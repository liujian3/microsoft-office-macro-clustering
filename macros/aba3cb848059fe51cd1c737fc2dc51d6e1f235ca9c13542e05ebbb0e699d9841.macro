Attribute VB_Name = "Auditrep"
Sub Autidrep_settings()
    Dim modeltype As Variant
    modeltype = GetDocPropNameErr("DocIsClass")
    
    With FrmDocVariables
    Dim index, index2 As Integer
    index = .LstInt_Period.ListIndex
    If index = 1 And modeltype = "C" Then modeltype = "C1"
    
        Select Case modeltype
         Case Is = "C1"
            .LstInt_Audit_type.ListIndex = 0
            
            .LstInt_Audit_type.Enabled = True
         Case Is = "C"
            .LstInt_Audit_type.Enabled = False
            .LstInt_Audit_type.ListIndex = 0
         Case Is = "B"
            .LstInt_Audit_type.Enabled = True
        End Select
    End With
End Sub


'|fffd|ndre erkl|fffd|ringstypen
Sub changesettings()
    With FrmDocVariables
        .LstInt_Audit_Management.Enabled = True
    
    If .LstInt_Audit_type.value = "Revision" Then
        'Erkl|fffd|rings rammen
        'Guidenstekster
            .Guide_Audit_Revi_01.Visible = True
            .Guide_Audit_review_01.Visible = False
        'Erkl|fffd|ringstype med/uden forbehold
            .Frm_Opinion.Enabled = True
            .LstInt_Audit_Opinion.Enabled = True
            If .LstInt_Audit_Opinion.value = "Med manglende konklusion" Then
                .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.Visible = True
            Else
                .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.Visible = False
            End If
        ' Ledelsesberetningens rammen
            .Frm_Management.Enabled = True
            .ChkBoo_Audit_Management.Visible = False
            .ChkBoo_Audit_Management.value = False
        'Fremh|fffd|velser
            .Frm_OtherRep.Enabled = True
            .LblCAP_OtherRep.Enabled = True
            .ChkBoo_Auditedrep_GoingCorcern.Enabled = True
            .ChkBoo_Auditedrep_MatterFinancialStat.Enabled = True
            .ChkBoo_Auditedrep_KeyMatter.Enabled = True
            .ChkBoo_Auditedrep_MatterAudit.Enabled = True
            .ChkBoo_Auditedrep_MatterAudit.Caption = "Fremh|fffd|velse af forhold vedr|fffd|rende revisionen"
            .ChkBoo_Auditedrep_Responsibilities_01.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_02.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_03.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_04.Enabled = True
            
            .ChkBoo_Auditedrep_RegulationEU.Enabled = True
       
    End If
    
    If .LstInt_Audit_type.value = "Review" Then
        'Erkl|fffd|rings rammen
        'Guidenstekster
            .Guide_Audit_Revi_01.Visible = False
            .Guide_Audit_review_01.Visible = True
        'Erkl|fffd|ringstype med/uden forbehold
            .Frm_Opinion.Enabled = True
            .LstInt_Audit_Opinion.Enabled = True
            .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.Visible = False
            .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.value = False
        'Ledelsesberetningen
            .Frm_Management.Enabled = True
            .ChkBoo_Audit_Management.Visible = True
            .ChkBoo_Audit_Management.value = False
        'Fremh|fffd|velser
            .Frm_OtherRep.Enabled = True
            .LblCAP_OtherRep.Enabled = True
            .ChkBoo_Auditedrep_GoingCorcern.Enabled = False
            .ChkBoo_Auditedrep_MatterFinancialStat.Enabled = True
            .ChkBoo_Auditedrep_KeyMatter.Enabled = False
            .ChkBoo_Auditedrep_MatterAudit.Enabled = True
            .ChkBoo_Auditedrep_MatterAudit.Caption = "Fremh|fffd|velse af forhold vedr|fffd|rende review"
            .ChkBoo_Auditedrep_Responsibilities_01.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_02.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_03.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_04.Enabled = False
            
            .ChkBoo_Auditedrep_RegulationEU.Enabled = False
    End If
    
    
    If .LstInt_Audit_type.value = "Udvidet gennemgang" Then
        'Guidenstekster
            .Guide_Audit_Revi_01.Visible = True
            .Guide_Audit_review_01.Visible = False
        'Forbehold
            .Frm_Opinion.Enabled = True
            .LstInt_Audit_Opinion.Enabled = True
             .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.Visible = False
            .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.value = False
        'Ledelsesberetningen
            .Frm_Management.Enabled = True
            .ChkBoo_Audit_Management.Visible = False
            .ChkBoo_Audit_Management.value = False
        'Fremh|fffd|velser
            .Frm_OtherRep.Enabled = True
            .LblCAP_OtherRep.Enabled = True
            .ChkBoo_Auditedrep_GoingCorcern.Enabled = False
            .ChkBoo_Auditedrep_MatterFinancialStat.Enabled = True
            .ChkBoo_Auditedrep_KeyMatter.Enabled = False
            .ChkBoo_Auditedrep_MatterAudit.Enabled = True
            .ChkBoo_Auditedrep_MatterAudit.Caption = "Fremh|fffd|velse af forhold vedr|fffd|rende udvidet gg."
            .ChkBoo_Auditedrep_Responsibilities_01.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_02.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_03.Enabled = True
            .ChkBoo_Auditedrep_Responsibilities_04.Enabled = True
            
            .ChkBoo_Auditedrep_RegulationEU.Enabled = True
            
    End If
    
    If .LstInt_Audit_type.value = "Assistance" Then
        'Guidenstekster
            .Guide_Audit_Revi_01.Visible = False
            .Guide_Audit_review_01.Visible = True
        .Frm_Opinion.Enabled = False
            .LstInt_Audit_Opinion.Enabled = False
             .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.Visible = False
            .ChkBoo_Auditedrep_Opinion_Disclaminer_Important.value = False
        .Frm_Management.Enabled = False
            .LstInt_Audit_Management.Enabled = False
            .ChkBoo_Audit_Management.Visible = False
             .ChkBoo_Audit_Management.value = False
        .Frm_OtherRep.Enabled = False
            .LblCAP_OtherRep.Enabled = False
            .ChkBoo_Auditedrep_GoingCorcern.Enabled = False
            .ChkBoo_Auditedrep_MatterFinancialStat.Enabled = False
            .ChkBoo_Auditedrep_KeyMatter.Enabled = False
            .ChkBoo_Auditedrep_MatterAudit.Enabled = False
            
            .ChkBoo_Auditedrep_Responsibilities_01.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_02.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_03.Enabled = False
            .ChkBoo_Auditedrep_Responsibilities_04.Enabled = False
            
            .ChkBoo_Auditedrep_RegulationEU.Enabled = False
    End If
    
    End With

End Sub
'Bygger dropboksen for konklusionstypen
Sub change_Audittype()
With FrmDocVariables
    Dim index As Integer
    index = .LstInt_Audit_type.ListIndex
    .LstInt_Audit_Opinion.Clear
End With
Select Case index
     Case Is = 0 'revision
         With FrmDocVariables.LstInt_Audit_Opinion
            .AddItem ("Uden forbehold")
            .AddItem ("Med forbehold pga. uenighed med ledelsen")
            .AddItem ("Med forbehold pga. utilstr|fffd|kkeligt revisionsbevis")
            .AddItem ("Med afkr|fffd|ftende konklusion")
            .AddItem ("Med manglende konklusion")
            .ListIndex = 0
         End With
         FrmDocVariables.LstInt_Audit_Management.ListIndex = 0
     Case Is = 1 'udvidet gennemgang
         With FrmDocVariables.LstInt_Audit_Opinion
            .AddItem ("Uden forbehold")
            .AddItem ("Med forbehold")
            .AddItem ("Med afkr|fffd|ftende konklusion")
            .AddItem ("Med manglende konklusion")
            .ListIndex = 0
         End With
         FrmDocVariables.LstInt_Audit_Management.ListIndex = 0
     Case Is = 2 'review
         With FrmDocVariables.LstInt_Audit_Opinion
            .AddItem ("Uden forbehold")
            .AddItem ("Med forbehold")
            .AddItem ("Med afkr|fffd|ftende konklusion")
            .AddItem ("Med manglende konklusion")
            .ListIndex = 0
         End With
         FrmDocVariables.LstInt_Audit_Management.ListIndex = -1
    Case Is = 3 ' Assistance
            FrmDocVariables.LstInt_Audit_Management.ListIndex = -1
End Select


End Sub

Attribute VB_Name = "BusinessServicesClient"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Function GetOffices() As DeloitteOffice()
    Dim xml As String
    xml = PostWebservice("http://businessservices/officeservice.asmx", _
    "<GetOffices xmlns=""http://dk.deloitte.com/businessservices/"">" & _
      "<CompanyID></CompanyID>" & _
    "</GetOffices>")
    
    Dim startPos As Integer
    Dim endPos As Integer
    Dim current As String
    Dim result() As DeloitteOffice
    Dim newOffice As DeloitteOffice
    Dim count As Integer
    
    startPos = 1
    count = -1
    
    Do
        startPos = InStr(startPos, xml, "<OfficeInfo>")
        If startPos > 0 Then
            endPos = InStr(startPos, xml, "</OfficeInfo>")
            startPos = startPos + 12
            
            current = Mid(xml, startPos, endPos - startPos)
            
            Set newOffice = New DeloitteOffice
            With newOffice
                .CompanyID = GetElementContent(current, "CompanyID")
                .CompanyName = GetElementContent(current, "CompanyName")
                .Country = GetElementContent(current, "Country")
                .CVRNo = GetElementContent(current, "CVRNo")
                .DisplayName = GetElementContent(current, "DisplayName")
                .Fax = GetElementContent(current, "Fax")
                .LegalName1 = GetElementContent(current, "LegalName1")
                .LegalName2 = GetElementContent(current, "LegalName2")
                .OfficeAddress = GetElementContent(current, "OfficeAddress")
                .OfficeCity = GetElementContent(current, "OfficeCity")
                .OfficeID = GetElementContent(current, "OfficeID")
                .OfficeName = GetElementContent(current, "OfficeName")
                .OfficeZip = GetElementContent(current, "OfficeZip")
                .Phone = GetElementContent(current, "Phone")
                .PostalAddress = GetElementContent(current, "PostalAddress")
                .PostalCity = GetElementContent(current, "PostalCity")
                .PostalZip = GetElementContent(current, "PostalZip")
            End With
            
            count = count + 1
            ReDim Preserve result(count)
            Set result(count) = newOffice
        End If
    Loop Until startPos = 0
    
    GetOffices = result
End Function

Private Function PostWebservice(ByVal AsmxUrl As String, ByVal soapBody As String) As String
 Dim objDom As Object
 Dim objXmlHttp As Object
 Dim strRet As String
 Dim intPos1 As Integer
 Dim intPos2 As Integer
 
On Error GoTo Err_PW
 
' Create objects to DOMDocument and XMLHTTP
 Set objDom = CreateObject("MSXML2.DOMDocument")
 Set objXmlHttp = CreateObject("MSXML2.XMLHTTP")
 
' Load XML
 objDom.async = False
 objDom.LoadXML "<?xml version=""1.0"" encoding=""utf-8""?>" & _
"<soap12:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap12=""http://www.w3.org/2003/05/soap-envelope""><soap12:Body>" & _
soapBody & _
"</soap12:Body></soap12:Envelope>"
 
' Open the webservice
 objXmlHttp.Open "POST", AsmxUrl, False
 
' Create headings
 'objXmlHttp.setRequestHeader "Content-Type", "text/xml; charset=utf-8"
 'objXmlHttp.setRequestHeader "SOAPAction", SoapActionUrl
 objXmlHttp.SetRequestHeader "Content-Type", "application/soap+xml; charset=utf-8"
 objXmlHttp.SetRequestHeader "Content-Length", Len(objDom.xml)
 
' Send XML command
 objXmlHttp.Send objDom.xml
 
' Get all response text from webservice
 strRet = objXmlHttp.ResponseText
 
' Close object
 Set objXmlHttp = Nothing
 
' Extract result
 intPos1 = InStr(strRet, "<soap:Body>") + 11
 intPos2 = InStr(strRet, "</soap:Body>")
 If intPos1 > 7 And intPos2 > 0 Then
 strRet = Mid(strRet, intPos1, intPos2 - intPos1)
 End If
 
' Return result
 PostWebservice = strRet
 
Exit Function
Err_PW:
 PostWebservice = "Error: " & Err.Number & " - " & Err.Description
 
End Function

Private Function GetElementContent(xml As String, elementName As String)
    Dim startPos As Integer
    Dim endPos As Integer
    
    startPos = InStr(xml, "<" & elementName & ">")
    If startPos > 0 Then
        endPos = InStr(startPos, xml, "</" & elementName & ">")
        startPos = startPos + Len(elementName) + 2
        If endPos > startPos Then
            GetElementContent = Mid(xml, startPos, endPos - startPos)
        End If
    End If
End Function

Attribute VB_Name = "CalTreasureAndKon"
'BEPE calculation of Treasure froms (koncern)
Sub CalculateSum_TreSubFormKon()

'insert name
Dim AktieA, AktieB, AktieC, AktieD, AktieE, AktieF, AktieG, AktieH, AktieI, AktieJ As String

On Error GoTo Errorhandler

AktieA = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_01.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_01.Caption = AktieA
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_01.Caption = AktieA
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_01.Caption = AktieA
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_01.Caption = AktieA


AktieB = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_02.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_02.Caption = AktieB
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_02.Caption = AktieB
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_02.Caption = AktieB
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_02.Caption = AktieB

AktieC = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_03.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_03.Caption = AktieC
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_03.Caption = AktieC
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_03.Caption = AktieC
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_03.Caption = AktieC

AktieD = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_04.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_04.Caption = AktieD
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_04.Caption = AktieD
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_04.Caption = AktieD
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_04.Caption = AktieD

AktieE = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_05.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_05.Caption = AktieE
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_05.Caption = AktieE
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_05.Caption = AktieE
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_05.Caption = AktieE

AktieF = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_06.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_06.Caption = AktieF
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_06.Caption = AktieF
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_06.Caption = AktieF
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_06.Caption = AktieF

AktieG = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_07.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_07.Caption = AktieG
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_07.Caption = AktieG
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_07.Caption = AktieG
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_07.Caption = AktieG

AktieH = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_08.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_08.Caption = AktieH
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_08.Caption = AktieH
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_08.Caption = AktieH
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_08.Caption = AktieH

AktieI = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_09.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_09.Caption = AktieI
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_09.Caption = AktieI
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_09.Caption = AktieI
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_09.Caption = AktieI

AktieJ = FrmKonTreasure.TxtStr_C_Treasur_Primo_Navn_10.value
FrmKonTreasure.LblStr_C_Treasur_Acq_Navn_10.Caption = AktieJ
FrmKonTreasure.LblStr_C_Treasur_Sol_Navn_10.Caption = AktieJ
FrmKonTreasure.LblStr_C_Treasur_Sec_Navn_10.Caption = AktieJ
FrmKonTreasure.LblStr_C_Treasur_Por_Navn_10.Caption = AktieJ

'calculated amount af treasur
'Dim AktieA_am_pr, AktieB_am_pr, AktieC_am_pr, AktieD_am_pr, AktieE_am_pr, AktieF_am_pr, AktieG_am_pr, AktieH_am_pr, AktieI_am_pr, AktieJ_am_pr As Double
Dim Array_am_pr(9) As Double
Dim Array_am_in(9) As Double
Dim Array_am_out(9) As Double
Dim Array_am_secure(9) As Double
Dim Array_am_ul(9) As Double

Dim Array_val_pr(9) As Double
Dim Array_val_in(9) As Double
Dim Array_val_out(9) As Double
Dim Array_val_secure(9) As Double
Dim Array_val_ul(9) As Double

Dim Array_pct_pr(9) As Double
Dim Array_pct_in(9) As Double
Dim Array_pct_out(9) As Double
Dim Array_pct_secure(9) As Double
Dim Array_pct_ul(9) As Double

Dim obj
Dim TabObj
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ObjNumber
Dim ObjValue

For Each PageTab In FrmKonTreasure.PgSubVar.Pages
    If PageTab.Visible = True Then
         For Each obj In PageTab.Controls
            
            If obj.Visible = True Then
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_PRIMO_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_ACQ_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SOL_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SEC_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_secure(ObjNumber) = ObjValue
                End If
                
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_PRIMO_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_ACQ_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SOL_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SEC_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_secure(ObjNumber) = ObjValue
                End If
            
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_PRIMO_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    
                    If ObjValue = "" Then
                        Array_pct_pr(ObjNumber) = 0
                    Else
                        Array_pct_pr(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_ACQ_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_in(ObjNumber) = 0
                    Else
                        Array_pct_in(ObjNumber) = ObjValue
                    End If
                    
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SOL_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_out(ObjNumber) = 0
                    Else
                         Array_pct_out(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_C_TREASUR_SEC_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_secure(ObjNumber) = 0
                    Else
                        Array_pct_secure(ObjNumber) = ObjValue
                    End If
                End If
                    
            
            End If
         Next obj
    
    End If

Next PageTab


Dim counter As Double


For counter = 0 To 9
    Array_am_ul(counter) = Array_am_pr(counter) + Array_am_in(counter) - Array_am_out(counter) + Array_am_secure(counter)
    Array_val_ul(counter) = Array_val_pr(counter) + Array_val_in(counter) - Array_val_out(counter) + Array_val_secure(counter)
    Array_pct_ul(counter) = Array_pct_pr(counter) + Array_pct_in(counter) - Array_pct_out(counter) + Array_pct_secure(counter)
Next




For Each PageTab In FrmKonTreasure.PgSubVar.Pages
       
            For Each obj In PageTab.Controls
                If obj.Visible = True Then
                    If InStr(1, UCase(obj.Name), "LBLINT_C_TREASUR_POR_NUMBER") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_am_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_C_TREASUR_POR_VALUE") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_val_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_C_TREASUR_POR_PCT") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_pct_ul(ObjNumber))
                    End If
                End If
            Next obj
Next PageTab




Dim Sum_am_pr As Double
Dim Sum_am_in As Double
Dim Sum_am_out As Double
Dim Sum_am_secure As Double
Dim Sum_am_ul As Double

Dim Sum_val_pr As Double
Dim Sum_val_in As Double
Dim Sum_val_out As Double
Dim Sum_val_secure As Double
Dim Sum_val_ul As Double

Dim Sum_pct_pr As Double
Dim Sum_pct_in As Double
Dim Sum_pct_out As Double
Dim Sum_pct_secure As Double
Dim Sum_pct_ul As Double

For counter = 0 To 9
    Sum_am_pr = Sum_am_pr + Array_am_pr(counter)
    Sum_am_in = Sum_am_in + Array_am_in(counter)
    Sum_am_out = Sum_am_out + Array_am_out(counter)
    Sum_am_secure = Sum_am_secure + Array_am_secure(counter)
    Sum_am_ul = Sum_am_ul + Array_am_ul(counter)

    Sum_val_pr = Sum_val_pr + Array_val_pr(counter)
    Sum_val_in = Sum_val_in + Array_val_in(counter)
    Sum_val_out = Sum_val_out + Array_val_out(counter)
    Sum_val_secure = Sum_val_secure + Array_val_secure(counter)
    Sum_val_ul = Sum_val_ul + Array_val_ul(counter)

    Sum_pct_pr = Sum_pct_pr + Array_pct_pr(counter)
    Sum_pct_in = Sum_pct_in + Array_pct_in(counter)
    Sum_pct_out = Sum_pct_out + Array_pct_out(counter)
    Sum_pct_secure = Sum_pct_secure + Array_pct_secure(counter)
    Sum_pct_ul = Sum_pct_ul + Array_pct_ul(counter)
Next
   
FrmKonTreasure.LblTot_C_Treasur_Primo_Number.Caption = DecSep(Sum_am_pr)
FrmKonTreasure.LblTot_C_Treasur_Primo_Value.Caption = DecSep(Sum_val_pr)
FrmKonTreasure.LblTot_C_Treasur_Primo_Pct.Caption = Sum_pct_pr
   
FrmKonTreasure.LblTot_C_Treasur_Acq_Number.Caption = DecSep(Sum_am_in)
FrmKonTreasure.LblTot_C_Treasur_Acq_Value.Caption = DecSep(Sum_val_in)
FrmKonTreasure.LblTot_C_Treasur_Acq_Pct.Caption = Sum_pct_in

FrmKonTreasure.LblTot_C_Treasur_Sol_Number.Caption = DecSep(Sum_am_out)
FrmKonTreasure.LblTot_C_Treasur_Sol_Value.Caption = DecSep(Sum_val_out)
FrmKonTreasure.LblTot_C_Treasur_Sol_Pct.Caption = Sum_pct_out

FrmKonTreasure.LblTot_C_Treasur_Sec_Number.Caption = DecSep(Sum_am_secure)
FrmKonTreasure.LblTot_C_Treasur_Sec_Value.Caption = DecSep(Sum_val_secure)
FrmKonTreasure.LblTot_C_Treasur_Sec_Pct.Caption = Sum_pct_secure

FrmKonTreasure.LblTot_C_Treasur_Por_Number.Caption = DecSep(Sum_am_ul)
FrmKonTreasure.LblTot_C_Treasur_Por_Value.Caption = DecSep(Sum_val_ul)
FrmKonTreasure.LblTot_C_Treasur_Por_Pct.Caption = Sum_pct_ul
   Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub
'BEPE calculation of Treasure froms (single og modervirksomheden)
Sub CalculateSum_TreSubForm()

'insert name
Dim AktieA, AktieB, AktieC, AktieD, AktieE, AktieF, AktieG, AktieH, AktieI, AktieJ As String

On Error GoTo Errorhandler

AktieA = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_01.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Sol_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Sec_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Por_Navn_01.Caption = AktieA


AktieB = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_02.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Sol_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Sec_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Por_Navn_02.Caption = AktieB

AktieC = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_03.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Sol_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Sec_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Por_Navn_03.Caption = AktieC

AktieD = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_04.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Sol_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Sec_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Por_Navn_04.Caption = AktieD

AktieE = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_05.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Sol_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Sec_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Por_Navn_05.Caption = AktieE

AktieF = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_06.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Sol_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Sec_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Por_Navn_06.Caption = AktieF

AktieG = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_07.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Sol_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Sec_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Por_Navn_07.Caption = AktieG

AktieH = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_08.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Sol_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Sec_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Por_Navn_08.Caption = AktieH

AktieI = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_09.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Sol_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Sec_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Por_Navn_09.Caption = AktieI

AktieJ = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_10.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Sol_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Sec_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Por_Navn_10.Caption = AktieJ

'calculated amount af treasur
'Dim AktieA_am_pr, AktieB_am_pr, AktieC_am_pr, AktieD_am_pr, AktieE_am_pr, AktieF_am_pr, AktieG_am_pr, AktieH_am_pr, AktieI_am_pr, AktieJ_am_pr As Double
Dim Array_am_pr(9) As Double
Dim Array_am_in(9) As Double
Dim Array_am_out(9) As Double
Dim Array_am_secure(9) As Double
Dim Array_am_ul(9) As Double

Dim Array_val_pr(9) As Double
Dim Array_val_in(9) As Double
Dim Array_val_out(9) As Double
Dim Array_val_secure(9) As Double
Dim Array_val_ul(9) As Double

Dim Array_pct_pr(9) As Double
Dim Array_pct_in(9) As Double
Dim Array_pct_out(9) As Double
Dim Array_pct_secure(9) As Double
Dim Array_pct_ul(9) As Double

Dim obj
Dim TabObj
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ObjNumber
Dim ObjValue

For Each PageTab In FrmTreasure.PgSubVar.Pages
    If PageTab.Visible = True Then
         For Each obj In PageTab.Controls
            
            If obj.Visible = True Then
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_secure(ObjNumber) = ObjValue
                End If
                
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_secure(ObjNumber) = ObjValue
                End If
            
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    
                    If ObjValue = "" Then
                        Array_pct_pr(ObjNumber) = 0
                    Else
                        Array_pct_pr(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_in(ObjNumber) = 0
                    Else
                        Array_pct_in(ObjNumber) = ObjValue
                    End If
                    
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_out(ObjNumber) = 0
                    Else
                         Array_pct_out(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_secure(ObjNumber) = 0
                    Else
                        Array_pct_secure(ObjNumber) = ObjValue
                    End If
                End If
                    
            
            End If
         Next obj
    
    End If

Next PageTab


Dim counter As Double


For counter = 0 To 9
    Array_am_ul(counter) = Array_am_pr(counter) + Array_am_in(counter) - Array_am_out(counter) + Array_am_secure(counter)
    Array_val_ul(counter) = Array_val_pr(counter) + Array_val_in(counter) - Array_val_out(counter) + Array_val_secure(counter)
    Array_pct_ul(counter) = Array_pct_pr(counter) + Array_pct_in(counter) - Array_pct_out(counter) + Array_pct_secure(counter)
Next




For Each PageTab In FrmTreasure.PgSubVar.Pages
       
            For Each obj In PageTab.Controls
                If obj.Visible = True Then
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_NUMBER") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_am_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_VALUE") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_val_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_PCT") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_pct_ul(ObjNumber))
                    End If
                End If
            Next obj
Next PageTab




Dim Sum_am_pr As Double
Dim Sum_am_in As Double
Dim Sum_am_out As Double
Dim Sum_am_secure As Double
Dim Sum_am_ul As Double

Dim Sum_val_pr As Double
Dim Sum_val_in As Double
Dim Sum_val_out As Double
Dim Sum_val_secure As Double
Dim Sum_val_ul As Double

Dim Sum_pct_pr As Double
Dim Sum_pct_in As Double
Dim Sum_pct_out As Double
Dim Sum_pct_secure As Double
Dim Sum_pct_ul As Double

For counter = 0 To 9
    Sum_am_pr = Sum_am_pr + Array_am_pr(counter)
    Sum_am_in = Sum_am_in + Array_am_in(counter)
    Sum_am_out = Sum_am_out + Array_am_out(counter)
    Sum_am_secure = Sum_am_secure + Array_am_secure(counter)
    Sum_am_ul = Sum_am_ul + Array_am_ul(counter)

    Sum_val_pr = Sum_val_pr + Array_val_pr(counter)
    Sum_val_in = Sum_val_in + Array_val_in(counter)
    Sum_val_out = Sum_val_out + Array_val_out(counter)
    Sum_val_secure = Sum_val_secure + Array_val_secure(counter)
    Sum_val_ul = Sum_val_ul + Array_val_ul(counter)

    Sum_pct_pr = Sum_pct_pr + Array_pct_pr(counter)
    Sum_pct_in = Sum_pct_in + Array_pct_in(counter)
    Sum_pct_out = Sum_pct_out + Array_pct_out(counter)
    Sum_pct_secure = Sum_pct_secure + Array_pct_secure(counter)
    Sum_pct_ul = Sum_pct_ul + Array_pct_ul(counter)
Next
   
FrmTreasure.LblTot_S_Treasur_Primo_Number.Caption = DecSep(Sum_am_pr)
FrmTreasure.LblTot_S_Treasur_Primo_Value.Caption = DecSep(Sum_val_pr)
FrmTreasure.LblTot_S_Treasur_Primo_Pct.Caption = Sum_pct_pr
   
FrmTreasure.LblTot_S_Treasur_Acq_Number.Caption = DecSep(Sum_am_in)
FrmTreasure.LblTot_S_Treasur_Acq_Value.Caption = DecSep(Sum_val_in)
FrmTreasure.LblTot_S_Treasur_Acq_Pct.Caption = Sum_pct_in

FrmTreasure.LblTot_S_Treasur_Sol_Number.Caption = DecSep(Sum_am_out)
FrmTreasure.LblTot_S_Treasur_Sol_Value.Caption = DecSep(Sum_val_out)
FrmTreasure.LblTot_S_Treasur_Sol_Pct.Caption = Sum_pct_out

FrmTreasure.LblTot_S_Treasur_Sec_Number.Caption = DecSep(Sum_am_secure)
FrmTreasure.LblTot_S_Treasur_Sec_Value.Caption = DecSep(Sum_val_secure)
FrmTreasure.LblTot_S_Treasur_Sec_Pct.Caption = Sum_pct_secure

FrmTreasure.LblTot_S_Treasur_Por_Number.Caption = DecSep(Sum_am_ul)
FrmTreasure.LblTot_S_Treasur_Por_Value.Caption = DecSep(Sum_val_ul)
FrmTreasure.LblTot_S_Treasur_Por_Pct.Caption = Sum_pct_ul
   Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub
Attribute VB_Name = "CalcGeneral"
Sub CalculateSum()
'Aangepast 11-10 avangool:
'LblTot is een som van de gelijke elementen. Probleem was PY en PY1 de string PY wordt ook gevonden in
'PY1. Drie oplossingstrategieen.
'PY wordt PY0 niet voor gekozen
'zoekstring wordt niet PY maar PY_ ivm nummer die erachter komt. Nadeel. Je kunt geen tot maken van een enkel label

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ErrorsFound
Dim EmptyTab As Boolean 'variable to test if a txt object is filled on a multitab
Dim SpecifyTab As Boolean 'variable to test if tab must be specified
Dim DataControl As String

Dim CVRSpec As Boolean 'variable to test if cvr forced filled are fillout
Dim CVRForced As Boolean ' variable to test if page are containing CVRforced filled
Dim CVRControlBox As Boolean ' variable are used to assure that the messagebox is only show one per page

FrmDocVariables.listNavigate.View = lvwReport
FrmDocVariables.listNavigate.ListItems.Clear
PageNr = 0

On Error GoTo Errorhandler

For Each PageTab In FrmDocVariables.MultiPage1.Pages

    If PageTab.Visible = True Then
    
        ErrorsFound = False
        FrmDocVariables.listNavigate.ListItems.Add , , PageTab.Caption
        'FrmDocVariables.lstNavigate.ListItems(PageNr + 1).SubItems(1) = "OK"
        FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlack
    
        Dim FormatTot
       
        EmptyTab = True
        SpecifyTab = False
        CVRSpec = False
        CVRForced = False
        CVRControlBox = False
        Sub_TbChecks = False
        Sub_Boo_Spec = False
        Sub_TbChecks = False
        Sub_Empty = False
        DataControl = ""
        
        If PageTab.Name = "Pg_Status_I" Then
            DataControl = PageTab.Tag
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = DataControl
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
            If DataControl = "" Then
                FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlack
            End If
            
        End If
        
        'Evaluation of totals
        
        Dim TbTotValue
        Dim TabObjName
        For Each obj In PageTab.Controls
        
            'reading info: if tab is part of a manual specification. No TB check only if SOMETHING is filled in
            If InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                SpecifyTab = True
            End If
            
            'add by BEPE, checks subforms
            If InStr(1, UCase(obj.Name), "SUBBOO_SPEC") > 0 Then
                Sub_Boo_Spec = obj.Caption
            End If
            If InStr(1, UCase(obj.Name), "SUB_TBCHECKS") > 0 Then
                Sub_TbChecks = obj.Caption
            End If
            If InStr(1, UCase(obj.Name), "SUB_EMPTY") > 0 Then
                Sub_Empty = obj.Caption
            End If
            
            If obj.Visible = True Then
            
                'add by bepe. controls numberfil, most be integer
                If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                    obj.ForeColor = vbBlack
                    If obj.value <> "" Then
                        NewValue = Replace(obj.value, " ", "")
                        If InStr(1, NewValue, "(") > 0 Then
                            obj.ForeColor = vbRed
                            CVRControlBox = True
                        ElseIf IsNumeric(NewValue) Then
                            obj.value = NewValue
'                        ElseIf CVRControlBox = False Then
'                            'MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter, derfor skal f|fffd|lgende fane gennemg|fffd|s igen: " & PageTab.Caption
'                            CVRControlBox = True
'                            obj.ForeColor = vbRed
                        Else
                            obj.ForeColor = vbRed
                            CVRControlBox = True
                        End If
                    End If
                End If
            
                'add by bepe. comtrols dato fill most be dato filled
                If InStr(1, UCase(obj.Name), "_DEADL") > 0 Or InStr(1, UCase(obj.Name), "_DUE") > 0 Then
                    obj.ForeColor = vbBlack
                    Dim control_obj As String
                    control_obj = ConvStringToDate_2(obj.value)
                    If control_obj = "False" Then
                        obj.ForeColor = vbRed
                        CVRControlBox = True
                    ElseIf control_obj = "" Then
                        obj.value = ""
                    Else
                        obj.ForeColor = vbBlack
                        obj.value = control_obj
                    End If
                End If
            

                'Looking for checksums based on the convention LBLTOT (vertical) see also LBLSUM (horizontal)
                'If vertical: is left part of the string equal to the LBLtot name
                'If horizontal: is the last part after the underscore equal to the LBLTOT name
                
                'Mind the following consequences... The LblSom may be part of a LblTot total but not the other way round, Therefore these are calculated first.
                
                'Calculating the lblSOM labels
                If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                    SumTot = 0
                    'Application.StatusBar = Obj.Name
                    TbTotValue = ""
                    For Each TabObj In PageTab.Controls
                        
                        'Add up the edit boxes
                        If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                            
                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        FormatTot = DecSep(SumTot)
                        If FormatTot = "" Then FormatTot = "0"
                        obj.Caption = FormatTot
                        
                    Next TabObj
                End If
                
                'Calculating the lblTOT labels
                If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                               
                    SumTot = 0
                    'Application.StatusBar = Obj.Name
                    TbTotValue = ""
                    
                    For Each TabObj In PageTab.Controls
                        
                        'Adding up the edit boxes
                        If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde sluit lstobject zelf uit (heeft ook geen value)
                            
                            If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then
    
                                ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                                SumTot = SumTot + val(ObjValue)
                            
                            End If
    ''                        'Veroorzaakt dubbeltellingen daarom verwijderd
    ''                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then
    ''
    ''                            Objvalue = ConvStrToNumb(TabObj.Caption, TabObj.Name)
    ''                            SumTot = SumTot + Val(Objvalue)
    ''
    ''                        End If
                        
                        End If
                        
                        FormatTot = DecSep(SumTot)
                        If FormatTot = "" Then FormatTot = "0"
                        obj.Caption = FormatTot
                        
                        'determining if there is a checksum as well and also record it's value
                        If InStr(1, UCase(TabObj.Name), "LBLINT") > 0 Then
                            If UCase(obj.Name) = "LBLTOT_" & UCase(Mid(TabObj.Name, 8, 100)) Then
                                'Checking for checksums on hidden frames (do not include)
                                If obj.Parent.Visible = True Then
                                    TbTotValue = TabObj.Caption
                                    TabObjName = TabObj.Name
                                End If
                            End If
                        End If
                        
                    Next TabObj
    
                    If TbTotValue <> "" Then 'A tb checksum has been found
                    
                        If obj.Caption = TbTotValue Then
                            'Update label on page
                            FrmDocVariables.Controls(TabObjName).ForeColor = vbBlue
                            
                            'Update Navigation Pane
                            If ErrorsFound = False Then
                             
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "OK"
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
                            End If
                        Else
                            'Red (not equal to)
                            'Update label on page
                    '## AVS 28062011
                            If EmptyTab = True Then
                            
                                FrmDocVariables.Controls(TabObjName).ForeColor = &H80FF& '&HFF
                                'Update Navigation Pane
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
                            Else
                            
                                FrmDocVariables.Controls(TabObjName).ForeColor = vbRed '&HFF
                                'Update Navigation Pane
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Difference"
                                FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
                            
                            End If
                    '## AVS 28062011
                            
                            ErrorsFound = True
        
                        End If
                    End If
    
                        
                End If 'LBLTOT > 0
             
                'Check if manual specifications are filled.
                If InStr(1, UCase(obj.Name), "TXTSTR") > 0 Or InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                    
                    If InStr(1, UCase(obj.Name), "_NC") = 0 Then 'addition NC for textboxes which are not included in the checks. Example employees which usually contain a default example text.
                              
                        If obj.value = "" Then
                            
                        Else
                            
                            EmptyTab = False
                            
                        End If
                
                    End If
                    
                End If
                
                
                               
                'ADD by BEPE, Check if CVR filled are fillout
                If obj.Tag <> "" Then
                    CVRForced = True
                    If obj.BackColor = vbRed Then
                        CVRSpec = True
                    End If
                End If
                
                'ADD by BEPE, Check if CVR filled are fillout
                If InStr(1, UCase(obj.Name), "PGDOCVARFORCED") > 0 Then
                    CVRForced = True
                    If obj.ForeColor = vbActiveTitleBar Then
                        CVRSpec = True
                    End If
                End If
            
            End If 'Object visible or not
            
        Next obj
    
    'Update Navigation pane for specification tabs (tabs containing differences are excluded = errorsfound)
    If EmptyTab = True And SpecifyTab = True And ErrorsFound = False Then
        FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
        FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
    End If
    If EmptyTab = False And SpecifyTab = True And ErrorsFound = False Then
        If CVRControlBox = True Then
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note!"
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
        Else
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note"
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
        End If
    End If
    
    'Add by BEPE; Update Nevigation pane for specification tabs (tabs containing CVR validations)
    If SpecifyTab = True And CVRForced = True Then
        If CVRSpec = True Then
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
        Else
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Ok"
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
        End If
    End If
    
    'add be BEPE; Update specifikation in sunforms
    If Sub_Boo_Spec = True Then
        If Sub_Empty = True Then
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
            FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
        Else
            If Sub_TbChecks = True Then
                   
                    'Update Navigation Pane
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Difference"
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
            Else
                If CVRControlBox = True Then
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note!"
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
                Else
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note"
                    FrmDocVariables.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
                End If
            End If
        End If
        
     
    End If
    
    
    PageNr = PageNr + 1
    
End If 'PageTab visible or not

Next PageTab



Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub
Sub CalculateSum_consol()
'Aangepast 11-10 avangool:
'LblTot is een som van de gelijke elementen. Probleem was PY en PY1 de string PY wordt ook gevonden in
'PY1. Drie oplossingstrategieen.
'PY wordt PY0 niet voor gekozen
'zoekstring wordt niet PY maar PY_ ivm nummer die erachter komt. Nadeel. Je kunt geen tot maken van een enkel label

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ErrorsFound
Dim EmptyTab As Boolean 'variable to test if a txt object is filled on a multitab
Dim SpecifyTab As Boolean 'variable to test if tab must be specified

Dim CVRSpec As Boolean 'variable to test if cvr forced filled are fillout
Dim CVRForced As Boolean ' variable to test if page are containing CVRforced filled
Dim CVRControlBox As Boolean ' variable are used to assure that the messagebox is only show one per page

FrmDocVarConSul.listNavigate.View = lvwReport
FrmDocVarConSul.listNavigate.ListItems.Clear
PageNr = 0

On Error GoTo Errorhandler

For Each PageTab In FrmDocVarConSul.MultiPage1.Pages

    If PageTab.Visible = True Then
    
        ErrorsFound = False
        FrmDocVarConSul.listNavigate.ListItems.Add , , PageTab.Caption
        'FrmDocVarConSul.lstNavigate.ListItems(PageNr + 1).SubItems(1) = "OK"
        FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlack
    
        Dim FormatTot
       
        EmptyTab = True
        SpecifyTab = False
        CVRSpec = False
        CVRForced = False
        CVRControlBox = False
        Sub_TbChecks = False
        Sub_Boo_Spec = False
        Sub_TbChecks = False
        Sub_Empty = False
        
        'Evaluation of totals
        
        Dim TbTotValue
        Dim TabObjName
        For Each obj In PageTab.Controls
        
            'reading info: if tab is part of a manual specification. No TB check only if SOMETHING is filled in
            If InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                SpecifyTab = True
            End If
            
            'add by BEPE, checks subforms
            If InStr(1, UCase(obj.Name), "SUBBOO_SPEC") > 0 Then
                Sub_Boo_Spec = obj.Caption
            End If
            If InStr(1, UCase(obj.Name), "SUB_TBCHECKS") > 0 Then
                Sub_TbChecks = obj.Caption
            End If
            If InStr(1, UCase(obj.Name), "SUB_EMPTY") > 0 Then
                Sub_Empty = obj.Caption
            End If
            
            If obj.Visible = True Then
            
                'add by bepe. controls numberfil, most be integer
                If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                    obj.ForeColor = vbBlack
                    If obj.value <> "" Then
                        NewValue = Replace(obj.value, " ", "")
                        If InStr(1, NewValue, "(") > 0 Then
                            obj.ForeColor = vbRed
                            CVRControlBox = True
                        ElseIf IsNumeric(NewValue) Then
                            obj.value = NewValue
'                        ElseIf CVRControlBox = False Then
'                            'MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter, derfor skal f|fffd|lgende fane gennemg|fffd|s igen: " & PageTab.Caption
'                            CVRControlBox = True
'                            obj.ForeColor = vbRed
                        Else
                            obj.ForeColor = vbRed
                            CVRControlBox = True
                        End If
                    End If
                End If
            
                'add by bepe. comtrols dato fill most be dato filled
                If InStr(1, UCase(obj.Name), "_DEADL") > 0 Or InStr(1, UCase(obj.Name), "_DUE") > 0 Then
                    obj.ForeColor = vbBlack
                    Dim control_obj As String
                    control_obj = ConvStringToDate_2(obj.value)
                    If control_obj = "False" Then
                        obj.ForeColor = vbRed
                        CVRControlBox = True
                    ElseIf control_obj = "" Then
                        obj.value = ""
                    Else
                        obj.ForeColor = vbBlack
                        obj.value = control_obj
                    End If
                End If
            

                'Looking for checksums based on the convention LBLTOT (vertical) see also LBLSUM (horizontal)
                'If vertical: is left part of the string equal to the LBLtot name
                'If horizontal: is the last part after the underscore equal to the LBLTOT name
                
                'Mind the following consequences... The LblSom may be part of a LblTot total but not the other way round, Therefore these are calculated first.
                
                'Calculating the lblSOM labels
                If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                    SumTot = 0
                    'Application.StatusBar = Obj.Name
                    TbTotValue = ""
                    For Each TabObj In PageTab.Controls
                        
                        'Add up the edit boxes
                        If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                            
                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        FormatTot = DecSep(SumTot)
                        If FormatTot = "" Then FormatTot = "0"
                        obj.Caption = FormatTot
                        
                    Next TabObj
                End If
                
                'Calculating the lblTOT labels
                If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                               
                    SumTot = 0
                    'Application.StatusBar = Obj.Name
                    TbTotValue = ""
                    
                    For Each TabObj In PageTab.Controls
                        
                        'Adding up the edit boxes
                        If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde sluit lstobject zelf uit (heeft ook geen value)
                            
                            If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then
    
                                ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                                SumTot = SumTot + val(ObjValue)
                            
                            End If
    ''                        'Veroorzaakt dubbeltellingen daarom verwijderd
    ''                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then
    ''
    ''                            Objvalue = ConvStrToNumb(TabObj.Caption, TabObj.Name)
    ''                            SumTot = SumTot + Val(Objvalue)
    ''
    ''                        End If
                        
                        End If
                        
                        FormatTot = DecSep(SumTot)
                        If FormatTot = "" Then FormatTot = "0"
                        obj.Caption = FormatTot
                        
                        'determining if there is a checksum as well and also record it's value
                        If InStr(1, UCase(TabObj.Name), "LBLINT") > 0 Then
                            If UCase(obj.Name) = "LBLTOT_" & UCase(Mid(TabObj.Name, 8, 100)) Then
                                'Checking for checksums on hidden frames (do not include)
                                If obj.Parent.Visible = True Then
                                    TbTotValue = TabObj.Caption
                                    TabObjName = TabObj.Name
                                End If
                            End If
                        End If
                        
                    Next TabObj
    
                    If TbTotValue <> "" Then 'A tb checksum has been found
                    
                        If obj.Caption = TbTotValue Then
                            'Update label on page
                            FrmDocVarConSul.Controls(TabObjName).ForeColor = vbBlue
                            
                            'Update Navigation Pane
                            If ErrorsFound = False Then
                             
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "OK"
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
                            End If
                        Else
                            'Red (not equal to)
                            'Update label on page
                    '## AVS 28062011
                            If EmptyTab = True Then
                            
                                FrmDocVarConSul.Controls(TabObjName).ForeColor = &H80FF& '&HFF
                                'Update Navigation Pane
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
                            Else
                            
                                FrmDocVarConSul.Controls(TabObjName).ForeColor = vbRed '&HFF
                                'Update Navigation Pane
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Difference"
                                FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
                            
                            End If
                    '## AVS 28062011
                            
                            ErrorsFound = True
        
                        End If
                    End If
    
                        
                End If 'LBLTOT > 0
             
                'Check if manual specifications are filled.
                If InStr(1, UCase(obj.Name), "TXTSTR") > 0 Or InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                    
                    If InStr(1, UCase(obj.Name), "_NC") = 0 Then 'addition NC for textboxes which are not included in the checks. Example employees which usually contain a default example text.
                              
                        If obj.value = "" Then
                            
                        Else
                            
                            EmptyTab = False
                            
                        End If
                
                    End If
                    
                End If
                
                
                               
                'ADD by BEPE, Check if CVR filled are fillout
'                If obj.Tag <> "" Then
'                    CVRForced = True
'                    If obj.ForeColor = vbRed Then
'                        CVRSpec = True
'                    End If
'                End If
            End If 'Object visible or not
            
        Next obj
    
    'Update Navigation pane for specification tabs (tabs containing differences are excluded = errorsfound)
    If EmptyTab = True And SpecifyTab = True And ErrorsFound = False Then
        FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
        FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
    End If
    If EmptyTab = False And SpecifyTab = True And ErrorsFound = False Then
        If CVRControlBox = True Then
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note!"
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
        Else
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note"
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
        End If
    End If
    
    'Add by BEPE; Update Nevigation pane for specification tabs (tabs containing CVR validations)
    If SpecifyTab = True And CVRForced = True Then
        If CVRSpec = True Then
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
        Else
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Ok"
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
        End If
    End If
    
    'add be BEPE; Update specifikation in sunforms
    If Sub_Boo_Spec = True Then
        If Sub_Empty = True Then
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Specify"
            FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = &H80FF&
        Else
            If Sub_TbChecks = True Then
                   
                    'Update Navigation Pane
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Difference"
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
            Else
                If CVRControlBox = True Then
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note!"
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbRed
                Else
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).SubItems(1) = "Note"
                    FrmDocVarConSul.listNavigate.ListItems(PageNr + 1).ForeColor = vbBlue
                End If
            End If
        End If
        
     
    End If
    
    
    PageNr = PageNr + 1
    
End If 'PageTab visible or not

Next PageTab



Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub


Sub CalculateSum_SubForm()

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim value01 As Double
Dim value02 As Double
Dim value03 As Double
Dim sum_PY3 As Double
Dim Sum_PY2 As Double
Dim Sum_PY1 As Double
Dim Sum_PY As Double


On Error GoTo Errorhandler


    
    Dim TbTotValue
    Dim TabObjName
    For Each obj In PageTab.Controls
          
       
        If obj.Visible = True Then
    
            'Op zoek naar controletotalen op basis van conventie LBLTOT (verticaal) zie ook LBLSUM (horizontaal)
            'Bij verticaal is linkergedeelte van de string gelijk aan het LBLtot naam
            'Bij horizontaal is het laatste gedeelte na de underscore gelijk aan de LBLTOT naam
            
            'Let op volgorde effecten... De LblSom mogen wel onderdeel zijn van een LblTot telling maar niet andersom. Derhalve worden deze eerst berekend.
            
            'Het berekenen van de lblSOM labels
            If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                SumTot = 0
                'Application.StatusBar = Obj.Name
                TbTotValue = ""
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                        
                        ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                        SumTot = SumTot + val(ObjValue)
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                Next TabObj
            End If
            
            
            
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                Next TabObj
                
                                   
            End If 'LBLTOT > 0
            
        End If 'Object visible or not
        
    Next obj
    
        
    PageNr = PageNr + 1
    



Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"
End Sub


Sub CalculateSum_KonTreasure()

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim FormatTot
'Beoordeling totalen
Dim TbTotValue
Dim TabObjName
    
On Error GoTo Errorhandler
    
    For Each obj In FrmKonTreasure.Frame65.Controls
          
       
        If obj.Visible = True Then
    
            'Op zoek naar controletotalen op basis van conventie LBLTOT (verticaal) zie ook LBLSUM (horizontaal)
            'Bij verticaal is linkergedeelte van de string gelijk aan het LBLtot naam
            'Bij horizontaal is het laatste gedeelte na de underscore gelijk aan de LBLTOT naam
            
            'Let op volgorde effecten... De LblSom mogen wel onderdeel zijn van een LblTot telling maar niet andersom. Derhalve worden deze eerst berekend.
            
            'Het berekenen van de lblSOM labels
            If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                SumTot = 0
                'Application.StatusBar = Obj.Name
                TbTotValue = ""
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                        
                        ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                        SumTot = SumTot + val(ObjValue)
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                Next TabObj
            End If
            
            
            
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In FrmKonTreasure.Frame65.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                Next TabObj
                
                                   
            End If 'LBLTOT > 0
            
        End If 'Object visible or not
        
    Next obj
    
        
    


Application.StatusBar = ""

Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub
'add by Bettina in dec. 2011 calculate frmKonAss (standard caculation)
Sub CalculateSum_KonAss()

Dim obj As control
Dim TabObj As control
Dim NewValue

Dim SumTot
Dim PageNr
Dim FormatTot
'Beoordeling totalen
Dim TbTotValue
Dim TabObjName
CVRControlBox = False
On Error GoTo Errorhandler

    For Each obj In FrmKonAss.Controls
        If obj.Visible = True Then
        
        
            If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                If obj.value <> "" Then
                    NewValue = Replace(obj.value, " ", "")
                    If InStr(1, NewValue, "(") > 0 Then
                        MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                        obj.ForeColor = vbRed
                        
                        Exit Sub
                    ElseIf IsNumeric(NewValue) Then
                        obj.value = NewValue
                        obj.ForeColor = vbBlack
                        Empty_C_FIXEDAS = False
                    ElseIf CVRControlBox = False Then
                        MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                        CVRControlBox = True
                        obj.ForeColor = vbRed
                        Exit Sub
                    Else
                        obj.value = ""
                    End If
                End If
            End If
            If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                SumTot = 0
                'Application.StatusBar = Obj.Name
                TbTotValue = ""
                For Each TabObj In FrmKonAss.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                        
                        ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                        SumTot = SumTot + val(ObjValue)
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                Next TabObj
            End If
            
            
            
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In FrmKonAss.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                Next TabObj
                                       
            End If 'LBLTOT > 0
            
        End If 'Object visible or not
        
    Next obj
Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub

'kontrollere om der er generalforsamling eller om der skal anvendes et alternativt
Sub CompDet_Annual_Chk()
Dim ValueChk As Boolean
Dim LblInt_ChkBoo_S_CompDet_Annual
LOOK_LANGCH = 3 'sporg
On Error GoTo Errorhandler
LOOK_LANGCH = ActiveDocument.CustomDocumentProperties("LOOK_LANGCH").value
Errorhandler:

    ValueChk = FrmDocVariables.ChkBoo_S_CompDet_Annual.value
If ValueChk Then 'tilvalgt
    LblInt_ChkBoo_S_CompDet_Annual = 1
    FrmDocVariables.Lbl_PgDocVarForced33.Enabled = True
    FrmDocVariables.TxtStr_S_CompDet_Annual_Text.Enabled = True
    FrmDocVariables.Lbl_PgDocVarForced34.Enabled = True
    FrmDocVariables.TxtStr_S_Chairman_Title.Enabled = True
'    FrmDocVariables.Lbl_PgDocVarForced34.ForeColor = vbBlue
    FrmDocVariables.TxtStr_S_Chairman_Title.BackColor = vbInactiveBorder
 '   FrmDocVariables.Lbl_PgDocVarForced33.ForeColor = vbBlue
    FrmDocVariables.TxtStr_S_CompDet_Annual_Text.BackColor = vbInactiveBorder
Else
    LblInt_ChkBoo_S_CompDet_Annual = 0
    FrmDocVariables.Lbl_PgDocVarForced33.Enabled = False
   ' FrmDocVariables.Lbl_PgDocVarForced33.ForeColor = vbBlue
   FrmDocVariables.TxtStr_S_CompDet_Annual_Text.BackColor = vbInactiveBorder
    FrmDocVariables.TxtStr_S_CompDet_Annual_Text.Enabled = False
    'FrmDocVariables.Lbl_PgDocVarForced34.ForeColor = vbBlue
    FrmDocVariables.TxtStr_S_Chairman_Title.BackColor = vbInactiveBorder
    FrmDocVariables.Lbl_PgDocVarForced34.Enabled = False
    FrmDocVariables.TxtStr_S_Chairman_Title.Enabled = False
    
    If LOOK_LANGCH = 4 Then
        FrmDocVariables.TxtStr_S_Chairman_Title.value = "Chairman of the General Meeting"
        FrmDocVariables.TxtStr_S_CompDet_Annual_Text.value = "The Annual General Meeting adopted the annual report on"
    Else
        FrmDocVariables.TxtStr_S_Chairman_Title.value = "Dirigent"
        FrmDocVariables.TxtStr_S_CompDet_Annual_Text.value = "Godkendt p|fffd| selskabets generalforsamling, den"
    End If
    
End If
    obj_Name = "LblInt_ChkBoo_S_CompDet_Annual"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    
    ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, LblInt_ChkBoo_S_CompDet_Annual
    
End Sub

'ved forskellige regler af type koncern, B og C, vises lables korrekt
Function Labels(obj As Object, modeltype As Variant, BooIsConsolidated As Boolean) As Boolean

    Labels = True
    If modeltype = "B" And InStr(1, UCase(obj.Name), "TEXTLBL_CLASSC_") > 0 Then Labels = False
    If modeltype = "B" And InStr(1, UCase(obj.Name), "TXTINT_CLASSC_") > 0 Then Labels = False
    If modeltype = "B" And InStr(1, UCase(obj.Name), "LBLTOT_CLASSC_") > 0 Then Labels = False
    If modeltype = "B" And InStr(1, UCase(obj.Name), "LBLINT_CLASSC_") > 0 Then Labels = False
    If modeltype = "C" And InStr(1, UCase(obj.Name), "TEXTLBL_CLASSB_") > 0 Then Labels = False
    
    If BooIsConsolidated = False And InStr(1, UCase(obj.Name), "_C_") > 0 Then Labels = False
    If BooIsConsolidated = True And InStr(1, UCase(obj.Name), "_E_") > 0 Then Labels = False
    If modeltype = "C" And InStr(1, UCase(obj.Name), "FRM_CLASSB") > 0 Then Labels = False
    

End Function
Attribute VB_Name = "CalcSubForms"
Sub Calculat_FrmFinAss()
Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr

On Error GoTo Errorhandler

For Each PageTab In FrmFinAss.MultiPage1.Pages

If PageTab.Visible = True Then

     Dim FormatTot
   
    'Beoordeling totalen
    
    Dim TbTotValue
    Dim TabObjName
    For Each obj In PageTab.Controls
          
       
        If obj.Visible = True Then
    
            'Op zoek naar controletotalen op basis van conventie LBLTOT (verticaal) zie ook LBLSUM (horizontaal)
            'Bij verticaal is linkergedeelte van de string gelijk aan het LBLtot naam
            'Bij horizontaal is het laatste gedeelte na de underscore gelijk aan de LBLTOT naam
            
            'Let op volgorde effecten... De LblSom mogen wel onderdeel zijn van een LblTot telling maar niet andersom. Derhalve worden deze eerst berekend.
            
            'Het berekenen van de lblSOM labels
            If InStr(1, UCase(obj.Name), "LBLSOM_") > 0 Then
                SumTot = 0
                'Application.StatusBar = Obj.Name
                TbTotValue = ""
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100)) > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then 'laatste voorwaarde om zichzelf uit te sluiten.
                        
                        ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                        SumTot = SumTot + val(ObjValue)
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                Next TabObj
            End If
            
            
            
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                Next TabObj
                
                                   
            End If 'LBLTOT > 0
            
        End If 'Object visible or not
        
    Next obj
    
        
    PageNr = PageNr + 1
    
End If 'PageTab visible or not



Next PageTab


Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"
End Sub
'BEPE calculation of Treasure froms
Sub CalculateSum_TreSubForm2()

'insert name
Dim AktieA, AktieB, AktieC, AktieD, AktieE, AktieF, AktieG, AktieH, AktieI, AktieJ As String

On Error GoTo Errorhandler

AktieA = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_01.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Sol_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Sec_Navn_01.Caption = AktieA
FrmTreasure.LblStr_S_Treasur_Por_Navn_01.Caption = AktieA


AktieB = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_02.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Sol_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Sec_Navn_02.Caption = AktieB
FrmTreasure.LblStr_S_Treasur_Por_Navn_02.Caption = AktieB

AktieC = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_03.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Sol_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Sec_Navn_03.Caption = AktieC
FrmTreasure.LblStr_S_Treasur_Por_Navn_03.Caption = AktieC

AktieD = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_04.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Sol_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Sec_Navn_04.Caption = AktieD
FrmTreasure.LblStr_S_Treasur_Por_Navn_04.Caption = AktieD

AktieE = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_05.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Sol_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Sec_Navn_05.Caption = AktieE
FrmTreasure.LblStr_S_Treasur_Por_Navn_05.Caption = AktieE

AktieF = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_06.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Sol_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Sec_Navn_06.Caption = AktieF
FrmTreasure.LblStr_S_Treasur_Por_Navn_06.Caption = AktieF

AktieG = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_07.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Sol_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Sec_Navn_07.Caption = AktieG
FrmTreasure.LblStr_S_Treasur_Por_Navn_07.Caption = AktieG

AktieH = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_08.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Sol_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Sec_Navn_08.Caption = AktieH
FrmTreasure.LblStr_S_Treasur_Por_Navn_08.Caption = AktieH

AktieI = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_09.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Sol_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Sec_Navn_09.Caption = AktieI
FrmTreasure.LblStr_S_Treasur_Por_Navn_09.Caption = AktieI

AktieJ = FrmTreasure.TxtStr_S_Treasur_Primo_Navn_10.value
FrmTreasure.LblStr_S_Treasur_Acq_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Sol_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Sec_Navn_10.Caption = AktieJ
FrmTreasure.LblStr_S_Treasur_Por_Navn_10.Caption = AktieJ

'calculated amount af treasur
'Dim AktieA_am_pr, AktieB_am_pr, AktieC_am_pr, AktieD_am_pr, AktieE_am_pr, AktieF_am_pr, AktieG_am_pr, AktieH_am_pr, AktieI_am_pr, AktieJ_am_pr As Double
Dim Array_am_pr(9) As Double
Dim Array_am_in(9) As Double
Dim Array_am_out(9) As Double
Dim Array_am_secure(9) As Double
Dim Array_am_ul(9) As Double

Dim Array_val_pr(9) As Double
Dim Array_val_in(9) As Double
Dim Array_val_out(9) As Double
Dim Array_val_secure(9) As Double
Dim Array_val_ul(9) As Double

Dim Array_pct_pr(9) As Double
Dim Array_pct_in(9) As Double
Dim Array_pct_out(9) As Double
Dim Array_pct_secure(9) As Double
Dim Array_pct_ul(9) As Double

Dim obj
Dim TabObj
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ObjNumber
Dim ObjValue

For Each PageTab In FrmTreasure.PgSubVar.Pages
    If PageTab.Visible = True Then
         For Each obj In PageTab.Controls
            
            If obj.Visible = True Then
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_secure(ObjNumber) = ObjValue
                End If
                
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_secure(ObjNumber) = ObjValue
                End If
            
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_PRIMO_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    
                    If ObjValue = "" Then
                        Array_pct_pr(ObjNumber) = 0
                    Else
                        Array_pct_pr(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_ACQ_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_in(ObjNumber) = 0
                    Else
                        Array_pct_in(ObjNumber) = ObjValue
                    End If
                    
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SOL_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                   ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_out(ObjNumber) = 0
                    Else
                         Array_pct_out(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASUR_SEC_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = obj.value
                    If ObjValue = "" Then
                        Array_pct_secure(ObjNumber) = 0
                    Else
                        Array_pct_secure(ObjNumber) = ObjValue
                    End If
                End If
                    
            
            End If
         Next obj
    
    End If

Next PageTab


Dim counter As Double


For counter = 0 To 9
    Array_am_ul(counter) = Array_am_pr(counter) + Array_am_in(counter) - Array_am_out(counter) + Array_am_secure(counter)
    Array_val_ul(counter) = Array_val_pr(counter) + Array_val_in(counter) - Array_val_out(counter) + Array_val_secure(counter)
    Array_pct_ul(counter) = Array_pct_pr(counter) + Array_pct_in(counter) - Array_pct_out(counter) + Array_pct_secure(counter)
Next




For Each PageTab In FrmTreasure.PgSubVar.Pages
       
            For Each obj In PageTab.Controls
                If obj.Visible = True Then
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_NUMBER") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_am_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_VALUE") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_val_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASUR_POR_PCT") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_pct_ul(ObjNumber))
                    End If
                End If
            Next obj
Next PageTab




Dim Sum_am_pr As Double
Dim Sum_am_in As Double
Dim Sum_am_out As Double
Dim Sum_am_secure As Double
Dim Sum_am_ul As Double

Dim Sum_val_pr As Double
Dim Sum_val_in As Double
Dim Sum_val_out As Double
Dim Sum_val_secure As Double
Dim Sum_val_ul As Double

Dim Sum_pct_pr As Double
Dim Sum_pct_in As Double
Dim Sum_pct_out As Double
Dim Sum_pct_secure As Double
Dim Sum_pct_ul As Double

For counter = 0 To 9
    Sum_am_pr = Sum_am_pr + Array_am_pr(counter)
    Sum_am_in = Sum_am_in + Array_am_in(counter)
    Sum_am_out = Sum_am_out + Array_am_out(counter)
    Sum_am_secure = Sum_am_secure + Array_am_secure(counter)
    Sum_am_ul = Sum_am_ul + Array_am_ul(counter)

    Sum_val_pr = Sum_val_pr + Array_val_pr(counter)
    Sum_val_in = Sum_val_in + Array_val_in(counter)
    Sum_val_out = Sum_val_out + Array_val_out(counter)
    Sum_val_secure = Sum_val_secure + Array_val_secure(counter)
    Sum_val_ul = Sum_val_ul + Array_val_ul(counter)

    Sum_pct_pr = Sum_pct_pr + Array_pct_pr(counter)
    Sum_pct_in = Sum_pct_in + Array_pct_in(counter)
    Sum_pct_out = Sum_pct_out + Array_pct_out(counter)
    Sum_pct_secure = Sum_pct_secure + Array_pct_secure(counter)
    Sum_pct_ul = Sum_pct_ul + Array_pct_ul(counter)
Next
   
FrmTreasure.LblTot_S_Treasur_Primo_Number.Caption = DecSep(Sum_am_pr)
FrmTreasure.LblTot_S_Treasur_Primo_Value.Caption = DecSep(Sum_val_pr)
FrmTreasure.LblTot_S_Treasur_Primo_Pct.Caption = Sum_pct_pr
   
FrmTreasure.LblTot_S_Treasur_Acq_Number.Caption = DecSep(Sum_am_in)
FrmTreasure.LblTot_S_Treasur_Acq_Value.Caption = DecSep(Sum_val_in)
FrmTreasure.LblTot_S_Treasur_Acq_Pct.Caption = Sum_pct_in

FrmTreasure.LblTot_S_Treasur_Sol_Number.Caption = DecSep(Sum_am_out)
FrmTreasure.LblTot_S_Treasur_Sol_Value.Caption = DecSep(Sum_val_out)
FrmTreasure.LblTot_S_Treasur_Sol_Pct.Caption = Sum_pct_out

FrmTreasure.LblTot_S_Treasur_Sec_Number.Caption = DecSep(Sum_am_secure)
FrmTreasure.LblTot_S_Treasur_Sec_Value.Caption = DecSep(Sum_val_secure)
FrmTreasure.LblTot_S_Treasur_Sec_Pct.Caption = Sum_pct_secure

FrmTreasure.LblTot_S_Treasur_Por_Number.Caption = DecSep(Sum_am_ul)
FrmTreasure.LblTot_S_Treasur_Por_Value.Caption = DecSep(Sum_val_ul)
FrmTreasure.LblTot_S_Treasur_Por_Pct.Caption = Sum_pct_ul
   Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"

End Sub



'BEPE calculation of TreasureSub froms
Sub CalculateSum_TreSubForm_SUB()

'insert name
Dim AktieA, AktieB, AktieC, AktieD, AktieE, AktieF, AktieG, AktieH, AktieI, AktieJ As String

On Error GoTo Errorhandler

AktieA = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_01.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_01.Caption = AktieA
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_01.Caption = AktieA
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_01.Caption = AktieA
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_01.Caption = AktieA


AktieB = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_02.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_02.Caption = AktieB
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_02.Caption = AktieB
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_02.Caption = AktieB
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_02.Caption = AktieB

AktieC = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_03.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_03.Caption = AktieC
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_03.Caption = AktieC
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_03.Caption = AktieC
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_03.Caption = AktieC

AktieD = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_04.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_04.Caption = AktieD
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_04.Caption = AktieD
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_04.Caption = AktieD
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_04.Caption = AktieD

AktieE = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_05.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_05.Caption = AktieE
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_05.Caption = AktieE
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_05.Caption = AktieE
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_05.Caption = AktieE

AktieF = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_06.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_06.Caption = AktieF
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_06.Caption = AktieF
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_06.Caption = AktieF
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_06.Caption = AktieF

AktieG = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_07.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_07.Caption = AktieG
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_07.Caption = AktieG
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_07.Caption = AktieG
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_07.Caption = AktieG

AktieH = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_08.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_08.Caption = AktieH
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_08.Caption = AktieH
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_08.Caption = AktieH
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_08.Caption = AktieH

AktieI = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_09.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_09.Caption = AktieI
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_09.Caption = AktieI
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_09.Caption = AktieI
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_09.Caption = AktieI

AktieJ = FrmTreasureSub.TxtStr_S_TreasSub_Primo_Navn_10.value
FrmTreasureSub.LblStr_S_TreasSub_Acq_Navn_10.Caption = AktieJ
FrmTreasureSub.LblStr_S_TreasSub_Sol_Navn_10.Caption = AktieJ
FrmTreasureSub.LblStr_S_TreasSub_Sec_Navn_10.Caption = AktieJ
FrmTreasureSub.LblStr_S_TreasSub_Por_Navn_10.Caption = AktieJ

'calculated amount af treasur
Dim Array_am_pr(9) As Double
Dim Array_am_in(9) As Double
Dim Array_am_out(9) As Double
Dim Array_am_secure(9) As Double
Dim Array_am_ul(9) As Double

Dim Array_val_pr(9) As Double
Dim Array_val_in(9) As Double
Dim Array_val_out(9) As Double
Dim Array_val_secure(9) As Double
Dim Array_val_ul(9) As Double

Dim Array_pct_pr(9) As Double
Dim Array_pct_in(9) As Double
Dim Array_pct_out(9) As Double
Dim Array_pct_secure(9) As Double
Dim Array_pct_ul(9) As Double

Dim obj
Dim TabObj
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr
Dim ObjNumber
Dim ObjValue

For Each PageTab In FrmTreasureSub.PgSubVar.Pages
    If PageTab.Visible = True Then
         For Each obj In PageTab.Controls
            
            If obj.Visible = True Then
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_PRIMO_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_ACQ_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SOL_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SEC_NUMBER") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_am_secure(ObjNumber) = ObjValue
                End If
                
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_PRIMO_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_pr(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_ACQ_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_in(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SOL_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_out(ObjNumber) = ObjValue
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SEC_VALUE") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    Array_val_secure(ObjNumber) = ObjValue
                End If
            
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_PRIMO_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    If ObjValue = "" Then
                        Array_pct_pr(ObjNumber) = 0
                    Else
                         Array_pct_pr(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_ACQ_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    If ObjValue = "" Then
                        Array_pct_in(ObjNumber) = 0
                    Else
                          Array_pct_in(ObjNumber) = ObjValue
                    End If
                    
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SOL_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    If ObjValue = "" Then
                        Array_pct_out(ObjNumber) = 0
                    Else
                          Array_pct_out(ObjNumber) = ObjValue
                    End If
                End If
                If InStr(1, UCase(obj.Name), "TXTINT_S_TREASSUB_SEC_PCT") > 0 Then
                    ObjNumber = Right(obj.Name, 2) - 1
                    ObjValue = ConvStrToNumb(obj.value, obj.Name)
                    If ObjValue = "" Then
                        Array_pct_secure(ObjNumber) = 0
                    Else
                          Array_pct_secure(ObjNumber) = ObjValue
                    End If
                End If
                    
            
            End If
         Next obj
    
    End If

Next PageTab



'calculated ultimo

For counter = 0 To 9
    Array_am_ul(counter) = Array_am_pr(counter) + Array_am_in(counter) - Array_am_out(counter) + Array_am_secure(counter)
    Array_val_ul(counter) = Array_val_pr(counter) + Array_val_in(counter) - Array_val_out(counter) + Array_val_secure(counter)
    Array_pct_ul(counter) = Array_pct_pr(counter) + Array_pct_in(counter) - Array_pct_out(counter) + Array_pct_secure(counter)
Next
For Each PageTab In FrmTreasureSub.PgSubVar.Pages
       
            For Each obj In PageTab.Controls
                If obj.Visible = True Then
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASSUB_POR_NUMBER") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_am_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASSUB_POR_VALUE") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_val_ul(ObjNumber))
                    End If
                    If InStr(1, UCase(obj.Name), "LBLINT_S_TREASSUB_POR_PCT") > 0 Then
                        ObjValue = ConvStrToNumb(obj.Caption, obj.Name)
                        ObjNumber = Right(obj.Name, 2) - 1
                        obj.Caption = DecSep(Array_pct_ul(ObjNumber))
                    End If
                End If
            Next obj
Next PageTab




Dim Sum_am_pr As Double
Dim Sum_am_in As Double
Dim Sum_am_out As Double
Dim Sum_am_secure As Double
Dim Sum_am_ul As Double

Dim Sum_val_pr As Double
Dim Sum_val_in As Double
Dim Sum_val_out As Double
Dim Sum_val_secure As Double
Dim Sum_val_ul As Double

Dim Sum_pct_pr As Double
Dim Sum_pct_in As Double
Dim Sum_pct_out As Double
Dim Sum_pct_secure As Double
Dim Sum_pct_ul As Double

For counter = 0 To 9
    Sum_am_pr = Sum_am_pr + Array_am_pr(counter)
    Sum_am_in = Sum_am_in + Array_am_in(counter)
    Sum_am_out = Sum_am_out + Array_am_out(counter)
    Sum_am_secure = Sum_am_secure + Array_am_secure(counter)
    Sum_am_ul = Sum_am_ul + Array_am_ul(counter)

    Sum_val_pr = Sum_val_pr + Array_val_pr(counter)
    Sum_val_in = Sum_val_in + Array_val_in(counter)
    Sum_val_out = Sum_val_out + Array_val_out(counter)
    Sum_val_secure = Sum_val_secure + Array_val_secure(counter)
    Sum_val_ul = Sum_val_ul + Array_val_ul(counter)

    Sum_pct_pr = Sum_pct_pr + Array_pct_pr(counter)
    Sum_pct_in = Sum_pct_in + Array_pct_in(counter)
    Sum_pct_out = Sum_pct_out + Array_pct_out(counter)
    Sum_pct_secure = Sum_pct_secure + Array_pct_secure(counter)
    Sum_pct_ul = Sum_pct_ul + Array_pct_ul(counter)
Next
   
FrmTreasureSub.LblTot_S_TreasSub_Primo_Number.Caption = DecSep(Sum_am_pr)
FrmTreasureSub.LblTot_S_TreasSub_Primo_Value.Caption = DecSep(Sum_val_pr)
FrmTreasureSub.LblTot_S_TreasSub_Primo_Pct.Caption = Sum_pct_pr
   
FrmTreasureSub.LblTot_S_TreasSub_Acq_Number.Caption = DecSep(Sum_am_in)
FrmTreasureSub.LblTot_S_TreasSub_Acq_Value.Caption = DecSep(Sum_val_in)
FrmTreasureSub.LblTot_S_TreasSub_Acq_Pct.Caption = Sum_pct_in

FrmTreasureSub.LblTot_S_TreasSub_Sol_Number.Caption = DecSep(Sum_am_out)
FrmTreasureSub.LblTot_S_TreasSub_Sol_Value.Caption = DecSep(Sum_val_out)
FrmTreasureSub.LblTot_S_TreasSub_Sol_Pct.Caption = Sum_pct_out

FrmTreasureSub.LblTot_S_TreasSub_Sec_Number.Caption = DecSep(Sum_am_secure)
FrmTreasureSub.LblTot_S_TreasSub_Sec_Value.Caption = DecSep(Sum_val_secure)
FrmTreasureSub.LblTot_S_TreasSub_Sec_Pct.Caption = Sum_pct_secure

FrmTreasureSub.LblTot_S_TreasSub_Por_Number.Caption = DecSep(Sum_am_ul)
FrmTreasureSub.LblTot_S_TreasSub_Por_Value.Caption = DecSep(Sum_val_ul)
FrmTreasureSub.LblTot_S_TreasSub_Por_Pct.Caption = Sum_pct_ul
 Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"
        
End Sub

'beregner Cashflow
Sub CalculateSum_KasSubForm()

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr

For Each PageTab In FrmCashFlow.PgSubVar.Pages

If PageTab.Visible = True Then

     Dim FormatTot
   
    'Beoordeling totalen
    
    Dim TbTotValue
    Dim TabObjName
    For Each obj In PageTab.Controls
          
       
        If obj.Visible = True Then
    
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                    Next TabObj
                
                    End If 'LBLTOT > 0
            
            End If 'Object visible or not
        
        Next obj
    
        
        PageNr = PageNr + 1
    
    End If 'PageTab visible or not
Next PageTab

'indsat af BEPE DK
Dim LblSum_MG_Kasstr_Ind_CY_03_kon As Double
LblSum_MG_Kasstr_Ind_CY_03_kon = ConvStrToNumb(FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_03.Caption, "")

Dim TxtInt_MG_Kasstr_Ind_CY_G_01_kon As Double
TxtInt_MG_Kasstr_Ind_CY_G_01_kon = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_G_01.value, "")

Dim TxtInt_MG_Kasstr_Ind_CY_F_01_kon As Double
TxtInt_MG_Kasstr_Ind_CY_F_01_kon = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_F_01.value, "")
FrmCashFlow.LblSum_MG_Kasstr_LIK_SUM_CY.Caption = DecSep(TxtInt_MG_Kasstr_Ind_CY_G_01_kon + LblSum_MG_Kasstr_Ind_CY_03_kon + TxtInt_MG_Kasstr_Ind_CY_F_01_kon)

Dim LblSum_MG_Kasstr_Ind_PY_03_kon As Double
LblSum_MG_Kasstr_Ind_PY_03_kon = ConvStrToNumb(FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_03.Caption, "")

Dim TxtInt_MG_Kasstr_Ind_PY_G_01_kon As Double
TxtInt_MG_Kasstr_Ind_PY_G_01_kon = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_G_01.value, "")

Dim TxtInt_MG_Kasstr_Ind_PY_F_01_kon As Double
TxtInt_MG_Kasstr_Ind_PY_F_01_kon = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_F_01.value, "")

FrmCashFlow.LblSum_MG_Kasstr_LIK_SUM_PY.Caption = DecSep(TxtInt_MG_Kasstr_Ind_PY_G_01_kon + LblSum_MG_Kasstr_Ind_PY_03_kon + TxtInt_MG_Kasstr_Ind_PY_F_01_kon)
Application.StatusBar = ""
End Sub

'beregner Cashflow (konsolideret)
Sub CalculateSum_KasSubForm_C()

Dim obj As control
Dim TabObj As control
Dim NewValue
Dim PageTab
Dim SumTot
Dim PageNr

On Error GoTo Errorhandler

For Each PageTab In FrmKonCashFlow.MultiPage1.Pages

If PageTab.Visible = True Then

     Dim FormatTot
   
    'Beoordeling totalen
    
    Dim TbTotValue
    Dim TabObjName
    For Each obj In PageTab.Controls
    
        If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    
                    Exit Sub
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                   
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
        End If
          
       
        If obj.Visible = True Then
    
            If InStr(1, UCase(obj.Name), "LBLTOT_") > 0 Then
                SumTot = 0
                Application.StatusBar = obj.Name
                
                For Each TabObj In PageTab.Controls
                    
                    'optellen van edit boxen
                    If InStr(1, UCase(TabObj.Name), Mid(UCase(obj.Name), 8, 100) & "_") > 0 And UCase(TabObj.Name) <> UCase(obj.Name) Then
                    
                        If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                        
                        If InStr(1, UCase(TabObj.Name), "LBLSOM") > 0 Or InStr(1, UCase(TabObj.Name), "LBLSUM") > 0 Then

                            ObjValue = ConvStrToNumb(TabObj.value, TabObj.Name)
                            SumTot = SumTot + val(ObjValue)
                        
                        End If
                    
                    End If
                    
                    FormatTot = DecSep(SumTot)
                    If FormatTot = "" Then FormatTot = "0"
                    obj.Caption = FormatTot
                    
                                        
                    Next TabObj
                
                    End If 'LBLTOT > 0
            
            End If 'Object visible or not
        
        Next obj
    
        
        PageNr = PageNr + 1
    
    End If 'PageTab visible or not
Next PageTab

'indsat af BEPE DK
Dim LblSum_MG_C_Kasstr_Ind_CY_03_kon As Double
LblSum_MG_C_Kasstr_Ind_CY_03_kon = ConvStrToNumb(FrmKonCashFlow.LblSum_MG_C_Kasstr_Ind_CY_03.Caption, "")

Dim TxtInt_MG_C_Kasstr_Ind_CY_G_01_kon As Double
TxtInt_MG_C_Kasstr_Ind_CY_G_01_kon = ConvStrToNumb(FrmKonCashFlow.TxtInt_MG_C_Kasstr_Ind_CY_G_01.value, "")

Dim TxtInt_MG_C_Kasstr_Ind_CY_F_01_kon As Double
TxtInt_MG_C_Kasstr_Ind_CY_F_01_kon = ConvStrToNumb(FrmKonCashFlow.TxtInt_MG_C_Kasstr_Ind_CY_F_01.value, "")
FrmKonCashFlow.LblSum_MG_C_Kasstr_LIK_SUM_CY.Caption = DecSep(TxtInt_MG_C_Kasstr_Ind_CY_G_01_kon + LblSum_MG_C_Kasstr_Ind_CY_03_kon + TxtInt_MG_C_Kasstr_Ind_CY_F_01_kon)

Dim LblSum_MG_C_Kasstr_Ind_PY_03_kon As Double
LblSum_MG_C_Kasstr_Ind_PY_03_kon = ConvStrToNumb(FrmKonCashFlow.LblSum_MG_C_Kasstr_Ind_PY_03.Caption, "")

Dim TxtInt_MG_C_Kasstr_Ind_PY_G_01_kon As Double
TxtInt_MG_C_Kasstr_Ind_PY_G_01_kon = ConvStrToNumb(FrmKonCashFlow.TxtInt_MG_C_Kasstr_Ind_PY_G_01.value, "")

Dim TxtInt_MG_C_Kasstr_Ind_PY_F_01_kon As Double
TxtInt_MG_C_Kasstr_Ind_PY_F_01_kon = ConvStrToNumb(FrmKonCashFlow.TxtInt_MG_C_Kasstr_Ind_PY_F_01.value, "")

FrmKonCashFlow.LblSum_MG_C_Kasstr_LIK_SUM_PY.Caption = DecSep(TxtInt_MG_C_Kasstr_Ind_PY_G_01_kon + LblSum_MG_C_Kasstr_Ind_PY_03_kon + TxtInt_MG_C_Kasstr_Ind_PY_F_01_kon)
Application.StatusBar = ""
Exit Sub
Errorhandler:
MsgBox "Fejl: Beregning kunne ikke gennemsf|fffd|res"
End Sub

Attribute VB_Name = "Controlcells"
Sub ChkForcedBox(Optional ByVal flag As Boolean)

    'Controle of forced velden (met name van eerste tabblad) gevuld zijn
    Dim obj As control
    Dim FoundErr As Boolean
    Dim FoundErr_2 As Boolean

    Dim ChkArrTxt()
    Dim ChkArrLbl()
    ChkArrTxt = Array(FrmDocVariables.TxtStr_DocVar_NameClient.Text, _
                    FrmDocVariables.LstInt_CURR.Text, _
                    FrmDocVariables.LstInt_ROUNDCY.Text, _
                    FrmDocVariables.LstInt_ROUNDPY.Text, _
                    FrmDocVariables.LstInt_GROSS.Text, _
                    FrmDocVariables.TxtStr_DocVar_FirstDay.Text, _
                    FrmDocVariables.TxtStr_DocVar_LastDay.Text, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_Street.Text, FrmDocVariables.TxtStr_S_CompDet_Comp_StreetNum.Text, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_PostCity.Text, FrmDocVariables.TxtStr_S_CompDet_Comp_Post.Text, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.Text, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_Registered.Text, _
                    FrmDocVariables.TxtDat_BeginDate_PY.Text, FrmDocVariables.TxtDat_BeginDate_PY_1.Text, FrmDocVariables.TxtDat_BeginDate_PY_2.Text, FrmDocVariables.TxtDat_BeginDate_PY_3.Text, FrmDocVariables.TxtDat_BeginDate_PY_4.Text, _
                    FrmDocVariables.TxtDat_EndDate_PY.Text, FrmDocVariables.TxtDat_EndDate_PY_1.Text, FrmDocVariables.TxtDat_EndDate_PY_2.Text, FrmDocVariables.TxtDat_EndDate_PY_3.Text, FrmDocVariables.TxtDat_EndDate_PY_4.Text, _
                    FrmDocVariables.TxtStr_RegData_Virksomhedsnavn1.Text, FrmDocVariables.TxtStr_RegData_CVR.Text, FrmDocVariables.TxtStr_RegData_Adresse.Text, FrmDocVariables.TxtStr_RegData_Adresse_num.Text, FrmDocVariables.TxtStr_RegData_PostNr.Text, FrmDocVariables.TxtStr_RegData_PostBy.Text)

ChkArrCell = Array(FrmDocVariables.TxtStr_DocVar_NameClient, _
                    FrmDocVariables.LstInt_CURR, _
                    FrmDocVariables.LstInt_ROUNDCY, _
                    FrmDocVariables.LstInt_ROUNDPY, _
                    FrmDocVariables.LstInt_GROSS, _
                    FrmDocVariables.TxtStr_DocVar_FirstDay, _
                    FrmDocVariables.TxtStr_DocVar_LastDay, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_Street, FrmDocVariables.TxtStr_S_CompDet_Comp_StreetNum, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_PostCity, FrmDocVariables.TxtStr_S_CompDet_Comp_Post, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_CBR, _
                    FrmDocVariables.TxtStr_S_CompDet_Comp_Registered, _
                    FrmDocVariables.TxtDat_BeginDate_PY, FrmDocVariables.TxtDat_BeginDate_PY_1, FrmDocVariables.TxtDat_BeginDate_PY_2, FrmDocVariables.TxtDat_BeginDate_PY_3, FrmDocVariables.TxtDat_BeginDate_PY_4, _
                    FrmDocVariables.TxtDat_EndDate_PY, FrmDocVariables.TxtDat_EndDate_PY_1, FrmDocVariables.TxtDat_EndDate_PY_2, FrmDocVariables.TxtDat_EndDate_PY_3, FrmDocVariables.TxtDat_EndDate_PY_4, _
                    FrmDocVariables.TxtStr_RegData_Virksomhedsnavn1, FrmDocVariables.TxtStr_RegData_CVR, FrmDocVariables.TxtStr_RegData_Adresse, FrmDocVariables.TxtStr_RegData_Adresse_num, FrmDocVariables.TxtStr_RegData_PostNr, FrmDocVariables.TxtStr_RegData_PostBy)




    ChkArrLbl = Array(FrmDocVariables.Lbl_PgDocVarForced01, _
                    FrmDocVariables.Lbl_PgDocVarForced02, _
                    FrmDocVariables.Lbl_PgDocVarForced03, _
                    FrmDocVariables.Lbl_PgDocVarForced04, _
                    FrmDocVariables.Lbl_PgDocVarForced05, _
                    FrmDocVariables.Lbl_PgDocVarForced06, _
                    FrmDocVariables.Lbl_PgDocVarForced07, _
                    FrmDocVariables.Lbl_PgDocVarForced15, FrmDocVariables.Lbl_PgDocVarForced15, _
                    FrmDocVariables.Lbl_PgDocVarForced16, FrmDocVariables.Lbl_PgDocVarForced16, _
                    FrmDocVariables.Lbl_PgDocVarForced17, _
                    FrmDocVariables.Lbl_PgDocVarForced18, _
                    FrmDocVariables.Lbl_PgDocVarForced06, FrmDocVariables.Lbl_PgDocVarForced06, FrmDocVariables.Lbl_PgDocVarForced06, FrmDocVariables.Lbl_PgDocVarForced06, FrmDocVariables.Lbl_PgDocVarForced06, _
                    FrmDocVariables.Lbl_PgDocVarForced07, FrmDocVariables.Lbl_PgDocVarForced07, FrmDocVariables.Lbl_PgDocVarForced07, FrmDocVariables.Lbl_PgDocVarForced07, FrmDocVariables.Lbl_PgDocVarForced07, _
                    FrmDocVariables.Lbl_PgDocVarForced40, FrmDocVariables.Lbl_PgDocVarForced42, FrmDocVariables.Lbl_PgDocVarForced43, FrmDocVariables.Lbl_PgDocVarForced43, FrmDocVariables.Lbl_PgDocVarForced43, FrmDocVariables.Lbl_PgDocVarForced43)

        FoundErr = False
'   jj = FrmDocVariables.ActiveControl.Name
    'Add by BEPE, reset the color
'    If flag Then 'ej ved opning af forms, kun ved |fffd|ndring
'    Else
'    For x = 0 To UBound(ChkArrLbl)
'        ChkArrLbl(x).ForeColor = vbBlack
'    Next
'    End If
    For X = 0 To UBound(ChkArrLbl)
        If ChkArrLbl(X).Visible = True And ChkArrTxt(X) = "" Then
            'ChkArrLbl(x).ForeColor = vbRed
            ChkArrCell(X).BackColor = vbActiveTitleBar
            FoundErr = True
        Else
           'Changed by BEPE, are using the reset funktion insted
           'ChkArrLbl(x).ForeColor = vbBlue
           ChkArrCell(X).BackColor = vbInactiveBorder
        End If
        If ChkArrCell(X).Tag <> "" Then
            FoundErr = True
            ChkArrCell(X).BackColor = vbRed
        End If
    Next

    'kontroller at forudfyldning er ersattet ellers forbliver caption r|fffd|d
    '  is information contrains information, from the start and most be refilled before the XBRl report is vaild
    If FrmDocVariables.TxtStr_DocVar_NameClient.value = "Kundenavn" Then
        FrmDocVariables.TxtStr_DocVar_NameClient.BackColor = vbActiveTitleBar
        FoundErr = True
    End If
    If FrmDocVariables.TxtStr_S_CompDet_Comp_Street.value = "Adresse" Then
        FrmDocVariables.TxtStr_S_CompDet_Comp_Street.BackColor = vbActiveTitleBar
        FoundErr = True
    End If
    If FrmDocVariables.TxtStr_S_CompDet_Comp_PostCity.value = "XXXX By" Then
        FrmDocVariables.TxtStr_S_CompDet_Comp_PostCity.BackColor = vbActiveTitleBar
        FoundErr = True
    End If

    cell_val = ContentControl_CVR(FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.value)
    If cell_val = "" Then
        FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.BackColor = vbActiveTitleBar
        FoundErr = True
    ElseIf cell_val = False Then
        FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.BackColor = vbActiveTitleBar
        FoundErr = True
    Else
        FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.BackColor = vbInactiveBorder
        FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.value = cell_val
    End If

    If FrmDocVariables.TxtStr_S_CompDet_Comp_Registered.value = "Hjemsted" Or FrmDocVariables.TxtStr_S_CompDet_Comp_Registered.value = "Registreret i (Sted)" Then
        FrmDocVariables.TxtStr_S_CompDet_Comp_Registered.BackColor = vbActiveTitleBar
        FoundErr = True
    End If
    
    
    'ANden revisor
    If FrmDocVariables.TxtStr_DocVar_AudiRep_Name_01_2AUD.value <> "" Then
        FrmDocVariables.TxtStr_DocVar_AudiRep_Name_01.BackColor = vbInactiveBorder
    Else
        If FrmDocVariables.TxtStr_DocVar_AudiRep_Name_01.value = "Underskrivende revisor 1" Or FrmDocVariables.TxtStr_DocVar_AudiRep_Name_01.value = "" Then
            FrmDocVariables.TxtStr_DocVar_AudiRep_Name_01.BackColor = vbActiveTitleBar
            FoundErr = True
        End If
    End If
    
    If FrmDocVariables.TxtStr_DocVar_AudiRep_Title_01_2AUD.value <> "" Then
        FrmDocVariables.TxtStr_DocVar_AudiRep_Title_01.BackColor = vbInactiveBorder
    Else
        If FrmDocVariables.TxtStr_DocVar_AudiRep_Title_01.value = "" Then
            FrmDocVariables.TxtStr_DocVar_AudiRep_Title_01.BackColor = vbActiveTitleBar
            FoundErr = True
        End If
    End If
    
    

    cell_val = ContentControl_CVR(FrmDocVariables.TxtStr_RegData_CVR.value)
    If cell_val = "" Then
        FrmDocVariables.TxtStr_RegData_CVR.BackColor = vbActiveTitleBar
        FoundErr = True
    ElseIf cell_val = False Then
        FrmDocVariables.TxtStr_RegData_CVR.BackColor = vbActiveTitleBar
        FoundErr = True
    Else
        FrmDocVariables.TxtStr_RegData_CVR.BackColor = vbInactiveBorder
        FrmDocVariables.TxtStr_RegData_CVR.value = cell_val
    End If

    

    Dim ValueChk As Boolean
    ValueChk = FrmDocVariables.ChkBoo_S_CompDet_Annual.value
    If ValueChk Then
        If FrmDocVariables.TxtStr_S_CompDet_Annual_Text.value = "" Then
        FoundErr_2 = True
        FrmDocVariables.TxtStr_S_CompDet_Annual_Text.BackColor = vbActiveTitleBar
        Else
        FrmDocVariables.TxtStr_S_CompDet_Annual_Text.BackColor = vbInactiveBorder
        End If
    End If

  

    'XBRL clinten email
    cell_val = FrmDocVariables.TxtStr_XBRL_Email.value
    If cell_val = "" Then
        FrmDocVariables.TxtStr_XBRL_Email.BackColor = vbActiveTitleBar
        FoundErr_2 = True
    Else
        FrmDocVariables.TxtStr_XBRL_Email.BackColor = vbInactiveBorder
    End If
    
    'XBRL info
    cell_val = FrmDocVariables.LstInt_FUNDS.value
    If cell_val = "" Then
        FrmDocVariables.LstInt_FUNDS.BackColor = vbActiveTitleBar
        FoundErr_2 = True
    Else
        FrmDocVariables.LstInt_FUNDS.BackColor = vbInactiveBorder
    End If
    
    cell_val = FrmDocVariables.LstInt_CLASS_CD.value
    If cell_val = "" Then
        FrmDocVariables.LstInt_CLASS_CD.BackColor = vbActiveTitleBar
        FoundErr_2 = True
    Else
        FrmDocVariables.LstInt_CLASS_CD.BackColor = vbInactiveBorder
    End If
    

'
    'add Bepe info about XBRL validation
    If FoundErr = True Then
        ' Required information are missing, before XBRL report is valid
        FrmDocVariables.Info_XBRL.Caption = "|fffd|rsrapport mangler obligatoriske oplysninger for digital indsendelse til ERST."
        FrmDocVariables.Info_XBRL.ForeColor = vbRed
    Else
        FrmDocVariables.Info_XBRL.Caption = "|fffd|rsrapport er klar til digital indsendelse til ERST."
        FrmDocVariables.Info_XBRL.ForeColor = vbBlue
    End If
    
End Sub



Attribute VB_Name = "Controls_subforms"
Sub Subform_Value()

Dim ControlsNames()
Dim pos_nr As Integer
pos_nr = 0
For Each PageTab In FrmDocVariables.MultiPage1.Pages

    If PageTab.Visible And PageTab.Tag = "CONTROL_SUB" Then
        
        ReDim Preserve ControlsNames(1, pos_nr)
        ControlsNames(0, pos_nr) = PageTab.Name
        ControlsNames(1, pos_nr) = False
        pos_nr = pos_nr + 1
                   
    End If
    
Next PageTab

For Each cdp In ActiveDocument.CustomDocumentProperties
        
      If InStr(1, UCase(cdp.Name), "TXTINT_") > 0 And InStr(1, UCase(cdp.Name), "PGDOCVAR") = 0 Then
        For a_counter = 0 To pos_nr - 1
            PG_name = Replace(ControlsNames(0, a_counter), "PgDocVar", "")
            
            If InStr(1, LCase(cdp.Name), LCase(PG_name)) > 0 Then
                ControlsNames(1, a_counter) = True
            End If
        Next a_counter
        
       End If
          
       'Undtagelse 1: kapitalandel anl|fffd|g om oms|fffd|tning
       
       If (InStr(1, UCase(cdp.Name), "TXTSTR_S_FAI_") > 0 Or InStr(1, UCase(cdp.Name), "TXTSTR_S_INV_") > 0) And InStr(1, UCase(cdp.Name), "PGDOCVAR") = 0 And InStr(1, UCase(cdp.Name), "TXTSTR_S_FAI_ISKS_DS") = 0 And InStr(1, UCase(cdp.Name), "TXTSTR_S_INV_ISKS_DS") = 0 Then
       For a_counter = 0 To pos_nr - 1
            PG_name = Replace(ControlsNames(0, a_counter), "PgDocVar_", "")
           
            If InStr(1, LCase(cdp.Name), LCase(PG_name)) > 0 Then
                ControlsNames(1, a_counter) = True
                
            End If
        Next a_counter
        End If
        
        'Undtagelse 1: kapitalandel koncern
        If InStr(1, UCase(cdp.Name), "TXTSTR_C_FAI_") > 0 And InStr(1, UCase(cdp.Name), "PGDOCVAR") = 0 And InStr(1, UCase(cdp.Name), "TXTSTR_S_FAI_ISKS_DS") = 0 Then
        For a_counter = 0 To pos_nr - 1
            PG_name = Replace(ControlsNames(0, a_counter), "PgDocVar_", "")
           
            If InStr(1, LCase(cdp.Name), LCase(PG_name)) > 0 Then
                ControlsNames(1, a_counter) = True
                
            End If
        Next a_counter
        End If
        
        'Undtagelse 2: Anl|fffd|gsaktiver Moder og koncern
        If InStr(1, UCase(cdp.Name), "DIFFREVAL_") > 0 Or InStr(1, UCase(cdp.Name), "FINEXPBOOK_") > 0 Then
       For a_counter = 0 To pos_nr - 1
            PG_name = Replace(ControlsNames(0, a_counter), "PgDocVar", "")
            
            If InStr(1, "_E_FINASS", UCase(PG_name)) > 0 And InStr(1, UCase(cdp.Name), "_S_") > 0 Then
                ControlsNames(1, a_counter) = True
            End If
            If InStr(1, "_C_FINASS", UCase(PG_name)) > 0 And InStr(1, UCase(cdp.Name), "_C_") > 0 Then
                ControlsNames(1, a_counter) = True
            End If
        Next a_counter
       End If
       
       
       
Next cdp

' opdatere dummies felterne p|fffd| niveau I
For a_counter = 0 To pos_nr - 1
    PG_value = ControlsNames(1, a_counter)
    PG_name = ControlsNames(0, a_counter)
        For Each obj In FrmDocVariables.MultiPage1.Pages(PG_name).Controls
            If InStr(1, UCase(obj.Name), "TXTINT_") > 0 Then
                If InStr(1, UCase(obj.Name), UCase(PG_name)) > 0 Then
                    If PG_value Then
                        obj.value = 1
                    Else
                        obj.value = ""
                    End If
                End If
            End If
    
        Next obj
    
Next a_counter
End Sub
Attribute VB_Name = "DeloitteOffice"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private m_CompanyID As String
Private m_CompanyName As String
Private m_Phone As String
Private m_Fax As String
Private m_OfficeID As String
Private m_OfficeName As String
Private m_OfficeAddress As String
Private m_OfficeZip As String
Private m_OfficeCity As String
Private m_PostalAddress As String
Private m_PostalZip As String
Private m_PostalCity As String
Private m_Country As String
Private m_LegalName1 As String
Private m_LegalName2 As String
Private m_CVRNo As String
Private m_DisplayName As String

Public Property Get CompanyID() As String
    CompanyID = m_CompanyID
End Property
Public Property Let CompanyID(value As String)
    m_CompanyID = value
End Property

Public Property Get CompanyName() As String
    CompanyName = m_CompanyName
End Property
Public Property Let CompanyName(value As String)
    m_CompanyName = value
End Property

Public Property Get Phone() As String
    Phone = m_Phone
End Property
Public Property Let Phone(value As String)
    m_Phone = value
End Property

Public Property Get Fax() As String
    Fax = m_Fax
End Property
Public Property Let Fax(value As String)
    m_Fax = value
End Property

Public Property Get OfficeID() As String
    OfficeID = m_OfficeID
End Property
Public Property Let OfficeID(value As String)
    m_OfficeID = value
End Property

Public Property Get OfficeName() As String
    OfficeName = m_OfficeName
End Property
Public Property Let OfficeName(value As String)
    m_OfficeName = value
End Property

Public Property Get OfficeAddress() As String
    OfficeAddress = m_OfficeAddress
End Property
Public Property Let OfficeAddress(value As String)
    m_OfficeAddress = value
End Property

Public Property Get OfficeZip() As String
    OfficeZip = m_OfficeZip
End Property
Public Property Let OfficeZip(value As String)
    m_OfficeZip = value
End Property

Public Property Get OfficeCity() As String
    OfficeCity = m_OfficeCity
End Property
Public Property Let OfficeCity(value As String)
    m_OfficeCity = value
End Property

Public Property Get PostalAddress() As String
    PostalAddress = m_PostalAddress
End Property
Public Property Let PostalAddress(value As String)
    m_PostalAddress = value
End Property

Public Property Get PostalZip() As String
    PostalZip = m_PostalZip
End Property
Public Property Let PostalZip(value As String)
    m_PostalZip = value
End Property

Public Property Get PostalCity() As String
    PostalCity = m_PostalCity
End Property
Public Property Let PostalCity(value As String)
    m_PostalCity = value
End Property

Public Property Get Country() As String
    Country = m_Country
End Property
Public Property Let Country(value As String)
    m_Country = value
End Property

Public Property Get LegalName1() As String
    LegalName1 = m_LegalName1
End Property
Public Property Let LegalName1(value As String)
    m_LegalName1 = value
End Property

Public Property Get LegalName2() As String
    LegalName2 = m_LegalName2
End Property
Public Property Let LegalName2(value As String)
    m_LegalName2 = value
End Property

Public Property Get CVRNo() As String
    CVRNo = m_CVRNo
End Property
Public Property Let CVRNo(value As String)
    m_CVRNo = value
End Property

Public Property Get DisplayName() As String
    DisplayName = m_DisplayName
End Property
Public Property Let DisplayName(value As String)
    m_DisplayName = value
End Property


Attribute VB_Name = "ERST_Validations"

Sub ValidateButton()
    
    Dim validationItems() As ValidationResult
    Dim ValidationClient As New ValidationClient
    Dim Parent_Tab As MSForms.Page
    Dim LValue As String
    LValue = Format(Date, "dd/mm/yyyy")
    Dim InfoText As String
    Dim InfoText_Warring As String
    
    Dim InfoText_Info As String
    Dim InforText_Fail As String
    Dim Infotext_Advis As String
    Dim Severity_Type As String
    Dim Database_type As String ' test eller produktions
    Dim Severity_level As Integer
    
    ' todo: refresh CustomDocumentProperties before validating.
    
    On Error GoTo Errorhandler
    
    'validationItems = validationClient.ValidateDocumentProperties(FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.Text, ActiveDocument.CustomDocumentProperties)
    validationItems = ValidationClient.ValidateFormAndDocumentProperties( _
        FrmDocVariables.TxtStr_S_CompDet_Comp_CBR.Text, _
        FrmDocVariables, _
        ActiveDocument.CustomDocumentProperties)
    
    On Error GoTo 0
    
    If UBound(validationItems) = -1 Then
    
        ' no validation items returned at all
        FrmDocVariables.TxtStr_S_Advis_01.Text = ""
        FrmDocVariables.TxtStr_DB_Valider_info.Text = LValue + " OK"
        FrmDocVariables.TxtStr_ERST.value = LValue
        
    ElseIf UBound(validationItems) = 0 And validationItems(0).ValidationField = "" Then
        
        
        If LCase(validationItems(0).Message) = "identifier not found." Then
            MsgBox "Det indtastede CVR nummer findes ikke i databasen."
        Else
            MsgBox "Fejl ved validering: " & validationItems(0).Message
        End If
    ElseIf UBound(validationItems) > -1 Then
        Dim item As ValidationResult
        Dim validatedControl As control
        FrmDocVariables.TxtStr_S_Advis_01.Text = ""
        FrmDocVariables.TxtStr_DB_Valider_info.Text = ""
        FrmDocVariables.TxtStr_DB_Valider_info.Text = LValue
        InfoText_Info = "INFOMATION:" + vbNewLine
        InfoText_Warring = "WARRING: " + vbNewLine
        InforText_Fail = "Error:" + vbNewLine
        Severity_level = 0
        FrmDocVariables.MultiPage1.Pages("Pg_Status_I").Tag = "Warring"
        
     
        For i = 0 To UBound(validationItems)
            Set item = validationItems(i)
            
            Set validatedControl = find_ctrl(item.ValidationField)
            If Not validatedControl Is Nothing Then
                
                
                
                'handling
                If InStr(1, UCase(item.ValidationField), "_ADVIS_") > 0 Then
                    Infotext_Advis = Infotext_Advis + "ADVIS: " + item.Message + " Database: " + item.Data + vbNewLine
                    'InfoText = InfoText + "Advis: Se Status II" + vbNewLine
                    
                ElseIf item.Action = Check Then
                    validatedControl.BackColor = RGB(255, 255, 0) ' yellow
                    validatedControl.ControlTipText = item.Message
                   
                    
                    If InStr(1, UCase(item.ValidationField), "TXTSTR") > 0 Then
                        indhold = " DPT: " + validatedControl.Text
                    Else
                        indhold = ""
                    End If
'                    Set Parent_Tab = find_tab(validatedControl)
'                    Parent_Tab.Tag = "Check"
                    InfoText = item.Message + indhold + " Database: " + item.Data + vbNewLine
                    
                ElseIf item.Action = Fail Then
                    validatedControl.BackColor = RGB(255, 0, 0) ' red
                    validatedControl.ControlTipText = item.Message
                    
                    If InStr(1, UCase(item.ValidationField), "TXTSTR") > 0 Then
                        indhold = " DPT: " + validatedControl.Text
                    Else
                        indhold = ""
                    End If
                    Set Parent_Tab = find_tab(validatedControl)
                    Severity_Type = item.Severity
                    Parent_Tab.Tag = "Fail"
                    
                    InfoText = item.Message + " DPT: " + indhold + " Database: " + item.Data + vbNewLine
                    
                ElseIf item.Action = ReplaceValue Then
                    validatedControl.Text = item.Data
                    validatedControl.BackColor = RGB(0, 255, 0) ' green
                    validatedControl.ControlTipText = item.Message
                    InfoText = item.Message + vbNewLine
      
                ElseIf item.Action = Pass Then
                    validatedControl.BackColor = RGB(0, 255, 0) ' green
                    validatedControl.ControlTipText = ""
                End If
            End If
             
            'test besked i status II
            Severity_Type = item.Severity
            If Severity_Type = 0 Then
                InfoText_Info = InfoText_Info + InfoText
                FrmDocVariables.MultiPage1.Pages("Pg_Status_I").Tag = ""
                validatedControl.Tag = ""
            ElseIf Severity_Type = 2 Then
                InforText_Fail = InforText_Fail + InfoText
                Severity_level = 2
                FrmDocVariables.MultiPage1.Pages("Pg_Status_I").Tag = "Error"
                validatedControl.Tag = "Error"
            ElseIf Severity_Type = 1 Then
                InfoText_Warring = InfoText_Warring + InfoText
                If Severity_level = 0 Then
                Severity_level = 1
                FrmDocVariables.MultiPage1.Pages("Pg_Status_I").Tag = ""
                validatedControl.Tag = ""
                End If
            End If
        Next
        
        FrmDocVariables.TxtStr_S_Advis_01.Text = Infotext_Advis
        'Dato for validering
        
        FrmDocVariables.TxtStr_ERST.value = LValue
        
        ' Bested i status I
        'Indledning Dato - type (produktion, Username)
        FrmDocVariables.TxtStr_DB_Valider_info.Text = ""
        Database_type = ""
        If FrmDocVariables.ChkBoo_S_Stad_Validate.value Then Database_type = vbCrLf & "BEM|fffd|RK udf|fffd|rt i test milj|fffd|"
        InfoText = "Dato for seneste validering el. henting af data : " & Now & Database_type & vbCrLf
        FrmDocVariables.TxtStr_DB_Valider_info.Text = InfoText + InforText_Fail + InfoText_Warring + InfoText_Info
        
        'navigationsplanet
        CalculateSum
        ChkForcedBox
    End If
    
    Exit Sub
    
    
        
    
    
Errorhandler:
    
    FrmDocVariables.TxtStr_ERST.Enabled = False
    
    MsgBox "Fejl: Kontrollen kunne ikke gennemf|fffd|res. Kontrollere at der er netv|fffd|rksforbindelse. Hvis du ikke er p|fffd| et af Deloittes kontore skal VPN ogs|fffd| v|fffd|re tilsluttet."
End Sub

Private Sub CustomerNameButton_Click()
    If CustomerNameButton.Tag <> "" Then
        Kundenavn.Text = CustomerNameButton.Tag
        Message.Caption = ""
    End If
End Sub


Private Function find_ctrl(ctrl_name As String) As control

For Each ctrl In FrmDocVariables.Controls
If LCase(ctrl_name) = LCase(ctrl.Name) Then
    Set find_ctrl = ctrl
    Exit Function
End If
Next
End Function

Private Function find_tab(ctrl As control) As MSForms.Page
i = 0
Do While TypeName(ctrl) <> "Page"
    Set ctrl = ctrl.Parent
    i = i + 1
    If i = 10 Then Exit Do
Loop

Set find_tab = ctrl
End Function
Attribute VB_Name = "FinHigh"

Sub CalculateFinHigh()

For Each obj In FrmFinHigh.Controls
    'add by bepe,  validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
Next obj

'get information from cash flow:
proc_LblSum_KasstroomInd 'beregner CF

roundcy = FrmDocVariables.LstInt_ROUNDCY.value
roundpy = FrmDocVariables.LstInt_ROUNDPY.value
If roundcy = "x 1" Then roundcy = 1000
If roundcy = "x 1.000" Then roundcy = 1
If roundcy = "x 1.000.000" Then roundcy = 1

If roundpy = "x 1" Then roundpy = 1000
If roundpy = "x 1.000" Then roundpy = 1
If roundpy = "x 1.000.000" Then roundpy = 1


FrmFinHigh.LblInt_E_FinHigh_CFO_CY.Caption = LblSum_MG_Kasstr_Ind_CY_02_val / roundcy
FrmFinHigh.LblInt_E_FinHigh_CFO_CY1.Caption = LblSum_MG_Kasstr_Ind_PY_02_val / roundpy
FrmFinHigh.LblInt_E_FinHigh_CFI_CY.Caption = LblTot_MG_Kasstr_Ind_CY_D_val / roundcy
FrmFinHigh.LblInt_E_FinHigh_CFI_CY1.Caption = LblTot_MG_Kasstr_Ind_PY_D_val / roundpy
FrmFinHigh.LblInt_E_FinHigh_CFF_CY.Caption = LblTot_MG_Kasstr_Ind_CY_E_val / roundcy
FrmFinHigh.LblInt_E_FinHigh_CFF_CY1.Caption = LblTot_MG_Kasstr_Ind_PY_E_val / roundpy

Dim TB_Dummy
Dim Array_Revenue_UserInput(5)
Array_Revenue_UserInput(1) = ""
Array_Revenue_UserInput(2) = ""
Array_Revenue_UserInput(3) = FrmFinHigh.TxtInt_E_FinHigh_Revenue_CY2.value
Array_Revenue_UserInput(4) = FrmFinHigh.TxtInt_E_FinHigh_Revenue_CY3.value
Array_Revenue_UserInput(5) = FrmFinHigh.TxtInt_E_FinHigh_Revenue_CY4.value

Dim Array_Revenue_TbInput(5)
Array_Revenue_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Revenue_CY, "TB_Dummy")
Array_Revenue_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Revenue_PY, "TB_Dummy")
Array_Revenue_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Revenue_PY1, "TB_Dummy")
Array_Revenue_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Revenue_PY2, "TB_Dummy")
Array_Revenue_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Revenue_PY3, "TB_Dummy")

Dim Array_Revenue_InputData(5)
Dim counter As Integer
Dim obj_Name As String

For counter = 1 To 5
    
    obj_Name = "TxtInt_Indput_FinHigh_Revenue_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Revenue_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Revenue_UserInput(counter) = "" Then
        Array_Revenue_InputData(counter) = Array_Revenue_TbInput(counter)
        If Array_Revenue_TbInput(counter) <> "" And Array_Revenue_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Revenue_TbInput(counter)
    Else
        Array_Revenue_InputData(counter) = Array_Revenue_UserInput(counter)
        If Array_Revenue_UserInput(counter) <> "" And Array_Revenue_UserInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Revenue_UserInput(counter)
    End If
    
Next counter

Dim Array_GrossProfit_Userinput(5)
Dim Array_GrossProfit_TbInput(5)
Dim Array_GrossProfit_InputData(5)

Array_GrossProfit_Userinput(1) = ""
Array_GrossProfit_Userinput(2) = ""
Array_GrossProfit_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit_CY2.value
Array_GrossProfit_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit_CY3.value
Array_GrossProfit_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit_CY4.value

Array_GrossProfit_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit_CY, "TB_Dummy")
Array_GrossProfit_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit_PY, "TB_Dummy")
Array_GrossProfit_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit_PY1, "TB_Dummy")
Array_GrossProfit_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit_PY2, "TB_Dummy")
Array_GrossProfit_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit_PY3, "TB_Dummy")

counter = 0
For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_GrossProfit_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_GrossProfit_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_GrossProfit_Userinput(counter) = "" Then
        Array_GrossProfit_InputData(counter) = Array_GrossProfit_TbInput(counter)
        If Array_GrossProfit_TbInput(counter) <> "" And Array_GrossProfit_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_GrossProfit_TbInput(counter)
    Else
        Array_GrossProfit_InputData(counter) = Array_GrossProfit_Userinput(counter)
        If Array_GrossProfit_Userinput(counter) <> "" And Array_GrossProfit_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_GrossProfit_Userinput(counter)
    End If
Next counter

Dim Array_GrossProfit2_Userinput(5)
Dim Array_GrossProfit2_TbInput(5)
Dim Array_GrossProfit2_InputData(5)

Array_GrossProfit2_Userinput(1) = ""
Array_GrossProfit2_Userinput(2) = ""
Array_GrossProfit2_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit2_CY2.value
Array_GrossProfit2_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit2_CY3.value
Array_GrossProfit2_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_GrossProfit2_CY4.value

Array_GrossProfit2_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit2_CY, "TB_Dummy")
Array_GrossProfit2_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit2_PY, "TB_Dummy")
Array_GrossProfit2_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit2_PY1, "TB_Dummy")
Array_GrossProfit2_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit2_PY2, "TB_Dummy")
Array_GrossProfit2_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_GrossProfit2_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_GrossProfit2_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_GrossProfit2_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_GrossProfit2_Userinput(counter) = "" Then
        Array_GrossProfit2_InputData(counter) = Array_GrossProfit2_TbInput(counter)
        If Array_GrossProfit2_TbInput(counter) <> "" And Array_GrossProfit2_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_GrossProfit2_TbInput(counter)
    Else
        Array_GrossProfit2_InputData(counter) = Array_GrossProfit2_Userinput(counter)
        If Array_GrossProfit2_Userinput(counter) <> "" And Array_GrossProfit2_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_GrossProfit2_Userinput(counter)
    End If
Next counter

Dim Array_Operating_Userinput(5)
Dim Array_Operating_TbInput(5)
Dim Array_Operating_InputData(5)

Array_Operating_Userinput(1) = ""
Array_Operating_Userinput(2) = ""
Array_Operating_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_Operating_CY2.value
Array_Operating_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_Operating_CY3.value
Array_Operating_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_Operating_CY4.value

Array_Operating_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Operating_CY, "TB_Dummy")
Array_Operating_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Operating_PY, "TB_Dummy")
Array_Operating_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Operating_PY1, "TB_Dummy")
Array_Operating_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Operating_PY2, "TB_Dummy")
Array_Operating_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Operating_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_Operating_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Operating_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Operating_Userinput(counter) = "" Then
        Array_Operating_InputData(counter) = Array_Operating_TbInput(counter)
        If Array_Operating_TbInput(counter) <> "" And Array_Operating_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Operating_TbInput(counter)
    Else
        Array_Operating_InputData(counter) = Array_Operating_Userinput(counter)
        If Array_Operating_Userinput(counter) <> "" And Array_Operating_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Operating_Userinput(counter)
    End If
Next counter

Dim Array_NetFinan_Userinput(5)
Dim Array_NetFinan_TbInput(5)
Dim Array_NetFinan_InputData(5)

Array_NetFinan_Userinput(1) = ""
Array_NetFinan_Userinput(2) = ""
Array_NetFinan_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_NetFinan_CY2.value
Array_NetFinan_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_NetFinan_CY3.value
Array_NetFinan_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_NetFinan_CY4.value

Array_NetFinan_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_NetFinan_CY, "TB_Dummy")
Array_NetFinan_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_NetFinan_PY, "TB_Dummy")
Array_NetFinan_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_NetFinan_PY1, "TB_Dummy")
Array_NetFinan_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_NetFinan_PY2, "TB_Dummy")
Array_NetFinan_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_NetFinan_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_NetFinan_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_NetFinan_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_NetFinan_Userinput(counter) = "" Then
        Array_NetFinan_InputData(counter) = Array_NetFinan_TbInput(counter)
        If Array_NetFinan_TbInput(counter) <> "" And Array_NetFinan_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_NetFinan_TbInput(counter)
    Else
        Array_NetFinan_InputData(counter) = Array_NetFinan_Userinput(counter)
        If Array_NetFinan_Userinput(counter) <> "" And Array_NetFinan_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_NetFinan_Userinput(counter)
    End If
Next counter

'Dim Array_ResExtra_Userinput(5)
'Dim Array_ResExtra_TbInput(5)
'Dim Array_ResExtra_InputData(5)
'
'Array_ResExtra_Userinput(1) = ""
'Array_ResExtra_Userinput(2) = ""
'Array_ResExtra_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_ResExtra_CY2.value
'Array_ResExtra_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_ResExtra_CY3.value
'Array_ResExtra_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_ResExtra_CY4.value
'
'Array_ResExtra_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_ResExtra_CY, "TB_Dummy")
'Array_ResExtra_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_ResExtra_PY, "TB_Dummy")
'Array_ResExtra_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_ResExtra_PY1, "TB_Dummy")
'Array_ResExtra_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_ResExtra_PY2, "TB_Dummy")
'Array_ResExtra_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_ResExtra_PY3, "TB_Dummy")
'
'For counter = 1 To 5
'    obj_Name = "TxtInt_Indput_FinHigh_ResExtra_CY" & (counter - 1)
'    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_ResExtra_CY"
'    bestaat = GetDocPropNameErr(obj_Name)
'    If bestaat <> "N/A" Then
'        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
'    End If
'    If Array_ResExtra_Userinput(counter) = "" Then
'        Array_ResExtra_InputData(counter) = Array_ResExtra_TbInput(counter)
'        If Array_ResExtra_TbInput(counter) <> "" And Array_ResExtra_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_ResExtra_TbInput(counter)
'    Else
'        Array_ResExtra_InputData(counter) = Array_ResExtra_Userinput(counter)
'        If Array_ResExtra_Userinput(counter) <> "" And Array_ResExtra_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_ResExtra_Userinput(counter)
'    End If
'Next counter

Dim Array_PLYear_Userinput(5)
Dim Array_PLYear_TbInput(5)
Dim Array_PLYear_InputData(5)

Array_PLYear_Userinput(1) = ""
Array_PLYear_Userinput(2) = ""
Array_PLYear_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_PLYear_CY2.value
Array_PLYear_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_PLYear_CY3.value
Array_PLYear_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_PLYear_CY4.value

Array_PLYear_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear_CY, "TB_Dummy")
Array_PLYear_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear_PY, "TB_Dummy")
Array_PLYear_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear_PY1, "TB_Dummy")
Array_PLYear_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear_PY2, "TB_Dummy")
Array_PLYear_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_PLYear_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_PLYear_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_PLYear_Userinput(counter) = "" Then
        Array_PLYear_InputData(counter) = Array_PLYear_TbInput(counter)
        If Array_PLYear_TbInput(counter) <> "" And Array_PLYear_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_PLYear_TbInput(counter)
    Else
        Array_PLYear_InputData(counter) = Array_PLYear_Userinput(counter)
        If Array_PLYear_Userinput(counter) <> "" And Array_PLYear_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_PLYear_Userinput(counter)
    End If
Next counter

'koncern ARL 2015 - udg|fffd|et

'Dim Array_PLYear2_Userinput(5)
'Dim Array_PLYear2_TbInput(5)
'Dim Array_PLYear2_InputData(5)
'
'Array_PLYear2_Userinput(1) = ""
'Array_PLYear2_Userinput(2) = ""
'Array_PLYear2_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY2.value
'Array_PLYear2_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY3.value
'Array_PLYear2_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY4.value
'
'Array_PLYear2_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear2_CY, "TB_Dummy")
'Array_PLYear2_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY, "TB_Dummy")
'Array_PLYear2_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY1, "TB_Dummy")
'Array_PLYear2_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY2, "TB_Dummy")
'Array_PLYear2_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY3, "TB_Dummy")
'
'For counter = 1 To 5
'    obj_Name = "TxtInt_Indput_FinHigh_PLYear2_CY" & (counter - 1)
'    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_PLYear2_CY"
'    bestaat = GetDocPropNameErr(obj_Name)
'    If bestaat <> "N/A" Then
'        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
'    End If
'    If Array_PLYear2_Userinput(counter) = "" Then
'        Array_PLYear2_InputData(counter) = Array_PLYear2_TbInput(counter)
'        If Array_PLYear2_TbInput(counter) <> "" And Array_PLYear2_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_PLYear_TbInput(counter)
'    Else
'        Array_PLYear2_InputData(counter) = Array_PLYear2_Userinput(counter)
'        If Array_PLYear2_Userinput(counter) <> "" And Array_PLYear2_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_PLYear_Userinput(counter)
'    End If
'Next counter

Dim Array_BalTot_Userinput(5)
Dim Array_BalTot_TbInput(5)
Dim Array_BalTot_InputData(5)

Array_BalTot_Userinput(1) = ""
Array_BalTot_Userinput(2) = ""
Array_BalTot_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_BalTot_CY2.value
Array_BalTot_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_BalTot_CY3.value
Array_BalTot_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_BalTot_CY4.value

Array_BalTot_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_BalTot_CY, "TB_Dummy")
Array_BalTot_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_BalTot_PY, "TB_Dummy")
Array_BalTot_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_BalTot_PY1, "TB_Dummy")
Array_BalTot_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_BalTot_PY2, "TB_Dummy")
Array_BalTot_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_BalTot_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_BalTot_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_BalTot_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_BalTot_Userinput(counter) = "" Then
        Array_BalTot_InputData(counter) = Array_BalTot_TbInput(counter)
        If Array_BalTot_TbInput(counter) <> "" And Array_BalTot_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_BalTot_TbInput(counter)
    Else
        Array_BalTot_InputData(counter) = Array_BalTot_Userinput(counter)
        If Array_BalTot_Userinput(counter) <> "" And Array_BalTot_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_BalTot_Userinput(counter)
    End If
Next counter

Dim Array_InvPPE_Userinput(5)
Dim Array_InvPPE_TbInput(5)
Dim Array_InvPPE_InputData(5)

Array_InvPPE_Userinput(1) = FrmFinHigh.TxtInt_E_FinHigh_InvPPE_CY.value
Array_InvPPE_Userinput(2) = FrmFinHigh.TxtInt_E_FinHigh_InvPPE_CY1.value
Array_InvPPE_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_InvPPE_CY2.value
Array_InvPPE_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_InvPPE_CY3.value
Array_InvPPE_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_InvPPE_CY4.value

Array_InvPPE_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_InvPPE_CY, "TB_Dummy")
Array_InvPPE_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_InvPPE_PY, "TB_Dummy")
Array_InvPPE_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_InvPPE_PY1, "TB_Dummy")
Array_InvPPE_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_InvPPE_PY2, "TB_Dummy")
Array_InvPPE_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_InvPPE_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_InvPPE_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_InvPPE_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_InvPPE_Userinput(counter) = "" Then
        Array_InvPPE_InputData(counter) = Array_InvPPE_TbInput(counter)
        If Array_InvPPE_TbInput(counter) <> "" And Array_InvPPE_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_InvPPE_TbInput(counter)
    Else
        Array_InvPPE_InputData(counter) = Array_InvPPE_Userinput(counter)
        If Array_InvPPE_Userinput(counter) <> "" And Array_InvPPE_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_InvPPE_Userinput(counter)
    End If
Next counter

Dim Array_Equity_Userinput(6)
Dim Array_Equity_TbInput(6)
Dim Array_Equity_InputData(6)

Array_Equity_Userinput(1) = ""
Array_Equity_Userinput(2) = ""
Array_Equity_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_Equity_CY2.value
Array_Equity_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_Equity_CY3.value
Array_Equity_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_Equity_CY4.value
Array_Equity_Userinput(6) = FrmFinHigh.TxtInt_E_FinHigh_Equity_CY5.value


Array_Equity_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_CY, "TB_Dummy")
Array_Equity_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_PY, "TB_Dummy")
Array_Equity_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_PY1, "TB_Dummy")
Array_Equity_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_PY2, "TB_Dummy")
Array_Equity_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_PY3, "TB_Dummy")
Array_Equity_TbInput(6) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity_PY4, "TB_Dummy")

For counter = 1 To 6
    obj_Name = "TxtInt_Indput_FinHigh_Equity_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Equity_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Equity_Userinput(counter) = "" Then
        Array_Equity_InputData(counter) = Array_Equity_TbInput(counter)
        If Array_Equity_TbInput(counter) <> "" And Array_Equity_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Equity_TbInput(counter)
    Else
        Array_Equity_InputData(counter) = Array_Equity_Userinput(counter)
        If Array_Equity_Userinput(counter) <> "" And Array_Equity_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Equity_Userinput(counter)
        
    End If
Next counter

'koncern ARL 2015
Dim Array_Equity2_Userinput(6)
Dim Array_Equity2_TbInput(6)
Dim Array_Equity2_InputData(6)

Array_Equity2_Userinput(1) = ""
Array_Equity2_Userinput(2) = ""
Array_Equity2_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_Equity2_CY2.value
Array_Equity2_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_Equity2_CY3.value
Array_Equity2_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_Equity2_CY4.value
Array_Equity2_Userinput(6) = FrmFinHigh.TxtInt_E_FinHigh_Equity2_CY5.value


Array_Equity2_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_CY, "TB_Dummy")
Array_Equity2_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_PY, "TB_Dummy")
Array_Equity2_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_PY1, "TB_Dummy")
Array_Equity2_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_PY2, "TB_Dummy")
Array_Equity2_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_PY3, "TB_Dummy")
Array_Equity2_TbInput(6) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_Equity2_PY4, "TB_Dummy")

For counter = 1 To 6
    obj_Name = "TxtInt_Indput_FinHigh_Equity2_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Equity2_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Equity2_Userinput(counter) = "" Then
        Array_Equity2_InputData(counter) = Array_Equity2_TbInput(counter)
        If Array_Equity2_TbInput(counter) <> "" And Array_Equity2_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Equity_TbInput(counter)
    Else
        Array_Equity2_InputData(counter) = Array_Equity2_Userinput(counter)
        If Array_Equity2_Userinput(counter) <> "" And Array_Equity2_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_Equity_Userinput(counter)
        
    End If
Next counter


Dim Array_DepIntangi_Userinput(5)
Dim Array_DepIntangi_TbInput(5)
Dim Array_DepIntangi_InputData(5)

Array_DepIntangi_Userinput(1) = FrmFinHigh.TxtInt_E_FinHigh_DepIntangi_CY.value
Array_DepIntangi_Userinput(2) = FrmFinHigh.TxtInt_E_FinHigh_DepIntangi_CY1.value
Array_DepIntangi_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_DepIntangi_CY2.value
Array_DepIntangi_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_DepIntangi_CY3.value
Array_DepIntangi_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_DepIntangi_CY4.value

Array_DepIntangi_TbInput(1) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_DepIntangi_CY, "TB_Dummy")
Array_DepIntangi_TbInput(2) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_DepIntangi_PY, "TB_Dummy")
Array_DepIntangi_TbInput(3) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_DepIntangi_PY1, "TB_Dummy")
Array_DepIntangi_TbInput(4) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_DepIntangi_PY2, "TB_Dummy")
Array_DepIntangi_TbInput(5) = ConvStrToNumb(FrmFinHigh.LblInt_E_FinHigh_DepIntangi_PY3, "TB_Dummy")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_DepIntangi_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_DepIntangi_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_DepIntangi_Userinput(counter) = "" Then
        Array_DepIntangi_InputData(counter) = Array_DepIntangi_TbInput(counter)
        If Array_DepIntangi_TbInput(counter) <> "" And Array_DepIntangi_TbInput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_DepIntangi_TbInput(counter)
    Else
        Array_DepIntangi_InputData(counter) = Array_DepIntangi_Userinput(counter)
        If Array_DepIntangi_Userinput(counter) <> "" And Array_DepIntangi_Userinput(counter) <> "0" Then ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, Array_DepIntangi_Userinput(counter)
    End If
Next counter

Dim Array_InvCap_Userinput(5)

Array_InvCap_Userinput(1) = FrmFinHigh.TxtInt_E_FinHigh_InvCap_CY.value
Array_InvCap_Userinput(2) = FrmFinHigh.TxtInt_E_FinHigh_InvCap_CY1.value
Array_InvCap_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_InvCap_CY2.value
Array_InvCap_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_InvCap_CY3.value
Array_InvCap_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_InvCap_CY4.value

Dim Array_IntBear_Userinput(5)

Array_IntBear_Userinput(1) = FrmFinHigh.TxtInt_E_FinHigh_IntBear_CY.value
Array_IntBear_Userinput(2) = FrmFinHigh.TxtInt_E_FinHigh_IntBear_CY1.value
Array_IntBear_Userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_IntBear_CY2.value
Array_IntBear_Userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_IntBear_CY3.value
Array_IntBear_Userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_IntBear_CY4.value


Dim Array_Employ_userinput(5)
Array_Employ_userinput(1) = FrmFinHigh.TxtInt_E_FinHigh_Employ_CY.value
Array_Employ_userinput(2) = FrmFinHigh.TxtInt_E_FinHigh_Employ_CY1.value
Array_Employ_userinput(3) = FrmFinHigh.TxtInt_E_FinHigh_Employ_CY2.value
Array_Employ_userinput(4) = FrmFinHigh.TxtInt_E_FinHigh_Employ_CY3.value
Array_Employ_userinput(5) = FrmFinHigh.TxtInt_E_FinHigh_Employ_CY4.value




'beregner n|fffd|lgetal
'Beregninger Ratio 1
Dim Array_Ratio1_amount(5)
Dim Gross_control
Gross_control = FrmDocVariables.LstInt_GROSS.value

For counter = 1 To 5
    
    If Gross_control = "Ja" Then
        Array_Ratio1_amount(counter) = "N/A"
    Else
        If Array_Revenue_InputData(counter) = 0 Or Array_Revenue_InputData(counter) = "" Then
            Array_Ratio1_amount(counter) = "N/A"
        Else
            Array_Ratio1_amount(counter) = Round((CSng(Array_GrossProfit_InputData(counter)) * 100) / CSng(Array_Revenue_InputData(counter)), 1)
        End If
    End If
Next counter


FrmFinHigh.LblInt_FinHigh_Ratio1_CY.Caption = Array_Ratio1_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio1_CY1.Caption = Array_Ratio1_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio1_CY2.Caption = Array_Ratio1_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio1_CY3.Caption = Array_Ratio1_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio1_CY4.Caption = Array_Ratio1_amount(5)

'Beregner Ratio 2
Dim Array_Ratio2_amount(5)

For counter = 1 To 5
    If Gross_control = "Ja" Then
        Array_Ratio2_amount(counter) = "N/A"
    Else
        If Array_Revenue_InputData(counter) = 0 Or Array_Revenue_InputData(counter) = "" Then
            Array_Ratio2_amount(counter) = "N/A"
        Else
            Array_Ratio2_amount(counter) = Round((CSng(Array_PLYear_InputData(counter)) * 100) / CSng(Array_Revenue_InputData(counter)), 1)
        End If
    End If
Next counter

FrmFinHigh.LblInt_FinHigh_Ratio2_CY.Caption = Array_Ratio2_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio2_CY1.Caption = Array_Ratio2_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio2_CY2.Caption = Array_Ratio2_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio2_CY3.Caption = Array_Ratio2_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio2_CY4.Caption = Array_Ratio2_amount(5)

'Beregner Ratio 3
Dim Array_Ratio3_amount(5)

For counter = 1 To 5
    If Array_InvCap_Userinput(counter) = 0 Or Array_InvCap_Userinput(counter) = "" Then
        Array_Ratio3_amount(counter) = "N/A"
    Else
        Array_Ratio3_amount(counter) = Round(((CSng(Array_Operating_InputData(counter)) + CSng(Array_DepIntangi_InputData(counter))) * 100) / CSng(Array_InvCap_Userinput(counter)), 1)
    End If
Next counter

FrmFinHigh.LblInt_FinHigh_Ratio3_CY.Caption = Array_Ratio3_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio3_CY1.Caption = Array_Ratio3_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio3_CY2.Caption = Array_Ratio3_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio3_CY3.Caption = Array_Ratio3_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio3_CY4.Caption = Array_Ratio3_amount(5)

'Beregner Ratio 4
Dim Array_Ratio4_amount(5)

For counter = 1 To 5
    If Gross_control = "Ja" Then
        Array_Ratio2_amount(counter) = "N/A"
    Else
        If Array_InvCap_Userinput(counter) = 0 Or Array_InvCap_Userinput(counter) = "" Then
            Array_Ratio4_amount(counter) = "N/A"
        Else
            Array_Ratio4_amount(counter) = Round((CSng(Array_Revenue_InputData(counter)) / CSng(Array_InvCap_Userinput(counter))), 1)
        End If
    End If
Next counter

FrmFinHigh.LblInt_FinHigh_Ratio4_CY.Caption = Array_Ratio4_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio4_CY1.Caption = Array_Ratio4_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio4_CY2.Caption = Array_Ratio4_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio4_CY3.Caption = Array_Ratio4_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio4_CY4.Caption = Array_Ratio4_amount(5)

'Beregner Ratio 5
Dim Array_Ratio5_amount(5)

For counter = 1 To 5
    If Array_Equity_InputData(counter) <= 0 Or Array_Equity_InputData(counter) = "" Or Array_IntBear_Userinput(counter) = "" Then
        Array_Ratio5_amount(counter) = "N/A"
    Else
        Array_Ratio5_amount(counter) = Round((CSng(Array_IntBear_Userinput(counter)) / CSng(Array_Equity_InputData(counter))), 1)
    End If
Next counter

FrmFinHigh.LblInt_FinHigh_Ratio5_CY.Caption = Array_Ratio5_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio5_CY1.Caption = Array_Ratio5_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio5_CY2.Caption = Array_Ratio5_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio5_CY3.Caption = Array_Ratio5_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio5_CY4.Caption = Array_Ratio5_amount(5)

'Beregner Ratio 6
Dim Array_Ratio6_amount(5)
'kontroller om ARL 2015 (=true) er anvendt
'value_new_AARL = GetDocPropNameErr("LblInt_E_FinHigh_PLYear2_CY")
'value_old_AARL = GetDocPropNameErr("LblInt_E_FinHigh_PLYear_CY")
value_new_AARL_2 = GetDocPropNameErr("LblInt_E_FinHigh_Equity2_CY")
value_old_AARL_2 = GetDocPropNameErr("LblInt_E_FinHigh_Equity_CY")
If value_new_AARL_2 = value_old_AARL_2 Then

TB9050_TB6199 = False
Else
TB9050_TB6199 = True
End If
Dim Gms

If TB9050_TB6199 = True Then 'anvende ARL 2015 (kun koncern)
    For counter = 1 To 5
        If Array_Equity_InputData(counter + 1) = 0 Then
            Gms = (CSng(Array_Equity2_InputData(counter)) + CSng(Array_Equity2_InputData(counter + 1)))
        Else
            Gms = (CSng(Array_Equity2_InputData(counter)) + CSng(Array_Equity2_InputData(counter + 1))) / 2
        End If
        If Gms <= 0 Then
            Array_Ratio6_amount(counter) = "N/A"
        Else
            Array_Ratio6_amount(counter) = Round(((CSng(Array_PLYear_InputData(counter)) * 100) / Gms), 1)
        End If
    Next counter
Else
    For counter = 1 To 5
        If Array_Equity_InputData(counter + 1) = 0 Then
            Gms = (CSng(Array_Equity_InputData(counter)) + CSng(Array_Equity_InputData(counter + 1)))
        Else
            Gms = (CSng(Array_Equity_InputData(counter)) + CSng(Array_Equity_InputData(counter + 1))) / 2
        End If
        If Gms <= 0 Then
            Array_Ratio6_amount(counter) = "N/A"
        Else
            Array_Ratio6_amount(counter) = Round(((CSng(Array_PLYear_InputData(counter)) * 100) / Gms), 1)
        End If
    Next counter
End If

FrmFinHigh.LblInt_FinHigh_Ratio6_CY.Caption = Array_Ratio6_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio6_CY1.Caption = Array_Ratio6_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio6_CY2.Caption = Array_Ratio6_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio6_CY3.Caption = Array_Ratio6_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio6_CY4.Caption = Array_Ratio6_amount(5)

'Beregner Ratio 7
Dim Array_Ratio7_amount(5)
If TB9050_TB6199 = True Then 'anvende ARL 2015 (kun koncern)
    For counter = 1 To 5
    
        If Array_BalTot_InputData(counter) = 0 Or Array_BalTot_InputData(counter) = "" Then
            Array_Ratio7_amount(counter) = "N/A"
        Else
            Array_Ratio7_amount(counter) = Round((CSng(Array_Equity2_InputData(counter)) * 100) / CSng(Array_BalTot_InputData(counter)), 1)
        End If
    Next counter
Else
    For counter = 1 To 5
    
        If Array_BalTot_InputData(counter) = 0 Or Array_BalTot_InputData(counter) = "" Then
            Array_Ratio7_amount(counter) = "N/A"
        Else
            Array_Ratio7_amount(counter) = Round((CSng(Array_Equity_InputData(counter)) * 100) / CSng(Array_BalTot_InputData(counter)), 1)
        End If
    Next counter
End If

FrmFinHigh.LblInt_FinHigh_Ratio7_CY.Caption = Array_Ratio7_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio7_CY1.Caption = Array_Ratio7_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio7_CY2.Caption = Array_Ratio7_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio7_CY3.Caption = Array_Ratio7_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio7_CY4.Caption = Array_Ratio7_amount(5)

'Beregner Ratio 8
Dim Array_Ratio8_amount(5)
For counter = 1 To 5

    If Array_Employ_userinput(counter) = 0 Or Array_Employ_userinput(counter) = "" Then
        Array_Ratio8_amount(counter) = "N/A"
    Else
        Array_Ratio8_amount(counter) = Round((CSng(Array_Revenue_InputData(counter))) / CSng(Array_Employ_userinput(counter)), 1)
    End If
Next counter

FrmFinHigh.LblInt_FinHigh_Ratio8_CY.Caption = Array_Ratio8_amount(1)
FrmFinHigh.LblInt_FinHigh_Ratio8_CY1.Caption = Array_Ratio8_amount(2)
FrmFinHigh.LblInt_FinHigh_Ratio8_CY2.Caption = Array_Ratio8_amount(3)
FrmFinHigh.LblInt_FinHigh_Ratio8_CY3.Caption = Array_Ratio8_amount(4)
FrmFinHigh.LblInt_FinHigh_Ratio8_CY4.Caption = Array_Ratio8_amount(5)

'Viser hovedtal hvis konto konto 6199 (egenkapital ex minorirtetsinteresser) eller 9050 (resultat ex minor.) er anvendt
'Dim TB9050_TB6199 As Boolean
'TB9050_TB6199 = True
'
'If FrmFinHigh.LblInt_E_FinHigh_Equity2_CY.Caption <> FrmFinHigh.LblInt_E_FinHigh_Equity_CY.Caption Or FrmFinHigh.LblInt_E_FinHigh_Equity2_CY.Caption = "1000 TB" Then TB9050_TB6199 = False
'If FrmFinHigh.LblInt_E_FinHigh_PLYear2_CY.Caption <> FrmFinHigh.LblInt_E_FinHigh_PLYear_CY.Caption Or FrmFinHigh.LblInt_E_FinHigh_PLYear2_CY.Caption = "1000 TB" Then TB9050_TB6199 = False

'FrmFinHigh.Lbltext_E_FinHigh_PLYear2.Enabled = TB9050_TB6199
'FrmFinHigh.LblInt_E_FinHigh_PLYear2_CY.Enabled = TB9050_TB6199
'FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY.Enabled = TB9050_TB6199
'FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY1.Enabled = TB9050_TB6199
'FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY2.Enabled = TB9050_TB6199
'FrmFinHigh.LblInt_E_FinHigh_PLYear2_PY3.Enabled = TB9050_TB6199
'FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY2.Enabled = TB9050_TB6199
'FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY3.Enabled = TB9050_TB6199
'FrmFinHigh.TxtInt_E_FinHigh_PLYear2_CY4.Enabled = TB9050_TB6199
'
'FrmFinHigh.Lbltext_E_FinHigh_Equity2.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_CY.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_PY.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_PY1.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_PY2.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_PY3.Enabled = TB9050_TB6199
'Me.LblInt_E_FinHigh_Equity2_PY4.Enabled = TB9050_TB6199
'Me.TxtInt_E_FinHigh_Equity2_CY2.Enabled = TB9050_TB6199
'Me.TxtInt_E_FinHigh_Equity2_CY3.Enabled = TB9050_TB6199
'Me.TxtInt_E_FinHigh_Equity2_CY4.Enabled = TB9050_TB6199
'Me.TxtInt_E_FinHigh_Equity2_CY5.Enabled = TB9050_TB6199
End Sub

'add by BEPE, save information from finhigh to tha XBRL report, this sub is call fram OK bottum in variablesform
Sub cal_XBRL()


firstday = FrmDocVariables.TxtStr_DocVar_FirstDay.value
LastDay = FrmDocVariables.TxtStr_DocVar_LastDay.value
roundcy = FrmDocVariables.LstInt_ROUNDCY.value
roundpy = FrmDocVariables.LstInt_ROUNDPY.value

If roundcy = "x 1" Then roundcy = 0
If roundcy = "x 1.000" Then roundcy = -3
If roundcy = "x 1.000.000" Then roundcy = -6

If roundpy = "x 1" Then roundpy = 0
If roundpy = "x 1.000" Then roundpy = -3
If roundpy = "x 1.000.000" Then roundpy = -6


On Error Resume Next
Dim cstmDocProp As DocumentProperty
 
Set cstmDocProp = ActiveDocument.CustomDocumentProperties("TxtDat_BeginDate_CY")
If Err.Number = 0 Then
    cstmDocProp.value = firstday
End If
 
Set cstmDocProp = ActiveDocument.CustomDocumentProperties("TxtDat_EndDate_CY")
If Err.Number = 0 Then
    cstmDocProp.value = LastDay
End If
 
Set cstmDocProp = ActiveDocument.CustomDocumentProperties("TxtDat_RoundCY")
If Err.Number = 0 Then
    cstmDocProp.value = roundcy
End If
 
Set cstmDocProp = ActiveDocument.CustomDocumentProperties("TxtDat_RoundPY")
If Err.Number = 0 Then
    cstmDocProp.value = roundpy
End If

'Finhigh

Dim val_rouding_CY As String
If FrmDocVariables.LstInt_ROUNDCY.value = "x 1" Then val_rouding_CY = "000"
If FrmDocVariables.LstInt_ROUNDCY.value = "x 1.000" Then val_rouding_CY = ""
If FrmDocVariables.LstInt_ROUNDCY.value = "x 1.000.000" Then val_rouding_CY = ""
Dim val_XBRL As String

'find 1 hovedtal
Dim Array_Revenue_UserInput(5)
Array_Revenue_UserInput(1) = ""
Array_Revenue_UserInput(2) = ""
Array_Revenue_UserInput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Revenue_CY2")
Array_Revenue_UserInput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Revenue_CY3")
Array_Revenue_UserInput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Revenue_CY4")

Dim Array_Revenue_TbInput(5)
Array_Revenue_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_Revenue_CY")
Array_Revenue_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_Revenue_PY")
Array_Revenue_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_Revenue_PY1")
Array_Revenue_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_Revenue_PY2")
Array_Revenue_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_Revenue_PY3")

Dim Array_Revenue_InputData(5)
Dim counter As Integer
Dim obj_Name As String

For counter = 1 To 5

    obj_Name = "TxtInt_Indput_FinHigh_Revenue_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Revenue_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Revenue_UserInput(counter) = "" Then
        Array_Revenue_InputData(counter) = Array_Revenue_TbInput(counter)
        If Array_Revenue_TbInput(counter) <> "" And Array_Revenue_TbInput(counter) <> 0 Then
            val_XBRL = Int(Array_Revenue_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_Revenue_InputData(counter) = Array_Revenue_UserInput(counter)
        If Array_Revenue_UserInput(counter) <> "" And Array_Revenue_UserInput(counter) <> "0" Then
            val_XBRL = Int(Array_Revenue_UserInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If

Next counter

'2 hovedtal
Dim Array_GrossProfit_Userinput(5)
Dim Array_GrossProfit_TbInput(5)
Dim Array_GrossProfit_InputData(5)

Array_GrossProfit_Userinput(1) = ""
Array_GrossProfit_Userinput(2) = ""
Array_GrossProfit_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit_CY2")
Array_GrossProfit_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit_CY3")
Array_GrossProfit_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit_CY4")

Array_GrossProfit_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit_CY")
Array_GrossProfit_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit_PY")
Array_GrossProfit_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit_PY1")
Array_GrossProfit_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit_PY2")
Array_GrossProfit_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit_PY3")


For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_GrossProfit_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_GrossProfit_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_GrossProfit_Userinput(counter) = "" Then
        Array_GrossProfit_InputData(counter) = Array_GrossProfit_TbInput(counter)
        If Array_GrossProfit_TbInput(counter) <> "" And Array_GrossProfit_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_GrossProfit_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_GrossProfit_InputData(counter) = Array_GrossProfit_Userinput(counter)
        If Array_GrossProfit_Userinput(counter) <> "" And Array_GrossProfit_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_GrossProfit_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

' 3 hovedtal
Dim Array_GrossProfit2_Userinput(5)
Dim Array_GrossProfit2_TbInput(5)
Dim Array_GrossProfit2_InputData(5)

Array_GrossProfit2_Userinput(1) = ""
Array_GrossProfit2_Userinput(2) = ""
Array_GrossProfit2_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit2_CY2")
Array_GrossProfit2_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit2_CY3")
Array_GrossProfit2_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_GrossProfit2_CY4")

Array_GrossProfit2_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit2_CY")
Array_GrossProfit2_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit2_PY")
Array_GrossProfit2_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit2_PY1")
Array_GrossProfit2_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit2_PY2")
Array_GrossProfit2_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_GrossProfit2_PY3")

counter = 0
For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_GrossProfit2_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_GrossProfit2_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_GrossProfit2_Userinput(counter) = "" Then
        Array_GrossProfit2_InputData(counter) = Array_GrossProfit2_TbInput(counter)
        If Array_GrossProfit2_TbInput(counter) <> "" And Array_GrossProfit2_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_GrossProfit2_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_GrossProfit2_InputData(counter) = Array_GrossProfit2_Userinput(counter)
        If Array_GrossProfit2_Userinput(counter) <> "" And Array_GrossProfit2_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_GrossProfit2_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

'1 frilinie
Dim Array_Primary_Userinput(5)
Array_Primary_Userinput(1) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Primary_CY")
Array_Primary_Userinput(2) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Primary_CY1")
Array_Primary_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Primary_CY2")
Array_Primary_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Primary_CY3")
Array_Primary_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Primary_CY4")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_Primary_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Primary_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Primary_Userinput(counter) <> "" And Array_Primary_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_Primary_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
    End If
    
Next counter


Dim Array_Operating_Userinput(5)
Dim Array_Operating_TbInput(5)
Dim Array_Operating_InputData(5)

Array_Operating_Userinput(1) = ""
Array_Operating_Userinput(2) = ""
Array_Operating_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Operating_CY2")
Array_Operating_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Operating_CY3")
Array_Operating_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Operating_CY4")

Array_Operating_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_Operating_CY")
Array_Operating_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_Operating_PY")
Array_Operating_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_Operating_PY1")
Array_Operating_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_Operating_PY2")
Array_Operating_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_Operating_PY3")


For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_Operating_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Operating_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Operating_Userinput(counter) = "" Then
        Array_Operating_InputData(counter) = Array_Operating_TbInput(counter)
        If Array_Operating_TbInput(counter) <> "" And Array_Operating_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_Operating_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_Operating_InputData(counter) = Array_Operating_Userinput(counter)
        If Array_Operating_Userinput(counter) <> "" And Array_Operating_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_Operating_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_NetFinan_Userinput(5)
Dim Array_NetFinan_TbInput(5)
Dim Array_NetFinan_InputData(5)

Array_NetFinan_Userinput(1) = ""
Array_NetFinan_Userinput(2) = ""
Array_NetFinan_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_NetFinan_CY2")
Array_NetFinan_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_NetFinan_CY3")
Array_NetFinan_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_NetFinan_CY4")

Array_NetFinan_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_NetFinan_CY")
Array_NetFinan_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_NetFinan_PY")
Array_NetFinan_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_NetFinan_PY1")
Array_NetFinan_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_NetFinan_PY2")
Array_NetFinan_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_NetFinan_PY3")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_NetFinan_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_NetFinan_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_NetFinan_Userinput(counter) = "" Then
        Array_NetFinan_InputData(counter) = Array_NetFinan_TbInput(counter)
        If Array_NetFinan_TbInput(counter) <> "" And Array_NetFinan_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_NetFinan_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_NetFinan_InputData(counter) = Array_NetFinan_Userinput(counter)
        If Array_NetFinan_Userinput(counter) <> "" And Array_NetFinan_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_NetFinan_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_ResExtra_Userinput(5)
Dim Array_ResExtra_TbInput(5)
Dim Array_ResExtra_InputData(5)

Array_ResExtra_Userinput(1) = ""
Array_ResExtra_Userinput(2) = ""
Array_ResExtra_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_ResExtra_CY2")
Array_ResExtra_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_ResExtra_CY3")
Array_ResExtra_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_ResExtra_CY4")

Array_ResExtra_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_ResExtra_CY")
Array_ResExtra_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_ResExtra_PY")
Array_ResExtra_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_ResExtra_PY1")
Array_ResExtra_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_ResExtra_PY2")
Array_ResExtra_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_ResExtra_PY3")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_ResExtra_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_ResExtra_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_ResExtra_Userinput(counter) = "" Then
        Array_ResExtra_InputData(counter) = Array_ResExtra_TbInput(counter)
        If Array_ResExtra_TbInput(counter) <> "" And Array_ResExtra_TbInput(counter) <> "0" Then
        val_XBRL = Int(Array_ResExtra_TbInput(counter)) & val_rouding_CY
        ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_ResExtra_InputData(counter) = Array_ResExtra_Userinput(counter)
        If Array_ResExtra_Userinput(counter) <> "" And Array_ResExtra_Userinput(counter) <> "0" Then
        val_XBRL = Int(Array_ResExtra_Userinput(counter)) & val_rouding_CY
        ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_PLYear_Userinput(5)
Dim Array_PLYear_TbInput(5)
Dim Array_PLYear_InputData(5)

Array_PLYear_Userinput(1) = ""
Array_PLYear_Userinput(2) = ""
Array_PLYear_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_PLYear_CY2")
Array_PLYear_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_PLYear_CY3")
Array_PLYear_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_PLYear_CY4")

Array_PLYear_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_PLYear_CY")
Array_PLYear_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_PLYear_PY")
Array_PLYear_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_PLYear_PY1")
Array_PLYear_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_PLYear_PY2")
Array_PLYear_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_PLYear_PY3")


For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_PLYear_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_PLYear_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_PLYear_Userinput(counter) = "" Then
        Array_PLYear_InputData(counter) = Array_PLYear_TbInput(counter)
        If Array_PLYear_TbInput(counter) <> "" And Array_PLYear_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_PLYear_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_PLYear_InputData(counter) = Array_PLYear_Userinput(counter)
        If Array_PLYear_Userinput(counter) <> "" And Array_PLYear_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_PLYear_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_BalTot_Userinput(5)
Dim Array_BalTot_TbInput(5)
Dim Array_BalTot_InputData(5)

Array_BalTot_Userinput(1) = ""
Array_BalTot_Userinput(2) = ""
Array_BalTot_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_BalTot_CY2")
Array_BalTot_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_BalTot_CY3")
Array_BalTot_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_BalTot_CY4")

Array_BalTot_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_BalTot_CY")
Array_BalTot_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_BalTot_PY")
Array_BalTot_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_BalTot_PY1")
Array_BalTot_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_BalTot_PY2")
Array_BalTot_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_BalTot_PY3")

counter = 0
For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_BalTot_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_BalTot_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_BalTot_Userinput(counter) = "" Then
        Array_BalTot_InputData(counter) = Array_BalTot_TbInput(counter)
        If Array_BalTot_TbInput(counter) <> "" And Array_BalTot_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_BalTot_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_BalTot_InputData(counter) = Array_BalTot_Userinput(counter)
        If Array_BalTot_Userinput(counter) <> "" And Array_BalTot_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_BalTot_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_InvPPE_Userinput(5)
Dim Array_InvPPE_TbInput(5)
Dim Array_InvPPE_InputData(5)

Array_InvPPE_Userinput(1) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvPPE_CY")
Array_InvPPE_Userinput(2) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvPPE_CY1")
Array_InvPPE_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvPPE_CY2")
Array_InvPPE_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvPPE_CY3")
Array_InvPPE_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvPPE_CY4")

Array_InvPPE_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_InvPPE_CY")
Array_InvPPE_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_InvPPE_PY")
Array_InvPPE_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_InvPPE_PY1")
Array_InvPPE_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_InvPPE_PY2")
Array_InvPPE_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_InvPPE_PY3")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_InvPPE_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_InvPPE_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_InvPPE_Userinput(counter) = "" Then
        Array_InvPPE_InputData(counter) = Array_InvPPE_TbInput(counter)
        If Array_InvPPE_TbInput(counter) <> "" And Array_InvPPE_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_InvPPE_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_InvPPE_InputData(counter) = Array_InvPPE_Userinput(counter)
        If Array_InvPPE_Userinput(counter) <> "" And Array_InvPPE_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_InvPPE_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter

Dim Array_Equity_Userinput(6)
Dim Array_Equity_TbInput(6)
Dim Array_Equity_InputData(6)

Array_Equity_Userinput(1) = ""
Array_Equity_Userinput(2) = ""
Array_Equity_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Equity_CY2")
Array_Equity_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Equity_CY3")
Array_Equity_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Equity_CY4")
Array_Equity_Userinput(6) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_Equity_CY5")


Array_Equity_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_Equity_CY")
Array_Equity_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_Equity_PY")
Array_Equity_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_Equity_PY1")
Array_Equity_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_Equity_PY2")
Array_Equity_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_Equity_PY3")
Array_Equity_TbInput(6) = GetDocPropValErr("LblInt_E_FinHigh_Equity_PY4")

For counter = 1 To 6
    obj_Name = "TxtInt_Indput_FinHigh_Equity_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_Equity_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_Equity_Userinput(counter) = "" Then
        Array_Equity_InputData(counter) = Array_Equity_TbInput(counter)
        If Array_Equity_TbInput(counter) <> "" And Array_Equity_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_Equity_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_Equity_InputData(counter) = Array_Equity_Userinput(counter)
        If Array_Equity_Userinput(counter) <> "" And Array_Equity_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_Equity_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If

    End If
Next counter

Dim Array_DepIntangi_Userinput(5)
Dim Array_DepIntangi_TbInput(5)
Dim Array_DepIntangi_InputData(5)

Array_DepIntangi_Userinput(1) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_DepIntangi_CY")
Array_DepIntangi_Userinput(2) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_DepIntangi_CY1")
Array_DepIntangi_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_DepIntangi_CY2")
Array_DepIntangi_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_DepIntangi_CY3")
Array_DepIntangi_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_DepIntangi_CY4")

Array_DepIntangi_TbInput(1) = GetDocPropValErr("LblInt_E_FinHigh_DepIntangi_CY")
Array_DepIntangi_TbInput(2) = GetDocPropValErr("LblInt_E_FinHigh_DepIntangi_PY")
Array_DepIntangi_TbInput(3) = GetDocPropValErr("LblInt_E_FinHigh_DepIntangi_PY1")
Array_DepIntangi_TbInput(4) = GetDocPropValErr("LblInt_E_FinHigh_DepIntangi_PY2")
Array_DepIntangi_TbInput(5) = GetDocPropValErr("LblInt_E_FinHigh_DepIntangi_PY3")

counter = 0
For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_DepIntangi_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_DepIntangi_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_DepIntangi_Userinput(counter) = "" Then
        Array_DepIntangi_InputData(counter) = Array_DepIntangi_TbInput(counter)
        If Array_DepIntangi_TbInput(counter) <> "" And Array_DepIntangi_TbInput(counter) <> "0" Then
            val_XBRL = Int(Array_DepIntangi_TbInput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    Else
        Array_DepIntangi_InputData(counter) = Array_DepIntangi_Userinput(counter)
        If Array_DepIntangi_Userinput(counter) <> "" And Array_DepIntangi_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_DepIntangi_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
        End If
    End If
Next counter
Dim Array_InvCap_Userinput(5)

Array_InvCap_Userinput(1) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvCap_CY")
Array_InvCap_Userinput(2) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvCap_CY1")
Array_InvCap_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvCap_CY2")
Array_InvCap_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvCap_CY3")
Array_InvCap_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_InvCap_CY4")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_InvCap_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_InvCap_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_InvCap_Userinput(counter) <> "" And Array_InvCap_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_InvCap_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
    End If
Next counter


Dim Array_IntBear_Userinput(5)

Array_IntBear_Userinput(1) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_IntBear_CY")
Array_IntBear_Userinput(2) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_IntBear_CY1")
Array_IntBear_Userinput(3) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_IntBear_CY2")
Array_IntBear_Userinput(4) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_IntBear_CY3")
Array_IntBear_Userinput(5) = GetDocPropValErr_UserInput("TxtInt_E_FinHigh_IntBear_CY4")

For counter = 1 To 5
    obj_Name = "TxtInt_Indput_FinHigh_IntBear_CY" & (counter - 1)
    If counter = 1 Then obj_Name = "TxtInt_Indput_FinHigh_IntBear_CY"
    bestaat = GetDocPropNameErr(obj_Name)
    If bestaat <> "N/A" Then
        ActiveDocument.CustomDocumentProperties(obj_Name).Delete
    End If
    If Array_IntBear_Userinput(counter) <> "" And Array_IntBear_Userinput(counter) <> "0" Then
            val_XBRL = Int(Array_IntBear_Userinput(counter)) & val_rouding_CY
            ActiveDocument.CustomDocumentProperties.Add obj_Name, False, msoPropertyTypeString, val_XBRL
    End If
Next counter

End Sub


Attribute VB_Name = "FrmCashFlow"
Attribute VB_Base = "0{E8B9DDEC-4C90-40B3-92DE-78EBE432A433}{4DDD8DDA-BDFC-4069-BFB9-66B0C22A71BC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False






Private Sub Cmd_Rollover_Click()
Rollover

CalculateSum_KasSubForm     'procedure berekent totalen txtboxen en doet controles
proc_PGKasstroom
CalculateSum_KasSubForm

End Sub

Private Sub cmdCalculate_Click()
For Each obj In Me.Controls
    'add by bepe,  validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
Next
CalculateSum_KasSubForm     'procedure berekent totalen txtboxen en doet controles
proc_PGKasstroom

CalculateSum_KasSubForm
End Sub
Private Sub Rollover()
Dim PY_Name As String
Dim PY_Textbox As Object

For Each obj In Me.Controls
    
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 And InStr(1, UCase(obj.Name), "CY") > 0 Then
        
        
        PY_Name = Replace(obj.Name, "CY", "PY")
        
        'PY_Textbox = Controls(PY_Name)
        
        NewYear CY:=Controls(obj.Name), CY1:=Controls(PY_Name)
        
    End If
Next
End Sub


Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls
    'add by bepe,  validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If


    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub



Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
CalculateSum_KasSubForm
proc_PGKasstroom
CalculateSum_KasSubForm

End Sub

Attribute VB_Name = "FrmCdpList"
Attribute VB_Base = "0{BEE3E7EA-64C7-4CA1-8D94-68D8DA0F443A}{8907CF9F-CC02-484B-9957-411D025CEBFB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False










Private Sub lstCDP_DblClick()
'SelItem = FrmCdpList.lstCDP.SelectedItem.Text
'curval = ActiveDocument.CustomDocumentProperties(SelItem).Value
'CdpValueEntry = InputBox("geef waarde voor: " & SelItem, "New value cdp", curval)

ActiveDocument.CustomDocumentProperties(SelItem).value = CdpValueEntry


'opnieuw opbouwen
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
    
Next cdp

For i = LBound(CdpName) To (UBound(CdpName))
    For j = (i + 1) To UBound(CdpName)
        If CdpName(i) > CdpName(j) Then
            tmp = CdpName(i)
            CdpName(i) = CdpName(j)
            CdpName(j) = tmp
         End If
    Next j
    
Next i

FrmCdpList.lstCDP.ColumnHeaders.Add , , "Template", FrmCdpList.lstCDP.Width / 2.5
FrmCdpList.lstCDP.ColumnHeaders.Add , , "Version", FrmCdpList.lstCDP.Width / 1.7
FrmCdpList.lstCDP.View = lvwReport
FrmCdpList.lstCDP.ListItems.Clear



For z = LBound(CdpName) To (UBound(CdpName))
    FrmCdpList.lstCDP.ListItems.Add , , CdpName(z)
    FrmCdpList.lstCDP.ListItems(z + 1).SubItems(1) = ActiveDocument.CustomDocumentProperties(CdpName(z)).value

Next z

End Sub

Private Sub UserForm_Initialize()
'opnieuw opbouwen
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
    
Next cdp

FrmCdpList.LblAantal.Caption = "Aantal variabelen : " & counter

For i = LBound(CdpName) To (UBound(CdpName))
    For j = (i + 1) To UBound(CdpName)
        If CdpName(i) > CdpName(j) Then
            tmp = CdpName(i)
            CdpName(i) = CdpName(j)
            CdpName(j) = tmp
         End If
    Next j
    
Next i

FrmCdpList.lstCDP.ColumnHeaders.Add , , "Template", FrmCdpList.lstCDP.Width / 2.5
FrmCdpList.lstCDP.ColumnHeaders.Add , , "Version", FrmCdpList.lstCDP.Width / 1.7
FrmCdpList.lstCDP.View = lvwReport
FrmCdpList.lstCDP.ListItems.Clear

opbouw = ""

For z = LBound(CdpName) To (UBound(CdpName))
    FrmCdpList.lstCDP.ListItems.Add , , CdpName(z)
    FrmCdpList.lstCDP.ListItems(z + 1).SubItems(1) = ActiveDocument.CustomDocumentProperties(CdpName(z)).value
    opbouw = opbouw & Chr(13) & CdpName(z) & " > " & ActiveDocument.CustomDocumentProperties(CdpName(z)).value
Next z
txtCDPs.Text = opbouw
End Sub
Attribute VB_Name = "FrmDocVarConSul"
Attribute VB_Base = "0{729A48E1-F04E-44CE-80C8-075301A9A2F4}{902125C6-767E-4C79-BAD1-C7F863CDF37C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False









Private Sub cmdCalculate_Click()
CalculateSum_consol
End Sub

Private Sub cmdcancel_Click()
 bestaat = GetDocPropNameErr("AutoGenerateCancel")
    If bestaat = "N/A" Then
        ActiveDocument.CustomDocumentProperties.Add "AutoGenerateCancel", False, msoPropertyTypeBoolean, "True"
    End If
    Unload Me
End Sub

Private Sub CmdOk_Click()
Dim obj As control
Dim NewValue
'Dim Empty_Fin As Boolean ' Add by BEPE. controls for values in subform, information are show in navigationspanel
'Empty_Fin = True
'Dim Empty_SharCap 'Add by BEPE. controls for values in subform, information are show in navigationspanel
'Empty_SharCap = True
'Dim CVRControlBox As Boolean
'CVRControlBox = False
For Each obj In Me.Controls

     If InStr(1, UCase(obj.Name), "TXTINT_S_ITA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_TFA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_FAI_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_Fin = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    ElseIf InStr(1, UCase(obj.Name), "TXTINT_S_SHARCAP_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                    Exit Sub
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_SharCap = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    End If
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

Application.StatusBar = "ready"
Unload Me
Subform_Value

End Sub

Private Sub CmdSpec_KonFinAss_Click()

Load FrmFinAss
FrmFinAss.Show
End Sub

Private Sub CmdSpec_Treasure_Click()
Load FrmKonTreasure
    FrmKonTreasure.Show
End Sub

Private Sub CommandButton4_Click()
Load FrmKonFixedAs2
FrmKonFixedAs2.Show

End Sub









Private Sub listNavigate_Click()
Dim SelItem
Dim TestTab
'SelItem = FrmDocVariables.listNavigate.SelectedItem.Index
'FrmDocVariables.MultiPage1.Value = SelItem - 1

SelItem = Me.listNavigate.SelectedItem.Text
For Each PageTab In Me.MultiPage1.Pages
    
    TestTab = PageTab.Caption
    If TestTab = SelItem Then
    
        Me.MultiPage1.value = PageTab.index
        
    End If
    
Next PageTab
End Sub

Private Sub MultiPage1_Change()
CalculateSum_consol

End Sub









Private Sub UserForm_Initialize()

'opslaan van een aantal setvelden in de CDP's ten behoeve van bedrijfsvergelijking.
'De velden worden voorafgegaan door BVG (bedrijfsvergelijking) in de cdp's
'''vastlegging_SET_in_CDP

'Deze routine bevat een opsomming van de verschillende procedures die de migratie van CDP's regelt van 2007 naar 2009
'''Migratie

'het opbouwen van de list boxen op het dialoog (vullen van de lijssies)
'InitializeLists

'Toevoeging Denemarken:

'bestaat = GetDocPropNameErr("TxtStr_RegData_Virksomhedsnavn1")
'If bestaat = "N/A" Then
'GetRegData
'
'End If
'
'
'
'    If Me.LstInt_CashFlow.value = "Ja" Then
'        Me.TxtInt_PgDocVar_MG_Kasstr.value = ""
'    Else
'        Me.TxtInt_PgDocVar_MG_Kasstr.value = 1
'    End If
'
''het vastleggen van de visuele status van enkele niet forced nodes
''o.a. ten behoeve van pubnummering
'
'PubNummering 'Arco to implement

'Definieren van de kolommen van het navigation pane
Me.listNavigate.ColumnHeaders.Add , , "NAVIGATIE :", Me.listNavigate.Width / 1.4
Me.listNavigate.ColumnHeaders.Add , , "Status", Me.listNavigate.Width / 4

'Definieren van de kolommen van statusoverzicht

'Me.listTemplates.ColumnHeaders.Add , , "Template", Me.listTemplates.Width / 2.5
'Me.listTemplates.ColumnHeaders.Add , , "Version", Me.listTemplates.Width / 1.7
'Me.listTemplates.View = lvwReport
'Me.listTemplates.ListItems.Clear


'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False

End If

'initieel alle Boo_Spec lables op true zetten zodat indien niet gevoed door excel het tabblad zichtbaar blijft
For Each Object In Me.Controls

    If InStr(1, UCase(Object.Name), "BOO_SPEC") > 0 Then
        Object.Caption = "TRUE"
    End If

Next Object
'
'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value

    counter = counter + 1

    'specifieke velden ten behoeve van statusoverzicht worden eruit gefilterd en in overzicht opgenomen
'    If InStr(1, LCase(cdp.Name), "template_ds_") > 0 Then
'        posSlash = InStr(1, cdp.value, "/")
'        Me.listTemplates.ListItems.Add , , Left(cdp.value, posSlash - 1)
'        Me.listTemplates.ListItems(counter2).SubItems(1) = Mid(cdp.value, posSlash + 1, 100)
'        counter2 = counter2 + 1
'    End If

Next cdp






'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then

        For ToTest = 0 To UBound(CdpName)

            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then

                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then

                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then

                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted

                    Else

                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)

                    End If

                Else

                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then

                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else

                            If InStr(1, LCase(obj.Name), "int_") > 0 Then

                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            'MsgBox me(Obj.Name).Name
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)

                                Else

                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)

                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If

                    End If
                End If

            GoTo ValueSet
            End If

        Next ToTest

    End If

ValueSet:
Next obj
'
''tonen / verbergen tabbladen (incl controls)
ShowHideMultipageControls_Consol
'
''ADD by BEPE, validations of subforms
'Subform_Value 'henter v|fffd|rdier fra underforms
'
''selecteren van de eerste sheet (documentvariabelen)
Me.MultiPage1.value = 0
'
''procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
''cmdCalculate_Click
CalculateSum_consol

End Sub

Attribute VB_Name = "FrmDocVariables"
Attribute VB_Base = "0{AC07BD5D-EC3E-4A31-9EF9-A9D7AD8D4B8E}{5839BF1B-E1C0-4BD3-9EDB-105DE5A4326D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub ChkBoo_S_CompDet_Annual_Change()
CompDet_Annual_Chk

End Sub
'boksen for "anvend anden dato for revisor p|fffd|tegning
Private Sub ChkBoo_S_Data_Click()
    
    ChkForcedBox
End Sub

Private Sub Cmd_ERST_Click()
ValidateButton
End Sub

Private Sub cmdCalculate_Click()

'in verband met de volgorde effecten dient deze procedure twee maal te lopen.. voor de subprocessen en erna
CalculateSum

'LblValueDisplay   'procedure voor plaatsten van de jaartallen op de tabs

ChkForcedBox    'procedure die controleert of forced velden (1e tabblad gevuld zijn)

'in verband met de volgorde effecten dient deze procedure altijd als laatste te lopen (deze berekent namelijk de totalen die in bovengenoemde subprocessen tot stand komen.
CalculateSum      'procedure berekent totalen txtboxen en doet controles

End Sub

Private Sub CmdSpec_ChanEq_Click()
SelectSubForm
End Sub

Private Sub CmdOk_Click()

'BEPE: sikre at revisordato kommer med i XBRL rapporten
'Me.TxtStr_S_DocVar_AudiRep_Date.Enabled = False

'BEPE: sikre at der ikke kommer en tom linje for de kontorer hvor der ikke er noget postnummer.
If Me.TxtStr_RegData_Postbox.value = " " Then Me.TxtStr_RegData_Postbox.value = ""

'BEPE: opretter CDP som angiver om regnskabs|fffd|ret er skr|fffd|vt
Year_type = Year_type_control(Me.TxtStr_DocVar_FirstDay.value, Me.TxtStr_DocVar_LastDay.value)
bestaat = GetDocPropNameErr("Year_type")
If bestaat = "N/A" Then
    ActiveDocument.CustomDocumentProperties.Add "Year_type", False, msoPropertyTypeString, Year_type
Else
    ActiveDocument.CustomDocumentProperties("Year_type").value = Year_type
End If
'Controle of forced velden (met name van eerste tabblad) gevuld zijn

RequiredMiss = False
ChkForcedBox
cal_XBRL


'Correctie procedure voor xlstring variabelen die van excel afkomen maar niet door
'docvarform beinvloed worden. De getallen krijgen vanuit excel niet het juiste format

For Each cdp In ActiveDocument.CustomDocumentProperties
    If InStr(1, LCase(cdp.Name), "xltstring") > 0 Then
        If IsNumeric(cdp.value) = True Then
        
            ActiveDocument.CustomDocumentProperties(cdp.Name).value = DecSepXlstr(cdp.value)
        
        End If
    End If
    
Next cdp

'verwerken alle values van de controls NAAR de custom document properties
Dim obj As control
Dim NewValue
For Each obj In FrmDocVariables.Controls

    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" And obj.Parent.Visible = True Then 'Aanpassing AVS 16022010 ivm Fiscaal SubForm
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
            'oftwel de variabele is nieuw ingevuld en dient aangemaakt te worden
               
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
            'of te wel de variabele bestaat al en de waarde dient te worden vervangen.
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
            
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                'Aanpassing AVS 16022010 ivm Fiscaal SubForm
                If obj.Parent.Visible = True Then
                    ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                End If
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

'variablen zonder quote opnemen
'******************************
NQ_Variables = Array("TxtStr_RepYear_PY", "TxtStr_RepYear_CY", "TxtStr_DocVar_FirstDay", "TxtStr_DocVar_LastDay", _
"TxtStr_DocVar_StatMan_Place", "TxtStr_S_DocVar_StatMan_Date", _
"TxtStr_S_DocVar_AudiRep_Place", "TxtStr_DocVar_AudiRep_IntPlace", _
"TxtStr_S_DocVar_AudiRep_Date", "TxtStr_DocVar_AudiRep_Name_01", "TxtStr_DocVar_AudiRep_Name_02", _
"TxtStr_S_DocVar_AudiRep_IntDate", "TxtStr_DocVar_AudiRep_IntName_011", "TxtStr_DocVar_AudiRep_IntName_02", _
"TxtStr_DocVar_AudiRep_Title_01", "TxtStr_DocVar_AudiRep_Title_02", _
"TxtStr_DocVar_AudiRep_IntTitle_011", "TxtStr_DocVar_AudiRep_IntTitle_02", _
"TxtStr_RegData_CVR", "TxtStr_RegData_Adresse_Num", "TxtStr_RegData_Adresse", _
"TxtStr_RegData_Postbox", "TxtStr_RegData_PostNr", "TxtStr_RegData_PostBy", "TxtStr_RegData_KontorTelefon", "TxtStr_RegData_KontorFax", _
"TxtStr_RegData_Virksomhedsnavn1", "TxtStr_RegData_Virksomhedsnavn2", _
"TxtStr_RegData_Virksomhedsnavn1_2AUD", "TxtStr_RegData_Virksomhedsnavn2_2AUD", "TxtStr_RegData_CVR_2AUD", _
"TxtStr_RegData_IntVirksomhedsnavn1", "TxtStr_RegData_IntVirksomhedsnavn2", _
"TxtStr_S_CompDet_Exec_Name_01", "TxtStr_S_CompDet_Exec_Name_02", "TxtStr_S_CompDet_Exec_Name_03", _
"TxtStr_S_CompDet_Exec_Name_04", "TxtStr_S_CompDet_Exec_Name_05", "TxtStr_S_CompDet_Exec_Name_06", _
"TxtStr_S_CompDet_Exec_Name_07", "TxtStr_S_CompDet_Exec_Name_08", "TxtStr_S_CompDet_Exec_Name_09", _
"TxtStr_S_CompDet_Exec_Name_10", "TxtStr_S_CompDet_Exec_Name_11", "TxtStr_S_CompDet_Exec_Name_12", _
"TxtStr_S_CompDet_Super_Name_01", "TxtStr_S_CompDet_Super_Name_02", "TxtStr_S_CompDet_Super_Name_03", "TxtStr_S_CompDet_Super_Name_04", _
"TxtStr_S_CompDet_Super_Name_05", "TxtStr_S_CompDet_Super_Name_06", "TxtStr_S_CompDet_Super_Name_07", "TxtStr_S_CompDet_Super_Name_08", _
"TxtStr_S_CompDet_Super_Name_09", "TxtStr_S_CompDet_Super_Name_10", "TxtStr_S_CompDet_Super_Name_11", "TxtStr_S_CompDet_Super_Name_12", _
"TxtStr_S_CompDet_Super_Name_13", "TxtStr_S_CompDet_Super_Name_14", "TxtStr_S_CompDet_Super_Name_15", "TxtStr_S_CompDet_Super_Name_16", _
"TxtStr_S_CompDet_Super_Name_17", "TxtStr_S_CompDet_Super_Name_18", _
"TxtStr_S_Chairman", "TxtStr_S_Chairman_Title", _
"TxtStr_E_FinHigh_Ratio1_DS", "TxtStr_E_FinHigh_Ratio2_DS", "TxtStr_E_FinHigh_Ratio3_DS", "TxtStr_E_FinHigh_Ratio4_DS", "TxtStr_E_FinHigh_Ratio5_DS", _
"TxTStr_DocVar_NameClient", "TxtStr_S_CompDet_Annual_Date", "TxtStr_S_CompDet_Annual_Text", "TxtStr_S_CompDet_Comp_CBR", _
"TxtStr_S_CompDet_Comp_Street", "TxtStr_S_CompDet_Comp_StreetNum", "TxtStr_S_CompDet_Comp_Post", "TxtStr_S_CompDet_Comp_PostCity")


For X = 0 To UBound(NQ_Variables)
   
        bestaat = GetDocPropNameErr(NQ_Variables(X))
       
            If bestaat = "N/A" Then
                
                Bestaat3 = GetDocPropNameErr(NQ_Variables(X) & "_NQ")
                If Bestaat3 = "N/A" Then
                
                                       
                Else
                
                   ActiveDocument.CustomDocumentProperties(NQ_Variables(X) & "_NQ").Delete
                
                End If
                
            Else
                ValueDVF = ActiveDocument.CustomDocumentProperties(NQ_Variables(X)).value
                
                Bestaat2 = GetDocPropNameErr(NQ_Variables(X) & "_NQ")
                If Bestaat2 = "N/A" Then
                
                    ActiveDocument.CustomDocumentProperties.Add NQ_Variables(X) & "_NQ", False, msoPropertyTypeString, Mid(ValueDVF, 2, 100)
                    
                Else
                
                    ActiveDocument.CustomDocumentProperties(NQ_Variables(X) & "_NQ").value = Mid(ValueDVF, 2, 100)
                
                End If
                
            End If
               
Next

'BEPE: genindstiller enabled for revisordato
'If Me.ChkBoo_S_Data Then
'    Me.TxtStr_S_DocVar_AudiRep_Date.Enabled = False
'Else
'    Me.TxtStr_S_DocVar_AudiRep_Date.Enabled = True
'End If

'WriteccData

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************
ActiveDocument.Fields.Update
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub CmdSpec_DocVar_Click()
SelectSubForm
End Sub

Private Sub CmdRegDataUpdate_Click()
GetRegData
End Sub

Private Sub CmdSpec_FinAss_Click()
    Load FrmFinAss
    FrmFinAss.Show
    
'    'add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_FIXEDAS") = "N/A" Then
'        Me.Sub_Empty_FIXEDAS.Caption = True
'    Else
'        Me.Sub_Empty_FIXEDAS.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_FIXEDAS").Value
'    End If
'    CalculateSum
End Sub



Private Sub CmdSpec_FixAssInv_Click()
    Load FrmFixedAs2
    FrmFixedAs2.Show
'    'add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_FIXEDAS2") = "N/A" Then
'        Me.Sub_Empty_FIXEDAS2.Caption = True
'    Else
'        Me.Sub_Empty_FIXEDAS2.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_FIXEDAS2").Value
'    End If
'    CalculateSum
End Sub
'Kapitalandele (oms|fffd|tning) (Moder)
Private Sub CmdSpec_Inv_Click()
    
If BooIsConsolidated Then
   ' Load FrmInv_E
   Load FrmInv
    FrmInv.Show
     'add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_E_Inv") = "N/A" Then
'        Me.Sub_Empty_E_Inv.Caption = True
'    Else
'        Me.Sub_Empty_E_Inv.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_E_Inv").Value
'    End If
'    CalculateSum
Else
    Load FrmInv
    FrmInv.Show
'     'add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_Inv") = "N/A" Then
'        Me.Sub_Empty_Inv.Caption = True
'    Else
'        Me.Sub_Empty_Inv.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_Inv").Value
'    End If
    
End If
'    CalculateSum

End Sub

Private Sub CmdSpec_KonCashFlow_Click()
Load FrmCashFlow
FrmCashFlow.Show
End Sub

'Anl|fffd|gsaktiver (Koncern)
Private Sub CmdSpec_KonFinAss_Click()
Load FrmFinAss
FrmFinAss.Show

''add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_C_FIXEDAS") = "N/A" Then
'        Me.Sub_Empty_C_FIXEDAS.Caption = True
'    Else
'        Me.Sub_Empty_C_FIXEDAS.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_C_FIXEDAS").value
'    End If
'   CalculateSum
End Sub

Private Sub CmdSpec_KonFinHigh_Click()
Load FrmFinHigh
FrmFinHigh.Show

End Sub

'Bev|fffd|gelser i virksomhedskapitalen
Private Sub CmdSpec_SharCap_Click()
SelectSubForm

End Sub

'Egne kapitalandele (Moder)
Private Sub CmdSpec_Treasure_Click()
    Load FrmTreasure
    FrmTreasure.Show
    
'    'add by BEPE, get information from subforms about specification for notes
'    If GetDocPropNameErr("Sub_Empty_E_SHARCAP2") = "N/A" Then
'        Me.Sub_Empty_E_SHARCAP2.Caption = True
'    Else
'        Me.Sub_Empty_E_SHARCAP2.Caption = ActiveDocument.CustomDocumentProperties("Sub_Empty_E_SHARCAP2").Value
'    End If
'    CalculateSum
End Sub

Private Sub CommandButton_Data_Click()
'add by bepe; updates date in variables

    On Error GoTo Fout
    'update primo date
    Me.TxtStr_DocVar_FirstDay.value = ConvStringToDate_DK(Me.TxtStr_DocVar_FirstDay)
    Me.TxtDat_BeginDate_PY.value = Date_PlusYear(Me.TxtStr_DocVar_FirstDay.value)
    Me.TxtDat_BeginDate_PY_1.value = Date_PlusYear(Me.TxtDat_BeginDate_PY.value)
    Me.TxtDat_BeginDate_PY_2.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_1.value)
    Me.TxtDat_BeginDate_PY_3.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_2.value)
    Me.TxtDat_BeginDate_PY_4.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_3.value)
    
    'update ultimo date
    Me.TxtStr_DocVar_LastDay.value = ConvStringToDate_DK(Me.TxtStr_DocVar_LastDay)
    Me.TxtDat_EndDate_PY.value = Date_PlusYear(Me.TxtStr_DocVar_LastDay.value)
    Me.TxtDat_EndDate_PY_1.value = Date_PlusYear(Me.TxtDat_EndDate_PY.value)
    Me.TxtDat_EndDate_PY_2.value = Date_PlusYear(Me.TxtDat_EndDate_PY_1.value)
    Me.TxtDat_EndDate_PY_3.value = Date_PlusYear(Me.TxtDat_EndDate_PY_2.value)
    Me.TxtDat_EndDate_PY_4.value = Date_PlusYear(Me.TxtDat_EndDate_PY_3.value)

    ' primo year
    frist_Year = Me.TxtStr_RepYear_CY.value
    If IsNumeric(frist_Year) And Len(frist_Year) = 4 Then
        Me.TxtStr_RepYear_PY.value = frist_Year - 1
        Me.TxtStr_RepYear_PY1.value = frist_Year - 2
        Me.TxtStr_RepYear_PY2.value = frist_Year - 3
        Me.TxtStr_RepYear_PY3.value = frist_Year - 4
        Me.TxtStr_RepYear_PY4.value = frist_Year - 5
    End If
    
Fout:

End Sub

'Nettooms|fffd|tningen
Private Sub CommandButton13_Click()
SelectSubForm
End Sub

Private Sub CommandButton14_Click()
Load FrmDocVarConSul
    FrmDocVarConSul.Show
End Sub

Private Sub CommandButton15_Click()

Dim url As String
Dim error_count As Boolean
error_count = False

url = Me.TxtStr_CORPRES_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

url = Me.TxtStr_SEX_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

url = Me.TxtStr_BUSMAN_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

url = Me.TxtStr_FOUNDATION_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

url = Me.TxtStr_DISTPOLICY_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

url = Me.TxtStr_PAYTOAUTH_URL.value
If IsActiveUrl(url) = False And url <> "" Then
    MsgBox url + " URL adressen findes ikke"
    error_count = True
End If

If error_count = False Then MsgBox "Kontrol gennemf|fffd|rt"
    
End Sub








'Egne kapitalandele erhvervet af dattervirksomheder (Moder)
Private Sub CommandButton2_Click()
    Load FrmTreasureSub
    FrmTreasureSub.Show
End Sub

Private Sub CommandButton3_Click()
Load FrmKonTreasure
FrmKonTreasure.Show

End Sub
'transaktioner med n|fffd|rtst|fffd|ende parter (moder)
Private Sub CommandButton20_Click()
SelectSubForm
End Sub










Private Sub listNavigate_Click()
'deze routine selecteert het sheet van de multitab na een dubbelklik in navigatiepane

Dim SelItem
Dim TestTab
'SelItem = FrmDocVariables.listNavigate.SelectedItem.Index
'FrmDocVariables.MultiPage1.Value = SelItem - 1

SelItem = FrmDocVariables.listNavigate.SelectedItem.Text
For Each PageTab In FrmDocVariables.MultiPage1.Pages
    
    TestTab = PageTab.Caption
    If TestTab = SelItem Then
    
        FrmDocVariables.MultiPage1.value = PageTab.index
        
    End If
    
Next PageTab
End Sub

Private Sub cmdcancel_Click()
    bestaat = GetDocPropNameErr("AutoGenerateCancel")
    If bestaat = "N/A" Then
        ActiveDocument.CustomDocumentProperties.Add "AutoGenerateCancel", False, msoPropertyTypeBoolean, "True"
    End If
    Unload Me
End Sub

Private Sub LstInt_Audit_Opinion_Change()
changesettings
End Sub

Private Sub LstInt_Audit_type_Change()
changesettings
change_Audittype
End Sub

Private Sub LstInt_CashFlow_Change()
    If Me.LstInt_CashFlow.value = "Ja" Then
        Me.TxtInt_PgDocVar_MG_Kasstr.value = 1
    Else
        Me.TxtInt_PgDocVar_MG_Kasstr.value = ""
    End If
End Sub

Private Sub LstInt_CH_ACC_Change()
ChkForcedBox
End Sub

Private Sub LstInt_CLASS_CD_Change()
ChkForcedBox
End Sub

Private Sub LstInt_FINHIGH_Change()
    If Me.LstInt_FINHIGH.value = "Ja" Then
        Me.TxtInt_PgDocVar_FinHigh.value = 1
    Else
        Me.TxtInt_PgDocVar_FinHigh.value = ""
    End If
End Sub

Private Sub LstInt_FUNDS_Change()
ChkForcedBox
End Sub

Private Sub LstInt_Management_Change()
    Manacom_CHK
End Sub

Private Sub LstInt_Period_Change()
Autidrep_settings
End Sub

Private Sub MultiPage1_Change()
cmdCalculate_Click
End Sub

Private Sub TxtDat_Start_BeforeUpdate(ByVal cancel As MSForms.ReturnBoolean)
    TxtDat_Start.value = ConvStringToDate(TxtDat_Start.value)
End Sub
Private Sub TxtDat_Start01_BeforeUpdate(ByVal cancel As MSForms.ReturnBoolean)
    TxtDat_Start01.value = ConvStringToDate(TxtDat_Start01.value)
End Sub





Private Sub ToggleButton1_Click()
    If Me.LstInt_Audit_type.value = "Revision" Then
        OpenWebSite "https://techlib.deloitte.com/default.aspx?view=content&id=0901ff8181609a2f" 'revision
    ElseIf Me.LstInt_Audit_type.value = "Assistance" Then
        OpenWebSite "https://techlib.deloitte.com/default.aspx?view=content&id=0901ff8180f3f26b" 'asssitance
    ElseIf Me.LstInt_Audit_type.value = "Review" Then
        OpenWebSite "https://techlib.deloitte.com/default.aspx?view=content&id=0901ff8180f4b184" 'Review
    Else
        OpenWebSite "https://techlib.deloitte.com/default.aspx?view=content&id=0901ff8180f4bbe2" 'Udvidet gennemgang
    End If

End Sub

Private Sub TxtDat_BeginDate_PY_1_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_BeginDate_PY_1.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_BeginDate_PY_1.value = cell_val
'        Me.Lbl_PgDocVarForced97.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtDat_BeginDate_PY_2_Exit(ByVal cancel As MSForms.ReturnBoolean)
  
    cell_val = ContentControl_Date(Me.TxtDat_BeginDate_PY_2.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_BeginDate_PY_2.value = cell_val
'        Me.Lbl_PgDocVarForced97.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtDat_BeginDate_PY_3_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_BeginDate_PY_3.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced95.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced95.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_BeginDate_PY_3.value = cell_val
'        Me.Lbl_PgDocVarForced95.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtDat_BeginDate_PY_4_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_BeginDate_PY_4.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced94.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced94.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_BeginDate_PY_4.value = cell_val
'        Me.Lbl_PgDocVarForced94.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub TxtDat_BeginDate_PY_Exit(ByVal cancel As MSForms.ReturnBoolean)
   ' cell_val = Me.TxtDat_BeginDate_PY.Value
    cell_val = ContentControl_Date(Me.TxtDat_BeginDate_PY.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced98.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced98.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_BeginDate_PY.value = cell_val
'        Me.Lbl_PgDocVarForced98.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub TxtDat_EndDate_PY_1_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_EndDate_PY_1.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_EndDate_PY_1.value = cell_val
'        Me.Lbl_PgDocVarForced97.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtDat_EndDate_PY_2_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_EndDate_PY_2.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced96.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced96.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_EndDate_PY_2.value = cell_val
'        Me.Lbl_PgDocVarForced96.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub TxtDat_EndDate_PY_3_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_EndDate_PY_3.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced96.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced96.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_EndDate_PY_3.value = cell_val
'        Me.Lbl_PgDocVarForced96.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub TxtDat_EndDate_PY_4_AfterUpdate()
    cell_val = ContentControl_Date(Me.TxtDat_EndDate_PY_4.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced97.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_EndDate_PY_4.value = cell_val
'        Me.Lbl_PgDocVarForced97.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtDat_EndDate_PY_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtDat_EndDate_PY.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced98.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced98.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtDat_EndDate_PY.value = cell_val
'        Me.Lbl_PgDocVarForced98.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub Rulllforward_Click()
 On Error GoTo Fout
    'update primo date
    Me.TxtStr_DocVar_FirstDay.value = ConvStringToDate_DK(Me.TxtStr_DocVar_FirstDay)
    Me.TxtDat_BeginDate_PY.value = Date_PlusYear(Me.TxtStr_DocVar_FirstDay.value)
    Me.TxtDat_BeginDate_PY_1.value = Date_PlusYear(Me.TxtDat_BeginDate_PY.value)
    Me.TxtDat_BeginDate_PY_2.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_1.value)
    Me.TxtDat_BeginDate_PY_3.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_2.value)
    Me.TxtDat_BeginDate_PY_4.value = Date_PlusYear(Me.TxtDat_BeginDate_PY_3.value)
    
    'update ultimo date
    Me.TxtStr_DocVar_LastDay.value = ConvStringToDate_DK(Me.TxtStr_DocVar_LastDay)
    Me.TxtDat_EndDate_PY.value = Date_PlusYear(Me.TxtStr_DocVar_LastDay.value)
    Me.TxtDat_EndDate_PY_1.value = Date_PlusYear(Me.TxtDat_EndDate_PY.value)
    Me.TxtDat_EndDate_PY_2.value = Date_PlusYear(Me.TxtDat_EndDate_PY_1.value)
    Me.TxtDat_EndDate_PY_3.value = Date_PlusYear(Me.TxtDat_EndDate_PY_2.value)
    Me.TxtDat_EndDate_PY_4.value = Date_PlusYear(Me.TxtDat_EndDate_PY_3.value)
'
    ' primo year
    frist_Year = Me.TxtStr_RepYear_CY.value
    If IsNumeric(frist_Year) And Len(frist_Year) = 4 Then
        Me.TxtStr_RepYear_PY.value = frist_Year - 1
        Me.TxtStr_RepYear_PY1.value = frist_Year - 2
        Me.TxtStr_RepYear_PY2.value = frist_Year - 3
        Me.TxtStr_RepYear_PY3.value = frist_Year - 4
        Me.TxtStr_RepYear_PY4.value = frist_Year - 5
    End If
    
Fout:
End Sub


Private Sub TxtStr_BUSMAN_URL_AfterUpdate()
Me.TxtStr_BUSMAN_URL.value = GetValidUrl(Me.TxtStr_BUSMAN_URL.value)
End Sub

Private Sub TxtStr_CORPRES_URL_AfterUpdate()
Me.TxtStr_CORPRES_URL.value = GetValidUrl(Me.TxtStr_CORPRES_URL.value)
End Sub

Private Sub TxtStr_DISTPOLICY_URL_AfterUpdate()
Me.TxtStr_DISTPOLICY_URL.value = GetValidUrl(Me.TxtStr_DISTPOLICY_URL.value)
End Sub

Private Sub TxtStr_DocVar_AudiRep_Name_01_2AUD_Change()
ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_AudiRep_Name_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_AudiRep_Title_01_2AUD_Change()
ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_AudiRep_Title_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_FirstDay_Exit(ByVal cancel As MSForms.ReturnBoolean)
    

    cell_val = ContentControl_Date(Me.TxtStr_DocVar_FirstDay.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced99.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced99.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced06.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtStr_DocVar_FirstDay.value = cell_val
'        Me.Lbl_PgDocVarForced99.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced06.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_LastDay_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtStr_DocVar_LastDay.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced99.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
'        Me.Lbl_PgDocVarForced99.ForeColor = vbRed
'        Me.Lbl_PgDocVarForced07.ForeColor = vbRed
        cancel = True
    Else
        Me.TxtStr_DocVar_LastDay.value = cell_val
'        Me.Lbl_PgDocVarForced99.ForeColor = vbBlue
'        Me.Lbl_PgDocVarForced07.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_NameClient_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox
End Sub

Private Sub TxtStr_DocVar_StatMan_Place_AfterUpdate()
    ChkForcedBox
End Sub

Private Sub TxtStr_FOUNDATION_URL_AfterUpdate()
Me.TxtStr_FOUNDATION_URL.value = GetValidUrl(Me.TxtStr_FOUNDATION_URL.value)
End Sub

Private Sub TxtStr_PAYTOAUTH_URL_AfterUpdate()
Me.TxtStr_PAYTOAUTH_URL.value = GetValidUrl(Me.TxtStr_PAYTOAUTH_URL.value)
End Sub

Private Sub TxtStr_RegData_Adresse_AfterUpdate()
    ChkForcedBox
End Sub



Private Sub TxtStr_RegData_Adresse_num_AfterUpdate()
    ChkForcedBox
End Sub



Private Sub TxtStr_RegData_CVR_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_CVR(Me.TxtStr_RegData_CVR.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
       ' Me.Lbl_PgDocVarForced42.ForeColor = vbRed
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format XXXXXXXX"
       ' Me.Lbl_PgDocVarForced42.ForeColor = vbRed
    Else
        Me.TxtStr_RegData_CVR.value = cell_val
        'Me.Lbl_PgDocVarForced42.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_RegData_PostBy_Afterupdate()
ChkForcedBox
End Sub

Private Sub TxtStr_RegData_PostNr_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = Me.TxtStr_RegData_PostNr.value
    control_num = IsNumeric(cell_val)
    If Len(cell_val) <> 4 Then control_num = False
    If cell_val = "" Then
'        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
       ' FrmDocVariables.Lbl_PgDocVarForced44.ForeColor = vbBlack
'        Cancel = True
    ElseIf control_num = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen, skal format v|fffd|re p|fffd| f|fffd|lgende form XXXX"
        'FrmDocVariables.Lbl_PgDocVarForced44.ForeColor = vbRed
        cancel = True
    Else
       ' FrmDocVariables.Lbl_PgDocVarForced44.ForeColor = vbBlue
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_RegData_Virksomhedsnavn1_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox
End Sub



Private Sub TxtStr_RepYear_CY_AfterUpdate()
ChkForcedBox
End Sub

Private Sub TxtStr_S_Chairman_AfterUpdate()
    ChkForcedBox
End Sub

Private Sub TxtStr_S_Chairman_Title_AfterUpdate()
ChkForcedBox
End Sub

Private Sub TxtStr_S_CompDet_Annual_Date_AfterUpdate()
cell_val = ContentControl_Date(Me.TxtStr_S_CompDet_Annual_Date.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
        
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
        Me.TxtStr_S_CompDet_Annual_Date.value = ""
    Else
        Me.TxtStr_S_CompDet_Annual_Date.value = cell_val
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_S_CompDet_Annual_Text_AfterUpdate()
ChkForcedBox
End Sub

Private Sub TxtStr_S_CompDet_Comp_CBR_Exit(ByVal cancel As MSForms.ReturnBoolean)
  
    cell_val = ContentControl_CVR(Me.TxtStr_S_CompDet_Comp_CBR.value)
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
        'Me.Lbl_PgDocVarForced17.ForeColor = vbRed
        
        'cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format XXXXXXXX"
        'Me.Lbl_PgDocVarForced17.ForeColor = vbRed
       
        cancel = True
    Else
        Me.TxtStr_S_CompDet_Comp_CBR.value = cell_val
        'Me.Lbl_PgDocVarForced17.ForeColor = vbBlue
       
    End If
    ChkForcedBox
End Sub

Private Sub TxtStr_S_CompDet_Comp_Fax_AfterUpdate()
    cell_val = Me.TxtStr_S_CompDet_Comp_Fax.value
    Me.TxtStr_S_CompDet_Comp_Fax.value = Replace(cell_val, " ", "")
End Sub



Private Sub TxtStr_S_CompDet_Comp_Founded_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ContentControl_Date(Me.TxtStr_S_CompDet_Comp_Founded.value)
    If cell_val = "" Then
'       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
'        Me.Lbl_PgDocVarForced19.ForeColor = vbRed
'
'        Cancel = True
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
       ' Me.Lbl_PgDocVarForced19.ForeColor = vbRed
        
        cancel = True
    Else
        Me.TxtStr_S_CompDet_Comp_Founded.value = cell_val
       ' Me.Lbl_PgDocVarForced19.ForeColor = vbBlue
        
    End If
End Sub

Private Sub TxtStr_S_CompDet_Comp_Phone_AfterUpdate()
cell_val = Me.TxtStr_S_CompDet_Comp_Phone.value
Me.TxtStr_S_CompDet_Comp_Phone.value = Replace(cell_val, " ", "")
End Sub

Private Sub TxtStr_S_CompDet_Comp_Post_AfterUpdate()
ChkForcedBox
End Sub
Private Sub TxtStr_S_CompDet_Comp_PostCity_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox

End Sub

Private Sub TxtStr_S_CompDet_Comp_Registered_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = Me.TxtStr_S_CompDet_Comp_Registered.value
    If cell_val = "" Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
       ' Me.Lbl_PgDocVarForced18.ForeColor = vbRed
        
        cancel = True
    ElseIf cell_val = "Registreret i (Sted)" Then
        'Me.Lbl_PgDocVarForced18.ForeColor = &H80FF&
     
    Else
        'Me.Lbl_PgDocVarForced18.ForeColor = vbBlue
    End If
ChkForcedBox
End Sub

Private Sub TxtStr_S_CompDet_Comp_Street_Exit(ByVal cancel As MSForms.ReturnBoolean)
    ChkForcedBox

End Sub


Private Sub TxtStr_S_CompDet_Comp_StreetNum_AfterUpdate()
    ChkForcedBox
End Sub

'datering for revisorp|fffd|tegning
Private Sub TxtStr_S_DocVar_AudiRep_Date_AfterUpdate()
    cell_val = ContentControl_Date(Me.TxtStr_S_DocVar_AudiRep_Date.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
        
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
        Me.TxtStr_S_DocVar_AudiRep_Date.value = ""
    Else
        Me.TxtStr_S_DocVar_AudiRep_Date.value = cell_val
    End If
    ChkForcedBox
End Sub



Private Sub TxtStr_S_DocVar_AudiRep_Place_AfterUpdate()
ChkForcedBox
End Sub

'datering for ledelsen underskrift, kontrollere om dato har korrekt format
Private Sub TxtStr_S_DocVar_StatMan_Date_AfterUpdate()
cell_val = ContentControl_Date(Me.TxtStr_S_DocVar_StatMan_Date.value)
    If cell_val = "" Then
       MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen kan dette felt ikke v|fffd|re tomt"
        
    ElseIf cell_val = False Then
        MsgBox "Fejlmeddelelse: Af hensyn til den elektroniske indberetning til erhvervsstyrelsen skal dette felt have f|fffd|lgende format dd.mm.yyyy"
        Me.TxtStr_S_DocVar_StatMan_Date.value = ""
    Else
        Me.TxtStr_S_DocVar_StatMan_Date.value = cell_val
    End If
    ChkForcedBox
    
End Sub

Private Sub TxtStr_S_Lconver_01_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Lconver_01_Deadl)
    Me.TxtStr_S_Lconver_01_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Lconver_02_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Lconver_02_Deadl)
    Me.TxtStr_S_Lconver_02_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Lconver_03_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Lconver_03_Deadl)
    Me.TxtStr_S_Lconver_03_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Lconver_04_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Lconver_04_Deadl)
    Me.TxtStr_S_Lconver_04_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Lconver_05_Deadl_AfterUpdate()
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Lconver_05_Deadl)
    Me.TxtStr_S_Lconver_05_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Sconver_01_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Sconver_01_Deadl)
    Me.TxtStr_S_Sconver_01_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Sconver_02_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Sconver_02_Deadl)
    Me.TxtStr_S_Sconver_02_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Sconver_03_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Sconver_03_Deadl)
    Me.TxtStr_S_Sconver_03_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Sconver_04_Deadl_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Sconver_04_Deadl)
    Me.TxtStr_S_Sconver_01_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Sconver_05_Deadl_AfterUpdate()
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Sconver_05_Deadl)
    Me.TxtStr_S_Sconver_05_Deadl.value = cell_val
End Sub

Private Sub TxtStr_S_Withd_01_Due_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Withd_01_Due)
    Me.TxtStr_S_Withd_01_Due.value = cell_val
End Sub

Private Sub TxtStr_S_Withd_02_Due_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Withd_02_Due)
    Me.TxtStr_S_Withd_02_Due.value = cell_val
End Sub

Private Sub TxtStr_S_Withd_03_Due_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Withd_03_Due)
    Me.TxtStr_S_Withd_03_Due.value = cell_val
End Sub

Private Sub TxtStr_S_Withd_04_Due_Exit(ByVal cancel As MSForms.ReturnBoolean)
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Withd_04_Due)
    Me.TxtStr_S_Withd_04_Due.value = cell_val
End Sub

Private Sub TxtStr_S_Withd_05_Due_AfterUpdate()
    cell_val = ConvStringToDate_DK(Me.TxtStr_S_Withd_05_Due)
    Me.TxtStr_S_Withd_05_Due.value = cell_val
End Sub

Private Sub TxtStr_SEX_URL_AfterUpdate()
Me.TxtStr_SEX_URL.value = GetValidUrl(Me.TxtStr_SEX_URL.value)
End Sub

Private Sub TxtStr_XBRL_Email_AfterUpdate()
 ChkForcedBox
End Sub

Private Sub UserForm_Initialize()

'opslaan van een aantal setvelden in de CDP's ten behoeve van bedrijfsvergelijking.
'De velden worden voorafgegaan door BVG (bedrijfsvergelijking) in de cdp's
'''vastlegging_SET_in_CDP

'Deze routine bevat een opsomming van de verschillende procedures die de migratie van CDP's regelt van 2007 naar 2009
'''Migratie

'het opbouwen van de list boxen op het dialoog (vullen van de lijssies)
InitializeLists

'Toevoeging Denemarken:

bestaat = GetDocPropNameErr("TxtStr_RegData_Virksomhedsnavn1")
If bestaat = "N/A" Then
GetRegData
If Me.TxtStr_RegData_Postbox.value = " " Then Me.TxtStr_RegData_Postbox.value = ""
End If



    If Me.LstInt_CashFlow.value = "Ja" Then
        Me.TxtInt_PgDocVar_MG_Kasstr.value = ""
    Else
        Me.TxtInt_PgDocVar_MG_Kasstr.value = 1
    End If

'het vastleggen van de visuele status van enkele niet forced nodes
'o.a. ten behoeve van pubnummering

PubNummering 'Arco to implement

'Definieren van de kolommen van het navigation pane
FrmDocVariables.listNavigate.ColumnHeaders.Add , , "NAVIGATIE :", FrmDocVariables.listNavigate.Width / 1.4
FrmDocVariables.listNavigate.ColumnHeaders.Add , , "Status", FrmDocVariables.listNavigate.Width / 4

'Definieren van de kolommen van statusoverzicht

FrmDocVariables.listTemplates.ColumnHeaders.Add , , "Template", FrmDocVariables.listTemplates.Width / 2.5
FrmDocVariables.listTemplates.ColumnHeaders.Add , , "Version", FrmDocVariables.listTemplates.Width / 1.7
FrmDocVariables.listTemplates.View = lvwReport
FrmDocVariables.listTemplates.ListItems.Clear


'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
    
End If

'initieel alle Boo_Spec lables op true zetten zodat indien niet gevoed door excel het tabblad zichtbaar blijft
For Each Object In FrmDocVariables.Controls
    
    If InStr(1, UCase(Object.Name), "BOO_SPEC") > 0 Then
        Object.Caption = "TRUE"
    End If

Next Object

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
    
    'specifieke velden ten behoeve van statusoverzicht worden eruit gefilterd en in overzicht opgenomen
    If InStr(1, LCase(cdp.Name), "template_ds_") > 0 Then
        posSlash = InStr(1, cdp.value, "/")
        FrmDocVariables.listTemplates.ListItems.Add , , Left(cdp.value, posSlash - 1)
        FrmDocVariables.listTemplates.ListItems(counter2).SubItems(1) = Mid(cdp.value, posSlash + 1, 100)
        counter2 = counter2 + 1
    End If
    
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In FrmDocVariables.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        FrmDocVariables(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         FrmDocVariables(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            FrmDocVariables(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            'MsgBox FrmDocVariables(Obj.Name).Name
                                    FrmDocVariables(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    FrmDocVariables(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                FrmDocVariables(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj

'tonen / verbergen tabbladen (incl controls)
ShowHideMultipageControls

'ADD by BEPE, validations of subforms
Subform_Value 'henter v|fffd|rdier fra underforms

'selecteren van de eerste sheet (documentvariabelen)
FrmDocVariables.MultiPage1.value = 0

'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
cmdCalculate_Click


'Manacom_CHK 'bestemmer om mulighed for fra og til valgt af ledelsesberetning skal med i f|fffd|rste fane

CompDet_Annual_Chk
CC_Controls
End Sub

Attribute VB_Name = "FrmFinAss"
Attribute VB_Base = "0{4B0D24CE-7AC4-49D1-BF72-81FA9D470E7E}{17A323DE-C703-498E-8390-3026367E7A36}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False








Private Sub cmdCalculate_Click()
Calculat_FrmFinAss
End Sub

Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_Fin As Boolean ' Add by BEPE. controls for values in subform, information are show in navigationspanel
Empty_Fin = True
Dim Empty_SharCap 'Add by BEPE. controls for values in subform, information are show in navigationspanel
Empty_SharCap = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls

     If InStr(1, UCase(obj.Name), "TXTINT_S_ITA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_TFA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_FAI_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_Fin = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    ElseIf InStr(1, UCase(obj.Name), "TXTINT_S_SHARCAP_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                    Exit Sub
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_SharCap = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    End If
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj
'add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_FIXEDAS") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_FIXEDAS", False, msoPropertyTypeString, Empty_Fin
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_FIXEDAS").value = CStr(Empty_Fin)
'End If
'FrmDocVariables.Sub_Empty_FIXEDAS.Caption = Empty_Fin
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub



Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")
Dim MpHidStatus As Boolean
Dim MpObject As control
If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If
RegnClass = GetDocPropNameErr("DARTLBL_FSnaam")

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp
For Each PageTab In FrmFinAss.MultiPage1.Pages
        MpHidStatus = False
        If BooIsConsolidated = False Then
            If InStr(1, UCase(PageTab.Caption), "(KONCERN)") > 0 Then
                MpHidStatus = True
            Else
                MpHidStatus = False
                
                'verwijderen (E) extention
                If InStr(1, UCase(PageTab.Caption), "(MODER)") > 0 Then
                
                    PageTab.Caption = Left(PageTab.Caption, Len(PageTab.Caption) - 8)
                
                End If
                
            End If
            
        Else
            If PageTab.Tag = "Consolidated" Then
                PageTab.Caption = PageTab.Caption & " (Koncern) "
            End If
        End If
        
        If MpHidStatus = True Then
        PageTab.Visible = False
        For Each MpObject In PageTab.Controls
            MpObject.Visible = False
        Next MpObject
    
        Else
        PageTab.Visible = True
        For Each MpObject In PageTab.Controls
            MpObject.Visible = True
        Next MpObject
        End If
    
Next PageTab
    
'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls
    If RegnClass = "Mikro B" And obj.Tag = "Mikro_false" Then
                    obj.Visible = False
    End If
    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then

                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted

                    Else

                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)

                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
Calculat_FrmFinAss

End Sub
Attribute VB_Name = "FrmFinHigh"
Attribute VB_Base = "0{EC470E4C-9EBB-4BCC-8536-065A30E30421}{69080248-83B6-434B-9979-A55D8B4ECCCD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Private Sub cmdCalculate_Click()

    CalculateFinHigh

End Sub

Private Sub cmdcancel_Click()

    Unload Me

End Sub

Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls

    'add by bepe,  validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
            
                Empty_SHARCAP2 = True
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If


    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub ComboBox1_Change()

End Sub

Private Sub CommandButton1_Click()

On Error GoTo Errorhandler

'n|fffd|gletal
NewYear CY:=Me.TxtInt_FinHigh_Ratio3_CY, CY1:=Me.TxtInt_FinHigh_Ratio3_CY1, CY2:=Me.TxtInt_FinHigh_Ratio3_CY2, CY3:=Me.TxtInt_FinHigh_Ratio3_CY3, CY4:=Me.TxtInt_FinHigh_Ratio3_CY4
NewYear CY:=Me.TxtInt_FinHigh_Ratio4_CY, CY1:=Me.TxtInt_FinHigh_Ratio4_CY1, CY2:=Me.TxtInt_FinHigh_Ratio4_CY2, CY3:=Me.TxtInt_FinHigh_Ratio4_CY3, CY4:=Me.TxtInt_FinHigh_Ratio4_CY4
NewYear CY:=Me.TxtInt_FinHigh_Ratio6_CY, CY1:=Me.TxtInt_FinHigh_Ratio6_CY1, CY2:=Me.TxtInt_FinHigh_Ratio6_CY2, CY3:=Me.TxtInt_FinHigh_Ratio6_CY3, CY4:=Me.TxtInt_FinHigh_Ratio6_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Ratio1_CY, CY1:=Me.TxtInt_E_FinHigh_Ratio1_CY1, CY2:=Me.TxtInt_E_FinHigh_Ratio1_CY2, CY3:=TxtInt_E_FinHigh_Ratio1_CY3, CY4:=Me.TxtInt_E_FinHigh_Ratio1_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Ratio2_CY, CY1:=Me.TxtInt_E_FinHigh_Ratio2_CY1, CY2:=Me.TxtInt_E_FinHigh_Ratio2_CY2, CY3:=TxtInt_E_FinHigh_Ratio2_CY3, CY4:=Me.TxtInt_E_FinHigh_Ratio2_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Ratio3_CY, CY1:=Me.TxtInt_E_FinHigh_Ratio3_CY1, CY2:=Me.TxtInt_E_FinHigh_Ratio3_CY2, CY3:=TxtInt_E_FinHigh_Ratio3_CY3, CY4:=Me.TxtInt_E_FinHigh_Ratio3_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Ratio4_CY, CY1:=Me.TxtInt_E_FinHigh_Ratio4_CY1, CY2:=Me.TxtInt_E_FinHigh_Ratio4_CY2, CY3:=TxtInt_E_FinHigh_Ratio4_CY3, CY4:=Me.TxtInt_E_FinHigh_Ratio4_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Ratio5_CY, CY1:=Me.TxtInt_E_FinHigh_Ratio5_CY1, CY2:=Me.TxtInt_E_FinHigh_Ratio5_CY2, CY3:=TxtInt_E_FinHigh_Ratio5_CY3, CY4:=Me.TxtInt_E_FinHigh_Ratio5_CY4

'hovedtal
NewYear CY:=Me.TxtInt_E_FinHigh_Revenue_CY2, CY1:=Me.TxtInt_E_FinHigh_Revenue_CY3, CY2:=Me.TxtInt_E_FinHigh_Revenue_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_GrossProfit_CY2, CY1:=Me.TxtInt_E_FinHigh_GrossProfit_CY3, CY2:=Me.TxtInt_E_FinHigh_GrossProfit_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_GrossProfit2_CY2, CY1:=Me.TxtInt_E_FinHigh_GrossProfit2_CY3, CY2:=Me.TxtInt_E_FinHigh_GrossProfit2_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Primary_CY, CY1:=Me.TxtInt_E_FinHigh_Primary_CY1, CY2:=Me.TxtInt_E_FinHigh_Primary_CY2, CY3:=Me.TxtInt_E_FinHigh_Primary_CY3, CY4:=Me.TxtInt_E_FinHigh_Primary_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Operating_CY2, CY1:=Me.TxtInt_E_FinHigh_Operating_CY3, CY2:=Me.TxtInt_E_FinHigh_Operating_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_NetFinan_CY2, CY1:=Me.TxtInt_E_FinHigh_NetFinan_CY3, CY2:=Me.TxtInt_E_FinHigh_NetFinan_CY4
'NewYear CY:=Me.TxtInt_E_FinHigh_ResExtra_CY2, CY1:=Me.TxtInt_E_FinHigh_ResExtra_CY3, CY2:=Me.TxtInt_E_FinHigh_ResExtra_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_PLYear_CY2, CY1:=Me.TxtInt_E_FinHigh_PLYear_CY3, CY2:=Me.TxtInt_E_FinHigh_PLYear_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_BalTot_CY2, CY1:=Me.TxtInt_E_FinHigh_BalTot_CY3, CY2:=Me.TxtInt_E_FinHigh_BalTot_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_InvPPE_CY, CY1:=Me.TxtInt_E_FinHigh_InvPPE_CY1, CY2:=Me.TxtInt_E_FinHigh_InvPPE_CY2, CY3:=Me.TxtInt_E_FinHigh_InvPPE_CY3, CY4:=Me.TxtInt_E_FinHigh_InvPPE_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Equity_CY2, CY1:=Me.TxtInt_E_FinHigh_Equity_CY3, CY2:=Me.TxtInt_E_FinHigh_Equity_CY4, CY3:=Me.TxtInt_E_FinHigh_Equity_CY5
'kun koncern
NewYear CY:=Me.TxtInt_E_FinHigh_Equity2_CY2, CY1:=Me.TxtInt_E_FinHigh_Equity2_CY3, CY2:=Me.TxtInt_E_FinHigh_Equity2_CY4, CY3:=Me.TxtInt_E_FinHigh_Equity2_CY5

NewYear CY:=Me.TxtInt_E_FinHigh_DepIntangi_CY, CY1:=Me.TxtInt_E_FinHigh_DepIntangi_CY1, CY2:=Me.TxtInt_E_FinHigh_DepIntangi_CY2, CY3:=Me.TxtInt_E_FinHigh_DepIntangi_CY3, CY4:=Me.TxtInt_E_FinHigh_DepIntangi_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_CFO_CY2, CY1:=Me.TxtInt_E_FinHigh_CFO_CY3, CY2:=Me.TxtInt_E_FinHigh_CFO_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_CFI_CY2, CY1:=Me.TxtInt_E_FinHigh_CFI_CY3, CY2:=Me.TxtInt_E_FinHigh_CFI_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_CFF_CY2, CY1:=Me.TxtInt_E_FinHigh_CFF_CY3, CY2:=Me.TxtInt_E_FinHigh_CFF_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_InvCap_CY, CY1:=Me.TxtInt_E_FinHigh_InvCap_CY1, CY2:=Me.TxtInt_E_FinHigh_InvCap_CY2, CY3:=Me.TxtInt_E_FinHigh_InvCap_CY3, CY4:=Me.TxtInt_E_FinHigh_InvCap_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_IntBear_CY, CY1:=Me.TxtInt_E_FinHigh_IntBear_CY1, CY2:=Me.TxtInt_E_FinHigh_IntBear_CY2, CY3:=Me.TxtInt_E_FinHigh_IntBear_CY3, CY4:=Me.TxtInt_E_FinHigh_IntBear_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_Employ_CY, CY1:=Me.TxtInt_E_FinHigh_Employ_CY1, CY2:=Me.TxtInt_E_FinHigh_Employ_CY2, CY3:=Me.TxtInt_E_FinHigh_Employ_CY3, CY4:=Me.TxtInt_E_FinHigh_Employ_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_KeyFig_01_CY, CY1:=Me.TxtInt_E_FinHigh_KeyFig_01_CY1, CY2:=Me.TxtInt_E_FinHigh_KeyFig_01_CY2, CY3:=Me.TxtInt_E_FinHigh_KeyFig_01_CY3, CY4:=Me.TxtInt_E_FinHigh_KeyFig_01_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_KeyFig_02_CY, CY1:=Me.TxtInt_E_FinHigh_KeyFig_02_CY1, CY2:=Me.TxtInt_E_FinHigh_KeyFig_02_CY2, CY3:=Me.TxtInt_E_FinHigh_KeyFig_02_CY3, CY4:=Me.TxtInt_E_FinHigh_KeyFig_02_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_KeyFig_03_CY, CY1:=Me.TxtInt_E_FinHigh_KeyFig_03_CY1, CY2:=Me.TxtInt_E_FinHigh_KeyFig_03_CY2, CY3:=Me.TxtInt_E_FinHigh_KeyFig_03_CY3, CY4:=Me.TxtInt_E_FinHigh_KeyFig_03_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_KeyFig_04_CY, CY1:=Me.TxtInt_E_FinHigh_KeyFig_04_CY1, CY2:=Me.TxtInt_E_FinHigh_KeyFig_04_CY2, CY3:=Me.TxtInt_E_FinHigh_KeyFig_04_CY3, CY4:=Me.TxtInt_E_FinHigh_KeyFig_04_CY4
NewYear CY:=Me.TxtInt_E_FinHigh_KeyFig_05_CY, CY1:=Me.TxtInt_E_FinHigh_KeyFig_05_CY1, CY2:=Me.TxtInt_E_FinHigh_KeyFig_05_CY2, CY3:=Me.TxtInt_E_FinHigh_KeyFig_05_CY3, CY4:=Me.TxtInt_E_FinHigh_KeyFig_05_CY4

CalculateFinHigh
Exit Sub
Errorhandler:
MsgBox "Fejl: Rollover kunne ikke gennemsf|fffd|res"


End Sub






















Private Sub LstInt_Ratio_CF_01_Change()
 Ratio_Layout
End Sub

Private Sub LstInt_Ratio_CF_02_Change()
Ratio_Layout
End Sub

Private Sub LstInt_Ratio_CF_03_Change()
  Ratio_Layout
End Sub

'Enable 1. n|fffd|gletal
Private Sub LstInt_Ratio1_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio2_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio3_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio4_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio5_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio6_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio7_Change()
    Ratio_Layout
End Sub

Private Sub LstInt_Ratio8_Change()
    Ratio_Layout
End Sub

Private Sub Ratio_Layout()

'Hovedtal CFO
Dim layout_cfo As Boolean
layout_cfo = True
If Me.LstInt_Ratio_CF_01.value = "Skjul" Then layout_cfo = False
Me.Lbl_CFO.Enabled = layout_cfo
Me.LblInt_E_FinHigh_CFO_CY.Enabled = layout_cfo
Me.LblInt_E_FinHigh_CFO_CY1.Enabled = layout_cfo
Me.TxtInt_E_FinHigh_CFO_CY2.Enabled = layout_cfo
Me.TxtInt_E_FinHigh_CFO_CY3.Enabled = layout_cfo
Me.TxtInt_E_FinHigh_CFO_CY4.Enabled = layout_cfo

'hovedtal CFI
Dim layout_cfi As Boolean
layout_cfi = True
If Me.LstInt_Ratio_CF_02.value = "Skjul" Then layout_cfi = False
Me.Lbl_CFI.Enabled = layout_cfi
Me.LblInt_E_FinHigh_CFI_CY.Enabled = layout_cfi
Me.LblInt_E_FinHigh_CFI_CY1.Enabled = layout_cfi
Me.TxtInt_E_FinHigh_CFI_CY2.Enabled = layout_cfi
Me.TxtInt_E_FinHigh_CFI_CY3.Enabled = layout_cfi
Me.TxtInt_E_FinHigh_CFI_CY4.Enabled = layout_cfi

'hovedtal CFF
Dim layout_cff As Boolean
layout_cff = True
If Me.LstInt_Ratio_CF_03.value = "Skjul" Then layout_cff = False
Me.Lbl_CFF.Enabled = layout_cff
Me.LblInt_E_FinHigh_CFF_CY.Enabled = layout_cff
Me.LblInt_E_FinHigh_CFF_CY1.Enabled = layout_cff
Me.TxtInt_E_FinHigh_CFF_CY2.Enabled = layout_cff
Me.TxtInt_E_FinHigh_CFF_CY3.Enabled = layout_cff
Me.TxtInt_E_FinHigh_CFF_CY4.Enabled = layout_cff

Dim Gross As Boolean
Gross = True
If FrmDocVariables.LstInt_GROSS = "Nej" Then Gross = False

'n|fffd|gletal 1 (skjulter n|fffd|gletal hvis de er fravalgt eller at nettooms|fffd|tningen ikke vises for de n|fffd|gletal hvor nettooms|fffd|tningen ikke ind g|fffd|r.

Dim LayOut_Ratio1 As Boolean
LayOut_Ratio1 = True

If Me.LstInt_Ratio1.value = "Nej" Or Gross Then LayOut_Ratio1 = False

Me.Lbl_Bruttomargin.Enabled = LayOut_Ratio1
Me.Lbl_Bruttomargin_Cal.Enabled = LayOut_Ratio1
Me.LblInt_FinHigh_Ratio1_CY.Enabled = LayOut_Ratio1
Me.LblInt_FinHigh_Ratio1_CY1.Enabled = LayOut_Ratio1
Me.LblInt_FinHigh_Ratio1_CY2.Enabled = LayOut_Ratio1
Me.LblInt_FinHigh_Ratio1_CY3.Enabled = LayOut_Ratio1
Me.LblInt_FinHigh_Ratio1_CY4.Enabled = LayOut_Ratio1

'n|fffd|gletal 2
Dim LayOut_Ratio2 As Boolean
LayOut_Ratio2 = True
If Me.LstInt_Ratio2.value = "Nej" Or Gross Then LayOut_Ratio2 = False

Me.Lbl_Nettomargin.Enabled = LayOut_Ratio2
Me.Lbl_Nettomargin_cal.Enabled = LayOut_Ratio2
Me.LblInt_FinHigh_Ratio2_CY.Enabled = LayOut_Ratio2
Me.LblInt_FinHigh_Ratio2_CY1.Enabled = LayOut_Ratio2
Me.LblInt_FinHigh_Ratio2_CY2.Enabled = LayOut_Ratio2
Me.LblInt_FinHigh_Ratio2_CY3.Enabled = LayOut_Ratio2
Me.LblInt_FinHigh_Ratio2_CY4.Enabled = LayOut_Ratio2

'n|fffd|gletal 3
Dim LayOut_Ratio3 As Boolean
LayOut_Ratio3 = True
If Me.LstInt_Ratio3.value = "Nej" Then LayOut_Ratio3 = False

Me.Lbl_Afkast.Enabled = LayOut_Ratio3
Me.Lbl_Afkast_Cal.Enabled = LayOut_Ratio3
Me.LblInt_FinHigh_Ratio3_CY.Enabled = LayOut_Ratio3
Me.TxtInt_FinHigh_Ratio3_CY.Enabled = LayOut_Ratio3
Me.LblInt_FinHigh_Ratio3_CY1.Enabled = LayOut_Ratio3
Me.TxtInt_FinHigh_Ratio3_CY1.Enabled = LayOut_Ratio3
Me.LblInt_FinHigh_Ratio3_CY2.Enabled = LayOut_Ratio3
Me.TxtInt_FinHigh_Ratio3_CY2.Enabled = LayOut_Ratio3
Me.LblInt_FinHigh_Ratio3_CY3.Enabled = LayOut_Ratio3
Me.TxtInt_FinHigh_Ratio3_CY3.Enabled = LayOut_Ratio3
Me.LblInt_FinHigh_Ratio3_CY4.Enabled = LayOut_Ratio3
Me.TxtInt_FinHigh_Ratio3_CY4.Enabled = LayOut_Ratio3
Me.Lbl_DepIntangi.Enabled = LayOut_Ratio3
Me.LblInt_E_FinHigh_DepIntangi_CY.Enabled = LayOut_Ratio3
Me.TxtInt_E_FinHigh_DepIntangi_CY.Enabled = LayOut_Ratio3
Me.LblInt_E_FinHigh_DepIntangi_PY.Enabled = LayOut_Ratio3
Me.LblInt_E_FinHigh_DepIntangi_PY1.Enabled = LayOut_Ratio3
Me.LblInt_E_FinHigh_DepIntangi_PY2.Enabled = LayOut_Ratio3
Me.LblInt_E_FinHigh_DepIntangi_PY3.Enabled = LayOut_Ratio3
Me.TxtInt_E_FinHigh_DepIntangi_CY1.Enabled = LayOut_Ratio3
Me.TxtInt_E_FinHigh_DepIntangi_CY2.Enabled = LayOut_Ratio3
Me.TxtInt_E_FinHigh_DepIntangi_CY3.Enabled = LayOut_Ratio3
Me.TxtInt_E_FinHigh_DepIntangi_CY4.Enabled = LayOut_Ratio3

'n|fffd|gletal 4
Dim LayOut_Ratio4 As Boolean
LayOut_Ratio4 = True
If Me.LstInt_Ratio4.value = "Nej" Or Gross Then LayOut_Ratio4 = False

Me.Lbl_Nettooms.Enabled = LayOut_Ratio4
Me.Lbl_Nettooms_Cal.Enabled = LayOut_Ratio4
Me.LblInt_FinHigh_Ratio4_CY.Enabled = LayOut_Ratio4
Me.TxtInt_FinHigh_Ratio4_CY.Enabled = LayOut_Ratio4
Me.LblInt_FinHigh_Ratio4_CY1.Enabled = LayOut_Ratio4
Me.TxtInt_FinHigh_Ratio4_CY1.Enabled = LayOut_Ratio4
Me.LblInt_FinHigh_Ratio4_CY2.Enabled = LayOut_Ratio4
Me.TxtInt_FinHigh_Ratio4_CY2.Enabled = LayOut_Ratio4
Me.LblInt_FinHigh_Ratio4_CY3.Enabled = LayOut_Ratio4
Me.TxtInt_FinHigh_Ratio4_CY3.Enabled = LayOut_Ratio4
Me.LblInt_FinHigh_Ratio4_CY4.Enabled = LayOut_Ratio4
Me.TxtInt_FinHigh_Ratio4_CY4.Enabled = LayOut_Ratio4

'n|fffd|gletal 5
Dim LayOut_Ratio5 As Boolean
LayOut_Ratio5 = True
If Me.LstInt_Ratio5.value = "Nej" Then LayOut_Ratio5 = False

Me.Lbl_Finansiel.Enabled = LayOut_Ratio5
Me.Lbl_Finansiel_Cal.Enabled = LayOut_Ratio5
Me.LblInt_FinHigh_Ratio5_CY.Enabled = LayOut_Ratio5
Me.LblInt_FinHigh_Ratio5_CY1.Enabled = LayOut_Ratio5
Me.LblInt_FinHigh_Ratio5_CY2.Enabled = LayOut_Ratio5
Me.LblInt_FinHigh_Ratio5_CY3.Enabled = LayOut_Ratio5
Me.LblInt_FinHigh_Ratio5_CY4.Enabled = LayOut_Ratio5

'n|fffd|gletal 6
Dim LayOut_Ratio6 As Boolean
LayOut_Ratio6 = True
If Me.LstInt_Ratio6.value = "Nej" Then LayOut_Ratio6 = False

Me.Lbl_Egenkap.Enabled = LayOut_Ratio6
Me.Lbl_Egenkap_Cal.Enabled = LayOut_Ratio6
Me.LblInt_FinHigh_Ratio6_CY.Enabled = LayOut_Ratio6
Me.TxtInt_FinHigh_Ratio6_CY.Enabled = LayOut_Ratio6
Me.LblInt_FinHigh_Ratio6_CY1.Enabled = LayOut_Ratio6
Me.TxtInt_FinHigh_Ratio6_CY1.Enabled = LayOut_Ratio6
Me.LblInt_FinHigh_Ratio6_CY2.Enabled = LayOut_Ratio6
Me.TxtInt_FinHigh_Ratio6_CY2.Enabled = LayOut_Ratio6
Me.LblInt_FinHigh_Ratio6_CY3.Enabled = LayOut_Ratio6
Me.TxtInt_FinHigh_Ratio6_CY3.Enabled = LayOut_Ratio6
Me.LblInt_FinHigh_Ratio6_CY4.Enabled = LayOut_Ratio6
Me.TxtInt_FinHigh_Ratio6_CY4.Enabled = LayOut_Ratio6

'n|fffd|gletal 7
Dim LayOut_Ratio7 As Boolean
LayOut_Ratio7 = True
If Me.LstInt_Ratio7.value = "Nej" Then LayOut_Ratio7 = False

Me.Lbl_Soliditetsgrad.Enabled = LayOut_Ratio7
Me.Lbl_Soliditetsgrad_Cal.Enabled = LayOut_Ratio7
Me.LblInt_FinHigh_Ratio7_CY.Enabled = LayOut_Ratio7
Me.LblInt_FinHigh_Ratio7_CY1.Enabled = LayOut_Ratio7
Me.LblInt_FinHigh_Ratio7_CY2.Enabled = LayOut_Ratio7
Me.LblInt_FinHigh_Ratio7_CY3.Enabled = LayOut_Ratio7
Me.LblInt_FinHigh_Ratio7_CY4.Enabled = LayOut_Ratio7

'n|fffd|gletal 8
Dim LayOut_Ratio8 As Boolean
LayOut_Ratio8 = True
If Me.LstInt_Ratio8.value = "Nej" Or Gross Then LayOut_Ratio8 = False

Me.Lbl_Nettooms_Employ.Enabled = LayOut_Ratio8
Me.Lbl_Nettooms_Employ_Cal.Enabled = LayOut_Ratio8
Me.LblInt_FinHigh_Ratio8_CY.Enabled = LayOut_Ratio8
Me.LblInt_FinHigh_Ratio8_CY1.Enabled = LayOut_Ratio8
Me.LblInt_FinHigh_Ratio8_CY2.Enabled = LayOut_Ratio8
Me.LblInt_FinHigh_Ratio8_CY3.Enabled = LayOut_Ratio8
Me.LblInt_FinHigh_Ratio8_CY4.Enabled = LayOut_Ratio8

'hovedtal, skjulter hovedtal hvor nettooms|fffd|tningen indg|fffd|r hvor nettooms|fffd|tningen skjultes i rapporten.

Me.LblStr_E_FinHigh_Revenue.Enabled = Not Gross
Me.LblInt_E_FinHigh_Revenue_CY.Enabled = Not Gross
Me.LblInt_E_FinHigh_Revenue_PY.Enabled = Not Gross
Me.LblInt_E_FinHigh_Revenue_PY1.Enabled = Not Gross
Me.LblInt_E_FinHigh_Revenue_PY2.Enabled = Not Gross
Me.LblInt_E_FinHigh_Revenue_PY3.Enabled = Not Gross
Me.TxtInt_E_FinHigh_Revenue_CY2.Enabled = Not Gross
Me.TxtInt_E_FinHigh_Revenue_CY3.Enabled = Not Gross
Me.TxtInt_E_FinHigh_Revenue_CY4.Enabled = Not Gross


Me.LblStr_E_FinHigh_GrossProfit.Enabled = Not Gross
Me.LblInt_E_FinHigh_GrossProfit_CY.Enabled = Not Gross
Me.LblInt_E_FinHigh_GrossProfit_PY.Enabled = Not Gross
Me.LblInt_E_FinHigh_GrossProfit_PY1.Enabled = Not Gross
Me.LblInt_E_FinHigh_GrossProfit_PY2.Enabled = Not Gross
Me.LblInt_E_FinHigh_GrossProfit_PY3.Enabled = Not Gross
Me.TxtInt_E_FinHigh_GrossProfit_CY2.Enabled = Not Gross
Me.TxtInt_E_FinHigh_GrossProfit_CY3.Enabled = Not Gross
Me.TxtInt_E_FinHigh_GrossProfit_CY4.Enabled = Not Gross


Me.LblStr_E_FinHigh_GrossProfit2.Enabled = Gross
Me.LblInt_E_FinHigh_GrossProfit2_CY.Enabled = Gross
Me.LblInt_E_FinHigh_GrossProfit2_PY.Enabled = Gross
Me.LblInt_E_FinHigh_GrossProfit2_PY1.Enabled = Gross
Me.LblInt_E_FinHigh_GrossProfit2_PY2.Enabled = Gross
Me.LblInt_E_FinHigh_GrossProfit2_PY3.Enabled = Gross
Me.TxtInt_E_FinHigh_GrossProfit2_CY2.Enabled = Gross
Me.TxtInt_E_FinHigh_GrossProfit2_CY3.Enabled = Gross
Me.TxtInt_E_FinHigh_GrossProfit2_CY4.Enabled = Gross

End Sub






Private Sub TxtInt_E_FinHigh_KeyFig_01_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    If Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC.value = "170" Or Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC.value = 170
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Public Function control_ordre(Control_valu As TextBox)
con_value = Control_valu.value
control_ordre = True
If InStr(Control_valu.Name, "KeyFig") Then
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_KeyFig_01_VPLAC.value Or con_value = 170 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC.value Or con_value = 180 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC.value Or con_value = 190 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC.value Or con_value = 200 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC.value Or con_value = 210 Then control_ordre = False
    End If
 End If
 If InStr(Control_valu.Name, "Ratio") Then
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_Ratio1_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_Ratio1_VPLAC.value Or con_value = 90 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_Ratio2_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_Ratio2_VPLAC.value Or con_value = 100 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_Ratio3_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_Ratio3_VPLAC.value Or con_value = 110 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_Ratio4_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_Ratio4_VPLAC.value Or con_value = 120 Then control_ordre = False
    End If
    If Control_valu.Name <> Me.TxtInt_E_FinHigh_Ratio5_VPLAC.Name Then
       If con_value = Me.TxtInt_E_FinHigh_Ratio5_VPLAC.value Or con_value = 130 Then control_ordre = False
    End If

 End If
 
 If control_ordre = False Then Exit Function
 If IsNumeric(con_value) = False Then
        
        control_ordre = False
        Exit Function
    Else
    decimal_kon = con_value / 10 - Int(con_value / 10)
    If decimal_kon = 0 Then
    control_ordre = False
    Exit Function
    Else
    
    control_ordre = True
    Exit Function
    
    End If
    
 End If
  
End Function

Private Sub TxtInt_E_FinHigh_KeyFig_02_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    If Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC.value = "180" Or Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_KeyFig_02_VPLAC.value = 180
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_KeyFig_03_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    If Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC.value = "190" Or Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_KeyFig_03_VPLAC.value = 190
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_KeyFig_04_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    If Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC.value = "200" Or Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_KeyFig_04_VPLAC.value = 200
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_KeyFig_05_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    If Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC.value = "210" Or Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_KeyFig_05_VPLAC.value = 210
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_Ratio1_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    
    If Me.TxtInt_E_FinHigh_Ratio1_VPLAC.value = "90" Or Me.TxtInt_E_FinHigh_Ratio1_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_Ratio1_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_Ratio1_VPLAC.value = 90
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_Ratio2_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    
    If Me.TxtInt_E_FinHigh_Ratio2_VPLAC.value = "100" Or Me.TxtInt_E_FinHigh_Ratio2_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_Ratio2_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_Ratio2_VPLAC.value = 100
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_Ratio3_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    
    If Me.TxtInt_E_FinHigh_Ratio3_VPLAC.value = "110" Or Me.TxtInt_E_FinHigh_Ratio3_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_Ratio3_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_Ratio3_VPLAC.value = 110
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_Ratio4_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    
    If Me.TxtInt_E_FinHigh_Ratio4_VPLAC.value = "120" Or Me.TxtInt_E_FinHigh_Ratio4_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_Ratio4_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_Ratio4_VPLAC.value = 120
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtInt_E_FinHigh_Ratio5_VPLAC_AfterUpdate()
    Dim controlval As Boolean
    
    If Me.TxtInt_E_FinHigh_Ratio5_VPLAC.value = "130" Or Me.TxtInt_E_FinHigh_Ratio5_VPLAC.value = "" Then Exit Sub
        controlval = control_ordre(Me.TxtInt_E_FinHigh_Ratio5_VPLAC)
    If controlval = fale Then
        Me.TxtInt_E_FinHigh_Ratio5_VPLAC.value = 130
        MsgBox "Valg en ubrugt placering"
    End If
End Sub

Private Sub TxtStr_E_FinHigh_Ratio1_DS_Change()
Dim cell_val As String
cell_val = Me.TxtStr_E_FinHigh_Ratio1_DS.value
If cell_val <> "" Then Me.LblStr_E_FinHigh_Ratio1_DS.Caption = cell_val
End Sub

Private Sub TxtStr_E_FinHigh_Ratio2_DS_Change()
Dim cell_val As String
cell_val = Me.TxtStr_E_FinHigh_Ratio2_DS.value
If cell_val <> "" Then Me.LblStr_E_FinHigh_Ratio2_DS.Caption = cell_val
End Sub

Private Sub TxtStr_E_FinHigh_Ratio3_DS_Change()
Dim cell_val As String
cell_val = Me.TxtStr_E_FinHigh_Ratio3_DS.value
If cell_val <> "" Then Me.LblStr_E_FinHigh_Ratio3_DS.Caption = cell_val
End Sub

Private Sub TxtStr_E_FinHigh_Ratio4_DS_Change()
Dim cell_val As String
cell_val = Me.TxtStr_E_FinHigh_Ratio4_DS.value
If cell_val <> "" Then Me.LblStr_E_FinHigh_Ratio4_DS.Caption = cell_val
End Sub

Private Sub TxtStr_E_FinHigh_Ratio5_DS_Change()
Dim cell_val As String
cell_val = Me.TxtStr_E_FinHigh_Ratio5_DS.value
If cell_val <> "" Then Me.LblStr_E_FinHigh_Ratio5_DS.Caption = cell_val
End Sub

Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")
InitializeLists_FinHigh
If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
CalculateFinHigh
'proc_PGKasstr

'insert years i captions
Dim CY As Variant
CY = FrmDocVariables.TxtStr_RepYear_CY.value
If CY = "" Then CY = "Dette |fffd|r"
Me.Lbl_Ratio_CY.Caption = CY
Me.Lbl_FinHigh_CY.Caption = CY

Dim CY1 As Variant
CY1 = FrmDocVariables.TxtStr_RepYear_PY.value
If CY1 = "" Then CY1 = "Sidste |fffd|r"
Me.Lbl_Ratio_CY1.Caption = CY1
Me.Lbl_FinHigh_CY1 = CY1

Dim CY2 As Variant
CY2 = FrmDocVariables.TxtStr_RepYear_PY1.value
If CY2 = "" Then CY2 = "Sidste |fffd|r-1"
Me.Lbl_Ratio_CY2.Caption = CY2
Me.Lbl_FinHigh_CY2.Caption = CY2

Dim CY3 As Variant
CY3 = FrmDocVariables.TxtStr_RepYear_PY2.value
If CY3 = "" Then CY3 = "Sidste |fffd|r-2"
Me.Lbl_Ratio_CY3.Caption = CY3
Me.Lbl_FinHigh_CY3.Caption = CY3

Dim CY4 As Variant
CY4 = FrmDocVariables.TxtStr_RepYear_PY3.value
If CY4 = "" Then CY3 = "Sidste |fffd|r-3"
Me.Lbl_Ratio_CY4.Caption = CY4
Me.Lbl_FinHigh_CY4.Caption = CY4

Ratio_Layout


End Sub
Attribute VB_Name = "FrmFixedAs2"
Attribute VB_Base = "0{E076882B-7C95-4557-B7AD-80DBC3675AEF}{E83D0ACD-CC80-47EB-B73B-30749D43C763}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False









'Kode ikke gennemg|fffd|et, men bare kopieret fra anden form. Derfor er der sikkert noget der kan slettes...
Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_FixedAs2 As Boolean ' Add by Bepe controls for empty feilds, information are used in navigationspanel
Empty_FixedAs2 = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
'    If InStr(1, UCase(obj.Name), "VALU") > 0 Then
'        If obj.value <> "" Then
'        obj.ForeColor = vbRed
'
'        Check = valuta_check(obj.value)
'        obj.value = Check
'        obj.ForeColor = vbBlack
'        End If
'    End If
    
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            Empty_FixedAs2 = False
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_FixedAs2 = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If

    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

''add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_FIXEDAS2") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_FIXEDAS2", False, msoPropertyTypeString, Empty_FixedAs2
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_FIXEDAS2").value = CStr(Empty_FixedAs2)
'End If
Subform_Value
'FrmDocVariables.Sub_Empty_FIXEDAS2.Caption = Empty_FixedAs2
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub CommandButton2_Click()

'kalder beregnings modullet
'CalculateSum_DEP

'procedurer er ukendt
LblValueDisplay

'proceduren tjekker om alle felter udfyldt korrekt
'ChkForecBox

'kalder beregnings modullet
CalculateSum_DEP

End Sub

Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CommandButton1_Click()
'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls
'
  If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
        Application.StatusBar = obj.Name
        If obj.value <> "" Then

            bestaat = GetDocPropNameErr(obj.Name)

            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files

                    If InStr(LCase(obj.Name), "lstint_") > 0 Then

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex

                    Else

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If

            Else

                If InStr(LCase(obj.Name), "int_") > 0 Then

                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else

                        If InStr(LCase(obj.Name), "lstint_") > 0 Then

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex

                        Else

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then

                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value

                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If

                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If

                End If
            End If

        Else

            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden

            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If

            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If

        End If

     End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************

Application.StatusBar = "ready"
Unload Me

End Sub


Private Sub Datterbutton_Click()

Dim obj As Object

For Each PageTab In FrmFixedAs2.MultiPage1.Pages

    If PageTab.Name = "Datter2" Or PageTab.Name = "Datter3" Then
    
        PageTab.Visible = True
    End If
    


Next PageTab


End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct01_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct01)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct02_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct02)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct03_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct03)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct04_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct04)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct05_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct05)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct06_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct06)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct07_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct07)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct08_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct08)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct09_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct09)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct10_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct10)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct11_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct11)
End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct12_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct12)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct13_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct13)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct14_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct14)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct15_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct15)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct16_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct16)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct17_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct17)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct18_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct18)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct19_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct19)

End Sub

Private Sub TxtStr_S_FAI_Assoc_Pct20_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Assoc_Pct20)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct01_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct01)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct02_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct02)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct03_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct03)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct04_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct04)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct05_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct05)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct06_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct06)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct07_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct07)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct08_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct08)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct09_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct09)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct10_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct10)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct100_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct100)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct101_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct101)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct102_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct102)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct103_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct103)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct104_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct104)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct105_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct105)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct106_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct106)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct107_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct107)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct108_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct108)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct109_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct109)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct11_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct11)


End Sub

Private Sub TxtStr_S_FAI_Group_Pct110_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct110)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct111_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct111)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct112_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct112)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct113_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct113)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct114_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct114)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct115_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct115)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct116_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct116)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct117_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct117)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct118_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct118)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct119_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct119)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct12_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct12)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct120_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct120)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct13_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct13)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct14_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct14)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct15_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct15)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct16_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct16)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct17_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct17)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct18_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct18)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct19_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct19)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct20_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct20)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct21_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct21)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct22_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct22)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct23_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct23)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct24_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct24)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct25_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct25)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct26_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct26)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct27_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct27)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct28_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct28)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct29_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct29)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct30_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct30)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct31_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct31)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct32_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct32)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct33_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct33)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct34_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct34)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct35_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct35)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct36_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct36)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct37_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct37)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct38_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct38)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct39_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct39)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct40_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct40)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct41_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct41)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct42_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct42)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct43_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct43)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct44_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct44)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct45_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct45)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct46_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct46)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct47_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct47)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct48_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct48)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct49_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct49)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct50_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct50)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct51_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct51)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct52_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct52)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct53_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct53)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct54_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct54)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct55_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct55)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct56_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct56)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct57_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct57)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct58_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct58)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct59_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct59)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct60_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct60)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct61_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct61)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct62_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct62)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct63_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct63)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct64_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct64)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct65_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct65)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct66_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct66)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct67_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct67)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct68_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct68)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct69_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct69)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct70_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct70)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct71_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct71)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct72_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct72)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct73_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct73)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct74_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct74)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct75_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct75)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct76_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct76)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct77_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct77)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct78_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct78)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct79_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct79)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct80_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct80)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct81_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct81)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct82_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct82)
End Sub

Private Sub TxtStr_S_FAI_Group_Pct83_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct83)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct84_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct84)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct85_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct85)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct86_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct86)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct87_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct87)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct88_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct88)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct89_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct89)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct90_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct90)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct91_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct91)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct92_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct92)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct93_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct93)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct94_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct94)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct95_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct95)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct96_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct96)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct97_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct97)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct98_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct98)

End Sub

Private Sub TxtStr_S_FAI_Group_Pct99_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtStr_S_FAI_Group_Pct99)

End Sub












Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")
InitializeLists_FixedAs2
If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

If BooIsConsolidated Then
    Me.MultiPage1.Pages("PG_E_Datter1").Visible = False
    Me.MultiPage1.Pages("PG_E_Datter2").Visible = False
    Me.MultiPage1.Pages("PG_E_Datter3").Visible = False
    Me.MultiPage1.Pages("PG_E_Datter4").Visible = False
    Me.MultiPage1.Pages("PG_E_Datter5").Visible = False
End If

modeltype = GetDocPropNameErr("DocIsClass")

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    If InStr(1, UCase(obj.Name), "TEXTLBL") > 0 Then
    obj.Visible = Labels(obj, modeltype, BooIsConsolidated)
    End If

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj



End Sub

Attribute VB_Name = "FrmInv"
Attribute VB_Base = "0{3D107B3B-C2F6-4879-8F94-E85D0C55AA9B}{AD50D17F-A5F8-4F02-B3E9-AFC56886C766}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







'Kode ikke gennemg|fffd|et, men bare kopieret fra anden form. Derfor er der sikkert noget der kan slettes...
Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_Inv As Boolean
Empty_Inv = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
 
    'add by bepe, validation of number
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
            
                obj.ForeColor = vbBlack
                Empty_Inv = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If


    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj
'add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_Inv") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_Inv", False, msoPropertyTypeString, Empty_Inv
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_Inv").value = CStr(Empty_Inv)
'End If
'FrmDocVariables.Sub_Empty_Inv.Caption = Empty_Inv
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub CommandButton2_Click()

'kalder beregnings modullet
'CalculateSum_DEP

'procedurer er ukendt
LblValueDisplay

'proceduren tjekker om alle felter udfyldt korrekt
'ChkForecBox

'kalder beregnings modullet
CalculateSum_DEP

End Sub

Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CommandButton1_Click()
'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls
'
  If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
        Application.StatusBar = obj.Name
        If obj.value <> "" Then

            bestaat = GetDocPropNameErr(obj.Name)

            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files

                    If InStr(LCase(obj.Name), "lstint_") > 0 Then

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex

                    Else

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If

            Else

                If InStr(LCase(obj.Name), "int_") > 0 Then

                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else

                        If InStr(LCase(obj.Name), "lstint_") > 0 Then

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex

                        Else

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then

                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value

                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If

                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If

                End If
            End If

        Else

            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden

            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If

            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If

        End If

     End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************

Application.StatusBar = "ready"
Unload Me

End Sub







Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")
modeltype = GetDocPropNameErr("DocIsClass")
If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If



If BooIsConsolidated Then
    
    'Me.MultiPage1.Pages("PgFixAssInv1").Visible = False
    Me.PgSubVar.Pages("PgFixAssInv1").Visible = False
    'Me.MultiPage1.Pages("PG_E_Datter3").Visible = False
End If


'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    
    
    If InStr(1, UCase(obj.Name), "TEXTLBL") > 0 Then
    obj.Visible = Labels(obj, modeltype, BooIsConsolidated)
    End If

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
'CalculateSum_KasSubForm
'proc_PGKasstroom
End Sub



Attribute VB_Name = "FrmKonFixedAs2"
Attribute VB_Base = "0{97120FAD-1A99-426E-B363-790F248D9574}{98BE191E-41D4-4AFC-85BE-6E62FFD575F1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub cmdcancel_Click_2()
Unload Me
End Sub

Private Sub CmdOk_Click_2()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_C_FIXEDAS2 As Boolean
Empty_C_FIXEDAS2 = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_C_FIXEDAS2 = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj
'add by BEPE, send information about specification to main forms
If GetDocPropNameErr("Sub_Empty_C_FIXEDAS2") = "N/A" Then
    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_C_FIXEDAS2", False, msoPropertyTypeString, Empty_C_FIXEDAS2
Else
    ActiveDocument.CustomDocumentProperties("Sub_Empty_C_FIXEDAS2").value = CStr(Empty_C_FIXEDAS2)
End If
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub CommandButton1_Click()
    FrmKonFixedAs2.MultiPage1.Datter2.Visible = True
    FrmKonFixedAs2.MultiPage1.Datter3.Visible = True
End Sub

Private Sub cancel_Click()
Unload Me
End Sub



Private Sub ok_Click()
    'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_C_FIXEDAS2 As Boolean
Empty_C_FIXEDAS2 = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_C_FIXEDAS2 = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj
''add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_C_FIXEDAS2") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_C_FIXEDAS2", False, msoPropertyTypeString, Empty_C_FIXEDAS2
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_C_FIXEDAS2").value = CStr(Empty_C_FIXEDAS2)
'End If
Subform_Value
Application.StatusBar = "ready"
Unload Me

End Sub



Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")
InitializeLists_KonFixedAs2
If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj

End Sub


'Sub auto_field()
'    Dim TabObj As Control
'    Dim NewValue As Long
'    Dim FeildLabel As String
'
'    NewValue = 100
'
'
'    'Froms som skal auto udfyldes
'    'FrmCashFlow, FrmDocVariables,FrmFinAss,FrmFinHigh, FrmFixedAS2, FrmInv, FrmKonFixedAs2, FrmSubVar, FrmTreasure, FrmTreasureSub
'
'    For Each PageTab In Me.MultiPage1.Pages
'        If PageTab.Visible = True Then '(anvendes kun for klasse B)
'
'            For Each TabObj In PageTab.Controls
'
'
'                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then
'
'                If TabObj.value = "" Then TabObj.value = NewValue
'                End If
'
'                If InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
'
'                  If TabObj.value = "" Then TabObj.value = TabObj.Name
'
'                End If
'
'            Next TabObj
'        End If
'    Next PageTab

'End Sub

Attribute VB_Name = "FrmKonTreasure"
Attribute VB_Base = "0{679B8083-A0AD-4B1D-A3E1-D0638BABA73B}{4C8EA0A8-046D-4A5E-8D16-6D7DA163B7EF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



'indsat kode fra formen FrmSubVar -SOHO 13 oktober 2012
'Kode ikke gennemg|fffd|et, men bare kopieret fra anden form. Derfor er der sikkert noget der kan slettes...
Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
'Dim Empty_SHARCAP2 As Boolean
'Empty_SHARCAP2 = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_SHARCAP2 = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
    
   
    
    
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

'add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_SHARCAP2") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_SHARCAP2", False, msoPropertyTypeString, Empty_SHARCAP2
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_SHARCAP2").value = CStr(Empty_SHARCAP2)
'End If
'FrmDocVariables.Sub_Empty_SHARCAP2.Caption = Empty_SHARCAP2
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub



Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub cmdCalculate_Click()

CalculateSum_TreSubFormKon
End Sub





Private Sub PgSubVar_Change()
CalculateSum_TreSubFormKon
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_01)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_02)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_03)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_04)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_05)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_06)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_07)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_08)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_09)
End Sub

Private Sub TxtInt_C_Treasur_Acq_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Acq_Pct_10)
End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_01)
End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_02)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_03)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_04)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_05)
End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_06)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_07)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_08)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_09)

End Sub

Private Sub TxtInt_C_Treasur_Primo_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Primo_Pct_10)

End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_01)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_02)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_03)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_04)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_05)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_06)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_07)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_08)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_09)
End Sub

Private Sub TxtInt_C_Treasur_Sec_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sec_Pct_10)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_01)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_02)
End Sub


Private Sub TxtInt_C_Treasur_Sol_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_03)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_04)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_05)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_06)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_07)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_08)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_09)
End Sub

Private Sub TxtInt_C_Treasur_Sol_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_C_Treasur_Sol_Pct_10)
End Sub

Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

modeltype = GetDocPropNameErr("DocIsClass")

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    If InStr(1, UCase(obj.Name), "TEXTLBL") > 0 Then
    obj.Visible = Labels(obj, modeltype, BooIsConsolidated)
    End If

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj

CalculateSum_TreSubFormKon
'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
'CalculateSum_KasSubForm
'proc_PGKasstroom
End Sub




Attribute VB_Name = "FrmSubVar"
Attribute VB_Base = "0{8065F17B-52CB-489C-9226-11D735047C52}{37D06C6F-6B55-45AB-BB7F-91D280C2CAB7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False











Private Sub cmdCalculate_Click()

CalculateSum_SubForm     'procedure berekent totalen txtboxen en doet controles

End Sub

Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
'Dim Empty_Fin As Boolean ' Add by BEPE. controls for values in subform, information are show in navigationspanel
'Empty_Fin = True
'Dim Empty_SharCap 'Add by BEPE. controls for values in subform, information are show in navigationspanel
'Empty_SharCap = True
'Dim CVRControlBox As Boolean
'CVRControlBox = False
For Each obj In Me.Controls

     If InStr(1, UCase(obj.Name), "TXTINT_S_ITA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_TFA_") > 0 Or InStr(1, UCase(obj.Name), "TXTINT_S_FAI_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_Fin = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    ElseIf InStr(1, UCase(obj.Name), "TXTINT_S_SHARCAP_") > 0 Then
            If obj.value <> "" Then
                NewValue = Replace(obj.value, " ", "")
                If InStr(1, NewValue, "(") > 0 Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    obj.ForeColor = vbRed
                    CVRControlBox = True
                    Exit Sub
                ElseIf IsNumeric(NewValue) Then
                    obj.value = NewValue
                    obj.ForeColor = vbBlack
                    Empty_SharCap = False
                ElseIf CVRControlBox = False Then
                    MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                    CVRControlBox = True
                    obj.ForeColor = vbRed
                    Exit Sub
                Else
                    obj.value = ""
                End If
            End If
                        
    End If
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

Application.StatusBar = "ready"
Unload Me
Subform_Value
End Sub









Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then

                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted

                    Else

                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)

                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
'CalculateSum_SubForm
End Sub
Attribute VB_Name = "FrmTreasure"
Attribute VB_Base = "0{2FB21033-E393-435A-A65B-8BA0DD9F36A0}{75FC07A7-143A-40F9-A2C0-A890ED053097}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False










'indsat kode fra formen FrmSubVar -SOHO 13 oktober 2012
'Kode ikke gennemg|fffd|et, men bare kopieret fra anden form. Derfor er der sikkert noget der kan slettes...
Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
Dim Empty_SHARCAP2 As Boolean
Empty_SHARCAP2 = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
     If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_SHARCAP2 = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If
    
   
    
    
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj

'add by BEPE, send information about specification to main forms
'If GetDocPropNameErr("Sub_Empty_SHARCAP2") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_SHARCAP2", False, msoPropertyTypeString, Empty_SHARCAP2
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_SHARCAP2").value = CStr(Empty_SHARCAP2)
'End If
'FrmDocVariables.Sub_Empty_SHARCAP2.Caption = Empty_SHARCAP2
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub

Private Sub CommandButton2_Click()

'kalder beregnings modullet
'CalculateSum_DEP

'procedurer er ukendt
LblValueDisplay

'proceduren tjekker om alle felter udfyldt korrekt
'ChkForecBox

'kalder beregnings modullet
CalculateSum_DEP

End Sub

Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CommandButton1_Click()
'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls
'
  If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
        Application.StatusBar = obj.Name
        If obj.value <> "" Then

            bestaat = GetDocPropNameErr(obj.Name)

            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files

                    If InStr(LCase(obj.Name), "lstint_") > 0 Then

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex

                    Else

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If

            Else

                If InStr(LCase(obj.Name), "int_") > 0 Then

                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else

                        If InStr(LCase(obj.Name), "lstint_") > 0 Then

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex

                        Else

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then

                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value

                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If

                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If

                End If
            End If

        Else

            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden

            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If

            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If

        End If

     End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************

Application.StatusBar = "ready"
Unload Me

End Sub

Private Sub cmdCalculate_Click()

CalculateSum_TreSubForm2
End Sub

Private Sub PgSubVar_Change()
CalculateSum_TreSubForm2
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_01)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_02)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_03)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_04)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_05)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_06)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_07)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_08)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_09)
End Sub

Private Sub TxtInt_S_Treasur_Acq_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Acq_Pct_10)
End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_01)
End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_02)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_03)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_04)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_05)
End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_06)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_07)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_08)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_09)

End Sub

Private Sub TxtInt_S_Treasur_Primo_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)

   cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Primo_Pct_10)

End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_01)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_02)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_03)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_04)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_05)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_06)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_07)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_08)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_09)
End Sub

Private Sub TxtInt_S_Treasur_Sec_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sec_Pct_10)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_01_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_01)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_02_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_02)
End Sub


Private Sub TxtInt_S_Treasur_Sol_Pct_03_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_03)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_04_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_04)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_05_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_05)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_06_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_06)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_07_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_07)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_08_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_08)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_09_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_09)
End Sub

Private Sub TxtInt_S_Treasur_Sol_Pct_10_Exit(ByVal cancel As MSForms.ReturnBoolean)
      cancel = ContentControl_Pct(Me.TxtInt_S_Treasur_Sol_Pct_10)
End Sub

Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

modeltype = GetDocPropNameErr("DocIsClass")

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    If InStr(1, UCase(obj.Name), "TEXTLBL") > 0 Then
    obj.Visible = Labels(obj, modeltype, BooIsConsolidated)
    End If

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj
CalculateSum_TreSubForm2

'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
'CalculateSum_KasSubForm
'proc_PGKasstroom
End Sub



Attribute VB_Name = "FrmTreasureSub"
Attribute VB_Base = "0{756B19E7-B74B-4F76-ADD1-BC2D12974243}{026460F5-4B25-4BB2-AFD3-589C0E8512F7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False









'indsat kode fra formen FrmSubVar -SOHO 13 oktober 2012
'Kode ikke gennemg|fffd|et, men bare kopieret fra anden form. Derfor er der sikkert noget der kan slettes...
Private Sub CmdOk_Click()

'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
'Sub_Empty_TREASURSUB
Dim Empty_TREASURSUB As Boolean
Empty_TREASURSUB = True
Dim CVRControlBox As Boolean
CVRControlBox = False
For Each obj In Me.Controls
    'add by bepe, validation of number
    If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
        If obj.value <> "" Then
            NewValue = Replace(obj.value, " ", "")
            If InStr(1, NewValue, "(") > 0 Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                obj.ForeColor = vbRed
                CVRControlBox = True
                Exit Sub
            ElseIf IsNumeric(NewValue) Then
                obj.value = NewValue
                obj.ForeColor = vbBlack
                Empty_TREASURSUB = False
            ElseIf CVRControlBox = False Then
                MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter."
                CVRControlBox = True
                obj.ForeColor = vbRed
                Exit Sub
            Else
                obj.value = ""
            End If
        End If
    End If


    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
    Application.StatusBar = obj.Name
        If obj.value <> "" Then
            
            bestaat = GetDocPropNameErr(obj.Name)
            
            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files
                    
                    If InStr(LCase(obj.Name), "lstint_") > 0 Then
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex
                    
                    Else
                    
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)
                    
                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        'ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If
                
            Else
                
                If InStr(LCase(obj.Name), "int_") > 0 Then
                    
                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else
                    
                        If InStr(LCase(obj.Name), "lstint_") > 0 Then
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex
                        
                        Else
                        
                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                    
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value
                        
                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
'                        IsCdpNew = GetDocPropNameErr(Obj.Name & "_NQ")
'                        If IsCdpNew = "N/A" Then
'                            ActiveDocument.CustomDocumentProperties.Add Obj.Name & "_NQ", False, msoPropertyTypeString, Obj.Value
'                        Else
'                            ActiveDocument.CustomDocumentProperties(Obj.Name & "_NQ").Value = Obj.Value
'                        End If
                    
                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If
                    
                End If
            End If
        
        Else
            
            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden
            
            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If
            
            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If
            
        End If
    
    End If

Next obj
'add by BEPE, send information about specification to main forms
'Sub_Empty_TREASURSUB
'If GetDocPropNameErr("Sub_Empty_TREASURSUB") = "N/A" Then
'    ActiveDocument.CustomDocumentProperties.Add "Sub_Empty_TREASURSUB", False, msoPropertyTypeString, Empty_TREASURSUB
'Else
'    ActiveDocument.CustomDocumentProperties("Sub_Empty_TREASURSUB").value = CStr(Empty_TREASURSUB)
'End If
Subform_Value
Application.StatusBar = "ready"
Unload Me
End Sub



Private Sub cmdcancel_Click()
Unload Me
End Sub

Private Sub CommandButton1_Click()
'verwerken alle values van de controls NAAR de custom document properties

Dim obj As control
Dim NewValue
For Each obj In Me.Controls
'
  If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LSTINT") > 0 Then
        Application.StatusBar = obj.Name
        If obj.value <> "" Then

            bestaat = GetDocPropNameErr(obj.Name)

            If bestaat = "N/A" Then
               If InStr(LCase(obj.Name), "int_") > 0 Then
                    'type float not supported by Wordml (xml) files

                    If InStr(LCase(obj.Name), "lstint_") > 0 Then

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.ListIndex

                    Else

                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    End If
                ElseIf InStr(LCase(obj.Name), "dat_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                ElseIf InStr(LCase(obj.Name), "boo_") > 0 Then
                    ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeBoolean, obj.value
                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, "'" & obj.value
                        ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                    Else
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, obj.value
                    End If
                End If

            Else

                If InStr(LCase(obj.Name), "int_") > 0 Then

                    If ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeNumber Or ActiveDocument.CustomDocumentProperties(obj.Name).Type = msoPropertyTypeFloat Then
                        'conversie oude int/float
                        ActiveDocument.CustomDocumentProperties(obj.Name).Delete
                        ActiveDocument.CustomDocumentProperties.Add obj.Name, False, msoPropertyTypeString, ConvStrToNumb(obj.value, obj.Name)

                    Else

                        If InStr(LCase(obj.Name), "lstint_") > 0 Then

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.ListIndex

                        Else

                            ActiveDocument.CustomDocumentProperties(obj.Name).value = ConvStrToNumb(obj.value, obj.Name)

                        End If
                    End If

                Else
                    If InStr(LCase(obj.Name), "str_") > 0 And Left(obj.value, 1) <> "'" Then

                        ActiveDocument.CustomDocumentProperties(obj.Name).value = "'" & obj.value

                        'tevens dubbele verwerking voor direct gebruik uit CDP's dus zonder kwoot
                        iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
                        If iscdpnew = "N/A" Then
                            ActiveDocument.CustomDocumentProperties.Add obj.Name & "_NQ", False, msoPropertyTypeString, obj.value
                        Else
                            ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").value = obj.value
                        End If

                    Else
                        ActiveDocument.CustomDocumentProperties(obj.Name).value = obj.value
                    End If

                End If
            End If

        Else

            'ofwel het editbox/listobject object is LEEG, oude geregistreerde waarde dient verwijderd te worden

            bestaat = GetDocPropNameErr(obj.Name)
            If bestaat <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name).Delete
            End If

            'ook verwijderen van dubbele opname cdp (met / zonder kwoot)
            iscdpnew = GetDocPropNameErr(obj.Name & "_NQ")
            If iscdpnew <> "N/A" Then
                ActiveDocument.CustomDocumentProperties(obj.Name & "_NQ").Delete
            End If

        End If

     End If

Next obj

'*****************
'temporary FIX for keep |fffd| and Space together

'Euro_Space

'*******************

Application.StatusBar = "ready"
Unload Me

End Sub



Private Sub cmdCalculate_Click()
CalculateSum_TreSubForm_SUB
End Sub









Private Sub UserForm_Initialize()
'vaststellen consolidatie en wegschrijven in public variable vervolgens verbergen
'show hide enkelvoudig geconsolideerd
bestaat = GetDocPropNameErr("DocIsConsolidated")

If UCase(bestaat) = True Then
    BooIsConsolidated = True
Else
    BooIsConsolidated = False
End If

'uitlezen alle custom document properties NAAR form
Dim CdpName() As String
Dim CdpValue() As String

counter = 0
counter2 = 1
Dim posSlash As Integer
For Each cdp In ActiveDocument.CustomDocumentProperties

    ReDim Preserve CdpName(counter)
    ReDim Preserve CdpValue(counter)
    CdpName(counter) = cdp.Name
    CdpValue(counter) = cdp.value
    
    counter = counter + 1
      
Next cdp

'terugzetten waarden in de controls
Dim obj As control
Dim ToTest As Integer
For Each obj In Me.Controls

    'afhandeling edit boxen
    If InStr(1, UCase(obj.Name), "TXT") > 0 Or InStr(1, UCase(obj.Name), "CHK") > 0 Or InStr(1, UCase(obj.Name), "LST") > 0 Or InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
    
        For ToTest = 0 To UBound(CdpName)
            
            If UCase(obj.Name) = UCase(CdpName(ToTest)) Then
                
                If InStr(1, UCase(obj.Name), "LBL") > 0 Or InStr(1, UCase(obj.Name), "BOO_SPEC") > 0 Then
                
                    'dit zijn de controle totalen / specificeer booleans
                    If InStr(1, UCase(obj.Name), "LBLINT") > 0 Then
                        
                        'label met getallen
                        Converted = ConvStrToNumb(CdpValue(ToTest), CdpName(ToTest))
                        Converted = DecSep(Converted)
                        Me(obj.Name).Caption = Converted
                        
                    Else
                    
                        'label met tekst 'LET OP !!!
                         Me(obj.Name).Caption = CdpValue(ToTest)
                    
                    End If
                
                Else
              
                    'afhandeling van de edit boxen
                    If Left(CdpValue(ToTest), 1) = "'" Then
                            
                            Me(obj.Name).value = Mid(CdpValue(ToTest), 2, 200)
                    Else
                    
                            If InStr(1, LCase(obj.Name), "int_") > 0 Then
                            
                                If InStr(1, LCase(obj.Name), "lstint_") > 0 Then
                            
                                    Me(obj.Name).ListIndex = CdpValue(ToTest)
                                
                                Else
                                    
                                    Me(obj.Name).value = Replace(CdpValue(ToTest), ".", ",", 1)
                                
                                End If
                            Else
                                Me(obj.Name).value = CdpValue(ToTest)
                            End If
                            
                    End If
                End If
                
            GoTo ValueSet
            End If
                        
        Next ToTest
    
    End If
     
ValueSet:
Next obj


'procedure die alle berekeningsprocedures uitvoert (zie ook calculate knop)
'CalculateSum_KasSubForm
'proc_PGKasstroom
End Sub





Attribute VB_Name = "FrmValuta"
Attribute VB_Base = "0{B89638A3-2AAF-47BB-8AD0-497B2A0831EB}{7517A0DC-880A-44DB-8B6F-9F70E067320F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub List_ISOValuta_Change()

End Sub

Private Sub OK_ISOKODE_Click()
    valuta_code = Me.List_ISOValuta.value
    Unload Me
End Sub

Private Sub UserForm_Initialize()

ISO_Kode = Array("AED", "AFN", "ALL", "AMD", "ANG", "AOA", "ARS", "AUD", "AWG", "AZN", "BAM", "BBD", "BDT", "BGN", "BHD", "BIF", "BMD", "BND", "BOB", "BRL", "BSD", "BTN", "BWP", _
"BYR", "BZD", "CAD", "CDF", "CHF", "CLP", "CNY", "COP", "CRC", "CUC", "CUP", "CVE", "CZK", "DJF", "DKK", "DOP", "DZD", "EGP", "ERN", "ETB", "EUR", "JD", "FKP", _
"GBP", "GEL", "GGP", "GHS", "GIP", "GMD", "GNF", "GTQ", "GYD", "HKD", "HNL", "HRK", "HTG", "HUF", "IDR", "ILS", "IMP", "INR", "IQD", "IRR", "ISK", "JEP", _
"JMD", "JOD", "JPY", "KES", "KGS", "KHR", "KMF", "KPW", "KRW", "KWD", "KYD", "KZT", "LAK", "LBP", "LKR", "LRD", "LSL", "LTL", "LYD", "MAD", "MDL", "MGA", _
"MKD", "MMK", "MNT", "MOP", "MRO", "MUR", "MVR", "MWK", "MXN", "MYR", "MZN", "NAD", "NGN", "NIO", "NOK", "NPR", "NZD", "OMR", "PAB", "PEN", "PGK", "PHP", _
"PKR", "PLN", "PYG", "QAR", "RON", "RUB", "RSD", "RWF", "SAR", "SBD", "SCR", "SDG", "SEK", "SGD", "SHP", "SLL", "SOS", "SRD", "SSP", "STD", "SVC", "SYP", _
"SZL", "THB", "TJS", "TMT", "TND", "TOP", "TRY", "TTD", "TWD", "TZS", "UAH", "UGX", "USD", "UYU", "UZS", "VEF", "VND", "VUV", "WST", "XAF", "XCD", "XOF", _
"XPF", "YER", "ZAR", "ZMW", "ZWL")
    For i = 0 To UBound(ISO_Kode)
        
       Me.List_ISOValuta.AddItem ISO_Kode(i)
    Next i

     
End Sub
Attribute VB_Name = "General"
Public Const DartPWD = "~~PH1nh"
Public BooIsConsolidated As Boolean
Public RequiredMiss As Boolean
Public Const NQVariables = ""

Public Function GetDocPropValErr(sExistName As String) As String
    Dim testvalue As String
    On Error GoTo Errorhandler
        testvalue = ActiveDocument.CustomDocumentProperties(sExistName).value
        GetDocPropValErr = testvalue
        Exit Function
Errorhandler:
    GetDocPropValErr = 0
End Function

Public Function GetDocPropValErr_UserInput(sExistName As String) As String
    Dim testvalue As String
        On Error GoTo Errorhandler
        testvalue = ActiveDocument.CustomDocumentProperties(sExistName).value
        GetDocPropValErr_UserInput = testvalue
        Exit Function
Errorhandler:
    GetDocPropValErr_UserInput = ""
End Function

Public Function SetDocPropValErr(obj As Variant, keyfig_val As Variant) As Variant
        On Error GoTo Errorhandler
        ActiveDocument.CustomDocumentProperties(obj).Delete
Errorhandler:
        If keyfig_val <> "" And keyfig_val <> "N/A" Then
            keyfig_val = Replace(keyfig_val, ",", ".")
            ActiveDocument.CustomDocumentProperties.Add obj, False, msoPropertyTypeString, keyfig_val
        End If
End Function

Public Function GetDocPropNameErr(sExistName As Variant) As Variant
    
    sExist = "N/A"
    On Error Resume Next    ' Defer error trapping.

    testvalue = ActiveDocument.CustomDocumentProperties(sExistName).value

    If Err.Number <> 0 Then
    
        sExist = "N/A"
        
    Else
        
        'Document properties kunnen ook de value "N/A" hebben deze mag de functie niet als
        'waarde teruggeven. Code verondersteld namelijk dat CPD dan niet bestaat.
        If testvalue = "N/A" Then
        
            sExist = "NotApplicable"
            
        Else
            
            sExist = testvalue
            
        End If
        
    End If
        
    Err.Clear   ' Clear Err object in case error occurred.

    On Error GoTo Errorhandler

    GetDocPropNameErr = sExist

Errorhandler:

End Function

'add by bepe, basic the same as ConvStringToDate, but dont return a errrormessing
Public Function ConvStringToDate_2(ConversieDatum As String)

If Len(ConversieDatum) < 3 Then

    ConvStringToDate_2 = ""

Else

    On Error GoTo Fout
    
    Datum = Replace(ConversieDatum, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum)
    maand = Month(Datum)
    dag = Day(Datum)

    If Len(maand) = 1 Then
        maand = 0 & maand
    Else
        maand = maand
    End If

    If Len(dag) = 1 Then
        dag = 0 & dag
    Else
        dag = dag
    End If

    ConvStringToDate_2 = dag & "." & maand & "." & Jaar
    Exit Function
Fout:
ConvStringToDate_2 = False
'MsgBox "Ongeldig datum formaat !!" + Chr(13) + Chr(13) + "Corrigeer invoer.", vbExclamation, "Onjuiste invoer"
End If

End Function

Public Function ConvStrToNumb2(CurValue As Variant, CurObjname As String) As Variant
'***********************
'LET OP: Reference only
'backup procedure... niet meer in gebruik. Bleek niet te werken voor getallen met meer dan 2 decimalen
'Vervangen door ConvStrToNumb
'***********************

Dim CheckChar
Dim CheckChar2

If IsNumeric(CurValue) = True Then
        
    If Len(CurValue) > 2 Then
    
        CheckChar = Mid(CurValue, Len(CurValue) - 1, 1)
        
        Select Case CheckChar
        Case "."
            ConvStrToNumb2 = Replace(CurValue, ",", "", 1)
            
        Case ","
            CurValue = Replace(CurValue, ".", "", 1)
            ConvStrToNumb2 = Replace(CurValue, ",", ".", 1)
            
        Case Else
        
            CheckChar2 = Mid(CurValue, Len(CurValue) - 2, 1)
        
            Select Case CheckChar2
                
            Case "."
                ConvStrToNumb2 = Replace(CurValue, ",", "", 1)
            Case ","
                CurValue = Replace(CurValue, ".", "", 1)
                ConvStrToNumb2 = Replace(CurValue, ",", ".", 1)
            Case Else
                CurValue = Replace(CurValue, ".", "", 1)
                ConvStrToNumb2 = Replace(CurValue, ",", "", 1)
            End Select
        End Select
    Else
        ConvStrToNumb2 = CurValue
    End If
Else

ConvStrToNumb2 = 0
    If curval <> "" Then
    
        MsgBox "Expected numeric value in " & CurObjname, vbOKOnly + vbInformation, "Numeric value"
     
    End If
End If

End Function

Public Function ConvStrToNumb(CurValue As Variant, CurObjname As String) As Variant
Dim CheckChar
Dim CheckChar2
Dim Char
Dim PosCount
Dim TestNumeric


'uiteindelijk moet de functie een getal opleveren waarbij de het decimaal teken een punt is.
'Daarvoor worden eerst de duizend tal seperators eruit gehaald en vervolgens de komma voor punt gewisseld.

TestNumeric = Replace(CurValue, ".", "", 1)
TestNumeric = Replace(TestNumeric, ",", "", 1)
If IsNumeric(TestNumeric) = True Then
    
    PosCount = 1
    For Char = Len(CurValue) To 1 Step -1
    
        CheckChar = Mid(CurValue, Char, 1)
        Select Case CheckChar
            
            Case "."
               
                If PosCount = 4 Then 'ofwel de punt wordt als thousand seperator gebruikt)
                    ConvStrToNumb = Replace(CurValue, ".", "", 1)
                Else
                    ConvStrToNumb = Replace(CurValue, ",", "", 1)
                End If
                
                Exit Function
            
            Case ","
            
                CurValue = Replace(CurValue, ".", "", 1)
                ConvStrToNumb = Replace(CurValue, ",", ".", 1)
                Exit Function
                
            Case Else

            End Select
    PosCount = PosCount + 1
    Next Char
    
    'no "." or "," has been found (no decimals)
    ConvStrToNumb = CurValue
    
Else

ConvStrToNumb = 0
    If CurValue <> "" Then

        'MsgBox "Expected numeric value in " & CurObjname, vbOKOnly + vbInformation, "Numeric value"

    End If
End If

End Function


Public Function DecSep(OpmaakNumber As Variant)

If Mid(Format(OpmaakNumber, "#,###.00"), Len(Format(OpmaakNumber, "#,###.00")) - 1, 1) = "0" And Right(Format(OpmaakNumber, "#,###.00"), 1) = "0" Then
   If OpmaakNumber = 0 Then
        
        'uitzondering waarbij op te maken getal 0 is
        DecSep = 0
    
    Else
    
        'op te maken getal bevat geen decimalen
        DecSep = Format(OpmaakNumber, "#,###")
   
   End If
Else

    'op te maken getal bevat decimalen
    DecSep = Format(OpmaakNumber, "#,###.#####")
End If

End Function

Public Function DecSepXlstr(OpmaakNumber As Variant)

If Mid(Format(OpmaakNumber, "#,###.00"), Len(Format(OpmaakNumber, "#,###.00")) - 1, 1) = "0" And Right(Format(OpmaakNumber, "#,###.00"), 1) = "0" Then
   If OpmaakNumber = 0 Then
        
        'uitzondering waarbij op te maken getal 0 is
        DecSepXlstr = 0
    
    Else
    
        'op te maken getal bevat geen decimalen
        DecSepXlstr = Format(OpmaakNumber, "#,###;(#,###)")
   
   End If
Else

    'op te maken getal bevat decimalen
    DecSepXlstr = Format(OpmaakNumber, "#,###.#####;(#,###,#####)")
End If

End Function

'***************************************
'conversie functies tbv data afhandeling

Public Function DvfActiveTextbox(frmNaam As UserForm) As String
Dim strTestString As String

    strTestString = frmNaam.ActiveControl.Name
    
    If InStr(1, UCase(strTestString), "MULTIPAGE") > 0 Then
        
        strTestString = frmNaam.Controls(strTestString).SelectedItem.ActiveControl.Name
        
        If InStr(1, UCase(strTestString), "MULTIPAGE") > 0 Then

            strTestString = frmNaam.Controls(strTestString).SelectedItem.ActiveControl.Name
            
        End If
   
    End If
        
    If InStr(1, UCase(strTestString), "FRAME") > 0 Then

        strTestString = frmNaam.Controls(strTestString).ActiveControl.Name
        

    End If
    
    DvfActiveTextbox = strTestString

End Function

Public Function ConvStringToDate(ConversieDatum As String)

If Len(ConversieDatum) < 3 Then

    ConvStringToDate = ""

Else

    On Error GoTo Fout
    
    Datum = Replace(ConversieDatum, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum)
    maand = Month(Datum)
    dag = Day(Datum)

    If Len(maand) = 1 Then
        maand = 0 & maand
    Else
        maand = maand
    End If

    If Len(dag) = 1 Then
        dag = 0 & dag
    Else
        dag = dag
    End If

    ConvStringToDate = dag & "." & maand & "." & Jaar
    Exit Function
Fout:
ConvStringToDate = ConversieDatum
MsgBox "Ongeldig datum formaat !!" + Chr(13) + Chr(13) + "Corrigeer invoer.", vbExclamation, "Onjuiste invoer"
End If

End Function

Public Function ConvStringToSofi(InputValue As String)
InputValue = Replace(InputValue, ".", "", 1)
InputValue = Replace(InputValue, "/", "", 1)
InputValue = Replace(InputValue, "-", "", 1)

    If Len(InputValue) = 9 Then
    
    Else
    
        MsgBox "Ongeldige invoer. Gewenste input fiscaal nummer ####.##.###; evenals het sofinummer voor IB.", vbExclamation, "Onjuist aantal karakters"
    
    End If
    
    Strleft = Left(InputValue, 4)
    StrMid = Mid(InputValue, 5, 2)
    StrRight = Mid(InputValue, 7, 5)
    
    ConvStringToSofi = Strleft & "." & StrMid & "." & StrRight
    
End Function

Public Function ConvStringToDate_DK(ConversieDatum_obj As Object)
Dim ConversieDatum As String
ConversieDatum = ConversieDatum_obj.value
ConversieDatum_obj.ForeColor = vbBlack
'Change the condition of 3 to 5
If Len(ConversieDatum) < 5 Then
    If Len(ConversieDatum) <> 0 Then MsgBox "Her skal indtastes dato i format dd.mm.yyyy"
    ConversieDatum_obj.ForeColor = vbRed
    ConvStringToDate_DK = ConversieDatum

Else

    On Error GoTo Fout
    
    Datum = Replace(ConversieDatum, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum)
    maand = Month(Datum)
    dag = Day(Datum)

    If Len(maand) = 1 Then
        maand = 0 & maand
    Else
        maand = maand
    End If

    If Len(dag) = 1 Then
        dag = 0 & dag
    Else
        dag = dag
    End If
    ConversieDatum_obj.ForeColor = vbBlack
    ConvStringToDate_DK = dag & "." & maand & "." & Jaar
    Exit Function
Fout:
ConversieDatum_obj.ForeColor = vbRed
ConvStringToDate_DK = ConversieDatum
MsgBox "Her skal indtastes dato i format dd.mm.yyyy"
'MsgBox "Ugyldigt datoformat !!" + Chr(13) + Chr(13) + "Korrigere indtastning", vbExclamation, "Forkert indtastning"
End If

End Function

'add by BEPE, controles date cell fore correct format
Public Function ContentControl_Date(ConversieDatum As String)
'ConversieDatum = Text_box.Value

If ConversieDatum = "" Then
    ContentControl_Date = ""
    Exit Function
End If
'Change the condition of 3 to 5
If Len(ConversieDatum) < 5 Then

    ContentControl_Date = False
    Exit Function
Else

    On Error GoTo Fout
    
    Datum = Replace(ConversieDatum, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum)
    maand = Month(Datum)
    dag = Day(Datum)
    
    If Len(Jaar) <> 4 Then
        ContentControl_Date = False
        Exit Function
    End If
    If Len(maand) = 1 Then
        maand = 0 & maand
    Else
        maand = maand
    End If

    If Len(dag) = 1 Then
        dag = 0 & dag
    Else
        dag = dag
    End If

    ContentControl_Date = dag & "." & maand & "." & Jaar
    Exit Function
Fout:
'MsgBox "Udgyldigt datoformat !!"
ContentControl_Date = False


End If

End Function

'add by BEPE, add one year
Public Function Date_PlusYear(ConversieDatum As String)


    On Error GoTo Fout
    
    Datum = Replace(ConversieDatum, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum) - 1
    maand = Month(Datum)
    dag = Day(Datum)

    If Len(maand) = 1 Then
        maand = 0 & maand
    Else
        maand = maand
    End If

    If Len(dag) = 1 Then
        dag = 0 & dag
    Else
        dag = dag
    End If

    Date_PlusYear = dag & "." & maand & "." & Jaar
    Exit Function
Fout:
Date_PlusYear = ""
'MsgBox "Ugyldigt datoformat !!" + Chr(13) + Chr(13) + "Korrigere indtastning", vbExclamation, "Forkert indtastning"
End Function


'Change by BEPE
Public Function ConvStringToCBR_DK(ConversieCVR As String)


'remove space
cvr = Replace(ConversieCVR, " ", "")

'control len
If Len(cvr) = 8 Then

Else
    ConvStringToCBR_DK = ""
    Exit Function
End If
    
'control for number
If IsNumeric(cvr) Then
    ConvStringToCBR_DK = cvr
Else
    ConvStringToCBR_DK = ""
    Exit Function
    
End If

End Function

'Change by BEPE
Public Function ContentControl_CVR(ConversieCVR As String)


'remove space
cvr = Replace(ConversieCVR, " ", "")

'control len
If Len(cvr) = 8 Then
    'control for number
    If IsNumeric(cvr) Then
        ContentControl_CVR = cvr
    Else
        ContentControl_CVR = False
        Exit Function
    
    End If
ElseIf cvr = "" Then
    ContentControl_CVR = ""
    Exit Function
Else
    ContentControl_CVR = False
    Exit Function

End If
    


End Function

'add by BEPE controles for correct format of procent cells
Public Function ContentControl_Pct(Control_Pct As TextBox)
    Pct_value = Control_Pct.value
    Control_Pct.ForeColor = vbblak
'    If Pct_value = "" Then
'
'        ContentControl_Pct = False
'        Exit Function
'    End If
    
    If IsNumeric(Pct_value) = False Then
        Control_Pct.ForeColor = vbRed
        control_num = False
        Exit Function
    End If
    If Pct_value >= 0 Then
     control_num = True
    Else
     ContentControl_Pct = True
   '  MsgBox "Formatfejl: Procent kan angives i f|fffd|lgende formater f.eks. 10 eller 11,59"
     Control_Pct.ForeColor = vbRed
     Exit Function
    End If
    
    Dim heltal As Single
    heltal = Pct_value * 100
    
    decimal_check = heltal - Int(heltal)
    
    If decimal_check <> 0 Then control_num = False
    
    If control_num = 0 Then
      '  MsgBox "Formatfejl: Procent kan angives i f|fffd|lgende formater f.eks. 10 eller 11,59"
        Control_Pct.ForeColor = vbRed
        ContentControl_Pct = True
        Exit Function
    Else
        
        ContentControl_Pct = False
        Exit Function
    End If


End Function
'add by bepe, validation of number in variables
Sub number_validation()
Dim CVRControlBox

For Each PageTab In FrmDocVariables.MultiPage1.Pages
    CVRControlBox = False
    If PageTab.Visible = True Then
        For Each obj In PageTab.Controls
            'add by BEPE controlles amount cell
            If InStr(1, UCase(obj.Name), "TXTINT") > 0 Then
                obj.ForeColor = vbBlack
                If obj.value <> "" Then
                    NewValue = Replace(obj.value, " ", "")
                    If IsNumeric(NewValue) Then
                        obj.value = NewValue
                    ElseIf CVRControlBox = False Then
                        MsgBox "Formatfejl: Det er ikke muligt at indtaste tekst i bel|fffd|bsfelter. Felter med formatfejl vil blive slettet, derfor skal f|fffd|lgende fane gennemg|fffd|s igen: " & PageTab.Caption
                        CVRControlBox = True
                        obj.ForeColor = vbRed
                    Else
                        obj.ForeColor = vbRed
                 End If
                End If
            End If
        Next
    End If
Next
End Sub

'
Function Year_type_control(ByVal Year_primo As String, ByVal Year_Ultimo As String)
    Year_type_control = 0
    If Year_primo = "" Or Year_Ultimo = "" Then Exit Function
    Datum = Replace(Year_primo, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum) - 1
    maand = Month(Datum)
    dag = Day(Datum)

    If maand <> 1 Or dag <> 1 Then Year_type_control = 1
    
    Datum = Replace(Year_Ultimo, ".", "-", 1)
    Datum = Replace(Datum, "/", "-")
    Datum = CDate(Datum)
  
    Jaar = Year(Datum) - 1
    maand = Month(Datum)
    dag = Day(Datum)

    If maand <> "12" Or dag <> 31 Then Year_type_control = 1
    

End Function

Attribute VB_Name = "Get_CC_info"


Sub CC_Controls()

Dim CC()
Dim docCCs_1 As ContentControls
Dim Value_CC As String
Dim pro_name As String

CC = Array("TxtStr_S_CompDet_Annual_Date_WD", "TxtStr_S_Chairman_WD", "TxtStr_DocVar_StatMan_Place_WD", "TxtStr_S_DocVar_StatMan_Date_WD", _
"TxtStr_S_DocVar_AudiRep_Place_WD01", "TxtStr_S_DocVar_AudiRep_Date_WD01", "TxtStr_S_DocVar_AudiRep_Place_WD02", _
"TxtStr_S_DocVar_AudiRep_Date_WD02", "TxtStr_S_DocVar_AudiRep_Place_WD03", "TxtStr_S_DocVar_AudiRep_Date_WD03", _
"TxtStr_S_DocVar_AudiRep_Place_WD04", "TxtStr_S_DocVar_AudiRep_Date_WD04")
For X = 0 To UBound(CC)

    On Error Resume Next
    pro_name = "CC_" & CC(X)
    Set docCCs_1 = ActiveDocument.SelectContentControlsByTag(CC(X))
    Value_CC = docCCs_1.item(1).Range.Text
    bestaat = GetDocPropNameErr(pro_name)
    If bestaat = "N/A" Then
        ActiveDocument.CustomDocumentProperties.Add pro_name, False, msoPropertyTypeString, Value_CC
    Else
        ActiveDocument.CustomDocumentProperties(pro_name).value = Value_CC
                        
    End If

Next


End Sub
Attribute VB_Name = "NoteNumbers"
Sub PubNummering()

Dim BalansPos()
Dim BalansPos_K()

'In deze array zijn opgenomen.
'1) Alle nodenamen van de balansposten. Dit in verband met de aansturing van de PubNummering
'2) De nodenamen van texten die optioneel zijn (forced = false) en tevens aangestuurd worden door een KEY.
'
'De visuele status van het dashboard wordt betrokken in het bepalen van de uiteindelijke value van de KEY.

'Eerst opschonen
For Each cdp In ActiveDocument.CustomDocumentProperties

    If InStr(1, UCase(cdp.Name), "VISSTAT_") > 0 Then
    
        cdp.Delete
    
    End If

Next cdp

BalansPos = Array("NOTES_GOINGCONCERN", "NOTES_ANOMALIES", "NOTES_PASTEVENTS", "NOTES_UNCERMEASURE", "NOTES_DISCONT", "NOTES_GROSS", "NOTES_REVENUE", "NOTES_FAIRINVP_A", _
"NOTES_FAIRINVA_A", "NOTES_FAIRLIAP_A", "NOTES_FAIRLIAA_A", "NOTES_FAIRINVP_F", "NOTES_FAIRINVA_F", "NOTES_FAIRLIAP_F", "NOTES_FAIRBIOASS_A", "NOTES_FAIRBIOASS_F", _
"NOTES_FAIRLIAA_F", "NOTES_CHANINV_A", "NOTES_WORKOWN_A", "NOTES_OTHOPINC_A", "NOTES_OTHOPINC_A_TXTFT", "NOTES_COGS_A", "NOTES_COSTRAW_A", "NOTES_OTEXTEX_A", _
"NOTES_PROPEXP_A", "NOTES_COSTSAL_F", "NOTES_COGS_F", "NOTES_PROPEXP_F", "NOTES_RESDEV_F", "NOTES_STAFCST_A", "NOTES_DEPAMOR_A", "NOTES_WRITE", "NOTES_OTHOPEXP", _
"NOTES_DISTR_F", "NOTES_ADMIN_F", "NOTES_FEEAUDI", "NOTES_STAFCST_F", "NOTES_DEPAMOR_F", "NOTES_OTHOPINC_F", "NOTES_OTHOPINC_F_TXTFT", "NOTES_OTHOPEXP_F", "NOTES_ININVGE", _
"NOTES_ININVAS", "NOTES_ININVFIX", "NOTES_OTHINCGE", "NOTES_OTFININ", "NOTES_IMPFINA", "NOTES_FINEXGR", "NOTES_OFINEXP", "NOTES_FAIRPROPER", "NOTES_FAIRINVEST", "NOTES_FAIRFINAN01", "NOTES_FAIRFINAN02", _
"NOTES_TAXORDI", "NOTES_EXTRINC", "NOTES_EXTREXP", "NOTES_TAXEXTR", "NOTES_OTHTAX", "NOTES_LISSUAN_01TXTFT", "NOTES_WITHD_TXTFT", _
"NOTES_LCONVER_01TXTFT", "NOTES_LDEPOS", "NOTES_LCOVERSUB", "NOTES_SISSUAN_01TXTFT", "NOTES_SCONVER_01TXTFT", "NOTES_SDEPOS", "NOTES_SCOVERSUB", "NOTES_INTANGI", "NOTES_PROPERT", "NOTES_FIXEDAS", "NOTES_DEFTAXFA", "NOTES_DEFTAXFA_TXTFT", "NOTES_INVENTO", "NOTES_TRADREC", "NOTES_CONPROG", "NOTES_RECEIGR", _
"NOTES_RECGEDIV", "NOTES_RECEIAS", "NOTES_RECACDIV", "NOTES_DEFTAXA", "NOTES_OTHREC", "NOTES_ITAXREC", "NOTES_COVER", "NOTES_CONTCAB", "NOTES_RECOWN", "NOTES_RECOWN_TXTFT", "NOTES_PREPAY", _
"NOTES_INVESGR", "NOTES_INVESAS", "NOTES_OTHINV", "NOTES_CASH", "NOTES_SHARCAP", "NOTES_TREASUR", "NOTES_NORIGCAP", "NOTES_INSURFUND", "NOTES_RESERVFUND", "NOTES_AVARESFUND", "NOTES_DISTRIB", _
"NOTES_PROVPEN", "NOTES_DEFTAX", "NOTES_PROVING", "NOTES_PROVINA", "NOTES_OTHPROV", "NOTES_LSUBLOAN", "NOTES_LMORTGA", "NOTES_LBANK", _
"NOTES_LFINLEA", "NOTES_LISSUAN", "NOTES_LCRINST", "NOTES_LCONVER", "NOTES_LPREPAY", "NOTES_LONACC", "NOTES_LPAYSUP", "NOTES_LDEBTGR", _
"NOTES_LDEBTAS", "NOTES_LDEBOWNMAN", "NOTES_LTAXPAY", "NOTES_LOTHPAY", "NOTES_LDEFINC", "NOTES_LNEGGWL", "NOTES_LONGLIA", "NOTES_DEPCURASS", _
"NOTES_SCURRLT", "NOTES_SSUBLOAN", "NOTES_SMORTGA", "NOTES_SBANK", "NOTES_SFINLEA", "NOTES_SISSUAN", "NOTES_SOTLOAN", "NOTES_SCONVER", "NOTES_SPREPAY", _
"NOTES_SONACC", "NOTES_SPAYSUP", "NOTES_SDEBTGR", "NOTES_SDEBTAS", "NOTES_SDEBOWNMAN", "NOTES_STAXPAY", "NOTES_SOTHPAY", "NOTES_SDEFINC", "NOTES_SNEGGWL", _
"NOTES_SPRODIV", "NOTES_CFCASH", "NOTES_COOP", "NOTES_ARRAN", "NOTES_WITHD", "NOTES_OPLEAS", "NOTES_OPLEAS_TXTFT", "NOTES_CONTASS", "NOTES_CONTLIAB", "NOTES_MORTSEC", _
"NOTES_RELPARTCONTROL", "NOTES_RELPART", "NOTES_TREASURSUB", "NOTES_OWNERSH", "NOTES_PARENT", "NOTES_PRIMACT", _
"NOTES_INVENTO_02TXTFT", "NOTES_INVENTO_03TXTFT", "NOTES_DEFTAXA_TXTFT", "NOTES_GOINGCONCERN", "NOTES_DEFTAX_TXTFT", _
"NOTES_WORKCAP", "NOTES_CFADJUST", "NOTES_CFINPAY", "NOTES_CFOUTPAY", "NOTES_CFOUTHERCF", "NOTES_CFINVEST", "NOTES_CFFINAN", "NOTES_DISCONT_TXTFT", "NOTES_REVENUE_TXTFT", "NOTES_STAFCST_A_COMPENS", "NOTES_STAFCST_A_SPECINC", _
"NOTES_DEPAMOR_A_IFA_TXTFT", "NOTES_FEEAUDI_TXTFT", "NOTES_STAFCST_F_COMPENS", "NOTES_STAFCST_F_SPECINC", _
"NOTES_DEPAMOR_F_IFA_TXTFT", "NOTES_OTFININ_TXTFT", "NOTES_OFINEXP_TXTFT", "NOTES_COVERROOF", "NOTES_TAXORDI_TXTFT", _
"NOTES_INTANGI_01TXTFT", "NOTES_PROPERT_01TXTFT", "NOTES_FIXEDAS_01TXTFT", "X_NOTES_FIXEDAS_GROUP_TBL", "NOTES_FIXEDAS_GROUP_01TXTFT", "NOTES_FIXEDAS_GROUP_02TXTFT", _
"X_NOTES_FIXEDAS_ASSOC_TBL", "NOTES_FIXEDAS_ASSOC_01TXTFT", "X_NOTES_FIXEDAS_PARTNER_TBL", "NOTES_RECMANA", "NOTES_RECMANA_01TXTTL", "NOTES_FIXEDAS_PARTNER_01TXTFT", "NOTES_CONPROG_TXTFT", _
"NOTES_OTHREC_TXTFT", "NOTES_WRITE_A", "NOTES_INVESGR_TXTFT", "NOTES_INVESGR_TXTFT02", "NOTES_INVESAS_TXTFT", "NOTES_OTHINV_TXTFT", "NOTES_SHARCAP_TXTTL", _
"NOTES_TREASUR_TXTFT01", "NOTES_TREASUR_TXTFT02", "NOTES_TREASUR_TXTFT03", "NOTES_TREASUR_TXTFT04", "NOTES_LOTHPAY_TXTFT", "NOTES_LONGLIA_TXTFT", "NOTES_LONGLIA_TXTFT02", "NOTES_SOTHPAY_TXTFT", "NOTES_CONTLIAB_01TXTTL", "NOTES_RELPART_01TXTTL", "NOTES_TREASURSUB_TXTFT")
                    
 
BalansPos_K = Array("NOTES_K_GOINGCONCERN", "NOTES_K_ANOMALIES", "NOTES_K_PASTEVENTS", "NOTES_K_UNCERMEASURE", "NOTES_K_DISCONT", "NOTES_K_GROSS", _
"NOTES_K_REVENUE", "NOTES_K_FAIRINVP_A", "NOTES_K_FAIRINVA_A", "NOTES_K_FAIRLIAP_A", "NOTES_K_FAIRLIAA_A", "NOTES_K_FAIRINVP_F", "NOTES_K_FAIRBIOASS_A", "NOTES_K_FAIRBIOASS_F", _
"NOTES_K_FAIRINVA_F", "NOTES_K_FAIRLIAP_F", "NOTES_K_FAIRLIAA_F", "NOTES_K_CHANINV_A", "NOTES_K_WORKOWN_A", "NOTES_K_OTHOPINC_A", "NOTES_K_OTHOPINC_A_TXTFT", "NOTES_K_COGS_A", "NOTES_K_COSTRAW_A", _
"NOTES_K_OTEXTEX_A", "NOTES_K_PROPEXP_A", "NOTES_K_COSTSAL_F", "NOTES_K_COGS_F", "NOTES_K_RESDEV_F", "NOTES_K_STAFCST_A", "NOTES_K_DEPAMOR_A", "NOTES_K_WRITE", "NOTES_K_FAIRPROPER", "NOTES_K_FAIRINVEST", "NOTES_K_FAIRFINAN01", "NOTES_K_FAIRFINAN02", _
"NOTES_K_OTHOPEXP_A", "NOTES_K_ADMIN_F", "NOTES_K_FEEAUDI", "NOTES_K_STAFCST_F", "NOTES_K_DEPAMOR_F", "NOTES_K_OTHOPINC_F", "NOTES_K_OTHOPINC_F_TXTFT", "NOTES_K_OTHOPEXP_F", "NOTES_K_OTHOPEXP", "NOTES_K_ININVGE", _
"NOTES_K_ININVAS", "NOTES_K_ININVFIX", "NOTES_K_OTHINCGE", "NOTES_K_OTFININ", "NOTES_K_IMPFINA", "NOTES_K_FINEXGR", "NOTES_K_OFINEXP", "NOTES_K_TAXORDI", "NOTES_K_EXTRINC", "NOTES_K_EXTREXP", "NOTES_K_TAXEXTR", "NOTES_K_OTHTAX", "NOTES_K_INTANGI", "NOTES_K_PROPERT", "NOTES_K_FIXEDAS", "NOTES_K_FIXEDAS_GROUP", _
"NOTES_K_FIXEDAS_ASSOC", "NOTES_K_FIXEDAS_PRORATA", "NOTES_K_DEFTAXFA", "NOTES_K_INVENTO", "NOTES_K_TRADREC", "NOTES_K_CONPROG", "NOTES_K_RECEIGR", "NOTES_K_RECGEDIV", _
"NOTES_K_RECEIAS", "NOTES_K_RECACDIV", "NOTES_K_DEFTAXA", "NOTES_K_OTHREC", "NOTES_K_ITAXREC", "NOTES_K_COVER", "NOTES_K_CONTCAB", "NOTES_K_RECOWN", "NOTES_K_RECOWN_TXTFT", "NOTES_K_PREPAY", "NOTES_K_DEPCURASS", _
"NOTES_K_INVESGR", "NOTES_K_INVESAS", "NOTES_K_OTHINV", "NOTES_K_CASH", "NOTES_K_SHARCAP", "NOTES_K_TREASUR", "NOTES_K_NORIGCAP", "NOTES_K_INSURFUND", "NOTES_K_RESERVFUND", "NOTES_K_AVARESFUND", "NOTES_K_MINORITY", "NOTES_K_DISTRIB", "NOTES_K_PROVPEN", _
"NOTES_K_DEFTAX", "NOTES_K_PROVING", "NOTES_K_PROVINA", "NOTES_K_COVERROOF", "NOTES_K_OTHPROV", "NOTES_K_LSUBLOAN", "NOTES_K_LMORTGA", "NOTES_K_LBANK", "NOTES_K_LFINLEA", "NOTES_K_LISSUAN", _
"NOTES_K_LCRINST", "NOTES_K_LCONVER", "NOTES_K_LDEPOS", "NOTES_K_LCOVERSUB", "NOTES_K_LPREPAY", "NOTES_K_LONACC", "NOTES_K_LPAYSUP", "NOTES_K_LDEBTGR", "NOTES_K_LDEBTAS", "NOTES_K_LDEBOWNMAN", "NOTES_K_LTAXPAY", "NOTES_K_LOTHPAY", _
"NOTES_K_LDEFINC", "NOTES_K_LNEGGWL", "NOTES_K_LONGLIA", "NOTES_K_SCURRLT", "NOTES_K_SSUBLOAN", "NOTES_K_SMORTGA", "NOTES_K_SBANK", "NOTES_K_SFINLEA", "NOTES_K_SISSUAN", "NOTES_K_CFADJUST", "NOTES_K_CFINPAY", "NOTES_K_CFOUTPAY", "NOTES_K_CFOUTHERCF", "NOTES_K_CFINVEST", "NOTES_K_CFFINAN", _
"NOTES_K_SOTLOAN", "NOTES_K_SCONVER", "NOTES_K_SDEPOS", "NOTES_K_SCOVERSUB", "NOTES_K_SPREPAY", "NOTES_K_SONACC", "NOTES_K_SPAYSUP", "NOTES_K_SDEBTGR", "NOTES_K_SDEBTAS", "NOTES_K_SDEBOWNMAN", "NOTES_K_STAXPAY", "NOTES_K_SOTHPAY", "NOTES_K_SDEFINC", "NOTES_K_SNEGGWL", "NOTES_K_SPRODIV", "NOTES_K_WORKCAP", "NOTES_K_CFCASH", "NOTES_K_COOP", "NOTES_K_ARRAN", _
"NOTES_K_LONGLIA_TXTFT02", "NOTES_K_LONGLIA_TXTFT", "NOTES_K_LOTHPAY_TXTFT", "NOTES_K_DEFTAX_TXTFT", "NOTES_K_TREASUR_TXTFT01", "NOTES_K_DEFTAXFA_TXTFT", "NOTES_K_FIXEDAS_PRORATA_TXTFT", "NOTES_K_FIXEDAS_ASSOC_TXTFT", "NOTES_K_TREASUR_TXTFT02", _
"NOTES_K_TREASUR_TXTFT03", "NOTES_K_TREASUR_TXTFT04", "NOTES_K_OTHREC_TXTFT", "NOTES_K_DEFTAXA_TXTFT", "NOTES_K_CONPROG_TXTFT", "NOTES_K_FIXEDAS_GROUP_TXTFT", "NOTES_K_FIXEDAS_01TXTFT", "X_NOTES_K_FIXEDAS_GROUP_TBL", "NOTES_K_FIXEDAS_GROUP_01TXTFT", "NOTES_K_FIXEDAS_GROUP_02TXTFT", "NOTES_K_SOTHPAY_TXTFT", _
"NOTES_K_INTANGI_01TXTFT", "NOTES_K_TAXORDI_TXTFT", "NOTES_K_OFINEXP_TXTFT", "NOTES_K_OTFININ_TXTFT", "NOTES_K_DEPAMOR_F_IFA_TXTFT", "NOTES_K_STAFCST_F_COMPENS", "NOTES_K_FEEAUDI_TXTFT", "NOTES_K_DEPAMOR_A_IFA_TXTFT", "NOTES_K_STAFCST_A_COMPENS", "NOTES_K_STAFCST_A_SPECINC", "NOTES_K_PROPERT_01TXTFT", _
"NOTES_K_NOTES_DISCONT", "NOTES_K_DISCONT_TXTFT", "NOTES_K_GOINGCONCERN", "NOTES_K_RECMANA", "NOTES_RECMANA_01TXTTL", "NOTES_K_REVENUE_TXTFT", _
"NOTES_K_WITHD", "NOTES_K_DISTR_F", "NOTES_K_PROPEXP_F", "NOTES_K_WRITE_A", "NOTES_K_OPLEAS", "NOTES_K_CONTASS", "NOTES_K_CONTLIAB", "NOTES_K_MORTSEC", "NOTES_K_RELPARTCONTROL", "NOTES_K_RELPART", "NOTES_K_TREASURSUB", "NOTES_K_OWNERSH", "NOTES_K_PARENT", "NOTES_K_PRIMACT", "NOTES_K_RELPART_01TXTTL", "NOTES_K_CONTLIAB_01TXTTL", "NOTES_K_OPLEAS_TXTFT")
                                                  
    For X = 0 To UBound(BalansPos)
        Dim ValueNode
        ValueNode = GetXmlNodeErr(BalansPos(X))
        If UCase(ValueNode) = "FALSE" Then ValueNode = 0 'Add by BEPE
        If InStr(1, UCase(ValueNode), "VALIDNODE") = 0 Then
            bestaat = GetDocPropNameErr("VisStat_" & BalansPos(X))
                If bestaat = "N/A" Then ' kontroller om elementet er oprettet i CDP
                'Toevoeging AVS d.d. 20060313
                    If ValueNode = "N/A" Then
                        ValueNode = "TRUE"
                    End If
                        If ValueNode = False Then ValueNode = 0 'Add by BEPE
                        ActiveDocument.CustomDocumentProperties.Add "VisStat_" & BalansPos(X), False, msoPropertyTypeString, ValueNode
                        ActiveDocument.CustomDocumentProperties.Add "VisStat_" & BalansPos(X) & "_PY", False, msoPropertyTypeString, ValueNode 'Add by BEPE
             
                Else
                    
                        ActiveDocument.CustomDocumentProperties("VisStat_" & BalansPos(X)).value = ValueNode
                        ActiveDocument.CustomDocumentProperties("VisStat_" & BalansPos(X) & "_PY").value = ValueNode 'Add by BEPE
                    
                End If
        End If
        
    Next
    
    If BooIsConsolidated Then
        For X = 0 To UBound(BalansPos_K)
            Dim ValueNode_K As String
            ValueNode_K = GetXmlNodeErr(BalansPos_K(X))
            If UCase(ValueNode_K) = "FALSE" Then ValueNode_K = 0 'Add by BEPE
            If InStr(1, UCase(ValueNode_K), "VALIDNODE") = 0 Then
                bestaat = GetDocPropNameErr("VisStat_" & BalansPos_K(X))
                    If bestaat = "N/A" Then
                    'Toevoeging AVS d.d. 20060313
                        If ValueNode_K = "N/A" Then
                            ValueNode_K = "TRUE"
                        End If
                        If UCase(ValueNode_K) = "FALSE" Then ValueNode_K = 0 'Add by BEPE
                        ActiveDocument.CustomDocumentProperties.Add "VisStat_" & BalansPos_K(X), False, msoPropertyTypeString, ValueNode_K
                        ActiveDocument.CustomDocumentProperties.Add "VisStat_" & BalansPos_K(X) & "_PY", False, msoPropertyTypeString, ValueNode_K 'Add by BEPE
                 
                    Else
                        ActiveDocument.CustomDocumentProperties("VisStat_" & BalansPos_K(X)).value = ValueNode_K
                        ActiveDocument.CustomDocumentProperties("VisStat_" & BalansPos_K(X) & "_PY").value = ValueNode_K 'Add by BEPE
                    End If
            End If
        Next
    End If
    For Each cdp In ActiveDocument.CustomDocumentProperties
        If InStr(1, cdp.Name, "ChkBoo") > 0 Then
             If cdp.value = "False" Then
                 cdp.Delete
             End If
             GoTo slut
        End If
        If InStr(1, cdp.Name, "TxtStr") > 0 Then
            Dim cbp_name As String
            cbp_name = cdp.Name
            If InStr(1, cbp_name, "TxtStr_C_FAI_Assoc_Pc") > 0 Or InStr(1, cbp_name, "TxtStr_C_FAI_Group_Pc") > 0 Then
                
                    cdp.Delete
             End If
          
            If InStr(1, cbp_name, "TxtInt_S_Str_Assoc_Pct") > 0 Then
              
                    cdp.Delete
            End If
            
            If InStr(1, cbp_name, "TxtStr_S_Treasur_Primo_Pct") > 0 Or InStr(1, cbp_name, "TxtStr_S_TreasSub_Primo_Pct") > 0 Then
               
                    cdp.Delete
        
            End If
        End If
slut:
    Next cdp


End Sub

Public Function GetXmlNodeErr(sExistName As Variant) As Variant
Dim XmlEle As XMLNode
Dim XmlAtrib
For Each XmlEle In ActiveDocument.XMLNodes
    If UCase(XmlEle.BaseName) = UCase(sExistName) Then
    
        For Each XmlAtrib In XmlEle.Attributes
            If UCase(XmlAtrib.BaseName) = "SE_U_VISIBLE" Then
            
                GetXmlNodeErr = XmlAtrib.Text
                
                Exit Function
            End If
            
        Next XmlAtrib
        
        GetXmlNodeErr = "ValidNode"
        Exit Function
    End If
    
Next XmlEle
GetXmlNodeErr = "NoValidNode"
End Function



Attribute VB_Name = "OpenWeb"
Sub OpenWebSite(url As String)
        Dim ie As Object
        Set ie = CreateObject("InternetExplorer.Application") 'Set IEapp = InternetExplorer
                                                                                                                                                                                        
        With ie
            .Silent = True 'No Pop-ups
            .Visible = True 'Set InternetExplorer to Visible
            .Navigate url 'Load web page
        End With
End Sub

Public Sub Test()
    'OpenWebSite "http://www.deloitte.dk"
    OpenWebSite "https://techlib.deloitte.com/default.aspx?view=content&id=0901ff8181609a2f"
End Sub


Attribute VB_Name = "PgDocumentVar"


Attribute VB_Name = "PgKasstroom"
Public LblSum_MG_Kasstr_Ind_CY_02_val, LblSum_MG_Kasstr_Ind_PY_02_val As Single
Public LblTot_MG_Kasstr_Ind_CY_D_val, LblTot_MG_Kasstr_Ind_PY_D_val As Single
Public LblTot_MG_Kasstr_Ind_CY_E_val, LblTot_MG_Kasstr_Ind_PY_E_val As Single


Sub proc_PGKasstroom()

proc_LblSum_KasstroomInd

End Sub

Sub proc_LblSum_KasstroomInd()


Dim KasIndCYSum01_01 As Variant
Dim KasIndCYSum01_02 As Variant
Dim KasIndCYSum01_03 As Variant
Dim KasIndCYSum01_04 As Variant
Dim KasIndCYSum01_05 As Variant
Dim KasIndCYSum01_06 As Variant
Dim KasIndCYSum01_07 As Variant

Dim KasIndCYSum02_01 As Variant
Dim KasIndCYSum02_02 As Variant

Dim KasIndCYSum03_01 As Variant
Dim KasIndCYSum03_02 As Variant
Dim KasIndCYSum03_03 As Variant

Dim KasIndCYSum04_01 As Variant


Dim KasIndPYSum01_01 As Variant
Dim KasIndPYSum01_02 As Variant
Dim KasIndPYSum01_03 As Variant
Dim KasIndPYSum01_04 As Variant

Dim KasIndPYSum02_01 As Variant
Dim KasIndPYSum02_02 As Variant

Dim KasIndPYSum03_01 As Variant
Dim KasIndPYSum03_02 As Variant
Dim KasIndPYSum03_03 As Variant

Dim KasIndPYSum04_01 As Variant

'New Eerste SumTelling made by BEPE DK
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_03.value <> "" Then
    KasIndCYSum01_03 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_03.value)
Else
    KasIndCYSum01_03 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_02.value <> "" Then
    KasIndCYSum01_02 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_02.value)
Else
    KasIndCYSum01_02 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_01.value <> "" Then
    KasIndCYSum01_01 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_01.value)
Else
    KasIndCYSum01_01 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_04.value <> "" Then
    KasIndCYSum01_04 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_04.value)
Else
    KasIndCYSum01_04 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_05.value <> "" Then
    KasIndCYSum01_05 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_05.value)
Else
    KasIndCYSum01_05 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_06.value <> "" Then
    KasIndCYSum01_06 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_06.value)
Else
    KasIndCYSum01_06 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_07.value <> "" Then
    KasIndCYSum01_07 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_07.value)
Else
    KasIndCYSum01_07 = 0
End If

KasIndCYSum01_08 = FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_B.Caption
KasIndCYBedrOpbr = (KasIndCYSum01_01 + KasIndCYSum01_02 + KasIndCYSum01_03 + KasIndCYSum01_04 + KasIndCYSum01_05 + KasIndCYSum01_06 + KasIndCYSum01_07 + KasIndCYSum01_08)
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_08.value <> "" Then KasIndCYBedrOpbr = KasIndCYBedrOpbr + FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_08.value
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_09.value <> "" Then KasIndCYBedrOpbr = KasIndCYBedrOpbr + FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_09.value
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_10.value <> "" Then KasIndCYBedrOpbr = KasIndCYBedrOpbr + FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_10.value
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_11.value <> "" Then KasIndCYBedrOpbr = KasIndCYBedrOpbr + FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_11.value
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_12.value <> "" Then KasIndCYBedrOpbr = KasIndCYBedrOpbr + FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_A_12.value

FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_01.Caption = DecSep(KasIndCYBedrOpbr)

'overf|fffd|r til n|fffd|ste side
FrmCashFlow.LblInt_MG_Kasstr_Ind_CY_01A.Caption = DecSep(KasIndCYBedrOpbr)

'Tweede Sumtelling
'KasIndCYSum02_01 = FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_B.Caption
KasIndCYSum02_02 = FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_C.Caption
KasIndCYOperAct = (KasIndCYBedrOpbr + KasIndCYSum02_02)
FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_02.Caption = DecSep(KasIndCYOperAct)
FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_02A.Caption = DecSep(KasIndCYOperAct)

'overf|fffd|res til hovedtal
LblSum_MG_Kasstr_Ind_CY_02_val = FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_02.Caption

'BEPE DK Transport from page "Pengestr|fffd|msopg|fffd|relsen II" to page "Pengestr|fffd|msopg|fffd|relsen III"
KasIndCYSum03_02 = ConvStrToNumb(FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_D.Caption, "")
LblTot_MG_Kasstr_Ind_CY_D_val = KasIndCYSum03_02

Dim LblSum_MG_Kasstr_Ind_CY_02A_kon As Double
LblSum_MG_Kasstr_Ind_CY_02A_kon = ConvStrToNumb(FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_02A.Caption, "")
Dim LblTot_MG_Kasstr_Ind_CY_OV1_kon As Double
LblTot_MG_Kasstr_Ind_CY_OV1_kon = LblSum_MG_Kasstr_Ind_CY_02A_kon + KasIndCYSum03_02
FrmCashFlow.LblSUM_MG_Kasstr_Ind_CY_OV1.Caption = DecSep(LblTot_MG_Kasstr_Ind_CY_OV1_kon)
FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_OV2.Caption = DecSep(LblTot_MG_Kasstr_Ind_CY_OV1_kon)



'Derde Sumtelling = Netto Kasstroom
KasIndCYSum03_01 = KasIndCYOperAct
'KasIndCYSum03_02 = FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_D.Caption
KasIndCYSum03_03 = FrmCashFlow.LblTot_MG_Kasstr_Ind_CY_E.Caption

LblTot_MG_Kasstr_Ind_CY_E_val = KasIndCYSum03_03

KasIndCYKasstroom = (KasIndCYSum03_01 + KasIndCYSum03_02 + KasIndCYSum03_03)
FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_03.Caption = DecSep(KasIndCYKasstroom)

'Vierde Sumtelling = Mutatie geldmiddelen
KasIndCYSum04_01 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_F_01.value, "TxtInt_MG_Kasstr_Ind_CY_F_01")

KasIndCYMutGeld = KasIndCYKasstroom + KasIndCYSum04_01
'her mangler noget
'FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_04.Caption = DecSep(KasIndCYMutGeld)


'New Eerste SumTelling made by BEPE DK
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_03.value <> "" Then
KasIndPYSum01_03 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_03.value)
Else
KasIndPYSum01_03 = 0
End If
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_02.value <> "" Then
KasIndPYSum01_02 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_02.value)
Else
KasIndPYSum01_02 = 0
End If
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_01.value <> "" Then
KasIndPYSum01_01 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_01.value)
Else
KasIndPYSum01_01 = 0
End If
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_04.value <> "" Then
KasIndPYSum01_04 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_04.value)
Else
KasIndPYSum01_04 = 0
End If
If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_05.value <> "" Then
KasIndPYSum01_05 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_05.value)
Else
KasIndPYSum01_05 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_06.value <> "" Then
KasIndPYSum01_06 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_06.value)
Else
KasIndPYSum01_06 = 0
End If

If FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_07.value <> "" Then
KasIndPYSum01_07 = Int(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_A_07.value)
Else
KasIndPYSum01_07 = 0
End If

KasIndPYSum01_08 = FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_B.Caption

KasIndPYBedrOpbr = (KasIndPYSum01_01 + KasIndPYSum01_02 + KasIndPYSum01_03 + KasIndPYSum01_04 + KasIndPYSum01_05 + KasIndPYSum01_06 + KasIndPYSum01_07 + KasIndPYSum01_08)
FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_01.Caption = DecSep(KasIndPYBedrOpbr)

'overf|fffd|r til n|fffd|ste side
FrmCashFlow.LblInt_MG_Kasstr_Ind_PY_01A.Caption = DecSep(KasIndPYBedrOpbr)


'Tweede Sumtelling
'KasIndPYSum02_01 = FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_B.Caption
KasIndPYSum02_02 = FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_C.Caption
KasIndPYOperAct = (KasIndPYBedrOpbr + KasIndPYSum02_02)
FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_02.Caption = DecSep(KasIndPYOperAct)

LblSum_MG_Kasstr_Ind_PY_02_val = FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_02.Caption


FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_02A.Caption = DecSep(KasIndPYOperAct)


'BEPE DK Transport from page "Pengestr|fffd|msopg|fffd|relsen II" to page "Pengestr|fffd|msopg|fffd|relsen III"
KasIndPYSum03_02 = ConvStrToNumb(FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_D.Caption, "")
LblTot_MG_Kasstr_Ind_PY_D_val = KasIndPYSum03_02
Dim LblSum_MG_Kasstr_Ind_pY_02A_kon As Double
LblSum_MG_Kasstr_Ind_pY_02A_kon = ConvStrToNumb(FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_02A.Caption, "")
Dim LblTot_MG_Kasstr_Ind_pY_OV1_kon As Double
LblTot_MG_Kasstr_Ind_pY_OV1_kon = LblSum_MG_Kasstr_Ind_pY_02A_kon + KasIndPYSum03_02
FrmCashFlow.LblSUM_MG_Kasstr_Ind_PY_OV1.Caption = DecSep(LblTot_MG_Kasstr_Ind_pY_OV1_kon)
FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_OV2.Caption = DecSep(LblTot_MG_Kasstr_Ind_pY_OV1_kon)



'Derde Sumtelling = Netto Kasstroom
KasIndPYSum03_01 = KasIndPYOperAct
'KasIndPYSum03_02 = FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_D.Caption
KasIndPYSum03_03 = FrmCashFlow.LblTot_MG_Kasstr_Ind_PY_E.Caption

LblTot_MG_Kasstr_Ind_PY_E_val = KasIndPYSum03_03

KasIndPYKasstroom = (KasIndPYSum03_01 + KasIndPYSum03_02 + KasIndPYSum03_03)
FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_03.Caption = DecSep(KasIndPYKasstroom)

'Vierde Sumtelling = Mutatie geldmiddelen
KasIndPYSum04_01 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_F_01.value, "TxtInt_MG_Kasstr_Ind_PY_F_01")

KasIndPYMutGeld = KasIndPYKasstroom + KasIndPYSum04_01
'her mangler noget
'FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_04.Caption = DecSep(KasIndPYMutGeld)

'beregning af sidste afsnit
Dim test1 As Double
Dim test2 As Double
Dim test3 As Double
Dim total1 As Double

'CY
test1 = ConvStrToNumb(FrmCashFlow.LblInt_MG_Kasstr_Ind_CY_N_01.Caption, "")
test2 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_N_01.value, "")
test3 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_CY_N_02.value, "")
total1 = test1 + test2 + test3
FrmCashFlow.LblSum_MG_Kasstr_Ind_CY_N.Caption = DecSep(total1)

test1 = ConvStrToNumb(FrmCashFlow.LblInt_MG_Kasstr_Ind_PY_N_01.Caption, "")
test2 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_N_01.value, "")
test3 = ConvStrToNumb(FrmCashFlow.TxtInt_MG_Kasstr_Ind_PY_N_02.value, "")
total1 = test1 + test2 + test3
FrmCashFlow.LblSum_MG_Kasstr_Ind_PY_N.Caption = DecSep(total1)


End Sub

Attribute VB_Name = "Placemanager"
Sub placemanager()
Dim keyfig_01 As TextBox

End Sub
Attribute VB_Name = "PubNum"
''Sub PubNummering()
''
''Dim BalansPos()
''
'''In deze array zijn opgenomen.
'''1) Alle nodenamen van de balansposten. Dit in verband met de aansturing van de PubNummering
'''2) De nodenamen van texten die optioneel zijn (forced = false) en tevens aangestuurd worden door een KEY.
'''
'''De visuele status van het dashboard wordt betrokken in het bepalen van de uiteindelijke value van de KEY.
''
'''Eerst opschonen
''For Each cdp In ActiveDocument.CustomDocumentProperties
''
''    If InStr(1, cdp.Name, "VisStat_") > 0 Then
''
''        cdp.Delete
''
''    End If
''
''Next cdp
''
''BalansPos = Array("NOTES_CHANACC", "NOTES_DISCONT", "NOTES_REVENUE", "NOTES_GROSS", "NOTES_INCINGR_H", "NOTES_INCINAS_H", "NOTES_CHANINV_A", _
''"NOTES_WORKOWN_A", "NOTES_OTHOPINC_A", "NOTES_OTHOPINC_F", "NOTES_COSTSAL_A", "NOTES_COSTSAL_F", "NOTES_FAIRINVP_A", _
''"NOTES_FAIRINVA_A", "NOTES_FAIRLIAP_A", "NOTES_FAIRLIAA_A", "NOTES_FAIRINVP_F", "NOTES_FAIRINVA_F", "NOTES_FAIRLIAP_F", _
''"NOTES_FAIRLIAA_F", "NOTES_COSTRAW_A", "NOTES_OTEXTEX_A", "NOTES_RESDEV_A", "NOTES_RESDEV_F", "NOTES_DISTR_F", _
''"NOTES_ADMIN_F", "NOTES_OTHOPEXP_F", "NOTES_STAFCST", "NOTES_STAFCST_COMPENS", "NOTES_STAFCST_SPECINC", "NOTES_DEPAMOR", _
''"NOTES_FEEAUDI", "NOTES_WRITE", "NOTES_OTHOPEXP", "NOTES_ININVGE", "NOTES_ININVAS", "NOTES_ININVFIX", "NOTES_OTHINCGE", "NOTES_OTFININ", _
''"NOTES_IMPFINA", "NOTES_FINEXGR", "NOTES_OFINEXP", "NOTES_TAXORDI", "NOTES_EXTRINC", "NOTES_EXTREXP", "NOTES_TAXEXTR", "NOTES_OTHTAX", _
''"NOTES_INTANGI", "NOTES_PROPERT", "NOTES_FIXEDAS", "NOTES_LTRECEI", "NOTES_INVENTO", "NOTES_TRADREC", "NOTES_CONPROG", "NOTES_RECEIGR", "NOTES_RECEIAS", _
''"NOTES_DEFTAXA", "NOTES_OTHREC", "NOTES_ITAXREC", "NOTES_CONTCAB", "NOTES_RECOWN", "NOTES_PREPAY", "NOTES_INVESGR", _
''"NOTES_OTHINV", "NOTES_CASH", "NOTES_SHARCAP", "NOTES_TREASUR", "NOTES_DISTRIB", "NOTES_PROVPEN", "NOTES_PROVDIS", _
''"NOTES_PROVTAX", "NOTES_DEFTAX", "NOTES_PROVING", "NOTES_PROVINA", "NOTES_OTHPROV", "NOTES_LONGLIA", "NOTES_LMORTGA", _
''"NOTES_LBANKDB", "NOTES_LFINLEA", "NOTES_LISSUAN", "NOTES_LCRINST", "NOTES_LCONVER", "NOTES_LPREPAY", "NOTES_LPAYSUP", _
''"NOTES_LDEBTGR", "NOTES_LDEBTAS", "NOTES_LTAXPAY", "NOTES_LOTHPAY", "NOTES_LDEFINC", "NOTES_LNEGGWL", "NOTES_SCURRLT", _
''"NOTES_SMORTGA", "NOTES_SBANKDB", "NOTES_SFINLEA", "NOTES_SISSUAN", "NOTES_SOTLOAN", "NOTES_SCONVER", "NOTES_SPREPAY", _
''"NOTES_SPAYSUP", "NOTES_SDEBTGR", "NOTES_SDEBTAS", "NOTES_STAXPAY", "NOTES_SOTHPAY", "NOTES_SDEFINC", "NOTES_SNEGGWL", _
''"NOTES_SPRODIV", "NOTES_CHANGWC", "NOTES_CFCASH", "NOTES_RECOG", "NOTES_ARRAN", "NOTES_WITHD", "NOTES_CONTASS", _
''"NOTES_MORTSEC", "NOTES_RELPART", "NOTES_OWNERSH")
''
''
''For x = 0 To UBound(BalansPos)
''
''    Dim ValueNode
''    ValueNode = GetXmlNodeErr(BalansPos(x))
''
''    If InStr(1, UCase(ValueNode), "VALIDNODE") = 0 Then
''
''        bestaat = GetDocPropNameErr("VisStat_" & BalansPos(x))
''
''            If bestaat = "N/A" Then
''            'Toevoeging AVS d.d. 20060313
''                If ValueNode = "N/A" Then
''                    ValueNode = "False"
''                End If
''
''               ActiveDocument.CustomDocumentProperties.Add "VisStat_" & BalansPos(x), False, msoPropertyTypeString, ValueNode
''
''            Else
''
''                ActiveDocument.CustomDocumentProperties("VisStat_" & BalansPos(x)).Value = ValueNode
''
''            End If
''
''    End If
''
''Next
''
''End Sub

Public Function GetXmlNodeErr(sExistName As Variant) As Variant
Dim XmlEle As XMLNode
Dim XmlAtrib
For Each XmlEle In ActiveDocument.XMLNodes
    If UCase(XmlEle.BaseName) = UCase(sExistName) Then
    
        For Each XmlAtrib In XmlEle.Attributes
            If UCase(XmlAtrib.BaseName) = "SE_U_VISIBLE" Then
            
                GetXmlNodeErr = XmlAtrib.Text
                
                Exit Function
            End If
            
        Next XmlAtrib
        
        GetXmlNodeErr = "ValidNode"
        Exit Function
    End If
    
Next XmlEle
GetXmlNodeErr = "NoValidNode"
End Function

Attribute VB_Name = "RegDataDK"
Sub GetRegData()

Dim strAutoTxt As String
Dim strPostnr As String
Dim strAdresse As String
Dim strDTFax As String
Dim strDTFaxX As String
Dim strDTTlf As String
Dim strDTTlfx As String
Dim strCVR As String
Dim Userkey As String
Dim strBrevType, strBy As String
Dim strValg As String
Dim DTHeader As Boolean
Dim rngHeader As Range
Dim strVirkNavn As String
Dim strPostbox
Dim i As Integer

Dim street, Num As String
Dim lastspace As Integer

On Error GoTo Errhandler
    'S|fffd|t oplysninger i Header's h|fffd|jre kolonne
    Userkey = "HKEY_CURRENT_USER\D&T UserInfo"
    strPostbox = System.PrivateProfileString("", Userkey, "Postbox")
    strPostnr = System.PrivateProfileString("", Userkey, "Postnr") '
    '+ " " + System.PrivateProfileString("", Userkey, "PostBy")
    strPostBy = System.PrivateProfileString("", Userkey, "PostBy")
    strAdresse = System.PrivateProfileString("", Userkey, "Adresse")
    
    'added by BEPE 22.05.2013 (the purpose of distinguishing the road name and number)
    lastspace = Len(strAdresse) - InStrRev(strAdresse, " ")
    street = Left(strAdresse, Len(strAdresse) - lastspace - 1)
    Num = Right(strAdresse, lastspace)
    '**
    
    strDTFaxX = System.PrivateProfileString("", Userkey, "Kontor Fax")
    strDTFax = Left(strDTFaxX, 2) + " " + Mid(strDTFaxX, 3, 2) + " " + Mid(strDTFaxX, 5, 2) + " " + Mid(strDTFaxX, 7, 2)
    strDTTlfx = System.PrivateProfileString("", Userkey, "Kontor Telefon")
    strDTTlf = Left(strDTTlfx, 2) + " " + Mid(strDTTlfx, 3, 2) + " " + Mid(strDTTlfx, 5, 2) + " " + Mid(strDTTlfx, 7, 2)
    strCVR = System.PrivateProfileString("", Userkey, "CVR")
    striCountry = System.PrivateProfileString("", Userkey, "Telefon Landekode")
    strsCountry = System.PrivateProfileString("", Userkey, "Land International")
    strShortName = System.PrivateProfileString("", Userkey, "Landekode")
    strVirkNavn = System.PrivateProfileString("", Userkey, "Virksomhedsnavn 2")
    strVirkNavn1 = System.PrivateProfileString("", Userkey, "Virksomhedsnavn 1") 'added by BEPE Okt 2011
    
    ActiveDocument.CustomDocumentProperties("DKRegDone").value = "True"
    
    'Added for DART
    FrmDocVariables.TxtStr_RegData_Virksomhedsnavn1.value = strVirkNavn1 'added by BEPE Okt 2011
    FrmDocVariables.TxtStr_RegData_Virksomhedsnavn2.value = strVirkNavn 'added by SH 23 sep 2011
    FrmDocVariables.TxtStr_RegData_Adresse.value = street 'added by BEPE 22.05.2013
    FrmDocVariables.TxtStr_RegData_Adresse_num.value = Num 'added by BEPE 22.05.2013
    FrmDocVariables.TxtStr_RegData_CVR.value = strCVR
    FrmDocVariables.TxtStr_RegData_Postbox.value = strPostbox
    FrmDocVariables.TxtStr_RegData_PostNr.value = strPostnr
    FrmDocVariables.TxtStr_RegData_PostBy.value = strPostBy
   ' FrmDocVariables.TxtStr_RegData_LandInternational.value = strsCountry
   ' FrmDocVariables.TxtStr_RegData_TelefonLandekode.value = striCountry
    FrmDocVariables.TxtStr_RegData_KontorTelefon.value = strDTTlf
    FrmDocVariables.TxtStr_RegData_KontorFax.value = strDTFax


''Sub GetOffices()
'    Dim bs As New BusinessServicesClient
'    Dim offices() As DeloitteOffice
'    offices = bs.GetOffices()
'    hund = offices(1).CompanyID
'    If UBound(offices) > -1 Then
'
'
'    For Row = 0 To UBound(offices)
'        If offices(Row).PostalZip = strPostnr Then
'        FrmDocVariables.TxtStr_OfficeZip.value = offices(Row).OfficeZip
'        FrmDocVariables.TxtStr_OfficeCity.value = offices(Row).OfficeCity
'        End If
'        'ActiveSheet.Cells(Row + 1, 1).value = offices(Row).CompanyID
''        ActiveSheet.Cells(Row + 1, 2).value = offices(Row).CompanyName
''        ActiveSheet.Cells(Row + 1, 3).value = offices(Row).OfficeName
''        ActiveSheet.Cells(Row + 1, 4).value = offices(Row).OfficeAddress
''        ActiveSheet.Cells(Row + 1, 5).value = offices(Row).OfficeZip
''        ActiveSheet.Cells(Row + 1, 6).value = offices(Row).OfficeCity
'    Next Row
'    End If
''End Sub

GoTo Done
Errhandler:
MsgBox "There was an error collecting the (Danish) Deloitte Office Properties, please contact IT support"

Done:
End Sub
' Content control in header is replaced by field codes... /SH
'Sub WriteccData()
'
'Dim oCC As ContentControl
'
'ProtStat = True
'    If ActiveDocument.ProtectionType = wdNoProtection Then
'        ProtStat = False
'    Else
'
'        ActiveDocument.Unprotect (DartPWD)
'    End If
'
'
'    Adresse = FrmDocVariables.TxtStr_RegData_Adresse.Value
'    CVR = FrmDocVariables.TxtStr_RegData_CVR.Value
'    Postbox = FrmDocVariables.TxtStr_RegData_Postbox.Value
'    Postnr = FrmDocVariables.TxtStr_RegData_PostNr.Value
'    PostBy = FrmDocVariables.TxtStr_RegData_PostBy.Value
'    strsCountry = FrmDocVariables.TxtStr_RegData_LandInternational.Value
'    striCountry = FrmDocVariables.TxtStr_RegData_TelefonLandekode.Value
'    DTTlf = FrmDocVariables.TxtStr_RegData_KontorTelefon.Value
'    DTFax = FrmDocVariables.TxtStr_RegData_KontorFax.Value
'
'    ccTitle = "Virknavn"
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    For x = 1 To a
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = VirkNavn
'    Next
'
'    ccTitle = "CVR"
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    For x = 1 To a
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = "CVR nr. " & CVR
'    Next
'
'    ccTitle = "Adresse"
'    For x = 1 To a
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = Adresse
'    Next
'
'    ccTitle = "Postbox"
'    For x = 1 To a
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = Postbox
'    Next
'
'    ccTitle = "Postnr"
'    For x = 1 To a
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = Postnr & " " & PostBy
'    Next
'
''    ccTitle = "Country"
''    For x = 1 To a
''    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
''    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
''    oCC.Range.Text = strsCountry
''    Next
'
'    ccTitle = "KontorTelefon"
'    For x = 1 To a
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = DTTlf
'    Next
'
'    ccTitle = "KontorFax"
'    For x = 1 To a
'    a = ActiveDocument.SelectContentControlsByTag(ccTitle).Count
'    Set oCC = ActiveDocument.SelectContentControlsByTag(ccTitle).Item(x)
'    oCC.Range.Text = DTFax
'    Next
'
'
'    If ProtStat = True Then
'       If ActiveDocument.ProtectionType = wdNoProtection Then
'
'        Application.EnableCancelKey = wdCancelInterrupt
'        ActiveDocument.Protect Password:=DartPWD, Type:=wdAllowOnlyReading
'
'        End If
'    End If
'
'
'End Sub

Attribute VB_Name = "Rollover"
Sub NewYear(ByRef CY As TextBox, ByRef CY1 As TextBox, Optional ByRef CY2 As TextBox, Optional ByRef CY3 As TextBox, Optional ByRef CY4 As TextBox)
    If Not CY4 Is Nothing Then CY4.Text = CY3.Text
    If Not CY3 Is Nothing Then CY3.Text = CY2.Text
    If Not CY2 Is Nothing Then CY2.Text = CY1.Text
    CY1.Text = CY.Text
    CY.Text = ""
End Sub

Attribute VB_Name = "StartInit"
'versie: 0.1
'aangepast op door agv

Sub AutoExecuteRG()

Unload FrmDocVariables
On Error GoTo Errorhandler
WinStat = Application.WindowState
Application.WindowState = wdWindowStateMinimize
Application.WindowState = wdWindowStateMaximize

FrmDocVariables.Show

CalculateSum
Application.WindowState = WinStat
GoTo Done

Errorhandler:
    MsgBox "Autoexecute failed"

Done:


End Sub

Sub ShowHideMultipageControls()

Dim ShowTabObj As control
Dim MpObject As control
Dim Applicable As String 'string met modelcodes waarop multipage van toepassing is
Dim Consolidated As Boolean
Dim MpHidStatus As Boolean

Dim ModelSelectie As Boolean
Dim TbSelectie As Boolean 'eindoordeel op basis van tbinfo
Dim TbShow As Boolean 'variabele die bepaalt of tbinformatie <> 0
Dim ClassShow As Boolean 'hider page if template Class <> page

'er zijn drie variabelen die bepalen of een sheet zichtbaar is:
'* consolidatie / enkelvoudig
'* het model (beplaald door _show object op multipage tab)
'* financiele TB info (beplaad door Boo_Spec opbject op multipage tab)


showtype = GetDocPropNameErr("FSType")
modeltype = GetDocPropNameErr("DocIsClass")
RegnClass = GetDocPropNameErr("DARTLBL_FSnaam")

If BooIsConsolidated = True Then FrmDocVariables.Caption = "Koncernregnskab " & "Regnskabsklasse " & modeltype
If BooIsConsolidated = False Then FrmDocVariables.Caption = "Regnskabsklasse " & modeltype

If showtype <> "N/A" Then
       For Each PageTab In FrmDocVariables.MultiPage1.Pages
            
            MpHidStatus = False
            
            ModelSelectie = False
            TbSelectie = False
            TbShow = False
            ClassShow = True ' page visibel
                
            'uitlezen toepassingsgebied multipage
            For Each ShowTabObj In PageTab.Controls
        
                '- test model info
'                If InStr(1, UCase(ShowTabObj.Name), "_SHOW") > 0 Then
'
'                    Applicable = ShowTabObj.Caption
'                    ShowTabObj.Visible = False
'
'                    ModelSelectie = True
'
'                End If
                
                '- test TB info
                If InStr(1, UCase(ShowTabObj.Name), "BOO_SPEC") > 0 Then
                
                    If UCase(ShowTabObj.Caption) = "TRUE" Then
                    
                        TbShow = True
                    
                    End If
                   
                    TbSelectie = True
                    ShowTabObj.Visible = False
                End If
                           
                ' Demo Frame hiden voor bep. modellen
                If PageTab.Visible = True Then
                  If InStr(1, UCase(ShowTabObj.Name), "SHWLABEL_") > 0 Then
                     ShowTabObj.Visible = False
                     If InStr(1, UCase(ShowTabObj.Caption), "_" & showtype & "_") > 0 Then
                        ShowTabObj.Parent.Visible = True
                     Else
                        ShowTabObj.Parent.Visible = False
                 End If
                  End If
                End If
                
                'Add by BEPE; hide class C pages in class B teplates
                If InStr(1, UCase(ShowTabObj.Name), "BOO_CLASS") > 0 Then
                
                    If UCase(ShowTabObj.Caption) = "C" And modeltype = "C" Then
                    
                        ClassShow = True
                    Else
                        ClassShow = False
                    
                    End If
                   
                    TbSelectie = True
                    ShowTabObj.Visible = False
                End If
                'add be BEPE; hide non mikro page in class B
                If InStr(1, UCase(ShowTabObj.Name), "BOO_MIKRO_FALSE_") > 0 Then
                
                    If RegnClass = "Mikro B" Then
                    
                        ClassShow = False
                    Else
                        ClassShow = True
                        
                    
                    End If
                   
                    TbSelectie = True
                    ShowTabObj.Visible = False
                End If
                
            Next ShowTabObj
            
            
            If ModelSelectie = False Then
                'No _show object on multipage
                'applicable to all; check consolidatie
                If BooIsConsolidated = False Then
                    If InStr(1, UCase(PageTab.Caption), "(KONCERN)") > 0 Then
                        MpHidStatus = True
                    Else
                        MpHidStatus = False
                        
                        'verwijderen (E) extention
                        If InStr(1, UCase(PageTab.Caption), "(MODER)") > 0 Then
                        
                            PageTab.Caption = Left(PageTab.Caption, Len(PageTab.Caption) - 8)
                        
                        End If
                        
                    End If
                    
                Else
                    If PageTab.Tag = "Consolidated" Then
                        PageTab.Caption = PageTab.Caption & " (Koncern) "
                    End If
                End If
                
                GoTo notfound:
                
            End If
Found:
            'zetten visuele status multipage
            
            'True multipage hidden; false visible
            If InStr(1, Applicable, "_" & showtype & "_") > 0 Then
                            
                If BooIsConsolidated = True Then
                    
                    'consolidatie
                    MpHidStatus = False
                
                Else
                
                    'geen consolidatie
                    If InStr(1, UCase(PageTab.Caption), "(KONCERN)") > 0 Then
                        MpHidStatus = True 'hidden maken tab
                    Else
                        MpHidStatus = False
                    End If
                                       
                End If
                
            Else
            
                MpHidStatus = True 'hidden maken tab
            
            End If
            
notfound:
            'zetten visuele status Multipage en objecten
            If MpHidStatus = True Then
                PageTab.Visible = False
                For Each MpObject In PageTab.Controls
                    MpObject.Visible = False
                Next MpObject
            
            Else
            
                If TbSelectie = True And (TbShow = False Or ClassShow = False) Then
                
                    PageTab.Visible = False
                    For Each MpObject In PageTab.Controls
                        MpObject.Visible = False
                    Next MpObject
                
                Else
                
                PageTab.Visible = True
                    'add by BEPE (are used fore show and hid guidence text in the forms,depneded on accounting class)
                    
                    For Each MpObject In PageTab.Controls
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "TEXTLBL_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "TXTINT_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "LBLTOT_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "LBLINT_CLASSC_") > 0 Then MpObject.Visible = False
                     
                     If modeltype = "C" And InStr(1, UCase(MpObject.Name), "TEXTLBL_CLASSB_") > 0 Then MpObject.Visible = False
                     If BooIsConsolidated = False And InStr(1, UCase(MpObject.Name), "_C_") > 0 Then MpObject.Visible = False
                     If BooIsConsolidated = True And InStr(1, UCase(MpObject.Name), "_E_") > 0 Then MpObject.Visible = False
                     
                     If modeltype = "C" And InStr(1, UCase(MpObject.Name), "FRM_CLASSB") > 0 Then MpObject.Visible = False
'
                    If RegnClass = "Mikro B" And MpObject.Tag = "Mikro_false" Then
                    MpObject.Visible = False
                    End If
                    Next MpObject
                End If
                
            End If
                    
        Next PageTab

End If
End Sub
Sub ShowHideMultipageControls_Consol()

Dim ShowTabObj As control
Dim MpObject As control
Dim Applicable As String 'string met modelcodes waarop multipage van toepassing is
Dim Consolidated As Boolean
Dim MpHidStatus As Boolean

Dim ModelSelectie As Boolean
Dim TbSelectie As Boolean 'eindoordeel op basis van tbinfo
Dim TbShow As Boolean 'variabele die bepaalt of tbinformatie <> 0
Dim ClassShow As Boolean 'hider page if template Class <> page

'er zijn drie variabelen die bepalen of een sheet zichtbaar is:
'* consolidatie / enkelvoudig
'* het model (beplaald door _show object op multipage tab)
'* financiele TB info (beplaad door Boo_Spec opbject op multipage tab)


showtype = GetDocPropNameErr("FSType")
modeltype = GetDocPropNameErr("DocIsClass")

If BooIsConsolidated = True Then FrmDocVarConSul.Caption = "Koncernregnskab " & "Regnskabsklasse " & modeltype & " - Noter"
If BooIsConsolidated = False Then FrmDocVarConSul.Caption = "Regnskabsklasse " & modeltype & " - Noter"

If showtype <> "N/A" Then
       For Each PageTab In FrmDocVarConSul.MultiPage1.Pages
            
            MpHidStatus = False
            
            ModelSelectie = False
            TbSelectie = False
            TbShow = False
            ClassShow = True ' page visibel
                
            'uitlezen toepassingsgebied multipage
            For Each ShowTabObj In PageTab.Controls
        
                '- test model info
'                If InStr(1, UCase(ShowTabObj.Name), "_SHOW") > 0 Then
'
'                    Applicable = ShowTabObj.Caption
'                    ShowTabObj.Visible = False
'
'                    ModelSelectie = True
'
'                End If
                
                '- test TB info
                If InStr(1, UCase(ShowTabObj.Name), "BOO_SPEC") > 0 Then
                
                    If UCase(ShowTabObj.Caption) = "TRUE" Then
                    
                        TbShow = True
                    
                    End If
                   
                    TbSelectie = True
                    ShowTabObj.Visible = False
                End If
                           
                ' Demo Frame hiden voor bep. modellen
                If PageTab.Visible = True Then
                  If InStr(1, UCase(ShowTabObj.Name), "SHWLABEL_") > 0 Then
                     ShowTabObj.Visible = False
                     If InStr(1, UCase(ShowTabObj.Caption), "_" & showtype & "_") > 0 Then
                        ShowTabObj.Parent.Visible = True
                     Else
                        ShowTabObj.Parent.Visible = False
                     End If
                  End If
                End If
                
                'Add by BEPE; hide class C pages in class B teplates
                If InStr(1, UCase(ShowTabObj.Name), "BOO_CLASS") > 0 Then
                
                    If UCase(ShowTabObj.Caption) = "C" And modeltype = "C" Then
                    
                        ClassShow = True
                    Else
                        ClassShow = False
                    
                    End If
                   
                    TbSelectie = True
                    ShowTabObj.Visible = False
                End If
                
                
            Next ShowTabObj
            
            
            If ModelSelectie = False Then
                'No _show object on multipage
                'applicable to all; check consolidatie
                If BooIsConsolidated = False Then
                    If InStr(1, UCase(PageTab.Caption), "(KONCERN)") > 0 Then
                        MpHidStatus = True
                    Else
                        MpHidStatus = False
                        
                        'verwijderen (E) extention
                        If InStr(1, UCase(PageTab.Caption), "(MODER)") > 0 Then
                        
                            PageTab.Caption = Left(PageTab.Caption, Len(PageTab.Caption) - 8)
                        
                        End If
                        
                    End If
                    
                Else
                    If PageTab.Tag = "Consolidated" Then
                        PageTab.Caption = PageTab.Caption & " (Koncern) "
                    End If
                End If
                
                GoTo notfound:
                
            End If
Found:
            'zetten visuele status multipage
            
            'True multipage hidden; false visible
            If InStr(1, Applicable, "_" & showtype & "_") > 0 Then
                            
                If BooIsConsolidated = True Then
                    
                    'consolidatie
                    MpHidStatus = False
                
                Else
                
                    'geen consolidatie
                    If InStr(1, UCase(PageTab.Caption), "(KONCERN)") > 0 Then
                        MpHidStatus = True 'hidden maken tab
                    Else
                        MpHidStatus = False
                    End If
                                       
                End If
                
            Else
            
                MpHidStatus = True 'hidden maken tab
            
            End If
            
notfound:
            'zetten visuele status Multipage en objecten
            If MpHidStatus = True Then
                PageTab.Visible = False
                For Each MpObject In PageTab.Controls
                    MpObject.Visible = False
                Next MpObject
            
            Else
            
                If TbSelectie = True And (TbShow = False Or ClassShow = False) Then
                
                    PageTab.Visible = False
                    For Each MpObject In PageTab.Controls
                        MpObject.Visible = False
                    Next MpObject
                
                Else
                
                PageTab.Visible = True
                    'add by BEPE (are used fore show and hid guidence text in the forms,depneded on accounting class)
                    
                    For Each MpObject In PageTab.Controls
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "TEXTLBL_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "TXTINT_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "LBLTOT_CLASSC_") > 0 Then MpObject.Visible = False
                     If modeltype = "B" And InStr(1, UCase(MpObject.Name), "LBLINT_CLASSC_") > 0 Then MpObject.Visible = False
                     
                     If modeltype = "C" And InStr(1, UCase(MpObject.Name), "TEXTLBL_CLASSB_") > 0 Then MpObject.Visible = False
                     If BooIsConsolidated = False And InStr(1, UCase(MpObject.Name), "_C_") > 0 Then MpObject.Visible = False
                     If BooIsConsolidated = True And InStr(1, UCase(MpObject.Name), "_E_") > 0 Then MpObject.Visible = False
                     
                     If modeltype = "C" And InStr(1, UCase(MpObject.Name), "FRM_CLASSB") > 0 Then MpObject.Visible = False
'
                    
                    
                    Next MpObject
                End If
                
            End If
                    
        Next PageTab

End If
End Sub
Attribute VB_Name = "SubVarForm"
Sub SelectSubForm()
selpage = FrmDocVariables.MultiPage1.Pages(FrmDocVariables.MultiPage1.value).Name
Load FrmSubVar

showtype = GetDocPropNameErr("FSType")

If showtype <> "N/A" Then
For Each PageTab In FrmSubVar.PgSubVar.Pages

    TestTab = PageTab.Name
    If TestTab = selpage Then

        PageTab.Visible = True

    Else

        PageTab.Visible = False

    End If


'Hide delen van SubForm (Zie StartInit module voor Code onder ShowHideMultipageControls)
' Demo Frame hiden voor bep. modellen
                If PageTab.Visible = True Then
                
                    For Each ShowTabObj In PageTab.Controls
                        If InStr(1, UCase(ShowTabObj.Name), "SHWLABEL_") > 0 Then
                           ShowTabObj.Visible = False
                           If InStr(1, UCase(ShowTabObj.Caption), "_" & showtype & "_") > 0 Then
                              ShowTabObj.Parent.Visible = True
                           Else
                              ShowTabObj.Parent.Visible = False
                           End If
                        End If
                      Next
                End If




Next PageTab
End If
FrmSubVar.Show

End Sub
Attribute VB_Name = "TestProgram"







'henter en ekstern liste over de felter som valideres
Function GetFieldNames()

Dim FilePath As String
FilePath = "C:\ProgramData\Deloitte\DPT\Data\DB\DPTFieldnames.txt"

Dim Fieldinfo As Variant
Dim i As Integer

Open FilePath For Input As #1
Do Until EOF(1)
    Line Input #1, linefromfile
    
    
    Fieldinfo = Split(linefromfile, ";")
    
Loop
Close #1
GetFieldNames = Fieldinfo

End Function

Sub SyncWithERST()
Dim FieldNames() As String
FieldNames = GetFieldNames

Dim cvr As String

cvr = FrmDocVariables(FieldNames(0)).Text
On Error GoTo Errorhandler
If cvr = "XXXXXXXX" Or cvr = "" Then

Else
    Client = get_info(cvr)
    searchstring = "<h1 class=" + Chr(34) + "enhedsnavn" + Chr(34) + ">"
    searchstring2 = "</h1>"
    startPos = InStr(1, Client, searchstring) + Len(searchstring)
    endPos = InStr(startPos, Client, searchstring2)
    clientname = Trim(Mid(Client, startPos, endPos - startPos))
    clientnameVB = FrmDocVariables(FieldNames(1)).Text
    If clientnameVB = "Kundenavn" Or clientnameVB = "" Then
        FrmDocVariables(FieldNames(1)).Text = clientname
        FrmDocVariables(FieldNames(1)).ForeColor = vbBlue
        ChkForcedBox (True)
        Exit Sub
    End If
    If UCase(clientname) = UCase(clientnameVB) Then
        FrmDocVariables(FieldNames(1)).ForeColor = vbBlue
        Exit Sub
    Else
        msg = "ERST: " + clientname + Chr(10) + "Indtastet: " + clientnameVB + Chr(10) + Chr(10) + "Kontroller-CVR nummer og kundenavn"
        titel = "Uoverensstemmelse"
        MsgBox msg, , titel
        
    End If
End If
Exit Sub
Errorhandler: MsgBox "Kontrollen kunne ikke gennemf|fffd|res"

End Sub



Function get_info(ByVal cvr As String)
Dim url As String
'url = "http://distribution.virk.dk/offentliggoerelser/_search?q=cvrNummer:" & CVR
url = "https://datacvr.virk.dk/data/visenhed?enhedstype=virksomhed&id=" + cvr + "&soeg=" + cvr
Dim httpRequest As Object
    
    On Error Resume Next
    Set httpRequest = CreateObject("WinHttp.WinHttpRequest.5.1")
    If httpRequest Is Nothing Then
        Set httpRequest = CreateObject("WinHttp.WinHttpRequest.5")
    End If
    Err.Clear
    On Error GoTo 0
    
    ' Launch the HTTP httpRequest synchronously
    On Error Resume Next
    httpRequest.Open "GET", url, False
    If Err.Number <> 0 Then
       get_info = False
       Err.Clear
    Else
        httpRequest.Send
        httpRequest.WaitForResponse
        
        If Err.Number <> 0 Then
           Err.Clear
           get_info = False
        ElseIf httpRequest.Status > 400 Then
           get_info = False
         Else
           get_info = httpRequest.ResponseText
    
           
        End If
    End If
    On Error GoTo 0
End Function
Sub openTaksonomi()
Dim link As String
link = "http://regnskaber.virk.dk/38401392/eGJybHN0b3JlOi8vWC00RUUxRTIwOC0yMDE0MDgxOF8xMzA2NDVfMDU2L3hicmw.xml"
Dim Req As New XMLHTTP60
Req.Open "get", link
Req.Send

Dim Reps As New DOMDocument60
Reps.LoadXML Req.responseXML

Debug.Print (Reps.getElementsByTagName("period").Length)
Dim ClassOfreport As IXMLDOMNode

ClassOfreport = Reps.SelectNodes("ClassOfReportingEntity")



'Dim NameOfReportingEntity As IXMLDOMElem
'NameOfReportingEntity = Reps.getElementsByTagName("NameOfReportingEntity")

End Sub

Sub auto_field()
    Dim TabObj As control
    Dim NewValue As Long
    Dim FeildLabel As String
    
    NewValue = 100


    'Froms som skal auto udfyldes
    'FrmCashFlow, FrmDocVariables,FrmFinAss,FrmFinHigh, FrmFixedAS2, FrmInv, FrmKonFixedAs2, FrmSubVar, FrmTreasure, FrmTreasureSub
     
    For Each PageTab In FrmDocVariables.MultiPage1.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            
            For Each TabObj In PageTab.Controls
            
                
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Then
                
                If TabObj.value = "" Then TabObj.value = NewValue
                End If
                
                If InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    
                  If TabObj.value = "" Then TabObj.value = TabObj.Name
                    
                End If

            Next TabObj
        End If
    Next PageTab
End Sub
'test DocVariables
Sub DocVariables_Test()
Dim TabObj As control
    Load FrmDocVariables
    For Each PageTab In FrmDocVariables.MultiPage1.Pages
     If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmDocVariables.Show
End Sub
'Test FrmCashFlow
Sub CashFlow_Test()
    Dim TabObj As control
    Load FrmCashFlow
    For Each PageTab In FrmCashFlow.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmCashFlow.Show
End Sub
'FrmFinAss
Sub FrmFinAss_Test()
Dim TabObj As control
    Load FrmFinAss
    For Each PageTab In FrmFinAss.MultiPage1.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmFinAss.Show
End Sub
'FrmFinHigh
Sub FrmFinHigh_Test()
Dim TabObj As control
    Load FrmFinHigh
    For Each PageTab In FrmFinHigh.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmFinHigh.Show
End Sub
'Fixedas2
Sub Fixedas2_Test()
Load FrmFixedAs2
    For Each PageTab In FrmFixedAs2.MultiPage1.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmFixedAs2.Show
End Sub
'FrmInv
Sub FrmInv_Test()
Load FrmInv
    For Each PageTab In FrmInv.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmInv.Show
End Sub
'FrmKonFixedAs2
Sub FrmKonFixedAs2_Test()
Load FrmKonFixedAs2
    For Each PageTab In FrmKonFixedAs2.MultiPage1.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmKonFixedAs2.Show
End Sub
'FrmSubVar
Sub FrmSubVar_Test()
Load FrmSubVar
    For Each PageTab In FrmSubVar.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmSubVar.Show
End Sub
'FrmTreasure
Sub FrmTreasure_Test()
Load FrmTreasure
    For Each PageTab In FrmTreasure.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmTreasure.Show
End Sub
'FrmTreasureSub
Sub FrmTreasureSub_Test()
Load FrmTreasureSub
    For Each PageTab In FrmTreasureSub.PgSubVar.Pages
        If PageTab.Visible = True Then '(anvendes kun for klasse B)
            For Each TabObj In PageTab.Controls
                If InStr(1, UCase(TabObj.Name), "TXTINT") > 0 Or InStr(1, UCase(TabObj.Name), "TXTSTR") > 0 Then
                    TabObj.value = TabObj.TabIndex
                End If
            Next TabObj
        End If
    Next PageTab
    FrmTreasureSub.Show
End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1TemplateProject.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Private Sub Document_Open()

End Sub

Attribute VB_Name = "URL_VALIDATION"
Function GetValidUrl(ByVal enteredUrl As String)
    
    url = Trim(enteredUrl)
    If url = "" Then Exit Function
    If InStr(url, "http://") = 0 And InStr(url, "https://") = 0 Then
        url = "http://" & url
    End If
    
    GetValidUrl = url
End Function

Function IsActiveUrl(ByVal url As String)
    Dim httpRequest As Object
    
    On Error Resume Next
    Set httpRequest = CreateObject("WinHttp.WinHttpRequest.5.1")
    If httpRequest Is Nothing Then
        Set httpRequest = CreateObject("WinHttp.WinHttpRequest.5")
    End If
    Err.Clear
    On Error GoTo 0
    
    ' Launch the HTTP httpRequest synchronously
    On Error Resume Next
    httpRequest.Open "GET", url, False
    If Err.Number <> 0 Then
       IsActiveUrl = False
       Err.Clear
    Else
        httpRequest.Send
        httpRequest.WaitForResponse
        
        If Err.Number <> 0 Then
           Err.Clear
           IsActiveUrl = False
        ElseIf httpRequest.Status > 400 Then
           IsActiveUrl = False
         Else
           IsActiveUrl = True
        End If
    End If
    On Error GoTo 0
End Function

Attribute VB_Name = "ValidationClient"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Function ValidateFormAndDocumentProperties(ByVal cvr As String, ByVal form As UserForm, ByVal dp As DocumentProperties)
    Set dict = CreateObject("scripting.dictionary")
    
    Dim prop As DocumentProperty
    For Each prop In dp
        If Left(prop.value, 1) = "'" Then
            dict.Add prop.Name, Right(prop.value, Len(prop.value) - 1)
        ElseIf prop.value <> "" Then
           dict.Add prop.Name, prop.value
        End If
    Next
    
    Dim ctrl As control
    Dim canBeDate As Boolean
    For Each ctrl In form.Controls
        If InStr(1, UCase(ctrl.Name), "TXT") > 0 Or InStr(1, UCase(ctrl.Name), "CHK") > 0 Or InStr(1, UCase(ctrl.Name), "LSTINT") > 0 Then
            currentValue = ""
            
            If ctrl.value <> "" And ctrl.Parent.Visible = True Then 'Aanpassing AVS 16022010 ivm Fiscaal SubForm
                canBeDate = False
                
                If InStr(LCase(ctrl.Name), "int_") > 0 And InStr(LCase(ctrl.Name), "lstint_") > 0 Then
                    currentValue = ctrl.ListIndex
                ElseIf InStr(LCase(ctrl.Name), "int_") > 0 Then
                    currentValue = ConvStrToNumb(ctrl.value, ctrl.Name)
                ElseIf InStr(LCase(ctrl.Name), "dat_") > 0 Then
                    currentValue = ctrl.value
                    canBeDate = True
                ElseIf InStr(LCase(ctrl.Name), "boo_") > 0 Then
                   currentValue = CStr(ctrl.value)
                ElseIf InStr(LCase(ctrl.Name), "str_") > 0 And Left(ctrl.value, 1) = "'" Then
                    currentValue = Right(ctrl.value, Len(ctrl.value) - 1)
                    canBeDate = True
                Else
                    currentValue = ctrl.value
                    canBeDate = True
                End If
                
                If canBeDate Then
                    dateString = Replace(currentValue, ".", "-")
                    
                    If IsDate(dateString) Then
                        currentValue = Format(DateValue(dateString), "yyyy-MM-dd hh:mm:ss")
                    End If
                End If
            End If
           
            If currentValue = "" And dict.Exists(ctrl.Name) Then
                dict.Remove (ctrl.Name)
            ElseIf currentValue <> "" Then
                If Not dict.Exists(ctrl.Name) Then
                    dict.Add ctrl.Name, currentValue
                Else
                    dict.item(ctrl.Name) = currentValue
                End If
            End If
        End If
    Next ctrl
    
    Dim json As String
    json = DictionaryToJSON(dict)
    Set dict = Nothing
    
    ValidateFormAndDocumentProperties = Validate(cvr, json)
End Function

Public Function ValidateDocumentProperties(ByVal cvr As String, ByVal dp As DocumentProperties) As ValidationResult()
    Dim json As String
    json = "{ ""data"":{"
    
    Dim prop As DocumentProperty
    i = 0
    For Each prop In dp
        If i > 0 Then json = json & ","
        json = json & """" & prop.Name & """:""" & Replace(Replace(prop.value, "\", "\\"), """", "\""") & """"
        
        i = i + 1
    Next
    
    json = json & "}}"
    
    ValidateDocumentProperties = Validate(cvr, json)
End Function

Private Function DictionaryToJSON(ByVal dict As Object) As String
    Dim json As String
    json = "{ ""data"":{"
    
    i = 0
    Dim propValue As String
    For Each propName In dict.Keys
        propValue = dict.item(propName)
        
        If i > 0 Then json = json & ","
        json = json & """" & propName & """:""" & Replace(Replace(propValue, "\", "\\"), """", "\""") & """"
        
        i = i + 1
    Next
    
    json = json & "}}"

    DictionaryToJSON = json
End Function

Private Function Validate(ByVal cvr As String, ByVal json As String) As ValidationResult()
    Dim url As String
    Dim Stad_validate As Boolean
    Stad_validate = FrmDocVariables.ChkBoo_S_Stad_Validate.value
    If Stad_validate = False Then
        url = "http://cdv/RuleSet/Validate?ruleset=DPT&identifier=" & cvr 'production database
    Else
        MsgBox "Kontrollen vil blive gennemf|fffd|rt via test databasen"
         
        url = "http://cdvtest/RuleSet/Validate?ruleset=DPT&identifier=" & cvr 'test database
        
    End If
    Dim request As New WinHttpRequest
    request.Open "POST", url, False
    request.SetRequestHeader "Content-Type", "application/json"
    request.SetAutoLogonPolicy 0
    request.Send json
    
    Dim response As String
    response = request.ResponseText
    
    Set request = Nothing
    
    Validate = GetValidationResults(response)
End Function




Private Function GetValidationResults(ByVal response As String)
' [{"ValidationField":"Kundenavn","Action":0,"Severity":0,"Message":"Navn hentet","Data":"Margo Sko ApS"},{"ValidationField":null,"Action":2,"Severity":1,"Message":"Navn er ikke det officielel","Data":"Margo Sko ApS"}]
    Dim results() As ValidationResult
    Dim val As ValidationResult
    
    response = Replace(Replace(Replace(response, "\""", """"), "\\", "\"), "\u0027", "'")
    
    
    If Len(response) > 5 Then
        Dim items() As String
        items = Split(response, "},{")
        
        For count = 0 To UBound(items)
            ReDim Preserve results(count)
            Dim item As String
            item = items(count)
            If Left(item, 2) = "[{" Then item = Right(item, Len(item) - 2)
            If Right(item, 2) = "}]" Then item = Left(item, Len(item) - 2)
            
            Set val = New ValidationResult
            val.ValidationField = GetPropertyValue(item, "ValidationField")
            val.Action = GetPropertyValue(item, "Action")
            val.Severity = GetPropertyValue(item, "Severity")
            val.Data = GetPropertyValue(item, "Data")
            val.Message = GetPropertyValue(item, "Message")
            
            Set results(count) = val
        Next
    End If
    
    GetValidationResults = results
End Function

Private Function GetPropertyValue(item, propertyName)
    Dim indexOfPropertyName As Integer
    indexOfPropertyName = InStr(1, item, """" & propertyName & """")
    Dim endOfProperty As Integer
    endOfProperty = InStr(indexOfPropertyName, item, ",")
    If endOfProperty = 0 Then endOfProperty = Len(item) + 1
    
    Dim value As String
    value = Mid(item, indexOfPropertyName + Len(propertyName) + 3, endOfProperty - indexOfPropertyName - Len(propertyName) - 3)
    If Len(value) > 0 Then
        If Left(value, 1) = """" And Right(value, 1) = """" Then
            value = Mid(value, 2, Len(value) - 2)
        End If
    End If
    
    GetPropertyValue = value
End Function
Attribute VB_Name = "ValidationResult"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public ValidationField As String
Public Action As ActionEnum
Public Severity As SeverityEnum
Public Message As String
Public Data As String

Public Enum ActionEnum
    ReplaceValue = 0
    Fail = 1
    Check = 2
    Pass = 3
End Enum

Public Enum SeverityEnum
    Info = 0
    Warning = 1
    Error = 2
End Enum


Attribute VB_Name = "lstdef"
Sub InitializeLists()

modeltype = GetDocPropNameErr("DocIsClass")

FrmDocVariables.LstInt_Audit_type.AddItem ("Revision")
FrmDocVariables.LstInt_Audit_type.AddItem ("Udvidet gennemgang")
'FrmDocVariables.LstInt_Audit_type.AddItem ("Review")
FrmDocVariables.LstInt_Audit_type.AddItem ("Assistance")

'kun revsion, review og udvidetgemmengang
FrmDocVariables.LstInt_Audit_Opinion.AddItem ("Uden forbehold")
FrmDocVariables.LstInt_Audit_Opinion.AddItem ("Med forbehold pga. uenighed med ledelsen")
FrmDocVariables.LstInt_Audit_Opinion.AddItem ("Med forbehold pga. utilstr|fffd|kkeligt revisionsbevis")
FrmDocVariables.LstInt_Audit_Opinion.AddItem ("Med afkr|fffd|ftende konklusion")
FrmDocVariables.LstInt_Audit_Opinion.AddItem ("Med manglende konklusion")

'Kun revision og udgivet gennemgang
FrmDocVariables.LstInt_Audit_Management.AddItem ("Ledelsesberetningen er i o.m. |fffd|rsregnskabet")
FrmDocVariables.LstInt_Audit_Management.AddItem ("Ledelsesberetningen er ikke i o.m. |fffd|rsregnskabet")


FrmDocVariables.LstInt_CURR.AddItem ("kr.")
FrmDocVariables.LstInt_CURR.AddItem ("EUR")
FrmDocVariables.LstInt_CURR.AddItem ("USD")
FrmDocVariables.LstInt_CURR.AddItem ("GBP")
FrmDocVariables.LstInt_CURR.AddItem ("NOK")
FrmDocVariables.LstInt_CURR.AddItem ("SEK")
FrmDocVariables.LstInt_CURR.AddItem ("CHF")

FrmDocVariables.LstInt_ROUNDCY.AddItem ("x 1")
FrmDocVariables.LstInt_ROUNDCY.AddItem ("x 1.000")
FrmDocVariables.LstInt_ROUNDCY.AddItem ("x 1.000.000")

FrmDocVariables.LstInt_ROUNDPY.AddItem ("x 1")
FrmDocVariables.LstInt_ROUNDPY.AddItem ("x 1.000")
FrmDocVariables.LstInt_ROUNDPY.AddItem ("x 1.000.000")

FrmDocVariables.LstInt_GROSS.AddItem ("Ja")
FrmDocVariables.LstInt_GROSS.AddItem ("Nej")

FrmDocVariables.LstInt_FINHIGH.AddItem ("Ja")
FrmDocVariables.LstInt_FINHIGH.AddItem ("Nej")

FrmDocVariables.LstInt_CashFlow.AddItem ("Ja")
FrmDocVariables.LstInt_CashFlow.AddItem ("Nej")

FrmDocVariables.LstInt_SUPER.AddItem ("Bestyrelse")
FrmDocVariables.LstInt_SUPER.AddItem ("Tilsynsr|fffd|d")
FrmDocVariables.LstInt_SUPER.AddItem ("Repr|fffd|sentantskab")

FrmDocVariables.LstInt_Period.AddItem ("|fffd|rsrapport")
FrmDocVariables.LstInt_Period.AddItem ("Del|fffd|rsrapport")



FrmDocVariables.LstInt_Treasur_MANACOM.AddItem ("Ja")
FrmDocVariables.LstInt_Treasur_MANACOM.AddItem ("Nej")

FrmDocVariables.LstInt_FUNDS.AddItem ("")
FrmDocVariables.LstInt_FUNDS.AddItem ("Ja")
FrmDocVariables.LstInt_FUNDS.AddItem ("Nej")

FrmDocVariables.LstInt_CLASS_CD.AddItem ("")
FrmDocVariables.LstInt_CLASS_CD.AddItem ("Nej")
FrmDocVariables.LstInt_CLASS_CD.AddItem ("Ja - C")
FrmDocVariables.LstInt_CLASS_CD.AddItem ("Ja - C og D")



End Sub
'for moder, b og C
Sub InitializeLists_FixedAs2()

FrmFixedAs2.LstInt_TABSPLIT.AddItem ("Automatisk")
FrmFixedAs2.LstInt_TABSPLIT.AddItem ("max 25 selskaber pr. tabel")
FrmFixedAs2.LstInt_TABSPLIT.AddItem ("max 20 selskaber pr. tabel")
FrmFixedAs2.LstInt_TABSPLIT.AddItem ("max 15 selskaber pr. tabel")

End Sub
'for koncern
Sub InitializeLists_KonFixedAs2()

FrmKonFixedAs2.LstInt_TABSPLIT.AddItem ("Automatisk")
FrmKonFixedAs2.LstInt_TABSPLIT.AddItem ("max 25 selskaber pr. tabel")
FrmKonFixedAs2.LstInt_TABSPLIT.AddItem ("max 20 selskaber pr. tabel")
FrmKonFixedAs2.LstInt_TABSPLIT.AddItem ("max 15 selskaber pr. tabel")


End Sub

Sub InitializeLists_FinHigh()

FrmFinHigh.LstInt_Ratio1.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio1.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio2.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio2.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio3.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio3.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio4.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio4.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio5.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio5.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio6.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio6.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio7.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio7.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio8.AddItem ("Ja")
FrmFinHigh.LstInt_Ratio8.AddItem ("Nej")

FrmFinHigh.LstInt_Ratio_CF_01.AddItem ("Vis")
FrmFinHigh.LstInt_Ratio_CF_01.AddItem ("Skjul")

FrmFinHigh.LstInt_Ratio_CF_02.AddItem ("Vis")
FrmFinHigh.LstInt_Ratio_CF_02.AddItem ("Skjul")

FrmFinHigh.LstInt_Ratio_CF_03.AddItem ("Vis")
FrmFinHigh.LstInt_Ratio_CF_03.AddItem ("Skjul")

End Sub


Sub InitializeLists_FinHigh_C()

FrmKonFinHigh.LstInt_C_Ratio1.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio1.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio2.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio2.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio3.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio3.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio4.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio4.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio5.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio5.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio6.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio6.AddItem ("Nej")

FrmKonFinHigh.LstInt_C_Ratio7.AddItem ("Ja")
FrmKonFinHigh.LstInt_C_Ratio7.AddItem ("Nej")

End Sub
Sub InitializeLists_Auditrep()
FrmAuditrep.LstInt_Audit_type.AddItem ("Revision")
FrmAuditrep.LstInt_Audit_type.AddItem ("Udvidet gennemgang")
FrmAuditrep.LstInt_Audit_type.AddItem ("Assistance")

'kun revsion, review og udvidetgemmengang
FrmAuditrep.LstInt_Audit_Opinion.AddItem ("Uden forbehold")
FrmAuditrep.LstInt_Audit_Opinion.AddItem ("Med forbehold pga. uenighed med ledelsen")
FrmAuditrep.LstInt_Audit_Opinion.AddItem ("Med forbehold pga. utilstr|fffd|kkeligt revisionsbevis")
FrmAuditrep.LstInt_Audit_Opinion.AddItem ("Med afkr|fffd|ftende konklusion")
FrmAuditrep.LstInt_Audit_Opinion.AddItem ("Med manglende konklusion")

'Kun revision og udgivet gennemgang
FrmAuditrep.LstInt_Audit_Management.AddItem ("Ledelsesberetningen er i o.m. |fffd|rsregnskabet")
FrmAuditrep.LstInt_Audit_Management.AddItem ("Ledelsesberetningen er ikke i o.m. |fffd|rsregnskabet")

End Sub


Sub hoppa()

For Each prop In ActiveDocument.CustomDocumentProperties

If UCase(Left(prop.Name, 7)) = "XLTINT_" Then
prop.Delete

End If


Next
End Sub

Sub remoprop()

For Each prop In ActiveDocument.CustomDocumentProperties
CC = prop.Name
If InStr(1, UCase(prop.Name), "COMPDET") > 1 Then
If prop.value = "' " Then
prop.value = ""
End If

End If

Next

For Each obj In FrmDocVariables.Controls
'MsgBox Obj.Name

If obj.Name = "TxtStr_S_CompDet_Super_Name_04" Then
Aa = 23
End If


If InStr(1, UCase(obj.Name), "COMPDET") > 1 Then

qq = "A" & obj.value & "B"

obj.value = ""
obj.Text = ""
End If

Next

End Sub

Attribute VB_Name = "valuta"
Public valuta_code As String
'kontrollere om valutaenheden er jf. ISO
Function valuta_check(ByVal Valuta As String)
    'valuta_check = False
Dim Check_ISO As Boolean

ISO_Kode = Array("AED", "AFN", "ALL", "AMD", "ANG", "AOA", "ARS", "AUD", "AWG", "AZN", "BAM", "BBD", "BDT", "BGN", "BHD", "BIF", "BMD", "BND", "BOB", "BRL", "BSD", "BTN", "BWP", _
"BYR", "BZD", "CAD", "CDF", "CHF", "CLP", "CNY", "COP", "CRC", "CUC", "CUP", "CVE", "CZK", "DJF", "DKK", "DOP", "DZD", "EGP", "ERN", "ETB", "EUR", "JD", "FKP", _
"GBP", "GEL", "GGP", "GHS", "GIP", "GMD", "GNF", "GTQ", "GYD", "HKD", "HNL", "HRK", "HTG", "HUF", "IDR", "ILS", "IMP", "INR", "IQD", "IRR", "ISK", "JEP", _
"JMD", "JOD", "JPY", "KES", "KGS", "KHR", "KMF", "KPW", "KRW", "KWD", "KYD", "KZT", "LAK", "LBP", "LKR", "LRD", "LSL", "LTL", "LYD", "MAD", "MDL", "MGA", _
"MKD", "MMK", "MNT", "MOP", "MRO", "MUR", "MVR", "MWK", "MXN", "MYR", "MZN", "NAD", "NGN", "NIO", "NOK", "NPR", "NZD", "OMR", "PAB", "PEN", "PGK", "PHP", _
"PKR", "PLN", "PYG", "QAR", "RON", "RUB", "RSD", "RWF", "SAR", "SBD", "SCR", "SDG", "SEK", "SGD", "SHP", "SLL", "SOS", "SRD", "SSP", "STD", "SVC", "SYP", _
"SZL", "THB", "TJS", "TMT", "TND", "TOP", "TRY", "TTD", "TWD", "TZS", "UAH", "UGX", "USD", "UYU", "UZS", "VEF", "VND", "VUV", "WST", "XAF", "XCD", "XOF", _
"XPF", "YER", "ZAR", "ZMW", "ZWL")
    For i = 0 To UBound(ISO_Kode)
        If UCase(Valuta) = ISO_Kode(i) Then
            Check_ISO = True
            Exit For
        Else
            Check_ISO = False
        End If
    Next i
    If Check_ISO Then
        valuta_check = UCase(Valuta)
        Exit Function
    Else
        Load FrmValuta
        FrmValuta.Show
        valuta_check = valuta_code
    End If
End Function



' InQuest injected base64 decoded content
' xbrlstore://X-4EE1E208-20140818_130645_056/xbrl

INQUEST-PP=macro
