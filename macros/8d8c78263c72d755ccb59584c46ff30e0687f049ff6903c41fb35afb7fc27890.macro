Attribute VB_Name = "ADV"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "AUTO"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
' Zmeni pismena na velka v bu|fffd|ce VIN
' a zaroven omezi na prvni pismeno v pripade vlozeni vice
If Not Application.Intersect(Target, Range("AUTO_VIN")) Is Nothing Then
If Target.Column = 4 Then
  If Target.Row = 30 Then
    Application.EnableEvents = False
    Target.Value = UCase(Target.Text)
    Application.EnableEvents = True
  End If
End If
End If
End Sub


Attribute VB_Name = "AZA"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Auto_POR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "BOL"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim Castka

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    With ThisWorkbook.Worksheets("Bolestn|fffd|")
        
        If Not Application.Intersect(Target, .Range("BOL_Dat_Bol")) Is Nothing Then
            If Len(.Range("BOL_Dat_PU")) > 0 And IsDate(.Range("BOL_Dat_PU")) Then
                oDatumZdr = CDate(.Range("BOL_Dat_PU"))
                oDatumZdrH = IIf(.Range("BOL_Dat_Bol") = vbNullString, oDatumZdr, CDate(.Range("BOL_Dat_Bol")))
                datum_nyni = CDate(Format(Now(), "d.m.yyyy"))
                If oDatumZdrH < oDatumZdr Or oDatumZdrH > datum_nyni Then
                    .Range("BOL_Dat_Bol") = vbNullString
                    oDatumZdrH = oDatumZdr
                End If
                With UserForm_datum_Zdr.DTPicker1
                    '.MinDate = CDate("1.1.2000")
                    .MinDate = oDatumZdr
                    .MaxDate = datum_nyni
                    .Value = oDatumZdrH
                    .ControlTipText = "Zad|fffd|n|fffd| data vzniku bolesti"
                End With
                
                With UserForm_datum_Zdr
                    .Label_Datum_min = oDatumZdr
                    .Label_Datum_max = datum_nyni
                    .Label3.Caption = "vzniku bolesti"
                    If .Visible = True Then .Hide Else .Show
                End With
            Else
                .Range("BOL_Dat_PU").Select
            End If
        
        ElseIf Not Application.Intersect(Target, .Range("Kody_bol")) Is Nothing Then
            'nen|fffd|-li vypln|fffd|no 'Datum vzniku bolesti'
            If ActiveSheet.Range("C3").Value = "" Then
                ActiveSheet.Range("C3").Select
                Exit Sub
            End If
        
        ElseIf Not Application.Intersect(Target, .Range("Stupne_bol")) Is Nothing Then
            'nen|fffd|-li vypln|fffd|no 'Datum vzniku bolesti'
            If ActiveSheet.Range("C3").Value = "" Then
                ActiveSheet.Range("C3").Select
                Exit Sub
            End If
            
            u = Target.Column
            If ActiveCell.Column = u And u >= 9 And u <= 14 And .Range("K" & Target.Row).Value > 0 Then
                Application.EnableEvents = False
                Select Case u
                    Case 9, 10:     .Range("AL" & Target.Row).Value = 1
                    Case 11, 12:    .Range("AL" & Target.Row).Value = 2
                    Case 13, 14:    .Range("AL" & Target.Row).Value = 3
                    Case Else:      .Range("AL" & Target.Row).ClearContents
                End Select
                Application.EnableEvents = True
                
                If u Mod 2 = 1 Then
                    .Range("O" & Target.Row).Value = Target.Value
                    DoEvents    'lich|fffd|
                Else
                    .Range("O" & Target.Row).Value = Target.Offset(0, -1).Value
                    DoEvents    'sud|fffd|
                End If

            End If
        
        End If
    End With

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
' vyhled|fffd|n|fffd| zapsan|fffd| polo|fffd|ky ze seznamu a vlo|fffd|en|fffd| do kalkula|fffd|ky
Dim target_nova_hodnota, SWsht, SBlk, u, v, sl
Dim su As Boolean

su = Application.ScreenUpdating

If BOL_dopsani_stav = 1 Then
    Application.EnableEvents = False
    ThisWorkbook.Worksheets("Bolestn|fffd|").Range("B37").FormulaR1C1 = ""
    Application.EnableEvents = True
    GoTo radek_BOL_Change_konec:
End If

Set SWsht = ThisWorkbook.Worksheets("Datov|fffd| list ODP")
Set SBlk = Intersect(SWsht.UsedRange, SWsht.Range("Sled_Kod"))
  
With ThisWorkbook.Worksheets("Bolestn|fffd|")
  If Not Application.Intersect(Target, .Range("BOL_Dat_Bol")) Is Nothing Then
    
    If Len(Format(.Range("BOL_Dat_Bol").Value, "dd.mm.yyyy")) = 10 Then
        If Year(.Range("BOL_Dat_Bol").Value) >= 2014 Then
            ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B515").FormulaR1C1 = "MAX"
        ElseIf Year(.Range("BOL_Dat_Bol").Value) < 2014 Then
            ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B515").FormulaR1C1 = "MIN"
        Else
            ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B515").FormulaR1C1 = ""
        End If
    Else
        ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B515").FormulaR1C1 = ""
    End If
    
    BOL_prepocitat
    
  ' vyhled|fffd|n|fffd| zapsan|fffd| polo|fffd|ky ze seznamu a vlo|fffd|en|fffd| do kalkula|fffd|ky
  ElseIf Not Application.Intersect(Target, .Range("Kody_bol")) Is Nothing Then
      
      Application.ScreenUpdating = False
        Cislo_radku = 0
        u = Target.Row
        If Target.Value <> "" Then
            Application.EnableEvents = False
            target_nova_hodnota = Target.Value          'pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
            Application.Undo
            Target.Value = UCase(Trim(target_nova_hodnota))    'p|fffd|evod mal|fffd|ch p|fffd|smen na velk|fffd|, odstran|fffd|n|fffd| p|fffd|ebyte|fffd|n|fffd|ch mezer
            Application.EnableEvents = True

            Set C = ThisWorkbook.Worksheets("Polo|fffd|ky_NS").Range("A1:A" & BOL_ciselnik_NOZ_konec_radek).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            If Not C Is Nothing Then
              Cislo_radku = C.Row
              u = Target.Row
              SWsht.Range("A" & u + 554) = Cislo_radku 'zobrazen|fffd| nalezen|fffd| polo|fffd|ky v seznamu
              .Range("AL" & u).FormulaR1C1 = 1
              
              Castka = Target.Offset(0, 6)     'nab|fffd|dnut|fffd| |fffd||fffd|stka
              .Range("O" & u) = Castka         'zaps|fffd|n|fffd| nab|fffd|dnut|fffd| |fffd||fffd|stky
              .Range("B37").FormulaR1C1 = ""
            Else
              SWsht.Range("A" & 561 - 7 + u).FormulaR1C1 = 1
              .Range("AL" & u).ClearContents
              .Range("B37").FormulaR1C1 = "Na |fffd||fffd|dku " & Target.Row & " je neexistuj|fffd|c|fffd| polo|fffd|ka!"
              Application.Wait (Now + TimeValue("0:00:2"))
            End If
          
        Else
            SWsht.Range("A" & 561 - 7 + u).FormulaR1C1 = 1
            .Range("AL" & u).ClearContents
            .Range("o" & u).FormulaR1C1 = 0
            .Range("B37").FormulaR1C1 = ""
        End If
        
        If Cislo_radku = 0 Then
          Cislo_radku = 1
        End If
        
        For Each kc In SBlk.Cells
          If .Range("c" & u) = kc Then
            .Range("A300") = "A"
          End If
        Next kc
        If (.Range("S32") > 50000) Then
          .Range("B37").FormulaR1C1 = "Podl|fffd|h|fffd| schv|fffd|len|fffd| disponenta nebo p|fffd|edej do t|fffd|mu ZZ"
        End If
        .Range("c" & u).Select
    
    End If
    
    If Not Application.Intersect(Target, .Range("Mnozstvi_BOL")) Is Nothing Then
      ' zaps|fffd|n|fffd| nav|fffd||fffd|en|fffd| |fffd||fffd|stky p|fffd|i zm|fffd|n|fffd| mno|fffd|stv|fffd| v polo|fffd|ce
        u = Target.Row
        If .Range("h" & u) < 0 Then
          .Range("h" & u).FormulaR1C1 = 1
        End If
        If Target.Value <> "" Then
            'Castka = Target.Offset(0, 1).Value
            'v = .Range("K" & u).Value
            v = .Range("AL" & u).Value
            Select Case v
                Case 1:         Castka = Target.Offset(0, 1).Value
                Case 2:         Castka = Target.Offset(0, 3).Value
                Case 3:         Castka = Target.Offset(0, 5).Value
                Case Else:
            End Select
            
            If Castka <> "" Then
                Target.Offset(0, 7) = Castka
            End If
        End If
        
        .Range("B37").ClearContents
        
        For Each kc In SBlk.Cells
          If .Range("c" & u) = kc Then
            .Range("A300") = "A"
          End If
        Next kc
        .Range("c" & u).Select
    
    End If

radek_BOL_Change_konec:
Call BOL_ZSU_hledat_chyby("Bolestn|fffd|")

Application.ScreenUpdating = su

End With
 
 Set SBlk = Nothing
 Set SWsht = Nothing
End Sub

Attribute VB_Name = "CORN"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ControlEvents"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public WithEvents chkBoxE As MSForms.CheckBox
Attribute chkBoxE.VB_VarHelpID = -1

Private Sub chkBoxE_Click()
 'MsgBox chkBoxE.Caption & " was pressed!"
 UF_Textace.Klik
End Sub
Attribute VB_Name = "DACP"
Option Explicit

Public strPripad As String
Dim strPodpripad As String
Dim strPOJ As String
Dim strPOS As String
Dim strPZN As String
Dim strPLN As String
Dim strSPLU As String
Dim strSvodi As String
Dim strTym As String
Dim strPojistne As String
Dim strKomu As String
Dim strNahrSK As String
Dim strLimitPoj As String
Dim strTypLim As String
Dim strLargeCell1 As String
Dim strUspora As String
Dim strMZDA As String  ' MRO
Dim strProdRad As String  ' MRO
Dim strVIN As String
Dim strBOL As String
Dim strZSU As String
Dim strKDO As String
Dim strBolZvy As String
Dim strZSUZvy As String
Dim strBol_Nav_Dr As String
Dim strBol_Nav_Lik As String
Dim strBol_Nav_Cas As String
Dim strBol_Preda As String
Dim strSledPol As String
Dim strRC As String
Dim SoubOut As String
Dim strSolDan As String
Dim str_Verze As String
Dim strDanSolDan As String
Dim Hodnota_pole As String
Dim soubPDF As String
Dim strOC As String
Dim strVOC As String
Dim nODP As String
Dim fso As Object
Const cForAppending = 8
Dim p As Integer
Dim jmList As String
Dim Pole_Temp As Variant
Dim UserName As String
Dim pole As Variant
Dim r As Integer
Dim Line As String
Dim tso As Object
Dim sh As Worksheet

Public strSubj 'k Sub zjistit_subjekt()    '|fffd|P x GP
Public listy_upl(), list_pom    'k upload

Const pth = "\\sfs04\LowCost\LPUNZP\Data\Sber\"
  '"\\sfs04\LowCost\LPUNZP\Data\Sber\"
  '"H:\Moje plocha\"
Function Vy|fffd|istit(txt As String) As String
  txt = Replace(txt, vbTab, " ")                   'Zam|fffd||fffd| Tab za mezeru
  txt = Replace(txt, vbCr, " ")                    'Zam|fffd||fffd| CR za mezeru
  txt = Application.WorksheetFunction.Clean(txt)   'Odstra|fffd| zbyl|fffd| netisknuteln|fffd| znaky
  txt = Replace(txt, """", "")                     'Vynechej uvozovky
  Vy|fffd|istit = Replace(txt, ";", ",")                'Zam|fffd|n st|fffd|edn|fffd|k za |fffd||fffd|rku
End Function
Function Najit_ListX()  'najde v|fffd|echny listy s n|fffd|zvem 'ListX', kde X je |fffd||fffd|slo
Dim ListX_pom(), list, pocet
Dim jjk
pocet = -1
ReDim ListX_pom(0 To 0)
ListX_pom(0) = "X"  'v|fffd|choz|fffd| v|fffd|sledek funkce = nenalezeno
    
    For Each list In ThisWorkbook.Sheets
        If list.Name Like "List#" Then
            pocet = pocet + 1
            ReDim Preserve ListX_pom(0 To pocet)
            ListX_pom(pocet) = list.Name
        End If
    Next list
    
    Najit_ListX = ListX_pom
  
End Function
Function Aktualne_vybrane_listy()   'vytvo|fffd|it seznam aktu|fffd|ln|fffd| vybran|fffd|ch list|fffd|
Dim Akt_vybraneX_pom(), list, pocet

pocet = -1
ReDim Akt_vybraneX_pom(0 To 0)
Akt_vybraneX_pom(0) = "X"  'v|fffd|choz|fffd| v|fffd|sledek funkce = nenalezeno
    
    For Each list In ThisWorkbook.Windows(1).SelectedSheets
            pocet = pocet + 1
            ReDim Preserve Akt_vybraneX_pom(0 To pocet)
            Akt_vybraneX_pom(pocet) = list.Name
    Next list
    
    Aktualne_vybrane_listy = Akt_vybraneX_pom
  
End Function


Function Spojit_Pole(Pole1, Pole2)
    Dim arr_x_pocet, i, arr(), arr_pocet, duplicita
    arr_pocet = -1
    
    ReDim arr(0 To 0)
    arr(0) = "X"  'v|fffd|choz|fffd| v|fffd|sledek funkce
    
    'zpracovani Pole1
    If Not IsMissing(Pole1) And IsArray(Pole1) = True Then
        arr_x_pocet = UBound(Pole1)
        For i = 0 To arr_x_pocet
            If arr_pocet = -1 Then
                arr_pocet = 0
                ReDim Preserve arr(0 To 0)
                arr(0) = Pole1(i)
            Else
                duplicita = Filter(arr, Pole1(i))
                If UBound(duplicita) < 0 Then
                    arr_pocet = arr_pocet + 1
                    ReDim Preserve arr(0 To arr_pocet)
                    arr(arr_pocet) = Pole1(i)
                End If
            End If
        Next
    End If
    
    'zpracovani Pole2
    If Not IsMissing(Pole2) And IsArray(Pole2) = True Then
        arr_x_pocet = UBound(Pole2)
        For i = 0 To arr_x_pocet
            If arr_pocet = -1 Then
                arr_pocet = 0
                ReDim Preserve arr(0 To 0)
                arr(0) = Pole2(i)
            Else
                duplicita = Filter(arr, Pole2(i))
                If UBound(duplicita) < 0 Then
                    arr_pocet = arr_pocet + 1
                    ReDim Preserve arr(0 To arr_pocet)
                    arr(arr_pocet) = Pole2(i)
                End If
            End If
        Next
    End If
    
'i = arr(0) 'test
    Spojit_Pole = arr
End Function


Sub Upload_ODP()
  ZjistiPUaPP

    'NUTN|fffd| - zji|fffd|t|fffd|n|fffd| listu, ze kter|fffd|ho byla akce spu|fffd|t|fffd|na - vyu|fffd|ito na konci
    Dim akt_List, akt_list_codename, msg_dotaz
    list_pom = Najit_ListX     'zjistit, zda existuje list s n|fffd|zvem "ListX", kde X je |fffd||fffd|slo
   
    akt_List = ThisWorkbook.ActiveSheet.Name
    akt_list_codename = ThisWorkbook.ActiveSheet.CodeName
    
  ' Test vypln|fffd|n|fffd| pol|fffd|
  If strPripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo p|fffd||fffd|padu!"
    Exit Sub
  End If

  If strPodpripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo podp|fffd||fffd|padu!"
    Exit Sub
  End If
  
  If akt_list_codename <> "ADV" And akt_list_codename <> "ZTR" Then
    If strPOJ = "" Then
        MsgBox "Nevypln|fffd|no jm|fffd|no poji|fffd|t|fffd|n|fffd|ho!"
        Exit Sub
    End If
  End If
  
  If strPZN = "#HODNOTA!" Then
    MsgBox "Nevypln|fffd|n pr|fffd|vn|fffd| z|fffd|klad n|fffd|roku!"
    Exit Sub
  End If
  
  If akt_list_codename <> "ZTR" And akt_list_codename <> "PENAL" Then
    If strLargeCell1 = "" Then
    MsgBox "Nevypln|fffd|n d|fffd|j vzniku PU!"
    Exit Sub
    End If
  End If
  
  If strKDO <> "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s." And strKDO <> "Generali poji|fffd||fffd|ovna a.s." And strKDO <> "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s." Then
    MsgBox "Dopl|fffd| poji|fffd||fffd|ovnu, pro kterou je v|fffd|po|fffd|et prov|fffd|d|fffd|n"
    Exit Sub
  End If
  
  If akt_list_codename <> "ZTR" And akt_list_codename <> "ADV" Then
    If strPojistne = "" Then
      MsgBox "Nevypln|fffd|no placen|fffd| pojistn|fffd|ho!"
      Exit Sub
    End If
  End If
  
  If akt_list_codename = "TOT" Then
    If strOC = "" Then
      MsgBox "Nevypln|fffd|na obecn|fffd| cena vozidla!"
      Exit Sub
    End If
    If strVOC = "" Then
      MsgBox "Nevypln|fffd|no vyj|fffd|d|fffd|en|fffd| k obecn|fffd| cen|fffd| vozidla!"
      Exit Sub
    End If
  End If
  
  If (akt_list_codename <> "ADV") And akt_list_codename <> "PENAL" Then
    If strKomu = "" Or strKomu = "0" Then
      MsgBox "Nevypln|fffd|no komu hrad|fffd|te!"
      Exit Sub
    End If
  End If
  
  If strPLN = "0,00" And strSPLU = "0,00" And strNahrSK = "0,00" Then
      MsgBox "Nulov|fffd| pln|fffd|n|fffd|!"
      Exit Sub
  End If
  
  If akt_list_codename <> "ADV" And akt_list_codename <> "ZTR" And akt_list_codename <> "PENAL" Then
    If strLimitPoj = "" Then
      MsgBox "Vypl|fffd| limit poji|fffd|t|fffd|n|fffd|!"
      Exit Sub
    End If
  End If
  
  If (akt_list_codename = "SOU") Or (akt_list_codename = "AZ") Then
    If strPLN = "0" Then
      MsgBox "Nulov|fffd| pln|fffd|n|fffd|!"
      Exit Sub
    End If
  End If
  
  If (akt_list_codename = "AUTO") Or (akt_list_codename = "POVOL") Or (akt_list_codename = "TOT") Or (akt_list_codename = "SHAV") Then
        If strSvodi = "" Then
          MsgBox "Vypl|fffd| druh sledovan|fffd|ho v|fffd|po|fffd|tu"
          Exit Sub
        End If
        
        If strSvodi <> "Ne" Then
            If strUspora = "" Then
              MsgBox "Vypl|fffd| |fffd||fffd|stku |fffd|spory"
              Range(akt_list_codename + "_Uspora").Select       ' MRO
              Exit Sub
            End If
        End If
        
        If strUspora <> "" And IsNumeric(strUspora) = False Then
            MsgBox "|fffd||fffd|stka |fffd|spory neobsahuje |fffd||fffd|selnou hodnotu"
            Range(akt_list_codename + "_Uspora").Select             ' MRO
            Exit Sub
        End If
               
        If strSvodi <> "Ne" And strTym = "MON" Or strTym = "SKO" Then    ' MRO
            If strMZDA = "" Then
              MsgBox "Vypl|fffd| |fffd||fffd|stku |fffd|spory ze zji|fffd|t|fffd|n|fffd| mzdy"
              Range(akt_list_codename + "_MZDA").Select
              Exit Sub
            End If
        End If
        
        If strMZDA <> "" And IsNumeric(strMZDA) = False Then          ' MRO
            MsgBox "|fffd||fffd|stka |fffd|spory ze mzdy neobsahuje |fffd||fffd|selnou hodnotu"
            Range(akt_list_codename + "_MZDA").Select
            Exit Sub
        End If
        
        If Val(strMZDA) > Val(strUspora) Then          ' MRO
            MsgBox "|fffd||fffd|stka |fffd|spory ze mzdy nesm|fffd| b|fffd|t vy|fffd||fffd||fffd| ne|fffd| hodnota v poli |fffd|spora"
            Range(akt_list_codename + "_MZDA").Select
            Exit Sub
        End If
        
        
        If strVIN = "" Then
          MsgBox "Dopl|fffd| VIN vozidla"
          Range(akt_list_codename + "_VIN").Select      ' MRO
          Exit Sub
        End If
  End If
  
  If strUspora <> "" And IsNumeric(strUspora) = False Then
    MsgBox "|fffd||fffd|stka |fffd|spory neobsahuje |fffd||fffd|selnou hodnotu"
    Range(akt_list_codename + "_Uspora").Select             ' MRO
    Exit Sub
  End If
  
  
  If akt_list_codename = "ZASI" Then
     If strTypLim = "1" Then
       MsgBox "Vyber typ p|fffd|epravy pro v|fffd|po|fffd|et limitu"
       Exit Sub
     End If
  End If
  
  If (akt_list_codename = "ZDR2") And (strSolDan <> "") Then
    If (strRC = "") Then
      MsgBox "Vypl|fffd| rodn|fffd| |fffd||fffd|slo na v|fffd|po|fffd|tu dan|fffd|"
      Exit Sub
    End If
  End If
  
  If akt_list_codename <> "AUTO" And akt_list_codename <> "POVOL" And akt_list_codename <> "TOT" And akt_list_codename <> "SHAV" Then
        If (strSvodi = "???? Vyber druh zran|fffd|n|fffd| ????") Or (strSvodi = "????") Then
            Select Case akt_list_codename
                Case "ZDR1", "ZDR2", "ZDR3":  MsgBox "Vypl|fffd| druh zran|fffd|n|fffd|"
                            Exit Sub                                        ' MRO
                Case Else
                            MsgBox "Vypl|fffd| druh sledovan|fffd|ho v|fffd|po|fffd|tu"
                            Exit Sub
            End Select
        End If
        
        If (strSvodi <> "Ne") Then
            Select Case akt_list_codename
                Case "ZDR1", "ZDR2", "SKOL", "AZA", "SOU", "ZDR3", "THV", "ZASI", "ZTR", "CORN", "ZAJ", _
                        "V|fffd|kaz_v|fffd|m|fffd|r", "PENAL", "NEM_POR", "MOV_POR", "Auto_POR", "ADV", "VYJE", "UMRT":
                Case Else
                    If strUspora = "" Then
                        MsgBox "Vypl|fffd| |fffd||fffd|stku |fffd|spory"
                        Range(akt_list_codename + "_Uspora").Select         'MRO
                        Exit Sub
                    End If
                    If strSvodi <> "Ne" And strTym = "MON" Or strTym = "SKO" Then    ' MRO
                        If strMZDA = "" Then
                            MsgBox "Vypl|fffd| |fffd||fffd|stku |fffd|spory ze zji|fffd|t|fffd|n|fffd| mzdy"
                            Range(akt_list_codename + "_MZDA").Select
                            Exit Sub
                        End If
                        
                        If strMZDA <> "" And IsNumeric(strMZDA) = False Then          ' MRO
                            Range(akt_list_codename + "_MZDA").Select
                            MsgBox "|fffd||fffd|stka |fffd|spory ze mzdy neobsahuje |fffd||fffd|selnou hodnotu"
                            Exit Sub
                        End If
                        
                        If Val(strMZDA) > Val(strUspora) Then          ' MRO
                        MsgBox "|fffd||fffd|stka |fffd|spory ze mzdy nesm|fffd| b|fffd|t vy|fffd||fffd||fffd| ne|fffd| hodnota v poli |fffd|spora"
                        Range(akt_list_codename + "_MZDA").Select
                            Exit Sub
                        End If
                                                
                    End If
            End Select
        End If
  End If
  
  Select Case akt_list_codename
    Case "ZDR1", "ZDR2", "ZDR3", "SKOL"
        listy_upl = Array(akt_List)
        If IsNumeric(ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value) And ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value > 0 And _
            ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value <> ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_BOLNOZ").Value Then
            msg_dotaz = MsgBox("Nejsou p|fffd|enesena data z listu Bolestn|fffd| nebo |fffd||fffd|stky nejsou stejn|fffd|!" & vbLf & vbLf & _
                        "Pokra|fffd|ovat stisknut|fffd|m tla|fffd||fffd|tka:" & vbLf & vbLf & _
                        "    Ano = Pokra|fffd|ovat v akci" & vbLf & _
                        "      Ne = Ukon|fffd|it akci Tisk do TIA / DACP", vbYesNo + vbDefaultButton2 + vbQuestion)
            If msg_dotaz = vbNo Then
                ThisWorkbook.Sheets("Bolestn|fffd|").Activate
                Exit Sub
            End If
        ElseIf IsNumeric(ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value) And ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value > 0 And _
            ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value = ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_BOLNOZ").Value Then
            'Vloz_BOL_do_VYP_ODP
            ReDim Preserve listy_upl(0 To UBound(listy_upl) + 1)
            listy_upl(UBound(listy_upl)) = "Bolestn|fffd|"
        ElseIf IsNumeric(ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value) And ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value = 0 And _
            ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Castka_Celkem").Value <> ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_BOLNOZ").Value Then
            With ThisWorkbook.Sheets(akt_List)
                .Range(akt_list_codename + "_BOLNOZ").Select
                msg_dotaz = MsgBox("Na listu Bolestn|fffd| nejsou data ale pole Bolestn|fffd| |fffd||fffd|stka dle NOZ jsou vypln|fffd|na." & vbLf & vbLf & _
                                "Pokra|fffd|ovat stisknut|fffd|m tla|fffd||fffd|tka:" & vbLf & vbLf & _
                                "    Ano = Pokra|fffd|ovat v akci" & vbLf & _
                                "      Ne = Ukon|fffd|it akci Tisk do TIA / DACP", vbYesNo + vbDefaultButton2 + vbQuestion)
                If msg_dotaz = vbNo Then
                    Exit Sub
                Else
                    '.Range(akt_list_codename + "_BOLNOZ").Value = vbNullString
                    '.Range(akt_list_codename + "_BOLZVY").Value = vbNullString
                    '.Range(akt_list_codename + "_BOL_Nav_Dr").Value = vbNullString
                    '.Range(akt_list_codename + "_BOL_Nav_Lik").Value = vbNullString
                    '.Range(akt_list_codename + "_BOL_Nav_Cas").Value = vbNullString
                End If
            End With
        Else
        End If
        
        If IsNumeric(ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value) And ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value > 0 And _
            ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value <> ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_ZSUNOZ").Value Then
            MsgBox "Nejsou p|fffd|enesena data z listu ZSU nebo |fffd||fffd|stky nejsou stejn|fffd|!"
            ThisWorkbook.Sheets("ZSU").Activate
            Exit Sub
        ElseIf IsNumeric(ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value) And ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value > 0 And _
            ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value = ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_ZSUNOZ").Value Then
            'Vloz_ZSU_do_VYP_ODP
            ReDim Preserve listy_upl(0 To UBound(listy_upl) + 1)
            listy_upl(UBound(listy_upl)) = "ZSU"
        ElseIf IsNumeric(ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value) And ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value = 0 And _
            ThisWorkbook.Sheets("ZSU").Range("ZSU_Castka_Celkem").Value <> ThisWorkbook.Sheets(akt_List).Range(akt_list_codename + "_ZSUNOZ").Value Then
            With ThisWorkbook.Sheets(akt_List)
                .Range(akt_list_codename + "_ZSUNOZ").Select
                msg_dotaz = MsgBox("Na listu ZSU nejsou data ale pole ZSU |fffd||fffd|stka dle NOZ jsou vypln|fffd|na." & vbLf & vbLf & _
                                "Pokra|fffd|ovat stisknut|fffd|m tla|fffd||fffd|tka:" & vbLf & vbLf & _
                                "    Ano = Pokra|fffd|ovat v akci" & vbLf & _
                                "      Ne = Ukon|fffd|it akci Tisk do TIA / DACP", vbYesNo + vbDefaultButton2 + vbQuestion)
                If msg_dotaz = vbNo Then
                    Exit Sub
                Else
                    '.Range(akt_list_codename + "_ZSUNOZ").Value = vbNullString
                    '.Range(akt_list_codename + "_ZSUZVY").Value = vbNullString
                End If
            End With
        Else
        End If
        
        If akt_list_codename = "ZDR2" Then
            If IsNumeric(ThisWorkbook.Sheets("P|fffd|epo|fffd|et dan|fffd|").Range("DAN_PZN").Value) And ThisWorkbook.Sheets("P|fffd|epo|fffd|et dan|fffd|").Range("DAN_PZN").Value > 0 Then
                Vloz_Korekci_dane
                ReDim Preserve listy_upl(0 To UBound(listy_upl) + 1)
                listy_upl(UBound(listy_upl)) = "P|fffd|epo|fffd|et dan|fffd|"
            Else
                With ThisWorkbook.Sheets(akt_List)
                    .Range("ZDR2_SolDan").Value = vbNullString
                    .Range("K27").Value = vbNullString
                End With
            End If
        End If
    
    'listy_upl = Array(akt_list, "Bolestn|fffd|")
    'MsgBox listy_upl(UBound(listy_upl))
    
    Case "NEM", "NEK":                      listy_upl = Array(akt_List, "V|fffd|kaz v|fffd|m|fffd|r")
    Case "AUTO", "POVOL", "SHAV", "TOT":    listy_upl = Array(akt_List, "V|fffd|po|fffd|et THV", "Pneu TH")
    Case Else:                              listy_upl = Array(akt_List)   'v|fffd|choz|fffd|
  End Select
  
  ThisWorkbook.Sheets(Spojit_Pole(listy_upl, Aktualne_vybrane_listy)).Select
  
  If list_pom(0) <> "X" Then
        ThisWorkbook.Sheets(Spojit_Pole(Aktualne_vybrane_listy, list_pom)).Select
  Else
        ThisWorkbook.Sheets(Aktualne_vybrane_listy).Select
  End If
  
  UserName = UCase(CreateObject("WScript.Network").UserName)
  'Ulo|fffd|en|fffd| dat do CSV - z modulu Data_soubor_SSL
  If (LCase(Range(akt_list_codename + "_pripad")) <> "test") And UserName <> "ROSOKOL" Then
    Data_soubor_SSL
  End If
  
  'Zobraz informa|fffd|n|fffd| hl|fffd|en|fffd|
  rsoWaitForm.Show (False)
  rsoWaitForm.Repaint
  soubPDF = PrintPDF(Windows(1).SelectedSheets)
  If Len(strPripad) < 10 Then
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplNaPlochu)
      Else
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplRobotLPU)
    End If
  Else
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplNaPlochu)
    Else
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplGENOdeslatKDoindexaciLPU)
    End If
  End If

    'NUTN|fffd| - n|fffd|vrat na list, ze kter|fffd|ho byla akce spu|fffd|t|fffd|na
    ThisWorkbook.Worksheets(akt_List).Select

  'Po 4 sekund|fffd|ch skryj informa|fffd|n|fffd| hl|fffd|en|fffd|
  Application.Wait (Now + TimeValue("0:00:02"))
  rsoWaitForm.Hide


End Sub
Sub Upload_POR()
  ZjistiPUaPP
    
    Dim akt_List, akt_list_codename
   
    akt_List = ThisWorkbook.ActiveSheet.Name
    akt_list_codename = ThisWorkbook.ActiveSheet.CodeName
  
  If existuje_li_range_nazev(akt_list_codename + "_Castka_Celkem") = True Then
    If Range(akt_list_codename + "_Castka_Celkem").Value = 0 Then
      MsgBox "|fffd||fffd|stka celkem = 0 - nevypln|fffd|na |fffd||fffd|dn|fffd| polo|fffd|ka!"
      Exit Sub
    End If
  End If
  
  If strPripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo p|fffd||fffd|padu!"
    Exit Sub
  End If

  If strPodpripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo podp|fffd||fffd|padu!"
    Exit Sub
  End If
  
  If existuje_li_range_nazev(akt_list_codename + "_POJ") = True Then
    If Range(akt_list_codename + "_POJ").Value = "" Then
      MsgBox "Nevypln|fffd|no jm|fffd|no poji|fffd|t|fffd|n|fffd|ho!"
      Exit Sub
    End If
  End If
  
  If existuje_li_range_nazev(akt_list_codename + "_POS") = True Then
    If Range(akt_list_codename + "_POS").Value = "" Then
      MsgBox "Nevypln|fffd|n|fffd| po|fffd|kozen|fffd|!"
      Exit Sub
    End If
  End If

  If existuje_li_range_nazev(akt_list_codename + "_Dat_UZS") = True Then
    If Range(akt_list_codename + "_Dat_UZS").Value = "" Then
      MsgBox "Nevypln|fffd|no datum ust|fffd|len|fffd| zdravotn|fffd|ho stavu - 'Datum UZS'!"
      Exit Sub
    End If
  End If
  
  If strKDO <> "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s." And strKDO <> "Generali poji|fffd||fffd|ovna a.s." And strKDO <> "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s." Then
    MsgBox "Dopl|fffd| poji|fffd||fffd|ovnu, pro kterou je v|fffd|po|fffd|et prov|fffd|d|fffd|n"
    Exit Sub
  End If
  
  If akt_list_codename = "ZSU_NS" Then
    If Range(akt_list_codename + "_koef_celkem").Value = 0 Then
      MsgBox "Nejsou vypln|fffd|ny polo|fffd|ky!   'Obt|fffd|e  (K=kapacita; V=v|fffd|kon)'"
      ThisWorkbook.ActiveSheet.Range("H11").Offset(1, 0).Next.Select
      Exit Sub
    End If
    If Range(akt_list_codename + "_bunka_vek").Value = "" Then
      MsgBox "Nevypln|fffd|n|fffd| koeficient! - Sn|fffd|en|fffd| / zv|fffd||fffd|en|fffd| podle v|fffd|ku po|fffd|kozen|fffd|ho k datu PU'"
      Exit Sub
    End If
    If Range(akt_list_codename + "_bunka_aktivity").Value = "" Then
      MsgBox "Nevypln|fffd|n|fffd| koeficient! - 'Sn|fffd|en|fffd| / zv|fffd||fffd|en|fffd| podle zapojen|fffd| po|fffd|kozen|fffd|ho do spole|fffd|ensk|fffd|ch aktivit p|fffd|ed DN'"
      Exit Sub
    End If
  End If
  
  listy_upl = Array(akt_List)   'v|fffd|choz|fffd|
  list_pom = Najit_ListX     'zjistit, zda existuje list s n|fffd|zvem "ListX", kde X je |fffd||fffd|slo
  
  ThisWorkbook.Sheets(Spojit_Pole(listy_upl, Aktualne_vybrane_listy)).Select
  
  If list_pom(0) <> "X" Then
        ThisWorkbook.Sheets(Spojit_Pole(Aktualne_vybrane_listy, list_pom)).Select
  Else
        ThisWorkbook.Sheets(Aktualne_vybrane_listy).Select
  End If
  
  'Zobraz informa|fffd|n|fffd| hl|fffd|en|fffd|
  rsoWaitForm.Show (False)
  rsoWaitForm.Repaint
  soubPDF = PrintPDF(Windows(1).SelectedSheets)
  If Len(strPripad) < 10 Then
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplNaPlochu)
    Else
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplRobotLPU)
    End If
  Else
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplNaPlochu)
    Else
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplGENOdeslatKDoindexaciLPU)
    End If
  End If
    
  'Po 4 sekund|fffd|ch skryj informa|fffd|n|fffd| hl|fffd|en|fffd|
  Application.Wait (Now + TimeValue("0:00:04"))
  rsoWaitForm.Hide
End Sub
Sub Upload_ZSU()

  ZjistiPUaPP
  
    Dim akt_List
   
    akt_List = ThisWorkbook.ActiveSheet.Name
  
  If strPripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo p|fffd||fffd|padu!"
    Exit Sub
  End If

  If strPodpripad = "" Then
    MsgBox "Nevypln|fffd|no |fffd||fffd|slo podp|fffd||fffd|padu!"
    Exit Sub
  End If
  
  If strPOJ = "" Then
    MsgBox "Nevypln|fffd|no jm|fffd|no poji|fffd|t|fffd|n|fffd|ho!"
    Exit Sub
  End If
  
  If strKDO <> "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s." And strKDO <> "Generali poji|fffd||fffd|ovna a.s." And strKDO <> "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s." Then
    MsgBox "Dopl|fffd| poji|fffd||fffd|ovnu, pro kterou je v|fffd|po|fffd|et prov|fffd|d|fffd|n"
    Exit Sub
  End If
  
  Set fso = CreateObject("Scripting.FileSystemObject")
  UserName = UCase(CreateObject("WScript.Network").UserName)
  
  'Ulo|fffd|en|fffd| dat do CSV - z modulu Data_soubor_SSL
  If (LCase(Range(ActiveSheet.CodeName + "_pripad")) <> "test") And UserName <> "ROSOKOL" Then
  
    If XMLRead("<SystemInfo><DB>") <> "TIAPROD2" And XMLRead("<SystemInfo><DB>") <> "ICCZPROD" Then
        MsgBox "Data neulo|fffd|ena - testovac|fffd| prost|fffd|ed|fffd|: " & XMLRead("<SystemInfo><DB>")
    Else
        
        If ActiveSheet.CodeName = "UMRT" Then
            If strKDO = "Generali poji|fffd||fffd|ovna a.s." Then
                nODP = "Data V|fffd|po|fffd|et ODP umrti Gen.dat"
            Else
                nODP = "Data V|fffd|po|fffd|et ODP umrti.dat"
            End If
            Pole_Temp = Array("PU |fffd|.", jmList + "_Pripad", "PP |fffd|.", jmList + "_Podpripad", _
              "Poji|fffd|t|fffd|n|fffd|", jmList + "_Poj", _
              "Po|fffd|kozen|fffd|", jmList + "_Pos", _
              "P|fffd||fffd|jemce", jmList + "_PRIJ", _
              "Datum PU", jmList + "_Dat_PU", _
              "Spoluvina", jmList + "_Splv", _
              "V|fffd|k po|fffd|kozen|fffd|ho", jmList + "_Vek", _
              "Po|fffd|adovan|fffd| |fffd||fffd|stka", jmList + "_PozCast", _
              "Intenzita vztahu C", jmList + "_Inten_C", "Intenzita vztahu T", jmList + "_Inten_T", _
              "Vztah_C", jmList + "_Vztah_C", "Vztah_T", jmList + "_VZTAH_T", _
              "Z|fffd|va|fffd|nost zavin|fffd|n|fffd|_C", jmList + "_Zavin_C", "Z|fffd|va|fffd|nost zavin|fffd|n|fffd|_T", jmList + "_Zavin_T", _
              "Dopad do sf|fffd|ry", jmList + "_Dopad", _
              "V|fffd|ce osob_C", jmList + "_Bliz_C", "V|fffd|ce osob_T", jmList + "_Bliz_T", _
              "P|fffd||fffd|tomnost C", jmList + "_Pritom_C", "P|fffd||fffd|tomnost_T", jmList + "_Pritom_T", _
              "N|fffd|hrada", jmList + "_Nahr", _
              "Prod.rada", jmList + "_ProdRad", _
              "Datum likvidace", jmList + "_Dat_Vyp", "Likvid|fffd|tor", jmList + "_Likv", _
              "T|fffd|m", jmList + "_Tym", "K|fffd|d Likv.", jmList + "_LKod", _
              "Typ PP", jmList + "_TypPP")
        Else
              If strKDO = "Generali poji|fffd||fffd|ovna a.s." Then
                  nODP = "Data V|fffd|po|fffd|et ODP ZSU Gen.dat"
              Else
                  nODP = "Data V|fffd|po|fffd|et ODP ZSU.dat"
              End If
              Pole_Temp = Array("PU |fffd|.", jmList + "_Pripad", "PP |fffd|.", jmList + "_Podpripad", _
                "Poji|fffd|t|fffd|n|fffd|", jmList + "_Poj", _
                "Po|fffd|kozen|fffd|", jmList + "_Pos", _
                "Datum PU", jmList + "_Dat_PU", _
                "P|fffd||fffd|jemce", jmList + "_PRIJ", _
                "V|fffd|k po|fffd|kozen|fffd|ho", jmList + "_Vek", _
                "Po|fffd|adovan|fffd| |fffd||fffd|stka", jmList + "_PozCast", _
                "Zdravotn|fffd| omezen|fffd|", jmList + "_HZO", _
                "Pr|fffd|m|fffd|r omezen|fffd|", jmList + "_PO", _
                "Pr|fffd|m|fffd|r individuality", jmList + "_PI", _
                "Pr|fffd|m|fffd|r v|fffd|ku", jmList + "_PV", _
                "ZSU", jmList + "_ZSUV", _
                "Datum likvidace", jmList + "_Dat_Vyp", "Likvid|fffd|tor", jmList + "_Likv", _
                "T|fffd|m", jmList + "_Tym", "K|fffd|d Likv.", jmList + "_LKod", _
                "Typ PP", jmList + "_TypPP")
        End If
        
        SoubOut = nODP
        
        'Otev|fffd|i datov|fffd| soubor, pokud je pou|fffd||fffd|v|fffd|n, zkou|fffd|ej to po 2 sekund|fffd|ch
        On Error Resume Next
        p = 0
        Do
          err.Clear
          Set tso = fso.OpenTextFile(pth + SoubOut, cForAppending, True)
          If err.Number <> 0 Then Application.Wait (Now + TimeValue("0:00:02"))
          p = p + 1
        Loop Until err.Number = 0 Or p > 4
        On Error GoTo 0
        
        'Pokud nelze datov|fffd| soubor otev|fffd||fffd|t, konec
        If p > 4 Then Exit Sub
        
        'Pokud je|fffd|t|fffd| datov|fffd| soubor neexistuje, vlo|fffd| hlavi|fffd|ku
        If fso.GetFile(pth + SoubOut).Size = 0 Then
          Line = """U|fffd|ivatel"";""|fffd|as"";"
          For p = LBound(Pole_Temp) To UBound(Pole_Temp) Step 2
            Line = Line + """" + Pole_Temp(p) + """"
            If p < UBound(Pole_Temp) - 1 Then Line = Line + ";"
          Next p
          Line = Line + ";""Typ v|fffd|po|fffd|tu"""
          tso.WriteLine (Line)
        End If
        
        'Vlo|fffd| data z listu
        Hodnota_pole = ""
        Line = """" & UserName & """;""" & Now & """;"
        For p = LBound(Pole_Temp) + 1 To UBound(Pole_Temp) Step 2
          If existuje_li_range_nazev(Pole_Temp(p)) = True Then
            Hodnota_pole = Vy|fffd|istit(Range(Pole_Temp(p)).Cells(1, 1).Text)
          Else
            Hodnota_pole = vbNullString
          End If
          Line = Line + """" + Hodnota_pole + """"
          If p < UBound(Pole_Temp) - 1 Then Line = Line + ";"
        Next p
        Line = Line + ";""" + ActiveSheet.CodeName + """"
        tso.WriteLine (Line)
           
        'Uzav|fffd|i datov|fffd| soubor
        tso.Close
    End If

  End If
  
  listy_upl = Array(akt_List)   'v|fffd|choz|fffd|
  list_pom = Najit_ListX     'zjistit, zda existuje list s n|fffd|zvem "ListX", kde X je |fffd||fffd|slo
  
  ThisWorkbook.Sheets(Spojit_Pole(listy_upl, Aktualne_vybrane_listy)).Select
  
  If list_pom(0) <> "X" Then
        ThisWorkbook.Sheets(Spojit_Pole(Aktualne_vybrane_listy, list_pom)).Select
  Else
        ThisWorkbook.Sheets(Aktualne_vybrane_listy).Select
  End If
  
  'Zobraz informa|fffd|n|fffd| hl|fffd|en|fffd|
  rsoWaitForm.Show (False)
  rsoWaitForm.Repaint
  soubPDF = PrintPDF(Windows(1).SelectedSheets)
  If Len(strPripad) < 10 Then
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplNaPlochu)
      Else
        Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplRobotLPU)
    End If
  Else
    If strTym = "MON" Or strTym = "SKO" Then
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplNaPlochu)
    Else
        Call Upload(Val(strPripad), Val(strPodpripad), uplGEN_VYP, soubPDF, uplGENOdeslatKDoindexaciLPU)
    End If
  End If
    
  'Po 4 sekund|fffd|ch skryj informa|fffd|n|fffd| hl|fffd|en|fffd|
  Application.Wait (Now + TimeValue("0:00:04"))
  rsoWaitForm.Hide
End Sub
Private Sub ZjistiPUaPP()
  strPripad = "": strPodpripad = "": strSvodi = "1": strPojistne = "": strTypLim = "": strUspora = ""
  strBOL = "": strZSU = "": jmList = ActiveSheet.CodeName
  
  'Nastav prom|fffd|nn|fffd| podle pojmenovan|fffd|ch oblast|fffd| (pokud existuj|fffd|)
  On Error Resume Next
  strPripad = Range(ActiveSheet.CodeName & "_Pripad").Text
  strPodpripad = Range(ActiveSheet.CodeName & "_Podpripad").Text
  strPZN = Range(ActiveSheet.CodeName & "_PZN").Text
  strPOJ = Range(ActiveSheet.CodeName & "_POJ").Text
  strLargeCell1 = Range(ActiveSheet.CodeName & "_LargeCell1").Text
  strPLN = Range(ActiveSheet.CodeName & "_PLN").Text
  strSPLU = Range(ActiveSheet.CodeName & "_SPLU").Text
  strSvodi = Range(ActiveSheet.CodeName & "_Svodidlo").Text
  strPojistne = Range(ActiveSheet.CodeName & "_PojPlac").Text
  strKomu = Range(ActiveSheet.CodeName & "_ZasPl").Text
  strNahrSK = Range(ActiveSheet.CodeName & "_NahrSK").Text
  strLimitPoj = Range(ActiveSheet.CodeName & "_LimitPoj").Text
  strTym = Range(ActiveSheet.CodeName & "_Tym").Text
  strTypLim = Range(ActiveSheet.CodeName & "_TypLim").Text
  strUspora = Range(ActiveSheet.CodeName & "_Uspora").Text
  strMZDA = Range(ActiveSheet.CodeName & "_MZDA").Text       ' MRO
  strProdRad = Range(ActiveSheet.CodeName & "_ProdRad").Text       ' MRO
  strOC = Range(ActiveSheet.CodeName & "_OC").Text
  strVOC = Range(ActiveSheet.CodeName & "_VOC").Text
  strVIN = Range(ActiveSheet.CodeName & "_VIN").Text
  strBOL = Range(ActiveSheet.CodeName & "_BOL").Text
  strZSU = Range(ActiveSheet.CodeName & "_ZSU").Text
  strKDO = Range(ActiveSheet.CodeName & "_KDO").Text
  strBolZvy = Range(ActiveSheet.CodeName & "_BolZvy").Text
  strZSUZvy = Range(ActiveSheet.CodeName & "_ZSUZvy").Text
  strSledPol = Range(ActiveSheet.CodeName & "_Sled_Kod_BOL").Text
  strBol_Nav_Dr = Range(ActiveSheet.CodeName & "_Bol_Nav_Dr").Text
  strBol_Nav_Lik = Range(ActiveSheet.CodeName & "_Bol_Nav_Lik").Text
  strBol_Nav_Cas = Range(ActiveSheet.CodeName & "_Bol_Nav_Cas").Text
  strBol_Preda = Range(ActiveSheet.CodeName & "_Preda").Text
  strTym = Trim(Left(strTym, 3))
  str_Verze = Range("Verze_VYP").Text
  strRC = Range("DAN_RC").Text
  strSolDan = Range("ZDR2_SolDan").Text
  strDanSolDan = Range("DAN_SolDan").Text
  On Error GoTo 0
End Sub
Public Sub Data_soubor_SSL()

  Dim SoubOutPCNB As String
  Dim SoubOutTOT As String
  
  If XMLRead("<SystemInfo><DB>") <> "TIAPROD2" And XMLRead("<SystemInfo><DB>") <> "ICCZPROD" Then
    MsgBox "Data neulo|fffd|ena - testovac|fffd| prost|fffd|ed|fffd|: " & XMLRead("<SystemInfo><DB>")
    Exit Sub
  End If
  
  'MsgBox jmList
  
  'Nen|fffd|-li vybr|fffd|n jeden z 19 ur|fffd|en|fffd|ch list|fffd|, tak konec
  '- > p|fffd|epracov|fffd|no na Select Case (M.Stan|fffd|k m|fffd|l IF) a zm|fffd|n|fffd|no um|fffd|st|fffd|n|fffd| (M.Stan|fffd|k m|fffd|l um|fffd|st|fffd|no a|fffd| za Array pole)
  Select Case jmList
    Case "ZDR1", "ZDR2", "ZDR3", "VEC1", "VEC2", "NEM", "NEK", "POVOL", "ZAJ", "OBEC", "Dop", "AUTO", "SOU", "ZASI", "JED", "AZA", "TOT", "SHAV", "SKOL":
    Case Else: Exit Sub
  End Select
  
  pole = Array("PU |fffd|.", jmList + "_Pripad", "PP |fffd|.", jmList + "_Podpripad", _
    "Poji|fffd|t|fffd|n|fffd|", jmList + "_Poj", _
    "Po|fffd|kozen|fffd|", jmList + "_Pos", _
    "Datum PU", jmList + "_Dat_PU", _
    "D|fffd|j", jmList + "_LargeCell1", _
    "Pojistn|fffd| smlouva", jmList + "_Sml", _
    "Pr|fffd|vn|fffd| z|fffd|klad n|fffd|roku", jmList + "_PZN", _
    "Postih zd|fffd|vodn|fffd|n|fffd|", jmList + "_Post", _
    "Spoluvina", jmList + "_Splv", "Spolu|fffd||fffd|ast", jmList + "_Splu", _
    "Postih (K|fffd|)", jmList + "_PosKc", "Pln|fffd|n|fffd| celkem", jmList + "_Pln", _
    "Datum likvidace", jmList + "_Dat_Vyp", "Likvid|fffd|tor", jmList + "_Likv", _
    "T|fffd|m", jmList + "_Tym", "K|fffd|d Likv.", jmList + "_LKod", _
    "Typ PP", jmList + "_TypPP", "Svodidlo", jmList + "_Svodidlo", _
    "Uspora_sv", jmList + "_Uspora", _
    "V|fffd|d|fffd|lek", jmList + "_Vydelek", "Bol OZ", jmList + "_BOLOZ", "Bol NOZ", jmList + "_BOLNOZ", _
    "ZSU OZ", jmList + "_ZSUOZ", "ZSU NOZ", jmList + "_ZSUNOZ", "Placen|fffd|", jmList + "_PojPlac", _
    "Komu", jmList + "_ZasPl", _
    "Produkt", jmList + "_Produkt")
  
  Set fso = CreateObject("Scripting.FileSystemObject")
  UserName = UCase(CreateObject("WScript.Network").UserName)
    
  'Nastav prom|fffd|nn|fffd| - n|fffd|zev datov|fffd|ho souboru a jm|fffd|na pojmenovan|fffd|ch bun|fffd|k
  If strKDO = "Generali poji|fffd||fffd|ovna a.s." Then
      SoubOut = "Data V|fffd|po|fffd|et ODP Gen.dat"
      SoubOutPCNB = "Data V|fffd|po|fffd|et ODP PCNB Gen.dat"
      SoubOutTOT = "Data V|fffd|po|fffd|et ODP TOT Gen.dat"
  Else
      SoubOut = "Data V|fffd|po|fffd|et ODP.dat"
      SoubOutPCNB = "Data V|fffd|po|fffd|et ODP PCNB.dat"
      SoubOutTOT = "Data V|fffd|po|fffd|et ODP TOT.dat"
  End If
  
  'Otev|fffd|i datov|fffd| soubor, pokud je pou|fffd||fffd|v|fffd|n, zkou|fffd|ej to po 2 sekund|fffd|ch
  On Error Resume Next
  p = 0
  Do
    err.Clear
    Set tso = fso.OpenTextFile(pth + SoubOut, cForAppending, True)
    If err.Number <> 0 Then Application.Wait (Now + TimeValue("0:00:02"))
    p = p + 1
  Loop Until err.Number = 0 Or p > 4
  On Error GoTo 0
  
  'Pokud nelze datov|fffd| soubor otev|fffd||fffd|t, konec
  If p > 4 Then Exit Sub
  
  'Pokud je|fffd|t|fffd| datov|fffd| soubor neexistuje, vlo|fffd| hlavi|fffd|ku
  If fso.GetFile(pth + SoubOut).Size = 0 Then
    Line = """U|fffd|ivatel"";""|fffd|as"";"
    For p = LBound(pole) To UBound(pole) Step 2
      Line = Line + """" + pole(p) + """"
      If p < UBound(pole) - 1 Then Line = Line + ";"
    Next p
    Line = Line + ";""Typ v|fffd|po|fffd|tu"""
    Line = Line + ";""VIN"""
    Line = Line + ";""Poji|fffd||fffd|ovna"""
    Line = Line + ";""Zv|fffd||fffd|en|fffd| BOL NOZ"""
    Line = Line + ";""Zv|fffd||fffd|en|fffd| ZSU NOZ"""
    Line = Line + ";""Sled_Pol"""
    Line = Line + ";""Bol_Nav_Dr"""
    Line = Line + ";""Bol_Nav_Lik"""
    Line = Line + ";""Bol_Nav_Cas"""
    Line = Line + ";""Predani_na_RES"""
    Line = Line + ";""Verze"""
    Line = Line + ";""|fffd|spora MZ"""  ' MRO
    Line = Line + ";""LP"""  ' MRO
    tso.WriteLine (Line)
  End If
  
  'Vlo|fffd| data z listu
  Hodnota_pole = ""
  Line = """" & UserName & """;""" & Now & """;"
  For p = LBound(pole) + 1 To UBound(pole) Step 2
    If existuje_li_range_nazev(pole(p)) = True Then
        Hodnota_pole = Vy|fffd|istit(Range(pole(p)).Cells(1, 1).Text)
    Else
        Hodnota_pole = vbNullString
    End If
    Line = Line + """" + Hodnota_pole + """"
    If p < UBound(pole) - 1 Then Line = Line + ";"
  Next p
  Line = Line + ";""" + ActiveSheet.CodeName + """"
  Line = Line + ";""" + strVIN + """"
  Line = Line + ";""" + strKDO + """"
  Line = Line + ";""" + strBolZvy + """"
  Line = Line + ";""" + strZSUZvy + """"
  Line = Line + ";""" + strSledPol + """"
  Line = Line + ";""" + strBol_Nav_Dr + """"
  Line = Line + ";""" + strBol_Nav_Lik + """"
  Line = Line + ";""" + strBol_Nav_Cas + """"
  Line = Line + ";""" + strBol_Preda + """"
  Line = Line + ";""" + str_Verze + """"
  Line = Line + ";""" + strMZDA + """"    'MRO
  Line = Line + ";""" + strProdRad + """"    'MRO
  tso.WriteLine (Line)
     
  'Uzav|fffd|i datov|fffd| soubor
  tso.Close
  
  If Range(ActiveSheet.CodeName & "_Svodidlo").Text Like "V|fffd|po|fffd|etn|fffd| technika*" Then
  
         'Otev|fffd|i datov|fffd| soubor PCNB, pokud je pou|fffd||fffd|v|fffd|n, zkou|fffd|ej to po 2 sekund|fffd|ch
        On Error Resume Next
        p = 0
        Do
          err.Clear
          Set tso = fso.OpenTextFile(pth + SoubOutPCNB, cForAppending, True)
          If err.Number <> 0 Then Application.Wait (Now + TimeValue("0:00:02"))
          p = p + 1
        Loop Until err.Number = 0 Or p > 4
        On Error GoTo 0
        
        'Pokud nelze datov|fffd| soubor PCNM otev|fffd||fffd|t, konec
        If p > 4 Then Exit Sub
        
        'Pokud je|fffd|t|fffd| datov|fffd| soubor PCNB neexistuje, vlo|fffd| hlavi|fffd|ku
        If fso.GetFile(pth + SoubOutPCNB).Size = 0 Then
          Line = """U|fffd|ivatel"";""|fffd|as"""
          Line = Line + ";""P|fffd||fffd|pad"""
          Line = Line + ";""LP"""
          Line = Line + ";""PCNB"""
          Line = Line + ";""ID"""
          Line = Line + ";""LS"""
          Line = Line + ";""Likvid|fffd|tor"""
          Line = Line + ";""Podpripad"""
          Line = Line + ";""|fffd|spora"""
          tso.WriteLine (Line)
        End If
        
        'Vlo|fffd| data PCNB z listu
        Line = """" & UserName & """;""" & Now & """;"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Pripad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_ProdRad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = "1"
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_LKod").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Tym").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Likv").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_PodPripad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Uspora").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        tso.WriteLine (Line)
        
         'Uzav|fffd|i datov|fffd| soubor PCNB
        tso.Close
  End If
  
  If ActiveSheet.CodeName = "TOT" Then   'Otev|fffd|i datov|fffd| soubor TOT, pokud je pou|fffd||fffd|v|fffd|n, zkou|fffd|ej to po 2 sekund|fffd|ch
        On Error Resume Next
        p = 0
        Do
          err.Clear
          Set tso = fso.OpenTextFile(pth + SoubOutTOT, cForAppending, True)
          If err.Number <> 0 Then Application.Wait (Now + TimeValue("0:00:02"))
          p = p + 1
        Loop Until err.Number = 0 Or p > 4
        On Error GoTo 0
        
        'Pokud nelze datov|fffd| soubor TOT otev|fffd||fffd|t, konec
        If p > 4 Then Exit Sub
         
        'Pokud je|fffd|t|fffd| datov|fffd| soubor PCNB neexistuje, vlo|fffd| hlavi|fffd|ku
        If fso.GetFile(pth + SoubOutTOT).Size = 0 Then
          Line = """U|fffd|ivatel"";""|fffd|as"""
          Line = Line + ";""P|fffd||fffd|pad"""
          Line = Line + ";""LP"""
          Line = Line + ";""TOT"""
          Line = Line + ";""ID"""
          Line = Line + ";""LS"""
          Line = Line + ";""Likvid|fffd|tor"""
          Line = Line + ";""Podpripad"""
          Line = Line + ";""Pr|fffd|m. cena"""
          Line = Line + ";""Vyj|fffd|d|fffd|en|fffd|"""
          Line = Line + ";""Zbytky"""
          Line = Line + ";""Obecn|fffd| cena"""
          Line = Line + ";""Spolu|fffd||fffd|ast"""
          Line = Line + ";""Pln|fffd|n|fffd|"""
          Line = Line + ";""VIN"""
          tso.WriteLine (Line)
        End If
        'Vlo|fffd| data TOT z listu
        
        Line = """" & UserName & """;""" & Now & """;"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Pripad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_ProdRad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = "1"
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_LKod").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Tym").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_Likv").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_PodPripad").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_PrCena").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_VOC").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_ZB").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_OC").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_SPLU").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_PLN").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        Hodnota_pole = Vy|fffd|istit(Range(ActiveSheet.CodeName & "_VIN").Cells(1, 1).Text)
        Line = Line + """" & Hodnota_pole & """" + ";"
        tso.WriteLine (Line)
         
        'Uzav|fffd|i datov|fffd| soubor TOT
        tso.Close
  End If
End Sub
Sub Ulozeni_pdf()
Dim oblast_pdf As Range
Dim aPU As String
Dim vPoji As String
Dim jmList As String
Dim volba As Integer
Dim cilova_slozka

    If Dir("H:\Desktop", vbDirectory) <> "" Then cilova_slozka = "H:\Desktop" Else cilova_slozka = "H:\Moje plocha"

    strPripad = Range(ActiveSheet.CodeName & "_Pripad").Text
    strPodpripad = Range(ActiveSheet.CodeName & "_Podpripad").Text
    volba = MsgBox("Chcete ulo|fffd|it soubor i do DACP ?", vbYesNoCancel + vbDefaultButton3 + vbQuestion)
    If volba = vbCancel Then Exit Sub
    
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    jmList = ActiveSheet.CodeName
    aPU = Range(jmList + "_Pripad")
    
    Select Case jmList
        Case "ZDR1"  'Zdrav|fffd| obecn|fffd|
          Rows("9:29").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:N45")
        Case "ZDR2"  'Zdrav|fffd| da|fffd|
          Rows("8:25").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:N42")
        Case "ZDR3"  'Zdrav|fffd| obecn|fffd|
          Rows("9:28").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:O47")
        Case "VEC1"  '|fffd|koda na v|fffd|ci I
          Rows("9:31").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:S48")
        Case "VEC2"  '|fffd|koda na v|fffd|ci II
          Rows("9:31").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:R78")
        Case "NEM"  '|fffd|koda na nemovitosti
          Rows("9:30").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:S190")
        Case "NEK"  '|fffd|koda na nemovitosti i movitosti
          Rows("9:27").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:Q219")
        Case "OBEC"  'Obecn|fffd|
          Rows("9:39").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:Q62")
        Case "Dop"  'Dopravci obecn|fffd|
          Rows("9:41").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:Q62")
        Case "AUTO" '|fffd|koda na vozidle
          Rows("11:31").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:M63")
        Case "POVOL" 'Vozidlo z v|fffd|konu povol|fffd|n|fffd|
          Rows("11:24").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:M56")
        Case "SOU" 'Soupoji|fffd|t|fffd|n|fffd|
          Set oblast_pdf = Range("A1:G18")
        Case "ZAJ" 'Z|fffd|jezd
          Rows("12:24").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:P39")
        Case "ZASI" 'Z|fffd|silky
          Rows("9:36").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:Q62")
        Case "JED" 'Jednoduch|fffd| |fffd|kody
          Rows("9:29").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:R50")
        Case "AZA" 'Aktivn|fffd| zaji|fffd|t|fffd|n|fffd|
          Set oblast_pdf = Range("A1:G18")
        Case "TOT" 'Tot|fffd|lka na aut|fffd|
          Rows("11:31").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:M55")
        Case "SHAV" 'Spolu|fffd||fffd|ast HAV
          Rows("11:31").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:M65")
        Case "SKOL" '|fffd|koln|fffd| |fffd|raz
          Rows("9:28").EntireRow.Hidden = True
          Set oblast_pdf = Range("A1:N43")
        Case "ZSU_NS" 'ZSU dle NS
          Set oblast_pdf = Range("A:R")
      End Select
      
    listy_upl = Array(ThisWorkbook.ActiveSheet.Name)   'v|fffd|choz|fffd|
    list_pom = Najit_ListX     'zjistit, zda existuje list s n|fffd|zvem "ListX", kde X je |fffd||fffd|slo
    
    ThisWorkbook.Sheets(Spojit_Pole(listy_upl, Aktualne_vybrane_listy)).Select
    
    If list_pom(0) <> "X" Then
          ThisWorkbook.Sheets(Spojit_Pole(Aktualne_vybrane_listy, list_pom)).Select
    Else
          ThisWorkbook.Sheets(Aktualne_vybrane_listy).Select
    End If
    
    soubPDF = PrintPDF(Windows(1).SelectedSheets)
    Call oblast_pdf.ExportAsFixedFormat(0, cilova_slozka & "\Vypocet_ODP_PU_" & aPU & ".pdf", 0, True, False)
    If volba = vbYes Then
       If Left(strPripad, 4) = "3000" Or Left(strPripad, 4) = "7000" Then
          Call Upload(strPripad, strPodpripad, uplGEN_VYP, soubPDF, uplNaPlochu)
       Else
          Call Upload(strPripad, strPodpripad, uplVYP, soubPDF, uplNaPlochu)
       End If
    End If
    
    Select Case jmList
        Case "ZDR1"  'Zdrav|fffd| obecn|fffd|
          Rows("9:29").EntireRow.Hidden = False
        Case "ZDR2"  'Zdrav|fffd| da|fffd|
          Rows("8:25").EntireRow.Hidden = False
        Case "ZDR3"  'Zdrav|fffd| obecn|fffd|
          Rows("9:28").EntireRow.Hidden = False
        Case "VEC1"  '|fffd|koda na v|fffd|ci I
          Rows("9:31").EntireRow.Hidden = False
        Case "VEC2"  '|fffd|koda na v|fffd|ci II
          Rows("9:31").EntireRow.Hidden = False
        Case "NEM"  '|fffd|koda na nemovitosti
          Rows("9:30").EntireRow.Hidden = False
        Case "NEK"  '|fffd|koda na nemovitosti i movitosti
          Rows("9:27").EntireRow.Hidden = False
        Case "OBEC"  'Obecn|fffd|
          Rows("9:39").EntireRow.Hidden = False
        Case "Dop"  'Dopravci obecn|fffd|
          Rows("9:41").EntireRow.Hidden = False
        Case "AUTO" '|fffd|koda na vozidle
          Rows("11:31").EntireRow.Hidden = False
        Case "POVOL" 'Vozidlo z v|fffd|konu povol|fffd|n|fffd|
          Rows("11:26").EntireRow.Hidden = False
        Case "SOU" 'Soupoji|fffd|t|fffd|n|fffd|
        Case "ZAJ" 'Z|fffd|jezd
          Rows("12:24").EntireRow.Hidden = False
        Case "ZASI" 'Z|fffd|silky
          Rows("9:36").EntireRow.Hidden = False
        Case "JED" 'Jednoduch|fffd| |fffd|kody
          Rows("18:19").EntireRow.Hidden = False
        Case "AZA" 'Aktivn|fffd| zaji|fffd|t|fffd|n|fffd|
        Case "TOT" 'Tot|fffd|lka na aut|fffd|
          Rows("11:31").EntireRow.Hidden = False
        Case "SHAV" 'Spolu|fffd||fffd|ast HAV
          Rows("11:31").EntireRow.Hidden = False
        Case "SKOL" '|fffd|koln|fffd| |fffd|raz
          Rows("9:28").EntireRow.Hidden = False
      End Select
      Range(jmList + "_Pripad").Select
      ThisWorkbook.ActiveSheet.Protect ("0309")
      'ThisWorkbook.Protect ("0309")
      MsgBox "V|fffd|stupn|fffd| soubor PDF byl vytvo|fffd|en." & vbLf & vbLf & _
      "    N|fffd|zev slo|fffd|ky: " & cilova_slozka & vbLf & _
      "N|fffd|zev souboru: Vypocet_ODP_PU_" & aPU & "_Poj_" & vPoji & ".pdf" & vbLf & vbLf & _
      "Po stisknut|fffd| tla|fffd||fffd|tka bude zobrazen obsah slo|fffd|ky ze souborem.", vbInformation + vbOKOnly, "AKCE BYLA DOKON|fffd|ENA"
      On Error Resume Next
      AppActivate (cilova_slozka)
      If err.Number <> 0 Then Call Shell("explorer.exe " & cilova_slozka, 1)  'vbHide=0, vbNormalFocus=1, vbMinimizedFocus=2, vbMaximizedFocus=3, vbNormalNoFocus=4, vbMinimizedNoFocus=6
      On Error GoTo 0
      DoEvents
End Sub
Attribute VB_Name = "DAN"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim chyba As Long, target_pom As String, text_pom As String
    chyba = 0: target_pom = vbNullString: text_pom = vbNullString
    
    With ThisWorkbook.Sheets("P|fffd|epo|fffd|et dan|fffd|")
        On Error Resume Next
        target_pom = Target(1).Name.Name
        If err.Number <> 0 Then chyba = err.Number
        On Error GoTo 0
        
        If chyba = 0 Then
            Application.EnableEvents = False
            If target_pom = "DAN_RC" Then
                If Target(1).NumberFormat <> "@" Then Target(1).NumberFormat = "@"
                text_pom = Target(1)
                text_pom = Trim(Replace(text_pom, "/", vbNullString))
                text_pom = Trim(Replace(text_pom, "!", vbNullString))
                Target(1).Value = text_pom

                If text_pom <> vbNullString Then
                    If validace_RC(text_pom) = vbNullString Then
                        If text_pom <> vbNullString Then
                            Target(1).Value = text_pom & " !!!"
                            Target(1).Select
                        End If
                    End If
                End If
            End If
            Application.EnableEvents = True
        End If
    End With
End Sub


Attribute VB_Name = "DPH"
Sub Overeni_DPH()
Attribute Overeni_DPH.VB_Description = "Makro zaznamenan|fffd| 4.10.2006, jvincenc"
Attribute Overeni_DPH.VB_ProcData.VB_Invoke_Func = " \n14"
If Worksheets("Datov|fffd| list").Range("A10") = 1 And Worksheets("Datov|fffd| list").Range("A198") = 2 Then
    MsgBox "Nelze vybrat 'Z|fffd|po|fffd|et DPH', pokud je vybr|fffd|no 'Hrazeno s DPH'" & vbCrLf & "Bude nastaveno 'Asistence nebyla poskytnuta'"
    Worksheets("Datov|fffd| list").Range("A198") = 1
  End If
End Sub


Attribute VB_Name = "Dop"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "JED"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "LIMIT_SRD"
Attribute VB_Base = "0{12D9D7E2-2DFC-43B2-A408-8E1EB99917FD}{DEAA8AE1-6682-4BDE-971C-78554728F661}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Initialize()

TextBox1.Value = Format(Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("Hruba_ztr"), "# ###")
TextBox3.Value = ""

    If Worksheets("Datov|fffd| list").Range("C90") = "" Then
     OptionButton2.Enabled = False
     Else: OptionButton2.Enabled = True
    End If

    If Worksheets("Datov|fffd| list").Range("C91") = "" Then
     OptionButton3.Enabled = False
     Else: OptionButton3.Enabled = True
    End If
    
    If Worksheets("Datov|fffd| list").Range("C92") = "" Then
     OptionButton4.Enabled = False
     Else: OptionButton4.Enabled = True
      OptionButton4.Caption = "  od " & Worksheets("Datov|fffd| list").Range("D92")
    End If
    
    If Worksheets("Datov|fffd| list").Range("C93") = "" Then
     OptionButton5.Enabled = False
     Else: OptionButton5.Enabled = True
      OptionButton5.Caption = "  od " & Worksheets("Datov|fffd| list").Range("D93")
    End If

End Sub

Private Sub CommandButton1_Click()
LIMIT_SRD.Hide
 If LIMIT_SRD.OptionButton1.Value = False And LIMIT_SRD.OptionButton2.Value = False And LIMIT_SRD.OptionButton3.Value = False And LIMIT_SRD.OptionButton4.Value = False And LIMIT_SRD.OptionButton5.Value = False Then
   LIMIT_SRD.Frame1.BackColor = &H8080FF
   MsgBox "Nen|fffd| zad|fffd|no obdob|fffd|, za kter|fffd| n|fffd|le|fffd||fffd| platba", 48, "CH Y B A"
   LIMIT_SRD.Show
 End If

Unload LIMIT_SRD
End Sub

Private Sub OptionButton1_Click()
    
    Frame1.BackColor = &HE0E0E0
    If LIMIT_SRD.OptionButton1.Value = True Then
        Worksheets("Datov|fffd| list").Range("SRD_ZO") = 0
        Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic") = 40
        TextBox2 = "BEZ SR|fffd||fffd|. DAN|fffd|"
        TextBox3 = Format("DA|fffd| " & Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("L45"), ">")
    End If

End Sub

Private Sub OptionButton2_Click()
    
    Frame1.BackColor = &HE0E0E0
    If LIMIT_SRD.OptionButton2.Value = True Then
        Worksheets("Datov|fffd| list").Range("SRD_ZO") = 1
        Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic") = 50
        TextBox2 = Format(Worksheets("Datov|fffd| list").Range("SRD_H"), "# ###")
        TextBox3 = Format("DA|fffd| " & Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("L45"), ">")
    End If

End Sub
 
Private Sub OptionButton3_Click()
    
    Frame1.BackColor = &HE0E0E0
    If LIMIT_SRD.OptionButton3.Value = True Then
        Worksheets("Datov|fffd| list").Range("SRD_ZO") = 2
        Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic") = 50
        TextBox2 = Format(Worksheets("Datov|fffd| list").Range("SRD_H"), "# ###")
        TextBox3 = Format("DA|fffd| " & Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("L45"), ">")
    End If

End Sub

Private Sub OptionButton4_Click()
    
    Frame1.BackColor = &HE0E0E0
    If LIMIT_SRD.OptionButton4.Value = True Then
        Worksheets("Datov|fffd| list").Range("SRD_ZO") = 3
        Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic") = 50
        TextBox2 = Format(Worksheets("Datov|fffd| list").Range("SRD_H"), "# ###")
        TextBox3 = Format("DA|fffd| " & Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("L45"), ">")
    End If

End Sub

Private Sub OptionButton5_Click()
    
    Frame1.BackColor = &HE0E0E0
    If LIMIT_SRD.OptionButton5.Value = True Then
        Worksheets("Datov|fffd| list").Range("SRD_ZO") = 4
        Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic") = 50
        TextBox2 = Format(Worksheets("Datov|fffd| list").Range("SRD_H"), "# ###")
        TextBox3 = Format("DA|fffd| " & Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("L45"), ">")
    End If

End Sub

Private Sub CommandButton1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)
CommandButton1.BackColor = &HC0FFC0
End Sub

Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)
CommandButton1.BackColor = &H8000000F
End Sub

'Private Sub Label3_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)
'MsgBox "Hezk|fffd| den", 64, ""
'End Sub








Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Attribute VB_Name = "Mov_POR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "NEK"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim ZakladnaN

Private Sub Worksheet_Change(ByVal Target As Range)
Dim target_nova_hodnota, wb As Workbook, wb_nazev, wb_posledni_radek, wb_oblast, wb_nenalezeno, _
polozka_nadpis, C, n, _
target_row, max_row, pocet_polozek, nalezeno_radku, nedostatek_radku
    
With ThisWorkbook.Worksheets("Nemovitosti komb")
    If Target.Row < 61 Or Target.Row > 210 Then Exit Sub
    
    If Not (Intersect(Target, .Range("KodyEC_NEK")) Is Nothing) Then
                
        If Target(1).Value = "" Then GoTo radek_wb_change_konec
        
        Application.EnableEvents = False
        target_nova_hodnota = Target.Value          'pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
        Application.Undo
        Target.Value = Trim(target_nova_hodnota)    'odstran|fffd|n|fffd| p|fffd|ebyte|fffd|n|fffd|ch mezer
        Application.EnableEvents = True
        
        If Not IsNumeric(Left(Target(1).Value, 1)) Then
            wb_nenalezeno = 1
            GoTo radek_wb_change_konec
        End If
                      
        Application.ScreenUpdating = False
        max_row = .Range("KodyEC_NEK").Rows.Count
        pocet_polozek = max_row - WorksheetFunction.CountIf(.Range("KodyEC_NEK"), "*") + 1
        nedostatek_radku = 0
        wb_nenalezeno = 0
        ZakladnaN = "": wb_nazev = ""
        
        'definice v modulu Vyber_Listu viz Public Const NEM_cenik_polozek_cesta
        'PthD = "d:\Data\JS\TIA\_vypocet_plneni_ODP\maj_ciselniky\"
        PthD = NEM_cenik_polozek_cesta
        
        ZakladnaN = Left(.Range("NEK_Cenik").Text, 1) & Right(.Range("NEK_Cenik").Text, 4)
        wb_nazev = Dir(PthD & "Polo|fffd|ky" & ZakladnaN & ".xls*")
        
        'z|fffd|stal-li n|fffd|hodou z p|fffd|ech|fffd|zej|fffd|c|fffd|ho zpracov|fffd|n|fffd| soubor otev|fffd|en|fffd|, tak zav|fffd||fffd|t soubor
        If sesit_je_otevren(wb_nazev) = True Then wb.Close (False)
            
        On Error Resume Next
        Set wb = Workbooks.Open(PthD & wb_nazev, , True)
        If err.Number <> 0 Then
            MsgBox "Soubor s polo|fffd|kami cen|fffd|ku je nedostupn|fffd|." & vbLf & vbLf & _
                "Cesta k souboru: " & PthD & vbLf & _
                "N|fffd|zev souboru: " & wb_nazev & vbLf & vbLf & _
                "Bu|fffd| soubor neexistuje nebo bude probl|fffd|m se s|fffd|ov|fffd|mi disky. Kontaktujte helpdesk.", vbCritical + vbOKOnly, "NELZE NA|fffd||fffd|ST POLO|fffd|KY CEN|fffd|KU"
            Target.Select
            GoTo radek_wb_change_konec
        End If
        On Error GoTo 0
                
        .Activate

        nalezeno_radku = 0
          
        If Val(Right(ZakladnaN, 4)) >= 2015 Then
            If Target.Offset(0, 0) = "" Then GoTo radek_wb_change_konec
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "A").End(xlUp).Row
            wb_oblast = "A4:A" & wb_posledni_radek
            
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                nalezeno_radku = WorksheetFunction.CountIf(wb.Worksheets(1).Range(wb_oblast), Target.Value & "*")
                    
                If nalezeno_radku > pocet_polozek Then
                    nedostatek_radku = 1
                    GoTo radek_wb_change_konec
                End If
                    
                Application.EnableEvents = False
                For n = 0 To (nalezeno_radku - 1)
                    target_row = Target.Offset(n, 0).Row
                    Target.Offset(n, -3) = Target.Offset(n, -3).Row - 30    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                        
                    If .Rows(target_row & ":" & target_row).Hidden = True Then
                        Pridej_NEK_NEM_radek
                    End If
                        
                    With Target.Offset(n, -2)                           'polo|fffd|ka - n|fffd|zev
                        .Value = C.Offset(n, 2).Value
                        If Mid(.Value, 2, 1) = UCase(Mid(.Value, 2, 1)) Then polozka_nadpis = 1 Else polozka_nadpis = 0
                    End With
                       
                    If polozka_nadpis = 0 Then
                        Target.Offset(n, 1) = C.Offset(n, 3).Value      'polo|fffd|ka - MJ
                        If C.Offset(n, 5).Value > 0 Then
                            'Target.Offset(n, 2) = 1                     'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = C.Offset(n, 5).Value  'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = "1"                   'polo|fffd|ka - DPH
                        Else
                            Target.Offset(n, 2) = ""                    'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = ""                    'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = ""                    'polo|fffd|ka - DPH
                        End If
                    Else
                        Target.Offset(n, 4) = ""                        'polo|fffd|ka - DPH
                    End If
                        
                    .Unprotect ("0309")
                    With Target.Offset(n, 0)                            'polo|fffd|ka - k|fffd|d
                        .Value = C.Offset(n, 1).Value
                        .Font.Bold = False
                        .Font.ColorIndex = 0
                        If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Mid(.Value, 6, 1) = "s") Then
                            .Font.Bold = True
                            .Font.ColorIndex = 3
                        End If
                    End With
                Next n
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
    
        Else
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "D").End(xlUp).Row
            wb_oblast = "D3:D" & wb_posledni_radek
            
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                Application.EnableEvents = False
                Target.Offset(0, 1) = C.Offset(0, 1).Value              'polo|fffd|ka - MJ
                'Target.Offset(0, 2) = c.Offset(0, 2).Value             'polo|fffd|ka - mno|fffd|stv|fffd|
                Target.Offset(0, 3) = C.Offset(0, 3).Value              'polo|fffd|ka - cena za jednotku
                    
                Target.Offset(0, -2).Value = C.Offset(0, -2).Value      'polo|fffd|ka - n|fffd|zev
                Target.Offset(0, -3) = Target.Offset(n, -3).Row - 30    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                Target.Offset(0, 4) = "1"                               'polo|fffd|ka - DPH
                
                .Unprotect ("0309")
                With Target.Offset(0, 0)
                    .Value = C.Offset(0, 0).Value
                    .Font.Bold = False
                    .Font.ColorIndex = 0
                    If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Right(.Value, 1) = "m") Then
                        .Font.Bold = True
                        .Font.ColorIndex = 3
                    End If
                End With
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
          
        End If
              
radek_wb_change_konec:
        If sesit_je_otevren(wb_nazev) = True Then wb.Close (False)
        
        Set C = Nothing
        Set wb = Nothing
        
        If wb_nenalezeno = 1 Then
            Application.EnableEvents = False
            Target.Offset(0, 1) = ""                                            'polo|fffd|ka - MJ
            Target.Offset(0, 2) = ""                                            'polo|fffd|ka - mno|fffd|stv|fffd|
            Target.Offset(0, 3) = ""                                            'polo|fffd|ka - cena za jednotku
            Target.Offset(0, -2).Value = ""                                     'polo|fffd|ka - n|fffd|zev
            Target.Offset(0, -3) = Target.Offset(n, -3).Row - 30                'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
            Target.Offset(0, 4) = "1"                                           'polo|fffd|ka - DPH
            Application.EnableEvents = True
            Application.ScreenUpdating = True
            Target.Select
            Application.ScreenUpdating = False
            MsgBox "Polo|fffd|ka nebyla ve zvolen|fffd|m cen|fffd|ku polo|fffd|ek nalezena." & vbLf & vbLf & _
                "K|fffd|d polo|fffd|ky: " & Target.Value & vbLf & _
                "Cen|fffd|k polo|fffd|ek: " & .Range("NEK_Cenik").Text & vbLf & vbLf & _
                "Zkontroluj:  1) zad|fffd|n|fffd| polo|fffd|ky" & vbLf & _
                "                   2) vybran|fffd| cen|fffd|k" & vbLf & vbLf & _
                "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbCritical + vbOKOnly, "POLO|fffd|KA CEN|fffd|KU NENNALEZENA"
        End If
        
        If nedostatek_radku = 1 Then
            MsgBox "Polo|fffd|ka se skl|fffd|d|fffd| z v|fffd|ce polo|fffd|ek (|fffd||fffd|dk|fffd|) ne|fffd| je mo|fffd|n|fffd| aktu|fffd|ln|fffd| do v|fffd|po|fffd|tu vlo|fffd|it." & vbLf & vbLf & _
            "Nalezeno |fffd||fffd|dk|fffd|: " & nalezeno_radku & vbLf & _
            "Mo|fffd|no vlo|fffd|it |fffd||fffd|dk|fffd|: " & pocet_polozek & vbLf & _
            "Nedost|fffd|v|fffd| se |fffd||fffd|dk|fffd|: " & nalezeno_radku - pocet_polozek & vbLf & vbLf & _
            "Do v|fffd|po|fffd|tu nebyla p|fffd|id|fffd|na |fffd||fffd|dn|fffd| polo|fffd|ka." & vbLf & vbLf & _
            "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbExclamation + vbOKOnly, "NEDOSTATEK POU|fffd|ITELN|fffd|CH |fffd||fffd|DK|fffd|"
        End If
        
        'Application.EnableEvents = True     'jen pro jistotu
        Application.ScreenUpdating = True
    
    End If
    .Protect ("0309")
End With

End Sub


Function sesit_je_otevren(nazev_xls)
Dim wbk As Workbook
sesit_je_otevren = False 'dosadit defaultn|fffd| hodnotu
For Each wbk In Workbooks
If wbk.Name = nazev_xls Then
    sesit_je_otevren = True
End If
Next
End Function



Sub nNEK()
Application.ScreenUpdating = True
Application.EnableEvents = True
ThisWorkbook.Unprotect ("0309")
ThisWorkbook.Worksheets("Nemovitosti").Unprotect ("0309")
End Sub

Attribute VB_Name = "NEM"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim Zakladna

Private Sub Worksheet_Change(ByVal Target As Range)
Dim target_nova_hodnota, wb As Workbook, wb_nazev, wb_posledni_radek, wb_oblast, wb_nenalezeno, _
polozka_nadpis, C, n, _
target_row, max_row, pocet_polozek, nalezeno_radku, nedostatek_radku, material_tucne

With ThisWorkbook.Worksheets("Nemovitosti")
    If Target.Row < 32 Or Target.Row > 181 Then Exit Sub
    
    If Not (Intersect(Target, .Range("KodyEC")) Is Nothing) Then
        
        If Target(1).Value = "" Then GoTo radek_wb_change_konec
        
        Application.EnableEvents = False
        target_nova_hodnota = Target.Value          'pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
        Application.Undo
        Target.Value = Trim(target_nova_hodnota)    'odstran|fffd|n|fffd| p|fffd|ebyte|fffd|n|fffd|ch mezer
        Application.EnableEvents = True
        
        If Not IsNumeric(Left(Target(1).Value, 1)) Then
            wb_nenalezeno = 1
            GoTo radek_wb_change_konec
        End If
        
        Application.ScreenUpdating = False
        max_row = .Range("KodyEC").Rows.Count
        pocet_polozek = max_row - WorksheetFunction.CountIf(.Range("KodyEC"), "*") + 1
        nedostatek_radku = 0
        wb_nenalezeno = 0
        Zakladna = "": wb_nazev = ""
        
        'definice v modulu Vyber_Listu viz Public Const NEM_cenik_polozek_cesta
        'PthD = "d:\Data\JS\TIA\_vypocet_plneni_ODP\maj_ciselniky\"
        PthD = NEM_cenik_polozek_cesta
        
        Zakladna = Left(.Range("NEM_Cenik").Text, 1) & Right(.Range("NEM_Cenik").Text, 4)
        wb_nazev = Dir(PthD & "Polo|fffd|ky" & Zakladna & ".xls*")
        
        'z|fffd|stal-li n|fffd|hodou z p|fffd|ech|fffd|zej|fffd|c|fffd|ho zpracov|fffd|n|fffd| soubor otev|fffd|en|fffd|, tak zav|fffd||fffd|t soubor
        If sesit_je_otevren(wb_nazev) = True Then Workbooks(wb_nazev).Close (False)
            
        On Error Resume Next
        Set wb = Workbooks.Open(PthD & wb_nazev, , True)
        If err.Number <> 0 Then
            MsgBox "Soubor s polo|fffd|kami cen|fffd|ku je nedostupn|fffd|." & vbLf & vbLf & _
                "Cesta k souboru: " & PthD & vbLf & _
                "N|fffd|zev souboru: " & wb_nazev & vbLf & vbLf & _
                "Bu|fffd| soubor neexistuje nebo bude probl|fffd|m se s|fffd|ov|fffd|mi disky. Kontaktujte helpdesk.", vbCritical + vbOKOnly, "NELZE NA|fffd||fffd|ST POLO|fffd|KY CEN|fffd|KU"
            Target.Select
            GoTo radek_wb_change_konec
        End If
        On Error GoTo 0
          
        .Activate
        nalezeno_radku = 0
          
        If Val(Right(Zakladna, 4)) >= 2015 Then
            If Target.Offset(0, 0) = "" Then GoTo radek_wb_change_konec
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "A").End(xlUp).Row
            wb_oblast = "A4:A" & wb_posledni_radek
            
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                nalezeno_radku = WorksheetFunction.CountIf(wb.Worksheets(1).Range(wb_oblast), Target.Value & "*")
                    
                If nalezeno_radku > pocet_polozek Then
                    nedostatek_radku = 1
                    GoTo radek_wb_change_konec
                End If
                    
                Application.EnableEvents = False
                For n = 0 To (nalezeno_radku - 1)
                    target_row = Target.Offset(n, 0).Row
                    Target.Offset(n, -3) = Target.Offset(n, -3).Row - 31    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                        
                    If .Rows(target_row & ":" & target_row).Hidden = True Then
                        Pridej_NEM_radek
                    End If
                        
                    With Target.Offset(n, -2)                           'polo|fffd|ka - n|fffd|zev
                        .Value = C.Offset(n, 2).Value
                        If Mid(.Value, 2, 1) = UCase(Mid(.Value, 2, 1)) Then polozka_nadpis = 1 Else polozka_nadpis = 0
                    End With
                       
                    If polozka_nadpis = 0 Then
                        Target.Offset(n, 1) = C.Offset(n, 3).Value      'polo|fffd|ka - MJ
                        If C.Offset(n, 5).Value > 0 Then
                            'Target.Offset(n, 2) = 1                     'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = C.Offset(n, 5).Value  'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = "1"                   'polo|fffd|ka - DPH
                        Else
                            Target.Offset(n, 2) = ""                    'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = ""                    'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = ""                    'polo|fffd|ka - DPH
                        End If
                    Else
                        Target.Offset(n, 4) = ""                        'polo|fffd|ka - DPH
                    End If
                        
                    .Unprotect ("0309")
                    With Target.Offset(n, 0)                            'polo|fffd|ka - k|fffd|d
                        .Value = C.Offset(n, 1).Value
                        .Font.Bold = False
                        .Font.ColorIndex = 0
                        If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Mid(.Value, 6, 1) = "s") Then
                            .Font.Bold = True
                            .Font.ColorIndex = 3
                        End If
                    End With
                Next n
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
    
        Else
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "D").End(xlUp).Row
            wb_oblast = "D3:D" & wb_posledni_radek
                
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                Application.EnableEvents = False
                Target.Offset(0, 1) = C.Offset(0, 1).Value              'polo|fffd|ka - MJ
                'Target.Offset(0, 2) = c.Offset(0, 2).Value             'polo|fffd|ka - mno|fffd|stv|fffd|
                Target.Offset(0, 3) = C.Offset(0, 3).Value              'polo|fffd|ka - cena za jednotku
                    
                Target.Offset(0, -2).Value = C.Offset(0, -2).Value      'polo|fffd|ka - n|fffd|zev
                Target.Offset(0, -3) = Target.Offset(n, -3).Row - 31    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                Target.Offset(0, 4) = "1"                               'polo|fffd|ka - DPH
                
                .Unprotect ("0309")
                With Target.Offset(0, 0)
                    .Value = C.Offset(0, 0).Value
                    .Font.Bold = False
                    .Font.ColorIndex = 0
                    If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Right(.Value, 1) = "m") Then
                        .Font.Bold = True
                        .Font.ColorIndex = 3
                    End If
                End With
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
          
        End If
              
radek_wb_change_konec:
        If sesit_je_otevren(wb_nazev) = True Then wb.Close (False)
        
        Set C = Nothing
        Set wb = Nothing
        
        If wb_nenalezeno = 1 Then
            Application.EnableEvents = False
            Target.Offset(0, 1) = ""                                            'polo|fffd|ka - MJ
            Target.Offset(0, 2) = ""                                            'polo|fffd|ka - mno|fffd|stv|fffd|
            Target.Offset(0, 3) = ""                                            'polo|fffd|ka - cena za jednotku
            Target.Offset(0, -2).Value = ""                                     'polo|fffd|ka - n|fffd|zev
            Target.Offset(0, -3) = Target.Offset(n, -3).Row - 31                'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
            Target.Offset(0, 4) = "1"                                           'polo|fffd|ka - DPH
            Application.EnableEvents = True
            Application.ScreenUpdating = True
            Target.Select
            Application.ScreenUpdating = False
            MsgBox "Polo|fffd|ka nebyla ve zvolen|fffd|m cen|fffd|ku polo|fffd|ek nalezena." & vbLf & vbLf & _
                "K|fffd|d polo|fffd|ky: " & Target.Value & vbLf & _
                "Cen|fffd|k polo|fffd|ek: " & .Range("NEM_Cenik").Text & vbLf & vbLf & _
                "Zkontroluj:  1) zad|fffd|n|fffd| polo|fffd|ky" & vbLf & _
                "                   2) vybran|fffd| cen|fffd|k" & vbLf & vbLf & _
                "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbCritical + vbOKOnly, "POLO|fffd|KA CEN|fffd|KU NENNALEZENA"
        End If
        
        If nedostatek_radku = 1 Then
            MsgBox "Polo|fffd|ka se skl|fffd|d|fffd| z v|fffd|ce polo|fffd|ek (|fffd||fffd|dk|fffd|) ne|fffd| je mo|fffd|n|fffd| aktu|fffd|ln|fffd| do v|fffd|po|fffd|tu vlo|fffd|it." & vbLf & vbLf & _
            "Nalezeno |fffd||fffd|dk|fffd|: " & nalezeno_radku & vbLf & _
            "Mo|fffd|no vlo|fffd|it |fffd||fffd|dk|fffd|: " & pocet_polozek & vbLf & _
            "Nedost|fffd|v|fffd| se |fffd||fffd|dk|fffd|: " & nalezeno_radku - pocet_polozek & vbLf & vbLf & _
            "Do v|fffd|po|fffd|tu nebyla p|fffd|id|fffd|na |fffd||fffd|dn|fffd| polo|fffd|ka." & vbLf & vbLf & _
            "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbExclamation + vbOKOnly, "NEDOSTATEK POU|fffd|ITELN|fffd|CH |fffd||fffd|DK|fffd|"
        End If
        
        'Application.EnableEvents = True     'jen pro jistotu
        Application.ScreenUpdating = True
    
    End If
On Error Resume Next
    .Protect ("0309")
On Error GoTo 0
End With

End Sub


Function sesit_je_otevren(nazev_xls)
Dim wbk As Workbook
sesit_je_otevren = False 'dosadit defaultn|fffd| hodnotu
For Each wbk In Workbooks
If wbk.Name = nazev_xls Then
    sesit_je_otevren = True
End If
Next
End Function


Sub nNEM()
Application.ScreenUpdating = True
Application.EnableEvents = True
ThisWorkbook.Unprotect ("0309")
ThisWorkbook.Worksheets("Nemovitosti").Unprotect ("0309")
'ThisWorkbook.Protect ("0309")
ThisWorkbook.Worksheets("Nemovitosti").Protect ("0309")

End Sub

Attribute VB_Name = "Na|fffd|ti"
Sub Nacti_Info_Aktualizace()
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Vypocet%20plneni/V%c3%bdpo%c4%8det%20pln%c4%9bn%c3%ad%20-%20ODP.aspx", _
    NewWindow:=True
End Sub
Sub Navrat_hl_str()
    
  Const cStartList = "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\V|fffd|po|fffd|et_pln|fffd|n|fffd|.xls"
  For Each wb In Workbooks
    If wb.FullName = cStartList Then
      wb.Activate
      Exit Sub
    End If
  Next wb
  
  Workbooks.Open (cStartList)
  ThisWorkbook.Close (False)
  
End Sub
Sub Nacti_Dluzne_pojistne()
Attribute Nacti_Dluzne_pojistne.VB_Description = "Makro zaznamenan|fffd| 11.9.2006, jvincenc"
Attribute Nacti_Dluzne_pojistne.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Seznameni%20s%20PU/Ov|fffd||fffd|en|fffd|%20pojistn|fffd|ho%20kryt|fffd|%20ODP.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_Postihy()
Attribute Nacti_Postihy.VB_Description = "Makro zaznamenan|fffd| 11.9.2006, jvincenc"
Attribute Nacti_Postihy.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Pohledavky%20a%20IP/Pohled%c3%a1vky%20z%20ODP.aspx", _
    NewWindow:=True
End Sub

Sub Nacti_Platby_vratky()
Attribute Nacti_Platby_vratky.VB_Description = "Makro zaznamenan|fffd| 11.9.2006, jvincenc"
Attribute Nacti_Platby_vratky.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Platby%20Vratky%20atd/Domovsk%C3%A1%20str%C3%A1nka.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_Dopisy()
Attribute Nacti_Dopisy.VB_Description = "Makro zaznamenan|fffd| 11.9.2006, jvincenc"
Attribute Nacti_Dopisy.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Dopisy%20a%20uzavreni%20PU/Domovsk%C3%A1%20str%C3%A1nka.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_Lh|fffd|ty()
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Pr%c3%a1ce%20s%20PU/Likvidace%20PU%20v%20z%c3%a1konn%c3%a9%20lh%c5%aft%c4%9b%20-%20%c5%a0et%c5%99en%c3%ad.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_Vypocet_pln()
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/Vypocet%20plneni/V%c3%bdpo%c4%8det%20pln%c4%9bn%c3%ad%20-%20ODP.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_SSL_VPP_2005()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Pojistn|fffd|_podm|fffd|nky_a_smluvn|fffd|_ujedn|fffd|n|fffd|\2005", _
    NewWindow:=True
End Sub
Sub Nacti_Sablony_setreni()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Dokumentace\Dopisy_Centralizace_N|fffd|P", _
    NewWindow:=True
End Sub
Sub Nacti_SSL_VPP_do_2005()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Pojistn|fffd|_podm|fffd|nky_a_smluvn|fffd|_ujedn|fffd|n|fffd|\P|fffd|vodn|fffd|_pojistn|fffd|_podm|fffd|nky_a_smluvn|fffd| ujedn|fffd|n|fffd|", _
    NewWindow:=True
End Sub
Sub Nacti_SSL_VLS()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\vseobecna_likv_smernice_v_1_10.doc", _
    NewWindow:=True
End Sub
Sub Nacti_SSL_ODP()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\", _
    NewWindow:=True
End Sub
Sub Nacti_Bolestn|fffd|()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\2001_440_2001_Bolestn|fffd|_a_ZSU.doc", _
    NewWindow:=True
End Sub

Sub Nacti_Bolestn|fffd|_2()
    Dim vyber
    vyber = MsgBox("Jakou verzi Na|fffd||fffd|zen|fffd| vl|fffd|dy 276/2015 Sb. chcete otev|fffd||fffd|t?" & vbLf & vbLf & _
                    "Ano ... platnou od 21.7.2016" & vbLf & _
                    "  Ne ... p|fffd|vodn|fffd|" _
                    , vbYesNoCancel + vbQuestion, "Vybrat verzi Na|fffd||fffd|zen|fffd| vl|fffd|dy 276/2015 Sb.")
                    '"Ano ... platnou od 21.7.2016 (p|fffd|edpis 224/2016 Sb.)" & vbLf & _

    Select Case vyber
        Case vbCancel:  Exit Sub
        Case vbYes:     Nacti_Bolestn|fffd|_2b
        Case vbNo:      Nacti_Bolestn|fffd|_2a
    End Select
End Sub
Sub Nacti_Bolestn|fffd|_2a()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Bolestn|fffd|_ZSU_276-2015.pdf", _
    NewWindow:=True
End Sub
Sub Nacti_Bolestn|fffd|_2b()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Bolestn|fffd|_ZSU_276-2015_NOV.pdf", _
    NewWindow:=True
End Sub

Sub Nacti_Bol_NS()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Hodnocen|fffd|_bolesti_CP_NS.pdf", _
    NewWindow:=True
End Sub
Sub Nacti_Emanuel()
    ActiveWorkbook.FollowHyperlink Address:="http://intranet.cpas.cz/naseutvaryt/ex/ulpunzp/emanuel/default.aspx", _
    NewWindow:=True
End Sub
Sub Nacti_LPUNZP()
    ActiveWorkbook.FollowHyperlink Address:="http://lpunzp.cpoj.cz/", _
    NewWindow:=True
End Sub


Sub upravit_komentare(obj_sht)
Dim xComment As Comment, Lf_pozice, Lf_pozice_pom, Lf_pocet, t, comm_text
t = obj_sht.Comments.Count
    If obj_sht.Comments.Count > 0 Then
        'Application.ScreenUpdating = False
        obj_sht.Unprotect Password:="0309"
        
        For Each xComment In obj_sht.Comments
            With xComment
radek_komentare_na_listu_znovu:
                comm_text = Len(.Text) & " / " & .Text
                If Left(.Text, 1) = vbLf Or Right(.Text, 1) = vbLf Or Right(.Text, 1) = " " Then
                    .Text Trim(.Text)
                    Lf_pozice = InStr(1, .Text, vbLf)
                    If Lf_pozice = 1 Then .Text Mid(.Text, 2)
                    Lf_pocet = Len(.Text) - Len(Replace(.Text, vbLf, ""))
                    If Lf_pocet > 1 Then
                        Lf_pozice_pom = 1
                        For t = 1 To Lf_pocet
                            Lf_pozice_pom = InStr(Lf_pozice_pom, .Text, vbLf) + 1
                        Next t
                        Lf_pozice = Lf_pozice_pom - 1
                    Else
                        Lf_pozice = InStr(1, .Text, vbLf)
                    End If
                    If Lf_pozice = Len(.Text) Then .Text Left(.Text, Lf_pozice - 1)
                    GoTo radek_komentare_na_listu_znovu
                End If
                
                With .Shape
                    .TextFrame.Characters.Font.Bold = False
                    .TextFrame.Characters.Font.Size = 11
                    .TextFrame.AutoSize = True
                    .ScaleWidth 1.1, msoFalse, msoScaleFromTopLeft
                    .ScaleHeight 1.1, msoFalse, msoScaleFromTopLeft
                End With
            End With
        Next
        'ActiveWindow.ScrollRow = 1
        'ActiveWindow.ScrollColumn = 1
        'obj_sht.Protect Password:="0309"
        'Application.ScreenUpdating = False
    End If
End Sub

Sub Nacti_email_admin()
  Const UvodniList = "|fffd|vodn|fffd| list"
  Dim user As String
  Dim volba As Integer
  Dim date_pom As Long
  
  user = UCase(CreateObject("WScript.Network").UserName)
  If user = "JVINCENC" Or user = "ROSOKOL" Or user = "MROM" Then
    volba = MsgBox("Zamknout listy?", vbYesNoCancel + vbDefaultButton3 + vbQuestion)
    If volba = vbCancel Then Exit Sub
    
    'pokud je se|fffd|it ReadOnly, tak R/W
    If ThisWorkbook.ReadOnly Then
        SetAttr ThisWorkbook.FullName, vbNormal
        Sleep 20
        DoEvents
        ThisWorkbook.ChangeFileAccess xlReadWrite
        Sleep 20
        DoEvents
    End If
    
    If volba = vbYes Then
      ThisWorkbook.Unprotect ("0309")
      Application.ScreenUpdating = False
      For Each list In ThisWorkbook.Sheets
        If list.Name <> UvodniList Then list.Visible = False
        list.Activate
        Call upravit_komentare(list)
        If Left(list.Name, 11) <> "Datov|fffd| list" And list.Name <> "Sazby |fffd|NB" Then
          If list.Name <> "ZSU dle NS" Then list.Protect Password:="0309", UserInterfaceOnly:=True
        End If
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1
      Next list
      ThisWorkbook.Sheets("ZSU_pom_Tabulky").Visible = False
      ThisWorkbook.Sheets("Seznam polo|fffd|ek").Activate
        Rows("954:990").EntireRow.Hidden = True
        Columns("A").EntireColumn.Hidden = True
        Range("B2").Select
      ThisWorkbook.Sheets("Polo|fffd|ky_NS").Activate
        Columns("C").EntireColumn.Hidden = True
        Range("B3").Select
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Activate
        Rows("100:110").EntireRow.Hidden = True
        Vymaz_Vyp_Zdravy_ODP
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Activate
        Rows("100:120").EntireRow.Hidden = True
        Vymaz_Vyp_Zdravy_Dan_ODP
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Activate
        Rows("100:110").EntireRow.Hidden = True
        Vymaz_Vyp_Zdravy_Zahr_ODP
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na V|fffd|CI I").Activate
        Rows("200:220").EntireRow.Hidden = True
        Vymaz_Vyp_Vec1_ODP
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na V|fffd|CI II").Activate
        Vymaz_Vyp_Vec2_ODP
      ThisWorkbook.Sheets("Obecn|fffd|").Activate
        Rows("100:220").EntireRow.Hidden = True
        Vymaz_Vyp_OBEC_ODP
      ThisWorkbook.Sheets("Dopravci").Activate
        Vymaz_Vyp_Dop_ODP
      ThisWorkbook.Sheets("Nemovitosti").Activate
        Vymaz_Vyp_Nemovitosti_ODP
      ThisWorkbook.Sheets("Jed_ODP").Activate
        Vymaz_Vyp_Jed_ODP
      ThisWorkbook.Sheets("Nemovitosti komb").Activate
        Vymaz_Vyp_Nemovitosti_komb_ODP
      ThisWorkbook.Sheets("V|fffd|kaz v|fffd|m|fffd|r").Activate
        Vymaz_Vymery
      ThisWorkbook.Sheets("Z|fffd|jezd").Activate
        Vymaz_Vyp_Zajezd_ODP
      ThisWorkbook.Sheets("Soupoji|fffd|t|fffd|n|fffd|").Activate
        Rows("40:60").EntireRow.Hidden = True
        Vymaz_Vyp_SOU_ODP
      ThisWorkbook.Sheets("AZ").Activate
        Rows("40:60").EntireRow.Hidden = True
        Vymaz_Vyp_AZA_ODP
      ThisWorkbook.Sheets("Auto").Activate
        Vymaz_Vyp_Auto_ODP
      ThisWorkbook.Sheets("AUTA V|fffd|KON POVOL.").Activate
        Vymaz_Vyp_Auto_Vyk_ODP
      ThisWorkbook.Sheets("Vec_POR").Activate
        Vymaz_Vyp_Vec_ODP_POR
      ThisWorkbook.Sheets("Nem_POR").Activate
        Vymaz_Vyp_Nemovitosti_ODP_POR
      ThisWorkbook.Sheets("Auto_POR").Activate
        Vymaz_Vyp_Auto_ODP_POR
      ThisWorkbook.Sheets("V|fffd|po|fffd|et Ztr|fffd|ta na v|fffd|d|fffd|lku").Activate
        Vymaz_Vyp_Vydelek_ODP
      ThisWorkbook.Sheets("V|fffd|po|fffd|et THV").Activate
        Vymaz_Vyp_THV
      ThisWorkbook.Sheets("Pneu TH").Activate
        Vymaz_Vyp_THP
      ThisWorkbook.Sheets("Advok|fffd|t").Activate
        Vymaz_Vyp_Advokat
      ThisWorkbook.Sheets("V|fffd|po|fffd|et |fffd|roku z prodlen|fffd| POV").Activate
        Vymaz_Vypocet_uroku_POV
      ThisWorkbook.Sheets("Confirmation").Activate
        Vymaz_CORN_Text
      ThisWorkbook.Sheets("Auto tot|fffd|lka").Activate
        Vymaz_Vyp_TOT_ODP
      ThisWorkbook.Sheets("Z|fffd|silky").Activate
        Vymaz_Vyp_ZASI_ODP
      ThisWorkbook.Sheets("Auto Spolu|fffd||fffd|ast").Activate
        Vymaz_Vyp_Auto_Spolu_ODP
      ThisWorkbook.Sheets("P|fffd|epo|fffd|et dan|fffd|").Activate
        Vymaz_Vyp_Prepocet_dane_ODP
      ThisWorkbook.Sheets("Bolestn|fffd|").Activate
        Vymaz_BOL
      ThisWorkbook.Sheets("ZSU dle NS").Activate
        Vymaz_ZSU_NS
      ThisWorkbook.Sheets("ZSU").Activate
        Vymaz_ZSU
      ThisWorkbook.Sheets("Vyjedn|fffd|v|fffd|n|fffd| ZSU").Activate
        Vymaz_ZSU_Vyjednavani
      ThisWorkbook.Sheets("|fffd|mrt|fffd|").Activate
        Vymaz_Umrti
      ThisWorkbook.Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Activate
        Rows("100:120").EntireRow.Hidden = True
        Vymaz_Vyp_Skol_ODP

      nastavit_CP "Nem - Opot|fffd|eben|fffd|"
      
      'VyberList
      ''ThisWorkbook.Protect ("0309")
      
      Application.ScreenUpdating = True
      ThisWorkbook.Sheets("|fffd|vodn|fffd| list").Activate
      ThisWorkbook.Save
      ThisWorkbook.Saved = True
    Else
      ThisWorkbook.Unprotect ("0309")
      
      Range("B1").Select
      For Each list In ThisWorkbook.Worksheets
        list.Unprotect ("0309")
        ThisWorkbook.Sheets(list.Name).Visible = True
      Next list
      ThisWorkbook.Worksheets("Bolestn|fffd|").Activate
        'pokud je bu|fffd|ka pr|fffd|zdn|fffd|, tak dosadit 'n|fffd|jak|fffd|' datum aby se rozbalily v|fffd|echny |fffd||fffd|dky 7:31
        If ThisWorkbook.Worksheets("Bolestn|fffd|").Range("C3").Value = vbNullString Then
            ThisWorkbook.Worksheets("Bolestn|fffd|").Range("C3").Value = CDate("1.1.1980")
            date_pom = 1
        End If
        Rows("12:31").EntireRow.Hidden = False
        For Each sh In ActiveSheet.Shapes
          If sh.Type <> msoPicture Then sh.Visible = True
        Next sh
        Columns("AI:AU").EntireColumn.Hidden = False
        Columns("D:G").EntireColumn.Hidden = False
        Range("A200").FormulaR1C1 = 20
        'pokud bylo dosazeno 'n|fffd|jak|fffd|' datum kv|fffd|li rozbalen|fffd| |fffd||fffd|dk|fffd| 7:31, tak 'n|fffd|jak|fffd|' datum smazat
        If date_pom = 1 Then ThisWorkbook.Worksheets("Bolestn|fffd|").Range("C3").Value = vbNullString
        
      ThisWorkbook.Sheets("Polo|fffd|ky_NS").Activate
        Columns("C").EntireColumn.Hidden = False
      ThisWorkbook.Sheets("ZSU").Activate
        'pokud je bu|fffd|ka pr|fffd|zdn|fffd|, tak dosadit 'n|fffd|jak|fffd|' datum aby se rozbalily v|fffd|echny |fffd||fffd|dky 7:31
        If ThisWorkbook.Worksheets("ZSU").Range("C3").Value = vbNullString Then
            ThisWorkbook.Worksheets("ZSU").Range("C3").Value = CDate("1.1.1980")
            date_pom = 1
        End If
        Rows("12:31").EntireRow.Hidden = False
        Columns("D:F").EntireColumn.Hidden = False
        For Each sh In ActiveSheet.Shapes
          If sh.Type <> msoPicture Then sh.Visible = True
        Next sh
        Range("A200").FormulaR1C1 = 20
        'pokud bylo dosazeno 'n|fffd|jak|fffd|' datum kv|fffd|li rozbalen|fffd| |fffd||fffd|dk|fffd| 7:31, tak 'n|fffd|jak|fffd|' datum smazat
        If date_pom = 1 Then ThisWorkbook.Worksheets("ZSU").Range("C3").Value = vbNullString
        DoEvents
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Activate
        Rows("100:110").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Activate
        Rows("100:120").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Activate
        Rows("100:110").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Activate
        Rows("100:120").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Worksheets("Nemovitosti").Activate
        Rows("37:181").EntireRow.Hidden = False
        Rows("300:400").EntireRow.Hidden = False
      ThisWorkbook.Worksheets("Nemovitosti komb").Activate
        Rows("35:59").EntireRow.Hidden = False
        Rows("65:210").EntireRow.Hidden = False
        Rows("300:400").EntireRow.Hidden = False
      ThisWorkbook.Sheets("Nem_POR").Activate
        Rows("12:161").EntireRow.Hidden = False
        Rows("300:400").EntireRow.Hidden = False
      ThisWorkbook.Worksheets("Seznam polo|fffd|ek").Activate
        Rows("954:990").EntireRow.Hidden = False
        Columns("A").EntireColumn.Hidden = False
        Columns("D:F").EntireColumn.Hidden = False
      ThisWorkbook.Worksheets("V|fffd|po|fffd|et na V|fffd|CI I").Activate
        Rows("41:85").EntireRow.Hidden = False
        Rows("200:220").EntireRow.Hidden = False
      ThisWorkbook.Worksheets("Soupoji|fffd|t|fffd|n|fffd|").Activate
        Rows("40:60").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Worksheets("AZ").Activate
        Rows("40:60").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Worksheets("Obecn|fffd|").Activate
        Rows("100:220").EntireRow.Hidden = False
        Range("D4").Select
      ThisWorkbook.Worksheets("AUTA V|fffd|KON POVOL.").Activate
        Rows("56:83").EntireRow.Hidden = False
        For Each sh In ActiveSheet.Shapes
          If Rows(56).Top <= sh.Top And sh.Top < Rows(82).Top Then
            sh.Visible = True
          End If
        Next sh
        Rows("95:160").EntireRow.Hidden = False
        Range("C4").Select
      ThisWorkbook.Sheets(UvodniList).Activate
      Range("C3").Select
    End If
  Else
    ActiveWorkbook.FollowHyperlink Address:="mailto:roman.sokol@ceskapojistovna.cz", _
    NewWindow:=True
  End If
End Sub
Sub Pruvodce_PS_v_TIA()
ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Pr|fffd|vodce_PS", _
    NewWindow:=True
End Sub
Sub Nacti_IS_06_116()
ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Dokumentace\Intern|fffd| sd|fffd|len|fffd|\IS 06-116.doc", _
    NewWindow:=True
End Sub
Sub Nacti_Vykaz_Vymer()
    Sheets("V|fffd|kaz v|fffd|m|fffd|r").Select
    Range("B5").Select
End Sub
Sub Nacti_pruvodce_VYP_ODP()
    ActiveWorkbook.FollowHyperlink Address:="\\sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Vypoctove_tabulky\V|fffd|po|fffd|tov|fffd| tabulky.doc", _
    NewWindow:=True
End Sub
Sub Nacti_amortizacni_stupnici_veci()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Amortiza|fffd|n|fffd|_skupiny.xls", _
    NewWindow:=True
End Sub
Sub Nacti_amortizacni_stupnici_vse()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\Amortizacni_tabulka_mov_i_nemov.xls", _
    NewWindow:=True
End Sub
Sub Datab|fffd|ze_polo|fffd|ek()
    ActiveWorkbook.FollowHyperlink Address:="\\Sfs01\Dokumenty\SSL\Likvidace\Majetek\ODPOV|fffd|DNOST", _
    NewWindow:=True
End Sub
Sub Vypocet_renty()
    ActiveWorkbook.FollowHyperlink Address:="\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\V|fffd|po|fffd|et_pln|fffd|n|fffd|_Renty.xls", _
    NewWindow:=True
End Sub
Sub Mail_Tel_RSL()
    Workbooks.Open "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Dopisy_Email_ODP.xls"
'    ActiveWorkbook.FollowHyperlink Address:="\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Dopisy_Email_ODP.xls", _
    NewWindow:=True
End Sub
Sub Vypocet_SKOL()
    Workbooks.Open "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\V|fffd|po|fffd|et_pln|fffd|n|fffd|_ODP_SKOL.xls"
End Sub
Sub Mail_Tel_RSL_SKOL()
    Workbooks.Open "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Dopisy_Email_ODP_SKOL.xls"
End Sub
Sub Pujcovne_ODP()
    Workbooks.Open "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\V|fffd|po|fffd|et_p|fffd|j|fffd|ovn|fffd|_ODP.xls"
'    ActiveWorkbook.FollowHyperlink Address:="\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Dopisy_Email_ODP.xls", _
    NewWindow:=True
End Sub
Sub Kopirovat_text_CZ()

  Dim C As Range
  Dim u As Range
  Dim rad As Integer
  Dim jmList As String
  
  'Application.ScreenUpdating = False
  Range("DataDopis_out").ClearContents
  For rad = 1 To 8
    Range("DataDopis_out").Offset(rad, 0).ClearContents
  Next rad
  Set u = Range("DataDopis_out").Cells(1)
  jmList = ActiveSheet.CodeName
  rad = 0
  txt = Range(jmList + "_DataDopis_CZ").Cells(1).Text & Chr(10)
  txt_out = ""
  
  For f = 1 To Len(txt)
      If Asc(Mid(txt, f, 1)) = 10 Then
          Range("DataDopis_out").Cells(1).Offset(rad, 0) = txt_out
          Set u = Union(u, Range("DataDopis_out").Cells(1).Offset(rad, 0))
          rad = rad + 1
          txt_out = ""
      Else
        txt_out = txt_out & Mid(txt, f, 1)
      End If
  Next f
  
  If Benefit_Spoluucast Then
      Range("DataDopis_out").Cells(1).Offset(rad, 0) = "Na Va|fffd||fffd| pojistn|fffd| smlouv|fffd| je sjedn|fffd|n Benefit Nulov|fffd| spolu|fffd||fffd|ast za beze|fffd|kodn|fffd| pr|fffd|b|fffd|h. Proto|fffd|e byla spln|fffd|na podm|fffd|nka pro poskytnut|fffd| tohoto benefitu, neode|fffd|etli jsme od pojistn|fffd|ho pln|fffd|n|fffd| spolu|fffd||fffd|ast sjednanou v pojistn|fffd| smlouv|fffd|."
      Set u = Union(u, Range("DataDopis_out").Cells(1).Offset(rad, 0))
  End If
  
  SeskupitCisla u ' Range("'Datov|fffd| list'!B53:'Datov|fffd| list'!B70") 'MRO seskupen|fffd| |fffd||fffd|sel
  
    'Pokud n|fffd|zev listu je ve skupin|fffd| pro kterou jsou definov|fffd|ny dodate|fffd|n|fffd| texty, zobraz formul|fffd||fffd| UF_TEXTACE
    Set C = Range("DATA_SKUPINA").Find(ActiveSheet.Name)
    If Not C Is Nothing Then
        If Date >= #4/23/2019# Then
            UF_Textace.Show (False)
        Else
            u.Copy 'P|fffd|vodn|fffd| |fffd|e|fffd|en|fffd|
        End If
    Else
        u.Copy 'P|fffd|vodn|fffd| |fffd|e|fffd|en|fffd|
    End If

  'u.Copy
  'Application.ScreenUpdating = True
  
End Sub
Function SeskupitCisla(txt) As String
    'Seskup|fffd| |fffd||fffd|sla po t|fffd|ech; vstupem je string nebo oblast;  vytvo|fffd|il RSO
    Dim strPattern As String: strPattern = "\d{1,3}(?=(\d{3})+(?!\d))"
    Dim strReplace As String: strReplace = "$& "
    Dim strInput As String
    Dim myRange As Range

    Set regEx = CreateObject("VBScript.RegExp")
    
    With regEx
        .Global = True
        .MultiLine = True
        .IgnoreCase = False
        .Pattern = strPattern
    End With
    
    If TypeName(txt) = "Range" Then
        Set myRange = txt
        For Each cell In myRange
            strInput = cell.Value
            If regEx.test(strInput) Then
                 cell.Value = regEx.Replace(strInput, strReplace)
            End If
        Next
    ElseIf TypeName(txt) = "String" Then
        strInput = txt
        If regEx.test(strInput) Then
             SeskupitCisla = regEx.Replace(strInput, strReplace)
         Else
            SeskupitCisla = strInput
        End If
    End If
    
    Set regEx = Nothing
End Function


Function Benefit_Spoluucast() As Boolean
    Dim dat As Date
    Benefit_Spoluucast = False
    If XMLRead("//BenefitExcess[position()=last()]/BenefitStartDate") <> "" Then
        dat = CDate(XMLRead("//Policy/BenefitExcess[not(../BenefitExcess/BenefitID > BenefitID)]/BenefitStartDate"))  '//BenefitExcess[position()=last()]/BenefitStartDate
        dat = CDate(Day(dat) & "." & Month(dat) & "." & (Year(dat) + 3))
        If XMLRead("//BenefitExcess[ClaEventNo=//ClaEvent/ClaEventNo]/BenefitStartDate") <> "" Or dat <= CDate(XMLRead("//ClaEvent/ClaCase/NotificationDate")) Then
            If ((XMLRead("//ClaEvent/CauseType") = "PVD" Or XMLRead("//ClaEvent/CauseType") = "ZAP") And XMLRead("//ExcessFlood", "0") <> "0") Or (((XMLRead("//ClaEvent/CauseType") <> "PVD" And XMLRead("//ClaEvent/CauseType") <> "ZAP") And XMLRead("//Excess", "0") <> "0")) Then
                Benefit_Spoluucast = True
            End If
        End If
    End If
End Function


Sub Kopirovat_text_EN()
  Dim C As Range
  Dim u As Range
  Dim rad As Integer
  Dim jmList As String
  
  Application.ScreenUpdating = False
  Range("DataDopis_out").ClearContents
  Set u = Range("DataDopis_out").Cells(1)
  jmList = ActiveSheet.CodeName
  rad = 0
  For Each C In Range(jmList + "_DataDopis_EN").Cells
  If rad < 1 Then
    Range("DataDopis_out").Cells(1).Offset(0, 0) = C.Text
    Set u = Union(u, Range("DataDopis_out").Cells(1).Offset(0, 0))
    rad = rad + 1
    End If
  Next C
  u.Copy
  Application.ScreenUpdating = True
End Sub
Sub Kopirovat_text_NE()
  Dim C As Range
  Dim u As Range
  Dim rad As Integer
  Dim jmList As String
  
  Application.ScreenUpdating = False
  Range("DataDopis_out").ClearContents
  Set u = Range("DataDopis_out").Cells(1)
  jmList = ActiveSheet.CodeName
  rad = 0
  For Each C In Range(jmList + "_DataDopis_NE").Cells
  If rad < 1 Then
    Range("DataDopis_out").Cells(1).Offset(0, 0) = C.Text
    Set u = Union(u, Range("DataDopis_out").Cells(1).Offset(0, 0))
    rad = rad + 1
    End If
  Next C
  u.Copy
  Application.ScreenUpdating = True
End Sub
Sub Kopirovat_text_FR()
  Dim C As Range
  Dim u As Range
  Dim rad As Integer
  Dim jmList As String
  
  Application.ScreenUpdating = False
  Range("DataDopis_out").ClearContents
  Set u = Range("DataDopis_out").Cells(1)
  jmList = ActiveSheet.CodeName
  rad = 0
  For Each C In Range(jmList + "_DataDopis_FR").Cells
  If rad < 1 Then
    Range("DataDopis_out").Cells(1).Offset(0, 0) = C.Text
    Set u = Union(u, Range("DataDopis_out").Cells(1).Offset(0, 0))
    rad = rad + 1
    End If
  Next C
  u.Copy
  Application.ScreenUpdating = True
End Sub
Sub Kopirovat_text_prohl_CZ()
  Dim C As Range
  Dim u As Range
  Dim rad As Integer
  Dim jmList As String
  
  Application.ScreenUpdating = False
  Range("DataProhl_Out").ClearContents
  Set u = Range("DataProhl_Out").Cells(1)
  jmList = ActiveSheet.CodeName
  rad = 0
  txt_out = Range(jmList + "_DELIB").Cells(1).Text
  Range("DataProhl_Out").Cells(1).Offset(rad, 0) = txt_out
  Set u = Union(u, Range("DataProhl_Out").Cells(1).Offset(0, 0))
  u.Copy
  Application.ScreenUpdating = True
End Sub
Sub Kopirovat_text_dopis()
  Application.ScreenUpdating = False
  jmList = ActiveSheet.CodeName
  Range(jmList + "_text").FormulaR1C1 = Range(jmList + "_DataDopis_CZ").Cells(1)
  Range(jmList + "_ZasPL").FormulaR1C1 = Range(jmList + "_ZasPL")
  Range(jmList + "_PlKan").FormulaR1C1 = Range(jmList + "_PlKan")
  Range(jmList + "_PlZpu").FormulaR1C1 = Range(jmList + "_PlZpu")
  Application.ScreenUpdating = True
End Sub
Sub Nacti_Data_Dopis_Poj()
  NactiTiaDat
  jmList = ActiveSheet.CodeName
  ActiveSheet.Unprotect ("0309")
  Range(jmList + "_Jmeno").FormulaR1C1 = XMLRead("<ForeName>") + " " + XMLRead("<SurName>")
  Range(jmList + "_Referent").FormulaR1C1 = ""
  Range(jmList + "_Ulice").FormulaR1C1 = XMLRead("<Street>") + " " + XMLRead("<StreetNo>")
  Range(jmList + "_Mesto").FormulaR1C1 = XMLRead("<ClaCase><Name><City>")
  Range(jmList + "_PSC").FormulaR1C1 = XMLRead("<PostArea>")
  vDatumPU = XMLRead("<IncidentDate>")
  Range(jmList + "_Pripad").FormulaR1C1 = XMLRead("<ClaCaseNo>")
  Range(jmList + "_PodPripad").FormulaR1C1 = XMLRead("<ClaSubcase><ClaSubCaseNo>")
  Range(jmList + "_Dat_PU").FormulaR1C1 = Trim(Left(vDatumPU, InStr(vDatumPU, ":") - 3))
  Range(jmList + "_POJ").FormulaR1C1 = XMLRead("<ForeName>") + " " + XMLRead("<SurName>") + ", " + XMLRead("<Street>") + " " + XMLRead("<StreetNo>") + ", " + XMLRead("<ClaCase><Name><City>") + ", PS|fffd| " + XMLRead("<PostArea>")
  Range(jmList + "_POS").FormulaR1C1 = XMLRead("<ThirdParty><Name><ForeName>") + " " + XMLRead("<ThirdParty><Name><SurName>") + ", " + XMLRead("<ThirdParty><Name><Street>") + " " + XMLRead("<ThirdParty><Name><StreetNo>") + ", " + XMLRead("<ThirdParty><Name><City>") + ", PS|fffd| " + XMLRead("<ThirdParty><Name><PostArea>")
  If jmList = "CORN" Then
    vZADOLilv = XMLRead("<ClaSubcase><UserName>")
On Error Resume Next
    vZADOLilv = Trim(Left(vZADOLilv, InStr(vZADOLilv, "(") - 1))
On Error GoTo 0
    Range(jmList + "_LIKV").FormulaR1C1 = vZADOLilv
    Range(jmList + "_Tym").FormulaR1C1 = XMLRead("<ClaSubcase><DeptNo>")
    vZADOSML = XMLRead("<PolicyNo>")
    Range(jmList + "_SML").FormulaR1C1 = vZADOSML
  End If

 Range(jmList + "_KDO").FormulaR1C1 = XMLRead("<Document><Company>")
 'vPojistovna = "Generali poji|fffd||fffd|ovna a.s." 'jen test
 'If LCase(Range(jmList + "_KDO").Value) Like "generali*" Then strSubj = "GP"
 'If LCase(Range(jmList + "_KDO").Value) Like "|fffd|esk|fffd|*" Then strSubj = "|fffd|P"
 'If Range(jmList + "_KDO").Value = "" Then
   If strSubj = "" Then zjistit_subjekt (Range(jmList + "_Pripad").Value) 'zjistit vPojistovna podle |fffd||fffd|sla PU

With ActiveSheet
    If NewFirma Then
        .Range(jmList + "_KDO").FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        .Range("C6").Value = "P.O. BOX 305,  659 05 Brno"
        '.Range("E6").Value = "601 00 Brno"
        .Range("H37").Value = "GENERALI |fffd|ESK|fffd| POJI|fffd||fffd|OVNA a.s. "
        .Range("C45").Value = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s.,"
        .Range("C46").Value = "ID: 45272956, VAT: CZ699001273,"
        .Range("C47").Value = "registered with the Commercial Register at the Municipal Court in Prague, Section B, Insert 1464"
        .Shapes("Logo_CP").Visible = False
        .Shapes("Logo_GP").Visible = False
        .Shapes("Logo_GCP").Visible = True
    ElseIf strSubj = "|fffd|P" Then
        .Range(jmList + "_KDO").FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        .Range("C6").Value = "P.O. BOX 305,  601 00 Brno"
        '.Range("E6").Value = "601 00 Brno"
        .Range("H37").Value = "|fffd|ESK|fffd| POJI|fffd||fffd|OVNA a.s. "
        .Range("C45").Value = "|fffd|esk|fffd| poji|fffd||fffd|ovna, a.s., Sp|fffd|len|fffd| 75/16, 113 04  Prague 1, phone: +420|fffd|224|fffd|051 111, fax +420 224 551 068,"
        .Range("C46").Value = "ID: 45272956, VAT: CZ699001273,"
        .Range("C47").Value = "registered with the Commercial Register at the Municipal Court in Prague, Section B, Insert 1464"
        .Shapes("Logo_CP").Visible = True
        .Shapes("Logo_GP").Visible = False
        .Shapes("Logo_GCP").Visible = False
    ElseIf strSubj = "GP" Then
        .Range(jmList + "_KDO").FormulaR1C1 = "Generali poji|fffd||fffd|ovna a.s."
        .Range("C6").Value = "P.O. BOX 151,  657 51 Brno 2"
        '.Range("E6").Value = "657 51 Brno 2"
        .Range("H37").Value = "GENERALI POJI|fffd||fffd|OVNA a.s. "
        .Range("C45").Value = "Generali Poji|fffd||fffd|ovna a.s., B|fffd|lehradsk|fffd| 132, 120 84  Prague 2, phone: +420|fffd|844 188 188,"
        .Range("C46").Value = "ID: 61859869, VAT: CZ699001273,"
        .Range("C47").Value = "registered with the Commercial Register at the Municipal Court in Prague, Section B, Insert 2866"
        .Shapes("Logo_CP").Visible = False
        .Shapes("Logo_GP").Visible = True
        .Shapes("Logo_GCP").Visible = False
    Else
    End If

End With

  ActiveSheet.Protect ("0309")

End Sub
Attribute VB_Name = "Na|fffd|ti_Kurz"
Sub Nacti_Kurz()
    ActiveWorkbook.FollowHyperlink Address:="https://www.cnb.cz/cs/financni-trhy/devizovy-trh/kurzy-devizoveho-trhu/kurzy-devizoveho-trhu/", _
    NewWindow:=True
End Sub
Sub Nacti_Kurz_z_Netu()
  Dim datum As Date
  Dim mena As String
  
  datum = Range(ActiveSheet.CodeName & "_kDatum").Value
  mena = Range(ActiveSheet.CodeName & "_kMena").Text
  Range(ActiveSheet.CodeName & "_kKurz") = ZjistiKurzCNB(datum, mena)
End Sub
Sub Nacti_Kurz_SDR()
  Dim datum As Date
  Dim mena As String
  
  datum = Range(ActiveSheet.CodeName & "_sDatum").Value
  mena = Range(ActiveSheet.CodeName & "_sMena").Value
  Range(ActiveSheet.CodeName & "_sKurz") = ZjistiKurzCNB(datum, mena)
End Sub
Sub Nacti_Kurz_Dop_Lim()
  Dim datum As Date
  Dim mena As String
  
  datum = Range(ActiveSheet.CodeName & "_lDatum").Value
  mena = Range(ActiveSheet.CodeName & "_lMena").Value
  Range(ActiveSheet.CodeName & "_lKurz") = ZjistiKurzCNB(datum, mena)
End Sub
Sub Nacti_Kurz_Dop()
  Dim datum As Date
  Dim mena As String
  
  datum = Range(ActiveSheet.CodeName & "_pDatum").Value
  mena = Range(ActiveSheet.CodeName & "_pMena").Value
  Range(ActiveSheet.CodeName & "_pKurz") = ZjistiKurzCNB(datum, mena)
End Sub

Function ZjistiKurzCNB(datum As Date, mena As String)
  Dim radek As Integer
  Dim sloupec As Integer
  Dim radek_meny As Integer

  Application.ScreenUpdating = False

  'Otev|fffd|i pomocn|fffd| se|fffd|it
  Set wbk = Workbooks.Add
  Set wsh = wbk.Sheets(1)
  With wsh
    On Error Resume Next
    'Na|fffd|ti data z internetu
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;https://www.cnb.cz/cs/financni-trhy/devizovy-trh/kurzy-devizoveho-trhu/kurzy-devizoveho-trhu/rok.txt?rok=" & Year(datum) _
        , Destination:=Range("A1"))
        .Name = "KL"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With

    If err.Number <> 0 Then
       wbk.Close (False)
       Application.ScreenUpdating = True
       ZjistiKurzCNB = 0
       MsgBox "Nelze zjistit kurz z webu |fffd|NB" & vbCrLf & "Chyba: " & err.Description
       Exit Function
    End If
    On Error GoTo 0

    'Rozho|fffd| na|fffd|ten|fffd| data do sloupc|fffd|
    .Columns("A:A").TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="|", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, _
        1), Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12 _
        , 1), Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), _
        Array(19, 1), Array(20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), Array( _
        25, 1), Array(26, 1), Array(27, 1), Array(28, 1), Array(29, 1), Array(30, 1), Array(31, 1), _
        Array(32, 1), Array(33, 1), Array(34, 1), Array(35, 1), Array(36, 1)), _
        TrailingMinusNumbers:=True

    radek = 0
    sloupec = 0
    radek_meny = 0

    'Vyhledej Datum v prvn|fffd|m sloupci
    Set C = .UsedRange.Columns(1).Find(datum, LookIn:=xlValues)
    If Not C Is Nothing Then
      radek = C.Row
    Else
      Set C = .UsedRange.Columns(1).Find(Format(datum, "dd.mm.yyyy"), LookIn:=xlValues)
      If Not C Is Nothing Then radek = C.Row
    End If

    'Vyhledej |fffd||fffd|dek s m|fffd|nami
    If radek > 0 Then
        Set C = .UsedRange.Columns(1).Find("Datum", LookIn:=xlValues)
        If Not C Is Nothing Then
            firstAddress = C.Address
            Do
                If radek_meny < C.Row And C.Row < radek Then radek_meny = C.Row
                Set C = .UsedRange.Columns(1).FindNext(C)
            Loop While Not C Is Nothing And C.Address <> firstAddress
        End If
    
        'Vyhledej M|fffd|nu v nalezen|fffd|m |fffd||fffd|dku m|fffd|n
        Set C = .UsedRange.Rows(radek_meny).Find(mena, LookIn:=xlValues, LookAt:=xlPart)
        If Not C Is Nothing Then sloupec = C.Column
    End If

    'Kurz je v pr|fffd|se|fffd||fffd|ku Data a m|fffd|ny
    If radek * sloupec > 0 Then
      ZjistiKurzCNB = .Cells(radek, sloupec).Value
    Else
      ZjistiKurzCNB = 1 'Pokud Datum nebo M|fffd|na nenalezena, vra|fffd| 1
    End If
  End With

  'Uzav|fffd|i pomocn|fffd| se|fffd|it
  wbk.Close (False)
  Application.ScreenUpdating = True
End Function

Attribute VB_Name = "Na|fffd|ti_TiaDat"
Option Explicit

Const cTiaDat = "C:\TiaVypoc\TIA.dat"
Dim tsi As Object
Dim s As String
Dim r As Integer
Dim vPojisteny As String, vUlice As String, vPoskozeny As String, vTypPP As String
Dim vMesto As String, vPoskRC As String, vPoskAdr As String, vLikvKod As String, vMisto As String, vPolic As String
Dim vVozidlo As String, vVIN As String, vSPZ As String, vPPPU As String, vDm As String
Dim vOBcena As String, vSpoluucast As String, vPU As String, vDatumPU As String, vLikvidator As String
Dim vSml As String, vPojAdr As String, vProdRad As String, vTypSpl As String, vPojKryt As String
Dim vPojStart As String, vPojEnd As String, vLimitPoj As String, vUzemi1 As String, vUzemi As String
Dim vSpolu|fffd||fffd|astPro As String, vTym As String, jmList As String, rok As Integer, vZADOLilv As String
Dim vProdukt As String, vPojistovna As String, vSpoluucast_GP
Dim list
Sub LimityPOV()
    vUzemi = "Zelen|fffd| karta"
    If XMLRead("<RiskVariant>") <> "" Then vPojKryt = vPojKryt + ", " + XMLRead("<RiskVariant>")
    If XMLRead("<HealthLimit>") <> "" Then vLimitPoj = Val(Replace(Mid(XMLRead("<HealthLimit>"), 4), ".", "")) Else vLimitPoj = "" ' MRO
         
    'vLimitPoj = "100.000.000"
    'If XMLRead("<RiskVariant>") = "Standard" Then
     '   vLimitPoj = "40.000.000"
    'End If
    vSpoluucast = "0"
End Sub
Sub NactiTiaDat()
    XMLInic
    
    Dim p, acs
    Dim spol As String
    Dim riskno As String

    vPojisteny = "": vUlice = "": vMesto = "": vLikvKod = ""
    vVozidlo = "": vVIN = "": vSPZ = "": vPPPU = "": vOBcena = ""
    vSpoluucast = "": vPU = "": vDatumPU = "": vLikvidator = "": vPojAdr = "":
    vSml = "": vTym = "": vPoskRC = "": vPoskAdr = "": vTypPP = "": vDm = "": vPoskozeny = "":
    vProdRad = "": vPolic = "": vTypSpl = "": vPojKryt = "":
    vPojStart = "": vPojEnd = "": vLimitPoj = "": vSpoluucast = "0": vUzemi1 = "": vUzemi = "":
    vSpolu|fffd||fffd|astPro = "0": vProdukt = "": vMisto = """": vPojistovna = "": vSpoluucast_GP = ""
    strSubj = ""
    
      vPU = XMLRead("<ClaCaseNo>")
      
      vPPPU = XMLRead("<ClaSubcase><ClaSubCaseNo>")
      vDatumPU = XMLRead("<ClaEvent><IncidentDate>")
      If vDatumPU <> "" Then
        vDatumPU = Format(CDate(Trim(Left(vDatumPU, InStr(vDatumPU, ":") - 3))), "dd.mm.yyyy")
      End If
      vLikvidator = XMLRead("<ClaSubcase><UserName>")
      If vLikvidator <> "" Then
        On Error Resume Next
        vLikvidator = Trim(Left(vLikvidator, InStr(vLikvidator, "(") - 1))
        If err.Number <> 0 Then Trim (vLikvidator)
        On Error GoTo 0
      End If
      vLikvKod = XMLRead("<ClaSubcase><Handler>")
      vTym = XMLRead("<ClaSubcase><DeptNo>")
      vTypPP = XMLRead("<SubCaseType>")
      vSml = XMLRead("<LegacyPolicyNo>") 'PS |fffd||fffd|slo z ext. syst|fffd|m|fffd| (Golem |fffd|P / VIAS GLI) nen|fffd|-li pr|fffd|zdn|fffd|, tak m|fffd| p|fffd|ednost p|fffd|ed <PolicyNo>
      If Len(vSml) = 0 Then vSml = XMLRead("<PolicyNo>")
      vProdRad = XMLRead("<ProductLineId>")
      vPoskRC = Trim(XMLRead("<ClaSubcase><ThirdParty><Name><CivilRegCode>"))
      If XMLRead("<ClaSubcase><ThirdParty><Name><SurName>") = "" Then
          vPoskAdr = XMLRead("<ClaSubcase><ThirdParty><Description>")
      Else
          vPoskAdr = Trim(XMLRead("<ClaSubcase><ThirdParty><Name><ForeName>") + " " + XMLRead("<ClaSubcase><ThirdParty><Name><SurName>")) + ", " + XMLRead("<ClaSubcase><ThirdParty><Name><Street>") + IIf(XMLRead("<ThirdParty><Name><StreetNo>", "0") <> "0", " " + XMLRead("<ThirdParty><Name><StreetNo>"), "") + ", " + XMLRead("<ClaSubcase><ThirdParty><Name><City>") + ", PS|fffd| " + XMLRead("<ClaSubcase><ThirdParty><Name><PostArea>")
      End If
      vPojAdr = Trim(XMLRead("<ClaCase><Name><ForeName>") + " " + XMLRead("<ClaCase><Name><SurName>")) + ", " + XMLRead("<ClaCase><Name><Street>") + IIf(XMLRead("<ClaCase><Name><StreetNo>", "0") <> "0", " " + XMLRead("<ClaCase><Name><StreetNo>"), "") + ", " + XMLRead("<ClaCase><Name><City>") + ", PS|fffd| " + XMLRead("<ClaCase><Name><PostArea>")
      
   vVozidlo = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><VehType>")
   vVozidlo = Trim(XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><VehMake>") + " " + vVozidlo)
   vSPZ = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><CarRegNo>")
      
      vPolic = XMLRead("<Questions#<Question>132#><Value>")
      vSpoluucast = XMLRead("<Excess>")
      vSpoluucast = Replace(vSpoluucast, ".", "")
      vSpoluucast = Replace(vSpoluucast, "K|fffd|", "")
      vSpoluucast = Replace(vSpoluucast, " ", "")
      vTypSpl = XMLRead("<ExcessType>")
      vPojKryt = XMLRead("<RiskName>")
      vPojStart = XMLRead("<CoverStartDate>")
      vPojEnd = XMLRead("<CoverEndDate>")
      vLimitPoj = XMLRead("<Limit>")
      vVIN = XMLRead("<ThirdPartyPOV><VIN>")
      vMisto = XMLRead("<ClaEvent><PlaceDesc>")
      vPojistovna = XMLRead("<Document><Company>")
      'vPojistovna = "Generali poji|fffd||fffd|ovna a.s." 'jen test
      
      If LCase(vPojistovna) Like "generali*" Then strSubj = "GP"
      If LCase(vPojistovna) Like "|fffd|esk|fffd|*" Then strSubj = "|fffd|P"
      If vPojistovna = "" Then If strSubj = "" Then zjistit_subjekt (vPU) 'zjistit vPojistovna podle |fffd||fffd|sla PU
      
      'odstran|fffd|n|fffd| minut z data
      If vPojStart <> "" Then
        vPojStart = Trim(Left(vPojStart, InStr(vPojStart, ":") - 3))
      End If
      If vPojEnd <> "" Then
        vPojEnd = Trim(Left(vPojEnd, InStr(vPojEnd, ":") - 3))
      End If
      
      ' Rozd|fffd|len|fffd| podm|fffd|nek dle produkrov|fffd|ch |fffd|ad ODP, POV
      Select Case vProdRad
      
      '*****ODP*****
        Case "APODO" 'Dopravci APIS
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Dopravci"
        Case "APZRA" 'pracovn|fffd| |fffd|razy a nemoci z povol|fffd|n|fffd|-z|fffd|konn|fffd| poji|fffd|t|fffd|n|fffd|
            vPojAdr = XMLRead("<Relation#<RelationDescription>Zam|fffd|stnavatel#><Name><SurName>") + ", " + XMLRead("<Relation#<RelationDescription>Zam|fffd|stnavatel#><Name><Street>") + " " + XMLRead("<Relation#<RelationDescription>Zam|fffd|stnavatel#><Name><StreetNo>") + ", " + XMLRead("<Relation#<RelationDescription>Zam|fffd|stnavatel#><Name><City>") + ", " + XMLRead("<Relation#<RelationDescription>Zam|fffd|stnavatel#><Name><PostArea>")
            vSpoluucast = "0"
            vSpolu|fffd||fffd|astPro = "0"
            vTypSpl = ""
            vPojKryt = "Z|fffd|konn|fffd| poji|fffd|t|fffd|n|fffd| pracovn|fffd|ho |fffd|razu a nemoci z povol|fffd|n|fffd|"
            vPojStart = "1.1.1993"
            vPojEnd = ""
            vLimitPoj = "bez limitu"
            vUzemi = "Cel|fffd| sv|fffd|t"
            vTypSpl = "-"
            vSml = "Z|fffd|konn|fffd| poji|fffd|t|fffd|n|fffd|"
            vProdukt = "Z|fffd|konn|fffd| poji|fffd|t|fffd|n|fffd|"
        Case "AZODP" 'zem|fffd|d|fffd|lci
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vUzemi = "|fffd|esk|fffd| republika"
            vProdukt = "Zem|fffd|d|fffd|lsk|fffd| poji|fffd|t|fffd|n|fffd|"
        Case "DPO02" 'Pr|fffd|mysl MR TIA   MRO 122092019
             vPojKryt = XMLRead("<ProductLineIdDescription>") & ";  " & XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><RiskName>") & "; " & XMLRead("<ShortName>")
             If XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Limit>") = "jin|fffd|" Or XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Limit>") = "Jin|fffd|" Then
                vLimitPoj = Replace(XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Specification>"), ".", "")
             Else
                vLimitPoj = Replace(XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Limit>"), ".", "")
             End If
             vProdukt = "Mal|fffd| rizika"
             vUzemi = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Range>")
             vSpoluucast = Replace(XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Excess>"), ".", "")
'        Case "DPO02" 'Pr|fffd|mysl MR TIA - p|fffd|vodn|fffd|
'            vLimitPoj = XMLRead("<Limit>")
'            vUzemi = XMLRead("<Range>")
'            vProdukt = "Mal|fffd| rizika"
        Case "DPOA3" 'Pr|fffd|mysl MR TIA
            vLimitPoj = XMLRead("<SumInsured>")
            vUzemi1 = XMLRead("<Objects>")
            vProdukt = "Mal|fffd| rizika"
            Select Case vUzemi1
                Case "D08000"
                    vUzemi = "|fffd|esk|fffd| republika"
                Case "D08V70"
                    vUzemi = "|fffd|esk|fffd| republika"
                Case "D08V72"
                    vUzemi = "|fffd|esk|fffd| republika"
                Case "D08V73"
                    vUzemi = "|fffd|esk|fffd| republika"
                Case "D08V97"
                    vUzemi = "|fffd|esk|fffd| republika"
                Case "D09000"
                    vUzemi = "Evropa"
            End Select
        Case "DOBK3" 'Ob|fffd|an TIA
            Select Case vTypPP
                Case "ODZ"
                    vLimitPoj = "2000000"
                Case "ODV"
                    vLimitPoj = "1000000"
                Case "ODF"
                    vLimitPoj = "500000"
            End Select
            vUzemi = XMLRead("<Range>")
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = "0"
        Case "DOPK3" 'V|fffd|kon povol|fffd|n|fffd| TIA
            vLimitPoj = XMLRead("<LimitSpec>")
            vUzemi = XMLRead("<Region>")
            vSpoluucast = "0"
            vSpolu|fffd||fffd|astPro = "1/3"
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
        Case "DOP01" 'V|fffd|kon povol|fffd|n|fffd| TIA
            vLimitPoj = XMLRead("<LimitSpec>")
            vUzemi = XMLRead("<Range>")
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
            If InStr(vSpoluucast, "%") Then
                vSpoluucast = "0"
                vSpolu|fffd||fffd|astPro = XMLRead("<Excess>")
                vSpolu|fffd||fffd|astPro = Trim(Left(vSpolu|fffd||fffd|astPro, InStr(vSpolu|fffd||fffd|astPro, "%") - 1))
            End If
        Case "DOPH1", "OHK01", "OHI01" 'V|fffd|kon povol|fffd|n|fffd| TIA - RSO 2017-09-18, RSO 2018-10-12, RSO 2018-11-12
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
            vLimitPoj = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Limit>")
            vUzemi = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Range>")
            vSpoluucast = Replace(XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Excess>"), " ", "")
            If InStr(vSpoluucast, "%") > 0 Or InStr(vSpoluucast, "/") > 0 Then
                vSpolu|fffd||fffd|astPro = Replace(Left(vSpoluucast, 3), "%", "")
                vSpoluucast = Split(vSpoluucast & ".", ".")(1)
            End If
            vSpoluucast = Replace(vSpoluucast, "K|fffd|", "")
        Case "DOB01" 'Ob|fffd|an TIA
            vUzemi = XMLRead("<Region>")
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = XMLRead("<Excess>")
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            vLimitPoj = "Z: " + XMLRead("<HealtLimitSpec>") + ", V: " + XMLRead("<ThingLimitSpec>") + " F: " + XMLRead("<FinancialLimitSpec>")
        Case "DOBH1" 'Ob|fffd|an TIA
            riskno = XMLRead("<ClaCase><RiskNo>")
            vUzemi = XMLRead("<Risk[RiskNo = '" & riskno & "']><Range>")
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = XMLRead("<Excess>")
            vPojKryt = XMLRead("<Risk[RiskNo = '" & riskno & "']><RiskName>")
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            vLimitPoj = XMLRead("<Risk[RiskNo = '" & riskno & "']><Limit>")
        Case "VOL01" 'Ob|fffd|an TIA
            vUzemi = "Evropa"
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = "0"
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            Select Case vTypPP
                Case "ODZ"
                    vLimitPoj = "2000000"
                Case "ODV"
                    vLimitPoj = "1000000"
                Case "ODF"
                    vLimitPoj = "500000"
            End Select
        Case "DOSK3" 'Ob|fffd|an
            vUzemi = "|fffd|esk|fffd| republika"
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = "0"
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            Select Case vTypPP
                Case "ODZ"
                    vLimitPoj = "2000000"
                Case "ODV"
                    vLimitPoj = "1000000"
                Case "ODF"
                    vLimitPoj = "500000"
            End Select
        Case "DOK01" 'Kolektivn|fffd| v|fffd|kon povol|fffd|n|fffd|, poji|fffd|t|fffd|n|fffd| v 3. stran|fffd| |fffd|k|fffd|dce
            vPojAdr = XMLRead("<ThirdParty#<ThirdPartyType>|fffd|K|fffd|#><Name><ForeName>") + " " + XMLRead("<ThirdParty><Name><SurName>") + ", " + XMLRead("<ThirdParty><Name><Street>") + " " + XMLRead("<ThirdParty><Name><StreetNo>") + ", " + XMLRead("<ThirdParty><Name><City>") + ", PS|fffd| " + XMLRead("<ThirdParty><Name><PostArea>")
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vUzemi = "Sv|fffd|t"
            vSpolu|fffd||fffd|astPro = ""
            vSpoluucast = "0"
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
            vLimitPoj = XMLRead("<Risk><Limit>")
        Case "VOZ01" 'ob|fffd|an v|fffd|kon povol|fffd|n|fffd|
            vUzemi = "Sv|fffd|t"
            vSpolu|fffd||fffd|astPro = XMLRead("<Excess>")
            vSpolu|fffd||fffd|astPro = Replace(vSpolu|fffd||fffd|astPro, "%", "")
            vSpoluucast = "0"
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
            vLimitPoj = XMLRead("<Risk><Limit>")
        Case "DPR01" 'Podnikatel profesn|fffd|
            vUzemi = XMLRead("<Range>")
            vSpolu|fffd||fffd|astPro = Trim(Left(XMLRead("<Excess>"), 2))
            vPojKryt = vPojKryt + ", " + XMLRead("<RiskType>")
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "DOL01" 'Poj.odp.za |fffd|kodu ob|fffd|.-stand.
            vUzemi = "|fffd|esk|fffd| republika"
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = "0"
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
            Select Case vTypPP
                Case "ODZ"
                    vLimitPoj = "2000000"
                Case "ODV"
                    vLimitPoj = "1000000"
                Case "ODF"
                    vLimitPoj = "500000"
            End Select
        Case "CJI01", "COI01", "COIH1", "CHI01", "EXOTI" ' Cestovn|fffd| poji|fffd|t|fffd|n|fffd| ' MRO
            vUzemi = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Range>")
            vProdukt = XMLRead("<ProductLineIdDescription>")
        Case "DPRA2" 'Nemocnice MR
            vPojKryt = XMLRead("<LegacyProductCode>") + ", " + XMLRead("<LegacyProductCodeDescription>")
            vLimitPoj = XMLRead("<SumInsured>")
            vUzemi = "|fffd|esk|fffd| republika"
            vProdukt = "Mal|fffd| rizika nemocnice"
        Case "DPVS1" 'profesn|fffd|
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "DPVS2" 'profesn|fffd|
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "DPVS3" 'profesn|fffd|
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "DPVS4" 'profesn|fffd|
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "DPV01", "DPV02", "DPV03", "DPV04", "DPV05", "DPOG2", "DPDG3" 'VR upraveno MRO 15022019
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Velk|fffd| rizika"
                       
        Case "PVD01" 'Dopravci 15022019 MRO
             vProdukt = "Dopravci"
             vLimitPoj = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Limit>")
             vUzemi = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Region>") & "; " & XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><RegionSpec>")
             vPojKryt = XMLRead("<ProductLineIdDescription>") & ";  " & XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><RiskName>") & "; " & XMLRead("<ShortName>")
             If XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Excess>") <> "Jin|fffd|" Then
               vSpoluucast = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Excess>")
               vSpoluucast = Replace(Replace(Mid(vSpoluucast, InStr(vSpoluucast, "min.") + 5), " ", ""), ",-K|fffd|", "")
               vSpolu|fffd||fffd|astPro = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><Excess>")
               If vSpolu|fffd||fffd|astPro <> "" Then vSpolu|fffd||fffd|astPro = (Left(vSpolu|fffd||fffd|astPro, InStr(vSpolu|fffd||fffd|astPro, "min.") - 4)) Else vSpolu|fffd||fffd|astPro = ""
             Else
               vSpoluucast = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><ExcessSpec>")
               vSpoluucast = Replace(Replace(Mid(vSpoluucast, InStr(vSpoluucast, "min.") + 5), " ", ""), ",-K|fffd|", "")
               vSpolu|fffd||fffd|astPro = XMLRead("<Object><Risk[RiskNo = //ClaCase/RiskNo]><ExcessSpec>")
               If vSpolu|fffd||fffd|astPro <> "" Then vSpolu|fffd||fffd|astPro = (Left(vSpolu|fffd||fffd|astPro, InStr(vSpolu|fffd||fffd|astPro, "min.") - 4)) Else vSpolu|fffd||fffd|astPro = ""
            End If
'        Case "DPD01" 'Dopravci
'            vLimitPoj = XMLRead("<Limit>")
'            vUzemi = XMLRead("<Region>")
'            vPojKryt = XMLRead("<ProductLineIdDescription>")
'            If XMLRead("<Excess>") <> "Jin|fffd|" And XMLRead("<Excess>") <> "jin|fffd|" Then
'               vSpoluucast = Mid(XMLRead("<Excess>"), InStr(XMLRead("<Excess>"), "n.") + 2, InStr(XMLRead("<Excess>"), ",-") - InStr(vSpoluucast, "n.") - 2)
'               vSpolu|fffd||fffd|astPro = Trim(Left(XMLRead("<Excess>"), InStr(XMLRead("<Excess>"), "min.") - 4))
'            End If
'            vTypSpl = XMLRead("<ExcessCode>")
'            vProdukt = "Dopravci"
'            If InStr(XMLRead("<Limit>"), "K|fffd|") Then
'                vLimitPoj = Replace(vLimitPoj, "K|fffd|", "")
'            End If
'            If InStr(XMLRead("<Limit>"), "mil.") Then
'                vLimitPoj = Replace(vLimitPoj, " mil.", "000000")
'            End If
        Case "DPD01", "PDD01" 'Dopravci 15022019 MRO
             vProdukt = "Dopravci"
             vLimitPoj = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Limit>")
             If vProdRad <> "PDD01" Then
              vUzemi = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Region>")
             Else
              vUzemi = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Range>")
             End If
             vPojKryt = XMLRead("<ProductLineIdDescription>") & ";  " & XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><RiskName>") & "; " & XMLRead("<ShortName>")
            
            spol = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><Excess>")
            If spol = "jin|fffd|" Or spol = "Jin|fffd|" Or spol = "Jin|fffd|" Then spol = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><ExcessSpec>")
            If InStr(spol, "%") = 0 Then
                vSpoluucast = Replace(Replace(Replace(Replace(spol, " ", ""), ",-", ""), "K|fffd|", ""), "CZK", "")
                vSpolu|fffd||fffd|astPro = ""
            Else
                vSpoluucast = Replace(Replace(Replace(Replace(Mid(spol, InStr(spol, "min.") + 5), " ", ""), ",-", ""), "K|fffd|", ""), "CZK", "")
                vSpolu|fffd||fffd|astPro = Val(Left(spol, 2))
            End If
            vTypSpl = XMLRead("<Object[SeqNo = //ClaCase/ObjectSeqNo]><Risk[RiskNo = //ClaCase/RiskNo]><ExcessCode>")
        Case "DSO01" 'St|fffd|edn|fffd| riziko pr|fffd|mysl nestahuje se Spl, Lim
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vProdukt = "St|fffd|edn|fffd| rizika"
        Case "PRODP" 'P|fffd|ipoji|fffd|t|fffd|n|fffd| 965 ob|fffd|an
            vPojKryt = "P|fffd|ipoji|fffd|t|fffd|n|fffd| odpov|fffd|dnosti v b|fffd|n|fffd|m ob|fffd|ansk|fffd|m |fffd|ivot|fffd| " + XMLRead("<LegacyProductCode>")
            vUzemi = "Evropa"
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
        Case "PVZ01" 'Zasilatel
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vProdukt = "Zasilatel"
        Case "JAK01" 'Jednor|fffd|zov|fffd| akce
            vPojKryt = XMLRead("<Object#<RiskNo>14#><RiskName>")
            vLimitPoj = XMLRead("<Object#<RiskNo>14#><Limit>")
            vUzemi = XMLRead("<Object#<RiskNo>14#><Region>")
            vProdukt = "Jednor|fffd|zov|fffd| akce"
        Case "DPRA3" 'profesn|fffd|
            vLimitPoj = XMLRead("<SumInsured>")
            vUzemi = "|fffd|esk|fffd| republika"
            vProdukt = "Profesn|fffd| odpov|fffd|dnost"
        Case "OPPOS" 'Podnikatel 601
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vProdukt = "Podnikatel 601"
        Case "APPOS" 'Podnikatel MR
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vProdukt = "Mal|fffd| rizika"
        Case "AOLD1" 'PNM 4 Dru|fffd|stva
            vPojKryt = XMLRead("<LegacyProductCodeDescription>")
            vPojStart = vPojEnd
            vProdukt = "Dru|fffd|stva"
        Case "DOMK3" 'Myslivost
            vUzemi = "|fffd|esk|fffd| republika"
            vProdukt = "Myslivost"
        Case "DPDA3" 'Dopravce
            vSpolu|fffd||fffd|astPro = "10"
            vLimitPoj = XMLRead("<SumInsured>")
            vUzemi = Trim(Left(XMLRead("<Objects>"), 3))
            If vUzemi = "D03" Then
                vUzemi = "|fffd|esk|fffd| republika"
                Else
                vUzemi = "Mezin|fffd|rodn|fffd| p|fffd|eprava"
            End If
            vProdukt = "Dopravce"
        Case "OOBEZ" 'Ob|fffd|an KOS
            vUzemi = "|fffd|esk|fffd| republika"
            vSpolu|fffd||fffd|astPro = "0"
            vSpoluucast = "0"
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            Select Case vTypPP
                Case "ODZ"
                    vLimitPoj = "2000000"
                Case "ODV"
                    vLimitPoj = "1000000"
                Case "ODF"
                    vLimitPoj = "500000"
            End Select
            vProdukt = "B|fffd|n|fffd| ob|fffd|ansk|fffd| |fffd|ivot"
        Case "OVZPO" 'V|fffd|kon povol|fffd|n|fffd| KOS
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vUzemi = "|fffd|esk|fffd| republika"
            vSpolu|fffd||fffd|astPro = "1/3"
            vSpoluucast = "0"
            vLimitPoj = ""
            vProdukt = "V|fffd|kon povol|fffd|n|fffd|"
        Case "OZVIR" 'Vlastnictv|fffd| zv|fffd||fffd|ete
            vPojKryt = XMLRead("<ProductLineIdDescription>")
            vProdukt = "Vlastnictv|fffd| zv|fffd||fffd|ete"
        Case "" '
            
        '*****POV*****
        
        Case "ABP01" '
            LimityPOV
            vProdukt = "POV"
         Case "ADP01" ' MRO
            LimityPOV
            vProdukt = "POV"
        Case "AEP01" '
            LimityPOV
            vProdukt = "POV"
        Case "AFP01" '
            LimityPOV
            vProdukt = "POV"
        Case "AGP01" '
            LimityPOV
            vProdukt = "POV"
        Case "AHP01" ' MRO
            LimityPOV
            vProdukt = "POV"
        Case "AKP01" '
            LimityPOV
            vProdukt = "POV"
        Case "ALP01" '
            LimityPOV
            vProdukt = "POV"
        Case "ANP01" ' MRO
            LimityPOV
            vProdukt = "POV"
        Case "POVGZ" ' MRO
            'LimityPOV
            vUzemi = "Zelen|fffd| karta"
            vProdukt = "POV"
            vSpoluucast = "0"
        Case "ASP01" '
            LimityPOV
            vProdukt = "POV"
        Case "ASPK3" '
            LimityPOV
            vProdukt = "POV"
        Case "ATP01" '
            LimityPOV
            vProdukt = "POV"
        Case "POVRU" '
            LimityPOV
            If vPojKryt = ", " Then
                vPojKryt = XMLRead("<LegacyProductCodeDescription>") + ", " + XMLRead("<RiskVariant>")
                'vSml = XMLRead("<LegacyPolicyNo>")
            End If
            vProdukt = "POV"
        Case Else
            vSpoluucast_GP = vSpoluucast
            vSpoluucast = vbNullString
      End Select
    
      If vPolic = "" Then
      vPolic = "Ne|fffd|et|fffd|eno"
      End If
      
      
      If Benefit_Spoluucast Then
        vTypSpl = "Benefit Nulov|fffd| spolu|fffd||fffd|ast"
        vSpoluucast = 0
        vSpolu|fffd||fffd|astPro = 0
      End If
      
      
      
    On Error GoTo 0
    
    Application.ScreenUpdating = False
    'Application.EnableEvents = False
    
   Set acs = ActiveSheet
    
    With ThisWorkbook
        For Each list In .Sheets
            
            jmList = list.CodeName
        If list.Visible Then
            With list
                '.Activate
                
                Select Case jmList
                'ListX = V|fffd|c - Opot|fffd|eben|fffd| GP, V|fffd|c - Opot|fffd|eben|fffd| |fffd|P, ZSU_pom_Tabulky, Seznam polo|fffd|ek, Datov|fffd| list, Datov|fffd| list ODP
                Case "List1", "List2", "List3", "List4", "List5", "List6", "List7", "List9", "List32", "|fffd|NB_sazby", "THV_Data", "THV_Data1", "Znehodnocen|fffd|_Data", "V|fffd|kaz_v|fffd|m|fffd|r", "Polo|fffd|ky_NS", "CORN", "|fffd|vodn|fffd|_list"
                    
                Case Else
                    If Application.ScreenUpdating = True Then Application.ScreenUpdating = False
                    'Application.ScreenUpdating = True
                    If .ProtectContents = True Then p = 1 Else p = 0
                    If p = 1 Then
                        .Unprotect ("0309")
                        acs.Select
                    End If
                    
                    If existuje_li_range_nazev(jmList + "_Likv") = True Then .Range(jmList + "_Likv").FormulaR1C1 = vLikvidator
                    If existuje_li_range_nazev(jmList + "_Tym") = True Then .Range(jmList + "_Tym").FormulaR1C1 = vTym
                    If existuje_li_range_nazev(jmList + "_LKod") = True Then .Range(jmList + "_LKod").FormulaR1C1 = vLikvKod
                    If existuje_li_range_nazev(jmList + "_TypPP") = True Then .Range(jmList + "_TypPP").FormulaR1C1 = vTypPP
                    If existuje_li_range_nazev(jmList + "_Sml") = True Then .Range(jmList + "_Sml").FormulaR1C1 = vSml
                    If existuje_li_range_nazev(jmList + "_PojKryt") = True Then .Range(jmList + "_PojKryt").FormulaR1C1 = vPojKryt
                    If existuje_li_range_nazev(jmList + "_ProdRad") = True Then .Range(jmList + "_ProdRad").FormulaR1C1 = vProdRad
                    If existuje_li_range_nazev(jmList + "_PojStart") = True Then .Range(jmList + "_PojStart").FormulaR1C1 = vPojStart
                    If existuje_li_range_nazev(jmList + "_PojEnd") = True Then .Range(jmList + "_PojEnd").FormulaR1C1 = vPojEnd
                    If existuje_li_range_nazev(jmList + "_LimitPoj") = True Then .Range(jmList + "_LimitPoj").FormulaR1C1 = vLimitPoj
                    If existuje_li_range_nazev(jmList + "_Produkt") = True Then .Range(jmList + "_Produkt").FormulaR1C1 = vProdukt
                    If existuje_li_range_nazev(jmList + "_Uzemi") = True Then .Range(jmList + "_Uzemi").FormulaR1C1 = vUzemi
                    If existuje_li_range_nazev(jmList + "_TypSpl") = True Then .Range(jmList + "_TypSpl").FormulaR1C1 = vTypSpl
                    If existuje_li_range_nazev(jmList + "_Splu_PC") = True Then .Range(jmList + "_Splu_PC").FormulaR1C1 = vSpoluucast
                    If existuje_li_range_nazev(jmList + "_Splu_Pro") = True Then .Range(jmList + "_Splu_Pro").FormulaR1C1 = vSpolu|fffd||fffd|astPro
                    If existuje_li_range_nazev(jmList + "_VIN") = True Then .Range(jmList + "_VIN").FormulaR1C1 = vVIN
                    If existuje_li_range_nazev(jmList + "_Misto") = True Then .Range(jmList + "_Misto").FormulaR1C1 = vMisto
                    If existuje_li_range_nazev(jmList + "_Polic") = True Then .Range(jmList + "_Polic").FormulaR1C1 = vPolic
                    If existuje_li_range_nazev(jmList + "_Dat_PU") = True Then .Range(jmList + "_Dat_PU").FormulaR1C1 = vDatumPU
                    If existuje_li_range_nazev(jmList + "_Pos") = True Then .Range(jmList + "_Pos").FormulaR1C1 = vPoskAdr
                    If existuje_li_range_nazev(jmList + "_RC") = True Then
                        Application.EnableEvents = False
                        .Range(jmList + "_RC").FormulaR1C1 = validace_RC(vPoskRC)
                        If .Range(jmList + "_RC").FormulaR1C1 <> vbNullString Then
                            If existuje_li_range_nazev(jmList + "_Dat_narozeni_POS") = True Then
                                .Range(jmList + "_Dat_narozeni_POS").FormulaR1C1 = Format(datum_narozeni_z_RC(.Range(jmList + "_RC").FormulaR1C1), "dd.mm.yyyy")
                            End If
                        End If
                        Application.EnableEvents = True
                    End If
                    
                    If existuje_li_range_nazev(jmList + "_Poj") = True Then .Range(jmList + "_Poj").FormulaR1C1 = vPojAdr
                    
                    If existuje_li_range_nazev(jmList + "_PodPripad") = True Then .Range(jmList + "_PodPripad").FormulaR1C1 = vPPPU
                    If existuje_li_range_nazev(jmList + "_Pripad") = True Then .Range(jmList + "_Pripad").FormulaR1C1 = vPU
                    
                    If existuje_li_range_nazev(jmList + "_kDatum") = True Then .Range(jmList + "_kDatum").FormulaR1C1 = vDatumPU
                    If existuje_li_range_nazev(jmList + "_sDatum") = True Then .Range(jmList + "_sDatum").FormulaR1C1 = vDatumPU
                    If existuje_li_range_nazev(jmList + "_pDatum") = True Then .Range(jmList + "_pDatum").FormulaR1C1 = vDatumPU
                    If existuje_li_range_nazev(jmList + "_lDatum") = True Then .Range(jmList + "_lDatum").FormulaR1C1 = vDatumPU
                    
                    If existuje_li_range_nazev(jmList + "_POS_Vozidlo") = True Then .Range(jmList + "_POS_Vozidlo").FormulaR1C1 = vVozidlo
                    If existuje_li_range_nazev(jmList + "_POS_SPZ") = True Then .Range(jmList + "_POS_SPZ").FormulaR1C1 = vSPZ
                    If existuje_li_range_nazev(jmList + "_POS_Voz_SPZ") = True Then
                    .Range(jmList + "_POS_Voz_SPZ").FormulaR1C1 = IIf(Len(vVozidlo) > 0, vVozidlo, "") & IIf(Len(vVozidlo) > 0 And Len(vSPZ) > 0, " / ", "") & IIf(Len(vSPZ) > 0, vSPZ, "")
                    End If
                    
                    If existuje_li_range_nazev(jmList + "_KDO") = True Then
                        If NewFirma Then
                          .Range(jmList + "_KDO").FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
                        ElseIf strSubj = "|fffd|P" Then
                          .Range(jmList + "_KDO").FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
                        ElseIf strSubj = "GP" Then
                          .Range(jmList + "_KDO").FormulaR1C1 = "Generali poji|fffd||fffd|ovna a.s."
                        End If
                    End If
                    
                    
                    'If existuje_li_shape_nazev(list.Name, "Logo_GLI") = True Then .Shapes("Logo_GLI").Name = "Logo_GP"
                    If NewFirma Then
                          If existuje_li_shape_nazev(list.Name, "Logo_CP") = True Then .Shapes("Logo_CP").Visible = False
                          If existuje_li_shape_nazev(list.Name, "Logo_GP") = True Then .Shapes("Logo_GP").Visible = False
                          If existuje_li_shape_nazev(list.Name, "Logo_GCP") = True Then .Shapes("Logo_GCP").Visible = True
                    ElseIf strSubj = "|fffd|P" Then
                          If existuje_li_shape_nazev(list.Name, "Logo_CP") = True Then .Shapes("Logo_CP").Visible = True
                          If existuje_li_shape_nazev(list.Name, "Logo_GP") = True Then .Shapes("Logo_GP").Visible = False
                          If existuje_li_shape_nazev(list.Name, "Logo_GCP") = True Then .Shapes("Logo_GCP").Visible = False
                    ElseIf strSubj = "GP" Then
                          If existuje_li_shape_nazev(list.Name, "Logo_CP") = True Then .Shapes("Logo_CP").Visible = False
                          If existuje_li_shape_nazev(list.Name, "Logo_GP") = True Then .Shapes("Logo_GP").Visible = True
                          If existuje_li_shape_nazev(list.Name, "Logo_GCP") = True Then .Shapes("Logo_GCP").Visible = False
                    End If
                    If existuje_li_shape_nazev(list.Name, "Btn2") = True Then .Shapes("Btn2").Visible = True      'tla|fffd||fffd|tko "Ov|fffd||fffd|en|fffd| limitu pln|fffd|n|fffd|
                    
                    If p = 1 Then .Protect ("0309")
                    
                    
                    If jmList = "AUTO" Or jmList = "POVOL" Then
                      .Range(jmList + "_Svodidlo").FormulaR1C1 = "|fffd|koda na vozidle"
                    End If
                    
                    
                    
                    If jmList = "SOU" Then
                      .Range("SOU_LimitPoj").FormulaR1C1 = "1"
                      .Range("SOU_Sml").FormulaR1C1 = XMLRead("<LegacyPolicyNo>")
                    End If
                    
                    If jmList = "SKOL" Then
                      .Range("SKOL_Uspora").FormulaR1C1 = "0"
                    End If
                    
                    If jmList = "POVOL" Then
                      .Range("POVOL_DOBA_OD").FormulaR1C1 = "1.1.2000"
                      .Range("POVOL_DOBA_DO").FormulaR1C1 = vDatumPU
                    End If
                    
                    If jmList = "AZA" Then
                      .Range("AZA_LimitPoj").FormulaR1C1 = "1"
                      .Range("AZA_Sml").FormulaR1C1 = XMLRead("<LegacyPolicyNo>")
                      If vPoskAdr = "" Then
                        vPoskAdr = " - "
                        .Range(jmList + "_Pos").FormulaR1C1 = vPoskAdr
                      End If
                    End If
                
                    Select Case jmList
                    '6x Zdrav|fffd| obecn|fffd|, 2x Zdrav|fffd| da|fffd|
                    Case "Mov_POR", "AUTO_POR", "ZSU", "DAN", "VYJE", "UMRT", "BOL", "Nem_POR"
                        .Range(jmList + "_Likv").FormulaR1C1 = vLikvidator
                        .Range(jmList + "_Tym").FormulaR1C1 = vTym
                        .Range(jmList + "_LKod").FormulaR1C1 = vLikvKod
                        .Range(jmList + "_TypPP").FormulaR1C1 = vTypPP
                        .Range(jmList + "_Dat_PU").FormulaR1C1 = vDatumPU
                        .Range(jmList + "_Poj").FormulaR1C1 = vPojAdr
                        .Range(jmList + "_Pos").FormulaR1C1 = vPoskAdr
                        .Range(jmList + "_PodPripad").FormulaR1C1 = vPPPU
                        .Range(jmList + "_Pripad").FormulaR1C1 = vPU
                        .Range(jmList + "_ProdRad").FormulaR1C1 = vProdRad
                    Case Else
                    End Select
                
                End Select
            End With
        End If
        Next list

        If List1.Visible = True Or List2.Visible = True Then
            If strSubj = "GP" Then List1.Visible = True Else List1.Visible = False
            If strSubj = "|fffd|P" Then List2.Visible = True Else List2.Visible = False
        End If
    
    End With
    
    'Application.EnableEvents = True
    Application.ScreenUpdating = True
    'Nacti_XMLView
End Sub
Attribute VB_Name = "Nem_POR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim ZakladnaN

Private Sub Worksheet_Change(ByVal Target As Range)
Dim target_nova_hodnota, wb As Workbook, wb_nazev, wb_posledni_radek, wb_oblast, wb_nenalezeno, _
polozka_nadpis, C, n, _
target_row, max_row, pocet_polozek, nalezeno_radku, nedostatek_radku

With ThisWorkbook.Worksheets("Nem_POR")
    If Target.Row < 12 Or Target.Row > 161 Then Exit Sub
    
    If Not (Intersect(Target, .Range("KodyEC_POR")) Is Nothing) Then
        
        If Target(1).Value = "" Then GoTo radek_wb_change_konec
        
        Application.EnableEvents = False
        target_nova_hodnota = Target.Value          'pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
        Application.Undo
        Target.Value = Trim(target_nova_hodnota)    'odstran|fffd|n|fffd| p|fffd|ebyte|fffd|n|fffd|ch mezer
        Application.EnableEvents = True
        
        If Not IsNumeric(Left(Target(1).Value, 1)) Then
            wb_nenalezeno = 1
            GoTo radek_wb_change_konec
        End If
                      
        Application.ScreenUpdating = False
        max_row = .Range("KodyEC_POR").Rows.Count
        pocet_polozek = max_row - WorksheetFunction.CountIf(.Range("KodyEC_POR"), "*") + 1
        nedostatek_radku = 0
        wb_nenalezeno = 0
        ZakladnaN = "": wb_nazev = ""
        
        'definice v modulu Vyber_Listu viz Public Const NEM_cenik_polozek_cesta
        'PthD = "d:\Data\JS\TIA\_vypocet_plneni_ODP\maj_ciselniky\"
        PthD = NEM_cenik_polozek_cesta
        
        ZakladnaN = Left(.Range("Nem_POR_Cenik").Text, 1) & Right(.Range("Nem_POR_Cenik").Text, 4)
        wb_nazev = Dir(PthD & "Polo|fffd|ky" & ZakladnaN & ".xls*")
        
        'z|fffd|stal-li n|fffd|hodou z p|fffd|ech|fffd|zej|fffd|c|fffd|ho zpracov|fffd|n|fffd| soubor otev|fffd|en|fffd|, tak zav|fffd||fffd|t soubor
        If sesit_je_otevren(wb_nazev) = True Then Workbooks(wb_nazev).Close (False)
            
        On Error Resume Next
        Set wb = Workbooks.Open(PthD & wb_nazev, , True)
        If err.Number <> 0 Then
            MsgBox "Soubor s polo|fffd|kami cen|fffd|ku je nedostupn|fffd|." & vbLf & vbLf & _
                "Cesta k souboru: " & PthD & vbLf & _
                "N|fffd|zev souboru: " & wb_nazev & vbLf & vbLf & _
                "Bu|fffd| soubor neexistuje nebo bude probl|fffd|m se s|fffd|ov|fffd|mi disky. Kontaktujte helpdesk.", vbCritical + vbOKOnly, "NELZE NA|fffd||fffd|ST POLO|fffd|KY CEN|fffd|KU"
            Target.Select
            GoTo radek_wb_change_konec
        End If
        On Error GoTo 0
          
        .Activate

        nalezeno_radku = 0
          
        If Val(Right(ZakladnaN, 4)) >= 2015 Then
            If Target.Offset(0, 0) = "" Then GoTo radek_wb_change_konec
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "A").End(xlUp).Row
            wb_oblast = "A4:A" & wb_posledni_radek
            
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                nalezeno_radku = WorksheetFunction.CountIf(wb.Worksheets(1).Range(wb_oblast), Target.Value & "*")
                    
                If nalezeno_radku > pocet_polozek Then
                    nedostatek_radku = 1
                    GoTo radek_wb_change_konec
                End If
                    
                Application.EnableEvents = False
                For n = 0 To (nalezeno_radku - 1)
                    target_row = Target.Offset(n, 0).Row
                    Target.Offset(n, -3) = Target.Offset(n, -3).Row - 11    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                        
                    If .Rows(target_row & ":" & target_row).Hidden = True Then
                        Pridej_Nem_POR_radek
                    End If
                        
                    With Target.Offset(n, -2)                           'polo|fffd|ka - n|fffd|zev
                        .Value = C.Offset(n, 2).Value
                        If Mid(.Value, 2, 1) = UCase(Mid(.Value, 2, 1)) Then polozka_nadpis = 1 Else polozka_nadpis = 0
                    End With
                       
                    If polozka_nadpis = 0 Then
                        Target.Offset(n, 1) = C.Offset(n, 3).Value      'polo|fffd|ka - MJ
                        If C.Offset(n, 5).Value > 0 Then
                            'Target.Offset(n, 2) = 1                     'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = C.Offset(n, 5).Value  'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = "1"                   'polo|fffd|ka - DPH
                        Else
                            Target.Offset(n, 2) = ""                    'polo|fffd|ka - mno|fffd|stv|fffd|
                            Target.Offset(n, 3) = ""                    'polo|fffd|ka - cena za jednotku
                            Target.Offset(n, 4) = ""                    'polo|fffd|ka - DPH
                        End If
                    Else
                        Target.Offset(n, 4) = ""                        'polo|fffd|ka - DPH
                    End If
                        
                    .Unprotect ("0309")
                    With Target.Offset(n, 0)                            'polo|fffd|ka - k|fffd|d
                        .Value = C.Offset(n, 1).Value
                        .Font.Bold = False
                        .Font.ColorIndex = 0
                        If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Mid(.Value, 6, 1) = "s") Then
                            .Font.Bold = True
                            .Font.ColorIndex = 3
                        End If
                    End With
                Next n
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
    
        Else
            
            wb_posledni_radek = wb.Worksheets(1).Cells(wb.Worksheets(1).Rows.Count, "D").End(xlUp).Row
            wb_oblast = "D3:D" & wb_posledni_radek
            
            If Mid(Target.Value, 5, 1) = "-" Then
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Else
                Set C = wb.Worksheets(1).Range(wb_oblast).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            End If
            
            If Not C Is Nothing Then
                Application.EnableEvents = False
                Target.Offset(0, 1) = C.Offset(0, 1).Value              'polo|fffd|ka - MJ
                'Target.Offset(0, 2) = c.Offset(0, 2).Value             'polo|fffd|ka - mno|fffd|stv|fffd|
                Target.Offset(0, 3) = C.Offset(0, 3).Value              'polo|fffd|ka - cena za jednotku
                    
                Target.Offset(0, -2).Value = C.Offset(0, -2).Value      'polo|fffd|ka - n|fffd|zev
                Target.Offset(0, -3) = Target.Offset(n, -3).Row - 11    'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
                Target.Offset(0, 4) = "1"                               'polo|fffd|ka - DPH
                
                .Unprotect ("0309")
                With Target.Offset(0, 0)
                    .Value = C.Offset(0, 0).Value
                    .Font.Bold = False
                    .Font.ColorIndex = 0
                    If (Not IsNumeric(Mid(.Value, 4, 1)) And Mid(.Value, 4, 1) = UCase(Mid(.Value, 4, 1))) Or (Right(.Value, 1) = "m") Then
                        .Font.Bold = True
                        .Font.ColorIndex = 3
                    End If
                End With
                Application.EnableEvents = True
                Target.Offset(0, -2).Select
            Else
                wb_nenalezeno = 1
            End If
        End If
              
radek_wb_change_konec:
        If sesit_je_otevren(wb_nazev) = True Then wb.Close (False)
        
        Set C = Nothing
        Set wb = Nothing
        
        If wb_nenalezeno = 1 Then
            Application.EnableEvents = False
            Target.Offset(0, 1) = ""                                            'polo|fffd|ka - MJ
            Target.Offset(0, 2) = ""                                            'polo|fffd|ka - mno|fffd|stv|fffd|
            Target.Offset(0, 3) = ""                                            'polo|fffd|ka - cena za jednotku
            Target.Offset(0, -2).Value = ""                                     'polo|fffd|ka - n|fffd|zev
            Target.Offset(0, -3) = Target.Offset(n, -3).Row - 11                'polo|fffd|ka - po|fffd|adov|fffd| |fffd||fffd|slo
            Target.Offset(0, 4) = "1"                                           'polo|fffd|ka - DPH
            Application.EnableEvents = True
            Application.ScreenUpdating = True
            Target.Select
            Application.ScreenUpdating = False
            MsgBox "Polo|fffd|ka nebyla ve zvolen|fffd|m cen|fffd|ku polo|fffd|ek nalezena." & vbLf & vbLf & _
                "K|fffd|d polo|fffd|ky: " & Target.Value & vbLf & _
                "Cen|fffd|k polo|fffd|ek: " & .Range("NEM_POR_Cenik").Text & vbLf & vbLf & _
                "Zkontroluj:  1) zad|fffd|n|fffd| polo|fffd|ky" & vbLf & _
                "                   2) vybran|fffd| cen|fffd|k" & vbLf & vbLf & _
                "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbCritical + vbOKOnly, "POLO|fffd|KA CEN|fffd|KU NENNALEZENA"
        End If
        
        If nedostatek_radku = 1 Then
            MsgBox "Polo|fffd|ka se skl|fffd|d|fffd| z v|fffd|ce polo|fffd|ek (|fffd||fffd|dk|fffd|) ne|fffd| je mo|fffd|n|fffd| aktu|fffd|ln|fffd| do v|fffd|po|fffd|tu vlo|fffd|it." & vbLf & vbLf & _
            "Nalezeno |fffd||fffd|dk|fffd|: " & nalezeno_radku & vbLf & _
            "Mo|fffd|no vlo|fffd|it |fffd||fffd|dk|fffd|: " & pocet_polozek & vbLf & _
            "Nedost|fffd|v|fffd| se |fffd||fffd|dk|fffd|: " & nalezeno_radku - pocet_polozek & vbLf & vbLf & _
            "Do v|fffd|po|fffd|tu nebyla p|fffd|id|fffd|na |fffd||fffd|dn|fffd| polo|fffd|ka." & vbLf & vbLf & _
            "Vkl|fffd|d|fffd|n|fffd| polo|fffd|ek bude ukon|fffd|eno.", vbExclamation + vbOKOnly, "NEDOSTATEK POU|fffd|ITELN|fffd|CH |fffd||fffd|DK|fffd|"
        End If
        
        'Application.EnableEvents = True     'jen pro jistotu
        Application.ScreenUpdating = True
    
    End If
    .Protect ("0309")
End With
End Sub


Function sesit_je_otevren(nazev_xls)
Dim wbk As Workbook
sesit_je_otevren = False 'dosadit defaultn|fffd| hodnotu
For Each wbk In Workbooks
If wbk.Name = nazev_xls Then
    sesit_je_otevren = True
End If
Next
End Function


Sub nNEM_POR()
Application.ScreenUpdating = True
Application.EnableEvents = True
ThisWorkbook.Unprotect ("0309")
ThisWorkbook.Worksheets("Nemovitosti").Unprotect ("0309")
End Sub

Attribute VB_Name = "OBEC"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "PENAL"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "POVOL"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
' Zmeni pismena na velka v bu|fffd|ce VIN
' a zaroven omezi na prvni pismeno v pripade vlozeni vice
If Not Application.Intersect(Target, Range("Povol_VIN")) Is Nothing Then
If Target.Column = 4 Then
  If Target.Row = 25 Then
    Application.EnableEvents = False
    Target.Value = UCase(Target.Text)
    Application.EnableEvents = True
  End If
End If
End If
End Sub
Attribute VB_Name = "Pen|fffd|le"
Sub Penale_1_obdobi()
Attribute Penale_1_obdobi.VB_Description = "Makro zaznamenan|fffd| 15.5.2006, jvincenc"
Attribute Penale_1_obdobi.VB_ProcData.VB_Invoke_Func = " \n14"

    Range("E3").Select
    Selection.Copy
    Range("E5").Select
    ActiveSheet.Paste
    Sheets("Datov|fffd| list-THV").Select
    Range("D35:D36").Select
    Sheets("Datov|fffd| list").Select
    Range("D12").Select
    Sheets("Sazby |fffd|NB").Select
    Range("E3").Select
    Application.CutCopyMode = False
    Range("E5").Select
    Sheets("V|fffd|po|fffd|et pen|fffd|le POV").Select
    Range("H11").Select
    ActiveWindow.SmallScroll Down:=-6
    Range("H11").Select
    ActiveSheet.Shapes("Option Button 8").Select
    Range("H6").Select
    ActiveSheet.Shapes("Option Button 8").Select
    With Selection
        .Value = xlOff
        .LinkedCell = ""
        .Display3DShading = False
    End With
    ActiveSheet.Shapes("Option Button 9").Select
    ActiveSheet.Shapes("Option Button 8").Select
    With Selection
        .Value = xlOff
        .LinkedCell = ""
        .Display3DShading = False
    End With
    ActiveSheet.Shapes("Option Button 9").Select
    With Selection
        .Value = xlOff
        .LinkedCell = ""
        .Display3DShading = False
    End With
    ActiveSheet.Shapes("Option Button 8").Select
    Selection.Delete
    ActiveSheet.Shapes("Option Button 9").Select
    Selection.Delete
    ActiveSheet.OptionButtons.Add(388.5, 119.25, 80.25, 17.25).Select
    ActiveSheet.Shapes("Option Button 10").Select
    Selection.Characters.Text = ""
    Range("H9").Select
    ActiveSheet.Shapes("Option Button 10").Select
    Selection.Copy
    Range("B5:G5").Select
    ActiveSheet.OptionButtons.Add(388.5, 119.25, 80.25, 17.25).Select
    ActiveSheet.Paste
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 0.75
    Selection.ShapeRange.IncrementLeft 399#
    Selection.ShapeRange.IncrementTop -18#
    Sheets("Sazby |fffd|NB").Select
    Selection.ClearContents
    Range("E6").Select
    Selection.ClearContents
    Sheets("V|fffd|po|fffd|et pen|fffd|le POV").Select
    ActiveWindow.SmallScroll Down:=0
    ActiveSheet.Shapes("Option Button 11").Select
    Sheets("Datov|fffd| list").Select
    Range("D12").Select
    Sheets("V|fffd|po|fffd|et pen|fffd|le POV").Select
    Range("H11").Select
    Sheets("Sazby |fffd|NB").Select
    Range("E5").Select
    ActiveCell.FormulaR1C1 = "100000"
    Range("E6").Select
    ActiveCell.FormulaR1C1 = "100000"
    Range("E5:E6").Select
    Selection.NumberFormat = "0.00"
    Range("G19").Select
    Application.WindowState = xlMinimized
    Sheets("V|fffd|po|fffd|et pen|fffd|le POV").Select
    Range("M19").Select
    ActiveWindow.SmallScroll Down:=-2
    ChDir _
        "C:\Documents and Settings\jvincenc\Plocha\Adres|fffd||fffd| Dokumenty\V|fffd|PO|20d||fffd|K\Projekt V|fffd|po|fffd||fffd|k\Fin|fffd|ln|fffd| projekt"
    ActiveWorkbook.SaveAs FileName:= _
        "C:\Documents and Settings\jvincenc\Plocha\Adres|fffd||fffd| Dokumenty\V|fffd|PO|20d||fffd|K\Projekt V|fffd|po|fffd||fffd|k\Fin|fffd|ln|fffd| projekt\Projekt-V|fffd|po|fffd|et pln|fffd|n|fffd|-v308.xls" _
        , FileFormat:=xlNormal, Password:="", WriteResPassword:="", _
        ReadOnlyRecommended:=False, CreateBackup:=False
End Sub
Attribute VB_Name = "Polo|fffd|ky_NS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "P|fffd|j|fffd|ovn|fffd|"
Sub Pujcovne()
If Not Worksheets("V|fffd|po|fffd|et POV").Visible Then
      MsgBox "Nelze vlo|fffd|it do V|fffd|po|fffd|tu POV, likvidujete PU z HAV...."
      Exit Sub
    End If

    Application.ScreenUpdating = False
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("I25").FormulaR1C1 = "='V|fffd|po|fffd|et p|fffd|j|fffd|ovn|fffd|ho'!R22C8"
    Range("B27:H27").Select
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vypocet_pujcovne()
    Application.ScreenUpdating = False
    With Sheets("V|fffd|po|fffd|et p|fffd|j|fffd|ovn|fffd|ho")
      .Range("C2:F3,I2:I3,B6:I7,B14:I18,I24").ClearContents
      .Range("C9").FormulaR1C1 = "0"
      .Range("C24").FormulaR1C1 = "=TODAY()"
      If ActiveSheet.Name = "V|fffd|po|fffd|et p|fffd|j|fffd|ovn|fffd|ho" Then .Range("C2").Select
    End With
    Application.ScreenUpdating = True
End Sub
Sub Pujcovne_special()
If Not Worksheets("V|fffd|po|fffd|et POV").Visible Then
      MsgBox "Nelze vlo|fffd|it do V|fffd|po|fffd|tu POV, likvidujete PU z HAV...."
      Exit Sub
    End If
    Application.ScreenUpdating = False
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("I25").FormulaR1C1 = "='P|fffd|j|fffd|ovn|fffd| speci|fffd|l'!R[40]C[-2]"
    Range("B27:H27").Select
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Pujcovne_special()
    Application.ScreenUpdating = False
    With Sheets("P|fffd|j|fffd|ovn|fffd| speci|fffd|l")
      .Range("C2:E3,G2:H3,B6:H9,B57:H61,G67:H67,L2").ClearContents
      .Range("C13,C14,C35,C45,C48").FormulaR1C1 = "0"
      .Range("C67").FormulaR1C1 = "=TODAY()"
      If ActiveSheet.Name = "P|fffd|j|fffd|ovn|fffd| speci|fffd|l" Then .Range("C2").Select
    End With
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "SHAV"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
' Zmeni pismena na velka v bu|fffd|ce VIN
' a zaroven omezi na prvni pismeno v pripade vlozeni vice
If Not Application.Intersect(Target, Range("SHAV_VIN")) Is Nothing Then
If Target.Column = 4 Then
  If Target.Row = 31 Then
    Application.EnableEvents = False
    Target.Value = UCase(Target.Text)
    Application.EnableEvents = True
  End If
End If
End If
End Sub
Attribute VB_Name = "SKOL"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SOU"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "THV"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "THV_Data"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "THV_Data1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "THV_V|fffd|po|fffd|et"
Dim List_zdroje As String
Sub Vypocitej_THV()
    Sheets("V|fffd|po|fffd|et THV").Select
    Range("I4").Select
End Sub
Sub Vloz_THV_do_VYP_POV()
Attribute Vloz_THV_do_VYP_POV.VB_Description = "Makro zaznamenan|fffd| 5.11.2005, jvincenc"
Attribute Vloz_THV_do_VYP_POV.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    With Sheets("V|fffd|po|fffd|et THV")
      .Range("K23").Copy (Sheets("V|fffd|po|fffd|et POV").Range("G29:H29"))
      .Range("I7").Copy (Sheets("V|fffd|po|fffd|et POV").Range("F28:H28"))
      .Range("I6").Copy
    End With
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("C28").PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    Range("B31:H31").Select
    Application.ScreenUpdating = True
End Sub
Sub Vloz_Korekci_dane()
Dim KorDan As String
Dim SDanC As String
Dim SDanP As String
Dim CDanC As String
Dim CDanP As String

    Application.ScreenUpdating = False
    Sheets("P|fffd|epo|fffd|et dan|fffd|").Select
    SDanC = Range("B100").Value
    SDanP = Range("H52").Value
    CDanC = Range("I31").Value
    CDanP = Range("I52").Value
    KorDan = Range("I55").Value
    
    Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Select
    
    Range("k26").FormulaR1C1 = "0"
    Range("k27").FormulaR1C1 = "0"
    
    If (CDanP < CDanC) And (SDanP = 0) Then
      Range("k27").FormulaR1C1 = KorDan
      Else
      If (CDanP < CDanC) And (SDanP <> 0) Then
        Range("k26").FormulaR1C1 = SDanP
       Else
        Range("k26").FormulaR1C1 = SDanC
      End If
    End If
    If SDanP <> KorDan And SDanP > 0 Then
      Range("k27").FormulaR1C1 = KorDan - SDanP
    End If
    If KorDan <= 0 And SDanP <> 0 Then
      Range("k26").FormulaR1C1 = SDanC
    End If
    If SDanP = 0 And CDanP = 0 Then
      Range("k26").FormulaR1C1 = SDanC
    End If
    Sheets("P|fffd|epo|fffd|et dan|fffd|").Select
    Range("c38").Select
    Application.ScreenUpdating = True
End Sub
Sub Vloz_THV_do_VYP_ODP()
    Application.ScreenUpdating = False
    List_zdroje = ""
    List_zdroje = ActiveSheet.CodeName
    With Sheets("V|fffd|po|fffd|et THV")
      .Range("K23").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("F43").PasteSpecial Paste:=xlPasteValues
      Sheets("AUTO").Range("F47").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto_POR").Range("F22").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto Spolu|fffd||fffd|ast").Range("F44").PasteSpecial Paste:=xlPasteValues
      .Range("I7").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("F42").PasteSpecial Paste:=xlPasteValues
      Sheets("AUTO").Range("F46").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto_POR").Range("F21").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto Spolu|fffd||fffd|ast").Range("F43").PasteSpecial Paste:=xlPasteValues
      .Range("I6").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("C42").PasteSpecial Paste:=xlPasteValues
      Sheets("AUTO").Range("C46").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto_POR").Range("C21").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto Spolu|fffd||fffd|ast").Range("C43").PasteSpecial Paste:=xlPasteValues
    End With
    Sheets("V|fffd|po|fffd|et THV").Select
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub
Sub Vloz_THV_do_VYP_ODP_DRUHE()
    Application.ScreenUpdating = False
    List_zdroje = ""
    List_zdroje = ActiveSheet.CodeName
    With Sheets("V|fffd|po|fffd|et THV")
      .Range("K23").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("B132").PasteSpecial Paste:=xlPasteValues
      .Range("I4").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("C69").PasteSpecial Paste:=xlPasteValues
      .Range("I7").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("F69").PasteSpecial Paste:=xlPasteValues
      .Range("I6").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("B133").PasteSpecial Paste:=xlPasteValues
      .Range("C71").Copy
      Sheets("AUTA V|fffd|KON POVOL.").Range("F161").PasteSpecial Paste:=xlPasteValues
      .Range("C72").Copy
      ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
      Sheets("AUTA V|fffd|KON POVOL.").Select
      Range("F68:H68").PasteSpecial Paste:=xlPasteValues
    End With
    Sheets("V|fffd|po|fffd|et THV").Select
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub
Sub Vloz_THP_do_VYP_ODP()
    Application.ScreenUpdating = False
    If Range("c9") = "Vyber kategorii vozidla" Then
      MsgBox "Vyber kategorii vozidla"
      Exit Sub
    End If
    If Range("c10") = "Vyber druh pneumatiky" Then
      MsgBox "Vyber druh pneumatiky"
      Exit Sub
    End If
    With Sheets("Pneu TH")
      .Range("A100").Copy
      'Sheets("AUTA V|fffd|KON POVOL.").Range("C47").PasteSpecial Paste:=xlPasteValues
      Sheets("AUTA V|fffd|KON POVOL.").Range("C52").PasteSpecial Paste:=xlPasteValues
      Sheets("AUTO").Range("C53").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto_POR").Range("C28").PasteSpecial Paste:=xlPasteValues
      Sheets("Auto Spolu|fffd||fffd|ast").Range("C50").PasteSpecial Paste:=xlPasteValues
    End With
    Sheets("Pneu TH").Select
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub
Sub Vloz_BOL_do_VYP_ODP()
    Application.ScreenUpdating = False
    List_zdroje = ""
    List_zdroje = ActiveSheet.CodeName
    With Sheets("Bolestn|fffd|")
      .Range("S32").Copy '|fffd||fffd|stka bolestn|fffd|
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_BOLNOZ").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_BOLNOZ").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_BOLNOZ").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_BOLNOZ").PasteSpecial Paste:=xlPasteValues
      .Range("AM33").Copy 'Celkov|fffd| nav|fffd||fffd|en|fffd|
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_BOLZVY").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_BOLZVY").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_BOLZVY").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_BOLZVY").PasteSpecial Paste:=xlPasteValues
      .Range("AT32").Copy 'Nav|fffd||fffd|en|fffd| doktorem
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_BOL_Nav_Dr").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_BOL_Nav_Dr").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_BOL_Nav_Dr").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_BOL_Nav_Dr").PasteSpecial Paste:=xlPasteValues
      .Range("AU32").Copy 'Nav|fffd||fffd|en|fffd| likvid|fffd|torem procento
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_BOL_Nav_Lik").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_BOL_Nav_Lik").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_BOL_Nav_Lik").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_BOL_Nav_Lik").PasteSpecial Paste:=xlPasteValues
      .Range("M33").Copy 'Nav|fffd||fffd|en|fffd| likvid|fffd|torem |fffd||fffd|stka
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_BOL_Nav_Cas").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_BOL_Nav_Cas").PasteSpecial Paste:=xlPasteValues   vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_BOL_Nav_Cas").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_BOL_Nav_Cas").PasteSpecial Paste:=xlPasteValues
    End With
    Sheets("Bolestn|fffd|").Select
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub
Sub Vloz_ZSU_do_VYP_ODP()
    Application.ScreenUpdating = False
    List_zdroje = ""
    List_zdroje = ActiveSheet.CodeName
    With Sheets("ZSU")
      .Range("O32").Copy
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_ZSUNOZ").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_ZSUNOZ").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_ZSUNOZ").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_ZSUNOZ").PasteSpecial Paste:=xlPasteValues
      .Range("AL32").Copy
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd|").Range("ZDR1_ZSUZVY").PasteSpecial Paste:=xlPasteValues
      'Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_ZSUZVY").PasteSpecial Paste:=xlPasteValues  vylou|fffd|il MRO
      Sheets("V|fffd|po|fffd|et |fffd|kol|fffd|ci").Range("SKOL_ZSUZVY").PasteSpecial Paste:=xlPasteValues
      Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Range("ZDR3_ZSUZVY").PasteSpecial Paste:=xlPasteValues
    End With
    Sheets("ZSU").Select
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "TH_Pneu"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "TOT"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
' Zmeni pismena na velka v bu|fffd|ce VIN
' a zaroven omezi na prvni pismeno v pripade vlozeni vice
If Not Application.Intersect(Target, Range("TOT_VIN")) Is Nothing Then
If Target.Column = 4 Then
  If Target.Row = 30 Then
    Application.EnableEvents = False
    Target.Value = UCase(Target.Text)
    Application.EnableEvents = True
  End If
End If
End If
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
    Dim pom_posl_list
    'MsgBox posl_list
    
    With ThisWorkbook
        Application.DisplayAlerts = False
        Sheets("|fffd|vodn|fffd| list").EnableSelection = 1
        Application.DisplayAlerts = True
        
        If posl_list Like "List*" Then
            pom_posl_list = .Sheets(posl_list).PageSetup.LeftFooter
        Else
            pom_posl_list = posl_list
        End If
        
        'MsgBox "Open: " & pom_posl_list
        posl_list = .ActiveSheet.Name
        posl_list2 = posl_list
    End With
  
End Sub

'Private Sub Workbook_BeforeClose(Cancel As Boolean)
' Dim user As String, pocet_wb
'
'pocet_wb = Application.Workbooks.Count
'user = LCase(Environ("UserName"))
'    'If user <> "t911064" Then
'       ThisWorkbook.Saved = True
'       If pocet_wb = 1 Then Application.Quit
'    'End If
'End Sub
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    uzivatel = UCase(CreateObject("WScript.Network").UserName)
    If uzivatel <> "JVINCENC" And uzivatel <> "ROSOKOL" Then ThisWorkbook.Saved = True

    If ThisWorkbook.ReadOnly = True Then Exit Sub
    
    If ThisWorkbook.Worksheets("Datov|fffd| list").Visible = False Then
        SetAttr ThisWorkbook.FullName, vbReadOnly       'vbNormal
    End If
End Sub

Private Sub Workbook_NewSheet(ByVal sh As Object)
    Dim pom_posl_list, kontrola, pom_Btn As Shape
'    MsgBox posl_list
    kontrola = 0
    Application.ScreenUpdating = False
    With ThisWorkbook
        If posl_list Like "List*" Then
            pom_posl_list = .Sheets(posl_list).PageSetup.LeftFooter
        Else
            pom_posl_list = posl_list
        End If
        
        'MsgBox "NewSheet: " & pom_posl_list
        .ActiveSheet.Name = "List" & zjistit_prvni_volne_cislo_listu("List")
        
        If Len(pom_posl_list) > 0 Then
            If existuje_li_range_nazev(.Sheets(pom_posl_list).CodeName & "_Pripad") Then
                On Error Resume Next
                Set pom_Btn = .Sheets(pom_posl_list).Shapes("Btn1")
                On Error GoTo 0
                If Not pom_Btn Is Nothing Then
                    If Len(.Sheets(pom_posl_list).Range(.Sheets(pom_posl_list).CodeName & "_Pripad")) > 0 Then
                        vlozit_tlacitka (pom_posl_list)
                    Else
                        kontrola = 1
                    End If
                Else
                    kontrola = 1
                End If
            Else
                kontrola = 1
            End If
        Else
            kontrola = 1
        End If
    
        If kontrola = 1 Then
            Application.DisplayAlerts = False
            sh.Delete
            Application.DisplayAlerts = True
            posl_list = pom_posl_list
            .Sheets(posl_list).Activate
        Else
            posl_list = .ActiveSheet.Name
            'ActiveWindow.View = xlPageLayoutView
            ActiveWindow.ScrollWorkbookTabs Position:=xlLast
        End If
    End With
    
    Set pom_Btn = Nothing
    Application.ScreenUpdating = True
    
End Sub

Private Sub Workbook_SheetActivate(ByVal sh As Object)
    'MsgBox "SheetActivate: " & posl_list
    posl_list = ThisWorkbook.ActiveSheet.Name

End Sub

Private Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)
    privolat_tlacitka
End Sub


Attribute VB_Name = "UF_Textace"
Attribute VB_Base = "0{A0759C96-5A21-4CD1-98EF-E26BF59D200F}{183D2EEF-CC4B-4F3B-9A63-0D0EB936E2B9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim arrEvents As Collection

Private Sub CB_Kopirovat_Click()

    'Dim DataObj As New MSForms.DataObject
       
    If Me.Controls("TB_Text").Text <> "" Then
        'DataObj.SetText Me.Controls("TB_Text").Text
        'DataObj.PutInClipboard
        ClipBoard_SetData Me.Controls("TB_Text").Text
        Unload Me
    End If
End Sub

Private Sub CB_Upravit_Click()
    UF_Textace_Upr.TB_Text = Me.Controls("TB_Text").Text
    UF_Textace_Upr.Show (False)
    Unload Me
End Sub

Private Sub UserForm_Initialize()
    Dim skup As String
    Dim i As Integer
    Dim chkBox As MSForms.CheckBox
    
    
    Dim objControlEvents As ControlEvents
    Set arrEvents = New Collection
    
    Me.Caption = "Texty pro list " & ActiveSheet.Name
    
    With Range("DATA_SKUPINA")
        Set C = .Find(ActiveSheet.Name)
        If Not C Is Nothing Then
            skup = .Cells(1, C.Column - .Column + 1)
        Else
            Exit Sub
        End If
    End With
    
    index = 1
    With Range("DATA_TEXTACE")
        For i = 1 To .Rows.Count
            If InStr(.Cells(i, 1), skup) > 0 Then
                Set chkBox = Me.Controls.Add("Forms.CheckBox.1", "CheckBox_" & index)
                chkBox.Caption = .Cells(i, 2).Value
                chkBox.ControlTipText = .Cells(i, 3).Value
                chkBox.tag = .Cells(i, 4).Value & "|" & .Cells(i, 5).Value
                chkBox.Left = 12
                chkBox.Top = 36 + ((index - 1) * 20)
                chkBox.Width = 430
                If chkBox.Top > Me.Height - 30 Then Me.Height = Me.Height + 30
                
                Set objControlEvents = New ControlEvents
                Set objControlEvents.chkBoxE = chkBox
                arrEvents.Add objControlEvents
                
                index = index + 1
            End If
            DoEvents
        Next i
    End With
    
        
    Set txtBox = Me.Controls.Add("Forms.TextBox.1", "TB_Text")
    With txtBox
        .Top = chkBox.Top + chkBox.Height + 10
        .Left = 12
        .Height = 100
        .Width = Me.Width - 4 - 2 * .Left '246
        .MultiLine = True
        .ScrollBars = 2
        .Text = SeskupitCisla(Range(ActiveSheet.CodeName + "_DataDopis_CZ").Cells(1).Text) ' MRO
        If Benefit_Spoluucast Then
            .Text = .Text & vbLf & "Na Va|fffd||fffd| pojistn|fffd| smlouv|fffd| je sjedn|fffd|n Benefit Nulov|fffd| spolu|fffd||fffd|ast za beze|fffd|kodn|fffd| pr|fffd|b|fffd|h. Proto|fffd|e byla spln|fffd|na podm|fffd|nka pro poskytnut|fffd| tohoto benefitu, neode|fffd|etli jsme od pojistn|fffd|ho pln|fffd|n|fffd| spolu|fffd||fffd|ast sjednanou v pojistn|fffd| smlouv|fffd|."
        End If
        .Locked = True
        .tag = .Text
        Me.Height = .Top + .Height + 60
    End With
    
    CB_Kopirovat.Top = Me.Height - CB_Kopirovat.Height - 30
    CB_Upravit.Top = Me.Height - CB_Upravit.Height - 30
    
    Me.Controls("CheckBox_1").SetFocus
End Sub


Sub Klik()
    txt = ""
    For Each cCont In Me.Controls

        If TypeName(cCont) = "CheckBox" Then
            If cCont.Value Then
                txt1 = Split(cCont.tag & "|", "|")(0)
                txt2 = Split(cCont.tag & "|", "|")(1)
                If txt2 = "" Then txt2 = txt1
                txt = txt & IIf(txt = "", txt1, txt2) & vbLf
            End If

        End If

     Next cCont
    Me.Controls("TB_Text").Text = txt & IIf(txt <> "", vbLf, "") & Me.Controls("TB_Text").tag
End Sub

Attribute VB_Name = "UF_Textace_Upr"
Attribute VB_Base = "0{A513EAD9-500E-4BF8-BC8C-9557856B1092}{3BF857B9-17DC-43B1-8C96-899665901B3E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CB_Kopirovat_Click()
  
    'Dim DataObj As New MSForms.DataObject
        
    If Me.Controls("TB_Text").Text <> "" Then
        'DataObj.SetText Me.Controls("TB_Text").Text
        'DataObj.PutInClipboard
        ClipBoard_SetData Me.Controls("TB_Text").Text
        Unload Me
    End If
End Sub

Private Sub TB_Text_Change()
 x = 1
 poc = 0
 Do While InStr(x, Me.TB_Text, "!!!") > 0
    poc = poc + 1
    x = InStr(x, Me.TB_Text, "!!!") + 1
 Loop
 Me.LB_Param = poc
End Sub
Attribute VB_Name = "UMRT"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm_ZSU_Tabs"
Attribute VB_Base = "0{1928D8EE-1C14-4D08-BAB6-2578F940EC5B}{B8B07E12-8B17-4068-A354-92B607060B74}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm_datum_Zdr"
Attribute VB_Base = "0{B097D776-159E-4CA0-90C1-A177B062FCBB}{D5EB07B8-6B8C-4E38-93D4-289364C3391E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub CommandButton1_Click()
    With Me
        oDatumZdr = .DTPicker1.Value
        DoEvents
        If oDatumZdr >= CDate(.Label_Datum_min) And oDatumZdr <= CDate(.Label_Datum_max) Then
            With ThisWorkbook
                If ActiveSheet.Name = "Bolestn|fffd|" Then
                    ThisWorkbook.Sheets("Bolestn|fffd|").Range("BOL_Dat_Bol").Value = oDatumZdr
                ElseIf ActiveSheet.Name = "ZSU" Or ActiveSheet.Name = "ZSU dle NS" Then
                    ThisWorkbook.Sheets("ZSU").Range("ZSU_Dat_UZS").Value = oDatumZdr
                    ThisWorkbook.Sheets("ZSU dle NS").Range("ZSU_NS_Dat_UZS").Value = oDatumZdr
                End If
            End With
            DoEvents
            .Hide
            Unload Me
        End If
    End With
End Sub

Private Sub DTPicker1_Click()
    Me.DTPicker1.MinDate = IIf(Year(Me.Label_Datum_min) = Year(Me.Label_Datum_max), CDate(Me.Label_Datum_min), CDate("1.1." & Year(Me.Label_Datum_min)))
    DoEvents
End Sub

Private Sub DTPicker1_Enter()
    Me.DTPicker1.MinDate = IIf(Year(Me.Label_Datum_min) = Year(Me.Label_Datum_max), CDate(Me.Label_Datum_min), CDate("1.1." & Year(Me.Label_Datum_min)))
    DoEvents
End Sub


Private Sub DTPicker1_Change()
    With Me
        'test spodn|fffd| meze
        If .DTPicker1.Value < CDate(.Label_Datum_min) Then
           .Label_Datum_min.BackColor = &HC0C0FF    'p|fffd|i p|fffd|ekro|fffd|en|fffd| min nebo max hodnoty
        Else
           .Label_Datum_min.BackColor = &H8000000F 'v|fffd|choz|fffd|
           .DTPicker1.MinDate = CDate(.Label_Datum_min)
        End If
           
        'test horn|fffd| meze
        If .DTPicker1.Value > CDate(.Label_Datum_max) Then
           .Label_Datum_max.BackColor = &HC0C0FF    'p|fffd|i p|fffd|ekro|fffd|en|fffd| min nebo max hodnoty
        Else
           .Label_Datum_max.BackColor = &H8000000F 'v|fffd|choz|fffd|
        End If
           
    End With
    DoEvents
End Sub

Private Sub UserForm_Terminate()
    If ActiveSheet.Name = "ZSU dle NS" Then
        ActiveCell.Offset(-2, -1).Next.Select
    Else
        ActiveCell.Offset(-1, -1).Next.Select
    End If
End Sub
Attribute VB_Name = "VEC1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "VEC2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "VYJE"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Vlo|fffd|_Ztr|fffd|tu_na_V|fffd|d|fffd|lku"
Sub Vloz_do_VYP_na_zdravi()
Attribute Vloz_do_VYP_na_zdravi.VB_Description = "Makro zaznamenan|fffd| 16.3.2007, JVincenc"
Attribute Vloz_do_VYP_na_zdravi.VB_ProcData.VB_Invoke_Func = " \n14"
Dim A

    Application.ScreenUpdating = False
    Range("E66").Select
    Selection.Copy
    Sheets("V|fffd|po|fffd|et na ZDRAV|fffd|").Select
    Range("M34").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
    Sheets("V|fffd|po|fffd|et na Zdrav|fffd| Zahr").Select
    Range("M36").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
    '|fffd|prava MRO v|fffd|b|fffd|r, zda vkl|fffd|dat i do v|fffd|po|fffd|tu s dan|fffd| - po vlo|fffd|en|fffd| se toti|fffd| spou|fffd||fffd| procedura pro sr|fffd|kovou da|fffd|
    
    A = MsgBox("Chcete vlo|fffd|it v|fffd|sledek i do listu V|fffd|po|fffd|et na Zdrav|fffd|Da|fffd|?", vbYesNo + vbQuestion, "V |fffd| B |fffd| R  L I S T U")
        If A = 7 Then
          Sheets("V|fffd|po|fffd|et Ztr|fffd|ta na v|fffd|d|fffd|lku").Select
          Range("E66").Select
          Application.CutCopyMode = False
          Sheets("V|fffd|po|fffd|et na ZDRAV|fffd|").Select
          Range("M34").Select
                
         ElseIf A = 6 Then
           
          Sheets("V|fffd|po|fffd|et na ZDRAV|fffd| da|fffd|").Select
          Range("G31").Select
          Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
          :=False, Transpose:=False
       End If
   Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Vyber_Listu"
Public Const NEM_cenik_polozek_cesta = "\\Sfs01\Dokumenty\SSL\Likvidace\Majetek\ODPOV|fffd|DNOST\Star|fffd| verze datab|fffd|zov|fffd|ch polo|fffd|ek\"
'Public Const NEM_cenik_polozek_cesta = "d:\Data\JS\TIA\_vypocet_plneni_ODP\maj_ciselniky\"     'pro testovac|fffd| |fffd||fffd|ely
Public Const BOL_ciselnik_OZ_konec_radek = 952
Public Const BOL_ciselnik_NOZ_konec_radek = 981
Public Const ZSU_ciselnik_konec_radek = 1276

Sub VyberList()
  Dim DatovyList As String
  Dim Odvetvi As String
  Dim prot As Boolean
  
  DatovyList = "Datov|fffd| list"
  Odvetvi = "ListyZDR"
  prot = ActiveWorkbook.ProtectStructure
  
  If TypeName(Application.Caller) = "String" Then
    Select Case Application.Caller
    Case "tl_ZDR"
      Odvetvi = "ListyZDR"
    Case "tl_MOV"
      Odvetvi = "ListyMOV"
    Case "tl_NEM"
      Odvetvi = "ListyNEM"
    Case "tl_VYK"
      Odvetvi = "ListyVYK"
    Case "tl_ZTR"
      Odvetvi = "ListyZTR"
    Case "tl_THV"
      Odvetvi = "ListyTHV"
    Case "tl_PUJ"
      Odvetvi = "ListyPUJ"
    Case "tl_URO"
      Odvetvi = "ListyURO"
    Case "tl_ADV"
      Odvetvi = "ListyADV"
    Case "tl_Vykaz"
      Odvetvi = "ListyVykaz"
    Case "tl_ZAJ"
      Odvetvi = "ListyZAJ"
    Case "tl_OBEC"
      Odvetvi = "ListyOBEC"
    Case "tl_SOU"
      Odvetvi = "ListySOU"
    Case "tl_POR"
      Odvetvi = "ListyPOR"
    Case "tl_ZASI"
      Odvetvi = "ListyZASI"
    Case "tl_DOT"
      Odvetvi = "ListyDOT"
    Case Else
      Odvetvi = "ListyZDR"
    End Select
  End If
  
  Application.ScreenUpdating = False
  On Error Resume Next
  ActiveWorkbook.Unprotect ("0309")
  
  For Each list In Sheets
    list.Visible = list.Name = "|fffd|vodn|fffd| list"
  Next list
  
  For Each list In Sheets(DatovyList).Range(Odvetvi).Cells
    If list.Text <> "" Then
      Sheets(list.Text).Visible = True
      list.Activate
      ActiveWindow.ScrollRow = 1
      ActiveWindow.ScrollColumn = 1
    End If
  Next list

  Sheets(Sheets(DatovyList).Range(Odvetvi).Range("A1").Text).Activate
  ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
  
  On Error GoTo 0
  If prot Then ActiveWorkbook.Protect ("0309")
  Application.ScreenUpdating = True
  
End Sub



Attribute VB_Name = "Vyber_Meny"
Sub NastavMenu()
  Dim aktcell As Range
  Dim mena As String
  Dim l As Worksheet
  Dim f As Range
  
  On Error GoTo chyba
  Application.ScreenUpdating = False
  Set aktcell = ActiveCell
  ActiveSheet.Shapes(Application.Caller).Select
  mena = Range(Selection.ListFillRange).Offset(Range(Selection.LinkedCell).Value - 1, 1).Range("A1")
  For Each l In Worksheets
    For Each f In l.UsedRange.Cells
      If InStr(f.NumberFormat, """""") > 0 Then _
        f.NumberFormat = "#,##0.00"""""" " & mena & """"
    Next f
  Next l
  aktcell.Select

chyba:
  Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Vymaz_ODP"
Public ZSU_dopsani_stav, BOL_dopsani_stav
Dim polbod

Function Smaz_Vyjmenovane(JmSesit As String)
  'Worksheets("Datov|fffd| list ODP").Unprotect ("0309")
  Worksheets("Datov|fffd| list ODP").Range("A470") = 1
  Worksheets("Datov|fffd| list ODP").Range("A116") = 1
  Worksheets("Datov|fffd| list ODP").Range("A180") = 1
  Worksheets("Datov|fffd| list ODP").Range("A205") = 1
  Worksheets("Datov|fffd| list").Range("SRD_ZO").ClearContents  'MRO
  'Worksheets("Datov|fffd| list ODP").Protect ("0309")
  
  On Error Resume Next  'MRO
  Range(JmSesit + "_Likv").Select
  Selection.ClearContents
  Range(JmSesit + "_Tym").Select
  Selection.ClearContents
  Range(JmSesit + "_LKod").Select
  Selection.ClearContents
  Range(JmSesit + "_TypPP").Select
  Selection.ClearContents
  Range(JmSesit + "_Dat_Vyp").FormulaR1C1 = "=TODAY()"
  Range(JmSesit + "_PlKan").Select
  Selection.ClearContents
  Range(JmSesit + "_PlZpu").Select
  Selection.ClearContents
  Range(JmSesit + "_ZasPl").Select
  Selection.ClearContents
  Range(JmSesit + "_kDatum").Select
  Selection.ClearContents
  Range(JmSesit + "_kKurz").Select
  ActiveCell.FormulaR1C1 = "1"
  Range(JmSesit + "_kMena").Select
  ActiveCell.FormulaR1C1 = "K|fffd|"
  Range(JmSesit + "_Pos_Pro").Select
  ActiveCell.FormulaR1C1 = "0"
  Range(JmSesit + "_MZDA").Select ' MRO
  Selection.ClearContents
  On Error GoTo 0   'MRO
    
  If JmSesit = "ZDR1" Or JmSesit = "ZDR2" Or JmSesit = "ZDR3" Or JmSesit = "SKOL" Then
        Worksheets("Datov|fffd| list ODP").Range("A180") = 1
    Else
        Range(JmSesit + "_Svodidlo").FormulaR1C1 = "????"
    End If
  If JmSesit = "Auto" Or JmSesit = "POVOL" Or JmSesit = "TOT" Or JmSesit = "SHAV" Then
        Range(JmSesit + "_Svodidlo").FormulaR1C1 = ""
    End If
  Range(JmSesit + "_VIN").Select
  Selection.ClearContents
  Range(JmSesit + "_Uspora").Select
  Selection.ClearContents
  
  If JmSesit <> "OBEC" Then
    Range(JmSesit + "_BolZvy").Select
    Selection.ClearContents
    Range(JmSesit + "_Bol_Nav_Dr").Select
    Selection.ClearContents
    Range(JmSesit + "_Bol_Nav_Lik").Select
    Selection.ClearContents
    Range(JmSesit + "_Bol_Nav_Cas").Select
    Selection.ClearContents
    Range(JmSesit + "_BOLNOZ").Select
    Selection.ClearContents
    Range(JmSesit + "_ZSUNOZ").Select
    Selection.ClearContents
  End If
  
  Range(JmSesit + "_Vydelek").Select
  Selection.ClearContents
  Range(JmSesit + "_Sml").Select
  Selection.ClearContents
  Range(JmSesit + "_PojKryt").Select
  Selection.ClearContents
  Range(JmSesit + "_Dluh").Select
  Selection.ClearContents
  Range(JmSesit + "_ProdRad").Select
  Selection.ClearContents
  Range(JmSesit + "_PojStart").Select
  Selection.ClearContents
  Range(JmSesit + "_PojEnd").Select
  Selection.ClearContents
  Range(JmSesit + "_LimitPoj").Select
  Selection.ClearContents
  Range(JmSesit + "_Produkt").Select
  Selection.ClearContents
  Range(JmSesit + "_Uzemi").Select
  Selection.ClearContents
  Range(JmSesit + "_TypSpl").Select
  Selection.ClearContents
  Range(JmSesit + "_Splu_Pro").Select
  ActiveCell.FormulaR1C1 = "0"
  Range(JmSesit + "_Splu_PC").Select
  ActiveCell.FormulaR1C1 = "0"
  Range(JmSesit + "_Splv_Pro").Select
  ActiveCell.FormulaR1C1 = "0"
  Range(JmSesit + "_LargeCell1").Select
  ActiveSheet.Unprotect ("0309")
  Selection.ClearContents
  Range(JmSesit + "_Misto").Select
  Selection.ClearContents
  Range(JmSesit + "_KcLim").Select
  ActiveCell.FormulaR1C1 = "K|fffd|"
  Range(JmSesit + "_Dat_PU").Select
  Selection.ClearContents
  Range(JmSesit + "_Pos").Select
  Selection.ClearContents
  Range(JmSesit + "_Poj").Select
  Selection.ClearContents
  Range(JmSesit + "_KDO").Select
  If NewFirma Then
    ActiveCell.FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
  Else
    ActiveCell.FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
  End If
  Range(JmSesit + "_PodPripad").Select
  Selection.ClearContents
  Range(JmSesit + "_Pripad").Select
  Selection.ClearContents
End Function
Sub Vymaz_Vyp_Zdravy_ODP()
Attribute Vymaz_Vyp_Zdravy_ODP.VB_Description = "Makro zaznamenan|fffd| 2.3.2007, JVincenc"
Attribute Vymaz_Vyp_Zdravy_ODP.VB_ProcData.VB_Invoke_Func = " \n14"
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Application.ScreenUpdating = False
    Range("B35:B37").Select
    Selection.ClearContents
    Range("C33").FormulaR1C1 = "1"
    Range("M34:M37").FormulaR1C1 = "0"
    Range("D32,D33").FormulaR1C1 = "0"
    Range("G32,G33").FormulaR1C1 = "250"
    Range("ZDR1_PosPop").Select
    Selection.ClearContents
    Range("ZDR1_PojPlac").Select
    Selection.ClearContents
    Range("D16:G16").FormulaR1C1 = "Ne"
    Range("D15:G15").FormulaR1C1 = "Ano"
    Range("D14").Select
    ActiveCell.FormulaR1C1 = "Ne"
    Range("G14").Select
    Selection.ClearContents
    Range("ZDR1_BolZvy").Select
    Selection.ClearContents
    Range("ZDR1_ZSUZvy").Select
    Selection.ClearContents
    Range("D13:G13").Select
    Selection.ClearContents
    Range("D12:G12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C8").Select
    Selection.ClearContents
    Range("H7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("ZDR1")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Zdravy_Dan_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Application.EnableEvents = False 'vypne proceduru na listu MRO
    Application.ScreenUpdating = False
    Range("B33,B34").Select
    Selection.ClearContents
    Range("M33,M34").FormulaR1C1 = "0"
    Range("G31").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("D29,D30").FormulaR1C1 = "0"
    Range("G29,G30").FormulaR1C1 = "250"
    Range("ZDR2_Pos_Pro").Select
    Selection.ClearContents
    Range("ZDR2_PojPlac").Select
    Selection.ClearContents
    'Range("ZDR2_BolZvy").Select
    'Selection.ClearContents
    'Range("ZDR2_ZSUZvy").Select
    'Selection.ClearContents
    Range("ZDR2_SolDan").Select
    Selection.ClearContents
    Range("K26:K27").Select
    Selection.ClearContents
    Range("D13").Select
    ActiveCell.FormulaR1C1 = "NE"
    Range("G13").Select
    Selection.ClearContents
    Range("D12:G12").Select
    Selection.ClearContents
    Range("H7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("C113").Select
    Selection.ClearContents
    Smaz_Vyjmenovane ("ZDR2")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.EnableEvents = True 'zapne proceduru na listu MRO
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Skol_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Application.ScreenUpdating = False
    Range("B33:B35").Select
    Selection.ClearContents
    Range("C32").FormulaR1C1 = "1"
    Range("M33:M35").FormulaR1C1 = "0"
    Range("D31,D32").FormulaR1C1 = "0"
    Range("G31,G32").FormulaR1C1 = "250"
    Range("SKOL_PosPop").Select
    Selection.ClearContents
    Range("SKOL_PojPlac").Select
    Selection.ClearContents
    Range("SKOL_BolZvy").Select
    Selection.ClearContents
    Range("SKOL_ZSUZvy").Select
    Selection.ClearContents
    Range("D16:G16").FormulaR1C1 = "Ne"
    Range("D15:G15").FormulaR1C1 = "Ano"
    Range("D14").Select
    ActiveCell.FormulaR1C1 = "Ne"
    Range("G14").Select
    Selection.ClearContents
    Range("D13:G13").Select
    Selection.ClearContents
    Range("D12:G12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C8").Select
    Selection.ClearContents
    Range("H7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("SKOL")
    Worksheets("Datov|fffd| list ODP").Range("A180") = 2
    Range("Skol_PZN").Select
    ActiveCell.FormulaR1C1 = "391 ZP odpov|fffd|dnost |fffd|koly za |fffd|kodu zp|fffd|sobenou |fffd||fffd|kovi"
    Range("C4").Select
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Prepocet_dane_ODP()
    Application.ScreenUpdating = False
    JmSesit = "DAN"
    Range(JmSesit + "_Likv").Select
    Selection.ClearContents
    Range(JmSesit + "_Tym").Select
    Selection.ClearContents
    Range(JmSesit + "_LKod").Select
    Selection.ClearContents
    Range(JmSesit + "_TypPP").Select
    Selection.ClearContents
    Range(JmSesit + "_Dat_Vyp").FormulaR1C1 = "=TODAY()"
    Range("i20").Select
    Selection.ClearContents
    Range("I8").FormulaR1C1 = "K|fffd|"
    Range("c14").FormulaR1C1 = "0"
    Range("i13").FormulaR1C1 = "0"
    Range("c10:c11").Select
    Selection.ClearContents
    Range("c10:c11").Select
    Selection.ClearContents
    Range("c7").Select
    Selection.ClearContents
    Range("c38:c50").Select
    Selection.ClearContents
    Range(JmSesit + "_Dat_PU").Select
    Selection.ClearContents
    Range(JmSesit + "_Pos").Select
    Selection.ClearContents
    Range(JmSesit + "_Poj").Select
    Selection.ClearContents
    Range(JmSesit + "_PodPripad").Select
    Selection.ClearContents
    Range(JmSesit + "_Pripad").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Zdravy_Zahr_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("B37:B39").Select
    Selection.ClearContents
    Range("K36:K39").FormulaR1C1 = "0"
    Range("M36:M38").FormulaR1C1 = "0"
    Range("D34,D35").FormulaR1C1 = "0"
    Range("G34,G35").FormulaR1C1 = "250"
    Range("ZDR3_Pos_Pro").Select
    Selection.ClearContents
    Range("ZDR3_PojPlac").Select
    Selection.ClearContents
    Range("ZDR3_BolZvy").Select
    Selection.ClearContents
    Range("ZDR3_ZSUZvy").Select
    Selection.ClearContents
    Range("D16:G16").FormulaR1C1 = "Ne"
    Range("D15:G15").FormulaR1C1 = "Ano"
    Range("D14").Select
    ActiveCell.FormulaR1C1 = "Ne"
    Range("G14").Select
    Selection.ClearContents
    Range("D13:G13").Select
    Selection.ClearContents
    Range("D12:G12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C8").Select
    Selection.ClearContents
    Range("H7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("ZDR3")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Vec1_ODP()
    Application.ScreenUpdating = False
    
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Rows("41:85").Select
    Selection.EntireRow.Hidden = False
    
    Range("C36:C85").Select
    Selection.ClearContents
    Range("G36:G85").Select
    Selection.ClearContents
    Range("S36:S85").Select
    Selection.ClearContents
    Range("H36:H85").FormulaR1C1 = "0"
    Range("I36:I85").FormulaR1C1 = "Nov|fffd| cena"
    Range("J36:J85").FormulaR1C1 = "0"
    Range("L36:L85").FormulaR1C1 = "0"
    Range("O36:O85").FormulaR1C1 = "0"
    Range("N36:N85").FormulaR1C1 = "0"
    For abc = 1 To 50
      Range("B" & abc + 35).FormulaR1C1 = abc
    Next abc
    Range("G28").Select
    Selection.ClearContents
    Range("G27").FormulaR1C1 = "0"
    Range("I27").FormulaR1C1 = "1"
    Range("VEC1_PosPop").Select
    Selection.ClearContents
    Range("VEC1_PojPlac").Select
    Selection.ClearContents
    Range("E16").FormulaR1C1 = "Ne"
    Range("E15").FormulaR1C1 = "Ano"
    Range("E14").FormulaR1C1 = "Ne"
    Range("I14").Select
    Selection.ClearContents
    Range("E13").Select
    Selection.ClearContents
    Range("E12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("D8").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("A200").FormulaR1C1 = "0"
    Worksheets("Datov|fffd| list ODP").Range("A340:a390") = 1
    Smaz_Vyjmenovane ("VEC1")
    
    Rows("41:85").Select
    Selection.EntireRow.Hidden = True
    
    rdk = 41
    For Each sh In ActiveSheet.Shapes
      If Rows(rdk).Top <= sh.Top Then
        If Rows(rdk).Top <= sh.Top And sh.Top <= Rows(rdk).Top + 45 * Rows(rdk).Height Then
          sh.Visible = False
        End If
      End If
    Next sh
 
    Range("VEC1_Pripad").Select
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    
    'ThisWorkbook.Protect ("0309")
    ThisWorkbook.ActiveSheet.Protect ("0309")
    
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Vec2_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("C36:E70").Select
    Selection.ClearContents
    Range("M36:N70").FormulaR1C1 = "0"
    Range("K36:K70").FormulaR1C1 = "0"
    Range("H36:H70").FormulaR1C1 = "Nov|fffd| cena"
    Range("F36:G70").FormulaR1C1 = "0"
    Range("I36:I70").FormulaR1C1 = "0"
    For abc = 1 To 35
      Range("B" & abc + 35).FormulaR1C1 = abc
    Next abc
    Range("F28").Select
    Selection.ClearContents
    Range("F27").FormulaR1C1 = "0"
    Range("H27").FormulaR1C1 = "1"
    Range("VEC2_PosPop").Select
    Selection.ClearContents
    Range("VEC2_PojPlac").Select
    Selection.ClearContents
    Range("D16:G16").FormulaR1C1 = "Ne"
    Range("D15:G15").FormulaR1C1 = "Ano"
    Range("D14").FormulaR1C1 = "Ne"
    Range("H14").Select
    Selection.ClearContents
    Range("D12:G13").Select
    Selection.ClearContents
    Range("D12").Select
    ActiveCell.FormulaR1C1 = "Loss occurance"
    Range("D8").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("VEC2")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    
    Application.ScreenUpdating = True

    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_OBEC_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("C43:M52").Select
    Selection.ClearContents
    Range("O59:O60").FormulaR1C1 = "0"
    Selection.ClearContents
    Range("O43:O52").FormulaR1C1 = "0"
    For abc = 1 To 10
      Range("B" & abc + 42).FormulaR1C1 = abc
    Next abc
    Range("E33:E35").Select
    Selection.ClearContents
    Range("G33:H35").FormulaR1C1 = "0"
    Range("I33:I35").FormulaR1C1 = "Nov|fffd| cena"
    Range("K33:K35").FormulaR1C1 = "0"
    Range("G28").Select
    Selection.ClearContents
    Range("G27").FormulaR1C1 = "0"
    Range("I27").FormulaR1C1 = "1"
    Range("OBEC_PosPop").Select
    Selection.ClearContents
    Range("OBEC_PojPlac").Select
    Selection.ClearContents
    Range("E16").FormulaR1C1 = "Ne"
    Range("E15").FormulaR1C1 = "Ano"
    Range("E14").FormulaR1C1 = "Ne"
    Range("I14").Select
    Selection.ClearContents
    Range("E13").Select
    Selection.ClearContents
    Range("E12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("D8").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("OBEC")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_ZASI_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("D63").FormulaR1C1 = "0"
    Range("B58:B59").Select
    Selection.ClearContents
    Range("O58").FormulaR1C1 = "0"
    Range("o59").FormulaR1C1 = "0"
    Range("ZASI_Pod_Pro").FormulaR1C1 = "0"
    Range("ZASI_Vic_Pro").FormulaR1C1 = "0"
    Range("C40:M49").Select
    Selection.ClearContents
    Range("O40:O49").FormulaR1C1 = "0"
    Range("B40").FormulaR1C1 = "1"
    Range("B41").FormulaR1C1 = "2"
    Range("B42").FormulaR1C1 = "3"
    Range("B43").FormulaR1C1 = "4"
    Range("B44").FormulaR1C1 = "5"
    Range("B45").FormulaR1C1 = "6"
    Range("B46").FormulaR1C1 = "7"
    Range("B47").FormulaR1C1 = "8"
    Range("B48").FormulaR1C1 = "9"
    Range("B49").FormulaR1C1 = "10"
    Range("E32:E34").Select
    Selection.ClearContents
    Range("G32:H34").FormulaR1C1 = "0"
    Range("I32:I34").FormulaR1C1 = "Nov|fffd| cena"
    Range("K32:K34").FormulaR1C1 = "0"
    Range("H29").Select
    Selection.ClearContents
    Range("E29").FormulaR1C1 = "????"
    Range("G27").FormulaR1C1 = "0"
    Range("G26").FormulaR1C1 = "0"
    Range("ZASI_sKurz").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("ZASI_sMena").Select
    ActiveCell.FormulaR1C1 = "XDR"
    Range("ZASI_PosPop").Select
    Selection.ClearContents
    Range("J20").Select
    Selection.ClearContents
    Range("D24").FormulaR1C1 = "Ne"
    Range("ZASI_PojPlac").Select
    Selection.ClearContents
    Range("E16").FormulaR1C1 = "Ne"
    Range("E15").FormulaR1C1 = "Ano"
    Range("E14").FormulaR1C1 = "Ne"
    Range("I14").Select
    Selection.ClearContents
    Range("E13").Select
    Selection.ClearContents
    Range("E11").Select
    ActiveCell.FormulaR1C1 = "- "
    Range("D8").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("ZASI")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Dop_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("DOP_pMena").FormulaR1C1 = "K|fffd|"
    Range("B60:B61").Select
    Selection.ClearContents
    Range("O60:O61").FormulaR1C1 = "0"
    Selection.ClearContents
    Range("I56").FormulaR1C1 = "1"
    Selection.ClearContents
    Range("O55").FormulaR1C1 = "0"
    Selection.ClearContents
    Range("G56").Select
    Selection.ClearContents
    Range("C44:M48").Select
    Selection.ClearContents
    Range("O44:O48").FormulaR1C1 = "0"
    Range("B44").FormulaR1C1 = "1"
    Range("B45").FormulaR1C1 = "2"
    Range("B46").FormulaR1C1 = "3"
    Range("B47").FormulaR1C1 = "4"
    Range("B48").FormulaR1C1 = "5"
    Range("E35:E37").Select
    Selection.ClearContents
    Range("G35:H37").FormulaR1C1 = "0"
    Range("I35:I37").FormulaR1C1 = "Nov|fffd| cena"
    Range("K35:K37").FormulaR1C1 = "0"
    Range("Dop_lDatum").Select
    Selection.ClearContents
    Range("Dop_lMena").FormulaR1C1 = "K|fffd|"
    Range("Dop_lKurz").FormulaR1C1 = "1"
    Range("Dop_sDatum").Select
    Selection.ClearContents
    Range("G27").FormulaR1C1 = "0"
    Range("Dop_sKurz").FormulaR1C1 = "1"
    Range("Dop_PosPop").Select
    Selection.ClearContents
    Range("Dop_PojPlac").Select
    Selection.ClearContents
    Range("E16").FormulaR1C1 = "Ne"
    Range("E15").FormulaR1C1 = "Ano"
    Range("E14").FormulaR1C1 = "Ne"
    Range("I14").Select
    Selection.ClearContents
    Range("E13").Select
    Selection.ClearContents
    Range("E12").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("D8").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("Dop")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Nemovitosti_ODP()
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ThisWorkbook.Unprotect ("0309")
    With ThisWorkbook.Worksheets("Nemovitosti")
        .Unprotect ("0309")
        .Rows("37:181").EntireRow.Hidden = False
        .Rows("300:400").EntireRow.Hidden = False
        .Range("E32:E181").Font.Bold = False
        .Range("E32:E181").Font.ColorIndex = 0
        .Range("C32:I181").ClearContents
        .Range("K32:K181").ClearContents
        .Range("N32:N181").ClearContents
        .Range("R32:R181").ClearContents
        For abc = 1 To 150
          .Range("B" & abc + 31).FormulaR1C1 = abc
        Next abc
        .Range("I32:I181").FormulaR1C1 = "1"
        .Range("L32:L181").FormulaR1C1 = "Nov|fffd| cena"
        .Range("NEM_Cenik").FormulaR1C1 = Range("Cenova_hladina").Cells(1)
        .Range("NEM_PosPop").Value = ""
        .Range("NEM_PojPlac").Value = ""
        .Range("D17:G17").FormulaR1C1 = "Ne"
        .Range("D16:G16").FormulaR1C1 = "Ano"
        .Range("D15").FormulaR1C1 = "Ne"
        .Range("H15:I15").ClearContents
        .Range("D14:G14").ClearContents
        .Range("D13").FormulaR1C1 = "Loss occurance"
        .Range("D8").ClearContents
        .Range("I7").FormulaR1C1 = "K|fffd|"
        'ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("b340:b390") = 1
        Smaz_Vyjmenovane ("NEM")
        
        .Rows("37:181").EntireRow.Hidden = True
        .Rows("300:400").EntireRow.Hidden = True
            
        rdk = 37
        For Each sh In .Shapes
          If Rows(rdk).Top <= sh.Top Then
            If Rows(rdk).Top <= sh.Top And sh.Top <= Rows(rdk).Top + 45 * Rows(rdk).Height Then
              sh.Visible = False
            End If
          End If
        Next sh
    
        .Range("NEM_Pripad").Select
        
        nastavit_CP (.Name)
        .Protect ("0309")
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1

End With
    
    'ThisWorkbook.Protect ("0309")
    Application.EnableEvents = True
    Range("A300").FormulaR1C1 = "0"
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Nemovitosti_komb_ODP()
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ThisWorkbook.Unprotect ("0309")
    
    With ThisWorkbook.Worksheets("Nemovitosti komb")
        .Unprotect ("0309")
        .Rows("35:59").EntireRow.Hidden = False
        .Rows("65:210").EntireRow.Hidden = False
        .Rows("300:400").EntireRow.Hidden = False
        .Range("B30:E59").ClearContents
        .Range("q30:q59").ClearContents
        .Range("K30:L59").FormulaR1C1 = "0"
        .Range("I30:I59").ClearContents
        .Range("F30:F59").FormulaR1C1 = "0"
        .Range("G30:G59").FormulaR1C1 = "Nov|fffd| cena"
        .Range("D61:D210").Font.Bold = False
        .Range("D61:D210").Font.ColorIndex = 0
        .Range("B61:H210").ClearContents
        .Range("J61:K210").ClearContents
        .Range("Q61:Q210").ClearContents
        .Range("H61:H210").FormulaR1C1 = "1"
        .Range("K61:K210").FormulaR1C1 = "Nov|fffd| cena"
        .Range("M61:M210").ClearContents
        For aa = 1 To 30
          .Range("A" & aa + 29).FormulaR1C1 = aa
        Next aa
        For bb = 31 To 180
          .Range("A" & 30 + bb).FormulaR1C1 = bb
        Next bb
        .Range("NEK_Cenik").FormulaR1C1 = Range("Cenova_hladina").Cells(1)
        .Range("NEK_PosPop").Value = ""
        .Range("NEK_PojPlac").Value = ""
        .Range("D16:G16").FormulaR1C1 = "Ne"
        .Range("D15:G15").FormulaR1C1 = "Ano"
        .Range("D14").FormulaR1C1 = "Ne"
        .Range("H14").Value = ""
        .Range("D12:G13").ClearContents
        .Range("D12").FormulaR1C1 = "Loss occurance"
        .Range("C8").ClearContents
        .Range("H7").FormulaR1C1 = "K|fffd|"
        Smaz_Vyjmenovane ("NEK")
        .Unprotect ("0309")
        .Rows("35:59").EntireRow.Hidden = True
        .Rows("66:210").EntireRow.Hidden = True
        .Rows("300:400").EntireRow.Hidden = True
        Application.EnableEvents = True
        .Range("A300:B300").FormulaR1C1 = "0"
        nastavit_CP (.Name)
        .Protect ("0309")
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1
    End With

    'ThisWorkbook.Protect ("0309")
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Nemovitosti_ODP_POR()
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    ThisWorkbook.Unprotect ("0309")
    
    With ThisWorkbook.Worksheets("Nem_POR")
        .Unprotect ("0309")
        .Rows("17:161").EntireRow.Hidden = False
        .Rows("300:400").EntireRow.Hidden = False
        .Range("NEM_POR_Likv, NEM_POR_Tym, NEM_POR_LKod, NEM_POR_TypPP").ClearContents
        .Range("NEM_POR_Cenik").FormulaR1C1 = Range("Cenova_hladina").Cells(1)
        .Range("NEM_POR_Dat_Vyp").FormulaR1C1 = "=TODAY()"
        For uu = 1 To 150
          .Range("B" & uu + 11).FormulaR1C1 = uu
        Next uu
        .Range("E12:E161").Font.Bold = False
        .Range("E12:E161").Font.ColorIndex = 0
        .Range("I12:I161").FormulaR1C1 = "1"
        .Range("L12:L161").FormulaR1C1 = "Nov|fffd| cena"
        .Range("C12:H161").ClearContents
        .Range("K12:K161, N12:N161").ClearContents
        .Range("D4, D7:D8").ClearContents
        .Range("D5:D6").Value = ""
        .Range("I7").FormulaR1C1 = "K|fffd|"
        .Range("J4").ClearContents
            
        rdk = 17
        For Each sh In .Shapes
          If Rows(rdk).Top <= sh.Top Then
            If Rows(rdk).Top <= sh.Top And sh.Top <= Rows(rdk).Top + 45 * Rows(rdk).Height Then
              sh.Visible = False
            End If
          End If
        Next sh
    
        .Rows("17:161").EntireRow.Hidden = True
        .Rows("300:400").EntireRow.Hidden = True
        
        .Range("Nem_POR_Pripad").Select
        Application.EnableEvents = True
        .Range("A300").FormulaR1C1 = "0"
        nastavit_CP (.Name)
        .Protect ("0309")
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1

    End With
    
    'ThisWorkbook.Protect ("0309")
    Application.ScreenUpdating = True

End Sub

Sub Vymaz_Vyp_Jed_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("E33").FormulaR1C1 = "0"
    Range("c41:c44").Select
    Selection.ClearContents
    Range("E34").FormulaR1C1 = "0"
    Range("E35").FormulaR1C1 = "0"
    Range("E36").FormulaR1C1 = "0"
    Range("F33:F38").FormulaR1C1 = "0"
    Range("c33:C38").FormulaR1C1 = "Nov|fffd| m|fffd|stnost"
    Range("F41:F44").FormulaR1C1 = "0"
    Range("G41:G44").FormulaR1C1 = "Nov|fffd| cena"
    Range("L41:M44").FormulaR1C1 = "0"
    Range("B33").FormulaR1C1 = "1"
    Range("B34").FormulaR1C1 = "2"
    Range("B35").FormulaR1C1 = "3"
    Range("B36").FormulaR1C1 = "4"
    Range("B39").FormulaR1C1 = "5"
    Range("B40").FormulaR1C1 = "6"
    Range("B41").FormulaR1C1 = "7"
    Range("B42").FormulaR1C1 = "8"
    Range("e41:e44").Select
    Selection.ClearContents
    Range("I41:I44").Select
    Selection.ClearContents
    Range("JED_PosPop").Select
    Selection.ClearContents
    Range("JED_PojPlac").Select
    Selection.ClearContents
    Range("D17:G17").FormulaR1C1 = "Ne"
    Range("D15:E15").FormulaR1C1 = "Ne"
    Range("D16:G16").FormulaR1C1 = "Ano"
    Range("D14").FormulaR1C1 = "Ne"
    Range("D13").Select
    ActiveCell.FormulaR1C1 = "Loss occurance"

'upravit |fffd||fffd|seln|fffd|k v Range("JED_Cenik")
Dim v_text
v_text = Right(Range("Cenova_hladina").Cells(1), 4) 'z|fffd|skat hodnotu nejnov|fffd|j|fffd||fffd| rok
v_text = "Sv|fffd|pomocn|fffd| ceny " & v_text & ",Sv|fffd|pomocn|fffd| ceny " & v_text - 1 & ",Sv|fffd|pomocn|fffd| ceny " & v_text - 2 & ",Sv|fffd|pomocn|fffd| ceny " & v_text - 3 & ",Sv|fffd|pomocn|fffd| ceny " & v_text - 4 & ","
'        "Sv|fffd|pomocn|fffd| ceny 2016;Sv|fffd|pomocn|fffd| ceny 2015;Sv|fffd|pomocn|fffd| ceny 2014;Sv|fffd|pomocn|fffd| ceny 2013;Sv|fffd|pomocn|fffd| ceny 2012;"
    
    With Range("JED_Cenik").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=v_text
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = False
        .ShowError = False
    End With
'konec upravit |fffd||fffd|seln|fffd|k v Range("JED_Cenik")
    
    Range("JED_Cenik").FormulaR1C1 = Range("Cenova_hladina").Cells(1)
    Range("D8").Select
    Selection.ClearContents
    Range("H7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("JED")
    Range("JED_Svodidlo").FormulaR1C1 = "Ne"
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vymery()
    Application.ScreenUpdating = False
    Range("B5:B24").Select
    Selection.ClearContents
    Range("E5:I24").Select
    Selection.ClearContents
    Range("L5:L24").Select
    Selection.ClearContents
    Range("N5:O24").Select
    Selection.ClearContents
    Range("C5:D24").FormulaR1C1 = "0"
    Range("B32:B51").Select
    Selection.ClearContents
    Range("E32:F51").Select
    Selection.ClearContents
    Range("C32:D51").FormulaR1C1 = "0"
    Range("B5").Select
    Selection.ClearContents
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Zajezd_ODP()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Range("ZAJ_Misto").Select
    Selection.ClearContents
    Range("ZAJ_Likv").Select
    Selection.ClearContents
    Range("Zaj_Tym").Select
    Selection.ClearContents
    Range("ZAJ_LKod").Select
    Selection.ClearContents
    Range("ZAJ_TypPP").Select
    Selection.ClearContents
    Range("ZAJ_Dat_Vyp").FormulaR1C1 = "=TODAY()"
    Range("C28:C37").Select
    Selection.ClearContents
    'vymazat "odzadu" -> nen|fffd| tak nutn|fffd| o|fffd|et|fffd|ovat ud|fffd|lost|fffd| procedury na listu ZAJ (Z|fffd|jezd)
    Range("M28:M37").FormulaR1C1 = "0"
    Range("K28:K37").FormulaR1C1 = "0"
    Range("J28:J37").FormulaR1C1 = "0"
    Range("I28:I37").FormulaR1C1 = "0"
    Range("H28:H37").FormulaR1C1 = "0"
    Range("G28:G37").FormulaR1C1 = "0"
    'konec - vymazat "odzadu"
    Range("ZAJ_PojPlac").Select
    Selection.ClearContents
    Range("Zaj_TypSpl").Select
    Selection.ClearContents
    Range("Zaj_LimitPoj").Select
    Selection.ClearContents
    Range("Zaj_PojEnd").Select
    Selection.ClearContents
    Range("Zaj_Uzemi").Select
    Selection.ClearContents
    Range("Zaj_KcLim").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("Zaj_PojStart").Select
    Selection.ClearContents
    Range("Zaj_ProdRad").Select
    Selection.ClearContents
    Range("Zaj_Sml").Select
    Selection.ClearContents
    Range("ZAJ_Splu_PC").Select
    Selection.ClearContents
    Range("Zaj_PojKryt").Select
    Selection.ClearContents
    Range("D12").Select
    Selection.ClearContents
    Range("D7:D11").Select
    Selection.ClearContents
    Range("F9:F10").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("D6").Select
    Selection.ClearContents
    Range("D5").Select
    Selection.ClearContents
    Range("K4").Select
    Selection.ClearContents
    Range("D4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_SOU_ODP()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Worksheets("Datov|fffd| list ODP").Range("A145") = 1
    Range("C21").Select
    Selection.ClearContents
    Range("G21").Select
    Selection.ClearContents
    Range("SOU_LKod").Select
    Selection.ClearContents
    Range("SOU_TypPP").Select
    Selection.ClearContents
    Range("C20").FormulaR1C1 = "=TODAY()"
    Range("D16").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("D15").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C11").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("SOU_Misto").Select
    Selection.ClearContents
    Range("C12").Select
    Selection.ClearContents
    Range("C10").Select
    ActiveCell.FormulaR1C1 = "Jednoduch|fffd| likvidace soupoji|fffd|t|fffd|n|fffd|. PU, kde |fffd|P a.s. nen|fffd| leaderem, naopak vypl|fffd|c|fffd| sv|fffd|j pod|fffd|l jako soupojistitel"
    Range("C9").Select
    Selection.ClearContents
    Range("C8").Select
    Selection.ClearContents
    Range("C7").Select
    Selection.ClearContents
    Range("G4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Range("C4").Select
    Selection.ClearContents
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_AZA_ODP()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Worksheets("Datov|fffd| list ODP").Range("K144") = 1
    Range("C21").Select
    Selection.ClearContents
    Range("G21").Select
    Selection.ClearContents
    Range("AZA_LKod").Select
    Selection.ClearContents
    Range("AZA_TypPP").Select
    Selection.ClearContents
    Range("C20").FormulaR1C1 = "=TODAY()"
    Range("AZA_Dluh").FormulaR1C1 = "Ano"
    Range("D16").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("D15").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C11").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("AZA_Misto").Select
    Selection.ClearContents
    Range("C12").Select
    Selection.ClearContents
    Range("C10").Select
    ActiveCell.FormulaR1C1 = "Jednoduch|fffd| likvidace aktivn|fffd|ho zaji|fffd|t|fffd|n|fffd|. PU, kde |fffd|P a.s. vypl|fffd|c|fffd| sv|fffd|j pod|fffd|l cedentovi jako zajistitel."
    Range("C9").Select
    Selection.ClearContents
    Range("C8").Select
    Selection.ClearContents
    Range("C7").Select
    Selection.ClearContents
    Range("G4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Range("C4").Select
    Selection.ClearContents
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Auto_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Worksheets("Datov|fffd| list").Range("B40") = 1
    Range("C51").FormulaR1C1 = "0"
    Range("C52").FormulaR1C1 = "0"
    Range("C53").FormulaR1C1 = "0"
    Range("C54").FormulaR1C1 = "0"
    Range("C55").FormulaR1C1 = "0"
    Range("E51").FormulaR1C1 = "21%"
    Range("E52").FormulaR1C1 = "21%"
    Range("E53").FormulaR1C1 = "21%"
    Range("E54").FormulaR1C1 = "21%"
    Range("E55").FormulaR1C1 = "21%"
    Range("D51:D55").Select
    Selection.ClearContents
    Range("B49").Select
    Selection.ClearContents
    Range("C46").Select
    Selection.ClearContents
    Range("F46:F47").Select
    Selection.ClearContents
    Range("F44").Select
    Selection.ClearContents
    Range("C43").Select
    Selection.ClearContents
    Range("E43").Select
    Selection.ClearContents
    Range("B37:E41").Select
    Selection.ClearContents
    Range("B33:B35").Select
    Selection.ClearContents
    Range("I33:I35").Select
    Selection.ClearContents
    Range("AUTO_PosPop").Select
    Selection.ClearContents
    Range("AUTO_PojPlac").Select
    Selection.ClearContents
    Range("L44").FormulaR1C1 = "Ne"
    Range("L43").FormulaR1C1 = "Ne"
    Range("D18:G18").FormulaR1C1 = "Ne"
    Range("D17:G17").FormulaR1C1 = "Ano"
    Range("D16").FormulaR1C1 = "Ne"
    Range("H16").Select
    Selection.ClearContents
    Range("D15").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C9:C10").Select
    Selection.ClearContents
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("Auto")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_TOT_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Range("c47").Select
    Selection.ClearContents
    Range("B44:B46").Select
    Selection.ClearContents
    Range("I43:I47").Select
    Selection.ClearContents
    Range("B41").Select
    Selection.ClearContents
    Range("D34:D37").Select
    Selection.ClearContents
    Range("I34").FormulaR1C1 = "0"
    Range("I35:I37").Select
    Selection.ClearContents
    Range("I32").Select
    Selection.ClearContents
    Range("F31").Select
    Selection.ClearContents
    Range("TOT_PosPop").Select
    Selection.ClearContents
    Range("TOT_PojPlac").Select
    Selection.ClearContents
    Range("D18:G18").FormulaR1C1 = "Ne"
    Range("D17:G17").FormulaR1C1 = "Ano"
    Range("D16").FormulaR1C1 = "Ne"
    Range("H16").Select
    Selection.ClearContents
    Range("D15").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C9:C10").Select
    Selection.ClearContents
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("TOT")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Auto_Spolu_ODP()
    ThisWorkbook.ActiveSheet.Protect ("0309")
    
    Application.ScreenUpdating = False
    Range("D59").FormulaR1C1 = "0"
    Range("B56:D57").Select
    Selection.ClearContents
    Range("D56:D57").FormulaR1C1 = "0"
    Range("E56:E57").FormulaR1C1 = "Nov|fffd| cena"
    Range("G56:H57").Select
    Selection.ClearContents
    Range("C48").FormulaR1C1 = "0"
    Range("C49").FormulaR1C1 = "0"
    Range("C50").FormulaR1C1 = "0"
    Range("C51").FormulaR1C1 = "0"
    Range("C52").FormulaR1C1 = "0"
    Range("E48").FormulaR1C1 = "21%"
    Range("E49").FormulaR1C1 = "21%"
    Range("E50").FormulaR1C1 = "21%"
    Range("E51").FormulaR1C1 = "21%"
    Range("E52").FormulaR1C1 = "21%"
    Range("D49:D52").Select
    Selection.ClearContents
    Range("B46").Select
    Selection.ClearContents
    Range("C43").Select
    Selection.ClearContents
    Range("F43:F44").Select
    Selection.ClearContents
    Range("I39:I40").Select
    Selection.ClearContents
    Range("I34:I35").Select
    Selection.ClearContents
    Range("SHAV_PosPop").Select
    Selection.ClearContents
    Range("SHAV_PojPlac").Select
    Selection.ClearContents
    Range("D18:G18").FormulaR1C1 = "Ne"
    Range("D17:G17").FormulaR1C1 = "Ano"
    Range("D16").FormulaR1C1 = "Ne"
    Range("H16").Select
    Selection.ClearContents
    Range("D15").Select
    ActiveCell.FormulaR1C1 = "Loss occurence"
    Range("C9:C10").Select
    Selection.ClearContents
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Smaz_Vyjmenovane ("SHAV")
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Auto_Vyk_ODP()
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Application.ScreenUpdating = False
    Worksheets("Datov|fffd| list").Range("B40") = 1
    Range("E50").FormulaR1C1 = "21%"
    Range("E51").FormulaR1C1 = "21%"
    Range("E52").FormulaR1C1 = "21%"
    Range("E53").FormulaR1C1 = "21%"
    Range("E54").FormulaR1C1 = "21%"
    Range("C50").FormulaR1C1 = "0%"
    Range("C51").FormulaR1C1 = "0%"
    Range("C52").FormulaR1C1 = "0%"
    Range("C53").FormulaR1C1 = "0%"
    Range("C54").FormulaR1C1 = "0%"
    Range("D50:D54").Select
    Selection.ClearContents
    Range("B51").Select
    ActiveCell.FormulaR1C1 = "N|fffd|pravy"
    Range("B50").Select
    ActiveCell.FormulaR1C1 = "ND"
    Range("B45:H45").Select
    Selection.ClearContents
    Range("E78").FormulaR1C1 = "21%"
    Range("E79").FormulaR1C1 = "21%"
    Range("E80").FormulaR1C1 = "21%"
    Range("E81").FormulaR1C1 = "21%"
    Range("E82").FormulaR1C1 = "21%"
    Range("C78").FormulaR1C1 = "0%"
    Range("C79").FormulaR1C1 = "0%"
    Range("C80").FormulaR1C1 = "0%"
    Range("C81").FormulaR1C1 = "0%"
    Range("C82").FormulaR1C1 = "0%"
    Range("D78:D82").Select
    Selection.ClearContents
    Range("B79").Select
    ActiveCell.FormulaR1C1 = "N|fffd|pravy"
    Range("B78").Select
    ActiveCell.FormulaR1C1 = "ND"
    Range("B73:H73").Select
    Selection.ClearContents
    Range("F69").FormulaR1C1 = "0"
    Range("F68").FormulaR1C1 = "??? Vyber vozidlo ???"
    Range("B132:B134").Select
    Selection.ClearContents
    Range("F161").Select
    Selection.ClearContents
    Range("F42:F43").Select
    Selection.ClearContents
    Range("B60:F64").Select
    Selection.ClearContents
    Range("C69").FormulaR1C1 = "1.1.2000"
    Range("C70").FormulaR1C1 = "2.1.2000"
    Range("L39").FormulaR1C1 = "Ne"
    Range("L67").FormulaR1C1 = "Ne"
    Range("C47").Select
    Selection.ClearContents
    Range("E47").Select
    Selection.ClearContents
    Range("C75").Select
    Selection.ClearContents
    Range("E67").Select
    Selection.ClearContents
    Range("E75").Select
    Selection.ClearContents
    Range("C42").Select
    Selection.ClearContents
    Range("E39").Select
    Selection.ClearContents
    Range("B32:F36").Select
    Selection.ClearContents
    Range("B28:F30").Select
    Selection.ClearContents
    Range("POVOL_PojPlac").Select
    Selection.ClearContents
    Range("G28").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("D26").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("G29").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("G30").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C10").Select
    Selection.ClearContents
    Range("C9").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    For Each sh In ActiveSheet.Shapes
      If Rows(57).Top <= sh.Top And sh.Top < Rows(83).Top Then
        sh.Visible = False
      End If
    Next sh
    
    Range("B72").FormulaR1C1 = "Vyberte zda je uplatn|fffd|na nebo neuplatn|fffd|na sr|fffd|ka na materi|fffd|l ?!?!?!"
    Rows("56:83").Select
    Selection.EntireRow.Hidden = True
    Rows("101:160").Select
    Selection.EntireRow.Hidden = True
    
    Smaz_Vyjmenovane ("POVOL")
    Application.ScreenUpdating = True

    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Vymaz_Vyp_Vec_ODP_POR()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Range("D50").Select
    Selection.ClearContents
    Range("H50").Select
    Selection.ClearContents
    Range("MOV_POR_LKod").Select
    Selection.ClearContents
    Range("MOV_POR_TypPP").Select
    Selection.ClearContents
    Range("D49").FormulaR1C1 = "=TODAY()"
    Range("C14:F46").Select
    Selection.ClearContents
    Range("M14:n46").FormulaR1C1 = "0"
    Range("i14:i46").FormulaR1C1 = "0"
    Range("k14:k46").FormulaR1C1 = "0"
    Range("G14:G46").FormulaR1C1 = "0"
    Range("H14:H46").FormulaR1C1 = "Nov|fffd| cena"
    For uu = 1 To 33
      Range("B" & uu + 13).FormulaR1C1 = uu
    Next uu
    Range("G10").FormulaR1C1 = "0"
    Range("I10").FormulaR1C1 = "1"
    Range("D8").Select
    Selection.ClearContents
    Range("D7").Select
    Selection.ClearContents
    Range("I7").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("D6").Select
    Selection.ClearContents
    Range("D5").Select
    Selection.ClearContents
    Range("L4").Select
    Selection.ClearContents
    Range("D4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
End Sub

Sub Vymaz_Vyp_Auto_ODP_POR()
    Application.ScreenUpdating = False
    Range("C35").Select
    Selection.ClearContents
    Range("G35").Select
    Selection.ClearContents
    Range("AUTO_POR_LKod").Select
    Selection.ClearContents
    Range("AUTO_POR_TypPP").Select
    Selection.ClearContents
    Range("C34").FormulaR1C1 = "=TODAY()"
    Range("C26").FormulaR1C1 = "0"
    Range("C27").FormulaR1C1 = "0"
    Range("C28").FormulaR1C1 = "0"
    Range("C29").FormulaR1C1 = "0"
    Range("C30").FormulaR1C1 = "0"
    Range("E26").FormulaR1C1 = "21%"
    Range("E27").FormulaR1C1 = "21%"
    Range("E28").FormulaR1C1 = "21%"
    Range("E29").FormulaR1C1 = "21%"
    Range("E30").FormulaR1C1 = "21%"
    Range("D26:D30").Select
    Selection.ClearContents
    Range("B24").Select
    Selection.ClearContents
    Range("C21").Select
    Selection.ClearContents
    Range("F21:F22").Select
    Selection.ClearContents
    Range("B12:E16").Select
    Selection.ClearContents
    Range("I10").Select
    Selection.ClearContents
    Range("C9").Select
    Selection.ClearContents
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "K|fffd|"
    Range("C7").Select
    Selection.ClearContents
    Range("C6").Select
    Selection.ClearContents
    Range("C5").Select
    Selection.ClearContents
    Range("I4").Select
    Selection.ClearContents
    Range("C4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Vydelek_ODP()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Range("E60").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C59").Select
    Selection.ClearContents
    Range("B58:G58").Select
    Selection.ClearContents
    Range("D57").Select
    Selection.ClearContents
    Range("D56").Select
    Selection.ClearContents
    Range("E54").Select
    Selection.ClearContents
    Range("F52").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("F51").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("G50").Select
    ActiveCell.FormulaR1C1 = "1/2/1950"
    Range("E50").Select
    ActiveCell.FormulaR1C1 = "1/1/1950"
    Range("D46").Select
    Selection.ClearContents
    Range("C36").Select
    Selection.ClearContents
    Range("C35").Select
    Selection.ClearContents
    Range("C34").Select
    Selection.ClearContents
    Range("E36").Select
    Selection.ClearContents
    Range("E35").Select
    Selection.ClearContents
    Range("E34").Select
    Selection.ClearContents
    Range("E23").Select
    Selection.ClearContents
    Range("E22").Select
    Selection.ClearContents
    Range("E21").Select
    Selection.ClearContents
    Range("C23").Select
    Selection.ClearContents
    Range("C22").Select
    Selection.ClearContents
    Range("C21").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("B15").Select
    Selection.ClearContents
    Range("G12").Select
    Selection.ClearContents
    Range("E12").Select
    Selection.ClearContents
    Range("E10").Select
    Selection.ClearContents
    Range("D10").Select
    Selection.ClearContents
    Range("D8").Select
    ActiveCell.FormulaR1C1 = "8"
    Range("D7").Select
    ActiveCell.FormulaR1C1 = "p|fffd|t dn|fffd|"
    Range("E6").Select
    ActiveCell.FormulaR1C1 = "hodinovou"
    Range("C6").Select
    Selection.ClearContents
    Range("C5").Select
    Selection.ClearContents
    Range("E5").Select
    Selection.ClearContents
    Range("G5").Select
    Selection.ClearContents
    Range("C4:G4").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_THV()
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets("V|fffd|po|fffd|et THV")
      .Unprotect ("0309")
      .Range("J25:K25").Select
      Selection.ClearContents
      .Range("C25").FormulaR1C1 = "=TODAY()"
      .Range("K2").Select
      Selection.ClearContents
      .Range("O2").Select
      Selection.ClearContents
      .Range("d2:i2").ClearContents
      .Range("d3:i3").ClearContents
      .Range("K3").ClearContents
      .Range("I7").FormulaR1C1 = "0"
      .Range("I5").FormulaR1C1 = "2.1.2000"
      .Range("I4").FormulaR1C1 = "1.1.2000"
      .Range("I7").FormulaR1C1 = "0"
      nastavit_CP (.Name)
      .Protect ("0309")
    End With
    
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_THP()
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets("Pneu TH")
      .Unprotect ("0309")
      .Range("c24").Select
      Selection.ClearContents
      .Range("C23").FormulaR1C1 = "=TODAY()"
      .Range("C19").FormulaR1C1 = "0"
      .Range("C13").FormulaR1C1 = "0"
      .Range("C10").FormulaR1C1 = "Vyber druh pneumatiky"
      .Range("C9").FormulaR1C1 = "Vyber kategorii vozidla"
      .Range("C4:C7").Select
      Selection.ClearContents
      .Range("C4").Select
      nastavit_CP (.Name)
      .Protect ("0309")
    End With
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vyp_Advokat()
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets("Advok|fffd|t")
      .Unprotect ("0309")
      .Range("I39,E15:I15,I2:I4,C3:G3,C2:G2,M2:N2").ClearContents
      .Range("I5,H9").FormulaR1C1 = "0"
      .Range("E8").FormulaR1C1 = "Ne"
      .Range("F11").FormulaR1C1 = "0%"
      .Range("C39").FormulaR1C1 = "=TODAY()"
      nastavit_CP (.Name)
      .Protect ("0309")
      If .Name = "Advok|fffd|t" Then .Range("C2").Select
    End With
    Application.ScreenUpdating = True
End Sub
Sub Vymaz_Vypocet_uroku_POV()
    Application.ScreenUpdating = False
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    Range("H17:I17").Select
    Selection.ClearContents
    Range("C17").FormulaR1C1 = "=TODAY()"
    Selection.ClearContents
    Range("E10:I10").Select
    Selection.ClearContents
    Range("C13:G13").Select
    Selection.ClearContents
    Range("I6").Select
    ActiveCell.FormulaR1C1 = "1/1/2010"
    Range("I5").Select
    ActiveCell.FormulaR1C1 = "1/1/2010"
    Range("I4").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("I3").Select
    Selection.ClearContents
    Range("I2").Select
    Selection.ClearContents
    Range("C3:G3").Select
    Selection.ClearContents
    Range("M2").Select
    Selection.ClearContents
    Range("C2:G2").Select
    Selection.ClearContents
    nastavit_CP (ThisWorkbook.ActiveSheet.Name)
    ThisWorkbook.ActiveSheet.Protect ("0309")
    Application.ScreenUpdating = True
End Sub


Sub Vymaz_CORN_Text()
    Application.ScreenUpdating = False
    jmList = ActiveSheet.CodeName
    ActiveSheet.Unprotect ("0309")
    Range(jmList + "_Jmeno").ClearContents
    Range(jmList + "_Referent").ClearContents
    Range(jmList + "_Ulice").ClearContents
    Range(jmList + "_Mesto").ClearContents
    Range(jmList + "_PSC").ClearContents
    Range(jmList + "_SML").Value = vbNullString
    Range(jmList + "_Likv").Value = vbNullString
    Range(jmList + "_Tym").ClearContents
    Range(jmList + "_POJ").Value = vbNullString
    Range(jmList + "_PRIPAD").Value = vbNullString
    Range(jmList + "_DAT_PU").Value = vbNullString
    Range(jmList + "_POS").ClearContents
    Range(jmList + "_PodPripad").Value = vbNullString
    
    With ActiveSheet
        .Range("C6").Value = "P.O. BOX 305,  601 00 Brno"
        '.Range("E6").Value = "601 00 Brno"
        .Range("H37").Value = "|fffd|ESK|fffd| POJI|fffd||fffd|OVNA a.s. "
        .Range("C45").Value = "|fffd|esk|fffd| poji|fffd||fffd|ovna, a.s., Sp|fffd|len|fffd| 75/16, 113 04 Prague 1, phone: +420|fffd|224|fffd|051 111, fax +420 224 551 068,"
        .Range("C46").Value = "ID: 45272956, VAT: CZ699001273,"
        .Range("C47").Value = "registered with the Commercial Register at the Municipal Court in Prague, Section B, Insert 1464"
    End With
    
    nastavit_CP (ActiveSheet.Name)
    
    ActiveSheet.Protect ("0309")
    
    Application.ScreenUpdating = True


End Sub

Sub Pridej_VEC_radek()
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Zkr_Rad = Range("A200")
    If Zkr_Rad < 45 Then
        RadH = 41 + Zkr_Rad
        Rows(RadH).Select
        Selection.EntireRow.Hidden = False
        For Each sh In ActiveSheet.Shapes
          If Rows(RadH).Top <= sh.Top Then
            If Rows(RadH).Top <= sh.Top And sh.Top < Rows(RadH).Top + Rows(RadH).Height Then
              sh.Visible = True
            End If
          End If
        Next sh
        Range("C" & RadH).Select
        Zkr_Rad = Zkr_Rad + 1
        Range("A200").FormulaR1C1 = Zkr_Rad
    End If
    
    'ThisWorkbook.Protect ("0309")
    ThisWorkbook.ActiveSheet.Protect ("0309")
    
End Sub
Sub Skryj_VEC_radek()
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    Zkr_Rad = Range("A200")
    If Zkr_Rad > 0 Then
        RadH = 40 + Zkr_Rad
        For Each sh In ActiveSheet.Shapes
          If Rows(RadH).Top <= sh.Top Then
            If Rows(RadH).Top <= sh.Top And sh.Top < Rows(RadH).Top + Rows(RadH).Height Then
              sh.Visible = False
            End If
          End If
        Next sh
        Rows(RadH).Select
        Selection.EntireRow.Hidden = True
        Range("C" & RadH).Select
        Zkr_Rad = Zkr_Rad - 1
        
        Range("C" & RadH).Select
        Selection.ClearContents
        Range("g" & RadH).Select
        Selection.ClearContents
        Range("H" & RadH).FormulaR1C1 = "0"
        Range("J" & RadH).FormulaR1C1 = "0"
        Range("L" & RadH).FormulaR1C1 = "0"
        Range("N" & RadH).FormulaR1C1 = "0"
        Range("O" & RadH).FormulaR1C1 = "0"
        Worksheets("Datov|fffd| list ODP").Range("A" & 345 + Zkr_Rad) = 1
        Range("A200").FormulaR1C1 = Zkr_Rad
        Range("C" & RadH).Select
        
    End If
    'ThisWorkbook.Protect ("0309")
    ThisWorkbook.ActiveSheet.Protect ("0309")

End Sub
Sub Pridej_VOZIDLO()
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
        
    Rows("56:83").Select
    Selection.EntireRow.Hidden = False
    Range("B60").Select
    
    For Each sh In ActiveSheet.Shapes
      If Rows(56).Top <= sh.Top And sh.Top < Rows(83).Top Then
        sh.Visible = True
      End If
    Next sh
    
    'ThisWorkbook.Protect ("0309")
    ThisWorkbook.ActiveSheet.Protect ("0309")
    
End Sub
Sub Uber_VOZIDLO()
    ThisWorkbook.Unprotect ("0309")
    ThisWorkbook.ActiveSheet.Unprotect ("0309")
    
    For Each sh In ActiveSheet.Shapes
      If Rows(56).Top <= sh.Top And sh.Top < Rows(83).Top Then
        sh.Visible = False
      End If
    Next sh
    
    Rows("56:83").Select
    Selection.EntireRow.Hidden = True
    Range("C85").Select
    
    'ThisWorkbook.Protect ("0309")
    ThisWorkbook.ActiveSheet.Protect ("0309")
    
End Sub

Sub Pridej_NEM_radek()
'    Application.ScreenUpdating = False
'    Application.EnableEvents = False
    
    With ThisWorkbook.Worksheets("Nemovitosti")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad < 145 Then
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            RadH = 37 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            'For Each sh In .Shapes
            '  If .Rows(RadH).Top <= sh.Top Then
            '    If .Rows(RadH).Top <= sh.Top And sh.Top < .Rows(RadH).Top + .Rows(RadH).Height Then
            '      sh.Visible = True
            '    End If
            '  End If
            'Next sh
            .Range("E" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
        End If
    End With

'    Application.EnableEvents = True
'    Application.ScreenUpdating = True
End Sub

Sub Skryj_NEM_radek()
    With ThisWorkbook.Worksheets("Nemovitosti")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad > 0 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 36 + Zkr_Rad
            'For Each sh In .Shapes
            '  If .Rows(RadH).Top <= sh.Top Then
            '    If .Rows(RadH).Top <= sh.Top And sh.Top < .Rows(RadH).Top + .Rows(RadH).Height Then
            '      sh.Visible = False
            '    End If
            '  End If
            'Next sh
            .Rows(RadH).EntireRow.Hidden = True
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            .Range("C" & RadH & ":H" & RadH).ClearContents
            .Range("E" & RadH).Font.Bold = False
            .Range("E" & RadH).Font.ColorIndex = 0
            .Range("K" & RadH).ClearContents
            .Range("N" & RadH).ClearContents
            .Range("R" & RadH).ClearContents
            .Range("B" & RadH).FormulaR1C1 = RadH - 31
            .Range("I" & RadH).FormulaR1C1 = "1"
            .Range("L" & RadH).FormulaR1C1 = "Nov|fffd| cena"
            'Worksheets("Datov|fffd| list ODP").Range("B" & 345 + Zkr_Rad) = 1
            Application.EnableEvents = True
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Range("E" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        End If
    End With
End Sub

Sub Pridej_Nem_POR_radek()
'    Application.ScreenUpdating = False
'    Application.EnableEvents = False
    
    With ThisWorkbook.Worksheets("Nem_POR")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad < 145 Then
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            RadH = 17 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            'For Each sh In .Shapes
            '  If .Rows(RadH).Top <= sh.Top Then
            '    If .Rows(RadH).Top <= sh.Top And sh.Top < .Rows(RadH).Top + .Rows(RadH).Height Then
            '      sh.Visible = True
            '    End If
            '  End If
            'Next sh
            .Range("E" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
        End If
    End With

'    Application.EnableEvents = True
'    Application.ScreenUpdating = True
End Sub

Sub Skryj_Nem_POR_radek()
    With ThisWorkbook.Worksheets("Nem_POR")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad > 0 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 16 + Zkr_Rad
            'For Each sh In .Shapes
            '  If .Rows(RadH).Top <= sh.Top Then
            '    If .Rows(RadH).Top <= sh.Top And sh.Top < .Rows(RadH).Top + .Rows(RadH).Height Then
            '      sh.Visible = False
            '    End If
            '  End If
            'Next sh
            .Rows(RadH).EntireRow.Hidden = True
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            .Range("C" & RadH & ":H" & RadH).ClearContents
            .Range("E" & RadH).Font.Bold = False
            .Range("E" & RadH).Font.ColorIndex = 0
            .Range("K" & RadH).ClearContents
            .Range("N" & RadH).ClearContents
            .Range("B" & RadH).FormulaR1C1 = RadH - 11
            .Range("I" & RadH).FormulaR1C1 = "1"
            .Range("L" & RadH).FormulaR1C1 = "Nov|fffd| cena"
            'Worksheets("Datov|fffd| list ODP").Range("B" & 345 + Zkr_Rad) = 1
            Application.EnableEvents = True
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Range("E" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        End If
    End With
End Sub

Sub Pridej_NEK_VEC_radek()
    With ThisWorkbook.Worksheets("Nemovitosti komb")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad < 25 Then
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            RadH = 35 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
        End If
    End With
End Sub

Sub Skryj_NEK_VEC_radek()
    With ThisWorkbook.Worksheets("Nemovitosti komb")
        Zkr_Rad = .Range("A300")
        If Zkr_Rad > 0 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 34 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = True
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            .Range("B" & RadH & ":E" & RadH).ClearContents
            .Range("Q" & RadH).ClearContents
            .Range("F" & RadH).FormulaR1C1 = "0"
            .Range("I" & RadH).FormulaR1C1 = "0"
            .Range("K" & RadH).FormulaR1C1 = "0"
            .Range("L" & RadH).FormulaR1C1 = "0"
            .Range("G" & RadH).FormulaR1C1 = "Nov|fffd| cena"
            .Range("A" & RadH).FormulaR1C1 = RadH - 29
            Application.EnableEvents = True
            .Range("A300").FormulaR1C1 = Zkr_Rad
            .Range("B" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        End If
    End With
End Sub

Sub Pridej_NEK_NEM_radek()
    'Application.ScreenUpdating = False
    
    With ThisWorkbook.Worksheets("Nemovitosti komb")
        Zkr_Rad = .Range("B300")
        If Zkr_Rad < 145 Then
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            RadH = 66 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            .Range("D" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            .Range("B300").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
        End If
        
        'Application.ScreenUpdating = True
    End With
End Sub

Sub Skryj_NEK_NEM_radek()
    With ThisWorkbook.Worksheets("Nemovitosti komb")
        Zkr_Rad = Range("B300")
        If Zkr_Rad > 0 Then
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.ScreenUpdating = False
            Application.EnableEvents = False
            RadH = 65 + Zkr_Rad
            Rows(RadH).EntireRow.Hidden = True
            Range("B" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            .Range("B" & RadH & ":G" & RadH).ClearContents
            .Range("D" & RadH).Font.Bold = False
            .Range("D" & RadH).Font.ColorIndex = 0
            .Range("J" & RadH).ClearContents
            .Range("Q" & RadH).ClearContents
            .Range("H" & RadH).FormulaR1C1 = "0"
            .Range("K" & RadH).FormulaR1C1 = "Nov|fffd| cena"
            .Range("M" & RadH).FormulaR1C1 = "0"
            .Range("A" & RadH).FormulaR1C1 = RadH - 30
            
            'Worksheets("Datov|fffd| list ODP").Range("B" & 345 + Zkr_Rad) = 1
            Application.EnableEvents = True
            .Range("B300").FormulaR1C1 = Zkr_Rad
            .Range("D" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        End If
    End With
End Sub
Function dopsani(cradek As Integer)

'nen|fffd|-li vypln|fffd|no 'Datum vzniku bolesti'
If ActiveSheet.Range("C3").Value = "" Then
    ActiveSheet.Range("C2").Select
    ThisWorkbook.Sheets("Datov|fffd| list ODP").Cells(561, 1).Offset(cradek - 7, 0).Value = 1
    ActiveSheet.Range("C3").Select
    Exit Function
End If

BOL_dopsani_stav = 1
Range("B" & cradek).Select
polbod = Range("I" & cradek)
CisKod = Range("d" & cradek)
If CisKod = 0 Then
    CisKod = ""
    Range("AL" & cradek).ClearContents
Else
    Range("AL" & cradek).FormulaR1C1 = 1
End If
Range("O" & cradek).FormulaR1C1 = polbod
Range("C" & cradek).FormulaR1C1 = CisKod
If Worksheets("Polo|fffd|ky_NS").Range("H" & cradek) <> "" Then
   Range("B37").FormulaR1C1 = Worksheets("Polo|fffd|ky_NS").Range("H" & cradek)
End If
If (Range("R32") > 50000) Then
  Range("B37").FormulaR1C1 = "Podl|fffd|h|fffd| schv|fffd|len|fffd| disponenta nebo p|fffd|edej na Resil"
  End If
BOL_dopsani_stav = 0
Range("C" & cradek).Select

End Function
Sub Vymaz_ZSU_Vyjednavani()
ThisWorkbook.ActiveSheet.Unprotect ("0309")
  Range("C15:c22").FormulaR1C1 = "0"
  Range("D15:E22").FormulaR1C1 = "1"
  Range("C4:C12").Select
  Selection.ClearContents
  Range("B24").Select
  Selection.ClearContents
  Range("D24").Select
  Selection.ClearContents
  Range("D28").Select
  Selection.ClearContents
  Range("B26").Select
  Selection.ClearContents
  Range("D26").Select
  Selection.ClearContents
  Range("F26").Select
  Selection.ClearContents
  Range("F24").Select
  Selection.ClearContents
  nastavit_CP (ThisWorkbook.ActiveSheet.Name)
ThisWorkbook.ActiveSheet.Protect ("0309")
  Range("C5").Select
End Sub
Sub Vymaz_Umrti()
ThisWorkbook.ActiveSheet.Unprotect ("0309")
  Range("C31").Select
  Selection.ClearContents
  Range("C33:C35").Select
  Selection.ClearContents
  Range("C4:C11").Select
  Selection.ClearContents
  Range("C13").Select
  Selection.ClearContents
  Range("E13").Select
  Selection.ClearContents
  Range("C15").Select
  Selection.ClearContents
  Range("E15").Select
  Selection.ClearContents
  Range("C17").Select
  Selection.ClearContents
  Range("E17").Select
  Selection.ClearContents
  Range("C19").Select
  Selection.ClearContents
  Range("C21").Select
  Selection.ClearContents
  Range("E21").Select
  Selection.ClearContents
  Range("C23").Select
  Selection.ClearContents
  Range("E23").Select
  Selection.ClearContents
  Range("C24").Select
  Selection.ClearContents
  Range("C25").Select
  Selection.ClearContents
  Range("C27").Select
  Selection.ClearContents
  Range("C29").Select
  Selection.ClearContents
  nastavit_CP (ThisWorkbook.ActiveSheet.Name)
ThisWorkbook.ActiveSheet.Protect ("0309")
  Range("C4").Select
End Sub
Function ZSU_dopsani(zradek As Integer)

'nen|fffd|-li vypln|fffd|no 'Datum ust|fffd|len|fffd| zdravotn|fffd|ho stavu'
If ActiveSheet.Range("C3").Value = "" Then
    ActiveSheet.Range("C2").Select
    ThisWorkbook.Sheets("Datov|fffd| list ODP").Cells(561, 2).Offset(zradek - 7, 0).Value = 1
    ActiveSheet.Range("C3").Select
    Exit Function
End If

'nen|fffd|-li vybr|fffd|no 'Vyber typ n|fffd|hrady'
If ActiveSheet.Range("B4").Value = "<<< VYBER TYP N|fffd|HRADY" Then
    ThisWorkbook.Sheets("Datov|fffd| list ODP").Cells(561, 2).Offset(zradek - 7, 0).Value = 1
    ActiveSheet.Range("B4").Select
    Exit Function
End If

ZSU_dopsani_stav = 1
Range("B36").ClearContents
Range("B" & zradek).Select
polbod = Range("H" & zradek)
CisKod = Range("D" & zradek)
Range("L" & zradek).FormulaR1C1 = polbod
Range("C" & zradek).FormulaR1C1 = CisKod
If Range("O" & zradek) = "" Then
   Range("B36").FormulaR1C1 = Range("E" & zradek)
End If
ZSU_dopsani_stav = 0
Range("C" & zradek).Select
End Function

Sub BOL_Seznam()
    dopsani (Val(Replace(Application.Caller, "stahovac|fffd|_", vbNullString)) + 6)
End Sub

Sub ZSU_Seznam()
    ZSU_dopsani (Val(Replace(Application.Caller, "stahovac|fffd|_", vbNullString)) + 6)
End Sub

Sub BOL_ZSU_hledat_chyby(list)
Dim r
    With ThisWorkbook.Worksheets(list)
        For r = 7 To 31
            If Len(.Range("C" & r).Value) > 0 And Left(.Range("B" & r).Value, 3) = "!!!" Then
                Application.EnableEvents = False
                .Range("B37").FormulaR1C1 = "Na |fffd||fffd|dku " & r & " je neexistuj|fffd|c|fffd| polo|fffd|ka!"
                Application.EnableEvents = True
                Exit For
            End If
        Next r
    End With
End Sub

Sub Vymaz_BOL()
  
    If ThisWorkbook.Sheets("Bolestn|fffd|").Name = ActiveSheet.Name And ActiveSheet.Visible = True Then
        If MsgBox("Smazat data formul|fffd||fffd|e?", vbQuestion + vbYesNo) = vbNo Then Exit Sub
        rsoWaitForm.Show (False)
        rsoWaitForm.Repaint
    End If
  
  With ThisWorkbook.Worksheets("Bolestn|fffd|")
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        ThisWorkbook.Unprotect ("0309")
        .Range("C7").Select
        .Unprotect ("0309")
        .Rows("12:31").EntireRow.Hidden = False
        .Columns("D:G").EntireColumn.Hidden = True
        .Columns("E:E").EntireColumn.Hidden = False
        
        For i = 7 To 31                             'b7 v|fffd||fffd|ka: 30, |fffd||fffd||fffd|ka: 61,43
            'BOL_ciselnik_NOZ_konec_radek - definice v modulu Vyber_Listu
            .Range("B" & i).Formula = "=INDEX(Polo|fffd|ky_NS!$C$1:$C$" & BOL_ciselnik_NOZ_konec_radek & ",'Datov|fffd| list ODP'!A" & 561 - 7 + i & ")"
            With .Shapes("stahovac|fffd|_" & i - 6)      'shape v|fffd||fffd|ka: 1,06, |fffd||fffd||fffd|ka 11,51
                .ControlFormat.ListFillRange = "Polo|fffd|ky_NS!$C$1:$C$" & BOL_ciselnik_NOZ_konec_radek
                .Visible = True
                '.Top = ThisWorkbook.ActiveSheet.Rows(i).Top
                '.Left = ThisWorkbook.ActiveSheet.Range("B" & i).Left
            End With
        Next i
        .Range("B7:B31").WrapText = True
        .Range("Q7:R31").ClearContents
        .Range("A300").ClearContents
        .Range("M33").ClearContents
        .Range("B37").ClearContents
        If NewFirma Then
            .Range("BOL_KDO").FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        Else
            .Range("BOL_KDO").FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        End If
        .Range("BOL_POS, BOL_Dat_PU, BOL_Dat_Bol").FormulaR1C1 = vbNullString
        
        .Range("AL7:AL31").ClearContents
        
        .Range("C7:C31").ClearContents
        .Range("C3").ClearContents
        ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("A561:A585").FormulaR1C1 = 1
        
        For i = 7 To 31
            .Range("H" & i).FormulaR1C1 = 1
            .Range("O" & i).FormulaR1C1 = 0
          If i >= 12 Then .Shapes("stahovac|fffd|_" & i - 6).Visible = False
        Next i
        'Po 4 sekund|fffd|ch skryj informa|fffd|n|fffd| hl|fffd|en|fffd|
        'Application.Wait (Now + TimeValue("0:00:04"))
        rsoWaitForm.Hide
        .Rows("12:31").EntireRow.Hidden = True
        .Columns("AI:AU").EntireColumn.Hidden = True
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1
        Application.EnableEvents = True
        .Range("A200").FormulaR1C1 = 0
        .Range("C7").Select
        nastavit_CP (.Name)
        .Protect ("0309")
        ThisWorkbook.Unprotect ("0309")
        Application.ScreenUpdating = True
  End With
  
End Sub

Sub Vymaz_ZSU_NS()
    
    If ThisWorkbook.Sheets("ZSU dle NS").Name = ActiveSheet.Name And ActiveSheet.Visible = True Then
        If MsgBox("Smazat data formul|fffd||fffd|e?", vbQuestion + vbYesNo) = vbNo Then Exit Sub
        rsoWaitForm.Show (False)
        rsoWaitForm.Repaint
    End If
    
    With ThisWorkbook.Sheets("ZSU dle NS")
        .Protect ("0309")
        DoEvents
        On Error Resume Next
        .UsedRange = vbNullString
        On Error GoTo 0
        '.Unprotect ("0309")
        ActiveWindow.ScrollRow = 11
        .Range("ZSU_NS_Pripad").Select
        nastavit_CP (.Name)
    End With

    Application.EnableEvents = True
    'ThisWorkbook.Unprotect ("0309")
    'Application.ScreenUpdating = True
    rsoWaitForm.Hide

End Sub

Sub Vymaz_ZSU()
  
    If ThisWorkbook.Sheets("ZSU").Name = ActiveSheet.Name And ActiveSheet.Visible = True Then
        If MsgBox("Smazat data formul|fffd||fffd|e?", vbQuestion + vbYesNo) = vbNo Then Exit Sub
        rsoWaitForm.Show (False)
        rsoWaitForm.Repaint
    End If
  
  With ThisWorkbook.Worksheets("ZSU")
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        ThisWorkbook.Unprotect ("0309")
        .Unprotect ("0309")
        .Rows("12:31").EntireRow.Hidden = False
        '.Columns("D:G").EntireColumn.Hidden = True
        
        For i = 7 To 31                             'b7 v|fffd||fffd|ka: 30, |fffd||fffd||fffd|ka: 61,43
            'ZSU_ciselnik_konec_radek - definice v modulu Vyber_Listu
            .Range("B" & i).Formula = "=INDEX('Seznam polo|fffd|ek'!$A$1000:$A$" & ZSU_ciselnik_konec_radek & ",'Datov|fffd| list ODP'!B" & 561 - 7 + i & ")"
            With .Shapes("stahovac|fffd|_" & i - 6)      'shape v|fffd||fffd|ka: 1,06, |fffd||fffd||fffd|ka 11,51
                .ControlFormat.ListFillRange = "'Seznam polo|fffd|ek'!$A$1000:$A$" & ZSU_ciselnik_konec_radek
                .Visible = True
                '.Top = ThisWorkbook.ActiveSheet.Range("B" & i).Top
                '.Left = ThisWorkbook.ActiveSheet.Range("B" & i).Left
            End With
        Next i
        .Range("B7:B31").WrapText = True
        .Range("C7:C31").ClearContents
        .Range("L7:L31").FormulaR1C1 = 0
        .Range("N7:N31").FormulaR1C1 = 0
        .Range("B36:B37").ClearContents
        If NewFirma Then
            .Range("ZSU_KDO").FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        Else
            .Range("ZSU_KDO").FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
        End If
        .Range("ZSU_POS, ZSU_Dat_PU, ZSU_Dat_UZS").FormulaR1C1 = vbNullString
        .Range("C7:C31").ClearContents
        '.Range("C2:C3").ClearContents
        ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B561:B585").FormulaR1C1 = 1
        'ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B516").FormulaR1C1 = ""
        .ZSU_OptionButton1 = False
        .ZSU_OptionButton2 = False
        .Shapes("ZSU_OptionButton1").Visible = False
        .Shapes("ZSU_OptionButton2").Visible = False
        .Shapes("Label1").Visible = False
        .Shapes("Textov|fffd|Pole 1").Visible = False
        
        For i = 7 To 31
            .Range("G" & i).FormulaR1C1 = 1
            .Range("L" & i).FormulaR1C1 = 0
            If i >= 12 Then .Shapes("stahovac|fffd|_" & i - 6).Visible = False
        Next i
        'Po 4 sekund|fffd|ch skryj informa|fffd|n|fffd| hl|fffd|en|fffd|
        'Application.Wait (Now + TimeValue("0:00:04"))
        rsoWaitForm.Hide
        .Rows("12:31").EntireRow.Hidden = True
        .Columns("D:F").EntireColumn.Hidden = True
        .Range("G7").Select
        ActiveWindow.ScrollRow = 1
        ActiveWindow.ScrollColumn = 1
        Application.EnableEvents = True
        .Range("A200").FormulaR1C1 = 0
        .Range("C7").Select
        nastavit_CP (.Name)
        .Protect ("0309")
        ThisWorkbook.Unprotect ("0309")
        Application.ScreenUpdating = True
  End With
  
End Sub
    
Sub BOL_prepocitat()
Dim u, v
Application.ScreenUpdating = False
Application.EnableEvents = False
         
With ThisWorkbook.Worksheets("Bolestn|fffd|")
    For u = 7 To 31
        
        If Len(.Range("c" & u).Value) > 0 Then
            If .Range("i" & u) < 0 Then
              .Range("i" & u).FormulaR1C1 = 1
            End If
            If .Range("H" & u).Value <> "" Then
                'Castka = .Range("H" & u).Offset(0, 1)
            
                v = .Range("AL" & u).Value
                Select Case v
                    Case 1:         Castka = .Range("H" & u).Offset(0, 1).Value
                    Case 2:         Castka = .Range("H" & u).Offset(0, 3).Value
                    Case 3:         Castka = .Range("H" & u).Offset(0, 5).Value
                    Case Else:
                End Select
            
              If Castka <> "" Then
                .Range("H" & u).Offset(0, 7) = Castka
              End If
            End If
            .Range("B37").ClearContents
            If .Range("S" & u) = "" Then
              .Range("B37").FormulaR1C1 = .Range("E" & u)
            End If
            .Range("c" & u).Select
        End If
    Next u

End With
Application.EnableEvents = True
Application.ScreenUpdating = True
End Sub

Sub ZSU_prepocitat()
Dim u
Application.ScreenUpdating = False
Application.EnableEvents = False
         
With ThisWorkbook.Worksheets("ZSU")
    For u = 7 To 31
        If Len(.Range("c" & u).Value) > 0 Then
            If .Range("h" & u) < 0 Then
              .Range("h" & u).FormulaR1C1 = 1
            End If
            If .Range("G" & u).Value <> "" Then
            Castka = .Range("G" & u).Offset(0, 1)
              If Castka <> "" Then
                .Range("G" & u).Offset(0, 5) = Castka
              End If
            End If
            .Range("B36").ClearContents
            If .Range("O" & u) = "" Then
              .Range("B36").FormulaR1C1 = .Range("E" & u)
            End If
            If ActiveSheet.Name = "ZSU" Then .Range("c" & u).Select
        End If
    Next u
End With
Application.EnableEvents = True
Application.ScreenUpdating = True
End Sub

Sub Pridej_BOL_radek()
    
    With ThisWorkbook.Worksheets("Bolestn|fffd|")
        Zkr_Rad = .Range("A200")
        If Zkr_Rad < 20 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 12 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            .Range("H" & RadH).FormulaR1C1 = "1"
            .Range("O" & RadH).FormulaR1C1 = "0"
            .Shapes("stahovac|fffd|_" & RadH - 6).Visible = True
            .Range("O" & RadH).FormulaR1C1 = "0"
            .Range("Q" & RadH).ClearContents
            .Range("C" & RadH).ClearContents
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            Application.EnableEvents = True
            .Range("A200").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            ThisWorkbook.Unprotect ("0309")
            Application.ScreenUpdating = True
        
        End If
    End With
    
End Sub
Sub Skryj_BOL_radek()
    
    With ThisWorkbook.Worksheets("Bolestn|fffd|")
        Zkr_Rad = .Range("A200")
        If Zkr_Rad > 0 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 11 + Zkr_Rad
            .Shapes("stahovac|fffd|_" & RadH - 6).Visible = False
            .Range("O" & RadH).ClearContents
            .Range("Q" & RadH).ClearContents
            .Range("R" & RadH).ClearContents
            .Rows(RadH).EntireRow.Hidden = True
            .Range("C" & RadH).ClearContents
            .Range("B37").ClearContents
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            
            ThisWorkbook.Worksheets("Seznam polo|fffd|ek").Range("A" & 968 + Zkr_Rad) = 1
            Application.EnableEvents = True
            .Range("A200").FormulaR1C1 = Zkr_Rad
            .Range("C" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        
        End If
    End With
    
End Sub
Sub Pridej_ZSU_radek()
    
    With ThisWorkbook.Worksheets("ZSU")
        Zkr_Rad = .Range("A200")
        If Zkr_Rad < 20 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 12 + Zkr_Rad
            .Rows(RadH).EntireRow.Hidden = False
            .Range("G" & RadH).FormulaR1C1 = "1"
            .Range("N" & RadH).FormulaR1C1 = "0"
            .Range("L" & RadH).FormulaR1C1 = "0"
            .Shapes("stahovac|fffd|_" & RadH - 6).Visible = True
            .Range("C" & RadH).ClearContents
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad + 1
            Application.EnableEvents = True
            .Range("A200").FormulaR1C1 = Zkr_Rad
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        
        End If
    End With
    
End Sub


Sub Skryj_ZSU_radek()
    
    With ThisWorkbook.Worksheets("ZSU")
        Zkr_Rad = .Range("A200")
        If Zkr_Rad > 0 Then
            Application.ScreenUpdating = False
            ThisWorkbook.Unprotect ("0309")
            .Unprotect ("0309")
            Application.EnableEvents = False
            RadH = 11 + Zkr_Rad
            .Shapes("stahovac|fffd|_" & RadH - 6).Visible = False
            .Range("L" & RadH).ClearContents
            .Range("N" & RadH).ClearContents
            .Rows(RadH).EntireRow.Hidden = True
            .Range("C" & RadH).ClearContents
            .Range("B37").ClearContents
            .Range("C" & RadH).Select
            Zkr_Rad = Zkr_Rad - 1
            ThisWorkbook.Worksheets("Seznam polo|fffd|ek").Range("A" & 968 + Zkr_Rad) = 1
            Application.EnableEvents = True
            .Range("A200").FormulaR1C1 = Zkr_Rad
            .Range("C" & RadH - 1).Select
            .Protect ("0309")
            'ThisWorkbook.Protect ("0309")
            Application.ScreenUpdating = True
        
        End If
    End With
    
End Sub




Attribute VB_Name = "V|fffd|kaz_v|fffd|m|fffd|r"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ZAJ"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)

With ThisWorkbook.Worksheets("Z|fffd|jezd")
    'If Target.Row < 12 Or Target.Row > 161 Then Exit Sub
    
    If Not (Intersect(Target, .Range("G28:I37")) Is Nothing) Then
        If Not IsNumeric(Target(1).Value) Or Target(1).Value = "" Or Target(1).Value < 0 Then Target(1).Value = 0
        If .Range("L" & Target(1).Row).Value < 0 Then Target(1).Value = 0
    
    ElseIf Not (Intersect(Target, .Range("J28:J37")) Is Nothing) Then
        If Not IsNumeric(Target(1).Value) Or Target(1).Value = "" Or Target(1).Value < 0 Or Target(1).Value > 100 Then Target(1).Value = 0
        If Target(1).Value = 0 Then
            GoTo radek_wb_change_konec
        Else
            Target(1).Offset(0, 1).Value = 0
        End If
    
    ElseIf Not (Intersect(Target, .Range("K28:K37")) Is Nothing) Then
        If Not IsNumeric(Target(1).Value) Or Target(1).Value = "" Then Target(1).Value = 0
        If Target(1).Value = 0 Then
            GoTo radek_wb_change_konec
        Else
            Target(1).Offset(0, -1).Value = 0
        End If
        If .Range("L" & Target(1).Row).Value < 0 Then Target(1).Value = 0
    
    ElseIf Not (Intersect(Target, .Range("M28:M37")) Is Nothing) Then
        If Not IsNumeric(Target(1).Value) Or Target(1).Value = "" Or Target(1).Value < 0 Or Target(1).Value > 100 Then
            Target(1).Value = 0
        Else
            GoTo radek_wb_change_konec
        End If
    End If

    

End With

radek_wb_change_konec:

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "ZDR1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ZDR2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim KeyCells As Range, A, B, C
 
' Zm|fffd|na v t|fffd|chto bu|fffd|k|fffd|ch spou|fffd|t|fffd| makro
    Set KeyCells = Range("G31,E28")
    
    If Not Application.Intersect(KeyCells, Range(Target.Address)) _
    Is Nothing Then
 
' Spou|fffd|t|fffd|n|fffd| makro
        
            Application.ScreenUpdating = False
            Worksheets("Datov|fffd| list").Range("SRD_ZO").ClearContents
            Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("SRD_Klic").ClearContents
            Application.ScreenUpdating = True
                 
         A = Worksheets("Datov|fffd| list").Range("SRD_ZAP").Value 'hodnota 1 aktivuje v|fffd|po|fffd|et sr|fffd|kov|fffd| dan|fffd|
         C = Worksheets("Datov|fffd| list").Range("SRD_MAX")
        
        If A = 1 Then
            If Range("G31") > 0 Then
                If Range("Hruba_ztr") > 0 And Range("Hruba_ztr") <= C Then
                   LIMIT_SRD.Show
                End If
            End If
        End If
    
'P|fffd|id|fffd|na procedura pro solid|fffd|rn|fffd| da|fffd|  MRO
        If Range("Hruba_ztr") > Worksheets("Datov|fffd| list").Range("SolD") Then
            B = MsgBox("Hrub|fffd| ztr|fffd|ta na v|fffd|d|fffd|lku po odpo|fffd|tu spoluviny: " & Format(Range("Hruba_ztr"), "# ###") & " " & Range("H7").Value & Chr(13) + Chr(13) + "Mo|fffd|n|fffd| solid|fffd|rn|fffd| zv|fffd||fffd|en|fffd| dan|fffd| (Limit je " & Format(Worksheets("Datov|fffd| list").Range("SolD"), "# ###") & " " & Range("H7").Value & ")." + Chr(13) + Chr(13) + "Chcete nyn|fffd| p|fffd|epnout na list P|fffd|epo|fffd|et dan|fffd|?", vbYesNo + vbExclamation + vbDefaultButton1, "S O L I D |fffd| R N |fffd|  D A |fffd|")
            If B = 6 Then
              Worksheets("P|fffd|epo|fffd|et dan|fffd|").Select
              Worksheets("P|fffd|epo|fffd|et dan|fffd|").Range("I13") = Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("G31").Value
              Worksheets("P|fffd|epo|fffd|et dan|fffd|").Range("C14") = Worksheets("V|fffd|po|fffd|et na Zdrav|fffd| Da|fffd|").Range("ZDR2_Splv_Pro").Value
            End If
        End If
       
    End If

End Sub

        


Attribute VB_Name = "ZDR3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ZSU"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ZSU_OptionButton1, 44, 0, MSForms, OptionButton"
Attribute VB_Control = "ZSU_OptionButton2, 45, 1, MSForms, OptionButton"
Attribute VB_Control = "Label1, 51, 2, MSForms, Label"

Dim Castka

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    With ThisWorkbook.Worksheets("ZSU")
        If Not Application.Intersect(Target, .Range("ZSU_Dat_UZS")) Is Nothing Then
            If Len(.Range("ZSU_Dat_PU")) > 0 And IsDate(.Range("ZSU_Dat_PU")) Then
                oDatumZdr = CDate(.Range("ZSU_Dat_PU"))
                oDatumZdrH = IIf(.Range("ZSU_Dat_UZS") = vbNullString, oDatumZdr, CDate(.Range("ZSU_Dat_UZS")))
                datum_nyni = CDate(Format(Now(), "d.m.yyyy"))
                If oDatumZdrH < oDatumZdr Or oDatumZdrH > datum_nyni Then
                    .Range("ZSU_Dat_UZS") = vbNullString
                    oDatumZdrH = oDatumZdr
                End If
                With UserForm_datum_Zdr.DTPicker1
                    '.MinDate = CDate("1.1.2000")
                    .MinDate = oDatumZdr
                    .MaxDate = datum_nyni
                    .Value = oDatumZdrH
                    .ControlTipText = "Zad|fffd|n|fffd| data ust|fffd|len|fffd| zdravotn|fffd|ho stavu"
                End With
                    
                With UserForm_datum_Zdr
                    .Label_Datum_min = oDatumZdr
                    .Label_Datum_max = datum_nyni
                    .Label3.Caption = "ust|fffd|len|fffd| zdravotn|fffd|ho stavu"
                    If .Visible = True Then .Hide Else .Show
                End With
            Else
                .Range("ZSU_Dat_PU").Select
            End If
            
        ElseIf Not Application.Intersect(Target, .Range("Kody_ZSU")) Is Nothing Then
            'nen|fffd|-li vypln|fffd|no 'Datum ust|fffd|len|fffd| zdravotn|fffd|ho stavu'
            If ActiveSheet.Range("C3").Value = "" Then
                ActiveSheet.Range("C3").Select
                Exit Sub
            End If
            
            'nen|fffd|-li vybr|fffd|no 'Vyber typ n|fffd|hrady'
            If ActiveSheet.Range("B4").Value = "<<< VYBER TYP N|fffd|HRADY" Then
                ActiveSheet.Range("B4").Select
                Exit Sub
            End If
            Call zobrazit_schovat_UserForm_ZSU_Tabs(Target)
        End If
    End With
    
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Dim target_nova_hodnota

If ZSU_dopsani_stav = 1 Then
    Application.EnableEvents = False
    ThisWorkbook.Worksheets("ZSU").Range("B37").FormulaR1C1 = ""
    Application.EnableEvents = True
    GoTo radek_ZSU_Change_konec:
End If

If (UserForm_ZSU_Tabs Is Nothing) Then
    UserForm_ZSU_Tabs.Hide
    Unload UserForm_ZSU_Tabs
End If

With ThisWorkbook.Worksheets("ZSU")
  If Not Application.Intersect(Target, .Range("ZSU_Dat_UZS")) Is Nothing Then
    
    .ZSU_OptionButton1 = False
    .ZSU_OptionButton2 = False
    'ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B516").FormulaR1C1 = NEPRAVDA
    
    If Year(.Range("ZSU_Dat_UZS").Value) >= 2014 Then
        .Shapes("ZSU_OptionButton1").Visible = True
        .Shapes("ZSU_OptionButton2").Visible = True
        .Shapes("Label1").Visible = True
    Else
        .Shapes("ZSU_OptionButton1").Visible = False
        .Shapes("ZSU_OptionButton2").Visible = False
        .Shapes("Label1").Visible = False
    End If
    
  
    If .Range("B4") = "" Then
        .Shapes("Textov|fffd|Pole 1").Visible = False
    Else
        If .Shapes("Label1").Visible = True Then .Shapes("Textov|fffd|Pole 1").Visible = True
    End If
    
    ZSU_prepocitat
    
  ' vyhled|fffd|n|fffd| zapsan|fffd| polo|fffd|ky ze seznamu a vlo|fffd|en|fffd| do kalkula|fffd|ky
  ElseIf Not Application.Intersect(Target, .Range("Kody_ZSU")) Is Nothing Then
    
    Application.ScreenUpdating = False
      Cislo_radku = 0
      u = Target.Row
      If Target.Value <> "" Then
            Application.EnableEvents = False
            target_nova_hodnota = Target.Value          'pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
            Application.Undo
            Target.Value = UCase(Trim(target_nova_hodnota))    'p|fffd|evod mal|fffd|ch p|fffd|smen na velk|fffd|, odstran|fffd|n|fffd| p|fffd|ebyte|fffd|n|fffd|ch mezer
            Application.EnableEvents = True
          
            'ZSU_ciselnik_konec_radek - definice v modulu Vyber_Listu
            Set C = ThisWorkbook.Worksheets("Seznam polo|fffd|ek").Range("B1000:B" & ZSU_ciselnik_konec_radek).Find(Target.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)
            If Not C Is Nothing Then
              Cislo_radku = C.Row - 1000
              u = Target.Row
              ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B" & u + 554) = Cislo_radku + 1 'zobrazen|fffd| nalezen|fffd| polo|fffd|ky v seznamu
              Castka = Target.Offset(0, 5)     'nab|fffd|dnut|fffd| |fffd||fffd|stka
              .Range("L" & u) = Castka          'zaps|fffd|n|fffd| nab|fffd|dnut|fffd| |fffd||fffd|stky
              .Range("B37").FormulaR1C1 = ""
            Else
              ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B" & 561 - 7 + u).FormulaR1C1 = 1
              .Range("B37").FormulaR1C1 = "Na |fffd||fffd|dku " & Target.Row & " je neexistuj|fffd|c|fffd| polo|fffd|ka!"
              Application.Wait (Now + TimeValue("0:00:2"))
            End If

      Else
            ThisWorkbook.Worksheets("Datov|fffd| list ODP").Range("B" & 561 - 7 + u).FormulaR1C1 = 1
            .Range("L" & u).FormulaR1C1 = 0
            .Range("B37").FormulaR1C1 = ""
      
      End If
      ''Close (False)
      .Range("B36").ClearContents
      If .Range("O" & u) = "" Then
        .Range("B36").FormulaR1C1 = .Range("E" & u)
      End If
      .Range("C" & u).Select
    
  End If
  
  If Not Application.Intersect(Target, .Range("Mnozstvi_ZSU")) Is Nothing Then
    ' zaps|fffd|n|fffd| nav|fffd||fffd|en|fffd| |fffd||fffd|stky p|fffd|i zm|fffd|n|fffd| mno|fffd|stv|fffd| v polo|fffd|ce
         
      u = ActiveCell.Row
      If .Range("h" & u) < 0 Then
        .Range("h" & u).FormulaR1C1 = 1
      End If
      If Target.Value <> "" Then
      Castka = Target.Offset(0, 1)
        If Castka <> "" Then
          Target.Offset(0, 5) = Castka
        End If
      End If
      .Range("B36").ClearContents
      If .Range("O" & u) = "" Then
        .Range("B36").FormulaR1C1 = .Range("E" & u)
      End If
      .Range("C" & u).Select
    
  End If

radek_ZSU_Change_konec:
Call BOL_ZSU_hledat_chyby("ZSU")

Application.ScreenUpdating = True

End With

End Sub



Private Sub zobrazit_schovat_UserForm_ZSU_Tabs(ByVal Target As Range)
    
    If ZSU_dopsani_stav = 1 Then
        Exit Sub
    End If
    
    Application.ScreenUpdating = False
    
    With UserForm_ZSU_Tabs
    
        If Not Application.Intersect(Target, ThisWorkbook.Worksheets("ZSU").Range("Kody_ZSU")) Is Nothing Then
            If Right(ThisWorkbook.Worksheets("ZSU").Range("B" & Target.Row).Value, 6) = " [Tab]" Then
                    
                If Left(ThisWorkbook.Worksheets("ZSU").Range("B" & Target.Row).Value, 4) = "032 " Then
                    .Image_032.Visible = True
                    .Image_035a.Visible = False
                    .Image_035b.Visible = False
                                
                ElseIf Left(ThisWorkbook.Worksheets("ZSU").Range("B" & Target.Row).Value, 4) = "035 " Then
                    .Image_032.Visible = False
                    .Image_035a.Visible = True
                    .Image_035b.Visible = True
                Else
                End If
                If Not .Visible Then
         
                    .StartUpPosition = 0
                    ZjistitRozliseniMonitoru
                    .Top = screen_o
                    .Left = screen_s * 0.75 - .Width - screen_o   ' * 0.75 p|fffd|epo|fffd|et z px rozli|fffd|en|fffd| na px userform
                    .Show
                End If
            Else
                If .Visible Then
                    .Hide
                    Unload UserForm_ZSU_Tabs
                End If
            
            End If
        End If
    
    End With
    
    Application.ScreenUpdating = True
End Sub
Private Sub ZSU_OptionButton1_Click()
    If ThisWorkbook.Sheets("ZSU").Shapes("Textov|fffd|Pole 1").Visible = True Then ThisWorkbook.Sheets("ZSU").Shapes("Textov|fffd|Pole 1").Visible = False
    ZSU_prepocitat
End Sub

Private Sub ZSU_OptionButton2_Click()
    If ThisWorkbook.Sheets("ZSU").Shapes("Textov|fffd|Pole 1").Visible = True Then ThisWorkbook.Sheets("ZSU").Shapes("Textov|fffd|Pole 1").Visible = False
    ZSU_prepocitat
End Sub
Attribute VB_Name = "ZSU_NS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    With ThisWorkbook.Worksheets("ZSU dle NS")
        If Not Application.Intersect(Target, .Range("ZSU_NS_Dat_UZS")) Is Nothing Then
            If Len(.Range("ZSU_NS_Dat_PU")) > 0 And IsDate(.Range("ZSU_NS_Dat_PU")) Then
                oDatumZdr = CDate(.Range("ZSU_NS_Dat_PU"))
                oDatumZdrH = IIf(.Range("ZSU_NS_Dat_UZS") = vbNullString, oDatumZdr, CDate(.Range("ZSU_NS_Dat_UZS")))
                datum_nyni = CDate(Format(Now(), "d.m.yyyy"))
                If oDatumZdrH < oDatumZdr Or oDatumZdrH > datum_nyni Then
                    .Range("ZSU_NS_Dat_UZS") = vbNullString
                    oDatumZdrH = oDatumZdr
                End If
                With UserForm_datum_Zdr.DTPicker1
                    '.MinDate = CDate("1.1.2000")
                    .MinDate = oDatumZdr
                    .MaxDate = datum_nyni
                    .Value = oDatumZdrH
                    .ControlTipText = "Zad|fffd|n|fffd| data ust|fffd|len|fffd| zdravotn|fffd|ho stavu"
                End With
                        
                With UserForm_datum_Zdr
                    .Label_Datum_min = oDatumZdr
                    .Label_Datum_max = datum_nyni
                    .Label3.Caption = "ust|fffd|len|fffd| zdravotn|fffd|ho stavu"
                    If .Visible = True Then .Hide Else .Show
                End With
            Else
                .Range("ZSU_NS_Dat_PU").Select
            End If
        ElseIf Not Application.Intersect(Target, .Range("ZSU_NS_bunka_vek")) Is Nothing Then
            If .Range("K136").Value = 0 Then .Range("H11").Offset(1, 0).Next.Select
            If .Range("ZSU_NS_Dat_UZS").Value = vbNullString Then .Range("ZSU_NS_Dat_UZS").Select
        
        ElseIf Not Application.Intersect(Target, .Range("ZSU_NS_bunka_aktivity")) Is Nothing Then
            If .Range("K136").Value = 0 Then .Range("H11").Offset(1, 0).Next.Select
            If .Range("ZSU_NS_bunka_vek").Value = vbNullString Then .Range("ZSU_NS_bunka_vek").Select
        End If
    End With
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim target_nova_hodnota As Variant, target_stara_hodnota As Variant, target_r As Long, target_s As Long, rng As Range, C As Range, _
    pol_od As Range, pol_do As Range, j_radku As Long, oblast_bunek As Range, ciselnik_rng As Range, ciselnik_stupen As Long, _
    chyba As Long, target_pom As String, text_pom As String
    
    If ActiveSheet.Name <> "ZSU dle NS" Then Exit Sub
    
    target_nova_hodnota = vbNullString: chyba = 0: target_pom = vbNullString: text_pom = vbNullString
    target_r = Target(1).Row
    target_s = Target(1).Column
    
    With ThisWorkbook.Sheets("ZSU dle NS")
        '1) pro hlavi|fffd|ku a pati|fffd|ku
        On Error Resume Next
        target_pom = Target(1).Name.Name
        If err.Number <> 0 Then chyba = err.Number
        On Error GoTo 0
        
        If chyba = 0 Then
            Application.EnableEvents = False
            If target_pom = "ZSU_NS_RC" Then
                If Target(1).NumberFormat <> "@" Then Target(1).NumberFormat = "@"
                text_pom = Target(1)
                text_pom = Trim(Replace(text_pom, "/", vbNullString))
                text_pom = Trim(Replace(text_pom, "!", vbNullString))
                Target(1).Value = text_pom
radek_ZSU_NS_RC:
                If text_pom <> vbNullString Then
                    If validace_RC(text_pom) = vbNullString Then
                        If text_pom <> vbNullString Then
radek_neplatne_datum:
                            .Range("ZSU_NS_Dat_narozeni_POS") = vbNullString
                            Target(1).Value = text_pom & " !!!"
                            Target(1).Select
                        End If
                    Else
                        If Year(CDate(datum_narozeni_z_RC(text_pom))) < 1890 Then GoTo radek_neplatne_datum
                        .Range("ZSU_NS_Dat_narozeni_POS") = Format(datum_narozeni_z_RC(text_pom), "dd.mm.yyyy")
                        '.Range("ZSU_NS_Dat_UZS").Select
                    End If
                End If
            ElseIf target_pom = "ZSU_NS_Dat_narozeni_POS" Then
                If .Range("ZSU_NS_RC") <> vbNullString Then
                    text_pom = .Range("ZSU_NS_RC")
                    GoTo radek_ZSU_NS_RC
                Else
radek_ZSU_NS_Dat_narozeni_POS:
                    If Target(1).NumberFormat <> "dd.mm.yyyy" Then Target(1).NumberFormat = "dd.mm.yyyy"
                    text_pom = Target(1)
                    text_pom = Replace(text_pom, ",", ".")
                    If Not IsDate(text_pom) Then
                        Target(1) = vbNullString
                        Target(1).Select
                    Else
                        text_pom = CDate(text_pom)
                        If CDate(text_pom) > Now() Then text_pom = CDate(DateSerial(Year(text_pom) - 100, Month(text_pom), Day(text_pom)))
                        If Year(CDate(text_pom)) < 1890 Then text_pom = ""
                        Target(1) = Format(text_pom, "dd.mm.yyyy")

                    End If
                End If
            ElseIf target_pom = "ZSU_NS_Dat_PU" Then
                GoTo radek_ZSU_NS_Dat_narozeni_POS
            ElseIf target_pom = "ZSU_NS_bunka_vek" Or target_pom = "ZSU_NS_bunka_aktivity" Then
                If Target(1).Offset(-1, 0).Value = vbNullString Then
                    Target(1).Value = vbNullString
                Else
                    If Target(1).Value <> vbNullString Then Target(1).Offset(1, -1).Next.Select
                End If
            End If
            
            Application.EnableEvents = True
            If target_pom = "ZSU_NS_Dat_UZS" Then
                If .Range("ZSU_NS_Dat_narozeni_POS").Value = vbNullString Then .Range("ZSU_NS_Dat_narozeni_POS").Select
            ElseIf target_pom = "ZSU_NS_Dat_narozeni_POS" Then
                If .Range("ZSU_NS_Dat_UZS").Value = vbNullString Then .Range("ZSU_NS_Dat_UZS").Select Else .Range("ZSU_NS_Dat_narozeni_POS").Select
            End If
        
        End If
        '1) konec - pro hlavi|fffd|ku a pati|fffd|ku
        
        
        '2) pro polo|fffd|ky seznamu
        If (target_s < 8 Or target_s > 11) And target_s <> 14 Then GoTo radek_wb_change_konec
        'Application.ScreenUpdating = False
        Set pol_od = .Range("B1:B" & .Cells(.Rows.Count, "B").End(xlUp).Row).Find("D1 *", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
        Set pol_do = .Range("B1:B" & .Cells(.Rows.Count, "B").End(xlUp).Row).Find("D1-D*", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
        
        If target_r < pol_od.Row Or target_r > pol_do.Row Then GoTo radek_wb_change_konec
            
        j_radku = pol_do.Row - pol_od.Row
            
        Set oblast_bunek = pol_od.Resize(j_radku, 1)
        'MsgBox oblast_bunek.Address(0, 0)
            
        Set rng = Nothing
            
        For Each C In oblast_bunek
            If UCase(C.Value) Like "D### *" Then
                'c.Offset(0, target_s - 2).Select
                If rng Is Nothing Then
                    Set rng = C.Offset(0, target_s - 2)
                Else
                    Set rng = Union(rng, C.Offset(0, target_s - 2))
                End If
            End If
        Next C
            
        If rng Is Nothing Then GoTo radek_wb_change_konec
        'If Not rng Is Nothing Then MsgBox rng.Address(0, 0)
        
        If Not (Intersect(Target, rng) Is Nothing) Then
            target_nova_hodnota = Trim(Target(1).Value)         '1|fffd|. pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
            
            If target_s = 10 Or target_s = 11 Then
                ciselnik_stupen = Target(1).Offset(0, -2).Value     'stara hodnota
                On Error Resume Next
                '1) z target_nova_hodnota dohled|fffd| nejbli|fffd||fffd||fffd| ni|fffd||fffd||fffd| hodnotu stupn|fffd| obt|fffd||fffd| (0-4) z |fffd||fffd|seln|fffd|ku obt|fffd||fffd|
                'ciselnik_stupen = WorksheetFunction.Match(Val(target_nova_hodnota), ThisWorkbook.Sheets("ZSU_pom_Tabulky").Range("ZSU_NS_cis_stupen_obtize_1"), 1) - 1
                '2) z target_nova_hodnota dohled|fffd| nejbli|fffd||fffd||fffd| hodnotu stupn|fffd| obt|fffd||fffd| (0-4) z |fffd||fffd|seln|fffd|ku obt|fffd||fffd| pomoc|fffd| Function obtize_nejblizsi_stupen(proc)
                ciselnik_stupen = obtize_nejblizsi_stupen(target_nova_hodnota)
                On Error GoTo 0
            End If
            
            chyba = 0
radek_chyba:
            If chyba = 0 Then
                Application.EnableEvents = False
                On Error Resume Next
                Application.Undo                                '2|fffd|. pro p|fffd||fffd|pad, |fffd|e je hodnota p|fffd||fffd| copy+paste vlo|fffd|ena v|fffd|etn|fffd| form|fffd|tov|fffd|n|fffd|
                If err.Number <> 0 Then chyba = err.Number
                On Error GoTo 0
                
                target_stara_hodnota = Trim(Target(1).Value)
                
                If target_s = 8 Or target_s = 9 Then
                    If target_nova_hodnota = vbNullString Then
                        Target(1).Offset(0, 2).Value = target_nova_hodnota
                    ElseIf IsNumeric(target_nova_hodnota) Then
                        Target(1).Offset(0, 2).Value = obtize_procento(target_nova_hodnota)
                    Else
                    End If
                
                ElseIf target_s = 10 Or target_s = 11 Then
                    If target_nova_hodnota = vbNullString Then
                        Target(1).Offset(0, -2).Value = target_nova_hodnota
                    ElseIf Not IsNumeric(target_nova_hodnota) Then
                        target_nova_hodnota = target_stara_hodnota
                    ElseIf IsNumeric(target_nova_hodnota) Then
                        target_nova_hodnota = target_nova_hodnota * 1
                        DoEvents
                        Target(1).Offset(0, -2).Value = ciselnik_stupen * 1
                    End If
                End If
                
                Target(1).Value = target_nova_hodnota
            End If
            
            Application.EnableEvents = True
        End If
        '2) konec - pro polo|fffd|ky seznamu
    
        If Target(1).Offset(1, -1).Next.Row > pol_od.Row And Target(1).Offset(1, -1).Next.Row < .Range("ZSU_NS_Likv").Row Then
            If (target_s >= 8 And target_s <= 11) Or target_s = 14 Then Target(1).Offset(1, -1).Next.Select
        End If

    End With

radek_wb_change_konec:
    'Application.ScreenUpdating = True
    Set pol_od = Nothing: Set pol_do = Nothing: Set oblast_bunek = Nothing: Set rng = Nothing: Set ciselnik_rng = Nothing
End Sub

Attribute VB_Name = "ZSU_NS_subs"
Option Explicit
'tento Sub pou|fffd||fffd|t jen p|fffd|i |fffd|prav|fffd|ch v sekc|fffd|ch polo|fffd|ek(p|fffd|id|fffd|n|fffd| / ubr|fffd|n|fffd|)
'Upozorn|fffd|n|fffd|: p|fffd|i p|fffd|id|fffd|n|fffd| / ubr|fffd|n|fffd| sloupc|fffd| nutn|fffd| prov|fffd|st |fffd|pravy v k|fffd|du !!! -> hlavn|fffd| Offset, Resize
Sub ZSU_NS_relativni_vaha()
    Dim sekce_pocet As Long, bunka_od As Range, bunka_do As Range, oblast_bunek As Range, oblast_pocet_polozek As Long, _
    C As Range, rng As Range, rng2 As Range, i As Long, j_radku As Long
    
    With ThisWorkbook.Sheets("ZSU dle NS")
    
        sekce_pocet = WorksheetFunction.CountIf(.Range("B1:B" & .Cells(.Rows.Count, "B").End(xlUp).Row), "D? C*")
        Set bunka_od = .Range("B1:B" & .Cells(.Rows.Count, "B").End(xlUp).Row).Find("D? *", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
        
        For i = 1 To sekce_pocet
        
            If i > 1 Then Set bunka_od = .Range(bunka_do.Offset(1, 0).Address & ":B" & .Cells(.Rows.Count, "B").End(xlUp).Row).Find("D? *", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            Set bunka_do = .Range(bunka_od.Offset(1, 0).Address(0, 0) & ":B" & .Cells(.Rows.Count, "B").End(xlUp).Row).Find("D? C", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns)
            'bunka_od.Offset(0, 5).Select
            bunka_od.Offset(0, 5).NumberFormat = "# ?/?"
            bunka_od.Offset(0, 5).Value = 1 / sekce_pocet
            'bunka_do.Offset(5, 0).Select
            
            j_radku = bunka_do.Row - bunka_od.Row + 1   '+1 tj. v|fffd|etn|fffd| 1.|fffd||fffd|dku v oblasti
            
            Set oblast_bunek = bunka_od.Resize(j_radku, 1)
            'MsgBox oblast_bunek.Address(0, 0)
            
            Set rng = Nothing
            
            For Each C In oblast_bunek
                If UCase(C.Value) Like "D### *" Then
                    'c.Offset(0, 5).Select
                    If rng Is Nothing Then
                        Set rng = C.Offset(0, 5)
                    Else
                        Set rng = Union(rng, C.Offset(0, 5))
                    End If
                End If
            Next C
            
            If Not rng Is Nothing Then
                'rng.Select
                oblast_pocet_polozek = rng.Count
                
                For Each C In rng
                    'c.Select
                    C.Value = 1 / oblast_pocet_polozek
                Next C
            End If
            
            'bunka_do.Offset(0, 11).Select
            If rng2 Is Nothing Then
                Set rng2 = bunka_do.Offset(0, 11)
            Else
                Set rng2 = Union(rng2, bunka_do.Offset(0, 11))
            End If
            
            'bunka_do.Offset(0, 11).Select
            bunka_do.Offset(0, 11).Formula = "=SUM(" & rng.Offset(0, 6).Address(0, 0) & ")"
            
        Next
        
        'bunka_do.Offset(2, 9).Select
        'bunka_do.Offset(2, 9).Formula = "=SUM(" & rng2.Address(0, 0) & ")"
        bunka_do.Offset(2, 9).Formula = "=if(abs(mod(SUM(" & rng2.Address(0, 0) & "),1))>0,round(SUM(" & rng2.Address(0, 0) & "),2),SUM(" & rng2.Address(0, 0) & "))"
        bunka_do.Offset(2, 9).NumberFormat = "General"
    End With
    
    Set bunka_od = Nothing: Set bunka_do = Nothing: Set oblast_bunek = Nothing: Set rng = Nothing: Set rng2 = Nothing

End Sub

Sub ZSU_NS_zobrazit_ciselnik()
    Dim tl_nazev As String, shp_nazev As String, shp As Shape
    tl_nazev = Application.Caller
    With ThisWorkbook.Sheets("ZSU dle NS")
        For Each shp In .Shapes
            shp_nazev = shp.Name
            If Not shp_nazev Like "*_tl_*" And Not shp_nazev Like "*tla|fffd||fffd|tko*" And Not shp_nazev Like "*Logo*" Then
                If shp_nazev <> Replace(tl_nazev, "tl_", vbNullString) Then
                    shp.Visible = False
                Else
                    If shp.Visible = True Then shp.Visible = False Else shp.Visible = True
                End If
            End If
        Next
    End With
End Sub

Sub ZSU_NS_zobrazit_ciselniky() 'jen pro v|fffd|voj
    Dim tl_nazev As String, shp_nazev As String, shp As Shape
    With ThisWorkbook.Sheets("ZSU dle NS")
        For Each shp In .Shapes
            shp.Visible = True
        Next
    End With
End Sub

Sub ZSU_NS_skryt_ciselnik()
    Application.EnableEvents = True
    'ThisWorkbook.Sheets("ZSU dle NS").Shapes("ZSU_ciselnik_aktivity").Visible = True
    ThisWorkbook.Sheets("ZSU dle NS").Shapes(Application.Caller).Visible = False
End Sub

Function validace_RC(ByVal RodneCislo As String) As String
    Dim kr_11_pom, rc
    
    RodneCislo = Trim(Replace(RodneCislo, "/", vbNullString))   'odstran|fffd|n|fffd| p|fffd||fffd|padn|fffd|ch po|fffd||fffd|te|fffd|n|fffd|ch a koncov|fffd|ch mezer a lom|fffd|tka v |fffd|et|fffd|zci
    
    '9-ti m|fffd|stn|fffd| rodn|fffd| |fffd||fffd|sla nelze ov|fffd||fffd|it
    If Len(RodneCislo) = 9 Then
        Select Case Mid(RodneCislo, 3, 1)
            Case 2, 3, 7, 8:    'nem|fffd||fffd|e nastat od r. 2004 m|fffd||fffd|e b|fffd|t na t|fffd|to pozici |fffd||fffd|slo 2,3,7,8, tj. Len(RodneCislo) m|fffd| b|fffd|t 10,
            Case Else:          GoTo radek_OK      'zpracov|fffd|ny budou jen ta R|fffd|, kter|fffd| lze ov|fffd||fffd|it
        End Select
        'GoTo radek_neOK
    
    'ov|fffd||fffd|en|fffd| 10-ti m|fffd|stn|fffd|ch rodn|fffd|ch |fffd||fffd|sel
    ElseIf Len(RodneCislo) = 10 Then
        If RodneCislo / 11 = Round(RodneCislo / 11, 0) Then
            GoTo radek_OK
        Else
            kr_11_pom = 0
            For rc = 1 To 10
                If Len(rc / 2) > 1 Then
                    kr_11_pom = kr_11_pom + Val(Mid(RodneCislo, rc, 1))
                Else
                    kr_11_pom = kr_11_pom - Val(Mid(RodneCislo, rc, 1))
                End If
            Next rc
            
            kr_11_pom = Abs(kr_11_pom Mod 11)
            If kr_11_pom = 1 And Right(RodneCislo, 1) = 0 Then GoTo radek_OK
        End If
    Else
    End If
    
radek_neOK:
    validace_RC = vbNullString
    Exit Function
    
radek_OK:
    validace_RC = RodneCislo
    
End Function

Function datum_narozeni_z_RC(ByVal RodneCislo As String) As String
    Dim r As Long, m As Long, d As Long, r_pom As Long
    
    
    If Len(RodneCislo) < 9 Or Len(RodneCislo) > 10 Then
        datum_narozeni_z_RC = vbNullString
        Exit Function
    End If
    
    r = Left(RodneCislo, 2)
    m = Mid(RodneCislo, 3, 2)
    d = Mid(RodneCislo, 5, 2)
    r_pom = 0
    
    Select Case m
        Case 71 To 82:  m = m - 70: r_pom = 2000    '|fffd|eny
        Case 51 To 62:  m = m - 50:                 '|fffd|eny
        Case 21 To 32:  m = m - 20: r_pom = 2000    'mu|fffd|i
        Case 1 To 12:                               'mu|fffd|i
    End Select
    
    If r_pom = 0 Then
        Select Case Len(RodneCislo)
            Case 9:     If r >= 54 Then r_pom = 1800 Else r_pom = 1900
            Case 10:    If r >= 54 Then r_pom = 1900 Else r_pom = 2000
        End Select
    End If
    
    r = r + r_pom
    
    datum_narozeni_z_RC = DateSerial(r, m, d)
End Function
Sub test_xx2()
'MsgBox validace_RC(Range("ZSU_NS_RC").Value)
MsgBox datum_narozeni_z_RC("000309123")
End Sub

Sub test_xx3()
                Dim A, B, C
                A = 22.5
                B = Range("J147:J151").Value
                A = Application.WorksheetFunction.Match(A, B, 0)

End Sub

Sub zobrazit_tlacitka_TIA()
    Dim stav As Boolean
    Application.EnableEvents = True
    
    With ThisWorkbook.Sheets("ZSU dle NS")
        .Unprotect
        stav = .Shapes("tla|fffd||fffd|tko 1").Visible
        If stav = True Then stav = False Else stav = True
        
        .Shapes("tla|fffd||fffd|tko 1").Visible = stav
        .Shapes("tla|fffd||fffd|tko 2").Visible = stav
        .Shapes("tla|fffd||fffd|tko 9").Visible = stav
        .Protect
    End With
End Sub

Function obtize_procento(ByVal stupen As Long) As Double
    Dim o_rng As Range, o_stupen() As Variant, i As Integer
    
    Set o_rng = ThisWorkbook.Sheets("ZSU_pom_Tabulky").Range("ZSU_NS_cis_stupen_obtize")
    o_stupen = o_rng
    
    obtize_procento = 0         'v|fffd|choz|fffd| v|fffd|sledek funkce
    For i = LBound(o_stupen) To UBound(o_stupen)
        If o_stupen(i, 1) = stupen Then
            'MsgBox o_stupen(i, 1) & " - " & o_stupen(i, 2)
            obtize_procento = o_stupen(i, 2)
            Exit For
        End If
    Next i
    
    Set o_rng = Nothing
End Function

Sub zzk()
    MsgBox obtize_procento("2")
End Sub

Function obtize_nejblizsi_stupen(ByVal proc As Double) As Long
    Dim o_rng As Range, o_stupen() As Variant, o_meze() As Variant, i As Integer, i_cnt As Long, prumer As Double
    
    Set o_rng = ThisWorkbook.Sheets("ZSU_pom_Tabulky").Range("ZSU_NS_cis_stupen_obtize_1")
    o_stupen = o_rng
    
    i_cnt = UBound(o_stupen)
    ReDim Preserve o_meze(0 To 1, 0 To i_cnt - 1)
    
    'zjistit pr|fffd|m|fffd|r mezi jednotliv|fffd|mi hodnotami kvantifik|fffd|toru (v %) - pr|fffd|m|fffd|ry ulo|fffd|it do pole o_meze()
    For i = LBound(o_stupen) To UBound(o_stupen)
        If i = i_cnt Then prumer = o_stupen(i, 1) Else prumer = (o_stupen(i, 1) + o_stupen(i + 1, 1)) / 2
        o_meze(0, i - 1) = o_stupen(i, 1)
        o_meze(1, i - 1) = prumer
        'msgbox o_stupen(i, 1) & " / " & o_meze(0, i - 1) & " - " & o_meze(1, i - 1)
    Next i
    
    Set o_rng = Nothing
    'msgbox o_meze(0, 0) & " - " & o_meze(1, 0)

    obtize_nejblizsi_stupen = 4         'v|fffd|choz|fffd| v|fffd|sledek funkce
    For i = 0 To UBound(o_meze, 2)
        If proc < o_meze(1, i) Then
            obtize_nejblizsi_stupen = i
            Exit For
        End If
    Next i
End Function

Attribute VB_Name = "ZTR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Znehodnocen|fffd|"
Sub Nacti_TAB_Znehodnoceni()
Attribute Nacti_TAB_Znehodnoceni.VB_Description = "Makro zaznamenan|fffd| 16.12.2005, jvincenc"
Attribute Nacti_TAB_Znehodnoceni.VB_ProcData.VB_Invoke_Func = " \n14"
    ActiveWorkbook.FollowHyperlink Address:="Znehodnoceni_opravou.pdf", _
    NewWindow:=True
End Sub
Sub Tabulka_Znehodnocen|fffd|_opravou()
    Sheets("Znehodnocen|fffd|").Select
    ActiveWindow.ScrollRow = 1
End Sub
Sub Vloz_Znehodnoceni_do_Vyp_POV()
    Application.ScreenUpdating = False
    Range("R29").Select
    Selection.Copy
    ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("G44:H44").Select
    ActiveSheet.Paste
    ActiveWindow.ScrollWorkbookTabs Position:=xlLast
    Sheets("Znehodnocen|fffd|").Select
    Application.CutCopyMode = False
    Range("R30").Select
    Selection.Copy
    ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("G43:H43").Select
    ActiveSheet.Paste
    Range("C46").Select
    ActiveWindow.ScrollWorkbookTabs Position:=xlLast
    Sheets("Znehodnocen|fffd|").Select
    Application.CutCopyMode = False
    ActiveWindow.SmallScroll Down:=-2
    ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("C46").Select
    Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Znehodnocen|fffd|_Data"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "all"

'k ZjistitRozliseniMonitoru()
Public Declare Function GetSystemMetrics Lib "user32.dll" (ByVal nIndex As Long) As Long
Const SM_CXSCREEN = 0
Const SM_CYSCREEN = 1
Public screen_s As Long, screen_v As Long
Public Const screen_o = 5   'odsazen|fffd| px od okraje monitoru - aby userform nebyl "nalepen|fffd|" |fffd|pln|fffd| na okraji monitoru

'posledn|fffd| list, ListX_vytvo|fffd|it/p|fffd|ej|fffd|t
Public posl_list, posl_list2

'ostatn|fffd|
Public uzivatel, datum_nyni As Date, oDatumZdr As Date, oDatumZdrH As Date

Public Sub ZjistitRozliseniMonitoru()
    screen_s = GetSystemMetrics(SM_CXSCREEN)
    screen_v = GetSystemMetrics(SM_CYSCREEN)
End Sub

Sub Nacti_XMLView()
    Dim xlApp As Excel.Application
    Set xlApp = CreateObject("Excel.Application")
    xlApp.Workbooks.Open ("\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\XMLView.xls")
    xlApp.Quit
    Set xlApp = Nothing
End Sub


Sub zjistit_subjekt(PU)
    'strPripad = Range(ActiveSheet.CodeName + "_Pripad")
    strSubj = IIf(Len(PU) = 10 And (Left(PU, 1) = "3" Or Left(PU, 1) = "7"), "GP", "|fffd|P")
End Sub
Sub nastavit_CP(list_nazev) 'nastav|fffd| logo a oblast _KDO na |fffd|P - v|fffd|choz|fffd| po vymaz|fffd|n|fffd| dat z listu
Dim p
    With ThisWorkbook.Sheets(list_nazev)
        If .ProtectContents = True Then p = 1 Else p = 0
        If p = 1 Then .Unprotect ("0309")
        
        If NewFirma Then
            If existuje_li_range_nazev(.CodeName + "_KDO") = True Then .Range(.CodeName + "_KDO").FormulaR1C1 = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
            
            If existuje_li_shape_nazev(.Name, "Logo_CP") Then .Shapes("Logo_CP").Visible = False
            If existuje_li_shape_nazev(.Name, "Logo_GP") Then .Shapes("Logo_GP").Visible = False
            If existuje_li_shape_nazev(.Name, "Logo_GCP") Then .Shapes("Logo_GCP").Visible = True
        Else
            If existuje_li_range_nazev(.CodeName + "_KDO") = True Then .Range(.CodeName + "_KDO").FormulaR1C1 = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
            
            If existuje_li_shape_nazev(.Name, "Logo_CP") Then .Shapes("Logo_CP").Visible = True
            If existuje_li_shape_nazev(.Name, "Logo_GP") Then .Shapes("Logo_GP").Visible = False
            If existuje_li_shape_nazev(.Name, "Logo_GCP") Then .Shapes("Logo_GCP").Visible = False
        End If
        
        If existuje_li_shape_nazev(.Name, "Btn2") = True Then .Shapes("Btn2").Visible = True 'False     'tla|fffd||fffd|tko "Ov|fffd||fffd|en|fffd| limitu pln|fffd|n|fffd|
        If p = 1 Then .Protect ("0309")
    End With
End Sub

Function NewFirma() As Boolean
    NewFirma = ThisWorkbook.Name Like "V|fffd|po|fffd|et_pln|fffd|n|fffd|_ODP_GCP*" Or Date >= #12/21/2019#
End Function

Private Sub NewLogo() 'po nasazen|fffd| nov|fffd|ho loga lze smazat
    With ThisWorkbook.Sheets(ActiveSheet.Name)
        .Shapes("Logo_GCP").Left = .Shapes("Logo_GP").Left
        .Shapes("Logo_GCP").Top = .Shapes("Logo_GP").Top
        .Shapes("Logo_GCP").Height = .Shapes("Logo_GP").Height
        .Shapes("Logo_GCP").LockAspectRatio = msoFalse
        .Shapes("Logo_GCP").Width = .Shapes("Logo_GCP").Height / 2 * 12.6
        .Shapes("Logo_GP").Visible = False
        .Shapes("Logo_CP").Visible = False
    End With
End Sub
Private Sub NewLogo2() 'po nasazen|fffd| nov|fffd|ho loga lze smazat
    With ThisWorkbook.Sheets(ActiveSheet.Name)
        .Shapes("Logo_GCP").Visible = False
        .Shapes("Logo_GP").Visible = False
        .Shapes("Logo_CP").Visible = True
    End With
End Sub


Function naplnit_ciselnik_rok(rok_min As Long) As Variant
    Dim rok_max As Long, v() As Variant, i As Long
    rok_max = Right(ThisWorkbook.Sheets("Datov|fffd| list ODP").Range("A485").Value, 4)  'podle hodnoty RRRR |fffd||fffd|seln|fffd|ku 'Sv|fffd|pomocn|fffd| ceny RRRR'
    i = rok_max - rok_min
    ReDim v(0 To i)
    If i > 0 Then
        For A = 0 To i
            v(A) = rok_max - A
        Next
    Else
        v(0) = rok_max
    End If
    naplnit_ciselnik_rok = v
End Function

Sub aktualizovat_ciselnik_rok()
    Dim puvodni As String, atualni As String
    With ThisWorkbook.Sheets("V|fffd|po|fffd|et Ztr|fffd|ta na v|fffd|d|fffd|lku").Range("E10").Validation
        puvodni = Replace(.Formula1, ";", ",")
        aktualni = Join(naplnit_ciselnik_rok(2010), ",")
        If puvodni <> aktualni Then
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:=aktualni
            .IgnoreBlank = True
            .InCellDropdown = True
            .InputTitle = ""
            .ErrorTitle = ""
            .InputMessage = ""
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = True
            MsgBox "Na listu 'V|fffd|po|fffd|et Ztr|fffd|ta na v|fffd|d|fffd|lku', v bu|fffd|ce 'E10' byl zm|fffd|n|fffd|n |fffd||fffd|seln|fffd|k" & vbLf & vbLf & _
                    "z p|fffd|vodn|fffd|: " & vbLf & puvodni & vbLf & vbLf & _
                    "na aktu|fffd|ln|fffd|: " & vbLf & aktualni
        Else
            MsgBox "|fffd||fffd|seln|fffd|k na listu 'V|fffd|po|fffd|et Ztr|fffd|ta na v|fffd|d|fffd|lku', v bu|fffd|ce 'E10' beze zm|fffd|n."
        End If
    End With

End Sub

Sub upravit_KDO() 'ur|fffd|eno jen pro re|fffd|im administr|fffd|tora - ru|fffd|n|fffd| spou|fffd|t|fffd|n|fffd|

    Application.ScreenUpdating = False
    For Each list In ThisWorkbook.Sheets
        With list
            'MsgBox .CodeName
            '.Activate
            .Unprotect ("0309")
            If existuje_li_range_nazev(.CodeName & "_KDO") = True Then
                If NewFirma Then
                    Range(.CodeName & "_KDO").Validation.Delete
                    Range(.CodeName & "_KDO") = "Generali |fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
                Else
                    With Range(.CodeName & "_KDO").Validation
                        .Delete
                        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                         xlBetween, Formula1:="|fffd|esk|fffd| poji|fffd||fffd|ovna a.s., Generali poji|fffd||fffd|ovna a.s."
                        .IgnoreBlank = True
                        .InCellDropdown = True
                        .InputTitle = ""
                        .ErrorTitle = ""
                        .InputMessage = ""
                        .ErrorMessage = ""
                        .ShowInput = False
                        .ShowError = False
                    End With
                End If
            End If
            '.Protect ("0309")
        End With
    Next list
    Application.ScreenUpdating = True
    MsgBox "hotovo"
End Sub

Function existuje_li_range_nazev(nazev) As Boolean
Dim nazev_pom
    nazev_pom = "X"
    On Error Resume Next
        nazev_pom = Len(Names(nazev).Name)
    On Error GoTo 0
        
    If nazev_pom = "X" Then existuje_li_range_nazev = False Else existuje_li_range_nazev = True
End Function
Function existuje_li_shape_nazev(nazev_listu, nazev_shape) As Boolean
Dim nazev_pom
    nazev_pom = "X"
    On Error Resume Next
    nazev_pom = ThisWorkbook.Sheets(nazev_listu).Shapes(nazev_shape).Name
    On Error GoTo 0
        
    If nazev_pom = "X" Then existuje_li_shape_nazev = False Else existuje_li_shape_nazev = True
    
    ''um|fffd|st|fffd|n|fffd| log na listu vzhledem k bu|fffd|ce B2
    'If nazev_pom <> "X" and nazev_shape = "Logo_CP" Then
    '    ThisWorkbook.Sheets(nazev_listu).Shapes(nazev_shape).Top = ThisWorkbook.Sheets(nazev_listu).Range("B2").Top - 4
    '    ThisWorkbook.Sheets(nazev_listu).Shapes(nazev_shape).Left = ThisWorkbook.Sheets(nazev_listu).Range("B2").Left - 4
    'Else
    '    ThisWorkbook.Sheets(nazev_listu).Shapes(nazev_shape).Top = ThisWorkbook.Sheets(nazev_listu).Range("B2").Top
    '    ThisWorkbook.Sheets(nazev_listu).Shapes(nazev_shape).Left = ThisWorkbook.Sheets(nazev_listu).Range("B2").Left
    'End If
End Function

Sub zobrazit_listy()
    Application.ScreenUpdating = False

    For Each list In ThisWorkbook.Sheets
        list.Visible = True
    Next list
    
    For Each list In ThisWorkbook.Sheets
        With list
            'Z|fffd|silky Dopis - ZADO
            'V|fffd|platn|fffd| Dopis - Dopis
            'Dopis VRATKY - VRATKY
            
            
            If .Name <> "|fffd|vodn|fffd| list" And .Name <> "Confirmation" Then
                        '.Name <> "V|fffd|platn|fffd| dopisx" And _
                        '.Name <> "Dopis vratkyx" And _
                        '.Name <> "Z|fffd|silky dopisx" And _
                        .Name <> "Confirmation" Then
                '.Visible = False
            End If
        End With
    Next list
    
    Application.ScreenUpdating = True
    MsgBox "hotovo"

End Sub

Sub pridat_List()
Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    Set ws = Nothing
End Sub

Function zjistit_prvni_volne_cislo_listu(nazev_listu)
    zjistit_prvni_volne_cislo_listu = 1 'v|fffd|chozi hodnota
    
    Dim sh As Worksheet, sh_pocet, sh_nazev
    sh_pocet = 0
    
    With ThisWorkbook
        For Each sh In .Sheets
            If sh.Name Like nazev_listu & "*" Then
                sh_pocet = sh_pocet + 1
                sh_nazev = sh.Name
            End If
        Next sh
    
        If sh_pocet = Val(Replace(sh_nazev, "List", vbNullString)) Then
            zjistit_prvni_volne_cislo_listu = sh_pocet
            Exit Function
        End If
        
        For i = 1 To sh_pocet + 1
            On Error Resume Next
            .Sheets(nazev_listu & i).Name = nazev_listu & i
            i_chyba = err.Number
            On Error GoTo 0
            If i_chyba <> 0 Then
                zjistit_prvni_volne_cislo_listu = i
                Exit For
            End If
        Next i
    End With

End Function

Function zjistit_prvni_ListX(nazev_listu)
    zjistit_prvni_ListX = vbNullString 'v|fffd|chozi hodnota
    
    Dim sh As Worksheet, aSh, tSh
    
    With ThisWorkbook
        aSh = .ActiveSheet.Name
        
        For Each sh In .Sheets
            tSh = sh.Name
            If tSh Like "List" & "*" Then
                If sh.PageSetup.LeftFooter = aSh Then
                    zjistit_prvni_ListX = tSh
                    Exit For
                End If
            End If
        Next sh

    End With

End Function

Sub vlozit_tlacitka(posledni_list)
    Dim t As Range, btn As Shape, btn_left, btn_left_pom, btn_vyska
    btn_left = 1.2
    btn_left_pom = btn_left
    btn_vyska = 16
    
    Application.ScreenUpdating = False
    vlastnosti_stranky
    
    With ThisWorkbook.ActiveSheet
          With .PageSetup
            .LeftFooter = posledni_list
            .CenterFooter = "str|fffd|nek:  &P / &N"
            .RightFooter = "Tisk: &D"
            
            '.LeftHeader = ""
            .CenterHeader = "k PU: " & ThisWorkbook.Sheets(posledni_list).Range(ThisWorkbook.Sheets(posledni_list).CodeName & "_Pripad") & "  ( " & posledni_list & " )"
            .RightHeader = "p|fffd||fffd|loha |fffd|. " & Replace(ThisWorkbook.ActiveSheet.Name, "List", vbNullString)
          End With
          
          Call pridat_logo_do_LeftHeader(ThisWorkbook.ActiveSheet.Name, Left(ThisWorkbook.Sheets(posledni_list).Range(ThisWorkbook.Sheets(posledni_list).CodeName & "_KDO"), 6))
          
          Set t = .Range("A1")
          Set btn = .Shapes.AddShape(msoShapeRoundedRectangle, btn_left_pom, btn_left, 88, btn_vyska)
          With btn
            .OnAction = "prejit_na_list2"
            .TextFrame2.TextRange.Characters.Text = "zp|fffd|t na V|fffd|po|fffd|et"
            .Name = "Btn1"
            btn_left_pom = btn.Left + btn.Width + 8
          End With
          
          Set btn = .Shapes.AddShape(msoShapeRoundedRectangle, btn_left_pom, btn_left, 84, btn_vyska)
          With btn
            .OnAction = "vlozit_textbox"
            .TextFrame2.TextRange.Characters.Text = "vlo|fffd|it TXT pole"
            .Name = "Btn2"
            btn_left_pom = btn.Left + btn.Width + 8 + btn_left
          End With
          
          Set btn = .Shapes.AddShape(msoShapeRoundedRectangle, btn_left_pom, btn_left, 84, btn_vyska)
          With btn
            .OnAction = "vybrat_vsechny_objekty"
            .TextFrame2.TextRange.Characters.Text = "ozna|fffd|it objekty"
            .Name = "Btn3"
            btn_left_pom = btn.Left + btn.Width + 8 + btn_left
          End With
          
          Set btn = .Shapes.AddShape(msoShapeRoundedRectangle, btn_left_pom, btn_left, 104, btn_vyska)
          With btn
            .OnAction = "prizpusobit_objekty"
            .TextFrame2.TextRange.Characters.Text = "p|fffd|izp|fffd|sobit objekty"
            .Name = "Btn4"
            btn_left_pom = btn.Left + btn.Width + 14 + btn_left
          End With
          
          Set btn = .Shapes.AddShape(msoShapeRoundedRectangle, btn_left_pom, btn_left, 30, btn_vyska)
          With btn
            .OnAction = "zobrazit_info_ListX"
            .TextFrame2.TextRange.Characters.Text = "???"
            .Name = "Btn5"
          End With
          
          .Range("A3").Select
    
    End With
    
    Set t = Nothing: Set btn = Nothing
    naformatovat_tlacitka
    ActiveWindow.View = xlPageLayoutView
    privolat_tlacitka
    
    Application.ScreenUpdating = True

End Sub

Sub vlastnosti_stranky()
    With ThisWorkbook.ActiveSheet.PageSetup
        .LeftMargin = Application.InchesToPoints(0.196850393700787)
        .RightMargin = Application.InchesToPoints(0.196850393700787)
        .TopMargin = Application.InchesToPoints(0.590551181102362)
        .BottomMargin = Application.InchesToPoints(0.590551181102362)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
    End With
End Sub

Sub naformatovat_tlacitka()    'od pozice kurzoru / objektu
    Dim shp As Shape
    On Error GoTo radek_nt_konec
    With ThisWorkbook.ActiveSheet
        'MsgBox .Shapes.Count
        For Each shp In .Shapes
            With shp
                If .Type = 1 Then    'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 1 = autom. objekt
                    .Placement = xlFreeFloating
                    .ControlFormat.LockedText = True
                    .ControlFormat.PrintObject = False
                    'With .Glow     'z|fffd||fffd|e okraje obrazce
                    '    .Color.SchemeColor = 3
                    '    .Color.TintAndShade = 0
                    '    .Color.Brightness = 0
                    '    .Transparency = 0.6
                    '    .Radius = 0.5
                    'End With
                    With .Fill      'v|fffd|pl|fffd| obrazce
                        .ForeColor.SchemeColor = 5  '|fffd|lut|fffd|:5 / sv|fffd|tloncezelen|fffd|:42
                        .Transparency = 0.6
                    End With
                    With .Line      'okraj obrazce
                        .Weight = 2
                        .Visible = msoTrue
                        .ForeColor.SchemeColor = 3  '|fffd|erven|fffd|:2 / sv|fffd|tlezelen|fffd|:3
                        .Transparency = 0.4
                    End With
                    With .TextFrame2
                        .VerticalAnchor = msoAnchorMiddle
                        .HorizontalAnchor = msoAnchorCenter
                        With .TextRange.Font
                            .Bold = True
                            .Size = 11
                            .Name = "Arial"
                            Select Case Right(shp.Name, 1)
                                Case 1: .Fill.ForeColor.SchemeColor = 6 'r|fffd||fffd|ov|fffd|:6
                                Case 5: .Fill.ForeColor.SchemeColor = 2 '|fffd|erven|fffd|:2 / hn|fffd|do|fffd|erven|fffd|:25
                                Case Else: .Fill.ForeColor.SchemeColor = 0 '|fffd|ern|fffd|:0
                            End Select
                            'With .line     'obrys p|fffd|sma
                            '    .Visible = msoTrue
                            '    .ForeColor.SchemeColor = 5  'b|fffd|l|fffd|:1 / |fffd|lut|fffd|:5
                            '    '.ForeColor.ObjectThemeColor = msoThemeColorBackground1
                            '    .ForeColor.TintAndShade = 0
                            '    .ForeColor.Brightness = 0
                            '    .Transparency = 0
                            '    .Weight = 0.3
                            'End With
                            With .Glow      'z|fffd||fffd|e p|fffd|sma
                                .Color.SchemeColor = 5  'b|fffd|l|fffd|:1 / |fffd|lut|fffd|:5
                                .Transparency = 0.4
                                .Radius = 12
                            End With
                        End With
                    End With
                End If
            End With
        Next shp
    End With
    
radek_nt_konec:
    On Error GoTo 0
    'Application.ScreenUpdating = True

End Sub

Sub prejit_na_list2()
Attribute prejit_na_list2.VB_ProcData.VB_Invoke_Func = "q\n14"
    If ThisWorkbook.ActiveSheet.Name Like "List*" Then
        prejit_na_list_1a
    Else
        prejit_na_list_1b
    End If
End Sub

Sub prejit_na_list_1a()
    With ThisWorkbook
        privolat_tlacitka
        posl_list = .ActiveSheet.PageSetup.LeftFooter
        posl_list2 = .ActiveSheet.Name
        .Sheets(posl_list).Activate
    End With
End Sub

Sub prejit_na_list_1b()
    'MsgBox "prejit_na_list2: " & posl_list2
    
    With ThisWorkbook.ActiveSheet
        If .Name = "|fffd|vodn|fffd| list" Then Exit Sub
        If Len(.Range(ThisWorkbook.Sheets(.Name).CodeName & "_Pripad").Text) = 0 Then Exit Sub
        ActiveWindow.ScrollWorkbookTabs Position:=xlLast
        
        If zjistit_prvni_ListX(.Name) = vbNullString Then
            posl_list = .Name
            pridat_List
        Else
            On Error Resume Next
            If .Name = ThisWorkbook.Sheets(posl_list2).PageSetup.LeftFooter Then
            If err.Number <> 0 Then GoTo radek_zjistit_prvni_ListX
                ThisWorkbook.Sheets(posl_list2).Activate
            Else
radek_zjistit_prvni_ListX:
                On Error GoTo 0
                ThisWorkbook.Sheets(zjistit_prvni_ListX(.Name)).Activate
            End If
        End If
    End With
End Sub

Sub vlozit_textbox()
    Dim shp As Shape, s As Range, txt_box As Shape, txt_box_pocet, txt_sirka, txt_chyba
    
    With ThisWorkbook.ActiveSheet
        txt_sirka = .Range(Cells(1, 1), Cells(1, zjistit_posledni_sloupec_na_strance_1)).Width - 5
        
        Set s = ActiveCell
        txt_box_pocet = zjistit_prvni_volne_cislo("TxtBox_")
        
        Set txt_box = .Shapes.AddTextbox(msoTextOrientationHorizontal, 0, s.Top, txt_sirka, 20)
        DoEvents
        With txt_box
            .Name = "TxtBox_" & txt_box_pocet
            .TextFrame.Characters.Text = "TxtBox_" & txt_box_pocet & ": "
            .TextFrame.Characters(1, .TextFrame2.TextRange.Length - 1).Font.Bold = True
            .TextFrame2.AutoSize = msoAutoSizeShapeToFitText
            .Line.Visible = msoFalse
            .Locked = False
            .Placement = xlFreeFloating
            .ZOrder msoBringForward
            '.TextFrame2.TextRange.Select
            .Select
        End With
    End With
    Set s = Nothing: Set txt_box = Nothing: Set s = Nothing
    privolat_tlacitka
End Sub

Sub vybrat_vsechny_objekty()    'od pozice kurzoru / objektu
    Dim shp As Shape, objekty_pom(), objekty_pocet, aktualni_vyber As Variant
    Application.ScreenUpdating = False
    objekty_pocet = -1
    
On Error GoTo radek_vvo_konec
    With ThisWorkbook.ActiveSheet
        Set aktualni_vyber = Selection
        DoEvents
        
        For Each shp In .Shapes
            With shp
                If Not .Type = 8 And Not .Type = 1 Then    'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 1 = autom. objekt
                    If shp.Top >= aktualni_vyber.Top Then
                        objekty_pocet = objekty_pocet + 1
                        ReDim Preserve objekty_pom(0 To objekty_pocet)
                        objekty_pom(objekty_pocet) = .Name
                    End If
                End If
            End With
        Next shp
        If objekty_pocet > -1 Then .Shapes.Range(objekty_pom).Select
        DoEvents
    End With
    
radek_vvo_konec:
    Set aktualni_vyber = Nothing
    privolat_tlacitka
    Application.ScreenUpdating = True

End Sub

Function zjistit_prvni_volne_cislo(nazev_objektu)
    zjistit_prvni_volne_cislo = 1 'v|fffd|chozi hodnota
    Dim shp As Shape, shp_pocet, i, i_chyba
    shp_pocet = zjistit_pocet_objektu(nazev_objektu)
    
    With ThisWorkbook.ActiveSheet
        For i = 1 To shp_pocet + 1
            On Error Resume Next
            .Shapes(nazev_objektu & i).Name = nazev_objektu & i
            i_chyba = err.Number
            On Error GoTo 0
            If i_chyba <> 0 Then
                zjistit_prvni_volne_cislo = i
                Exit For
            End If
        Next i
    End With

End Function

Function zjistit_pocet_objektu(nazev_objektu)
    zjistit_pocet_objektu = 0 'v|fffd|chozi hodnota
    Dim shp As Shape, shp_pocet, i, i_chyba
    shp_pocet = 0
    For Each shp In ThisWorkbook.ActiveSheet.Shapes
        If shp.Name Like nazev_objektu & "*" Then shp_pocet = shp_pocet + 1
    Next shp

    zjistit_pocet_objektu = shp_pocet
End Function

Function zjistit_posledni_sloupec_na_strance_1()
    Dim sloupec_pom As Long
    With ThisWorkbook.ActiveSheet
        'zajistit, |fffd|e existuje v|fffd|ce ne|fffd| 1 str|fffd|nka k vyti|fffd|t|fffd|n|fffd| - do 1. bu|fffd|ky posledn|fffd|ho sloupce n|fffd|co zadat (nap|fffd|. |fffd||fffd|slo 0)
        .Cells(1, .Columns.Count) = 0
        sloupec_pom = .VPageBreaks(1).Location.Column - 1
        'smazat posledn|fffd| sloupec aby se obnovila pou|fffd|it|fffd| oblast a vymazala 1. bu|fffd|ka posledn|fffd|ho sloupce
        .Cells(1, .Columns.Count).EntireColumn.Delete
    End With
    zjistit_posledni_sloupec_na_strance_1 = sloupec_pom
End Function


Sub prizpusobit_objekty()
Attribute prizpusobit_objekty.VB_ProcData.VB_Invoke_Func = "a\n14"
'
    Dim curr_cell As Range, sirka, shp As Shape, popisek As Shape, skupina As Shape, skupina_pom, skupina_pom2, status_bar_old
    
    With ThisWorkbook.ActiveSheet
        If Not .Name Like "List*" Then Exit Sub
    
        'jen kv|fffd|li tomu, |fffd|e v tomto zobrazen|fffd| obrazovka m|fffd|n|fffd| 'divo|fffd||fffd|' + nav|fffd|c je patrn|fffd|j|fffd||fffd|, |fffd|e akce je ji|fffd| dokon|fffd|ena
        ActiveWindow.View = xlNormalView
        
        On Error GoTo radek_po_konec
        
        'statusbaru p|fffd|id|fffd|n pr|fffd|b|fffd|h akce
        Application.StatusBar = ""
        status_bar_old = Application.StatusBar
        Application.StatusBar = "P|fffd|izp|fffd|sobit objekty ... akce z|fffd|h|fffd|jena ... |fffd|ekejte ..."
    
        sirka = .Range(Cells(1, 1), Cells(1, zjistit_posledni_sloupec_na_strance_1)).Width - 5
        
        'workarround kv|fffd|li zn|fffd|m|fffd| chyb|fffd| Microsoftu - viz https://support.microsoft.com/en-us/kb/210663
        'slou|fffd||fffd| k zabezbe|fffd|en|fffd| bezprobl|fffd|mov|fffd|ho chodu HPageBreaks (VPageBreaks)
        .Cells(ActiveCell.Row, 1).Activate
        Set curr_cell = ActiveCell
'        'MsgBox curr_cell.Address
        .Cells(.Rows.Count, .Columns.Count).Activate
        curr_cell.Activate
        'konec workarround
        
        Application.ScreenUpdating = False
        
        For Each shp In .Shapes
            With shp                    'shp.Type = 8 msoFormControl, 17 = msoTextBox, 6 = msoGroup, 1 = msoAutoShape
                If .Type = 6 Then       'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 6 = skupina, 1 = autom. objekt
                    If .Width > sirka Or .Left > 0 Then
                        If .Left > 0 Then .Left = 0
                        If .Width > sirka Then .Width = sirka
                    End If
                    DoEvents
                ElseIf Not .Type = 6 And Not .Type = 8 And Not .Type = 17 And Not .Type = 1 Then        'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 6 = skupina, 1 = autom. objekt
                    If .Width > sirka Or .Left > 0 Then
                        If .Left > 0 Then .Left = 0
                        If .Width > sirka Then .Width = sirka
                    End If
                    .Placement = xlFreeFloating
                    .LockAspectRatio = msoTrue
                    DoEvents
                    
                    With ThisWorkbook.ActiveSheet
                        Set popisek = .Shapes.AddTextbox(msoTextOrientationHorizontal, 0, shp.Top + shp.Height, sirka, 20)
                        DoEvents
                        With popisek
                            .TextFrame.Characters.Text = "Obr|fffd|zek XXX: "
                            .TextFrame2.AutoSize = msoAutoSizeShapeToFitText
                            .Line.Visible = msoFalse
                            .Placement = xlFreeFloating
                            .ZOrder msoBringForward
                            DoEvents
                        End With
                        
                        On Error Resume Next
radek_skupina_znovu:
                        Set skupina = .Shapes.Range(Array(shp.Name, popisek.Name)).group
                        'm|fffd||fffd|e se p|fffd|ihodit, |fffd|e n|fffd|zev aktu|fffd|ln|fffd|ho shp (obr|fffd|zku) je u|fffd| pou|fffd|it|fffd| (mo|fffd|n|fffd| dal|fffd||fffd| neo|fffd|et|fffd|en|fffd| chyba Microsoftu) - pak vytvo|fffd|en|fffd| shp 'skupina' skon|fffd||fffd| chybou
                        'tak|fffd|e nyn|fffd| bude prob|fffd|hat p|fffd|ejmenov|fffd|n|fffd| obr|fffd|zku
                        If skupina Is Nothing Then
                            'MsgBox "OK"
                            'MsgBox nahradit_co2(shp.Name)
                            shp.Name = nahradit_co2(shp.Name)
                            GoTo radek_skupina_znovu
                        End If
                        'Pozn.: u shp 'popisek' se mi je|fffd|t|fffd| nestalo, |fffd|e by byla duplicita n|fffd|zv|fffd| - tak|fffd|e jsem zat|fffd|m neo|fffd|et|fffd|il
                        
                        On Error GoTo radek_po_konec
                        DoEvents
                        With skupina
                            .Placement = xlFreeFloating
                        End With
                        DoEvents

                        Set popisek = Nothing
                        Set skupina = Nothing
                    End With

                ElseIf .Type = 17 Then      'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 6 = skupina
                    If Len(.TextFrame.Characters.Text) > 0 Then
                        If Not .Name Like "TxtBox_*" Then
                            .Delete                     'vymaz|fffd|n|fffd| popisku bez obr|fffd|zku
                        Else
                            'MsgBox .Name
                            .Left = 0
                            .Width = sirka
                            .Line.Visible = msoFalse
                            .Placement = xlFreeFloating
                            .TextFrame2.AutoSize = msoAutoSizeShapeToFitText
                            .ZOrder msoBringForward
                            'If Len(.OnAction) = 0 Then .OnAction = "privolat_tlacitka"
                        End If
                        '.Select
                    Else
                        .Delete
                    End If
                    DoEvents
                End If
            End With
        Next shp
    End With
    DoEvents
    usporadat_objekty
    privolat_tlacitka

radek_po_konec:
    On Error GoTo 0
    Set curr_cell = Nothing
    Application.ScreenUpdating = True
    ActiveWindow.View = xlPageLayoutView
    Application.StatusBar = "P|fffd|izp|fffd|sobit objekty ... akce dokon|fffd|ena"
    Application.StatusBar = status_bar_old

End Sub

Function nahradit_co2(ByVal kde As String) As String
    Dim objRegex, nalezeno, cislo
    Set objRegex = CreateObject("vbscript.regexp")
    With objRegex
         .Global = True
         .Pattern = "\d+"
        Set nalezeno = .Execute(kde)
        If nalezeno.Count <> 0 Then
            cislo = nalezeno.Item(0) + 1
            nahradit_co2 = .Replace(kde, cislo)
        Else
            nahradit_co2 = vbNullString
        End If
    End With
    Set objRegex = Nothing
End Function

Sub usporadat_objekty()
    Dim shp As Shape, shp_sirka_pom, shp_t, shp_b, shp_items As Object, txt_pom, obj(), obj_pocet, A, obj_pozice
    Dim HPgB As HPageBreak, HPgB_r, obr_cislo
    
    On Error GoTo radek_uo_konec
    obj_pocet = -1
        
    With ThisWorkbook.ActiveSheet
        For Each shp In .Shapes
            With shp
                If Not .Type = 8 And Not .Type = 1 Then    'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 1 = autom. objekt
                        obj_pocet = obj_pocet + 1
                        ReDim Preserve obj(0 To 1, 0 To obj_pocet)
                        obj(0, obj_pocet) = .Name
                        obj(1, obj_pocet) = .Top
                End If
            End With
        Next shp
    
        If obj_pocet = -1 Then GoTo radek_uo_konec
        
        seradit_2D_pole obj, 1, 1
        'Dim zk, zk2, b
        'b = 3
        'zk = obj_pom(0, b)
        'zk2 = obj_pom(1, b)
    
radek_kontrola:
        obj_pozice = 1  '|fffd||fffd|slo |fffd||fffd|dku
        HPgB_r = 0
        obr_cislo = 0
 
        For A = 0 To obj_pocet
            Application.StatusBar = "P|fffd|izp|fffd|sobit objekty ... hotovo " & Round((100 * (A + 1) / (obj_pocet + 1)), 0) & "%"
            shp_sirka_pom = .Shapes(obj(0, A)).Width
            If .Shapes(obj(0, A)).Type = 6 Then        'shp.Type = 8 tla|fffd||fffd|tko, 17 = textov|fffd| pole, 6 = skupina, 1 = autom. objekt
                obr_cislo = obr_cislo + 1
                Set shp_items = .Shapes(obj(0, A)).GroupItems
                DoEvents
                txt_pom = shp_items(2).TextFrame.Characters.Text ' = "Obr|fffd|zek XXX: "
                txt_pom = nahradit_co(txt_pom, obr_cislo)
                shp_items(2).TextFrame.Characters.Text = txt_pom
                txt_pom = InStr(1, txt_pom, ": ")
                If txt_pom > 0 Then
                    shp_items(2).TextFrame.Characters.Font.Bold = False
                    shp_items(2).TextFrame.Characters(1, txt_pom - 1).Font.Bold = True
                Else
                    obr_cislo = obr_cislo - 1
                End If
            End If
            DoEvents
            .Shapes(obj(0, A)).Width = shp_sirka_pom
            
            .Shapes(obj(0, A)).Top = .Rows(obj_pozice).Top + 10
            DoEvents
            shp_t = .Shapes(obj(0, A)).TopLeftCell.Row
            shp_b = .Shapes(obj(0, A)).BottomRightCell.Row
            
            If A < obj_pocet Then   'kv|fffd|li zaji|fffd|t|fffd|n|fffd| spr|fffd|vn|fffd|ho c|fffd|lov|fffd|ho HPpB_r je dal|fffd||fffd| shp ihned p|fffd|esunut o 100 |fffd||fffd|dk|fffd| n|fffd|e ne|fffd| aktu|fffd|ln|fffd| shp
                .Shapes(obj(0, A + 1)).Top = .Rows(obj_pozice + 70).Top
                DoEvents
            End If
            
            If HPgB_r > 0 And ((shp_t < HPgB_r And shp_b >= HPgB_r) Or ((shp_t - 3) < HPgB_r And shp_t > HPgB_r And shp_b > HPgB_r)) Then
                .Shapes(obj(0, A)).Top = .Rows(HPgB_r).Top + 10
                shp_t = .Shapes(obj(0, A)).TopLeftCell.Row
                shp_b = .Shapes(obj(0, A)).BottomRightCell.Row
                DoEvents
            End If
            
            obj_pozice = shp_b
            
            For Each HPgB In .HPageBreaks
                DoEvents
                HPgB_r = HPgB.Location.Row
                If obj_pozice < HPgB_r Then
                    Exit For
                End If
            Next
            If A < obj_pocet Then obj_pozice = shp_b + 2
            
            If A = obj_pocet Then
                Application.ScreenUpdating = True
                DoEvents
                .Range("A" & .Shapes(obj(0, A)).BottomRightCell.Row - 10).Activate
                DoEvents
                ActiveCell.Offset(20, 0).Activate
                DoEvents
                ActiveCell.Offset(-9, 0).Activate
                '.ScrollArea = "A1:" & .Shapes(obj(0, a)).BottomRightCell.Offset(500, 12).Address
                DoEvents
            End If
        Next
    End With
    
radek_uo_konec:
    On Error GoTo 0
    Set shp_items = Nothing
End Sub


Sub seradit_2D_pole(ByRef nazev_pole As Variant, razeni As Long, sloupec_pole As Long, Optional ByVal l_rozpeti_pole As Long, Optional ByVal p_rozpeti_pole As Long)
'N|fffd|zevPole, |fffd|azen|fffd| ( 1=vzestupn|fffd|, 2=sestupn|fffd|), Sloupec (0, 1), Rozp|fffd|t|fffd|PoleZleva, Rozp|fffd|t|fffd|PoleZprava
    Dim Prvni As Long
    Dim Posledni As Long
    Dim strTest As Variant
    Dim strZamenit As Variant
    Dim C As Long
    Dim cMin As Long
    Dim cMax As Long
    
    cMin = LBound(nazev_pole, razeni)
    cMax = UBound(nazev_pole, razeni)
    Select Case razeni
        Case 1
            If p_rozpeti_pole = 0 Then
                l_rozpeti_pole = LBound(nazev_pole, 2)
                p_rozpeti_pole = UBound(nazev_pole, 2)
            End If
            Prvni = l_rozpeti_pole
            Posledni = p_rozpeti_pole
            strTest = nazev_pole(sloupec_pole, (l_rozpeti_pole + p_rozpeti_pole) \ 2)
            Do
                Do While nazev_pole(sloupec_pole, Prvni) < strTest And Prvni < p_rozpeti_pole
                    Prvni = Prvni + 1
                Loop
                Do While strTest < nazev_pole(sloupec_pole, Posledni) And Posledni > l_rozpeti_pole
                    Posledni = Posledni - 1
                Loop
                If Prvni <= Posledni Then
                    For C = cMin To cMax
                        strZamenit = nazev_pole(C, Prvni)
                        nazev_pole(C, Prvni) = nazev_pole(C, Posledni)
                        nazev_pole(C, Posledni) = strZamenit
                    Next
                    Prvni = Prvni + 1
                    Posledni = Posledni - 1
                End If
            Loop Until Prvni > Posledni
            If l_rozpeti_pole < Posledni Then seradit_2D_pole nazev_pole, razeni, sloupec_pole, l_rozpeti_pole, Posledni
            If Prvni < p_rozpeti_pole Then seradit_2D_pole nazev_pole, razeni, sloupec_pole, Prvni, p_rozpeti_pole
        Case 2
            If p_rozpeti_pole = 0 Then
                l_rozpeti_pole = LBound(nazev_pole, 1)
                p_rozpeti_pole = UBound(nazev_pole, 1)
            End If
            Prvni = l_rozpeti_pole
            Posledni = p_rozpeti_pole
            strTest = nazev_pole((l_rozpeti_pole + p_rozpeti_pole) \ 2, sloupec_pole)
            Do
                Do While nazev_pole(Prvni, sloupec_pole) < strTest And Prvni < p_rozpeti_pole
                    Prvni = Prvni + 1
                Loop
                Do While strTest < nazev_pole(Posledni, sloupec_pole) And Posledni > l_rozpeti_pole
                    Posledni = Posledni - 1
                Loop
                If Prvni <= Posledni Then
                    For C = cMin To cMax
                        strZamenit = nazev_pole(Prvni, C)
                        nazev_pole(Prvni, C) = nazev_pole(Posledni, C)
                        nazev_pole(Posledni, C) = strZamenit
                    Next
                    Prvni = Prvni + 1
                    Posledni = Posledni - 1
                End If
            Loop Until Prvni > Posledni
            If l_rozpeti_pole < Posledni Then seradit_2D_pole nazev_pole, razeni, sloupec_pole, l_rozpeti_pole, Posledni
            If Prvni < p_rozpeti_pole Then seradit_2D_pole nazev_pole, razeni, sloupec_pole, Prvni, p_rozpeti_pole
    End Select
End Sub

Function nahradit_co(ByVal kde As String, ByVal nahrada As String) As String
    Dim objRegex
    Set objRegex = CreateObject("vbscript.regexp")
    With objRegex
         .Global = True
         .Pattern = "Obr|fffd|zek (XXX|\d+): "
        nahradit_co = .Replace(kde, "Obr|fffd|zek " & nahrada & ": ")
    End With
    Set objRegex = Nothing
End Function

Sub zobrazit_info_ListX()
'Application.EnableEvents = True
MsgBox "Vytvo|fffd|it sn|fffd|mek m|fffd||fffd|ete pomoc|fffd| stisku kl|fffd|ves:" & vbLf & _
        "   [ PrintSceen ]  -> sn|fffd|mek cel|fffd| obrazovky" & vbLf & _
        "   [ Win ] + [ S ]  -> v|fffd||fffd|ez obrazovky (pomoc|fffd| aplikace OneNote)" & vbLf & vbLf & vbLf & _
        "Vlo|fffd|en|fffd| sn|fffd|mku na pozici kurzoru provedete pomoc|fffd|: " & vbLf & _
        "    - kontextov|fffd|ho menu 'Vlo|fffd|it'" & vbLf & _
        "    - menu prav|fffd|ho tla|fffd||fffd|tka my|fffd|i 'Vlo|fffd|it'" & vbLf & _
        "    - stisknut|fffd|m kl|fffd|ves [ Ctrl ] + [ V ]" & vbLf & vbLf & vbLf & _
        "Funkce tla|fffd||fffd|tek:" & vbLf & _
        "   [ Zp|fffd|t na V|fffd|po|fffd|et  <Ctrl+Q> ]  k navigaci zp|fffd|t na |fffd|zdrojov|fffd||fffd| list" & vbLf & _
        "           V|fffd|po|fffd|et" & vbLf & _
        "   [ Vlo|fffd|it TXT pole ]  k vlo|fffd|en|fffd| nov|fffd|ho textov|fffd|ho pole na pozici kurzoru" & vbLf & _
        "           (bude v|fffd|dy za|fffd||fffd|nat u lev|fffd|ho okraje listu a kon|fffd|it t|fffd|sn|fffd| u okraje" & vbLf & _
        "           prav|fffd|ho)" & vbLf & _
        "   [ Ozna|fffd|it objekty ]  k hromadn|fffd|mu ozna|fffd|en|fffd| v|fffd|ech objekt|fffd| na listu od" & vbLf & _
        "            pozice dol|fffd| (za |fffd||fffd|elem posunut|fffd| objekt|fffd|, smaz|fffd|n|fffd|,|fffd|)" & vbLf & _
        "   [ P|fffd|izp|fffd|sobit objekty  <Ctrl+A> ]  k zarovn|fffd|n|fffd| v|fffd|ech objekt|fffd| k lev|fffd|mu" & vbLf & _
        "            okraji, p|fffd||fffd|padn|fffd|mu zmen|fffd|en|fffd| objekt|fffd|, p|fffd|id|fffd|n|fffd| popisk|fffd| pod" & vbLf & _
        "            obr|fffd|zky a p|fffd|euspo|fffd||fffd|d|fffd|n|fffd| objekt|fffd| na str|fffd|nce" & vbLf & _
        "   [ ??? ]  tato n|fffd|pov|fffd|da" & vbLf & vbLf & _
        "P|fffd|ivol|fffd|n|fffd| tla|fffd||fffd|tek <Ctrl+Y>", vbInformation, "??? - N|fffd|POV|fffd|DA"

End Sub


Sub privolat_tlacitka()
Attribute privolat_tlacitka.VB_ProcData.VB_Invoke_Func = "y\n14"
    Dim ws As Worksheet, t As Range, sh_line
    Set ws = ThisWorkbook.ActiveSheet
    Set t = ws.Cells(ActiveWindow.ScrollRow, ActiveWindow.ScrollColumn)
    If Not ws.Name Like "List*" Then Exit Sub
    
    With t
        sh_line = ws.Shapes("Btn1").Line.Weight
        ws.Shapes("Btn1").Top = .Top + sh_line
        ws.Shapes("Btn2").Top = .Top + sh_line
        ws.Shapes("Btn3").Top = .Top + sh_line
        ws.Shapes("Btn4").Top = .Top + sh_line
        ws.Shapes("Btn5").Top = .Top + sh_line
    End With
    
    ws.Shapes("Btn1").ZOrder msoBringToFront
    ws.Shapes("Btn2").ZOrder msoBringToFront
    ws.Shapes("Btn3").ZOrder msoBringToFront
    ws.Shapes("Btn4").ZOrder msoBringToFront
    ws.Shapes("Btn5").ZOrder msoBringToFront
    DoEvents
    Set t = Nothing
    Set ws = Nothing

End Sub



Sub pridat_logo_do_LeftHeader(nazev_listu, firma)
    Dim Logo_nazev, Logo_temp
    
    With ThisWorkbook.Sheets("Datov|fffd| list")
        If NewFirma Then
            Logo_nazev = "Logo_export_GCP"
        Else
            Logo_nazev = IIf(firma = "|fffd|esk|fffd| ", "Logo_export_CP", "Logo_export_GP")
        End If
        Logo_temp = Environ("TEMP")
        If Not Dir(Logo_temp & "\Logo_Temp.png", vbDirectory) = vbNullString Then Kill Logo_temp & "\Logo_Temp.png"
        DoEvents
        If Not Dir(Logo_temp, vbDirectory) = vbNullString Then
            ThisWorkbook.Sheets("Datov|fffd| list").ChartObjects(Logo_nazev).Chart.Export (Logo_temp & "\Logo_Temp.png")
        Else
            MsgBox "Cesta neexistuje: " & Logo_temp
        End If
        DoEvents
    End With

    With ThisWorkbook.Sheets(nazev_listu).PageSetup
        With .LeftHeaderPicture
            .FileName = (Logo_temp & "\Logo_Temp.png")
            '.Height = 50
        End With
        
        .LeftHeader = "&G"
        '.HeaderMargin = 30
        '.TopMargin = 90
    End With
    
    If Not Dir(Logo_temp & "\Logo_Temp.png", vbDirectory) = vbNullString Then Kill Logo_temp & "\Logo_Temp.png"
    DoEvents

End Sub
Sub vytvorit_Logo_export()
    Dim objChart As Chart, myLogo As Shape
    Dim Logo_temp, vyska, sirka
    Dim Logo_nazev
    Logo_nazev = "Logo_export_GCP"    'Logo_export_CP, Logo_export_GP
    
    With ThisWorkbook.Sheets("Datov|fffd| list")
        Logo_temp = Replace(Logo_nazev, "_export", vbNullString)
        Set myLogo = .Shapes(Logo_temp)
        With myLogo
            vyska = .Height * 0.68
            sirka = .Width * 0.68
        End With
    
        myLogo.Copy
        .Shapes.AddChart.Name = Logo_nazev
        Set objChart = .ChartObjects(Logo_nazev).Chart
        DoEvents
        For Each s In objChart.SeriesCollection
            s.Delete
        Next s
        objChart.Parent.Height = vyska
        objChart.Parent.Width = sirka
        objChart.ChartArea.Border.LineStyle = xlNone
        DoEvents
        objChart.Paste
        DoEvents
        
        'Logo_temp = Environ("TEMP")
        'objChart.Export (Logo_temp & "\Logo_Temp.jpg")
        'objChart.Parent.Delete
        Set myLogo = Nothing
        Set objChart = Nothing
    End With
End Sub

Function zjistitOperacniSystem()
    Dim localHost As String, objWMIService As Variant, colOperatingSystems As Variant, objOperatingSystem As Variant
    
On Error GoTo radek_chyba
    localHost = "." 'technicky lze spustit i proti vzd|fffd|len|fffd|mu PC, je-li povoleno
    Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & localHost & "\root\cimv2")
    Set colOperatingSystems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem")

    For Each objOperatingSystem In colOperatingSystems
        zjistitOperacniSystem = objOperatingSystem.Caption & " " & objOperatingSystem.Version
        GoTo radek_konec_testu
    Next

radek_chyba:
    MsgBox "P|fffd||fffd| zji|fffd||fffd|ov|fffd|n|fffd| spu|fffd|t|fffd|n|fffd| verze Windows se vyskytla n|fffd|sleduj|fffd|c|fffd| chyba:" & vbCrLf & vbCrLf & _
           "|fffd||fffd|slo chyby: " & err.Number & vbCrLf & _
           "Zdroj chyby: zjistitOperacniSystem" & vbCrLf & _
           "Popis chyby: " & err.Description, _
           vbCritical, "!!! ZJI|fffd||fffd|OV|fffd|N|fffd| VERZE WINDOWS - VYSKYTLA SE CHYBA !!!"
           zjistitOperacniSystem = "Chyba |fffd||fffd|slo: " & err.Number
            
radek_konec_testu:
            On Error GoTo 0
           Set objWMIService = Nothing: Set colOperatingSystems = Nothing
            Exit Function

End Function

Function JeOS_MWServer() As String
Dim OS, OS_pom
OS = vbNullString
OS_pom = zjistitOperacniSystem
OS = IIf(Len(OS_pom) > 0, OS_pom, OS)
    If Len(OS) > 0 And Left(OS, 13) <> "Chyba |fffd||fffd|slo: " Then
        JeOS_MWServer = IIf(Len(OS) - Len(Replace(OS, "Microsoft Windows Server", vbNullString)) > 0, "Ano", "Ne")
    Else
        JeOS_MWServer = "nezji|fffd|t|fffd|no"
    End If
End Function

Sub otevrit_soubor_PU_ZAM_ZAM_XLSB()
'otev|fffd||fffd|t soubor PU registrovan|fffd| na LP ODKGZ s riziky ZAM-ZAM
    zjistit_subjekt (ThisWorkbook.ActiveSheet.Range(ThisWorkbook.ActiveSheet.CodeName & "_Pripad").Text)
    If strSubj = "|fffd|P" Then  'XMLRead("<CompanyNo>") = "CPC" Then 'GCZ
        If XMLRead("<ProductLineId>") = "DOK01" Then
            otevrit_soubor_PU_VYKONPOVOLCP_XLSB "DOK01"
        End If
        If XMLRead("<LegacyPolicyNo>") = "8992536128" And XMLRead("<ProductLineId>") = "DPOG2" Then
            otevrit_soubor_PU_VYKONPOVOLCP_XLSB "DPOG2"
        End If
        Exit Sub
    End If
    
    Dim cesta_oWbk, cisloPS, p, dotaz
    p = 0
    
    If Len(ThisWorkbook.ActiveSheet.Range(ThisWorkbook.ActiveSheet.CodeName & "_Pripad").Text) = 0 Then Exit Sub
    cisloPS = "" & ThisWorkbook.ActiveSheet.Range(ThisWorkbook.ActiveSheet.CodeName + "_Sml")
    'cisloPS = "2904948870"  'jak|fffd|koliv existuj|fffd|c|fffd| |fffd||fffd|slo PS v seznamu PU
    
    Dim ExApp As New Excel.Application, oWbk As Workbook
    If JeOS_MWServer = "Ne" Then
        'pro PC
        cesta_oWbk = "\\CZ00SF0001.gpcz.corp.local\Hq-proj-root\LIK_NZP\"
    Else
        'pro CITRIX - CDA
        cesta_oWbk = "\\sfs01\Dokumenty\SSL\Statistiky\Likvidace\"
    End If
        
    Set oWbk = ExApp.Workbooks.Open(cesta_oWbk & "PU_ZAM-ZAM.xlsb", , True)
    
    With oWbk
        'nastavit jako aktivn|fffd| list a filtrovat |fffd||fffd|slo PS
        .Activate
        
        On Error Resume Next
        p = .Sheets(1).Columns(1).Find(cisloPS).Row
        On Error GoTo 0
        
        If p = 0 Then   'kdy|fffd| cisloPS nenalezeno
            
            dotaz = MsgBox("PS |fffd||fffd|slo " & cisloPS & " nebyla nenalezena v seznamu registrovan|fffd|ch PU na LP ODKGZ s riziky ZAM-ZAM." & _
                    vbLf & vbLf & "Chcete-li soubor se seznamem p|fffd|esto otev|fffd||fffd|t, stisn|fffd|te tla|fffd||fffd|tko 'Ano'.", vbExclamation + vbYesNo + vbDefaultButton2, "OV|fffd||fffd|EN|fffd| LIMITU PLN|fffd|N|fffd| - PS NENALEZENA")
            
            If dotaz = vbYes Then
                p = 1
                GoTo radek_otevrit_oWbk
            Else
                oWbk.Saved = True
                oWbk.Close
            End If
            
        Else
            .Sheets(1).Range("A2").AutoFilter _
                field:=1, _
                Criteria1:=cisloPS, _
                VisibleDropDown:=True
        End If
    End With
    
radek_otevrit_oWbk:
    With ExApp
        If p > 0 Then
            On Error Resume Next    'pro jistotu zat|fffd|m nev|fffd|m pro|fffd|, ale v CITRIX to n|fffd|kdy ud|fffd|l|fffd| chybu
            .Height = 600
            .Width = 720
            .Top = 1
            .Left = 1
            .Visible = True
            On Error GoTo 0
        Else
            .Quit
        End If
    End With
    
    Set oWbk = Nothing
    Set ExApp = Nothing

End Sub


Sub otevrit_soubor_PU_VYKONPOVOLCP_XLSB(LP As String)
'otev|fffd||fffd|t soubor PU registrovan|fffd| na LP DOK01
    
    Dim cesta_oWbk, cisloPS, p, dotaz
    p = 0
    
    If Len(ThisWorkbook.ActiveSheet.Range(ThisWorkbook.ActiveSheet.CodeName & "_Pripad").Text) = 0 Then Exit Sub
    cisloPS = "" & ThisWorkbook.ActiveSheet.Range(ThisWorkbook.ActiveSheet.CodeName + "_Sml")
    'cisloPS = "2904948870"  'jak|fffd|koliv existuj|fffd|c|fffd| |fffd||fffd|slo PS v seznamu PU
    
    Dim ExApp As New Excel.Application, oWbk As Workbook
    If JeOS_MWServer = "Ne" Then
        'pro PC
        'cesta_oWbk = "\\CZ00SF0001.gpcz.corp.local\Hq-proj-root\LIK_NZP\"
        cesta_oWbk = "\\sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\V|fffd|konPovol|fffd|n|fffd|\"
    Else
        'pro CITRIX - CDA
        cesta_oWbk = "\\sfs01\Dokumenty\SSL\Likvidace\Odpov|fffd|dnost\V|fffd|konPovol|fffd|n|fffd|\"
    End If
        
    Set oWbk = ExApp.Workbooks.Open(cesta_oWbk & "PU_" & LP & ".xlsb", , True)
    
    With oWbk
        'nastavit jako aktivn|fffd| list a filtrovat |fffd||fffd|slo PS
        .Activate
        
        On Error Resume Next
        p = .Sheets(1).Columns(1).Find(cisloPS).Row
        On Error GoTo 0
        
        If p = 0 Then   'kdy|fffd| cisloPS nenalezeno
            
            dotaz = MsgBox("PS |fffd||fffd|slo " & cisloPS & " nebyla nenalezena v seznamu registrovan|fffd|ch PU na LP " & LP & "." & _
                    vbLf & vbLf & "Chcete-li soubor se seznamem p|fffd|esto otev|fffd||fffd|t, stisn|fffd|te tla|fffd||fffd|tko 'Ano'.", vbExclamation + vbYesNo + vbDefaultButton2, "OV|fffd||fffd|EN|fffd| LIMITU PLN|fffd|N|fffd| - PS NENALEZENA")
            
            If dotaz = vbYes Then
                p = 1
                GoTo radek_otevrit_oWbk
            Else
                oWbk.Saved = True
                oWbk.Close
            End If
            
        Else
            .Sheets(1).Range("A2").AutoFilter _
                field:=1, _
                Criteria1:=cisloPS, _
                VisibleDropDown:=True
        End If
    End With
    
radek_otevrit_oWbk:
    With ExApp
        If p > 0 Then
            On Error Resume Next    'pro jistotu zat|fffd|m nev|fffd|m pro|fffd|, ale v CITRIX to n|fffd|kdy ud|fffd|l|fffd| chybu
            .Height = 600
            .Width = 720
            .Top = 1
            .Left = 1
            .Visible = True
            On Error GoTo 0
        Else
            .Quit
        End If
    End With
    
    Set oWbk = Nothing
    Set ExApp = Nothing

End Sub

'p|fffd|izp|fffd|sob|fffd| Shapes 'stahovaci_cislo' bu|fffd|k|fffd|m - pro listy 'Bolestn|fffd|' a 'ZSU'
Sub prizpusobit_shapes_stahovaci()
    Dim i As Long, x
    With ActiveSheet
        For i = 7 To 31
            With .Shapes("stahovac|fffd|_" & i - 6)
                x = ActiveSheet.Cells(i, 2).Height
                .Width = ActiveSheet.Cells(i, 2).Width
                .Height = ActiveSheet.Cells(i, 2).Height
                .Left = ActiveSheet.Cells(i, 2).Left
                .Top = ActiveSheet.Cells(i, 2).Top
            End With
        Next
    End With
End Sub

Attribute VB_Name = "jviAudanet"
'*******************************************************'
'* jseAudanet                                          *'
'* JSE 2016-02-04 - Obsah tohoto modulu nem|fffd|nit!       *'
'*                                                     *'
'* Vy|fffd|aduje moduly:  rsoUploadAudaKalkulace            *'
'*                   rsoUpload                         *'
'*******************************************************'

Option Explicit

Sub AUDANET_Tisk_kalkulace()
 
    Dim sPU As String, sPP As String, sPoskozeny As String, sKDO As String
    sPU = vbNullString: sPP = vbNullString: sPoskozeny = "": sKDO = vbNullString
    
    sPoskozeny = Range(ActiveSheet.CodeName & "_Pos")
    sPU = Range(ActiveSheet.CodeName & "_Pripad")
    sPP = Range(ActiveSheet.CodeName & "_PodPripad")
    sKDO = Range(ActiveSheet.CodeName & "_KDO")

    If Len(sPU) = 0 Then Exit Sub
   
    If MsgBox("Chcete st|fffd|hnout provedenou kalkulaci z Audanetu do DA?" & vbLf & vbLf & _
              "Po|fffd|kozen|fffd|:  " & sPoskozeny & vbLf & _
              "PU |fffd|.:  " & sPU & vbLf & _
              "Podp|fffd||fffd|pad |fffd|.:  " & sPP _
              , vbDefaultButton1 + vbQuestion + vbYesNo) = vbYes Then
        
        If Len(sPU) = 10 Then                                                           'vol|fffd|n|fffd| proced|fffd|ry pro upload kalkulace
            ProvedUploadKalkulaceAudaNetu sPU, sPP, uplGEN_KAL, uplGENOdeslatKDoindexaciLPU     'PU GLI
        Else
            ProvedUploadKalkulaceAudaNetu sPU, sPP                                              'PU |fffd|P
        End If
    End If
   
 End Sub



Attribute VB_Name = "rsoClipBoard"
'*******************************************************'
'* rsoClipBoard                                        *'
'* RSO 2019-06-20 - Obsah tohoto modulu nem|fffd|nit!       *'
'* K|fffd|d z internetu |fffd|e|fffd||fffd|c|fffd| chybn|fffd| vkl|fffd|d|fffd|n|fffd| textu        *'
'*   do schr|fffd|nky - dva |fffd|tvere|fffd|ky |fffd|i dva otazn|fffd|ky       *'
'*******************************************************'

#If Mac Then
    ' ignore
#Else
    #If VBA7 Then
        Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
        Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
        Declare PtrSafe Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, _
                                                             ByVal dwBytes As LongPtr) As LongPtr

        Declare PtrSafe Function CloseClipboard Lib "User32" () As Long
        Declare PtrSafe Function OpenClipboard Lib "User32" (ByVal hwnd As LongPtr) As LongPtr
        Declare PtrSafe Function EmptyClipboard Lib "User32" () As Long

        Declare PtrSafe Function lstrcpy Lib "kernel32" (ByVal lpString1 As Any, _
                                                         ByVal lpString2 As Any) As LongPtr

        Declare PtrSafe Function SetClipboardData Lib "User32" (ByVal wFormat _
                                                                As Long, ByVal hMem As LongPtr) As LongPtr
    #Else
        Declare Function GlobalUnlock Lib "kernel32" (ByVal hMem As Long) As Long
        Declare Function GlobalLock Lib "kernel32" (ByVal hMem As Long) As Long
        Declare Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, _
                                                     ByVal dwBytes As Long) As Long

        Declare Function CloseClipboard Lib "User32" () As Long
        Declare Function OpenClipboard Lib "User32" (ByVal hwnd As Long) As Long
        Declare Function EmptyClipboard Lib "User32" () As Long

        Declare Function lstrcpy Lib "kernel32" (ByVal lpString1 As Any, _
                                                 ByVal lpString2 As Any) As Long

        Declare Function SetClipboardData Lib "User32" (ByVal wFormat _
                                                        As Long, ByVal hMem As Long) As Long
    #End If
#End If
Public Const GHND = &H42
Public Const CF_TEXT = 1
Public Const MAXSIZE = 4096

Sub ClipBoard_SetData(MyString As String)
    #If Mac Then
        With New MSForms.DataObject
            .SetText MyString
            .PutInClipboard
        End With
    #Else
        #If VBA7 Then
            Dim hGlobalMemory As LongPtr
            Dim hClipMemory   As LongPtr
            Dim lpGlobalMemory    As LongPtr
        #Else
            Dim hGlobalMemory As Long
            Dim hClipMemory   As Long
            Dim lpGlobalMemory    As Long
        #End If

        Dim x                 As Long

        ' Allocate moveable global memory.
        '-------------------------------------------
        hGlobalMemory = GlobalAlloc(GHND, Len(MyString) + 1)

        ' Lock the block to get a far pointer
        ' to this memory.
        lpGlobalMemory = GlobalLock(hGlobalMemory)

        ' Copy the string to this global memory.
        lpGlobalMemory = lstrcpy(lpGlobalMemory, MyString)

        ' Unlock the memory.
        If GlobalUnlock(hGlobalMemory) <> 0 Then
            MsgBox "Could not unlock memory location. Copy aborted."
            GoTo OutOfHere2
        End If

        ' Open the Clipboard to copy data to.
        If OpenClipboard(0&) = 0 Then
            MsgBox "Could not open the Clipboard. Copy aborted."
            Exit Sub
        End If

        ' Clear the Clipboard.
        x = EmptyClipboard()

        ' Copy the data to the Clipboard.
        hClipMemory = SetClipboardData(CF_TEXT, hGlobalMemory)

OutOfHere2:

        If CloseClipboard() = 0 Then
            MsgBox "Could not close Clipboard."
        End If
    #End If

End Sub

Attribute VB_Name = "rsoPDF"
'*******************************************************'
'* PDF                                                 *'
'* RSO 2012-01-06 - Obsah tohoto modulu nem|fffd|nit!       *'
'*******************************************************'
Option Explicit

Public Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long)


'**********************************************************************************'
'** Tisk vybran|fffd|ch list|fffd| do PDF
'** Pokud nen|fffd| zad|fffd|n parametr sFileName, bude PDF ulo|fffd|eno automaticky do TEMP pod
'** automaticky vytvo|fffd|en|fffd|m n|fffd|zvem. Tento n|fffd|zev i s cestou je n|fffd|vratov|fffd| hodnota fce
'** Pokud je n|fffd|vratovou hodnotou "", nebyl vytvo|fffd|en soubor PDF
'**********************************************************************************'

Function PrintPDF(shts As Variant, Optional sFileName As String = "") As String
    If Val(Application.Version) > 11 Then
        PrintPDF = PrintPDF_Office(shts, sFileName)
    End If
    If PrintPDF = "" Then
        PrintPDF = PrintPDF_PDFCreator(shts, sFileName)
    End If
End Function


'* Tisk pomoc|fffd| metody aplikace Office 2007 a vy|fffd||fffd||fffd|
Private Function PrintPDF_Office(shts As Variant, Optional sFileName As String = "") As String
  Dim sel As Sheets
  Dim act As Worksheet
  Dim rep As Boolean
  Dim i As Integer
  Dim sl As Worksheet
  Dim author As String
  
  'Uschov|fffd|n|fffd| stavu aktivn|fffd|ho listu a v|fffd|ech vybran|fffd|ch list|fffd|
  Set sel = ThisWorkbook.Windows(1).SelectedSheets
  Set act = ActiveSheet
  
  rep = True
  sFileName = GetTempFullFileName(sFileName)
  
  Select Case TypeName(shts)

    Case "Sheets" '-- P|fffd||fffd|klad: Call PrintPDF(ActiveWorkbook.Windows(1).SelectedSheets, "c:\test.pdf")
        For i = 1 To shts.Count
            shts(i).Select rep
            rep = False
        Next i

    Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Worksheets("List1"), "c:\test.pdf")
        shts.Select

    Case "String" '-- P|fffd||fffd|klad: Call PrintPDF("List1", "c:\test.pdf")
        Worksheets(shts).Select
    
    Case "Range" '-- P|fffd||fffd|klad: Call PrintPDF(Range("A1:C20"), "c:\test.pdf")

    Case "Variant()", "String()"
        If IsArray(shts) Then '-- Pole

            Select Case TypeName(shts(LBound(shts)))

                Case "String" '-- P|fffd||fffd|klad: Call PrintPDF(Array("List2", "List1"), "c:\test.pdf")
                    For i = LBound(shts) To UBound(shts)
                        Worksheets(shts(i)).Select rep
                        rep = False
                    Next i

                Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Array(Worksheets("List1"), Worksheets("List2")), "c:\test.pdf")
                    For i = LBound(shts) To UBound(shts)
                        shts(i).Select rep
                        rep = False
                    Next i

                Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
                  MsgBox TypeName(shts(LBound(shts)))
                  sFileName = ""

            End Select

        Else '-- Neo|fffd|et|fffd|en|fffd| typ
            MsgBox TypeName(shts)
            sFileName = ""
        End If

    Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
        MsgBox TypeName(shts)
        sFileName = ""

  End Select
    
  On Error Resume Next
  
  author = ThisWorkbook.BuiltinDocumentProperties("Author")
  ThisWorkbook.BuiltinDocumentProperties("Author") = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
  
  If TypeName(shts) = "Range" Then
      Call shts.ExportAsFixedFormat(0, sFileName, 0, True, False) '(xlTypePDF, sFileName, xlQualityStandard, True, False)
  Else
      Call ActiveSheet.ExportAsFixedFormat(0, sFileName, 0, True, False) '(xlTypePDF, sFileName, xlQualityStandard, True, False)
  End If
  If err.Number > 0 Then sFileName = ""
  
  ThisWorkbook.BuiltinDocumentProperties("Author") = author
  
  On Error GoTo 0

  'Obnoven|fffd| stavu aktivn|fffd|ho listu a v|fffd|ech vybran|fffd|ch list|fffd|
  rep = True
  For Each sl In sel
    sl.Select rep
    rep = False
  Next sl
  act.Activate
  
  PrintPDF_Office = sFileName

End Function


'* Tisk pomoc|fffd| objektu PDFCreator
Function PrintPDF_PDFCreator(shts As Variant, Optional sFileName As String = "") As String
  Dim PDFCreator1 As Object
  Dim i As Integer
  Dim cnt As Integer
  Dim fso As Object
  Dim oldStatusBar As Boolean

  PrintPDF_PDFCreator = ""

  On Error GoTo chyba
  Set PDFCreator1 = CreateObject("PDFCreator.clsPDFCreator", "")
  On Error GoTo 0

  oldStatusBar = Application.DisplayStatusBar
  Application.DisplayStatusBar = True

  sFileName = GetTempFullFileName(sFileName)

  If PDFCreator1.cStart("/NoProcessingAtStartup") = False Then
      MsgBox "Nebylo mo|fffd|n|fffd| inicializovat PDFCreator."
      If MsgBox("Neprov|fffd|d|fffd|te aktu|fffd|ln|fffd| tisk do PDF z jin|fffd| aplikace |fffd|i jin|fffd|ho listu V|fffd|po|fffd|tu pln|fffd|n|fffd|?", vbDefaultButton1 + vbQuestion + vbYesNoCancel) = vbNo Then
          If MsgBox("Provedu ukon|fffd|en|fffd| PDFCreatoru, aby bylo mo|fffd|n|fffd| aktu|fffd|ln|fffd| po|fffd|adavek vy|fffd||fffd|dit. Souhlas|fffd|te?", vbDefaultButton2 + vbQuestion + vbYesNoCancel) = vbYes Then

              KillProcess ("PDFCreator.exe") 'Ukon|fffd|i PDFCreator
              Set PDFCreator1 = CreateObject("PDFCreator.clsPDFCreator", "")
              If PDFCreator1.cStart("/NoProcessingAtStartup") = False Then
                  MsgBox "Nebylo mo|fffd|n|fffd| inicializovat PDFCreator."
                  Application.StatusBar = False
                  Application.DisplayStatusBar = oldStatusBar
                  Exit Function
              End If

          Else
            Application.StatusBar = False
            Application.DisplayStatusBar = oldStatusBar
            Exit Function
          End If
      Else
          Application.StatusBar = False
          Application.DisplayStatusBar = oldStatusBar
          Exit Function
      End If
  End If

  Set fso = CreateObject("Scripting.FileSystemObject")

  Application.StatusBar = "PDFCreator: nastaven|fffd| prom|fffd|nn|fffd|ch"

  With PDFCreator1
      .cOption("UseAutosave") = 1
      .cOption("UseAutosaveDirectory") = 1
      .cOption("AutosaveDirectory") = fso.GetParentFolderName(sFileName)
      .cOption("AutosaveFilename") = fso.GetFileName(sFileName)
      .cOption("AutosaveFormat") = 0                            ' 0 = PDF
      .cOption("StandardTitle") = " "
      .cOption("StandardSubject") = ""
      .cOption("StandardAuthor") = "|fffd|esk|fffd| poji|fffd||fffd|ovna a.s."
      .cOption("UseStandardAuthor") = 1
      .cClearcache
  End With

  Application.EnableEvents = False

  Application.StatusBar = "PDFCreator: pos|fffd|l|fffd|m str|fffd|nky ke zpracov|fffd|n|fffd|..."

  cnt = 0

  Select Case TypeName(shts)

    Case "Sheets" '-- P|fffd||fffd|klad: Call PrintPDF(ActiveWorkbook.Windows(1).SelectedSheets, "c:\test.pdf")
        For i = 1 To shts.Count
            Application.StatusBar = "PDFCreator: tisknu str|fffd|nku " & shts(i).Name & "..."
            shts(i).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
            Sleep 700
        Next i
        cnt = shts.Count

    Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Worksheets("List1"), "c:\test.pdf")
        Application.StatusBar = "PDFCreator: tisknu str|fffd|nku " & shts.Name & "..."
        shts.PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
        cnt = 1

    Case "String" '-- P|fffd||fffd|klad: Call PrintPDF("List1", "c:\test.pdf")
        Application.StatusBar = "PDFCreator: tisknu str|fffd|nku " & Worksheets(shts).Name & "..."
        Worksheets(shts).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
        cnt = 1

    Case "Range" '-- P|fffd||fffd|klad: Call PrintPDF(Range("A1:C30"), "c:\test.pdf")
        Application.StatusBar = "PDFCreator: tisknu oblast " & shts.Address & "..."
        shts.PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
        cnt = 1

    Case "Variant()", "String()"
        If IsArray(shts) Then '-- Pole

            Select Case TypeName(shts(LBound(shts)))

                Case "String" '-- P|fffd||fffd|klad: Call PrintPDF(Array("List2", "List1"), "c:\test.pdf")
                    For i = LBound(shts) To UBound(shts)
                        Application.StatusBar = "PDFCreator: tisknu str|fffd|nku " & Worksheets(shts(i)).Name & "..."
                        Worksheets(shts(i)).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
                        Sleep 700
                    Next i
                    cnt = UBound(shts) - LBound(shts) + 1

                Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Array(Worksheets("List1"), Worksheets("List2")), "c:\test.pdf")
                    For i = LBound(shts) To UBound(shts)
                        Application.StatusBar = "PDFCreator: tisknu str|fffd|nku " & shts(i).Name & "..."
                        shts(i).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("PDFCreator:")
                        Sleep 700
                    Next i
                    cnt = UBound(shts) - LBound(shts) + 1

                Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
                  MsgBox TypeName(shts(LBound(shts)))
                  sFileName = ""

            End Select

        Else '-- Neo|fffd|et|fffd|en|fffd| typ
            MsgBox TypeName(shts)
            sFileName = ""
        End If

    Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
        MsgBox TypeName(shts)
        sFileName = ""

  End Select

  Application.EnableEvents = True

  Application.StatusBar = "PDFCreator: |fffd|ek|fffd|m na vyti|fffd|t|fffd|n|fffd| v|fffd|ech str|fffd|nek (" & cnt & ")..."

  Do Until PDFCreator1.cCountOfPrintjobs = cnt
      DoEvents
      Sleep 500
  Loop


  Application.StatusBar = "PDFCreator: seskupuji tisk..."
  Sleep 100
  PDFCreator1.cCombineAll


  Application.StatusBar = "PDFCreator: tisknu PDF..."
  Sleep 900
  PDFCreator1.cPrinterStop = False

  Sleep 4000
  Application.StatusBar = "PDFCreator: ma|fffd|u cache PDFCreatoru..."
  PDFCreator1.cClearcache

  Sleep 200
  Application.StatusBar = "PDFCreator: zav|fffd|r|fffd|m PDFCreator..."
  PDFCreator1.cClose

  Sleep 1000
  DoEvents

  Application.StatusBar = "PDFCreator: odstra|fffd|uji objekt PDFCreator..."

  Set PDFCreator1 = Nothing

  KillProcess ("PDFCreator.exe") 'Nenechejme nic n|fffd|hod|fffd|...

  If fso.FileExists(sFileName) Then
      PrintPDF_PDFCreator = sFileName
  End If

  Application.StatusBar = False
  Application.DisplayStatusBar = oldStatusBar

  Exit Function

chyba:

  MsgBox "Nelze vytvo|fffd|it PDF dokument. Nastal probl|fffd|m v p|fffd||fffd|stupu k aplikaci PDFCreator." _
          & vbLf & vbLf & "Chyba: " & err.Number & " " & err.Description, vbExclamation

  If GetPrinterName("Microsoft Document Imaging Writer Port:") = "" Then Exit Function

  '-- Nouzov|fffd| |fffd|e|fffd|en|fffd| tisku do form|fffd|tu TIF pomoc|fffd| MS Office Dokument Image Writer --
  If MsgBox("Vytisknout pomoc|fffd| MS Office Dokument Image Writer? Do form|fffd|tu .TIF?", vbQuestion + vbDefaultButton3 + vbYesNoCancel) = vbYes Then

      sFileName = GetTempFullFileName(sFileName)
      sFileName = Left(sFileName, Len(sFileName) - 4) & ".tif"

      Select Case TypeName(shts)

          Case "Sheets" '-- P|fffd||fffd|klad: Call PrintPDF(ActiveWorkbook.Windows(1).SelectedSheets, "c:\test.pdf")
              shts.PrintOut Copies:=1, ActivePrinter:=GetPrinterName("Microsoft Document Imaging Writer Port:"), Preview:=False, PrintToFile:=True, PrToFileName:=sFileName

          Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Worksheets("List1"), "c:\test.pdf")
              shts.PrintOut Copies:=1, ActivePrinter:=GetPrinterName("Microsoft Document Imaging Writer Port:"), Preview:=False, PrintToFile:=True, PrToFileName:=sFileName

          Case "String" '-- P|fffd||fffd|klad: Call PrintPDF("List1", "c:\test.pdf")
              Worksheets(shts).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("Microsoft Document Imaging Writer Port:"), Preview:=False, PrintToFile:=True, PrToFileName:=sFileName

          Case "Variant()", "String()"
              If IsArray(shts) Then '-- Pole

                  Select Case TypeName(shts(LBound(shts)))

                      Case "String" '-- P|fffd||fffd|klad: Call PrintPDF(Array("List2", "List1"), "c:\test.pdf")
                          Worksheets(shts).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("Microsoft Document Imaging Writer Port:"), Preview:=False, PrintToFile:=True, PrToFileName:=sFileName

                      Case "Worksheet" '-- P|fffd||fffd|klad: Call PrintPDF(Array(Worksheets("List1"), Worksheets("List2")), "c:\test.pdf")
                          For i = LBound(shts) To UBound(shts)
                              shts(i) = shts(i).Name
                          Next i
                          Worksheets(shts).PrintOut Copies:=1, ActivePrinter:=GetPrinterName("Microsoft Document Imaging Writer Port:"), Preview:=False, PrintToFile:=True, PrToFileName:=sFileName

                      Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
                          MsgBox TypeName(shts(LBound(shts)))
                          sFileName = ""

                  End Select

              Else '-- Neo|fffd|et|fffd|en|fffd| typ
                  MsgBox TypeName(shts)
                  sFileName = ""
          End If

          Case Else '-- Neo|fffd|et|fffd|en|fffd| typ
              MsgBox TypeName(shts)
              sFileName = ""

      End Select

      Set fso = CreateObject("Scripting.FileSystemObject")
      If fso.FileExists(sFileName) Then
          PrintPDF_PDFCreator = sFileName
       End If

  End If
  '-----------------------------------------------

End Function


'**********************************************************************************'
'** Vrac|fffd| jm|fffd|no tisk|fffd|rny dle zadan|fffd|ho portu
'**********************************************************************************'

Private Function GetPrinterName(port As String) As String
  Dim oPrinters As Object
  Dim p As Integer

  Set oPrinters = CreateObject("WScript.Network").EnumPrinterConnections()
  For p = 0 To oPrinters.Length - 1 Step 2
      If UCase(oPrinters.Item(p)) = UCase(port) Then
          GetPrinterName = oPrinters.Item(p + 1)
          Exit Function
      End If
  Next
  GetPrinterName = ""
End Function


'**********************************************************************************'
'** Vrac|fffd| automaticky vygenerovan|fffd| jm|fffd|no temp souboru i s cestou, pokud neexistuje
'**********************************************************************************'

Private Function GetTempFullFileName(sFileName As String) As String
  Const cTemporaryFolder = 2
  Dim fso As Object
  Dim sPath As String
  Dim sFile As String
  Dim f As Integer

  Set fso = CreateObject("Scripting.FileSystemObject")

  'Cesta k souboru
  sPath = fso.GetParentFolderName(sFileName)
  If sPath = "" Then
      sPath = fso.GetSpecialFolder(cTemporaryFolder) & "\TiaVypoc"
      If Not fso.FolderExists(sPath) Then fso.CreateFolder (sPath)
  End If

  'Soubor s p|fffd||fffd|ponou
  sFile = fso.GetFileName(sFileName)
  If sFile = "" Then
      sFile = fso.GetBaseName(fso.GetTempName()) & ".pdf"
  ElseIf fso.GetExtensionName(sFile) = "" Then
      sFile = Replace(sFile + ".pdf", "..", ".")
  End If


  On Error Resume Next
  'O|fffd|et|fffd|en|fffd| situace, kdy je soubor v dr|fffd|en|fffd| jin|fffd| aplikace - t|fffd|eba AdobeReaderu
  For f = 0 To 10
      sFileName = sPath & "\" & sFile
      err.Clear
      If Dir(sFileName) <> "" Then Kill (sFileName)
      If err.Number <> 0 Then '70
          If f = 0 Then
              sFile = Replace(sFile, "." & fso.GetExtensionName(sFile), "#" & f + 1 & "." & fso.GetExtensionName(sFile))
          Else
              sFile = Replace(sFile, "#" & f & "." & fso.GetExtensionName(sFile), "#" & f + 1 & "." & fso.GetExtensionName(sFile))
          End If
      Else
          Exit For
      End If
  Next f
  On Error GoTo 0

  GetTempFullFileName = sPath & "\" & sFile
End Function


'**********************************************************************************'
'** Ukon|fffd||fffd| zvolen|fffd| proces - pou|fffd||fffd|v|fffd| se k ukon|fffd|en|fffd| procesu PDFCreator.exe
'**********************************************************************************'

Private Sub KillProcess(sProcess As String)
  Dim objWMIService As Object
  Dim colProcessList As Variant
  Dim objProcess As Variant

  On Error Resume Next
  Set objWMIService = GetObject("winmgmts:" _
      & "{impersonationLevel=impersonate}!\\.\root\cimv2")
  Set colProcessList = objWMIService.ExecQuery _
      ("Select * from Win32_Process Where Name = '" & sProcess & "'")
  For Each objProcess In colProcessList
      objProcess.Terminate
  Next
  On Error GoTo 0
End Sub
Attribute VB_Name = "rsoUpload"
'*******************************************************'
'* Upload                                              *'
'* RSO 2017-02-15  - Obsah tohoto modulu nem|fffd|nit!      *'
'*******************************************************'
Option Explicit

Enum uplTypeID
    uplVYP = 35    'V|fffd|po|fffd|et pln|fffd|n|fffd|
    uplVYPC = 702  'V|fffd|po|fffd|et pln|fffd|n|fffd| |fffd||fffd|st
    uplVEX = 363   'V|fffd|po|fffd|et z expertn|fffd|ho syst|fffd|mu
    uplODDO = 50   'Odes|fffd|lan|fffd| dopis
    uplOMAI = 812  'Odchoz|fffd| mail
    uplPMAI = 813  'P|fffd||fffd|choz|fffd| mail
    uplZRSL = 935  '|fffd||fffd|dost na |fffd|SL
    uplDINF = 4    'Dopl|fffd|kov|fffd| info
    uplREL = 260   'Relace
    uplPLI = 36    'Likvida|fffd|n|fffd| zpr|fffd|va
    uplKRYD = 1554 'Kryc|fffd| dopis
    
    'GENERALI
    uplGEN_PLI = 1069  'Likvida|fffd|n|fffd| zpr|fffd|va
    uplGEN_KRYD = 765  'Kryc|fffd| dopis
    uplGEN_OSTD = 735  'Ostatn|fffd| dokumenty - pouze ICMS
    uplGEN_VYP = 1044  'V|fffd|po|fffd|et pln|fffd|n|fffd|
    uplGEN_KAL = 1024  'Kalkulace  - pouze ICMS
    uplGEN_INFK = 962  'Info klientovi - pouze ICMS
    
    uplGEN_OPU = 1066  'Ostatn|fffd| dokumenty PU - pouze TIA
    uplGEN_VYPC = 1045 'V|fffd|po|fffd|et pln|fffd|n|fffd| |fffd||fffd|st - pouze TIA
    uplGEN_DINF = 1021 'Dopl|fffd|kov|fffd| info - pouze TIA
End Enum

Private Const uplRequestCodeStr = "RCUPLQM01 RCUPLDESK RC25CQDZ20 RC25INDUPLOAD04 RC25GLIUP002TIA" 'po|fffd|ad|fffd| dle uplRequestCode

Enum uplRequestCode
    uplRobotLPU = 0       'RCUPLQM01
    uplNaPlochu = 1       'RCUPLDESK
    ulpNaRSL = 2          'RC25CQDZ20
    
    'GENERALI
    uplGENOdeslatKDoindexaciLPU = 3 'RC25INDUPLOAD04
    uplGENOdeslatKDoindexaciTIAGLI = 4 'RC25GLIUP002TIA
End Enum


'**********************************************************************************'
'** Spu|fffd|t|fffd|n|fffd| aplikace Upload s parametrem XML souboru
'** P|fffd|i chyb|fffd| vrac|fffd| 0, v opa|fffd|n|fffd|m p|fffd||fffd|pad|fffd| |fffd||fffd|slo procesu spu|fffd|t|fffd|n|fffd|ho Uploadu
'** P|fffd||fffd|klad:   Call Upload("123", "", "702", Array("c:\data.txt", "c:\data2.txt"))
'**********************************************************************************'

Function Upload(Optional strPripad As String = "", Optional strPodpripad As String = "", Optional strTypeID As uplTypeID, Optional varSoub As Variant, Optional bUserDesktop As uplRequestCode = 0) As Variant

  Const TemporaryFolder = 2
  Dim fso As Object, wsh As Object, tso As Object
  Dim strDACP As String
  Dim strTMP As String
  Dim strSoubXML As String
  Dim f As Integer
  Dim tagFileItems As Boolean
  Dim company As String
  Dim group As String

  Set wsh = CreateObject("WScript.Shell")
  Set fso = CreateObject("Scripting.FileSystemObject")

  Upload = 0
  strDACP = ""

  'Slo|fffd|ka k aplikaci Upload
  On Error Resume Next
  If fso.FileExists("C:\Program Files (x86)\Ceska pojistovna\CP.DA.Client.Upload\CP.DA.Client.Upload.exe") Then _
      strDACP = "C:\Program Files (x86)\Ceska pojistovna\CP.DA.Client.Upload\CP.DA.Client.Upload.exe"
  If fso.FileExists("C:\Program Files\Ceska pojistovna\CP.DA.Client.Upload\CP.DA.Client.Upload.exe") Then _
      strDACP = "C:\Program Files\Ceska pojistovna\CP.DA.Client.Upload\CP.DA.Client.Upload.exe"
  
  If strDACP = "" Or Dir(strDACP) = "" Then strDACP = wsh.RegRead("HKLM\Software\Wow6432Node\Ceska pojistovna\CP.DA.Client.Upload\Application\ExecutableLocation")
  If strDACP = "" Or Dir(strDACP) = "" Then strDACP = wsh.RegRead("HKCU\Software\Ceska pojistovna\CP.DA.Client.Upload\Application\ExecutableLocation")
  If strDACP = "" Or Dir(strDACP) = "" Then strDACP = wsh.RegRead("HKCU\Software\|fffd|esk|fffd| poji|fffd||fffd|ovna\CP.DA.Client.Upload\Application\ExecutableLocation")
  If strDACP = "" Or Dir(strDACP) = "" Then strDACP = wsh.RegRead("HKLM\Software\Ceska pojistovna\CP.DA.Client.Upload\Application\ExecutableLocation")
  If strDACP = "" Or Dir(strDACP) = "" Then strDACP = wsh.RegRead("HKLM\Software\|fffd|esk|fffd| poji|fffd||fffd|ovna\CP.DA.Client.Upload\Application\ExecutableLocation")
  On Error GoTo 0

  If strDACP = "" Then
      MsgBox "Aplikace Upload nen|fffd| spr|fffd|vn|fffd| nainstalov|fffd|na" & vbCrLf & "Kontaktujte l. 99478"
      Exit Function
  End If

  If Dir(strDACP) = "" Then
      MsgBox "Nenalezena aplikace Upload" & vbCrLf & "Kontaktujte l. 99478"
      Exit Function
  End If

  If strPripad = "" Then
      Upload = Shell(strDACP)
      Exit Function
  End If
  
  'Slo|fffd|ka do|fffd|asn|fffd|ch soubor|fffd| (Temporary folder); neexistuje-li, vytvo|fffd|
'  strTMP = fso.GetSpecialFolder(TemporaryFolder) & "\TiaVypoc"
  strTMP = Environ("LOCALAPPDATA") & "\TiaVypoc"
  
  If Not fso.FolderExists(strTMP) Then fso.CreateFolder (strTMP)

  strSoubXML = strTMP + "\Upload" & strPripad & "_" & Mid(fso.GetTempName(), 4, 5) & ".xml"

  'Vytvo|fffd|en|fffd| parametriza|fffd|n|fffd|ho XML
  Set tso = fso.CreateTextFile(strSoubXML, True)
  tso.WriteLine ("<?xml version=""1.0"" encoding=""windows-1250""?>")
  tso.WriteLine ("<XMLDocument xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns=""http://www.cpoj.cz/da/xsd/upload/xmldocument/v200"">")

  If Not IsMissing(varSoub) Then
      If IsArray(varSoub) Then
          tagFileItems = False
          For f = LBound(varSoub) To UBound(varSoub)
              If Trim(varSoub(f)) <> "" Then
                  If Not tagFileItems Then tso.WriteLine ("    <FileItems>")
                  tagFileItems = True
                  tso.WriteLine ("        <anyType xsi:type=""xsd:string"">" & TidyXML(varSoub(f)) & "</anyType>")
              End If
          Next f
          If tagFileItems Then tso.WriteLine ("    </FileItems>")
      Else
          If Trim(varSoub) <> "" Then
              tso.WriteLine ("    <FileItems>")
              tso.WriteLine ("        <anyType xsi:type=""xsd:string"">" & TidyXML(varSoub) & "</anyType>")
              tso.WriteLine ("    </FileItems>")
          End If
      End If
  End If
  
  If bUserDesktop = uplGENOdeslatKDoindexaciLPU And Val(strPripad) > 7000000000# Then bUserDesktop = uplGENOdeslatKDoindexaciTIAGLI
  
  If bUserDesktop = uplGENOdeslatKDoindexaciLPU Or (Val(strPripad) > 3000000000# And Val(strPripad) < 7000000000#) Then
       tso.WriteLine ("    <ClaimSystemId>86</ClaimSystemId>") 'GENERALI ICMS
  Else
       tso.WriteLine ("    <ClaimSystemId>22</ClaimSystemId>") 'CP TIA
  End If
  
  tso.WriteLine ("    <ClaimCode>" & strPripad & "</ClaimCode>")

  If strPodpripad <> "" Then
      tso.WriteLine ("    <DynamicIndexes>")
      tso.WriteLine ("        <DocumentDynamicIndex xmlns:q1=""http://www.cpoj.cz/da/xsd/client/dynamicindex/v200"" xsi:type=""q1:DocumentDynamicIndexInt64"">")
      If bUserDesktop = uplGENOdeslatKDoindexaciLPU Or bUserDesktop = uplGENOdeslatKDoindexaciTIAGLI Or Val(strPripad) > 3000000000# Then
          tso.WriteLine ("            <q1:Code>GPSUBCASE</q1:Code>") 'GENERALI
      Else
          tso.WriteLine ("            <q1:Code>CPSUBCASE</q1:Code>") 'CP
      End If
      tso.WriteLine ("            <q1:Value>" & strPodpripad & "</q1:Value>")
      tso.WriteLine ("        </DocumentDynamicIndex>")
      tso.WriteLine ("    </DynamicIndexes>")
  End If

  'Um|fffd|st|fffd|n|fffd| - pozd|fffd|ji p|fffd|ejmenovat bUserDesktop na bUmisteni - nutno upravit dal|fffd||fffd| moduly
  If bUserDesktop = uplGENOdeslatKDoindexaciLPU And Val(strPripad) > 7000000000# Then bUserDesktop = uplGENOdeslatKDoindexaciTIAGLI
  tso.WriteLine ("    <RequestCode>" & Split(uplRequestCodeStr)(Abs(bUserDesktop)) & "</RequestCode>")

  tso.WriteLine ("    <Note></Note>")
  tso.WriteLine ("    <ReceiveDate></ReceiveDate>")
  
  If bUserDesktop = uplGENOdeslatKDoindexaciTIAGLI Or Val(strPripad) > 7000000000# Then
    Select Case strTypeID
        Case uplGEN_OSTD: strTypeID = uplGEN_OPU
        Case uplGEN_KAL: strTypeID = uplGEN_VYP
        Case uplGEN_INFK: strTypeID = uplGEN_DINF
    End Select
  End If
  
  If bUserDesktop = uplGENOdeslatKDoindexaciLPU Or (Val(strPripad) > 3000000000# And Val(strPripad) < 7000000000#) Then
    Select Case strTypeID
        Case uplGEN_OPU: strTypeID = uplGEN_OSTD
        Case uplGEN_VYPC: strTypeID = uplGEN_KAL
        Case uplGEN_DINF: strTypeID = uplGEN_INFK
    End Select
  End If
  
  tso.WriteLine ("    <TypeId>" & strTypeID & "</TypeId>")
  tso.WriteLine ("    <SectionId>4</SectionId>")
  tso.WriteLine ("</XMLDocument>")
  tso.Close

  If bUserDesktop = uplGENOdeslatKDoindexaciLPU Or Val(strPripad) > 3000000000# Then company = " /CM:2" Else company = " /CM:1"
  
  If Val(strPripad) > 7000000000# Then
    group = " /G:444" 'GNZP-TIA
  ElseIf Val(strPripad) > 3000000000# Then
    group = " /G:237" 'GNZP-ICMS
  Else
    group = "" 'NZP LPU-SS
  End If
  
  'Spu|fffd|t|fffd|n|fffd| aplikace Upload
  Upload = Shell(strDACP & company & group & " /X:""" & strSoubXML & """", 1)
  SaveToLog strDACP & company & group & " /X:""" & strSoubXML & """", strSoubXML, Upload
End Function


'**********************************************************************************'
'** Spu|fffd|t|fffd|n|fffd| aplikace Upload
'** P|fffd|i chyb|fffd| vrac|fffd| 0, v opa|fffd|n|fffd|m p|fffd||fffd|pad|fffd| |fffd||fffd|slo procesu spu|fffd|t|fffd|n|fffd|ho Uploadu
'**********************************************************************************'

Function UploadInit() As Variant
  UploadInit = Upload
  SaveToLog "", "", UploadInit
End Function


'**********************************************************************************'
'** Z|fffd|m|fffd|na neplatn|fffd|ch znak|fffd| v XML
'**********************************************************************************'
Private Function TidyXML(ByVal tag As String) As String
  tag = Replace(tag, "&", "&amp;")
  tag = Replace(tag, """", "&quot;")
  tag = Replace(tag, "'", "&apos;")
  tag = Replace(tag, "<", "&lt;")
  tag = Replace(tag, ">", "&gt;")
  TidyXML = tag
End Function


'**********************************************************************************'
'** Logov|fffd|n|fffd|
'**********************************************************************************'
Private Sub SaveToLog(CmdLine As String, strSoubXML As String, exitCode As Variant)
  Dim fso As Object, tso As Object
  Dim user As String
  Const pth = "\\czcsfs216\Data1\cdap\LPUNZP\Data\Upload\"
  
  On Error Resume Next
  Set fso = CreateObject("Scripting.FileSystemObject")
  user = CreateObject("WScript.Network").UserName
  If Not fso.FileExists(pth & "_" & user) And Not fso.FileExists(pth & "_all") Then Exit Sub
  Set tso = fso.OpenTextFile(pth & "_UploadLog.txt", 8, True)
  tso.WriteLine (Format(Now, "YYYY-MM-DD HH:MM:SS") & vbTab & user & vbTab & exitCode & vbTab & CmdLine & vbTab & Environ("COMPUTERNAME"))
  tso.Close
  If fso.FileExists(strSoubXML) Then fso.CopyFile strSoubXML, pth, True
End Sub


Attribute VB_Name = "rsoUploadAudaKalkulace"
'*******************************************************'
'* UploadAudaKalkulace                                 *'
'* RSO 2015-03-02 - Obsah tohoto modulu nem|fffd|nit!       *'
'*                                                     *'
'* Vy|fffd|aduje modul rsoUpload, rsoWaitForm               *'
'*******************************************************'
Option Explicit

Private Const cUmisteniKalkulaceAudanetu = "HKCU\Software\LPUNZP\Audanet\Slo|fffd|kaKalkulace"
'Private Declare Sub Sleep Lib "kernel32.dll" (ByVal dwMilliseconds As Long) - ji|fffd| v modulu rsoPDF


'**********************************************************************************'
'** Proveden|fffd| uploadu souboru kalkulace z AudaNetu
'**********************************************************************************'

Sub ProvedUploadKalkulaceAudaNetu(sPU As String, Optional sPP As String, Optional sTypeID As uplTypeID = uplVEX, Optional sRequestCode As uplRequestCode = uplRobotLPU)
  Dim soubPDF As String
  Dim soub As Variant
  Dim poc As Integer

  If sPU = "" Then
      MsgBox "Nevypln|fffd|no |fffd||fffd|slo p|fffd||fffd|padu..."
      Exit Sub
  End If

  soubPDF = GetAudaNetFile(sPU)
  If soubPDF = "" Then Exit Sub
  poc = 0

  'Zobraz informa|fffd|n|fffd| hl|fffd|en|fffd|
  rsoWaitForm.Show (False)
  rsoWaitForm.Repaint

  'Spu|fffd|t|fffd|n|fffd| Uploadu s indexy a souborem PDF
  For Each soub In Split(soubPDF, ",")
      poc = poc + 1
      If Upload(strPripad:=sPU, _
            strPodpripad:=sPP, _
            strTypeID:=sTypeID, _
            varSoub:=soub, _
            bUserDesktop:=sRequestCode) = 0 Then

            'Chyba p|fffd|i Uploadu
            rsoWaitForm.Hide
            MsgBox "Chyba automatizace. Prove|fffd|te Upload manu|fffd|ln|fffd|."
            Exit Sub
      End If
      WaitForProcess "CP.DA.Client.Upload.exe", 2, 15
      If poc = 1 Then Sleep 4000 Else Sleep 3000
      Application.Wait (Now + TimeValue("0:00:01"))
      rsoWaitForm.Repaint

  Next soub

  rsoWaitForm.Hide

End Sub


'**********************************************************************************'
'** |fffd|ek|fffd|n|fffd| na spu|fffd|t|fffd|n|fffd| procesu - zde pro |fffd|ek|fffd|n|fffd| na "CP.DA.Client.Upload.exe"
'**********************************************************************************'

Private Sub WaitForProcess(sProcess As String, Optional sWait As Integer = 0, Optional sMaxWait As Integer = 30)
  Dim objWMIService As Object
  Dim colProcessList As Variant
  Dim objProcess As Variant
  Dim dat As String
  Dim datdiff As Integer
  Dim datstart As Date

  On Error Resume Next
  Set objWMIService = GetObject("winmgmts:" _
      & "{impersonationLevel=impersonate}!\\.\root\cimv2")
  datdiff = -1
  datstart = Now

  Do
      Set colProcessList = objWMIService.ExecQuery _
        ("Select * from Win32_Process Where Name = '" & sProcess & "'")

      If colProcessList.Count > 0 Then
          For Each objProcess In colProcessList
             dat = Mid(objProcess.CreationDate, 1, 4) & "-" & Mid(objProcess.CreationDate, 5, 2) & "-" & Mid(objProcess.CreationDate, 7, 2)
             dat = dat & " " & Mid(objProcess.CreationDate, 9, 2) & ":" & Mid(objProcess.CreationDate, 11, 2) & ":" & Mid(objProcess.CreationDate, 13, 2)
             datdiff = DateDiff("s", CDate(dat), Now)
             Exit For
          Next
      Else
          Sleep 500
      End If

      If DateDiff("s", datstart, Now) >= sMaxWait Then Exit Do

  Loop While colProcessList.Count = 0 Or datdiff < sWait
  On Error GoTo 0
End Sub


'**********************************************************************************'
'** Nalezen|fffd| souboru kalkulace z AudaNetu - soubor PDF za|fffd||fffd|naj|fffd|c|fffd| na |fffd||fffd|slo PU
'**********************************************************************************'

Function GetAudaNetFile(sPU As String) As String
  Dim soubPDF As Variant
  Dim actDir As String
  Dim net As Object, fso As Object
  Dim folders(2) As String
  Dim folder As Variant
  Dim sDir As String
  Dim drv As Variant
  Dim f As Integer


  Set net = CreateObject("WScript.Network")
  Set fso = CreateObject("Scripting.FileSystemObject")

  folders(0) = RegReadCalcFolder
  folders(1) = "H:\Dokumenty"
  folders(2) = "H:\Dokumenty\AudapadPDF"

  For f = LBound(folders) + 1 To UBound(folders)
      If UCase(folders(0)) = UCase(folders(f)) Then folders(0) = ""
  Next f

  GetAudaNetFile = ""

  For Each folder In folders
      If fso.FolderExists(folder) Then

          soubPDF = Dir(folder & "\" & sPU & "*.pdf")
          Do While soubPDF <> ""  'V p|fffd||fffd|pad|fffd| v|fffd|ce nalezen|fffd|ch soubor|fffd| se budou postupn|fffd| nab|fffd|zet
              If MsgBox("Nalezen soubor: " & soubPDF & vbCrLf & _
                        "Vytvo|fffd|en: " & fso.GetFile(folder & "\" & soubPDF).DateCreated & vbCrLf & _
                        "Jedn|fffd| se o kalkulaci z AudaNetu?", vbQuestion + vbDefaultButton1 + vbYesNo, _
                        "Potvrzen|fffd| souboru kalkulace z AudaNetu") = vbYes Then
                  GetAudaNetFile = GetAudaNetFile & "," & folder & "\" & soubPDF
                  RegWriteCalcFolder (folder)
              End If
              soubPDF = Dir
          Loop

          If GetAudaNetFile <> "" Then
              GetAudaNetFile = Mid(GetAudaNetFile, 2)
              Exit Function
          End If

      End If
  Next folder


  'Soubor nenalezen |fffd|i neschv|fffd|len - spu|fffd|t|fffd|n|fffd| dialogu Otev|fffd||fffd|t

  actDir = CurDir
  folder = RegReadCalcFolder

  On Error Resume Next

  If Left(folder, 2) = "\\" Then

      For Each drv In Split("X:,Y:,Z:,W:,V:", ",")
        If Not fso.FolderExists(drv) Then Exit For
      Next drv

      net.MapNetworkDrive drv, fso.GetDriveName(folder)
      ChDrive drv
      sDir = Mid(folder, Len(fso.GetDriveName(folder)) + 1)
      If sDir <> "" Then ChDir sDir
  ElseIf folder <> "" Then
      ChDrive Left(folder, 1)
      ChDir folder
  End If

  soubPDF = Application.GetOpenFilename("Kalkulace z Audanetu (*.pdf), *.pdf", , "Otev|fffd||fffd|t kalkulaci z AudaNetu")

  If soubPDF <> False Then
      If Left(soubPDF, 2) = drv Then _
          soubPDF = fso.GetDriveName(folder) & Mid(soubPDF, 3)
      GetAudaNetFile = soubPDF
      RegWriteCalcFolder (fso.GetParentFolderName(soubPDF))
  Else
      GetAudaNetFile = ""
  End If

  If fso.FolderExists(drv) Then net.RemoveNetworkDrive drv, True

  ChDir actDir
  ChDrive Left(actDir, 1)

End Function


'**********************************************************************************'
'** Zji|fffd|t|fffd|n|fffd| slo|fffd|ky ulo|fffd|en|fffd|ch kalkulac|fffd| z registru
'**********************************************************************************'

Private Function RegReadCalcFolder() As String
  RegReadCalcFolder = ""
  On Error Resume Next
  RegReadCalcFolder = CreateObject("WScript.Shell").RegRead(cUmisteniKalkulaceAudanetu)
  On Error GoTo 0
End Function


'**********************************************************************************'
'** Zaps|fffd|n|fffd| slo|fffd|ky ulo|fffd|en|fffd|ch kalkulac|fffd| do registru
'**********************************************************************************'

Private Function RegWriteCalcFolder(sFolder As String)
  On Error Resume Next
  CreateObject("WScript.Shell").RegWrite cUmisteniKalkulaceAudanetu, sFolder, "REG_SZ"
  On Error GoTo 0
End Function

Attribute VB_Name = "rsoWaitForm"
Attribute VB_Base = "0{72701065-477F-46EA-9B5E-FC0EBB0F3710}{1B9A027C-0DEB-4452-8538-2DA0F35524CA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Attribute VB_Name = "rsoXMLReader"
'Attribute VB_Name = "rsoXMLReader"
'*******************************************************'
'* XMLReader Ver.7.4                                   *'
'* RSO 2015-06-16 - Obsah tohoto modulu nem|fffd|nit!       *'
'*******************************************************'
Option Explicit

Private xmlDct As Object
Private xmlEr As String
Private xmlLastTagName As String
Private xmlLastTagValue As String


'**********************************************************************************'
'Vr|fffd|t|fffd| plnou cestu k souboru TIA_ES.xml - |fffd|prava pro CITRIX
'**********************************************************************************'

Public Function xmlTIA() As String
  Dim fso As Object
  Set fso = CreateObject("Scripting.FileSystemObject")
  On Error Resume Next
  xmlTIA = "c:\tiavypoc\TIA_ES.xml"
  
  If Environ("CP_DATA_PATH") <> "" Then
      xmlTIA = Environ("CP_DATA_PATH") & "\TiaVypoc\TIA_ES.xml"
  ElseIf Environ("HOMEDRIVE") <> "" Then
      If fso.DirectoryExists(Environ("HOMEDRIVE") & "\TiaVypoc") Then
          xmlTIA = Environ("HOMEDRIVE") & "\TiaVypoc\TIA_ES.xml"
          If fso.FileExists("c:\tiavypoc\TIA_ES.xml") And fso.FileExists(xmlTIA) Then
              If FileDateTime("c:\tiavypoc\TIA_ES.xml") > FileDateTime(xmlTIA) Then
                  xmlTIA = "c:\tiavypoc\TIA_ES.xml"
              End If
          End If
      End If
  End If
  
  On Error GoTo 0
End Function


'**********************************************************************************'
'Vr|fffd|t|fffd| plnou cestu k souboru TIA.dat - |fffd|prava pro CITRIX
'**********************************************************************************'

Public Function datTIA() As String
  datTIA = CreateObject("Scripting.FileSystemObject").GetParentFolderName(xmlTIA) & "\TIA.dat"
End Function


'**********************************************************************************'
'** Na|fffd|ten|fffd| souboru XML do prom|fffd|nn|fffd| xmlDct dle zadan|fffd|ho kl|fffd||fffd|e (inicializace)
'** xmlSource    - m|fffd||fffd|e b|fffd|t soubor nebo text s xml obsahem, v|fffd|choz|fffd|m je soubor xmlTIA
'** xmlKey       - je libovoln|fffd| hodnota umo|fffd||fffd|uj|fffd|c|fffd| pracovat sou|fffd|asn|fffd| s v|fffd|ce XML
'**                pou|fffd||fffd|v|fffd| se p|fffd|i |fffd|ten|fffd| hodnot v XMLRead jako kl|fffd||fffd|, kter|fffd| soubor |fffd|teme
'** xmlUpperCase - pokud je true, nen|fffd| rozli|fffd|ov|fffd|na velikost p|fffd|smen v tagu (v|fffd|choz|fffd| false, pro xmlTIA je automaticky true)
'**********************************************************************************'

Public Function XMLInic(Optional xmlSource As String = "", Optional xmlKey = "xmlTIA", Optional xmlUpperCase As Boolean = False) As Boolean
  Dim xmlTmp As Object
  Dim xmlTmpOrig As Object
  
  xmlEr = ""
  xmlLastTagName = ""
  xmlLastTagValue = ""
  
  If xmlSource = "" Or xmlSource = "xmlTIA" Then
      xmlSource = xmlTIA
      xmlUpperCase = True
  End If

  Set xmlTmp = CreateObject("Msxml2.DOMDocument.3.0")     'SelectionLanguage = XSLPattern
  Set xmlTmpOrig = CreateObject("Msxml2.DOMDocument.6.0") 'SelectionLanguage = XPath
  xmlTmp.async = False
  xmlTmpOrig.async = False
  
  On Error Resume Next
  If InStr(1, xmlSource, "<") > 0 Then
      xmlTmp.LoadXML xmlSource
      xmlTmpOrig.LoadXML xmlSource
  Else
      xmlTmp.Load xmlSource
      xmlTmpOrig.Load xmlSource
  End If
  On Error GoTo 0
  
'  xmlTmpOrig.setProperty "SelectionLanguage", "XPath"
  xmlTmpOrig.setProperty "SelectionNamespaces", GetNameSpaces(xmlTmpOrig.xml)
  
  XMLInic = xmlTmp.parseError.ErrorCode = 0
  If xmlTmp.parseError.ErrorCode <> 0 Then
      xmlEr = "url:\" & vbTab & xmlTmp.parseError.URL
      xmlEr = xmlEr & vbLf & "Error:  " & vbTab & xmlTmp.parseError.ErrorCode
      xmlEr = xmlEr & vbLf & "Reason: " & vbTab & xmlTmp.parseError.Reason
      xmlEr = xmlEr & vbLf & "Line:   " & vbTab & xmlTmp.parseError.Line
      xmlEr = xmlEr & vbLf & "LinePos:" & vbTab & xmlTmp.parseError.LinePos
      xmlEr = xmlEr & vbLf & "FilePos:" & vbTab & xmlTmp.parseError.FilePos
      xmlEr = xmlEr & vbLf & "SrcText:" & vbTab & xmlTmp.parseError.SrcText
       
      If xmlSource = xmlTIA Then _
          MsgBox "Nelze na|fffd||fffd|st |fffd|daje z TIA!" & vbLf & _
             "Restartujte po|fffd||fffd|ta|fffd| pro op|fffd|tovn|fffd| namapov|fffd|n|fffd| sd|fffd|len|fffd|ch s|fffd|ov|fffd|ch disk|fffd|." & vbLf & _
             "Pokud probl|fffd|m bude p|fffd|etrv|fffd|vat kontaktujte linku 99478."
  Else
      If xmlUpperCase Then Set xmlTmp = XMLUCase(xmlTmp) 'P|fffd|eve|fffd| v|fffd|echny tagy na velk|fffd| p|fffd|smena
  End If
  
  
  If xmlDct Is Nothing Then Set xmlDct = CreateObject("Scripting.Dictionary")
  If xmlDct.Exists(xmlKey) Then xmlDct.Remove xmlKey
  If xmlDct.Exists("orig#" & xmlKey) Then xmlDct.Remove "orig#" & xmlKey
  xmlDct.Add xmlKey, Array(xmlTmp, xmlUpperCase)
  xmlDct.Add "orig#" & xmlKey, Array(xmlTmpOrig, False)

  Set xmlTmp = Nothing
  Set xmlTmpOrig = Nothing
End Function


'**********************************************************************************'
'** Odstran|fffd| z xmlDct na|fffd|ten|fffd| XML dle kl|fffd||fffd|e xmlKey
'**********************************************************************************'

Public Function XMLRelease(Optional xmlKey = "xmlTIA") As Boolean
  If xmlDct Is Nothing Then Exit Function
  If xmlDct.Exists(xmlKey) Then xmlDct.Remove xmlKey
  If xmlDct.Exists("orig#" & xmlKey) Then xmlDct.Remove "orig#" & xmlKey
End Function


'**********************************************************************************'
'** Funkce vr|fffd|t|fffd| posledn|fffd| chybov|fffd| stav p|fffd|i na|fffd||fffd|t|fffd|n|fffd| xml souboru
'**********************************************************************************'

Public Function XMLErr()
  XMLErr = xmlEr
End Function


'**********************************************************************************'
'** Funkce zjist|fffd| pou|fffd|it|fffd| jmenn|fffd| prostory v xml souboru - pou|fffd|ito v XMLInic
'**********************************************************************************'

Private Function GetNameSpaces(xml As String) As String
    Dim ns, ns1
    GetNameSpaces = ""
    If InStr(xml, "xmlns:") > 0 Then
        For Each ns In Split(Replace(Replace(xml, ">", ""), "<", " "), " ")
            If InStr(ns, "xmlns:") = 1 Then
                ns1 = Split(ns, """")(0) & """" & Split(ns, """")(1) & """"
                If InStr(1, GetNameSpaces, ns1) = 0 Then GetNameSpaces = GetNameSpaces & ns1 & vbLf
            End If
        Next ns
    End If
    If InStr(xml, "xmlns=") > 0 Then 'pro v|fffd|choz|fffd| jmenn|fffd| prostor nastavujeme prefix "def:"
        For Each ns In Split(Replace(Replace(xml, ">", ""), "<", " "), " ")
            If InStr(ns, "xmlns=") = 1 Then
                ns1 = Split(ns, """")(0) & """" & Split(ns, """")(1) & """"
                If InStr(1, GetNameSpaces, ns1) = 0 Then GetNameSpaces = GetNameSpaces & Replace(ns1, "xmlns=", "xmlns:def=") & vbLf
                Exit For
            End If
        Next ns
    End If
End Function


'**********************************************************************************'
'** Funkce vr|fffd|t|fffd| hodnotu z XML dle zadan|fffd|ho tagu
'** V p|fffd||fffd|pad|fffd| neexistence tagu vrac|fffd| sDefault, pokud je nastaven|fffd|, jinak ""
'** xmlKey - jednozna|fffd|n|fffd| identifik|fffd|tor na|fffd|ten|fffd|ho XML souboru (nastavuje se v XMLInic)
'**        - lze vyplnit n|fffd|zvem souboru xml |fffd|i p|fffd||fffd|mo obsahem xml (bez prvot. inicial. p|fffd|es XMLInic)
'** Tagy lze uzav|fffd||fffd|t do ostr|fffd|ch z|fffd|vorek nebo pou|fffd||fffd|t odd|fffd|lova|fffd| lom|fffd|tko "/"
'** Pokud jsou pou|fffd|ita lom|fffd|tka, nen|fffd| provedena transformace zdrojov|fffd|ho XML - z|fffd|pis tag|fffd| mus|fffd| b|fffd|t case sensitive
'** V p|fffd||fffd|pad|fffd| z|fffd|pisu s lom|fffd|tky lze pou|fffd||fffd|t funkce XPath 1.0; prvn|fffd| hodnota = 1
'**
'** P|fffd||fffd|klady pou|fffd|it|fffd| funkce XMLRead:
'**   MsgBox XMLRead("<Document><ClaEvent><ClaEventNo>")     - |fffd|pln|fffd| z|fffd|pis
'**   MsgBox XMLRead("<ClaCaseNo>")                          - zkr|fffd|cen|fffd| z|fffd|pis
'**   MsgBox XMLRead("<Object#5#><SeqNo>")                   - |fffd||fffd|seln|fffd| podm|fffd|nka (prvn|fffd| hodnota = 1)
'**   MsgBox XMLRead("<Object#<ObjectName>Drah|fffd|#><SeqNo>")   - textov|fffd| podm|fffd|nka
'**   MsgBox XMLRead("<AgreementLine><Role#<RoleType>24</RoleType>#2#><RoleNo>") - kombinace
'**   MsgBox XMLRead("<Question[1]>");                       - |fffd||fffd|seln|fffd| podm|fffd|nka (prvn|fffd| hodnota = 0)
'**   MsgBox XMLRead("<Question[@id='201']>");               - hled|fffd|n|fffd| dle atributu
'**   MsgBox XMLRead("//ClaEvent/ClaEventNo",,"C:\TIA_ES.xml")- z|fffd|pis s "/" s ur|fffd|en|fffd|m zdroj. souboru
'**   MsgBox XMLRead("//D1/AD",,"<D1><AD>Test</AD></D1>")     - z|fffd|pis s "/" s p|fffd||fffd|m|fffd|m z|fffd|pisem xml (prvn|fffd| hodnota = 1)
'**   MsgBox XMLRead("//D1/AD/@atr",,"<D1><AD atr = ""atribut"">Test</AD></D1>") - zji|fffd|t|fffd|n|fffd| hodnoty atributu
'**   MsgBox XMLRead("//D1/AD/@",,"<D1><AD atr = ""atribut"">Test</AD></D1>") - vr|fffd|t|fffd| cel|fffd| tag AD - p|fffd|idan|fffd| funk|fffd|nost
'**********************************************************************************'

Public Function XMLRead(ByVal sTags As String, Optional sDefault As String = "", Optional xmlKey = "xmlTIA") As String
  Dim xmlTmp As Object
  Dim xmlUpperCase As Boolean
  Dim rootnode As Object, node As Object
  Dim arr As Variant, ar As Variant
  Dim tg As String
  Dim n As Integer
  Dim cnt As Integer
  Dim ind As Integer
  Dim fnd As String
  Dim orig As Boolean
  Dim xmlKey2

  orig = Left(Trim(sTags), 2) = "//"
    
  'Kontrola na|fffd|ten|fffd|ho XML do glob|fffd|ln|fffd| prom|fffd|nn|fffd| typu Dictionary
  If xmlDct Is Nothing Then
      If Not XMLInic(CStr(xmlKey), xmlKey) Then GoTo chyba
  Else
      'Pokud kl|fffd||fffd| neexistuje, zkus jej pou|fffd||fffd|t jako zdroj pro XMLInic
      If Not xmlDct.Exists(xmlKey) Then
          If Not XMLInic(CStr(xmlKey), xmlKey) Then GoTo chyba
      Else
          'Pokud |fffd|teme znovu stejn|fffd| tag, vra|fffd| ulo|fffd|en|fffd| posledn|fffd| v|fffd|sledek
          If xmlLastTagName = sTags & sDefault & CStr(IIf(orig, "orig#", "") & xmlKey) Then
              XMLRead = xmlLastTagValue
              Exit Function
          End If
      End If
  End If
  
  On Error GoTo chyba:
  
  If orig Then xmlKey2 = "orig#" & CStr(xmlKey) Else xmlKey2 = CStr(xmlKey)
  
  xmlLastTagName = sTags & sDefault & CStr(xmlKey2)
  xmlLastTagValue = ""
  
  'Na|fffd|ten|fffd| ulo|fffd|en|fffd|ch hodnot
  Set xmlTmp = xmlDct(xmlKey2)(0)
  xmlUpperCase = xmlDct(xmlKey2)(1)

  If xmlUpperCase Then sTags = UCase(sTags)
  sTags = Trim(sTags)
  tg = sTags
  
  If Not orig Then 'XML p|fffd|evedena na velk|fffd| p|fffd|smena (dle xmlInic - xmlUpperCase), pou|fffd||fffd|vaj|fffd| se <>
      'Odstra|fffd| text p|fffd|ed prvn|fffd|m "<" v|fffd|etn|fffd| a za posledn|fffd|m ">" v|fffd|etn|fffd|
      '  Znak "<" mus|fffd| b|fffd|t p|fffd|ed "#" pokud "#" existuje
      If InStr(1, Split(sTags + "#", "#")(0), "<") > 0 Then
          sTags = StrReverse(Mid(sTags, InStr(1, sTags, "<") + 1))
          sTags = StrReverse(Mid(sTags, InStr(1, sTags, ">") + 1))
      End If
      
      arr = Split(sTags, "><")            'Ulo|fffd| do pole
    
      'Nastav v|fffd|choz|fffd| node dle prvn|fffd|ho tagu, vynechej p|fffd||fffd|padnou podm|fffd|nku za #
      Set rootnode = xmlTmp.selectSingleNode("//" & Split(arr(0) + "#", "#")(0))
    
      'Posu|fffd| node o |fffd|rove|fffd| n|fffd|e, pokud to lze (kv|fffd|li p|fffd||fffd|padn|fffd| podm|fffd|nce v prvn|fffd|m tagu)
      If rootnode.parentNode.nodeType = 1 Then
          'Znovu nastav pole s p|fffd|id|fffd|n|fffd|m jedn|fffd| ni|fffd||fffd||fffd| |fffd|rovn|fffd|
          arr = Split(rootnode.parentNode.tagName & "><" & sTags, "><")
          Set rootnode = xmlTmp.selectSingleNode("//" & rootnode.parentNode.tagName)
      End If
    
      tg = ""
      For n = 1 To UBound(arr)
          ar = Split(arr(n), "#")
    
          'Prvn|fffd| |fffd||fffd|seln|fffd| podm|fffd|nka
          If UBound(ar) > 0 Then
              If Trim(CStr(Val(ar(1)))) = Trim(ar(1)) Then
                  arr(n) = Split(arr(n), "#")(0) & "[" & Trim(CStr(Val(ar(1)) - 1)) & "]"
              End If
          Else
              arr(n) = arr(n) & "[0]"
          End If
          ar = Split(arr(n), "#")
    
    
          tg = tg & "/" & ar(0)
    
          'Textov|fffd| podm|fffd|nka
          If UBound(ar) > 0 Then
    
              'Druh|fffd| |fffd||fffd|seln|fffd| podm|fffd|nka po podm|fffd|nce textov|fffd| - nastaven|fffd| prom|fffd|nn|fffd| cnt
              cnt = 0
              If UBound(ar) > 1 Then
                  If Trim(CStr(Val(ar(2)))) = Trim(ar(2)) Then
                      cnt = Val(ar(2))
                  End If
              End If
    
              Set node = rootnode.getElementsByTagName(Mid(tg, 2))
              ind = -1
    
              Do  '|fffd||fffd|ta|fffd| druh|fffd| |fffd||fffd|seln|fffd| podm|fffd|nky, pokud existuje
                  cnt = cnt - 1
                  Do
                      ind = ind + 1
                      fnd = node.NextNode().xml
                  Loop While InStr(1, IIf(xmlUpperCase, UCase(fnd), fnd), ar(1)) = 0
              Loop While cnt > 0
    
              tg = tg & "[" & ind & "]"
              arr(n) = ar(0) & "[" & ind & "]"
    
          End If
    
      Next n
      
      'Vra|fffd| nalezenou hodnotu
      Set rootnode = xmlTmp.selectSingleNode("//" & Join(arr, "/"))
  Else 'orig - pou|fffd||fffd|vaj|fffd| se pouze lom|fffd|tka, zdrojov|fffd| XML bez |fffd|prav
      If Right(tg, 2) = "/@" Then 'Pokud kon|fffd||fffd| na /@ vr|fffd|t|fffd| xml tagu
          Set rootnode = xmlTmp.selectSingleNode(Left(tg, Len(tg) - 2))
          XMLRead = rootnode.xml   'struktura xml hledan|fffd|ho tagu
          xmlLastTagValue = XMLRead
          Exit Function
      Else
          Set rootnode = xmlTmp.selectSingleNode(tg)
      End If
  End If
  
  If rootnode.FirstChild Is Nothing Then
      XMLRead = ""
  Else
      If rootnode.FirstChild.nodeType = 3 Or rootnode.FirstChild.nodeType = 4 Then 'NODE_TEXT or CDATA_SECTION_NODE
          XMLRead = rootnode.Text  'hodnota tagu
      Else
          XMLRead = rootnode.xml   'struktura xml hledan|fffd|ho tagu
      End If
  End If
  
  xmlLastTagValue = XMLRead
  
  Exit Function

chyba:
  XMLRead = sDefault
  xmlLastTagValue = XMLRead

End Function


'**********************************************************************************'
'** Vypln|fffd|n|fffd| definovan|fffd|ho listu hodnotami z XML dle zad|fffd|n|fffd| v bu|fffd|k|fffd|ch.
'** V|fffd|stup do sousedn|fffd| prav|fffd| bu|fffd|ky
'**********************************************************************************'

Public Sub XMLReadToTemplateSheet(sSheetName As String)
  Dim C As Range
  Dim firstAddress As String
  Dim xcalc As XlCalculation
  Dim ecalc As Boolean

  xcalc = Application.Calculation
  ecalc = ThisWorkbook.Sheets(sSheetName).EnableCalculation
  
  Application.EnableEvents = False
  Application.Calculation = xlCalculationManual
  ThisWorkbook.Sheets(sSheetName).EnableCalculation = False
  
  With ThisWorkbook.Sheets(sSheetName).UsedRange

      Set C = .Find("<*>", LookIn:=xlValues)
      If Not C Is Nothing Then
          firstAddress = C.Address
          Do
              C.Offset(0, 1).Value = XMLRead(C.Text)
              Set C = .FindNext(C)
          Loop While Not C Is Nothing And C.Address <> firstAddress
      End If
      
      Set C = .Find("//*", LookIn:=xlValues)
      If Not C Is Nothing Then
          firstAddress = C.Address
          Do
              C.Offset(0, 1).Value = XMLRead(C.Text)
              Set C = .FindNext(C)
          Loop While Not C Is Nothing And C.Address <> firstAddress
      End If

  End With
  
  ThisWorkbook.Sheets(sSheetName).EnableCalculation = ecalc
  Application.Calculation = xcalc
  Application.EnableEvents = True
End Sub


'**********************************************************************************'
'** Vytvo|fffd|en|fffd| souboru TIA.dat ze souboru TIA_ES.xml (prom. datTIA a xmlTIA)
'** parametr bForce - true - v|fffd|dy p|fffd|epi|fffd| TIA.dat
'**                 - false - default - p|fffd|epi|fffd| TIA.dat, pokud je XML nov|fffd|j|fffd||fffd|
'**********************************************************************************'

Public Sub CreateTIADAT(Optional bForce As Boolean)
  Dim arr(1 To 35) As String
  Dim uTag As String
  Dim f As Integer
  Dim tso As Object, fso As Object


  Set fso = CreateObject("Scripting.FileSystemObject")

  If Not fso.FileExists(xmlTIA) Then Exit Sub

  If fso.FileExists(datTIA) And Not bForce Then
      If fso.GetFile(datTIA).DateLastModified > fso.GetFile(xmlTIA).DateLastModified Then Exit Sub
  End If

  For f = LBound(arr) To UBound(arr)
      arr(f) = ""
  Next f

  If XMLRead("<ClaSubcase><ThirdParty>") <> "" Then
      uTag = "<ClaSubcase><ThirdParty>"
  Else
      uTag = "<ClaCase>"
  End If

  arr(1) = XMLRead(uTag & "<Name><NameIdNo>")
  arr(3) = XMLRead(uTag & "<Name><ForeName>")
  arr(4) = XMLRead(uTag & "<Name><SurName>")
  arr(5) = XMLRead(uTag & "<Name><Street>")
  arr(6) = XMLRead(uTag & "<Name><StreetNo>")
  arr(7) = XMLRead(uTag & "<Name><City>")
  arr(8) = XMLRead(uTag & "<Name><PostArea>")
  arr(9) = XMLRead(uTag & "<Name><CivilRegCode>")
  arr(10) = XMLRead(uTag & "<Name><CompanyRegNo>")

  If XMLRead("<ClaSubcase><ThirdParty>") <> "" Then
      arr(14) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><VehType>")
      arr(15) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><VehMake>")
      arr(16) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><VIN>")
      arr(17) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><CarRegNo>")
      arr(20) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><ManufactureYear>")
      arr(21) = XMLRead("<ClaSubcase><ThirdParty><ThirdPartyPOV><FirstOperationDate>")
  ElseIf XMLRead("<VehicleCard>") <> "" Then
      arr(14) = XMLRead("<VehicleCard><ModelDesc>")
      arr(15) = XMLRead("<VehicleCard><MakeDesc>")
      arr(16) = XMLRead("<VehicleCard><VIN>")
      arr(17) = XMLRead("<VehicleCard><RegistrationNo>")
      arr(18) = XMLRead("<VehicleCard><EngineSize>")
      arr(19) = XMLRead("<VehicleCard><EnginePower>")
      arr(20) = XMLRead("<VehicleCard><ManufactureYear>")
      arr(21) = XMLRead("<VehicleCard><FirstOperationDate>")
  Else
      arr(14) = XMLRead("<Object><ModelDesc>")
      arr(15) = XMLRead("<Object><MakeDesc>")
      arr(16) = XMLRead("<Object><VIN>")
      arr(17) = XMLRead("<Object><RegistrationNo>")
      arr(18) = XMLRead("<Object><EngineSize>")
      arr(19) = XMLRead("<Object><EnginePower>")
      arr(20) = XMLRead("<Object><ManufactureYear>")
      arr(21) = XMLRead("<Object><FirstOperationDate>")
  End If

  arr(22) = XMLRead("<LegacyPolicyNo>")
  arr(23) = XMLRead("<PolicyNo>")
  arr(24) = XMLRead("<ClaSubcase><ClaSubCaseNo>")
'  arr(25) = XMLRead("<ThirdPartyNo>")

  If InStr(1, XMLRead("<Object><Excess>"), "v|fffd|ak") > 0 Then
      If InStr(1, XMLRead("<Object><Excess>"), "v|fffd|ak K|fffd|") > 0 Then
          arr(26) = Split(XMLRead("<Object><Excess>"), "K|fffd| ")(1) 'HAVAR: 5%, minim|fffd|ln|fffd| v|fffd|ak K|fffd| 5 000
      Else
          arr(26) = Split(Split(XMLRead("<Object><Excess>"), "v|fffd|ak ")(1), " K|fffd|")(0) 'AFH01: 5%, minim|fffd|ln|fffd| v|fffd|ak 5 000 K|fffd|
      End If
      arr(26) = Split(arr(26))(0) & Split(arr(26))(1)
      arr(27) = Split(XMLRead("<Object><Excess>"), "%")(0) 'HAVAR, AFH01
  End If

  arr(28) = XMLRead("<Object><Limit>") 'HAVAR
  arr(29) = XMLRead("<ClaCaseNo>")
  arr(30) = Left(XMLRead("<IncidentDate>"), 10)
  arr(31) = XMLRead("<ClaSubcase><Handler>")
  arr(32) = XMLRead("<ClaSubcase><UserName>")
  arr(35) = XMLRead("<SubCaseType>")

  Set tso = fso.CreateTextFile(datTIA, True)
  tso.WriteLine (Join(arr, vbCrLf))
  tso.Close

  Set fso = Nothing
  Set tso = Nothing
End Sub


'**********************************************************************************'
'** Transformace v|fffd|ech n|fffd|zv|fffd| tag|fffd| objektu XML na velk|fffd| p|fffd|smena
'**********************************************************************************'

Private Function XMLUCase(xmlTmp As Object) As Object
  Set XMLUCase = CreateObject("Msxml2.DOMDocument.3.0")
  XMLUCaseRec xmlTmp.documentElement, XMLUCase.appendChild(xmlTmp.createElement(UCase(xmlTmp.documentElement.tagName)))
End Function


'**********************************************************************************'
'** Rekurzivn|fffd| procedura pro funkci XMLUCase
'** proch|fffd|z|fffd| v|fffd|echny tagy a m|fffd|n|fffd| tagName na velk|fffd| p|fffd|smena (v|fffd|etn|fffd| n|fffd|zv|fffd| atribut|fffd|)
'**********************************************************************************'

Private Sub XMLUCaseRec(orinode As Object, newnode As Object)
  Dim f

  'NODE_ATTRIBUTE
  For f = 0 To orinode.Attributes.Length - 1
      If orinode.Attributes(f).Prefix <> "xmlns" Then
          newnode.setAttribute UCase(orinode.Attributes(f).nodeName), orinode.Attributes(f).nodeValue
      End If
  Next f

  For f = 0 To orinode.childNodes.Length - 1
      Select Case orinode.childNodes.Item(f).nodeType
          Case 1: 'NODE_ELEMENT
              XMLUCaseRec orinode.childNodes(f), newnode.appendChild(orinode.ownerDocument.createElement(UCase(orinode.childNodes(f).tagName)))
          Case 3: 'NODE_TEXT
              newnode.Text = orinode.childNodes(f).Text
      End Select
  Next f
End Sub


'**********************************************************************************'
'** Dek|fffd|dov|fffd|n|fffd| souboru z textu ulo|fffd|en|fffd|ho ve form|fffd|tu BASE64 (nap|fffd||fffd|klad z XML)
'**********************************************************************************'

Function DecodeBase64ToFile(strIn As String, fileOut As String) As String
    Dim objDocElem
    
    DecodeBase64ToFile = ""
    If strIn = "" Then Exit Function
    
    On Error GoTo err
    Set objDocElem = CreateObject("MSXml2.DOMDocument").createElement("Base64Data")
    With objDocElem
        .DataType = "bin.base64"
        .Text = strIn
    End With
    With CreateObject("ADODB.Stream")
        .Type = 1 'adTypeBinary
        .Open
        .Write objDocElem.nodeTypedValue
        .SaveToFile fileOut, 2 'adSaveCreateOverWrite
    End With
    DecodeBase64ToFile = fileOut
err:
End Function


'**********************************************************************************'
'** Dek|fffd|dov|fffd|n|fffd| souboru z textu ulo|fffd|en|fffd|ho ve form|fffd|tu BASE64 (nap|fffd||fffd|klad z XML)
'**********************************************************************************'

Function DecodeBase64ToString(strIn As String, Optional charSet As String = "UTF-8") As String
    Dim objDocElem
    
    DecodeBase64ToString = ""
    If strIn = "" Then Exit Function
    
    On Error GoTo err
    Set objDocElem = CreateObject("MSXml2.DOMDocument").createElement("Base64Data")
    With objDocElem
        .DataType = "bin.base64"
        .Text = strIn
    End With
    With CreateObject("ADODB.Stream")
        .Type = 1 'adTypeBinary
        .Open
        .Write objDocElem.nodeTypedValue
        .Position = 0
        .Type = 2 'adTypeText
        .charSet = charSet
        DecodeBase64ToString = .ReadText
    End With
err:
End Function


'**********************************************************************************'
'** Enk|fffd|dov|fffd|n|fffd| textu do textu ve form|fffd|tu BASE64
'**********************************************************************************'

Function EncodeStringToBase64(strIn As String, Optional charSet As String = "Windows-1250") As String
    Dim objDocElem
    Dim objStream
    
    EncodeStringToBase64 = ""
    If strIn = "" Then Exit Function
    
    On Error GoTo err
    Set objStream = CreateObject("ADODB.Stream")
    With objStream
        .Type = 2 'adTypeText
        .charSet = charSet
        .Open
        .WriteText strIn
        .Position = 0
        .Type = 1 'adTypeBinary
    End With
    
    Set objDocElem = CreateObject("MSXml2.DOMDocument").createElement("Base64Data")
    With objDocElem
        .DataType = "bin.base64"
        .nodeTypedValue = objStream.Read()
        EncodeStringToBase64 = .Text
    End With
err:
End Function


'**********************************************************************************'
'** Na|fffd|ten|fffd| hodnot z parametriza|fffd|n|fffd|ch soubor|fffd| xml
'**********************************************************************************'

Function XMLReadParam(ByVal sTags As String, Optional sDefault As String = "", Optional xmlParam As String) As String
  Dim fso As Object
  Dim pth As String
  Dim key
  
  Set fso = CreateObject("Scripting.FileSystemObject")
  If xmlParam <> "" And xmlParam = fso.GetFileName(xmlParam) Then
      xmlParam = ThisWorkbook.Path & "\" & xmlParam
  End If
  
  'N|fffd|zev souboru dle prom|fffd|nn|fffd| xmlParam
  pth = xmlParam
  
  'N|fffd|zev z vlastnosti se|fffd|itu nazvanou xmlParamFullName
  On Error Resume Next
  pth = pth & ";" & ThisWorkbook.CustomDocumentProperties("xmlParamFile")
  On Error GoTo 0
  
  'Stejn|fffd| n|fffd|vev souboru s koncovkou .xml ve stejn|fffd|m um|fffd|st|fffd|n|fffd|
  pth = pth & ";" & Mid(ThisWorkbook.FullName, 1, Len(ThisWorkbook.FullName) - InStr(1, StrReverse(ThisWorkbook.FullName), ".")) & ".xml"
  
  'N|fffd|zev Vypocet_plneni.xml ve stejn|fffd|m um|fffd|st|fffd|n|fffd|
  pth = pth & ";" & ThisWorkbook.Path & "\Vypocet_plneni.xml"
  
  'Stejn|fffd| n|fffd|vev souboru s koncovkou .xml ve slo|fffd|ce Param
  pth = pth & ";" & ThisWorkbook.Path & "\Param\" & Mid(ThisWorkbook.Name, 1, Len(ThisWorkbook.Name) - InStr(1, StrReverse(ThisWorkbook.Name), ".")) & ".xml"
  
  'N|fffd|zev Vypocet_plneni.xml ve slo|fffd|ce Param
  pth = pth & ";" & ThisWorkbook.Path & "\Param\Vypocet_plneni.xml"
   
  'N|fffd|zev Vypocet_plneni.xml ve slo|fffd|ce Data\Param
  pth = pth & ";" & ThisWorkbook.Path & "\Data\Param\Vypocet_plneni.xml"
   
  'Absolutn|fffd| cesta
  If fso.FileExists("\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Data\Param\VYPPL.xml") Then
      pth = pth & ";" & "\\sfs04\LowCost\LPUNZP\V|fffd|po|fffd|et_pln|fffd|n|fffd|\Data\Param\VYPPL.xml"
  End If
  
  For Each key In Split(pth, ";")
      If key <> "" Then
          XMLReadParam = XMLRead(sTags, "#NotExist", key)
          If XMLReadParam <> "#NotExist" Then
              If XMLRead("//@Crypt", , XMLRead(sTags & "/@", , key)) = "B64" Then
                  XMLReadParam = DecodeBase64ToString(XMLReadParam)
              End If
              XMLRelease key
              Exit Function
          End If
          XMLRelease key
      End If
  Next key
  
  XMLReadParam = sDefault
  
End Function

Attribute VB_Name = "zasi"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd|rok"
Sub Vloz_urok_do_VYP_POV()
    Application.ScreenUpdating = False
    Range("I8").Select
    Selection.Copy
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("I49").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("V|fffd|po|fffd|et |fffd|roku z prodlen|fffd| POV").Select
    Application.CutCopyMode = False
    Range("B13:I13").Select
    Sheets("V|fffd|po|fffd|et POV").Select
    Range("I50").Select
    Application.ScreenUpdating = True
End Sub
Sub Vypocitej_urok_POV()
    Sheets("V|fffd|po|fffd|et |fffd|roku z prodlen|fffd| POV").Select
    Range("I4").Select
End Sub

Attribute VB_Name = "|fffd|vodn|fffd|_list"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd|NB_sazby"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' y(^z

INQUEST-PP=macro
