Attribute VB_Name = "AdditionalFunction"
Public Function ConvertToSum(Val) As Double
    Dim RealVal
    
    If TypeName(Val) = "Range" Then
        RealVal = Val(1, 1).Value
    Else
        RealVal = Val
    End If
    
    If RealVal = "-" Then
        ConvertToSum = 0
    Else
        ConvertToSum = CDbl(RealVal)
    End If
End Function

Public Function ConvertSumToStr(Val, N) As String
    Dim SumStr
    If Val > 0 Then
        SumStr = Left(CStr(Val), N)
        ConvertSumToStr = SumStr + String(N - Len(SumStr), "-")
    Else
        ConvertSumToStr = String(N, "-")
    End If
End Function

Public Function ConvertPageNumToStr(Val) As String
    Dim sNumber
    sNumber = CStr(Val)
    Select Case Len(sNumber)
        Case Is < 3
            ConvertPageNumToStr = String(3 - Len(sNumber), "0") + sNumber
        Case Is = 3
            ConvertPageNumToStr = sNumber
        Case Is > 3
            ConvertPageNumToStr = "999"
    End Select
End Function

Public Sub FillRangeFromDS(Sheet, oDS, arrFields, N)
    Dim i
    For i = 0 To UBound(arrFields)
        Call SetValToRange(Sheet.Range("Field_" + arrFields(i)), String(N, "-"), pdRightDown)
    Next
    
    oDS.Run ("GetFirst")
    While oDS.Run("ValidPosition")
        For i = 0 To UBound(arrFields)
            If oDS.Fields("|fffd||fffd||fffd|").Value = arrFields(i) Then
                Call SetValToRange(Sheet.Range("Field_" + arrFields(i)), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, N), pdRightDown)
                Exit For
            End If
        Next
        oDS.Run ("GetNext")
    Wend
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetParams(oInputParams, sPath)
    VBProject.VBComponents.Import sPath + "ReportFunctions.bas"
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim oStructDS As Object
    Set oStructDS = oInputParams.GetValue("StructObject")
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim oDS As Object
    Set oDS = oInputParams.GetValue("Object")
    
    '---------------------------------------------
    '---------------------------------------------
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|'", True
    FillSheet Sheets("|fffd||fffd||fffd|.1_|fffd||fffd||fffd||fffd|01"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| 03'", True
    FillSheet Sheets("|fffd||fffd||fffd|.14_|fffd||fffd||fffd||fffd|03"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| 03'", True
    FillSheet Sheets("|fffd||fffd||fffd|.15_|fffd|.03"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| 03'", True
    FillSheet Sheets("|fffd||fffd||fffd|.16_|fffd|.03"), oInputParams, oStructDS, oDS
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 04'", True
    FillSheet Sheets("|fffd||fffd||fffd|.17_|fffd||fffd||fffd||fffd|04"), oInputParams, oStructDS, oDS
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 05'", True
    FillSheet Sheets("|fffd||fffd||fffd|.18_|fffd||fffd||fffd||fffd|05"), oInputParams, oStructDS, oDS
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 06 (1)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.19_|fffd||fffd||fffd||fffd|06"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 06 (2)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.20_|fffd|.06"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 06 (3)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.21_|fffd|.06"), oInputParams, oStructDS, oDS
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 07'", True
    FillSheet Sheets("|fffd||fffd||fffd|.22_|fffd||fffd||fffd||fffd|07"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=1' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=2' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=3' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=4'", True
    FillSheet Sheets("|fffd||fffd||fffd|.13_|fffd||fffd||fffd||fffd|.5_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|2 (2)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.9_|fffd||fffd|.2_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|3 (1)'", True

    FillSheet Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|3 (2)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.11_|fffd||fffd|.3_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|2 (1)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|1'", True
    FillSheet Sheets("|fffd||fffd||fffd|.7_|fffd||fffd||fffd||fffd|.1_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=1' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=2' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=3' |fffd||fffd||fffd| " + _
                               """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=4'", True
    FillSheet Sheets("|fffd||fffd||fffd|.4_|fffd||fffd||fffd||fffd|.1_1.3"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|4'", True
    FillSheet Sheets("|fffd||fffd||fffd|.12_|fffd||fffd||fffd||fffd|.4_|fffd|.02"), oInputParams, oStructDS, oDS

    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 02 (1)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd| 02 (2)'", True
    FillSheet Sheets("|fffd||fffd||fffd|.6_|fffd|.02"), oInputParams, oStructDS, oDS
    
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.1'", True
    FillSheet Sheets("|fffd||fffd||fffd|.2_|fffd||fffd||fffd||fffd|.1_1.1"), oInputParams, oStructDS, oDS
    oStructDS.Run "SetFilter", """|fffd||fffd||fffd|"" = '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.2'", True
    FillSheet Sheets("|fffd||fffd||fffd|.3_|fffd||fffd||fffd||fffd|.1_1.2"), oInputParams, oStructDS, oDS
    '---------------------------------------------
    '---------------------------------------------
    
    Sheets("|fffd||fffd||fffd|.1_|fffd||fffd||fffd||fffd|01").Activate
End Sub

Private Sub FillSheet(Sheet, oInputParams, oStructDS, oDS)
    Dim iPageNum As Integer
    
    Sheet.Visible = xlSheetVisible
    
    If oStructDS.Run("GetFirst") Then
        iPageNum = 2
        For i = 2 To oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value
' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!!
'If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = 3 Then
'    MsgBox "Cur=" + CStr(Sheet.Index) + ":After=" + CStr(Sheets(Sheet.Index + i - 2).Index)
'    MsgBox Sheets(Sheet.Index + i - 2).Name + ":" + Sheets(Sheet.Index + i - 3).Name
'End If
            Sheet.Copy After:=Sheets(Sheet.Index + i - 2)
'If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = 3 Then
'    MsgBox "Cur=" + CStr(Sheet.Index) + ":After=" + CStr(Sheets(Sheet.Index + i - 2).Index) + ":New=" + CStr(Sheets(Sheet.Index + i - 1).Index)
'    MsgBox Sheets(Sheet.Index + i - 2).Name + ":" + Sheets(Sheet.Index + i - 1).Name + ":" + Sheet.Name + " - " + CStr(iPageNum)
'End If
            Sheets(Sheet.Index + i - 1).Name = Sheet.Name + " - " + CStr(iPageNum)
'            Call SetValToRange(Sheets(Sheet.Index + i - 1).Range("Field_Page"), "00" + CStr(iPageNum), pdRightDown)
            Call SetValToRange(Sheets(Sheet.Index + i - 1).Range("Field_Page"), ConvertPageNumToStr(Sheets(Sheet.Index + i - 1).Index), pdRightDown)
            oDS.Run "SetFilter", """StructID"" = " + CStr(oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) + " AND ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" = " + CStr(i), True
            Sheets(Sheet.Index + i - 1).SetNames oInputParams, oDS, oStructDS
            
            If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|").Value = 0 Then
                Sheets(Sheet.Index + i - 1).Visible = xlSheetHidden
            End If
            
            iPageNum = iPageNum + 1
        Next i
        oDS.Run "SetFilter", """StructID"" = " + CStr(oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) + " AND ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" = 1", True
'        Call SetValToRange(Sheet.Range("Field_Page"), "001", pdRightDown)
        Call SetValToRange(Sheet.Range("Field_Page"), ConvertPageNumToStr(Sheet.Index), pdRightDown)
        Sheet.SetNames oInputParams, oDS, oStructDS
        If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|").Value = 0 Then
            Sheet.Visible = xlSheetHidden
        End If
    
        While oStructDS.Run("GetNext")
            Sheet.Copy , Sheets(Sheet.Index + iPageNum - 2)
            Sheets(Sheet.Index + iPageNum - 1).Name = Sheet.Name + " - " + CStr(iPageNum)
            oDS.Run "SetFilter", """StructID"" = " + CStr(oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) + " AND ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" = 1", True
'            Call SetValToRange(Sheets(Sheet.Index + iPageNum - 1).Range("Field_Page"), "00" + CStr(iPageNum), pdRightDown)
            Call SetValToRange(Sheets(Sheet.Index + iPageNum - 1).Range("Field_Page"), ConvertPageNumToStr(Sheets(Sheet.Index + iPageNum - 1).Index), pdRightDown)
            Sheets(Sheet.Index + iPageNum - 1).SetNames oInputParams, oDS, oStructDS
            If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|").Value = 0 Then
                Sheets(Sheet.Index + iPageNum - 1).Visible = xlSheetHidden
            End If
        
            iPageNum = iPageNum + 1
            
            For i = 2 To oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value
                Sheet.Copy , Sheets(Sheet.Index + iPageNum - 2)
                Sheets(Sheet.Index + iPageNum - 1).Name = Sheet.Name + " - " + CStr(iPageNum)
'                Call SetValToRange(Sheets(Sheet.Index + iPageNum - 1).Range("Field_Page"), "00" + CStr(iPageNum), pdRightDown)
                Call SetValToRange(Sheets(Sheet.Index + iPageNum - 1).Range("Field_Page"), ConvertPageNumToStr(Sheets(Sheet.Index + iPageNum - 1).Index), pdRightDown)
                oDS.Run "SetFilter", """StructID"" = " + CStr(oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) + " AND ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" = " + CStr(i), True
                Sheets(Sheet.Index + iPageNum - 1).SetNames oInputParams, oDS, oStructDS
                
                If oStructDS.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|").Value = 0 Then
                    Sheets(Sheet.Index + iPageNum - 1).Visible = xlSheetHidden
                End If
            
                iPageNum = iPageNum + 1
            Next i
    
        Wend
    Else
        oDS.Run "SetFilter", """|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" = -1", True
'        Call SetValToRange(Sheet.Range("Field_Page"), "001", pdRightDown)
        Call SetValToRange(Sheet.Range("Field_Page"), ConvertPageNumToStr(Sheet.Index), pdRightDown)
        Sheet.SetNames oInputParams, oDS, oStructDS
    End If
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oDSStruct)
    Dim Name
    For i = 1 To 3
        Name = "Field_P" + CStr(i)
'        Call SetValToRange(Range(Name), "   ", pdRightDown)
        Call SetName(Range(Name), oInputParams, Name, pdRightDown)
    Next i
    
    For i = 10 To 15
        Name = "Field_P" + CStr(i)
'        Call SetValToRange(Range(Name), "   ", pdRightDown)
        Call SetName(Range(Name), oInputParams, Name, pdRightDown)
    Next i
    
    Call SetName(Range("Field_P5"), oInputParams, "Field_P5", pdRightDown)
    Call SetName(Range("Field_P7"), oInputParams, "Field_P7", pdRightDown)
    Call SetName(Range("Field_P8"), oInputParams, "Field_P8", pdRightDown)
    Call SetName(Range("Field_P3_1"), oInputParams, "Field_P3_1", pdRightDown)
    Call SetName(Range("Field_P7_1"), oInputParams, "Field_P7_1", pdRightDown)
    Call SetName(Range("Field_P12_1"), oInputParams, "Field_P12_1", pdRightDown)
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("010", "020", "030", "040", "050", "060", _
        "070", "080", "100", "110", "120", "130", "140", "170")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
    Call SetValToRange(Range("Field_090"), ConvertSumToStr(ConvertToSum(Field_080) - ConvertToSum(Field_070), 15), pdRightDown)
    Call SetValToRange(Range("Field_150"), ConvertSumToStr(ConvertToSum(Field_120) - ConvertToSum(Field_100) - ConvertToSum(Field_140), 15), pdRightDown)
    Call SetValToRange(Range("Field_160"), ConvertSumToStr(ConvertToSum(Field_130) - ConvertToSum(Field_110) - ConvertToSum(Field_140), 15), pdRightDown)
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("180", "190", "210", "220", "240", "250")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
    Call SetValToRange(Range("Field_200"), ConvertSumToStr(ConvertToSum(Field_190) - ConvertToSum(Field_180), 15), pdRightDown)
    Call SetValToRange(Range("Field_230"), ConvertSumToStr(ConvertToSum(Field_220) - ConvertToSum(Field_210), 15), pdRightDown)
    Call SetValToRange(Range("Field_260"), ConvertSumToStr(ConvertToSum(Field_250) - ConvertToSum(Field_240), 15), pdRightDown)
    Call SetValToRange(Range("Field_340"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_030")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_070")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_100")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_110")) + _
        ConvertToSum(Field_180) + ConvertToSum(Field_210) + ConvertToSum(Field_240), 15), pdRightDown)
    Call SetValToRange(Range("Field_350"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_040")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_080")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_120")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_130")) + _
        ConvertToSum(Field_210) + ConvertToSum(Field_240), 15), pdRightDown)
    Call SetValToRange(Range("Field_360"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_060")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_090")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_150")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.10_|fffd||fffd||fffd||fffd|.3_|fffd|.02").Range("Field_160")) + _
        ConvertToSum(Field_200) + ConvertToSum(Field_230) + ConvertToSum(Field_260), 15), pdRightDown)
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("020", "040", "050", "060", "070", _
        "080", "090", "100", "110", "120", "130", "150")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    ' P107
    Call SetValToRange(Range("Field_010"), ConvertSumToStr(ConvertToSum(Field_020) + ConvertToSum(Field_030), 15), pdRightDown)
    ' P108
    Call SetValToRange(Range("Field_030"), ConvertSumToStr(ConvertToSum(Field_040) + ConvertToSum(Field_050) _
                                 + ConvertToSum(Field_060) + ConvertToSum(Field_070) _
                                 + ConvertToSum(Field_080) + ConvertToSum(Field_090) _
                                 + ConvertToSum(Field_100) + ConvertToSum(Field_110) _
                                 + ConvertToSum(Field_120) + ConvertToSum(Field_130), 15), pdRightDown)
    ' P109
    Call SetValToRange(Range("Field_140"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_100")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.18_|fffd||fffd||fffd||fffd|05").Range("Field_100")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.21_|fffd|.06").Range("Field_530")), 15), pdRightDown)
    ' P110
    Call SetValToRange(Range("Field_160"), ConvertSumToStr(ConvertToSum(Field_010) - ConvertToSum(Field_150) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_060")) - _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.18_|fffd||fffd||fffd||fffd|05").Range("Field_100")) - _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.21_|fffd|.06").Range("Field_530")), 15), pdRightDown)
    ' P111
    Call SetValToRange(Range("Field_170"), ConvertSumToStr(ConvertToSum(Field_020) - _
        ConvertToSum(Field_150), 15), pdRightDown)
    ' P112
    Call SetValToRange(Range("Field_180"), ConvertSumToStr(ConvertToSum(Field_030) - _
        (ConvertToSum(Field_150) - ConvertToSum(Field_020)), 15), pdRightDown)

End Sub





Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    If oStructDS.Run("ValidPosition") Then
        If oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=1" Then
            Range("Field_002").Value = "1"
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=2" Then
            Range("Field_002").Value = "2"
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=3" Then
            Range("Field_002").Value = "3"
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5 |fffd|=4" Then
            Range("Field_002").Value = "4"
        End If
    End If

    Dim arrFields
    arrFields = Array("030", "031", "050", "090", "120", "121")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("040")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 11

    arrFields = Array("060")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 4

    Call SetValToRange(Range("Field_070"), ConvertSumToStr(ConvertToSum(Field_050) * ConvertToSum(Field_060) / 100, 15), pdRightDown)
    Call SetValToRange(Range("Field_100"), ConvertSumToStr(ConvertToSum(Field_070) - ConvertToSum(Field_080) - ConvertToSum(Field_090), 15), pdRightDown)
    Call SetValToRange(Range("Field_110"), ConvertSumToStr(-ConvertToSum(Field_070) + ConvertToSum(Field_080) + ConvertToSum(Field_090), 15), pdRightDown)
    
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("010", "020", "030", "040", "050", "060", _
        "070", "090", "100", "110", "120", "071", "072", "101")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("080", "081")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 18

    arrFields = Array("130")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 2
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("140", "150", "160", "010", "030", "040", "050")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("020")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 2
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("060", "070")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("010", "020", "050", "060", "070")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("030")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 2

    Call SetValToRange(Range("Field_040"), ConvertSumToStr((ConvertToSum(Field_010) - ConvertToSum(Field_020)) * ConvertToSum(Field_030) / 100, 15), pdRightDown)
    Call SetValToRange(Range("Field_080"), ConvertSumToStr(ConvertToSum(Field_040) - ConvertToSum(Field_050) - ConvertToSum(Field_060) - ConvertToSum(Field_070), 15), pdRightDown)
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("010", "020", "030", "050", "070", "080")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
    Call SetValToRange(Range("Field_040"), ConvertSumToStr(ConvertToSum(Field_010) + ConvertToSum(Field_020) - ConvertToSum(Field_030), 15), pdRightDown)
    Call SetValToRange(Range("Field_060"), ConvertSumToStr(ConvertToSum(Field_040) - ConvertToSum(Field_050), 15), pdRightDown)
    Call SetValToRange(Range("Field_090"), ConvertSumToStr(ConvertToSum(Field_070) - ConvertToSum(Field_080), 15), pdRightDown)
    Call SetValToRange(Range("Field_100"), ConvertSumToStr(ConvertToSum(Field_060) - ConvertToSum(Field_080), 15), pdRightDown)
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("020", "030", "040", "050", "060", "070", "080", "090", _
        "100", "110", "120", "130", "140", "150", "160", "170", "180")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
    Call SetValToRange(Range("Field_010"), ConvertSumToStr(ConvertToSum(Field_020) + _
        ConvertToSum(Field_030) + ConvertToSum(Field_040) + ConvertToSum(Field_050) + _
        ConvertToSum(Field_060) + ConvertToSum(Field_070) + ConvertToSum(Field_080) + _
        ConvertToSum(Field_090) + ConvertToSum(Field_100) + ConvertToSum(Field_110), 15), pdRightDown)
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oDSStruct)
    i = 16
    Call SetValToRange(Range("Field_P" + CStr(i)), "   ", pdRightDown)
    
    'P19
'    Call SetValToRange(Range("Field_040"), "   ", pdRightDown)
    'P20
'    Call SetValToRange(Range("Field_050"), "   ", pdRightDown)
    'P23
'    Call SetValToRange(Range("Field_070"), "   ", pdRightDown)
    'P24
'    Call SetValToRange(Range("Field_080"), "   ", pdRightDown)
    
'    Call SetName(Range("Field_P16"), oInputParams, "Field_P16", pdRightDown)
    
    ' P19
    Call SetValToRange( _
            Range("Field_040"), _
            ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_190")) - _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_220")) - _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_250")), 15), _
            pdRightDown)
    ' P20
    Call SetValToRange( _
            Range("Field_050"), _
            ConvertSumToStr(-ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_190")) + _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_220")) + _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_250")), 15), _
            pdRightDown)
    
    ' P23
    Call SetValToRange( _
            Range("Field_070"), _
            ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_200")) - _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_230")) - _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_260")), 15), _
            pdRightDown)
    ' P24
    Call SetValToRange( _
            Range("Field_080"), _
            ConvertSumToStr(-ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_200")) + _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_230")) + _
                ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_260")), 15), _
            pdRightDown)
            
    Call SetName(Range("Field_P16_1"), oInputParams, "Field_P16_1", pdRightDown)

    
End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("200", "210", "220", "250", "260", "270", "280", _
        "290", "300", "310", "320", "330", "340", "350", "360", "370")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("230")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 7

    Call SetValToRange(Range("Field_240"), ConvertSumToStr(ConvertToSum(Field_250) + _
        ConvertToSum(Field_260) + ConvertToSum(Field_270) + ConvertToSum(Field_280) + _
        ConvertToSum(Field_290) + ConvertToSum(Field_300) + ConvertToSum(Field_310) + _
        ConvertToSum(Field_320), 15), pdRightDown)
    Call SetValToRange(Range("Field_190"), ConvertSumToStr(ConvertToSum(Field_200) + _
        ConvertToSum(Field_210) + ConvertToSum(Field_220), 15), pdRightDown)
End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("380", "390", "400", "420", "430", "460", "470", "500", "510")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
    Call SetValToRange(Range("Field_410"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.20_|fffd|.06").Range("Field_330")) - _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.20_|fffd|.06").Range("Field_340")), 15), pdRightDown)
    Call SetValToRange(Range("Field_440"), ConvertSumToStr(ConvertToSum(Field_420) - ConvertToSum(Field_430), 15), pdRightDown)
    Call SetValToRange(Range("Field_450"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.20_|fffd|.06").Range("Field_350")) - _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.20_|fffd|.06").Range("Field_360")), 15), pdRightDown)
    Call SetValToRange(Range("Field_480"), ConvertSumToStr(ConvertToSum(Field_460) - ConvertToSum(Field_470), 15), pdRightDown)
    Call SetValToRange(Range("Field_490"), ConvertSumToStr(ConvertToSum(Field_390) - ConvertToSum(Field_400), 15), pdRightDown)
    Call SetValToRange(Range("Field_520"), ConvertSumToStr(ConvertToSum(Field_500) - ConvertToSum(Field_510), 15), pdRightDown)
    Call SetValToRange(Range("Field_530"), ConvertSumToStr(ConvertToSum(Field_410) - _
        ConvertToSum(Field_430) + ConvertToSum(Field_450) - ConvertToSum(Field_470) + _
        ConvertToSum(Field_490) - ConvertToSum(Field_510), 15), pdRightDown)
End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
' |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd| |fffd| |fffd||fffd||fffd||fffd|)
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oDSStruct)
    For i = 12 To 14
'        Call SetValToRange(Range("Field_" + CStr(i * 10)), "   ", pdRightDown)
        Call SetValToRange( _
                Range("Field_" + CStr(i * 10)), _
                ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_300")) / 3, 15), _
                pdRightDown)
    Next i
    For i = 22 To 24
'        Call SetValToRange(Range("Field_" + CStr(i * 10)), "   ", pdRightDown)
        Call SetValToRange( _
                Range("Field_" + CStr(i * 10)), _
                ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.6_|fffd|.02").Range("Field_310")) / 3, 15), _
                pdRightDown)
    Next i
    
End Sub





Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
'    For i = 47 To 56
'        Call SetValToRange(Range("Field_P" + CStr(i)), "   ", pdRightDown)
'    Next i
    If oStructDS.Run("ValidPosition") Then
        If oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=1" Then
            Call SetValToRange(Range("Field_P44"), "1", pdRightDown)
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=2" Then
            Call SetValToRange(Range("Field_P44"), "2", pdRightDown)
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=3" Then
            Call SetValToRange(Range("Field_P44"), "3", pdRightDown)
        ElseIf oStructDS.Fields("|fffd||fffd||fffd|").String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.3 |fffd||fffd|=4" Then
            Call SetValToRange(Range("Field_P44"), "4", pdRightDown)
        End If
    End If

    If oDS.Run("GetFirst") Then
        While oDS.Run("ValidPosition")
            If oDS.Fields("|fffd||fffd||fffd|").Value = "040" Then
                Call SetValToRange(Range("Field_P47"), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, 15), pdRightDown)
            ElseIf oDS.Fields("|fffd||fffd||fffd|").Value = "060" Then
                Call SetValToRange(Range("Field_P49"), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, 15), pdRightDown)
            ElseIf oDS.Fields("|fffd||fffd||fffd|").Value = "080" Then
                Call SetValToRange(Range("Field_P51"), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, 15), pdRightDown)
            ElseIf oDS.Fields("|fffd||fffd||fffd|").Value = "100" Then
                Call SetValToRange(Range("Field_P53"), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, 15), pdRightDown)
            ElseIf oDS.Fields("|fffd||fffd||fffd|").Value = "120" Then
                Call SetValToRange(Range("Field_P55"), ConvertSumToStr(oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, 15), pdRightDown)
            End If

            oDS.Run ("GetNext")
        Wend
    Else
        Call SetValToRange(Range("Field_P47"), String(15, "-"), pdRightDown)
        Call SetValToRange(Range("Field_P49"), String(15, "-"), pdRightDown)
        Call SetValToRange(Range("Field_P51"), String(15, "-"), pdRightDown)
        Call SetValToRange(Range("Field_P53"), String(15, "-"), pdRightDown)
        Call SetValToRange(Range("Field_P55"), String(15, "-"), pdRightDown)
    End If

End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
'    For i = 1 To 9
'        Call SetValToRange(Range("Field_0" + CStr(i) + "0"), "", pdRightDown)
'    Next i
'    For i = 10 To 20
'        Call SetValToRange(Range("Field_" + CStr(i) + "0"), "", pdRightDown)
'    Next i

    Dim arrFields
    arrFields = Array("070", "080", "090", "130")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    arrFields = Array("140", "150", "160", "170")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 4

    ' P58
    Call SetValToRange(Range("Field_010"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.7_|fffd||fffd||fffd||fffd|.1_|fffd|.02").Range("Field_040")), 15), pdRightDown)
    ' P59
    Call SetValToRange(Range("Field_020"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.7_|fffd||fffd||fffd||fffd|.1_|fffd|.02").Range("Field_100")), 15), pdRightDown)
    ' P60
    Call SetValToRange(Range("Field_030"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.9_|fffd||fffd|.2_|fffd|.02").Range("Field_130")), 15), pdRightDown)
    ' P61
    Call SetValToRange(Range("Field_040"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.9_|fffd||fffd|.2_|fffd|.02").Range("Field_200")) + ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.9_|fffd||fffd|.2_|fffd|.02").Range("Field_300")), 15), pdRightDown)
    ' P62
    Call SetValToRange(Range("Field_050"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.11_|fffd||fffd|.3_|fffd|.02").Range("Field_360")), 15), pdRightDown)
    ' P63
    Call SetValToRange(Range("Field_060"), ConvertSumToStr(ConvertToSum(Field_010) + ConvertToSum(Field_020) - _
        ConvertToSum(Field_030) - ConvertToSum(Field_040) + ConvertToSum(Field_050), 15), pdRightDown)
    ' P67
    Call SetValToRange(Range("Field_100"), ConvertSumToStr(ConvertToSum(Field_060) - ConvertToSum(Field_070) - _
        ConvertToSum(Field_080) - ConvertToSum(Field_090), 15), pdRightDown)
    ' P68
    Call SetValToRange(Range("Field_110"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.12_|fffd||fffd||fffd||fffd|.4_|fffd|.02").Range("Field_150")), 15), pdRightDown)
    ' P69
    Call SetValToRange(Range("Field_120"), ConvertSumToStr(ConvertToSum(Field_100) - ConvertToSum(Field_110) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.18_|fffd||fffd||fffd||fffd|05").Range("Field_100")) + ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.21_|fffd|.06").Range("Field_530")), 15), pdRightDown)
    ' P75
    Call SetValToRange(Range("Field_180"), ConvertSumToStr(ConvertToSum(Field_190) + ConvertToSum(Field_200), 15), pdRightDown)
    ' P76
    Call SetValToRange(Range("Field_190"), ConvertSumToStr(ConvertToSum(Field_120) * ConvertToSum(Field_150) / 100, 15), pdRightDown)
    ' P77
    Call SetValToRange(Range("Field_200"), ConvertSumToStr((ConvertToSum(Field_120) - ConvertToSum(Field_130)) * ConvertToSum(Field_160) / 100 + _
        ConvertToSum(Field_130) * ConvertToSum(Field_170) / 100, 15), pdRightDown)
    
    Call SetName(Range("Field_PriznakNP"), oInputParams, "Field_PriznakNP", pdRightDown)
    
    
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
'    For i = 21 To 31
'        Call SetValToRange(Range("Field_" + CStr(i) + "0"), "", pdRightDown)
'    Next i

    oDS.Run ("GetFirst")
    
    Call SetValToRange(Range("Field_210"), ConvertSumToStr(ConvertToSum(Field_220) + ConvertToSum(Field_230), 15), pdRightDown)
    ' P81
    Call SetValToRange(Range("Field_240"), ConvertSumToStr(ConvertToSum(Field_250) + ConvertToSum(Field_260), 15), pdRightDown)

    ' P84
    Call SetValToRange(Range("Field_270"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_180")) - _
        ConvertToSum(Field_210) - ConvertToSum(Field_240), 15), pdRightDown)
    ' P85
    Call SetValToRange(Range("Field_280"), ConvertSumToStr(ConvertToSum(Field_210) + _
        ConvertToSum(Field_240) - ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.5_|fffd||fffd||fffd||fffd|02").Range("Field_180")), 15), pdRightDown)
    ' P86
    Call SetValToRange(Range("Field_290"), ConvertSumToStr(ConvertToSum(Field_300) + ConvertToSum(Field_310), 15), pdRightDown)
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    ' P87
'    Range("Field_040").Formula = _
'        "=ConvertSumToStr(ConvertToSum('|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.2'!Field_120)+" + _
'        "ConvertToSum('|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.2'!Field_130)+ConvertToSum('|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.2'!Field_140))"
End Sub




Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim bNext: bNext = oDS.Run("GetFirst")
    Do While bNext = True
       Call SetValToRange(Range("Field_" + oDS.Fields("|fffd||fffd||fffd|").Value), oDS.Fields("|fffd||fffd||fffd||fffd||fffd|").Value, pdRightDown)
       bNext = oDS.Run("GetNext")
    Loop
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("010", "020", "030", "040", "041", "042", "043", "044", _
        "045", "046", "047", "048", "049", "050", "051", "055", "060", "070")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15

    ' P96
    Call SetValToRange(Range("Field_080"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.11_|fffd||fffd|.3_|fffd|.02").Range("Field_350")), 15), pdRightDown)

End Sub

 

 
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub SetNames(oInputParams, oDS, oStructDS)
    Dim arrFields
    arrFields = Array("200", "201", "202", "203", "300", "301", "302", "090", "100")
    FillRangeFromDS Parent.Sheets(Index), oDS, arrFields, 15
    
       ' P97
    Call SetValToRange(Range("Field_130"), ConvertSumToStr(ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_010")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_020")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_030")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_040")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_050")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_060")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_070")) + _
        ConvertToSum(Parent.Sheets("|fffd||fffd||fffd|.8_|fffd||fffd||fffd||fffd|.2_|fffd|.02").Range("Field_080")) + _
        ConvertToSum(Field_090) + ConvertToSum(Field_100), 15), pdRightDown)

End Sub





INQUEST-PP=macro
