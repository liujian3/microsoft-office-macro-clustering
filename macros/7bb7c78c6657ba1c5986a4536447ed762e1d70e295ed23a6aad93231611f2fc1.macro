Attribute VB_Name = "FormDCuentas"
Attribute VB_Base = "0{9E75F590-0392-46E6-B6F9-F792F2B38742}{F25C3994-7F20-4936-96AD-60DAE439111F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()
txtCodigo.Text = ""
cboCuentas.Text = ""
txtDebe.Text = ""
txtHaber.Text = ""
cboMovimiento.Text = ""

txtCodigo.Enabled = False
cboCuentas.Enabled = False
txtDebe.Enabled = False
txtHaber.Enabled = False
cboMovimiento.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

'---Borra datos
Hoja12.Range("b14").Select
'Hacemos un bucle Do While el cual se ejecutar|fffd| hasta que haya una celda vac|fffd|a
Do While ActiveCell.Value <> ""
    'La condici|fffd|n es que si el largo es diferente a 10...
    If ActiveCell.Value = txtCodigo.Text Then
        '... elimina la fila
        ActiveCell.EntireRow.Delete
        ActiveCell.Offset(-1, 0).Select
    Else
    End If
    'Recorre una fila hacia abajo
    ActiveCell.Offset(1, 0).Select
Loop
'---------------------

txtCodigo.Text = ""
cboCuentas.Text = ""
txtDebe.Text = ""
txtHaber.Text = ""
cboMovimiento.Text = ""

cboCuentas.Enabled = False
txtDebe.Enabled = False
txtHaber.Enabled = False
cboMovimiento.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If cboCuentas.Text = "" Then
         MsgBox "Ingrese la Cuenta"
         cboCuentas.SetFocus
         Exit Sub
End If

    Hoja12.Activate
    'Sheets("TBCOS").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("b:b")) + 13
    
    'Cells(nextrow, 1) = "A"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = cboCuentas.Text
    Cells(nextrow, 4) = etiqNombreCuenta.Caption
    
    If txtDebe.Text = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(txtDebe.Text, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If txtHaber.Text = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(txtHaber.Text, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
       
'--------------------------------------
    If etiqCtaAdebe.Caption > "" Then
    Hoja12.Activate
    nextrow = _
        Application.WorksheetFunction.CountA(Range("b:b")) + 3
    'Cells(nextrow, 1) = "B"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = etiqCtaAdebe.Caption
    Cells(nextrow, 4) = "=IF(ISERROR(VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],1,0))=FALSE,VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],2,0),0)"
    Cells(nextrow, 4).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    If etiqVal1Debe.Caption = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(etiqVal1Debe.Caption, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If etiqVal1Haber.Caption = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(etiqVal1Haber.Caption, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
           
    End If
'------------------------------
    If etiqCtaAhaber.Caption > "" Then
    Hoja12.Activate
    nextrow = _
        Application.WorksheetFunction.CountA(Range("b:b")) + 3
    'Cells(nextrow, 1) = "B"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = etiqCtaAhaber.Caption
    Cells(nextrow, 4) = "=IF(ISERROR(VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],1,0))=FALSE,VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],2,0),0)"
    Cells(nextrow, 4).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    If etiqVal2Debe.Caption = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(etiqVal2Debe.Caption, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If etiqVal2Haber.Caption = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(etiqVal2Haber.Caption, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
          
    End If
     
'-----------------------------
txtCodigo.Enabled = False
cboCuentas.Enabled = False
txtDebe.Enabled = False
txtHaber.Enabled = False
cboMovimiento.Enabled = False
btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("b14:l500").Select
    ActiveWorkbook.Worksheets("VOUDIARIO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("VOUDIARIO").Sort.SortFields.Add Key:=Range("b14"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("VOUDIARIO").Sort
        .SetRange Range("b14:l500")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
Dim d As Byte, totd As Double
For d = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
totd = totd + Val(lisTabla.List(d, 6))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next d
etiqSumaDebe.Caption = Format(totd, "###,##0.00")

Dim h As Byte, toth As Double
For h = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
toth = toth + Val(lisTabla.List(h, 7))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next h
etiqSumaHaber.Caption = Format(toth, "###,##0.00")
    
'Hoja12.Range ("c2")

Application.ScreenUpdating = True
    
End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

'---Borra datos
Hoja12.Range("b14").Select
'Hacemos un bucle Do While el cual se ejecutar|fffd| hasta que haya una celda vac|fffd|a
Do While ActiveCell.Value <> ""
    'La condici|fffd|n es que el c|fffd|digo es igual
    If ActiveCell.Value = txtCodigo.Text Then
        '... elimina la fila
        ActiveCell.EntireRow.Delete
        ActiveCell.Offset(-1, 0).Select
    Else
    End If
    'Recorre una fila hacia abajo
    ActiveCell.Offset(1, 0).Select
Loop

'--------Guardar datos modificados
Hoja12.Activate
    'Sheets("TBCOS").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("b:b")) + 13
    
    'Cells(nextrow, 1) = "A"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = cboCuentas.Text
    Cells(nextrow, 4) = etiqNombreCuenta.Caption
    
    If txtDebe.Text = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(txtDebe.Text, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If txtHaber.Text = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(txtHaber.Text, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
      
'--------------------------------------
    If etiqCtaAdebe.Caption > "" Then
    Hoja12.Activate
    nextrow = _
        Application.WorksheetFunction.CountA(Range("b:b")) + 3
    'Cells(nextrow, 1) = "B"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = etiqCtaAdebe.Caption
    Cells(nextrow, 4) = "=IF(ISERROR(VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],1,0))=FALSE,VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],2,0),0)"
    Cells(nextrow, 4).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    If etiqVal1Debe.Caption = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(etiqVal1Debe.Caption, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If etiqVal1Haber.Caption = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(etiqVal1Haber.Caption, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
           
    End If
'------------------------------
    If etiqCtaAhaber.Caption > "" Then
    Hoja12.Activate
    nextrow = _
        Application.WorksheetFunction.CountA(Range("b:b")) + 3
    'Cells(nextrow, 1) = "B"
    Cells(nextrow, 2) = txtCodigo.Text
    Cells(nextrow, 3) = etiqCtaAhaber.Caption
    Cells(nextrow, 4) = "=IF(ISERROR(VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],1,0))=FALSE,VLOOKUP(RC[-1],TPC!R[-12]C[-2]:R[2486]C[-1],2,0),0)"
    Cells(nextrow, 4).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    If etiqVal2Debe.Caption = "" Then
    Cells(nextrow, 8) = 0
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 8) = Format(etiqVal2Debe.Caption, "###,##0.00")
    Cells(nextrow, 8).Select
    Selection.Style = "Comma"
    End If
    
    If etiqVal2Haber.Caption = "" Then
    Cells(nextrow, 9) = 0
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    Else
    Cells(nextrow, 9) = Format(etiqVal2Haber.Caption, "###,##0.00")
    Cells(nextrow, 9).Select
    Selection.Style = "Comma"
    End If
    
    Cells(nextrow, 10) = etiqNumRegistro.Caption
    Cells(nextrow, 11) = etiqMes.Caption
    Cells(nextrow, 12) = etiqMovimiento.Caption
          
    End If
    
'---------------------------------------

Range("b14:l500").Select
    ActiveWorkbook.Worksheets("VOUDIARIO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("VOUDIARIO").Sort.SortFields.Add Key:=Range("b14"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("VOUDIARIO").Sort
        .SetRange Range("b14:l500")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'--------------------------------------
Dim d As Byte, totd As Double
For d = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
totd = totd + Val(lisTabla.List(d, 6))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next d
etiqSumaDebe.Caption = Format(totd, "###,##0.00")

Dim h As Byte, toth As Double
For h = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
toth = toth + Val(lisTabla.List(h, 7))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next h
etiqSumaHaber.Caption = Format(toth, "###,##0.00")

'--------------------------------------
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

Hoja12.Range("A1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
cboCuentas.Text = ""
txtDebe.Text = ""
txtHaber.Text = ""
cboMovimiento.Text = ""

txtCodigo.Enabled = True
cboCuentas.Enabled = True
txtDebe.Enabled = True
txtHaber.Enabled = True
cboMovimiento.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub btoNuevo_Click()

'------------Numeraci|fffd|n del Recibo
Range("b13").End(xlDown).Select

If ActiveCell.Text = "" Then
txtCodigo.Text = 1
Else
txtCodigo.Text = ActiveCell.Text + 1
End If


cboCuentas.Enabled = True
txtDebe.Enabled = True
txtHaber.Enabled = True
cboMovimiento.Enabled = True

cboCuentas.Text = ""
txtDebe.Text = ""
txtHaber.Text = ""
cboMovimiento.Text = ""

cboCuentas.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
End Sub

Private Sub btoSalir_Click()
Unload Me

Hoja12.Range("A2").Select

End Sub

Private Sub cboCuentas_AfterUpdate()

etiqNombreCuenta.Caption = cboCuentas.Column(1)
etiqCtaAdebe.Caption = cboCuentas.Column(2)
etiqCtaAhaber.Caption = cboCuentas.Column(3)

txtDebe.SetFocus

End Sub

Private Sub cboCuentas_Click()

etiqNombreCuenta.Caption = cboCuentas.Column(1)
etiqCtaAdebe.Caption = cboCuentas.Column(2)
etiqCtaAhaber.Caption = cboCuentas.Column(3)

'txtDebe.SetFocus

End Sub

Private Sub cboMovimiento_Click()

Select Case cboMovimiento.Text

    Case "INGRESO"
    etiqMovimiento.Caption = "I"
    Case "EGRESO"
    etiqMovimiento.Caption = "E"
        
End Select

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

cboCuentas.Enabled = True
txtDebe.Enabled = True
txtHaber.Enabled = True
cboMovimiento.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
cboCuentas.Text = lisTabla.Column(1)
txtDebe.Text = lisTabla.Column(6)
txtHaber.Text = lisTabla.Column(7)
etiqNumRegistro.Caption = lisTabla.Column(8)
etiqMes.Caption = lisTabla.Column(9)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True
End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 14 To 500
If Hoja12.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 14 To final

If txtCodigo.Text = Hoja12.Cells(i, 2).Value Then
cboCuentas.Text = Hoja12.Cells(i, 3)
txtDebe.Text = Hoja12.Cells(i, 8)
txtHaber.Text = Hoja12.Cells(i, 9)
cboMovimiento.Text = Hoja12.Cells(i, 12)
etiqNumRegistro.Caption = Hoja12.Cells(i, 10)
etiqMes.Caption = Hoja12.Cells(i, 11)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub txtDebe_AfterUpdate()


'If txtDebe.Text = "" Then
'txtDebe.Text = Format(0, "###,##0.00")
'    Else
'    If txtDebe.Text > 0 Then|fffd|
 '    txtDebe.Text = Format(txtDebe.Text, "###,##0.00")
'     txtHaber.Text = "0.00"
'    End If
'End If

If txtDebe.Text > "" And etiqCtaAdebe.Caption > "" And etiqCtaAhaber.Caption > "" Then

etiqVal1Debe.Caption = Format(txtDebe.Text, "###,##0.00")
etiqVal2Haber.Caption = Format(txtDebe.Text, "###,##0.00")
etiqVal2Debe.Caption = Format(txtHaber.Text, "###,##0.00")
etiqVal1Haber.Caption = Format(txtHaber.Text, "###,##0.00")
Else
'etiqVal1Debe.Caption = ""
'etiqVal2Haber.Caption = ""
'etiqVal2Debe.Caption = ""
'etiqVal1Haber.Caption = ""

End If


End Sub

Private Sub txtHaber_AfterUpdate()


'If txtHaber.Text = "" Then
'txtHaber.Text = Format(0, "###,##0.00")
'    Else
'    If txtHaber.Text > 0 Then
'    txtHaber.Text = Format(txtHaber.Text, "###,##0.00")
'    txtDebe.Text = "0.00"
'    End If
'End If

If txtHaber.Text > "" And etiqCtaAdebe.Caption > "" And etiqCtaAhaber.Caption > "" Then

etiqVal1Debe.Caption = Format(txtDebe.Text, "###,##0.00")
etiqVal2Haber.Caption = Format(txtDebe.Text, "###,##0.00")
etiqVal2Debe.Caption = Format(txtHaber.Text, "###,##0.00")
etiqVal1Haber.Caption = Format(txtHaber.Text, "###,##0.00")
Else
'etiqVal1Debe.Caption = ""
'etiqVal2Haber.Caption = ""
'etiqVal2Debe.Caption = ""
'etiqVal1Haber.Caption = ""

End If

cboMovimiento.SetFocus

End Sub

Private Sub UserForm_Initialize()

etiqNumRegistro.Caption = Range("l2")
etiqMes.Caption = Range("c2")

Hoja12.Activate
lisTabla.RowSource = "B14:K100"

'etiqSumaDebe.Caption = lisTabla.Column(6).TotalsCalculation = xlTotalsCalculationSum

Dim d As Byte, totd As Double
For d = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
totd = totd + Val(lisTabla.List(d, 6))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next d
etiqSumaDebe.Caption = Format(totd, "###,##0.00")

Dim h As Byte, toth As Double
For h = 0 To lisTabla.ListCount - 1    'ajustar nbre del control ListBox
toth = toth + Val(lisTabla.List(h, 7))      'ajustar nbre y nro de col, aqu|fffd| el 2 representa la 3er col
Next h
etiqSumaHaber.Caption = Format(toth, "###,##0.00")

End Sub
Attribute VB_Name = "FormDDetalle"
Attribute VB_Base = "0{CF1081DB-5CFF-4C48-82FB-5B911AE5CEBD}{82B9FD6E-1E74-45D8-BB4A-2F36670D1D4C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoEntidad_Click()

FormDEntidades.Show

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub


Private Sub cboBanco_Click()

etiqMoneda.Caption = cboBanco.Column(1)
etiqCodigoBanco.Caption = cboBanco.Column(2)
etiqNombreBanco.Caption = cboBanco.Column(3)

Range("c8") = etiqCodigoBanco.Caption
Range("d8") = etiqNombreBanco.Caption
Range("g8") = cboBanco.Column(0)
Range("h8") = etiqMoneda.Caption

End Sub

Private Sub cboDocumento_Click()

etiqNombredocumento.Caption = cboDocumento.Column(1)

Range("h4") = cboDocumento.Column(0)

txtSerie.SetFocus

End Sub

Private Sub cboLibro_Click()

etiqNombreLibro.Caption = cboLibro.Column(1)

Range("c5") = cboLibro.Column(0)
Range("d5") = etiqNombreLibro.Caption

txtNumOperac.SetFocus

End Sub

Private Sub cboMes_Click()

Select Case cboMes.Text

    Case "ENERO"
    Range("c2") = 1
    Range("D2") = cboMes.Column(0)
    Case "FEBRERO"
    Range("c2") = 2
    Range("D2") = cboMes.Column(0)
    Case "MARZO"
    Range("c2") = 3
    Range("D2") = cboMes.Column(0)
    Case "ABRIL"
    Range("c2") = 4
    Range("D2") = cboMes.Column(0)
    Case "MAYO"
    Range("c2") = 5
    Range("D2") = cboMes.Column(0)
    Case "JUNIO"
    Range("c2") = 6
    Range("D2") = cboMes.Column(0)
    Case "JULIO"
    Range("c2") = 7
    Range("D2") = cboMes.Column(0)
    Case "AGOSTO"
    Range("c2") = 8
    Range("D2") = cboMes.Column(0)
    Case "SEPTIEMBRE"
    Range("c2") = 9
    Range("D2") = cboMes.Column(0)
    Case "OCTUBRE"
    Range("c2") = 10
    Range("D2") = cboMes.Column(0)
    Case "NOVIEMBRE"
    Range("c2") = 11
    Range("D2") = cboMes.Column(0)
    Case "DICIEMBRE"
    Range("c2") = 12
    Range("D2") = cboMes.Column(0)
    
End Select

End Sub
Private Sub cboPago_Click()

etiqNombrePago.Caption = cboPago.Column(1)

Range("c9") = cboPago.Column(0)
Range("d9") = etiqNombrePago.Caption

End Sub

Private Sub cboVoucher_Click()

etiqNombrevoucher.Caption = cboVoucher.Column(1)

Range("f2") = cboVoucher.Column(0)

txtNumeroVoucher.Text = Range("h2")

txtNumRegistro.Text = Range("c2") & cboVoucher.Text & txtNumeroVoucher.Text
Range("L2") = txtNumRegistro.Text
'txtNumRegistro.Text = Range("c2") & Range("f2") & Range("h2")

End Sub


Private Sub txtFecha_AfterUpdate()

txtFecha.Text = CDate(txtFecha.Text)
Range("c4") = txtFecha.Text

End Sub


Private Sub txtGlosa_AfterUpdate()

txtGlosa.Text = UCase(txtGlosa.Text)

Range("c11") = txtGlosa.Text

End Sub

Private Sub txtNumDocumento_AfterUpdate()

Range("h6") = txtNumDocumento.Text

End Sub

Private Sub txtNumeroVoucher_AfterUpdate()

Range("H2") = txtNumeroVoucher.Text
'txtNumRegistro.Text = Range("L2")
txtNumRegistro.Text = Range("c2") & cboVoucher.Text & txtNumeroVoucher.Text
Range("L2") = txtNumRegistro.Text

For i = 2 To 500000
If Hoja13.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 2 To final

If txtNumRegistro.Text = Hoja13.Cells(i, 1) Then
cboMes.Text = Hoja13.Cells(i, 2)
cboVoucher.Text = Hoja13.Cells(i, 3)
txtNumeroVoucher.Text = Hoja13.Cells(i, 4)
txtFecha.Text = Hoja13.Cells(i, 5)
cboLibro.Text = Hoja13.Cells(i, 6)
txtNumOperac.Text = Hoja13.Cells(i, 7)
cboDocumento.Text = Format(Hoja13.Cells(i, 8), "0#")
txtSerie.Text = Hoja13.Cells(i, 9)
txtNumDocumento.Text = Hoja13.Cells(i, 10)
etiqNumEntidad.Caption = Hoja13.Cells(i, 11)
txtGlosa.Text = Hoja13.Cells(i, 12)

Hoja12.Range("c4") = txtFecha.Text
Hoja12.Range("H4") = cboDocumento.Text
Hoja12.Range("H5") = txtSerie.Text
Hoja12.Range("H6") = txtNumDocumento.Text
Hoja12.Range("G9") = etiqNumEntidad.Caption
Hoja12.Range("C11") = txtGlosa.Text


Hoja23.Range("A1:J500000").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Hoja12.Range("L1:L2"), CopyToRange:=Hoja12.Range("B13:K13"), Unique:=False


Exit For
End If
Next

End Sub


Private Sub txtNumOperac_AfterUpdate()

Range("c6") = txtNumOperac.Text

End Sub

Private Sub txtSerie_AfterUpdate()

Range("h5") = txtSerie.Text

End Sub

Private Sub UserForm_Activate()

cboMes.Text = Hoja12.Range("d2")

End Sub

Attribute VB_Name = "FormDEntidades"
Attribute VB_Base = "0{0967181D-625F-42E3-8503-1CC76D2ED3A8}{9129F40F-B985-4301-8BF8-CEC9B991C6B1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub list00_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

If ActiveSheet.Name = ("VOUDIARIO") Then

FormDDetalle.etiqNumEntidad.Caption = list00.Column(0)
FormDDetalle.etiqNombreEntidad.Caption = list00.Column(1)

Range("g9") = FormDDetalle.etiqNumEntidad.Caption
Range("h9") = FormDDetalle.etiqNombreEntidad.Caption

End If

Unload Me

End Sub

Private Sub list12_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

If ActiveSheet.Name = ("VOUDIARIO") Then

FormDDetalle.etiqNumEntidad.Caption = list12.Column(0)
FormDDetalle.etiqNombreEntidad.Caption = list12.Column(1)

Range("g9") = FormDDetalle.etiqNumEntidad.Caption
Range("h9") = FormDDetalle.etiqNombreEntidad.Caption

End If

Unload Me

End Sub

Private Sub list42_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

If ActiveSheet.Name = ("VOUDIARIO") Then

FormDDetalle.etiqNumEntidad.Caption = list42.Column(0)
FormDDetalle.etiqNombreEntidad.Caption = list42.Column(1)

Range("g9") = FormDDetalle.etiqNumEntidad.Caption
Range("h9") = FormDDetalle.etiqNombreEntidad.Caption

End If

Unload Me

End Sub

Private Sub MultiPage1_Change()

End Sub

Private Sub txtBusqueda00_AfterUpdate()

On Error GoTo errorbusqueda
          
            
            list00 = txtBusqueda00.Text
            
            Exit Sub
                                
errorbusqueda:
    MsgBox "No se encontro el C|fffd|digo"
    txtBusqueda00.SetFocus
    
End Sub

Private Sub txtBusqueda12_AfterUpdate()

On Error GoTo errorbusqueda
          
            
            list12 = txtBusqueda12.Text
            
            Exit Sub
                                
errorbusqueda:
    MsgBox "No se encontro el C|fffd|digo"
    txtBusqueda12.SetFocus

End Sub

Private Sub txtBusqueda42_AfterUpdate()
On Error GoTo errorbusqueda
          
            
            list42 = txtBusqueda42.Text
            
            Exit Sub
                                
errorbusqueda:
    MsgBox "No se encontro el C|fffd|digo"
    txtBusqueda42.SetFocus
End Sub

Private Sub UserForm_Initialize()

If ActiveSheet.Name = ("VOUDIARIO") Then

Hoja8.Activate
list12.RowSource = "a3:C3000"

Hoja9.Activate
list42.RowSource = "a3:C3000"

Hoja11.Activate
list00.RowSource = "a3:B500"

Hoja12.Activate

End If

End Sub
Attribute VB_Name = "FormEmpresa"
Attribute VB_Base = "0{C8FEAA9B-CB1B-467D-9E4A-683079EAAB4A}{FD500A21-6730-4DB8-A79D-13954D8296FF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtEmpresa.Text = Hoja1.Range("b2")
txtRuc.Text = Hoja1.Range("b3")
txtPeriodo.Text = Hoja1.Range("b4")
cboMes.Text = Hoja1.Range("b5")
txtIgv.Text = Hoja1.Range("b6") * 100

txtEmpresa.Enabled = False
txtRuc.Enabled = False
txtPeriodo.Enabled = False
cboMes.Enabled = False
txtIgv.Enabled = False

btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoSalir.Enabled = True

End Sub

Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtEmpresa.Text = "" Then
         MsgBox "Ingrese nombre de la empresa"
         txtEmpresa.SetFocus
         Exit Sub
End If

If txtRuc.Text = "" Then
         MsgBox "Ingrese RUC de la empresa"
         txtRuc.SetFocus
         Exit Sub
End If

If txtPeriodo.Text = "" Then
         MsgBox "Ingrese el Periodo de Trabajo"
         txtPeriodo.SetFocus
         Exit Sub
End If

If cboMes.Text = "" Then
         MsgBox "Seleccione el Mes de Trabajo"
         cboMes.SetFocus
         Exit Sub
End If

If txtIgv.Text = "" Then
         MsgBox "Ingrese la tasa de Impuesto a las Ventas"
         txtIgv.SetFocus
         Exit Sub
End If

Hoja1.Range("b2") = txtEmpresa.Text
Hoja1.Range("b3") = txtRuc.Text
Hoja1.Range("b4") = txtPeriodo.Text
Hoja1.Range("b5") = cboMes.Text
Hoja1.Range("b6") = txtIgv.Text / 100

txtEmpresa.Enabled = False
txtRuc.Enabled = False
txtPeriodo.Enabled = False
cboMes.Enabled = False
txtIgv.Enabled = False

btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoSalir.Enabled = True

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtEmpresa.Enabled = True
txtRuc.Enabled = True
txtPeriodo.Enabled = True
cboMes.Enabled = True
txtIgv.Enabled = True

txtEmpresa.Text = Hoja1.Range("b2")
txtRuc.Text = Hoja1.Range("b3")
txtPeriodo.Text = Hoja1.Range("b4")
cboMes.Text = Hoja1.Range("b5")
txtIgv.Text = Hoja1.Range("b6") * 100

btoModificar.Enabled = False
btoCancelar.Enabled = True
btoGuardar.Enabled = True
btoSalir.Enabled = False

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub UserForm_Activate()

txtEmpresa.Text = Hoja1.Range("b2")
txtRuc.Text = Hoja1.Range("b3")
txtPeriodo.Text = Hoja1.Range("b4")
cboMes.Text = Hoja1.Range("b5")
txtIgv.Text = Hoja1.Range("b6") * 100

End Sub

Attribute VB_Name = "FormTBcos"
Attribute VB_Base = "0{E750E354-5731-4575-AC53-378894DABA70}{7120C336-ECD2-43D1-BA41-BF14DD437762}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja10.Activate
'---------------------------
For i = 3 To 100
If Hoja10.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja10.Cells(i, 1) Then
Hoja10.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 100
    If Hoja10.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja10.Cells(i, 1) Then
    Hoja10.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

Range("A3:b100").Select
    ActiveWorkbook.Worksheets("TBCOS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TBCOS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TBCOS").Sort
        .SetRange Range("A3:b100")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 100
If Hoja10.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja10.Cells(i, 1) Then
txtDescripcion.Text = Hoja10.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TBCOS").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b100").Select
    ActiveWorkbook.Worksheets("TBCOS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TBCOS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TBCOS").Sort
        .SetRange Range("A3:b100")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 100
If Hoja10.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja10.Cells(i, 2) Then
txtCodigo.Text = Hoja10.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja10.Activate
lisTabla.RowSource = "a3:B100"

End Sub


Attribute VB_Name = "FormTBcosCia"
Attribute VB_Base = "0{059A6610-B45C-441F-AF39-60E40EE92690}{35EEDA64-78E3-4600-8456-EDF7ED87413A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
cboMoneda.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
cboMoneda.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja18.Activate
'---------------------------
For i = 3 To 25
If Hoja18.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja18.Cells(i, 1) Then
Hoja18.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
cboMoneda.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
cboMoneda.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. de Cuenta"
         txtCodigo.SetFocus
         Exit Sub
End If

If cboMoneda.Text = "" Then
         MsgBox "Seleccione Tipo de Moneda"
         cboMoneda.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione el Banco"
         cboDocumentos.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 25
    If Hoja18.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja18.Cells(i, 1) Then
    Hoja18.Cells(i, 2) = cboMoneda.Text
    Hoja18.Cells(i, 3) = cboDocumentos.Text
    Hoja18.Cells(i, 4) = etiqNombredocumento.Caption
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    cboMoneda.Enabled = False
    cboDocumentos.Enabled = False
        
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------
Range("A3:d25").Select
    ActiveWorkbook.Worksheets("TBCOSCIA").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TBCOSCIA").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TBCOSCIA").Sort
        .SetRange Range("A3:d25")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
cboMoneda.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = ""
cboMoneda.Text = ""
cboDocumentos.Text = ""

cboDocumentos.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub


Private Sub cboDocumentos_Click()

etiqNombredocumento.Caption = cboDocumentos.Column(1)
txtCodigo.SetFocus

'cboDocumentos.ListIndex = 1

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
cboMoneda.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
cboMoneda.Text = lisTabla.Column(1)
cboDocumentos.Text = lisTabla.Column(2)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 25
If Hoja18.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja18.Cells(i, 1) Then
cboMoneda.Text = Hoja8.Cells(i, 2)
cboDocumentos.Text = Hoja8.Cells(i, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. de Cuenta"
         txtCodigo.SetFocus
         Exit Sub
End If

If cboMoneda.Text = "" Then
         MsgBox "Ingrese Moneda"
         txtDescripcion.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione Banco"
         cboDocumentos.SetFocus
         Exit Sub
End If

    Sheets("TBCOSCIA").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = cboMoneda.Text
    Cells(nextrow, 3) = cboDocumentos.Text
    Cells(nextrow, 4) = etiqNombredocumento.Caption
    
txtCodigo.Enabled = False
cboMoneda.Enabled = False
cboDocumentos.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:d25").Select
    ActiveWorkbook.Worksheets("TBCOSCIA").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TBCOSCIA").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TBCOSCIA").Sort
        .SetRange Range("A3:D25")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
cboMoneda.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = True
cboMoneda.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

'Private Sub txtDescripcion_AfterUpdate()

'txtDescripcion.Text = UCase(txtDescripcion.Text)

'For i = 3 To 3000
'If Hoja8.Cells(i, 2) = "" Then
'final = i - 1
'Exit For
'End If
'Next

'For i = 3 To final

'If txtDescripcion = Hoja8.Cells(i, 2) Then
'txtCodigo.Text = Hoja8.Cells(i, 1)
'cboDocumentos.Text = Hoja8.Cells(i, 3)
'btoGuardar.Enabled = False
'Exit For
'End If
'Next

'End Sub

Private Sub UserForm_Initialize()

Hoja18.Activate
lisTabla.RowSource = "a3:d25"

End Sub




Attribute VB_Name = "FormTClientes"
Attribute VB_Base = "0{DE332B21-1C2A-4770-948A-CC514CD805AF}{5B3B37AF-67BF-4BCC-8147-0974ADDDA121}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoDoc_Click()

FormTDocum.Show

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja8.Activate
'---------------------------
For i = 3 To 3000
If Hoja8.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja8.Cells(i, 1) Then
Hoja8.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. I. T."
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese el Nombre"
         txtDescripcion.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione el tipo de documento"
         cboDocumentos.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 3000
    If Hoja8.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja8.Cells(i, 1) Then
    Hoja8.Cells(i, 2) = UCase(txtDescripcion.Text)
    Hoja8.Cells(i, 3) = cboDocumentos.Text
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
    cboDocumentos.Enabled = False
        
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------
Range("A3:C3000").Select
    ActiveWorkbook.Worksheets("TCLIEN").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TCLIEN").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCLIEN").Sort
        .SetRange Range("A3:C3000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

cboDocumentos.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub


Private Sub cboDocumentos_Click()

etiqNombredocumento.Caption = cboDocumentos.Column(1)

'cboDocumentos.ListIndex = 1

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)
cboDocumentos.Text = lisTabla.Column(2)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 3000
If Hoja8.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja8.Cells(i, 1) Then
txtDescripcion.Text = Hoja8.Cells(i, 2)
cboDocumentos.Text = Hoja8.Cells(i, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. I. T."
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese el Nombre"
         txtDescripcion.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione el Tipo de Documento"
         cboDocumentos.SetFocus
         Exit Sub
End If

    Sheets("TCLIEN").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
    Cells(nextrow, 3) = cboDocumentos.Text
    
txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:C3000").Select
    ActiveWorkbook.Worksheets("TCLIEN").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TCLIEN").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCLIEN").Sort
        .SetRange Range("A3:C3000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 3000
If Hoja8.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja8.Cells(i, 2) Then
txtCodigo.Text = Hoja8.Cells(i, 1)
cboDocumentos.Text = Hoja8.Cells(i, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja8.Activate
lisTabla.RowSource = "a3:C3000"

End Sub


Attribute VB_Name = "FormTComprob"
Attribute VB_Base = "0{246BDB52-1BC7-47A9-82E2-23F53E6490F8}{B4011D12-5ECA-4C9F-8781-61E6E31C4736}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja5.Activate
'---------------------------
For i = 3 To 100
If Hoja5.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja5.Cells(i, 1) Then
Hoja5.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 100
    If Hoja5.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja5.Cells(i, 1) Then
    Hoja5.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

 Range("A3:b100").Select
    ActiveWorkbook.Worksheets("TCOMPROB").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TCOMPROB").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCOMPROB").Sort
        .SetRange Range("A3:b100")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 100
If Hoja5.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja5.Cells(i, 1) Then
txtDescripcion.Text = Hoja5.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TCOMPROB").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = (txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b100").Select
    ActiveWorkbook.Worksheets("TCOMPROB").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TCOMPROB").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCOMPROB").Sort
        .SetRange Range("A3:b100")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True


End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()
txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 100
If Hoja5.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja5.Cells(i, 2) Then
txtCodigo.Text = Hoja5.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next
End Sub

Private Sub txtDescripcion_Change()

End Sub

Private Sub UserForm_Initialize()

Hoja5.Activate
lisTabla.RowSource = "a3:B100"

End Sub
Attribute VB_Name = "FormTDocum"
Attribute VB_Base = "0{C92D7EA8-BBA6-4D1A-BBA6-D9B0AF7AE62C}{901844E8-9683-4658-B62D-D3145DAD5F11}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja6.Activate
'---------------------------
For i = 3 To 20
If Hoja6.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja6.Cells(i, 1) Then
Hoja6.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 20
    If Hoja6.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja6.Cells(i, 1) Then
    Hoja6.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

 Range("A3:b20").Select
    ActiveWorkbook.Worksheets("TDOC").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TDOC").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCOMPROB").Sort
        .SetRange Range("A3:b20")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 20
If Hoja6.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja6.Cells(i, 1) Then
txtDescripcion.Text = Hoja6.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TDOC").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b20").Select
    ActiveWorkbook.Worksheets("TDOC").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TDOC").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TCOMPROB").Sort
        .SetRange Range("A3:b20")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 20
If Hoja6.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja6.Cells(i, 2) Then
txtCodigo.Text = Hoja6.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub txtDescripcion_Change()

End Sub

Private Sub UserForm_Initialize()

Hoja6.Activate
lisTabla.RowSource = "a3:B20"

End Sub


Attribute VB_Name = "FormTLibros"
Attribute VB_Base = "0{29EE07D8-FF46-4409-9916-7A37F98977E1}{B4180DD6-FE6C-47E3-BC25-1BA78B2957E1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja4.Activate
'---------------------------
For i = 3 To 50
If Hoja4.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja4.Cells(i, 1) Then
Hoja4.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 50
    If Hoja4.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja4.Cells(i, 1) Then
    Hoja4.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

 Range("A3:b50").Select
    ActiveWorkbook.Worksheets("TLIBROS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TLIBROS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TLIBROS").Sort
        .SetRange Range("A3:b50")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 50
If Hoja4.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja4.Cells(i, 1) Then
txtDescripcion.Text = Hoja4.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TLIBROS").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b50").Select
    ActiveWorkbook.Worksheets("TLIBROS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TLIBROS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TLIBROS").Sort
        .SetRange Range("A3:b50")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 50
If Hoja4.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja4.Cells(i, 2) Then
txtCodigo.Text = Hoja4.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub


Private Sub UserForm_Initialize()

Hoja4.Activate
lisTabla.RowSource = "a3:B50"

End Sub
Attribute VB_Name = "FormTOtros"
Attribute VB_Base = "0{F4056C8A-0001-4E76-9231-B693910A07BB}{7486C296-CD50-48B3-A797-D93DCE8A0C39}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja11.Activate
'---------------------------
For i = 3 To 500
If Hoja11.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja11.Cells(i, 1) Then
Hoja11.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 500
    If Hoja11.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja11.Cells(i, 1) Then
    Hoja11.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

 Range("A3:b500").Select
    ActiveWorkbook.Worksheets("TOTROS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TOTROS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TOTROS").Sort
        .SetRange Range("A3:b500")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

txtCodigo.Text = UCase(txtCodigo.Text)

For i = 3 To 500
If Hoja11.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja11.Cells(i, 1) Then
txtDescripcion.Text = Hoja11.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TOTROS").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b500").Select
    ActiveWorkbook.Worksheets("TOTROS").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TOTROS").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TOTROS").Sort
        .SetRange Range("A3:b500")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 500
If Hoja11.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja11.Cells(i, 2) Then
txtCodigo.Text = Hoja11.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja11.Activate
lisTabla.RowSource = "a3:B500"

End Sub




Attribute VB_Name = "FormTPagos"
Attribute VB_Base = "0{8E37A229-A307-4DA9-886B-774308D21C64}{3A740EAB-95CD-4B95-BADB-A4FE33C2947D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja7.Activate
'---------------------------
For i = 3 To 40
If Hoja7.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja7.Cells(i, 1) Then
Hoja7.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 40
    If Hoja7.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja7.Cells(i, 1) Then
    Hoja7.Cells(i, 2) = UCase(txtDescripcion.Text)
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
          
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

 Range("A3:b40").Select
    ActiveWorkbook.Worksheets("TPAGO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TPAGO").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TPAGO").Sort
        .SetRange Range("A3:b40")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 40
If Hoja7.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja7.Cells(i, 1) Then
txtDescripcion.Text = Hoja7.Cells(i, 2)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TPAGO").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
       
txtCodigo.Enabled = False
txtDescripcion.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:b40").Select
    ActiveWorkbook.Worksheets("TPAGO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TPAGO").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TPAGO").Sort
        .SetRange Range("A3:b40")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 40
If Hoja7.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja7.Cells(i, 2) Then
txtCodigo.Text = Hoja7.Cells(i, 1)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja7.Activate
lisTabla.RowSource = "a3:B40"

End Sub




Attribute VB_Name = "FormTPlancuentas"
Attribute VB_Base = "0{D9F6B86C-53EF-4707-9F04-5C1857F80C0F}{668BF416-F208-466D-BE78-DA4B420FE4CC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtCuenta.Text = ""
txtNombre.Text = ""
txtADebe.Text = ""
txtAHaber.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtCuenta.Enabled = False
txtNombre.Enabled = False
txtADebe.Enabled = False
txtAHaber.Enabled = False
cboDocumentos.Enabled = False

Selection.EntireRow.Delete

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoCancelar1_Click()

txtCodigo.Text = ""
txtCuenta.Text = ""
txtNombre.Text = ""
txtADebe.Text = ""
txtAHaber.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtCuenta.Enabled = False
txtNombre.Enabled = False
txtADebe.Enabled = False
txtAHaber.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoCancelar.Visible = True
btoCancelar1.Enabled = False
btoCancelar1.Visible = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja2.Activate
'---------------------------
For i = 4 To 3502
If Hoja2.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 4 To final
If txtCodigo.Text = Hoja2.Cells(i, 2) Then
Hoja2.Cells(i, 2).Select
Selection.EntireRow.Delete
'Else

Exit For
End If
Next

For i = 4 To final
If txtCuenta.Text = Hoja2.Cells(i, 1) Then
Hoja2.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtCuenta.Text = ""
txtNombre.Text = ""
txtADebe.Text = ""
txtAHaber.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtCuenta.Enabled = False
txtNombre.Enabled = False
txtADebe.Enabled = False
txtAHaber.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoCancelar.Visible = True
btoCancelar1.Enabled = False
btoCancelar1.Visible = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

'    For i = 4 To 2502
'    If Hoja2.Cells(i, 1) = "" Then
'    final = i - 1
'    Exit For
'    End If
'    Next
    
'    For i = 4 To final
'    If txtCodigo = Hoja18.Cells(i, 1) Then
'    Hoja18.Cells(i, 2) = cboMoneda.Text
'    Hoja18.Cells(i, 3) = cboDocumentos.Text
'    Hoja18.Cells(i, 4) = etiqNombreDocumento.Caption
'    Exit For
'    End If
'    Next
              
'    Dim z As Integer
    'como los datos empiezan en fila2 se incrementa al nro de |fffd|ndice del listbox
'    z = lisTabla.ListIndex + 4
'    Cells(z, 1).Select
    
    ActiveCell.Offset(0, 0).Select
    ActiveCell = txtCuenta.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtCodigo.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtNombre.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtADebe.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtAHaber.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = cboDocumentos.Text
    
    Hoja2.Activate
    lisTabla.RowSource = "a4:f3502"
              
    txtCodigo.Enabled = False
    txtCuenta.Enabled = False
    txtNombre.Enabled = False
    txtADebe.Enabled = False
    txtAHaber.Enabled = False
    cboDocumentos.Enabled = False
        
    btoCancelar.Enabled = False
    btoCancelar.Visible = True
    btoCancelar1.Enabled = False
    btoCancelar1.Visible = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtCuenta.Enabled = True
txtNombre.Enabled = True
txtADebe.Enabled = True
txtAHaber.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = ""
txtCuenta.Text = ""
txtNombre.Text = ""
txtADebe.Text = ""
txtAHaber.Text = ""
cboDocumentos.Text = ""

txtCuenta.SetFocus

Dim z As Integer
'como los datos empiezan en fila2 se incrementa al nro de |fffd|ndice del listbox
z = lisTabla.ListIndex + 4
Cells(z, 1).Select
    Selection.EntireRow.Insert CopyOrigin:=xlFormatFromLeftOrAbove
    'Selection.EntireRow.Insert shift:=xlUp, CopyOrigin:=xlFormatFromLeftOrAbove

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub


Private Sub cboDocumentos_Click()

etiqNombredocumento.Caption = cboDocumentos.Column(1)
'txtCodigo.SetFocus

'cboDocumentos.ListIndex = 1

End Sub

Private Sub lisTabla_Click()

Dim z As Integer
'como los datos empiezan en fila2 se incrementa al nro de |fffd|ndice del listbox
z = lisTabla.ListIndex + 4
Cells(z, 1).Select

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtCuenta.Enabled = True
txtNombre.Enabled = True
txtADebe.Enabled = True
txtAHaber.Enabled = True
cboDocumentos.Enabled = True

txtCuenta.Text = lisTabla.Column(0)
txtCodigo.Text = lisTabla.Column(1)
txtNombre.Text = lisTabla.Column(2)
txtADebe.Text = lisTabla.Column(3)
txtAHaber.Text = lisTabla.Column(4)
cboDocumentos.Text = lisTabla.Column(5)

btoNuevo.Enabled = False
btoCancelar.Enabled = False
btoCancelar1.Visible = True
btoCancelar1.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 4 To 3502
If Hoja2.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 4 To final

If txtCodigo.Text = Hoja2.Cells(i, 2) Then
txtCuenta.Text = Hoja2.Cells(i, 1)
txtNombre.Text = Hoja2.Cells(i, 3)
txtADebe.Text = Hoja2.Cells(i, 4)
txtAHaber.Text = Hoja2.Cells(i, 5)
cboDocumentos.Text = Hoja2.Cells(i, 6)

'cboMoneda.Text = Hoja2.Cells(i, 2)
'cboDocumentos.Text = Hoja8.Cells(2, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

    Dim z As Integer
    'como los datos empiezan en fila2 se incrementa al nro de |fffd|ndice del listbox
    z = lisTabla.ListIndex + 4
    Cells(z, 1).Select
    
    ActiveCell.Offset(0, 0).Select
    ActiveCell = txtCuenta.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtCodigo.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtNombre.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtADebe.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = txtAHaber.Text
    ActiveCell.Offset(0, 1).Select
    ActiveCell = cboDocumentos.Text
    
Hoja2.Activate
lisTabla.RowSource = "a4:f3502"
    
txtCodigo.Enabled = False
txtCuenta.Enabled = False
txtNombre.Enabled = False
txtADebe.Enabled = False
txtAHaber.Enabled = False
cboDocumentos.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtCuenta.Text = ""
txtNombre.Text = ""
txtADebe.Text = ""
txtAHaber.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = True
txtCuenta.Enabled = True
txtNombre.Enabled = True
txtADebe.Enabled = True
txtAHaber.Enabled = True
cboDocumentos.Enabled = True

txtCuenta.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = False
btoCancelar.Visible = False
btoCancelar1.Enabled = True
btoCancelar1.Visible = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCuenta_AfterUpdate()

For i = 4 To 3502
If Hoja2.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 4 To final

If txtCuenta.Text = Hoja2.Cells(i, 1) Then
Hoja2.Cells(i, 1).Select
txtCodigo.Text = Hoja2.Cells(i, 2)
txtNombre.Text = Hoja2.Cells(i, 3)
txtADebe.Text = Hoja2.Cells(i, 4)
txtAHaber.Text = Hoja2.Cells(i, 5)
cboDocumentos.Text = Hoja2.Cells(i, 6)

'cboMoneda.Text = Hoja2.Cells(i, 2)
'cboDocumentos.Text = Hoja8.Cells(2, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja2.Activate
lisTabla.RowSource = "a4:f3502"

End Sub


Attribute VB_Name = "FormTProveedores"
Attribute VB_Base = "0{A3EB9EB6-368C-4558-9A5D-6644A19A48E8}{F6FA2DE0-71A6-4F95-8001-C93480D84752}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoDoc_Click()

FormTDocum.Show

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja9.Activate
'---------------------------
For i = 3 To 3000
If Hoja9.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja9.Cells(i, 1) Then
Hoja9.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. I. T."
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese el Nombre"
         txtDescripcion.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione el tipo de documento"
         cboDocumentos.SetFocus
         Exit Sub
End If

    'Dim i As Integer
    'Dim final As Integer
    
    For i = 3 To 3000
    If Hoja9.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja9.Cells(i, 1) Then
    Hoja9.Cells(i, 2) = UCase(txtDescripcion.Text)
    Hoja9.Cells(i, 3) = cboDocumentos.Text
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
    cboDocumentos.Enabled = False
        
    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------
Range("A3:C3000").Select
    ActiveWorkbook.Worksheets("TPROVEE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TPROVEE").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TPROVEE").Sort
        .SetRange Range("A3:C3000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

cboDocumentos.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub


Private Sub cboDocumentos_Click()

etiqNombredocumento.Caption = cboDocumentos.Column(1)

'cboDocumentos.ListIndex = 1

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)
cboDocumentos.Text = lisTabla.Column(2)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 3000
If Hoja9.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja9.Cells(i, 1) Then
txtDescripcion.Text = Hoja9.Cells(i, 2)
cboDocumentos.Text = Hoja9.Cells(i, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el N. I. T."
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese el Nombre"
         txtDescripcion.SetFocus
         Exit Sub
End If

If cboDocumentos.Text = "" Then
         MsgBox "Seleccione el Tipo de Documento"
         cboDocumentos.SetFocus
         Exit Sub
End If

    Sheets("TPROVEE").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
    Cells(nextrow, 3) = cboDocumentos.Text
    
txtCodigo.Enabled = False
txtDescripcion.Enabled = False
cboDocumentos.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:C3000").Select
    ActiveWorkbook.Worksheets("TPROVEE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TPROVEE").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TPROVEE").Sort
        .SetRange Range("A3:C3000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
cboDocumentos.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
cboDocumentos.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 3000
If Hoja9.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja9.Cells(i, 2) Then
txtCodigo.Text = Hoja9.Cells(i, 1)
cboDocumentos.Text = Hoja9.Cells(i, 3)
btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja9.Activate
lisTabla.RowSource = "a3:C3000"

End Sub




Attribute VB_Name = "FormTVouchers"
Attribute VB_Base = "0{A88B910F-5DA6-4BC7-8B38-7A18F89072A5}{36C955A6-9A0B-4615-B1CC-BE3C47D9CDA0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub btoCancelar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
txtCorrelativo.Text = ""
txt2.Text = ""
txt3.Text = ""
txt4.Text = ""
txt5.Text = ""
txt6.Text = ""
txt7.Text = ""
txt8.Text = ""
txt9.Text = ""
txt10.Text = ""
txt11.Text = ""
txt12.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
txtCorrelativo.Enabled = False
txt2.Enabled = False
txt3.Enabled = False
txt4.Enabled = False
txt5.Enabled = False
txt6.Enabled = False
txt7.Enabled = False
txt8.Enabled = False
txt9.Enabled = False
txt10.Enabled = False
txt11.Enabled = False
txt12.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False

End Sub

Private Sub btoEliminar_Click()

Application.ScreenUpdating = False

Hoja3.Activate
'---------------------------
For i = 3 To 24
If Hoja3.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final
If txtCodigo.Text = Hoja3.Cells(i, 1) Then
Hoja3.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

txtCodigo.Text = ""
txtDescripcion.Text = ""
txtCorrelativo.Text = ""
txt2.Text = ""
txt3.Text = ""
txt4.Text = ""
txt5.Text = ""
txt6.Text = ""
txt7.Text = ""
txt8.Text = ""
txt9.Text = ""
txt10.Text = ""
txt11.Text = ""
txt12.Text = ""

txtCodigo.Enabled = False
txtDescripcion.Enabled = False
txtCorrelativo.Enabled = False
txt2.Enabled = False
txt3.Enabled = False
txt4.Enabled = False
txt5.Enabled = False
txt6.Enabled = False
txt7.Enabled = False
txt8.Enabled = False
txt9.Enabled = False
txt10.Enabled = False
txt11.Enabled = False
txt12.Enabled = False

btoNuevo.Enabled = True
btoModificar.Enabled = True
btoCancelar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = True
btoGuardar1.Enabled = False
btoGuardar1.Visible = False
btoSalir.Enabled = True
btoEliminar.Enabled = False
btoEliminar.Visible = False
'---------------------------------
'Hoja10.Select 'Panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoGuardar1_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    For i = 3 To 24
    If Hoja3.Cells(i, 1) = "" Then
    final = i - 1
    Exit For
    End If
    Next
    
    For i = 3 To final
    If txtCodigo.Text = Hoja3.Cells(i, 1) Then
    Hoja3.Cells(i, 2) = UCase(txtDescripcion.Text)
    Hoja3.Cells(i, 3) = txtCorrelativo.Text
    Hoja3.Cells(i, 4) = txt2.Text
    Hoja3.Cells(i, 5) = txt3.Text
    Hoja3.Cells(i, 6) = txt4.Text
    Hoja3.Cells(i, 7) = txt5.Text
    Hoja3.Cells(i, 8) = txt6.Text
    Hoja3.Cells(i, 9) = txt7.Text
    Hoja3.Cells(i, 10) = txt8.Text
    Hoja3.Cells(i, 11) = txt9.Text
    Hoja3.Cells(i, 12) = txt10.Text
    Hoja3.Cells(i, 13) = txt11.Text
    Hoja3.Cells(i, 14) = txt12.Text
    
    Exit For
    End If
    Next
              
    txtCodigo.Enabled = False
    txtDescripcion.Enabled = False
    txtCorrelativo.Enabled = False
    txt2.Enabled = False
    txt3.Enabled = False
    txt4.Enabled = False
    txt5.Enabled = False
    txt6.Enabled = False
    txt7.Enabled = False
    txt8.Enabled = False
    txt9.Enabled = False
    txt10.Enabled = False
    txt11.Enabled = False
    txt12.Enabled = False

    btoCancelar.Enabled = False
    btoModificar.Enabled = True
    btoNuevo.Enabled = True
    btoGuardar.Enabled = False
    btoGuardar.Visible = True
    btoGuardar1.Enabled = False
    btoGuardar1.Visible = False
    btoSalir.Enabled = True
    btoEliminar.Enabled = False
    btoEliminar.Visible = False

'---------------------------------------

Range("A3:n24").Select
    ActiveWorkbook.Worksheets("TVOU").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TVOU").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TVOU").Sort
        .SetRange Range("A3:n24")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoNuevo_Click()

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
txtCorrelativo.Enabled = True
txt2.Enabled = True
txt3.Enabled = True
txt4.Enabled = True
txt5.Enabled = True
txt6.Enabled = True
txt7.Enabled = True
txt8.Enabled = True
txt9.Enabled = True
txt10.Enabled = True
txt11.Enabled = True
txt12.Enabled = True

txtCodigo.Text = ""
txtDescripcion.Text = ""
txtCorrelativo.Text = ""
txt2.Text = ""
txt3.Text = ""
txt4.Text = ""
txt5.Text = ""
txt6.Text = ""
txt7.Text = ""
txt8.Text = ""
txt9.Text = ""
txt10.Text = ""
txt11.Text = ""
txt12.Text = ""

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = True
btoSalir.Enabled = False
btoEliminar.Enabled = True

End Sub

Private Sub btoSalir_Click()

Unload Me

End Sub

Private Sub lisTabla_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
txtCorrelativo.Enabled = True
txt2.Enabled = True
txt3.Enabled = True
txt4.Enabled = True
txt5.Enabled = True
txt6.Enabled = True
txt7.Enabled = True
txt8.Enabled = True
txt9.Enabled = True
txt10.Enabled = True
txt11.Enabled = True
txt12.Enabled = True

txtCodigo.Text = lisTabla.Column(0)
txtDescripcion.Text = lisTabla.Column(1)
txtCorrelativo.Text = lisTabla.Column(2)
txt2.Text = lisTabla.Column(3)
txt3.Text = lisTabla.Column(4)
txt4.Text = lisTabla.Column(5)
txt5.Text = lisTabla.Column(6)
txt6.Text = lisTabla.Column(7)
txt7.Text = lisTabla.Column(8)
txt8.Text = lisTabla.Column(9)
txt9.Text = lisTabla.Column(10)
txt10.Text = lisTabla.Column(11)
txt11.Text = lisTabla.Column(12)
txt12.Text = lisTabla.Column(13)

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtCodigo_AfterUpdate()

For i = 3 To 24
If Hoja3.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtCodigo.Text = Hoja3.Cells(i, 1) Then
txtDescripcion.Text = Hoja3.Cells(i, 2)
txtCorrelativo.Text = Hoja3.Cells(i, 3)
txt2.Text = Hoja3.Cells(i, 4)
txt3.Text = Hoja3.Cells(i, 5)
txt4.Text = Hoja3.Cells(i, 6)
txt5.Text = Hoja3.Cells(i, 7)
txt6.Text = Hoja3.Cells(i, 8)
txt7.Text = Hoja3.Cells(i, 9)
txt8.Text = Hoja3.Cells(i, 10)
txt9.Text = Hoja3.Cells(i, 11)
txt10.Text = Hoja3.Cells(i, 12)
txt11.Text = Hoja3.Cells(i, 13)
txt12.Text = Hoja3.Cells(i, 14)

btoGuardar.Enabled = False
Exit For
End If
Next

End Sub
Private Sub btoGuardar_Click()

Application.ScreenUpdating = False

If txtCodigo.Text = "" Then
         MsgBox "Ingrese el C|fffd|digo"
         txtCodigo.SetFocus
         Exit Sub
End If

If txtDescripcion.Text = "" Then
         MsgBox "Ingrese Descripci|fffd|n"
         txtDescripcion.SetFocus
         Exit Sub
End If

    Sheets("TVOU").Activate
        nextrow = _
            Application.WorksheetFunction.CountA(Range("a:a")) + 1
    
    Cells(nextrow, 1) = txtCodigo.Text
    Cells(nextrow, 2) = UCase(txtDescripcion.Text)
    Cells(nextrow, 3) = txtCorrelativo.Text
    Cells(nextrow, 4) = txt2.Text
    Cells(nextrow, 5) = txt3.Text
    Cells(nextrow, 6) = txt4.Text
    Cells(nextrow, 7) = txt5.Text
    Cells(nextrow, 8) = txt6.Text
    Cells(nextrow, 9) = txt7.Text
    Cells(nextrow, 10) = txt8.Text
    Cells(nextrow, 11) = txt9.Text
    Cells(nextrow, 12) = txt10.Text
    Cells(nextrow, 13) = txt11.Text
    Cells(nextrow, 14) = txt12.Text
    
txtCodigo.Enabled = False
txtDescripcion.Enabled = False
txtCorrelativo.Enabled = False
txt2.Enabled = False
txt3.Enabled = False
txt4.Enabled = False
txt5.Enabled = False
txt6.Enabled = False
txt7.Enabled = False
txt8.Enabled = False
txt9.Enabled = False
txt10.Enabled = False
txt11.Enabled = False
txt12.Enabled = False

btoCancelar.Enabled = False
btoModificar.Enabled = True
btoNuevo.Enabled = True
btoGuardar.Enabled = False
btoSalir.Enabled = True

'---------------------------------------

Range("A3:n24").Select
    ActiveWorkbook.Worksheets("TVOU").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("TVOU").Sort.SortFields.Add Key:=Range("A3"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("TVOU").Sort
        .SetRange Range("A3:n24")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
'---------------------------------------
'Hoja10.Select  'panel
'Range("a1").Select

Application.ScreenUpdating = True

End Sub

Private Sub btoModificar_Click()

txtCodigo.Text = ""
txtDescripcion.Text = ""
txtCorrelativo.Text = ""
txt2.Text = ""
txt3.Text = ""
txt4.Text = ""
txt5.Text = ""
txt6.Text = ""
txt7.Text = ""
txt8.Text = ""
txt9.Text = ""
txt10.Text = ""
txt11.Text = ""
txt12.Text = ""

txtCodigo.Enabled = True
txtDescripcion.Enabled = True
txtCorrelativo.Enabled = True
txt2.Enabled = True
txt3.Enabled = True
txt4.Enabled = True
txt5.Enabled = True
txt6.Enabled = True
txt7.Enabled = True
txt8.Enabled = True
txt9.Enabled = True
txt10.Enabled = True
txt11.Enabled = True
txt12.Enabled = True

txtCodigo.SetFocus

btoNuevo.Enabled = False
btoCancelar.Enabled = True
btoModificar.Enabled = False
btoGuardar.Enabled = False
btoGuardar.Visible = False
btoGuardar1.Enabled = True
btoGuardar1.Visible = True
btoSalir.Enabled = False
btoEliminar.Enabled = True
btoEliminar.Visible = True

End Sub

Private Sub txtDescripcion_AfterUpdate()

txtDescripcion.Text = UCase(txtDescripcion.Text)

For i = 3 To 24
If Hoja3.Cells(i, 2) = "" Then
final = i - 1
Exit For
End If
Next

For i = 3 To final

If txtDescripcion.Text = Hoja3.Cells(i, 2) Then
txtCodigo.Text = Hoja3.Cells(i, 1)
txtCorrelativo.Text = Hoja3.Cells(i, 3)
txt2.Text = Hoja3.Cells(i, 4)
txt3.Text = Hoja3.Cells(i, 5)
txt4.Text = Hoja3.Cells(i, 6)
txt5.Text = Hoja3.Cells(i, 7)
txt6.Text = Hoja3.Cells(i, 8)
txt7.Text = Hoja3.Cells(i, 9)
txt8.Text = Hoja3.Cells(i, 10)
txt9.Text = Hoja3.Cells(i, 11)
txt10.Text = Hoja3.Cells(i, 12)
txt11.Text = Hoja3.Cells(i, 13)
txt12.Text = Hoja3.Cells(i, 14)

btoGuardar.Enabled = False
Exit For
End If
Next

End Sub

Private Sub UserForm_Initialize()

Hoja3.Activate
lisTabla.RowSource = "a3:N24"

End Sub
Attribute VB_Name = "Hoja1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CombMes_Click()

selecion_mes_trabajo

End Sub

Private Sub Worksheet_Activate()

End Sub


Attribute VB_Name = "Hoja10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoCerrarHoja12, 13, 1, MSForms, CommandButton"
Attribute VB_Control = "btoDModificar, 12, 2, MSForms, CommandButton"
Attribute VB_Control = "btoDNuevo, 2, 3, MSForms, CommandButton"
Attribute VB_Control = "btoDEliminar, 3, 4, MSForms, CommandButton"
Attribute VB_Control = "btoDCancelar, 4, 5, MSForms, CommandButton"
Attribute VB_Control = "btoDGuardar, 5, 6, MSForms, CommandButton"
Attribute VB_Control = "btoDDetalle, 7, 7, MSForms, CommandButton"
Attribute VB_Control = "btoDAsiento, 8, 8, MSForms, CommandButton"
Attribute VB_Control = "btoDEditar, 9, 9, MSForms, CommandButton"
Private Sub btoBGuardar_Click()

End Sub

Private Sub btoCGuardar_Click()

End Sub

Private Sub btoCerrarHoja12_Click()

Hoja12.Visible = xlSheetVeryHidden

End Sub

Private Sub btoDAsiento_Click()

FormDCuentas.Show

End Sub

Private Sub btoDCancelar_Click()

Call boton_cancelar_voudiario

End Sub

Private Sub btoDDetalle_Click()

FormDDetalle.Show

End Sub

Private Sub btoDEditar_Click()

boton_editar_voudiario

End Sub

Private Sub btoDEliminar_Click()

Application.ScreenUpdating = False

boton_eliminar_voudiario

Application.ScreenUpdating = True

End Sub

Private Sub btoDGuardar_Click()

Application.ScreenUpdating = False

boton_grabar_voudiario

Application.ScreenUpdating = True

End Sub

Private Sub btoDNuevo_Click()

boton_nuevo_voudiario

Hoja12.Range("d2") = Hoja1.Range("b5")

End Sub

Private Sub btoDModificar_Click()

Application.ScreenUpdating = False

boton_modificar_voudiario

Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Hoja13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoBusqueda, 4, 0, MSForms, CommandButton"
Attribute VB_Control = "Label1, 2, 1, MSForms, Label"
Attribute VB_Control = "cboMesConsultaDiario, 1, 2, MSForms, ComboBox"
Attribute VB_Control = "btoCerrarLibroDiario, 5, 3, MSForms, CommandButton"
Private Sub btoBusqueda_Click()

boton_consulta_diario

End Sub

Private Sub btoCerrarLibroDiario_Click()

Hoja25.Visible = xlSheetVeryHidden

End Sub

Private Sub cboMesConsultaDiario_Click()

seleccion_mes_consulta_diario

End Sub

Private Sub Worksheet_Activate()

End Sub

Attribute VB_Name = "Hoja26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoConsultaMayor, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "Label1, 2, 1, MSForms, Label"
Attribute VB_Control = "cboMesConsultaMayor, 1, 2, MSForms, ComboBox"
Attribute VB_Control = "btoCerrarLibroMayor, 4, 3, MSForms, CommandButton"
Private Sub btoCerrarLibroMayor_Click()

Hoja27.Visible = xlSheetVeryHidden

End Sub

Private Sub btoConsultaMayor_Click()

Application.ScreenUpdating = False

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Consulta Finalizada"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

boton_consulta_mayor

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

Application.ScreenUpdating = True

End Sub
Private Sub cboMesConsultaMayor_Click()

seleccion_mes_consulta_mayor

End Sub
Attribute VB_Name = "Hoja28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoConsultaHT, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "Label1, 2, 1, MSForms, Label"
Attribute VB_Control = "cboMesConsultaHT, 1, 2, MSForms, ComboBox"
Attribute VB_Control = "btoCerrarHojaTrabajo, 4, 3, MSForms, CommandButton"
Private Sub btoCerrarHojaTrabajo_Click()

Hoja28.Visible = xlSheetVeryHidden

End Sub

Private Sub btoConsultaHT_Click()

boton_consulta_ht

End Sub

Private Sub cboMesConsultaHT_Click()

seleccion_mes_consulta_ht

End Sub
Attribute VB_Name = "Hoja29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoCerrarBalance, 1, 0, MSForms, CommandButton"
Private Sub btoCerrarBalance_Click()

Hoja30.Visible = xlSheetVeryHidden

End Sub
Attribute VB_Name = "Hoja31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btoCerrarEstadoResultados, 4, 3, MSForms, CommandButton"
Private Sub btoCerrarEstadoResultados_Click()

Hoja31.Visible = xlSheetVeryHidden

End Sub
Attribute VB_Name = "Hoja32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "M|fffd|dulo1"
Sub guarda_encabezado_diario()

Application.ScreenUpdating = False

'------Guarda el encabezado de diario
    Hoja13.Activate
            nextrow = _
            Application.WorksheetFunction.CountA(Hoja13.Range("a:a")) + 1
    
    Hoja13.Cells(nextrow, 1) = Hoja12.Range("L2")
    Hoja13.Cells(nextrow, 2) = Hoja12.Range("C2")
    Hoja13.Cells(nextrow, 3) = Hoja12.Range("F2")
    Hoja13.Cells(nextrow, 4) = Hoja12.Range("H2")
    Hoja13.Cells(nextrow, 5) = Format(Hoja12.Range("C4"), "DD/MM/YYYY")
    Hoja13.Cells(nextrow, 6) = Hoja12.Range("C5")
    Hoja13.Cells(nextrow, 7) = Hoja12.Range("C6")
    Hoja13.Cells(nextrow, 8) = Hoja12.Range("H4")
    Hoja13.Cells(nextrow, 9) = Hoja12.Range("H5")
    Hoja13.Cells(nextrow, 10) = Hoja12.Range("H6")
    Hoja13.Cells(nextrow, 11) = Hoja12.Range("G9")
    Hoja13.Cells(nextrow, 12) = Hoja12.Range("C11")

Application.ScreenUpdating = True

End Sub

Sub guarda_asiento_diario()

'------Guarda el asiento de diario

Application.ScreenUpdating = False

Sheets("VOUDIARIO").Select
Range("j13").Select

Do While ActiveCell.Value <> ""
If ActiveCell.Offset(1, 0).Value = Range("L2") Then
ActiveCell.Offset(1, 0).Copy
Sheets("BDASTODIARIO").Range("a800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
ActiveCell.Offset(1, 1).Copy
Hoja23.Range("b800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
ActiveCell.Offset(1, -1).Copy
Hoja23.Range("g800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
Hoja23.Range("g800000").End(xlUp).Offset(0, 0).Style = "Comma"
ActiveCell.Offset(1, -2).Copy
Hoja23.Range("f800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
Hoja23.Range("f800000").End(xlUp).Offset(0, 0).Style = "Comma"
ActiveCell.Offset(1, -6).Copy
Hoja23.Range("e800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
ActiveCell.Offset(1, -7).Copy
Hoja23.Range("d800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
ActiveCell.Offset(1, -8).Copy
Hoja23.Range("c800000").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlValues
End If
ActiveCell.Offset(1, 0).Select
Loop
Application.CutCopyMode = False

Application.ScreenUpdating = True

End Sub

Sub guarda_numvoucher_diario()

'-----Guarda el N|fffd|mero de Voucher del Diario a la hoja tipo de voucher

    Hoja3.Activate
    FILA = Hoja12.Range("F2")
    COLUMNA = Hoja12.Range("C2") + 1
    Hoja3.Columns("A:A").Select
    Selection.Find(What:=FILA, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Offset(0, COLUMNA).Select
    ActiveCell = Hoja12.Range("H2")

End Sub
Sub ordena_data_encabezado_diario()

'-----Ordena la data del encabezado de diario

Hoja13.Activate

Hoja13.Range("A2:L500000").Select
    ActiveWorkbook.Worksheets("BDDIARIO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("BDDIARIO").Sort.SortFields.Add Key:=Range("A2"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("BDDIARIO").Sort
        .SetRange Range("A2:L500000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

End Sub
Sub ordena_data_asiento_diario()

'-----Ordena la data del asiento de diario

Hoja23.Activate

Hoja23.Range("A2:J500000").Select
    ActiveWorkbook.Worksheets("BDASTODIARIO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("BDASTODIARIO").Sort.SortFields.Add Key:=Range("A2"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("BDASTODIARIO").Sort
        .SetRange Range("A2:J500000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

End Sub

Sub borra_encabezado_diario()

'-----Ubica el registro y elimina
Hoja13.Activate

For i = 2 To 500000
If Hoja13.Cells(i, 1) = "" Then
final = i - 1
Exit For
End If
Next

For i = 2 To final
If Hoja12.Range("l2") = Hoja13.Cells(i, 1) Then
Hoja13.Cells(i, 1).Select
Selection.EntireRow.Delete
Exit For
End If
Next

End Sub
Sub borra_asiento_diario()

'---Borra asiento de diario
Hoja23.Activate
Hoja23.Range("a2").Select
'Hacemos un bucle Do While el cual se ejecutar|fffd| hasta que haya una celda vac|fffd|a
Do While ActiveCell.Value <> ""
    'La condici|fffd|n es que el c|fffd|digo sea igual al de la data
    If ActiveCell.Value = Hoja12.Range("L2") Then
        '... elimina la fila
        ActiveCell.EntireRow.Delete
        ActiveCell.Offset(-1, 0).Select
    Else
    End If
    'Recorre una fila hacia abajo
    ActiveCell.Offset(1, 0).Select
Loop

End Sub

Sub extrae_diario_mes()

Application.ScreenUpdating = False

Hoja24.Activate

If Hoja24.Cells(2, 18).Value > 0 Then

'Atrapar el codigo de la mercaderia
  wcod = Hoja24.Cells(2, 18).Value
 '-Limpiar el Rengo de Celdas del Kardex
  
  Hoja24.Range("S2:AH800000").Select
 Selection.ClearContents
    
  Hoja24.Range("S2").Select
 '-Inicializar fila del kardex
  wfmovil = 2
 '-Buscar en la  hoja REGISTRO
  For wfdata = 2 To 800000
     If Hoja23.Cells(wfdata, 2).Value = wcod Then
     '---------
     '-Mostrar
     '---------
        
         Hoja24.Cells(wfmovil, 19).Value = Hoja23.Cells(wfdata, 1).Value
         
         Hoja24.Cells(wfmovil, 20).Value = Hoja23.Cells(wfdata, 2).Value
         
         Hoja24.Cells(wfmovil, 21).Value = "=IF(ISERROR(VLOOKUP(RC[-2],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-2],BDDIARIO!R2C1:R800000C12,3,0),0)"
        
         Hoja24.Cells(wfmovil, 22).Value = "=IF(ISERROR(VLOOKUP(RC[-3],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-3],BDDIARIO!R2C1:R800000C12,4,0),0)"
                   
         Hoja24.Cells(wfmovil, 23).Value = "=IF(ISERROR(VLOOKUP(RC[-4],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-4],BDDIARIO!R2C1:R800000C12,5,0),0)"
         
         Hoja24.Cells(wfmovil, 24).Value = "=IF(ISERROR(VLOOKUP(RC[-5],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-5],BDDIARIO!R2C1:R800000C12,12,0),0)"
         
         Hoja24.Cells(wfmovil, 25).Value = "=IF(ISERROR(VLOOKUP(RC[-6],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-6],BDDIARIO!R2C1:R800000C12,6,0),0)"
         
         Hoja24.Cells(wfmovil, 26).Value = "=IF(ISERROR(VLOOKUP(RC[-7],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-7],BDDIARIO!R2C1:R800000C12,7,0),0)"
         
         Hoja24.Cells(wfmovil, 27).Value = "=IF(ISERROR(VLOOKUP(RC[-8],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-8],BDDIARIO!R2C1:R800000C12,8,0),0)"
         
         Hoja24.Cells(wfmovil, 28).Value = "=IF(ISERROR(VLOOKUP(RC[-9],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-9],BDDIARIO!R2C1:R800000C12,9,0),0)"
         
         Hoja24.Cells(wfmovil, 29).Value = "=IF(ISERROR(VLOOKUP(RC[-10],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-10],BDDIARIO!R2C1:R800000C12,10,0),0)"
         
         Hoja24.Cells(wfmovil, 30).Value = Hoja23.Cells(wfdata, 4).Value
        
         Hoja24.Cells(wfmovil, 31).Value = Hoja23.Cells(wfdata, 5).Value
        
         Hoja24.Cells(wfmovil, 32).Value = Hoja23.Cells(wfdata, 6).Value
        
         Hoja24.Cells(wfmovil, 33).Value = Hoja23.Cells(wfdata, 7).Value
         
         Hoja24.Cells(wfmovil, 34).Value = "=IF(ISERROR(VLOOKUP(RC[-15],BDDIARIO!R2C1:R800000C12,1,0))=FALSE,VLOOKUP(RC[-15],BDDIARIO!R2C1:R800000C12,11,0),0)"
            
               
       '-incrementar fila
        wfmovil = wfmovil + 1
               
      End If
 
      Next wfdata

End If


'--------Copia especial de la data para convertir las f|fffd|rmulas en datos

Hoja24.Range("S2:AH800000").Select
Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

Application.ScreenUpdating = True

End Sub
Sub extrae_diario_meses_anteriores()

'-------extrae la data del diario de los meses anteriores al mes de consulta

Application.ScreenUpdating = False


Hoja23.Range("A1:g800000").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Hoja24.Range("A1:A2"), CopyToRange:=Hoja24.Range("B1:G1"), Unique:=False


Application.ScreenUpdating = True

End Sub

Sub LIBRO_DIARIO()

Application.ScreenUpdating = False

'-----Borra los datos para reemplazarlos por la nueva consulta

Hoja25.Activate

 Hoja25.Range("A11:N800000").Select
 Selection.Borders(xlEdgeTop).LineStyle = xlNone
 Selection.Borders(xlEdgeBottom).LineStyle = xlNone
 Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
 Selection.EntireRow.Delete
 'Selection.ClearContents
  
'--------Copia los datos de la nueva consulta al diario

Hoja24.Activate

Hoja24.Range("U2:AH800000").Select
    Selection.Copy
    Sheets("LDIARIO").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'-------Formato de los datos
Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda
Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda3 As String                              'variable de la ultima celda
Dim UltCelda4 As String                              'variable de la ultima celda
Dim UltCelda5 As String                              'variable de la ultima celda
Dim UltCelda6 As String                              'variable de la ultima celda
Dim UltCelda7 As String                              'variable de la ultima celda
Dim UltCelda8 As String                              'variable de la ultima celda

UltLinea = Range("A" & Rows.Count).End(xlUp).Row   'captura el n|fffd|mero de la ultima fila con datos
UltCelda1 = "N" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda2 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda3 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda4 = "A" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda5 = "B" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range("A11", UltCelda1).Select
 Application.CutCopyMode = False
    With Selection.Font
        .Name = "Arial Narrow"
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
        .Size = 10
    End With

Range("C11", UltCelda2).Select
    Selection.NumberFormat = "m/d/yyyy"
    
Range("L11", UltCelda3).Select
    Selection.Style = "Comma"
   
'--------Ordena la data por tipo de voucher y n|fffd|mero de voucher
Range("A11", UltCelda1).Select
    ActiveWorkbook.Worksheets("LDIARIO").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("LDIARIO").Sort.SortFields.Add Key:=Range("A11", UltCelda4 _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("LDIARIO").Sort.SortFields.Add Key:=Range("B11", UltCelda5 _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("LDIARIO").Sort
        .SetRange Range("A11", UltCelda1)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
   
 Range("A1").Select
   
 '----------Se agrega los Totales, total debe y total haber
   
UltLinea = Range("A" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda6 = "K" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda7 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda8 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda6) = "TOTALES"
Range(UltCelda6).Select
Selection.Font.Bold = True

'------suma del debe
    varsuma = Range(("L10"), (UltCelda7))
    Range(UltCelda7) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda7).Select
'    Selection.Name = "Arial Narrow"
'    Selection.Size = 10
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
   
'------suma del haber
    varsuma = Range(("M10"), (UltCelda8))
    Range(UltCelda8) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda8).Select
'    Selection.Name = "Arial Narrow"
'    Selection.Size = 10
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
   
Range("A1").Select
    
Application.ScreenUpdating = True

End Sub
Sub COPIA_CUENTAS_MAYOR()

Application.ScreenUpdating = False

'---------COPIA CUENTAS |fffd|NICAS DEL DIARIO
    Hoja26.Activate
    Columns("A:A").Select
    Selection.ClearContents
    
    Hoja23.Range("D1:D800000").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Hoja26.Range( _
        "a1"), Unique:=True
        
'---------ORDENA CUENTAS |fffd|NICAS DEL DIARIO
        
    Columns("A:A").Select
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Add Key:=Range("A2") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("CONSULMAYOR").Sort
        .SetRange Range("A2:A800000")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
Application.ScreenUpdating = True

End Sub
Sub MAYORIZAR_POR_CUENTA()

Application.ScreenUpdating = False

Hoja26.Activate

fin = Range("A" & Rows.Count).End(xlUp).Row
For x = 2 To fin
Cells(x, 1).Select
Range("D2") = ActiveCell

EXTRAE_MAYOR_MES

Hoja26.Activate

Next

Application.ScreenUpdating = True

End Sub
Sub borrar_contenido_lineas_mayor()

Application.ScreenUpdating = False

Hoja26.Activate

'-----BORRAR CONTENIDO Y LINEAS

 Hoja26.Range("C4:L800000").Select
 Selection.Borders(xlEdgeTop).LineStyle = xlNone
 Selection.Borders(xlEdgeBottom).LineStyle = xlNone
 Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
 Selection.Font.Bold = False
 Selection.ClearContents
 
Application.ScreenUpdating = True

End Sub
Sub formato_cuenta_consultada_mayor()

'----FORMATO DE CONTENIDO

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda
Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda3 As String                              'variable de la ultima celda

UltLinea = Range("C" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda1 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda2 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda3 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range("C4", UltCelda1).Select
 Application.CutCopyMode = False
    With Selection.Font
        .Name = "Arial Narrow"
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
        .Size = 10
    End With

Range("C4", UltCelda2).Select
    Selection.NumberFormat = "m/d/yyyy"
    
Range("G4", UltCelda3).Select
    Selection.Style = "Comma"
    
Application.ScreenUpdating = True

End Sub

Sub ordenar_data_mayor()

Application.ScreenUpdating = False

'--------ordena la data por fecha, tipo voucher y n|fffd|mero voucher
Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda
Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda4 As String                              'variable de la ultima celda
Dim UltCelda5 As String                              'variable de la ultima celda

UltLinea = Range("C" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda1 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda2 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda4 = "D" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda5 = "E" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna


Range("C4", UltCelda1).Select
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Add Key:=Range("C4", UltCelda2 _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Add Key:=Range("D4", UltCelda4 _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("CONSULMAYOR").Sort.SortFields.Add Key:=Range("E4", UltCelda5 _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("CONSULMAYOR").Sort
        .SetRange Range("C4", UltCelda1)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

Application.ScreenUpdating = True

End Sub
Sub subtotales_cuenta_mayor()

 '-------SUBTOTALES

Application.ScreenUpdating = False
 
Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda6 As String                              'variable de la ultima celda
Dim UltCelda7 As String                              'variable de la ultima celda
Dim UltCelda8 As String                              'variable de la ultima celda

Dim UltCelda81 As String                              'variable de la ultima celda
   
   
UltLinea = Range("C" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos

UltCelda81 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda6 = "F" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda7 = "G" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda8 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda81) = "'-"

Range(UltCelda6) = "SUBTOTALES"

'------suma del debe
    varsuma = Range(("G3"), (UltCelda7))
    Range(UltCelda7) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda7).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
   
'------suma del haber
    varsuma = Range(("H3"), (UltCelda8))
    Range(UltCelda8) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda8).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

Application.ScreenUpdating = True

End Sub
Sub saldofinal_cuenta_mayor()

'-------SALDO FINAL

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda9 As String                              'variable de la ultima celda
Dim UltCelda10 As String                              'variable de la ultima celda
Dim UltCelda11 As String                              'variable de la ultima celda

Dim UltCelda82 As String                              'variable de la ultima celda

   
UltLinea = Range("F" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda82 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda9 = "F" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda10 = "G" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda11 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda82) = "'-"

Range(UltCelda9) = "SALDO FINAL"

'------SALDO DEL DEBE
    Range(UltCelda10) = "=IF(R[-1]C[1]>R[-1]C,R[-1]C[1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda10).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

'------SALDO DEL HABER
    Range(UltCelda11) = "=IF(R[-1]C[-1]>R[-1]C,R[-1]C[-1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda11).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

Application.ScreenUpdating = True

End Sub
Sub totales_cuenta_mayor()

 '-------TOTALES
 
Application.ScreenUpdating = False
 
Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltLinea1 As Long                                'variable del numero de la  ultima fila
Dim UltLinea2 As Long                                'variable del numero de la  ultima fila

Dim UltCelda7 As String                              'variable de la ultima celda
Dim UltCelda8 As String                              'variable de la ultima celda
Dim UltCelda12 As String                              'variable de la ultima celda
Dim UltCelda13 As String                              'variable de la ultima celda
Dim UltCelda14 As String                              'variable de la ultima celda

Dim UltCelda83 As String                              'variable de la ultima celda
Dim UltCelda84 As String                              'variable de la ultima celda
 
UltLinea2 = Range("C" & Rows.Count).End(xlUp).Row - 1 'captura el n|fffd|mero de la ultima fila con datos

UltCelda7 = "G" & UltLinea2                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda8 = "H" & UltLinea2                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
    
UltLinea1 = Range("F" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda83 = "C" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda12 = "F" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda13 = "G" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda14 = "H" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda83) = "'-"

Range(UltCelda12) = "TOTALES"
Range(UltCelda12).Select
Selection.Font.Bold = True
    
'------TOTAL DEBE
    varsuma = Range((UltCelda7), (UltCelda13))
    Range(UltCelda13) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda13).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
       
'------TOTAL HABER
    varsuma = Range((UltCelda8), (UltCelda14))
    Range(UltCelda14) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda14).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
    
'-------LINEA DE SEPARACION ENTRE CUENTAS CONSULTADAS
    
UltLinea = Range("C" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda84 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
    
Range(UltCelda84) = "'-"


Application.ScreenUpdating = True

End Sub

Sub copiar_cuenta_consultada_limpia_a_mayor()

'---------COPIAR CUENTA MAYORIZADA

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda85 As String                              'variable de la ultima celda


    UltLinea = Range("C" & Rows.Count).End(xlUp).Row 'captura el n|fffd|mero de la ultima fila con datos
    UltCelda85 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

    Range(("C2"), (UltCelda85)).Select
    'Range("C2:L20000").Select
    Selection.Copy

    Hoja27.Activate
        
    UltLinea = Range("A" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
    UltCelda = "A" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
    Range(UltCelda).Select
       
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    
Application.ScreenUpdating = True

End Sub

Sub EXTRAE_MAYOR_MES()

Application.ScreenUpdating = False


borrar_contenido_lineas_mayor
 
 
 '------------------------

If Hoja26.Cells(2, 4).Value > 0 Then

'Atrapar el codigo de la mercaderia
  wcod = Hoja26.Cells(2, 4).Value
 '-Limpiar el Rengo de Celdas del Kardex
  Hoja26.Range("C4:L10000").Select
  Selection.ClearContents
    
  Hoja26.Range("C4").Select
 '-Inicializar fila del REGISTRO
  wfmovil = 4
 '-Buscar en la  hoja REGISTRO
  For wfdata = 2 To 800000
     If Hoja24.Cells(wfdata, 30).Value = wcod Then
     '---------
     '-Mostrar
     '---------
        
         Hoja26.Cells(wfmovil, 3).Value = Hoja24.Cells(wfdata, 23).Value
         
         Hoja26.Cells(wfmovil, 4).Value = Hoja24.Cells(wfdata, 21).Value
         
         Hoja26.Cells(wfmovil, 5).Value = Hoja24.Cells(wfdata, 22).Value
         
         Hoja26.Cells(wfmovil, 6).Value = Hoja24.Cells(wfdata, 24).Value
         
         Hoja26.Cells(wfmovil, 7).Value = Hoja24.Cells(wfdata, 32).Value
         
         Hoja26.Cells(wfmovil, 8).Value = Hoja24.Cells(wfdata, 33).Value
         
         Hoja26.Cells(wfmovil, 9).Value = Hoja24.Cells(wfdata, 34).Value
         
         Hoja26.Cells(wfmovil, 10).Value = Hoja24.Cells(wfdata, 27).Value
         
         Hoja26.Cells(wfmovil, 11).Value = Hoja24.Cells(wfdata, 28).Value
         
         Hoja26.Cells(wfmovil, 12).Value = Hoja24.Cells(wfdata, 29).Value
                        
       '-incrementar fila
        wfmovil = wfmovil + 1
               
      End If
 
      Next wfdata

End If

'------rutina

formato_cuenta_consultada_mayor
 
ordenar_data_mayor
     
subtotales_cuenta_mayor
   
saldofinal_cuenta_mayor
    
totales_cuenta_mayor
      
copiar_cuenta_consultada_limpia_a_mayor

 
Range("A1").Select


Application.ScreenUpdating = True

End Sub
Sub extrae_ht()

'-------extrae la data del diario de los meses anteriores al mes de consulta

Application.ScreenUpdating = False


Hoja23.Range("A1:g800000").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Hoja29.Range("A1:A2"), CopyToRange:=Hoja29.Range("B1:G1"), Unique:=False


Application.ScreenUpdating = True

End Sub
Sub COPIA_CUENTAS_HT()

Application.ScreenUpdating = False

'---------COPIA CUENTAS |fffd|NICAS DEL DIARIO
    'Hoja28.Activate
    'Hoja28.Range("A7:A20000").Select
    'Selection.ClearContents
    
    'Hoja29.Range("D1:D800000").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Hoja28.Range _
        ("B7"), Unique:=True
            
    '----elimina el titulo
    'Hoja28.Activate
    'Rows("7:7").Select
    'Selection.Delete Shift:=xlUp
    
    Hoja29.Activate
    Hoja29.Range("D2:D800000").Select
    Selection.Copy
    Sheets("HT").Select
    Range("B7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    Range("B7:B800000").Select
    ActiveSheet.Range("$B$7:$B$800000").RemoveDuplicates Columns:=1, Header:=xlNo


'---------ORDENA CUENTAS |fffd|NICAS DEL DIARIO
        
    Hoja28.Activate
    Hoja28.Range("B7:B20000").Select
    ActiveWorkbook.Worksheets("HT").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("HT").Sort.SortFields.Add Key:=Range("B7") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("HT").Sort
        .SetRange Range("B7:B20000")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
Application.ScreenUpdating = True

End Sub
Sub nombre_cuenta_ht()

'---busca el nombre de la cuenta
Hoja28.Activate
Hoja28.Range("B7").Select
'Hacemos un bucle Do While el cual se ejecutar|fffd| hasta que haya una celda vac|fffd|a
Do While ActiveCell.Value <> ""
    'La condici|fffd|n es que exista una cuenta
    If ActiveCell.Value > 0 Then
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = _
        "=IF(ISERROR(VLOOKUP(RC[-1],TPC!R4C2:R3502C6,1,0))=FALSE,VLOOKUP(RC[-1],TPC!R4C2:R3502C6,2,0),0)"
        
        ActiveCell.Offset(0, -2).Select
        ActiveCell.FormulaR1C1 = _
        "=IF(ISERROR(VLOOKUP(RC[1],TPC!R4C2:R3502C6,1,0))=FALSE,VLOOKUP(RC[1],TPC!R4C2:R3502C6,5,0),0)"
        
        ActiveCell.Offset(0, 3).Select
        ActiveCell.FormulaR1C1 = "=SUMIF(CONSULHT!C,HT!RC[-2],CONSULHT!C[2])"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=SUMIF(CONSULHT!C[-1],HT!RC[-3],CONSULHT!C[2])"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(RC[-2]>RC[-1],RC[-2]-RC[-1],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(RC[-2]>RC[-3],RC[-2]-RC[-3],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(RC[-7]=1,RC[-2],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(RC[-8]=1,RC[-2],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(OR(RC[-9]=3,RC[-9]=4),RC[-4],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(OR(RC[-10]=3,RC[-10]=4),RC[-4],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(OR(RC[-11]=2,RC[-11]=4),RC[-6],0)"
        
        ActiveCell.Offset(0, 1).Select
        ActiveCell.FormulaR1C1 = "=IF(OR(RC[-12]=2,RC[-12]=4),RC[-6],0)"
        
        ActiveCell.Offset(0, 3).Select
        ActiveCell.FormulaR1C1 = "=MID(RC[-14],1,2)"
        
        '----regresa a la fila
        ActiveCell.Offset(0, -14).Select
    Else
    End If
    'Recorre una fila hacia abajo
    ActiveCell.Offset(1, 0).Select
Loop

End Sub
Sub formato_ht()

'----FORMATO DE CONTENIDO

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda
'Dim UltCelda2 As String                              'variable de la ultima celda
'Dim UltCelda3 As String                              'variable de la ultima celda

UltLinea = Range("B" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda1 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
'UltCelda2 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
'UltCelda3 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range("B7", UltCelda1).Select
 Application.CutCopyMode = False
    With Selection.Font
        .Name = "Arial Narrow"
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
        .Size = 10
    End With

Range("D7", UltCelda1).Select
    Selection.Style = "Comma"
       
Application.ScreenUpdating = True

End Sub
Sub copiar_formulas_comodatos_ht()

'-----Copia las formulas como datos

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda

UltLinea = Range("B" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda1 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range("A7", UltCelda1).Select
Selection.Copy
    Range("A7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

Application.ScreenUpdating = True

End Sub

Sub borrar_consulta_ht()

    Hoja28.Rows("7:10000").Select
    Selection.Delete shift:=xlUp

End Sub

Sub subtotales_ht()

 '-------SUBTOTALES

Application.ScreenUpdating = False
 
Dim UltLinea As Long                                'variable del numero de la  ultima fila

Dim UltCelda1 As String                              'variable de la ultima celda

Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda3 As String                              'variable de la ultima celda
Dim UltCelda4 As String                              'variable de la ultima celda
Dim UltCelda5 As String                              'variable de la ultima celda
Dim UltCelda6 As String                              'variable de la ultima celda
Dim UltCelda7 As String                              'variable de la ultima celda
Dim UltCelda8 As String                              'variable de la ultima celda
Dim UltCelda9 As String                              'variable de la ultima celda
Dim UltCelda10 As String                              'variable de la ultima celda
Dim UltCelda11 As String                              'variable de la ultima celda

Dim UltCelda12 As String                              'variable de la ultima celda
   
   
UltLinea = Range("B" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos

UltCelda12 = "B" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda1 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda2 = "D" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda3 = "E" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda4 = "F" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda5 = "G" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda6 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda7 = "I" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda8 = "J" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda9 = "K" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda10 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda11 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda12) = "'-"

Range(UltCelda1) = "SUBTOTALES"

'------suma del debe
    varsuma = Range(("D7"), (UltCelda2))
    Range(UltCelda2) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda2).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
   
'------suma del haber
    varsuma = Range(("E7"), (UltCelda3))
    Range(UltCelda3) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda3).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    
'------suma del saldo debe
    varsuma = Range(("F7"), (UltCelda4))
    Range(UltCelda4) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda4).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

'------suma del saldo haber
    varsuma = Range(("G7"), (UltCelda5))
    Range(UltCelda5) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda5).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

'------suma del activo
    varsuma = Range(("H7"), (UltCelda6))
    Range(UltCelda6) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda6).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    
'------suma del pasivo
    varsuma = Range(("I7"), (UltCelda7))
    Range(UltCelda7) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda7).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    
'------suma perdida funcion
    varsuma = Range(("J7"), (UltCelda8))
    Range(UltCelda8) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda8).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    
'------suma ganancia funcion
    varsuma = Range(("K7"), (UltCelda9))
    Range(UltCelda9) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda9).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

'------suma perdida naturaleza
    varsuma = Range(("L7"), (UltCelda10))
    Range(UltCelda10) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda10).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

'------suma ganancia naturaleza
    varsuma = Range(("M7"), (UltCelda11))
    Range(UltCelda11) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda11).Select
    Selection.Style = "Comma"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous

Application.ScreenUpdating = True

End Sub

Sub saldofinal_ht()

'-------SALDO FINAL

Application.ScreenUpdating = False

Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltCelda1 As String                              'variable de la ultima celda

Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda3 As String                              'variable de la ultima celda
Dim UltCelda4 As String                              'variable de la ultima celda
Dim UltCelda5 As String                              'variable de la ultima celda
Dim UltCelda6 As String                              'variable de la ultima celda
Dim UltCelda7 As String                              'variable de la ultima celda

Dim UltCelda8 As String                              'variable de la ultima celda

   
UltLinea = Range("B" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda8 = "B" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda1 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda2 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda3 = "I" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda4 = "J" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda5 = "K" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda6 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda7 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda8) = "'-"

Range(UltCelda1) = "SALDOS"

'------SALDO DEL ACTIVO
    Range(UltCelda2) = "=IF(R[-1]C[1]>R[-1]C,R[-1]C[1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda2).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

'------SALDO DEL PASIVO
    Range(UltCelda3) = "=IF(R[-1]C[-1]>R[-1]C,R[-1]C[-1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda3).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    
'------SALDO PERDIDA FUNCION
    Range(UltCelda4) = "=IF(R[-1]C[1]>R[-1]C,R[-1]C[1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda4).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

'------SALDO GANANCIA FUNCION
    Range(UltCelda5) = "=IF(R[-1]C[-1]>R[-1]C,R[-1]C[-1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda5).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous
    
'------SALDO PERDIDA NATURALEZA
    Range(UltCelda6) = "=IF(R[-1]C[1]>R[-1]C,R[-1]C[1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda6).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

'------SALDO GANANCIA NATURALEZA
    Range(UltCelda7) = "=IF(R[-1]C[-1]>R[-1]C,R[-1]C[-1]-R[-1]C,0)"
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda7).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlContinuous

Application.ScreenUpdating = True

End Sub
Sub totales_ht()

 '-------TOTALES
 
Application.ScreenUpdating = False
 
Dim UltLinea As Long                                'variable del numero de la  ultima fila
Dim UltLinea1 As Long                                'variable del numero de la  ultima fila
'Dim UltLinea2 As Long                                'variable del numero de la  ultima fila

Dim UltCelda1 As String                              'variable de la ultima celda
Dim UltCelda2 As String                              'variable de la ultima celda
Dim UltCelda3 As String                              'variable de la ultima celda
Dim UltCelda4 As String                              'variable de la ultima celda
Dim UltCelda5 As String                              'variable de la ultima celda
Dim UltCelda6 As String                              'variable de la ultima celda

Dim UltCelda7 As String                              'variable de la ultima celda
Dim UltCelda8 As String                              'variable de la ultima celda
Dim UltCelda9 As String                              'variable de la ultima celda
Dim UltCelda10 As String                              'variable de la ultima celda
Dim UltCelda11 As String                              'variable de la ultima celda
Dim UltCelda12 As String                              'variable de la ultima celda

Dim UltCelda50 As String                              'variable de la ultima celda
Dim UltCelda51 As String                              'variable de la ultima celda
 
UltLinea1 = Range("G" & Rows.Count).End(xlUp).Row  'captura el n|fffd|mero de la ultima fila con datos

UltCelda1 = "H" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda2 = "I" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda3 = "J" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda4 = "K" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda5 = "L" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda6 = "M" & UltLinea1                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
    
UltLinea = Range("B" & Rows.Count).End(xlUp).Row + 1 'captura el n|fffd|mero de la ultima fila con datos
UltCelda50 = "B" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda51 = "C" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

UltCelda7 = "H" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda8 = "I" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda9 = "J" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda10 = "K" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda11 = "L" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna
UltCelda12 = "M" & UltLinea                           'muestra el n|fffd|mero de la ultima fila con su letra de columna

Range(UltCelda50) = "'-"

Range(UltCelda51) = "TOTALES"
Range(UltCelda51).Select
Selection.Font.Bold = True
    
    
'------TOTAL ACTIVO
    varsuma = Range((UltCelda1), (UltCelda7))
    Range(UltCelda7) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda7).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
       
'------TOTAL PASIVO
    varsuma = Range((UltCelda2), (UltCelda8))
    Range(UltCelda8) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda8).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
    
'------TOTAL PERDIDA FUNCION
    varsuma = Range((UltCelda3), (UltCelda9))
    Range(UltCelda9) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda9).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
       
'------TOTAL GANANCIA FUNCION
    varsuma = Range((UltCelda4), (UltCelda10))
    Range(UltCelda10) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda10).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble

'------TOTAL PERDIDA NATURALEZA
    varsuma = Range((UltCelda5), (UltCelda11))
    Range(UltCelda11) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda11).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
       
'------TOTAL GANANCIA NATURALEZA
    varsuma = Range((UltCelda6), (UltCelda12))
    Range(UltCelda12) = Application.WorksheetFunction.Sum(varsuma)
    '------Poner en negrita y l|fffd|neas
    Range(UltCelda12).Select
    Selection.Style = "Comma"
    Selection.Font.Bold = True
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
  
Application.ScreenUpdating = True

End Sub
Sub borrar_data()

Application.ScreenUpdating = False


Dim Mensaje, Estilo, T|fffd|tulo, Respuesta
  
Mensaje = "Est|fffd| seguro de borrar los datos?"

Estilo = vbYesNo + vbCritical
  
T|fffd|tulo = "Borrar Datos"

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

 If Respuesta = vbYes Then   ' El usuario eligi|fffd| el bot|fffd|n S|fffd|.

  

'-----Borra data de encabezado y detalle diario para ingresar nueva informaci|fffd|n

    Hoja13.Activate
    Hoja13.Rows("2:900000").Select
    Selection.Delete shift:=xlUp
    
    Hoja23.Activate
    Hoja23.Rows("2:900000").Select
    Selection.Delete shift:=xlUp

Else   ' El usuario eligi|fffd| el bot|fffd|n No.

  
End If

Application.ScreenUpdating = True

End Sub

Sub ultimo()

Range("b14").End(xlDown).Select
'Selection.End(xlDown).Select

End Sub
Attribute VB_Name = "M|fffd|dulo2"
Sub menu_contabilidad()

'-------CREAR MENU

Dim NewMenu As CommandBarPopup

'   Eliminar el men|fffd|,si existe
    Call Delete_menu_contabilidad
    
'   Encontrar el men|fffd| Ayuda
    Set HelpMenu = CommandBars(1).FindControl(ID:=30010)
    
    If HelpMenu Is Nothing Then
'       A|fffd|adir el men|fffd| al final
        Set NewMenu = CommandBars(1).Controls.Add _
          (Type:=msoControlPopup, _
           temporary:=True)
    Else
'      A|fffd|adir el men|fffd| antes de la Ayuda
        Set NewMenu = CommandBars(1).Controls.Add _
          (Type:=msoControlPopup, _
           Before:=HelpMenu.index, _
           temporary:=True)
    End If


'-----NOMBRE DEL MENU GENERAL

'A|fffd|adir un t|fffd|tulo al men|fffd|
    NewMenu.Caption = "Contabilidad"
    'a|fffd|adir control menu

'----NOMBRES DE LOS SUBMENU DEL MENU


'------------EMPRESA
    
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlButton)
    With MenuItem
        .Caption = "Empresa"
'        .FaceId = 162
'        .ShortcutText = "ctrl+mayus+F"
        .OnAction = "formulario_empresa"
        .BeginGroup = True
    End With
    
'------------TABLAS
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlPopup)
    With MenuItem
        .Caption = "Tablas"
    End With

        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Tipo de Vouchers"
            '.FaceId = 584
            .OnAction = "formulario_tipo_vouchers"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Tipo de Comprobantes"
            '.FaceId = 584
            .OnAction = "formulario_tipo_comprobantes"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Tipo de Documentos"
            '.FaceId = 584
            .OnAction = "formulario_tipo_documentos"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Tipo de Libros"
            '.FaceId = 584
            .OnAction = "formulario_tipo_libros"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Plan de Cuentas"
            '.FaceId = 584
            .OnAction = "formulario_plan_cuentas"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Entidad Clientes"
            '.FaceId = 584
            .OnAction = "formulario_entidad_clientes"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Entidad Proveedores"
            '.FaceId = 584
            .OnAction = "formulario_entidad_proveedores"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Entidad Otros"
            '.FaceId = 584
            .OnAction = "formulario_entidad_otros"
        End With
                       
'------------VOUCHERS
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlPopup)
    With MenuItem
        .Caption = "Vouchers"
        '.FaceId = 162
        '.ShortcutText = "ctrl+mayus+F"
        '.OnAction = "startwizard"
        '.BeginGroup = True
    End With
    
    Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Diario"
            '.FaceId = 584
            .OnAction = "hoja_voudiario"
        End With
          
'------------LIBROS
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlPopup)
    With MenuItem
        .Caption = "Libros"
    End With
    
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Diario"
            '.FaceId = 584
            .OnAction = "hoja_libro_diario"
        End With
    
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Mayor"
            '.FaceId = 584
            .OnAction = "hoja_libro_mayor"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Hoja de Trabajo"
            '.FaceId = 584
            .OnAction = "hoja_libro_trabajo"
        End With
        
    
'------------ESTADOS FINANCIEROS
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlPopup)
    With MenuItem
        .Caption = "EE. FF."
    End With
    
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Balance"
            '.FaceId = 584
            .OnAction = "hoja_balance"
        End With
        
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Resultados"
            '.FaceId = 584
            .OnAction = "hoja_resultados"
        End With
    
'------------UTILITARIOS
Set MenuItem = NewMenu.Controls.Add _
      (Type:=msoControlPopup)
    With MenuItem
        .Caption = "Utiltarios"
    End With
    
        Set SubMenuItem = MenuItem.Controls.Add _
          (Type:=msoControlButton)
        With SubMenuItem
            .Caption = "Reiniciar Base de Datos"
            '.FaceId = 584
            .OnAction = "borrar_bd_diario"
        End With
    
End Sub

Sub Delete_menu_contabilidad()

    On Error Resume Next
    CommandBars(1).Controls("Contabilidad").Delete
    
End Sub
Sub formulario_empresa()

FormEmpresa.Show

End Sub
Sub formulario_tipo_vouchers()

FormTVouchers.Show

End Sub
Sub formulario_tipo_comprobantes()

FormTComprob.Show

End Sub
Sub formulario_tipo_documentos()

FormTDocum.Show

End Sub
Sub formulario_tipo_libros()

FormTLibros.Show

End Sub
Sub formulario_plan_cuentas()

FormTPlancuentas.Show

End Sub
Sub formulario_entidad_clientes()

FormTClientes.Show

End Sub
Sub formulario_entidad_proveedores()

FormTProveedores.Show

End Sub
Sub formulario_entidad_otros()

FormTOtros.Show

End Sub
Sub hoja_voudiario()

Hoja12.Visible = xlSheetVisible
Hoja12.Activate

End Sub
Sub hoja_libro_diario()

Hoja25.Visible = xlSheetVisible
Hoja25.Activate

End Sub
Sub hoja_libro_mayor()

Hoja27.Visible = xlSheetVisible
Hoja27.Activate

End Sub
Sub hoja_libro_trabajo()

Hoja28.Visible = xlSheetVisible
Hoja28.Activate

End Sub
Sub hoja_balance()

Hoja30.Visible = xlSheetVisible
Hoja30.Activate

End Sub
Sub hoja_resultados()

Hoja31.Visible = xlSheetVisible
Hoja31.Activate

End Sub
Sub borrar_bd_diario()

borrar_data

End Sub


Sub selecion_mes_trabajo()

Select Case Hoja1.CombMes.Text
    Case "ENERO"
    Range("B5") = 1
    Case "FEBRERO"
    Range("B5") = 2
    Case "MARZO"
    Range("B5") = 3
    Case "ABRIL"
    Range("B5") = 4
    Case "MAYO"
    Range("B5") = 5
    Case "JUNIO"
    Range("B5") = 6
    Case "JULIO"
    Range("B5") = 7
    Case "AGOSTO"
    Range("B5") = 8
    Case "SEPTIEMBRE"
    Range("B5") = 9
    Case "OCTUBRE"
    Range("B5") = 10
    Case "NOVIEMBRE"
    Range("B5") = 11
    Case "DICIEMBRE"
    Range("B5") = 12
End Select

End Sub

Sub seleccion_mes_consulta_diario()

Select Case Hoja25.cboMesConsultaDiario.Text
    Case "ENERO"
    Hoja24.Range("R2") = 1
    Hoja24.Range("A2") = "<1"
    Case "FEBRERO"
    Hoja24.Range("R2") = 2
    Hoja24.Range("A2") = "<2"
    Case "MARZO"
    Hoja24.Range("R2") = 3
    Hoja24.Range("A2") = "<3"
    Case "ABRIL"
    Hoja24.Range("R2") = 4
    Hoja24.Range("A2") = "<4"
    Case "MAYO"
    Hoja24.Range("R2") = 5
    Hoja24.Range("A2") = "<5"
    Case "JUNIO"
    Hoja24.Range("R2") = 6
    Hoja24.Range("A2") = "<6"
    Case "JULIO"
    Hoja24.Range("R2") = 7
    Hoja24.Range("A2") = "<7"
    Case "AGOSTO"
    Hoja24.Range("R2") = 8
    Hoja24.Range("A2") = "<8"
    Case "SEPTIEMBRE"
    Hoja24.Range("R2") = 9
    Hoja24.Range("A2") = "<9"
    Case "OCTUBRE"
    Hoja24.Range("R2") = 10
    Hoja24.Range("A2") = "<10"
    Case "NOVIEMBRE"
    Hoja24.Range("R2") = 11
    Hoja24.Range("A2") = "<11"
    Case "DICIEMBRE"
    Hoja24.Range("R2") = 12
    Hoja24.Range("A2") = "<12"
End Select

End Sub

Sub seleccion_mes_consulta_mayor()

Application.ScreenUpdating = False

'------selecciona el mes de consulta del mayor

Select Case Hoja27.cboMesConsultaMayor.Text
    Case "ENERO"
    Hoja24.Range("R2") = 1
    Hoja24.Range("A2") = "<1"
    Case "FEBRERO"
    Hoja24.Range("R2") = 2
    Hoja24.Range("A2") = "<2"
    Case "MARZO"
    Hoja24.Range("R2") = 3
    Hoja24.Range("A2") = "<3"
    Case "ABRIL"
    Hoja24.Range("R2") = 4
    Hoja24.Range("A2") = "<4"
    Case "MAYO"
    Hoja24.Range("R2") = 5
    Hoja24.Range("A2") = "<5"
    Case "JUNIO"
    Hoja24.Range("R2") = 6
    Hoja24.Range("A2") = "<6"
    Case "JULIO"
    Hoja24.Range("R2") = 7
    Hoja24.Range("A2") = "<7"
    Case "AGOSTO"
    Hoja24.Range("R2") = 8
    Hoja24.Range("A2") = "<8"
    Case "SEPTIEMBRE"
    Hoja24.Range("R2") = 9
    Hoja24.Range("A2") = "<9"
    Case "OCTUBRE"
    Hoja24.Range("R2") = 10
    Hoja24.Range("A2") = "<10"
    Case "NOVIEMBRE"
    Hoja24.Range("R2") = 11
    Hoja24.Range("A2") = "<11"
    Case "DICIEMBRE"
    Hoja24.Range("R2") = 12
    Hoja24.Range("A2") = "<12"
End Select

'------rutinas

extrae_diario_mes

extrae_diario_meses_anteriores



Hoja27.Activate

Hoja27.Range("A1").Select

Application.ScreenUpdating = True

End Sub

Sub seleccion_mes_consulta_ht()

Application.ScreenUpdating = False

'------selecciona el mes de consulta del mayor

Select Case Hoja28.cboMesConsultaHT.Text
    Case "ENERO"
    Hoja29.Range("A2") = "<2"
    Case "FEBRERO"
    Hoja29.Range("A2") = "<3"
    Case "MARZO"
    Hoja29.Range("A2") = "<4"
    Case "ABRIL"
    Hoja29.Range("A2") = "<5"
    Case "MAYO"
    Hoja29.Range("A2") = "<6"
    Case "JUNIO"
    Hoja29.Range("A2") = "<7"
    Case "JULIO"
    Hoja29.Range("A2") = "<8"
    Case "AGOSTO"
    Hoja29.Range("A2") = "<9"
    Case "SEPTIEMBRE"
    Hoja29.Range("A2") = "<10"
    Case "OCTUBRE"
    Hoja29.Range("A2") = "<11"
    Case "NOVIEMBRE"
    Hoja29.Range("A2") = "<12"
    Case "DICIEMBRE"
    Hoja29.Range("A2") = "<13"
End Select

'------rutinas

extrae_ht



Hoja28.Activate

Hoja28.Range("A1").Select

Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "M|fffd|dulo3"
'---CODIGO DE LA HOJA VOUDIARIO (HOJA12)

Sub boton_cancelar_voudiario()

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Registro Cancelado"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

'-----Estado de botones

Hoja12.btoDNuevo.Enabled = True
Hoja12.btoDCancelar.Enabled = False
Hoja12.btoDEditar.Enabled = True

Hoja12.btoDGuardar.Visible = True
Hoja12.btoDGuardar.Enabled = False

Hoja12.btoDModificar.Enabled = False
Hoja12.btoDModificar.Visible = False

Hoja12.btoDNuevo.Visible = True
Hoja12.btoDEditar.Visible = True

'Hoja12.btoCGuardar.Enabled = False
'Hoja12.btoBGuardar.Enabled = False
Hoja12.btoDEliminar.Enabled = False
Hoja12.btoDDetalle.Enabled = False
Hoja12.btoDAsiento.Enabled = False

Hoja12.btoDDetalle.Visible = False
Hoja12.btoDAsiento.Visible = False

'---------Borrar contenido de celdas
Hoja12.Range("C2:D2,F2,C4,H2:H6,C5:D6,C8:D9,G8:H9,C11,B14:K500").Select
Selection.ClearContents

'------------seleciona celda
Range("c2").Select

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

End Sub

Sub boton_editar_voudiario()

'-----Estado de botones
Hoja12.btoDNuevo.Enabled = False
Hoja12.btoDCancelar.Enabled = True
Hoja12.btoDEditar.Enabled = False

Hoja12.btoDNuevo.Visible = False
Hoja12.btoDEditar.Visible = False

Hoja12.btoDGuardar.Enabled = False
Hoja12.btoDGuardar.Visible = False

Hoja12.btoDModificar.Visible = True
Hoja12.btoDModificar.Enabled = True

'Hoja12.btoCGuardar.Enabled = True
'Hoja12.btoBGuardar.Enabled = True
Hoja12.btoDEliminar.Enabled = True

Hoja12.btoDDetalle.Visible = True
Hoja12.btoDAsiento.Visible = True

Hoja12.btoDDetalle.Enabled = True
Hoja12.btoDAsiento.Enabled = True

'---------Borrar contenido de celdas

Hoja12.Range("C2:D2,F2,C4,H2:H6,C5:D6,C8:D9,G8:H9,C11,B14:K500").Select
Selection.ClearContents

'------Copia f|fffd|rmula en celda
Hoja12.Range("h2") = "=IF(AND(RC[-5]>0,RC[-2]>0),INDEX(TVOU!R[1]C[-6]:R[22]C[6],MATCH(RC[-2],TVOU!R[1]C[-7]:R[22]C[-7],0),MATCH(RC[-5],TVOU!RC[-6]:RC[6],0)),0)+1"

Hoja12.Range("a1").Select

'-----llama al formulario
FormDDetalle.Show

End Sub

Sub boton_eliminar_voudiario()

Application.ScreenUpdating = False

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Registro Eliminado"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

'-------rutinas

borra_encabezado_diario

borra_asiento_diario


'-----Estado de botones
Hoja12.btoDNuevo.Visible = True
Hoja12.btoDNuevo.Enabled = True

Hoja12.btoDCancelar.Enabled = False

Hoja12.btoDEditar.Visible = True
Hoja12.btoDEditar.Enabled = True

Hoja12.btoDGuardar.Visible = True
Hoja12.btoDGuardar.Enabled = False

Hoja12.btoDModificar.Enabled = False
Hoja12.btoDModificar.Visible = False

'Hoja12.btoCGuardar.Enabled = False
'Hoja12.btoBGuardar.Enabled = False
Hoja12.btoDEliminar.Enabled = False
Hoja12.btoDDetalle.Enabled = False
Hoja12.btoDAsiento.Enabled = False

Hoja12.btoDDetalle.Visible = False
Hoja12.btoDAsiento.Visible = False

Hoja12.Activate

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

Application.ScreenUpdating = True

End Sub

Sub boton_grabar_voudiario()

Application.ScreenUpdating = False

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Registro Guardado"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

'-------Valida datos
If Hoja12.Range("c2") = "" Then
         MsgBox "Ingrese el Mes"
         Hoja12.Range("c2").Select
         Exit Sub
End If
If Hoja12.Range("f2") = "" Then
         MsgBox "Ingrese el Tipo de Voucher"
         Hoja12.Range("f2").Select
         Exit Sub
End If
If Hoja12.Range("c4") = "" Then
         MsgBox "Ingrese la Fecha de la operaci|fffd|n"
         Hoja12.Range("c4").Select
         Exit Sub
End If
If Hoja12.Range("c11") = "" Then
         MsgBox "Ingrese la Glosa"
         Hoja12.Range("c11").Select
         Exit Sub
End If

'---------Rutinas

guarda_encabezado_diario
    
guarda_asiento_diario
            
guarda_numvoucher_diario
    
ordena_data_encabezado_diario

Hoja12.Activate

'-----Estado de botones
Hoja12.btoDNuevo.Visible = True
Hoja12.btoDNuevo.Enabled = True
Hoja12.btoDCancelar.Enabled = False

Hoja12.btoDEditar.Visible = True
Hoja12.btoDEditar.Enabled = True

Hoja12.btoDGuardar.Visible = True
Hoja12.btoDGuardar.Enabled = False

Hoja12.btoDModificar.Enabled = False
Hoja12.btoDModificar.Visible = False

'Hoja12.btoCGuardar.Enabled = False
'Hoja12.btoBGuardar.Enabled = False
Hoja12.btoDEliminar.Enabled = False



Hoja12.btoDDetalle.Enabled = False
Hoja12.btoDAsiento.Enabled = False

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

Application.ScreenUpdating = True

End Sub

Sub boton_nuevo_voudiario()

'-----Estado de botones
Hoja12.btoDNuevo.Enabled = False
Hoja12.btoDCancelar.Enabled = True
Hoja12.btoDEditar.Enabled = False

Hoja12.btoDGuardar.Visible = True
Hoja12.btoDGuardar.Enabled = True

Hoja12.btoDModificar.Enabled = False
Hoja12.btoDModificar.Visible = False

Hoja12.btoDNuevo.Visible = False
Hoja12.btoDEditar.Visible = False
'Hoja12.btoCGuardar.Enabled = True
'Hoja12.btoBGuardar.Enabled = True
Hoja12.btoDEliminar.Enabled = False

Hoja12.btoDDetalle.Visible = True
Hoja12.btoDAsiento.Visible = True

Hoja12.btoDDetalle.Enabled = True
Hoja12.btoDAsiento.Enabled = True

'---------Borrar contenido de celdas

Hoja12.Range("C2:D2,F2,C4,H2:H6,C5:D6,C8:D9,G8:H9,C11,B14:K500").Select
Selection.ClearContents

'------Copia f|fffd|rmula en celda
Hoja12.Range("h2") = "=IF(AND(RC[-5]>0,RC[-2]>0),INDEX(TVOU!R[1]C[-6]:R[22]C[6],MATCH(RC[-2],TVOU!R[1]C[-7]:R[22]C[-7],0),MATCH(RC[-5],TVOU!RC[-6]:RC[6],0)),0)+1"

End Sub

Sub boton_modificar_voudiario()

Application.ScreenUpdating = False

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Registro Modificado"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

'---------rutinas

borra_encabezado_diario

borra_asiento_diario

'-------Valida datos
If Hoja12.Range("c2") = "" Then
         MsgBox "Ingrese el Mes"
         Hoja12.Range("c2").Select
         Exit Sub
End If
If Hoja12.Range("f2") = "" Then
         MsgBox "Ingrese el Tipo de Voucher"
         Hoja12.Range("f2").Select
         Exit Sub
End If
If Hoja12.Range("c4") = "" Then
         MsgBox "Ingrese la Fecha de la operaci|fffd|n"
         Hoja12.Range("c4").Select
         Exit Sub
End If
If Hoja12.Range("c11") = "" Then
         MsgBox "Ingrese la Glosa"
         Hoja12.Range("c11").Select
         Exit Sub
End If

'---------rutinas

guarda_encabezado_diario

guarda_asiento_diario

ordena_data_encabezado_diario

ordena_data_asiento_diario

'-----Estado de botones
Hoja12.btoDNuevo.Visible = True
Hoja12.btoDNuevo.Enabled = True

Hoja12.btoDCancelar.Enabled = False

Hoja12.btoDEditar.Visible = True
Hoja12.btoDEditar.Enabled = True

Hoja12.btoDGuardar.Visible = True
Hoja12.btoDGuardar.Enabled = False

Hoja12.btoDModificar.Enabled = False
Hoja12.btoDModificar.Visible = False

'Hoja12.btoCGuardar.Enabled = False
'Hoja12.btoBGuardar.Enabled = False
Hoja12.btoDEliminar.Enabled = False
Hoja12.btoDDetalle.Enabled = False
Hoja12.btoDAsiento.Enabled = False

Hoja12.Activate

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "M|fffd|dulo4"
'---CODIGO DE LA HOJA LDIARIO (HOJA25)

Sub boton_consulta_diario()

Application.ScreenUpdating = False

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Consulta Finalizada"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.

extrae_diario_mes

extrae_diario_meses_anteriores

LIBRO_DIARIO

Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "M|fffd|dulo5"
'---CODIGO DE LA HOJA LMAYOR (HOJA27)

Sub boton_consulta_mayor()

Application.ScreenUpdating = False

'-----BORRAR CONTENIDO Y LINEAS DEL MAYOR
Hoja27.Range("A9:J800000").Select
Selection.Borders(xlEdgeTop).LineStyle = xlNone
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
Selection.EntireRow.Delete
'Selection.ClearContents

'-----rutinas

COPIA_CUENTAS_MAYOR

MAYORIZAR_POR_CUENTA

'EXTRAE_MAYOR_MES

'----Borra formtado de busqueda de la hoja 26 CONSULMAYOR
Hoja26.Activate
    Hoja26.Rows("10:800000").Select
    Hoja26.Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete shift:=xlUp



Hoja27.Activate
    Hoja27.Range("a1").Select

Application.ScreenUpdating = True


End Sub
Attribute VB_Name = "M|fffd|dulo6"
'---CODIGO DE LA HOJA HT (HOJA28)

Sub boton_consulta_ht()

'--------Mensaje
Dim Mensaje, Estilo, T|fffd|tulo, Ctxt
Mensaje = "Consulta Finalizada"    ' Define el mensaje.
Estilo = vbInformation    ' Define los botones.
T|fffd|tulo = "Mensaje"    ' Define el t|fffd|tulo.



borrar_consulta_ht

COPIA_CUENTAS_HT

nombre_cuenta_ht

formato_ht

copiar_formulas_comodatos_ht

subtotales_ht

saldofinal_ht

totales_ht


Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo)

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

'Application.StatusBar = "Hecho por www.archivoexcel.com"

Call menu_contabilidad

End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)

Call Delete_menu_contabilidad

End Sub



INQUEST-PP=macro
