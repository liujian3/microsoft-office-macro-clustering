Attribute VB_Name = "CallUpdate"
Public Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal Milliseconds As LongPtr)

Public Sub Call_UpdateNow()
Application.ScreenUpdating = False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
    'Worksheets("Valid Codes").Range("A2") = "1/1/2015"
    Call Call_Update
End Sub

Public Sub Call_Update()
Application.ScreenUpdating = False
    Dim wb As Workbook
    Dim wbm As Workbook
    Dim Update_Success As Boolean
    
    'Save Inital States
    Dim i_EnableEvents As Boolean
    Dim i_ScreenUpdating As Boolean
    Dim i_DisplayAlerts As Boolean
    Dim i_Calculation As Variant
    Sheets("Valid Codes").Select
'ActiveSheet.Unprotect Password:="re"
    i_EnableEvents = Application.EnableEvents
    i_ScreenUpdating = Application.ScreenUpdating
    i_DisplayAlerts = Application.DisplayAlerts
    i_Calculation = Application.Calculation
    Sheets("Vars").Visible = True
    'Set source workbook
    Set wb = ThisWorkbook
    
    'Load Variables
    Dim MasterURL As Range
    Dim updaterURL As Range
    Dim ScrptStartWait As Range
    Dim ScrptEndWait As Range
    Set MasterURL = wb.Worksheets("Vars").Range("MasterURL")
    Set updaterURL = wb.Worksheets("Vars").Range("updaterURL")
    Set ScrptStartWait = wb.Worksheets("Vars").Range("ScrptStartWait")
    Set ScrptEndWait = wb.Worksheets("Vars").Range("ScrptEndWait")
    
    'Set States
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    Application.Calculation = xlManual
    
    'wb.Worksheets("Valid Codes").Range("A3").Value = ""
On Error GoTo acsdned

Set wbm = Workbooks.Open(MasterURL.Text)
acd = 1
acsdned:
If acd <> 1 Then
sPath = "https://proj.extsp.ford.com/sites/eMIXQDAS/Shared Documents/Gauge Supplier - Providing the information for Programming/Valid Codes K2001-K2002"


    Dim IE As Object
'Set IE = CreateObject("InternetExplorer.Application")
retVal = Shell("explorer.exe " & sPath, vbNormalFocus)
'IE.Navigate sPath
'On Error GoTo acs
'Set wbm = Workbooks.Open(MasterURL.Text)
'sue = 1
End If


'Set objShell = CreateObject("Wscript.Shell")
'objShell.Run ("taskkill /im iexplore.exe"), 3, True

    'Stewart's SharePoint   https://mysite.sp.ford.com/personal/seddy4/Master_Database_Test/QDAS K Field Master List.xlsm
If acd = 1 Then
   ans = ActiveWorkbook.Name
    Workbooks(ans).Activate
    Sheets("Valid Codes").Select
    Cells.Select
    Selection.Copy
    ThisWorkbook.Activate
    Sheets("Valid Codes").Select
    Cells.Select
    ActiveSheet.Paste
    'Sheets("Valid Codes").Select
    Range("AC11").Select
    Selection.End(xlDown).Select
    lt1 = Selection.Row + 1
    Range("AC" & lt1 & ":AC5000").ClearContents
     Range("B8:AC5000").Select
    On Error Resume Next
  Selection.Replace what:=",", Replacement:=";", _
    LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
    SearchFormat:=False, ReplaceFormat:=False
    Range("A1").Select
    Range("A1").Select
    Application.CutCopyMode = False
    Sheets("CMM K-Field Naming Template").Select
    Range("A1").Select
    Workbooks(ans).Activate
    ActiveWorkbook.Close
    ThisWorkbook.Activate
    MsgBox "Valid Codes has been updated"
End If
    'Set IE = New InternetExplorerMedium
    'IE.Quit
    '----
    If acd <> 1 Then
Set objShell = CreateObject("Wscript.Shell")
objShell.Run ("taskkill /im iexplore.exe"), 0, True
End If
'----

ThisWorkbook.Activate
Sheets("Vars").Visible = xlVeryHidden
Sheets("CMM K-Field Naming Template").Select
Range("A1").Select
cmm114 = Environ("Username")
cmm115 = LCase(cmm114)
If cmm115 <> "seddy4" And cmm115 <> "rengel7" And cmm115 <> "jokroy" And cmm115 <> "apraba" And cmm115 <> "svarre" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
Sheets("Valid Codes").Select
Worksheets("Valid Codes").Range("A2") = Now()
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("Valid Codes").Select
Worksheets("Valid Codes").Range("A2") = Now()
ActiveSheet.Unprotect Password:="re"
End If
acs:
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
HardReset = True
    
    If HardReset Then
        Call Reset_Status
    Else
        Application.EnableEvents = i_EnableEvents
        Application.ScreenUpdating = i_ScreenUpdating
        Application.DisplayAlerts = i_DisplayAlerts
        Application.Calculation = i_Calculation
    End If
    
Exit Sub
End Sub

Sub Reset_Status()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Application.Calculation = xlCalculationAutomatic
End Sub
Attribute VB_Name = "MenuSearch_Subs"
Public Sub DDList(Tcell As String)
    Dim myRange As Range
    Select Case Range(Tcell).Column
        Case 2
            'Cant use "Jlist" because named ranges with formulas cannot be set as a VBA range
            'Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("Jlist")
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("H2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("H10:H" & listLen)
        Case 3
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("B2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("B10:B" & listLen)
        Case 5
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("W2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("W10:W" & listLen)
        Case 6
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("P2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("P10:P" & listLen)
        Case 7
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("S2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("S10:S" & listLen)
        Case 9
            listLen = ThisWorkbook.Sheets("Valid Codes").Range("AC2").Value
            Set myRange = ThisWorkbook.Sheets("Valid Codes").Range("AC11:AC" & listLen)
        Case Other
            
    End Select
    
    form = Lsort(Range(Tcell).Value, myRange)
    
    ThisWorkbook.Sheets("CMM K-Field Naming Template").Unprotect Password:="re"
    ThisWorkbook.Sheets("CMM K-Field Naming Template").Range(Tcell).Validation.Modify Formula1:=form
    ThisWorkbook.Sheets("CMM K-Field Naming Template").Protect Password:="re", DrawingObjects:=False
    
End Sub

Public Function Lsort(mySort As String, myRange As Range) As String
    
    Dim rng1 As Range
    Dim rng2 As Range
    Dim cell As Range
    
    Dim parse As String
    parse = ","
    
    Dim myStr As String
    Dim myStr1 As String
    Dim myStr2 As String
    
    Dim i1 As Integer
    Dim i2 As Integer
    i1 = 0
    i2 = 0
    
    For Each cell In myRange
        
        If InStr(LCase(cell.Text), LCase(mySort)) > 0 Or i1 = 0 And cell.Text = "" Then
            i1 = i1 + 1
                myStr1 = myStr1 & parse & cell.Text
        ElseIf InStr(LCase(cell.Text), LCase(mySort)) = 0 And cell.Text <> "" Then
            i2 = i2 + 1
                myStr2 = myStr2 & parse & cell.Text
        End If
    Next cell
    
    myStr = myStr1
    
    If i2 > 0 Then
        myStr = myStr & parse & "-----" & myStr2
    End If
    'MsgBox rng1.Address
    
    Lsort = myStr
    
End Function

Public Sub ResetDropDown()
    'This Sub will reset all menu lists to their defaults
    
    Dim form As String
    Dim col As String
    
    Dim Acols(0 To 5) As String
    Acols(0) = "B" '=Jlist
    Acols(1) = "C" '=BList
    Acols(2) = "E" '=ZList
    Acols(3) = "F" '=RList
    Acols(4) = "G" '=UList
    Acols(5) = "I" '=AGlist
    
    Dim Aform(0 To 5) As String
    Aform(0) = "=Jlist"
    Aform(1) = "=BList"
    Aform(2) = "=ZList"
    Aform(3) = "=RList"
    Aform(4) = "=UList"
    Aform(5) = "=AGlist"
    
    minR = 8
    maxR = 5007
    On Error Resume Next
    For i = 0 To 5
        col = Acols(i)
        form = Aform(i)
        With ThisWorkbook.Sheets("CMM K-Field Naming Template").Range(col & minR & ":" & col & maxR).Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=form
            .IgnoreBlank = False
            .InCellDropdown = True
            .InputTitle = ""
            .ErrorTitle = ""
            .InputMessage = ""
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
    Next i
End Sub

Attribute VB_Name = "Module1"
Public strfile
Sub Rectangle16_Click()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Unprotect Password:="re"
nam = Range("I5").Value
nam1 = Range("N4").Value
nam2 = Range("N5").Value
rww = Range("B5007").End(xlUp).Row
For Each sd In Range("L8:L" & rww)
If sd <> "" Then
If sd.Offset(0, 0).Value = "REF 0" Or sd.Offset(0, 0).Value = "0" Then
sd.Offset(0, 0).Value = "0"
End If
If sd.Offset(0, 0).Value = "OTH 1" Or sd.Offset(0, 0).Value = "1" Then
sd.Offset(0, 0).Value = "1"
End If
If sd.Offset(0, 0).Value = "HI/SO 2" Or sd.Offset(0, 0).Value = "2" Then
sd.Offset(0, 0).Value = "2"
End If
If sd.Offset(0, 0).Value = "SC 3" Or sd.Offset(0, 0).Value = "3" Then
sd.Offset(0, 0).Value = "3"
End If
If sd.Offset(0, 0).Value = "CC 4" Or sd.Offset(0, 0).Value = "4" Then
sd.Offset(0, 0).Value = "4"
End If
End If
Next
'rww1 = Range("F5008").End(xlUp).Row
For Each sd1 In Range("M6:M" & rww)
If sd1 <> "" Then
If sd1.Offset(0, 0).Value = "0 None" Or sd1.Offset(0, 0).Value = "0" Then
sd1.Offset(0, 0).Value = "0"
End If
If sd1.Offset(0, 0).Value = "1 Ascending" Or sd1.Offset(0, 0).Value = "1" Then
sd1.Offset(0, 0).Value = "1"
End If
If sd1.Offset(0, 0).Value = "2 Descending" Or sd1.Offset(0, 0).Value = "2" Then
sd1.Offset(0, 0).Value = "2"
End If
End If
Next
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
Workbooks.Add
ot = ActiveWorkbook.Name
Workbooks(ot).Activate
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
'ot1 = ActiveSheet.UsedRange.Rows.Count + 100
'cmm88 = Range("I3").Value

'If cmm88 <> "Select Q-das Attributes" Then
'
''K2001 Output
'If cmm88 = "K2001 Output" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:K5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_k2001number"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''K2005 Class
'If cmm88 = "K2005 Class" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("L8:L5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_k2005class"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''2015 Tool Wear
'If cmm88 = "2015 Tool Wear" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("M8:M5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_K2015ToolWear"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''2093 Best-Fit Group
'If cmm88 = "2093 Best-Fit Group" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("N8:N5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_K2093BestFit"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''K2116 Lower Warning Limit
'If cmm88 = "K2116 Lower Warning Limit" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("O8:O5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_K2116LowerWarningLimit"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''K2117 Upper Warning Limit
'If cmm88 = "K2117 Upper Warning Limit" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("P8:P5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_K2117UpperWarningLimit"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If
'
''K2311 Tool Number
'If cmm88 = "K2311 Tool Number" Then
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("J8:J5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("A2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Application.CutCopyMode = False
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("Q8:Q5007").Select
'Selection.Copy
'Workbooks(ot).Activate
'Range("B2").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
'        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_K2311ToolNumber"
'ThisWorkbook.Activate
'Application.CutCopyMode = False
'Workbooks(ot).Activate
'End If

'All K Fields Attributes
'If cmm88 = "All K Fields Attributes" Then
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("J8:Q5007").Select
Selection.Copy
Workbooks(ot).Activate
Range("A2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Range("A1").Value = "Identifier"
Range("B1").Value = "u_k2001number"
Range("C1").Value = "u_K2005class"
Range("D1").Value = "u_K2015ToolWear"
Range("E1").Value = "u_K2093BestFit"
Range("F1").Value = "u_K2116LowerWarningLimit"
Range("G1").Value = "u_K2117UpperWarningLimit"
Range("H1").Value = "u_K2311ToolNumber"
Application.CutCopyMode = False
'End If

Range("A1").Select

 vaa = 0
 time123 = Format(Time, "HH.MMAM/PM")
 date123 = Format(Date, "DD-MMM-YY")
    InitFile = "CMM and Variable Gauge Q-DAS K-Field_" & nam & "_" & nam1 & "_" & nam2 & "_" & date123 & "_" & time123 '<~~ You can set Default name here
   
    Set fd = Application.FileDialog(msoFileDialogSaveAs)
With fd
.InitialFileName = InitFile
.FilterIndex = 11
.Show

End With
cln1 = 0
On Error GoTo cancl
strPath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)
cln1 = 1
'ActiveWorkbook.SaveAs strPath
'On Error GoTo cancelled
    'Ret = Application.GetSaveAsFilename(InitialFileName:=InitFile, _
                                        fileFilter:="Excel Files (*.xlsx), *.xlsx", _
                                        FilterIndex:=1, _
                                        Title:="Save As")
'Ret = Application.GetSaveAsFilename(InitialFileName:=InitFile)
'intChoice = Application.FileDialog(msoFileDialogSaveAs).Show
''AX = 0
' 'If ax = 1 Then
' 'On Error GoTo Err1
' 'End If
' 'Dim strpath As Object
' On Error GoTo cancelled
' dntcal = 0
'    strpath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)

  sfile = Split(strPath, "\")(UBound(Split(strPath, "\")))
  ssfile = Left(sfile, Len(sfile) - 0)
'    wb.SaveAs strpath & "\" & Range("A5").Value & ".xlsx"
strfile = Left(strPath, Len(strPath) - Len(sfile))
'cancelled:
       'write strfile values and apply conditional formatting for last two columns
cancl:
If cln1 <> 1 Then
 MsgBox "Save has been Cancelled"
 ActiveWorkbook.Close
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("A1").Select
cmm1101 = Environ("UserName")
cmm1111 = LCase(cmm1101)
If cmm1111 <> "seddy4" And cmm1111 <> "rengel7" And cmm1111 <> "jokroy" And cmm1111 <> "svarre" And cmm1111 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A7").Select
 dntcal = 1
 End If
If dntcal <> 1 Then
Call txtwrite(ssfile)
End If
For Each sd In Range("L8:L" & rww)
If sd <> "" Then
If sd.Offset(0, 0).Value = "REF 0" Or sd.Offset(0, 0).Value = "0" Then
sd.Offset(0, 0).Value = "REF 0"
End If
If sd.Offset(0, 0).Value = "OTH 1" Or sd.Offset(0, 0).Value = "1" Then
sd.Offset(0, 0).Value = "OTH 1"
End If
If sd.Offset(0, 0).Value = "HI/SO 2" Or sd.Offset(0, 0).Value = "2" Then
sd.Offset(0, 0).Value = "HI/SO 2"
End If
If sd.Offset(0, 0).Value = "SC 3" Or sd.Offset(0, 0).Value = "3" Then
sd.Offset(0, 0).Value = "SC 3"
End If
If sd.Offset(0, 0).Value = "CC 4" Or sd.Offset(0, 0).Value = "4" Then
sd.Offset(0, 0).Value = "CC 4"
End If
End If
Next
'rww1 = Range("F5008").End(xlUp).Row
For Each sd1 In Range("M6:M" & rww)
If sd1 <> "" Then
If sd1.Offset(0, 0).Value = "0 None" Or sd1.Offset(0, 0).Value = "0" Then
sd1.Offset(0, 0).Value = "0 None"
End If
If sd1.Offset(0, 0).Value = "1 Ascending" Or sd1.Offset(0, 0).Value = "1" Then
sd1.Offset(0, 0).Value = "1 Ascending"
End If
If sd1.Offset(0, 0).Value = "2 Descending" Or sd1.Offset(0, 0).Value = "2" Then
sd1.Offset(0, 0).Value = "2 Descending"
End If
End If
Next
'Else
'Workbooks(ot).Activate
'ActiveWorkbook.Close
'ThisWorkbook.Activate
'Sheets("CMM K-Field Naming Template").Select
'Range("A1").Select
'cmm1102 = Environ("UserName")
'cmm1112 = LCase(cmm1102)
'If cmm1112 <> "seddy4" And cmm1112 <> "rengel7" And cmm1112 <> "jokroy" Then
''And cmm98 <> "skhanapu"
''cmm98 <> "apraba" And
'Sheets("CMM K-Field Naming Template").Select
'ActiveSheet.Range("I3").Locked = False
'ActiveSheet.Range("B8:I5008").Locked = False
'ActiveSheet.Range("L8:Q5008").Locked = False
'ActiveSheet.Range("A4:W5").Locked = False
'ActiveSheet.Protect Password:="re"
'Sheets("Valid Codes").Select
'ActiveSheet.Range("B5:AN5000").Locked = True
'ActiveSheet.Protect Password:="re"
'Else
'Sheets("CMM K-Field Naming Template").Select
'ActiveSheet.Range("I3").Locked = False
'ActiveSheet.Range("B8:I5008").Locked = False
'ActiveSheet.Range("L8:Q5008").Locked = False
'ActiveSheet.Range("A4:W5").Locked = False
'ActiveSheet.Protect Password:="re"
'Sheets("Valid Codes").Select
'ActiveSheet.Unprotect Password:="re"
'End If
'Sheets("CMM K-Field Naming Template").Select
'Range("A7").Select
'MsgBox "Please Select Q-das Attributes to proceed with Export Calypso Attributes"
'End If
End Sub

Sub txtwrite(ssfile)
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Dim FilePath As String
Dim CellData As String
Dim LastCol As Long
Dim LastRow As Long

LastCol = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Column
LastRow = Range("A65536").End(xlUp).Row
FilePath = strfile & ssfile & ".txt"
Open FilePath For Output As #2
'celldata =
For i = 1 To LastRow

For j = 1 To LastCol

If j = LastCol Then

CellData = CellData + Trim(ActiveCell(i, j).Value)

Else

CellData = CellData + Trim(ActiveCell(i, j).Value) & vbTab

End If

Next j

Print #2, CellData
CellData = ""

Next i

Close #2
ActiveWorkbook.Close
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("A1").Select
cmm110 = Environ("UserName")
cmm111 = LCase(cmm10)
If cmm111 <> "seddy4" And cmm111 <> "rengel7" And cmm111 <> "jokroy" And cmm111 <> "svarre" And cmm111 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A1").Select
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub
Attribute VB_Name = "Module2"
Sub K2002Output_Click()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Application.Calculation = xlCalculationManual
Sheets("CMM K-Field Naming Template").Select
If Range("I5").Value <> "" And Range("N4").Value <> "" And Range("N5").Value <> "" Then
If Len(Trim(Range("N4").Value)) = 2 Then
Range("N4").Value = "0" & Trim(Range("N4").Value)
End If
If Len(Trim(Range("N4").Value)) = 1 Then
MsgBox ("Please enter a valid Operation Number")
GoTo finl
End If
'If Range("N4").Value <> "" Then
'If Range("N5").Value <> "" Then

ActiveSheet.Unprotect Password:="re"
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
Sheets("Valid Codes - Copy").Visible = True
Sheets("Calculation").Visible = True
Sheets("CMM K-Field Naming Template").Select
Range("J8:K5500").ClearContents
Range("V8:W5500").ClearContents
Sheets("Calculation").Select
Rows("2:10000").Select
Selection.ClearContents

lastrw1 = 0
Sheets("CMM K-Field Naming Template").Select
rw = Range("B5008").End(xlUp).Row
If rw > 7 Then
If Range("C3").Value <> "All Other" Then
'For Each rw1 In Range("B8:G" & rw)
'If rw1 = "" Then
'lastrw1 = 1
'rw1.Select
'GoTo lastrw
'End If
'Next
'Else
For Each ry In Range("B8:C" & rw)
If ry = "" Then
lastrw1 = 1
'rw1.Select
GoTo lastrw
End If
Next
For Each rz In Range("E8:G" & rw)
If rz = "" Then
lastrw1 = 1
'rw1.Select
GoTo lastrw
End If
Next
End If
End If
If rw <> 7 Then
'K2002 Word 1
Sheets("CMM K-Field Naming Template").Select
cmm2 = ActiveSheet.UsedRange.Rows.Count
Range("B" & cmm2 + 10).Select
Selection.End(xlUp).Select
cmm3 = Selection.Row
err1 = 0
If cmm3 > 7 Then
Range("B8:B" & cmm3).Select
Selection.Copy
Sheets("Calculation").Select
Range("A2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
cmm4 = ActiveSheet.UsedRange.Rows.Count
Range("A" & cmm4 + 10).Select
Selection.End(xlUp).Select
cmm5 = Selection.Row
For Each cmm14 In Range("A2:A" & cmm5)
If cmm14 <> "" Then
Sheets("Valid Codes").Select
Range("H10:H10000").Select

On Error GoTo err1

Selection.Find(what:=cmm14, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
err1 = 1
ActiveCell.Offset(0, -2).Select
cmm6 = Trim(Selection.Value)
'K2001, Word 3
ActiveCell.Offset(0, 1).Select
cmm61 = Trim(Selection.Value)
'-------------
Sheets("Calculation").Select
cmm14.Offset(0, 1).Value = cmm6
'K2001, Word 3
cmm14.Offset(0, 19).Value = cmm61
'-------------
End If
Next
End If

'K2002 Word 2
Sheets("CMM K-Field Naming Template").Select
cmm7 = ActiveSheet.UsedRange.Rows.Count
Range("C" & cmm7 + 10).Select
Selection.End(xlUp).Select
cmm8 = Selection.Row
If cmm8 > 7 Then
Range("C8:C" & cmm8).Select
Selection.Copy
Sheets("Calculation").Select
Range("C2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
'------------n


'K2002 Word 2
Sheets("Calculation").Select
cmm9 = ActiveSheet.UsedRange.Rows.Count
Range("C" & cmm9 + 10).Select
Selection.End(xlUp).Select
cmm10 = Selection.Row
For Each cmm11 In Range("C2:C" & cmm10)
If cmm11 <> "" Then
Sheets("Valid Codes").Select
Range("B10:B10000").Select
Selection.Find(what:=cmm11, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
ActiveCell.Offset(0, 2).Select
cmm12 = Trim(Selection.Value)
'K2002 Word 3 - Letter 1
ActiveCell.Offset(0, -1).Select
cmm13 = Trim(Selection.Value)
'------------
'K2001, Word 1
cmm62 = cmm13
'-------------
'K2002 Word 3 - Letter 1
Sheets("Calculation").Select
cmm11.Offset(0, 1).Value = cmm12
'-------------
'K2001 Word 1
cmm11.Offset(0, 15).Select
Selection.Value = cmm62
'-------------
'K2002 Word 3 Letter 1
cmm11.Offset(0, 3).Select
cmm11.Offset(0, 3).Value = cmm13
'-------------

End If
Next
End If
'K2002 Word 3 Letter 2
Sheets("CMM K-Field Naming Template").Select
Range("D" & cmm7 + 10).Select
Selection.End(xlUp).Select
cmm15 = Selection.Row
If cmm15 > 7 Then
Range("D8:D" & cmm15).Select
Selection.Copy
Sheets("Calculation").Select
Range("G2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
cmm970 = ActiveSheet.UsedRange.Count
Range("G" & cmm970 + 10).Select
Selection.End(xlUp).Select
cmm971 = Selection.Row
Dim g1 As String
Dim g2 As String
g1 = "-00"
g2 = "-0"
'For cmm972 = 2 To cmm971
'' To add - or 0
'If Len(Range("G" & cmm972)) = 1 Then
'Range("G" & cmm972) = g1 & Range("G" & cmm972)
'cmm973 = 1
'Else
'If Len(Range("G" & cmm972)) = 2 Then
'Range("G" & cmm972) = g2 & Range("G" & cmm972)
'Else
'If Len(Range("G" & cmm972)) = 3 Then
'Range("G" & cmm972) = "-" & Range("G" & cmm972)
'Else
'If Len(Range("G" & cmm972)) = 4 Then
'Range("G" & cmm972) = Range("G" & cmm972)
'End If
'End If
'End If
'End If
'Next
'K2001 Word 2
Range("G2:G" & cmm971).Select
Selection.Copy
Range("S2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
For cmm972 = 2 To cmm971
' To add - or 0
If Len(Range("S" & cmm972)) = 1 Then
Range("S" & cmm972) = g1 & Range("S" & cmm972)
cmm973 = 1
Else
If Len(Range("S" & cmm972)) = 2 Then
Range("S" & cmm972) = g2 & Range("S" & cmm972)
Else
If Len(Range("S" & cmm972)) = 3 Then
Range("S" & cmm972) = "-" & Range("S" & cmm972)
Else
If Len(Range("S" & cmm972)) = 4 Then
Range("S" & cmm972) = Range("S" & cmm972)
End If
End If
End If
End If
Next
End If
'-------------
'K2002 Word 3
Sheets("Calculation").Select
cmm990 = ActiveSheet.UsedRange.Count
Range("E" & cmm990).Select
Selection.End(xlUp).Select
cmm9990 = Selection.Row
'If cmm9990 > 1 Then
For Each cmm992 In Range("E2:E" & cmm990)
Sheets("CMM K-Field Naming Template").Select
'If Range("C3").Value = "All Other" Then
Sheets("Calculation").Select
'cmm992.Offset(0, 0).Value = Trim(cmm992.Offset(0, 1).Value) & Trim(cmm992.Offset(0, 2).Value)
'If cmm992.Offset(0, -4).Value = "" Then
'Exit For
'End If
'Else
'Sheets("Calculation").Select
cmm992.Offset(0, 0).Value = Trim(cmm992.Offset(0, 2).Value)
If cmm992.Offset(0, -4).Value = "" Then
Exit For
End If
'End If
Next
'End If
'End If


'K2002 Word 4
Sheets("CMM K-Field Naming Template").Select
cmm16 = ActiveSheet.UsedRange.Rows.Count
Range("E" & cmm16 + 10).Select
Selection.End(xlUp).Select
cmm17 = Selection.Row
If cmm17 > 7 Then
Range("E8:E" & cmm17).Select
Selection.Copy
Sheets("Calculation").Select
Range("H2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
cmm18 = ActiveSheet.UsedRange.Rows.Count
Range("H" & cmm18 + 10).Select
Selection.End(xlUp).Select
cmm19 = Selection.Row
For Each cmm20 In Range("H2:H" & cmm19)
If cmm20 <> "No location" Then
Sheets("Valid Codes").Select
Range("W10:W10000").Select
Selection.Find(what:=cmm20, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
ActiveCell.Offset(0, -2).Select
cmm21 = Trim(Selection.Value)
'K2001 Word 5
ActiveCell.Offset(0, 1).Select
cmm68 = Trim(Selection.Value)
'-------------
'K2002 Word 4
Sheets("Calculation").Select
cmm20.Offset(0, 1).Value = cmm21
'-------------
'K2001 Word 5
cmm20.Offset(0, 14).Value = cmm68
End If
Next
End If
'K2002 Word 5 Letter 1
Sheets("CMM K-Field Naming Template").Select
cmm22 = ActiveSheet.UsedRange.Rows.Count
Range("F" & cmm22 + 10).Select
Selection.End(xlUp).Select
cmm23 = Selection.Row
If cmm23 > 7 Then
Range("F8:F" & cmm23).Select
Selection.Copy
Sheets("Calculation").Select
Range("J2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
cmm24 = ActiveSheet.UsedRange.Rows.Count
Range("J" & cmm24 + 10).Select
Selection.End(xlUp).Select
cmm25 = Selection.Row
For Each cmm26 In Range("J2:J" & cmm25)
If cmm26 <> "" Then
Sheets("Valid Codes").Select
Range("P10:P10000").Select
Selection.Find(what:=cmm26, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
ActiveCell.Offset(0, -2).Select
cmm27 = Trim(Selection.Value)
'K2001 Word 4
ActiveCell.Offset(0, 1).Select
cmm65 = Trim(Selection.Value)
'-------------
'K2002 Word 5 Letter 1
Sheets("Calculation").Select
cmm26.Offset(0, 2).Value = cmm27
'K2001 Word 4
cmm26.Offset(0, 11).Value = cmm65
End If
Next
End If
'K2002 Word 5 Letter 2
Sheets("CMM K-Field Naming Template").Select
cmm35 = ActiveSheet.UsedRange.Rows.Count
Range("G" & cmm35 + 10).Select
Selection.End(xlUp).Select
cmm36 = Selection.Row
If cmm36 > 7 Then
Range("G8:G" & cmm36).Select
Selection.Copy
Sheets("Calculation").Select
Range("M2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
Sheets("Calculation").Select
cmm28 = ActiveSheet.UsedRange.Rows.Count
Range("M" & cmm28 + 10).Select
Selection.End(xlUp).Select
cmm29 = Selection.Row
For Each cmm30 In Range("M2:M" & cmm29)
If cmm30 <> "" Then
Sheets("Valid Codes").Select
Range("S10:S10000").Select
Selection.Find(what:=cmm30, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
ActiveCell.Offset(0, -1).Select
cmm31 = Trim(Selection.Value)
Sheets("Calculation").Select
cmm30.Offset(0, 1).Value = cmm31
End If
Next
End If
Sheets("Calculation").Select
cmm32 = ActiveSheet.UsedRange.Rows.Count
Range("J" & cmm32 + 10).Select
Selection.End(xlUp).Select
cmm33 = Selection.Row
If cmm33 > 1 Then
For Each cmm34 In Range("J2:J" & cmm33)
cmm34.Offset(0, 1).Value = Trim(cmm34.Offset(0, 2).Value) & Trim(cmm34.Offset(0, 4).Value)
Next
End If
'K2002 Word 6
Sheets("CMM K-Field Naming Template").Select
cmm37 = ActiveSheet.UsedRange.Rows.Count
Range("H" & cmm37 + 10).Select
Selection.End(xlUp).Select
cmm38 = Selection.Row
If cmm38 > 7 Then
Range("H8:H" & cmm38).Select
Selection.Copy
Sheets("Calculation").Select
Range("O2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
cmm42 = ActiveSheet.UsedRange.Rows.Count
Range("O" & cmm42 + 10).Select
Selection.End(xlUp).Select
cmm43 = Selection.Row
For Each cmm44 In Range("O2:O" & cmm43)
cmm44.Offset(0, 0).Value = UCase(cmm44.Offset(0, 0).Value)
cmm44.Offset(0, 0).Value = Trim(cmm44.Offset(0, 0).Value)
Next
Range("O2:O" & cmm43).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("H8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
'Range("A1").Select
End If
'K2002 Word 7
Sheets("CMM K-Field Naming Template").Select
cmm80 = ActiveSheet.UsedRange.Rows.Count
Range("I" & cmm80 + 10).Select
Selection.End(xlUp).Select
cmm81 = Selection.Row
If cmm81 > 7 Then
Range("I8:I" & cmm81).Select
Selection.Copy
Sheets("Calculation").Select
Range("P2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
cmm82 = ActiveSheet.UsedRange.Rows.Count
Range("P" & cmm82 + 10).Select
Selection.End(xlUp).Select
cmm83 = Selection.Row
For Each cmm84 In Range("P2:P" & cmm83)
If cmm84 <> "" Then
Sheets("Valid Codes").Select
Range("AC11:AC10000").Select
Selection.Find(what:=cmm84, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Activate
cmm1201 = Trim(ActiveCell.Offset(0, -1).Value)
Sheets("Calculation").Select
cmm84.Offset(0, 0).Value = cmm1201
cmm84.Offset(0, 0).Value = UCase(cmm84.Offset(0, 0).Value)
End If
Next
'Range("P2:P" & cmm83).Select
'Selection.Copy
'Sheets("CMM K-Field Naming Template").Select
'Range("I8").Select
'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
'Application.CutCopyMode = False
'Range("A1").Select
End If
'K2002 Value
Sheets("Calculation").Select
cmm50 = ActiveSheet.UsedRange.Rows.Count
For Each K2002 In Range("Q2:Q" & cmm50)
K2002.Select
cmm39 = Selection.Row
If Range("A" & cmm39).Value = "" Then
Exit For
End If
Selection.End(xlUp).Select
'If Range("B" & cmm39).Value & Range("D" & cmm39).Value & Range("E" & cmm39).Value & Range("I" & cmm39).Value & Range("K" & cmm50).Value & Range("O" & cmm50).Value = "" Then
'Exit For
'End If
If Range("B" & cmm39).Value <> "" Then
sa = " "
Else
sa8 = ""
End If
If Range("D" & cmm39) <> "" Then
sa1 = " "
Else
sa1 = ""
End If
If Range("E" & cmm39) <> "" Then
sa2 = " "
Else
sa2 = ""
End If
If Range("I" & cmm39) <> "" Then
sa3 = " "
Else
sa3 = ""
End If
If Range("K" & cmm39) <> "" Then
sa4 = " "
Else
sa4 = ""
End If
If Range("O" & cmm39) <> "" Then
sa5 = " "
Else
sa5 = ""
End If
If Range("Q" & cmm39).Offset(0, -12).Value = "" Then
If Range("Q" & cmm39).Offset(0, -11).Value <> "" Or Range("Q" & cmm39).Offset(0, -10).Value <> "" Then
Range("Q" & cmm39).Offset(0, -12).Select
Range("Q" & cmm39).Offset(0, -12).Value = Range("Q" & cmm39).Offset(0, -11).Value & Range("Q" & cmm39).Offset(0, -10).Value
If Range("C3").Value <> "All Other" And Range("Q" & cmm39).Offset(0, -10).Value = "" Then
Range("Q" & cmm39).Offset(0, -12).Value = ""
End If
End If
End If
If Range("Q" & cmm39).Offset(0, -15).Value <> "" Then
'Sheets("CMM K-Field Naming Template").Select
'If Range("C3").Value = "All Other" Then
'Sheets("Calculation").Select
'K2002.Offset(0, 0).Value = K2002.Offset(0, -15).Value & sa & K2002.Offset(0, -13).Value & sa1 & K2002.Offset(0, -12).Value & sa2 & K2002.Offset(0, -8).Value & sa3 & K2002.Offset(0, -6).Value & sa4 & K2002.Offset(0, -2).Value & sa5 & K2002.Offset(0, -1).Value
'K2002.Offset(0, 0).Value = Trim(K2002.Offset(0, 0).Value)
''ani = Trim(K2002.Offset(0, 0).Value)
'K2002.Offset(0, 7).Value = Len(K2002.Offset(0, 0).Value)
'If K2002.Offset(0, 7).Value = "0" Then
'K2002.Offset(0, 7).Value = ""
'End If
'Else
Sheets("Calculation").Select
K2002.Offset(0, 0).Value = K2002.Offset(0, -15).Value & sa & K2002.Offset(0, -13).Value & sa1 & K2002.Offset(0, -12).Value & sa2 & K2002.Offset(0, -8).Value & sa3 & K2002.Offset(0, -6).Value & sa4 & K2002.Offset(0, -2).Value
K2002.Offset(0, 0).Value = Trim(K2002.Offset(0, 0).Value)
'ani = Trim(K2002.Offset(0, 0).Value)
K2002.Offset(0, 7).Value = Len(K2002.Offset(0, 0).Value)
If K2002.Offset(0, 7).Value = "0" Then
K2002.Offset(0, 7).Value = ""
'End If
End If
End If
If Range("Q" & cmm39).Offset(0, -15).Value = "" Then
K2002.Offset(0, 0).Value = K2002.Offset(0, -15).Value & K2002.Offset(0, -13).Value & sa1 & K2002.Offset(0, -12).Value & sa2 & K2002.Offset(0, -8).Value & sa3 & K2002.Offset(0, -6).Value & sa4 & K2002.Offset(0, -2).Value & sa5 & K2002.Offset(0, -1).Value
K2002.Offset(0, 0).Value = Trim(K2002.Offset(0, 0).Value)
'Len of K2002
K2002.Offset(0, 7).Value = Len(K2002.Offset(0, 0).Value)
If K2002.Offset(0, 7).Value = "0" Then
K2002.Offset(0, 7).Value = ""
End If
'-----------
End If
Next

'Range("Q10000").Select
'Selection.End(xlUp).Select
'arg4 = Selection.Row
'For Each arg1 In Range("Q2:Q" & arg4)
'arg1.Select
'arg2 = Selection.Value
'arg3 = Len(arg2)
'If arg3 < 1 Then
'Selection.ClearContents
'End If
'Next

'K2001 Value
Sheets("Calculation").Select
cmm70 = ActiveSheet.UsedRange.Rows.Count
For Each K2001 In Range("W2:W" & cmm70)
K2001.Select
cmm71 = Selection.Row
If Range("A" & cmm71).Value = "" Then
Exit For
End If
'Sheets("CMM K-Field Naming Template").Select
'If Range("C3").Value = "All Other" Then
'Sheets("Calculation").Select
'Range("W" & cmm71).Value = Range("R" & cmm71).Value & Range("S" & cmm71).Value & Range("T" & cmm71).Value & Range("U" & cmm71).Value & Range("V" & cmm71).Value
'Range("W" & cmm71).Value = Trim(Range("W" & cmm71).Value)
''Len of K2001
'Range("W" & cmm71).Offset(0, 2).Value = Len(Range("W" & cmm71).Value)
'If Range("W" & cmm71).Offset(0, 2).Value = "0" Then
'Range("W" & cmm71).Offset(0, 2).Value = ""
'End If
'Else
'Sheets("Calculation").Select
Range("W" & cmm71).Value = Range("R" & cmm71).Value & Range("S" & cmm71).Value & Range("T" & cmm71).Value & Range("U" & cmm71).Value & Range("V" & cmm71).Value & Range("P" & cmm71).Value
Range("W" & cmm71).Value = Trim(Range("W" & cmm71).Value)
'Len of K2001
Range("W" & cmm71).Offset(0, 2).Value = Len(Range("W" & cmm71).Value)
If Range("W" & cmm71).Offset(0, 2).Value = "0" Then
Range("W" & cmm71).Offset(0, 2).Value = ""
End If
'End If
'-------------
Next

Range("W10000").Select
Selection.End(xlUp).Select
arg4 = Selection.Row
For Each arg1 In Range("W2:W" & arg4)
arg1.Select
arg2 = Selection.Value
arg3 = Len(arg2)
If arg3 < 1 Then
Selection.ClearContents
End If
Next
'------------
'K2002
Sheets("Calculation").Select
cmm40 = ActiveSheet.UsedRange.Rows.Count
Range("Q" & cmm40 + 10).Select
Selection.End(xlUp).Select
cmm41 = Selection.Row
If cmm41 > 1 Then
Range("Q2:Q" & cmm41).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("J8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'K2001
Sheets("Calculation").Select
cmm72 = ActiveSheet.UsedRange.Rows.Count
Range("W" & cmm72 + 10).Select
Selection.End(xlUp).Select
cmm73 = Selection.Row
If cmm73 > 1 Then
Range("W2:W" & cmm73).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("K8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'Len of K2002
Sheets("Calculation").Select
cmm90 = ActiveSheet.UsedRange.Rows.Count
Range("X" & cmm90 + 10).Select
Selection.End(xlUp).Select
cmm91 = Selection.Row
If cmm91 > 1 Then
Range("X2:X" & cmm91).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("W8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'Len of K2001
Sheets("Calculation").Select
cmm92 = ActiveSheet.UsedRange.Rows.Count
Range("Y" & cmm92 + 10).Select
Selection.End(xlUp).Select
cmm93 = Selection.Row
If cmm93 > 1 Then
Range("Y2:Y" & cmm93).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("V8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If

'Clear column R to U values
Range("R8:U5006").ClearContents
'Main Sheet Column R - K2001 Word 1
Sheets("Calculation").Select
cmm101 = ActiveSheet.UsedRange.Rows.Count
Range("R" & cmm101 + 10).Select
Selection.End(xlUp).Select
cmm102 = Selection.Row
If cmm102 > 1 Then
Range("R2:R" & cmm102).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("R8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'Main Sheet Column S - K2001 Word 3
Sheets("Calculation").Select
cmm103 = ActiveSheet.UsedRange.Rows.Count
Range("T" & cmm103 + 10).Select
Selection.End(xlUp).Select
cmm104 = Selection.Row
If cmm104 > 1 Then
Range("T2:T" & cmm104).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("S8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'Main Sheet Column T - K2001 Word 4
Sheets("Calculation").Select
cmm105 = ActiveSheet.UsedRange.Rows.Count
Range("U" & cmm105 + 10).Select
Selection.End(xlUp).Select
cmm106 = Selection.Row
If cmm106 > 1 Then
Range("U2:U" & cmm106).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
Range("T8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
'Main Sheet Column U - K2001 Word 5
Sheets("Calculation").Select
cmm107 = ActiveSheet.UsedRange.Rows.Count
Range("V" & cmm107 + 10).Select
Selection.End(xlUp).Select
cmm108 = Selection.Row
If cmm108 > 1 Then
Range("V2:V" & cmm108).Select
Selection.Copy
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("U8").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False
End If
Sheets("Calculation").Select
Range("A1").Select
Sheets("CMM K-Field Naming Template").Select
Range("L5007").Select
Selection.End(xlUp).Select
ZZ = Selection.Row
Range("M5007").Select
Selection.End(xlUp).Select
ZZ1 = Selection.Row
Range("N5007").Select
Selection.End(xlUp).Select
ZZ2 = Selection.Row
Range("O5007").Select
Selection.End(xlUp).Select
ZZ3 = Selection.Row
Range("P5007").Select
Selection.End(xlUp).Select
ZZ4 = Selection.Row
Range("Q5007").Select
Selection.End(xlUp).Select
ZZ5 = Selection.Row
ZZ6 = WorksheetFunction.Max(ZZ, ZZ1, ZZ2, ZZ3, ZZ4, ZZ5)
For Z = 8 To 5007
If Z > ZZ6 Then
Exit For
End If
If Range("J" & Z) = "" And Range("K" & Z) = "" Then
Range("L" & Z) = ""
Range("M" & Z) = ""
Range("N" & Z) = ""
Range("O" & Z) = ""
Range("P" & Z) = ""
Range("Q" & Z) = ""
End If
Next

Range("A1").Select
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("Calculation").Visible = xlVeryHidden

'err1
err1:
If err1 = 0 Then
Sheets("CMM K-Field Naming Template").Select
'MsgBox "Table 2 value " & cmm14 & " is incorrect Please correct it to proceed further"
End If
Range("A1").Select
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("Calculation").Visible = xlVeryHidden
cmm114 = Environ("Username")
    'Dim cmm98 As Characters
    cmm115 = LCase(cmm114)
If cmm115 <> "seddy4" And cmm115 <> "rengel7" And cmm115 <> "jokroy" And cmm115 <> "svarre" And cmm115 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
'ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
'ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
'Password = Application.InputBox("Enter Password", "Password Protected")
'
'Select Case Password
'    Case Is = False
'        'do nothing
'    Case Is = "macro"
'        Range("A1").Value = "This is secret code"
'    Case Else
'        MsgBox "Incorrect Password"
'        End Select
lastrw:
If lastrw1 = 1 Then
MsgBox "Please fill in all the Mandatory Values to proceed further"
cmm114 = Environ("Username")
    'Dim cmm98 As Characters
    cmm115 = LCase(cmm114)
If cmm115 <> "seddy4" And cmm115 <> "rengel7" And cmm115 <> "jokroy" And cmm115 <> "svarre" And cmm115 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("Calculation").Visible = xlVeryHidden
End If
Else
If Range("E8").Value = "" And Range("B8").Value = "" And Range("C8").Value = "" And Range("D8").Value = "" And Range("F8").Value = "" And Range("G8").Value = "" And Range("H8").Value = "" And Range("I8").Value = "" Then
cmm114 = Environ("Username")
    'Dim cmm98 As Characters
    cmm115 = LCase(cmm114)
If cmm115 <> "seddy4" And cmm115 <> "rengel7" And cmm115 <> "jokroy" And cmm115 <> "svarre" And cmm115 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("Calculation").Visible = xlVeryHidden
Range("A7").Select
Else
cmm114 = Environ("Username")
    'Dim cmm98 As Characters
    cmm115 = LCase(cmm114)
If cmm115 <> "seddy4" And cmm115 <> "rengel7" And cmm115 <> "jokroy" And cmm115 <> "svarre" And cmm115 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
MsgBox "Please fill in all the Mandatory Values to proceed further"
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("Calculation").Visible = xlVeryHidden
End If
End If
Else
'MsgBox "Please Fill in Part Description to proceed further"
'End If
'Else
'MsgBox "Please Fill in Operation Number and Part Description to proceed further"
'End If
'Else

MsgBox "Please Fill in Part Description, Operation Number and  Gauge Manufacturer to proceed further"
End If
finl:
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub

Attribute VB_Name = "Module3"
Sub Other_Kfields_Click()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Sheets("Variable Gauge Output").Visible = True
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Unprotect Password:="re"
nam = Range("I5").Value
nam1 = Range("N4").Value
nam2 = Range("N5").Value
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
Dim wb As Workbook
Set wb = Workbooks.Add
ThisWorkbook.Sheets("Variable Gauge Output").Copy Before:=wb.Sheets(1)
ot = ActiveWorkbook.Name
Workbooks(ot).Activate
Sheets(2).Delete
'ThisWorkbook.Sheets("Variable Gauge Output Template").Copy Before:=ot.Sheets(1)
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("J8:Q5007").Select
Selection.Copy
Workbooks(ot).Activate
Range("C6").Select
'ActiveSheet.Paste
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
'Range("A1").Value = "Identifier"
'Range("B1").Value = "u_k2001number"
'Range("C1").Value = "u_K2005class"
'Range("D1").Value = "u_K2015ToolWear"
'Range("E1").Value = "u_K2093BestFit"
'Range("F1").Value = "u_K2116LowerWarningLimit"
'Range("G1").Value = "u_K2117UpperWarningLimit"
'Range("H1").Value = "u_K2311ToolNumber"
Application.CutCopyMode = False
'End If
'K2005 and 2015 Tool Wear Values

rww = Range("E5008").End(xlUp).Row

For Each sd In Range("E6:E" & rww)
If sd <> "" Then
If sd.Offset(0, 0).Value = "REF 0" Or sd.Offset(0, 0).Value = "0" Then
sd.Offset(0, 0).Value = "REF 0"
End If
If sd.Offset(0, 0).Value = "OTH 1" Or sd.Offset(0, 0).Value = "1" Then
sd.Offset(0, 0).Value = "OTH 1"
End If
If sd.Offset(0, 0).Value = "HI/SO 2" Or sd.Offset(0, 0).Value = "2" Then
sd.Offset(0, 0).Value = "HI/SO 2"
End If
If sd.Offset(0, 0).Value = "SC 3" Or sd.Offset(0, 0).Value = "3" Then
sd.Offset(0, 0).Value = "SC 3"
End If
If sd.Offset(0, 0).Value = "CC 4" Or sd.Offset(0, 0).Value = "4" Then
sd.Offset(0, 0).Value = "CC 4"
End If
End If
Next
rww1 = Range("F5008").End(xlUp).Row
For Each sd1 In Range("F6:F" & rww1)
If sd1 <> "" Then
If sd1.Offset(0, 0).Value = "0 None" Or sd1.Offset(0, 0).Value = "0" Then
sd1.Offset(0, 0).Value = "0 None"
End If
If sd1.Offset(0, 0).Value = "1 Ascending" Or sd1.Offset(0, 0).Value = "1" Then
sd1.Offset(0, 0).Value = "1 Ascending"
End If
If sd1.Offset(0, 0).Value = "2 Descending" Or sd1.Offset(0, 0).Value = "2" Then
sd1.Offset(0, 0).Value = "2 Descending"
End If
End If
Next
Range("J3").NumberFormat = "@"
Range("G4").Value = nam
Range("J3").Value = nam1
Range("J4").Value = nam2
Range("G4").HorizontalAlignment = xlHAlignLeft
Range("J3").HorizontalAlignment = xlHAlignLeft
Range("J4").HorizontalAlignment = xlHAlignLeft
Range("C6:J5000").HorizontalAlignment = xlHAlignLeft
Range("A1").Select

'Workbooks(ot).Activate
'Cells.Select
'Columns("A:J").AutoFit
'Range("A1").Select
'ActiveWorkbook.SaveAs Ret

'ThisWorkbook.Activate
'Range("A7").Select



'intChoice = Application.FileDialog(msoFileDialogSaveAs).Show
'AX = 0
 'If ax = 1 Then
 'On Error GoTo Err1
 'End If
 'Dim strpath As Object
 
 vaa = 0
 time123 = Format(Time, "HH.MMAM/PM")
 date123 = Format(Date, "DD-MMM-YY")
    InitFile = "CMM and Variable Gauge Q-DAS K-Field_" & nam & "_" & nam1 & "_" & nam2 & "_" & date123 & "_" & time123 '<~~ You can set Default name here
    
    Set fd = Application.FileDialog(msoFileDialogSaveAs)
With fd
.InitialFileName = InitFile
.FilterIndex = 1
.Show
End With
cln1 = 0
On Error GoTo cancl
strPath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)
cln1 = 1
ActiveWorkbook.SaveAs strPath
ActiveWorkbook.Close
Sheets("Variable Gauge Output").Visible = xlVeryHidden
Sheets("CMM K-Field Naming Template").Select
Range("A7").Select
    
    'strpath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)

  'sfile = Split(strpath, "\")(UBound(Split(strpath, "\")))
  'ssfile = Left(sfile, Len(sfile) - 5)
   
'strfile = Left(strpath, Len(strpath) - Len(sfile))
'cancelled:
       'write strfile values and apply conditional formatting for last two columns
cancl:
 If cln1 = 0 Then
 MsgBox "Save has been Cancelled"
 ActiveWorkbook.Close
ThisWorkbook.Activate
Sheets("CMM K-Field Naming Template").Select
Range("A1").Select
cmm1101 = Environ("UserName")
cmm1111 = LCase(cmm1101)
If cmm1111 <> "seddy4" And cmm1111 <> "rengel7" And cmm1111 <> "jokroy" And cmm1111 <> "svarre" And cmm1111 <> "apraba" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
ActiveSheet.Range("B8:I5008").Locked = False
ActiveSheet.Range("L8:Q5008").Locked = False
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("Variable Gauge Output").Visible = xlVeryHidden
Sheets("CMM K-Field Naming Template").Select
Range("A7").Select
End If
End Sub
Attribute VB_Name = "Module4"
Sub RightArrow1_Click()
Sheets("Manual").Visible = True
Sheets("Manual").Select
cmm96 = Environ("Username")
    'Dim cmm98 As Characters
    cmm98 = LCase(cmm96)
If cmm98 <> "seddy4" And cmm98 <> "rengel7" And cmm98 <> "jokroy" And cmm98 <> "svarre" And cmm98 <> "apraba" Then
'And cmm98 <> "skhanapu"
On Error Resume Next
ActiveSheet.Range("G1:R42").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("Manual").Select
ActiveSheet.Unprotect Password:="re"
End If
Range("G1").Select
End Sub
Sub LeftArrow2_Click()
Sheets("CMM K-Field Naming Template").Select
Sheets("Manual").Visible = xlVeryHidden
End Sub
Attribute VB_Name = "Module5"
Sub ChgLog_Click()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Sheets("ChangeLog").Visible = True
Sheets("Valid Codes - Copy").Visible = True
chgs = 0
Dim ij(8) As String
ij(1) = "B"
ij(2) = "H"
ij(3) = "L"
ij(4) = "P"
ij(5) = "S"
ij(6) = "W"
ij(7) = "Z"
ij(8) = "AC"
For i = 1 To 8
For j = 10 To 500
If Sheets("Valid Codes").Range(ij(i) & j).Value <> Sheets("Valid Codes - Copy").Range(ij(i) & j).Value Then
Sheets("Valid Codes").Select
Range(ij(i) & j).Select
If ij(i) = "B" Then
ActiveCell.Offset(0, 2).Select
obv = ActiveCell.Value
End If
If ij(i) = "H" Or ij(i) = "L" Or ij(i) = "P" Or ij(i) = "W" Then
ActiveCell.Offset(0, -2).Select
obv = ActiveCell.Value
End If
If ij(i) = "S" Or ij(i) = "Z" Or ij(i) = "AC" Then
ActiveCell.Offset(0, -1).Select
obv = ActiveCell.Value
End If
v15 = Selection.Row
vl1 = Sheets("Valid Codes").Range(ij(i) & j).Value
vl2 = Sheets("Valid Codes - Copy").Range(ij(i) & j).Value
Sheets("Valid Codes - Copy").Select
Range(ij(i) & j).Select
v14 = Selection.Row
On Error Resume Next
Range(ij(i) & "10:" & ij(i) & 1000).Select
Set v13 = Selection.Find(what:=vl1, After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=True _
        , SearchFormat:=False).Activate
        
If v13 = "" Then
tbl = 0
If ij(i) = "B" Then
tbl = "Table 1"
End If
If ij(i) = "H" Then
tbl = "Table 2"
End If
If ij(i) = "L" Then
tbl = "Table 7"
End If
If ij(i) = "P" Or ij(i) = "S" Then
tbl = "Table 3 & 8"
End If
If ij(i) = "W" Then
tbl = "Table 4"
End If
If ij(i) = "Z" Then
tbl = "Table 5"
End If
If ij(i) = "AC" Then
tbl = "Table 6"
End If
Sheets("ChangeLog").Select
plz = ActiveSheet.UsedRange.Rows.Count + 10
Range("B" & plz).Select
Selection.End(xlUp).Offset(1, 0).Select
ActiveCell.Value = Format(Date, "MM/DD/YYYY") & " " & Format(Time, "HH:MM")
envm = Environ("Username")
ActiveCell.Offset(0, 1).Value = envm & " Changed " & tbl & " Row number " & v15 & " Option to '" & vl1 & "' and abrev. to '" & obv & "'"
chgs = 1
End If
End If
Next
Next
If chgs = 1 Then
Sheets("Valid Codes - Copy").Select
Cells.Select
Cells.ClearContents
With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
End With
Sheets("Valid Codes").Select
Cells.Select
Selection.Copy
Sheets("Valid Codes - Copy").Select
Cells.Select
ActiveSheet.Paste
Application.CutCopyMode = False
Range("A2").Select
Sheets("Valid Codes").Select
Range("A1").Select
End If
Sheets("ChangeLog").Visible = False
Sheets("Valid Codes - Copy").Visible = xlVeryHidden
Sheets("CMM K-Field Naming Template").Select
Range("A7").Select
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 7, 0, MSForms, ComboBox"
Attribute VB_Control = "CommandButton1, 8, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
    Call UpdateNow
End Sub


Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
    Call Call_Update
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    DDCols = "2 3 5 6 7 9" 'Column numbers for all columns with a drop down lists
1    If Target.Rows.Count = 1 And Target.Columns.Count = 1 Then
        If InStr(DDCols, Target.Column) > 0 Then
            If Target.Row >= 8 Then
                Call DDList(Target.Address)
            End If
        End If
    End If
End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

    'Target.Calculate
    'End Sub
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    Sheets("CMM K-Field Naming Template").Select
    ActiveSheet.Unprotect Password:="re"
    Call ResetDropDown
End Sub
Private Sub Workbook_Open()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Application.EnableEvents = True
nm = ThisWorkbook.Name
If nm = "CMM and Variable Gauge Q-DAS K-Field Generator Rel 3.1.xlsm" Then
nam = Range("I5").Value
nam1 = Range("N4").Value
nam2 = Range("N5").Value
time123 = Format(Time, "HH.MMAM/PM")
 date123 = Format(Date, "DD-MMM-YY")
    InitFile = "CMM and Variable Gauge Q-DAS K-Field Generator Rel 3.1_" & date123 ' & nam & "_" & nam1 & "_" & nam2 & "_" & time123  <~~ You can set Default name here
    
    Set fd = Application.FileDialog(msoFileDialogSaveAs)
With fd
.InitialFileName = InitFile
.FilterIndex = 2
.Show
End With
cln1 = 0
On Error GoTo cancl
strPath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)
cln1 = 1
ActiveWorkbook.SaveAs strPath
'ActiveWorkbook.Close
'Workbooks.Open strPath
cancl:
 If cln1 = 0 Then
 MsgBox "Save has been Cancelled"
 ActiveWorkbook.Close
ThisWorkbook.Activate
Sheets("K-Field Naming Template").Select
Range("A1").Select
End If
End If
MsgBox "Please update the Valid Codes if required, Before that Please close all the Internet Explorer if you have opened"
    Call ResetDropDown
    'Call Call_Update
'Disable Cut Copy Paste
'Application.CutCopyMode = False
'Application.OnKey "^c", ""
'Application.CellDragAndDrop = False
On Error Resume Next

Sheets("CMM K-Field Naming Template").Select
'Range("I3").Value = "Select Q-das Attributes"
Range("A1").Select
Sheets("KField Naming Template").Visible = xlVeryHidden
Sheets("Valid Codes - Copy").Visible = True
Sheets("Valid Codes - Copy").Select
    Cells.Select
    Cells.ClearContents
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Sheets("Valid Codes").Select
    Cells.Select
    Selection.Copy
    Sheets("Valid Codes - Copy").Select
    Cells.Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A2").Select
    Sheets("Valid Codes").Select
    Range("AC11").Select
    Selection.End(xlDown).Select
    lt1 = Selection.Row + 1
    Range("AC" & lt1 & ":AC5000").ClearContents
    Range("B8:AC5000").Select
    On Error Resume Next
  Selection.Replace what:=",", Replacement:=";", _
    LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
    SearchFormat:=False, ReplaceFormat:=False
    Range("A1").Select
'    Sheets("Valid Codes - Copy").Select
'    cmm = ActiveSheet.UsedRange.Rows.Count
'    '1
'    Range("J" & cmm).Select
'    Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("H10:J" & cmm1).Select
'    'Columns("H:J").Sort key1:=Range("J10"), _
'      order1:=xlAscending, Header:=xlYes
'
' ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("J10:J" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
'        :=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("H10:J" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    '2
'    Range("B" & cmm + 10).Select
'    Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("B10:D" & cmm1).Select
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("B10:B" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
'        :=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("B10:D" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    '3
'    Range("Z" & cmm + 10).Select
'    Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("X10:Z" & cmm1).Select
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("Z10:Z" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
'        :=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("X10:Z" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    '4
'    Range("R" & cmm + 10).Select
'    Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("P10:R" & cmm1).Select
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("R10:R" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
'        :=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("P10:R" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    '5
'    Range("U" & cmm + 10).Select
'    Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("T10:U" & cmm1).Select
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("U10:U" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
'        :=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("T10:U" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    '6
'    Range("AG100").Select
'    Selection.End(xlUp).Select
'    'Selection.End(xlUp).Select
'    cmm1 = Selection.Row
'    Range("AF11:AG" & cmm1).Select
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort.SortFields.Add Key:= _
'        Range("AG11:AG" & cmm1), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
'    With ActiveWorkbook.Worksheets("Valid Codes - Copy").Sort
'        .SetRange Range("AF11:AG" & cmm1)
'        .Header = xlGuess
'        .MatchCase = False
'        .Orientation = xlTopToBottom
'        .SortMethod = xlPinYin
'        .Apply
'    End With
'    Range("A1").Select
    Sheets("ChangeLog").Visible = False
    Sheets("Sheet1").Visible = xlVeryHidden
    Sheets("Valid Codes - Copy").Visible = xlVeryHidden
    Sheets("Calculation").Visible = xlVeryHidden
    Sheets("CMM K-Field Naming Template").Select
    'Range("B8:W5500").ClearContents
    Range("A1").Select
    cmm96 = Environ("Username")
    'Dim cmm98 As Characters
    cmm98 = LCase(cmm96)
If cmm98 <> "seddy4" And cmm98 <> "rengel7" And cmm98 <> "jokroy" And cmm98 <> "apraba" And cmm98 <> "svarre" Then
'And cmm98 <> "skhanapu"
'cmm98 <> "apraba" And
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("B8:I5008").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("L8:Q5008").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Range("B5:AN5000").Locked = True
ActiveSheet.Protect Password:="re"
Sheets("Manual").Select
ActiveSheet.Range("G1:R42").Locked = True
ActiveSheet.Protect Password:="re"
Else
Sheets("CMM K-Field Naming Template").Select
ActiveSheet.Range("I3").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("B8:I5008").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("L8:Q5008").Locked = False
'ActiveSheet.Protect Password:="re"
ActiveSheet.Range("A4:W5").Locked = False
ActiveSheet.Protect Password:="re", DrawingObjects:=False
Sheets("Valid Codes").Select
ActiveSheet.Unprotect Password:="re"
Sheets("Manual").Select
ActiveSheet.Unprotect Password:="re"
End If
Sheets("Manual").Visible = xlVeryHidden
Sheets("Vars").Visible = xlVeryHidden
Sheets("Variable Gauge Output").Visible = xlVeryHidden
Sheets("CMM K-Field Naming Template").Select
Range("A6").Select
   ' Sheets("Surf K-Field Naming Template").Select
'    ActiveSheet.Range("A3:T3").Locked = False
'    'ActiveSheet.Range("D3").Locked = False
'    ActiveSheet.Range("A7:I5000").Locked = False
'    ActiveSheet.Range("L7:L5000").Locked = False
'    ActiveSheet.Protect Password:="re"
'    Sheets("Gauge K-Field Naming Template").Select
'    ActiveSheet.Range("E3:P3").Locked = False
'    ActiveSheet.Range("D3").Locked = False
'    ActiveSheet.Range("A7:F5000").Locked = False
'    ActiveSheet.Range("I7:I5000").Locked = False
'    ActiveSheet.Protect Password:="re"
End Sub
Private Sub Workbook_NewSheet(ByVal Sh As Object)

    Application.DisplayAlerts = False
    ActiveSheet.Delete
    MsgBox "Sorry, Adding new sheet is not allowed"
    
End Sub


' InQuest injected base64 decoded content
' w.?1

INQUEST-PP=macro
