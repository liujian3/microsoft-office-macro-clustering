Attribute VB_Name = "Allgemein"
'Definition von Variablen, ob diese nur aus der jeweiligen Funktion oder von |fffd|berall her aufrufbar sind:
'Public = |fffd|bergreifende Variable, DIM = lokale Variable innerhalb der Funktion.

'As Integer = Ganzzahl; As Double = Dezimalzahl; As Boolean = richtig/falsch, ja/nein ...

Public TechnProblem As String      'Text f|fffd|r Fehlermeldung beim Anklicken der Schaltfl|fffd|chen

Public mBL As Integer              'Betrieb:           1=bitte ausw|fffd|hlen, 2=Land, 3=Bund
Public mLose As Integer            'losweise Vergabe:  1=nein 2=ja,
Public mNutzer_B As Integer        'Nutzerart Bund     1=bitte ausw|fffd|hlen, 2=Zivil, 3=Bundeswehr, 4=US-Gaststreitkr|fffd|fte,5=franz.-Gaststreitkr|fffd|fte
Public mVA As Integer              'Vergabeart
Public mZV_Art As Integer          'Zeitvertrag Art    2=Angebotsverfahren  3=Auf- und Abgebotsverfahren
Public mZV As Boolean              'Zeitvertrag        ja/nein

Public m_ShowHiddenText As Boolean
Public m_ShowAll As Boolean
Public m_PrintHiddenText As Boolean
Public m_MarkupMode As Integer      '1=alle |fffd|berarbeitungen inline  2=nur teilweise in Sprechblasen  3 = alle in Sprechblasen
Public m_TableGridlines As Boolean
Public m_HyperlinkOpen As Boolean   'Aufruf Hyperlink (mit/ohne Strg)

Public strNetzLaufwerk As String    'Netzlaufwerk, ermittelt in CheckBetrieb / XML_Import/checkLaufwerke, normalerweise "H:\"
Public LTMG_Wert As Double          'Schwellenwert f|fffd|r G|fffd|ltigkeit des Landestariftreue- und Mindestlohngesetz (LTMG)
Public VS As Boolean                'verteidigungs- und sicherheitsrelevante Ma|fffd|nahme

Public aktuell As Boolean
Public Druck_alt As Boolean
Public Jump As Boolean                'zum |fffd|berspringen von Programmierzeilen (allgemein)

Public User As String
Public sign As String
Public unsign As String
Public NettoBrutto As String
Public Const USt As Double = 1.19


Sub setStartupValues(Optional bProtect As Boolean = True)      'Makro startet beim |fffd|ffnen der Datenliste (siehe Objekt "ThisDocument")

    LTMG_Wert = 20000                                          'Schwellenwert ohne USt. f|fffd|r G|fffd|ltigkeit des LTMG
    VS = ActiveDocument.FormFields("TM181_CB").CheckBox.Value  'verteidigungs- und sicherheitsrelevante Ma|fffd|nahme

   'Pr|fffd|fen und "merken" vorhandener Word-Einstellungen ----------------------------------------------------------------------
   'Beim Schlie|fffd|en des Dokuments werden die urspr|fffd|nglichen Einstellungen durch das "AutoClose" Makro wieder gesetzt
    
    m_ShowHiddenText = ActiveDocument.ActiveWindow.View.ShowHiddenText           'Verstecken des "ausgeblendeten Textes" (wegen Word 2003 erforderlich)
    m_ShowAll = ActiveDocument.ActiveWindow.View.ShowAll                         'Ausblenden von "ausgeblendetem Text" + "allen Formatierungszeichen"
    m_PrintHiddenText = Options.PrintHiddenText                                  'Ausgeblendeter Text wird nicht gedruckt (= gesonderte Einstellung in Word)
    m_TableGridlines = ActiveDocument.ActiveWindow.View.TableGridlines           'Ausblenden der Tabellen-Rasterlinien
    m_HyperlinkOpen = Options.CtrlClickHyperlinkToOpen                           'Aufruf Hyperlink (mit/ohne Strg)
        
    If ActiveDocument.ActiveWindow.View.MarkupMode = wdInLineRevisions Then      'Alle |fffd|berarbeitungen inline anzeigen
       m_MarkupMode = 1
    ElseIf ActiveDocument.ActiveWindow.View.MarkupMode = wdMixedRevisions Then   'nur Kommentare und Formatierungen in Sprechblasen anzeigen
       m_MarkupMode = 2
    ElseIf ActiveDocument.ActiveWindow.View.MarkupMode = wdBalloonRevisions Then '|fffd|berarbeitungen in Sprechblasen anzeigen
       m_MarkupMode = 3
    End If
    
    '-------------------------------------------------------------------------------------------------------------------------------

    Call protectFile(False)   'Ausf|fffd|hren der Function "protectFile" und |fffd|bergabe des Wertes "False" (wegen Word 2003 erforderlich)

    ActiveDocument.Bookmarks("TM171").Range.Font.Hidden = True 'Ausblenden des Hinweises "Bitte Makros aktivieren"

    ActiveDocument.ActiveWindow.View.ShowHiddenText = False         'Das zus|fffd|tzliche Verstecken des "ausgeblendeten Textes" ist wegen Word 2003 notwendig
    ActiveDocument.ActiveWindow.View.ShowAll = False                'Ausblenden von "ausgeblendetem Text" + "allen Formatierungszeichen"
    Options.PrintHiddenText = False                                 'Ausgeblendeter Text wird nicht gedruckt (= gesonderte Einstellung in Word)
    ActiveDocument.ActiveWindow.View.MarkupMode = wdInLineRevisions 'Alle |fffd|berarbeitungen inline anzeigen (z.B. Kommentare)
    ActiveDocument.ActiveWindow.View.TableGridlines = False         'Ausblenden der Tabellen-Rasterlinien
    Options.CtrlClickHyperlinkToOpen = False                        'Aufruf Hyperlink (ohne Strg)
           
    'Lesen des Wertes vom jeweiligen Feld und Zuordnung zur Variablen (notwendig, um Makros nur bei |fffd|nderung in den Feldinhalten ablaufen zu lassen)
    'mBL siehe Makro "checkBetrieb"
     mLose = ActiveDocument.FormFields("DD2_losweise").DropDown.Value
     mNutzer_B = ActiveDocument.FormFields("Nutzerart_Bund").DropDown.Value
     mVA = ActiveDocument.FormFields("DD3_Vergabeart").DropDown.Value
     mZV = ActiveDocument.FormFields("Zeitvertrag_CB").CheckBox.Value
     mZV_Art = ActiveDocument.FormFields("TM75_DD").DropDown.Value
     
    'Variablen bef|fffd|llen
     Jump = False

     User = Environ("username")
     sign = "elektron. signieren"
     unsign = "Signatur aufheben"

    
    'Ausf|fffd|hren der folgenden Functionen ist notwendig, um alle nicht relevanten Textmarken auszublenden
     Call fcPreisaufgliederung(False)
     Call fcZeitvertrag(False)
     Call fcVergabeart(False)
     Call fcCheckbox_Instandhaltung(False)
     Call fcWBVB_CB_Wasser(False)
     Call fcStoffpreisgleitklausel(False)
     Call fcProduktaufkl|fffd|rung(False)
     
    'Bef|fffd|llen von MsgBox-Inhalten
     TechnProblem = "Wegen fehlender Internetverbindung oder eines technischen Problems kann die Datei nicht heruntergeladen werden." + Chr$(13) + "Wir bitten diesen Umstand zu entschuldigen." + Chr$(13) + Chr$(13) + "Bitte setzen Sie sich |fffd|ber die Vergabestelle mit dem Anwendungssupport in Verbindung."
     
    'Korrektur wegen Bug von Word (ansonsten entsteht Leerzeile obwohl Text ausgeblendet)
     If ActiveDocument.FormFields("TM181_CB").CheckBox.Value = False Then
        ActiveDocument.Bookmarks("TM82").Range.Font.Hidden = True  'Formblatt 247
     End If
     
    'Einblenden der vor dem Ausdruck ausgeblendeten Textmarken
     If ActiveDocument.Bookmarks("Erkl_LV").Range.Font.Hidden = False Then
        ActiveDocument.Bookmarks("Erkl_LV_Button").Range.Font.Hidden = False  '"Erkl|fffd|rung zum LV" Schaltfl|fffd|che
        ActiveDocument.Bookmarks("Erkl_LV_Button").Select
        Selection.Font.Underline = wdUnderlineNone  'nicht unterstrichen
     End If
     
     
     ActiveWindow.View.Reviewers("Hinweis").Visible = True                 'Kommentare vom Bearbeiter "Hinweis" einblenden
                                                                                  
                                                                                  
    'Unterschriften - Schaltfl|fffd|chen
     ActiveDocument.Bookmarks("U_Schaltfl|fffd|chen1").Range.Font.Hidden = False
     
     ActiveDocument.Bookmarks("U_VBV").Range.Font.Hidden = False           'Schaltfl|fffd|chen - Unterschriftenregelung VBV Ba-W|fffd|
     
     ActiveDocument.Bookmarks("U_weitere_Z").Range.Font.Hidden = False
     If ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = True Then ActiveDocument.Bookmarks("U_Schaltfl|fffd|chen2").Range.Font.Hidden = False
                
    'Darstellung der Unterschriftenschaltfl|fffd|chen (erst nach dem Bef|fffd|llen der User-Variable + Einblenden der Unterschriften-Schaltfl|fffd|chen)
     Call setButtons

    'Sonstige Schaltfl|fffd|chen
     ActiveDocument.Bookmarks("Schaltfl|fffd|chen_Z").Range.Font.Hidden = False
                                                                                  
                                                                                  
     ActiveDocument.Bookmarks("Dat_Eingang").Select    'Textmarke (Textfeld) markieren

    If bProtect = True Then Call protectFile(True)    'Wird zu "bProtect" der Wert "True" |fffd|bergeben, dann Ausf|fffd|hren der Function "protectFile" und |fffd|bergabe des Wertes "True" (wegen Word 2003 erforderlich)

End Sub


Function ReadOnly_Dir_check()

   'Schreibeschutz pr|fffd|fen
    With ThisDocument
    
        If .ReadOnly Then
        
           If MsgBox("Die Datei  """ & ThisDocument.Name & """  ist schreibgesch|fffd|tzt." + vbNewLine + vbNewLine + _
                  "Bitte speichern Sie die Datei vor der Bearbeitung unter einem anderen Dateinamen ab, um Datenverlust zu vermeiden !" + vbNewLine + vbNewLine + _
                  "M|fffd|chten Sie die Datei jetzt speichern ?", vbYesNo + vbCritical, "Warnung") = vbYes Then
                  
              On Error Resume Next  'notwendig falls Speichervorgang abgebrochen wird
              ThisDocument.Save
          
           End If
        
           Exit Function
        
        End If
        
    End With
    
    
   'Datei liegt in einem tempor|fffd|ren Benutzerverzeichnis
    If ThisDocument.Path = Environ("TEMP") Or ThisDocument.Path = "C:\Temp" Then
       
       
       If MsgBox("Die Datei  """ & ThisDocument.Name & """  liegt in einem tempor|fffd|ren Verzeichnis." + vbNewLine + vbNewLine + _
                 "Bitte speichern Sie die Datei vor der Bearbeitung in einem anderen Verzeichnis ab." + vbNewLine + vbNewLine + _
                 "M|fffd|chten Sie die Datei jetzt speichern ?", vbYesNo + vbCritical, "Warnung") = vbYes Then
            
          On Error Resume Next  'notwendig falls Speichervorgang abgebrochen wird
          ThisDocument.Save
          
       End If
          
    End If
    
End Function


Sub LandBund()

Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung

    If ActiveDocument.FormFields("DD1_Betrieb").DropDown.Value = mBL Then   'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
        ActiveDocument.Bookmarks("DD1_Betrieb_Dummy").Select
        Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
        Exit Sub
    Else
        mBL = ActiveDocument.FormFields("DD1_Betrieb").DropDown.Value       'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "LandBund" ausf|fffd|hren
        
        If Geduld.Visible = False Then  'Formular "Geduld" nicht sichtbar
           Geduld.Show (0)              'Anzeige des Formulars "Geduld"
            DoEvents                    'notwendig, um Inhalt des Formulars anzuzeigen
        End If
        
        ActiveWindow.View.Type = wdNormalView
        
        Call fcLandBund                 'Ausf|fffd|hrung der Function "fcLandBund"
        
        ActiveWindow.View.Type = wdPrintView
        
        Geduld.hide                     'Ausblenden des Formulars "Geduld"
        
        ActiveDocument.Bookmarks("DD1_Betrieb_Dummy").Select    'Textmarke (Textfeld) markieren
        
    End If
        
Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
        
End Sub

Function fcLandBund(Optional bProtect As Boolean = True)

    Call protectFile(False)   'Ausf|fffd|hren der Function "protectFile" und |fffd|bergabe des Wertes "False" (wegen Word 2003 erforderlich)
    
    ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = True       'Baumittel       (Land)
    ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = True       'Verm|fffd|gensmittel (Land)
    ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = True     'Sonstige Mittel (Land)

    Select Case mBL
    
    Case 1   'erster Eintrag in Dropdownfeld "bitte ausw|fffd|hlen..."
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True    'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM15").Range.Font.Hidden = True   'Mittelart (Land)
        ActiveDocument.Bookmarks("TM18").Range.Font.Hidden = True   'Haushaltsstelle Bund
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = True 'Nummern BW + BImA + Rechn.St.
        ActiveDocument.Bookmarks("TM81").Range.Font.Hidden = True   'Anlage "Angebot Stoffpreisgleitklausel"
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = True   'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        ActiveDocument.Bookmarks("TM27").Range.Font.Hidden = True   'Anlage "NATO Infrastruktur"
        ActiveDocument.Bookmarks("TM83").Range.Font.Hidden = True   'Anlage "Angebot Lohngleitklausel"
        ActiveDocument.Bookmarks("TM112").Range.Font.Hidden = True  'Nutzerart (Bund)
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = True  'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
                                                                    
        Call fcWBVB_alle_ausblenden(False)
        Call fcTeilnahmebedingungen(False)
                                                                    
    Case 2  'zweiter Eintrag in Dropdownfeld "Landesbetrieb"
        ActiveDocument.Bookmarks("TM15").Range.Font.Hidden = False  'Mittelart (Land)
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True    'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18").Range.Font.Hidden = True   'Haushaltsstelle Bund
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = True 'Nummern BW + BImA + Rechn.St.
        ActiveDocument.Bookmarks("TM81").Range.Font.Hidden = True   'Anlage "Angebot Stoffpreisgleitklausel"
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = True   'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        ActiveDocument.Bookmarks("TM27").Range.Font.Hidden = True   'Anlage "NATO Infrastruktur"
        ActiveDocument.Bookmarks("TM83").Range.Font.Hidden = False ' True   'Anlage "Angebot Lohngleitklausel"
        ActiveDocument.Bookmarks("TM112").Range.Font.Hidden = True  'Nutzerart (Bund)
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = True  'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
            
        Call fcHHDaten_Mittelart(False)
        Call fcWBVB_Land(False)
        Call fcTeilnahmebedingungen(False)
    
    Case 3   'dritter Eintrag in Dropdownfeld "Bundesbetrieb"
        ActiveDocument.Bookmarks("TM15").Range.Font.Hidden = True   'Mittelart (Land)
               
        'TM1    (US-Projekt/Vergabe-Nr.):                       Ein-/Ausblenden ist in "fcNutzerart_Bund" enthalten
        ActiveDocument.Bookmarks("TM18").Range.Font.Hidden = False  'Haushaltsstelle Bund
        'TM18_1 (Nummer BW + BImA + Rechn.St.):                 Ein-/Ausblenden ist in "fcNutzerart_Bund" enthalten
        'TM26   (Anlage "Auftr|fffd|ge Gaststreitkr|fffd|fte):            Ein-/Ausblenden ist in "fcNutzerart_Bund" enthalten
        ActiveDocument.Bookmarks("TM81").Range.Font.Hidden = False  'Anlage "Angebot Stoffpreisgleitklausel"
        ActiveDocument.Bookmarks("TM27").Range.Font.Hidden = False  'Anlage "NATO Infrastruktur"
        ActiveDocument.Bookmarks("TM83").Range.Font.Hidden = False  'Anlage "Angebot Lohngleitklausel"
        ActiveDocument.Bookmarks("TM112").Range.Font.Hidden = False 'Nutzerart (Bund)
                      
        Call fcNutzerart_Bund(False)
    
    End Select
    
    Call fcPreisaufgliederung(False)
    
    If mZV = True Then
        Call fcZeitvertrag(False, "fcLandBund")  'Ausf|fffd|hrung der Function "Zeitvertrag", |fffd|bergebe die Werte "false" und "Text"
    Else
        Call fcCheckbox_Zahlung(False)           'nur wenn kein ZV, da diese Funktion |fffd|ber fcZeitvertrag ohnehin aufgerufen wird
    End If
      
    Call TM16_Titel
    
    If bProtect = True Then Call protectFile(True)    'Wird zu "bProtect" der Wert "True" |fffd|bergeben, dann Ausf|fffd|hren der Function "protectFile" und |fffd|bergabe des Wertes "True" (wegen Word 2003 erforderlich)


End Function

Sub Lose()
'
' Lose Makro
'
    If ActiveDocument.FormFields("DD2_losweise").DropDown.Value = mLose Then    'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
        ActiveDocument.Bookmarks("DD2_losweise_Dummy").Select                   'Textmarke (Textfeld) markieren
        Exit Sub
    Else
        mLose = ActiveDocument.FormFields("DD2_losweise").DropDown.Value        'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "Lose" ausf|fffd|hren
        Call fcLose     'Ausf|fffd|hrung der Function "fcLose"
    End If
    
End Sub

Function fcLose(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'erster Eintrag in Dropdownfeld "nein"
    Select Case mLose
        Case 1
            ActiveDocument.Bookmarks("Lose_all").Range.Font.Hidden = True
            ActiveDocument.FormFields("Lose_Anzahl").Result = ""
            ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ""
            ActiveDocument.FormFields("Lose_Eins_CB").CheckBox.Value = False
            ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = False
            ActiveDocument.FormFields("Lose_alle_CB").CheckBox.Value = False
            ActiveDocument.FormFields("Lose_ZuschlMax_CB").CheckBox.Value = False
            ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = ""
            ActiveDocument.FormFields("Lose_ZuschlMax_txt2").Result = ""
            ActiveDocument.Bookmarks("TM12").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM14").Range.Font.Hidden = True
            
            
'zweiter Eintrag in Dropdownfeld "ja"
        Case 2
            ActiveDocument.Bookmarks("Lose").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM12").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM14").Range.Font.Hidden = False
            
    End Select

'Korrektur bei Vergaben ohne Bekanntmachung, Ausblenden des losbezogenen Bekanntmachungstextes
    Select Case mVA
    
        Case 1, 3, 5, 9, 11
            ActiveDocument.Bookmarks("TM12").Range.Font.Hidden = True 'Ausblenden des losbezogenen Bekanntmachungstextes
    End Select

    ActiveDocument.Bookmarks("DD2_losweise_Dummy").Select

    If bProtect = True Then Call protectFile(True)
        
End Function

Sub Lose_Anzahl()

   If ActiveDocument.FormFields("Lose_Anzahl").Result = "" Then
      Exit Sub
   End If

    If ActiveDocument.FormFields("Lose_Anzahl").Result <= "1" Then
       MsgBox "Die Anzahl muss mindestens 2 betragen." + Chr$(13) + Chr$(13) + _
              "Ihre Eingabe wird gel|fffd|scht.", vbInformation, "Fehlerhafte Anzahl"
       ActiveDocument.FormFields("Lose_Anzahl").Result = ""
    End If
                
  If ActiveDocument.FormFields("Lose_Anzahl").Result < ActiveDocument.FormFields("Lose_AngMax_Txt").Result Or _
     ActiveDocument.FormFields("Lose_Anzahl").Result < ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result Then
     ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ActiveDocument.FormFields("Lose_Anzahl").Result
     ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = ""
  End If
     
End Sub

Sub Lose_Eins_CB()

    If ActiveDocument.FormFields("Lose_Eins_CB").CheckBox.Value = True Then
       ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = False
       Call Lose_mehr_CB
       ActiveDocument.FormFields("Lose_alle_CB").CheckBox.Value = False
       Call Lose_alle_CB
       ActiveDocument.FormFields("Lose_ZuschlMax_CB").CheckBox.Value = False
       ActiveDocument.Bookmarks("Lose_ZuschlMax").Range.Font.Hidden = True
       ActiveDocument.Bookmarks("Lose_ZuschlMax_ja").Range.Font.Hidden = True
    End If
       
    ActiveDocument.FormFields("TM10_Dummy").Select
       
End Sub

Sub Lose_mehr_CB()

    If ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = True Then
       ActiveDocument.FormFields("Lose_Eins_CB").CheckBox.Value = False
       ActiveDocument.FormFields("Lose_alle_CB").CheckBox.Value = False
       ActiveDocument.Bookmarks("Lose_ZuschlMax").Range.Font.Hidden = False
       Call Lose_ZuschlMax_CB
    
       If ActiveDocument.FormFields("Lose_AngMax_Txt").Result = "" Then
          ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ActiveDocument.FormFields("Lose_Anzahl").Result
       End If
    
       If ActiveDocument.FormFields("Lose_AngMax_Txt").Result > ActiveDocument.FormFields("Lose_Anzahl").Result Then
          ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ActiveDocument.FormFields("Lose_Anzahl").Result
       End If
    Else
       ActiveDocument.Bookmarks("Lose_ZuschlMax").Range.Font.Hidden = True
       ActiveDocument.Bookmarks("Lose_ZuschlMax_ja").Range.Font.Hidden = True
       ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ""
    
    End If

    ActiveDocument.FormFields("TM10_Dummy").Select

End Sub

Sub Lose_alle_CB()

    If ActiveDocument.FormFields("Lose_alle_CB").CheckBox.Value = True Then
       ActiveDocument.FormFields("Lose_Eins_CB").CheckBox.Value = False
       ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = False
       ActiveDocument.Bookmarks("Lose_ZuschlMax").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("Lose_ZuschlMax").Range.Font.Hidden = True
    End If

    ActiveDocument.FormFields("TM10_Dummy").Select

End Sub

Sub Lose_ZuschlMax_CB()

    If ActiveDocument.FormFields("Lose_ZuschlMax_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("Lose_ZuschlMax_ja").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("Lose_ZuschlMax_ja").Range.Font.Hidden = True
    End If

    ActiveDocument.FormFields("TM10_Dummy").Select

End Sub

Sub Lose_AngMax_Txt()

   If ActiveDocument.FormFields("Lose_AngMax_Txt").Result = "" Then
      Exit Sub
   End If

   If ActiveDocument.FormFields("Lose_AngMax_Txt").Result > ActiveDocument.FormFields("Lose_Anzahl").Result Then

      MsgBox "Die Anzahl darf die Gesamtanzahl der Lose nicht |fffd|bersteigen." + Chr$(13) + Chr$(13) + _
             "Die Eingabe wird auf den Standardwert zur|fffd|ckgesetzt.", vbInformation, "Fehlerhafte Anzahl"
          
      ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ActiveDocument.FormFields("Lose_Anzahl").Result

   End If

   If ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result >= ActiveDocument.FormFields("Lose_AngMax_Txt").Result Then

      MsgBox "Die Anzahl muss die Anzahl der Lose |fffd|bersteigen, f|fffd|r welche ein Bieter den Zuschlag erhalten darf." + Chr$(13) + Chr$(13) + _
             "Die Eingabe wird auf den Standardwert zur|fffd|ckgesetzt.", vbInformation, "Fehlerhafte Anzahl"
          
      ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ActiveDocument.FormFields("Lose_Anzahl").Result

   End If

End Sub

Sub Lose_ZuschlMax_txt1()

If ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = "" Then
   Exit Sub
End If

If ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result >= ActiveDocument.FormFields("Lose_Anzahl").Result Then

   MsgBox "Die Anzahl muss die Gesamtanzahl der Lose unterschreiten." + Chr$(13) + Chr$(13) + _
          "Ihre Angabe wird daher gel|fffd|scht.", vbInformation, "Fehlerhafte Anzahl"
          
   ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = ""

End If

If ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result >= ActiveDocument.FormFields("Lose_AngMax_Txt").Result Then

   MsgBox "Die Anzahl muss geringer sein, als die Anzahl der Lose, welche ein Bieter maximal abgeben darf." + Chr$(13) + Chr$(13) + _
          "Ihre Angabe wird daher gel|fffd|scht.", vbInformation, "Fehlerhafte Anzahl"
          
   ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = ""

End If

End Sub

Sub Nutzerart_Bund()

Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung

    If ActiveDocument.FormFields("Nutzerart_Bund").DropDown.Value = mNutzer_B Then    'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
        ActiveDocument.Bookmarks("Nutzerart_Bund_Dummy").Select
        Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
        Exit Sub
    Else
        mNutzer_B = ActiveDocument.FormFields("Nutzerart_Bund").DropDown.Value        'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "Lose" ausf|fffd|hren
        
        If Geduld.Visible = False Then  'Formular "Geduld" nicht sichtbar
           Geduld.Show (0)              'Anzeige des Formulars "Geduld"
            DoEvents                    'notwendig, um Inhalt des Formulars anzuzeigen
        End If
        
        ActiveWindow.View.Type = wdNormalView
        
        Call fcNutzerart_Bund     'Ausf|fffd|hrung der Function "fcNutzerart_Bund"
    
        ActiveWindow.View.Type = wdPrintView
    
        Geduld.hide                     'Ausblenden des Formulars "Geduld"
    
    End If
    
Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
    
End Sub

Function fcNutzerart_Bund(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    Select Case mNutzer_B
        
      Case 1  'erster Eintrag "bitte ausw|fffd|hlen"
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True     'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = True  'Nummern BW + BIma + Rechn.St.
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = True   'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = True    'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        fcWBVB_alle_ausblenden (False)
        
      Case 2  'zweiter Eintrag "Zivil"
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True     'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = False 'Nummern BW + BIma + Rechn.St.
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = True   'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = True    'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        fcWBVB_Bund_Zivil (False)
        
      Case 3  'dritter Eintrag "Bundeswehr"
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True     'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = False 'Nummern BW + BIma + Rechn.St.
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = True   'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = True    'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        fcWBVB_Bund_Bundeswehr (False)
    
      Case 4  'vierter Eintrag "US-Gaststreitkr|fffd|fte"
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = False    'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = True  'Nummern BW + BIma + Rechn.St.
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = False  'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = False   'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        fcWBVB_Bund_US (False)
                                               
      Case 5  'f|fffd|nfter Eintrag "franz|fffd|sische Gaststreitkr|fffd|fte"
        ActiveDocument.Bookmarks("TM1").Range.Font.Hidden = True     'US-Projekt/Vergabe-Nr.
        ActiveDocument.Bookmarks("TM18_1").Range.Font.Hidden = True  'Nummern BW + BIma + Rechn.St.
        ActiveDocument.Bookmarks("TM170").Range.Font.Hidden = False  'Hinweis auf Gaststreitkr|fffd|fte im Aufforderungsschreiben
        ActiveDocument.Bookmarks("TM26").Range.Font.Hidden = False   'Anlage "Auftr|fffd|ge f|fffd|r Gaststreitkr|fffd|fte"
        fcWBVB_Bund_Bundeswehr (False)
                                                                                              
    End Select

    Call fcCheckbox_Zahlung(False)
    Call fcTeilnahmebedingungen(False)
    Call fcVergabeart(False)
    
    ActiveDocument.Bookmarks("Nutzerart_Bund_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Verteidigung_Sicherheit()          'Checkbox "verteidigungs- und sicherheitsrelevante Ma|fffd|nahme"
    Call fcVerteidigung_Sicherheit
End Sub

Function fcVerteidigung_Sicherheit(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM181_CB").CheckBox.Value = False Then
       VS = False
       ActiveDocument.Bookmarks("TM82").Range.Font.Hidden = True  'Formblatt 247
    Else
       VS = True
       ActiveDocument.Bookmarks("TM82").Range.Font.Hidden = False
    End If

    ActiveWindow.View.Type = wdNormalView

    Call fcVergabeart(False)

    ActiveWindow.View.Type = wdPrintView

    ActiveDocument.Bookmarks("TM181_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub Vergabeart()

Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung

    If ActiveDocument.FormFields("DD3_Vergabeart").DropDown.Value = mVA Then        'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
       ActiveDocument.Bookmarks("DD3_Vergabeart_Dummy").Select                      'Textmarke (Textfeld) markieren
       Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
       Exit Sub
    Else
        mVA = ActiveDocument.FormFields("DD3_Vergabeart").DropDown.Value            'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "Vergabeart" ausf|fffd|hren
        
        If Geduld.Visible = False Then  'Formular "Geduld" nicht sichtbar
           Geduld.Show (0)              'Anzeige des Formulars "Geduld"
            DoEvents                    'notwendig, um Inhalt des Formulars anzuzeigen
        End If
        
        ActiveWindow.View.Type = wdNormalView
        
        Call fcVergabeart               'Ausf|fffd|hrung der Function "fcVergabeart"
    
        ActiveWindow.View.Type = wdPrintView
    
        Geduld.hide                     'Ausblenden des Formulars "Geduld"
    
    End If
    
Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
    
End Sub

Function fcVergabeart(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    Call fcCheckbox_Zuschlagskriterien(False)
    Call fcAutoSicherheitsleistung(False)         'bei |fffd|A und OV und >250000 automatisch Sicherheiten ankreuzen
    
    Select Case mVA

        Case 1  'erster Eintrag im Dropdownfeld "bitte ausw|fffd|hlen..."
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
            
                        
        Case 2  'zweiter Eintrag im Dropdownfeld "|fffd|ffentliche Ausschreibung"
            
            If VS = True Then
               GoTo R|fffd|ckg|fffd|ngig1
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = False
        
        Case 3  'dritter Eintrag im Dropdownfeld "Beschr|fffd|nkte Ausschreibung"
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = False
        
        Case 4  'vierter Eintrag im Dropdownfeld "Beschr|fffd|nkte Ausschreibung mit Teilnahmewettbewerb"
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = False
        
        Case 5  'f|fffd|nfter Eintrag im Dropdownfeld "Freih|fffd|ndige Vergabe"
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = False
        
        Case 6  'sechster Eintrag im Dropdownfeld "Offenes Verfahren"
            
            If VS = True Then
               GoTo R|fffd|ckg|fffd|ngig1
            End If
            
            If mBL = 3 Then
               If mNutzer_B = 4 Or mNutzer_B = 5 Then
                  GoTo R|fffd|ckg|fffd|ngig2
               End If
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        
        Case 7  'siebter Eintrag im Dropdownfeld "Nichtoffenes Verfahren"
            
            If mBL = 3 Then
               If mNutzer_B = 4 Or mNutzer_B = 5 Then
                  GoTo R|fffd|ckg|fffd|ngig2
               End If
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        
        Case 8   'achter Eintrag im Dropdownfeld "Verhandlungsverfahren mit Teilnahmewettbewerb"
            
            If mBL = 3 Then
               If mNutzer_B = 4 Or mNutzer_B = 5 Then
                  GoTo R|fffd|ckg|fffd|ngig2
               End If
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            
            If VS = False Then
               ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = False
               ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
               ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            Else
               ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
               ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
               ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            End If
            
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            
            ActiveDocument.Bookmarks("TM9").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_VVmTW_WD").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_1_VV").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_1_VV_mTW").Range.Font.Hidden = False
            
            ActiveDocument.Bookmarks("TM9_VVoTW").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_1_VV_oTW").Range.Font.Hidden = True
                        
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
            
        Case 9  'neunter Eintrag im Dropdownfeld "Verhandlungsverfahren ohne Teilnahmewettbewerb"
            
            If mBL = 3 Then
               If mNutzer_B = 4 Or mNutzer_B = 5 Then
                  GoTo R|fffd|ckg|fffd|ngig2
               End If
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            
            If VS = False Then
               ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = False
               ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            Else
               ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
               ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = False
            End If
            
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            
            ActiveDocument.Bookmarks("TM9").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_VVmTW_WD").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_1_VV").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_1_VV_mTW").Range.Font.Hidden = True
            
            ActiveDocument.Bookmarks("TM9_VVoTW").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_1_VV_oTW").Range.Font.Hidden = False
            
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        
        Case 10 'zehnter Eintrag im Dropdownfeld "Wettbewerblicher Dialog"
            
            If mBL = 3 Then
               If mNutzer_B = 4 Or mNutzer_B = 5 Then
                  GoTo R|fffd|ckg|fffd|ngig2
               End If
            End If
            
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            
            If VS = False Then
              ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = False
              ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            Else
              ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
              ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = False
            End If
            
            ActiveDocument.Bookmarks("TM9").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_VVmTW_WD").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM9_1_VV").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_1_VV_mTW").Range.Font.Hidden = True
            
            ActiveDocument.Bookmarks("TM9_VVoTW").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_1_VV_oTW").Range.Font.Hidden = True
                        
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        
        Case 11 'elfter Eintrag im Dropdownfeld "Internationale NATO-Ausschreibung"
            ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM9_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM11").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM13").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("Selbstausf_all").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM19").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM21").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM23").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM25").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM28").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM56").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        
    End Select
    
    Call fcLose(False)
    Call fcNebenangebote(False)
    Call fcCheckbox_Sicherheitsleistungen(False)

    If mZV = True Then
        Call fcZeitvertrag(False, "fcVergabeart")   'Ausf|fffd|hrung der Function "Zeitvertrag" und |fffd|bergabe der Werte "False" und "fcVergabeart"
    End If

    Call fcEx_ante(False)
    
    Call fcAngemessene_Ang_Frist(False)
    
    Call fcEigenerkl|fffd|rung(False)
    Call fcSelbstausf|fffd|hrung(False)
    Call fcTeilnahmebedingungen(False)
    Call Inst_Ver|fffd|ffentlichung
        
    ActiveDocument.Bookmarks("DD3_Vergabeart_Dummy").Select

    If bProtect = True Then Call protectFile(True)

R|fffd|ckg|fffd|ngig1:  '-----------------------------------
    'Wenn VS = true dann keine |fffd|A und kein OV
    If VS = True Then
       If mVA = 2 Or mVA = 6 Then      '|fffd|A oder OV
          Geduld.hide                  'Ausblenden des Formulars "Geduld"
            
          MsgBox "Bei ""verteidigungs- und sicherheitsrelevanten Ma|fffd|nahmen"" sind die Leistungen nicht in einer ""|fffd|ffentlichen Ausschreibung"" oder einem ""Offenen Verfahren"" dem Wettbewerb zu unterstellen." & vbNewLine & vbNewLine & _
                 "Die gew|fffd|hlte Vergabeart wird daher auf ""bitte ausw|fffd|hlen..."" zur|fffd|ckgesetzt." & vbNewLine & vbNewLine & _
                 "Bitte w|fffd|hlen Sie anschlie|fffd|end eine andere Vergabeart.", vbInformation, "Pr|fffd|fung Vergabeart"
                     
          ActiveDocument.FormFields("DD3_Vergabeart").DropDown.Value = 1  'bitte ausw|fffd|hlen...
          Call Vergabeart
          
       End If
    End If
     
R|fffd|ckg|fffd|ngig2:
    'Wenn Gaststreitkr|fffd|fte, dann keine EU-Vergabearten
    If mBL = 3 Then
       If mNutzer_B = 4 Or mNutzer_B = 5 Then
          If mVA = 6 Or mVA = 7 Or mVA = 8 Or mVA = 9 Or mVA = 10 Then
             Geduld.hide                  'Ausblenden des Formulars "Geduld"
              
             MsgBox "Leistungen f|fffd|r die ""Gaststreitkr|fffd|fte"" sind nicht in einem EU-Vergabeverfahren dem Wettbewerb zu unterstellen." & vbNewLine & vbNewLine & _
                    "Die gew|fffd|hlte Vergabeart wird daher auf ""bitte ausw|fffd|hlen..."" zur|fffd|ckgesetzt." & vbNewLine & vbNewLine & _
                    "Bitte w|fffd|hlen Sie anschlie|fffd|end eine andere Vergabeart.", vbInformation, "Pr|fffd|fung Vergabeart"
                       
             ActiveDocument.FormFields("DD3_Vergabeart").DropDown.Value = 1  'bitte ausw|fffd|hlen...
             Call Vergabeart
          End If
       End If
    End If
'---------------------------------------------
     
End Function

Function fcTeilnahmebedingungen(Optional bProtect As Boolean = True)

  Call protectFile(False)
  
   'Vorzulegende Nachweise (Teilnahmebedingungen): Ein-/Ausblenden der Anforderungen an den Schutz von Verschlusssachen
    If VS = True Then
       If mVA = 7 Or mVA = 8 Or mVA = 10 Then      'NOV oder VV mit TW oder WD
          ActiveDocument.Bookmarks("TM28_1").Range.Font.Hidden = False
       Else
          ActiveDocument.Bookmarks("TM28_1").Range.Font.Hidden = True
       End If
    Else
       ActiveDocument.Bookmarks("TM28_1").Range.Font.Hidden = True
    End If
  
  If bProtect = True Then Call protectFile(True)
    
End Function

Sub Ex_ante()
    Call fcEx_ante
End Sub

Function fcEx_ante(Optional bProtect As Boolean = True)

    Call protectFile(False)
    
    Select Case mVA
    
    Case 3 'Beschr|fffd|nkte Ausschreibung
        
        If ActiveDocument.FormFields("AtrWert").Result >= 25000 And ActiveDocument.FormFields("TM2_CB4").CheckBox.Value = False And ActiveDocument.FormFields("TM2_CB5").CheckBox.Value = False Then
           If ActiveDocument.FormFields("TM2_CB1").CheckBox.Value = True Or ActiveDocument.FormFields("TM2_CB2").CheckBox.Value = True Or ActiveDocument.FormFields("TM2_CB3").CheckBox.Value = True Then
              ActiveDocument.Bookmarks("TM2_1").Range.Font.Hidden = False
           Else
              ActiveDocument.Bookmarks("TM2_1").Range.Font.Hidden = True
           End If
        Else
              ActiveDocument.Bookmarks("TM2_1").Range.Font.Hidden = True
        End If

    Case 1, 2, 4, 5, 6, 7, 8, 9, 10, 11 'alle anderen Vergabearten
         ActiveDocument.Bookmarks("TM2_1").Range.Font.Hidden = True

    End Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_VABegr()   'erste drei Checkboxen der Standardbegr|fffd|ndungen zur Beschr|fffd|nkten Ausschreibung
    Call fcCheckbox_VABegr
End Sub

Function fcCheckbox_VABegr(Optional bProtect As Boolean = True)

    Call protectFile(False)
    
    Call fcEx_ante

    ActiveDocument.Bookmarks("TM2_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)
    
End Function

Sub Angemessene_Ang_Frist() 'Die Angemessenheit der Angebotsfrist wird gepr|fffd|ft
    Call fcAngemessene_Ang_Frist
End Sub

Function fcAngemessene_Ang_Frist(Optional bProtect As Boolean = True)
    
If ActiveDocument.FormFields("AngFrist_Datum").Result = "" Then 'Wenn Angebotsfrist noch leer ist, Makro verlassen
   ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = True
   Exit Function
End If
    
Dim DateFristanfang As Date                                           'Variable = Datumsformat
Dim DateFristende As Date                                             'Variable = Datumsformat
    
     If ActiveDocument.Bookmarks("TM22").Range.Font.Hidden = False Then 'Wenn Versand der Vergabeunterlagen sichtbar
       
        If ActiveDocument.FormFields("TM22_Datum").Result = "" Then 'Wenn Versand VU noch leer ist, Makro verlassen
           ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = True
           Exit Function
        Else
           DateFristanfang = ActiveDocument.FormFields("TM22_Datum").Result
        End If
          
      Else
      
        If ActiveDocument.FormFields("TM19_Datum").Result = "" Then 'Wenn Ver|fffd|ffentlichungstermin noch leer ist, Makro verlassen
           ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = True
           Exit Function
        Else
           DateFristanfang = ActiveDocument.FormFields("TM19_Datum").Result
        End If
      
      End If
      
      DateFristende = ActiveDocument.FormFields("AngFrist_Datum").Result
       
      If DateFristende - DateFristanfang < 29 Then 'Wenn zwischen Versand VU und Angebotsfrist weniger als x-Tage liegen.
                                                   'Wert ist 29, da bei EU-Verfahren der VErsand sp|fffd|testens 2 Tage vor Ver|fffd|ffentlichung erfolgt
         ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = False
         Else
         ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = True
      End If
     
End Function

Sub Zeitspanne_Ausf_Beginn()

    If ActiveDocument.FormFields("Zuschlagsfrist").Result = "" Or ActiveDocument.FormFields("Ausf|fffd|hrung_Beginn").Result = "" Then Exit Sub
       
    Dim Diff As Integer

    Diff = DateDiff("d", Left(ActiveDocument.FormFields("Zuschlagsfrist").Result, 10), Left(ActiveDocument.FormFields("Ausf|fffd|hrung_Beginn").Result, 10))
    
    If Diff < 21 Then
       MsgBox "Die Zeitspanne zwischen dem Ablauf der Bindefrist und dem vorgesehenen Ausf|fffd|hrungsbeginn liegt unter 3 Wochen!" & vbNewLine & vbNewLine & _
              "M|fffd|glicherweise ist damit eine f|fffd|r die Vertragsabwicklung notwendige Arbeitsvorbereitung durch den Auftragnehmer, insbesondere bei einer evtl. erforderlichen Bindefristverl|fffd|ngerung, nicht m|fffd|glich." & vbNewLine & vbNewLine & _
              "Bitte erweitern Sie gegebenenfalls die Zeitspanne.", vbInformation, "Pr|fffd|fung Zeitspanne Arbeitsvorbereitung"
    End If

End Sub


Sub AngFrist_Begr_Text()

   'nur wenn leer
    If ActiveDocument.FormFields("AngFrist_Begr_Text").Range.Font.Hidden = False And _
       ActiveDocument.FormFields("AngFrist_Begr_Text").Result = "" Then

       If MsgBox("M|fffd|chten Sie eine ""Standard-Begr|fffd|ndung"" |fffd|bernehmen?" + vbNewLine + vbNewLine + _
                 "Diese Begr|fffd|ndung ist anschlie|fffd|end auf den vorliegenden Einzelfall anzupassen!", vbYesNo + vbQuestion, "Standard-Begr|fffd|ndung") = vbYes Then

          ActiveDocument.FormFields("AngFrist_Begr_Text").Result = "Die vorgenannte Angebotsfrist r|fffd|umt den Bietern auch unter Ber|fffd|cksichtigung einer evtl. Nachunternehmerbeteiligung ausreichend Zeit f|fffd|r eine ordnungsgem|fffd||fffd|e Kalkulation der im LV ausgewiesenen Leistungen ein."
            
       End If

    End If

End Sub


Sub Eigenerkl|fffd|rung()
    Call fcEigenerkl|fffd|rung
End Sub

Function fcEigenerkl|fffd|rung(Optional bProtect As Boolean = True)
 
    Call protectFile(False)
 
    If ActiveDocument.Bookmarks("TM13_DD1").Range.Font.Hidden = False Then
       If ActiveDocument.FormFields("TM13_DD1").DropDown.Value = 3 Or ActiveDocument.FormFields("TM13_DD2").DropDown.Value = 3 Or ActiveDocument.FormFields("TM13_DD3").DropDown.Value = 3 Or _
          ActiveDocument.FormFields("TM13_DD4").DropDown.Value = 3 Or ActiveDocument.FormFields("TM13_DD5").DropDown.Value = 3 Or ActiveDocument.FormFields("TM13_DD6").DropDown.Value = 3 Or _
          ActiveDocument.FormFields("TM13_DD7").DropDown.Value = 3 Or ActiveDocument.FormFields("TM13_DD8").DropDown.Value = 3 Then
 
          ActiveDocument.Bookmarks("TM13_Erkl").Range.Font.Hidden = False
       Else
          ActiveDocument.Bookmarks("TM13_Erkl").Range.Font.Hidden = True
       End If
 
    Else
       ActiveDocument.Bookmarks("TM13_Erkl").Range.Font.Hidden = True
    End If
 
    ActiveDocument.Bookmarks("TM13_DD_Dummy").Select
 
    If bProtect = True Then Call protectFile(True)

End Function

Sub Selbstausf|fffd|hrung() 'Selbstausf|fffd|hrungspflicht bei EU-VErfahren
    Call fcSelbstausf|fffd|hrung
End Sub

Function fcSelbstausf|fffd|hrung(Optional bProtect As Boolean = True) 'Selbstausf|fffd|hrungspflicht bei EU-VErfahren
        
 If ActiveDocument.Bookmarks("Selbstausf").Range.Font.Hidden = True Then
    ActiveDocument.FormFields("Selbstausf_CB").CheckBox.Value = False
    ActiveDocument.FormFields("Selbstausf_Begr_Txt").Result = ""
    ActiveDocument.FormFields("Selbstausf_Txt").Result = ""
    Exit Function
 End If
 
 If ActiveDocument.FormFields("Selbstausf_CB").CheckBox.Value = False Then
    ActiveDocument.FormFields("Selbstausf_Begr_Txt").Result = ""
    ActiveDocument.FormFields("Selbstausf_Txt").Result = ""
    ActiveDocument.Bookmarks("Selbstausf_ja").Range.Font.Hidden = True
 Else
    ActiveDocument.Bookmarks("Selbstausf_ja").Range.Font.Hidden = False
 End If
 
 ActiveDocument.Bookmarks("Selbstausf_Dummy").Select
        
End Function


Sub HHDaten_Mittelart()
    Call fcHHDaten_Mittelart
End Sub

Function fcHHDaten_Mittelart(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
       
    Select Case ActiveDocument.FormFields("TM15_DD").DropDown.Value
    
        Case 1      '"bitte ausw|fffd|hlen..."
            ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = True   'Baumittel       (Land)
                ActiveDocument.FormFields("TM16_Titel").Result = ""
                Call TM16_Titel
            
            ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = True   'Verm|fffd|gensmittel (Land)
            ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = True 'Sonstige Mittel (Land)

        Case 2      '"Baumittel"
            ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = True

        Case 3      '"Bau- und Nutzermittel"
            ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = False

        Case 4      '"Verm|fffd|gensmittel"
            ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = True
                ActiveDocument.FormFields("TM16_Titel").Result = ""
                Call TM16_Titel
            
            ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = True
    
         Case 5      '"Sonstige (Dritte)"
            ActiveDocument.Bookmarks("TM16").Range.Font.Hidden = True
                ActiveDocument.FormFields("TM16_Titel").Result = ""
                Call TM16_Titel
                       
            ActiveDocument.Bookmarks("TM17").Range.Font.Hidden = True
            ActiveDocument.Bookmarks("TM17_1").Range.Font.Hidden = False
    
    End Select
       
    ActiveDocument.Bookmarks("TM15_DD_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function


Sub TM16_Titel()

    If ActiveDocument.FormFields("TM16_Titel").Range.Font.Hidden = False And _
       ActiveDocument.FormFields("TM16_Titel").Result <> "" Then
       
       On Error GoTo weiter
                    
       Dim Titel As String
       
      'Leerzeichen entfernen
       Titel = Replace(ActiveDocument.FormFields("TM16_Titel").Result, " ", "")
       ActiveDocument.FormFields("TM16_Titel").Result = Titel
       
       If Titel = "51901" Or Titel = "71101" Then
          ActiveDocument.Bookmarks("TM16_1").Range.Font.Hidden = False
       Else
          GoTo weiter
       End If

    Else
weiter:
       ActiveDocument.FormFields("Finanzpos_DD").DropDown.Value = 1
       ActiveDocument.Bookmarks("TM16_1").Range.Font.Hidden = True
    End If

End Sub


Sub Checkbox_Anlagen()
    Call fcCheckbox_Anlagen
End Sub

Function fcCheckbox_Anlagen(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM24_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM24_1").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("TM24_2").Range.Font.Hidden = False
    Else
       ActiveDocument.FormFields("TM24_1_CB").CheckBox.Value = False
       Call fcAnlagen_Verfahren_CB(False)
       ActiveDocument.Bookmarks("TM24_1").Range.Font.Hidden = True
       
       ActiveDocument.FormFields("TM24_2_CB").CheckBox.Value = False
       Call fcAnlagen_Vertrag_CB(False)
       ActiveDocument.Bookmarks("TM24_2").Range.Font.Hidden = True
    
    End If

    ActiveDocument.Bookmarks("TM24_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)
    
End Function

Sub Anlagen_Verfahren_CB()
    Call fcAnlagen_Verfahren_CB
End Sub

Function fcAnlagen_Verfahren_CB(Optional bProtect As Boolean = True)
    
    Call protectFile(False)

    If ActiveDocument.FormFields("TM24_1_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM24_1_Anlagen").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM24_1_Anlagen").Range.Font.Hidden = True
    End If
    
    ActiveDocument.Bookmarks("TM24_1_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Anlagen_Vertrag_CB()
    Call fcAnlagen_Vertrag_CB
End Sub

Function fcAnlagen_Vertrag_CB(Optional bProtect As Boolean = True)
    
    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM24_2_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM24_2_1").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("TM24_2_2").Range.Font.Hidden = False
    Else
       ActiveDocument.FormFields("TM24_2_1_CB").CheckBox.Value = False
       Call fcAnlagen_Vertrag_Plaene_CB(False)
       ActiveDocument.Bookmarks("TM24_2_1").Range.Font.Hidden = True
       
       ActiveDocument.FormFields("TM24_2_2_CB").CheckBox.Value = False
       Call fcAnlagen_Vertrag_Sonstige(False)
       ActiveDocument.Bookmarks("TM24_2_2").Range.Font.Hidden = True
       
    End If

    ActiveDocument.Bookmarks("TM24_2_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Anlagen_Vertrag_Plaene_CB()
    Call fcAnlagen_Vertrag_Plaene_CB
End Sub

Function fcAnlagen_Vertrag_Plaene_CB(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM24_2_1_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM24_2_1_Text").Range.Font.Hidden = False
       
       ActiveDocument.Bookmarks("TM24_2_1_Ja").Range.Font.Hidden = False
       Call Anlagen_Vertrag_Plaene_Ja(False)
       
       ActiveDocument.Bookmarks("TM24_2_1_Nein").Range.Font.Hidden = False
       Call Anlagen_Vertrag_Plaene_Nein(False)
    Else
       ActiveDocument.Bookmarks("TM24_2_1_Text").Range.Font.Hidden = True
       
       ActiveDocument.TM24_2_1_RB1.Value = False
       ActiveDocument.FormFields("TM24_2_1_AnzPlaene").Result = ""
       ActiveDocument.Bookmarks("TM24_2_1_Ja").Range.Font.Hidden = True
       
       ActiveDocument.TM24_2_1_RB2.Value = False
       Call Anlagen_Vertrag_Plaene_Nein(False)
       ActiveDocument.Bookmarks("TM24_2_1_Nein").Range.Font.Hidden = True
    End If
    
    ActiveDocument.Bookmarks("TM24_2_1_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Function Anlagen_Vertrag_Plaene_Ja(Optional bProtect As Boolean = True)

    Call protectFile(False)
       
       If ActiveDocument.TM24_2_1_RB1.Value = True Then
          ActiveDocument.Bookmarks("TM24_2_1_Ja_Anzahl").Range.Font.Hidden = False
          Call Anlagen_Vertrag_Plaene_Nein(False)
       Else
          ActiveDocument.Bookmarks("TM24_2_1_Ja_Anzahl").Range.Font.Hidden = True
       End If
       
    ActiveDocument.Bookmarks("TM24_2_1_Ja_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Function Anlagen_Vertrag_Plaene_Nein(Optional bProtect As Boolean = True)

    Call protectFile(False)
       
       If ActiveDocument.TM24_2_1_RB2.Value = True Then
          ActiveDocument.Bookmarks("TM24_2_1_Nein_Plaene").Range.Font.Hidden = False
          Call Anlagen_Vertrag_Plaene_Ja(False)
       Else
          ActiveDocument.Bookmarks("TM24_2_1_Nein_Plaene").Range.Font.Hidden = True
       End If
       
    ActiveDocument.Bookmarks("TM24_2_1_Nein_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Anlagen_Vertrag_Sonstige()
    Call fcAnlagen_Vertrag_Sonstige
End Sub

Function fcAnlagen_Vertrag_Sonstige(Optional bProtect As Boolean = True)

    Call protectFile(False)
       
       If ActiveDocument.FormFields("TM24_2_2_CB").CheckBox.Value = True Then
          ActiveDocument.Bookmarks("TM24_2_2_Anlagen").Range.Font.Hidden = False
       Else
          ActiveDocument.Bookmarks("TM24_2_2_Anlagen").Range.Font.Hidden = True
       End If
       
    ActiveDocument.Bookmarks("TM24_2_2_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function
   
    
Sub Anlagen_Link()

    If ActiveDocument.FormFields("Anlagen_Ort_Text").Result <> "" Then
       Dim Link As String
       
       On Error GoTo weiter
       
      'Leerzeichen am Anfang und Ende entfernen
       Link = Trim(ActiveDocument.FormFields("Anlagen_Ort_Text").Result)
       ActiveDocument.FormFields("Anlagen_Ort_Text").Result = Link
       
      'Link existiert
       If Dir(Link, vbDirectory) <> "" Then

          Call protectFile(False)
             ActiveDocument.Bookmarks("Anlagen_Link").Range.Font.Hidden = False
             ActiveDocument.Bookmarks("Anlagen_Link").Select
             Selection.Font.Size = 8
       
             ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:=Link _
             , SubAddress:="", ScreenTip:="", TextToDisplay:="Link zu den Anlagen"

          Call protectFile(True)

          
      'Link existiert nicht
       Else
          GoTo weiter
       End If

       
    Else
weiter:
       ActiveDocument.Bookmarks("Anlagen_Link").Range.Font.Hidden = True
    End If

End Sub


Sub Checkbox_Instandhaltung()
    Call fcCheckbox_Instandhaltung
End Sub

Function fcCheckbox_Instandhaltung(Optional bProtect As Boolean = True)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("Instand_CB").CheckBox.Value = True Then
    
        ActiveDocument.Bookmarks("Instand_Formulare_Anz_Z").Range.Font.Hidden = False
        
        ActiveDocument.Bookmarks("TM184").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM184_AG_Z").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("Inst_Z").Range.Font.Hidden = False
        
        ActiveDocument.Bookmarks("Inst_Barwert_Z").Range.Font.Hidden = True 'Zeile Barwert ausblenden
        
        ActiveDocument.Bookmarks("Inst_Hinweis").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("Instand_Formulare_Anz_Z").Range.Font.Hidden = True
         ActiveDocument.FormFields("Instand_FormulareAnz").Result = ""
        
         For i = 1 To 4
           ActiveDocument.FormFields("Instand_VM_DD" & i).DropDown.Value = 1
           ActiveDocument.FormFields("Instand_VM_Anz" & i).Result = ""
           ActiveDocument.Bookmarks("Instand_VM_DD" & i & "_Z").Range.Font.Hidden = True
         Next
         
        ActiveDocument.Bookmarks("TM184").Range.Font.Hidden = True
          ActiveDocument.FormFields("TM184_DD").DropDown.Value = 1
        ActiveDocument.Bookmarks("TM184_AG_Z").Range.Font.Hidden = True
          ActiveDocument.FormFields("TM184_AG").Result = ""
          
        ActiveDocument.Bookmarks("Inst_Z").Range.Font.Hidden = True
          ActiveDocument.FormFields("Inst_Bestandteil_CB2").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_Gegenstand_CB1").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_Gegenstand_CB2").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_Gegenstand_CB3").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_Gegenstand_Text").Result = ""
          ActiveDocument.FormFields("Inst_Anl_Bez").Result = ""
          ActiveDocument.FormFields("Inst_Anl_Beibl_CB").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_AK_CB1").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_AK_CB2").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_AK_CB3").CheckBox.Value = False
          ActiveDocument.FormFields("Inst_Laufzeit").Result = ""
          ActiveDocument.FormFields("Inst_Barwert").Result = ""
        
        ActiveDocument.Bookmarks("Inst_Hinweis").Range.Font.Hidden = True
        
    End If

    Call Inst_Ver|fffd|ffentlichung

    ActiveDocument.Bookmarks("Instand_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub Instand_FormulareAnz()

    If ActiveDocument.FormFields("Instand_FormulareAnz").Result < 1 Or ActiveDocument.FormFields("Instand_FormulareAnz").Result > 4 Then
       MsgBox "Bitte geben Sie einen Zahlenwert zwischen 1 und 4 ein.", vbCritical, "Pr|fffd|fung Eingabewert"
       ActiveDocument.FormFields("Instand_FormulareAnz").Result = ""
    End If


    If ActiveDocument.FormFields("Instand_FormulareAnz").Result = "" Then
       
       For i = 1 To 4
         ActiveDocument.FormFields("Instand_VM_DD" & i).DropDown.Value = 1
         ActiveDocument.FormFields("Instand_VM_Anz" & i).Result = ""
         ActiveDocument.Bookmarks("Instand_VM_DD" & i & "_Z").Range.Font.Hidden = True
       Next
       
       Exit Sub
    End If
    
    
    If ActiveDocument.FormFields("Instand_FormulareAnz").Result = 1 Then
       ActiveDocument.Bookmarks("Instand_VM_DD1_Z").Range.Font.Hidden = False
       
       For i = 2 To 4
         ActiveDocument.FormFields("Instand_VM_DD" & i).DropDown.Value = 1
         ActiveDocument.FormFields("Instand_VM_Anz" & i).Result = ""
         ActiveDocument.Bookmarks("Instand_VM_DD" & i & "_Z").Range.Font.Hidden = True
       Next
    
       Exit Sub
    End If
    
    
    If ActiveDocument.FormFields("Instand_FormulareAnz").Result = 2 Then
       ActiveDocument.Bookmarks("Instand_VM_DD1_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD2_Z").Range.Font.Hidden = False
       
       For i = 3 To 4
         ActiveDocument.FormFields("Instand_VM_DD" & i).DropDown.Value = 1
         ActiveDocument.FormFields("Instand_VM_Anz" & i).Result = ""
         ActiveDocument.Bookmarks("Instand_VM_DD" & i & "_Z").Range.Font.Hidden = True
       Next
    
       Exit Sub
    End If
    
    
    If ActiveDocument.FormFields("Instand_FormulareAnz").Result = 3 Then
       ActiveDocument.Bookmarks("Instand_VM_DD1_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD2_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD3_Z").Range.Font.Hidden = False
       
       For i = 4 To 4
         ActiveDocument.FormFields("Instand_VM_DD" & i).DropDown.Value = 1
         ActiveDocument.FormFields("Instand_VM_Anz" & i).Result = ""
         ActiveDocument.Bookmarks("Instand_VM_DD" & i & "_Z").Range.Font.Hidden = True
       Next
    
       Exit Sub
    End If
    
     
    If ActiveDocument.FormFields("Instand_FormulareAnz").Result = 4 Then
       ActiveDocument.Bookmarks("Instand_VM_DD1_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD2_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD3_Z").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("Instand_VM_DD4_Z").Range.Font.Hidden = False
           
       Exit Sub
    End If
 
End Sub


Function Inst_Ver|fffd|ffentlichung()

    If ActiveDocument.FormFields("TM11_Text").Range.Font.Hidden = False And _
       ActiveDocument.FormFields("Instand_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM11_Instandhaltung").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM11_Instandhaltung").Range.Font.Hidden = True
    End If

End Function


Sub Inst_Laufzeit()

    If ActiveDocument.FormFields("Inst_Laufzeit").Result <> "" Then

       Dim LZ As Double
           LZ = ActiveDocument.FormFields("Inst_Laufzeit").Result

       If LZ > 5 Then
          ActiveDocument.Bookmarks("Inst_Barwert_Z").Range.Font.Hidden = False
       Else
          GoTo weiter
       End If
       
    Else
    
weiter:
       If ActiveDocument.Bookmarks("Inst_Barwert_Z").Range.Font.Hidden = False Then
          ActiveDocument.FormFields("Inst_Barwert").Result = ""
          ActiveDocument.Bookmarks("Inst_Barwert_Z").Range.Font.Hidden = True
       End If
       
    End If


End Sub

Sub Inst_AK_CB1()

    ActiveDocument.FormFields("Inst_AK_CB2").CheckBox.Value = False
    ActiveDocument.FormFields("Inst_AK_CB3").CheckBox.Value = False
    ActiveDocument.Bookmarks("Inst_Laufzeit").Select

End Sub

Sub Inst_AK_CB2()

    ActiveDocument.FormFields("Inst_AK_CB1").CheckBox.Value = False
    ActiveDocument.FormFields("Inst_AK_CB3").CheckBox.Value = False
    ActiveDocument.Bookmarks("Inst_Laufzeit").Select

End Sub

Sub Inst_AK_CB3()

    ActiveDocument.FormFields("Inst_AK_CB1").CheckBox.Value = False
    ActiveDocument.FormFields("Inst_AK_CB2").CheckBox.Value = False
    ActiveDocument.Bookmarks("Inst_Laufzeit").Select

End Sub


Sub NettoFeld()
    NettoBrutto = "netto"
End Sub

Sub BruttoFeld()
    NettoBrutto = "brutto"
End Sub

Sub Preisaufgliederung()

' Aufruf von "DD1_Betrieb" / "AtrWert" / "AtrWertBrutto" / "TM29_CB2"

    Call fcPreisaufgliederung

End Sub

Function fcPreisaufgliederung(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    If ActiveDocument.FormFields("AtrWert").Result = "" Then               'verhindert Fehlermeldung bei fehlendem Atr.-Wert
       ActiveDocument.FormFields("AtrWert").Result = 0
    Else
       If Not IsNumeric(ActiveDocument.FormFields("AtrWert").Result) Then  'wenn Feldinhalt nicht nummerisch, dann...
          MsgBox "Im Feld ""voraussichtlicher Auftragswert"" d|fffd|rfen nur Zahlen eingegeben werden." & vbNewLine & _
                 "Ihre Eintragung entspricht nicht dieser Vorgabe." & vbNewLine & vbNewLine & _
                 "Bitte geben Sie einen zul|fffd|ssigen Wert ein.", vbCritical, "Pr|fffd|fung Eingabewert"
          ActiveDocument.FormFields("AtrWert").Result = ""
          Exit Function
      End If
    End If
    
    If ActiveDocument.FormFields("AtrWertBrutto").Result = "" Then               'verhindert Fehlermeldung bei fehlendem Atr.-Wert
       ActiveDocument.FormFields("AtrWertBrutto").Result = 0
    Else
       If Not IsNumeric(ActiveDocument.FormFields("AtrWertBrutto").Result) Then  'wenn Feldinhalt nicht nummerisch, dann...
          MsgBox "Im Feld ""voraussichtlicher Auftragswert"" d|fffd|rfen nur Zahlen eingegeben werden." & vbNewLine & _
                 "Ihre Eintragung entspricht nicht dieser Vorgabe." & vbNewLine & vbNewLine & _
                 "Bitte geben Sie einen zul|fffd|ssigen Wert ein.", vbCritical, "Pr|fffd|fung Eingabewert"
          ActiveDocument.FormFields("AtrWertBrutto").Result = ""
          Exit Function
      End If
    End If
    
'brutto / netto dynamisch anpassen
    If NettoBrutto = "netto" Then _
        ActiveDocument.FormFields("AtrWertBrutto").Result = ActiveDocument.FormFields("AtrWert").Result * USt
    If NettoBrutto = "brutto" Then _
        ActiveDocument.FormFields("AtrWert").Result = ActiveDocument.FormFields("AtrWertBrutto").Result / USt
    NettoBrutto = ""
    

    Call protectFile(False)
    
    Call fcAutoSicherheitsleistung(False)          'bei |fffd|A und OV und >250000 automatisch Sicherheiten ankreuzen

'zweiter/dritter Eintrag in Dropdownfeld Betrieb (Land bzw. Bund) und kein Zeitvertrag gew|fffd|hlt
    If mBL > 1 And mZV = False Then
        ActiveDocument.Bookmarks("TM29").Range.Font.Hidden = False
        Call fcAufgliederung_der_EP(False)
        Call fcPreisermittlung(False)

              
    Else
    'erster Eintrag in Dropdownfeld Betrieb "bitte ausw|fffd|hlen..." oder Zeitvertrag
        ActiveDocument.Bookmarks("TM29").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM51").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM52").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = True
    End If


    If mBL = 2 And ActiveDocument.FormFields("AtrWert").Result >= LTMG_Wert Then    'Land + LTMG-Wert |fffd|berschritten
       ActiveDocument.Bookmarks("Anl_LTMG").Range.Font.Hidden = False               'Anlagen zum Landestariftreue- + Mindestlohngesetz
       ActiveDocument.Bookmarks("Anl_LTMG_lite").Range.Font.Hidden = True           'Lite-Version der VE zur Tariftreue und Mindestentlohnung
    
    ElseIf mBL = 2 And ActiveDocument.FormFields("AtrWert").Result < LTMG_Wert Then 'Land + LTMG-Wert unterschritten
       ActiveDocument.Bookmarks("Anl_LTMG").Range.Font.Hidden = True
       ActiveDocument.Bookmarks("Anl_LTMG_lite").Range.Font.Hidden = False
    
    Else
       ActiveDocument.Bookmarks("Anl_LTMG").Range.Font.Hidden = True
       ActiveDocument.Bookmarks("Anl_LTMG_lite").Range.Font.Hidden = True
    End If


    Call fcEx_ante(False)
    Call fcAufgliederung_alle_EP

    ActiveDocument.FormFields("AtrWert_Dummy").Select

    If bProtect = True Then Call protectFile(True)
    
End Function

Function fcAutoSicherheitsleistung(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)
    If (mVA = 2 Or mVA = 6) And ActiveDocument.FormFields("AtrWert").Result >= 250000 Then
        ActiveDocument.FormFields("TM37_CB").CheckBox.Value = True
        ActiveDocument.FormFields("TM37_VtrgErf_CB").CheckBox.Value = True
        ActiveDocument.FormFields("TM37_Maengel_CB").CheckBox.Value = True
    Else
        ActiveDocument.FormFields("TM37_CB").CheckBox.Value = False
        ActiveDocument.FormFields("TM37_VtrgErf_CB").CheckBox.Value = False
        ActiveDocument.FormFields("TM37_Maengel_CB").CheckBox.Value = False
    End If
    Call fcCheckbox_Sicherheitsleistungen(False)
End Function

Sub Nebenangebote()
   Call fcNebenangebote
End Sub

Function fcNebenangebote(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    Select Case ActiveDocument.FormFields("TM30_DD").DropDown.Value
    
        Case 1      'bitte ausw|fffd|hlen...
            ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
            Call fcNebenangebot_nein(False)
            
        Case 2      'NA sind zugelassen
        
            Select Case mVA 'Vergabeart
                Case 1              '"bitte ausw|fffd|hlen..."
                ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
                Call fcNebenangebot_nein(False)
                
                Case 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 'alle Verfahren, ehemals nur nationale Verfahren
                ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
                Call fcNebenangebot_ja(False)
        
                Case 9999  'ehemals EU-weite Verfahren, derzeit keine mehr
                If ActiveDocument.FormFields("TM25_CB").CheckBox.Value = False Then  'nur Kriterium "Preis"
                   ActiveDocument.FormFields("TM30_DD").DropDown.Value = 3           'Setze Wert auf "NA nicht zugelassen"
                   ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
                   Call fcNebenangebot_nein(False)
                Else
                   ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
                   Call fcNebenangebot_ja(False)
                End If
            End Select
            
        Case 3      'NA sind nicht zugelassen
        
            Select Case mVA 'Vergabeart
                Case 1              '"bitte ausw|fffd|hlen..."
                ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
    
                Case 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 'alle Verfahren, ehemals nur nationale Verfahren
                ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = False
        
                Case 9999  'ehemals EU-weite Verfahren, derzeit keine mehr
                If ActiveDocument.FormFields("TM25_CB").CheckBox.Value = False Then  'nur Kriterium "Preis"
                   ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
                Else
                   ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = False
                End If
                
            End Select
            
            Call fcNebenangebot_nein(False)
            
    End Select
        
    ActiveDocument.Bookmarks("TM30_DD_Dummy").Select
        
    If bProtect = True Then Call protectFile(True)
    
End Function


Function fcNebenangebot_nein(Optional bProtect As Boolean = True)

    Call protectFile(False)

         ActiveDocument.TM31_RB1.Value = False
         ActiveDocument.TM31_RB2.Value = False
            ActiveDocument.FormFields("TM31_1_Text").Result = ""
         
         ActiveDocument.TM31_RB3.Value = False
            ActiveDocument.FormFields("TM31_2_Text").Result = ""
         
         ActiveDocument.FormFields("TM31_CB").CheckBox.Value = False
            ActiveDocument.FormFields("TM31_3_CB").CheckBox.Value = False
            ActiveDocument.FormFields("TM31_3_Text").Result = ""
         
         ActiveDocument.Bookmarks("TM31").Range.Font.Hidden = True

    If bProtect = True Then Call protectFile(True)

End Function

Function fcNebenangebot_ja(Optional bProtect As Boolean = True)

    Call protectFile(False)

         ActiveDocument.Bookmarks("TM31").Range.Font.Hidden = False
         Call fcNebenang_zugelassen(False)
         Call fcNebenang_zugel_WB(False)

    If bProtect = True Then Call protectFile(True)

End Function

Sub Nebenang_zugelassen()
    Call fcNebenang_zugelassen
End Sub

Function fcNebenang_zugelassen(Optional bProtect As Boolean = True)

    Call protectFile(False)

    '----------------------------------------------------------------------------------------------------
    'Abh|fffd|ngigkeit Stoffpreisgleitklausel:
    'Sicherstellung, dass keine Nebenangebote |fffd|ber den Verzicht auf Stoffpreisgleitung eingereicht werden k|fffd|nnen,
    'wenn die Stoffpreisgleitung Bestandteil des Verfahrens ist
    
     If ActiveDocument.FormFields("TM81_CB").CheckBox.Value = True Then   'Anlage "Stoffpreigleitklausel" ausgew|fffd|hlt
        'Ausblenden der Auswahl "f|fffd|r die gesamte Leistung" (1. RB)
        ActiveDocument.TM31_RB1.Value = False
        ActiveDocument.Bookmarks("TM31_ges_Leist").Range.Font.Hidden = True
       
        'Auswahl 2. RB
        If ActiveDocument.TM31_RB2.Value = True Then
           ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = False
           ActiveDocument.Bookmarks("TM31_2_Stoff").Range.Font.Hidden = True
           ActiveDocument.FormFields("TM31_2_Text").Result = ""
           ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = True
           ActiveDocument.Bookmarks("TM31_1_Text").Select
        Else
           ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = True
        End If
       
        'Auswahl 3. RB
        If ActiveDocument.TM31_RB3.Value = True Then
           ActiveDocument.FormFields("TM31_1_Text").Result = ""
           ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = True
           ActiveDocument.Bookmarks("TM31_2_Stoff").Range.Font.Hidden = False
           ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = False
           ActiveDocument.Bookmarks("TM31_2_Text").Select
        Else
           ActiveDocument.Bookmarks("TM31_2_Stoff").Range.Font.Hidden = True
           ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = True
        End If
        
        If bProtect = True Then Call protectFile(True)
        Exit Function
     
     Else
        ActiveDocument.Bookmarks("TM31_ges_Leist").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM31_2_Stoff").Range.Font.Hidden = True
     End If
    
    '----------------------------------------------------------------------------------------------------
       
       'Steuerung in Abh|fffd|ngigkeit der Radiobutton-Auswahl

       If ActiveDocument.TM31_RB1.Value = True Then
          ActiveDocument.FormFields("TM31_1_Text").Result = ""
          ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = True
          ActiveDocument.FormFields("TM31_2_Text").Result = ""
          ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = True
          ActiveDocument.Bookmarks("TM31_Dummy").Select
       End If
                
       If ActiveDocument.TM31_RB2.Value = True Then
          ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = False
          ActiveDocument.FormFields("TM31_2_Text").Result = ""
          ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = True
          ActiveDocument.Bookmarks("TM31_1_Text").Select
       Else
          ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = True
       End If
       
       If ActiveDocument.TM31_RB3.Value = True Then
          ActiveDocument.FormFields("TM31_1_Text").Result = ""
          ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = True
          ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = False
          ActiveDocument.Bookmarks("TM31_2_Text").Select
       Else
          ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = True
       End If
    
       
    If bProtect = True Then Call protectFile(True)


End Function

Sub Nebenang_zugel_WB()
    Call fcNebenang_zugel_WB

End Sub

Function fcNebenang_zugel_WB(Optional bProtect As Boolean = True)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM31_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM31_3").Range.Font.Hidden = False
    Else
        ActiveDocument.FormFields("TM31_3_CB").CheckBox.Value = False
        ActiveDocument.FormFields("TM31_3_Text").Result = ""
        ActiveDocument.Bookmarks("TM31_3").Range.Font.Hidden = True

    End If
  
    ActiveDocument.Bookmarks("TM31_3_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_Zuschlagskriterien()
    Call fcCheckbox_Zuschlagskriterien
End Sub

Function fcCheckbox_Zuschlagskriterien(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM25_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = False
    Else
        ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = True
    End If

    Call fcNebenangebote(False)

    ActiveDocument.Bookmarks("TM25_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_Vertragsstrafe()

    Call fcCheckbox_Vertragsstrafe
    
End Sub

Function fcCheckbox_Vertragsstrafe(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM36_CB").CheckBox.Value = True Then
    
        'Bund + US-Gaststreitkr|fffd|fte"
         If mBL = 3 And mNutzer_B = 4 Then
            ActiveDocument.Bookmarks("TM36").Range.Font.Hidden = True
        
            ActiveDocument.Bookmarks("TM144_Gesamt").Range.Font.Hidden = False
        
        '"bitte ausw|fffd|hlen..." + Land + Bund ohne US-Gaststreitkr|fffd|fte
         Else
            ActiveDocument.Bookmarks("TM36").Range.Font.Hidden = False
                      
            ActiveDocument.Bookmarks("TM144_Gesamt").Range.Font.Hidden = True
           
         End If
             
    Else
        ActiveDocument.Bookmarks("TM36").Range.Font.Hidden = True
        
        ActiveDocument.Bookmarks("TM144_Gesamt").Range.Font.Hidden = True
        
    End If

    ActiveDocument.Bookmarks("TM36_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)
    
End Function

Sub Checkbox_Zahlung()

    Call fcCheckbox_Zahlung

End Sub

Function fcCheckbox_Zahlung(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

 Call protectFile(False)

 If mZV = False Then      'kein Zeitvertrag
             
    Select Case mBL
            
        Case 1, 2 '"bitte ausw|fffd|hlen" + Land
           ActiveDocument.Bookmarks("TM167").Range.Font.Hidden = False
           
           If ActiveDocument.FormFields("TM167_CB").CheckBox.Value = True Then
              ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = False
              Call fcCheckbox_Zahlung_CBen
           Else
              ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
              ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
           End If

        Case 3 'Bund
              
           Select Case mNutzer_B
               
             Case 1, 2, 3 '"bitte ausw|fffd|hlen", Zivil, Bundeswehr
                ActiveDocument.Bookmarks("TM167").Range.Font.Hidden = False
                
                If ActiveDocument.FormFields("TM167_CB").CheckBox.Value = True Then
                   ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = False
                   Call fcCheckbox_Zahlung_CBen
                Else
                   ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
                   ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
                End If
                    
             Case 4 'US-Gaststreitkr|fffd|fte, hier gibt es einen speziellen Textbaustein in den WBVBs (TM138), so dass die Anzeige "Zahlungsfrist" entfallen kann
                ActiveDocument.FormFields("TM167_CB").CheckBox.Value = False
                ActiveDocument.Bookmarks("TM167").Range.Font.Hidden = True
                ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
                ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
                   
             Case 5 'franz.-Gaststreitkr|fffd|fte
                ActiveDocument.Bookmarks("TM167").Range.Font.Hidden = False
                
                If ActiveDocument.FormFields("TM167_CB").CheckBox.Value = True Then
                   ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
                   ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = False
                   ActiveDocument.Bookmarks("TM169_Dummy").Select
                Else
                   ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
                   ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
                End If
                
              End Select
                
    End Select
    
    ActiveDocument.Bookmarks("TM167_CB_Dummy").Select

 Else 'Zeitvertrag = ja
   ActiveDocument.FormFields("TM167_CB").CheckBox.Value = False
   ActiveDocument.Bookmarks("TM167").Range.Font.Hidden = True
   ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = True
   ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
   
 End If


 If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_Zahlung_CBen()

    Call fcCheckbox_Zahlung_CBen

End Sub

Function fcCheckbox_Zahlung_CBen(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM168_1_CB").CheckBox.Value = False And ActiveDocument.FormFields("TM168_2_CB").CheckBox.Value = False And ActiveDocument.FormFields("TM168_3_CB").CheckBox.Value = False And ActiveDocument.FormFields("TM168_4_Text").Result = "" Then
       ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = True
       ActiveDocument.Bookmarks("TM168_Dummy").Select
       
    Else
    
       ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = False
       ActiveDocument.Bookmarks("TM169_Dummy").Select
        
    End If

    If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_Zahlung_Frist()

    Call fcCheckbox_Zahlung_Frist

End Sub

Function fcCheckbox_Zahlung_Frist(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
      
    If ActiveDocument.FormFields("TM169_Text").Result = "" Then
       ActiveDocument.FormFields("TM169_Text").Result = 0
    End If
       
    If ActiveDocument.FormFields("TM169_Text").Result < 31 Or ActiveDocument.FormFields("TM169_Text").Result > 60 Then
       MsgBox "Verl|fffd|ngerte Frist f|fffd|r die F|fffd|lligkeit der Schlusszahlung:" + Chr$(13) + Chr$(13) + "Die Regelfrist f|fffd|r Schlusszahlungen betr|fffd|gt 30 Tage nach Zugang der Schlussrechnung." + Chr$(13) + "Sofern sachlich gerechtfertigt, kann diese Frist im Ausnahmefall auf h|fffd|chstens 60 Tage verl|fffd|ngert werden." + Chr$(13) + Chr$(13) + "Bitte legen Sie die verl|fffd|ngerte Frist in Abh|fffd|ngigkeit der ma|fffd|gebenden Umst|fffd|nde fest." + Chr$(13) + "Die verl|fffd|ngerte Frist muss mehr als 30 Tage (= Regelfrist) und darf h|fffd|chstens 60 Tage betragen.", vbInformation, "Hinweis"
       ActiveDocument.FormFields("TM169_Text").Result = ""

    Else
       ActiveDocument.Bookmarks("TM169_Dummy").Select
              
    End If

    If bProtect = True Then Call protectFile(True)

End Function

Sub Checkbox_Sicherheitsleistungen()
    Call fcCheckbox_Sicherheitsleistungen
End Sub

Function fcCheckbox_Sicherheitsleistungen(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM37_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM37").Range.Font.Hidden = False
        If ActiveDocument.FormFields("TM11_Text").Range.Font.Hidden = False Then  'Ver|fffd|ffentlichungstext eingeblendet
           ActiveDocument.Bookmarks("TM37_1").Range.Font.Hidden = False           'Hinweis an Vergabestelle eingeblendet
        Else
           ActiveDocument.Bookmarks("TM37_1").Range.Font.Hidden = True
        End If
                
    Else
        ActiveDocument.Bookmarks("TM37").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM37_1").Range.Font.Hidden = True
    End If

    ActiveDocument.Bookmarks("TM37_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Stoffpreisgleitklausel()
    Call fcStoffpreisgleitklausel
End Sub

Function fcStoffpreisgleitklausel(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM81_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM50").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM182_Gesamt").Range.Font.Hidden = False
    Else
        ActiveDocument.Bookmarks("TM50").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM182_Gesamt").Range.Font.Hidden = True
    End If
    
    Call fcNebenangebote(False)
    
    ActiveDocument.Bookmarks("TM81_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function


Sub Anl_NEM_CB()

 '   Call protectFile(False)
    
    If ActiveDocument.FormFields("Anl_NEM_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("NEM_Z").Range.Font.Hidden = False
    Else
        ActiveDocument.FormFields("NEM_Bez_CB1").CheckBox.Value = False
        ActiveDocument.FormFields("NEM_Bez_CB2").CheckBox.Value = False
        ActiveDocument.FormFields("NEM_Bez_Text").Result = ""
    
        ActiveDocument.FormFields("NEM_Verw_DD").DropDown.Value = 1
        ActiveDocument.FormFields("NEM_Zeitpunkt").Result = ""
    
        ActiveDocument.FormFields("NEM_Stoff_frei").Result = ""
    
        ActiveDocument.FormFields("NEM_Verw_Kupfer").Result = ""
        ActiveDocument.FormFields("NEM_Verw_Blei").Result = ""
        ActiveDocument.FormFields("NEM_Verw_Alu").Result = ""
        ActiveDocument.FormFields("NEM_Verw_frei").Result = ""
        
        ActiveDocument.FormFields("NEM_Wert_Kupfer").Result = ""
        ActiveDocument.FormFields("NEM_Wert_Blei").Result = ""
        ActiveDocument.FormFields("NEM_Wert_Alu").Result = ""
        ActiveDocument.FormFields("NEM_Wert_frei").Result = ""
    
        ActiveDocument.Bookmarks("NEM_Z").Range.Font.Hidden = True
    End If
    
    ActiveDocument.Bookmarks("TM81_CB_Dummy").Select
    
  '  If bProtect = True Then Call protectFile(True)

End Sub


Sub Aufgliederung_der_EP()
    Call fcAufgliederung_der_EP
End Sub

Function fcAufgliederung_der_EP(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

 'bei Atr.-Wert gr|fffd||fffd|er 50.000 |fffd| wird Checkbox "Aufgliederung der EP" (TM29_CB2)angehakt
    If ActiveDocument.FormFields("AtrWert").Result > 50000 Then
       ActiveDocument.FormFields("TM29_CB2").CheckBox.Value = True
    End If
    
 'bei angehakter Checkbox "Aufgliederung der EP" (TM29_CB2)
    If ActiveDocument.FormFields("TM29_CB2").CheckBox.Value = True Then
    
        'zweiter Eintrag in Dropdownfeld Betrieb = "Landesbetrieb"
         If mBL = 2 Then
            ActiveDocument.Bookmarks("TM51").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM52").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = False
         End If
         
         'dritter Eintrag in Dropdownfeld Betrieb = "Bundesbetrieb" und Atr.-Wert <= 100.000 |fffd|
         If mBL = 3 And ActiveDocument.FormFields("AtrWert").Result <= 100000 Then
            ActiveDocument.Bookmarks("TM51").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM52").Range.Font.Hidden = False
            Call fcAufgliederung_alle_EP(False)
         End If
           
         'dritter Eintrag in Dropdownfeld Betrieb = "Bundesbetrieb" und Atr.-Wert > 100.000 |fffd|
         If mBL = 3 And ActiveDocument.FormFields("AtrWert").Result > 100000 Then
            ActiveDocument.Bookmarks("TM51").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM52").Range.Font.Hidden = False
            ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = True
            ActiveDocument.FormFields("TM52_CB1").CheckBox.Value = True
         End If
    Else

  'bei NICHT angehakter Checkbox "Aufgliederung der EP" (TM29_CB2)
        ActiveDocument.Bookmarks("TM51").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM52").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = True
    End If

    ActiveDocument.Bookmarks("TM29_CB2_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub Preisermittlung()

    Call fcPreisermittlung

End Sub


Function fcPreisermittlung(Optional bProtect As Boolean = True)

    Call protectFile(False)

 'bei Atr.-Wert gr|fffd||fffd|er 50.000 |fffd| wird Checkbox "Preisermittlung" (TM29_CB1)angehakt
    If ActiveDocument.FormFields("AtrWert").Result > 50000 Then
       ActiveDocument.FormFields("TM29_CB1").CheckBox.Value = True
    End If

    ActiveDocument.Bookmarks("TM29_CB2_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub Aufgliederung_alle_EP()

    Call fcAufgliederung_alle_EP

End Sub

Function fcAufgliederung_alle_EP(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

   Call protectFile(False)

   'dritter Eintrag in Dropdownfeld Betrieb = "Bundesbetrieb" und Atr.-Wert > 100.000 |fffd|
    If mBL = 3 And ActiveDocument.FormFields("AtrWert").Result > 100000 Then
    ActiveDocument.FormFields("TM52_CB1").CheckBox.Value = True
    End If

    If ActiveDocument.FormFields("TM52_CB1").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = True
    Else
       ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = False
    End If

    ActiveDocument.Bookmarks("TM52_CB1_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub Checkbox_Begr|fffd|ndungen()

    Call fcCheckbox_Begr|fffd|ndungen

End Sub

Function fcCheckbox_Begr|fffd|ndungen(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM63_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM63").Range.Font.Hidden = False
    Else
        ActiveDocument.Bookmarks("TM63").Range.Font.Hidden = True
    End If

    ActiveDocument.Bookmarks("TM63_Text").Select

    If bProtect = True Then Call protectFile(True)
    
End Function


Sub Zeitvertrag()

Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung

    If ActiveDocument.FormFields("Zeitvertrag_CB").CheckBox.Value = mZV Then    'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
        ActiveDocument.Bookmarks("Zeitvertrag_CB_Dummy").Select
        Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
        Exit Sub
    Else
        mZV = ActiveDocument.FormFields("Zeitvertrag_CB").CheckBox.Value        'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "Zeitvertrag" ausf|fffd|hren
        
        If Geduld.Visible = False Then  'Formular "Geduld" nicht sichtbar
           Geduld.Show (0)              'Anzeige des Formulars "Geduld"
            DoEvents                    'notwendig, um Inhalt des Formulars anzuzeigen
        End If
        
        ActiveWindow.View.Type = wdNormalView
        
        Call fcZeitvertrag
    
        ActiveWindow.View.Type = wdPrintView
    
        Geduld.hide                     'Ausblenden des Formulars "Geduld"
    
    End If
    
Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
    
End Sub

Function fcZeitvertrag(Optional bProtect As Boolean = True, Optional strSender As String = "")

    Call protectFile(False)

    If mZV = True Then      'Zeitvertrag
    
    'Anpassung allgemeiner Punkte, welche bei ZV-Arbeiten generell gelten (unabh|fffd|ngig ob Angebots- oder Auf-/Abgebotsverfahren)
        ActiveDocument.Bookmarks("TM75").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM77").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM78").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM60").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM79").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM80").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM92").Range.Font.Hidden = True
        
        'Anlage "Stoffpreisgleitklausel"
        ActiveDocument.FormFields("TM81_CB").CheckBox.Value = False
        Call fcStoffpreisgleitklausel(False)
        ActiveDocument.Bookmarks("TM81").Range.Font.Hidden = True
        
            
        'Anlage "Instandhaltung"
        ActiveDocument.FormFields("Instand_CB").CheckBox.Value = False
        Call fcCheckbox_Instandhaltung(False)
        ActiveDocument.Bookmarks("Instand_CB_Z").Range.Font.Hidden = True
           
        ActiveDocument.Bookmarks("TM27").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM83").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM84").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM85").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM90").Range.Font.Hidden = False

        'Preisaufgliederung
        Call fcPreisaufgliederung(False)
         
        'Nebenangebote
        ActiveDocument.Bookmarks("TM91").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = True
        Call fcNebenangebot_nein(False)
                        
        'Vertragsstrafe - einschl. WBVBs zur Vertragsstrafe (Land und Bund)
        ActiveDocument.FormFields("TM36_CB").CheckBox.Value = False
        Call fcCheckbox_Vertragsstrafe(False)
        ActiveDocument.Bookmarks("TM95").Range.Font.Hidden = True
       
        'Zahlung
        Call fcCheckbox_Zahlung(False)
       
        'Sicherheitsleistungen
        ActiveDocument.FormFields("TM37_CB").CheckBox.Value = False
        Call fcCheckbox_Sicherheitsleistungen(False)
        ActiveDocument.Bookmarks("TM98").Range.Font.Hidden = True

        'PlanTeam-Server
        ActiveDocument.Bookmarks("PTS").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM183_Gesamt").Range.Font.Hidden = True

        'WBVB - Vorauszahlungen
        ActiveDocument.FormFields("TM99_CB").CheckBox.Value = False
        Call fcWBVB_CB_Vorauszahlungen(False)
        ActiveDocument.Bookmarks("TM99").Range.Font.Hidden = True
             
        'WBVB - Baustellenbesprechung
        ActiveDocument.FormFields("TM100_CB").CheckBox.Value = False
        Call fcWBVB_CB_Baustellenbespr(False)
        ActiveDocument.Bookmarks("TM100").Range.Font.Hidden = True
       
        'WBVB - Baufristenplan
        ActiveDocument.FormFields("TM102_CB").CheckBox.Value = False
        Call fcWBVB_CB_Baufristenplan(False)
        ActiveDocument.Bookmarks("TM102").Range.Font.Hidden = True
       
        Select Case mVA     'Vergabeart
        'Anpassung der vorzulegenden Nachweise um "Reaktionszeit"
          Case 2, 4     'Nationale Verfahren mit Bekanntmachung
            ActiveDocument.Bookmarks("TM88").Range.Font.Hidden = False
      
          Case 1, 3, 5, 6, 7, 8, 9, 10, 11     'alle anderen Verfahren
            ActiveDocument.Bookmarks("TM88").Range.Font.Hidden = True
        
        End Select
    

        Call fcZV_Art(False)
        
    Else
    
    'R|fffd|ckg|fffd|ngigmachen der vorstehenden Anpassungen
        ActiveDocument.Bookmarks("TM75").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM77").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM78").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM79").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM80").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM92").Range.Font.Hidden = False

        'Anlage "Stoffpreisgleitklausel"
        ActiveDocument.Bookmarks("TM81").Range.Font.Hidden = False
        
       
        'Anlage "Instandhaltung"
        ActiveDocument.Bookmarks("Instand_CB_Z").Range.Font.Hidden = False
        Call fcCheckbox_Instandhaltung(False)
                          
        ActiveDocument.Bookmarks("TM84").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM85").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM90").Range.Font.Hidden = True

        'Preisaufgliederung (Korrektur erfolgt mit Makro "BundLand" am Ende dieser Else-Function)

        'Nebenangebote
        ActiveDocument.Bookmarks("TM91").Range.Font.Hidden = False
            
        'Vertragssstrafe
        ActiveDocument.Bookmarks("TM95").Range.Font.Hidden = False
        
        'Zahlung
        Call fcCheckbox_Zahlung(False)
        
        'Sicherheitsleistungen
        ActiveDocument.Bookmarks("TM98").Range.Font.Hidden = False
                              
        'PlanTeam-Server
        ActiveDocument.Bookmarks("PTS").Range.Font.Hidden = False
        Call fcPlanTeam(False)
                                                            
        'WBVB - Vorauszahlungen
        ActiveDocument.Bookmarks("TM99").Range.Font.Hidden = False
        
        'WBVB - Baustellenbesprechung
        ActiveDocument.Bookmarks("TM100").Range.Font.Hidden = False

        'WBVB - Baufristenplan
        ActiveDocument.Bookmarks("TM102").Range.Font.Hidden = False

       'Anpassung der vorzulegenden Nachweise um "Reaktionszeit"
        ActiveDocument.Bookmarks("TM88").Range.Font.Hidden = True

       'Spezifische Anpassung Angebots- und Auf-/Abgebotsverfahren
        ActiveDocument.Bookmarks("TM86").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM87").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM89").Range.Font.Hidden = True
        
        'Einblenden von Angaben zu Losen
        ActiveDocument.Bookmarks("TM76").Range.Font.Hidden = False
               
       If Not strSender = "fcLandBund" Then Call fcLandBund(False)     'Ausf|fffd|hrung der Function "fcLandBund", falls nicht von dort aufgerufen und |fffd|bergabe des Wertes "False"
       If Not strSender = "fcVergabeart" Then Call fcVergabeart(False) 'Ausf|fffd|hrung der Function "fcVergabeart", falls nicht von dort aufgerufen und |fffd|bergabe des Wertes "False"
        
    End If

   'WBVB - Beginn Zahlungsfristen
    Call fcWBVB_BeginnZahlungsfrist(False)
               
    ActiveDocument.Bookmarks("Zeitvertrag_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub ZeitvertragArt()

    If ActiveDocument.FormFields("TM75_DD").DropDown.Value = mZV_Art Then   'wenn Wert des Feldes = identisch mit Variablen, dann nichts machen
       ActiveDocument.Bookmarks("TM75_DD_Dummy").Select
       Exit Sub
    Else
        mZV_Art = ActiveDocument.FormFields("TM75_DD").DropDown.Value       'wenn Werte nicht identisch, dann neuen Wert der Variablen zuordnen und Function "fcZV_Art" ausf|fffd|hren
        Call fcZV_Art
    End If

End Sub

Function fcZV_Art(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
'Verfahrensart "bitte ausw|fffd|hlen..."
    If mZV_Art = 1 Then     'Zeitvertrag Art
        ActiveDocument.Bookmarks("TM86").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM87").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM89").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM76").Range.Font.Hidden = False
    End If
    
'Verfahrensart "Angebotsverfahren"
    If mZV_Art = 2 Then
        ActiveDocument.Bookmarks("TM86").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM87").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM89").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM76").Range.Font.Hidden = False
    End If
        
'Verfahrensart "Auf- und Abgebotsverfahren"
    If mZV_Art = 3 Then
        ActiveDocument.Bookmarks("TM86").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM87").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM89").Range.Font.Hidden = False
        
        'Ausblenden von Angaben zu Losen
        ActiveDocument.FormFields("DD2_losweise").DropDown.Value = 1    'Setze Wert des Felds auf "Nein"
        mLose = 1   'setze |fffd|ffentliche Variable "mLose" auch auf "Nein"
        
        Call fcLose(False)
        ActiveDocument.Bookmarks("TM76").Range.Font.Hidden = True
    End If
       
    ActiveDocument.Bookmarks("TM75_DD_Dummy").Select
         
    If bProtect = True Then Call protectFile(True)
         
End Function

Sub Produktaufkl|fffd|rung()
    Call fcProduktaufkl|fffd|rung
End Sub

Function fcProduktaufkl|fffd|rung(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
       
    Select Case ActiveDocument.FormFields("TM146_DD").DropDown.Value
    
        Case 1, 2      '"bitte ausw|fffd|hlen..." + "nein"
            ActiveDocument.Bookmarks("TM146").Range.Font.Hidden = True

        Case 3         '"ja"
            ActiveDocument.Bookmarks("TM146").Range.Font.Hidden = False
    
    End Select
       
    ActiveDocument.Bookmarks("TM146_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub Qualit|fffd|tserkl_LV()
    Call fcQualit|fffd|tserkl_LV
End Sub

Function fcQualit|fffd|tserkl_LV(Optional bProtect As Boolean = True)

    Call protectFile(False)
       
       If ActiveDocument.FormFields("fbT").Result = "" Then
          ActiveDocument.Bookmarks("Erkl_LV").Range.Font.Hidden = True
          ActiveDocument.FormFields("Erkl_LV_DD").DropDown.Value = 1
          ActiveDocument.Bookmarks("Erkl_LV_Begr").Range.Font.Hidden = True
          ActiveDocument.FormFields("Erkl_LV_Begr_Text").Result = ""
       Else
          ActiveDocument.Bookmarks("Erkl_LV").Range.Font.Hidden = False
       End If
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub Qualit|fffd|tserkl_LV_DD()
    Call fcQualit|fffd|tserkl_LV_DD
End Sub

Function fcQualit|fffd|tserkl_LV_DD(Optional bProtect As Boolean = True)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("Erkl_LV_DD").DropDown.Value = 3 Then      'NEIN
        ActiveDocument.Bookmarks("Erkl_LV_Begr").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("Erkl_LV_Begr_Text").Select
    Else
        ActiveDocument.Bookmarks("Erkl_LV_Begr").Range.Font.Hidden = True
        ActiveDocument.FormFields("Erkl_LV_Begr_Text").Result = ""
        ActiveDocument.Bookmarks("Erkl_LV_Dummy").Select
    End If

    If bProtect = True Then Call protectFile(True)

End Function


Public Sub InsertRow()      'Zeile in Tabelle einf|fffd|gen

    'Call protectFile (False) <= da ungesch|fffd|tzter Tabellenbereich nicht erforderlich
    
    'pr|fffd|fen ob Cursor in einer Tabelle steht
    If Selection.Information(wdWithInTable) = True Then

      'Zeile vor der aktuellen Zeile einf|fffd|gen
      Selection.InsertRowsAbove 1
      
      'Zeile nach der aktuellen Zeile einf|fffd|gen
      'Selection.InsertRowsBelow 1
    Else
        MsgBox "Die Einf|fffd|gemarke befindet sich nicht in einer Tabelle.", vbInformation
        Exit Sub
    End If

End Sub


Public Sub DeleteRow()      'Zeile in Tabelle entfernen

    'Call protectFile (False) <= da ungesch|fffd|tzter Tabellenbereich nicht erforderlich
    
    Dim tbl As Table
    Dim cnt As Integer
    
    If Selection.Information(wdWithInTable) = True Then
        Set tbl = Selection.Tables(1)                   'Tabelle selektieren
        cnt = tbl.Rows.Count - 1                        'Anzahl Zeilen ermitteln und 1 abziehen
        If cnt > 1 Then tbl.Rows(cnt).Delete            'vorletzte Zeile entfernen wenn noch mehr als 2 da sind
    Else
        MsgBox "Die Einf|fffd|gemarke befindet sich nicht in einer Tabelle.", vbInformation
        Exit Sub
    End If

End Sub


Function protectFile(doProtect As Boolean)

    If doProtect = True Then
       If ActiveDocument.ProtectionType = wdNoProtection Then ActiveDocument.Protect Password:="Vergadmin", NoReset:=True, Type:=wdAllowOnlyFormFields 'Formularschutz
    Else
       If ActiveDocument.ProtectionType = wdAllowOnlyFormFields Then ActiveDocument.Unprotect Password:="Vergadmin"    'Formularschutz aufheben
       If ActiveDocument.ProtectionType = wdAllowOnlyReading Then ActiveDocument.Unprotect Password:="Vergadmin"       '"nur Lesen"-Schutz aufheben
    End If

End Function
Attribute VB_Name = "Ausdruck_Ausblenden"

'Funktion dient zum Ausblenden von Textmarken vor dem Ausdruck.
'Der Aufruf dieser Funktion erfolgt |fffd|ber das Klassenmodul "EventClassModule".

'Die ausgeblendeten Textmarken werden nach dem Drucken nicht wieder eingeblendet.

'Das Einblenden der ausgeblendeten Textmarken erfolgt erst beim erneuten |fffd|ffnen des
'Dokuments durch das Startmakro "setStartupValues".


Function fcAusblenden_vor_Druck(Optional bProtect As Boolean = True)

  MsgBox "Vor dem Drucken werden die nicht erforderlichen Inhalte (z.B. Schaltfl|fffd|chen) ausgeblendet." + vbNewLine + vbNewLine + _
         "Zum erneuten Einblenden dieser Inhalte bitte zun|fffd|chst das Dokument ""speichern"", ""schlie|fffd|en"" und dann ""erneut |fffd|ffnen"".", vbInformation, "Hinweis"


  Call protectFile(False)
    
  ActiveDocument.Bookmarks("Erkl_LV_Button").Range.Font.Hidden = True  '"Erkl|fffd|rung zum LV" Schaltfl|fffd|che
    
  ActiveWindow.View.Reviewers("Hinweis").Visible = False               'Kommentare vom Bearbeiter "Hinweis" ausblenden
        
         
 'Unterschriften - Schaltfl|fffd|chen
  ActiveDocument.Bookmarks("U_Schaltfl|fffd|chen1").Range.Font.Hidden = True
   
  ActiveDocument.Bookmarks("U_VBV").Range.Font.Hidden = True           'Schaltfl|fffd|chen - Unterschriftenregelung VBV Ba-W|fffd|
   
  ActiveDocument.Bookmarks("U_weitere_Z").Range.Font.Hidden = True
 
 
  ActiveDocument.Bookmarks("U_Schaltfl|fffd|chen2").Range.Font.Hidden = True
   
 'Sonstige Schaltfl|fffd|chen
  ActiveDocument.Bookmarks("Schaltfl|fffd|chen_Z").Range.Font.Hidden = True
    
    
    
  If bProtect = True Then Call protectFile(True)

End Function
Attribute VB_Name = "Ausdruck_Pr|fffd|fen"

Public Drucken As Boolean
Public bReset As Boolean            'verhindert eine Schleife beim zur|fffd|cksetzen der Textfelder
                                    'Reset der Felder: "reset" eintragen im Feld Baumassnahme und feld verlassen (Tab)

Public bFehlerTemp As Boolean
Public mAnzahl As Integer           'Anzahl der unvollst|fffd|ndigen Felder
Public strFirstField As String      'Name des ersten unvollst|fffd|ndigen Pflichtfelds

Public strFirstFieldType As String
Public lastFFokName As String
Public bDoCount As Boolean

Function Vollst|fffd|ndigkeits_Check() 'Aufruf |fffd|ber Schaltfl|fffd|che "Vollst|fffd|ndigkeit pr|fffd|fen"
   
    Call Pr|fffd|fen("all")
    Pruefen.hide
       
    If Drucken = True Then        'Wert der Variablen wird im Makro "Pr|fffd|fen" festgelegt
       MsgBox "S|fffd|mtliche Pflichtangaben sind vorhanden.", vbInformation, "Vollst|fffd|ndigkeitspr|fffd|fung"
       ActiveDocument.Bookmarks("Schaltfl_Dummy").Select
    End If

End Function

Function Pr|fffd|fen(strFieldName As String)
         
    Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung
         
    ActiveWindow.View.Type = wdNormalView
                 
    Call protectFile(False)
    
    On Error GoTo endFunction  'falls im Anfangsbereich ein Fehler auftritt, wird komplett beendet
    
        
    bReset = False
    
    Select Case strFieldName
        Case Is = "Projekt"
            If ActiveDocument.FormFields("Projekt").Result = "reset" Then
                bReset = True
                strFieldName = "all"
                GoTo startReset
            Else
                GoTo endFunction
            End If
    
        Case Is = "all"
            On Error GoTo resumeFunction  'falls vor dem Drucken bei einer Pr|fffd|fung ein Fehler auftritt, wird mit dem bis dahin gepr|fffd|ften Stand beendet
    
        Case Else
            GoTo endFunction
            
    End Select
    
    Pruefen.Show (0)  'Anzeige des Formulars "Pr|fffd|fen"
    DoEvents          'notwendig, um Inhalt des Formulars anzuzeigen
    
    mAnzahl = 0
    strFirstField = ""
    strFirstFieldType = ""
    bDoCount = True
    lastFFokName = ""
    
startReset:

'ab hier Pr|fffd|fungen der Felder ob Pflichtangaben vorhanden
'-----------------------------------------------------------


    'Hinweis zur Programmierung:
    
    'Die beim "reset" auszuf|fffd|hrende Funktionen zum Ein-/Ausblenden der abh|fffd|ngigen Bookmarks erfolgt in separater
    'Funktion "doAfterReset".

    'Bei vorangestellten If-Pr|fffd|fungen muss immer der Zusatz "Or bReset = True " angebracht werden, damit bei der
    'Eingabe von "reset" auch die darunter angebrachten Angaben zur|fffd|ckgestellt und ein/-ausgeblendet werden.


 'Pr|fffd|fung: Betriebsart = "bitte ausw|fffd|hlen..."
    bFehlerTemp = mBL = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("DD1_Betrieb"))
    
 'Pr|fffd|fung: Bund + Nutzerart Bund "bitte ausw|fffd|hlen..."
    bFehlerTemp = mBL = 3 And mNutzer_B = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Nutzerart_Bund"))
       
 'Pr|fffd|fung: Zeitvertragsarbeiten + Verfahrensart "bitte ausw|fffd|hlen..."
    bFehlerTemp = mZV = True And mZV_Art = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM75_DD"))
       
 'Pr|fffd|fung: Ma|fffd|nahme
    bFehlerTemp = ActiveDocument.FormFields("Projekt").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Projekt"))
       
 'Pr|fffd|fung: Liegenschaft
  'entf|fffd|llt, da gelegentlich mehrer Projekte zusammengefasst werden.
       
 'Pr|fffd|fung: Leistung
    bFehlerTemp = ActiveDocument.FormFields("Leistung").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Leistung"))
       
 'Pr|fffd|fung: Voraussichtlicher Auftragswert <= 0
    bFehlerTemp = ActiveDocument.FormFields("AtrWert").Result <= 0
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("AtrWert"))
       
 'Pr|fffd|fung: Vergabeart = "bitte ausw|fffd|hlen..."
    bFehlerTemp = mVA = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("DD3_Vergabeart"))
       
 'Pr|fffd|fung: Mindestens eine Standardbegr|fffd|ndung zur gew|fffd|hlten Vergabeart festgelegt
    
   'TM2: Beschr|fffd|nkte Ausschreibung
         bFehlerTemp = ActiveDocument.Bookmarks("TM2").Range.Font.Hidden = False And ActiveDocument.FormFields("TM2_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM2_CB2").CheckBox.Value = False And ActiveDocument.FormFields("TM2_CB3").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM2_CB4").CheckBox.Value = False And ActiveDocument.FormFields("TM2_CB5").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM2_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM2_CB2"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM2_CB3"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM2_CB4"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM2_CB5"))
       
   'TM3: Beschr|fffd|nkte Ausschreibung mit Teilnahmewettbewerb
         bFehlerTemp = ActiveDocument.Bookmarks("TM3").Range.Font.Hidden = False And ActiveDocument.FormFields("TM3_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM3_CB2").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM3_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM3_CB2"))
       
   'TM4: Freih|fffd|ndige Vergabe
         bFehlerTemp = ActiveDocument.Bookmarks("TM4").Range.Font.Hidden = False And ActiveDocument.FormFields("TM4_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM4_CB2").CheckBox.Value = False And ActiveDocument.FormFields("TM4_CB3").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM4_CB4").CheckBox.Value = False And ActiveDocument.FormFields("TM4_CB5").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM4_CB6").CheckBox.Value = False And ActiveDocument.FormFields("TM4_CB7").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB2"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB3"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB4"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB5"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB6"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM4_CB7"))
              
   'TM6: Verhandlungsverfahren mit Teilnahmewettbewerb UND Wettbewerblicher Dialog - VgV

         bFehlerTemp = ActiveDocument.Bookmarks("TM6").Range.Font.Hidden = False And ActiveDocument.FormFields("TM6_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM6_CB2").CheckBox.Value = False And ActiveDocument.FormFields("TM6_CB3").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM6_CB4").CheckBox.Value = False And ActiveDocument.FormFields("TM6_CB5").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM6_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM6_CB2"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM6_CB3"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM6_CB4"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM6_CB5"))
         
   'TM7: Verhandlungsverfahren ohne Teilnahmewettbewerb - VgV
         bFehlerTemp = ActiveDocument.Bookmarks("TM7").Range.Font.Hidden = False And ActiveDocument.FormFields("TM7_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM7_CB2").CheckBox.Value = False And ActiveDocument.FormFields("TM7_CB3").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM7_CB4").CheckBox.Value = False And ActiveDocument.FormFields("TM7_CB5").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_CB2"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_CB3"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_CB4"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_CB5"))
       
   'TM7_1: Verhandlungsverfahren ohne Teilnahmewettbewerb - VSVgV
         bFehlerTemp = ActiveDocument.Bookmarks("TM7_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM7_1_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM7_1_CB2_1").CheckBox.Value = False And ActiveDocument.FormFields("TM7_1_CB2_2").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM7_1_CB3").CheckBox.Value = False And ActiveDocument.FormFields("TM7_1_CB4").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM7_1_CB5").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB2_1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB2_2"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB3"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB4"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM7_1_CB5"))
       
   'TM8_1: Wettbewerblicher Dialog - VSVgV
         bFehlerTemp = ActiveDocument.Bookmarks("TM8_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM8_1_CB1").CheckBox.Value = False And _
                       ActiveDocument.FormFields("TM8_1_CB2").CheckBox.Value = False
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM8_1_CB1"))
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM8_1_CB2"))
       
 'Pr|fffd|fung: Vergabeart ohne n|fffd|here "Erl|fffd|uterungen" zur gew|fffd|hlten Standardbegr|fffd|ndung
    If mVA = 4 Or mVA = 5 Or mVA = 7 Or mVA = 8 Or mVA = 9 Or mVA = 10 Or bReset = True Then
       bFehlerTemp = ActiveDocument.Bookmarks("TM57").Range.Font.Hidden = False And ActiveDocument.FormFields("TM57_Begr").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM57_Begr"))
    End If
       
    If mVA = 3 Or bReset = True Then  'Beschr|fffd|nkte Ausschreibung
       bFehlerTemp = ActiveDocument.FormFields("TM2_CB1").CheckBox.Value = False And ActiveDocument.FormFields("TM2_CB2").CheckBox.Value = False And _
                     ActiveDocument.FormFields("TM2_CB3").CheckBox.Value = False And ActiveDocument.FormFields("TM57_Begr").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM57_Begr"))
    End If
              
 'Pr|fffd|fung: Losweise Vergabe
    If ActiveDocument.Bookmarks("Lose").Range.Font.Hidden = False Or bReset = True Then
       
      'ohne Angabe der Losanzahl
       bFehlerTemp = ActiveDocument.FormFields("Lose_Anzahl").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_Anzahl"))
       
      'keine CB gew|fffd|hlt
       bFehlerTemp = ActiveDocument.FormFields("Lose_Eins_CB").CheckBox.Value = False And ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = False And _
                     ActiveDocument.FormFields("Lose_alle_CB").CheckBox.Value = False
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_Eins_CB"))
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_mehr_CB"))
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_alle_CB"))
      
      'Bei EU-Verfahren und Angebotsabgabe f|fffd|r mehrere Lose ist keine maximale Anzahl angegeben
       If mVA = 6 Or mVA = 7 Or mVA = 8 Or mVA = 9 Or mVA = 10 Then
          If ActiveDocument.FormFields("Lose_mehr_CB").CheckBox.Value = True Then
             bFehlerTemp = ActiveDocument.FormFields("Lose_AngMax_Txt").Result = ""
             Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_AngMax_Txt"))
          End If
       End If
    
      'Beschr|fffd|nkung der Losanzahl f|fffd|r Zuschlagserteilung ohne Eintragung der zugeh|fffd|rigen Textfelder
       If ActiveDocument.FormFields("Lose_ZuschlMax_CB").CheckBox.Value = True Then
          bFehlerTemp = ActiveDocument.FormFields("Lose_ZuschlMax_txt1").Result = ""
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_ZuschlMax_txt1"))
          bFehlerTemp = ActiveDocument.FormFields("Lose_ZuschlMax_txt2").Result = ""
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Lose_ZuschlMax_txt2"))
       End If
       
    End If
       
 'Pr|fffd|fung: Ausf|fffd|hrungsfrist - Beginn
    bFehlerTemp = ActiveDocument.FormFields("Ausf|fffd|hrung_Beginn").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Ausf|fffd|hrung_Beginn"))
       
 'Pr|fffd|fung: Ausf|fffd|hrungsfrist - Ende
    bFehlerTemp = ActiveDocument.FormFields("Ausf|fffd|hrung_Ende").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Ausf|fffd|hrung_Ende"))
       
 'Pr|fffd|fung: Begr|fffd|ndung Angemessenheit der Angebotsfrist
    
    If ActiveDocument.Bookmarks("AngFrist_Begr").Range.Font.Hidden = False Or bReset = True Then
       bFehlerTemp = ActiveDocument.FormFields("AngFrist_Begr_Text").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("AngFrist_Begr_Text"))
    End If
       
 'Pr|fffd|fung: Nationale Verfahren mit Bek. + Zeitvertrag + auftragsbezogener Nachweise "Reaktionszeit" ohne Angabe der Tage
    If mVA = 2 Or mVA = 4 Or bReset = True Then
       bFehlerTemp = mZV = True And ActiveDocument.FormFields("TM88_CB").CheckBox.Value = True And ActiveDocument.FormFields("TM88_Tage").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM88_Tage"))
    End If
       
 'Pr|fffd|fung: Verfahren mit Bek. ohne Ver|fffd|ffentlichungstext
    If mVA = 2 Or mVA = 4 Or mVA = 6 Or mVA = 7 Or mVA = 8 Or mVA = 10 Or bReset = True Then
       bFehlerTemp = ActiveDocument.FormFields("TM11_Text").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM11_Text"))
    End If
              
 'Pr|fffd|fung: Verfahren mit Bek. + losweise Vergabe + fehlende Beschreibung der Losinhalte im Bek.-Text
    If mVA = 2 Or mVA = 4 Or mVA = 6 Or mVA = 7 Or mVA = 8 Or mVA = 10 Or bReset = True Then
       bFehlerTemp = mLose = 2 And ActiveDocument.FormFields("TM12_Text").Result = ""
       Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM12_Text"))
    End If
       
 'Pr|fffd|fung: Auswahl Pr|fffd|qualifizierung bzw. Eigenerkl|fffd|rung getroffen, wenn Tab. "Aufzufordernde Unternehmen" sichtbar
    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name1").Result <> "" And ActiveDocument.FormFields("TM13_DD1").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD1"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name2").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name2").Result <> "" And ActiveDocument.FormFields("TM13_DD2").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD2"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name3").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name3").Result <> "" And ActiveDocument.FormFields("TM13_DD3").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD3"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name4").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name4").Result <> "" And ActiveDocument.FormFields("TM13_DD4").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD4"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name5").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name5").Result <> "" And ActiveDocument.FormFields("TM13_DD5").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD5"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name6").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name6").Result <> "" And ActiveDocument.FormFields("TM13_DD6").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD6"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name7").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name7").Result <> "" And ActiveDocument.FormFields("TM13_DD7").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD7"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Name8").Range.Font.Hidden = False And ActiveDocument.FormFields("TM13_Name8").Result <> "" And ActiveDocument.FormFields("TM13_DD8").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM13_DD8"))
           
 'Pr|fffd|fung: Eigenerkl|fffd|rung liegt vor bzw. von Vergabestelle anzufordern
    bFehlerTemp = ActiveDocument.Bookmarks("TM13_Erkl").Range.Font.Hidden = False And ActiveDocument.TM13_Erkl_RB1.Value = False And ActiveDocument.TM13_Erkl_RB2.Value = False
    Call MarkierenOpt(bFehlerTemp, ActiveDocument.TM13_Erkl_RB1)
    Call MarkierenOpt(bFehlerTemp, ActiveDocument.TM13_Erkl_RB2)
                  
 'Pr|fffd|fung: Selbstausf|fffd|hrungspflicht ausgef|fffd|llt
    bFehlerTemp = ActiveDocument.FormFields("Selbstausf_CB").CheckBox.Value = True And ActiveDocument.FormFields("Selbstausf_Txt").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Selbstausf_Txt"))

    bFehlerTemp = ActiveDocument.FormFields("Selbstausf_CB").CheckBox.Value = True And ActiveDocument.FormFields("Selbstausf_Begr_Txt").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Selbstausf_Begr_Txt"))
                      
 'Pr|fffd|fung: HH-Daten - Mittelart beim Land muss ausgew|fffd|hlt sein (nicht "bitte ausw|fffd|hlen")
    bFehlerTemp = ActiveDocument.Bookmarks("TM15").Range.Font.Hidden = False And ActiveDocument.FormFields("TM15_DD").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM15_DD"))
       
 'Pr|fffd|fung: HH-Daten - "SAP-CO-Nr." muss beim Bund ausgef|fffd|llt sein
    bFehlerTemp = ActiveDocument.FormFields("TM18_CONr").Range.Font.Hidden = False And ActiveDocument.FormFields("TM18_CONr").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM18_CONr"))
       
 'Pr|fffd|fung: Anlage Instandhaltung
    bFehlerTemp = ActiveDocument.FormFields("Instand_FormulareAnz").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_FormulareAnz").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_FormulareAnz"))
    
 
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_DD1").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_DD1").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_DD1"))
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_DD2").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_DD2").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_DD2"))
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_DD3").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_DD3").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_DD3"))
   
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_DD4").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_DD4").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_DD4"))
   
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_Anz1").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_Anz1").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_Anz1"))
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_Anz2").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_Anz2").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_Anz2"))
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_Anz3").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_Anz3").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_Anz3"))
    
    bFehlerTemp = ActiveDocument.FormFields("Instand_VM_Anz4").Range.Font.Hidden = False And ActiveDocument.FormFields("Instand_VM_Anz4").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Instand_VM_Anz4"))
    
 
    bFehlerTemp = ActiveDocument.Bookmarks("TM184").Range.Font.Hidden = False And ActiveDocument.FormFields("TM184_DD").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM184_DD"))

    bFehlerTemp = ActiveDocument.Bookmarks("TM184_AG_Z").Range.Font.Hidden = False And ActiveDocument.FormFields("TM184_AG").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM184_AG"))

 'Pr|fffd|fung: Zeitvertrag + Angebotsverfahren + prozentuale Aufteilung des Jahreswertes in Einzelauftr|fffd|ge fehlt
    bFehlerTemp = mZV = True And mZV_Art = 2 And ActiveDocument.FormFields("TM86_Jahreswert").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM86_Jahreswert"))
    
    bFehlerTemp = mZV = True And mZV_Art = 2 And ActiveDocument.FormFields("TM86_Prozent1").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM86_Prozent1"))
       
 'Pr|fffd|fung: Zeitvertrag + Auf-/Abgebotsverfahren + Angabe mind. eines Leistungsbereichs fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And ActiveDocument.FormFields("TM87_LB1").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_LB1"))
       
 'Pr|fffd|fung: Zeitvertrag + Auf-/Abgebotsverfahren + ....
       
   '+ Angabe des Jahreswerts im 1. Leistungsbereich fehlt (Pr|fffd|fung, ob 1. LB definiert wurde, erfolgt im Makro davor)
    bFehlerTemp = mZV = True And mZV_Art = 3 And ActiveDocument.FormFields("TM87_Betrag1").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag1"))
       
   '+ 2. Leistungsbereich ist definiert + Angabe des Jahreswerts im 2. Leistungsbereich fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And Not ActiveDocument.FormFields("TM87_LB2").Result = "" And ActiveDocument.FormFields("TM87_Betrag2").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag2"))
       
   '+ 3. Leistungsbereich ist definiert + Angabe des Jahreswerts im 3. Leistungsbereich fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And Not ActiveDocument.FormFields("TM87_LB3").Result = "" And ActiveDocument.FormFields("TM87_Betrag3").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag3"))
       
   '+ 4. Leistungsbereich ist definiert + Angabe des Jahreswerts im 4. Leistungsbereich fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And Not ActiveDocument.FormFields("TM87_LB4").Result = "" And ActiveDocument.FormFields("TM87_Betrag4").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag4"))
       
   '+ 5. Leistungsbereich ist definiert + Angabe des Jahreswerts im 5. Leistungsbereich fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And Not ActiveDocument.FormFields("TM87_LB5").Result = "" And ActiveDocument.FormFields("TM87_Betrag5").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag5"))
       
   '+ 6. Leistungsbereich ist definiert + Angabe des Jahreswerts im 6. Leistungsbereich fehlt
    bFehlerTemp = mZV = True And mZV_Art = 3 And Not ActiveDocument.FormFields("TM87_LB6").Result = "" And ActiveDocument.FormFields("TM87_Betrag6").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM87_Betrag6"))
       
'Pr|fffd|fung: Zeitvertrag + fehlende Angaben zum Kleinstauftragszuschlag
       
   'Wertgrenze f|fffd|r Kleinstauftr|fffd|ge  'Update: 11.05.2018: ab sofort kein Feld mehr, da fest auf 500 |fffd| festgelegt
    'bFehlerTemp = ActiveDocument.Bookmarks("TM90").Range.Font.Hidden = False And ActiveDocument.FormFields("TM90_Wertgrenze").Result = ""
    'Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM90_Wertgrenze"))
       
   'Zuschlag f|fffd|r Kleinstauftr|fffd|gen
    bFehlerTemp = ActiveDocument.Bookmarks("TM90").Range.Font.Hidden = False And ActiveDocument.FormFields("TM90_Zuschlag").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM90_Zuschlag"))
       
'Pr|fffd|fung: Nebenangebote "bitte ausw|fffd|hlen..."
    bFehlerTemp = ActiveDocument.Bookmarks("TM30_DD").Range.Font.Hidden = False And ActiveDocument.FormFields("TM30_DD").DropDown.Value = 1
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM30_DD"))
      
'Pr|fffd|fung: Begr|fffd|ndung bei Nichtzulassung von Nebenangeboten ist eingeblendet + Begr|fffd|ndung fehlt
    bFehlerTemp = ActiveDocument.Bookmarks("TM30").Range.Font.Hidden = False And ActiveDocument.FormFields("TM30_Begr").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM30_Begr"))
       
'Pr|fffd|fung: Nebenangebot ist zugelassen + ...
       
   'Festlegung fehlt, ob f|fffd|r gesamte Leistung oder nur f|fffd|r bestimmte Bereiche
    bFehlerTemp = ActiveDocument.Bookmarks("TM30_DD").Range.Font.Hidden = False And ActiveDocument.FormFields("TM30_DD").DropDown.Value = 2 And _
                  ActiveDocument.TM31_RB1.Value = False And ActiveDocument.TM31_RB2.Value = False And ActiveDocument.TM31_RB3.Value = False
    Call MarkierenOpt(bFehlerTemp, ActiveDocument.TM31_RB1)
    Call MarkierenOpt(bFehlerTemp, ActiveDocument.TM31_RB2)
    Call MarkierenOpt(bFehlerTemp, ActiveDocument.TM31_RB3)
       
   'Text bei "nur f|fffd|r nachfolgend genannte Bereiche" fehlt
    bFehlerTemp = ActiveDocument.Bookmarks("TM31_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM31_1_Text").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM31_1_Text"))
       
   'Text bei "mit Ausnahme nachfolgend genannte Bereiche" fehlt
    bFehlerTemp = ActiveDocument.Bookmarks("TM31_2").Range.Font.Hidden = False And ActiveDocument.FormFields("TM31_2_Text").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM31_2_Text"))
       
   'Angabe "unter folgenden weiteren Bedingungen" fehlt
    bFehlerTemp = ActiveDocument.Bookmarks("TM31_3").Range.Font.Hidden = False And ActiveDocument.FormFields("TM31_3_CB").CheckBox.Value = False And _
                  ActiveDocument.FormFields("TM31_3_Text").Result = ""
    Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM31_3_Text"))
       
 'Pr|fffd|fung: Tabelle "Zuschlagskriterien" eingeblendet +  ....
    If ActiveDocument.Bookmarks("TM35").Range.Font.Hidden = False Or bReset = True Then
       
    'Kriterium "Preis"
        'fehlende Gewichtungsangabe
         bFehlerTemp = ActiveDocument.FormFields("TM35_Gew1").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew1"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = ActiveDocument.FormFields("TM35_GrundlageBew1").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew1"))
       
     '2. Kriterium
        'fehlende Benennung der Kriteriums (TM35 ist nur sichtbar, wenn neben dem "Preis" mind. ein weiteres Kriterium bewertet wird)
         bFehlerTemp = ActiveDocument.FormFields("TM35_Kriterium2").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Kriterium2"))
       
        'fehlende Gewichtungsangabe
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium2").Result = "" And ActiveDocument.FormFields("TM35_Gew2").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew2"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium2").Result = "" And ActiveDocument.FormFields("TM35_GrundlageBew2").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew2"))
       
     '3. Kriterium
        'fehlende Gewichtungsangabe
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium3").Result = "" And ActiveDocument.FormFields("TM35_Gew3").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew3"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium3").Result = "" And ActiveDocument.FormFields("TM35_GrundlageBew3").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew3"))
       
     '4. Kriterium
        'fehlende Gewichtungsangabe
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium4").Result = "" And ActiveDocument.FormFields("TM35_Gew4").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew4"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium4").Result = "" And ActiveDocument.FormFields("TM35_GrundlageBew4").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew4"))
       
     '5. Kriterium
        'fehlende Gewichtungsangabe
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium5").Result = "" And ActiveDocument.FormFields("TM35_Gew5").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew5"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium5").Result = "" And ActiveDocument.FormFields("TM35_GrundlageBew5").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew5"))
       
     '6. Kriterium
        'fehlende Gewichtungsangabe
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium6").Result = "" And ActiveDocument.FormFields("TM35_Gew6").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_Gew6"))
       
        'fehlende Angabe zur "Grundlage der Punktebewertung"
         bFehlerTemp = Not ActiveDocument.FormFields("TM35_Kriterium6").Result = "" And ActiveDocument.FormFields("TM35_GrundlageBew6").Result = ""
         Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM35_GrundlageBew6"))
              
    End If
       
       
       
       'Pr|fffd|fung: Abweichende Zahlungsfrist f|fffd|r Schlusszahlung
          'Begr|fffd|ndung erfasst
           bFehlerTemp = ActiveDocument.Bookmarks("TM168").Range.Font.Hidden = False And ActiveDocument.FormFields("TM168_1_CB").CheckBox.Value = False And _
                         ActiveDocument.FormFields("TM168_2_CB").CheckBox.Value = False And ActiveDocument.FormFields("TM168_3_CB").CheckBox.Value = False And _
                         ActiveDocument.FormFields("TM168_4_Text").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM168_1_CB"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM168_2_CB"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM168_3_CB"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM168_4_Text"))
       
          'Tage der Fristverl|fffd|ngerung erfasst
           bFehlerTemp = ActiveDocument.Bookmarks("TM169").Range.Font.Hidden = False And ActiveDocument.FormFields("TM169_Text").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM169_Text"))
       
       'Pr|fffd|fung: Sicherheitsleistungen
        If ActiveDocument.FormFields("TM37_CB").CheckBox.Value = True Or bReset = True Then
        
           bFehlerTemp = ActiveDocument.FormFields("TM37_VtrgErf_CB").CheckBox.Value = False And ActiveDocument.FormFields("TM37_Maengel_CB").CheckBox.Value = False
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM37_VtrgErf_CB"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM37_Maengel_CB"))
       
        End If
       
       'Pr|fffd|fung: PlanTeam-Server
        bFehlerTemp = ActiveDocument.Bookmarks("PTS").Range.Font.Hidden = False And ActiveDocument.FormFields("PTS_DD").DropDown.Value = 1
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("PTS_DD"))
       
       
       'Pr|fffd|fung: Weitere Besondere Vertragsbedingungen (WBVB)
        Call WBVB_Check("Druck")                                           'Aufruf mit Parameter "Druck" = Herkunft des Aufrufs
          
       'Pr|fffd|fung: Stoffpreisgleitklausel - Zeitpunkt Marktpreis
        bFehlerTemp = ActiveDocument.Bookmarks("TM50").Range.Font.Hidden = False And ActiveDocument.FormFields("TM50_Dat").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM50_Dat"))
       
       
       'Pr|fffd|fung: Stoffpreisgleitklausel Nichteisenmetalle
        If ActiveDocument.Bookmarks("NEM_Z").Range.Font.Hidden = False Or bReset = True Then
       
           bFehlerTemp = ActiveDocument.FormFields("NEM_Bez_CB1").CheckBox.Value = False And _
                         ActiveDocument.FormFields("NEM_Bez_CB2").CheckBox.Value = False And _
                         ActiveDocument.FormFields("NEM_Bez_Text").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Bez_CB1"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Bez_CB2"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Bez_Text"))
       
           bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_DD").DropDown.Value = 1
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Verw_DD"))
       
           bFehlerTemp = ActiveDocument.FormFields("NEM_Zeitpunkt").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Zeitpunkt"))
       
       
           bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_DD").DropDown.Value = 2 And _
                         ActiveDocument.FormFields("NEM_Verw_Kupfer").Result = "" And _
                         ActiveDocument.FormFields("NEM_Verw_Blei").Result = "" And _
                         ActiveDocument.FormFields("NEM_Verw_Alu").Result = "" And _
                         ActiveDocument.FormFields("NEM_Verw_frei").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Verw_Kupfer"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Verw_Blei"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Verw_Alu"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Verw_frei"))
           
           
           bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_DD").DropDown.Value = 3 And _
                         ActiveDocument.FormFields("NEM_Wert_Kupfer").Result = "" And _
                         ActiveDocument.FormFields("NEM_Wert_Blei").Result = "" And _
                         ActiveDocument.FormFields("NEM_Wert_Alu").Result = "" And _
                         ActiveDocument.FormFields("NEM_Wert_frei").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Kupfer"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Blei"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Alu"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_frei"))
           
           
           If ActiveDocument.FormFields("NEM_Verw_DD").DropDown.Value = 2 Or bReset = True Then
           
              bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_Kupfer").Result <> "" And _
                            ActiveDocument.FormFields("NEM_Wert_Kupfer").Result = ""
              Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Kupfer"))
            
              bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_Blei").Result <> "" And _
                            ActiveDocument.FormFields("NEM_Wert_Blei").Result = ""
              Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Blei"))
            
              bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_Alu").Result <> "" And _
                            ActiveDocument.FormFields("NEM_Wert_Alu").Result = ""
              Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_Alu"))
            
              bFehlerTemp = ActiveDocument.FormFields("NEM_Verw_frei").Result <> "" And _
                            ActiveDocument.FormFields("NEM_Wert_frei").Result = ""
              Call Markieren(bFehlerTemp, ActiveDocument.FormFields("NEM_Wert_frei"))
           
           End If
              
        End If
        
       
       'Pr|fffd|fung: Aufgliederung der Einheitspreise
        bFehlerTemp = ActiveDocument.Bookmarks("TM53").Range.Font.Hidden = False And ActiveDocument.FormFields("TM53_OZ1").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM53_OZ1"))
       
       
       'Pr|fffd|fung: Instandhaltung
        If ActiveDocument.FormFields("Inst_Bestandteil_CB1").Range.Font.Hidden = False Or bReset = True Then
       
           bFehlerTemp = ActiveDocument.FormFields("Inst_Gegenstand_CB1").CheckBox.Value = False And _
                         ActiveDocument.FormFields("Inst_Gegenstand_CB2").CheckBox.Value = False And _
                         ActiveDocument.FormFields("Inst_Gegenstand_CB3").CheckBox.Value = False And _
                         ActiveDocument.FormFields("Inst_Gegenstand_Text").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Gegenstand_CB1"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Gegenstand_CB2"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Gegenstand_CB3"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Gegenstand_Text"))
       
       
           bFehlerTemp = ActiveDocument.FormFields("Inst_AK_CB1").CheckBox.Value = False And _
                         ActiveDocument.FormFields("Inst_AK_CB2").CheckBox.Value = False And _
                         ActiveDocument.FormFields("Inst_AK_CB3").CheckBox.Value = False
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_AK_CB1"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_AK_CB2"))
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_AK_CB3"))
       
       
           bFehlerTemp = ActiveDocument.FormFields("Inst_Laufzeit").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Laufzeit"))
       
       
           bFehlerTemp = ActiveDocument.FormFields("Inst_Barwert").Range.Font.Hidden = False And _
                         ActiveDocument.FormFields("Inst_Barwert").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Inst_Barwert"))
       
        
        End If
        
       'Pr|fffd|fung: Produktaufkl|fffd|rung
        bFehlerTemp = ActiveDocument.FormFields("TM146_DD").DropDown.Value = 1
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM146_DD"))
            
       'Pr|fffd|fung: Qualit|fffd|tserkl|fffd|rung zur Leistungsbeschreibung
        bFehlerTemp = ActiveDocument.Bookmarks("Erkl_LV").Range.Font.Hidden = False And ActiveDocument.FormFields("Erkl_LV_DD").DropDown.Value = 1
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Erkl_LV_DD"))
        
        bFehlerTemp = ActiveDocument.Bookmarks("Erkl_LV_Begr_Text").Range.Font.Hidden = False And _
                      ActiveDocument.FormFields("Erkl_LV_Begr_Text").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("Erkl_LV_Begr_Text"))
       

'bis hier Pr|fffd|fungen der Felder
'-----------------------------------------------------------

resumeFunction:

    'Funktionen nach reset
    If bReset Then Call doAfterReset  'Funktion "doAfterReset" (siehe unten) muss alle Makros enthalten,
                                      'welche |fffd|ber die zuvor aufgef|fffd|hrten, auf Vollst|fffd|ndigkeit |fffd|berpr|fffd|ften
                                      'Objekte aufgerufen werden !
    
    'Abschlu|fffd| reset
    If bReset = True Then
        ActiveDocument.FormFields("Betrieb_DD").Range.Select
        GoTo endFunction
    End If
    
    Pruefen.hide
    
    Drucken = mAnzahl = 0

    If Drucken = False Then
    
       MsgBox "Es fehlen noch " & mAnzahl & " Pflichtangaben!" & vbNewLine & vbNewLine & _
              "Die noch fehlenden Angaben sind im Dokument in der Farbe ""T|fffd|rkis"" markiert." & vbNewLine & vbNewLine & _
              "Bitte erg|fffd|nzen Sie die fehlenden Angaben.", vbInformation, "Vollst|fffd|ndigkeitspr|fffd|fung"
           
        'Erstes Formularfeld mit fehlenden Angaben selektieren
        Call selectFirstField(strFirstField)
    End If

endFunction:
    
    bReset = False
    If Jump = False Then Call protectFile(True)  'Wert der Variablen "Jump" wird in Funktion "U_Button" festgelegt
  
    ActiveWindow.View.Type = wdPrintView
  
Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
  
End Function

Private Function doAfterReset()
   'Funktionen, die nach einem "reset" ausgef|fffd|hrt werden sollen

      Call ZeitvertragArt                                                  'ZV - Verfahrensart
      ActiveDocument.FormFields("Zeitvertrag_CB").CheckBox.Value = False   'ZV - nein
        Call Zeitvertrag
      
      ActiveDocument.FormFields("DD2_losweise").DropDown.Value = 1         'Lose - nein
        Call Lose
      
      ActiveDocument.FormFields("Instand_CB").CheckBox.Value = False          'Instandhaltung - nein
        Call fcCheckbox_Instandhaltung

      
      Call Nutzerart_Bund
      Call LandBund
      Call Vergabeart
      
    
   'Einblenden evtl. beim Drucken ausgeblendeter Bookmarks
        
      'fehlt noch ...
        
End Function

Public Function selectFirstField(strFieldName As String) As Boolean
    
    'm|fffd|glich sind nur formfields oder OptionButtons
    Dim ff As FormField
    Dim op As OptionButton
    
    Select Case strFirstFieldType
        Case Is = "70", "71"          'Textfeld oder Checkbox
            ThisDocument.FormFields(strFieldName).Range.Select
                        
        Case Else
        
           'Ist das erste Feld mit fehlenden Pflichtangaben ein Dropdownfeld, wird nicht dieses sondern das davor liegende Pfichtfeld
           'markiert (Grund: Die Funktion von DD-Felder ist nicht gegeben, wenn diese automatisiert angesprungen werden).
           'Vor dem allerersten, auf Vollst|fffd|ndigkeit zu pr|fffd|fenden Dropdownfeld im Dokument muss daher ein anderes Pflichtfeld sein, welches
           'ebenfalls vor dem Drucken gepr|fffd|ft wird.
           'Ist dieses (wie hier) nicht der Fall, muss gezielt ein Sprungziel (hier "DD1_Betrieb_Dummy") f|fffd|r diese DD-Felder vorgegeben werden.
                
            If Not lastFFokName = "" And Not strFieldName = "DD1_Betrieb" And Not strFieldName = "Nutzerart_Bund" And Not strFieldName = "TM75_DD" Then
                ThisDocument.FormFields(lastFFokName).Range.Select
            Else
                ThisDocument.FormFields("DD1_Betrieb_Dummy").Range.Select
            End If
    End Select
    
End Function

'Formularfelder markieren
Public Function Markieren(bFehler As Boolean, ffTemp As FormField)

    ThisDocument.FormFields(ffTemp.Name).Range.Select
    
    If bReset = True Then   'nur im "reset" Fall
                
       
        Dim bhidden As Boolean
        bhidden = ThisDocument.Bookmarks(ffTemp.Name).Range.Font.Hidden
            
        If bhidden = True Then ThisDocument.Bookmarks(ffTemp.Name).Range.Font.Hidden = False
      
        
        Selection.Range.HighlightColorIndex = wdNoHighlight 'keine Farbhinterlegung mehr
        
        Select Case ffTemp.Type                             'Textfelder werden geleert
            Case Is = wdFieldFormTextInput
                ffTemp.Result = ""
            Case Is = wdFieldFormCheckBox                   'Checkboxen abgew|fffd|hlt
                ffTemp.CheckBox.Value = False
            Case Is = wdFieldFormDropDown                   'Dropdownfelder 1. Wert aufw|fffd|hlen
                ffTemp.DropDown.Value = 1
        End Select
            
        If Not ThisDocument.Bookmarks(ffTemp.Name).Range.Font.Hidden = bhidden Then ThisDocument.Bookmarks(ffTemp.Name).Range.Font.Hidden = bhidden
            
        Exit Function
    
    End If
    
    
    If Not bFehler Then  'Feld ist komplett
        If ffTemp.Name = strFirstField Then
            strFirstField = ""
            strFirstFieldType = ""
        End If
        
        If bDoCount = True Then
            If ffTemp.Type = wdFieldFormTextInput Or ffTemp.Type = wdFieldFormCheckBox Then
                If ThisDocument.Bookmarks(ffTemp.Name).Range.Font.Hidden = False Then lastFFokName = ffTemp.Name
            End If
        End If
        
        Selection.Range.HighlightColorIndex = wdNoHighlight
    Else
        If strFirstField = "" Then
            strFirstField = ffTemp.Name
            strFirstFieldType = ffTemp.Type
        End If
        
        mAnzahl = mAnzahl + 1
        
        Selection.Range.HighlightColorIndex = wdTurquoise
    End If
    
End Function

'Optionsbuttons markieren
Public Function MarkierenOpt(bFehler As Boolean, opTemp As OptionButton)
    
    If bReset = True Then
        opTemp.BackColor = RGB(255, 255, 255)
        opTemp.Value = False
        Exit Function
    End If
    
    If Not bFehler Then 'Feld ist komplett
    
        If opTemp.Name = strFirstField Then
            strFirstField = ""
            strFirstFieldType = ""
        End If
        
        opTemp.BackColor = RGB(255, 255, 255)
        
    Else
        If strFirstField = "" Then
            strFirstField = opTemp.Name
            strFirstFieldType = "optionbutton"
            bDoCount = False
        End If
        
        mAnzahl = mAnzahl + 1
        
        opTemp.BackColor = RGB(64, 224, 208)    'turquoise
    
    End If
    
End Function

Attribute VB_Name = "DocEvents"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Public WithEvents appWord As Word.Application
Attribute appWord.VB_VarHelpID = -1


Private Sub appWord_DocumentBeforeSave(ByVal doc As Document, SaveAsUI As Boolean, Cancel As Boolean)
     
     If skipSafeCheck = False Then
     
        If checkSourceTemp(doc.Path) = True Then
        
           Cancel = True
           
           Dim strFileName As String
           strFileName = getPath()
           
           If Not strFileName = "" Then
               doc.SaveAs2 (strFileName)
           Else
               MsgBox "Das Speichern der Datei wurde von Ihnen abgebrochen.", vbInformation, "Hinweis"
           End If
           
        End If
        
    End If
    
End Sub


Private Sub appWord_DocumentBeforePrint(ByVal doc As Document, Cancel As Boolean)
    
   'Hinweis und ggf. Abbruch des Druckvorgangs bei nicht aktueller Datei-----------------------
    If aktuell = False Then
       Druck_alt = False      'notwendig, falls nachstehende Userform mit X geschlossen wird
       Druck_veraltet.Show
         DoEvents
    
       If Druck_alt = False Then
          Cancel = True
          Call Aktualit|fffd|tspr|fffd|fung
          Exit Sub
       End If
    
    End If
   '------------------------------------------------------------------------------------------
    
    Call Pr|fffd|fen("all")
    Pruefen.hide
        
    If Drucken = False Then     'False = nicht ausdrucken
       Cancel = True
    Else
       Call fcAusblenden_vor_Druck
    End If
    
End Sub
Attribute VB_Name = "Druck_veraltet"
Attribute VB_Base = "0{ECBCF8B1-846C-4499-9887-BF1341A4643D}{4743AC9A-951C-41F7-AB75-584F5D6564D3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub Druck_veraltet_ja_Click()
    Druck_alt = True
    Druck_veraltet.hide
End Sub

Private Sub Druck_veraltet_nein_Click()
    Druck_alt = False
    Druck_veraltet.hide
End Sub

Attribute VB_Name = "Geduld"
Attribute VB_Base = "0{B11749DC-EFC6-4633-9249-45CBEFA691B9}{13B6786C-9946-43C8-A4B1-E763BC38EAE3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Attribute VB_Name = "KillUnvisibleProcs"

'ben|fffd|tigte Windows API Deklarationen

#If VBA7 Then
    Private Declare PtrSafe Function GetWindowThreadProcessId Lib "user32.dll" ( _
      ByVal hWnd As Long, _
      lpdwProcessId As Long) As Long
    
    Private Declare PtrSafe Function IsWindowVisible Lib "User32" _
    (ByVal hWnd As Long) As Long
    
    Private Declare PtrSafe Function CloseHandle Lib "kernel32" ( _
      ByVal hObject As Long) As Long
     
    Private Declare PtrSafe Function OpenProcess Lib "kernel32" ( _
      ByVal dwDesiredAccess As Long, _
      ByVal bInheritHandle As Long, _
      ByVal dwProcessId As Long) As Long
     
    Private Declare PtrSafe Function TerminateProcess Lib "kernel32" ( _
      ByVal hProcess As Long, _
      ByVal uExitCode As Long) As Long
     
    Private Declare PtrSafe Function FindWindow Lib "User32" _
     Alias "FindWindowA" _
     (ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
#Else
    Private Declare Function GetWindowThreadProcessId Lib "user32.dll" ( _
      ByVal hWnd As Long, _
      lpdwProcessId As Long) As Long
    
    Private Declare Function IsWindowVisible Lib "User32" _
    (ByVal hWnd As Long) As Long
    
    Private Declare Function CloseHandle Lib "kernel32" ( _
      ByVal hObject As Long) As Long
     
    Private Declare Function OpenProcess Lib "kernel32" ( _
      ByVal dwDesiredAccess As Long, _
      ByVal bInheritHandle As Long, _
      ByVal dwProcessId As Long) As Long
     
    Private Declare Function TerminateProcess Lib "kernel32" ( _
      ByVal hProcess As Long, _
      ByVal uExitCode As Long) As Long
     
    Private Declare Function FindWindow Lib "User32" _
     Alias "FindWindowA" _
     (ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
#End If

 
Public Sub killInvisibleWindows(ByVal strDocName As String)

    'Dokumentname zum Fenstertitel erg|fffd|nzen
    strDocName = strDocName & " - Microsoft Word"

    Dim isOk As Long
    isOk = 1
    
    Dim iMax As Integer
    iMax = 1
    
    Do Until isOk = 0
        isOk = GetHandleFromTitle(strDocName)
        
        If iMax = 3 Then Exit Do           'Schleife max. 3 mal durchlaufen, verhindert Endlosschleife im Fehlerfall
        iMax = iMax + 1
    Loop

End Sub

Public Function GetHandleFromTitle(ByVal strFenstertitel As String) As Long

    GetHandleFromTitle = 0     'hWnd, Fensterhandle
        
    'handle anhand des Namens suchen
    GetHandleFromTitle = FindWindow(vbNullString, strFenstertitel)
    
    'hWnd = 0: kein Fenster mit gesuchtem Title gefunden
    If GetHandleFromTitle = 0 Then Exit Function
               
    If IsWindowVisible(GetHandleFromTitle) = 0 Then   'Fenster ist unsichtbar

        Dim procID As Long
        procID = ProcIDFromWnd(GetHandleFromTitle)
    
        If procID > 0 Then Call TerminateProc(procID)
    
    End If
 
End Function
 
Function ProcIDFromWnd(ByVal hWnd As Long) As Long

    Dim idProc As Long
    Call GetWindowThreadProcessId(hWnd, idProc)
    ProcIDFromWnd = idProc
    
End Function

Private Sub TerminateProc(ByVal lTaskID As Long)

   Dim hTask As Long
   Dim lResult As Long
   
   hTask = OpenProcess(&H1, 0&, lTaskID)
   lResult = TerminateProcess(hTask, 1&)
   lResult = CloseHandle(hTask)
   
End Sub
Attribute VB_Name = "Pruefen"
Attribute VB_Base = "0{5DF65730-C330-43EB-8B36-7AD3BD0C8C65}{5402091B-7D2F-4EEA-907F-1B7796E7698D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Attribute VB_Name = "Start"
Attribute VB_Base = "0{FBFD98E3-7CAC-4BF9-BDC7-A662CB18623E}{2EB10D3F-DDDC-41E3-B0D5-1F0D7A0DAFFF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

#If VBA7 Then
 
    Private Declare PtrSafe Function DrawMenuBar Lib "User32" ( _
     ByVal hWnd As Long) As Long
    
    Private Declare PtrSafe Function FindWindow Lib "User32" Alias "FindWindowA" ( _
     ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
    
    Private Declare PtrSafe Function GetWindowLong Lib "User32" Alias "GetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long) As Long
    
    Private Declare PtrSafe Function SetWindowLong Lib "User32" Alias "SetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long, _
     ByVal dwNewLong As Long) As Long
     
#Else

    Private Declare Function DrawMenuBar Lib "User32" ( _
     ByVal hWnd As Long) As Long
    
    Private Declare Function FindWindow Lib "User32" Alias "FindWindowA" ( _
     ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
    
    Private Declare Function GetWindowLong Lib "User32" Alias "GetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long) As Long
    
    Private Declare Function SetWindowLong Lib "User32" Alias "SetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long, _
     ByVal dwNewLong As Long) As Long
     
#End If
     

Const WS_CAPTION As Long = &HC00000
Const GWL_STYLE As Long = (-16)

Dim hWnd&

Private Function GetHandleUF(uf As MSForms.UserForm) As Long
    GetHandleUF = IIf(Int(Val(Application.Version)) < 9, _
        FindWindow("ThunderXFrame", uf.Caption), FindWindow("ThunderDFrame", uf.Caption))
End Function

Private Sub UserForm_Initialize()

    hWnd = GetHandleUF(Me)

   'Die Titelleiste entfernen
    Call SetWindowLong(hWnd, GWL_STYLE, GetWindowLong(hWnd, GWL_STYLE) And Not WS_CAPTION)

    Call DrawMenuBar(hWnd)

End Sub


Attribute VB_Name = "Synchronisation"

'Synchronisation der Inhalte von Steuerelementen

    
'Zur |fffd|bernahme von Bookmarks = Textmarkeninhalten in beliebige andere Textmarken (auch Kopf-/Fu|fffd|zeilen)
'Achtung: Die Textmarke, deren Inhalt |fffd|berschrieben werden soll muss mind. ein Leerzeichen enthalten
'         L|fffd|sung: Textmarke |fffd|ber Leerzeichen legen.

'Aufruf erfolgt wie folgt:
'Call ReSetBookmark("Textmarke in welche Wert zu |fffd|bernehmen ist", ActiveDocument.FormFields("Textmarke von welcher Wert |fffd|bernommen wird").Result)

 Public Sub ReSetBookmark(ByVal TMName As String, ByVal TMInhalt As String)

    Dim bm As Bookmark
    Dim rng As Range
     
    If ActiveDocument.Bookmarks.Exists(TMName) Then
        Set bm = ActiveDocument.Bookmarks(TMName)
        Set rng = bm.Range
        rng.Text = TMInhalt
        ActiveDocument.Bookmarks.Add Name:=TMName, Range:=rng
    End If
     
    Set rng = Nothing
    Set bm = Nothing

End Sub

'nur f|fffd|r tempor|fffd|re Datei beim Erstellen der WBVB
 Public Sub ReSetBookmark_Temp(ByVal TMName As String, ByVal TMInhalt As String)

    Dim bm As Bookmark
    Dim rng As Range
     
    If docTemp.Bookmarks.Exists(TMName) Then
        Set bm = docTemp.Bookmarks(TMName)
        Set rng = bm.Range
        rng.Text = TMInhalt
        docTemp.Bookmarks.Add Name:=TMName, Range:=rng
    End If
     
    Set rng = Nothing
    Set bm = Nothing

End Sub


'Setzt Inhalt eines Formfields auf leer (Textfeld), nicht angehakt (Checkbox) bzw. auf 1 (Dropdown) bei Aufruf mit "False"
'Bei Aufruf mit "True" wird Wert zur|fffd|ckgegeben, ob Textfeld leer, eine Checkbox nicht angehakt oder ein Dropdownfeld auf 1 gesetzt ist.

'Aufruf erfolgt wie folgt:
'Call resetField("Feldbezeichnung", False oder True)

Public Function resetField(strFieldName As String, bOnlyCheckIfEmpty As Boolean) As Boolean
    
    On Error GoTo ende
    resetField = False
    
    Dim ff As FormField
    Set ff = ThisDocument.FormFields(strFieldName)
    
    Select Case ff.Type
      Case 70  ' Textfeld
        If bOnlyCheckIfEmpty Then
            resetField = ff.Result = ""
        Else
            ff.Result = ""
        End If
        
      Case 71  ' Checkbox
        If bOnlyCheckIfEmpty Then
            resetField = ff.CheckBox.Value = False
        Else
            ff.CheckBox.Value = False
        End If
        
      Case 83   ' Dropdown
        If bOnlyCheckIfEmpty Then
            resetField = ff.DropDown.Value = 1
        Else
            ff.DropDown.Value = 1
        End If
        
    End Select
    
ende:
    
End Function


Sub VergNr()

    Call protectFile(False)
    
        Call ReSetBookmark("VergNr_Kopf", ActiveDocument.FormFields("VergNr").Result)
        
        
        If ActiveDocument.FormFields("VergNr").Result = "" Then
           ActiveDocument.Bookmarks("VergNr_Kopf_Bez").Range.Font.Hidden = True
        Else
           ActiveDocument.Bookmarks("VergNr_Kopf_Bez").Range.Font.Hidden = False
        End If
       
    Call protectFile(True)

End Sub


Sub Projekt()

    If bReset = False And ActiveDocument.FormFields("Projekt").Result = "reset" Then Call Pr|fffd|fen("Projekt") 'Notwendig, um beim Verlassen des Feldes "Projekt" zu pr|fffd|fen, ob dort die Zeichenfolge "reset" erfasst ist.
                                                                                                            'Wenn ja, werden |fffd|ber die Funktion "Pr|fffd|fen" alle Pflichtfelder zur|fffd|ckgesetzt, d.h. inhaltlich geleert und nicht farbig markiert.
    
    Call protectFile(False)
      Call ReSetBookmark("Projekt_Kopf", ActiveDocument.FormFields("Projekt").Result)
    Call protectFile(True)
        

End Sub


Sub Leistung()

    Call protectFile(False)
      Call ReSetBookmark("Leistung_Kopf", ActiveDocument.FormFields("Leistung").Result)
    Call protectFile(True)

End Sub


Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "WBVB_erstellen, 36, 16, MSForms, CommandButton"
Attribute VB_Control = "Vollst|fffd|ndigkeit_pr|fffd|fen, 35, 17, MSForms, CommandButton"
Attribute VB_Control = "U6_Button, 34, 18, MSForms, CommandButton"
Attribute VB_Control = "U5_Button, 33, 19, MSForms, CommandButton"
Attribute VB_Control = "U4_Button, 32, 20, MSForms, CommandButton"
Attribute VB_Control = "Sign_individuell, 31, 21, MSForms, CommandButton"
Attribute VB_Control = "Sign_Technik, 30, 22, MSForms, CommandButton"
Attribute VB_Control = "Sign_Hochbau, 29, 23, MSForms, CommandButton"
Attribute VB_Control = "U3_Button, 28, 24, MSForms, CommandButton"
Attribute VB_Control = "U2_Button, 27, 25, MSForms, CommandButton"
Attribute VB_Control = "U1_Button, 26, 26, MSForms, CommandButton"
Attribute VB_Control = "Erkl|fffd|rung_zum_LV, 25, 27, MSForms, CommandButton"
Attribute VB_Control = "cbDelete5, 24, 28, MSForms, CommandButton"
Attribute VB_Control = "CBInsert5, 23, 29, MSForms, CommandButton"
Attribute VB_Control = "cbDelete1, 22, 30, MSForms, CommandButton"
Attribute VB_Control = "CBInsert1, 21, 31, MSForms, CommandButton"
Attribute VB_Control = "cbDelete, 20, 32, MSForms, CommandButton"
Attribute VB_Control = "CBInsert, 19, 33, MSForms, CommandButton"
Attribute VB_Control = "TM31_RB3, 18, 34, MSForms, OptionButton"
Attribute VB_Control = "TM31_RB2, 17, 35, MSForms, OptionButton"
Attribute VB_Control = "TM31_RB1, 16, 36, MSForms, OptionButton"
Attribute VB_Control = "cbDelete8, 15, 37, MSForms, CommandButton"
Attribute VB_Control = "CBInsert8, 14, 38, MSForms, CommandButton"
Attribute VB_Control = "cbDelete7, 13, 39, MSForms, CommandButton"
Attribute VB_Control = "CBInsert7, 12, 40, MSForms, CommandButton"
Attribute VB_Control = "TM24_2_1_RB2, 11, 41, MSForms, OptionButton"
Attribute VB_Control = "TM24_2_1_RB1, 10, 42, MSForms, OptionButton"
Attribute VB_Control = "cbDelete6, 9, 43, MSForms, CommandButton"
Attribute VB_Control = "CBInsert6, 8, 44, MSForms, CommandButton"
Attribute VB_Control = "TM13_Erkl_RB2, 7, 45, MSForms, OptionButton"
Attribute VB_Control = "TM13_Erkl_RB1, 6, 46, MSForms, OptionButton"
Attribute VB_Control = "cbDelete2, 5, 47, MSForms, CommandButton"
Attribute VB_Control = "CBInsert2, 4, 48, MSForms, CommandButton"
Attribute VB_Control = "cbDelete4, 3, 49, MSForms, CommandButton"
Attribute VB_Control = "CBInsert4, 2, 50, MSForms, CommandButton"
Attribute VB_Control = "cbDelete3, 1, 51, MSForms, CommandButton"
Attribute VB_Control = "CBInsert3, 0, 52, MSForms, CommandButton"
Option Explicit
' Klasseninstanz f|fffd|r Eventhandler
Dim thisAppDoc As New DocEvents

'Konstanten mit URLPfaden                                                   'mit / am Ende
Private Const UrlFormulare As String = "http://www.vbv.statistik-bw.de/Formulare/"

'Startmakro beim Neuerstellen eine Datei aus Vorlagedatei durch Doppelklick
    Private Sub Document_New()
    
    ThisDocument.Activate 'Focus auf dieses Dokument legen
    Application.Visible = True

    
    Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung
    
       'Aktualit|fffd|tspr|fffd|fung Office
        If Application.Version < "14.0" Then  '14.0 = Word 2010
           MsgBox "Die Funktionalit|fffd|ten dieses Arbeitsmittels erfordern ""Word 2010"" oder aktueller." + vbNewLine + _
                  "Bitte installieren Sie vor der Verwendung dieses Arbeitsmittels eine aktuelle Word Version.", vbInformation, "Aktualit|fffd|tspr|fffd|fung"
           Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, wenn am Beginn auf "false" gesetzt
           Exit Sub
        End If
    
        ActiveWindow.View.Type = wdNormalView
    
        Call Internet
        
        Start.Show (0)  'Anzeige des Formulars "Start"
          DoEvents       'notwendig, um Inhalt des Formulars anzuzeigen
        
        Call protectFile(False)
          checkBetrieb
          Pr|fffd|fung_Import
          setStartupValues
        Call protectFile(True)
        
       'Ablageort der Anlagen - Link
        If ActiveDocument.FormFields("Anlagen_Ort_Text").Range.Font.Hidden = False Then Call Anlagen_Link
        
        Set thisAppDoc.appWord = ThisDocument.Application
        
        Start.hide      'Ausblenden des Formulars "Start"
        
        ActiveWindow.View.Type = wdPrintView
        
        Call ReadOnly_Dir_check
        
    Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
        
    End Sub

'Startmakro beim |fffd|ffnen einer bestehenden Datei
    Private Sub Document_Open()
        
       ThisDocument.Activate 'Focus auf dieses Dokument legen
       Application.Visible = True
        
        
       Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung
        
       'Aktualit|fffd|tspr|fffd|fung Office
        If Application.Version < "14.0" Then  '14.0 = Word 2010
           MsgBox "Die Funktionalit|fffd|ten dieses Arbeitsmittels erfordern ""Word 2010"" oder aktueller." + vbNewLine + _
                  "Bitte installieren Sie vor der Verwendung dieses Arbeitsmittels eine aktuelle Word Version.", vbInformation, "Aktualit|fffd|tspr|fffd|fung"
           Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, wenn am Beginn auf "false" gesetzt
           Exit Sub
        End If
        
        Set thisAppDoc.appWord = ThisDocument.Application
        
        ActiveWindow.View.Type = wdNormalView
        
        Call Internet
       
        ThisDocument.Activate 'Focus auf dieses Dokument legen, sonst funktioniert "ActiveDocument..." nach Download nicht !
            
        Start.Show (0)       'Anzeige des Formulars "Start"
          DoEvents       'notwendig, um Inhalt des Formulars anzuzeigen
            
        Call protectFile(False)
          checkBetrieb
          Pr|fffd|fung_Import
          setStartupValues
        Call protectFile(True)
        
       'Ablageort der Anlagen - Link
        If ActiveDocument.FormFields("Anlagen_Ort_Text").Range.Font.Hidden = False Then Call Anlagen_Link
        
        Start.hide           'Ausblenden des Formulars "Start"
        
        ActiveWindow.View.Type = wdPrintView
        
        Call ReadOnly_Dir_check
        
        Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
        
    End Sub
    
'Makro beim Schlie|fffd|en der Datei
    Sub AutoClose()
    
        'Wiederherstellen der urspr|fffd|nglichen Word-Einstellungen ----------------------------------------------
        ActiveDocument.ActiveWindow.View.ShowHiddenText = m_ShowHiddenText  'Verstecken des "ausgeblendeten Textes"
        ActiveDocument.ActiveWindow.View.ShowAll = m_ShowAll                'Ausblenden von "ausgeblendetem Text" + "allen Formatierungszeichen"
        Options.PrintHiddenText = m_PrintHiddenText                         'Ausgeblendeter Text wird nicht gedruckt
        ActiveDocument.ActiveWindow.View.TableGridlines = m_TableGridlines  'Ausblenden der Tabellen-Rasterlinien
        Options.CtrlClickHyperlinkToOpen = m_HyperlinkOpen                  'Aufruf Hyperlink (mit/ohne Strg)

        If m_MarkupMode = 1 Then                                            'Alle |fffd|berarbeitungen inline anzeigen
            ActiveDocument.ActiveWindow.View.MarkupMode = wdInLineRevisions
        ElseIf m_MarkupMode = 2 Then                                        'Nur Kommentare und Formatierungen in Sprechblasen anzeigen
            ActiveDocument.ActiveWindow.View.MarkupMode = wdMixedRevisions
        ElseIf m_MarkupMode = 3 Then                                        '|fffd|berarbeitungen in Sprechblasen anzeigen
            ActiveDocument.ActiveWindow.View.MarkupMode = wdBalloonRevisions
        End If
         '---------------------------------------------------------------------------------------------------
    
         ActiveDocument.Bookmarks("TM171").Range.Font.Hidden = False 'Einblenden des Hinweises "Bitte Makros aktivieren"
         
         Call protectFile(False)
         ActiveDocument.Protect Password:="Vergadmin", NoReset:=False, Type:=wdAllowOnlyReading, UseIRM:=False, EnforceStyleLock:=False  '"nur Lesen"-Schutz anbringen
    
    End Sub

'Schaltfl|fffd|chen <Zeile einf|fffd|gen> bzw. <Zeile entfernen>

    'Stoffpreisgleitklausel
      Private Sub cbInsert_Click()    '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete_Click()    '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Aufgliederung der Einheitspreise
      Private Sub cbInsert1_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete1_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Aufzufordernde Bewerber
      Private Sub cbInsert2_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete2_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Losbezogener Auftragswert
      Private Sub cbInsert3_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete3_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Print-Ver|fffd|ffentlichungsmedien
      Private Sub cbInsert4_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete4_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Produktaufkl|fffd|rung nach Angebotser|fffd|ffnung
      Private Sub cbInsert5_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete5_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

    'Pl|fffd|ne und sonstige Anlagen - "im Verfahren zu beachten"
      Private Sub cbInsert6_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete6_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub
      
    'Pl|fffd|ne und sonstige Anlagen - "Vertragsbestandteil" - Pl|fffd|ne
      Private Sub cbInsert7_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete7_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub
      
    'Pl|fffd|ne und sonstige Anlagen - "Vertragsbestandteil" - Sonstige Anlagen
      Private Sub cbInsert8_Click()   '"Zeile einf|fffd|gen"
        Call InsertRow
      End Sub

      Private Sub cbDelete8_Click()   '"Zeile entfernen"
        Call DeleteRow
      End Sub

'Schaltfl|fffd|che "Erkl|fffd|rung zum LV"
      Private Sub Erkl|fffd|rung_zum_LV_Click()
        Call startWord("Erklaerung_zum_LV.docm", UrlFormulare)
      End Sub
      
 
'Schaltfl|fffd|chen zur Unterschriftenregelung der VBV Ba-W|fffd|

     'Hoch-/Tiefbau
      Private Sub Sign_Hochbau_Click()
      Call fcUnterschrift_Hochbau
      End Sub

     'Technik
      Private Sub Sign_Technik_Click()
      Call fcUnterschrift_Technik
      End Sub

     'Individuell
      Private Sub Sign_individuell_Click()
      Call fcUnterschrift_Individuell
      End Sub

'Eigenerkl|fffd|rung - Klick auf Radiobutton "von Vergabestelle anzufordern"
      Private Sub TM13_Erkl_RB2_Click()
      
        MsgBox "Entsprechend der getroffenen Auswahl werden die ""Eigenerkl|fffd|rungen"" durch die Vergabestelle angefordert." & vbNewLine & _
               "Diese ""Eigenerkl|fffd|rungen"" liegen ca. 7 Tage nach Eingang der Datenliste bei der Vergabestelle vor." & vbNewLine & vbNewLine & _
               "Bitte ber|fffd|cksichtigen Sie diesen Zeitraum bei Ihrer Terminplanung.", vbInformation, "Anforderung der Eigenerkl|fffd|rung"
      
      End Sub

'Pl|fffd|ne und sonstige Anlagen - Klick auf Radiobuttons
      Private Sub TM24_2_1_RB1_Click()
        Call Anlagen_Vertrag_Plaene_Ja
      End Sub

      Private Sub TM24_2_1_RB2_Click()
        Call Anlagen_Vertrag_Plaene_Nein
      End Sub

'Nebenangebote zugelassen - Klick auf Radiobuttons

     Private Sub TM31_RB1_Click() 'Button 1
       Call fcNebenang_zugelassen
     End Sub

     Private Sub TM31_RB2_Click() 'Button 2
       Call fcNebenang_zugelassen
     End Sub

     Private Sub TM31_RB3_Click() 'Button 3
       Call fcNebenang_zugelassen
     End Sub


'Unterschriften

Private Sub U1_Button_Click()
   Call U_Button(U1_Button, "U1")
End Sub

Private Sub U2_Button_Click()
   Call U_Button(U2_Button, "U2")
End Sub

Private Sub U3_Button_Click()
   Call U_Button(U3_Button, "U3")
End Sub

Private Sub U4_Button_Click()
   Call U_Button(U4_Button, "U4")
End Sub

Private Sub U5_Button_Click()
   Call U_Button(U5_Button, "U5")
End Sub

Private Sub U6_Button_Click()
   Call U_Button(U6_Button, "U6")
End Sub


Function U_Button(UB As CommandButton, UBName As String)    'den CommandButton als solchen |fffd|bergeben, ist dann direkt ansprechbar

    Call protectFile(False)
    
      If ActiveDocument.Bookmarks(UBName & "_User").Range.Text = "" Then        'noch kein Username vorhanden = signieren
      
        'Vollst|fffd|ndigkeit pr|fffd|fen
         Jump = True
           Call Pr|fffd|fen("all")
         Jump = False
         
         Pruefen.hide
         If Drucken = False Then GoTo weiter  'Wert der Variablen wird in Funktion "Pr|fffd|fen" festgelegt
       
        'Username
         ActiveDocument.FormFields(UBName & "_User_free").Result = ""
         ActiveDocument.FormFields(UBName & "_User_free").Range.Font.Hidden = True
         
         Call ReSetBookmark(UBName & "_User", User)                             'Username wird |fffd|bernommen
         ActiveDocument.Bookmarks(UBName & "_User").Range.Font.Hidden = False
      
        'Datum
         ActiveDocument.FormFields(UBName & "_Date_free").Result = ""
         ActiveDocument.FormFields(UBName & "_Date_free").Range.Font.Hidden = True
                  
         Call ReSetBookmark(UBName & "_Date", Format(Date, "ddd, dd.mm.yyyy"))  'aktuelles Datum einlesen
         ActiveDocument.Bookmarks(UBName & "_Date").Range.Font.Hidden = False
                  
        'Schaltfl|fffd|che
         UB.Caption = unsign   'Schaltfl|fffd|chenbeschriftung |fffd|ndern
         UB.ForeColor = &HFE&  'Schriftfarbe = rot
                  
        'Hinweis
         ActiveDocument.Bookmarks(UBName & "_Hinw").Range.Font.Hidden = False
          
         
      Else  'Username bereits vorhanden = Signatur wieder aufheben
         
         If ActiveDocument.Bookmarks(UBName & "_User").Range.Text = User Then      'Eintrag im Dokument ist identisch mit Username
            
            If MsgBox("Mit dem Aufheben der Signatur wird der Name des Unterzeichners """ & User & """ sowie das Datum der Signatur """ & ActiveDocument.Bookmarks(UBName & "_Date").Range.Text & """ entfernt." + Chr(13) + Chr(13) + _
                      "M|fffd|chten Sie die Signatur wirklich aufheben ? ", vbYesNo + vbQuestion, "Signatur aufheben") = vbYes Then
            
              'Username
               Call ReSetBookmark(UBName & "_User", "")
               ActiveDocument.FormFields(UBName & "_User_free").Range.Font.Hidden = False
            
              'Datum
               Call ReSetBookmark(UBName & "_Date", "")
               ActiveDocument.FormFields(UBName & "_Date_free").Range.Font.Hidden = False
            
              'Schaltfl|fffd|che
               UB.Caption = sign         'Schaltfl|fffd|chenbeschriftung |fffd|ndern
               UB.ForeColor = &HFF0000   'Schriftfarbe = blau
            
              'Hinweis
               ActiveDocument.Bookmarks(UBName & "_Hinw").Range.Font.Hidden = True
            
            End If
 
            
         Else      'Eintrag im Dokument ist NICHT identisch mit Username
            MsgBox "Sie sind mit dem Benutzernamen """ & User & """ an diesem PC angemeldet." + vbNewLine + vbNewLine + _
                   "Das Aufheben der elektronischen Signatur ist ausschlie|fffd|lich dem Unterzeichner selbst (" & ActiveDocument.Bookmarks(UBName & "_User").Range.Text & ") vorbehalten.", vbInformation, "Pr|fffd|fung der Legitimation"
         End If
      
      End If
    
      ActiveDocument.FormFields(UBName & "_Funktion").Select
    
weiter:
    Call protectFile(True)

End Function


'Vollst|fffd|ndigkeit der Angaben pr|fffd|fen
    Private Sub Vollst|fffd|ndigkeit_pr|fffd|fen_Click()
       Call Vollst|fffd|ndigkeits_Check
    End Sub

'WBVB erstellen
    Private Sub WBVB_erstellen_Click()
        
      Call protectFile(False)
        
        Call ReSetBookmark("VergNr_Kopf", ActiveDocument.FormFields("VergNr").Result)
        Call ReSetBookmark("Projekt_Kopf", ActiveDocument.FormFields("Projekt").Result)
        Call ReSetBookmark("Leistung_Kopf", ActiveDocument.FormFields("Leistung").Result)
        
        Call createWBVB
        
      Call protectFile(True)
        
    End Sub


Private Function startWord(ByVal strFileName As String, ByVal strUrl As String) As Boolean
        
        If DownloadFile(strUrl & strFileName, Environ("TEMP") & "\" & strFileName) Then
            
            On Error Resume Next
            
            Dim wdNeu As New Word.Application
            wdNeu.Visible = True
            
            AppActivate wdNeu.Caption  'Word im Vordergrund darstellen
            wdNeu.Documents.Open FileName:=Environ("TEMP") & "\" & strFileName
            
            AppActivate (wdNeu.ActiveDocument)
            AppActivate wdNeu.Caption
            
            startWord = True
            Set wdNeu = Nothing
            Exit Function
        Else
            MsgBox TechnProblem, vbInformation, "Technisches Problem"
            startWord = False
        End If

End Function

Attribute VB_Name = "Unterschriftenregelung"

    
Function setButtons() 'geht alle OLE-Objekte im Dokument durch und ruft f|fffd|r alle Objekte, deren Namen mit "U" beginnen,
                      '= Unterschriftenschaltfl|fffd|chen (U1, U2, ... U6) , die Funktion "Unterschr_Button" auf.

    Dim btnx As InlineShape
    
    For Each btnx In ActiveDocument.InlineShapes
        If btnx.Type = wdInlineShapeOLEControlObject Then
            If btnx.OLEFormat.ClassType = "Forms.CommandButton.1" And Left$(btnx.OLEFormat.Object.Name, 1) = "U" Then   'Name beginnt mit "U"
                Call Unterschr_Button(btnx, Left$(btnx.OLEFormat.Object.Name, 2))
            End If
        End If
    Next btnx

End Function
        
        
Function Unterschr_Button(UB As InlineShape, UBName As String)

'User = "Test"    '<== nur f|fffd|r Testzwecke !!!

    If ActiveDocument.Bookmarks(UBName & "_User").Range.Text <> "" And Not _
       ActiveDocument.Bookmarks(UBName & "_User").Range.Text = User Then   'Unterzeichner vorhanden aber nicht User
        UB.OLEFormat.Object.Caption = unsign          'Schaltfl|fffd|chenbeschriftung |fffd|ndern
        UB.OLEFormat.Object.ForeColor = &H808080      'Schriftfarbe = grau
    End If
       
    
    If ActiveDocument.Bookmarks(UBName & "_User").Range.Text = User Then    'Unterzeichner = User
        UB.OLEFormat.Object.Caption = unsign          'Schaltfl|fffd|chenbeschriftung |fffd|ndern
        UB.OLEFormat.Object.ForeColor = &HFF&         'Schriftfarbe = rot
    End If
    
    If ActiveDocument.Bookmarks(UBName & "_User").Range.Text = "" Then      'kein Unterzeichner
        UB.OLEFormat.Object.Caption = sign            'Schaltfl|fffd|chenbeschriftung |fffd|ndern
        UB.OLEFormat.Object.ForeColor = &HFF0000      'Schriftfarbe = blau
    End If
  
End Function


Sub U_weitere_CB()

    Call fcU_weitere_CB
    ActiveDocument.Bookmarks("U_weitere_CB_Dummy").Select

End Sub


Function fcU_weitere_CB()

    If ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = False Then
       ActiveDocument.Bookmarks("U_Z2").Range.Font.Hidden = True
    Else
       ActiveDocument.Bookmarks("U_Z2").Range.Font.Hidden = False
       
       For i = 4 To 6

           If ActiveDocument.Bookmarks("U" & i & "_User").Range.Text <> "" Then 'Unterzeichner vorhanden
              ActiveDocument.FormFields("U" & i & "_User_free").Range.Font.Hidden = True
              ActiveDocument.FormFields("U" & i & "_Date_free").Range.Font.Hidden = True
           Else
              ActiveDocument.Bookmarks("U" & i & "_Hinw").Range.Font.Hidden = True
           End If

       Next
       
       Call setButtons
       
    End If

End Function



Function fcUnterschrift_Hochbau(Optional bProtect As Boolean = True)
    
    Dim Sign_R|fffd|ckgabe As Byte

    Call protectFile(False)

    Sign_R|fffd|ckgabe = MsgBox("Wird die Sachbearbeitung und Projektleitung von einer Person wahrgenommen?", vbYesNo, "Unterschriftenpr|fffd|fung")

    If Sign_R|fffd|ckgabe = vbYes Then
    
       ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = True
       Call fcU_weitere_CB
    
       ActiveDocument.FormFields("U1_Funktion").Result = "Projektleiter(in)"
       ActiveDocument.FormFields("U2_Funktion").Result = "Abteilungsleiter(in)"
       ActiveDocument.FormFields("U3_Funktion").Result = "Vergabestelle"
       ActiveDocument.FormFields("U4_Funktion").Result = "Haushalt"
       ActiveDocument.FormFields("U5_Funktion").Result = ""
       ActiveDocument.FormFields("U6_Funktion").Result = ""
       
    Else
       
       ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = True
       Call fcU_weitere_CB
       
       ActiveDocument.FormFields("U1_Funktion").Result = "Sachbearbeiter(in)"
       ActiveDocument.FormFields("U2_Funktion").Result = "Projektleiter(in)"
       ActiveDocument.FormFields("U3_Funktion").Result = "Abteilungsleiter(in)"
       ActiveDocument.FormFields("U4_Funktion").Result = "Vergabestelle"
       ActiveDocument.FormFields("U5_Funktion").Result = "Haushalt"
       ActiveDocument.FormFields("U6_Funktion").Result = ""
       
    End If
    
    If bProtect = True Then Call protectFile(True)

End Function


Function fcUnterschrift_Technik(Optional bProtect As Boolean = True)
    
    Dim Sign_R|fffd|ckgabe As Byte

    Call protectFile(False)

    Sign_R|fffd|ckgabe = MsgBox("Wird die Sachbearbeitung und Projektleitung von einer Person wahrgenommen?", vbYesNo, "Unterschriftenpr|fffd|fung")

    If Sign_R|fffd|ckgabe = vbYes Then
       
       ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = True
       Call fcU_weitere_CB
       
       ActiveDocument.FormFields("U1_Funktion").Result = "Projektl. Technik"
       ActiveDocument.FormFields("U2_Funktion").Result = "Abteilungsl. Technik"
       ActiveDocument.FormFields("U3_Funktion").Result = "Vergabestelle"
       ActiveDocument.FormFields("U4_Funktion").Result = "Haushalt"
       ActiveDocument.FormFields("U5_Funktion").Result = ""
       ActiveDocument.FormFields("U6_Funktion").Result = ""
       
    Else

       ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = True
       Call fcU_weitere_CB
       
       ActiveDocument.FormFields("U1_Funktion").Result = "Sachbearb. Technik"
       ActiveDocument.FormFields("U2_Funktion").Result = "Abteilungsl. Technik"
       ActiveDocument.FormFields("U3_Funktion").Result = "Projektleiter(in)"
       ActiveDocument.FormFields("U4_Funktion").Result = "Vergabestelle"
       ActiveDocument.FormFields("U5_Funktion").Result = "Haushalt"
       ActiveDocument.FormFields("U6_Funktion").Result = ""
       
    End If
    
    If bProtect = True Then Call protectFile(True)

End Function

Function fcUnterschrift_Individuell(Optional bProtect As Boolean = True)
    
    Call protectFile(False)
       
       ActiveDocument.FormFields("U_weitere_CB").CheckBox.Value = False
       Call fcU_weitere_CB
       
       ActiveDocument.FormFields("U1_Funktion").Result = ""
       ActiveDocument.FormFields("U2_Funktion").Result = ""
       ActiveDocument.FormFields("U3_Funktion").Result = ""
       ActiveDocument.FormFields("U4_Funktion").Result = ""
       ActiveDocument.FormFields("U5_Funktion").Result = ""
       ActiveDocument.FormFields("U6_Funktion").Result = ""

    If bProtect = True Then Call protectFile(True)

End Function
Attribute VB_Name = "Update"
Option Explicit

''API Funktionen
#If VBA7 Then
    
   Private Declare PtrSafe Function URLDownloadToFile Lib "urlmon" Alias _
                            "URLDownloadToFileA" ( _
                                ByVal pCaller As Long, _
                                ByVal szURL As String, _
                                ByVal szFileName As String, _
                                ByVal dwReserved As Long, _
                                ByVal lpfnCB As Long) As Long
    
   Private Declare PtrSafe Function DeleteUrlCacheEntry Lib "wininet.dll" Alias _
       "DeleteUrlCacheEntryA" (ByVal lpszUrlName As String) As Long
    
#Else

   Private Declare Function URLDownloadToFile Lib "urlmon" Alias _
                            "URLDownloadToFileA" ( _
                                ByVal pCaller As Long, _
                                ByVal szURL As String, _
                                ByVal szFileName As String, _
                                ByVal dwReserved As Long, _
                                ByVal lpfnCB As Long) As Long

   Private Declare Function DeleteUrlCacheEntry Lib "wininet.dll" Alias _
       "DeleteUrlCacheEntryA" (ByVal lpszUrlName As String) As Long

#End If
    
Private strDownloadFileNeu As String    ' keinen Wert zuweisen
Private strUpdatelinkTemp As String     ' keinen Wert zuweisen
    
'-------------------------------------------------------------------------------------------------------------------------------------------
'-------------------------------------------------------------------------------------------------------------------------------------------

''Festlegung der Konstanten
'URL der Datei, anhand der gepr|fffd|ft wird, ob eine Internetverbindung besteht (Datei erreichbar = Internetverbindung, sonst keine)
Private Const strCheckFile As String = "http://www.vbv.statistik-bw.de/Internetverbindung/CheckInternet.txt"

'URL des Updateordners
Private Const strUpdatelink As String = "http://www.vbv.statistik-bw.de/Datenliste/VOB/"      ' "/" am Ende nicht zwingend, wird gepr|fffd|ft und ggf. korrigiert

'Name des Downloadfile auf dem Server
Public Const strDownloadFile As String = "VHB-Standard_Zeitvertrag.docm"   '<= Dateibezeichnung der Anwendung

Private Const strVersNr As String = "VHB-Standard_Zeitvertrag_Version_025.txt"    '<= Versionsdatei (txt-Format) - letzte |fffd|nderung wg. Viren-Problem beim Mailversand
                                'Anhand dieser Versionsdatei wird gepr|fffd|ft, ob die Anwendung noch aktuell ist.
                                'Die Bezeichnung entspricht der Dateibezeichnung der Anwendung mit einem fortlaufenden Index,
                                'welcher bei einer neuen Version um einen Z|fffd|hler erh|fffd|ht wird.
                                'Auf dem Updateserver ist dann die veraltete Versionsdatei zu l|fffd|schen und die neue hochzuladen.
                                'Im nachfolgenden Code wird gepr|fffd|ft, ob die in dieser Anwendung bezeichnete Versionsdatei noch
                                'auf dem Updateserver liegt.
                                'Wenn ja = kein Update erforderlich.
                                'Wenn nein = Update erforderlich.


Private Function URLVorhanden(ByVal sURL As String) As Boolean
    
    Dim oHTTP As Object
    Dim lStatus As Long
    
    On Error Resume Next        'im Fehlerfall mit der n|fffd|chsten Anweisung fortfahren
    DeleteUrlCacheEntry (sURL)  'evtl. vorhandene tempor|fffd|re Datei aus dem IE-Cache entfernen

    On Error GoTo ende          'wenn Error-Meldung, dann weiter mit "ende:"
   
    Set oHTTP = CreateObject("Microsoft.XMLHTTP")
    With oHTTP
        .Open "GET", sURL, False
        .Send
        lStatus = .Status
    End With
    
    Set oHTTP = Nothing
    
    URLVorhanden = lStatus = 200  'wenn Status 200 dann URLVorhanden = True
    Exit Function
    
ende:
    URLVorhanden = False

End Function

Sub Internet()  'Pr|fffd|fung, ob Internetverbindung zum Updateserver besteht
      
   aktuell = True
      
   If URLVorhanden(strCheckFile) Then
      Call Aktualit|fffd|tspr|fffd|fung
   Else
      If MsgBox("Die Suche nach Updates ist fehlgeschlagen." + Chr$(13) + "Eine Verbindung zum Updateserver konnte nicht hergestellt werden." + Chr$(13) + "Das kann folgende Ursachen haben:" + Chr$(13) + Chr$(13) + "- Es besteht keine Internetverbindung," + Chr$(13) + "- Der Updateserver ist derzeit nicht ansprechbar," + Chr$(13) + "- Ihre Firewall verweigert der Anwendung den Internetzugriff." + Chr$(13) + Chr$(13) + "M|fffd|chten Sie den Vorgang wiederholen?", vbYesNo + vbQuestion, "Pr|fffd|fung der Internetverbindung") = vbYes Then
         Call Internet
      End If
   End If
    
End Sub

Sub Aktualit|fffd|tspr|fffd|fung() 'Pr|fffd|fung, ob aktuellere Datei bereitgestellt wurde

    Dim strFileTemp As String
    
    Dim strMsg As String
    strMsg = "Wegen eines technischen Problems kann die neue Version dieser Datei nicht heruntergeladen werden." + Chr$(13) + "Wir bitten diesen Umstand zu entschuldigen." + Chr$(13) + Chr$(13) + "Bitte setzen Sie sich |fffd|ber die Vergabestelle mit dem Anwendungssupport in Verbindung."

    'Tempor|fffd|r verwendete und ver|fffd|nderbare Variablen setzen und pr|fffd|fen auf "/" am Ende
    strDownloadFileNeu = strDownloadFile
    strUpdatelinkTemp = strUpdatelink
    If Right(strUpdatelinkTemp, 1) <> "/" Then strUpdatelinkTemp = strUpdatelinkTemp & "/"
    
    'Versionsdatei aus dem Cache entfernen
    On Error Resume Next        'im Fehlerfall mit der n|fffd|chsten Anweisung fortfahren
    DeleteUrlCacheEntry (strUpdatelinkTemp & strVersNr)
 
    If URLVorhanden(strUpdatelinkTemp & strVersNr) Then
        'MsgBox "Die Datei ist auf dem aktuellen Stand.", vbInformation, "Aktualit|fffd|tspr|fffd|fung" 'Vor der Auslieferung auskommentieren
        Exit Sub
    Else
        aktuell = False

        If MsgBox("Die Datei ist nicht mehr aktuell." + vbNewLine + "Sofern erst k|fffd|rzlich Daten in dieser Datenliste erfasst wurden, kann diese Datei weiterverwendet werden." + vbNewLine + vbNewLine + _
                  "M|fffd|chten Sie die neue Version dieser Datei herunterladen?" + vbNewLine + "(Daten werden nicht |fffd|bernommen)", _
            vbYesNo + vbQuestion, "Aktualit|fffd|tspr|fffd|fung") = vbYes Then
            If URLVorhanden(strUpdatelinkTemp & strDownloadFile) = False Then     'Pr|fffd|fung, ob neue Datei auf Updateserver liegt
                MsgBox strMsg, vbInformation, "Hinweis"
            Else
                'Zielpfad f|fffd|r Download abfragen, Abbruch, wenn keine Angabe durch User
                strFileTemp = getPath()
                If strFileTemp = "" Then
                    MsgBox "Das Herunterladen der aktualisierten Datei wurde von Ihnen abgebrochen." + Chr$(13) + Chr$(13) + "Zum nochmaligen |fffd|ffnen des Download-Dialogs schlie|fffd|en Sie bitte zun|fffd|chst diese Datei und |fffd|ffnen Sie diese anschlie|fffd|end erneut.", vbInformation, "Hinweis"
                    Exit Sub
                End If
                'Datei herunterladen
                If Not DownloadFile(strUpdatelinkTemp & strDownloadFile, strFileTemp) Then
                    MsgBox strMsg, vbInformation, "Hinweis"
                Else
                    'Neue Datei gleich |fffd|ffnen
                    If MsgBox("Die Datei wurde erfolgreich heruntergeladen und wie folgt gespeichert:" + Chr$(13) + Chr$(13) + _
                        "" & strFileTemp & "" + Chr$(13) + Chr$(13) + Chr$(13) + "M|fffd|chten Sie die aktuelle Version jetzt |fffd|ffnen?", vbYesNo + vbInformation, "Download erfolgreich") = vbYes Then
                        
                        Dim doc As Word.Document
                        Set doc = Application.ActiveDocument
                        
                        Application.Documents.Open (strFileTemp)
                        doc.Activate
                        doc.Close savechanges:=False  'Schlie|fffd|en der "alten" Datei ohne zu speichern
                    End If
                    
                 End If
            End If
        Else
            MsgBox "Sie k|fffd|nnen die neue Version dieser Datei auch zu einem sp|fffd|teren Zeitpunkt herunterladen." + Chr$(13) + Chr$(13) + "Die Aktualit|fffd|tspr|fffd|fung erfolgt automatisch nach jedem |fffd|ffnen der Datei.", vbInformation, "Hinweis"
        End If
    End If

End Sub

Public Function DownloadFile(UrlFileName As String, DestinationFileName As String) As Boolean

    On Error Resume Next
    DownloadFile = False
    
    DestinationFileName = Trim(DestinationFileName)
    
    If DestinationFileName = vbNullString Then Exit Function
    
    Dim L As Long
    
    L = DeleteUrlCacheEntry(UrlFileName)
    L = URLDownloadToFile(0&, UrlFileName, DestinationFileName, 0&, 0&)
    
    If L = 0 Then DownloadFile = True
    
End Function

Public Function getPath() As String
    
    Dim strAktPath As String
    
    If checkSourceTemp(Application.ActiveDocument.Path) = False Then
        strAktPath = Application.ActiveDocument.Path
    Else
        strAktPath = "C:"
    End If

    getPath = saveFormAs(strAktPath, Application.ActiveDocument.Name)
    
    If getPath = Application.ActiveDocument.FullName Then   'Pfad der aktuell ge|fffd|ffneten Datei
           Dim fso As New FileSystemObject
           Dim strExt As String
        
           strExt = fso.GetExtensionName(Application.ActiveDocument.FullName)
           
           getPath = fso.GetAbsolutePathName(Application.ActiveDocument.Path) & "\" & fso.GetBaseName(Application.ActiveDocument.Name)
           getPath = getPath & " - Neu." & fso.GetExtensionName(Application.ActiveDocument.FullName)
               
           MsgBox "Ein Dokument kann nicht unter dem gleichen Namen wie ein bereits ge|fffd|ffnetes Dokument gespeichert werden." & Chr$(13) & Chr$(13) & _
           "Um die Datei dennoch speichern zu k|fffd|nnen, wird der Dateiname automatisch um den Zusatz  "" - Neu ""  erweitert." & Chr$(13) & Chr$(13) & _
           "Die neue Datei ist anschlie|fffd|end unter dem Dateinamen  """ & fso.GetBaseName(getPath) & """  aufrufbar.", vbInformation, "Datei bereits vorhanden"
            
    End If
  
End Function

Public Function saveFormAs(strPath As String, strFileName As String) As String
    
    Dim fd As FileDialog
    Set fd = Application.FileDialog(msoFileDialogSaveAs)
    
    If Application.Name = "Microsoft Word" Then
        If Application.Version = "11.0" Then
            fd.FilterIndex = 1
        Else
            fd.FilterIndex = 2
        End If
    End If
    
    With fd
        .Title = "Datei speichern unter ..."
        .InitialFileName = strPath
        If Not strFileName = "" Then .InitialFileName = strPath & "\" & strFileName
    End With
            
    If fd.Show = True Then
        saveFormAs = fd.SelectedItems(1)
    Else
        saveFormAs = ""
    End If
       
End Function

Public Function checkSourceTemp(strPath As String) As Boolean

    checkSourceTemp = False
    Dim fso As New FileSystemObject
    
    If fso.FolderExists(strPath) Then
        If Len(strPath) >= 4 Then
            If LCase(Right$(strPath, 3)) = "tmp" Or LCase(Right$(strPath, 4)) = "temp" Then checkSourceTemp = True
        End If
    Else
        checkSourceTemp = True
    End If
    
End Function

Public Function loadTempFile(ByVal strFileName As String) As String
    
    loadTempFile = ""
    
    strUpdatelinkTemp = strUpdatelink
    If Not Right(strUpdatelinkTemp, 1) = "/" Then strUpdatelinkTemp = strUpdatelinkTemp & "/"

    If DownloadFile(strUpdatelinkTemp & strFileName, Environ("TEMP") & "\" & strFileName) Then
        loadTempFile = Environ("TEMP") & "\" & strFileName
    Else
        MsgBox "Wegen eines technischen Problems kann die Vorlagedatei f|fffd|r die Erstellung der ""Weiteren Besonderen Vertragsbedingungen"" nicht heruntergeladen werden." & vbNewLine & _
               "Wir bitten diesen Umstand zu entschuldigen." & vbNewLine & vbNewLine & "Bitte setzen Sie sich |fffd|ber die Vergabestelle mit dem Anwendungssupport in Verbindung.", vbInformation, "Hinweis"
        loadTempFile = ""
    End If
    
End Function

Attribute VB_Name = "WBVB_Bund_Bundeswehr_France"


'WBVBs - Bund - Bundeswehr (BW) + franz|fffd|sische Gaststreitkr|fffd|fte


Sub WBVB_CB_B_BW_Baustellenausweis()

    Call fcWBVB_CB_B_BW_Baustellenausweis
    
End Sub

Function fcWBVB_CB_B_BW_Baustellenausweis(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM113_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM113_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Firmenliste()

    Call fcWBVB_CB_B_BW_Firmenliste
    
End Sub

Function fcWBVB_CB_B_BW_Firmenliste(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM114_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM114_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Wartezeiten()

    Call fcWBVB_CB_B_BW_Wartezeiten
    
End Sub

Function fcWBVB_CB_B_BW_Wartezeiten(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM115_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM115_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_BW_Handyverbot()

    Call fcWBVB_CB_B_BW_Handyverbot
    
End Sub

Function fcWBVB_CB_B_BW_Handyverbot(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM147_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM147_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_BW_Staatenliste()
    Call fcWBVB_CB_B_BW_Staatenliste
End Sub

Function fcWBVB_CB_B_BW_Staatenliste(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM116_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = False
        
        If ActiveDocument.FormFields("TM116_2_CBs").CheckBox.Value = True Then
           ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = False
        Else
           ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
        End If
        
    Else
        ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM116_2_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
                      
    End If
    
    ActiveDocument.Bookmarks("TM116_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Unterk|fffd|nfte()

    Call fcWBVB_CB_B_BW_Unterk|fffd|nfte
    
End Sub

Function fcWBVB_CB_B_BW_Unterk|fffd|nfte(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM117_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM117_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_BW_BehandlPl|fffd|ne()

    Call fcWBVB_CB_B_BW_BehandlPl|fffd|ne
    
End Sub

Function fcWBVB_CB_B_BW_BehandlPl|fffd|ne(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM118_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM118_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_S|fffd|Angeh|fffd|rige()
    Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige
End Sub

Function fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM119_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = False
        
        ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = False
        Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige2(False)
                
        ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = False
        Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige3(False)
                
        ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = False
        Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige4(False)
                
        ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = False
        Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige5(False)
    
    Else
        ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM119_2_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM119_3_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM119_4_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM119_5_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM119_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_S|fffd|Angeh|fffd|rige2()

    Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige2
    
End Sub

Function fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige2(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM119_2_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM119_2_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_S|fffd|Angeh|fffd|rige3()

    Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige3
    
End Sub

Function fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige3(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM119_3_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM119_3_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_S|fffd|Angeh|fffd|rige4()

    Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige4
    
End Sub

Function fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige4(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM119_4_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM119_4_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_BW_S|fffd|Angeh|fffd|rige5()

    Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige5
    
End Sub

Function fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige5(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM119_5_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM119_5_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Anfuhr()

    Call fcWBVB_CB_B_BW_Anfuhr
    
End Sub

Function fcWBVB_CB_B_BW_Anfuhr(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM120_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM120_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Feuergef|fffd|hrl()

    Call fcWBVB_CB_B_BW_Feuergef|fffd|hrl
    
End Sub

Function fcWBVB_CB_B_BW_Feuergef|fffd|hrl(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM121_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM121_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Verkehr()

    Call fcWBVB_CB_B_BW_Verkehr
    
End Sub

Function fcWBVB_CB_B_BW_Verkehr(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM122_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM122_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Foto()

    Call fcWBVB_CB_B_BW_Foto
    
End Sub

Function fcWBVB_CB_B_BW_Foto(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM123_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM123_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Aufenthalt()

    Call fcWBVB_CB_B_BW_Aufenthalt
    
End Sub

Function fcWBVB_CB_B_BW_Aufenthalt(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM124_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM124_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_KasernenBer()

    Call fcWBVB_CB_B_BW_KasernenBer
    
End Sub

Function fcWBVB_CB_B_BW_KasernenBer(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM125_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM125_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Arbeitzeit()

    Call fcWBVB_CB_B_BW_Arbeitszeit
    
End Sub

Function fcWBVB_CB_B_BW_Arbeitszeit(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM126_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM126_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_BW_Pf|fffd|ndung()

    Call fcWBVB_CB_B_BW_Pf|fffd|ndung
    
End Sub

Function fcWBVB_CB_B_BW_Pf|fffd|ndung(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM127_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM127_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Attribute VB_Name = "WBVB_Bund_US"



'WBVBs - Bund - US-Gaststreitkr|fffd|fte


Sub WBVB_CB_B_US_AusschlussL()

    Call fcWBVB_CB_B_US_AusschlussL
    
End Sub
Sub WBVB_CB_B_US_Arbeitszeit()

    Call fcWBVB_CB_B_US_Arbeitszeit
    
End Sub

Function fcWBVB_CB_B_US_Arbeitszeit(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM129_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM129_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Zugang()

    Call fcWBVB_CB_B_US_Zugang
    
End Sub

Function fcWBVB_CB_B_US_Zugang(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM130_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM130_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Wartezeit()

    Call fcWBVB_CB_B_US_Wartezeit
    
End Sub

Sub WBVB_CB_B_US_Anlieferungen()

    Call fcWBVB_CB_B_US_Anlieferungen
    
End Sub

Sub WBVB_CB_B_US_Feuergef|fffd|hrl()

    Call fcWBVB_CB_B_US_Feuergef|fffd|hrl
    
End Sub

Function fcWBVB_CB_B_US_Feuergef|fffd|hrl(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM133_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM133_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Schilder()

    Call fcWBVB_CB_B_US_Schilder
    
End Sub

Sub WBVB_CB_B_US_AbnahmeUnterl()

    Call fcWBVB_CB_B_US_AbnahmeUnterl
    
End Sub

Sub WBVB_CB_B_US_BeschStahl()

    Call fcWBVB_CB_B_US_BeschStahl
    
End Sub

Function fcWBVB_CB_B_US_BeschStahl(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM136_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM136_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Fabrikat()

    Call fcWBVB_CB_B_US_Fabrikat
    
End Sub

Function fcWBVB_CB_B_US_Fabrikat(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM155_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM155_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Baustellenverkehr()

    Call fcWBVB_CB_B_US_Baustellenverkehr
    
End Sub

Function fcWBVB_CB_B_US_Baustellenverkehr(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM156_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM156_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_Helmpflicht()

    Call fcWBVB_CB_B_US_Helmpflicht
    
End Sub

Function fcWBVB_CB_B_US_Helmpflicht(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM157_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM157_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_WasserStrom()

    Call fcWBVB_CB_B_US_WasserStrom
    
End Sub

Function fcWBVB_CB_B_US_WasserStrom(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM134_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM134_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Kommunistisch()

    Call fcWBVB_CB_B_US_Kommunistisch
    
End Sub

Function fcWBVB_CB_B_US_Kommunistisch(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM137_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM137_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Unterkunft()

    Call fcWBVB_CB_B_US_Unterkunft
    
End Sub

Function fcWBVB_CB_B_US_Unterkunft(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM139_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM139_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_BaustEinrPlan()

    Call fcWBVB_CB_B_US_BaustEinrPlan
    
End Sub

Function fcWBVB_CB_B_US_BaustEinrPlan(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM158_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM158_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_Bauleitung()

    Call fcWBVB_CB_B_US_Bauleitung
    
End Sub

Function fcWBVB_CB_B_US_Bauleitung(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM159_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM159_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_Baufristenplan()

    Call fcWBVB_CB_B_US_Baufristenplan
    
End Sub

Function fcWBVB_CB_B_US_Baufristenplan(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM160_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM160_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Unf|fffd|lle()

    Call fcWBVB_CB_B_US_Unf|fffd|lle
    
End Sub

Function fcWBVB_CB_B_US_Unf|fffd|lle(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM162_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM162_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_GrabGen()

    Call fcWBVB_CB_B_US_GrabGen
    
End Sub

Function fcWBVB_CB_B_US_GrabGen(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM163_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM163_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Abschaltungen()

    Call fcWBVB_CB_B_US_Abschaltungen
    
End Sub

Function fcWBVB_CB_B_US_Abschaltungen(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM164_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM164_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_Rauchverbot()

    Call fcWBVB_CB_B_US_Rauchverbot
    
End Sub

Function fcWBVB_CB_B_US_Rauchverbot(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM140_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM140_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_BehandlPl|fffd|ne()

    Call fcWBVB_CB_B_US_BehandlPl|fffd|ne
    
End Sub

Function fcWBVB_CB_B_US_BehandlPl|fffd|ne(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM141_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM141_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_EnglLV()

    Call fcWBVB_CB_B_US_EnglLV
    
End Sub

Function fcWBVB_CB_B_US_EnglLV(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM142_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM142_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_EinwWartung()

    Call fcWBVB_CB_B_US_EinwWartung
    
End Sub

Function fcWBVB_CB_B_US_EinwWartung(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM143_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM143_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Aufmass()

    Call fcWBVB_CB_B_US_Aufmass
    
End Sub

Function fcWBVB_CB_B_US_Aufmass(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM165_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM165_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_US_BenennNU()
    Call fcWBVB_CB_B_US_BenennNU
End Sub

Function fcWBVB_CB_B_US_BenennNU(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM166_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM166_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_PlanStrafe()

    Call fcWBVB_CB_B_US_PlanStrafe
    
End Sub

Function fcWBVB_CB_B_US_PlanStrafe(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM187_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM187_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_Stundenlohn()

    Call fcWBVB_CB_B_US_Stundenlohn
    
End Sub

Function fcWBVB_CB_B_US_Stundenlohn(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM188_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM188_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_FotoGenehm()

    Call fcWBVB_CB_B_US_FotoGenehm
    
End Sub

Function fcWBVB_CB_B_US_FotoGenehm(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM189_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM189_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_AusfuehrungsZeich()

    Call fcWBVB_CB_B_US_AusfuehrungsZeich
    
End Sub

Function fcWBVB_CB_B_US_AusfuehrungsZeich(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM190_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM190_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_AbnahmeBetriebstech()

    Call fcWBVB_CB_B_US_AbnahmeBetriebstech
    
End Sub

Function fcWBVB_CB_B_US_AbnahmeBetriebstech(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM191_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM191_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_BenennNUStr()

    Call fcWBVB_CB_B_US_BenennNUStr
    
End Sub

Function fcWBVB_CB_B_US_BenennNUStr(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM192_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM192_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_US_BedingNU()

    Call fcWBVB_CB_B_US_BedingNU
    
End Sub

Function fcWBVB_CB_B_US_BedingNU(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM193_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM193_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Attribute VB_Name = "WBVB_Land"

'WBVBs - Nur Land


Sub WBVB_CB_Sich_JVA()

    Call fcWBVB_CB_Sich_JVA
    
End Sub

Function fcWBVB_CB_Sich_JVA(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM59_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = True
       
    End If
    
    ActiveDocument.Bookmarks("TM59_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_Sich_Sabotage()

    Call fcWBVB_CB_Sich_Sabotage
    
End Sub

Function fcWBVB_CB_Sich_Sabotage(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM110_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = True
       
    End If
    
    ActiveDocument.Bookmarks("TM110_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_Sich_Polizei()
    Call fcWBVB_CB_Sich_Polizei
End Sub

Function fcWBVB_CB_Sich_Polizei(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM111_CB").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = True
       
    End If
    
    ActiveDocument.Bookmarks("TM111_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function



Attribute VB_Name = "WBVB_Pr|fffd|fen"

Function WBVB_Check(strHerkunft As String) As Boolean
 
        If strHerkunft = "WBVB" Then
        
           mAnzahl = 0
           strFirstField = ""
           strFirstFieldType = ""
           bDoCount = True
           lastFFokName = ""

        End If



       'Pr|fffd|fung: WBVB - Baustellenbesprechungen (allgemein)
        bFehlerTemp = ActiveDocument.Bookmarks("TM100_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM100_1_Termin").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM100_1_Termin"))
       
       'Pr|fffd|fung: WBVB - Baufristenplan (allgemein)
        If ActiveDocument.Bookmarks("TM102_1").Range.Font.Hidden = False Or bReset = True Then
        
           bFehlerTemp = ActiveDocument.FormFields("TM102_1_Werktage").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM102_1_Werktage"))
        
           bFehlerTemp = ActiveDocument.FormFields("TM102_1_AnzFertig").Result = ""
           Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM102_1_AnzFertig"))
                     
        End If

       'Pr|fffd|fung: WBVB - Sicherheits|fffd|berpr|fffd|fung in Justizvollzugsanstalten (Land)
        bFehlerTemp = ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM59_1_Wochen").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM59_1_Wochen"))
          
       'Pr|fffd|fung: WBVB - Sicherheits|fffd|berpr|fffd|fung nach Sabotageschutz (Land)
        bFehlerTemp = ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = False And ActiveDocument.FormFields("TM110_1_Wochen").Result = ""
        Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM110_1_Wochen"))
       
       'Pr|fffd|fung: WBVB - Sicherheits|fffd|berpr|fffd|fung von Firmenangeh|fffd|rigen (Bund-zivil)
        If ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = False Or bReset = True Then

         'Fehlende Eingaben im Textfeld
          bFehlerTemp = ActiveDocument.FormFields("TM148_1_Text1").Result = ""
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_1_Text1"))
         
         'Fehlende Sicherheits|fffd|berpr|fffd|fungsstufe
          bFehlerTemp = ActiveDocument.FormFields("TM148_2_CBs").CheckBox.Value = False And ActiveDocument.FormFields("TM148_3_CBs").CheckBox.Value = False And _
                        ActiveDocument.FormFields("TM148_4_CBs").CheckBox.Value = False And ActiveDocument.FormFields("TM148_5_CBs").CheckBox.Value = False
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_2_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_3_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_4_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_5_CBs"))
         
         'Fehlende Eingaben in den  Textfeldern der |fffd|berpr|fffd|fungsstufe 3
          If ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = False Or bReset = True Then
         
             bFehlerTemp = ActiveDocument.FormFields("TM148_5_1_Text1").Result = ""
             Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_5_1_Text1"))
         
             bFehlerTemp = ActiveDocument.FormFields("TM148_5_1_Text2").Result = ""
             Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM148_5_1_Text2"))
         
          End If
          
        End If
    
       'Pr|fffd|fung: WBVB - Sicherheits|fffd|berpr|fffd|fung von Firmenangeh|fffd|rigen (Bund-Bundeswehr)
        If ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = False Or bReset = True Then
    
         'Fehlende Eingaben in Textfelder
          bFehlerTemp = ActiveDocument.FormFields("TM119_1_Text1").Result = ""
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM119_1_Text1"))
         
         'Fehlende Sicherheits|fffd|berpr|fffd|fungsstufe
          bFehlerTemp = ActiveDocument.FormFields("TM119_2_CBs").CheckBox.Value = False And ActiveDocument.FormFields("TM119_3_CBs").CheckBox.Value = False And _
                        ActiveDocument.FormFields("TM119_4_CBs").CheckBox.Value = False And ActiveDocument.FormFields("TM119_5_CBs").CheckBox.Value = False
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM119_2_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM119_3_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM119_4_CBs"))
          Call Markieren(bFehlerTemp, ActiveDocument.FormFields("TM119_5_CBs"))
    
        End If


   ' Select Case strHerkunft  'MsgBox-Inhalt in Abh|fffd|ngigkeit des Aufrufs
      '  Case Is = "Druck"
      '      strMsg = vbNewLine & vbNewLine & "Ohne diese Festlegung kann die Datenliste nicht gedruckt werden." & vbNewLine & "Bitte erg|fffd|nzen Sie die Datenliste um die fehlende Angabe."
      '  Case Is = "WBVB"
      '      strMsg = vbNewLine & vbNewLine & "Ohne diese Festlegung k|fffd|nnen die WBVB nicht erstellt werden." & vbNewLine & "Bitte erg|fffd|nzen Sie die Datenliste um die fehlende Angabe."
      '  End Select

    If strHerkunft = "WBVB" And Not mAnzahl = 0 Then
       Pruefen.hide

       MsgBox "Es fehlen noch " & mAnzahl & " Pflichtangaben!" & vbNewLine & vbNewLine & _
              "Ohne diese Festlegung k|fffd|nnen die WBVB nicht erstellt werden." & vbNewLine & _
              "Die noch fehlenden Angaben sind im Dokument in der Farbe ""T|fffd|rkis"" markiert." & vbNewLine & vbNewLine & _
              "Bitte erg|fffd|nzen Sie die fehlenden Angaben.", vbInformation, "Vollst|fffd|ndigkeitspr|fffd|fung"
           
       'Erstes Formularfeld mit fehlenden Angaben selektieren
       Call selectFirstField(strFirstField)
       WBVB_Check = False
    Else
       WBVB_Check = True
    End If



End Function
Attribute VB_Name = "WBVB_Steuerung"

'Ausblenden aller WBVBs (WBVBs, welcher f|fffd|r Bund und Land stets relevant sind, werden nicht ausgeblendet!)
Function fcWBVB_alle_ausblenden(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'Ausblenden
                          
     'Allgemein g|fffd|ltig - ausgenommen Zeitvertrag
       'Folgende WBVBs werden durch "fcZeitvertrag" angepasst, welche |fffd|ber "fcLandBund" aufgerufen wird:
          '-Vertragsstrafe
          '-Beginn der Zahlungsfristen
          '-Vorauszahlungen
          '-Baustellenbesprechung
          '-|fffd|bernahme betriebstechn. Anlagen
          '-Baufristenplan
    
       'Vertragsstrafe (generelle Anpassung, wenn kein Zeitvertrag)
        If mZV = False Then
        Call fcCheckbox_Vertragsstrafe(False)
        End If
    
    'Nur Land
    
     ActiveDocument.Bookmarks("TM59").Range.Font.Hidden = True   'Sicherheits|fffd|berpr|fffd|fung JVA
     ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM110").Range.Font.Hidden = True  'Sicherheits|fffd|berpr|fffd|fung Sabotageschutz
     ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM111").Range.Font.Hidden = True  'Zuverl|fffd|ssikeitspr|fffd|fung Polizei
     ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = True
    
    'Nur Bund - Zivil
     ActiveDocument.Bookmarks("TM148").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM150").Range.Font.Hidden = True  'Zutrittsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM151").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM152").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM153").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM154").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM149").Range.Font.Hidden = True  'Zusatz Sicherheits|fffd|berpr|fffd|fung
     ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = True
    
    
    'Nur Bund - Bundeswehr
     ActiveDocument.Bookmarks("TM113").Range.Font.Hidden = True  'Baustellenausweis
     ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM114").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM115").Range.Font.Hidden = True  'Wartezeit
     ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM147").Range.Font.Hidden = True  'Handyverbot
     ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = True
         
     ActiveDocument.Bookmarks("TM116").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM117").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM118").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM119").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM120").Range.Font.Hidden = True  'Anfuhr von Stoffen und Bauteilen
     ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM121").Range.Font.Hidden = True  'Feuergef|fffd|hrliche Arbeiten
     ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM122").Range.Font.Hidden = True  'Verkehrsregelung
     ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM123").Range.Font.Hidden = True  'Fotografierverbot
     ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM124").Range.Font.Hidden = True  'Aufenthaltsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM125").Range.Font.Hidden = True  'Kasernenbereich
     ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM126").Range.Font.Hidden = True  'Arbeitszeiten auf der Baustelle
     ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = True  'Pf|fffd|ndung und Abtretung
     ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
    
    
    'Nur Bund - US-Gaststreitkr|fffd|fte
     ActiveDocument.Bookmarks("TM129").Range.Font.Hidden = True  'Arbeitszeiten
     ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM130").Range.Font.Hidden = True  'Zugangsregelung
     ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM133").Range.Font.Hidden = True  'Genehmigung f|fffd|r Hei|fffd|arbeiten
     ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM136").Range.Font.Hidden = True  'Beschaffung von Stahl
     ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM155").Range.Font.Hidden = True  'Fabrikatsangaben
     ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM156").Range.Font.Hidden = True  'Baustellenverkehr
     ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM157").Range.Font.Hidden = True  'Helmpflicht
     ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM134").Range.Font.Hidden = True  'Bauwasser, Baustrom, Abwasser
     ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM137").Range.Font.Hidden = True  'Materialien/Dienstl. aus kommunisischen Gebieten
     ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM138").Range.Font.Hidden = True  'Zahlungsfristen
     ActiveDocument.Bookmarks("TM138_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM139").Range.Font.Hidden = True  'Unterk|fffd|nfte
     ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM158").Range.Font.Hidden = True  'Baustelleneinrichtungsplan
     ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM159").Range.Font.Hidden = True  'Bauleitung
     ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM160").Range.Font.Hidden = True  'Baufristenplan
     ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM162").Range.Font.Hidden = True  'Unf|fffd|lle
     ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM163").Range.Font.Hidden = True  'Grabgenehmigung
     ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM164").Range.Font.Hidden = True  'Abschaltungen
     ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM140").Range.Font.Hidden = True  'Alkohol- und Rauchverbot
     ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM141").Range.Font.Hidden = True  'Ausf|fffd|hrungs-, Montage- u. Werkstattpl|fffd|ne
     ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM142").Range.Font.Hidden = True  'Englischsprachiges LV
     ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM143").Range.Font.Hidden = True  'Einweisung Betriebs-/Wartungsanweisung
     ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM165").Range.Font.Hidden = True  'Gemeinsames Aufma|fffd|
     ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM166").Range.Font.Hidden = True  'Benennung Nachunternehmen
     ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = True
        
     ActiveDocument.Bookmarks("TM187").Range.Font.Hidden = True  'Bauzeitenplan, Vertragsstrafe
     ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM188").Range.Font.Hidden = True  'Stundenlohn
     ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM189").Range.Font.Hidden = True  'Fotografiergenehmigung
     ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = True
   
     ActiveDocument.Bookmarks("TM190").Range.Font.Hidden = True  '|fffd|bergabe Ausf|fffd|hrungszeichnungen
     ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = True
   
     ActiveDocument.Bookmarks("TM191").Range.Font.Hidden = True  'Abnahme betriebstechnischer Anlagen
     ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = True
   
     ActiveDocument.Bookmarks("TM192").Range.Font.Hidden = True  'Benennung NU Vertragsstrafe
     ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = True
   
     ActiveDocument.Bookmarks("TM193").Range.Font.Hidden = True  'Bedingungen NU
     ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = True
   
     'Vertragsstrafe-US (TM144): Korrektur erfolgt durch generelle Anpassung der Vertragsstrafe am Anfang dieser Funktion
        
If bProtect = True Then Call protectFile(True)

End Function

'WBVBs Land (WBVBs, welcher f|fffd|r Bund und Land stets relevant sind, sind auch immer eingeblendet!)
Function fcWBVB_Land(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'Einblenden

         
    'Allgemein g|fffd|ltig - ausgenommen Zeitvertrag
         'Folgende WBVBs werden durch "fcZeitvertrag" angepasst, welche |fffd|ber "fcLandBund" aufgerufen wird:
          '-Vertragsstrafe
          '-Beginn der Zahlungsfristen
          '-Vorauszahlungen
          '-Baustellenbesprechung
          '-|fffd|bernahme betriebstechn. Anlagen
          '-Baufristenplan

       'Vertragsstrafe (generelle Anpassung, wenn kein Zeitvertrag)
        If mZV = False Then
        Call fcCheckbox_Vertragsstrafe(False)
        End If
    
    'Nur Land
    
     ActiveDocument.Bookmarks("TM59").Range.Font.Hidden = False   'Sicherheits|fffd|berpr|fffd|fung JVA
     Call fcWBVB_CB_Sich_JVA(False)

     ActiveDocument.Bookmarks("TM110").Range.Font.Hidden = False  'Sicherheits|fffd|berpr|fffd|fung Sabotageschutz
     Call fcWBVB_CB_Sich_Sabotage(False)
    
     ActiveDocument.Bookmarks("TM111").Range.Font.Hidden = False  'Zuverl|fffd|ssikeitspr|fffd|fung Polizei
     Call fcWBVB_CB_Sich_Polizei(False)
    
'Ausblenden

    'Nur Bund - Zivil
     ActiveDocument.Bookmarks("TM148").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM150").Range.Font.Hidden = True  'Zutrittsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM151").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM152").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM153").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM154").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM149").Range.Font.Hidden = True  'Zusatz Sicherheits|fffd|berpr|fffd|fung
     ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = True
    
    'Nur Bund - Bundeswehr
     ActiveDocument.Bookmarks("TM113").Range.Font.Hidden = True  'Baustellenausweis
     ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM114").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM115").Range.Font.Hidden = True  'Wartezeit
     ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM147").Range.Font.Hidden = True  'Handyverbot
     ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = True
       
     ActiveDocument.Bookmarks("TM116").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM117").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM118").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM119").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM120").Range.Font.Hidden = True  'Anfuhr von Stoffen und Bauteilen
     ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM121").Range.Font.Hidden = True  'Feuergef|fffd|hrliche Arbeiten
     ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM122").Range.Font.Hidden = True  'Verkehrsregelung
     ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM123").Range.Font.Hidden = True  'Fotografierverbot
     ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM124").Range.Font.Hidden = True  'Aufenthaltsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM125").Range.Font.Hidden = True  'Kasernenbereich
     ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM126").Range.Font.Hidden = True  'Arbeitszeiten auf der Baustelle
     ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = True  'Pf|fffd|ndung und Abtretung
     ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
    
    
    'Nur Bund - US-Gaststreitkr|fffd|fte
     ActiveDocument.Bookmarks("TM129").Range.Font.Hidden = True  'Arbeitszeiten
     ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM130").Range.Font.Hidden = True  'Zugangsregelung
     ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM133").Range.Font.Hidden = True  'Genehmigung f|fffd|r Hei|fffd|arbeiten
     ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM136").Range.Font.Hidden = True  'Beschaffung von Stahl
     ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM155").Range.Font.Hidden = True  'Fabrikatsangaben
     ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM156").Range.Font.Hidden = True  'Baustellenverkehr
     ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM157").Range.Font.Hidden = True  'Helmpflicht
     ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM134").Range.Font.Hidden = True  'Bauwasser, Baustrom, Abwasser
     ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM137").Range.Font.Hidden = True  'Materialien/Dienstl. aus kommunisischen Gebieten
     ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM138").Range.Font.Hidden = True  'Zahlungsfristen
     ActiveDocument.Bookmarks("TM138_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM139").Range.Font.Hidden = True  'Unterk|fffd|nfte
     ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM158").Range.Font.Hidden = True  'Baustelleneinrichtungsplan
     ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM159").Range.Font.Hidden = True  'Bauleitung
     ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM160").Range.Font.Hidden = True  'Baufristenplan
     ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM162").Range.Font.Hidden = True  'Unf|fffd|lle
     ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM163").Range.Font.Hidden = True  'Grabgenehmigung
     ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM164").Range.Font.Hidden = True  'Abschaltungen
     ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM140").Range.Font.Hidden = True  'Alkohol- und Rauchverbot
     ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM141").Range.Font.Hidden = True  'Ausf|fffd|hrungs-, Montage- u. Werkstattpl|fffd|ne
     ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM142").Range.Font.Hidden = True  'Englischsprachiges LV
     ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM143").Range.Font.Hidden = True  'Einweisung Betriebs-/Wartungsanweisung
     ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM165").Range.Font.Hidden = True  'Gemeinsames Aufma|fffd|
     ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM166").Range.Font.Hidden = True  'Benennung Nachunternehmen
     ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM187").Range.Font.Hidden = True  'Bauzeitenplan, Vertragsstrafe
     ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM188").Range.Font.Hidden = True  'Stundenlohn
     ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM189").Range.Font.Hidden = True  'Fotografiergenehmigung
     ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM190").Range.Font.Hidden = True  '|fffd|bergabe Ausf|fffd|hrungszeichnungen
     ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM191").Range.Font.Hidden = True  'Abnahme betriebstechnischer Anlagen
     ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM192").Range.Font.Hidden = True  'Benennung NU Vertragsstrafe
     ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = True

     ActiveDocument.Bookmarks("TM193").Range.Font.Hidden = True  'Bedingungen NU
     ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = True

     'Vertragsstrafe-US (TM144): Korrektur erfolgt durch generelle Anpassung der Vertragsstrafe am Anfang dieser Funktion
        
If bProtect = True Then Call protectFile(True)

End Function

'WBVBs Bund Zivil (WBVBs, welcher f|fffd|r Bund und Land stets relevant sind, sind auch immer eingeblendet!)
Function fcWBVB_Bund_Zivil(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'Einblenden

         
    'Allgemein g|fffd|ltig - ausgenommen Zeitvertrag
         'Folgende WBVBs werden durch "fcZeitvertrag" angepasst, welche |fffd|ber "fcLandBund" aufgerufen wird:
          '-Vertragsstrafe
          '-Beginn der Zahlungsfristen
          '-Vorauszahlungen
          '-Baustellenbesprechung
          '-|fffd|bernahme betriebstechn. Anlagen
          '-Baufristenplan

       'Vertragsstrafe (generelle Anpassung, wenn kein Zeitvertrag)
        If mZV = False Then
        Call fcCheckbox_Vertragsstrafe(False)
        End If


'Ausblenden
        
    'Nur Land
     
     ActiveDocument.Bookmarks("TM59").Range.Font.Hidden = True   'Sicherheits|fffd|berpr|fffd|fung JVA
     ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM110").Range.Font.Hidden = True  'Sicherheits|fffd|berpr|fffd|fung Sabotageschutz
     ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM111").Range.Font.Hidden = True  'Zuverl|fffd|ssikeitspr|fffd|fung Polizei
     ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = True
    
'Einblenden
    'Nur Bund - Zivil
     ActiveDocument.Bookmarks("TM148").Range.Font.Hidden = False  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige(False)
     
     ActiveDocument.Bookmarks("TM150").Range.Font.Hidden = False  'Zutrittsbeschr|fffd|nkung
     Call fcWBVB_CB_B_Z_Zutritt(False)
     
     ActiveDocument.Bookmarks("TM151").Range.Font.Hidden = False  'Einrichtung von Unterk|fffd|nften
     Call fcWBVB_CB_B_Z_Unterk|fffd|nfte(False)
     
     ActiveDocument.Bookmarks("TM152").Range.Font.Hidden = False  'Behandlungn von Pl|fffd|nen
     Call fcWBVB_CB_B_Z_BehandlPl|fffd|ne(False)
     
     ActiveDocument.Bookmarks("TM153").Range.Font.Hidden = False  'Firmenliste
     Call fcWBVB_CB_B_Z_Firmenliste(False)
     
     ActiveDocument.Bookmarks("TM154").Range.Font.Hidden = False  'Staatenliste
     Call fcWBVB_CB_B_Z_Staatenliste(False)
     
     ActiveDocument.Bookmarks("TM149").Range.Font.Hidden = False  'Zusatz zur Sicherheits|fffd|berpr|fffd|fung
     Call fcWBVB_CB_B_Z_SichZusatz(False)
     
          
'Ausblenden
    'Nur Bund - Bundeswehr
     ActiveDocument.Bookmarks("TM113").Range.Font.Hidden = True  'Baustellenausweis
     ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM114").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM115").Range.Font.Hidden = True  'Wartezeit
     ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM147").Range.Font.Hidden = True  'Handyverbot
     ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = True
        
     ActiveDocument.Bookmarks("TM116").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM117").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM118").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM119").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM120").Range.Font.Hidden = True  'Anfuhr von Stoffen und Bauteilen
     ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM121").Range.Font.Hidden = True  'Feuergef|fffd|hrliche Arbeiten
     ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM122").Range.Font.Hidden = True  'Verkehrsregelung
     ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM123").Range.Font.Hidden = True  'Fotografierverbot
     ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM124").Range.Font.Hidden = True  'Aufenthaltsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM125").Range.Font.Hidden = True  'Kasernenbereich
     ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM126").Range.Font.Hidden = True  'Arbeitszeiten auf der Baustelle
     ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = True  'Pf|fffd|ndung und Abtretung
     ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
    
    
    'Nur Bund - US-Gaststreitkr|fffd|fte
     ActiveDocument.Bookmarks("TM129").Range.Font.Hidden = True  'Arbeitszeiten
     ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM130").Range.Font.Hidden = True  'Zugangsregelung
     ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM133").Range.Font.Hidden = True  'Genehmigung f|fffd|r Hei|fffd|arbeiten
     ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM136").Range.Font.Hidden = True  'Beschaffung von Stahl
     ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM155").Range.Font.Hidden = True  'Fabrikatsangaben
     ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM156").Range.Font.Hidden = True  'Baustellenverkehr
     ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM157").Range.Font.Hidden = True  'Helmpflicht
     ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM134").Range.Font.Hidden = True  'Bauwasser, Baustrom, Abwasser
     ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM137").Range.Font.Hidden = True  'Materialien/Dienstl. aus kommunisischen Gebieten
     ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM138").Range.Font.Hidden = True  'Zahlungsfristen
     ActiveDocument.Bookmarks("TM138_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM139").Range.Font.Hidden = True  'Unterk|fffd|nfte
     ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM158").Range.Font.Hidden = True  'Baustelleneinrichtungsplan
     ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM159").Range.Font.Hidden = True  'Bauleitung
     ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM160").Range.Font.Hidden = True  'Baufristenplan
     ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM162").Range.Font.Hidden = True  'Unf|fffd|lle
     ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM163").Range.Font.Hidden = True  'Grabgenehmigung
     ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM164").Range.Font.Hidden = True  'Abschaltungen
     ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM140").Range.Font.Hidden = True  'Alkohol- und Rauchverbot
     ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM141").Range.Font.Hidden = True  'Ausf|fffd|hrungs-, Montage- u. Werkstattpl|fffd|ne
     ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM142").Range.Font.Hidden = True  'Englischsprachiges LV
     ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM143").Range.Font.Hidden = True  'Einweisung Betriebs-/Wartungsanweisung
     ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM165").Range.Font.Hidden = True  'Gemeinsames Aufma|fffd|
     ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM166").Range.Font.Hidden = True  'Benennung Nachunternehmen
     ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM187").Range.Font.Hidden = True  'Bauzeitenplan, Vertragsstrafe
     ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM188").Range.Font.Hidden = True  'Stundenlohn
     ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM189").Range.Font.Hidden = True  'Fotografiergenehmigung
     ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM190").Range.Font.Hidden = True  '|fffd|bergabe Ausf|fffd|hrungszeichnungen
     ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM191").Range.Font.Hidden = True  'Abnahme betriebstechnischer Anlagen
     ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM192").Range.Font.Hidden = True  'Benennung NU Vertragsstrafe
     ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM193").Range.Font.Hidden = True  'Bedingungen NU
     ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = True
    
     'Vertragsstrafe-US (TM144): Korrektur erfolgt durch generelle Anpassung der Vertragsstrafe am Anfang dieser Funktion
    
If bProtect = True Then Call protectFile(True)

End Function

'WBVBs Bund Bundeswehr + franz|fffd|sische Gaststreitkr|fffd|fte (WBVBs, welcher f|fffd|r Bund und Land stets relevant sind, sind auch immer eingeblendet!)


'Hinweis: Der Textbaustein "Pf|fffd|ndung und Abtretung" gilt nur f|fffd|r die Bundeswehr, nicht f|fffd|r die franz|fffd|sischen Gaststreitkr|fffd|fte
'         Das Aus-/Einblenden dieses Textbausteins erfolgt |fffd|ber diese Function.


Function fcWBVB_Bund_Bundeswehr(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'Einblenden

         
    'Allgemein g|fffd|ltig - ausgenommen Zeitvertrag
         'Folgende WBVBs werden durch "fcZeitvertrag" angepasst, welche |fffd|ber "fcLandBund" aufgerufen wird:
          '-Vertragsstrafe
          '-Beginn der Zahlungsfristen
          '-Vorauszahlungen
          '-Baustellenbesprechung
          '-|fffd|bernahme betriebstechn. Anlagen
          '-Baufristenplan
       
       'Vertragsstrafe (generelle Anpassung, wenn kein Zeitvertrag)
        If mZV = False Then
        Call fcCheckbox_Vertragsstrafe(False)
        End If

'Ausblenden
        
    'Nur Land
     
     ActiveDocument.Bookmarks("TM59").Range.Font.Hidden = True   'Sicherheits|fffd|berpr|fffd|fung JVA
     ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM110").Range.Font.Hidden = True  'Sicherheits|fffd|berpr|fffd|fung Sabotageschutz
     ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM111").Range.Font.Hidden = True  'Zuverl|fffd|ssikeitspr|fffd|fung Polizei
     ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = True
    
    'Nur Bund - Zivil
     ActiveDocument.Bookmarks("TM148").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM150").Range.Font.Hidden = True  'Zutrittsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM151").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM152").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM153").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM154").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM149").Range.Font.Hidden = True  'Zusatz Sicherheits|fffd|berpr|fffd|fung
     ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = True
    
'Einblenden
    
    'Nur Bund - Bundeswehr
     ActiveDocument.Bookmarks("TM113").Range.Font.Hidden = False  'Baustellenausweis
     Call fcWBVB_CB_B_BW_Baustellenausweis(False)
    
     ActiveDocument.Bookmarks("TM114").Range.Font.Hidden = False  'Firmenliste
     Call fcWBVB_CB_B_BW_Firmenliste(False)
    
     ActiveDocument.Bookmarks("TM115").Range.Font.Hidden = False  'Wartezeit
     Call fcWBVB_CB_B_BW_Wartezeiten(False)
    
     ActiveDocument.Bookmarks("TM147").Range.Font.Hidden = False  'Handyverbot
     Call fcWBVB_CB_B_BW_Handyverbot(False)
    
     ActiveDocument.Bookmarks("TM116").Range.Font.Hidden = False  'Staatenliste
     Call fcWBVB_CB_B_BW_Staatenliste(False)
    
     ActiveDocument.Bookmarks("TM117").Range.Font.Hidden = False  'Einrichtung von Unterk|fffd|nften
     Call fcWBVB_CB_B_BW_Unterk|fffd|nfte(False)
    
     ActiveDocument.Bookmarks("TM118").Range.Font.Hidden = False  'Behandlung von Pl|fffd|nen
     Call fcWBVB_CB_B_BW_BehandlPl|fffd|ne(False)
    
     ActiveDocument.Bookmarks("TM119").Range.Font.Hidden = False  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     Call fcWBVB_CB_B_BW_S|fffd|Angeh|fffd|rige(False)
    
     ActiveDocument.Bookmarks("TM120").Range.Font.Hidden = False  'Anfuhr von Stoffen und Bauteilen
     Call fcWBVB_CB_B_BW_Anfuhr(False)
    
     ActiveDocument.Bookmarks("TM121").Range.Font.Hidden = False  'Feuergef|fffd|hrliche Arbeiten
     Call fcWBVB_CB_B_BW_Feuergef|fffd|hrl(False)
    
     ActiveDocument.Bookmarks("TM122").Range.Font.Hidden = False  'Verkehrsregelung
     Call fcWBVB_CB_B_BW_Verkehr(False)
    
     ActiveDocument.Bookmarks("TM123").Range.Font.Hidden = False  'Fotografierverbot
     Call fcWBVB_CB_B_BW_Foto(False)
    
     ActiveDocument.Bookmarks("TM124").Range.Font.Hidden = False  'Aufenthaltsbeschr|fffd|nkung
     Call fcWBVB_CB_B_BW_Aufenthalt(False)
    
     ActiveDocument.Bookmarks("TM125").Range.Font.Hidden = False  'Kasernenbereich
     Call fcWBVB_CB_B_BW_KasernenBer(False)
    
     ActiveDocument.Bookmarks("TM126").Range.Font.Hidden = False  'Arbeitszeiten auf der Baustelle
     Call fcWBVB_CB_B_BW_Arbeitszeit(False)
    
    'Sondersituation: "Pf|fffd|ndung + Abtretung" nicht bei franz|fffd|sischen Gaststreitkr|fffd|ften
     Select Case mNutzer_B
            
     Case 3  'dritter Eintrag "Bundeswehr"
          ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = False  'Pf|fffd|ndung und Abtretung
          Call fcWBVB_CB_B_BW_Pf|fffd|ndung(False)
                                               
     Case 5  'f|fffd|nfter Eintrag "franz|fffd|sische Gaststreitkr|fffd|fte"
          ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = True
          ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
                                                                                                                                                                                           
    End Select
    
    
    
'Ausblenden

    'Nur Bund - US-Gaststreitkr|fffd|fte
     ActiveDocument.Bookmarks("TM129").Range.Font.Hidden = True  'Arbeitszeiten
     ActiveDocument.Bookmarks("TM129_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM130").Range.Font.Hidden = True  'Zugangsregelung
     ActiveDocument.Bookmarks("TM130_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM133").Range.Font.Hidden = True  'Genehmigung f|fffd|r Hei|fffd|arbeiten
     ActiveDocument.Bookmarks("TM133_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM136").Range.Font.Hidden = True  'Beschaffung von Stahl
     ActiveDocument.Bookmarks("TM136_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM155").Range.Font.Hidden = True  'Fabrikatsangaben
     ActiveDocument.Bookmarks("TM155_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM156").Range.Font.Hidden = True  'Baustellenverkehr
     ActiveDocument.Bookmarks("TM156_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM157").Range.Font.Hidden = True  'Helmpflicht
     ActiveDocument.Bookmarks("TM157_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM134").Range.Font.Hidden = True  'Bauwasser, Baustrom, Abwasser
     ActiveDocument.Bookmarks("TM134_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM137").Range.Font.Hidden = True  'Materialien/Dienstl. aus kommunisischen Gebieten
     ActiveDocument.Bookmarks("TM137_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM138").Range.Font.Hidden = True  'Zahlungsfristen
     ActiveDocument.Bookmarks("TM138_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM139").Range.Font.Hidden = True  'Unterk|fffd|nfte
     ActiveDocument.Bookmarks("TM139_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM158").Range.Font.Hidden = True  'Baustelleneinrichtungsplan
     ActiveDocument.Bookmarks("TM158_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM159").Range.Font.Hidden = True  'Bauleitung
     ActiveDocument.Bookmarks("TM159_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM160").Range.Font.Hidden = True  'Baufristenplan
     ActiveDocument.Bookmarks("TM160_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM162").Range.Font.Hidden = True  'Unf|fffd|lle
     ActiveDocument.Bookmarks("TM162_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM163").Range.Font.Hidden = True  'Grabgenehmigung
     ActiveDocument.Bookmarks("TM163_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM164").Range.Font.Hidden = True  'Abschaltungen
     ActiveDocument.Bookmarks("TM164_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM140").Range.Font.Hidden = True  'Alkohol- und Rauchverbot
     ActiveDocument.Bookmarks("TM140_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM141").Range.Font.Hidden = True  'Ausf|fffd|hrungs-, Montage- u. Werkstattpl|fffd|ne
     ActiveDocument.Bookmarks("TM141_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM142").Range.Font.Hidden = True  'Englischsprachiges LV
     ActiveDocument.Bookmarks("TM142_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM143").Range.Font.Hidden = True  'Einweisung Betriebs-/Wartungsanweisung
     ActiveDocument.Bookmarks("TM143_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM165").Range.Font.Hidden = True  'Gemeinsames Aufma|fffd|
     ActiveDocument.Bookmarks("TM165_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM166").Range.Font.Hidden = True  'Benennung Nachunternehmen
     ActiveDocument.Bookmarks("TM166_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM187").Range.Font.Hidden = True  'Bauzeitenplan, Vertragsstrafe
     ActiveDocument.Bookmarks("TM187_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM188").Range.Font.Hidden = True  'Stundenlohn
     ActiveDocument.Bookmarks("TM188_1").Range.Font.Hidden = True
     
     ActiveDocument.Bookmarks("TM189").Range.Font.Hidden = True  'Fotografiergenehmigung
     ActiveDocument.Bookmarks("TM189_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM190").Range.Font.Hidden = True  '|fffd|bergabe Ausf|fffd|hrungszeichnungen
     ActiveDocument.Bookmarks("TM190_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM191").Range.Font.Hidden = True  'Abnahme betriebstechnischer Anlagen
     ActiveDocument.Bookmarks("TM191_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM192").Range.Font.Hidden = True  'Benennung NU Vertragsstrafe
     ActiveDocument.Bookmarks("TM192_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM193").Range.Font.Hidden = True  'Bedingungen NU
     ActiveDocument.Bookmarks("TM193_1").Range.Font.Hidden = True
    
     'Vertragsstrafe-US (TM144): Korrektur erfolgt durch generelle Anpassung der Vertragsstrafe am Anfang dieser Funktion
        
If bProtect = True Then Call protectFile(True)

End Function


'WBVBs Bund US-Gaststreitkr|fffd|fte (WBVBs, welcher f|fffd|r Bund und Land stets relevant sind, sind auch immer eingeblendet!)
Function fcWBVB_Bund_US(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

'Einblenden
         
    'Allgemein g|fffd|ltig - ausgenommen Zeitvertrag
         'Folgende WBVBs werden durch "fcZeitvertrag" angepasst, welche |fffd|ber "fcLandBund" aufgerufen wird:
          '-Vertragsstrafe
          '-Beginn der Zahlungsfristen
          '-Vorauszahlungen
          '-Baustellenbesprechung
          '-|fffd|bernahme betriebstechn. Anlagen
          '-Baufristenplan
       
       'Vertragsstrafe (generelle Anpassung, wenn kein Zeitvertrag)
        If mZV = False Then
        Call fcCheckbox_Vertragsstrafe(False)
        End If

'Ausblenden
        
    'Nur Land
     
     ActiveDocument.Bookmarks("TM59").Range.Font.Hidden = True   'Sicherheits|fffd|berpr|fffd|fung JVA
     ActiveDocument.Bookmarks("TM59_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM110").Range.Font.Hidden = True  'Sicherheits|fffd|berpr|fffd|fung Sabotageschutz
     ActiveDocument.Bookmarks("TM110_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM111").Range.Font.Hidden = True  'Zuverl|fffd|ssikeitspr|fffd|fung Polizei
     ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = True
    
    'Nur Bund - Zivil
     ActiveDocument.Bookmarks("TM148").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM150").Range.Font.Hidden = True  'Zutrittsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM151").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM152").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM153").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM154").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM149").Range.Font.Hidden = True  'Zusatz Sicherheits|fffd|berpr|fffd|fung
     ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = True
          
    'Nur Bund - Bundeswehr
     ActiveDocument.Bookmarks("TM113").Range.Font.Hidden = True  'Baustellenausweis
     ActiveDocument.Bookmarks("TM113_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM114").Range.Font.Hidden = True  'Firmenliste
     ActiveDocument.Bookmarks("TM114_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM115").Range.Font.Hidden = True  'Wartezeit
     ActiveDocument.Bookmarks("TM115_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM147").Range.Font.Hidden = True  'Handyverbot
     ActiveDocument.Bookmarks("TM147_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM116").Range.Font.Hidden = True  'Staatenliste
     ActiveDocument.Bookmarks("TM116_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM116_2_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM117").Range.Font.Hidden = True  'Einrichtung von Unterk|fffd|nften
     ActiveDocument.Bookmarks("TM117_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM118").Range.Font.Hidden = True  'Behandlung von Pl|fffd|nen
     ActiveDocument.Bookmarks("TM118_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM119").Range.Font.Hidden = True  'Sicherheitspr|fffd|fung Firmenangeh|fffd|rige
     ActiveDocument.Bookmarks("TM119_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_2_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_3_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_4_1").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5").Range.Font.Hidden = True
     ActiveDocument.Bookmarks("TM119_5_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM120").Range.Font.Hidden = True  'Anfuhr von Stoffen und Bauteilen
     ActiveDocument.Bookmarks("TM120_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM121").Range.Font.Hidden = True  'Feuergef|fffd|hrliche Arbeiten
     ActiveDocument.Bookmarks("TM121_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM122").Range.Font.Hidden = True  'Verkehrsregelung
     ActiveDocument.Bookmarks("TM122_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM123").Range.Font.Hidden = True  'Fotografierverbot
     ActiveDocument.Bookmarks("TM123_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM124").Range.Font.Hidden = True  'Aufenthaltsbeschr|fffd|nkung
     ActiveDocument.Bookmarks("TM124_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM125").Range.Font.Hidden = True  'Kasernenbereich
     ActiveDocument.Bookmarks("TM125_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM126").Range.Font.Hidden = True  'Arbeitszeiten auf der Baustelle
     ActiveDocument.Bookmarks("TM126_1").Range.Font.Hidden = True
    
     ActiveDocument.Bookmarks("TM127").Range.Font.Hidden = True  'Pf|fffd|ndung und Abtretung
     ActiveDocument.Bookmarks("TM127_1").Range.Font.Hidden = True
    
'Einblenden

    'Nur Bund - US-Gaststreitkr|fffd|fte
     ActiveDocument.Bookmarks("TM129").Range.Font.Hidden = False  'Arbeitszeiten
     Call fcWBVB_CB_B_US_Arbeitszeit(False)
    
     ActiveDocument.Bookmarks("TM130").Range.Font.Hidden = False  'Zugangsregelung
     Call fcWBVB_CB_B_US_Zugang(False)
    
     ActiveDocument.Bookmarks("TM133").Range.Font.Hidden = False  'Genehmigung f|fffd|r Hei|fffd|arbeiten
     Call fcWBVB_CB_B_US_Feuergef|fffd|hrl(False)
    
     ActiveDocument.Bookmarks("TM136").Range.Font.Hidden = False  'Beschaffung von Stahl
     Call fcWBVB_CB_B_US_BeschStahl(False)
     
     ActiveDocument.Bookmarks("TM155").Range.Font.Hidden = False  'Fabrikatsangaben
     Call fcWBVB_CB_B_US_Fabrikat(False)
        
     ActiveDocument.Bookmarks("TM156").Range.Font.Hidden = False  'Baustellenverkehr
     Call fcWBVB_CB_B_US_Baustellenverkehr(False)
        
     ActiveDocument.Bookmarks("TM157").Range.Font.Hidden = False  'Helmpflicht
     Call fcWBVB_CB_B_US_Helmpflicht(False)
                
     ActiveDocument.Bookmarks("TM134").Range.Font.Hidden = False  'Bauwasser, Baustrom, Abwasser
     Call fcWBVB_CB_B_US_WasserStrom(False)
                
     ActiveDocument.Bookmarks("TM137").Range.Font.Hidden = False  'Materialien/Dienstl. aus kommunisischen Gebieten
     Call fcWBVB_CB_B_US_Kommunistisch(False)
    
     ActiveDocument.Bookmarks("TM138").Range.Font.Hidden = False  'Zahlungsfristen
     ActiveDocument.Bookmarks("TM138_1").Range.Font.Hidden = False
    
     ActiveDocument.Bookmarks("TM139").Range.Font.Hidden = False  'Unterk|fffd|nfte
     Call fcWBVB_CB_B_US_Unterkunft(False)
    
     ActiveDocument.Bookmarks("TM158").Range.Font.Hidden = False  'Baustelleneinrichtungsplan
     Call fcWBVB_CB_B_US_BaustEinrPlan(False)
     
     ActiveDocument.Bookmarks("TM159").Range.Font.Hidden = False  'Bauleitung
     Call fcWBVB_CB_B_US_Bauleitung(False)
     
     ActiveDocument.Bookmarks("TM160").Range.Font.Hidden = False  'Baufristenplan
     Call fcWBVB_CB_B_US_Baufristenplan(False)
     
     ActiveDocument.Bookmarks("TM162").Range.Font.Hidden = False  'Unf|fffd|lle
     Call fcWBVB_CB_B_US_Unf|fffd|lle(False)
     
     ActiveDocument.Bookmarks("TM163").Range.Font.Hidden = False  'Grabgenehmigung
     Call fcWBVB_CB_B_US_GrabGen(False)
     
     ActiveDocument.Bookmarks("TM164").Range.Font.Hidden = False  'Abschaltungen
     Call fcWBVB_CB_B_US_Abschaltungen(False)
    
     ActiveDocument.Bookmarks("TM140").Range.Font.Hidden = False  'Alkohol- und Rauchverbot
     Call fcWBVB_CB_B_US_Rauchverbot(False)
    
     ActiveDocument.Bookmarks("TM141").Range.Font.Hidden = False  'Ausf|fffd|hrungs-, Montage- u. Werkstattpl|fffd|ne
     Call fcWBVB_CB_B_US_BehandlPl|fffd|ne(False)
    
     ActiveDocument.Bookmarks("TM142").Range.Font.Hidden = False  'Englischsprachiges LV
     Call fcWBVB_CB_B_US_EnglLV(False)
    
     ActiveDocument.Bookmarks("TM143").Range.Font.Hidden = False  'Einweisung Betriebs-/Wartungsanweisung
     Call fcWBVB_CB_B_US_EinwWartung(False)
     
     ActiveDocument.Bookmarks("TM165").Range.Font.Hidden = False  'Gemeinsames Aufma|fffd|
     Call fcWBVB_CB_B_US_Aufmass(False)
     
     ActiveDocument.Bookmarks("TM166").Range.Font.Hidden = False  'Benennung Nachunternehmen
     Call fcWBVB_CB_B_US_BenennNU(False)
    
     ActiveDocument.Bookmarks("TM187").Range.Font.Hidden = False  'Bauzeitenplan Vertragsstrafe
     Call fcWBVB_CB_B_US_PlanStrafe(False)
     
     ActiveDocument.Bookmarks("TM188").Range.Font.Hidden = False  'Stundenlohn
     Call fcWBVB_CB_B_US_Stundenlohn(False)
     
     ActiveDocument.Bookmarks("TM189").Range.Font.Hidden = False  'Fotografiergenehmigung
     Call fcWBVB_CB_B_US_FotoGenehm(False)
    
     ActiveDocument.Bookmarks("TM190").Range.Font.Hidden = False  '|fffd|bergabe Ausf|fffd|hrungszeichnungen
     Call fcWBVB_CB_B_US_AusfuehrungsZeich(False)
    
     ActiveDocument.Bookmarks("TM191").Range.Font.Hidden = False  'Abnahme betriebstechnischer Anlagen
     Call fcWBVB_CB_B_US_AbnahmeBetriebstech(False)
    
     ActiveDocument.Bookmarks("TM192").Range.Font.Hidden = False  'Benennung NU Vertragsstrafe
     Call fcWBVB_CB_B_US_BenennNUStr(False)
    
     ActiveDocument.Bookmarks("TM193").Range.Font.Hidden = False  'Bedingungen NU
     Call fcWBVB_CB_B_US_BedingNU(False)
    
     'Vertragsstrafe-US (TM144): Korrektur erfolgt durch generelle Anpassung der Vertragsstrafe am Anfang dieser Funktion

If bProtect = True Then Call protectFile(True)

End Function


Attribute VB_Name = "WBVB_Zivil"


'WBVBs - Bund - Zivil


Sub WBVB_CB_B_Z_S|fffd|Angeh|fffd|rige()
    Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige
End Sub

Function fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM148_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = False
        
        ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = False
        Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige2(False)
                
        ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = False
        Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige3(False)
                
        ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = False
        Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige4(False)
                
        ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = False
        Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige5(False)
    
    Else
        ActiveDocument.Bookmarks("TM148_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM148_2").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM148_2_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM148_3").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM148_3_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM148_4").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM148_4_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM148_5").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM148_5_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM148_CB_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_Z_S|fffd|Angeh|fffd|rige2()
    Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige2
End Sub

Function fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige2(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM148_2_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM148_2_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM148_2_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_Z_S|fffd|Angeh|fffd|rige3()
    Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige3
End Sub

Function fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige3(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM148_3_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM148_3_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM148_3_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_B_Z_S|fffd|Angeh|fffd|rige4()
    Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige4
End Sub

Function fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige4(Optional bProtect As Boolean = True)     '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM148_4_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM148_4_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM148_4_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_S|fffd|Angeh|fffd|rige5()
    Call fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige5
End Sub

Function fcWBVB_CB_B_Z_S|fffd|Angeh|fffd|rige5(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM148_5_CBs").CheckBox.Value = True Then
       ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM148_5_1").Range.Font.Hidden = True
    End If
    ActiveDocument.Bookmarks("TM148_5_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_Zutritt()

    Call fcWBVB_CB_B_Z_Zutritt
    
End Sub

Function fcWBVB_CB_B_Z_Zutritt(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM150_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM150_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM150_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_Unterk|fffd|nfte()

    Call fcWBVB_CB_B_Z_Unterk|fffd|nfte
    
End Sub

Function fcWBVB_CB_B_Z_Unterk|fffd|nfte(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM151_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM151_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM151_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_BehandlPl|fffd|ne()

    Call fcWBVB_CB_B_Z_BehandlPl|fffd|ne
    
End Sub

Function fcWBVB_CB_B_Z_BehandlPl|fffd|ne(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM152_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM152_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM152_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_Firmenliste()

    Call fcWBVB_CB_B_Z_Firmenliste
    
End Sub

Function fcWBVB_CB_B_Z_Firmenliste(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM153_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM153_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM153_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_Staatenliste()
    Call fcWBVB_CB_B_Z_Staatenliste
End Sub

Function fcWBVB_CB_B_Z_Staatenliste(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM154_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = False
        
        If ActiveDocument.FormFields("TM154_2_CBs").CheckBox.Value = True Then
           ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = False
        Else
           ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
        End If
        
    Else
        ActiveDocument.Bookmarks("TM154_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM154_2").Range.Font.Hidden = True
        ActiveDocument.FormFields("TM154_2_CBs").CheckBox.Value = False
        ActiveDocument.Bookmarks("TM154_2_1").Range.Font.Hidden = True
                      
    End If
    
    ActiveDocument.Bookmarks("TM154_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_B_Z_SichZusatz()

    Call fcWBVB_CB_B_Z_SichZusatz
    
End Sub

Function fcWBVB_CB_B_Z_SichZusatz(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM149_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM149_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM149_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function
Attribute VB_Name = "WBVB_allgemein"

Sub PlanTeam()
    Call fcPlanTeam
End Sub

Function fcPlanTeam(Optional bProtect As Boolean = True)

    Call protectFile(False)
       
    Select Case ActiveDocument.FormFields("PTS_DD").DropDown.Value
    
        Case 1, 2      '"bitte ausw|fffd|hlen..." + "nein"
            ActiveDocument.Bookmarks("TM183_Gesamt").Range.Font.Hidden = True

        Case 3         '"ja"
            ActiveDocument.Bookmarks("TM183_Gesamt").Range.Font.Hidden = False
    
    End Select
       
    ActiveDocument.Bookmarks("PTS_DD_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function





'WBVBs - allgemein g|fffd|ltig (Land + Bund) - auch f|fffd|r Zeitvertrag


Sub WBVB_CB_Wasser()

    Call fcWBVB_CB_Wasser
    
End Sub

Function fcWBVB_CB_Wasser(Optional bProtect As Boolean = True)      '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM39_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM39_2").Range.Font.Hidden = False
    Else
        ActiveDocument.Bookmarks("TM39_2").Range.Font.Hidden = True
    End If

    ActiveDocument.Bookmarks("TM39_Dummy").Select
    
    If bProtect = True Then Call protectFile(True)

End Function



'WBVBs - allgemein g|fffd|ltig (Land + Bund) - ausgenommen Zeitvertrag


Sub WBVB_BeginnZahlungsfrist()
    Call fcWBVB_BeginnZahlungsfrist
End Sub

Function fcWBVB_BeginnZahlungsfrist(Optional bProtect As Boolean = True)        '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If mZV = False Then  'kein Zeitvertrag
       ActiveDocument.Bookmarks("TM173_Gesamt").Range.Font.Hidden = False
    Else
       ActiveDocument.Bookmarks("TM173_Gesamt").Range.Font.Hidden = True
    End If

    If bProtect = True Then Call protectFile(True)

End Function


Sub WBVB_CB_Vorauszahlungen()

    Call fcWBVB_CB_Vorauszahlungen

End Sub

Function fcWBVB_CB_Vorauszahlungen(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM99_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM99_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM99_1").Range.Font.Hidden = True
        
    End If

    ActiveDocument.Bookmarks("TM99_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)
    
End Function

Sub WBVB_CB_Baustellenbespr()

    Call fcWBVB_CB_Baustellenbespr
    
End Sub

Function fcWBVB_CB_Baustellenbespr(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM100_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM100_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM100_1").Range.Font.Hidden = True
        
    End If

    ActiveDocument.Bookmarks("TM100_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_Baufristenplan()

    Call fcWBVB_CB_Baufristenplan
    
End Sub

Function fcWBVB_CB_Baufristenplan(Optional bProtect As Boolean = True)    '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)

    If ActiveDocument.FormFields("TM102_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM102_1").Range.Font.Hidden = False
        
    Else
        ActiveDocument.Bookmarks("TM102_1").Range.Font.Hidden = True
        
    End If
    
    ActiveDocument.Bookmarks("TM102_CB_Dummy").Select

    If bProtect = True Then Call protectFile(True)

End Function

Sub WBVB_CB_Individuell()
    Call fcWBVB_CB_Individuell
End Sub

Function fcWBVB_CB_Individuell(Optional bProtect As Boolean = True)       '(wird zu "bProtect" kein Wert |fffd|bergeben, wird "true" verwendet)

    Call protectFile(False)
    
    If ActiveDocument.FormFields("TM74_CB").CheckBox.Value = True Then
        ActiveDocument.Bookmarks("TM74_1").Range.Font.Hidden = False
        ActiveDocument.Bookmarks("TM74_1_Text").Select
         
    Else
        ActiveDocument.Bookmarks("TM74_1").Range.Font.Hidden = True
        ActiveDocument.Bookmarks("TM74_CB_Dummy").Select
    End If

    If bProtect = True Then Call protectFile(True)

End Function

Attribute VB_Name = "WBVB_erzeugen"

 Private Const strVergabeordner1 As String = "H:\Vergabe- und Vertragsunterlagen\"                  'Struktur auf H:
 Private Const strVergabeordner2 As String = "\Verfahren\Original-VU\"                              'Struktur auf H:.....\VNr ......

 Private Const strTempPath As String = "c:\Temp\"                           'Ordner f|fffd|r tempor|fffd|re Dateien
 Private Const strTempDot As String = strTempPath & "OrgDot.dotx"           'Vorlage zum Erzeugen der einzelnen Formulare
 
 Private Const strTempFileName As String = "DocTemp.docx"                   'Dokumentname (und Teil des Fensternamens zur Pr|fffd|fung auf unsichtbares Fenster)
 Public Const strTempDoc As String = strTempPath & strTempFileName          'Dieses Originaldokument"
 
 Private strOutputFolder As String                                          'Ausgabeordner
 
 Public wdNeu As Word.Application
 Public docTemp As Word.Document
 
 Private strFormularListe As String                                         'Liste der erzeugten Formulare
 Private anzFormulare As Integer                                            'Anzahl der erzeugten Formulare

 Public skipSafeCheck As Boolean
 
'ausgeblendete Bereiche
 Public bSkipAufforderung As Boolean
 
 'URL des Formular-Ordners
 Private Const strFormularelink As String = "http://www.vbv.statistik-bw.de/Formulare/"
 
  'URL des Info-Ordners
 Private Const strInfolink As String = "http://www.vbv.statistik-bw.de/Info/VOB/"


    
 Public Function createWBVB()
 
 Application.ScreenUpdating = False 'beschleunigt das Makro, da keine Bildschirmaktualisierung
 
 'Formularinhalte pr|fffd|fen
  If Not checkValues = True Then
     Exit Function
     Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
  End If
 
 Dim strFileName As String                                              'jeweiliger Dateiname
 Dim strFormularName As String                                          'Bezeichnung des jeweils erzeugten Formulars
  
 Dim fso As New FileSystemObject
 strOutputFolder = ""
  
 
 'Vergabeordner pr|fffd|fen
    Dim strVNr As String
    strVNr = ActiveDocument.Bookmarks("VergNr_Kopf").Range.Text
    
    If Len(strVNr) = 8 Then
        Dim strVergabepath As String
        strVergabepath = strVergabeordner1 & strVNr & strVergabeordner2
        
        If fso.FolderExists(strVergabepath) Then
            strOutputFolder = strVergabepath
        Else
            strOutputFolder = ""
        End If
    End If
 
 'Speicherung pr|fffd|fen
    If strOutputFolder = "" Then
       strOutputFolder = ThisDocument.Path      'Pfad f|fffd|r Formularsatz wird auf gleichen (Ursprungs-)Ordner eingestellt
    End If
        
    ThisDocument.Save   'speichern im Ursprungsordner
        
    If strOutputFolder = "" Then
        MsgBox "Es wurde kein Ausgabeordner f|fffd|r die Formulare ermittelt.", vbInformation, "Hinweis"
        Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
        Exit Function
    End If
    
   'Timer: k|fffd|nstliche Wartezeit verhindert ansonsten gelegentlich auftretende Fehler beim Erstellen der tempor|fffd|ren Datei
   '       Da Zusammenh|fffd|nge unklar sind, nach einer gewissen Zeit die Notwendigkeit des Timers |fffd|berpr|fffd|fen.
  
    Dim x As Long
  
        x = Timer()
    Do While x + 4 > Timer()
      DoEvents
    Loop
  '----------------------------
    
    WBVB_generieren.Show (0)
      DoEvents
    
    
    If Not Right$(strOutputFolder, 1) = "\" Then strOutputFolder = strOutputFolder & "\"
    
    skipSafeCheck = True    'verhindert abfangen des Speichervorgangs im Klassenmodul DocEvents/appWord_DocumentBeforeSave
                
    If Not fso.FolderExists(strTempPath) Then fso.CreateFolder (strTempPath)
    If Not fso.FolderExists(strTempPath) Then
        WBVB_generieren.hide
        MsgBox "Tempor|fffd|rer Ordner konnte nicht angelegt werden.", vbInformation, "Hinweis"
        Exit Function
        Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
    End If
    
    
    killInvisibleWindows (strTempFileName)  'Unsichtbare Wordprozesse mit Fenstername "DocTemp.docx" abschiessen, falls vorhanden
    If fso.FileExists(strTempDoc) Then fso.DeleteFile (strTempDoc)
    If fso.FileExists(strTempPath & "~$" & Right$(strTempFileName, 11)) Then fso.DeleteFile (strTempPath & "~$" & Right$(strTempFileName, 11))
    
    
    Dim orgDocName As String
    orgDocName = ThisDocument.FullName
    
    ThisDocument.SaveAs2 FileName:=strTempDoc, Fileformat:=12    'docx erzeugen ohne Makros
    ThisDocument.SaveAs2 FileName:=orgDocName, Fileformat:=13    'R|fffd|cksprung auf Originalname des Dokuments (docm)
    
    Set wdNeu = New Word.Application
    wdNeu.Visible = False
    
    Set docTemp = wdNeu.Documents.Open(strTempDoc)


'Allgemeine Aufbereitung der Vorlage

   'Schutz entfernen
    docTemp.ActiveWindow.View = wdNormalView
    If Not docTemp.ProtectionType = wdNoProtection Then docTemp.Unprotect Password:="Vergadmin"    'Formularschutz aufheben

   'nur noch ma|fffd|gebende WBVB-Bereiche anzeigen
    
    If mBL = 2 Then 'Land
       docTemp.Bookmarks("Bereich_WBVB_nur_Bund_zivil").Range.Delete
       docTemp.Bookmarks("Bereich_WBVB_nur_Bund_BW").Range.Delete
       docTemp.Bookmarks("Bereich_WBVB_nur_Bund_US").Range.Delete
       
    Else            'Bund
       docTemp.Bookmarks("Bereich_WBVB_nur_Land").Range.Delete
    
       If mNutzer_B = 2 Then     'Zivil
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_BW").Range.Delete
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_US").Range.Delete
       
       ElseIf (mNutzer_B = 3 Or mNutzer_B = 5) Then  'Bundeswehr oder franz. Gaststreitkr|fffd|fte
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_zivil").Range.Delete
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_US").Range.Delete
    
       ElseIf mNutzer_B = 4 Then 'US-Gaststreitkr|fffd|fte
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_zivil").Range.Delete
          docTemp.Bookmarks("Bereich_WBVB_nur_Bund_BW").Range.Delete
       
       End If
    
    End If
    
    docTemp.Bookmarks("Bereich_nach_WBVB").Range.Delete
    docTemp.Bookmarks("Bereich_vor_WBVB").Range.Delete 'muss am Ende entfernt werden, da die Felder zuvor noch ausgelesen werden
    
   '"Ende der WBVB" einblenden
    docTemp.Bookmarks("Ende_WBVB").Range.Font.Hidden = False
    
   'Kopfzeile ver|fffd|ndern
    Call ReSetBookmark_Temp("Kopf_Zeile1_Bez", "Fortsetzung der ""Weiteren Besonderen Vertragsbedingungen""")
   
   'Call deleteHiddenText
     'funktioniert noch nicht
  
   'als Vorlage ohne speichern und schlie|fffd|en
    docTemp.SaveAs2 FileName:=strTempDot, Fileformat:=wdFormatXMLTemplate
    docTemp.Close savechanges:=False
    
   'l|fffd|schen
    If fso.FileExists(strTempDoc) Then fso.DeleteFile (strTempDoc)
    
   'pr|fffd|fen ob Vorlage vorhanden (vorsichtshalber)
    If Not fso.FileExists(strTempDot) Then
       WBVB_generieren.hide
       MsgBox "Die Dokumentvorlage konnte nicht gefunden werden.", vbInformation, "Hinweis"
       Application.ScreenUpdating = True 'Muss vor dem Exit eingeschaltet werden, da zu Beginn auf "false" gesetzt
       Exit Function
    End If
    
    
'Formulare erzeugen
    anzFormulare = 0
    strFormularListe = ""

'Fortsetzung der WBVB (pdf- und docx-Format)

   'Tempor|fffd|re Kopie des Originaldokuments aus Vorlage und ohne Makros
    Set docTemp = wdNeu.Documents.Add(strTempDot, False)
        
   'Entfernen nicht erforderlicher Textmarken
    Call deleteWBVB
                
   'wenn m|fffd|glich, nicht sichtbarer Text im Formular l|fffd|schen
     'Call deleteHiddenText
        
   'Formularschutz anbringen "Vergadmin"
     'hier nicht erforderlich
     
   'Abspeichern im pdf- und docx-Format
    strFileName = strOutputFolder & "Fortsetzung_WBVB_" & strVNr              'Dateiname
    
    docTemp.ExportAsFixedFormat outputFileName:=strFileName, exportformat:=wdExportFormatPDF, useiso19005_1:=True
    docTemp.SaveAs2 FileName:=strFileName, Fileformat:=12
   
   
   'pr|fffd|fen, ob wirklich vorhanden und weiterz|fffd|hlen
    strFormularName = "- Fortsetzung der WBVB"                               'Formularname f|fffd|r Auflistung in MsgBox
    Call checkForm(strFileName, strFormularName)
   
   'schliessen ohne weiteres speichern
    docTemp.Close savechanges:=False
    
    
'Download und Ablage "Hinweisblatt Holzprodukte"

    'Holzprodukte:
    'Bis 01.07.16 ist ein Merkblatt beizuf|fffd|gen. Anschlie|fffd|end wird das Formblatt komplett ge|fffd|ndert.
    'Daher diesen Bereich ab 01.07.2016 entfernen
    
    'If ActiveDocument.FormFields("Anl_Holzprodukte_CB").CheckBox.Value = True Then
                       
     '  If Len(strVNr) < 9 Then
      '    strFileName = strOutputFolder & strVNr & "_Info - Merkblatt_Holzprodukte.pdf"  'Dateiname mit Vergabe-Nr.
       'Else
        '  strFileName = strOutputFolder & "Merkblatt_Holzprodukte.pdf"                   'Dateiname ohne Vergabe-Nr.
       'End If
          
      ' Call DownloadFile(strFormularelink & "Holz_Bieterinfo.pdf", strFileName)
       
       'pr|fffd|fen, ob wirklich vorhanden und weiterz|fffd|hlen
       'strFileName = strOutputFolder & strVNr & "_Info - Merkblatt_Holzprodukte"                    'notwendig, da Endung ".pdf" in Sub CheckForm hinzugef|fffd|gt wird
                                                                                                    'Datei wird sonst nicht gefunden
       'strFormularName = "- Merkblatt Holzprodukte"                                                 'Formularname f|fffd|r Auflistung in MsgBox
       'Call checkForm(strFileName, strFormularName)
       
    'End If
    
'Download und Ablage "LTMG"
    If ActiveDocument.Bookmarks("Anl_LTMG").Range.Font.Hidden = False Then
       
       If Len(strVNr) < 9 Then
          strFileName = strOutputFolder & strVNr & "_Info - LTMG.pdf"                    'Dateiname mit Vergabe-Nr.
       Else
          strFileName = strOutputFolder & "LTMG.pdf"                       'Dateiname ohne Vergabe-Nr.
       End If
          
       Call DownloadFile(strFormularelink & "LTMG_Erkl.pdf", strFileName)
       
       'pr|fffd|fen, ob wirklich vorhanden und weiterz|fffd|hlen
       strFileName = strOutputFolder & strVNr & "_Info - LTMG"                    'notwendig, da Endung ".pdf" in Sub CheckForm hinzugef|fffd|gt wird
                                                                                                    'Datei wird sonst nicht gefunden
       strFormularName = "- Unterlagen nach LTMG"                                                 'Formularname f|fffd|r Auflistung in MsgBox
       Call checkForm(strFileName, strFormularName)
       
    End If
    
'Download und Ablage "LTMG_lite"
    If ActiveDocument.Bookmarks("Anl_LTMG_lite").Range.Font.Hidden = False Then
       
       If Len(strVNr) < 9 Then
          strFileName = strOutputFolder & strVNr & "_Info - LTMG.pdf"                    'Dateiname mit Vergabe-Nr.
       Else
          strFileName = strOutputFolder & "LTMG.pdf"                       'Dateiname ohne Vergabe-Nr.
       End If
          
       Call DownloadFile(strFormularelink & "LTMG_Erkl_lite.pdf", strFileName)
       
       'pr|fffd|fen, ob wirklich vorhanden und weiterz|fffd|hlen
       strFileName = strOutputFolder & strVNr & "_Info - LTMG"                    'notwendig, da Endung ".pdf" in Sub CheckForm hinzugef|fffd|gt wird
                                                                                                    'Datei wird sonst nicht gefunden
       strFormularName = "- Unterlagen nach LTMG"                                              'Formularname f|fffd|r Auflistung in MsgBox
       Call checkForm(strFileName, strFormularName)
       
    End If
    
    
'Download und Ablage "Einwilligung Zuverl|fffd|ssigkeits|fffd|berpr|fffd|fung"
    If ActiveDocument.Bookmarks("TM111_1").Range.Font.Hidden = False Then
       
       If Len(strVNr) < 9 Then
          strFileName = strOutputFolder & strVNr & "_Info - Einwilligung_Zuverl.pdf"                    'Dateiname mit Vergabe-Nr.
       Else
          strFileName = strOutputFolder & "Einwilligung_Zuverl.pdf"                       'Dateiname ohne Vergabe-Nr.
       End If
          
       Call DownloadFile(strInfolink & "Einwilligungserkl|fffd|rung_Zuverl|fffd|ssigkeits|fffd|berpr|fffd|fung.pdf", strFileName)
       
       'pr|fffd|fen, ob wirklich vorhanden und weiterz|fffd|hlen
       strFileName = strOutputFolder & strVNr & "_Info - Einwilligung_Zuverl"                    'notwendig, da Endung ".pdf" in Sub CheckForm hinzugef|fffd|gt wird
                                                                                                    'Datei wird sonst nicht gefunden
       strFormularName = "- Einwilligung Zuverl|fffd|ssigkeits|fffd|berpr|fffd|fung"                                                 'Formularname f|fffd|r Auflistung in MsgBox
       Call checkForm(strFileName, strFormularName)
       
    End If
    

'aufr|fffd|umen
    wdNeu.Quit
   
    If fso.FileExists(strTempDot) Then fso.DeleteFile (strTempDot)
    skipSafeCheck = False
    
'Meldungen
    WBVB_generieren.hide
   
    If anzFormulare = 0 Then    'keine Formulare erzeugt
        MsgBox "Es konnten keine Formulare generiert werden!", vbCritical, "Formularaufbereitung fehlgeschlagen"
    Else
       'Die nachstehende Funktion musste auskommentiert werden, da die Shell-Funktion vom Mail-Server als Virus erkannt wurde
       ' If MsgBox("Die nachstehenden Formulare" & vbNewLine & vbNewLine & strFormularListe & vbNewLine & vbNewLine & "wurden erfolgreich generiert und im Ordner" & vbNewLine & vbNewLine & _
        '          strOutputFolder & vbNewLine & vbNewLine & "abgelegt." & vbNewLine & vbNewLine & "M|fffd|chten Sie diesen Ordner jetzt |fffd|ffnen?", vbYesNo + vbInformation, "Umfang der Formularaufbereitung") = vbYes Then
        '    Shell "Explorer.exe " & strOutputFolder, vbNormalFocus
       ' End If
       
      MsgBox "Die nachstehenden Formulare" & vbNewLine & vbNewLine & strFormularListe & vbNewLine & vbNewLine & "wurden erfolgreich generiert und im Ordner" & vbNewLine & vbNewLine & _
              strOutputFolder & vbNewLine & vbNewLine & "abgelegt.", vbInformation, "Umfang der Formularaufbereitung"
    End If
        
 Application.ScreenUpdating = True 'Zu Beginn auf False gesetzt, muss wieder angeschaltet werden
        
 End Function

Function deleteWBVB()

     Dim ffTemp As FormField
     Dim Bmk As Bookmark
     Dim BmkTemp As Bookmark
    
     Dim rngTM As Range
     Set rngTM = docTemp.Range
     
     Dim xRow As Integer
     Dim strTemp, strTempBmk, strBmkName As String

     For Each Bmk In rngTM.Bookmarks
        strBmkName = Bmk.Name
            
        If Right$(strBmkName, 3) = "_CB" Then
             
            If rngTM.FormFields(strBmkName).Type = wdFieldFormCheckBox Then
                
                If rngTM.FormFields(strBmkName).CheckBox.Value = True And Bmk.Range.Font.Hidden = False Then
                                            
                    'Checkbox l|fffd|schen
                    If rngTM.Bookmarks.Exists(strBmkName) Then docTemp.FormFields(strBmkName).Delete
                        
                    'Bookmark |fffd|berschrift formatieren + Textmarke entfernen
                    strTemp = Left$(strBmkName, Len(strBmkName) - 3)
                    If rngTM.Bookmarks.Exists(strTemp) Then
                        rngTM.Bookmarks(strTemp).Range.Font.Hidden = False
                        rngTM.Bookmarks(strTemp).Range.Font.ColorIndex = wdBlack
                        rngTM.Bookmarks(strTemp).Range.Font.Bold = True
                        rngTM.Bookmarks(strTemp).Range.Font.Underline = wdUnderlineNone
                        rngTM.Bookmarks(strTemp).Delete
                    End If
                        
                    'Textfelder in Unterabschnitten abklappern
                    strTemp = Left$(strBmkName, Len(strBmkName) - 2) & "Gesamt"
                        
                    If rngTM.Bookmarks.Exists(strTemp) Then
                        For Each ffTemp In rngTM.Bookmarks(strTemp).Range.FormFields
                            If ffTemp.Type = wdFieldFormTextInput Then
                                strTemp = ffTemp.Name
                                If rngTM.Bookmarks.Exists(strTemp) Then
                                    rngTM.Bookmarks(strTemp).Range.Text = docTemp.FormFields(strTemp).Result
                                End If
                            End If
                        Next
                    End If
                        
                    'untergeordneten Checkboxen auswerten und nicht selektierte Bereiche entfernen
                    strTemp = Left$(strBmkName, Len(strBmkName) - 2) & "Gesamt"             'z.B. TMxx_Gesamt
                        
                    If rngTM.Bookmarks.Exists(strTemp) Then
                            
                        If rngTM.Bookmarks(strTemp).Range.Tables.Count = 1 Then
                            xRow = 2    'erste zu bearbeitende Zeile in der Tabelle
                        Else
                            xRow = 0
                        End If
                            
                        For Each ffTemp In rngTM.Bookmarks(strTemp).Range.FormFields
                            
                            If ffTemp.Type = wdFieldFormCheckBox And Right$(ffTemp.Name, 3) = "CBs" Then
                                    
                                strTempBmk = Left$(ffTemp.Name, Len(ffTemp.Name) - 4)           'z.B. TMxx_2
                                If rngTM.Bookmarks.Exists(strTempBmk) Then rngTM.Bookmarks(strTempBmk).Range.Font.Hidden = False
                                    
                                If ffTemp.CheckBox.Value = False Then                           'z.B. ffTemp.Name = TMxx_2_CBs
                                    'Tabellenzeile mit betreffender Checkbox
                                    If rngTM.Bookmarks.Exists(strTempBmk) Then
                                        If xRow = 0 Then
                                            rngTM.Bookmarks(strTempBmk).Range.Tables(1).Delete
                                        Else
                                            rngTM.Bookmarks(strTempBmk).Range.Tables(1).Rows(xRow).Delete
                                        End If
                                    End If
                                Else
                                    If rngTM.Bookmarks.Exists(strTempBmk) Then
                                        If xRow = 0 Then
                                            rngTM.Bookmarks(strTempBmk).Range.Tables(1).Columns(2).Delete
                                        Else
                                            rngTM.Bookmarks(strTempBmk).Range.Tables(1).Rows(xRow).Cells(2).Delete
                                            xRow = xRow + 1
                                        End If
                                    End If
                                        
                                    If rngTM.Bookmarks.Exists(strTempBmk) Then rngTM.Bookmarks(strTempBmk).Delete
                                        
                                    strTemp = strTempBmk & "_Hinweis" 'Hinweis entfernen
                                    If rngTM.Bookmarks.Exists(strTemp) Then rngTM.Bookmarks(strTemp).Range.Delete
                                        
                                    strTemp = strTempBmk & "_Dummy" 'Hinweis entfernen
                                    If rngTM.Bookmarks.Exists(strTemp) Then rngTM.Bookmarks(strTemp).Range.Delete
                                        
                                    strTemp = strTempBmk & "_1" 'Bookmark ..._1 entfernen
                                    If rngTM.Bookmarks.Exists(strTemp) Then rngTM.Bookmarks(strTemp).Range.Font.Hidden = False
                                    If rngTM.Bookmarks.Exists(strTemp) Then rngTM.Bookmarks(strTemp).Delete
                                        
                                End If
                                    
                            End If
                            
                        Next
                    End If
                        
                    'Bookmark ..._1 entfernen, wo keine untergeordnete Checkbox ist
                    strTemp = Left$(strBmkName, Len(strBmkName) - 2) & "1"
                    If rngTM.Bookmarks.Exists(strTemp) Then
                        rngTM.Bookmarks(strTemp).Range.Font.Hidden = False
                        rngTM.Bookmarks(strTemp).Delete
                    End If

                    'Bookmark ..._Gesamt entfernen
                    strTemp = Left$(strBmkName, Len(strBmkName) - 2) & "Gesamt"
                    If rngTM.Bookmarks.Exists(strTemp) Then
                        rngTM.Bookmarks(strTemp).Range.InsertAfter (vbNewLine)
                        rngTM.Bookmarks(strTemp).Delete
                    End If
                        
                Else
                    'TM..._Gesamt l|fffd|schen
                    strTemp = Left$(strBmkName, Len(strBmkName) - 2) & "Gesamt"
                    If rngTM.Bookmarks.Exists(strTemp) Then
                        If rngTM.Bookmarks(strTemp).Range.Tables.Count > 0 Then
                            For Each tblTemp In rngTM.Bookmarks(strTemp).Range.Tables
                                tblTemp.Delete
                            Next
                            End If
                    End If
                        
                    If rngTM.Bookmarks.Exists(strTemp) Then rngTM.Bookmarks(strTemp).Delete
                        
                End If
            End If
        Else
            If Right$(strBmkName, 5) = "Dummy" Then
                If rngTM.Bookmarks.Exists(strBmkName) Then
                    
                    For Each ffTemp In rngTM.Bookmarks(strBmkName).Range.FormFields
                        If ffTemp.Name = strBmkName Then
                            If ffTemp.Type = wdFieldFormCheckBox Or ffTemp.Type = wdFieldFormTextInput Then
                                ffTemp.Delete
                            End If
                        End If
                    Next
                    
                    If rngTM.Bookmarks.Exists(strBmkName) Then rngTM.Bookmarks(strBmkName).Range.Delete
                        
                End If
            End If
                
            If Right$(strBmkName, 7) = "Hinweis" Then
                If rngTM.Bookmarks.Exists(strBmkName) Then
                    rngTM.Bookmarks(strBmkName).Range.Delete
                End If
            End If
                
            If rngTM.Bookmarks.Exists(strBmkName) Then
                If rngTM.Bookmarks(Bmk).Range.Font.Hidden = True Then rngTM.Bookmarks(strBmkName).Range.Delete
            End If
                    
        End If
            
    Next
        
       
End Function


Private Function checkForm(strFileName As String, strFormName As String) As Boolean

    Dim fsoF As New FileSystemObject
    
    If fsoF.FileExists(strFileName & ".pdf") Then
            anzFormulare = anzFormulare + 1
            strFormularListe = IIf(strFormularListe = "", strFormName, strFormularListe & vbNewLine + strFormName)
    End If

End Function


'Formularinhalte pr|fffd|fen vor WBVB-Erstellung
Private Function checkValues() As Boolean
                
            
        checkValues = False
        
        'WBVB pr|fffd|fen
        Call protectFile(False)
        
        Pruefen.Show (0)
        DoEvents

        If WBVB_Check("WBVB") = False Then
           Call protectFile(True)
           Exit Function
        Else
            Call protectFile(True)
            Pruefen.hide
        End If
        
        
        'Weitere Pr|fffd|fungen
        Dim bOk As Boolean
        bOk = True
        
        Dim strTest, strMsg As String
        
        'Pr|fffd|fen, ob g|fffd|ltige Vergabe-Nr. erfasst wurde
        strTest = ThisDocument.FormFields("VergNr").Result
        strMsg = "Das Erstellen der ""Weiteren Besonderen Vertragsbedingungen"" ist erst nach der Eingabe einer g|fffd|ltigen Vergabenummer m|fffd|glich." & vbNewLine & vbNewLine & "Bitte erfassen Sie zuerst die Vergabenummer."
        
        If strTest = "" Then
            bOk = False
        Else
            If Len(strTest) = 8 Then
                If Not Mid$(strTest, 3, 1) = "-" Then bOk = False
            Else
                bOk = False
            End If
        End If
        
        'hier evtl. weitere Pr|fffd|fungen
        
        
        
        
        If Not bOk Then
            MsgBox strMsg, vbCritical, "Vergabenummer pr|fffd|fen"
            ThisDocument.FormFields("VergNr").Select
            Exit Function
        End If
        
        checkValues = True
        
End Function
    


Attribute VB_Name = "WBVB_generieren"
Attribute VB_Base = "0{6D1C8BE2-AD79-4670-856E-F80EE97E5C5B}{165FBD12-4F91-482A-9E82-6BCA025C0498}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

#If VBA7 Then
 
    Private Declare PtrSafe Function DrawMenuBar Lib "User32" ( _
     ByVal hWnd As Long) As Long
    
    Private Declare PtrSafe Function FindWindow Lib "User32" Alias "FindWindowA" ( _
     ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
    
    Private Declare PtrSafe Function GetWindowLong Lib "User32" Alias "GetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long) As Long
    
    Private Declare PtrSafe Function SetWindowLong Lib "User32" Alias "SetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long, _
     ByVal dwNewLong As Long) As Long
     
#Else

    Private Declare Function DrawMenuBar Lib "User32" ( _
     ByVal hWnd As Long) As Long
    
    Private Declare Function FindWindow Lib "User32" Alias "FindWindowA" ( _
     ByVal lpclassname As String, _
     ByVal lpWindowName As String) As Long
    
    Private Declare Function GetWindowLong Lib "User32" Alias "GetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long) As Long
    
    Private Declare Function SetWindowLong Lib "User32" Alias "SetWindowLongA" ( _
     ByVal hWnd As Long, _
     ByVal nIndex As Long, _
     ByVal dwNewLong As Long) As Long
     
#End If
     

Const WS_CAPTION As Long = &HC00000
Const GWL_STYLE As Long = (-16)

Dim hWnd&

Private Function GetHandleUF(uf As MSForms.UserForm) As Long
    GetHandleUF = IIf(Int(Val(Application.Version)) < 9, _
        FindWindow("ThunderXFrame", uf.Caption), FindWindow("ThunderDFrame", uf.Caption))
End Function

Private Sub UserForm_Initialize()

    hWnd = GetHandleUF(Me)

   'Die Titelleiste entfernen
    Call SetWindowLong(hWnd, GWL_STYLE, GetWindowLong(hWnd, GWL_STYLE) And Not WS_CAPTION)

    Call DrawMenuBar(hWnd)

End Sub
Attribute VB_Name = "XML_Import"

Private xmlPath As String
Private Const xmlFile As String = "Formulare und Datenlisten\Vergabestelle.xml"  'Pfad der xml-Datei mit den Daten der Vergabestelle

Private Const anzImporte As Integer = 1     'Anzahl, wie oft die Daten in das Dokument eingelesen werden  (Standard = 1)
                                            'Bezeichnung der Textfelder im Dokument:
                                                    'erste Angabe : VSt01,   VSt02,   VSt03,   VSt04
                                                    'zweite Angabe: VSt01_1, VSt02_1, VSt03_1, VSt04_1
                                                    'dritte Angabe: VSt01_2, VSt02_2, VSt03_2, VSt04_2
                                                    'u.s.w
    
Sub Pr|fffd|fung_Import()

    Call protectFile(False)

    If ActiveDocument.Bookmarks.Exists("VSt01") Then
       If ActiveDocument.Bookmarks("VSt01").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt01").Result = "" Then
       If readXML = False Then Exit Sub
       Anpassung_Import (False)
       End If
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt02") Then
       If ActiveDocument.Bookmarks("VSt02").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt02").Result = "" Then
       If readXML = False Then Exit Sub
       Anpassung_Import (False)
       End If
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt03") Then
       If ActiveDocument.Bookmarks("VSt03").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt03").Result = "" Then
       If readXML = False Then Exit Sub
       End If
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt04") Then
       If ActiveDocument.Bookmarks("VSt04").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt04").Result = "" Then
       If readXML = False Then Exit Sub
       End If
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt_Kurzbez_Abs1") Then
       If ActiveDocument.Bookmarks("VSt_Kurzbez_Abs1").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt_Kurzbez_Abs1").Result = "" Then
       If readXML = False Then Exit Sub
       End If
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt_Kurzbez_Abs2") Then
       If ActiveDocument.Bookmarks("VSt_Kurzbez_Abs2").Range.Font.Hidden = False And ActiveDocument.FormFields("VSt_Kurzbez_Abs2").Result = "" Then
       If readXML = False Then Exit Sub
       End If
    End If

    Call protectFile(True)
    
End Sub

Public Function readXML() As Boolean
    
    readXML = True
    
    Dim fso
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FileExists(xmlPath) Or anzImporte = 0 Then Exit Function
    
    On Error Resume Next
    
    Set msxml = CreateObject("Microsoft.XMLDOM")
    msxml.Load (xmlPath)
    
    Set Root = msxml.DocumentElement
    Dim strName As String
    Dim strFieldName As String
    
    If Not Root Is Nothing Then
        Set ChildNodes = Root.ChildNodes()
        
        For Each v_child In ChildNodes
            If v_child.BaseName = "Vergabestelle" Then
                Set v_child_props = v_child.ChildNodes()
                For Each V_Child_Prop In v_child_props
                    ActiveDocument.FormFields(V_Child_Prop.BaseName).Result = V_Child_Prop.nodeTypedValue
                    
                    If anzImporte > 1 Then
                        Dim i As Integer
                        For i = 1 To anzImporte - 1
                            strFieldName = V_Child_Prop.BaseName & "_" & i
                            ActiveDocument.FormFields(strFieldName).Result = V_Child_Prop.nodeTypedValue
                        Next
                    End If
                Next
            End If
        Next
    Else
        MsgBox "Die Importdatei mit den Daten der Vergabestelle ist fehlerhaft." + Chr$(13) + "Die Daten k|fffd|nnen deshalb nicht eingelesen werden." + Chr$(13) + Chr$(13) + "Bitte setzen Sie sich |fffd|ber die Vergabestelle mit dem Anwendungssupport in Verbindung.", vbCritical, "Pr|fffd|fung der Importdatei"
        readXML = False
    End If
    
End Function

Sub Anpassung_Import(Optional bProtect As Boolean = True)

    Call protectFile(False)

    If ActiveDocument.Bookmarks.Exists("VSt01") And ActiveDocument.Bookmarks.Exists("VSt02") And _
       ActiveDocument.Bookmarks.Exists("TM_VSt01") And ActiveDocument.Bookmarks.Exists("TM_VSt02") Then
    
       If Not ActiveDocument.FormFields("VSt01").Result = "" And ActiveDocument.FormFields("VSt02").Result = "" Then
          ActiveDocument.Bookmarks("TM_VSt02").Range.Font.Hidden = True
       ElseIf Not ActiveDocument.FormFields("VSt02").Result = "" And ActiveDocument.FormFields("VSt01").Result = "" Then
          ActiveDocument.Bookmarks("TM_VSt01").Range.Font.Hidden = True
       End If
       
    End If
    
    If ActiveDocument.Bookmarks.Exists("VSt01_1") And ActiveDocument.Bookmarks.Exists("VSt02_1") And _
       ActiveDocument.Bookmarks.Exists("TM_VSt01_1") And ActiveDocument.Bookmarks.Exists("TM_VSt02_1") Then
    
       If Not ActiveDocument.FormFields("VSt01_1").Result = "" And ActiveDocument.FormFields("VSt02_1").Result = "" Then
          ActiveDocument.Bookmarks("TM_VSt02_1").Range.Font.Hidden = True
       ElseIf Not ActiveDocument.FormFields("VSt02_1").Result = "" And ActiveDocument.FormFields("VSt01_1").Result = "" Then
          ActiveDocument.Bookmarks("TM_VSt01_1").Range.Font.Hidden = True
       End If
       
    End If
    
    If bProtect = True Then Call protectFile(True)
     
End Sub

Sub checkBetrieb()  'muss immer als erste Funktion im Modul ausgef|fffd|hrt werden !!

    'Lesen des Wertes vom jeweiligen Feld und Zuordnung zur Variablen (notwendig, um Makros nur bei |fffd|nderung in den Feldinhalten ablaufen zu lassen)
    mBL = ActiveDocument.FormFields("DD1_Betrieb").DropDown.Value
    
    'Falls xml-Datei in irgendeinem Laufwerk gefunden wird, wird der Pfad entsprechend gesetzt
    xmlPath = checkLaufwerke
    
    'Pr|fffd|fen ob bereits ein Wert ausgew|fffd|hlt ist oder xml-Datei nicht existiert.
    If ActiveDocument.FormFields("DD1_Betrieb").DropDown.Value > 1 Or xmlPath = "" Then Exit Sub
        
    'Pr|fffd|fen ob Wert in xml-Datei vorhanden
    If setBetrieb = False Then
        MsgBox "Die Importdatei mit den Daten der Betriebsart (Land/Bund) ist fehlerhaft." + Chr$(13) + "Die Betriebsart kann deshalb nicht eingelesen werden." + Chr$(13) + Chr$(13) + "Bitte setzen Sie sich |fffd|ber die Vergabestelle mit dem Anwendungssupport in Verbindung.", vbCritical, "Pr|fffd|fung der Importdatei"
        Exit Sub
    End If
    
    Call fcLandBund
    
End Sub

Function setBetrieb() As Boolean
        
    setBetrieb = False
    
    Set msxml = CreateObject("Microsoft.XMLDOM")
    msxml.Load (xmlPath)
    
    Set Root = msxml.DocumentElement
   
    If Not Root Is Nothing Then
        Set ChildNodes = Root.ChildNodes()
        
        For Each v_child In ChildNodes
            If v_child.BaseName = "Vergabestelle" Then
                Set v_child_props = v_child.ChildNodes()
                For Each V_Child_Prop In v_child_props
                    If V_Child_Prop.BaseName = "VSt_isLand" Then
                        mBL = IIf(V_Child_Prop.nodeTypedValue = "true", 2, 3)
                        ActiveDocument.FormFields("DD1_Betrieb").DropDown.Value = mBL
                        setBetrieb = True
                        Exit For
                    End If
                Next
                Exit For
            End If
        Next
    End If
    
End Function

Private Function checkLaufwerke() As String

    Dim fso As FileSystemObject
    Dim lw As Drive
       
    checkLaufwerke = ""
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    'zuerst auf H:\ nachsehen, wird am h|fffd|ufigsten vorkommen
    If fso.FileExists("H:\" & xmlFile) Then
        checkLaufwerke = "H:\" & xmlFile
    Else
        For Each lw In fso.Drives 'alle Laufwerke
            If lw.DriveType = 1 Or lw.DriveType = 2 Or lw.DriveType = 3 Then    'Lauwerke: entfernbar/lokal/Netz
                If fso.FileExists(lw.Path & "\" & xmlFile) Then
                    checkLaufwerke = lw.Path & "\" & xmlFile
                    Exit For
                End If
            End If
        Next
    End If
    
    Set fso = Nothing
    
End Function




' InQuest injected base64 decoded content
' %z+d

INQUEST-PP=macro
