Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
'2008/1/17 Ver.800|fffd|@|fffd||1c9||fffd|
'2017/11/28 Ver.1800

    hyouji_nyuuflg = True
    
End Sub

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
'2008/1/17 Ver.800|fffd|@|fffd||1c9||fffd|

    hyouji_nyuuflg = True
End Sub

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_BeforeClose(Cancel As Boolean)
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610
'2017/1/8 Ver.1700
'2017/11/26 Ver.1800
'2019/1/2 Ver.1900

    If myflgclose Then Exit Sub
    Dim myBook As Workbook
    Dim a As String, strinFile1 As String, strinFile2 As String
'    strinFile1 = "tyousyuuhyou31"                       '|fffd||fffd||fffd||fffd||fffd|[|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    strinFile2 = "goukeihyou31"                         '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    On Error Resume Next
    For Each myBook In Workbooks
        If myBook.Path = ThisWorkbook.Path Then
            a = Workbooks(myBook.Name).Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile2 Then
                If MsgBox(myBook.Name & "|fffd|@|fffd||fffd||fffd||82||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|m|fffd|F") = vbYes Then
                    Workbooks(myBook.Name).Close
                    ThisWorkbook.Activate
                End If
            End If
            a = ""
        End If
    Next
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610
'2017/1/8 Ver.1700
'2017/11/26 Ver.1800
'2019/1/2 Ver.1900

    If myflgsave Then Exit Sub
    Dim myBook As Workbook
    Dim a As String, strinFile1 As String, strinFile2 As String
    strinFile1 = "tyousyuuhyou31"                       '|fffd||fffd||fffd||fffd||fffd|[|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    strinFile2 = "goukeihyou31"                         '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    On Error Resume Next
    For Each myBook In Workbooks
        If myBook.Path = ThisWorkbook.Path Then
            a = Workbooks(myBook.Name).Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile1 Or a = strinFile2 Then
                If MsgBox(myBook.Name & "|fffd|@|fffd||582||315||3cd|X|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd||6d1||fffd||fffd|m|fffd|F") = vbYes Then
                    Application.ScreenUpdating = False
                    Workbooks(myBook.Name).Save
                    Application.ScreenUpdating = True
                End If
            End If
            a = ""
        End If
    Next
End Sub

Private Sub Workbook_Open()
'2003/5/15
'2008/11/10 Ver.810
'2009/11/26 Ver.911|fffd|@|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||58e|~|fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd||1c9||fffd|
'2009/11/28 Ver.920
'2011/1/10 Ver.1100|fffd|@TextBoxes|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
'2017/11/26 Ver.1800
    
    Dim i As Long
    Dim a As String
    
    a = Me.FullName
    If Replace(Replace(a, "[", ""), "]", "") <> a Then
        MsgBox "|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|E|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||242||341|A|fffd||fffd||fffd|p|fffd||5287||fffd||295||fffd||fffd||fffd| [|fffd|@] |fffd||34e|g|fffd|p|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||101|A|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|E|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
    End If
        
    mybkhp = "|fffd|g|fffd|b|fffd|v"
    mybkzei = "|fffd|g|fffd|b|fffd|v"
    Worksheets("|fffd|g|fffd|b|fffd|v").Select
    Range("A5").Select
    Me.Saved = True
'    Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{2D28AF35-7A05-4157-9516-9E11161DD8FA}{3BD06FDA-B3B1-410D-9197-C22AD45D5C89}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private myflg As Boolean
Private opfg As Boolean
Private nnn As Long, datacnt As Long

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|s
'2007/1/20 Ver.710
'2008/11/10 Ver.810
'2011/2/28 Ver.1005
'2017/11/28 Ver.1800
    
    Dim i As Long, j As Long, n As Long, m As Long, k As Long, mm As Long
    Dim wshd As Worksheet
    Dim lfg As Boolean
    Dim mytime As Single
    Dim comflg(1 To 4) As Boolean
    
    Set wshd = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
    
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    ActiveWindow.ScrollColumn = 100
    
    comflg(1) = Me.CommandButton4.Enabled
    comflg(2) = Me.CommandButton5.Enabled
    comflg(3) = Me.CommandButton6.Enabled
    comflg(4) = Me.CommandButton7.Enabled
    
    Me.CommandButton1.Enabled = False
    Me.CommandButton2.Enabled = True
    Me.CommandButton3.Enabled = False
    Me.CommandButton4.Enabled = False
    Me.CommandButton5.Enabled = False
    Me.CommandButton6.Enabled = False
    Me.CommandButton7.Enabled = False
    Me.CommandButton2.Cancel = True
    Me.Label3.Visible = True
    
    j = 1
    Me.Label3.Caption = "|fffd||fffd||fffd||fffd||fffd|"
    Me.ListBox1.Enabled = False
    Me.Frame1.Enabled = False
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
        m = wshd.Range("D13").Value
        mm = m
        
        DoEvents
        
        For i = 0 To Me.ListBox1.ListCount - 1
            If Me.ListBox1.Selected(i) = True Then
                If myflg = True Then
                    MsgBox j & " |fffd||fffd||fffd||688||20d|~|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|~"
                    Exit For
                End If
                
                If Me.OptionButton1.Value Then
                    k = m
                Else
                    k = nnn * 20 + i + 1
                End If
                
                If m <> k Then
                    wshd.Range("D13").Value = k
                    Call hyouji2n
                    
                    .Activate
                    
'                    Call hyouji1b
                    m = k
                End If
                
                DoEvents
                .PrintOut Copies:=1
'                .PrintPreview
                Me.Label3.Caption = j & " |fffd||fffd||fffd||688||fffd||fffd||fffd||fffd|"
                DoEvents
                j = j + 1
                
                mytime = Timer + 1
                Do While mytime > Timer
                    DoEvents
                    If myflg Then Exit Do
                Loop
            End If
        Next i
        DoEvents
        
        If wshd.Range("D13").Value <> mm Then
            wshd.Range("D13").Value = mm
            
            Call hyouji2n
            
            .Activate
'            Call hyouji1b
        End If
        
    End With
    
    Me.CommandButton1.Enabled = True
    Me.CommandButton2.Enabled = False
    Me.CommandButton3.Enabled = True
    Me.CommandButton4.Enabled = comflg(1)
    Me.CommandButton5.Enabled = comflg(2)
    Me.CommandButton6.Enabled = comflg(3)
    Me.CommandButton7.Enabled = comflg(4)
    Me.CommandButton3.Cancel = True
    Me.Label3.Visible = False
    Me.ListBox1.Enabled = True
    Me.Frame1.Enabled = True
    
    ActiveWindow.ScrollColumn = 1
    myflg = False
    DoEvents
    
    Set wshd = Nothing
End Sub

Private Sub CommandButton2_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton3_Click()
'|fffd|I|fffd||fffd|

    Unload Me
End Sub

Private Sub CommandButton4_Click()
'|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||682||fffd||fffd||5c2||111|I|fffd||fffd|

    Dim i As Long
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            .Selected(i) = True
        Next i
    End With
End Sub

Private Sub CommandButton5_Click()
'|fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|r|fffd||fffd||fffd|[
'2007/1/20 Ver.710
'2008/11/10 Ver.810
'2017/11/28 Ver.1800

    Dim i As Long, n As Long, m As Long, k As Long
    Dim wshd As Worksheet
    Dim lfg As Boolean
    
    Set wshd = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                n = i
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    Me.Hide
    DoEvents
    ActiveWindow.ScrollColumn = 100
    DoEvents
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
        m = wshd.Range("D13").Value
        If Me.OptionButton1.Value Then
            k = m
        Else
            k = nnn * 20 + n + 1
        End If
        
        If m <> k Then
            wshd.Range("D13").Value = k
            Call hyouji2n
            
            .Activate
'            Call hyouji1b
        End If
        
        .PrintPreview
        
        If m <> k Then
            wshd.Range("D13").Value = m
            Call hyouji2n
            
            .Activate
'            Call hyouji1b
        End If
    End With
    
    DoEvents
    ActiveWindow.ScrollColumn = 1
    DoEvents
    Me.Show
    
    Set wshd = Nothing
End Sub

Private Sub CommandButton6_Click()
'|fffd|O|fffd||fffd|
'2007/1/20 Ver.710
    
    Dim i As Long, n As Long, k As Long
    
    nnn = nnn - 1
    If nnn = 0 Then Me.CommandButton6.Enabled = False
    
    k = 20 * nnn + 1
    n = k + 19

    opfg = False
    Me.ListBox1.Clear
    For i = k To n
        Me.ListBox1.AddItem Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(30 + i, 8).Value
    Next i
    opfg = True
    
    Me.Label4.Caption = k & "|fffd||fffd||fffd||fffd|" & n & " /" & datacnt & "|fffd||fffd||fffd||fffd|"
    Me.CommandButton1.Enabled = False
    Me.CommandButton7.Enabled = True
End Sub

Private Sub CommandButton7_Click()
'|fffd||fffd||fffd||fffd|
'2007/1/20 Ver.710

    Dim i As Long, n As Long, k As Long
    
    nnn = nnn + 1
    
    k = 20 * nnn + 1
    If datacnt < k + 20 Then
        n = datacnt
        Me.CommandButton7.Enabled = False
    Else
        n = k + 19
'        Me.CommandButton7.Enabled = True
    End If
    
    opfg = False
    Me.ListBox1.Clear
    For i = k To n
        Me.ListBox1.AddItem Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(30 + i, 8).Value
    Next i
    opfg = True
    
    Me.Label4.Caption = k & "|fffd||fffd||fffd||fffd|" & n & " /" & datacnt & "|fffd||fffd||fffd||fffd|"
    Me.CommandButton1.Enabled = False
    Me.CommandButton6.Enabled = True
End Sub

Private Sub ListBox1_Change()
'2007/1/20 Ver.710

    If opfg = False Then Exit Sub
    
    Dim i As Long
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If (.Selected(i) = True) Then
                Me.CommandButton1.Enabled = True
                Exit Sub
            End If
        Next i
        Me.CommandButton1.Enabled = False
    End With
End Sub

Private Sub OptionButton1_Click()
'|fffd||fffd||fffd||fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd||302||fffd|
'2007/1/20 Ver.710

    Dim n As Long
    
    nnn = 0
    
    opfg = False
    With Me.ListBox1
        .Clear
        .AddItem Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D15").Value
        .Selected(0) = True
    End With
    opfg = True
    
    Me.Label4.Caption = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D13").Value & "|fffd||516||fffd| /" & datacnt & "|fffd||fffd||fffd||fffd|"
    Me.CommandButton1.Enabled = True
    Me.CommandButton6.Enabled = False
    Me.CommandButton7.Enabled = False
End Sub

Private Sub OptionButton2_Click()
'|fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|X|fffd|g|fffd||151|I|fffd||fffd|
'2007/1/20 Ver.710

    Dim i As Long, n As Long
    
    nnn = 0
    
    opfg = False
    nnn = 0
    Me.ListBox1.Clear
    If datacnt > 20 Then
        Me.CommandButton7.Enabled = True
        n = 20
    Else
        n = datacnt
        Me.CommandButton7.Enabled = False
    End If
    For i = 1 To n
        Me.ListBox1.AddItem Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(30 + i, 8).Value
    Next i
    opfg = True
    
    Me.Label4.Caption = "1|fffd||fffd||fffd||fffd|" & n & " /" & datacnt & "|fffd||fffd||fffd||fffd|"
    
    Me.CommandButton1.Enabled = False
    Me.CommandButton6.Enabled = False
End Sub

Private Sub UserForm_Initialize()
'2007/1/20 Ver.710

    datacnt = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value
    nnn = 0
    
    With Me
        opfg = False
'        .CommandButton1.Enabled = True
        .CommandButton2.Enabled = False
        .CommandButton3.Cancel = True
        
        .OptionButton1.Value = True
'        .CommandButton6.Enabled = False
'        .CommandButton7.Enabled = False
        opfg = True
        
        .Label1.Caption = "|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||151|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||9294e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(10) & _
                            "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||317|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(10) & _
                            "|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B"
        
'        .Label4.Caption = "1 /" & datacnt & "|fffd||fffd||fffd||fffd|"
    End With
End Sub
Attribute VB_Name = "data_narabikae"
Option Explicit
Option Private Module

Sub tyoubo_narabikae()
'2009/11/22 Ver.911

    Dim m As Long
    Dim a As String
    a = ActiveSheet.Name
    
    Application.ScreenUpdating = False
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        m = .Cells(.Rows.Count, 4).End(xlUp).Row
        If m > 31 Then
            .Unprotect Password:="s2341"
            
            narabikae
            
            .Protect Password:="s2341"
        End If
        .Activate
    End With
    
    Worksheets(a).Activate
    Application.ScreenUpdating = True
End Sub
Sub narabikae()
'2002/5/8
'2009/11/22 Ver.911
    
'    Application.ScreenUpdating = False
    Dim m As Long
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        m = .Cells(.Rows.Count, 4).End(xlUp).Row
        If m > 31 Then
'            .Unprotect Password:="s2341"
            .Range("D19").Value = .Range("D18").Value
            Select Case .Range("D22").Value
                Case Is = 1
                    .Range(.Cells(31, 3), .Cells(m, 7)).Sort _
                        Key1:=.Range("C31"), Order1:=xlAscending, Header:=xlNo, _
                        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                        SortMethod:=xlPinYin
        
                Case Is = 2
                    .Range(.Cells(31, 3), .Cells(m, 7)).Sort _
                        Key1:=.Range("C31"), Order1:=xlAscending, Header:=xlNo, _
                        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                        SortMethod:=xlPinYin
                    m = .Cells(.Rows.Count, 4).End(xlUp).Row
                    If m > 31 Then
                        .Range(.Cells(31, 3), .Cells(m, 7)).Sort _
                        Key1:=.Range("F31"), Order1:=xlAscending, Header:=xlNo, _
                            OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                            SortMethod:=xlPinYin
                    End If
    
                Case Is = 3
                    .Range(.Cells(31, 3), .Cells(m, 7)).Sort _
                        Key1:=.Range("E31"), Order1:=xlAscending, Header:=xlNo, _
                        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                        SortMethod:=xlPinYin
        
                Case Is = 4
                    .Range(.Cells(31, 3), .Cells(m, 7)).Sort _
                        Key1:=.Range("E31"), Order1:=xlAscending, Key2:=.Range("C31"), _
                        Order2:=xlAscending, Header:=xlNo, OrderCustom:=1, MatchCase:=False, _
                        Orientation:=xlTopToBottom, SortMethod:=xlPinYin
            End Select
    
            .Range("D13").Value = .Range("D20").Value
'            .Protect Password:="s2341"
        End If
    End With
'    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "hukusya_kyuuyobi"
Option Explicit
Option Private Module

Sub kyuuyobi2n()
'2003/1/2
    With Worksheets("|fffd||fffd||fffd||fffd|")
        If .Range("F98").Value = .Range("E30").Value * 12 Then
            .Range("E30:E41").Value = .Range("F27").Value
        End If
    End With
End Sub

Sub zengetuhukusya2n()
'2003/5/22
    With ActiveCell
        If .Row >= 31 And .Row <= 41 And _
                .Column >= 4 And .Column <= 9 And .Column <> 8 Then
            If Cells(.Row - 1, 4).Value = "" Then
                Cells(.Row, 4).Value = ""
            Else
                Cells(.Row, 4).Value = Cells(.Row - 1, 4).Value + 1
            End If
                Cells(.Row, 5).Value = Cells(.Row - 1, 5).Value
                Range(Cells(.Row, 6), Cells(.Row, 7)).Value _
                    = Range(Cells(.Row - 1, 6), Cells(.Row - 1, 7)).Value
                Cells(.Row, 9).Value = Cells(.Row - 1, 9).Value
            .Offset(1).Select
        End If
    End With
End Sub

Sub sinkisakusei()
'2003/5/22
'2008/1/17 Ver.800
'2008/11/10 Ver.810
'2010/1/5 Ver.1000 |fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
'2017/11/28 Ver.1800
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        If hyouji_nyuuflg Then
            If MsgBox("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||313|o|fffd|^|fffd|m|fffd|F") = vbYes Then
                .Range("D13").Value = .Range("E13").Value
                If Worksheets("|fffd||fffd||fffd||fffd|").Range("F18").Value = "" Then
                    MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
                Else
                    myflgnyuutouroku = True
                    
                    touroku2n
                    
                    myflgnyuutouroku = False
                    hyouji_nyuuflg = False
                End If
                Exit Sub
            End If
        End If
        
        If .Range("D25").Value > 229 Then
            MsgBox "230|fffd||fffd||fffd||20f||fffd||34d||c42c||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
        Else
            .Range("D13").Value = .Range("D25").Value + 1
            
            hyouji2n
            
            .Range("E13").Value = .Range("D13").Value
        End If
        
        hyouji_nyuuflg = False
        
    End With
    
    Range("A5").Select
End Sub
Attribute VB_Name = "jyoukyou"
Option Explicit
Option Private Module

Sub jyoukyouitiranhyou()
    Worksheets("|fffd||fffd||fffd||fffd||fffd||cbd48||a5d7||fffd|\").Select
    
    jyoukyouitiran_syuukei
    
    Range("A4").Select
End Sub

Sub itiran_jyoukyoutyouhe()
'2009/3/1 Ver.910

    jyoukyouitiran_clear
    
    Worksheets("|fffd||cbd52||fffd|").Select
End Sub

Sub jyoukyouitiran_clear()
'2009/3/1 Ver.910

    With Worksheets("|fffd||fffd||fffd||fffd||fffd||cbd48||a5d7||fffd|\")
        If Not IsEmpty(.Range("A4").Value) Then
            .Unprotect Password:="s2341"
            .Range("A4:N5000,X5:AI56").ClearContents
            .Protect Password:="s2341"
        End If
    End With
End Sub

Sub jyoukyouitiran_syuukei()
'2009/2/28 Ver.910
'2009/12/25 Ver.923

    Dim i As Long, j As Long, k As Long, n As Long, m As Long, a As Long, b As Long
    Dim mydata() As Variant
    Dim mydata2(1 To 52, 1 To 12) As Variant
    Dim moto As Variant, c As Variant
    
    n = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value               '|fffd|o|fffd|^|fffd||fffd|
    
    If n > 0 Then
        b = n * 18
        ReDim mydata(1 To b, 1 To 14)
        With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            m = .Range("D24").Value
            c = .Range("G31:G260").Value                        '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
            moto = .Range("S1").Resize(476, m - 18).Value
        End With
        k = 0
        
        For i = 1 To n
            a = c(i, 1)                                     '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
            
            For j = 1 To 12                                 '|fffd||fffd||fffd|^
                k = k + 1
                mydata(k, 1) = i                            'No
                mydata(k, 2) = moto(45, a)                  '|fffd||fffd||fffd||fffd||fffd||50d||fffd|
                mydata(k, 3) = moto(36, a)                  '|fffd||fffd||fffd||fffd|
                mydata(k, 4) = j                            '|fffd||fffd||fffd||656a|
                mydata(k, 5) = moto(127 + (j - 1) * 2, a)   '|fffd|x|fffd||fffd||fffd||fffd|
                mydata(k, 6) = moto(164 + (j - 1) * 2, a)   '|fffd|x|fffd||fffd||fffd||fffd|
                mydata(k, 7) = moto(201 + (j - 1) * 2, a)   '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                mydata(k, 8) = moto(241 + (j - 1) * 2, a)   '|fffd||409||fffd||6cc||fffd||fffd||fffd|
                mydata(k, 9) = moto(281 + (j - 1) * 2, a)   '|fffd||409||fffd||6cc||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||30b||fffd||fffd|z
                mydata(k, 10) = moto(321 + (j - 1) * 2, a)  '|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd|
                mydata(k, 12) = moto(358 + (j - 1) * 2, a)  '|fffd|Z|fffd|o|fffd||14a|z
                mydata(k, 13) = moto(398 + (j - 1) * 2, a)  '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd|
                mydata(k, 14) = moto(438 + (j - 1) * 2, a)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14a|z
            Next j
            
            For j = 1 To 5                                      '|fffd||717|^
                If Not IsEmpty(moto(227 + (j - 1) * 2, a)) Then     '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                    k = k + 1
                    mydata(k, 1) = i                            'No
                    mydata(k, 2) = moto(45, a)                  '|fffd||fffd||fffd||fffd||fffd||50d||fffd|
                    mydata(k, 3) = moto(36, a)                  '|fffd||fffd||fffd||fffd|
                    mydata(k, 4) = "|fffd||fffd|" & j                     '|fffd||fffd||fffd||656a|
                    mydata(k, 5) = moto(153 + (j - 1) * 2, a)   '|fffd|x|fffd||fffd||fffd||fffd|
                    mydata(k, 6) = moto(190 + (j - 1) * 2, a)   '|fffd|x|fffd||fffd||fffd||fffd|
                    mydata(k, 7) = moto(227 + (j - 1) * 2, a)   '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                    mydata(k, 8) = moto(267 + (j - 1) * 2, a)   '|fffd||409||fffd||6cc||fffd||fffd||fffd|
                    mydata(k, 9) = moto(307 + (j - 1) * 2, a)   '|fffd||409||fffd||6cc||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||30b||fffd||fffd|z
                    mydata(k, 10) = moto(347 + (j - 1) * 2, a)  '|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd|
                    mydata(k, 11) = moto(384 + (j - 1) * 2, a)  '|fffd||717|^|fffd||157||fffd|
                    mydata(k, 12) = moto(385 + (j - 1) * 2, a)  '|fffd|Z|fffd|o|fffd||14a|z
                    mydata(k, 13) = moto(424 + (j - 1) * 2, a)  '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd|
                    mydata(k, 14) = moto(464 + (j - 1) * 2, a)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14a|z
                End If
            Next j
            
            If Not IsEmpty(moto(239, a)) Then                   '|fffd|O|fffd|E|fffd|@|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                k = k + 1
                mydata(k, 1) = i                                'No
                mydata(k, 2) = moto(45, a)                      '|fffd||fffd||fffd||fffd||fffd||50d||fffd|
                mydata(k, 3) = moto(36, a)                      '|fffd||fffd||fffd||fffd|
                mydata(k, 4) = "|fffd|O|fffd|E"                             '|fffd||fffd||fffd||656a|
                mydata(k, 7) = moto(239, a)                     '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                mydata(k, 8) = moto(279, a)                     '|fffd||409||fffd||6cc||fffd||fffd||fffd|
                mydata(k, 12) = moto(396, a)                    '|fffd|Z|fffd|o|fffd||14a|z
            End If
            
        Next i
        
        '|fffd||fffd||fffd|v|fffd||fffd|
        For j = 1 To k
            If (Not IsEmpty(mydata(j, 5))) And (Not IsEmpty(mydata(j, 7))) Then
                m = mydata(j, 5)
                If Left(mydata(j, 4), 1) = "|fffd||fffd|" Then
                    i = m + 17
                ElseIf Left(mydata(j, 4), 1) = "|fffd|O" Then
                    i = 52
                Else
                    i = m
                End If
                
                If IsEmpty(mydata2(i, 1)) Then
                    mydata2(i, 1) = mydata(j, 6)
                ElseIf mydata(j, 6) < mydata2(i, 1) Then
                    mydata2(i, 1) = mydata(j, 6)
                End If
                
                If IsEmpty(mydata2(i, 2)) Then
                    mydata2(i, 2) = mydata(j, 6)
                ElseIf mydata(j, 6) > mydata2(i, 2) Then
                    mydata2(i, 2) = mydata(j, 6)
                End If
                
                mydata2(i, 3) = mydata2(i, 3) + 1                       '|fffd|l|fffd||fffd|
                mydata2(i, 4) = mydata2(i, 4) + mydata(j, 7)            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
                mydata2(i, 5) = mydata2(i, 5) + mydata(j, 8)            '|fffd||409||fffd||6cc||fffd||fffd||fffd|
                mydata2(i, 6) = mydata2(i, 6) + mydata(j, 9)            '|fffd||409||fffd||6cc||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||30b||fffd||fffd|z
                mydata2(i, 7) = mydata2(i, 7) + Val(mydata(j, 12))      '|fffd|Z|fffd|o|fffd||14a|z
                If mydata(j, 13) > 0 Then
                    mydata2(i, 8) = mydata2(i, 8) + 1                   '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd|s|fffd||fffd||fffd|l|fffd||fffd|
                    mydata2(i, 9) = mydata2(i, 9) + mydata(j, 13)       '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd|s|fffd||fffd||fffd|z
                ElseIf mydata(j, 13) < 0 Then
                    mydata2(i, 10) = mydata2(i, 10) + 1                 '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||94b4||fffd||7d0|l|fffd||fffd|
                    mydata2(i, 11) = mydata2(i, 11) + mydata(j, 13)     '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||94b4||fffd||7ca|z
                End If
                mydata2(i, 12) = mydata2(i, 12) + mydata(j, 14)         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14a|z
            End If
        Next j
        
        '1-12|fffd||fffd||fffd||fffd||fffd|v
        For k = 0 To 1
            For j = 1 To 12
                a = k * 17 + j
                If j < 7 Then
                    i = k * 17 + 13
                Else
                    i = k * 17 + 14
                End If
                
                '|fffd||fffd||fffd|^or|fffd||717|^
                If (IsEmpty(mydata2(i, 1))) And (Not IsEmpty(mydata2(a, 1))) Then
                    mydata2(i, 1) = mydata2(a, 1)
                    If IsEmpty(mydata2(k * 17 + 15, 1)) Then mydata2(k * 17 + 15, 1) = mydata2(a, 1)
                End If
                
                If IsEmpty(mydata2(a, 2)) Then
                ElseIf IsEmpty(mydata2(i, 2)) Then
                    mydata2(i, 2) = mydata2(a, 2)
                    mydata2(k * 17 + 15, 2) = mydata2(a, 2)
                ElseIf mydata2(a, 2) > mydata2(i, 2) Then
                    mydata2(i, 2) = mydata2(a, 2)
                    mydata2(k * 17 + 15, 2) = mydata2(a, 2)
                End If
                
                '|fffd||fffd||fffd|^|fffd||717|^|fffd|v
                If IsEmpty(mydata2(a, 1)) Then
                ElseIf IsEmpty(mydata2(j + 34, 1)) Then
                    mydata2(j + 34, 1) = mydata2(a, 1)
                ElseIf mydata2(a, 1) < mydata2(j + 34, 1) Then
                    mydata2(j + 34, 1) = mydata2(a, 1)
                End If
                
                If IsEmpty(mydata2(a, 2)) Then
                ElseIf IsEmpty(mydata2(j + 34, 2)) Then
                    mydata2(j + 34, 2) = mydata2(a, 2)
                ElseIf mydata2(a, 2) > mydata2(j + 34, 2) Then
                    mydata2(j + 34, 2) = mydata2(a, 2)
                End If
                
                If k = 0 Then
                    If j < 7 Then
                        m = 47
                    Else
                        m = 48
                    End If
                    
                    If IsEmpty(mydata2(m, 1)) Then
                        If (Not IsEmpty(mydata2(j, 1))) And (Not IsEmpty(mydata2(j + 17, 1))) Then
                            If mydata2(j, 1) < mydata2(j + 17, 1) Then
                                mydata2(m, 1) = mydata2(j, 1)
                            Else
                                mydata2(m, 1) = mydata2(j + 17, 1)
                            End If
                        ElseIf Not IsEmpty(mydata2(j, 1)) Then
                            mydata2(m, 1) = mydata2(j, 1)
                        ElseIf Not IsEmpty(mydata2(j + 17, 1)) Then
                            mydata2(m, 1) = mydata2(j, 1)
                        End If
                    End If
                    
                    If (Not IsEmpty(mydata2(j, 2))) And (Not IsEmpty(mydata2(j + 17, 2))) Then
                        If mydata2(j, 2) > mydata2(j + 17, 2) Then
                            mydata2(m, 2) = mydata2(j, 2)
                        Else
                            mydata2(m, 2) = mydata2(j + 17, 2)
                        End If
                    ElseIf Not IsEmpty(mydata2(j, 1)) Then
                        mydata2(m, 2) = mydata2(j, 2)
                    ElseIf Not IsEmpty(mydata2(j + 17, 1)) Then
                        mydata2(m, 2) = mydata2(j, 2)
                    End If
                End If
                
                For m = 3 To 12
                    If Not IsEmpty(mydata2(a, m)) Then
                        mydata2(i, m) = mydata2(i, m) + mydata2(a, m)
                        mydata2(k * 17 + 15, m) = mydata2(k * 17 + 15, m) + mydata2(a, m)
                        mydata2(j + 34, m) = mydata2(j + 34, m) + mydata2(a, m)
                        If j < 7 Then
                            mydata2(47, m) = mydata2(47, m) + mydata2(a, m)
                        Else
                            mydata2(48, m) = mydata2(48, m) + mydata2(a, m)
                        End If
                        mydata2(49, m) = mydata2(49, m) + mydata2(a, m)
                    End If
                Next m
            Next j
        Next k
        
        '|fffd||fffd||fffd|^or|fffd||717|^ 1-12|fffd||fffd||fffd||fffd||fffd|v
        If Not IsEmpty(mydata2(47, 1)) Then
            mydata2(49, 1) = mydata2(47, 1)
        ElseIf Not IsEmpty(mydata2(48, 1)) Then
            mydata2(49, 1) = mydata2(47, 1)
        End If
        
        If Not IsEmpty(mydata2(48, 2)) Then
            mydata2(49, 2) = mydata2(48, 2)
        ElseIf Not IsEmpty(mydata2(47, 2)) Then
            mydata2(49, 2) = mydata2(47, 2)
        End If
        If Not IsEmpty(mydata2(48, 2)) Then mydata2(49, 2) = mydata2(48, 2)
    End If
        
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||cbd48||a5d7||fffd|\")
        .Unprotect Password:="s2341"
        .Range("A4:N5000,X5:AI56").ClearContents
        
        If n > 0 Then
            .Range("A4").Resize(b, 14).Value = mydata
            .Range("X5").Resize(52, 12).Value = mydata2
        End If
        .Protect Password:="s2341"
    End With
    
End Sub

Sub jyoukyouitiran_narabikae()
'2009/2/28 Ver.910

    Dim n As Long
    Dim r As Range
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||cbd48||a5d7||fffd|\")
        n = .Cells(.Rows.Count, 1).End(xlUp).Row
        
        If n > 2 Then
            If ActiveSheet.Shapes(Application.Caller).BottomRightCell.Column = 4 Then
                Set r = ActiveSheet.Range("D4")
            Else
                Set r = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Offset(2)
            End If
            
            .Unprotect Password:="s2341"
            
            .Range("A4:N4").Resize(n - 3).Sort _
                Key1:=r, Order1:=xlAscending, Header:=xlNo, _
                OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                SortMethod:=xlPinYin
                
            .Protect Password:="s2341"
            
            Set r = Nothing
            
        End If
    End With
    
End Sub

Attribute VB_Name = "jyoukyou2"
Option Explicit
Option Private Module

Sub nenmatuitiranhyou()
    Worksheets("|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5d7||fffd|\").Select
    
    nenmatuitiran_syuukei
    
    Range("G4").Select
End Sub

Sub nenmatu_jyoukyoutyouhe()
'2009/3/1 Ver.910

    nenmatuitiran_clear
    
    Worksheets("|fffd||cbd52||fffd|").Select
End Sub

Sub nenmatuitiran_clear()
'2009/3/1 Ver.910
'2009/11/28 Ver.920|fffd|@|fffd|E|fffd|v|fffd||fffd||fffd||1c9||fffd|
'2013/1/9 Ver.1300

    With Worksheets("|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5d7||fffd|\")
        If Not IsEmpty(.Range("H1").Value) Then
            .Unprotect Password:="s2341"
            .Range("H1:IV83").ClearContents
            .Protect Password:="s2341"
        End If
    End With
End Sub

Sub nenmatuitiran_syuukei()
'2009/3/1 Ver.910
'2009/11/28 Ver.920|fffd|@|fffd|E|fffd|v|fffd||fffd||fffd||1c9||fffd|
'2011/8/21 Ver.1110|fffd|@|fffd|E|fffd|v|fffd||fffd||fffd||1c9||fffd|
'2012/11/12 Ver.1210
'2013/1/9 Ver.1300
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610    |fffd||fffd||6d0||142||182||202||fffd||28b||38e||84d6||fffd||fffd||fffd||1c9||fffd| 18|fffd|s|fffd||691||fffd|
'2016/12/22 Ver.1625
'2017/11/30 Ver.1800

    Dim i As Long, j As Long, k As Long, n As Long, m As Long
    Dim mydata() As Variant
    Dim moto As Variant, c As Variant
    
    n = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value    '|fffd|o|fffd|^|fffd||fffd|
    
    If n > 0 Then
        ReDim mydata(1 To 91, 1 To n)
        With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            m = .Range("D24").Value
            c = .Range("G31:G260").Value                '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
            moto = .Range("S1").Resize(514, m - 18).Value
        End With
        
        For i = 1 To n
            k = c(i, 1)                         '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
            
            mydata(1, i) = i                'No
            mydata(2, i) = moto(45, k)      '|fffd||fffd||fffd||fffd||fffd||50d||fffd|
            mydata(3, i) = moto(36, k)      '|fffd||fffd||fffd||fffd|
            mydata(4, i) = moto(239, k)     '|fffd|O|fffd|E|fffd||fffd| |fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|z
            mydata(5, i) = moto(279, k)     '|fffd|O|fffd|E|fffd||fffd| |fffd||409||fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd|z
            mydata(6, i) = moto(396, k)     '|fffd|O|fffd|E|fffd||fffd| |fffd|Z|fffd|o|fffd||14a|z
            mydata(7, i) = moto(478, k)     '|fffd||fffd||fffd||fffd||fffd|E|fffd||84d6||fffd||fffd||fffd|@|fffd||fffd||fffd|z
            mydata(8, i) = moto(492, k)     '|fffd||fffd||fffd||fffd||fffd|E|fffd||84d6||fffd||fffd||fffd|@|fffd||14a|z
            mydata(9, i) = moto(479, k)     '|fffd||717|^|fffd||fffd||fffd|@|fffd||fffd||fffd|z
            mydata(10, i) = moto(493, k)    '|fffd||717|^|fffd||fffd||fffd|@|fffd||14a|z
            mydata(11, i) = moto(480, k)    '|fffd|v|fffd|@|fffd||fffd||fffd|z
            mydata(12, i) = moto(494, k)    '|fffd|v|fffd|@|fffd||14a|z
            mydata(13, i) = moto(481, k)    '|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||30b||fffd||fffd|^|fffd||fffd||fffd||30b||fffd||fffd|z
            
            mydata(14, i) = moto(497, k)    '|fffd|z|fffd||fffd||482||30d||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
'            mydata(15, i) = moto(497, k)    '|fffd||90|l|fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|z
            mydata(15, i) = moto(498, k)    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||6cc||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|z
            mydata(16, i) = moto(499, k)    '(10)|fffd||302||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd||34a||fffd||18b||fffd||fffd||3d3||fffd||fffd|||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(17, i) = moto(500, k)    '(11)|fffd||302||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(18, i) = moto(514, k)    '|fffd||fffd||6d0||142||182||202||fffd||28b||38e||84d6|
            
            mydata(19, i) = moto(482, k)    '|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd||fffd|
            mydata(20, i) = moto(483, k)    '|fffd|\|fffd||fffd||fffd||242||fffd||fffd||409||fffd||6cc||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd||fffd|
            mydata(21, i) = moto(484, k)    '|fffd|\|fffd||fffd||fffd||242||fffd||93ec||fffd|K|fffd||34a||fffd||18b||fffd||fffd||3d3||fffd||fffd|||fffd||fffd||fffd||30d|T|fffd||fffd||fffd||fffd|
            mydata(22, i) = moto(485, k)    '|fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd|z
            mydata(23, i) = moto(486, k)    '|fffd|n|fffd|k|fffd||6cc||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd|z
            mydata(24, i) = moto(487, k)    '|fffd|z|fffd||fffd||493||fffd||fffd||28d|T|fffd||fffd||fffd|z
            mydata(25, i) = moto(488, k)    '|fffd|T|fffd||fffd||fffd|z|fffd||30d||fffd||fffd|v|fffd|z
            mydata(26, i) = moto(489, k)    '|fffd||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd|z|fffd||30d||fffd||fffd|v|fffd|z
            mydata(27, i) = moto(490, k)    '|fffd||fffd||fffd||fffd||fffd||6d0||14b||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            
            mydata(28, i) = moto(501, k)    '|fffd|Z|fffd|o|fffd|N|fffd||14a|z
            mydata(29, i) = moto(502, k)    '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd|z
            mydata(30, i) = moto(503, k)    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||14a|z
            mydata(31, i) = moto(504, k)    '|fffd|N|fffd||fffd||fffd|N|fffd||14a|z
            If moto(504, k) < 0 Then
                mydata(32, i) = moto(505, k)    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7ca|z
            Else
                mydata(33, i) = moto(505, k)    '|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|z
            End If
            mydata(34, i) = moto(506, k)    '|fffd|{|fffd|N|fffd||14c||fffd||30b||fffd||fffd|^|fffd||fffd||fffd||74a5||fffd||fffd||fffd||fffd||fffd||fffd||14a|z|fffd||24f|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(35, i) = moto(507, k)    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd||24c|W|fffd||95a2||fffd||fffd||fffd||fffd||fffd||310||14a|z|fffd||24f|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(36, i) = moto(508, k)    '|fffd||fffd||fffd||fffd||fffd||482||fffd||fffd||fffd||fffd||fffd|z
            mydata(37, i) = moto(509, k)    '|fffd|{|fffd|N|fffd||fffd||fffd||24a||495|t|fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(38, i) = moto(510, k)    '|fffd||fffd||fffd|N|fffd||242||fffd||fffd||fffd||fffd||10a||495|t|fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(39, i) = moto(511, k)    '|fffd|{|fffd|N|fffd||14c||fffd||30b||fffd||fffd|^|fffd||fffd||fffd||74a5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(40, i) = moto(512, k)    '|fffd||fffd||fffd|N|fffd||24c|J|fffd||fffd|z|fffd||fffd||fffd||112||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            mydata(41, i) = moto(513, k)    '(26)|fffd||302||fffd||fffd||fffd||fffd|A|fffd|{|fffd|l|fffd||fffd||fffd|^|fffd||316||fffd||fffd|[|fffd|t|fffd||fffd||fffd||9294e||fffd||fffd||14a|z|fffd||20a|O|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
            
            For j = 43 To 72
                mydata(j, i) = moto(j + 35, k)  '|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd||fffd||fffd||310|\|fffd||fffd||fffd|i|fffd|N|fffd||fffd||fffd||fffd||fffd|j
            Next j
            mydata(73, i) = 380000          '|fffd||fffd|b|fffd|T|fffd||fffd||fffd|z
            
            mydata(74, i) = moto(49, k)     '|fffd||4b3cf|Z|fffd||482||142||fffd||fffd||fffd|e|fffd||fffd||fffd||310||fffd|
            mydata(75, i) = moto(59, k)     '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd|K|fffd|p|fffd||fffd|
            mydata(76, i) = moto(60, k)     '|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|i1|fffd||fffd||681|j
            mydata(77, i) = moto(61, k)     '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd||656a|(1|fffd||fffd||fffd|)
            mydata(78, i) = moto(62, k)     '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|c|fffd||fffd|(1|fffd||fffd||fffd|)
            mydata(79, i) = moto(63, k)    '|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|i2|fffd||fffd||681|j
            mydata(80, i) = moto(64, k)    '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd||656a|(2|fffd||fffd||fffd|)
            mydata(81, i) = moto(65, k)    '|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|c|fffd||fffd|(2|fffd||fffd||fffd|)
            mydata(82, i) = moto(69, k)    '|fffd|E|fffd|v|fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||9396||fffd||fffd|(1)|fffd|@|fffd|Z|fffd||fffd||fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd|
            mydata(83, i) = moto(70, k)    '|fffd|E|fffd|v|fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||9396||fffd||fffd|(2)
            mydata(84, i) = moto(69, k)    '|fffd|E|fffd|v|fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||9396||fffd||fffd|(3)
            mydata(85, i) = moto(70, k)    '|fffd|E|fffd|v|fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||9396||fffd||fffd|(4)
            mydata(86, i) = moto(74, k)    '|fffd||fffd||fffd|^|fffd||fffd||fffd||30e||fffd||fffd|
            mydata(87, i) = moto(52, k)    '|fffd|V|fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(88, i) = moto(53, k)    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(89, i) = moto(54, k)    '|fffd||fffd||fffd||fffd||d5||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(90, i) = moto(55, k)    '|fffd|V|fffd||90|l|fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            mydata(91, i) = moto(56, k)    '|fffd||fffd||fffd||90|l|fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z
            
            
        Next i
    End If
    
    With Worksheets("|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5d7||fffd|\")
        .Unprotect Password:="s2341"
        .Range("H1:IV91").ClearContents
        If n > 0 Then .Range("H1").Resize(91, n).Value = mydata
        .Protect Password:="s2341"
    End With
End Sub


Attribute VB_Name = "list_nyuuryoku"
Option Explicit
Option Private Module

Public myflgnyuutouroku As Boolean
Private myflgtou As Boolean

Sub nyuu_risutonyuuryokuhe()
'2007/1/26 Ver.710

    Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Select
    
    myflgtou = True
    
    risutonyuuryoku_sumihyouji
    
    myflgtou = False
    
End Sub

Sub risutonyuuryoku_nyuuhe()
'2007/1/26 Ver.710

    If Not IsEmpty(Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Range("A3").Value) Then
    
        risutohyouji_clear
    
    End If
    
    Worksheets("|fffd||fffd||fffd||fffd|").Select
End Sub

Sub risutohyouji_clear()
'2007/3/31 Ver.711

    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        .Range("A3:O65536").ClearContents
        .Range("AA3:AO65536").ClearContents
        .Range("BA3:BO65536").ClearContents
        .Protect Password:="s2341"
    End With
End Sub

Sub risutonyuuryoku_maehyouji()
'2007/3/31 Ver.711

    Dim n As Long
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        n = .Cells(.Rows.Count, 4).End(xlUp).Row - 2
        If n > 0 Then
            .Unprotect Password:="s2341"
            .Range("A3").Resize(n, 8).Value = .Range("BA3").Resize(n, 8).Value
            .Range("J3").Resize(n, 4).Value = .Range("BJ3").Resize(n, 4).Value
            .Protect Password:="s2341"
            
            risutonyuuryoku_kakunin
            
        End If
    End With
    
End Sub

Sub risutonyuuryoku_sumihyouji()
'2007/3/31 Ver.711
'2008/7/7 Ver.801

    Dim i As Long, j As Long, k As Long, n As Long, a As Long, b As Long
    Dim mydata() As Variant
    
    n = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value               '|fffd|o|fffd|^|fffd||fffd|
    
    If n > 0 Then
        b = n * 17
        ReDim mydata(1 To b, 1 To 13)
        k = 0
        
        For i = 1 To n
            With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                a = .Cells(i + 30, 7).Value + 18    '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
                
                For j = 1 To 12
                    k = k + 1
                    mydata(k, 1) = k
                    mydata(k, 2) = j
                    mydata(k, 3) = .Cells(45, a).Value
                    mydata(k, 4) = .Cells(36, a).Value
                    mydata(k, 5) = .Cells(127 + (j - 1) * 2, a).Value
                    mydata(k, 6) = .Cells(164 + (j - 1) * 2, a).Value
                    mydata(k, 7) = .Cells(201 + (j - 1) * 2, a).Value
                    mydata(k, 8) = .Cells(241 + (j - 1) * 2, a).Value
                    mydata(k, 10) = .Cells(321 + (j - 1) * 2, a).Value
                    mydata(k, 11) = .Cells(358 + (j - 1) * 2, a).Value
                    mydata(k, 13) = .Cells(398 + (j - 1) * 2, a).Value
                Next j
                
                For j = 1 To 5
                    k = k + 1
                    mydata(k, 1) = k
                    mydata(k, 2) = "|fffd||717|^" & j
                    mydata(k, 3) = .Cells(45, a).Value
                    mydata(k, 4) = .Cells(36, a).Value
                    mydata(k, 5) = .Cells(153 + (j - 1) * 2, a).Value
                    mydata(k, 6) = .Cells(190 + (j - 1) * 2, a).Value
                    mydata(k, 7) = .Cells(227 + (j - 1) * 2, a).Value
                    mydata(k, 8) = .Cells(267 + (j - 1) * 2, a).Value
                    mydata(k, 10) = .Cells(347 + (j - 1) * 2, a).Value
                    mydata(k, 11) = .Cells(385 + (j - 1) * 2, a).Value
                    mydata(k, 12) = .Cells(384 + (j - 1) * 2, a).Value
                    mydata(k, 13) = .Cells(424 + (j - 1) * 2, a).Value
                Next j
            End With
        Next i
    End If
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        .Range("A3:O65536").ClearContents
        .Range("AA3:AO65536").ClearContents
        
        If myflgtou Then .Range("BA3:BO65536").ClearContents
        
        If n > 0 Then
            .Range("A3").Resize(b, 13).Value = mydata
            .Range("I3").Resize(b).Formula = "=IF(G3="""","""",G3-H3)"
            .Range("N3").Resize(b).Formula = "=IF(G3="""","""",K3+M3)"      '2008/7/7 Ver.801
            If myflgtou Then .Range("BA3").Resize(b, 13).Value = mydata
        End If
        .Protect Password:="s2341"
    End With
    
End Sub

Sub risutonyuuryoku_touroku()
'2007/3/31 Ver.711
'2009/11/22 Ver.911

    Dim i As Long, j As Long, k As Long, n As Long, a As Long, b As Long
    Dim mydata As Variant
    Dim mych As Variant
    Dim Dict As Object
    Dim dictkey As Variant
    
    If TypeName(Selection) <> "Range" Then Exit Sub
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        n = .Cells(.Rows.Count, 4).End(xlUp).Row - 2
    End With
    
    If n > 0 Then
        
        risutonyuuryoku_kakunin
        
        If Application.WorksheetFunction.CountIf(Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Range("AE3:AL65536"), 1) > 0 Then
            If MsgBox("|fffd|C|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|o|fffd|^|fffd|m|fffd|F") = vbNo Then
                Exit Sub
            End If
        ElseIf Application.WorksheetFunction.CountIf(Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Range("AE3:AL65536"), 2) > 0 Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd|v|fffd|Z|fffd||250||752||80b3||fffd||fffd||102||fffd||fffd||702||fffd||fffd||302||141|A|fffd||3cd|X|fffd||4cf||fffd||fffd||fffd|o|fffd|^|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B", vbOKOnly, "|fffd|m|fffd|F"
            Exit Sub
        Else
            MsgBox "|fffd||3cd|X|fffd||4cf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B", vbOKOnly, "|fffd|m|fffd|F"
            Exit Sub
        End If
        
        With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
            mydata = .Range("B3").Resize(n, 11).Value
            mych = .Range("AE3").Resize(n, 8).Value
        End With
        
        Application.ScreenUpdating = False
        
        With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            .Unprotect Password:="s2341"
            
            For i = 1 To n
                b = Application.WorksheetFunction.Match(mydata(i, 3), .Range("D31:D260"), 0)
                a = .Cells(b + 30, 7).Value + 18                                            '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
                
                If Val(mydata(i, 1)) <> 0 Then
                    j = (mydata(i, 1) - 1) * 2
                    
                    If mych(i, 1) = 1 Then .Cells(127 + j, a).Value = mydata(i, 4)          '|fffd||fffd|
                    If mych(i, 2) = 1 Then .Cells(164 + j, a).Value = mydata(i, 5)          '|fffd||fffd|
                    If mych(i, 3) = 1 Then .Cells(201 + j, a).Value = mydata(i, 6)          '|fffd|x|fffd||fffd||fffd|z
                    If mych(i, 4) = 1 Then .Cells(241 + j, a).Value = mydata(i, 7)          '|fffd||409||fffd||6cc||fffd|
                    If mych(i, 6) = 1 Then .Cells(321 + j, a).Value = mydata(i, 9)          '|fffd|}|fffd|{
                    
                    If mych(i, 7) = 1 Then
                        If .Cells(525, a).Value Then
                            .Cells(358 + j, a).Value = mydata(i, 10)                         '|fffd||14a|z
                        End If
                    End If
                    
'                    mych(i, 8) = True
                Else
                    j = (Val(Right(mydata(i, 1), 1)) - 1) * 2
                    
                    If mych(i, 1) = 1 Then
                        .Cells(116 + j, a).Value = mydata(i, 4)                             '|fffd||fffd||fffd||656a|
                        .Cells(153 + j, a).Value = mydata(i, 4)                             '|fffd||fffd|
                    End If
                    If mych(i, 2) = 1 Then .Cells(190 + j, a).Value = mydata(i, 5)          '|fffd||fffd|
                    If mych(i, 3) = 1 Then .Cells(227 + j, a).Value = mydata(i, 6)          '|fffd|x|fffd||fffd||fffd|z
                    If mych(i, 4) = 1 Then .Cells(267 + j, a).Value = mydata(i, 7)          '|fffd||409||fffd||6cc||fffd|
                    If mych(i, 6) = 1 Then .Cells(347 + j, a).Value = mydata(i, 9)          '|fffd|}|fffd|{
                    
                    
                    If mych(i, 7) = 1 Then
                        If .Cells(525, a).Value Then
                            .Cells(385 + j, a).Value = mydata(i, 10)                         '|fffd||14a|z
                        End If
                    End If
                        
                    If mych(i, 8) = 1 Then
                        If .Cells(525, a).Value Then
                            .Cells(384 + j, a).Value = mydata(i, 11)                        '|fffd||157||fffd|
                        End If
                    End If
                End If
            Next i
            
            .Protect Password:="s2341"
            .Activate
        End With
        
        Set Dict = CreateObject("Scripting.Dictionary")
        
        On Error Resume Next
        For i = 1 To n
            For j = 1 To 8
'                If j <> 2 Then
                    If mych(i, j) = 1 Then
                        Dict.Add mydata(i, 3), Empty
                    End If
'                End If
            Next j
        Next i
        On Error GoTo 0
        
        If Dict.Count > 0 Then
            dictkey = Dict.keys
            
'            Application.ScreenUpdating = False
            Worksheets("|fffd||fffd||fffd||fffd|").Select
            
            myflgnyuutouroku = True
            For i = 0 To Dict.Count - 1
                With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                    .Range("D13").Value = Application.WorksheetFunction.Match(dictkey(i), .Range("D31:D260"), 0)
                End With
                
                hyouji2n
                touroku2n
                
            Next i
            myflgnyuutouroku = False
            
            Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Select
            
             risutonyuuryoku_kakunin
            
'            Application.ScreenUpdating = True
        End If
        
        Application.ScreenUpdating = True
        Set Dict = Nothing
    End If
    
End Sub

Sub risutonyuuryoku_kakunin()
'2007/3/31 Ver.711

    Dim i As Long, j As Long, k As Long, n As Long, a As Long, b As Long
    Dim mydata As Variant
    Dim mych() As Variant
    Dim myerr() As Variant
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        n = .Cells(.Rows.Count, 4).End(xlUp).Row - 2
    End With
    
    If n > 0 Then
        
        mydata = Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|").Range("B3").Resize(n, 11).Value
        
        ReDim mych(1 To n, 1 To 8)
        ReDim myerr(1 To n, 1 To 1)
        
        For i = 1 To n
            With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                b = Application.WorksheetFunction.Match(mydata(i, 3), .Range("D31:D260"), 0)
                a = .Cells(b + 30, 7).Value + 18                                        '|fffd|o|fffd|^|fffd||fffd||292|u|fffd||50d||fffd|
                
                If Val(mydata(i, 1)) <> 0 Then
                    j = (mydata(i, 1) - 1) * 2
                    
                    If IsEmpty(.Cells(127 + j, a).Value) = IsEmpty(mydata(i, 4)) Then
                        mych(i, 1) = (.Cells(127 + j, a).Value = mydata(i, 4))          '|fffd||fffd|
                    Else
                        mych(i, 1) = False
                    End If
                    
                    If IsEmpty(.Cells(164 + j, a).Value) = IsEmpty(mydata(i, 5)) Then
                        mych(i, 2) = (.Cells(164 + j, a).Value = mydata(i, 5))          '|fffd||fffd|
                    Else
                        mych(i, 2) = False
                    End If
                    
                    If IsEmpty(.Cells(201 + j, a).Value) = IsEmpty(mydata(i, 6)) Then
                        mych(i, 3) = (.Cells(201 + j, a).Value = mydata(i, 6))          '|fffd|x|fffd||fffd||fffd|z
                    Else
                        mych(i, 3) = False
                    End If
                    
                    If IsEmpty(.Cells(241 + j, a).Value) = IsEmpty(mydata(i, 7)) Then
                        mych(i, 4) = (.Cells(241 + j, a).Value = mydata(i, 7))          '|fffd||409||fffd||6cc||fffd|
                    Else
                        mych(i, 4) = False
                    End If
                    
                    If IsEmpty(.Cells(281 + j, a).Value) = (mydata(i, 8) = "") Then
                        mych(i, 5) = (.Cells(281 + j, a).Value = mydata(i, 8))          '|fffd||409||fffd||6cc||fffd||fffd|T|fffd||fffd||fffd||fffd|
                    Else
                        mych(i, 5) = False
                    End If
                    
                    If IsEmpty(.Cells(321 + j, a).Value) = IsEmpty(mydata(i, 9)) Then
                        mych(i, 6) = (.Cells(321 + j, a).Value = mydata(i, 9))          '|fffd|}|fffd|{
                    Else
                        mych(i, 6) = False
                    End If
                    
                    If IsEmpty(.Cells(358 + j, a).Value) = IsEmpty(mydata(i, 10)) Then
                        mych(i, 7) = (.Cells(358 + j, a).Value = mydata(i, 10))          '|fffd||14a|z
                    Else
                        mych(i, 7) = False
                    End If
                    
                    mych(i, 8) = True
                    
                Else
                    j = (Val(Right(mydata(i, 1), 1)) - 1) * 2
                    
                    If IsEmpty(.Cells(153 + j, a).Value) = IsEmpty(mydata(i, 4)) Then
                        mych(i, 1) = (.Cells(153 + j, a).Value = mydata(i, 4))          '|fffd||fffd|
                    Else
                        mych(i, 1) = False
                    End If
                    
                    If IsEmpty(.Cells(190 + j, a).Value) = IsEmpty(mydata(i, 5)) Then
                        mych(i, 2) = (.Cells(190 + j, a).Value = mydata(i, 5))          '|fffd||fffd|
                    Else
                        mych(i, 2) = False
                    End If
                    
                    If IsEmpty(.Cells(227 + j, a).Value) = IsEmpty(mydata(i, 6)) Then
                        mych(i, 3) = (.Cells(227 + j, a).Value = mydata(i, 6))          '|fffd|x|fffd||fffd||fffd|z
                    Else
                        mych(i, 3) = False
                    End If
                    
                    If IsEmpty(.Cells(267 + j, a).Value) = IsEmpty(mydata(i, 7)) Then
                        mych(i, 4) = (.Cells(267 + j, a).Value = mydata(i, 7))          '|fffd||409||fffd||6cc||fffd|
                    Else
                        mych(i, 4) = False
                    End If
                    
                    If IsEmpty(.Cells(307 + j, a).Value) = (mydata(i, 8) = "") Then
                        mych(i, 5) = (.Cells(307 + j, a).Value = mydata(i, 8))          '|fffd||409||fffd||6cc||fffd||fffd|T|fffd||fffd||fffd||fffd|
                    Else
                        mych(i, 5) = False
                    End If
                    
                    
                    If IsEmpty(.Cells(347 + j, a).Value) = IsEmpty(mydata(i, 9)) Then
                        mych(i, 6) = (.Cells(347 + j, a).Value = mydata(i, 9))          '|fffd|}|fffd|{
                    Else
                        mych(i, 6) = False
                    End If
                    
                    If IsEmpty(.Cells(385 + j, a).Value) = IsEmpty(mydata(i, 10)) Then
                        mych(i, 7) = (.Cells(385 + j, a).Value = mydata(i, 10))          '|fffd||14a|z
                    Else
                        mych(i, 7) = False
                    End If
                    
                    If IsEmpty(.Cells(384 + j, a).Value) = IsEmpty(mydata(i, 11)) Then
                        mych(i, 8) = (.Cells(384 + j, a).Value = mydata(i, 11))         '|fffd||157||fffd|
                    Else
                        mych(i, 8) = False
                    End If
                    
                End If
            End With
            
            For k = 1 To 8
                If mych(i, k) Then
                    mych(i, k) = Empty
                Else
                    mych(i, k) = 1
                End If
            Next k
            
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(525, a).Value = False Then
                If mych(i, 7) = 1 Then
                    myerr(i, 1) = "|fffd||14a|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||755|s|fffd||81|A"
                    mych(i, 7) = 2
                End If
                If mych(i, 8) = 1 Then
                    myerr(i, 1) = myerr(i, 1) & "|fffd||157||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||755|s|fffd||fffd|"
                    mych(i, 8) = 2
                End If
            End If
                    
        Next i
    End If
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        .Range("O3:O65536").ClearContents
        .Range("AA3:AO65536").ClearContents
        If n > 0 Then
            .Range("O3").Resize(n).Value = myerr
            .Range("AE3").Resize(n, 8).Value = mych
        End If
        .Protect Password:="s2341"
    End With
        
End Sub

Sub risutonyuuryoku_narabikae()
'2007/3/31 Ver.711

    Dim n As Long
    Dim r As Range
    
    With Worksheets("|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|")
        n = .Cells(.Rows.Count, 4).End(xlUp).Row - 2
        
        If n > 0 Then
            Set r = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Offset(1)
            
            .Unprotect Password:="s2341"
            
            .Range("A2:AO2").Resize(n + 1).Sort _
                Key1:=r, Order1:=xlAscending, Header:=xlYes, _
                OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
                SortMethod:=xlPinYin
                
            .Protect Password:="s2341"
            
            Set r = Nothing
            
        End If
    End With
    
End Sub
Attribute VB_Name = "nyuu_1"
Option Explicit
Option Private Module

Sub koujyokeisan2n()
 '2003/5/8
 '2007/1/11 Ver.700
 '2017/11/26 Ver.1800
    
    With Worksheets("|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        If .Range("F105").Value = False Then
            With .Range("J72")
                .Formula = "=IF(AND(F9=""|fffd||fffd||fffd||fffd|i|fffd|b|fffd||fffd||fffd|j"",F59=""|fffd||fffd||fffd||fffd|""),|fffd|}|fffd|{|fffd|T|fffd||fffd|!AI55,"""")"
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
        Else
            With .Range("J72")
                .Value = .Value
                .Interior.ColorIndex = 35
                .Locked = False
                .FormulaHidden = False
            End With
        End If
        .Protect Password:="s2341"
    End With
End Sub

Sub zeigakukeisan2n()
'2003/5/22
'2009/11/22 Ver.911

'    Application.ScreenUpdating = False
    With Worksheets("|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        If .Range("F106").Value = False Then
            .Range("J30:J41") = .Range("V30:V41").Formula
            With .Range("J30:J53")
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
            .Range("J44:J53") = .Range("V44:V53").Formula
    
        Else
            With .Range("J30:J41")
                .Value = .Value
                .Interior.ColorIndex = 35
                .Locked = False
                .FormulaHidden = False
            End With
            With .Range("J44:J53")
                .Value = .Value
                .Interior.ColorIndex = 35
                .Locked = False
                .FormulaHidden = False
            End With
        End If
        .Protect Password:="s2341"
    End With
'    Application.ScreenUpdating = True
End Sub

Sub tyokukinyuu2n()
    '2003/5/8
    '2007/1/11 Ver.700
    '2013/1/9 Ver.1300
    
    With Worksheets("|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        If .Range("F109").Value = False Then
            With .Range("J80,J83,J85")
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
            .Range("J80:J85") = .Range("V80:V85").Formula
        Else
            If .Range("F107").Value = True Then
                With .Range("J80")
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                End With
                .Range("J80") = .Range("V80").Formula
            Else
                With .Range("J80")
                    .Interior.ColorIndex = 36
                    .Locked = False
                    .FormulaHidden = False
                    .Value = .Value
                End With
            End If
            
            If .Range("F108").Value = True Then
                With .Range("J83")
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                End With
                .Range("J83") = .Range("V83").Formula
            Else
                With .Range("J83")
                    .Interior.ColorIndex = 36
                    .Locked = False
                    .FormulaHidden = False
                    .Value = .Value
                End With
            End If
            
            With .Range("J85")
                .Interior.ColorIndex = 36
                .Locked = False
                .FormulaHidden = False
                .Value = .Value
            End With
        End If
        .Protect Password:="s2341"
    End With
End Sub

Sub jyuutou2n()
    '2003/5/8
    '2007/1/11 Ver.700
    '2013/1/9 Ver.1300
    
    With Worksheets("|fffd||fffd||fffd||fffd|")
        If .Range("F109").Value = True Then
            .Unprotect Password:="s2341"
            If .Range("F107").Value = True Then
                With .Range("J80")
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                End With
                .Range("J80") = .Range("V80").Formula
            Else
                With .Range("J80")
                    .Interior.ColorIndex = 36
                    .Locked = False
                    .FormulaHidden = False
                    .Value = .Value
                End With
            End If
            .Protect Password:="s2341"
        End If
    End With
End Sub

Sub honnenkanpu2n()
    '2003/5/8
    '2007/1/11 Ver.700
    '2013/1/9 Ver.1300
    
    With Worksheets("|fffd||fffd||fffd||fffd|")
        If .Range("F109").Value = True Then
            .Unprotect Password:="s2341"
            If .Range("F108").Value = True Then
                With .Range("J83")
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                End With
                .Range("J83") = .Range("V83").Formula
            Else
                With .Range("J83")
                    .Interior.ColorIndex = 36
                    .Locked = False
                    .FormulaHidden = False
                    .Value = .Value
                End With
            End If
            .Protect Password:="s2341"
        End If
    End With
End Sub
Attribute VB_Name = "nyuu_hyouji"
Option Explicit
Option Private Module

Sub hyouji2n()
'2013/1/9 Ver.1300
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610   |fffd||fffd||6d0||142||182||202||fffd||28b||38e||84d6||fffd||fffd||fffd||1c9||fffd||fffd|@|fffd||fffd|
'2017/11/30 Ver.1800
'2018/1/12 Ver.1801


    Dim myshdt As Worksheet, myshdf As Worksheet
    Dim i As Long, a As Long, b As Long
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Set myshdt = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
    Set myshdf = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
    
    If myshdt.Range("D13").Value <= myshdt.Range("D25").Value Then
        a = myshdt.Range("D18").Value + 18
        b = myshdt.Range("D18").Value + 1
    
        With Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|")
            .Unprotect Password:="s2341"
            .Range("C11").Value = myshdf.Cells(b * 10 + 2, 3).Value
            .Range("D9:AE18").Value = myshdf.Cells(b * 10, 4).Resize(10, 28).Value
            .Range("AI9:AI13").Value = myshdf.Cells(b * 10, 35).Resize(5).Value
            .Range("AK13:AO18").Value = myshdf.Cells(b * 10 + 4, 37).Resize(6, 5).Value
            .Range("AQ9:AS17").Value = myshdf.Cells(b * 10, 43).Resize(9, 3).Value
            .Range("AH33:AH38").Value = myshdt.Cells(87, a).Resize(6).Value
            .Range("AH42").Value = myshdt.Cells(96, a).Value
            .Range("AH50").Value = myshdt.Cells(104, a).Value
            
            .Range("N23").Value = myshdt.Cells(49, a).Value
            .Range("N26:N30").Value = myshdt.Cells(52, a).Resize(5).Value
            .Range("N33:N39").Value = myshdt.Cells(59, a).Resize(7).Value
            .Range("B45:B48").Value = myshdt.Cells(69, a).Resize(4).Value
            .Range("N51").Value = myshdt.Cells(74, a).Value
            .Protect Password:="s2341"
            .Activate
        End With
    
        With Worksheets("|fffd||fffd||fffd||fffd|")
            .Unprotect Password:="s2341"
            Application.Calculation = xlManual
            .Range("F9").Value = myshdt.Cells(30, a).Value
            .Range("H11").Value = myshdt.Cells(46, a).Value       'Ver.910|fffd||1c9||fffd|
            .Range("F59").Value = myshdt.Cells(31, a).Value
            .Range("F27").Value = myshdt.Cells(32, a).Value
            .Range("F11:F14").Value = myshdt.Cells(41, a).Resize(4).Value
            .Range("F15").Value = myshdt.Cells(39, a).Value
            .Range("F16").Value = myshdt.Cells(40, a).Value
            .Range("F17").Value = myshdt.Cells(37, a).Value
            .Range("F18").Value = myshdt.Cells(36, a).Value
            .Range("F19").Value2 = myshdt.Cells(38, a).Value2
            .Range("F20").Value = myshdt.Cells(45, a).Value
            .Range("F22").Value = myshdt.Cells(111, a).Value
            .Range("G22").Value = myshdt.Cells(112, a).Value
            .Range("F24").Value = myshdt.Cells(113, a).Value
            .Range("F25").Value = myshdt.Cells(114, a).Value
            
            .Range("H59").Value = myshdt.Cells(35, a).Value
            
            For i = 0 To 11
                .Cells(30 + i, 4).Value = myshdt.Cells(127 + i * 2, a).Value
                .Cells(30 + i, 5).Value = myshdt.Cells(164 + i * 2, a).Value
                .Cells(30 + i, 6).Value = myshdt.Cells(201 + i * 2, a).Value
                .Cells(30 + i, 7).Value = myshdt.Cells(241 + i * 2, a).Value
                .Cells(30 + i, 9).Value = myshdt.Cells(321 + i * 2, a).Value
            Next i
    
            .Range("C44:C53").Value = myshdt.Cells(116, a).Resize(10).Value
            .Range("D44:D53").Value = myshdt.Cells(153, a).Resize(10).Value
            .Range("E44:E53").Value = myshdt.Cells(190, a).Resize(10).Value
            .Range("F44:F53").Value = myshdt.Cells(227, a).Resize(10).Value
            .Range("F56").Value = myshdt.Cells(239, a).Value
            .Range("G44:G53").Value = myshdt.Cells(267, a).Resize(10).Value
            .Range("G56").Value = myshdt.Cells(279, a).Value
            .Range("H56").Value = myshdt.Cells(319, a).Value
            .Range("I44:I53").Value = myshdt.Cells(347, a).Resize(10).Value
    
            If myshdt.Cells(525, a).Value = True Then
                For i = 0 To 11
                    .Cells(30 + i, 10).Value = myshdt.Cells(358 + i * 2, a).Value
                Next i
                .Range("J44:J53").Value = myshdt.Cells(384, a).Resize(10).Value
            End If
    
            .Range("J56").Value = myshdt.Cells(396, a).Value
    
            .Range("J67:J71").Value = myshdt.Cells(483, a).Resize(5).Value      'Ver.1801
            
            If myshdt.Cells(524, a).Value = True Then
                .Range("J72").Value = myshdt.Cells(488, a).Value
            End If
            .Range("L66:L69").Value = myshdt.Cells(497, a).Resize(4).Value
            .Range("L70").Value = myshdt.Cells(514, a).Value                'Ver.1610|fffd||1c9||fffd|
            
            .Range("J76").Value = myshdt.Cells(502, a).Value
            .Range("J81").Value = myshdt.Cells(507, a).Value
            .Range("F103:F104").Value = myshdt.Cells(522, a).Resize(2).Value
            .Range("F107:F109").Value = myshdt.Cells(526, a).Resize(3).Value
    
            Application.Calculation = xlAutomatic
            .Activate
    
            If .Range("F105").Value <> myshdt.Cells(524, a).Value Then
                .Range("F105").Value = myshdt.Cells(524, a).Value
                koujyokeisan2n
            End If
            If .Range("F106").Value <> myshdt.Cells(525, a).Value Then
                .Range("F106").Value = myshdt.Cells(525, a).Value
                zeigakukeisan2n
            End If
            
            .Unprotect Password:="s2341"
            .Range("J80").Value = myshdt.Cells(506, a).Value
            .Range("J83").Value = myshdt.Cells(509, a).Value
            .Range("J85").Value = myshdt.Cells(511, a).Value
            tyokukinyuu2n
        End With
    
    Else
        With Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|")
            .Unprotect Password:="s2341"
            .Range("C11").Value = myshdf.Range("C11").Value
            .Range("D9:AE18").Value = myshdf.Range("D9:AE18").Value
            .Range("AI9:AI13").Value = myshdf.Range("AI9:AI13").Value
            .Range("AK13:AO18").Value = myshdf.Range("AK13:AO18").Value
            .Range("AQ9:AS17").Value = myshdf.Range("AQ9:AS17").Value
            .Range("N23:S23,N26:S30,N33:S39,B45:U48,AH33:AH38,AH42,AH50").ClearContents
            .Range("N51").Value = .Range("N54").Value
            .Protect Password:="s2341"
            .Activate
        End With
        
        Worksheets("|fffd||fffd||fffd||fffd|").Activate
        syokika2n
    End If
    
    Application.EnableEvents = True
    Application.ScreenUpdating = Not hyouji2n_flg
'    Application.ScreenUpdating = True
    Set myshdt = Nothing
    Set myshdf = Nothing
End Sub
Attribute VB_Name = "nyuu_touroku"
Option Explicit
Option Private Module

Sub touroku2n()
'2013/1/9 Ver.1300
'2013/12/2 Ver.1303
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610    |fffd||fffd||6d0||142||182||202||fffd||28b||38e||84d6||fffd||fffd||fffd||1c9||fffd||fffd||fffd|
'2017/11/28 Ver.1800
    
    Dim myshg As Worksheet, myshdt As Worksheet
    Dim myBtn As Integer
    Dim i As Long, n As Long
    Dim myMsg As String
    Dim myTitle As String
        
    Set myshg = Worksheets("|fffd||fffd||fffd||fffd|")
    Set myshdt = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
    
    If myshg.Range("F18").Value = "" Then
        MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    Else
        If myflgnyuutouroku Then
            myBtn = vbYes
        Else
            myTitle = "|fffd|f|fffd|[|fffd|^|fffd||313|o|fffd|^|fffd|m|fffd|F"
            If myshdt.Range("D13").Value <= myshdt.Range("D25").Value Then
                myMsg = "|fffd|u" & myshdt.Range("D14").Value & "|fffd|v|fffd|@|fffd||30f|C|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H"
            Else
                myMsg = "|fffd|u" & myshg.Range("F18").Value & "|fffd|v|fffd|@|fffd||303|f|fffd|[|fffd|^|fffd||fffd|V|fffd|K|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H"
            End If
            myBtn = MsgBox(myMsg, vbYesNo, myTitle)
        End If
        
        If myBtn = vbYes Then
    
            Application.ScreenUpdating = False
            With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                .Unprotect Password:="s2341"
                Application.Calculation = xlManual
                Dim a As Long, b As Long
                
                a = .Range("D18").Value + 18
                b = .Range("D18").Value + 1
                .Cells(.Range("D13").Value + 30, 4).Value = myshg.Range("F18").Value
                .Cells(.Range("D13").Value + 30, 6).Value = myshg.Range("F20").Value
                .Cells(30, a).Value = myshg.Range("F9").Value
                .Cells(31, a).Value = myshg.Range("F59").Value
                .Cells(32, a).Value = myshg.Range("F27").Value
                
                .Cells(35, a).Value = myshg.Range("H59").Value
                
                .Cells(36, a).Value = myshg.Range("F18").Value
                .Cells(37, a).Value = myshg.Range("F17").Value
                .Cells(38, a).Value2 = myshg.Range("F19").Value2
                .Cells(39, a).Resize(2).Value = myshg.Range("F15:F16").Value
                .Cells(41, a).Resize(4).Value = myshg.Range("F11:F14").Value
                .Cells(45, a).Value = myshg.Range("F20").Value
                .Cells(46, a).Value = myshg.Range("H11").Value
                
                
                .Cells(111, a).Value = myshg.Range("F22").Value
                .Cells(112, a).Value = myshg.Range("G22").Value
                .Cells(113, a).Resize(2).Value = myshg.Range("F24:F25").Value
                .Cells(116, a).Resize(10).Value = myshg.Range("C44:C53").Value
                .Cells(212, a).Value = myshg.Range("P45").Value
                .Cells(224, a).Value = myshg.Range("P46").Value
                .Cells(252, a).Value = myshg.Range("Q45").Value
                .Cells(264, a).Value = myshg.Range("Q46").Value
                .Cells(292, a).Value = myshg.Range("R45").Value
                .Cells(304, a).Value = myshg.Range("R46").Value
                .Cells(369, a).Value = myshg.Range("S45").Value
                .Cells(381, a).Value = myshg.Range("S46").Value
                .Cells(449, a).Value = myshg.Range("T45").Value
                .Cells(461, a).Value = myshg.Range("T46").Value
    
                For i = 0 To 11
                    .Cells(127 + i * 2, a).Value = myshg.Cells(30 + i, 4).Value
                    .Cells(164 + i * 2, a).Value = myshg.Cells(30 + i, 5).Value
                    .Cells(201 + i * 2, a).Value = myshg.Cells(30 + i, 6).Value
                    .Cells(241 + i * 2, a).Value = myshg.Cells(30 + i, 7).Value
                    .Cells(281 + i * 2, a).Value = myshg.Cells(30 + i, 8).Value
                    .Cells(321 + i * 2, a).Value = myshg.Cells(30 + i, 9).Value
                    .Cells(358 + i * 2, a).Value = myshg.Cells(30 + i, 10).Value
                    .Cells(398 + i * 2, a).Value = myshg.Cells(30 + i, 11).Value
                    .Cells(438 + i * 2, a).Value = myshg.Cells(30 + i, 12).Value
                Next i
    
                .Cells(153, a).Resize(10).Value = myshg.Range("D44:D53").Value
                .Cells(190, a).Resize(10).Value = myshg.Range("E44:E53").Value
                .Cells(226, a).Resize(11).Value = myshg.Range("F43:F53").Value
                .Cells(238, a).Resize(2).Value = myshg.Range("F55:F56").Value
                .Cells(266, a).Resize(11).Value = myshg.Range("G43:G53").Value
                .Cells(278, a).Resize(2).Value = myshg.Range("G55:G56").Value
                .Cells(306, a).Resize(11).Value = myshg.Range("H43:H53").Value
                .Cells(318, a).Resize(2).Value = myshg.Range("H55:H56").Value
                .Cells(347, a).Resize(10).Value = myshg.Range("I44:I53").Value
                .Cells(383, a).Resize(11).Value = myshg.Range("J43:J53").Value
                .Cells(395, a).Resize(2).Value = myshg.Range("J55:J56").Value
                .Cells(423, a).Resize(11).Value = myshg.Range("K43:K53").Value
                .Cells(435, a).Resize(2).Value = myshg.Range("K55:K56").Value
                .Cells(463, a).Resize(11).Value = myshg.Range("L43:L53").Value
                .Cells(475, a).Resize(2).Value = myshg.Range("L55:L56").Value
                .Cells(478, a).Resize(13).Value = myshg.Range("J62:J74").Value
                .Cells(492, a).Resize(3).Value = myshg.Range("L62:L64").Value
                .Cells(497, a).Resize(4).Value = myshg.Range("L66:L69").Value   'Ver1300
                .Cells(514, a).Value = myshg.Range("L70").Value                 'Ver.1610|fffd||1c9||fffd|
                .Cells(501, a).Resize(13).Value = myshg.Range("J75:J87").Value    'Ver1300
                
                .Cells(519, a).Resize(34).Value = myshg.Range("F100:F133").Value
                .Cells(556, a).Resize(25).Value = myshg.Range("M103:M127").Value
    
                Application.Calculation = xlAutomatic
    
                n = .Cells(36, .Columns.Count).End(xlToLeft).Column
                If n > 18 Then
                    .Range("R582:R776").AutoFill _
                        Destination:=.Range(.Cells(582, 18), .Cells(776, n)), Type:=xlFillValues    'Ver.1610|fffd||3cd|X689-776
                    .Range("D24").Value = n
                End If
                
                .Cells(49, a).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N23").Value
                .Cells(52, a).Resize(5).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N26:N30").Value
                .Cells(59, a).Resize(8).Value2 = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N33:N40").Value2
                .Cells(69, a).Resize(4).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("B45:B48").Value
                .Cells(74, a).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N51").Value
                .Cells(78, a).Resize(15).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AH24:AH38").Value
                .Cells(93, a).Value2 = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AH39").Value2
                .Cells(94, a).Resize(14).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AH40:AH53").Value

                narabikae
                
                .Protect Password:="s2341"
                .Activate
            End With
    
            With Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
                .Unprotect Password:="s2341"
                .Cells(b * 10 + 2, 3).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("C11").Value
                .Cells(b * 10, 4).Resize(10, 28).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("D9:AE18").Value
                .Cells(b * 10, 35).Resize(5).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AI9:AI13").Value
                .Cells(b * 10 + 4, 37).Resize(6, 5).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AK13:AO18").Value
                .Cells(b * 10, 43).Resize(9, 3).Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("AQ9:AS17").Value
                .Protect Password:="s2341"
                .Activate
            End With
    
            myshg.Activate
            
            hyouji_nyuuflg = False
            Application.ScreenUpdating = True
        End If
    End If
    Set myshg = Nothing
    Set myshdt = Nothing
End Sub
Attribute VB_Name = "sakujyo"
Option Explicit
Option Private Module

Sub sakujyo1b2n()
'2012/11/12 Ver.1210
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610
'2017/11/30 Ver.1800
    
    Dim nam As String, c As String
    nam = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D14").Value
    c = ActiveSheet.Name
    Dim myBtn As Integer
    Dim myMsg As String
    Dim myTitle As String
    myMsg = "|fffd|u" & nam & "|fffd|v|fffd|@|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H" & Chr(13) & _
        "|fffd||d3dc||fffd||fffd||fffd||a0bd||fffd|f|fffd|[|fffd|^|fffd||34c||fffd||fffd||242||356||7c2||fffd||702||fffd||fffd||fffd|B"
    myTitle = "|fffd|f|fffd|[|fffd|^|fffd||30d||d3dc||fffd|m|fffd|F"
    myBtn = MsgBox(myMsg, vbYesNo + vbExclamation, myTitle)
    If myBtn = vbYes Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
    
        Dim a As Integer, b As Integer
        With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            .Unprotect Password:="s2341"
            a = .Range("D18").Value + 18
            b = .Range("D18").Value + 1
            .Cells(.Range("D13").Value + 30, 4).ClearContents
            .Cells(.Range("D13").Value + 30, 6).Value = "|fffd|V|fffd|K"
            .Range(.Cells(30, a), .Cells(580, a)).ClearContents
    
            Dim n As Long
            n = .Cells(36, .Columns.Count).End(xlToLeft).Column
            If n < .Range("D24").Value Then
                .Range(.Cells(582, n + 1), .Cells(776, .Range("D24").Value)).ClearContents      'ver1610
                .Range("D24").Value = n
            End If
            
            narabikae
            
            .Protect Password:="s2341"
            .Activate
        End With
    
        With Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
            .Unprotect Password:="s2341"
            .Range(.Cells(b * 10, 3), .Cells(b * 10 + 9, 45)).ClearContents
            .Protect Password:="s2341"
            .Activate
        End With
    
        With Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|")
            .Unprotect Password:="s2341"
            .Range("C11").Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^").Range("C11").Value
            .Range("D9:AE18").Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D9:AE18").Value
            .Range("AI9:AI13").Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^").Range("AI9:AI13").Value
            .Range("AK13:AO18").Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^").Range("AK13:AO18").Value
            .Range("AQ9:AS17").Value = Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^").Range("AQ9:AS17").Value
            .Range("N23:S23,N26:S30,N33:S39,B45:U48,AH33:AH38,AH42,AH50").ClearContents
            .Range("N51").Value = .Range("N54").Value
            .Protect Password:="s2341"
            .Activate
        End With
        
        Worksheets(c).Activate
        
        syokika2n
        
        With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            .Range("D13").Value = .Cells(.Range("D25").Value + 31, 1).Value
            .Range("E13").Value = .Range("D13").Value
        End With
        
        hyouji_nyuuflg = False
        
        Application.EnableEvents = True
        Application.ScreenUpdating = True
    End If
    
End Sub

Sub syokika2n()
'2013/1/9 Ver.1300
'2017/11/28 Ver.1800

    Application.ScreenUpdating = False
    With Worksheets("|fffd||fffd||fffd||fffd|")
        .Unprotect Password:="s2341"
        .Range("F9").Value = "|fffd||fffd||fffd||fffd|i|fffd|b|fffd||fffd||fffd|j"
        .Range("F59").Value = "|fffd||fffd||fffd||352||fffd|"
        .Range("H11,F11:F15,F16:H16,F17:G19,F20,F22:G22,F24:F25,H59:L59").ClearContents
        .Range("D30:D41") = .Range("S30:S41").Formula
        .Range("F27,E30:E41").Value = 1
        .Range("F30:F41") = .Range("T30:T41").Formula
        .Range("G30:G41").ClearContents
        .Range("I30:I41") = .Range("U30:U41").Formula
        .Range("C44:G53").ClearContents
        .Range("F56:L56").ClearContents
        .Range("I44:I53").ClearContents
        .Range("F103:F104").Value = False
        .Range("F107:F108").Value = False
    
        If .Range("F105").Value = True Then
            .Range("F105").Value = False
            With .Range("J72")
                .Formula = "=IF(AND(F9=""|fffd||fffd||fffd||fffd|i|fffd|b|fffd||fffd||fffd|j"",F59=""|fffd||fffd||fffd||fffd|""),|fffd|}|fffd|{|fffd|T|fffd||fffd|!AI54,"""")"
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
        End If
    
        If .Range("F106").Value = True Then
            .Range("F106").Value = False
            With .Range("J30:J53")
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
            .Range("J30:J41") = .Range("V30:V41").Formula
            .Range("J44:J53") = .Range("V44:V53").Formula
        End If
    
        If .Range("F109").Value = True Then
            .Range("F109").Value = False
            With .Range("J80,J83,J85")
                .Interior.ColorIndex = xlNone
                .Locked = True
                .FormulaHidden = True
            End With
            .Range("J80:J85") = .Range("V80:V85").Formula
        End If
    
        .Range("J67:J71,L66:L70,J76,J81").ClearContents
        .Protect Password:="s2341"
    End With
    Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "sheet_select"
Option Explicit
Option Private Module

Public mybkhp As String, mybkzei As String

Sub herupu()
'2003/5/24

    mybkhp = ActiveSheet.Name
    Worksheets("|fffd|w|fffd||fffd||fffd|v").Select
End Sub

Sub herupu_modoru()
'2017/11/28 Ver.1800

    On Error Resume Next
    Worksheets(mybkhp).Select
    
    If Err.Number <> 0 Then
        Worksheets("|fffd|g|fffd|b|fffd|v").Select
    End If
End Sub

Sub zeigaku_modoru()
'2017/11/28 Ver.1800

    On Error Resume Next
    Worksheets(mybkzei).Select
    
    If Err.Number <> 0 Then
        Worksheets("|fffd|g|fffd|b|fffd|v").Select
    End If
End Sub

Sub huyou_modoru()
'2017/11/28 Ver.1800

    Worksheets("|fffd||fffd||fffd||fffd|").Select
End Sub

Sub huyouhe()

    Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Select
    Range("A4").Select
End Sub

Sub main()

    Worksheets("|fffd|g|fffd|b|fffd|v").Select
    Range("A5").Select
End Sub

Sub top_nyuuhe()
'2017/11/28 Ver.1800

    Worksheets("|fffd||fffd||fffd||fffd|").Select
    Range("A5").Select
End Sub

Sub tyousyuubohe()
'2017/11/28 Ver.1800

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("A4").Select
    
End Sub

Sub insatu()
'2017/11/28 Ver.1800

    If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
        UserForm1.Show
    Else
        ActiveSheet.PrintPreview
    End If
End Sub

Sub getugakuhyouhe()

    mybkzei = ActiveSheet.Name
    Worksheets("|fffd||fffd||fffd|z|fffd|\").Select
End Sub

Sub syouyo_getugakuhe()

    Worksheets("|fffd||fffd||fffd|z|fffd|\").Select
End Sub

Sub syouyohe()

    Worksheets("|fffd||717|^").Select
End Sub

Sub jyoukyoutyouhe()

    Worksheets("|fffd||cbd52||fffd|").Select
    Range("A3").Select
End Sub

Attribute VB_Name = "top_1"
Option Explicit
Option Private Module

Public strgenFileName As String, strtyouFileName As String, strgouFileName As String, myps As String

Sub tyousyuuhyouhe()
    '2016/1/16 Ver.1600
    '2016/11/23 Ver.1610
    '2016/11/29 Ver.1615
    '2017/1/8 Ver.1700
    '2017/11/28 Ver.1800
    '2019/1/2 Ver.1900
    
    Dim myBook As Workbook
    Dim a As String, strinFile As String
    strgenFileName = ThisWorkbook.Name                  '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd|
    strinFile = "tyousyuuhyou31"                        '|fffd||fffd||fffd||fffd||fffd|[|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    myps = ThisWorkbook.Path                            '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||303|p|fffd|X
    
    Application.ScreenUpdating = False
    On Error Resume Next
    For Each myBook In Workbooks
'        If myBook.Path = myps Then
            a = myBook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile Then
                strtyouFileName = myBook.Name           '|fffd||fffd||fffd||fffd||fffd|[|fffd|u|fffd|b|fffd|N|fffd||fffd|
                myBook.Activate
                myBook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("D5").Value = ThisWorkbook.Name
                Application.Run "'" & Replace(myBook.FullName, "'", "''") & "'!" & "tyoutorikomi"
                Exit Sub
            End If
            a = ""
'        End If
    Next
    
    Application.ScreenUpdating = True
    
    MsgBox "|fffd|utyousyuuhyou28|fffd|v|fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & Chr(13) & Chr(13) & _
            "|fffd|u" & strinFile & "|fffd|v|fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|" & Chr(13) & _
            "|fffd||113|x|fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|m|fffd|F"
    
End Sub

Sub goukeihyouhe()
    '2016/1/16 Ver.1600
    '2017/1/8 Ver.1700
    '2017/11/30 Ver.1800
    '2019/1/2 Ver.1900
    
    Dim myBook As Workbook
    Dim a As String, strinFile As String
    strgenFileName = ThisWorkbook.Name                  '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd|
    strinFile = "goukeihyou31"                          '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    myps = ThisWorkbook.Path                            '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||303|p|fffd|X
    
    Application.ScreenUpdating = False
    On Error Resume Next
    For Each myBook In Workbooks
        If myBook.Path = myps Then
            a = myBook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile Then
                strgouFileName = myBook.Name            '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||fffd|
                myBook.Activate
                myBook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("D5").Value = ThisWorkbook.Name
                Application.Run "'" & Replace(myBook.FullName, "'", "''") & "'!" & "goutorikomi"
                Exit Sub
            End If
            a = ""
        End If
    Next
    
    Dim c As String, aa As String
    Dim n As Integer
    c = Dir(myps & "\" & "*.xlsm")      'Ver.1800 |fffd|g|fffd||fffd||fffd|q|fffd||3cd|X
    Do While c <> ""
        If Replace(Replace(c, "[", ""), "]", "") <> c Then
            Application.ScreenUpdating = True
            MsgBox "|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|E|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||242||341|A|fffd||fffd||fffd|p|fffd||5287||fffd||295||fffd||fffd||fffd| [|fffd|@] |fffd||34e|g|fffd|p|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                    "|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||101|A|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|E|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            Exit Sub
        End If
        
        aa = myps & "\[" & c & "]|fffd|w|fffd||fffd||fffd|v"      'Ver.910
        aa = Replace(aa, "'", "''")
        aa = Replace(aa, "|fffd|f", "|fffd|f|fffd|f")
        a = Application.ExecuteExcel4Macro("'" & aa & "'!R6C3")
        If a = strinFile Then
            Workbooks.Open Filename:=myps & "\" & c
            strgouFileName = c                          '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||fffd|
            Workbooks(c).Activate
            Workbooks(c).Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("D5").Value = ThisWorkbook.Name
            Application.Run "'" & Replace(myps & "\" & c, "'", "''") & "'!" & "goutorikomi"
            Exit Sub
        End If
        c = Dir()
    Loop
    Application.ScreenUpdating = True
    
    MsgBox "|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||241|u" & strinFile & "|fffd|v|fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd|B" & Chr(13) & Chr(13) & _
            "|fffd|u" & strinFile & "|fffd|v|fffd||fffd||fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||193||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||251|}|fffd||fffd||fffd||fffd||fffd|A" & Chr(13) & _
            "|fffd||113|x|fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|m|fffd|F"
    
End Sub
Attribute VB_Name = "top_import"
Option Explicit
Option Private Module

Sub import()
'2016/1/16 Ver.1600
'2016/11/22 Ver.1610
'2017/1/8 Ver.1700
'2017/11/28 Ver.1800
'2019/1/2 Ver.1900

    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim i As Long, n As Long
    Dim myMsg As String
    Dim myshft As Worksheet, myshfd As Worksheet, myshff As Worksheet, myshfj As Worksheet
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = gn Then
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    ThisWorkbook.Activate
    Application.ScreenUpdating = True
    
    On Error GoTo 0
    If hn = gn Then
        If h >= 1900 And h <= g Then                                 '|fffd|{|fffd|N|fffd|u|fffd|b|fffd|N|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd||635e||fffd|m|fffd|F") = vbYes Then
                
                Set myshft = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshfd = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                Set myshff = Workbooks(f).Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
                Set myshfj = Workbooks(f).Worksheets("|fffd||cbd52||fffd|")
                
                Application.ScreenUpdating = False
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
                    .Activate
                    .Range("U11").Value = myshft.Range("U11").Value
                    .Range("U10").Value = .Range("U11").Value
                    .Range("E14").Value = myshft.Range("E14").Value
                    .Range("E18:L18").Value = myshft.Range("E18:L18").Value
                    .Range("E19:E34").Value = myshft.Range("E19:E34").Value
                    If .Range("U12").Value <> myshft.Range("U12").Value Then
                        .Range("U12").Value = myshft.Range("U12").Value
                        nouki
                        Application.ScreenUpdating = False
                    End If
                End With
                
                If myshfd.Range("D24").Value > 18 Then
                    With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                        .Unprotect Password:="s2341"
                        .Range("D13:E13").Value = myshfd.Range("D13:E13").Value     'Ver.1110
                        .Range("D19").Value = myshfd.Range("D19").Value
                        .Range("D22:D24").Value = myshfd.Range("D22:D24").Value
                        
                        n = .Range("D24").Value
                        
                        myshfd.Range("D31:G260").Copy
                            .Range("D31").PasteSpecial Paste:=xlPasteValues
                        myshfd.Range(myshfd.Cells(30, 19), myshfd.Cells(580, n)).Copy
                            .Range("S30").PasteSpecial Paste:=xlPasteValues
                        
                        Application.CutCopyMode = False
                        
                        .Range("R582:R776").AutoFill _
                            Destination:=.Range(.Cells(582, 18), .Cells(776, n)), _
                                Type:=xlFillValues          'Ver.1610|fffd||3cd|X689-776
                        
                        .Protect Password:="s2341"
                        .Activate
                    End With
                    
                    With ThisWorkbook.Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
                        .Unprotect Password:="s2341"
                        myshff.Range("C20:AS" & (n - 17) * 10 + 8).Copy
                            .Range("C20").PasteSpecial Paste:=xlPasteValues
                        Application.CutCopyMode = False
                        .Protect Password:="s2341"
                        .Activate
                    End With
                End If
                
                With ThisWorkbook.Worksheets("|fffd||cbd52||fffd|")
                    .Unprotect Password:="s2341"
                    For i = 12 To 34 Step 2
                        .Cells(i, 5).Value = myshfj.Cells(i, 5).Value
                        .Cells(i, 6).Value = myshfj.Cells(i, 6).Value
                        .Cells(i, 9).Value = myshfj.Cells(i, 9).Value
                        .Cells(i + 1, 19).Value = myshfj.Cells(i + 1, 19).Value
                    Next i
                    .Range("E36").Value = myshfj.Range("E36").Value
                    .Range("E51").Value = myshfj.Range("E51").Value
                    .Range("S40").Value = myshfj.Range("S40").Value
                    .Range("S42").Value = myshfj.Range("S42").Value
                    .Range("S44").Value = myshfj.Range("S44").Value
                    .Range("S46").Value = myshfj.Range("S46").Value
                    .Range("S48").Value = myshfj.Range("S48").Value
                    
                    .Range("G65:G66").Value2 = myshfj.Range("G65:G66").Value2      '2009/7/28 Ver.910
                    .Range("K65:K66").Value2 = myshfj.Range("K65:K66").Value2
                    .Range("N65:N66").Value = myshfj.Range("N65:N66").Value
                    .Range("O65:O66").Value = myshfj.Range("O65:O66").Value
                    .Range("Q65:Q66").Value = myshfj.Range("Q65:Q66").Value
                    .Range("G68").Value2 = myshfj.Range("G68").Value2
                    .Range("Q71").Value = myshfj.Range("Q71").Value
                    .Protect Password:="s2341"
                    .Activate
                End With
                
                ThisWorkbook.Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N54").Value _
                        = Workbooks(f).Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N54").Value       'Ver1800
                
                
                ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd|").Activate
                hyouji2n
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set myshft = Nothing
                Set myshfd = Nothing
                Set myshff = Nothing
                Set myshfj = Nothing
            End If
        Else
            MsgBox "|fffd|{|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||742||342||142||fffd||fffd||702||fffd||fffd||fffd|"
        End If
    Else
        MsgBox "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|A|fffd|b|fffd|v|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub
Attribute VB_Name = "top_kouzei"
Option Explicit
Option Private Module

Sub koukeisan()
    '2003/1/13
    Dim myBtn As Integer
    myBtn = 0
    With Worksheets("|fffd|g|fffd|b|fffd|v")
        If .Range("U11").Value <> .Range("U10").Value Then
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value > 0 Then
                myBtn = MsgBox("|fffd|o|fffd|^|fffd||3c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
                        "|fffd|o|fffd|^|fffd||3c2||303|f|fffd|[|fffd|^|fffd||242||355||3cd|X|fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & Chr(13) & _
                        "|fffd||682||fffd||fffd||fffd||fffd||341|u|fffd|w|fffd||fffd||fffd|v|fffd|v|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & Chr(13) & _
                        "|fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbOKCancel, "|fffd||3cd|X|fffd|m|fffd|F")
            End If
            If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value = 0 Or myBtn = vbOK Then
                .Range("U11").Value = .Range("U10").Value
            Else
                .Range("U10").Value = .Range("U11").Value
            End If
        End If
    End With
End Sub
Attribute VB_Name = "top_nenkousin"
Option Explicit
Option Private Module

Sub nendokousin()
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610
'2017/1/8 Ver.1700
'2017/11/28 Ver.1800
'2019/1/2 Ver.1900
    
    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim i As Long, n As Long
    Dim myMsg As String
    Dim myshft As Worksheet, myshfd As Worksheet, myshff As Worksheet
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = "gensen30" Then                         '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    ThisWorkbook.Activate
    Application.ScreenUpdating = True
    
    On Error GoTo 0
    If hn = "gensen30" Then                                     '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
        If h >= 1800 And h < 1900 Then                           '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd|N|fffd|x|fffd|X|fffd|V|fffd|m|fffd|F") = vbYes Then
                
                Set myshft = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshfd = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                Set myshff = Workbooks(f).Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
                
                Application.ScreenUpdating = False
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
                    .Activate
'                    If .[Button 4].Characters.Text = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
'                        .Unprotect Password:="s2341"
'                        .[Button 4].Characters.Text = "|fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||343|V|fffd|[|fffd|g"
'                        .Protect Password:="s2341"
'                    End If
                    .Range("U11").Value = myshft.Range("U11").Value
                    .Range("U10").Value = .Range("U11").Value
                    .Range("E14").Value = myshft.Range("E14").Value
                    .Range("E18:L18").Value = myshft.Range("E18:L18").Value
                    .Range("E19:E34").Value = myshft.Range("E19:E34").Value
                    If .Range("U12").Value <> myshft.Range("U12").Value Then
                        .Range("U12").Value = myshft.Range("U12").Value
                        nouki
                        Application.ScreenUpdating = False
                    End If
                End With
                
                If myshfd.Range("D24").Value > 18 Then
                    With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                        .Unprotect Password:="s2341"
'                        .Range("D13").Value = myshfd.Range("D13").Value
'                        .Range("D19").Value = myshfd.Range("D19").Value
                        .Range("D22").Value = myshfd.Range("D22").Value
                        .Range("D24").Value = myshfd.Range("D24").Value
                        
                        n = .Range("D24").Value
                        
                        .Range("S30").Resize(1, n - 18).Value = _
                            myshfd.Range("S30").Resize(1, n - 18).Value
                        .Range("S31").Resize(1, n - 18).Value = "|fffd||fffd||fffd||352||fffd|"
                        .Range("S32").Resize(1, n - 18).Value = _
                            myshfd.Range("S32").Resize(1, n - 18).Value
                        .Range("S35:S46").Resize(, n - 18).Value = _
                            myshfd.Range("S35:S46").Resize(, n - 18).Value      '2009/3/6 Ver.910
                        .Range("S88:S89").Resize(, n - 18).Value = _
                            myshfd.Range("S88:S89").Resize(, n - 18).Value      'Ver.1800 |fffd||40a|Q|fffd||481|A|fffd|O|fffd||fffd||fffd|l76:77 Ver.1900 88:89
                        
                        .Range("S74").Resize(1, n - 18).Value = _
                            myshfd.Range("S74").Resize(1, n - 18).Value                'Ver.1800 |fffd||fffd||fffd|105 Ver.1900 74
                        ThisWorkbook.Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N54").Value _
                            = Workbooks(f).Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd|").Range("N54").Value    'Ver.1800|fffd|u|fffd||fffd||fffd|^|fffd||fffd||fffd||30e||fffd||281|v|fffd||30f||fffd||fffd||fffd||fffd|l B40 Ver.1900 N54
                        
'                        .Range("S96").Resize(1, n - 18).Value = _
                            myshfd.Range("S96").Resize(1, n - 18).Value
                        
                        myshfd.Range("D31:G260").Copy
                            .Range("D31").PasteSpecial Paste:=xlPasteValues
                        Application.CutCopyMode = False
                        
                        For i = 19 To n
                            If myshfd.Cells(510, i).Value > 0 Then                  'H18|fffd||302||742||30f||a3ca|518 H19|fffd||fffd||fffd|509 'Ver.1300 H26|fffd||fffd||fffd|510 'Ver.1400
                                .Cells(111, i).Value = "|fffd||fffd||fffd||fffd|"
                                .Cells(112, i).Value = myshfd.Cells(510, i).Value   'H18|fffd||302||742||30f||a3ca|518 H19|fffd||fffd||fffd|509 H26|fffd||fffd||fffd|510 'Ver.1400
                            ElseIf myshfd.Cells(512, i).Value > 0 Then              'H18|fffd||302||742||30f||a3ca|521 H19|fffd||fffd||fffd|511 'Ver.1300 H26|fffd||fffd||fffd|512 'Ver.1400
                                .Cells(111, i).Value = "|fffd|s|fffd||fffd|"
                                .Cells(112, i).Value = myshfd.Cells(512, i).Value   'H18|fffd||302||742||30f||a3ca|521 H19|fffd||fffd||fffd|511 H26|fffd||fffd||fffd|512 'Ver.1400
                            End If
                        Next i
                        
                        .Range("R582:R776").AutoFill _
                            Destination:=.Range(.Cells(582, 18), .Cells(776, n)), _
                                Type:=xlFillValues                                  'Ver.1610
                        
                        .Protect Password:="s2341"
                        .Activate
                    End With
                        
                    With ThisWorkbook.Worksheets("|fffd|}|fffd|{|fffd|T|fffd||fffd||fffd|f|fffd|[|fffd|^")
                        .Unprotect Password:="s2341"
                        myshff.Range("C20:AS" & (n - 17) * 10 + 8).Copy
                            .Range("C20").PasteSpecial Paste:=xlPasteValues
                        Application.CutCopyMode = False
                        .Protect Password:="s2341"
                        .Activate
                    End With
                End If
                
                ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd|").Activate
                hyouji2n
    
                Worksheets("|fffd|g|fffd|b|fffd|v").Select
                Application.ScreenUpdating = False
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set myshft = Nothing
                Set myshfd = Nothing
                Set myshff = Nothing
            End If
    
        Else
            MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd|"
        End If
    Else
        MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub
Attribute VB_Name = "top_nouki"
Option Explicit
Option Private Module

Sub nouki()
'2003/12/28
'2009/7/28 Ver.910
'2009/11/28 Ver.920

    Dim myBtn As Integer
    myBtn = 0
    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value > 0 Then
        myBtn = MsgBox("|fffd|o|fffd|^|fffd||3c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
                "|fffd|o|fffd|^|fffd||3c2||303|f|fffd|[|fffd|^|fffd||242||355||3cd|X|fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & Chr(13) & _
                "|fffd||682||fffd||fffd||fffd||fffd||341|u|fffd|w|fffd||fffd||fffd|v|fffd|v|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & Chr(13) & _
                "|fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbOKCancel, "|fffd||3cd|X|fffd|m|fffd|F")
    End If
    If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("D25").Value = 0 Or myBtn = vbOK Then
        Application.ScreenUpdating = False
        With Worksheets("|fffd||cbd52||fffd|")
            .Unprotect Password:="s2341"
    
            With .Range("E12:L12,E14:L14,E16:L16,E18:L18,E20:L20,E24:L24,E26:L26,E28:L28,E30:L30,E32:L32")
                If Worksheets("|fffd|g|fffd|b|fffd|v").Range("U12").Value = True Then
                    .ClearContents
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                Else
                    .Interior.ColorIndex = 36
                    .Locked = False
                    .FormulaHidden = False
                End If
            End With
    
            With .Range("S13,S15,S17,S19,S21,S25,S27,S29,S31,S33")
                If Worksheets("|fffd|g|fffd|b|fffd|v").Range("U12").Value = True Then
                    .ClearContents
                    .Interior.ColorIndex = xlNone
                    .Locked = True
                    .FormulaHidden = True
                Else
                    .Interior.ColorIndex = 35
                    .Locked = False
                    .FormulaHidden = False
                End If
            End With
    
            .Protect Password:="s2341"
            .Activate
        End With
        Worksheets("|fffd|g|fffd|b|fffd|v").Activate
        Application.ScreenUpdating = True
    Else
        If Worksheets("|fffd|g|fffd|b|fffd|v").Range("U12").Value = True Then
            Worksheets("|fffd|g|fffd|b|fffd|v").Range("U12").Value = False
        Else
            Worksheets("|fffd|g|fffd|b|fffd|v").Range("U12").Value = True
        End If
    End If
End Sub
Attribute VB_Name = "top_tojiru"
Option Explicit
Option Private Module

Public myflgclose As Boolean, myflgsave As Boolean

Sub tojiru()
'2016/1/16 Ver.1600
'2016/11/23 Ver.1610
'2017/1/8 Ver.1700
'2017/11/26 Ver.1800
'2019/1/2 Ver.1900

    myflgclose = False
    myflgsave = False
    Dim n As Integer
    n = MsgBox("|fffd|\|fffd|t|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(10) & "|fffd||3cd|X|fffd||fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNoCancel, "|fffd||6d1||fffd||fffd|m|fffd|F")
    If n = vbYes Then
        myflgclose = True
        myflgsave = True
        ThisWorkbook.Save
    ElseIf n = vbNo Then
        myflgclose = True
        ThisWorkbook.Saved = True
    Else
        Exit Sub
    End If
    Dim myBook As Workbook
    Dim a As String, strinFile1 As String, strinFile2 As String
'    strinFile1 = "tyousyuuhyou28"                       '|fffd||fffd||fffd||fffd||fffd|[|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    strinFile2 = "goukeihyou31"                         '|fffd||fffd||fffd|v|fffd|\|fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    On Error Resume Next
    For Each myBook In Workbooks
        If myBook.Path = ThisWorkbook.Path Then
            a = Workbooks(myBook.Name).Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile2 Then
                If myflgsave Then
                    Workbooks(myBook.Name).Close True
                Else
                    Workbooks(myBook.Name).Close False
                End If
            End If
            a = ""
        End If
    Next
    
'    ThisWorkbook.Close      'Ver810 |fffd||3cd|X
    Application.OnTime Now(), "jibunwotojiru"
    
End Sub

Sub jibunwotojiru()
'2008/10/25 Ver.810

    'Excel2007 |fffd||389||fffd|
    ThisWorkbook.Close
End Sub
Attribute VB_Name = "ue_sita"
Option Explicit
'Option Private Module

Public hyouji_nyuuflg As Boolean
Public hyouji2n_flg As Boolean

Sub sitahe()
    If ActiveCell.Row < 26 Then
        ActiveWindow.ScrollRow = 26
        Range("A26").Select
    ElseIf ActiveCell.Row < 59 Then
        ActiveWindow.ScrollRow = 59
        Range("A59").Select
    Else
        ActiveWindow.ScrollRow = 68
        Range("A68").Select
    End If
End Sub

Sub uehe()
    If ActiveCell.Row >= 68 Then
        ActiveWindow.ScrollRow = 59
        Range("A59").Select
    ElseIf ActiveCell.Row >= 59 Then
        ActiveWindow.ScrollRow = 26
        Range("A26").Select
    Else
        ActiveWindow.ScrollRow = 5
        Range("A5").Select
    End If
End Sub

Sub tugi()
'2007/1/20 Ver.710
'2008/1/17 Ver.800
'2008/10/24 Ver.810
'2010/1/5 Ver.1000 |fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
'2017/11/28 Ver.1800

    Dim m As Long, n As Long
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        m = .Range("D13").Value
        n = .Range("D25").Value
        If m < n + 1 Then
            If hyouji_nyuuflg Then
                If MsgBox("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||313|o|fffd|^|fffd|m|fffd|F") = vbYes Then
                    .Range("D13").Value = .Range("E13").Value
                    If Worksheets("|fffd||fffd||fffd||fffd|").Range("F18").Value = "" Then
                        MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
                    Else
                        myflgnyuutouroku = True
                        
                        touroku2n
                        
                        myflgnyuutouroku = False
                        hyouji_nyuuflg = False
                    End If
                    Exit Sub
                End If
            End If
            
            If m > 229 Then
                MsgBox "230|fffd||fffd||fffd||20f||fffd||34d||c42c||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
            Else
                .Range("D13").Value = m + 1
                
                hyouji2n
                
                .Range("E13").Value = .Range("D13").Value
            End If
            
            hyouji_nyuuflg = False
            
        End If
    End With
    
End Sub

Sub mae()
'2007/1/20 Ver.710
'2008/1/17 Ver.800
'2008/10/24 Ver.810
'2010/1/5 Ver.1000
'2017/11/28 Ver.1800

    Dim m As Long, n As Long
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        m = .Range("D13").Value
        n = .Range("D25").Value
        If m > 1 Then
            If hyouji_nyuuflg Then
                If MsgBox("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||313|o|fffd|^|fffd|m|fffd|F") = vbYes Then
                    .Range("D13").Value = .Range("E13").Value
                    If Worksheets("|fffd||fffd||fffd||fffd|").Range("F18").Value = "" Then
                        MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
                    Else
                        myflgnyuutouroku = True
                        
                        touroku2n
                        
                        myflgnyuutouroku = False
                        hyouji_nyuuflg = False
                    End If
                    Exit Sub
                End If
            End If
            
            .Range("D13").Value = m - 1
            
            hyouji2n
            
            hyouji_nyuuflg = False
            .Range("E13").Value = .Range("D13").Value
        End If
    End With
End Sub

Sub hyouji_nyuu()
'2008/1/17 Ver.800
'2010/1/5 Ver.1000 |fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        If hyouji_nyuuflg Then
            If MsgBox("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||313|o|fffd|^|fffd|m|fffd|F") = vbYes Then
'                .Range("D13").Value = detano
                .Range("D13").Value = .Range("E13").Value
                If Worksheets("|fffd||fffd||fffd||fffd|").Range("F18").Value = "" Then
                    MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
                Else
                    myflgnyuutouroku = True
                    
                    touroku2n
                    
                    myflgnyuutouroku = False
                    hyouji_nyuuflg = False
                End If
                Exit Sub
            End If
        End If
        
        If .Range("D13").Value > 230 Then
            MsgBox "230|fffd||fffd||fffd||20f||fffd||34d||c42c||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
            .Range("D13").Value = .Range("E13").Value
        Else
            hyouji2n
        End If
        
        .Range("E13").Value = .Range("D13").Value
        hyouji_nyuuflg = False
    End With
    
End Sub

Sub hyouji_tyou()
'2018/1/2 Ver.1800

    hyouji2n_flg = True
    
    hyouji_nyuu
    
    hyouji2n_flg = False
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("A4").Select
    
    Application.ScreenUpdating = True
End Sub

Sub tugi_tyou()
'2018/1/2 Ver.1800
    
    hyouji2n_flg = True
     
    tugi
    
    hyouji2n_flg = False
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("A4").Select
    
    Application.ScreenUpdating = True
End Sub

Sub mae_tyou()
'2018/1/2 Ver.1800

    hyouji2n_flg = True
    
    mae
    
    hyouji2n_flg = False
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("A4").Select
    
    Application.ScreenUpdating = True
End Sub



INQUEST-PP=macro
