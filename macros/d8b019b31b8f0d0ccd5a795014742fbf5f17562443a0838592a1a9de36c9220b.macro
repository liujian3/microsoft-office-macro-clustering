Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Top_import"
Option Private Module
Option Explicit

Sub import()
'2016/11/27 Ver.1612
'2017/1/8 Ver.1700
'2018/1/2 Ver.1800
'2019/1/2 Ver.1900

    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim myMsg As String
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = gn Then
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    Workbooks(e).Activate
    Application.ScreenUpdating = True
    
    On Error GoTo 0
    If hn = gn Then
        If h >= 1900 And h <= g Then                 '|fffd|{|fffd|N|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd||635e||fffd|m|fffd|F") = vbYes Then
                                    
                Dim mysht As Worksheet, myshs As Worksheet, myshd As Worksheet
                
                Set mysht = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshs = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                Set myshd = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                
                Application.ScreenUpdating = False
                                
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
'                    .Unprotect Password:="2343t"
'                    .Range("G7") = mysht.Range("G7").Value
                    .Range("E10") = mysht.Range("E10").Value
                    .Range("E12") = mysht.Range("E12").Value
                    .Range("E14") = mysht.Range("E14").Value
                    .Range("E18:L18") = mysht.Range("E18:L18").Value
                    .Range("E19:E34") = mysht.Range("E19:E34").Value
                    .Range("E35:Q35") = mysht.Range("E35:Q35").Value
'                    .Protect Password:="2343t"
'                    .Activate
                End With
                
                With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                    .Unprotect Password:="as2343t"
                    .Range("E9") = myshs.Range("E9").Value
                    .Range("G9") = myshs.Range("G9").Value
                    .Range("I9") = myshs.Range("I9").Value
                    .Range("K11") = myshs.Range("K11").Value
                    .Range("N11") = myshs.Range("N11").Value
                    .Range("R11") = myshs.Range("R11").Value
                    .Range("I21") = myshs.Range("I21").Value
                    .Range("L26") = myshs.Range("L26").Value
                    .Range("L27") = myshs.Range("L27").Value
                    .Range("AB17") = myshs.Range("AB17").Value
                    .Range("AB18") = myshs.Range("AB18").Value
                    .Range("AB20") = myshs.Range("AB20").Value
                    .Range("AB23") = myshs.Range("AB23").Value
                    .Range("AB24") = myshs.Range("AB24").Value
                    .Range("AB25") = myshs.Range("AB25").Value
                    .Range("AB26") = myshs.Range("AB26").Value
                    If .Range("AM1").Value = 1 Then
                        .Shapes("maru1").Visible = True
                        .Shapes("maru2").Visible = False
                        .Shapes("maru3").Visible = True
                        .Shapes("maru4").Visible = False
                    Else
                        .Shapes("maru2").Visible = True
                        .Shapes("maru1").Visible = False
                        .Shapes("maru4").Visible = True
                        .Shapes("maru3").Visible = False
                    End If
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                
                 With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                    .Unprotect Password:="as2343t"
                    
'                    .Range("A1").Value = myshd.Range("A1").Value
                    myshd.Range("A5:B235").Copy
                        .Range("A5").PasteSpecial Paste:=xlPasteValues
                    myshd.Range("M5:IH133").Copy
                        .Range("M5").PasteSpecial Paste:=xlPasteValues
                    
                    Application.CutCopyMode = False
                    
                    .Protect Password:="as2343t"
                End With
                
                
                
                With ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
                    .Unprotect Password:="as2343t"
                    .Range("A36").Value = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A36").Value  '|fffd|Y|fffd||fffd||fffd|L|fffd||fffd|
                    .Range("A2:D10") = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A2:D10").Value    '|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N Ver.1610
                    
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set mysht = Nothing
                Set myshs = Nothing
                Set myshd = Nothing
            End If
        Else
            MsgBox "|fffd|{|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||742||342||142||fffd||fffd||702||fffd||fffd||fffd|"
        End If
    Else
        MsgBox "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|A|fffd|b|fffd|v|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{B7E87C20-C1BA-4C07-9CEE-AA6B96CCA967}{B363249B-CA6C-4625-A673-37D595528A6B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CheckBox1_Click()
'|fffd||fffd||fffd||fffd|
    If Me.CheckBox1.Value Or Me.CheckBox2.Value Then
            Me.CommandButton1.Enabled = True
    Else
        Me.CommandButton1.Enabled = False
    End If
End Sub

Private Sub CheckBox2_Click()
'|fffd|E|fffd||fffd|
    If Me.CheckBox1.Value Or Me.CheckBox2.Value Then
            Me.CommandButton1.Enabled = True
    Else
        Me.CommandButton1.Enabled = False
    End If
End Sub

Private Sub ComboBox1_Change()
'2009/11/28 Ver.920

    Me.Label4.BackColor = Worksheets("|fffd|r|fffd||fffd|").Cells(Me.ComboBox1.ListIndex + 12, 31).Interior.Color
End Sub

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd|s
'2005/11/18 Ver.520
'2008/11/3 Ver.810
'2009/2/27 Ver.901
'2009/11/27 Ver.920|fffd|@|fffd||292|u|fffd||3cd|X
'2010/1/1 Ver.1000
'2016/11/21 Ver.1610
'2016/11/29 Ver.1614

    Dim i As Long, j As Long, k As Long, n As Long, a As Long
    Dim myArray As Variant, myArray2 As Variant
    Dim ws As Worksheet, ws2 As Worksheet
    
    On Error GoTo myErr
    
    Set ws = Worksheets("|fffd|r|fffd||fffd|")
    Set ws2 = Worksheets("|fffd||4d40f||fffd|")
    
    a = Val(Left(Me.ComboBox1.Value, 2))
    
    Me.Hide
    DoEvents
    Application.ScreenUpdating = False
    
    n = ws.Range("AG65536").End(xlUp).Row
    myArray2 = ws.Range("AG12").Resize(n - 11, 2).Value
    
    ws2.Unprotect Password:="as2343t"
    For j = 1 To 2
        If Me.Controls("CheckBox" & j).Value Then
            
            n = ws.Cells(65536, j).End(xlUp).Row
            myArray = ws.Cells(12, 1).Resize(n - 11, 14).Value
            
            For i = 1 To UBound(myArray)
                If Not IsEmpty(myArray(i, j)) Then
                    With ws2.Range(myArray(i, j))
                        If Not IsEmpty(myArray(i, 3)) Then
                           .Borders(xlEdgeLeft).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 5)) Then
                            .Borders(xlEdgeTop).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 7)) Then
                            .Borders(xlEdgeBottom).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 9)) Then
                            .Borders(xlEdgeRight).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 11)) Then
                            .Borders(xlInsideVertical).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 13)) Then
                            .Borders(xlInsideHorizontal).ColorIndex = a
                        End If
                    End With
                End If
            Next i
            
            ws2.Range(myArray2(1, j)).SpecialCells(xlCellTypeConstants, 23).Font.ColorIndex = a
            ws2.Range("N45:V45").Font.ColorIndex = 0
            For k = 2 To UBound(myArray2)
                If Not IsEmpty(myArray2(k, j)) Then
                    ws2.Range(myArray2(k, j)).Font.ColorIndex = a
                End If
            Next k
            
            ws2.Shapes("maru" & j).Line.ForeColor.RGB = _
                    Worksheets("|fffd|r|fffd||fffd|").Cells(a + 12, 31).Interior.Color
        End If
    Next j
    
    ws2.Protect Password:="as2343t"
    Application.ScreenUpdating = True
    Set ws = Nothing
    Set ws2 = Nothing
    
    For i = 1 To 2
        Me.Controls("CheckBox" & i).Value = False
    Next i
    
    MsgBox "|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    Me.Show
'    Unload Me
    Exit Sub
myErr:
    myflg = True
    ws2.Protect Password:="2343t"
    Application.ScreenUpdating = True
    MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|" & Chr(13) & _
            "|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|u|fffd|b|fffd|N|fffd|j|fffd||fffd||82||fffd||fffd||fffd||fffd||fffd|A|fffd||102||44a|J|fffd||fffd||fffd||103|G|fffd||fffd||fffd|[|fffd||302||fffd||fffd||fffd||fffd||fffd||fffd||348||342||fffd|" & Chr(13) & _
            "|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|"
    Set ws = Nothing
    Set ws2 = Nothing
    
    Unload Me
    
End Sub

Private Sub CommandButton2_Click()
'|fffd|I|fffd||fffd|

    Unload Me
End Sub

Private Sub CommandButton3_Click()
'|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
'2008/11/2 Ver.810
'2011/8/20 Ver.1110

    Me.Hide
    
    keisenhutosa
    
    Me.Show
    
     If myflg Then Unload Me
End Sub


Private Sub UserForm_Initialize()
'2018/1/2 Ver.1800

    Me.CommandButton1.Enabled = False
'    Me.Label1.Caption = "|fffd|I|fffd||fffd||348||342||303|t|fffd|H|fffd||fffd||fffd|g|fffd|E|fffd|r|fffd||fffd||fffd||310|F|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
'                        "|fffd||3cd|X|fffd||343|u|fffd|b|fffd|N|fffd|I|fffd||fffd||fffd||702||142||30a||502||fffd|1|fffd|`2|fffd||fffd||302||749||94|\|fffd||142||fffd||fffd|B"
    Me.Label1.Caption = "|fffd|I|fffd||fffd||348||342||303|t|fffd|H|fffd||fffd||fffd|g|fffd|E|fffd|r|fffd||fffd||fffd||310|F|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B"
    Me.ComboBox1.List = Worksheets("|fffd|r|fffd||fffd|").Range("AE12:AE68").Value
    Me.ComboBox1.ListIndex = 0
    Me.Label4.BackColor = RGB(0, 0, 0)
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{4C71F935-7DEC-4321-B8CE-082368E7B2BF}{84EAB6AE-3E6C-4F8F-A194-A1052C021FA2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private myflg As Boolean
'Private myflg2 As Boolean
Private opfg As Boolean

'Private Sub CheckBox5_Click()
''|fffd|N|fffd|x|fffd||fffd||fffd||310||fffd||fffd||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("C5").Value = Me.CheckBox5.Value
'    End If
'End Sub

'Private Sub CheckBox6_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("C6").Value = Me.CheckBox6.Value
'        Me.OptionButton7.Enabled = Me.CheckBox6.Value
'        Me.OptionButton8.Enabled = Me.CheckBox6.Value
'    End If
'End Sub

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|s
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615
'2019/11/14 Ver.1910
    
    Dim i As Long, n As Long, m As Variant, k As Variant
    Dim lfg As Boolean
    Dim mytime As Single
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    Application.GoTo Range("A130"), True
    
    Me.CommandButton2.Enabled = True
    Me.CommandButton3.Enabled = False
    Me.CommandButton4.Enabled = False
    Me.CommandButton5.Enabled = False
    Me.CommandButton2.Cancel = True
    Me.Label3.Visible = True
    Me.ListBox1.Enabled = False
    Me.Frame1.Enabled = False
    Me.Frame2.Enabled = False
'    Me.Frame5.Enabled = False
    
'    Me.Hide
'    DoEvents
    
    k = 1
    Me.Label3.Caption = "|fffd||fffd||fffd||fffd||fffd|"
    
    With Worksheets("|fffd||4d40f||fffd|")
        n = .Range("A1").Value
        
        DoEvents
        For i = 0 To Me.ListBox1.ListCount - 1
            If Me.ListBox1.Selected(i) = True Then
                If myflg = True Then
                    MsgBox k & " |fffd||fffd||fffd||688||20d|~|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|~"
                    Exit For
                End If
                
                If Me.OptionButton1 Then
                    
                Else
                    .Range("A1").Value = i + 1
                End If
                
                DoEvents
                .PrintOut Copies:=1
'                    .PrintPreview
                Me.Label3.Caption = k & " |fffd||fffd||fffd||688||fffd||fffd||fffd||fffd|"
                DoEvents
                k = k + 1
                
                mytime = Timer + 1
                Do While mytime > Timer
                    DoEvents
                    If myflg Then Exit Do
                Loop
            End If
        Next i
        
        .Range("A1").Value = n
    End With
    
    Me.CommandButton2.Enabled = False
    Me.CommandButton3.Enabled = True
    Me.CommandButton4.Enabled = True
    Me.CommandButton5.Enabled = True
    Me.CommandButton3.Cancel = True
    Me.Label3.Visible = False
    Me.ListBox1.Enabled = True
    Me.Frame1.Enabled = True
    Me.Frame2.Enabled = True
'    Me.Frame5.Enabled = True
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                Me.CommandButton1.Enabled = True
                Exit For
            End If
        Next i
    End With
    
    Application.GoTo Range("A19"), True
    myflg = False
    DoEvents
'    Me.Show
End Sub

Private Sub CommandButton2_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
''|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton3_Click()

    Unload Me
End Sub

Private Sub CommandButton4_Click()
'|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||682||fffd||fffd||5c2||111|I|fffd||fffd|

    Dim i As Long
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            .Selected(i) = True
        Next i
    End With
End Sub

Private Sub CommandButton5_Click()
'|fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|r|fffd||fffd||fffd|[
'2005/11/20 Ver.520
'2008/11/10 Ver.810
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615

    Dim i As Long, n As Variant, m As Variant
    Dim a As String
    Dim lfg As Boolean
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    Me.Hide
    DoEvents
    ActiveWindow.ScrollColumn = 148
    DoEvents
    
    With Worksheets("|fffd||4d40f||fffd|")
        n = .Range("A1").Value
                
        DoEvents
        If Me.OptionButton1 Then
            
        Else
            .Range("A1").Value = i + 1
        End If
        DoEvents
        .PrintPreview
        
        .Range("A1").Value = n
    End With
    
    ActiveWindow.ScrollColumn = 1
    DoEvents
    
    Me.Show
End Sub

Private Sub ListBox1_Change()
    Dim i As Long
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If (.Selected(i) = True) Then
                Me.CommandButton1.Enabled = True
                Exit Sub
            End If
        Next i
        Me.CommandButton1.Enabled = False
    End With
End Sub

Private Sub OptionButton1_Click()
'|fffd||fffd||fffd||fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd||302||fffd|
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615
'2016/12/3 Ver.1617b

    
    opfg = False
    
    With Me.ListBox1
        .Clear
        If (Worksheets("|fffd||4d40f||fffd|").Range("A1").Value > 0) And (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("A2").Value > 0) Then
            .AddItem Worksheets("|fffd||4d40f||fffd|").Range("B1").Value
        Else
            .AddItem ""
        End If
            .Selected(0) = True
    End With
    opfg = True
End Sub

Private Sub OptionButton2_Click()
'|fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|X|fffd|g|fffd||151|I|fffd||fffd|
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615

    Dim i As Long, n As Long
    
    Me.ListBox1.Clear
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        n = .Range("A65536").End(xlUp).Row
        
        If n > 4 Then
            For i = 5 To n
                If .Cells(i, 1).Value <> "" Then
                    Me.ListBox1.AddItem .Cells(i, 1).Value
                End If
            Next i
        End If
        If Me.ListBox1.ListCount = 0 Then
            Me.ListBox1.AddItem ""
        End If
    End With
End Sub

Private Sub OptionButton3_Click()
'|fffd||fffd||fffd||fffd||348||341|@4|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = True
        .Range("D4").Value = False
        .Range("D5").Value = False
        Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR12").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
            If a Is Nothing Then
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR12").Value
            End If
        End If
    End With
End Sub

Private Sub OptionButton4_Click()
'|fffd||fffd||fffd||fffd||348||341|@|fffd||fffd|2|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = False
        .Range("D4").Value = True
        .Range("D5").Value = False
        Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR13").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
            If a Is Nothing Then
            Else
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR13").Value
            End If
        End If
    End With
End Sub

Private Sub OptionButton5_Click()
'|fffd||fffd||fffd||fffd||348||341|@|fffd||fffd|2|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = False
        .Range("D4").Value = False
        .Range("D5").Value = True
        Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR14").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
            If a Is Nothing Then
            Else
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR14").Value
            End If
        End If
    End With
End Sub

'Private Sub OptionButton7_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||fffd||fffd||fffd||fffd||939e||fffd||302||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("D7").Value = True
'        Worksheets("|fffd||4d40f||fffd|").Range("D8").Value = False
'    End If
'End Sub
'
'Private Sub OptionButton8_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd||fffd|@|fffd||d39e|
''2014/1/09 Ver.1400|fffd|@|fffd||1c9||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("D7").Value = False
'        Worksheets("|fffd||4d40f||fffd|").Range("D8").Value = True
'    End If
'End Sub

Private Sub UserForm_Initialize()
'2016/11/21 Ver.1610
'2019/11/14 Ver.1910

    With Me
        opfg = False
        .CommandButton2.Enabled = False
        .CommandButton3.Cancel = True
              
'        myflg2 = True
        
        .OptionButton1.Value = True
        
        If Worksheets("|fffd||4d40f||fffd|").Range("D3").Value = True Then
            .OptionButton3.Value = True
        ElseIf Worksheets("|fffd||4d40f||fffd|").Range("D4").Value = True Then
            .OptionButton4.Value = True
        ElseIf Worksheets("|fffd||4d40f||fffd|").Range("D5").Value = True Then
            .OptionButton5.Value = True
        End If
        
'        .CheckBox5.Value = Worksheets("|fffd||4d40f||fffd|").Range("C5").Value
'        .CheckBox6.Value = Worksheets("|fffd||4d40f||fffd|").Range("C6").Value
'        .OptionButton7.Value = Worksheets("|fffd||4d40f||fffd|").Range("D7").Value
'        .OptionButton8.Value = Worksheets("|fffd||4d40f||fffd|").Range("D8").Value
'
'
'        .OptionButton7.Enabled = .CheckBox6.Value
'        .OptionButton8.Enabled = .CheckBox6.Value
        
'        myflg2 = False
        
        opfg = True
        
        .Label1.Caption = "|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||151|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||9294e||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(10) & _
                            "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||317|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(10) & _
                            "|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B"
    End With
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{BE8FBBF8-8751-4917-AAEB-5F533FBF70A5}{288AB9BC-CAD5-40AC-ABBC-171C871D7028}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub CheckBox1_Click()

    If Me.CheckBox1.Value Then
        Me.TextBox1.PasswordChar = ""
        Me.TextBox2.PasswordChar = ""
    Else
        Me.TextBox1.PasswordChar = "*"
        Me.TextBox2.PasswordChar = "*"
    End If
    
End Sub

Private Sub CommandButton1_Click()
'OK

    If Me.TextBox1.Text = Me.TextBox2.Text Then
        Unload Me
        
        Application.DisplayAlerts = False
        ThisWorkbook.SaveAs Filename:=ThisWorkbook.FullName, Password:=Me.TextBox1.Text
        Application.DisplayAlerts = True
    Else
        MsgBox "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|m|fffd|F"
        
        Me.TextBox1.Text = ""
        Me.TextBox2.Text = ""
    End If
    
End Sub

Private Sub CommandButton2_Click()
'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|

    Unload Me
End Sub

Private Sub UserForm_Initialize()

    Me.Label1.Caption = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||6cc||c0b7||fffd||90bd||fffd||7c2||313||1c2||74e||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd|15|fffd||fffd||fffd||fffd||fffd||213||fffd||fffd||153||fffd||fffd||342||fffd||fffd||702||fffd||fffd|B" & _
            Chr(13) & "|fffd||5576||fffd||fffd||fffd||18f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||702||fffd||fffd|B" & _
            Chr(13) & Chr(13) & "|fffd|V|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h"
    
End Sub
Attribute VB_Name = "hensyuu"
Option Private Module
Option Explicit

Sub hensyuuhe()
'|fffd||48f|W
'2016/11/26 Ver.1611

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        .Range("A1").Value = 0
        .Activate
    End With
    
End Sub
Sub hensyuu_simei()
'|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
'2016/11/26 Ver.1611
    
    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        
        Dim n As Long

        n = .Range("A2").Value + 12

        .Unprotect Password:="as2343t"

'        .Range("K4:K133").Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n).Resize(130).Value
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n).Resize(130).Copy
            .Range("K4").PasteSpecial Paste:=xlPasteValues
        Application.CutCopyMode = False

        .Protect Password:="as2343t"
    End With
    
End Sub
Sub touroku()
'|fffd|o|fffd|^
'2016/11/19 Ver.1611
'2016/12/5 Ver.1621

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        If .Range("A1").Value = 0 Then Exit Sub
         
        If .Range("N76").Value > 0 Then
            MsgBox "|fffd||90|l|fffd||50d||fffd||fffd||253||fffd||fffd||342||30a||508||10a2||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
         
        If MsgBox(.Range("K5").Value & "|fffd|@|fffd||582||30f|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", _
                vbOKCancel, "|fffd|o|fffd|^|fffd|m|fffd|F") = vbOK Then
            
            Dim ws As Worksheet
            Dim n As Long
            
            Set ws = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
            n = .Range("A2").Value + 12
            
            ws.Unprotect Password:="as2343t"
                        
'            ws.Cells(12, n).Resize(122).Value = .Range("K12:K133").Value
            .Range("K12:K133").Copy
                ws.Cells(12, n).PasteSpecial Paste:=xlPasteValues
            Application.CutCopyMode = False
            
            ws.Protect Password:="as2343t"
            
        End If
    End With
    
    Set ws = Nothing
    
End Sub


Sub touroku_cancel()
'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
'2016/11/19 Ver.1611

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        Dim n As Long
        
        If .Range("A1").Value = 0 Then Exit Sub
        n = .Range("A2").Value + 12
        
        .Unprotect Password:="as2343t"
        
'        .Range("K12:K133").Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(12, n).Resize(122).Value
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(12, n).Resize(122).Copy
            .Range("K12").PasteSpecial Paste:=xlPasteValues
        Application.CutCopyMode = False
        
        .Protect Password:="as2343t"
    End With

End Sub

Sub syuuryou()
'|fffd|I|fffd||fffd|
'2016/11/19 Ver.1611

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        .Unprotect Password:="as2343t"
        
        .Range("K4:K133").ClearContents
        
        .Protect Password:="as2343t"
    End With
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Activate
    
End Sub

Sub tugihe()
'|fffd||fffd||fffd||fffd|
'2016/11/19 Ver.1611

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        Dim n As Long
        
        n = .Range("A1").Value + 1
        
        If n > Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Range("A2").Value Then Exit Sub
        
        .Range("A1").Value = n
        n = .Range("A2").Value
        
        .Unprotect Password:="as2343t"
        
'        .Range("K4:K133").Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n + 12).Resize(130).Value
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n + 12).Resize(130).Copy
            .Range("K4").PasteSpecial Paste:=xlPasteValues
        Application.CutCopyMode = False
        
        .Protect Password:="as2343t"
    End With


End Sub

Sub maehe()
'|fffd|O|fffd||fffd|
'2016/11/26 Ver.1611

    With Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W")
        Dim n As Long
            
        n = .Range("A1").Value - 1
        
        If n < 1 Then Exit Sub
        
        .Range("A1").Value = n
         n = .Range("A2").Value
        
        .Unprotect Password:="as2343t"
        
'        .Range("K4:K133").Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n + 12).Resize(130).Value
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Cells(4, n + 12).Resize(130).Copy
            .Range("K4").PasteSpecial Paste:=xlPasteValues
        Application.CutCopyMode = False
        
        .Protect Password:="as2343t"
    End With


End Sub
Attribute VB_Name = "insatuiti"
Option Private Module
Option Explicit

Sub tyuuouiti()
'2016/11/19 Ver.1610

    Dim a As Double, b As Double
    Dim c As String, d As String
    Dim k As Long, n As Long
    
    b = Range("A31").Value
    c = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
        "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
    d = "|fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|"
        
    a = Application.InputBox(Prompt:=c, Title:=d, Default:=b, Type:=1)
    
    If a > 0 And a <= 20 Then
        ActiveSheet.Unprotect Password:="as2343t"
        Rows(29).RowHeight = a / 0.306
        Range("A31").Value = WorksheetFunction.Round(a, 1)
        ActiveSheet.Protect Password:="as2343t"
    ElseIf a <> 0 Then
        MsgBox "|fffd|l|fffd||fffd||fffd||348||353||fffd||fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub

Sub hidariiti()
'2016/11/19 Ver.1610

    Dim a As Double, b As Double
    Dim c As String, d As String
    Dim k As Long, n As Long
    
    k = Range("A7").Value
    n = ActiveSheet.Buttons(Application.Caller).TopLeftCell.Column
    
    If n < 20 Then
        b = Range("A29").Value
        c = "|fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
        d = "|fffd||fffd||fffd||292|u|fffd||fffd||fffd||fffd|"
    Else
        b = Range("A31").Value
        c = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
        d = "|fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
        
    a = Application.InputBox(Prompt:=c, Title:=d, Default:=b, Type:=1)
    
    If a > 0 And a <= 20 Then
        ActiveSheet.Unprotect Password:="as2343t"
        If n < 20 Then
            Columns("B").ColumnWidth = a * 0.86
            Range("A29").Value = WorksheetFunction.Round(a, 1)
        Else
            Columns("BX").ColumnWidth = a * 0.86
            Range("A31").Value = WorksheetFunction.Round(a, 1)
        End If
        ActiveSheet.Protect Password:="as2343t"
        
    ElseIf a <> 0 Then
        MsgBox "|fffd|l|fffd||fffd||fffd||348||353||fffd||fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If
    
End Sub

Attribute VB_Name = "keisenirohenkou"
Option Private Module
Option Explicit

Public myflg As Boolean

Sub keiseniro()
'2003/5/22
'2010/1/1 Ver.1000

'    If MsgBox("|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X|fffd||343|u|fffd|b|fffd|N|fffd|I|fffd||fffd||fffd||702||142||30a||502||fffd|1|fffd|`2|fffd||fffd||302||749||94|\|fffd||142||fffd||fffd|B" & Chr(13) & Chr(13) & _
'            "|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", _
'            vbOKCancel, "|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X") = vbOK Then
        UserForm1.Show
'    End If
End Sub

Sub keisenhutosa()
'2017/7/7 H29
'2018/3/29 H30

    Dim myWeight As Variant
    Dim k As Long
mylabel:
    myWeight = Application.InputBox("|fffd||fffd|2|fffd||fffd||fffd||30c|r|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
            "|fffd|r|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||24d||5d0||fffd||fffd|A 2 |fffd||5d0||fffd| |fffd||142||fffd||fffd|B", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|")
    If VarType(myWeight) = vbBoolean Then
        Exit Sub
    ElseIf myWeight = "1" Or myWeight = "|fffd|P" Then
        k = 1
    ElseIf myWeight = "2" Or myWeight = "|fffd|Q" Then
        k = 2
    Else
        MsgBox "|fffd||fffd||fffd||30e|w|fffd||80aa||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & Chr(13) & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
        GoTo mylabel
    End If

    
    Dim i As Long, j As Long, n As Long
    Dim myArray As Variant
    Dim ws As Worksheet, ws2 As Worksheet
'    Const k As Long = 1     '|fffd||24d||5d0||fffd|
'    Const k As Long = 2     '|fffd||5d0||fffd|
    
    Set ws = ThisWorkbook.Worksheets("|fffd|r|fffd||fffd|")
    Set ws2 = ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
    
    Application.ScreenUpdating = False
    ws2.Unprotect Password:="as2343t"
    
    For j = 1 To 2
        Select Case j
            Case 1
                n = ws.Cells(65536, 16).End(xlUp).Row
                myArray = ws.Cells(12, 16).Resize(n - 11, 14).Value
            Case 2
                n = ws.Cells(65536, 17).End(xlUp).Row
                myArray = ws.Cells(12, 16).Resize(n - 11, 14).Value
        End Select
        
        For i = 1 To UBound(myArray)
            If Not IsEmpty(myArray(i, j)) Then
                With ws2.Range(myArray(i, j))
                    If Not IsEmpty(myArray(i, 3)) Then
                        With .Borders(xlEdgeLeft)
                            .LineStyle = myArray(i, 3)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 4)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 5)) Then
                        With .Borders(xlEdgeTop)
                            .LineStyle = myArray(i, 5)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 6)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 7)) Then
                        With .Borders(xlEdgeBottom)
                            .LineStyle = myArray(i, 7)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 8)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 9)) Then
                        With .Borders(xlEdgeRight)
                            .LineStyle = myArray(i, 9)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 10)
                            End If
                        End With
                    End If
                    
'                    If Not IsEmpty(myArray(i, 11)) Then
'                        With .Borders(xlInsideVertical)
'                            .LineStyle = myArray(i, 11)
'                            If k = 2 Then
'                                .Weight = k
'                            Else
'                                .Weight = myArray(i, 12)
'                            End If
'                        End With
'                    End If
'
'                    If Not IsEmpty(myArray(i, 13)) Then
'                        With .Borders(xlInsideHorizontal)
'                            .LineStyle = myArray(i, 13)
'                            If k = 2 Then
'                                .Weight = k
'                            Else
'                                .Weight = myArray(i, 14)
'                            End If
'                        End With
'                    End If
                    
                End With
            End If
        Next i
    Next j
    
    n = ws.Range("BB65536").End(xlUp).Row
    myArray = ws.Range("BB12").Resize(n - 11, 4).Value
    
    For j = 1 To 2
        For i = 1 To UBound(myArray)
            If Not IsEmpty(myArray(i, j)) Then
                With ws2.Range(myArray(i, j))
                    If Not IsEmpty(myArray(i, 3)) Then
                        With .Borders(xlDiagonalUp)
                            .LineStyle = myArray(i, 3)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 4)
                            End If
                        End With
                    End If
                End With
            End If
        Next i
    Next j
    
    n = ws.Range("AL65536").End(xlUp).Row
    myArray = ws.Range("AL12").Resize(n - 11, 5).Value
    
    For i = 1 To UBound(myArray)
        With ws2.Range(myArray(i, 1))
            If Not IsEmpty(myArray(i, 2)) Then
                With .Borders(xlEdgeLeft)
                    .LineStyle = myArray(i, 2)
                    .Weight = k
                End With
            End If
            
            If Not IsEmpty(myArray(i, 4)) Then
                With .Borders(xlEdgeTop)
                    .LineStyle = myArray(i, 4)
                    .Weight = k
                End With
            End If
        End With
    Next i
    
    ws2.Protect Password:="as2343t"
    Application.ScreenUpdating = True
        
    Set ws = Nothing
    Set ws2 = Nothing
End Sub


'Sub keisenhutosa()
''2004/1/10
''2005/11/11 Ver.520
''2008/11/9 Ver.810
''2011/8/20 Ver.1110
''2016/11/21 Ver.1610
'
'    Dim myInp As Variant, myWeight As Variant
'    Dim myWei As Long
'mylabel:
'    myWeight = Application.InputBox("|fffd||fffd|2|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
'            "|fffd|r|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
'            "|fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||5d0||fffd||fffd|A 3 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|A 4 |fffd||fffd||fffd||251||fffd||fffd||fffd||fffd||142||fffd||fffd|B", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|")
'    If VarType(myWeight) = vbBoolean Then
'        Exit Sub
'    ElseIf myWeight = "2" Or myWeight = "|fffd|Q" Then
'        myWei = 2
'    ElseIf myWeight = "3" Or myWeight = "|fffd|R" Then
'        myWei = -4138
'    ElseIf myWeight = "4" Or myWeight = "|fffd|S" Then
'        myWei = 4
'    Else
'        MsgBox "|fffd||fffd||fffd||30e|w|fffd||80aa||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & Chr(13) & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
'        GoTo mylabel
'    End If
'
'    Dim i As Long, j As Long, k As Long, n As Long
'    Dim myArray As Variant
'    Dim ws As Worksheet, ws2 As Worksheet
'
'    On Error GoTo myErr
'
'    Set ws = Worksheets("|fffd|r|fffd||fffd|")
'    Set ws2 = Worksheets("|fffd||4d40f||fffd|")
'
'    Application.ScreenUpdating = False
'
'    ws2.Unprotect Password:="as2343t"
'
'    For j = 1 To 2
'        n = ws.Cells(65536, j).End(xlUp).Row
'        myArray = ws.Cells(12, 1).Resize(n - 11, 14).Value
'
'        For i = 1 To UBound(myArray)
'            If Not IsEmpty(myArray(i, j)) Then
'                With ws2.Range(myArray(i, j))
'                    If Not IsEmpty(myArray(i, 3)) Then
'                        If myArray(i, 4) = 4 Then
'                            .Borders(xlEdgeLeft).Weight = myWei
'                        End If
'                    End If
'
'                    If Not IsEmpty(myArray(i, 5)) Then
'                        If myArray(i, 6) = 4 Then
'                            .Borders(xlEdgeTop).Weight = myWei
'                        End If
'                    End If
'
'                    If Not IsEmpty(myArray(i, 7)) Then
'                        If myArray(i, 8) = 4 Then
'                            .Borders(xlEdgeBottom).Weight = myWei
'                        End If
'                    End If
'
'                    If Not IsEmpty(myArray(i, 9)) Then
'                        If myArray(i, 10) = 4 Then
'                            .Borders(xlEdgeRight).Weight = myWei
'                        End If
'                    End If
'
'                    If Not IsEmpty(myArray(i, 11)) Then
'                        If myArray(i, 12) = 4 Then
'                            .Borders(xlInsideVertical).Weight = myWei
'                        End If
'                    End If
'
'                    If Not IsEmpty(myArray(i, 13)) Then
'                        If myArray(i, 14) = 4 Then
'                            .Borders(xlInsideHorizontal).Weight = myWei
'                        End If
'                    End If
'
'                End With
'            End If
'        Next i
'    Next j
'
'    ws2.Protect Password:="as2343t"
'    Application.ScreenUpdating = True
'
'    Set ws = Nothing
'    Set ws2 = Nothing
'
'    MsgBox "|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
'    Exit Sub
'myErr:
'    myflg = True
'    MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|" & Chr(13) & _
'            "|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|u|fffd|b|fffd|N|fffd|j|fffd||fffd||82||fffd||fffd||fffd||fffd||fffd|A|fffd||102||44a|J|fffd||fffd||fffd||fffd|" & Chr(13) & _
'            "|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|"
'    ws2.Protect Password:="as2343t"
'    Set ws = Nothing
'    Set ws2 = Nothing
'End Sub
Attribute VB_Name = "sheetselect"
Option Private Module
Option Explicit

'Public mybk As String

Sub herupu()
'2003/5/24
'2016/12/3 Ver.1620

    Dim mybk As String
    mybk = ActiveSheet.Name
    With Worksheets("|fffd|w|fffd||fffd||fffd|v")
        .Select
        .Range("D6").Value = mybk
    End With
End Sub

Sub modoru()
    Worksheets(Range("D6").Value).Select
End Sub

Sub main()
    Worksheets("|fffd|g|fffd|b|fffd|v").Select
    Range("A5").Select
End Sub

Sub houkokusyo()
    Worksheets("|fffd||4d40f||fffd|").Select
    Range("A14").Select
End Sub

Sub soukatuhyou()
    Worksheets("|fffd||fffd||fffd||fffd||fffd|\").Select
    Range("A4").Select
End Sub

Sub tyousyuubokakunin()
'2004/1/3

    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^").Select
End Sub

Sub insatu()
'2010/1/1 Ver.1000
'2016/11/19 Ver.1610

    With ActiveSheet
'        If .Name = "|fffd||fffd||fffd||68b|L|fffd||fffd||fffd|f|fffd|[|fffd|^" Then
'            .Range("B1").Value = 1
'            .PrintPreview
'            .Range("B1").ClearContents
'        Else
            .PrintPreview
'        End If
    End With
End Sub

Sub insatusettei()
'2004/1/27 Ver.400

    UserForm2.Show
End Sub

Sub tyousyuuhyou_nyuuryoku()
'2010/1/1 Ver.1000

    UserForm3.Show
End Sub

Attribute VB_Name = "soukatu_kubun"
Option Explicit
Option Private Module

Sub kubun()
'2005/11/23 Ver.520

    With Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
        .Unprotect Password:="as2343t"
        If .Range("AM1").Value = 1 Then
            .Shapes("maru1").Visible = True
            .Shapes("maru2").Visible = False
            .Shapes("maru3").Visible = True
            .Shapes("maru4").Visible = False
        Else
            .Shapes("maru2").Visible = True
            .Shapes("maru1").Visible = False
            .Shapes("maru4").Visible = True
            .Shapes("maru3").Visible = False
        End If
        .Protect Password:="as2343t"
    End With
End Sub
Attribute VB_Name = "top_gen"
Option Private Module
Option Explicit

Public strgenFileName As String, strtyouFileName As String, strgouFileName As String, myps As String
Public aflg As Boolean

Sub mainbook()
'2016/11/19 Ver.1610
'2017/1/8 Ver.1700
'2018/1/2 Ver.1800
'2019/1/2 Ver.1900

    Dim myBook As Workbook
    Dim a As String, strinFile As String
    strtyouFileName = ThisWorkbook.Name                 '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd|
    strinFile = "gensen31"                              '|fffd||fffd||fffd|C|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
    myps = ThisWorkbook.Path                            '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||303|p|fffd|X
    
    On Error Resume Next
    If ActiveSheet.Name <> "|fffd|g|fffd|b|fffd|v" Then Worksheets("|fffd|g|fffd|b|fffd|v").Select
    For Each myBook In Workbooks
'        If myBook.Path = myps Then
            a = Workbooks(myBook.Name).Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
            If a = strinFile Then
                strgenFileName = myBook.Name            '|fffd||fffd||fffd|C|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd|
                ThisWorkbook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("D5").Value = strgenFileName
                myBook.Activate
                Exit Sub
            End If
            a = ""
'        End If
    Next
    
    MsgBox "|fffd||fffd||fffd||9294e||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd||fffd||fffd|C|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKOnly, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd|m|fffd|F"
        
End Sub

Sub passhozon()

    DoEvents
    UserForm3.Show
End Sub
Attribute VB_Name = "top_nenkousin"
Option Explicit
Option Private Module

Sub nendokousin()
'2017/1/8 Ver.1700
'2018/1/2 Ver.1800
'2019/1/8 Ver.1900
    
    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim i As Long, n As Long
    Dim myMsg As String
    Dim mysht As Worksheet, myshs As Worksheet, myshd As Worksheet
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = "tyousyuuhyou30" Then                         '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    ThisWorkbook.Activate
    
    On Error GoTo 0
    If hn = "tyousyuuhyou30" Then                                     '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
        If h >= 1800 And h < 1900 Then                           '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd|N|fffd|x|fffd|X|fffd|V|fffd|m|fffd|F") = vbYes Then
                
                Set mysht = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshs = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                Set myshd = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                
                Application.ScreenUpdating = False
                                
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
'                    .Unprotect Password:="2343t"
'                    .Range("G7") = mysht.Range("G7").Value
                    .Range("E10") = mysht.Range("E10").Value
                    .Range("E12") = mysht.Range("E12").Value
                    .Range("E14") = mysht.Range("E14").Value
                    .Range("E18:L18") = mysht.Range("E18:L18").Value
                    .Range("E19:E34") = mysht.Range("E19:E34").Value
                    .Range("E35:Q35") = mysht.Range("E35:Q35").Value
'                    .Protect Password:="2343t"
'                    .Activate
                End With
                
                With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
'                    .Unprotect Password:="as2343t"
'                    .Range("E9") = myshs.Range("E9").Value
'                    .Range("G9") = myshs.Range("G9").Value
'                    .Range("I9") = myshs.Range("I9").Value
'                    .Range("K11") = myshs.Range("K11").Value
'                    .Range("N11") = myshs.Range("N11").Value
'                    .Range("R11") = myshs.Range("R11").Value
                    .Range("I21") = myshs.Range("I21").Value
                    .Range("L26") = myshs.Range("L26").Value
                    .Range("L27") = myshs.Range("L27").Value
'                    .Range("AB17") = myshs.Range("AB17").Value
'                    .Range("AB18") = myshs.Range("AB18").Value
'                    .Range("AB20") = myshs.Range("AB20").Value
                    .Range("AB23") = myshs.Range("AB23").Value
                    .Range("AB24") = myshs.Range("AB24").Value
                    .Range("AB25") = myshs.Range("AB25").Value
                    .Range("AB26") = myshs.Range("AB26").Value
'                    If .Range("AM1").Value = 1 Then
'                        .Shapes("maru1").Visible = True
'                        .Shapes("maru2").Visible = False
'                        .Shapes("maru3").Visible = True
'                        .Shapes("maru4").Visible = False
'                    Else
'                        .Shapes("maru2").Visible = True
'                        .Shapes("maru1").Visible = False
'                        .Shapes("maru4").Visible = True
'                        .Shapes("maru3").Visible = False
'                    End If
'                    .Protect Password:="as2343t"
'                    .Activate
                End With
                
                
                 With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
                    .Unprotect Password:="as2343t"
                    
'                    .Range("A1").Value = myshd.Range("A1").Value
                    myshd.Range("A5:B235").Copy
                        .Range("A5").PasteSpecial Paste:=xlPasteValues
                    myshd.Range("M5:IH133").Copy
                        .Range("M5").PasteSpecial Paste:=xlPasteValues
                    
                    Application.CutCopyMode = False
                    
                    .Range("M12:IV75").ClearContents        '2019/1/2 Ver.1900 12:41-12:75
'                    .Range("M44:IV75").ClearContents
                    
                    .Protect Password:="as2343t"
                End With
                
                
                
                With ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
                    .Unprotect Password:="as2343t"
                    .Range("A36").Value = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A36").Value  '|fffd|Y|fffd||fffd||fffd|L|fffd||fffd|
                    .Range("A2:D10") = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A2:D10").Value    '|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N Ver.1610
                    
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set mysht = Nothing
                Set myshs = Nothing
                Set myshd = Nothing
            End If
        Else
            MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd|"
        End If
    Else
        MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub
Attribute VB_Name = "torikomi_1"
Option Private Module
Option Explicit

Sub torikomi()
'2003/5/18
'2009/11/22 Ver.911

'    Application.ScreenUpdating = False
    mainbook
    If ActiveWorkbook.Name = ThisWorkbook.Name Then
'        Application.ScreenUpdating = True
        MsgBox "|fffd||fffd||835e||fffd||742||343|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        Exit Sub
    Else
        ThisWorkbook.Activate
        tyoutorikomi
    End If
End Sub

Sub tyoutorikomi()
'2016/11/25 Ver.1610
'2016/11/28 Ver.1613
'2017/10/19 Ver.1702
'2018/1/2 Ver.1800

    Dim mysht As Worksheet, myshdat As Worksheet
    Dim a As String
    Dim n As Long, i As Long
    Dim b As Variant, c As Variant
    
    a = ThisWorkbook.Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("D5").Value
    Set mysht = Workbooks(a).Worksheets("|fffd|g|fffd|b|fffd|v")
    Set myshdat = Workbooks(a).Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
    n = myshdat.Range("D24").Value - 18
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
'        .Unprotect Password:="as2343t"
'        .Range("G7") = mysht.Range("G7").Value
        .Range("E10") = mysht.Range("E10").Value
        .Range("E12") = mysht.Range("E12").Value
        .Range("E14") = mysht.Range("E14").Value
        .Range("E18:L18") = mysht.Range("E18:L18").Value
        .Range("E19:E34") = mysht.Range("E19:E34").Value
'        .Range("E35:Q35") = mysht.Range("E35:Q35").Value
'        .Protect Password:="as2343t"
'        .Activate
    End With
    
    With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^")
        .Unprotect Password:="as2343t"

        If n < 230 Then .Cells(5, n + 13).Resize(129, 230 - n).ClearContents    'Ver.1702
        
        If n > 0 Then
            b = myshdat.Cells(701, 19).Resize(, n).Value
            c = .Range("M5").Resize(, n).Value
            
            myshdat.Range("D31:D260").Copy
                .Range("A5").PasteSpecial Paste:=xlPasteValues
            myshdat.Range("G31:G260").Copy
                .Range("B5").PasteSpecial Paste:=xlPasteValues
            .Range("M5:IV13").ClearContents
            .Range("M15:IV17").ClearContents
            .Range("M19:IV41").ClearContents
            .Range("M44:IV76").ClearContents
        
            myshdat.Cells(701, 19).Resize(9, n).Copy
                .Range("M5").PasteSpecial Paste:=xlPasteValues         'Ver.1610
            myshdat.Cells(711, 19).Resize(3, n).Copy
                .Range("M15").PasteSpecial Paste:=xlPasteValues         'Ver.1610
            myshdat.Cells(715, 19).Resize(58, n).Copy
                .Range("M19").PasteSpecial Paste:=xlPasteValues         'Ver.1610   'Ver.1800
'            myshdat.Cells(740, 19).Resize(33, n).Copy
'                .Range("M44").PasteSpecial Paste:=xlPasteValues         'Ver.1610   'Ver.1800
            
            Application.CutCopyMode = False
            
            If n = 1 Then
                If b <> c Then
                    .Cells(14, 13).ClearContents
                    .Cells(18, 13).ClearContents
'                    .Cells(42, 13).Resize(2).ClearContents      'Ver.1800
                    .Cells(77, 13).Resize(57).ClearContents
                End If
                
            ElseIf n > 1 Then
                For i = 1 To n
                    If b(1, i) <> c(1, i) Then
                        .Cells(14, i + 12).ClearContents
                        .Cells(18, i + 12).ClearContents
'                        .Cells(42, i + 12).Resize(2).ClearContents
                        .Cells(77, i + 12).Resize(57).ClearContents
                    End If
                Next i
            End If
        
            ThisWorkbook.Worksheets("|fffd||4d40f||fffd|").Range("A1").Value = 1
            ThisWorkbook.Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W").Range("A1").Value = 1
        
        Else
            ThisWorkbook.Worksheets("|fffd||4d40f||fffd|").Range("A1").Value = 0
            ThisWorkbook.Worksheets("|fffd|f|fffd|[|fffd|^|fffd||48f|W").Range("A1").Value = 0
        End If
                
        .Protect Password:="as2343t"
        .Activate
    End With
    
    ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
    Application.ScreenUpdating = True
    Set mysht = Nothing
    Set myshdat = Nothing
End Sub



INQUEST-PP=macro
