Attribute VB_Name = "FormMsgApo"
Attribute VB_Base = "0{580689BC-63D2-4AF0-A013-4517E02D5E29}{C57C6DEC-E263-429A-A6B8-8189D890BCB4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ButtonCloseForm_Click()
Unload Me
'UserForm1.Show 0
End Sub

Private Sub LabelEmail_Click()
    f_CopyToClipboard LabelEmail
    Me.Label9 = "Sent to the clipboard"
    Me.LabelEmail.ForeColor = &H80000002
End Sub

Private Sub UserForm_Initialize()
    Me.Label9 = "Click on email to send to the clipboard"
    Me.LabelEmail.ForeColor = &H8000000D
End Sub
Attribute VB_Name = "FuncionesAPO"

Public Function f_SpeechSpeak(ByVal msgText As String) As Integer
MsgBox msgText
Exit Function
Dim Voc As SpeechLib.SpVoice
Set Voc = New SpVoice
Voc.GetVoices
Voc.Speak "Hola a todos"
'Application.Speech.Speak msgText, True
End Function

Public Function f_ButtonYesNoFrames(ByRef v_ButtonYesNoFrames As Object, ByRef v_LabelYesNoFrames As Object)
If v_ButtonYesNoFrames Then
    v_LabelYesNoFrames = "Frames"
Else
    v_LabelYesNoFrames = "No Frames"
End If
End Function


Public Function f_SpinButtonRef(ByRef v_SpinButtonSystemRef As Object, v_TextBoxSystemRef As Object, v_TextBoxValueRef As Object) As Double


    Select Case v_SpinButtonSystemRef   ' Evaluate Number.
    Case 1     ' Number between 1 and 5, inclusive.
        v_TextBoxSystemRef = "CINE 23'98 fps"
        v_TextBoxValueRef = 23.98
    Case 2     ' Number between 1 and 5, inclusive.
        v_TextBoxSystemRef = "CINE 24 fps"
        v_TextBoxValueRef = 24
    Case 3    ' Number between 6 and 8.
        v_TextBoxSystemRef = "PAL 25 fps"
        v_TextBoxValueRef = 25
    Case 4    ' Number is 9 or 10.
        v_TextBoxSystemRef = "NTSC 29'97 fps"
        v_TextBoxValueRef = 29.97
    Case 5    ' Number is 9 or 10.
        v_TextBoxSystemRef = "NTSC 30 fps"
        v_TextBoxValueRef = 30
    Case 6    ' Number is 9 or 10.
        v_TextBoxSystemRef = "PAL 50 fps"
        v_TextBoxValueRef = 50
    Case 7    ' Number is 9 or 10.
        v_TextBoxSystemRef = "NTSC 59'97 fps"
        v_TextBoxValueRef = 59.97
    Case 8    ' Number is 9 or 10.
        v_TextBoxSystemRef = "NTSC 60 fps"
        v_TextBoxValueRef = 60
    End Select
    
End Function

Private Function f_Str2Ascii()
    MyString = ActiveCell
    For Counter = 1 To Len(MyString)
        'do something to each character in string
        'here we'll msgbox each character
        Ascii = Ascii & " " & Asc(Mid(MyString, Counter, 1))
    Next
    MsgBox Ascii
End Function

Public Function f_CopyToClipboard(ByVal labelName As String) As Integer
Dim clipboard As MSForms.DataObject
Dim strSample As String

Set clipboard = New MSForms.DataObject
    
    strSample = CStr(labelName)
    clipboard.SetText strSample
    clipboard.PutInClipboard
    f_CopyToClipboard = 0

End Function
Public Function f_CopyFromClipboard() As String
Dim clipboard As MSForms.DataObject
Dim strSample As String
Set clipboard = New MSForms.DataObject

    clipboard.GetFromClipboard
    strSample = clipboard.GetText
    f_CopyFromClipboard = strSample

End Function


Private Sub f_buscaMMSS()
Dim valueTMP As String
'On Error Resume Next

    MyString = ActiveCell
    For Counter = 1 To Len(MyString)
        Ascii = Asc(Mid(MyString, Counter, 1))
        If Not (Not Ascii >= 48 Or Not Ascii <= 57) Then MsgBox "Es n|fffd|mero  " & Chr(Ascii)
    Next
    
    
    If InStr(ActiveCell, "/") Or InStr(ActiveCell, "\") Or InStr(ActiveCell, "-") Or InStr(ActiveCell, "_") Or InStr(ActiveCell, ";") Then
        MsgBox "Formato no soportado."
    Else
        MsgBox "OK"
    End If
    Exit Sub
    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            numToConvert = .Text
            valueTMP = f_detectFormatTC(numToConvert)
            obj_Cell.Value = valueTMP
        End With
    Next
End Sub


Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "M|fffd|dulo1"
Sub OpenUserForm1(Registro1 As IRibbonControl)
UserForm1.Show 0
End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{DA4483B3-F3AB-411F-A4EA-2811B92E7A41}{09C6E2E6-4554-47AC-86B0-BCF0EFFFAC2B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'---------------------------------------------------------------------------------------------------------- Variables Globales
Public ButtonYesNoFrames, v_LabelSuma1, v_LabelSuma2, v_LabelSuma3 As Boolean
Public rowNumm, colNum, rowLim As Double
Public flagTarget As Boolean
Public RangoTC As Range
Public flagSelectionChange As Integer
Public zoomTMP As Single
Public zoomFlag As Boolean
Public v_Suma1, v_Suma2, v_Suma3 As Integer
Public TimeLock As String
Public TextBoxZoomFlag As Integer
Public TextBoxInsertExtractFlag As Integer
Public TextBoxInRef
Public TextBoxInFlag As Integer

'---------------------------------------------------------------------------------------------------------- Constantes Globales
Const Phi = 1.61803
Const FormWidth = 695
Const FormHeight = 280
Const msgErr1 = "The data does not have the correct format"
Const msgErr2 = "Number out of range"





'---------------------------------------------------------------------------------------------------------- Function f_InsertaZero(ByVal insertPos As Integer)
Public Function f_InsertaZero(ByVal insertPos As Integer)
Dim obj_Cell As Range
   
On Error Resume Next

    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            numToConvert = .Text
            numToConvert = f_FormatNumTo00000000(numToConvert)
            If numToConvert = "Error" Then GoTo LabelNo
            If Len(numToConvert) = 8 And Mid(numToConvert, 1, 1) >= 1 And Mid(numToConvert, 1, 1) <= 9 And Not ButtonYesNoRequest Then
                MyNote1 = "With this action you will lose the eighth digit (" & Left(numToConvert, 1) & ")" & Chr(13) & "of the Time Code number: " & numToConvert
                MyNote2 = Chr(13) & Chr(13) & "Do you want continue?"
                Answer = MsgBox(MyNote1 & MyNote2, vbQuestion + vbYesNo, "|fffd||fffd|Attention!!")
                If Answer = vbNo Then
                    GoTo LabelNo
                End If
            End If
                obj_Cell = Right("00000000" & Left(numToConvert, insertPos) & "0" & Right(numToConvert, 8 - insertPos), 8)
LabelNo:
        End With
    Next
    TextBoxInsertExtractFlag = 0
End Function
'---------------------------------------------------------------------------------------------------------- Function f_ExtraeZero(ByVal ExtraePos As Integer)
Public Function f_ExtraeZero(ByVal ExtraePos As Integer)
Dim obj_Cell As Range
   
On Error Resume Next

    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            numToConvert = .Text
            numToConvert = f_FormatNumTo00000000(numToConvert)
            If numToConvert = "Error" Then GoTo LabelNo
            If Mid(numToConvert, ExtraePos, 1) <> 0 And Not ButtonYesNoRequest Then
                MyNote1 = "The digit number " & (9 - ExtraePos) & " with value " & Mid(numToConvert, ExtraePos, 1) & Chr(13)
                MyNote2 = "will be delete from Time Code." & Chr(13) & Chr(13) & "Do you want continue?"
                Answer = MsgBox(MyNote1 & MyNote2, vbQuestion + vbYesNo, "|fffd||fffd|Attention!!")
                If Answer = vbNo Then GoTo LabelNo
            End If
                obj_Cell = Right("00000000" & Left(numToConvert, ExtraePos - 1) & Right(numToConvert, 8 - ExtraePos), 8)

LabelNo:
        End With
    Next
    TextBoxInsertExtractFlag = 0
End Function
'---------------------------------------------------------------------------------------------------------- ButtonAbreFormMsgApo_Click
Private Sub ButtonAbreFormMsgApo_Click()
FormMsgApo.Show 0
'Unload Me
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonDeleteAllRef1_Click
Private Sub ButtonDeleteAllRef1_Click()
TextBoxInRef = TextBoxValueRef4
f_changeColorsInputBox
TextBoxFramesTcRef2 = 0
TextBoxSecondsTcRef2 = 0
TextBoxTimeCodeRef2 = "00:00:00:00"
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonDeleteAllRef2_Click
Private Sub ButtonDeleteAllRef2_Click()
TextBoxInRef = TextBoxValueRef4
f_changeColorsInputBox
TextBoxFramesTcRef2 = 0
TextBoxSecondsTcRef2 = 0
TextBoxTimeCodeRef2 = "00:00:00:00"
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonDeleteAllRef3_Click
Private Sub ButtonDeleteAllRef3_Click()
TextBoxInRef = TextBoxValueRef4
f_changeColorsInputBox
TextBoxFramesTcRef2 = 0
TextBoxSecondsTcRef2 = 0
TextBoxTimeCodeRef2 = "00:00:00:00"
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonFormatCells_Click
Private Sub ButtonFormatCells_Click()
Dim obj_Cell As Range
   
On Error Resume Next
n = 0
    If Selection.Count > 1000 Then
        MsgBox "You have selected too many cells " & Chr(13) & " Select blocks of 1000 cells maximum"
        Exit Sub
    End If
     
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            If .Text = "" Then
                obj_Cell.VerticalAlignment = xlCenter
                obj_Cell.HorizontalAlignment = xlCenter
                obj_Cell.NumberFormat = "00\:00\:00\:00"
                obj_Cell.Value = ""
            Else
                n = 1
            End If
        End With
    Next
    If n Then Beep
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract1_Click
Private Sub ButtonExtract1_Click()
Dim ExtractPos As Integer
ExtractPos = 8
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert1_Click
Private Sub ButtonInsert1_Click()
Dim insertPos As Integer
insertPos = 8
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract2_Click
Private Sub ButtonExtract2_Click()
Dim ExtractPos As Integer
ExtractPos = 7
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert2_Click
Private Sub ButtonInsert2_Click()
Dim insertPos As Integer
insertPos = 7
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract3_Click
Private Sub ButtonExtract3_Click()
Dim ExtractPos As Integer
ExtractPos = 6
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert3_Click
Private Sub ButtonInsert3_Click()
Dim insertPos As Integer
insertPos = 6
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract4_Click
Private Sub ButtonExtract4_Click()
Dim ExtractPos As Integer
ExtractPos = 5
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert4_Click
Private Sub ButtonInsert4_Click()
Dim insertPos As Integer
insertPos = 5
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract5_Click
Private Sub ButtonExtract5_Click()
Dim ExtractPos As Integer
ExtractPos = 4
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert5_Click
Private Sub ButtonInsert5_Click()
Dim insertPos As Integer
insertPos = 4
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract6_Click
Private Sub ButtonExtract6_Click()
Dim ExtractPos As Integer
ExtractPos = 3
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert6_Click
Private Sub ButtonInsert6_Click()
Dim insertPos As Integer
insertPos = 3
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract7_Click
Private Sub ButtonExtract7_Click()
Dim ExtractPos As Integer
ExtractPos = 2
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert7_Click
Private Sub ButtonInsert7_Click()
Dim insertPos As Integer
insertPos = 2
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonExtract8_Click
Private Sub ButtonExtract8_Click()
Dim ExtractPos As Integer
ExtractPos = 1
TextBoxInsertExtractFlag = 1
f_ExtraeZero ExtractPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonInsert8_Click
Private Sub ButtonInsert8_Click()
Dim insertPos As Integer
insertPos = 1
TextBoxInsertExtractFlag = 1
f_InsertaZero insertPos
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonLimpiar_DblClick
Private Sub ButtonLimpiar_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    MyNote = "This acction will erase all sheet data forever" & Chr(13) & "and you will never see them again." & Chr(13) & Chr(13) & "Do you want continue?"
    Answer = MsgBox(MyNote, vbQuestion + vbYesNo, "|fffd||fffd|Attention!!")
    If Answer = vbNo Then
        Exit Sub
    Else
        ActiveSheet.Cells.ClearContents
        f_Format
    End If
End Sub

Private Sub ButtonYesNoFrames4_Click()
ButtonYesNoFrames = ButtonYesNoFrames4
f_ButtonYesNoFrames ButtonYesNoFrames4, LabelYesNoFrames4
End Sub

'---------------------------------------------------------------------------------------------------------- ButtonYesNoRequest_Click
Private Sub ButtonYesNoRequest_Click()
If ButtonYesNoRequest Then
    LabelYesNoAnswer.ForeColor = RGB(&HFF, &H40, &H40)
    LabelYesNoAnswer = "|fffd||fffd|Request confirmation disabled!!"
Else
    LabelYesNoAnswer.ForeColor = &H80000012
    LabelYesNoAnswer = "Request confirmation enable"
End If
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonYesNoFrames1_Click
Private Sub ButtonYesNoFrames1_Click()
ButtonYesNoFrames = ButtonYesNoFrames1
f_ButtonYesNoFrames ButtonYesNoFrames1, LabelYesNoFrames1
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonYesNoFrames2_Click
Private Sub ButtonYesNoFrames2_Click()
ButtonYesNoFrames = ButtonYesNoFrames2
f_ButtonYesNoFrames ButtonYesNoFrames2, LabelYesNoFrames2
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonYesNoFrames3_Click
Private Sub ButtonYesNoFrames3_Click()
ButtonYesNoFrames = ButtonYesNoFrames3
f_ButtonYesNoFrames ButtonYesNoFrames3, LabelYesNoFrames3
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonClearBoxTotalTC_Click
Private Sub ButtonClearBoxTotalTC_Click()
TextBoxTC1 = "00:00:00:00"
TextBoxTC2 = "00:00:00:00"
TextBoxTC3 = "00:00:00:00"
TextBoxTotalTC = "00:00:00"
TextBoxSecondsTcRef = 0
TextBoxFramesTcRef = 0
TextBoxTimeCodeRef = "00:00:00:00"
TextBoxTotalTC.ForeColor = &H80000010

End Sub
'---------------------------------------------------------------------------------------------------------- ButtonClearBoxTC1_Click
Private Sub ButtonClearBoxTC1_Click()
TextBoxTC1 = "00:00:00:00"
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonClearBoxTC2_Click
Private Sub ButtonClearBoxTC2_Click()
TextBoxTC2 = "00:00:00:00"
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonClearBoxTC3_Click
Private Sub ButtonClearBoxTC3_Click()
TextBoxTC3 = "00:00:00:00"
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonTC1_Click
Private Sub ButtonTC1_Click()
Dim framesRef As Double

    ButtonYesNoFrames = ButtonYesNoFrames1
    framesRef = TextBoxValueRef1 'Formatos: PAL 25, NTSC 30, CINE 24
    TextBoxTC1 = f_CalculateRangeTC(framesRef)
    f_SumaTotalTC
    UserForm_Click
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonTC2_Click
Private Sub ButtonTC2_Click()
Dim framesRef As Double

    ButtonYesNoFrames = ButtonYesNoFrames2
    framesRef = TextBoxValueRef2 'Formatos: PAL 25, NTSC 30, CINE 24
    TextBoxTC2 = f_CalculateRangeTC(framesRef)
    f_SumaTotalTC
    UserForm_Click
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonTC3_Click
Private Sub ButtonTC3_Click()
Dim framesRef As Double

    ButtonYesNoFrames = ButtonYesNoFrames3
    framesRef = TextBoxValueRef3    'Formatos: PAL 25, NTSC 30, CINE 24...
    TextBoxTC3 = f_CalculateRangeTC(framesRef)
    f_SumaTotalTC
    UserForm_Click
End Sub
'---------------------------------------------------------------------------------------------------------- f_CalculateRangeTC
Public Function f_CalculateRangeTC(ByVal framesRef1 As Double) As String

' variable de tipo Range para hacer referencia a las celdas
Dim obj_Cell As Range
Dim sumaTotalFrames As Double
sumaTotalFrames = 0
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            sumaTotalFrames = sumaTotalFrames + f_CalculateTcInFrames(.Text, framesRef1)
        End With
    Next
    f_CalculateRangeTC = f_ConvertFramesTo_HHMMSSFF(sumaTotalFrames, framesRef1)    'Sal de la funci|fffd|n y devuelve valor formateado a HHMMSSFF
End Function
'---------------------------------------------------------------------------------------------------------- f_SumaTotalTC
Public Function f_SumaTotalTC() As Integer
Dim sumaTotalTempInSeconds As Double
sumaTotalTempInSeconds = 0

    sumaTotalTempInSeconds = v_Suma1 * f_CalculateTcInSeconds(TextBoxTC1, TextBoxValueRef1) + v_Suma2 * f_CalculateTcInSeconds(TextBoxTC2, TextBoxValueRef2) + v_Suma3 * f_CalculateTcInSeconds(TextBoxTC3, TextBoxValueRef3)
    If sumaTotalTempInSeconds < 0 Then
        TextBoxTotalTC.ForeColor = RGB(&HFF, &H70, &H70)
    Else
        TextBoxTotalTC.ForeColor = &H80000010
    End If
    
    TextBoxTotalTC = f_ConvertSecondsTo_HHMMSS(Abs(sumaTotalTempInSeconds), TextBoxValueRef4)
    TextBoxSecondsTcRef = Round(Abs(sumaTotalTempInSeconds), 3)
    TextBoxFramesTcRef = Round(Abs(sumaTotalTempInSeconds * TextBoxValueRef4), 3)
    TextBoxTimeCodeRef = f_ConvertSecondsTo_HHMMSSFF(Abs(sumaTotalTempInSeconds), TextBoxValueRef4)

End Function
'---------------------------------------------------------------------------------------------------------- f_CalculateTcInFrames
Public Function f_CalculateTcInFrames(ByVal numToConvert As String, ByVal framesRef2 As Double) As Double
Dim fra2f, seg2f, min2f, hor2f As Double
fra2f = 0
seg2f = 0
min2f = 0
hor2f = 0

On Error GoTo ErrorHandler

    'Formateamos a 00000000
    numToConvert = f_FormatNumTo00000000(numToConvert)
    If numToConvert = "Error" Then Exit Function
        
    fra2f = Mid(numToConvert, 7, 2)                       'Pasa frames a frames
    seg2f = Mid(numToConvert, 5, 2) * (framesRef2)        'Pasa segundos a frames
    min2f = Mid(numToConvert, 3, 2) * (60 * framesRef2)   'Pasa minutos a frames
    hor2f = Mid(numToConvert, 1, 2) * (3600 * framesRef2) 'Pasa horas a frames
    sumaFrames = hor2f + min2f + seg2f + fra2f

    f_CalculateTcInFrames = sumaFrames        'Salimos de la funci|fffd|n y devolvemos el valor.

    Exit Function


ErrorHandler:
    If Err.Number Then
        Msg = "Error2 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
End Function
'---------------------------------------------------------------------------------------------------------- f_CalculateTcInSeconds
Public Function f_CalculateTcInSeconds(ByVal numToConvert As String, ByVal framesRef5 As Double) As Double
Dim fra2s, seg2s, min2s, hor2s As Double
fra2s = 0
seg2s = 0
min2s = 0
hor2s = 0

On Error GoTo ErrorHandler

    numToConvert = f_FormatNumTo00000000(numToConvert)
    
    fra2s = Mid(numToConvert, 7, 2) / framesRef5            'Pasa frames a segundos
    seg2s = Mid(numToConvert, 5, 2)                         'Pasa segundos a segundos
    min2s = Mid(numToConvert, 3, 2) * 60                    'Pasa minutos a segundos
    hor2s = Mid(numToConvert, 1, 2) * 3600                  'Pasa horas a segundos
    
    'MsgBox "hor2s min2s seg2s fra2s -> " & hor2s & "  " & min2s & "  " & seg2s & "  " & fra2s
    
    'Sal de la funci|fffd|n y devuelve valor.
    f_CalculateTcInSeconds = hor2s + min2s + seg2s + fra2s    'Suma todos los segundos
    Exit Function


ErrorHandler:
    If Err.Number Then
        Msg = "Error2 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
End Function
'---------------------------------------------------------------------------------------------------------- f_ConvertFramesTo_HHMMSSFF
Public Function f_ConvertFramesTo_HHMMSSFF(ByVal numToConvertInFrames As Double, ByVal framesRef3 As Double) As String
Dim f2fra, f2seg, f2min, f2hor, TimeCodeTMP, cocient As Double
f2fra = 0
f2seg = 0
f2min = 0
f2hor = 0

On Error GoTo ErrorHandler
    
    'El parametro pasado est|fffd| todo en frames.
    TimeCodeTMP = numToConvertInFrames

    f2hor = Int(TimeCodeTMP / (3600 * framesRef3))                 'Obten parte entera horas
    TimeCodeTMP = TimeCodeTMP - (3600 * framesRef3 * f2hor)   'Obten resto
    f2min = Int(TimeCodeTMP / (60 * framesRef3))                            'Obten parte entera minutos
    TimeCodeTMP = TimeCodeTMP - (60 * framesRef3 * f2min)             'Obten resto
    f2seg = Int(Round(TimeCodeTMP / framesRef3, 3))                           'Obten parte entera segundos
    TimeCodeTMP = TimeCodeTMP - (framesRef3 * f2seg)               'Obten resto
    f2fra = Int(Round(TimeCodeTMP, 3))                                           'Obten frames

    'Formatea a 00:00:00:00
    f_ConvertFramesTo_HHMMSSFF = Right("00" & f2hor, 2) & ":" & Right("00" & f2min, 2) & ":" & Right("00" & f2seg, 2) & ":" & Right("00" & f2fra, 2)
    Exit Function
    
ErrorHandler:
    If Err.Number <> 5000 Then
        Msg = "Error3 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
End Function
'---------------------------------------------------------------------------------------------------------- f_ConvertSecondsTo_HHMMSS
Public Function f_ConvertSecondsTo_HHMMSS(ByVal numToConvertInSeconds As Double, ByVal framesRef4 As Double) As String
Dim s2fra, s2seg, s2min, s2hor, TimeCodeTMP As Double
s2fra = 0
s2seg = 0
s2min = 0
s2hor = 0
TimeCodeTMP = 0
 
On Error GoTo ErrorHandler

    'El parametro pasado est|fffd| todo en segundos con decimales por los frames.
    TimeCodeTMP = numToConvertInSeconds
    s2hor = Int(TimeCodeTMP / 3600)               'Obten horas
    TimeCodeTMP = TimeCodeTMP - (3600 * s2hor)   'Obten resto
    s2min = Int(TimeCodeTMP / 60)               'Obten minutos
    TimeCodeTMP = TimeCodeTMP - (60 * s2min)   'Obten resto
    s2seg = Int(Round(TimeCodeTMP, 3))              'Obten segundos redondeados
    
    
    'Formatea a 00:00:00
    f_ConvertSecondsTo_HHMMSS = Right("00" & s2hor, 2) & ":" & Right("00" & s2min, 2) & ":" & Right("00" & s2seg, 2)
    Exit Function
    
ErrorHandler:
    If Err.Number <> 5000 Then
        Msg = "Error3 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
End Function
'---------------------------------------------------------------------------------------------------------- f_ConvertSecondsTo_HHMMSSFF
Public Function f_ConvertSecondsTo_HHMMSSFF(ByVal numToConvertInSeconds As Double, ByVal framesRef4 As Double) As String
Dim s2fra, s2seg, s2min, s2hor, TimeCodeTMP As Double
s2fra = 0
s2seg = 0
s2min = 0
s2hor = 0
TimeCodeTMP = 0
 
On Error GoTo ErrorHandler

    'El parametro pasado est|fffd| todo en segundos con decimales por los frames.
    TimeCodeTMP = numToConvertInSeconds
        
    s2hor = Int(TimeCodeTMP / 3600)             'Obten horas
    TimeCodeTMP = TimeCodeTMP - (3600 * s2hor)  'Obten resto
    s2min = Int(TimeCodeTMP / 60)               'Obten minutos
    TimeCodeTMP = TimeCodeTMP - (60 * s2min)    'Obten resto
    s2seg = Int(TimeCodeTMP)                    'Obten segundos redondeado
    TimeCodeTMP = TimeCodeTMP - (s2seg)   'Obten resto
    s2fra = Int(Round(TimeCodeTMP * framesRef4, 0))        'Obten segundos redondeados
    
    
    'Formatea a 00:00:00
    f_ConvertSecondsTo_HHMMSSFF = Right("00" & s2hor, 2) & ":" & Right("00" & s2min, 2) & ":" & Right("00" & s2seg, 2) & ":" & Right("00" & s2fra, 2)
    Exit Function
    
ErrorHandler:
    If Err.Number <> 5000 Then
        Msg = "Error3 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
End Function
'---------------------------------------------------------------------------------------------------------- f_ConvertHHMMSSFF_ToSeconds
Public Function f_ConvertHHMMSSFF_ToSeconds(ByVal Num_HHMMSSFF As String, ByVal ValueRef As Double) As Double
Dim fra2s, seg2s, min2s, hor2s As Double
fra2s = 0
seg2s = 0
min2s = 0
hor2s = 0
On Error GoTo ErrorHandler
    fra2s = Mid(Num_HHMMSSFF, 7, 2) / ValueRef              'Pasa frames a segundos
    seg2s = Mid(Num_HHMMSSFF, 5, 2)                         'Pasa segundos a segundos
    min2s = Mid(Num_HHMMSSFF, 3, 2) * 60                    'Pasa minutos a segundos
    hor2s = Mid(Num_HHMMSSFF, 1, 2) * 3600                  'Pasa horas a segundos
    
    f_ConvertHHMMSSFF_ToSeconds = hor2s + min2s + seg2s + fra2s    'Suma todos los segundos
    Exit Function

ErrorHandler:
    If Err.Number <> 5000 Then
        Msg = "Error3 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If

End Function
'---------------------------------------------------------------------------------------------------------- f_ConvertHHMMSSFF_ToFrames
Public Function f_ConvertHHMMSSFF_ToFrames(ByVal Num_HHMMSSFF As String, ByVal ValueRef As Double) As Double
Dim fra2s, seg2s, min2s, hor2s As Double
fra2f = 0
seg2f = 0
min2f = 0
hor2f = 0
On Error GoTo ErrorHandler

    numToConvert = f_FormatNumTo00000000(Num_HHMMSSFF)

    'fra2f = Mid(Num_HHMMSSFF, 7, 2)                                     'Pasa frames a segundos
    'seg2f = Mid(Num_HHMMSSFF, 5, 2) * ValueRef                          'Pasa segundos a segundos
    'min2f = Mid(Num_HHMMSSFF, 3, 2) * (60 * ValueRef)                     'Pasa minutos a segundos
    'hor2f = Mid(Num_HHMMSSFF, 1, 2) * (3600 * ValueRef)                   'Pasa horas a segundos
    
    fra2f = Mid(numToConvert, 7, 2)                         'Pasa frames a frames
    seg2f = Mid(numToConvert, 5, 2) * (ValueRef)            'Pasa segundos a frames
    min2f = Mid(numToConvert, 3, 2) * (60 * ValueRef)       'Pasa minutos a frames
    hor2f = Mid(numToConvert, 1, 2) * (3600 * ValueRef)     'Pasa horas a frames
    sumaFrames = hor2f + min2f + seg2f + fra2f
    
    
    f_ConvertHHMMSSFF_ToFrames = sumaFrames             'Suma todos los frames
    Exit Function

ErrorHandler:
    If Err.Number <> 5000 Then
        Msg = "Error3 # " & Str(Err.Number) & " was generated by " & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
        MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If

End Function
'---------------------------------------------------------------------------------------------------------- ButtonFormatMinSec_Click
Private Sub ButtonFormatMinSec_Click()
    Selection.Cells.VerticalAlignment = xlCenter
    Selection.Cells.HorizontalAlignment = xlCenter
    Selection.Cells.NumberFormat = "@"
End Sub
'---------------------------------------------------------------------------------------------------------- f_detectFormatTC
Public Function f_detectFormatTC(ByVal valueToDetect As String) As String
Dim addTMP1, addTMP2 As Double


    If InStr(valueToDetect, ":") Or InStr(valueToDetect, ",") Or InStr(valueToDetect, ".") Then
        f_detectFormatTC = valueToDetect
        Exit Function
    End If
    'Elimina car|fffd|cteres no validos
    ActiveCellTMP = f_FormatNumTo00000000(valueToDetect)
          
    'Busca Horas y pasa a segundos
    h_TMP = InStr(UCase(ActiveCellTMP), "H")
    If h_TMP Then
        addTMP1 = Right("00" & Mid(ActiveCellTMP, 1, h_TMP - 1), h_TMP - 1)
        addTMP2 = addTMP1 * 3600
        valueTcTMP = addTMP1
    Else
        valueTcTMP = "00"
        addTMP2 = 0
    End If
    
    'Busca Minutos y pasa a segundos
    m_TMP = InStr(UCase(ActiveCellTMP), "'")
    If m_TMP Then
        addTMP1 = Right("00" & Mid(ActiveCellTMP, h_TMP + 1, m_TMP - h_TMP - 1), m_TMP - h_TMP - 1)
        addTMP2 = addTMP2 + addTMP1 * 60
        valueTcTMP = valueTcTMP & ":" & addTMP1
    Else
        valueTcTMP = valueTcTMP & ":00"
    End If
    
    'Busca Segundos y pasa a segundos
    s_TMP = InStr(UCase(ActiveCellTMP), """")
    If s_TMP Then
        addTMP1 = Right("00" & Mid(ActiveCellTMP, m_TMP + 1, s_TMP - m_TMP - 1), s_TMP - m_TMP - 1)
        addTMP2 = addTMP2 + addTMP1
        valueTcTMP = valueTcTMP & ":" & addTMP1
    Else
        valueTcTMP = valueTcTMP & ":00"
    End If
    
    f_detectFormatTC = f_ConvertSecondsTo_HHMMSS(addTMP2, 0) & ":00"


End Function
'---------------------------------------------------------------------------------------------------------- ButtonClearRango_Click
Private Sub ButtonClearRango_Click()
Dim obj_Cell As Range

On Error Resume Next

    If Selection.Count > 1000 Then
        MsgBox "You have selected too many cells " & Chr(13) & " Select blocks of 1000 cells maximum"
        Exit Sub
     End If

    MyNote = "This action will erase the data forever" & Chr(13) & "and you will never see them again." & Chr(13) & Chr(13) & "Do you want continue?"
    Answer = MsgBox(MyNote, vbQuestion + vbYesNo, "|fffd||fffd|Attention!!")
    If Answer = vbNo Then Exit Sub
    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
         obj_Cell.ClearContents
    Next
    'f_Format
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonFormat_Click
Private Sub ButtonFormat_Click()
Dim obj_Cell As Range
   
On Error Resume Next
    ButtonYesNoFrames = ButtonYesNoFrames4
    num_Unformated = 0
    num_TotalCells = 0
    msg1 = "There is one unformatted cell"
    
    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            num_TotalCells = num_TotalCells + 1
            numToConvert = .Text
            numToConvert = f_FormatNumTo00000000(numToConvert)
            If IsNumeric(numToConvert) Then
                obj_Cell = Mid(numToConvert, 1, 2) & ":" & Mid(numToConvert, 3, 2) & ":" & Mid(numToConvert, 5, 2) & ":" & Mid(numToConvert, 7, 2)
            Else
                num_Unformated = num_Unformated + 1
            End If
        End With
    Next
    
    If num_Unformated > 1 Then
        msg1 = "There are " & num_Unformated & " unformatted cells out of a total of " & num_TotalCells
    Else
        msg1 = "There is one unformatted cell out of a total of " & num_TotalCells
    End If
    
    If num_Unformated > 0 Then MsgBox msg1
    f_Format
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonLShift_Click
Private Sub ButtonLShift_Click()
Dim obj_Cell As Range

    TextBoxInsertExtractFlag = 1
    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            numToConvert = .Text
            numToConvert = f_FormatNumTo00000000(numToConvert)
            If numToConvert <> "Error" Then
                MSB = Mid(numToConvert, 1, 1)
                numToConvert = Right(numToConvert & MSB, 8)       'Formatea a ocho d|fffd|gitos
                obj_Cell = Mid(numToConvert, 1, 2) & ":" & Mid(numToConvert, 3, 2) & ":" & Mid(numToConvert, 5, 2) & ":" & Mid(numToConvert, 7, 2)
            End If
        End With
    Next
    TextBoxInsertExtractFlag = 0
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonRShift_Click
Private Sub ButtonRShift_Click()
Dim obj_Cell As Range
    TextBoxInsertExtractFlag = 1
    'For Each obj_Cell In RangoPasado
    For Each obj_Cell In Selection.Cells
        With obj_Cell
            numToConvert = .Text
            numToConvert = f_FormatNumTo00000000(numToConvert)
            If numToConvert <> "Error" Then
                LSB = Mid(numToConvert, 8, 1)
                numToConvert = Left(LSB & numToConvert, 8)                'Inserta LSB  a ocho d|fffd|gitos
                obj_Cell = Mid(numToConvert, 1, 2) & ":" & Mid(numToConvert, 3, 2) & ":" & Mid(numToConvert, 5, 2) & ":" & Mid(numToConvert, 7, 2)
            End If
        End With
    Next
    TextBoxInsertExtractFlag = 0
End Sub
'---------------------------------------------------------------------------------------------------------- f_FormatNumTo00000000
Public Function f_FormatNumTo00000000(ByVal v_num2Convert As String) As String
Dim numToConvert As String

        numToConvert = v_num2Convert
        numToConvert = Replace(numToConvert, " ", "")               'Elimina los dos puntos
        numToConvert = Replace(numToConvert, ":", "")               'Elimina los dos puntos
        numToConvert = Replace(numToConvert, ".", "")               'Elimina puntos
        numToConvert = Replace(numToConvert, ";", "")               'Elimina puntos y comas
        numToConvert = Replace(numToConvert, ",", "")               'Elimina comas
        numToConvert = Replace(numToConvert, "-", "")               'Elimina guiones
        numToConvert = Replace(numToConvert, "_", "")               'Elimina guiones bajos
        numToConvert = Replace(numToConvert, "/", "")               'Elimina slash
        numToConvert = Replace(numToConvert, "\", "")               'Elimina slash
        
        If Not IsNumeric(numToConvert) And Len(numToConvert) > 0 Then
            f_FormatNumTo00000000 = "Error"
            Exit Function
        End If
        'If Len(numToConvert) > 8 Then Exit Function
        
        numToConvert = Right("00000000" & numToConvert, 8)

        'Si el modo <No Frames> est|fffd| habilitado y MSB es cero y LSB es distinto de cero, podemos rotar dos posiciones numToConvert
        If Not ButtonYesNoFrames And Right(numToConvert, 2) <> "00" And Left(numToConvert, 2) = "00" And Not TextBoxInsertExtractFlag = 1 Then
            numToConvert = Right("00000000" & numToConvert & "00", 8)
        End If
        
        'TextBoxInsertExtractFlag = 0
        f_FormatNumTo00000000 = numToConvert   'Sal de la funci|fffd|n


End Function
'---------------------------------------------------------------------------------------------------------- f_Format
Public Function f_Format() As Integer
    Selection.Cells.VerticalAlignment = xlCenter
    Selection.Cells.HorizontalAlignment = xlCenter
    Selection.Cells.NumberFormat = "00\:00\:00\:00"
End Function
'---------------------------------------------------------------------------------------------------------- f_Format2
Public Function f_Format2() As Integer
    Selection.Cells.VerticalAlignment = xlCenter
    Selection.Cells.HorizontalAlignment = xlCenter
    Selection.Cells.NumberFormat = ""
End Function



'---------------------------------------------------------------------------------------------------------- LabelSuma1_Click
Private Sub LabelSuma1_Click()
v_LabelSuma1 = Not v_LabelSuma1
If Not v_LabelSuma1 Then
    LabelSuma1.Caption = "TC1"
    v_Suma1 = 1
    LabelSuma1.ForeColor = RGB(0, 0, 0)
    TextBoxTC1.ForeColor = &H80000010
Else
    LabelSuma1.Caption = "- TC1"
    v_Suma1 = -1
    LabelSuma1.ForeColor = RGB(&HFF, &H0, &H0)
    TextBoxTC1.ForeColor = RGB(&HFF, &H80, &H80)
End If
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- LabelSuma2_Click
Private Sub LabelSuma2_Click()
v_LabelSuma2 = Not v_LabelSuma2
If Not v_LabelSuma2 Then
    LabelSuma2.Caption = "TC2"
    v_Suma2 = 1
    LabelSuma2.ForeColor = RGB(0, 0, 0)
    TextBoxTC2.ForeColor = &H80000010
Else
    LabelSuma2.Caption = "- TC2"
    v_Suma2 = -1
    LabelSuma2.ForeColor = RGB(&HFF, &H0, &H0)
    TextBoxTC2.ForeColor = RGB(&HFF, &H80, &H80)
End If
f_SumaTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- LabelSuma3_Click
Private Sub LabelSuma3_Click()
v_LabelSuma3 = Not v_LabelSuma3
If Not v_LabelSuma3 Then
    LabelSuma3.Caption = "TC3"
    v_Suma3 = 1
    LabelSuma3.ForeColor = RGB(0, 0, 0)
    TextBoxTC3.ForeColor = &H80000010
Else
    LabelSuma3.Caption = "- TC3"
    v_Suma3 = -1
    LabelSuma3.ForeColor = RGB(&HFF, &H0, &H0)
    TextBoxTC3.ForeColor = RGB(&HFF, &H80, &H80)
End If
f_SumaTotalTC
End Sub

Private Sub LabelSumaTotal_Click()
'Linea1 = TextBoxSystemRef1 & " " & TextBoxTC1 & Chr(13)
'Linea2 = TextBoxSystemRef2 & " " & TextBoxTC2 & Chr(13)
'Linea3 = TextBoxSystemRef3 & " " & TextBoxTC3 & Chr(13)

Linea1 = TextBoxTC1 & Chr(13)
Linea2 = TextBoxTC2 & Chr(13)
Linea3 = TextBoxTC3 & Chr(13)

f_CopyToClipboard Linea1 & Linea2 & Linea3
End Sub

'---------------------------------------------------------------------------------------------------------- SpinButtonSystemRef1_Change
Private Sub SpinButtonSystemRef1_Change()
If SpinButtonSystemRef1 > 8 Then SpinButtonSystemRef1 = 1
If SpinButtonSystemRef1 < 1 Then SpinButtonSystemRef1 = 8
f_SpinButtonRef SpinButtonSystemRef1, TextBoxSystemRef1, TextBoxValueRef1
End Sub
'---------------------------------------------------------------------------------------------------------- SpinButtonSystemRef2_Change
Private Sub SpinButtonSystemRef2_Change()
If SpinButtonSystemRef2 > 8 Then SpinButtonSystemRef2 = 1
If SpinButtonSystemRef2 < 1 Then SpinButtonSystemRef2 = 8
f_SpinButtonRef SpinButtonSystemRef2, TextBoxSystemRef2, TextBoxValueRef2
End Sub
'---------------------------------------------------------------------------------------------------------- SpinButtonSystemRef3_Change
Private Sub SpinButtonSystemRef3_Change()
If SpinButtonSystemRef3 > 8 Then SpinButtonSystemRef3 = 1
If SpinButtonSystemRef3 < 1 Then SpinButtonSystemRef3 = 8
f_SpinButtonRef SpinButtonSystemRef3, TextBoxSystemRef3, TextBoxValueRef3
End Sub
'---------------------------------------------------------------------------------------------------------- SpinButtonSystemRef4_Change
Private Sub SpinButtonSystemRef4_Change()
If SpinButtonSystemRef4 > 8 Then SpinButtonSystemRef4 = 1
If SpinButtonSystemRef4 < 1 Then SpinButtonSystemRef4 = 8
f_SpinButtonRef SpinButtonSystemRef4, TextBoxSystemRef4, TextBoxValueRef4
f_SumaTotalTC
f_changeColorsInputBox
End Sub
'---------------------------------------------------------------------------------------------------------- SpinButtonZoom_Change
Private Sub SpinButtonZoom_Change()

If SpinButtonZoom > 6 Then SpinButtonZoom = 6
If SpinButtonZoom < 1 Then SpinButtonZoom = 1


Select Case SpinButtonZoom    ' Evaluate Number.
'Case 1 To 5    ' Number between 1 and 5, inclusive.
Case 1     ' Number between 1 and 5, inclusive.
    caseZoom = 0.6
Case 2     ' Number between 1 and 5, inclusive.
    caseZoom = 0.7
Case 3     ' Number between 1 and 5, inclusive.
    caseZoom = 0.8
Case 4     ' Number between 1 and 5, inclusive.
    caseZoom = 1
Case 5     ' Number between 1 and 5, inclusive.
    caseZoom = 1.2
Case 6     ' Number between 1 and 5, inclusive.
    caseZoom = 1.4
End Select
    aspectRelation = FormWidth / FormHeight
    Me.Zoom = (100 * caseZoom)
    Me.Width = FormWidth * caseZoom
    Me.Height = (Me.Width / aspectRelation) * ((caseZoom + 0.025) / caseZoom)
    LabelZoom = "Zoom " & caseZoom * 100 & "%"
    zoomFlag = True
    zoomTMP = caseZoom
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxSecondsTcRef2_Enter
Private Sub TextBoxSecondsTcRef2_Enter()
    TextBoxInFlag = 2
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxSecondsTcRef2_AfterUpdate
Private Sub TextBoxSecondsTcRef2_AfterUpdate()
    If TextBoxSecondsTcRef2 = "" Or Not IsNumeric(TextBoxSecondsTcRef2) Then TextBoxSecondsTcRef2 = 0
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxSecondsTcRef2_Change
Private Sub TextBoxSecondsTcRef2_Change()
On Error Resume Next
    If TextBoxInFlag = 2 Then
        TextBoxInRef = TextBoxValueRef4
        f_changeColorsInputBox
        TextBoxFramesTcRef2 = Round((TextBoxSecondsTcRef2 * TextBoxValueRef4), 3)
        TextBoxTimeCodeRef2 = f_ConvertFramesTo_HHMMSSFF(TextBoxFramesTcRef2, TextBoxValueRef4)
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxFramesTcRef2_Enter
Private Sub TextBoxFramesTcRef2_Enter()
    TextBoxInFlag = 1
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxFramesTcRef2_AfterUpdate
Private Sub TextBoxFramesTcRef2_AfterUpdate()
    If TextBoxFramesTcRef2 = "" Or Not IsNumeric(TextBoxFramesTcRef2) Then TextBoxFramesTcRef2 = 0
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxFramesTcRef2_Change
Private Sub TextBoxFramesTcRef2_Change()
On Error Resume Next
    If TextBoxInFlag = 1 Then
        TextBoxInRef = TextBoxValueRef4
        f_changeColorsInputBox
        TextBoxSecondsTcRef2 = Round((TextBoxFramesTcRef2 / TextBoxValueRef4), 3)
        TextBoxTimeCodeRef2 = f_ConvertFramesTo_HHMMSSFF(TextBoxFramesTcRef2, TextBoxValueRef4)
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTimeCodeRef2_Enter
Private Sub TextBoxTimeCodeRef2_Enter()
    TextBoxInFlag = 3
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTimeCodeRef2_AfterUpdate
Private Sub TextBoxTimeCodeRef2_AfterUpdate()
On Error Resume Next

    If TextBoxTimeCodeRef2 = "" Or Not IsNumeric(TextBoxTimeCodeRef2) Then TextBoxTimeCodeRef2 = "00:00:00:00"
    TextBoxTimeCodeRef2 = Format(TextBoxTimeCodeRef2, "00\:00\:00\:00")
    If TextBoxInFlag = 3 Then
        TextBoxInRef = TextBoxValueRef4
        f_changeColorsInputBox
        ButtonYesNoFrames = True
        TextBoxSecondsTcRef2 = Round(f_CalculateTcInSeconds(Replace(TextBoxTimeCodeRef2, ":", ""), TextBoxValueRef4), 3)
        TextBoxFramesTcRef2 = Round(f_CalculateTcInFrames(Replace(TextBoxTimeCodeRef2, ":", ""), TextBoxValueRef4), 3)
        
        'Con esta l|fffd|nea se refresca TextBoxTimeCodeRef2 en funci|fffd|n de TextBoxValueRef4
        TextBoxTimeCodeRef2 = f_ConvertFramesTo_HHMMSSFF(TextBoxFramesTcRef2, TextBoxValueRef4)
        
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteTC1_Click
Private Sub ButtonPasteTC1_Click()
    ButtonYesNoFrames = ButtonYesNoFrames1
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")

    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 99595959 Then                      'Max TimeCode 99595959 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxTC1 = Format(f_FormatNumTo00000000(TextBoxTC_TMP), "00:00:00:00")
            f_SumaTotalTC
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteTC2_Click
Private Sub ButtonPasteTC2_Click()
    ButtonYesNoFrames = ButtonYesNoFrames2
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")
    
    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 99595959 Then                      'Max TimeCode 99595959 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxTC2 = Format(f_FormatNumTo00000000(TextBoxTC_TMP), "00:00:00:00")
            f_SumaTotalTC
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteTC3_Click
Private Sub ButtonPasteTC3_Click()
    ButtonYesNoFrames = ButtonYesNoFrames3
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")
    
    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 99595959 Then                      'Max TimeCode 99595959 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxTC3 = Format(f_FormatNumTo00000000(TextBoxTC_TMP), "00:00:00:00")
            f_SumaTotalTC
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteSeconds_Click
Private Sub ButtonPasteSeconds_Click()
    TextBoxInFlag = 2
    f_changeColorsInputBox
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")
    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 359999.999 Then          'Max Seconds 359999.999 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxSecondsTcRef2 = ""
            TextBoxSecondsTcRef2 = TextBoxTC_TMP
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteFrames_Click
Private Sub ButtonPasteFrames_Click()
    TextBoxInFlag = 1
    f_changeColorsInputBox
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")
    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 21599999.994 Then        'Max Frames 21599999.994 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxFramesTcRef2 = ""
            TextBoxFramesTcRef2 = TextBoxTC_TMP
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonPasteTc_Click
Private Sub ButtonPasteTc_Click()
    TextBoxInFlag = 3
    f_changeColorsInputBox
    TextBoxTC_TMP = Replace(f_CopyFromClipboard, ":", "")
    If Not IsNumeric(TextBoxTC_TMP) Then
            f_SpeechSpeak msgErr1
    Else
        If TextBoxTC_TMP > 99595959 Then        'Max TC 99595959 = 99:59:59:59
            f_SpeechSpeak msgErr2
        Else
            TextBoxTimeCodeRef2 = TextBoxTC_TMP
            TextBoxTimeCodeRef2_AfterUpdate
        End If
    End If
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTC1_Click
Private Sub TextBoxTC1_Click()
f_CopyToClipboard TextBoxTC1
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTC2_Click
Private Sub TextBoxTC2_Click()
f_CopyToClipboard TextBoxTC2
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTC3_Click
Private Sub TextBoxTC3_Click()
f_CopyToClipboard TextBoxTC3
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxSecondsTcRef_Click
Private Sub TextBoxSecondsTcRef_Click()
f_CopyToClipboard TextBoxSecondsTcRef
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxFramesTcRef_Click
Private Sub TextBoxFramesTcRef_Click()
f_CopyToClipboard TextBoxFramesTcRef
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTimeCodeRef_Click
Private Sub TextBoxTimeCodeRef_Click()
f_CopyToClipboard TextBoxTimeCodeRef
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxTotalTC_Click
Private Sub TextBoxTotalTC_Click()
f_CopyToClipboard TextBoxTotalTC
End Sub
'---------------------------------------------------------------------------------------------------------- TextBoxSystemRef4_Click
Private Sub TextBoxSystemRef4_Click()
f_CopyToClipboard TextBoxSystemRef4 & "     " & TextBoxSecondsTcRef & " Seconds     " & TextBoxFramesTcRef & " Frames     " & TextBoxTimeCodeRef & " TimeCode"
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonCopySeconds_Click
Private Sub ButtonCopySeconds_Click()
f_CopyToClipboard TextBoxSecondsTcRef2
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonCopyFrames_Click
Private Sub ButtonCopyFrames_Click()
f_CopyToClipboard TextBoxFramesTcRef2
End Sub
'---------------------------------------------------------------------------------------------------------- ButtonCopyTc_Click
Private Sub ButtonCopyTc_Click()
f_CopyToClipboard TextBoxTimeCodeRef2
End Sub
'---------------------------------------------------------------------------------------------------------- f_changeColorsInputBox
Public Function f_changeColorsInputBox()
If TextBoxInRef <> TextBoxValueRef4 And TextBoxSecondsTcRef2 > 0 Then
    TextBoxFramesTcRef2.ForeColor = RGB(&HFF, &H80, &H80)
    TextBoxSecondsTcRef2.ForeColor = RGB(&HFF, &H80, &H80)
    TextBoxTimeCodeRef2.ForeColor = RGB(&HFF, &H80, &H80)
Else
    TextBoxFramesTcRef2.ForeColor = RGB(&H0, &H0, &H0)
    TextBoxSecondsTcRef2.ForeColor = RGB(&H0, &H0, &H0)
    TextBoxTimeCodeRef2.ForeColor = RGB(&H0, &H0, &H0)
End If
End Function
'---------------------------------------------------------------------------------------------------------- UserForm_Initialize
Private Sub UserForm_Initialize()
    'f_SpeechSpeak "Bienvenidos a APO69"
    TimeLock = Right("000000" & Replace(Time(), ":", ""), 6)
    v_Suma1 = 1
    v_Suma2 = 1
    v_Suma3 = 1
    v_LabelSuma1 = False
    v_LabelSuma2 = False
    v_LabelSuma3 = False
    SpinButtonZoom = 4
    
    TextBoxFramesTcRef2 = 0
    TextBoxSecondsTcRef2 = 0
    TextBoxTimeCodeRef2 = "00:00:00:00"
    TextBoxValueRef1 = 25
    TextBoxValueRef2 = 25
    TextBoxValueRef3 = 25
    TextBoxValueRef4 = 25
    TextBoxZoomFlag = 100
    SpinButtonSystemRef1 = 3
    TextBoxSystemRef1 = "PAL 25 fps"
    SpinButtonSystemRef2 = 3
    TextBoxSystemRef2 = "PAL 25 fps"
    SpinButtonSystemRef3 = 3
    TextBoxSystemRef3 = "PAL 25 fps"
    SpinButtonSystemRef4 = 3
    TextBoxSystemRef4 = "PAL 25 fps"
    TextBoxInRef = TextBoxValueRef4
End Sub
'---------------------------------------------------------------------------------------------------------- UserForm_Click
Private Sub UserForm_Click()
    TimeLock2 = Right("000000" & Replace(Time(), ":", ""), 6)
    If TimeLock2 - TimeLock > 1000 Then      'TimeLock formato HHMMSS  10'
        FormMsgApo.Show 1
        TimeLock = Right("000000" & Replace(Time(), ":", ""), 6)
    End If
End Sub


INQUEST-PP=macro
