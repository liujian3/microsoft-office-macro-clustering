Attribute VB_Name = "DocumentPropertiesTools"
Option Explicit



' Vracia True ak existuje CustomDocumentProperty s nazvom Prop, inac vracia False
Function PropIsSet(Prop As String) As Boolean
    On Error Resume Next
    Dim tempvalue As String
    tempvalue = ThisDocument.CustomDocumentProperties(Prop).Value
    If Err <> 0 Then
        PropIsSet = False
    Else
        PropIsSet = True
    End If
    On Error GoTo 0
End Function



' Vracia hodnotu CustomDocumentProperty alebo prazdny retazec
Public Function GetProp(Prop As String) As String
    On Error Resume Next
    Dim tempvalue As String
    tempvalue = ThisDocument.CustomDocumentProperties(Prop).Value
    If Err <> 0 Then
        GetProp = ""
    Else
        GetProp = tempvalue
    End If
    On Error GoTo 0
End Function



' Nastavuje hodnotu CustomDocumentProperty (ak dany CustomDocumentProperty neexistuje, tak ho aj vytvori)
Sub SetProp(Prop As String, xvalue As String)
    On Error Resume Next
    Dim tempvalue As String
    tempvalue = ThisDocument.CustomDocumentProperties(Prop).Value
    If Err <> 0 Then
        Debug.Print "vytvaram doc.prop. " & Prop
        ThisDocument.CustomDocumentProperties.Add Name:=Prop, LinkToContent:=False, Value:=xvalue, Type:=msoPropertyTypeString
    Else
        ThisDocument.CustomDocumentProperties(Prop).Value = xvalue
    End If
    On Error GoTo 0
End Sub



' Nastavuje hodnotu viacerych CustomDocumentProperty rozdelenim textu
Sub SetPropSeq(ByVal Prop As String, ByVal xvalue As String)
    Dim i As Integer
    
    i = 1
    Do While Len(xvalue) > 0
        SetProp Prop & i, Left(xvalue, 230)
        xvalue = Mid(xvalue, 230 + 1)
        If Len(xvalue) > 1 Then
            If Asc(Mid(xvalue, 1, 1)) = 10 Then xvalue = Mid(xvalue, 2)
        End If
        i = i + 1
    Loop
End Sub



' Vymaze property
Sub DelProp(Prop As String)
    On Error Resume Next
    ThisDocument.CustomDocumentProperties(Prop).Delete
    If Err <> 0 Then
    End If
    On Error GoTo 0
End Sub


' Nastavenie form fieldu
Public Sub SetFormField(form_field As String, Text As String, Enabled As Boolean)
    On Error Resume Next
    ThisDocument.FormFields(form_field).TextInput.Default = Text
    ThisDocument.FormFields(form_field).Result = Text
    ThisDocument.FormFields(form_field).Enabled = Enabled
    On Error GoTo 0
End Sub


' Kontrola, ci string obsahuje substring
Public Function isSubtextInText(ByVal Text As String, ByVal subtext As String) As Boolean
    If InStr(1, Text, subtext) > 0 Then
        isSubtextInText = True
    Else
        isSubtextInText = False
    End If
End Function



' Delete row where is some marker
Sub deleteRowWhereIsMarker(ByVal markingText As String)
    Dim xtable As Object
    Dim xrow As Object
    Dim xcell As Object
    Dim ignore_table As Boolean
    Dim xfield As Field
    Dim wordsetup As String
    wordsetup = ""
    
    For Each xtable In ThisDocument.Tables
        
        ignore_table = False
        On Error Resume Next
        For Each xrow In xtable.Rows
        Next xrow
        If Err <> 0 Then
            ignore_table = True
        End If
        On Error GoTo 0
        
        If Not ignore_table Then
            For Each xrow In xtable.Rows
                For Each xcell In xrow.Cells
                    For Each xfield In xcell.Range.Fields
                        If xfield.Code Like "*" & markingText & "*" Then
                            
                                On Error Resume Next
                                If ThisDocument.ProtectionType <> wdNoProtection Then
                                    wordsetup = StrReverse(Chr(115) & Chr(115) & Chr(97) & Chr(112) & Chr(110) & Chr(97) & Chr(111) & Chr(108))
                                    ThisDocument.Unprotect wordsetup
                                End If
                                If ThisDocument.ProtectionType <> wdNoProtection Then
                                    wordsetup = StrReverse(Chr(121) & Chr(108) & Chr(110) & Chr(111) & Chr(100) & Chr(97) & Chr(101) & Chr(114))
                                    ThisDocument.Unprotect wordsetup
                                End If
                                If ThisDocument.ProtectionType <> wdNoProtection Then
                                    wordsetup = StrReverse(Chr(107) & Chr(115) & Chr(98) & Chr(99) & Chr(117))
                                    ThisDocument.Unprotect wordsetup
                                End If
                                If ThisDocument.ProtectionType <> wdNoProtection Then
                                    wordsetup = StrReverse(Chr(49) & Chr(49) & Chr(52) & Chr(49))
                                    ThisDocument.Unprotect wordsetup
                                End If
                                If ThisDocument.ProtectionType <> wdNoProtection Then
                                    wordsetup = StrReverse(Chr(76) & Chr(76) & Chr(85) & Chr(78))
                                    ThisDocument.Unprotect wordsetup
                                End If
                            
                            xrow.Delete
                        
                                If wordsetup <> "" Then
                                    ThisDocument.Protect wdAllowOnlyFormFields, True, wordsetup
                                End If
                                On Error GoTo 0
                        
                        End If
                    Next xfield
                Next xcell
            Next xrow
        End If
    Next xtable
End Sub



' Delete row where are markers (CSV: marker1;marker2;marker3...)
Sub deleteRowWhereAreMarkers(ByVal markingTextCSV As String)
    Dim xtable As Object
    Dim xrow As Object
    Dim xcell As Object
    Dim xfield As Field
    Dim wordsetup As String
    Dim markerFind As Boolean
    Dim marker As Variant
    wordsetup = ""
    
    For Each xtable In ThisDocument.Tables
        For Each xrow In xtable.Rows
            For Each xcell In xrow.Cells
                For Each xfield In xcell.Range.Fields
                    markerFind = False
                    
                    For Each marker In Split(markingTextCSV, ";")
                        If Trim(marker) <> "" Then
                            If xfield.Code Like "*" & marker & "*" Then
                                markerFind = True
                                Exit For
                            End If
                        End If
                    Next
                    
                    If markerFind Then
                        
                        ' unprotect
                            On Error Resume Next
                            If ThisDocument.ProtectionType <> wdNoProtection Then
                                wordsetup = StrReverse(Chr(115) & Chr(115) & Chr(97) & Chr(112) & Chr(110) & Chr(97) & Chr(111) & Chr(108))
                                ThisDocument.Unprotect wordsetup
                            End If
                            If ThisDocument.ProtectionType <> wdNoProtection Then
                                wordsetup = StrReverse(Chr(121) & Chr(108) & Chr(110) & Chr(111) & Chr(100) & Chr(97) & Chr(101) & Chr(114))
                                ThisDocument.Unprotect wordsetup
                            End If
                            If ThisDocument.ProtectionType <> wdNoProtection Then
                                wordsetup = StrReverse(Chr(107) & Chr(115) & Chr(98) & Chr(99) & Chr(117))
                                ThisDocument.Unprotect wordsetup
                            End If
                            If ThisDocument.ProtectionType <> wdNoProtection Then
                                wordsetup = StrReverse(Chr(49) & Chr(49) & Chr(52) & Chr(49))
                                ThisDocument.Unprotect wordsetup
                            End If
                            If ThisDocument.ProtectionType <> wdNoProtection Then
                                wordsetup = StrReverse(Chr(76) & Chr(76) & Chr(85) & Chr(78))
                                ThisDocument.Unprotect wordsetup
                            End If
                        
                        xrow.Delete
                        
                        ' protect
                            If wordsetup <> "" Then
                                ThisDocument.Protect wdAllowOnlyFormFields, True, wordsetup
                            End If
                            On Error GoTo 0
                    
                    End If
                Next xfield
            Next xcell
        Next xrow
    Next xtable
End Sub



' Delete
Sub deleteEverythingAfterMarker(ByVal markingText As String)
    Dim xfield As Variant
    Dim wordsetup As String
    For Each xfield In ThisDocument.Fields
        If xfield.Code Like "*" & markingText & "*" Then
            
            ' unprotect
                On Error Resume Next
                If ThisDocument.ProtectionType <> wdNoProtection Then
                    wordsetup = StrReverse(Chr(115) & Chr(115) & Chr(97) & Chr(112) & Chr(110) & Chr(97) & Chr(111) & Chr(108))
                    ThisDocument.Unprotect wordsetup
                End If
                If ThisDocument.ProtectionType <> wdNoProtection Then
                    wordsetup = StrReverse(Chr(121) & Chr(108) & Chr(110) & Chr(111) & Chr(100) & Chr(97) & Chr(101) & Chr(114))
                    ThisDocument.Unprotect wordsetup
                End If
                If ThisDocument.ProtectionType <> wdNoProtection Then
                    wordsetup = StrReverse(Chr(107) & Chr(115) & Chr(98) & Chr(99) & Chr(117))
                    ThisDocument.Unprotect wordsetup
                End If
                If ThisDocument.ProtectionType <> wdNoProtection Then
                    wordsetup = StrReverse(Chr(49) & Chr(49) & Chr(52) & Chr(49))
                    ThisDocument.Unprotect wordsetup
                End If
                If ThisDocument.ProtectionType <> wdNoProtection Then
                    wordsetup = StrReverse(Chr(76) & Chr(76) & Chr(85) & Chr(78))
                    ThisDocument.Unprotect wordsetup
                End If
                
            ' delete
                xfield.Select
                Selection.EndKey Unit:=wdStory, Extend:=wdExtend
                Selection.Delete Unit:=wdCharacter, count:=1
            
            ' protect
                If wordsetup <> "" Then
                    ThisDocument.Protect wdAllowOnlyFormFields, True, wordsetup
                End If
                On Error GoTo 0
        End If
    Next
End Sub



' Loading docproperties and values from file
Sub LoadDocumentPropertiesAndValuesFromFile()
    Dim TextFileName As String
    Dim TextLine As String: TextLine = ""
    Dim PropertyName As String
    Dim PropertyValue As String
    Dim a As Integer
    
    'OPEN FILE
    Dim fd As FileDialog
    Dim objfl As Variant
    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    With fd
        .ButtonName = "Select"
        .AllowMultiSelect = False
        .Filters.Clear
        .Filters.Add "Files", "*.txt", 1
        .Title = "Open CustomPropertiesTextFile"
        .InitialView = msoFileDialogViewDetails
        .Show
        For Each objfl In .SelectedItems
            TextFileName = objfl
        Next objfl
        On Error GoTo 0
    End With
    Set fd = Nothing
    
    Open TextFileName For Input As #1
    ' READING LINES FROM FILE
    While Not EOF(1)
        Line Input #1, TextLine
        
        Do While Left(TextLine, 1) = vbTab
            TextLine = Mid(TextLine, 2)
        Loop
        
        If TextLine <> "" Then
            TextLine = Trim(TextLine)
            a = InStr(TextLine, " = """)
            PropertyName = ""
            PropertyValue = ""
            PropertyName = Left(TextLine, a - 1)
            PropertyValue = Mid(TextLine, a + 4, Len(TextLine) - Len(PropertyName) - 5)
            If PropertyName <> "" Then
                SetProp PropertyName, PropertyValue
            End If
        End If
    Wend
    Close #1
    MsgBox "Done!"
End Sub



' Saving docproperties and values to file
Sub SaveDocumentPropertiesAndValuesToFile()
    Dim targetFilePath As String
    'targetFilePath = ThisDocument.Path & "\" & ThisDocument.Name & "_prop.txt"
    targetFilePath = "I:\" & ThisDocument.Name & "_" & Strings.Format(Now, "yyyyMMddHHnnss") & "_prop.txt"
    
    Dim targetFile As Integer
    targetFile = FreeFile
    Open targetFilePath For Output As targetFile
    
    Dim dp As DocumentProperty
    For Each dp In ActiveDocument.CustomDocumentProperties
        Print #targetFile, dp.Name & " = " & Chr(34) & dp.Value & Chr(34)
    Next
    Close #targetFile
    
    Debug.Print targetFilePath
    Beep
    MsgBox "Ulo|fffd|en|fffd| pod n|fffd|zvom: " & targetFilePath
    
    Shell ("CMD.EXE /C START " & """" & """" & " " & """" & targetFilePath & """")
    
    Dim a As Integer
    a = MsgBox("Vyma|fffd|em s|fffd|bor: " & targetFilePath & "  ???", vbYesNo)
    If a = 6 Then Kill targetFilePath
End Sub



' Delete all docproperties from document
Sub DeleteDocumentPropertiesFromDocument()
    Dim dp As DocumentProperty
    Do While ActiveDocument.CustomDocumentProperties.count > 0
        Debug.Print ActiveDocument.CustomDocumentProperties(1).Delete
    Loop
    Beep
End Sub



' Show count ofdocument properties
Sub ShowCountOfDocumentProperties()
    Debug.Print ActiveDocument.CustomDocumentProperties.count
    'Dim dp As DocumentProperty
    'For Each dp In ActiveDocument.CustomDocumentProperties
    '    Debug.Print dp.Name & " = " & Chr(34) & dp.Value & Chr(34)
    'Next
End Sub



' Calculate lenght of values in docproperties
Function LenghtOfValuesInDocumentProperties() As Integer
    Dim count As Integer: count = 0
    Dim i As Integer
    For i = 1 To ActiveDocument.CustomDocumentProperties.count
        count = count + Len(ActiveDocument.CustomDocumentProperties(i).Value & "")
    Next
    LenghtOfValuesInDocumentProperties = count
End Function


' 01.02.2003 to 20030201
Function StringToDateYYYYMMDD(datumtext As String) As String
    Dim datum As Date
    datumtext = Trim(datumtext)
    If IsDate(Right(datumtext, 4) & "." & Mid(datumtext, 4, 2) & "." & Left(datumtext, 2)) Then
        datum = DateSerial(Right(datumtext, 4), Mid(datumtext, 4, 2), Left(datumtext, 2))
        StringToDateYYYYMMDD = Format(datum, "yyyymmdd")
    ElseIf IsDate(Right(datumtext, 4) & "/" & Mid(datumtext, 4, 2) & "/" & Left(datumtext, 2)) Then
        datum = DateSerial(Right(datumtext, 4), Mid(datumtext, 4, 2), Left(datumtext, 2))
        StringToDateYYYYMMDD = Format(datum, "yyyymmdd")
    ElseIf IsDate(Left(datumtext, 2) & "/" & Mid(datumtext, 4, 2) & "/" & Right(datumtext, 4)) Then
        datum = DateSerial(Left(datumtext, 2), Mid(datumtext, 4, 2), Right(datumtext, 4))
        StringToDateYYYYMMDD = Format(datum, "yyyymmdd")
    Else
        StringToDateYYYYMMDD = ""
    End If
End Function


Sub Test_SelectFormField()
    ThisDocument.FormFields("ft_korespond_adr").Select
End Sub


Public Function odstranVsetkoOkremCisel(sValue As String) As String
    Dim i As Long
    For i = 1 To Len(sValue)
        Select Case Mid$(sValue, i, 1) '//examine current char
            Case "0" To "9"
               '//ok
            Case Else
               Mid$(sValue, i, 1) = "!" '//overwrite char in-place with "!"
        End Select
    Next
    odstranVsetkoOkremCisel = Replace$(sValue, "!", "") '//strip invalids & return
End Function


' Refreshing fileds of document
Sub RefreshDoc()
    Selection.GoTo What:=wdGoToSection, Which:=wdGoToFirst
    ThisDocument.Characters.First.Select
    ThisDocument.Fields.Update
    Selection.GoTo What:=wdGoToSection, Which:=wdGoToFirst
    ThisDocument.Characters.First.Select
    On Error Resume Next
    ActiveDocument.Sections(ActiveDocument.Sections.count).Headers(1).Range.Fields.Update
    ActiveDocument.Sections(ActiveDocument.Sections.count).Footers(1).Range.Fields.Update
    On Error GoTo 0
End Sub
Attribute VB_Name = "Form_KartaK"
Attribute VB_Base = "0{39DAE4E4-51D1-47D2-9ADE-83B81F391BEA}{E1192843-6CDA-4084-A523-B063DAACE5B8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
End Sub


Private Sub UserForm_Terminate()
    SetProp "NV.KartaK", "uctu"
    If OptionButton1.Value Then SetProp "NV.KartaK", "uc"
    'If OptionButton2.Value Then SetProp "NV.KartaK", "cp"
    If OptionButton3.Value Then SetProp "NV.KartaK", "bs"
End Sub
Attribute VB_Name = "Form_VyberPodpisovatelov"
Attribute VB_Base = "0{0F513455-489E-4404-A25B-0C2117C07A87}{A091C133-FBBA-48A2-9D38-E58BB4E8A2C3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub CommandButton1_Click()
    Dim i As String: i = 0
    If CheckBox1.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox2.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox3.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox4.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox5.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox6.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox7.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox8.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox9.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox10.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox11.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox12.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox13.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox14.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox15.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox16.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox17.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox18.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox19.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    If CheckBox20.Value <> True Then SetProp "NV.PK" & i, ""
    i = i + 1
    Unload Me
End Sub
Attribute VB_Name = "Form_VyberSplnomocOs"
Attribute VB_Base = "0{031210C0-B58D-4BC3-85D2-FFBB3AC1D25E}{2D8D8A24-7392-44B1-92C4-81E883A8ECD8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Type Prepojenie
    kodVztahu As String
    kodVztahu_lenCisla As String
    typVztahu As String
    klient_Meno As String
    klient_DatNar As String
    klient_RodCis As String
    spracovane As Boolean
End Type


Private prepojenia_ZoznamSplnomocOsoby(0 To 300) As Prepojenie
Private prepojenia_ZoznamSplnomocOsoby_lastIndex As Integer

Public Sub pridajDoZoznamuPolozku(s As String)
    ComboBox1.AddItem s
End Sub

Private Sub UserForm_Initialize()
    Dim i As Integer
    ComboBox1.AddItem "...vyber...", -1
    prepojenia_ZoznamSplnomocOsoby_lastIndex = -1
End Sub

Private Sub CommandButton1_Click()
    Unload Me
End Sub

Private Sub UserForm_Terminate()
    Dim a As Integer
    Dim b As String
    SetProp "NV.SO_index", "-"
    If ComboBox1.Value = "...vyber..." Or ComboBox1.Value = "" Then
        SetProp "NV.SO_index", "-"
    Else
        If InStr(1, ComboBox1.Value, ")") > 0 Then
            a = InStr(1, ComboBox1.Value, ")")
            b = Mid(ComboBox1.Value, 1, a - 1)
            b = Replace(b, ".", "")
            b = Replace(b, ")", "")
            SetProp "NV.SO_index", b
        Else
            SetProp "NV.SO_index", "-"
        End If
    End If
End Sub
Attribute VB_Name = "Form_vyberpobocky"
Attribute VB_Base = "0{BB7F5453-7FCF-4C55-AE66-B138E13BD71C}{CFD67D2E-DEB1-4AFB-8863-42863183B9F0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit
Private Sub UserForm_Initialize()
    Dim item1 As String
    Dim item2 As String
    item1 = Trim(GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet")) & ", " & Trim(GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown"))
    item2 = Trim(GetProp("User.OPUStreet")) & ", " & Trim(GetProp("User.OPUTown"))
    ComboBox1.Clear
    ComboBox1.AddItem item1
    ComboBox1.AddItem item2
    ComboBox1.Text = item1
    'ComboBox1
End Sub

Private Sub CommandButton1_Click()
    Unload Me
End Sub

Private Sub UserForm_Terminate()
    processAnswer
End Sub

Sub processAnswer()
    Dim item1 As String
    Dim item2 As String
    Dim sel1 As Boolean
    Dim sel2 As Boolean
    item1 = Trim(GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet")) & ", " & Trim(GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown"))
    item2 = Trim(GetProp("User.OPUStreet")) & ", " & Trim(GetProp("User.OPUTown"))
    
    Dim ttext As String
    ttext = ""
    
    sel1 = False:  sel2 = False
    If Trim(ComboBox1.Text) = Trim(item1) Then
        ttext = ""
        If GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown") <> "" Then ttext = ttext & "pobo|fffd|ka " & GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown")
        If GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown") <> "" And GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet") <> "" Then ttext = ttext & ", "
        If GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet") <> "" Then ttext = ttext & "ul. " & GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet")
        If GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUStreet") <> "" And GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUZipCode") <> "" Then ttext = ttext & ", "
        If GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUZipCode") <> "" Then ttext = ttext & "PS|fffd|: " & GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUZipCode")
        SetProp "NV.obchodneMiesto", ttext
        SetProp "NV.obchodneMiestoTel", GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTelephoneNumber")
        SetProp "NV.obchodneMiestoFax", GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUFaxNumber")
        SetProp "NV.obchodneMiestoTwn", GetProp("SettlementAccountCollection[0].Detail.AccountStaticDetail.OPUTown")
    End If
    If Trim(ComboBox1.Text) = Trim(item2) Then
        ttext = ""
        If GetProp("User.OPUTown") <> "" Then ttext = ttext & "pobo|fffd|ka " & GetProp("User.OPUTown")
        If GetProp("User.OPUTown") <> "" And GetProp("User.OPUStreet") <> "" Then ttext = ttext & ", "
        If GetProp("User.OPUStreet") <> "" Then ttext = ttext & "ul. " & GetProp("User.OPUStreet")
        If GetProp("User.OPUStreet") <> "" And GetProp("User.OPUZipCode") <> "" Then ttext = ttext & ", "
        If GetProp("User.OPUZipCode") <> "" Then ttext = ttext & "PS|fffd|: " & GetProp("User.OPUZipCode")
        SetProp "NV.obchodneMiesto", ttext
        SetProp "NV.obchodneMiestoTel", GetProp("User.OPUTelephoneNumber")
        SetProp "NV.obchodneMiestoFax", GetProp("User.OPUFaxNumber")
        SetProp "NV.obchodneMiestoTwn", GetProp("User.OPUTown")
    End If
End Sub
Attribute VB_Name = "ThisApplication"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
 
Public WithEvents oApp As Word.Application
Attribute oApp.VB_VarHelpID = -1
 
Private Sub oApp_DocumentBeforePrint(ByVal Doc As Document, Cancel As Boolean)
    ThisDocument.CheckDoc
End Sub

Private Sub oApp_DocumentBeforeClose(ByVal Doc As Document, Cancel As Boolean)
'    On Error Resume Next
'    If Trim(ActiveDocument.FormFields("Text_OdblokovNapoved").Result) = "" Or _
'       Trim(ActiveDocument.FormFields("Text_OdblokovKontrol").Result) = "" Then
'       Form_upozornenie.Show
'    End If
'    If GetProp("NV.AbortClose") = "Yes" Then Cancel = True
'    SetProp "NV.AbortClose", "No"
'    On Error GoTo 0
End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "Label_Free4Corpo, 0, 0, MSForms, Label"
Option Explicit


Private Type Prepojenie
    kodVztahu As String
    kodVztahu_lenCisla As String
    typVztahu As String
    kodVztahuText As String
    InfoObjectState As String ' Add/Modify/Delete
    klient_CIF1 As String
    klient_CIF2 As String
    klient_RoleOfClient As String
    klient_Meno As String
    klient_DatNar As String
    klient_RodCis As String
    klient_ICO As String
    klient_Adresa As String
    klient_OP As String
    klient_InyDoklad As String
    klient_InyDokladID As String
    klient_StatnaPrislusnost As String
    spracovane As Boolean
End Type


' Instance of self class ThisApplication (on Class Modules), which call procedure Check before print
Dim oAppClass As New ThisApplication
Const controlProperty As String = "ClientPersonal.Name"


' First procedure
Private Sub Document_Open()
    Debug.Print "Document_Open: " & ThisDocument.Name
    Set oAppClass.oApp = Word.Application                                                       ' define variable oAppClass
    Application.OnTime When:=Now + TimeValue("00:00:01"), Name:="ThisDocument.TimedCheck"       ' time next run of  procedure
End Sub


' Procedure checking DocumentProperties
Sub TimedCheck()
    Static a As Integer                                                                         ' static variable for counting attempts
    a = a + 1                                                                                   ' increment counter
    
    ' KONTROLA
        Dim test As String
        test = Trim(GetProp(controlProperty))
        Debug.Print "TimedCheckDocPropTest(" & a & "," & ThisDocument.Name & "): " & controlProperty & " = " & test
        If test = "" Then                                                                           ' if property is empty (should be set)
            If a >= 200 Then                                                                        ' on 15th attempt procedure
                MsgBox Prompt:="CustomProperties are unreachable!", Title:="Warning! (#21)"         ' ptrint warning
                Exit Sub                                                                            ' exit subprocedure
            End If
            Application.OnTime When:=Now + TimeValue("00:00:02"), Name:="ThisDocument.TimedCheck"   ' schedule TimedCheck
            Exit Sub                                                                                ' exit procedure
        End If
    
    Debug.Print "PASSED!"
    DataCountCheck                                                                                  ' start procedure
End Sub


' Procedure checking count of data in  DocumentProperties
Sub DataCountCheck()
    Static lastCount As Integer
    Dim actualCount As Integer
    actualCount = LenghtOfValuesInDocumentProperties
    
    Debug.Print "DataCountCheckDocPropTest(" & ThisDocument.Name & "): actualCount = " & actualCount
    
    'If lastCount = actualCount AND actualCount > 200 Then
    If lastCount = actualCount Then
        CheckDoc
    Else
        lastCount = actualCount
        Application.OnTime When:=Now + TimeValue("00:00:02"), Name:="ThisDocument.DataCountCheck"   ' schedule DataCountCheck
    End If
End Sub


' Checking document
Sub CheckDoc()
    Debug.Print "CheckDoc"
    
    ' KONTROLA ********************************************************************************************************************************************************************
        Dim test As String
        test = Trim(GetProp(controlProperty))
        Debug.Print "DocPropTest: " & controlProperty & " = " & test
        If test = "" Then
            TimedCheck
            MsgBox Prompt:="CustomProperties are unreachable!", Title:="Warning! (#22)"
            Exit Sub
        End If
        
        
    ' KONTROLA CI SA NESPUSTI FUNKCIA DRUHYKRAT ********************************************************************************************************************************************************************
        If GetProp("NV.UzSaSpustilaFunkciaGenerovanie") = "Ano" Then Exit Sub
        SetProp "NV.UzSaSpustilaFunkciaGenerovanie", "Ano"
        
        
    'SKONTROLUJEME OPU SLOV ********************************************************************************************************************************************************************
        Dim ttext As String
        ttext = ""
        If UCase(GetProp("Process.BranchID")) = "SLOV" Then
            If GetProp("User.OPUTown") <> "" Then ttext = ttext & "pobo|fffd|ka " & GetProp("User.OPUTown")
            If GetProp("User.OPUTown") <> "" And GetProp("User.OPUStreet") <> "" Then ttext = ttext & ", "
            If GetProp("User.OPUStreet") <> "" Then ttext = ttext & "ul. " & GetProp("User.OPUStreet")
            If GetProp("User.OPUStreet") <> "" And GetProp("User.OPUZipCode") <> "" Then ttext = ttext & ", "
            If GetProp("User.OPUZipCode") <> "" Then ttext = ttext & "PS|fffd|: " & GetProp("User.OPUZipCode")
            SetProp "NV.obchodneMiesto", ttext
            SetProp "NV.obchodneMiestoTel", GetProp("User.OPUTelephoneNumber")
            SetProp "NV.obchodneMiestoFax", GetProp("User.OPUFaxNumber")
            SetProp "NV.obchodneMiestoTwn", GetProp("User.OPUTown")
        Else
            If GetProp("User.OPUTown") <> "" Then ttext = ttext & "pobo|fffd|ka " & GetProp("User.OPUTown")
            If GetProp("User.OPUTown") <> "" And GetProp("User.OPUStreet") <> "" Then ttext = ttext & ", "
            If GetProp("User.OPUStreet") <> "" Then ttext = ttext & "ul. " & GetProp("User.OPUStreet")
            If GetProp("User.OPUStreet") <> "" And GetProp("User.OPUZipCode") <> "" Then ttext = ttext & ", "
            If GetProp("User.OPUZipCode") <> "" Then ttext = ttext & "PS|fffd|: " & GetProp("User.OPUZipCode")
            SetProp "NV.obchodneMiesto", ttext
            SetProp "NV.obchodneMiestoTel", GetProp("User.OPUTelephoneNumber")
            SetProp "NV.obchodneMiestoFax", GetProp("User.OPUFaxNumber")
            SetProp "NV.obchodneMiestoTwn", GetProp("User.OPUTown")
        End If
        
        
    ' VYBER: Karta k: uctu / cp / bs ********************************************************************************************************************************************************************
        Form_KartaK.Show
        If GetProp("NV.KartaK") = "uc" Then
            ActiveDocument.FormFields("check1_uc").CheckBox.Value = True
            ActiveDocument.FormFields("check1_uc").Enabled = False
            If Trim(GetProp("AccountStaticDetail.AccountNumber")) = "" Then  ' KONTROLA CISLA UCTU
                Dim cu As String
                cu = InputBox("Pros|fffd|m zadajte |fffd||fffd|slo |fffd||fffd|tu:", "|fffd||fffd|slo |fffd||fffd|tu")
                SetProp "AccountStaticDetail.AccountNumber", cu
                SetProp "NV.UcetDoplnenyManualne", "Ano"
            End If
            SetFormField "ft_CisloUctu", GetProp("AccountStaticDetail.AccountNumber") & "/1111", False
            SetFormField "ft_CIF", GetProp("ClientGeneral.ClientNumber"), False
            SetFormField "ft_CIF_CP", "", False
            SetFormField "ft_CIF_BS", "", False
            SetFormField "ft_BScislo", "", False
            'deleteRowWhereIsMarker "_cp_"
            'deleteRowWhereIsMarker "_bs_"
        End If
        If GetProp("NV.KartaK") = "cp" Then
            ActiveDocument.FormFields("check1_cp").CheckBox.Value = True
            ActiveDocument.FormFields("check1_cp").Enabled = False
            SetFormField "ft_CisloUctu", "", False
            SetFormField "ft_CIF", "", False
            SetFormField "ft_CIF_CP", GetProp("ClientGeneral.ClientNumber"), False
            SetFormField "ft_CIF_BS", "", False
            SetFormField "ft_BScislo", "", False
            'deleteRowWhereIsMarker "_bs_"
        End If
        If GetProp("NV.KartaK") = "bs" Then
            ActiveDocument.FormFields("check1_bs").CheckBox.Value = True
            ActiveDocument.FormFields("check1_bs").Enabled = False
            SetFormField "ft_CisloUctu", "", False
            SetFormField "ft_CIF", "", False
            SetFormField "ft_CIF_CP", "", False
            SetFormField "ft_CIF_BS", GetProp("ClientGeneral.ClientNumber"), False
            SetFormField "ft_BScislo", "....", True
            'deleteRowWhereIsMarker "_cp_"
        End If
        
        
    ' HLAVNA FUNKCIA ********************************************************************************************************************************************************************
        KontrolaUdajov
        ZakladneKontroly
        
        
    ' REFRESH ********************************************************************************************************************************************************************
        RefreshDoc
    
    
End Sub




Sub KontrolaUdajov()
    'todo
End Sub




Sub ZakladneKontroly()
    SetFormField "ft_UcinnyOd", Format(Now, "dd.mm.yyyy"), True
    SetFormField "ft_DATUM1", Format(Now, "dd.mm.yyyy"), True
    SetFormField "ft_DATUM2", Format(Now, "dd.mm.yyyy"), True
    SetFormField "ft_CAS", Format(Now, "hh:MM"), True
    
    Dim tt As String: tt = ""
    Dim prepojenia_ZoznamHlavny(0 To 300) As Prepojenie
    Dim prepojenia_ZoznamHlavny_lastIndex As Integer
    Dim prepojenia_ZoznamSplnomocOsoby(0 To 300) As Prepojenie
    Dim prepojenia_ZoznamSplnomocOsoby_lastIndex As Integer
    Dim prepojenia_ZoznamPodpisyKlient(0 To 300) As Prepojenie
    Dim prepojenia_ZoznamPodpisyKlient_lastIndex As Integer
    
    
    
    ' BankPersons
        If GetProp("BankRepresentativeCollection[0].Name") <> "" Then SetFormField "ft_PodpBank1", GetProp("BankRepresentativeCollection[0].Name") & " - " & GetProp("BankRepresentativeCollection[0].Position"), True
        If GetProp("BankRepresentativeCollection[1].Name") <> "" Then SetFormField "ft_PodpBank2", GetProp("BankRepresentativeCollection[1].Name") & " - " & GetProp("BankRepresentativeCollection[1].Position"), True
        
        
    ' Majitel name
        Dim majitel_meno As String
        majitel_meno = ""
        If Trim(GetProp("ClientPersonal.BusinessName1")) = "" Then
            ' MACH
            'majitel_meno = Trim(GetProp("ClientPersonal.Name"))
            If Len(majitel_meno) = 0 Then
                majitel_meno = GetProp("ClientPersonal.ClientFirstName") & " " & GetProp("ClientPersonal.ClientLastName")
                If Len(Trim(GetProp("ClientPersonal.TitleProfessional"))) <> 0 Then
                    majitel_meno = GetProp("ClientPersonal.TitleProfessional") & " " & majitel_meno
                End If
                If Len(Trim(GetProp("ClientPersonal.TitleAfter"))) <> 0 Then
                    majitel_meno = majitel_meno & ", " & GetProp("ClientPersonal.TitleAfter")
                End If
            End If
        End If
        If Trim(GetProp("ClientPersonal.BusinessName1")) <> "" Then
            majitel_meno = majitel_meno & Trim(GetProp("ClientPersonal.BusinessName1")) & " "
            majitel_meno = majitel_meno & Trim(GetProp("ClientPersonal.BusinessName2")) & " "
            majitel_meno = majitel_meno & Trim(GetProp("ClientPersonal.BusinessName3")) & " "
            majitel_meno = majitel_meno & Trim(GetProp("ClientPersonal.BusinessName4")) & " "
            majitel_meno = Trim(majitel_meno)
        End If
        SetProp "NV.MajitelMeno", majitel_meno
        
        
    ' CIF
        Dim majitel_cif As String
        majitel_cif = ""
        If Trim(GetProp("ClientGeneral.ClientNumber")) <> "" Then
            majitel_cif = Trim(GetProp("ClientGeneral.ClientNumber"))
        End If
        'SetProp "NV.CIF", majitel_cif
        
        
    ' Rodne cislo
        Dim majitel_rc As String
        ' MACH
        majitel_rc = Trim(GetProp("ClientPersonal.PersonalIDCZ"))
        If majitel_rc = "" Then majitel_rc = Trim(GetProp("ClientPersonal.PersonalIDNumber"))
        
        If Trim(GetProp("ClientPersonal.FiscalCode")) = "" Then
            SetProp "NV.DNV", "D|fffd|tum narodenia"
        Else
            SetProp "NV.DNV", "D|fffd|tum vzniku"
        End If
        SetProp "NV.RC", majitel_rc
        SetFormField "ft_RC", majitel_rc, True
        
        
    ' Datum narodenia
        Dim majitel_nar As String
        majitel_nar = ""
        If Trim(GetProp("ClientPersonal.DateOfBirth")) <> "" Then
            majitel_nar = Trim(GetProp("ClientPersonal.DateOfBirth"))
        End If
        SetProp "NV.DatumNar", majitel_nar
        SetFormField "ft_DatumNar", majitel_nar, False
        
        
    ' KONTROLA VEKU
        Dim Rodne As String
        Dim Rok As Integer
        Dim Mesiac As Integer
        Dim Den As Integer
        Dim MaKlient18aleboViacRokov As Boolean: MaKlient18aleboViacRokov = True
        If majitel_nar <> "" Then
            Rok = Mid(majitel_nar, 7, 4)
            Mesiac = Mid(majitel_nar, 4, 2)
            Den = Mid(majitel_nar, 1, 2)
            If DatePart("yyyy", Now) - Rok > 18 Then MaKlient18aleboViacRokov = True
            If DatePart("yyyy", Now) - Rok = 18 Then
                If Month(Now) > Mesiac Then MaKlient18aleboViacRokov = True
                If Month(Now) = Mesiac Then
                    If Day(Now) > Den Then MaKlient18aleboViacRokov = True
                    If Day(Now) = Den Then MaKlient18aleboViacRokov = True
                    If Day(Now) < Den Then MaKlient18aleboViacRokov = False
                End If
                If Month(Now) < Mesiac Then MaKlient18aleboViacRokov = False
            End If
            If DatePart("yyyy", Now) - Rok < 18 Then MaKlient18aleboViacRokov = False
        End If
        
        
    ' ICO
        Dim majitel_ico As String
        majitel_ico = ""
        If Trim(GetProp("ClientPersonal.FiscalCode")) <> "" Then
            majitel_ico = Trim(GetProp("ClientPersonal.FiscalCode"))
        End If
        SetProp "NV.ICO", majitel_ico
        SetFormField "ft_ICO", majitel_ico, True
        
        
    ' OP
        Dim majitel_op As String
        majitel_op = ""
        If Trim(GetProp("ClientPersonal.IDCardNumber")) <> "" Then
            majitel_op = Trim(GetProp("ClientPersonal.IDCardNumber"))
        End If
        'SetProp "NV.OP", majitel_op
        
        
    ' StatnaPrislusnost
        Dim majitel_statnaPrislusnost As String
        majitel_statnaPrislusnost = ""
        If Trim(GetProp("ClientStatistic.Citizenship.DisplayedText")) <> "" Then
            majitel_statnaPrislusnost = Trim(GetProp("ClientStatistic.Citizenship.DisplayedText"))
        End If
        'SetProp "NV.StatnaPrisl", majitel_statnaPrislusnost
        
        
    ' Iny doklad
        Dim majitel_inyDoklad As String
        Dim majitel_inyDoklad_ID As String
        If majitel_op = "AA 777777" Then
            majitel_op = ""
            majitel_inyDoklad = "Cestovn|fffd| pas"
            majitel_inyDoklad_ID = GetProp("ClientPersonal.PassportNumber")
        End If
        'SetProp "NV.InyDoklad", majitel_inyDoklad
        
        
    ' Adresa
        Dim majitel_adresa As String
        If Trim(GetProp("ClientDomicileAddress.DomicileStreet")) <> "" Then
            tt = GetProp("ClientDomicileAddress.DomicileStreet") & ", "
        End If
        If Trim(GetProp("ClientDomicileAddress.DomicilePOBox")) <> "" Then
            tt = tt & Trim(GetProp("ClientDomicileAddress.DomicilePOBox")) & ", "
        End If
        If tt = Left(GetProp("ClientDomicileAddress.DomicileCity"), Len(GetProp("ClientDomicileAddress.DomicileCity"))) Then
            tt = tt & GetProp("ClientDomicileAddress.DomicileZIPCode")
        Else
            tt = tt & GetProp("ClientDomicileAddress.DomicileCity") & " " & GetProp("ClientDomicileAddress.DomicileZIPCode")
        End If
        majitel_adresa = tt
        SetPropSeq "NV.MajitelAdresa", majitel_adresa
        
        
    ' ANALYZA VSETKYCH UDAJOV A NAPLNENIE ZOZNAMU "prepojenia"
        ' na zaciatku vyhodit "DUPL", "HKL", "BO*", "RKL", "MAJ", a vyhodit vsetky CA ktori nie su (03,04,05,06,07,11,12,13,25,26,34,36)
        
        Dim i As Integer: i = -1 ' iterator
        Dim x As Integer: x = -1 ' pamata si posledny naplneny index
        Dim tempKodVztahu As String
        Dim kontrolaSpravnosti As Boolean
        
        'udaje o vztahoch CLIENT-CLIENT - STARE UDAJE TODOOOOOOOOOO
        For i = 0 To 29
            tempKodVztahu = UCase(Trim(GetProp("ClientConnectedPerson[" & i & "].RelationCode")))
            If tempKodVztahu <> "" Then
                kontrolaSpravnosti = True
                If tempKodVztahu Like "BO*" Then kontrolaSpravnosti = False
                If tempKodVztahu = "BOC" Then kontrolaSpravnosti = False
                If tempKodVztahu = "DUPL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "DUP" Then kontrolaSpravnosti = False
                If tempKodVztahu = "HKL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "RKL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "MAJ" Then kontrolaSpravnosti = False
                If kontrolaSpravnosti Then
                    x = x + 1
                    prepojenia_ZoznamHlavny(x).kodVztahu = tempKodVztahu
                    prepojenia_ZoznamHlavny(x).kodVztahu_lenCisla = Right("00" & odstranVsetkoOkremCisel(tempKodVztahu), 2)
                    prepojenia_ZoznamHlavny(x).kodVztahuText = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).InfoObjectState = "...."
                    prepojenia_ZoznamHlavny(x).typVztahu = "CC"
                    
                    ' MACH
                    'prepojenia_ZoznamHlavny(x).klient_Meno = Trim(GetProp("ClientConnectedPerson[" & i & "].Name")) ' todo title
                    prepojenia_ZoznamHlavny(x).klient_Meno = ""
                    If Len(prepojenia_ZoznamHlavny(x).klient_Meno) = 0 Then
                        prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("ClientConnectedPerson[" & i & "].ClientFirstName") & " " & GetProp("ClientConnectedPerson[" & i & "].ClientLastName")
                        If Len(Trim(GetProp("ClientConnectedPerson[" & i & "].TitleProfessional"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("ClientConnectedPerson[" & i & "].TitleProfessional") & " " & prepojenia_ZoznamHlavny(x).klient_Meno
                        End If
                        If Len(Trim(GetProp("ClientConnectedPerson[" & i & "].TitleAfter"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = prepojenia_ZoznamHlavny(x).klient_Meno & ", " & GetProp("ClientConnectedPerson[" & i & "].TitleAfter")
                        End If
                    End If
                    
                    prepojenia_ZoznamHlavny(x).klient_CIF1 = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_CIF2 = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_RoleOfClient = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_DatNar = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_RodCis = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_ICO = "...." ' TODO
                    tt = ""
                    If Trim(GetProp("ClientConnectedPerson[" & i & "].Street")) <> "" Then
                        tt = GetProp("ClientConnectedPerson[" & i & "].Street") & ", "
                    End If
                    If tt = Left(GetProp("ClientConnectedPerson[" & i & "].City"), Len(GetProp("ClientConnectedPerson[" & i & "].City"))) Then
                        tt = tt & GetProp("ClientConnectedPerson[" & i & "].ZIPCode")
                    Else
                        tt = tt & GetProp("ClientConnectedPerson[" & i & "].City") & " " & GetProp("ClientConnectedPerson[" & i & "].ZIPCode")
                    End If
                    prepojenia_ZoznamHlavny(x).klient_Adresa = tt
                    prepojenia_ZoznamHlavny(x).klient_OP = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_StatnaPrislusnost = "...." ' TODO
                    prepojenia_ZoznamHlavny(x).klient_InyDoklad = "" ' TODO
                    prepojenia_ZoznamHlavny(x).klient_InyDokladID = "" ' TODO
                    prepojenia_ZoznamHlavny(x).spracovane = False
                End If
            End If
        Next i
        
        'udaje o vztahoch CLIENT-CLIENT - NOVE UDAJE
        For i = 0 To 29
            tempKodVztahu = UCase(Trim(GetProp("AuthorizedPersonCollection[" & i & "].RelationCode")))
            If UCase(Trim(GetProp("AuthorizedPersonCollection[" & i & "].RelationshipType"))) <> "" Then
                tempKodVztahu = UCase(Trim(GetProp("AuthorizedPersonCollection[" & i & "].RelationshipType")))
            End If
            If tempKodVztahu <> "" Then
                kontrolaSpravnosti = True
                If tempKodVztahu Like "BO*" Then kontrolaSpravnosti = False
                If tempKodVztahu = "BOC" Then kontrolaSpravnosti = False
                If tempKodVztahu = "DUPL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "DUP" Then kontrolaSpravnosti = False
                If tempKodVztahu = "HKL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "RKL" Then kontrolaSpravnosti = False
                If tempKodVztahu = "MAJ" Then kontrolaSpravnosti = False
                If kontrolaSpravnosti Then
                    x = x + 1
                    prepojenia_ZoznamHlavny(x).kodVztahu = tempKodVztahu
                    prepojenia_ZoznamHlavny(x).kodVztahu_lenCisla = Right("00" & odstranVsetkoOkremCisel(tempKodVztahu), 2)
                    prepojenia_ZoznamHlavny(x).kodVztahuText = Trim(GetProp("AuthorizedPersonCollection[" & i & "].Description"))
                    prepojenia_ZoznamHlavny(x).InfoObjectState = Trim(GetProp("AuthorizedPersonCollection[" & i & "].InfoObjectState"))
                    prepojenia_ZoznamHlavny(x).typVztahu = "CC"
                    
                    ' MACH
                    'prepojenia_ZoznamHlavny(x).klient_Meno = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.Name")) ' todo title
                    prepojenia_ZoznamHlavny(x).klient_Meno = ""
                    If Len(prepojenia_ZoznamHlavny(x).klient_Meno) = 0 Then
                        prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.ClientFirstName") & " " & GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.ClientLastName")
                        If Len(Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.TitleProfessional"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.TitleProfessional") & " " & prepojenia_ZoznamHlavny(x).klient_Meno
                        End If
                        If Len(Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = prepojenia_ZoznamHlavny(x).klient_Meno & ", " & GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter")
                        End If
                    End If
                    
                    prepojenia_ZoznamHlavny(x).klient_CIF1 = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_CIF2 = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientGeneral.ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_RoleOfClient = Trim(GetProp("AuthorizedPersonCollection[" & i & "].RoleOfClient"))
                    prepojenia_ZoznamHlavny(x).klient_DatNar = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.DateOfBirth"))
                    
                    ' MACH
                    prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDCZ"))
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then
                        prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDNumber"))
                    End If
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then prepojenia_ZoznamHlavny(x).klient_RodCis = "11111111"
                    
                    prepojenia_ZoznamHlavny(x).klient_ICO = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.FiscalCode"))
                    tt = ""
                    If Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileStreet")) <> "" Then
                        tt = GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileStreet") & ", "
                    End If
                    If Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicilePOBox")) <> "" Then
                        tt = GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicilePOBox") & ", "
                    End If
                    If tt = Left(GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity"), Len(GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity"))) Then
                        tt = tt & GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    Else
                        tt = tt & GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity") & " " & GetProp("AuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    End If
                    prepojenia_ZoznamHlavny(x).klient_Adresa = tt
                    prepojenia_ZoznamHlavny(x).klient_OP = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.IDCardNumber"))
                    prepojenia_ZoznamHlavny(x).klient_StatnaPrislusnost = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientStatistic.Citizenship.DisplayedText")) ' todo
                    If prepojenia_ZoznamHlavny(x).klient_OP = "AA 777777" Then
                        prepojenia_ZoznamHlavny(x).klient_OP = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = "Cestovn|fffd| pas"
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = Trim(GetProp("AuthorizedPersonCollection[" & i & "].ClientPersonal.PassportNumber"))
                    Else
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = ""
                    End If
                    prepojenia_ZoznamHlavny(x).spracovane = False
                End If
            End If
        Next i
        
        'udaje o vztahoch CLIENT-ACCOUNT - STARE UDAJE
        For i = 0 To 29
            tempKodVztahu = UCase(Trim(GetProp("CoHolderCollection[" & i & "].AuthorizationLevelID")))
            If tempKodVztahu <> "" Then
                kontrolaSpravnosti = True
                If tempKodVztahu = 9 Then kontrolaSpravnosti = False
                If tempKodVztahu = 10 Then kontrolaSpravnosti = False
                If tempKodVztahu = 14 Then kontrolaSpravnosti = False
                If tempKodVztahu = 15 Then kontrolaSpravnosti = False
                If tempKodVztahu = 16 Then kontrolaSpravnosti = False
                If tempKodVztahu = 17 Then kontrolaSpravnosti = False
                If tempKodVztahu = 27 Then kontrolaSpravnosti = False
                If tempKodVztahu = 28 Then kontrolaSpravnosti = False
                If tempKodVztahu = 30 Then kontrolaSpravnosti = False
                If tempKodVztahu = 31 Then kontrolaSpravnosti = False
                If tempKodVztahu = 32 Then kontrolaSpravnosti = False
                If tempKodVztahu = 33 Then kontrolaSpravnosti = False
                If tempKodVztahu = 37 Then kontrolaSpravnosti = False
                If tempKodVztahu = 38 Then kontrolaSpravnosti = False
                If tempKodVztahu = 39 Then kontrolaSpravnosti = False
                If tempKodVztahu = 40 Then kontrolaSpravnosti = False
                If tempKodVztahu = 41 Then kontrolaSpravnosti = False
                If tempKodVztahu = 42 Then kontrolaSpravnosti = False
                If tempKodVztahu = 50 Then kontrolaSpravnosti = False
                If kontrolaSpravnosti Then
                    x = x + 1
                    prepojenia_ZoznamHlavny(x).kodVztahu = tempKodVztahu
                    prepojenia_ZoznamHlavny(x).kodVztahu_lenCisla = Right("00" & odstranVsetkoOkremCisel(tempKodVztahu), 2)
                    prepojenia_ZoznamHlavny(x).kodVztahuText = Trim(GetProp("CoHolderCollection[" & i & "].AuthorizationLevelText"))
                    prepojenia_ZoznamHlavny(x).InfoObjectState = Trim(GetProp("CoHolderCollection[" & i & "].InfoObjectState"))
                    prepojenia_ZoznamHlavny(x).typVztahu = "CA"
                    
                    ' MACH
                    'prepojenia_ZoznamHlavny(x).klient_Meno = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.Name")) ' todo title
                    prepojenia_ZoznamHlavny(x).klient_Meno = ""
                    If Len(prepojenia_ZoznamHlavny(x).klient_Meno) = 0 Then
                        prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("CoHolderCollection[" & i & "].ClientPersonal.ClientFirstName") & " " & GetProp("CoHolderCollection[" & i & "].ClientPersonal.ClientLastName")
                        If Len(Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.TitleProfessional"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("CoHolderCollection[" & i & "].ClientPersonal.TitleProfessional") & " " & prepojenia_ZoznamHlavny(x).klient_Meno
                        End If
                        If Len(Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.TitleAfter"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = prepojenia_ZoznamHlavny(x).klient_Meno & ", " & GetProp("CoHolderCollection[" & i & "].ClientPersonal.TitleAfter")
                        End If
                    End If
                    
                    prepojenia_ZoznamHlavny(x).klient_CIF1 = Trim(GetProp("CoHolderCollection[" & i & "].ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_CIF2 = Trim(GetProp("CoHolderCollection[" & i & "].ClientGeneral.ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_RoleOfClient = Trim(GetProp("CoHolderCollection[" & i & "].RoleOfClient"))
                    prepojenia_ZoznamHlavny(x).klient_DatNar = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.DateOfBirth"))
                    
                    ' MACH
                    prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.PersonalIDCZ"))
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then
                        prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.PersonalIDNumber"))
                    End If
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then prepojenia_ZoznamHlavny(x).klient_RodCis = "11111111"
                    
                    prepojenia_ZoznamHlavny(x).klient_ICO = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.FiscalCode"))
                    tt = ""
                    If Trim(GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileStreet")) <> "" Then
                        tt = GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileStreet") & ", "
                    End If
                    If Trim(GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicilePOBox")) <> "" Then
                        tt = GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicilePOBox") & ", "
                    End If
                    If tt = Left(GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileCity"), Len(GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileCity"))) Then
                        tt = tt & GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    Else
                        tt = tt & GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileCity") & " " & GetProp("CoHolderCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    End If
                    prepojenia_ZoznamHlavny(x).klient_Adresa = tt
                    prepojenia_ZoznamHlavny(x).klient_OP = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.IDCardNumber"))
                    prepojenia_ZoznamHlavny(x).klient_StatnaPrislusnost = Trim(GetProp("CoHolderCollection[" & i & "].ClientStatistic.Citizenship.DisplayedText"))
                    If prepojenia_ZoznamHlavny(x).klient_OP = "AA 777777" Then
                        prepojenia_ZoznamHlavny(x).klient_OP = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = "Cestovn|fffd| pas"
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = Trim(GetProp("CoHolderCollection[" & i & "].ClientPersonal.PassportNumber"))
                    Else
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = ""
                    End If
                    prepojenia_ZoznamHlavny(x).spracovane = False
                End If
            End If
        Next i
        
        'udaje o vztahoch CLIENT-ACCOUNT - NOVE UDAJE
        For i = 0 To 29
            tempKodVztahu = UCase(Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].AuthorizationLevelID")))
            If tempKodVztahu <> "" Then
                kontrolaSpravnosti = True
                If tempKodVztahu = 9 Then kontrolaSpravnosti = False
                If tempKodVztahu = 10 Then kontrolaSpravnosti = False
                If tempKodVztahu = 14 Then kontrolaSpravnosti = False
                If tempKodVztahu = 15 Then kontrolaSpravnosti = False
                If tempKodVztahu = 16 Then kontrolaSpravnosti = False
                If tempKodVztahu = 17 Then kontrolaSpravnosti = False
                If tempKodVztahu = 27 Then kontrolaSpravnosti = False
                If tempKodVztahu = 28 Then kontrolaSpravnosti = False
                If tempKodVztahu = 30 Then kontrolaSpravnosti = False
                If tempKodVztahu = 31 Then kontrolaSpravnosti = False
                If tempKodVztahu = 32 Then kontrolaSpravnosti = False
                If tempKodVztahu = 33 Then kontrolaSpravnosti = False
                If tempKodVztahu = 37 Then kontrolaSpravnosti = False
                If tempKodVztahu = 38 Then kontrolaSpravnosti = False
                If tempKodVztahu = 39 Then kontrolaSpravnosti = False
                If tempKodVztahu = 40 Then kontrolaSpravnosti = False
                If tempKodVztahu = 41 Then kontrolaSpravnosti = False
                If tempKodVztahu = 42 Then kontrolaSpravnosti = False
                If tempKodVztahu = 50 Then kontrolaSpravnosti = False
                If kontrolaSpravnosti Then
                    x = x + 1
                    prepojenia_ZoznamHlavny(x).kodVztahu = tempKodVztahu
                    prepojenia_ZoznamHlavny(x).kodVztahu_lenCisla = Right("00" & odstranVsetkoOkremCisel(tempKodVztahu), 2)
                    prepojenia_ZoznamHlavny(x).kodVztahuText = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].AuthorizationLevelText"))
                    prepojenia_ZoznamHlavny(x).InfoObjectState = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].InfoObjectState"))
                    prepojenia_ZoznamHlavny(x).typVztahu = "CA"
                    
                    ' MACH
                    'prepojenia_ZoznamHlavny(x).klient_Meno = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.Name")) ' todo title
                    prepojenia_ZoznamHlavny(x).klient_Meno = ""
                    If Len(prepojenia_ZoznamHlavny(x).klient_Meno) = 0 Then
                        prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.ClientFirstName") & " " & GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.ClientLastName")
                        If Len(Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.TitleProfessional"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.TitleProfessional") & " " & prepojenia_ZoznamHlavny(x).klient_Meno
                        End If
                        If Len(Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter"))) <> 0 Then
                            prepojenia_ZoznamHlavny(x).klient_Meno = prepojenia_ZoznamHlavny(x).klient_Meno & ", " & GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter")
                        End If
                    End If
                    
                    prepojenia_ZoznamHlavny(x).klient_CIF1 = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_CIF2 = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientGeneral.ClientNumber"))
                    prepojenia_ZoznamHlavny(x).klient_RoleOfClient = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].RoleOfClient"))
                    prepojenia_ZoznamHlavny(x).klient_DatNar = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.DateOfBirth"))
                    
                    ' MACH
                    prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDCZ"))
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then
                        prepojenia_ZoznamHlavny(x).klient_RodCis = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDNumber"))
                    End If
                    If prepojenia_ZoznamHlavny(x).klient_RodCis = "" Then prepojenia_ZoznamHlavny(x).klient_RodCis = "11111111"
                    
                    prepojenia_ZoznamHlavny(x).klient_ICO = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.FiscalCode"))
                    tt = ""
                    If Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileStreet")) <> "" Then
                        tt = GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileStreet") & ", "
                    End If
                    If Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicilePOBox")) <> "" Then
                        tt = GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicilePOBox") & ", "
                    End If
                    If tt = Left(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity"), Len(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity"))) Then
                        tt = tt & GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    Else
                        tt = tt & GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileCity") & " " & GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientDomicileAddress.DomicileZIPCode")
                    End If
                    prepojenia_ZoznamHlavny(x).klient_Adresa = tt
                    prepojenia_ZoznamHlavny(x).klient_OP = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.IDCardNumber"))
                    prepojenia_ZoznamHlavny(x).klient_StatnaPrislusnost = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientStatistic.Citizenship.DisplayedText"))
                    If prepojenia_ZoznamHlavny(x).klient_OP = "AA 777777" Then
                        prepojenia_ZoznamHlavny(x).klient_OP = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = "Cestovn|fffd| pas"
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = Trim(GetProp("AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.PassportNumber"))
                    Else
                        prepojenia_ZoznamHlavny(x).klient_InyDoklad = ""
                        prepojenia_ZoznamHlavny(x).klient_InyDokladID = ""
                    End If
                    prepojenia_ZoznamHlavny(x).spracovane = False
                End If
            End If
        Next i
        
        prepojenia_ZoznamHlavny_lastIndex = x
        
        
    ' ZORADENIE VZTAHOV DO ZOZNAMU "SPLNOMOCNENE OSOBY" (premenna prepojenia_ZoznamSplnomocOsoby)
        Dim j As Integer: j = -1 ' iterator nad kodom vztahu
        x = -1
        
        For j = 0 To 50 ' SKUSIME SKOPIROVAT Z "prepojenia" DO "prepojenia_SplnomocOsoby" POSTUPNE PODLA CISELNEHO KODU (od  1 az po 50), NAJPRV ZAZNAMY TYPU "CC"
            For i = 0 To prepojenia_ZoznamHlavny_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
                If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla <> "00" Then ' ignorujeme tie vztahy kde v kode nie je cislo
                    If prepojenia_ZoznamHlavny(i).typVztahu = "CC" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = j And prepojenia_ZoznamHlavny(i).spracovane = False Then
                        'If prepojenia_ZoznamHlavny(i).InfoObjectState <> "Delete" Then
                            x = x + 1
                            prepojenia_ZoznamSplnomocOsoby(x) = prepojenia_ZoznamHlavny(i)
                            prepojenia_ZoznamHlavny(i).spracovane = True
                        'End If
                    End If
                End If
            Next i
        Next j
        For j = 0 To 50 ' SKUSIME SKOPIROVAT Z "prepojenia" DO "prepojenia_SplnomocOsoby" POSTUPNE PODLA CISELNEHO KODU (od  1 az po 50), ZAZNAMY TYPU "CA"
            For i = 0 To prepojenia_ZoznamHlavny_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
                If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla <> "00" Then ' ignorujeme tie vztahy kde v kode nie je cislo
                    If prepojenia_ZoznamHlavny(i).typVztahu = "CA" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = j And prepojenia_ZoznamHlavny(i).spracovane = False Then
                        'If prepojenia_ZoznamHlavny(i).InfoObjectState <> "Delete" Then
                            x = x + 1
                            prepojenia_ZoznamSplnomocOsoby(x) = prepojenia_ZoznamHlavny(i)
                            prepojenia_ZoznamHlavny(i).spracovane = True
                        'End If
                    End If
                End If
            Next i
        Next j
        prepojenia_ZoznamSplnomocOsoby_lastIndex = x
        
        
    ' ZRESETUJEME PREMENNE "spracovane"
        For i = 0 To prepojenia_ZoznamHlavny_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
            If prepojenia_ZoznamHlavny(i).typVztahu <> "" Then
                If prepojenia_ZoznamHlavny(i).spracovane = True Then
                    x = x + 1
                    prepojenia_ZoznamHlavny(i).spracovane = False
                Else
                    tt = "do zoznamu SPLNOMOCNENE OSOBY sa nedostal vztah: "
                    tt = tt & "Klient: " & prepojenia_ZoznamHlavny(i).klient_Meno & " // "
                    tt = tt & "TypVztahu: " & prepojenia_ZoznamHlavny(i).typVztahu & " // "
                    tt = tt & "Vztah: " & prepojenia_ZoznamHlavny(i).kodVztahu & ""
                    Debug.Print tt
                End If
            End If
        Next i
        
        
    ' ZORADENIE VZTAHOV DO ZOZNAMU "PODPISY KLIENTA" (premenna prepojenia_ZoznamSplnomocOsoby)
        x = -1
        For j = 0 To 50 ' SKUSIME SKOPIROVAT Z "prepojenia" DO "prepojenia_SplnomocOsoby" POSTUPNE PODLA CISELNEHO KODU (od  1 az po 50), ZAZNAMY TYPU "CA"
            For i = 0 To prepojenia_ZoznamHlavny_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
                If prepojenia_ZoznamHlavny(i).typVztahu = "CA" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = j And prepojenia_ZoznamHlavny(i).spracovane = False And _
                        (prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = 25 Or prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = 26) Then
                    If prepojenia_ZoznamHlavny(i).klient_RoleOfClient <> "Z|fffd|KONN|fffd| Z|fffd|STUPCA" Then
                        'If prepojenia_ZoznamHlavny(i).InfoObjectState <> "Delete" Then
                            x = x + 1
                            prepojenia_ZoznamPodpisyKlient(x) = prepojenia_ZoznamHlavny(i)
                            prepojenia_ZoznamHlavny(i).spracovane = True
                        'End If
                    End If
                End If
            Next i
        Next j
        For j = 0 To 50 ' SKUSIME SKOPIROVAT Z "prepojenia" DO "prepojenia_SplnomocOsoby" POSTUPNE PODLA CISELNEHO KODU (od  1 az po 50), NAJPRV ZAZNAMY TYPU "CC"
            For i = 0 To prepojenia_ZoznamHlavny_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
                If prepojenia_ZoznamHlavny(i).typVztahu = "CC" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = j And prepojenia_ZoznamHlavny(i).spracovane = False Then
                    If prepojenia_ZoznamHlavny(i).klient_RoleOfClient <> "Z|fffd|KONN|fffd| Z|fffd|STUPCA" Then
                        'If prepojenia_ZoznamHlavny(i).InfoObjectState <> "Delete" Then
                            x = x + 1
                            prepojenia_ZoznamPodpisyKlient(x) = prepojenia_ZoznamHlavny(i)
                            prepojenia_ZoznamHlavny(i).spracovane = True
                        'End If
                    End If
                End If
            Next i
        Next j
        prepojenia_ZoznamPodpisyKlient_lastIndex = x
        
        
    ' KONTROLA ZOZNAMOV
        Dim PridatNaPrveMiestoSplnomocnenychMajitelaUctu As Boolean
        Dim PridatNaPrveMiestoPodpisovatelovMajitelaUctu As Boolean
        PridatNaPrveMiestoSplnomocnenychMajitelaUctu = False
        PridatNaPrveMiestoPodpisovatelovMajitelaUctu = False
        If (prepojenia_ZoznamSplnomocOsoby_lastIndex = -1) Then
            PridatNaPrveMiestoSplnomocnenychMajitelaUctu = True
            If (GetProp("ClientGeneral.ClientType") = 33 Or GetProp("ClientGeneral.ClientType") = 98) Then ' Ak je to pravnicka osoba
                PridatNaPrveMiestoSplnomocnenychMajitelaUctu = False
                MsgBox "CHYBA: Nie s|fffd| nadefinovan|fffd| vz|fffd|ahy klient |fffd||fffd|et!"
                ActiveDocument.Close False
            End If
        End If
        If (prepojenia_ZoznamPodpisyKlient_lastIndex = -1) Or (prepojenia_ZoznamPodpisyKlient_lastIndex = 0 And prepojenia_ZoznamPodpisyKlient(0).kodVztahu_lenCisla = "03") Then
            PridatNaPrveMiestoPodpisovatelovMajitelaUctu = True
        End If
        
        
    ' KONTROLA ZOZNAMU PODPISY KLIENT (podla mailu p. Urblikovej 17.4.2015 16.23)
        If (GetProp("ClientGeneral.ClientType") = 11 Or GetProp("ClientGeneral.ClientType") = 99) Then
            PridatNaPrveMiestoPodpisovatelovMajitelaUctu = True
            If Not MaKlient18aleboViacRokov Then PridatNaPrveMiestoPodpisovatelovMajitelaUctu = False
            For i = 0 To prepojenia_ZoznamPodpisyKlient_lastIndex
                If prepojenia_ZoznamPodpisyKlient(i).typVztahu = "CC" Then
                    If prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "ZAK" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPL" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "POA" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKP" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKO" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPU" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "POR" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "TUD" _
                    Then
                        prepojenia_ZoznamPodpisyKlient(i).klient_Meno = "VYNECHAT!"
                    End If
                End If
            Next i
        End If
        If (GetProp("ClientGeneral.ClientType") = 22 Or GetProp("ClientGeneral.ClientType") = 97) Then
            PridatNaPrveMiestoPodpisovatelovMajitelaUctu = True
            For i = 0 To prepojenia_ZoznamPodpisyKlient_lastIndex
                If prepojenia_ZoznamPodpisyKlient(i).typVztahu = "CA" Then
                    prepojenia_ZoznamPodpisyKlient(i).klient_Meno = "VYNECHAT!"
                End If
                If prepojenia_ZoznamPodpisyKlient(i).typVztahu = "CC" Then
                    If prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPL" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "POA" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKP" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKO" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPU" _
                    Then
                        prepojenia_ZoznamPodpisyKlient(i).klient_Meno = "VYNECHAT!"
                    End If
                End If
            Next i
        End If
        If (GetProp("ClientGeneral.ClientType") = 33 Or GetProp("ClientGeneral.ClientType") = 98) Then
            PridatNaPrveMiestoPodpisovatelovMajitelaUctu = False
            For i = 0 To prepojenia_ZoznamPodpisyKlient_lastIndex
                If prepojenia_ZoznamPodpisyKlient(i).typVztahu = "CA" Then
                    prepojenia_ZoznamPodpisyKlient(i).klient_Meno = "VYNECHAT!"
                End If
                If prepojenia_ZoznamPodpisyKlient(i).typVztahu = "CC" Then
                    If prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "KON" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "LR" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "STR" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "KOM" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPL" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "POA" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SPU" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKP" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "SKO" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "PRE" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "POD" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "CLE" And _
                       prepojenia_ZoznamPodpisyKlient(i).kodVztahu <> "PRO" _
                    Then
                        prepojenia_ZoznamPodpisyKlient(i).klient_Meno = "VYNECHAT!"
                    End If
                End If
            Next i
        End If
        
        
    ' KONTROLA AK JE 0 PODPISOVATELOV
        If (prepojenia_ZoznamPodpisyKlient_lastIndex = -1) Or (prepojenia_ZoznamPodpisyKlient_lastIndex = 0 And prepojenia_ZoznamPodpisyKlient(0).kodVztahu_lenCisla = "03") Then
            If (GetProp("ClientGeneral.ClientType") = 33 Or GetProp("ClientGeneral.ClientType") = 98) Then
                MsgBox "CHYBA: nie s|fffd| nadefinovan|fffd| vztahy"
                ActiveDocument.Close False
            End If
        End If
        
        
    ' KONTROLA CI JE VIAC AKO 2 SPOLUMAJITELOV
        j = 1 ' pocet spolumajitelov (1. je hlavny majitel uctu)
        For i = 0 To prepojenia_ZoznamHlavny_lastIndex
            If (prepojenia_ZoznamSplnomocOsoby(i).kodVztahu_lenCisla = "25" Or prepojenia_ZoznamSplnomocOsoby(i).kodVztahu_lenCisla = "26") And _
               prepojenia_ZoznamSplnomocOsoby(i).typVztahu = "CA" _
            Then
                j = j + 1
                If majitel_cif <> prepojenia_ZoznamSplnomocOsoby(i).klient_CIF2 Then
                    'PridatNaPrveMiestoSplnomocnenychMajitelaUctu = True
                    'PridatNaPrveMiestoPodpisovatelovMajitelaUctu = True
                    SetProp "NV.MajitelMeno", GetProp("NV.MajitelMeno") & ", " & vbCrLf & prepojenia_ZoznamSplnomocOsoby(i).klient_Meno
                    SetProp "NV.RC", GetProp("NV.RC") & ", " & vbCrLf & prepojenia_ZoznamSplnomocOsoby(i).klient_RodCis
                    SetFormField "ft_RC", GetProp("NV.RC"), False
                    SetProp "NV.DatumNar", GetProp("NV.DatumNar") & ", " & vbCrLf & prepojenia_ZoznamSplnomocOsoby(i).klient_DatNar
                    SetFormField "ft_DatumNar", GetProp("NV.DatumNar"), False
                    SetProp "NV.ICO", GetProp("NV.ICO")
                    tt = GetProp("NV.MajitelAdresa1") & GetProp("NV.MajitelAdresa2") & GetProp("NV.MajitelAdresa3")
                    tt = tt & "; " & vbCrLf & prepojenia_ZoznamSplnomocOsoby(i).klient_Adresa
                    SetPropSeq "NV.MajitelAdresa", tt
                End If
                If j > 3 Then
                    MsgBox "CHYBA: |fffd||fffd|et m|fffd| viac ako 2 spolumajite|fffd|ov. Kontaktujte pros|fffd|m oddelenie Operational Organisation (Metodika)."
                    ActiveDocument.Close False
                End If
            End If
        Next i
    
    
    ' KONTROLA CHYB
        'Dim pocetCA As Integer: pocetCA = 0
        'Dim pocetCC As Integer: pocetCC = 0 ' (typ "CX" - pismenkovi s cislom)
        'Dim pocetCX As Integer: pocetCX = 0 ' (typ "CX" - pismenkovi bez cisla)
        'For i = 0 To prepojenia_ZoznamHlavny_lastIndex
        '    If prepojenia_ZoznamHlavny(i).typVztahu = "CA" Then pocetCA = pocetCA + 1
        '    If prepojenia_ZoznamHlavny(i).typVztahu = "CC" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla <> "00" Then pocetCC = pocetCC + 1
        '    If prepojenia_ZoznamHlavny(i).typVztahu = "CC" And prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = "00" Then pocetCX = pocetCX + 1
        'Next i
        'If pocetCA = 0 And pocetCC = 0 And pocetCX > 1 Then
        '    MsgBox "CHYBA: ch|fffd|ba spr|fffd|vne vytvoreny vz|fffd|ah."
        '    ActiveDocument.Close False
        'End If
        
        
    ' KONTROLA CHYB
        'Dim Pocet_ZAK_POR_SPU_SPL_True As Integer: Pocet_ZAK_POR_SPU_SPL_True = 0
        'Dim Pocet_ZAK_POR_SPU_SPL_Fals As Integer: Pocet_ZAK_POR_SPU_SPL_Fals = 0
        'If (GetProp("ClientGeneral.ClientType") = 11 Or _
        '    GetProp("ClientGeneral.ClientType") = 99 Or _
        '    GetProp("ClientGeneral.ClientType") = 22 Or _
        '    GetProp("ClientGeneral.ClientType") = 97) _
        'Then
        '    For i = 0 To prepojenia_ZoznamHlavny_lastIndex
        '        If majitel_cif <> prepojenia_ZoznamHlavny(i).klient_CIF Then
        '            If (prepojenia_ZoznamHlavny(i).kodVztahu = "ZAK" Or _
        '                prepojenia_ZoznamHlavny(i).kodVztahu = "POR" Or _
        '                prepojenia_ZoznamHlavny(i).kodVztahu = "SPU" Or _
        '                prepojenia_ZoznamHlavny(i).kodVztahu = "SPL") _
        '            Then
        '                Pocet_ZAK_POR_SPU_SPL_True = Pocet_ZAK_POR_SPU_SPL_True + 1
        '            Else
        '                Pocet_ZAK_POR_SPU_SPL_Fals = Pocet_ZAK_POR_SPU_SPL_Fals + 1
        '            End If
        '        End If
        '    Next i
        '    If Pocet_ZAK_POR_SPU_SPL_True > 0 And Pocet_ZAK_POR_SPU_SPL_Fals <> 0 Then
        '        MsgBox "CHYBA: V pr|fffd|pade ak je zadan|fffd| vz|fffd|ah ZAK/POR/SPU/SPL nem|fffd||fffd|e by|fffd| nastaven|fffd| vz|fffd|ah klient-klient, ktor|fffd| nie je ZAK/POR/SPU/SPL."
        '        ActiveDocument.Close False
        '    End If
        'End If
        
        
    ' KONTROLA CHYB
        ' ak je kod 04 a 05 pri jednom |fffd||fffd|te - vyhodit chybu "Kombin|fffd|cia kodu 04 a 05 na jednom |fffd||fffd|te sa vylu|fffd|uje, opravte kody vz|fffd|ahov" - VYPNUTE
        ' ak je kod 25 a 26 pri jednom |fffd||fffd|te - vyhodi|fffd| chybu "Kombin|fffd|cia kodu 25 a 26 na jednom |fffd||fffd|te sa vylu|fffd|uje, opravte kody vz|fffd|ahov"
        Dim Pocet_04 As Integer: Pocet_04 = 0
        Dim Pocet_05 As Integer: Pocet_05 = 0
        Dim Pocet_25 As Integer: Pocet_25 = 0
        Dim Pocet_26 As Integer: Pocet_26 = 0
        For i = 0 To prepojenia_ZoznamHlavny_lastIndex
            'If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = "04" Then Pocet_04 = Pocet_04 + 1 ' vypneme
            'If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = "05" Then Pocet_05 = Pocet_05 + 1 ' vypneme
            If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = "25" Then Pocet_25 = Pocet_25 + 1
            If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla = "26" Then Pocet_26 = Pocet_26 + 1
        Next i
        If Pocet_04 > 0 And Pocet_05 > 0 Then
            MsgBox "Kombin|fffd|cia kodu 04 a 05 na jednom |fffd||fffd|te sa vylu|fffd|uje, opravte kody vz|fffd|ahov"
            ActiveDocument.Close False
        End If
        If Pocet_25 > 0 And Pocet_26 > 0 Then
            MsgBox "Kombin|fffd|cia kodu 25 a 26 na jednom |fffd||fffd|te sa vylu|fffd|uje, opravte kody vz|fffd|ahov"
            ActiveDocument.Close False
        End If
        
        
    ' ODSTRANIME PRIPADY AK SA VYTVORIL VZTAH SO SAMYM SEBOU
        For i = 0 To prepojenia_ZoznamHlavny_lastIndex
            If prepojenia_ZoznamHlavny(i).klient_CIF2 = majitel_cif Then
                If prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla <> "25" Or _
                   prepojenia_ZoznamHlavny(i).kodVztahu_lenCisla <> "26" Then
                    prepojenia_ZoznamHlavny(i).klient_Meno = "VYNECHAT!"
                End If
            End If
        Next i
        
        
    ' ****************
    ' NAPLNENIE UDAJOV
    ' ****************
        'x = -1
        'If PridatNaPrveMiestoSplnomocnenychMajitelaUctu Then
        '    x = x + 1
        '    Form_VyberSplnomocOs.pridajDoZoznamuPolozku x & ".) " & majitel_meno
        'End If
        'For i = 0 To prepojenia_ZoznamSplnomocOsoby_lastIndex
        '    x = x + 1
        '    Form_VyberSplnomocOs.pridajDoZoznamuPolozku x & ".) " & prepojenia_ZoznamSplnomocOsoby(i).klient_Meno
        'Next i
        'Form_VyberSplnomocOs.ComboBox1.Value = "...vyber..."
        'Form_VyberSplnomocOs.Show
        'Debug.Print GetProp("NV.SO_index")
        'If Not IsNumeric(GetProp("NV.SO_index")) Then
        '    MsgBox "Chyba"
        '    ActiveDocument.Close False
        'End If
        Dim index As Integer
        'index = CInt(GetProp("NV.SO_index"))
        'If PridatNaPrveMiestoSplnomocnenychMajitelaUctu And index = 0 Then
            index = 9999
        'ElseIf PridatNaPrveMiestoSplnomocnenychMajitelaUctu And index > 0 Then
        '    index = index - 1
        'End If
        
        If index = 9999 Then
            SetFormField "ft_SO_MENO", majitel_meno, False
            'SetFormField "ft_SO_CIF", majitel_cif, False
            'SetFormField "ft_SO_ADRESA", majitel_adresa, False
            SetFormField "ft_SO_RC", majitel_rc, True
            If majitel_ico <> "" Then SetFormField "ft_SO_RC", majitel_ico, False
            SetFormField "ft_SO_NAR", majitel_nar, False
            'SetFormField "ft_SO_OP", majitel_op, False
            'SetFormField "ft_SO_INYDOKLAD", majitel_inyDoklad, False
            'SetFormField "ft_SO_INYDOKLAD_ID", majitel_inyDoklad_ID, False
            'SetFormField "ft_SO_STATPRISLUS", majitel_statnaPrislusnost, True
            SetFormField "ft_SO_KOD", "03 - len majite|fffd| |fffd||fffd|tu (plat|fffd| len pre fyzick|fffd| osoby) / len u|fffd||fffd|vate|fffd| schr|fffd|nky", False
            If Pocet_25 > 0 Then SetFormField "ft_SO_KOD", "25 - spolumajite|fffd| spolo|fffd|n|fffd|ho |fffd||fffd|tu - samostatne", False
            If Pocet_26 > 0 Then SetFormField "ft_SO_KOD", "26 - spolumajitelia spolo|fffd|n|fffd|ho |fffd||fffd|tu - spolo|fffd|ne", False
        Else
            SetFormField "ft_SO_MENO", prepojenia_ZoznamSplnomocOsoby(index).klient_Meno, False
            'SetFormField "ft_SO_CIF", prepojenia_ZoznamSplnomocOsoby(index).klient_CIF, False
            SetFormField "ft_SO_RC", prepojenia_ZoznamSplnomocOsoby(index).klient_RodCis, True
            If prepojenia_ZoznamSplnomocOsoby(index).klient_ICO <> "" Then SetFormField "ft_SO_RC", prepojenia_ZoznamSplnomocOsoby(index).klient_ICO, False
            SetFormField "ft_SO_NAR", prepojenia_ZoznamSplnomocOsoby(index).klient_DatNar, False
            'SetFormField "ft_SO_OP", prepojenia_ZoznamSplnomocOsoby(index).klient_OP, False
            'SetFormField "ft_SO_INYDOKLAD", prepojenia_ZoznamSplnomocOsoby(index).klient_InyDoklad, True
            'SetFormField "ft_SO_INYDOKLAD_ID", prepojenia_ZoznamSplnomocOsoby(index).klient_InyDokladID, True
            'SetFormField "ft_SO_STATPRISLUS", prepojenia_ZoznamSplnomocOsoby(index).klient_StatnaPrislusnost, True
            'SetFormField "ft_SO_ADRESA", prepojenia_ZoznamSplnomocOsoby(index).klient_Adresa, False
            tt = prepojenia_ZoznamSplnomocOsoby(index).kodVztahu_lenCisla
            If tt = "03" Then tt = tt & " - len majite|fffd| |fffd||fffd|tu (plat|fffd| len pre fyzick|fffd| osoby) / len u|fffd||fffd|vate|fffd| schr|fffd|nky"
            If tt = "04" Then tt = tt & " - ka|fffd|d|fffd| opr|fffd|vnen|fffd| osoba samostatne (vr|fffd|tane zria|fffd|ovania, zmeny a ru|fffd|enia Vkladov na Vkladov|fffd|ch |fffd||fffd|toch)"
            If tt = "05" Then tt = tt & " - opr|fffd|vnen|fffd| osoba spolu s majite|fffd|om |fffd||fffd|tu / opr|fffd|vnen|fffd| osoba spolu u|fffd||fffd|vate|fffd|om schr|fffd|nky"
            If tt = "06" Then tt = tt & " - dvaja v zmysle podpisov|fffd|ho vzoru (vr|fffd|tane zria|fffd|ovania, zmeny a ru|fffd|enia Vkladov na Vkladov|fffd|ch |fffd||fffd|toch)"
            If tt = "07" Then tt = tt & " - in|fffd| sp|fffd|sob *) presn|fffd| definovanie opr|fffd|vnenia, podlieha schv|fffd|leniu obchodn|fffd|ho miesta"
            If tt = "11" Then tt = tt & " - preberanie p|fffd|somnost|fffd| k |fffd||fffd|tu (v|fffd|pisy a in|fffd|.)"
            If tt = "12" Then tt = tt & " - doru|fffd|ovanie p|fffd|somnost|fffd| k |fffd||fffd|tu (pr|fffd|kazy na z|fffd||fffd|tovanie a in|fffd|.)"
            If tt = "13" Then tt = tt & " - preberanie a doru|fffd|ovanie p|fffd|somnost|fffd| k |fffd||fffd|tu"
            If tt = "20" Then tt = tt & " - z|fffd|konn|fffd| z|fffd|stupca neplnoletej osoby"
            If tt = "25" Then tt = tt & " - spolumajite|fffd| spolo|fffd|n|fffd|ho |fffd||fffd|tu - samostatne"
            If tt = "26" Then tt = tt & " - spolumajitelia spolo|fffd|n|fffd|ho |fffd||fffd|tu - spolo|fffd|ne"
            If tt = "34" Then tt = tt & " - len zria|fffd|ova|fffd|, meni|fffd| a ru|fffd|i|fffd| Vklady na Vkladov|fffd|ch |fffd||fffd|toch a za t|fffd|m |fffd||fffd|elom zrealizova|fffd| prevod z tohto |fffd||fffd|tu na Vkladov|fffd| |fffd||fffd|et - samostatne"
            If tt = "36" Then tt = tt & " - len zria|fffd|ova|fffd|, meni|fffd| a ru|fffd|i|fffd| Vklady na Vkladov|fffd|ch |fffd||fffd|toch a za t|fffd|m |fffd||fffd|elom zrealizova|fffd| prevod z tohto |fffd||fffd|tu na Vkladov|fffd| |fffd||fffd|et - dvaja spolo|fffd|ne"
            If tt = "00" Then tt = ""
            SetFormField "ft_SO_KOD", tt, False
        End If
        
        
        
        ' *** NAPLNIME UDAJE DO ZOZNAMU "PODPISY KLIENTA" *
        ' KONTROLA CI EXISTUJE ClientRepresentativeCollection
        tt = GetProp("ClientRepresentativeCollection[0].Name") & " " & GetProp("ClientRepresentativeCollection[0].Surname")
        
        ' AK EXISTUJE ClientRepresentativeCollection
        If Len(Trim(tt)) > 0 Then
        
            For i = 0 To 30
                tt = ""
                If Len(Trim(GetProp("ClientRepresentativeCollection[" & i & "].Name"))) <> 0 Then
                    tt = GetProp("ClientRepresentativeCollection[" & i & "].Name") & " " & GetProp("ClientRepresentativeCollection[" & i & "].Surname")
                    If Trim(GetProp("ClientRepresentativeCollection[" & i & "].ClientRepresentativeID")) <> "" Then
                        For j = 0 To 10
                            If Trim(GetProp("AuthorizedPersonCollection[" & j & "].ClientNumber")) = Trim(GetProp("ClientRepresentativeCollection[" & i & "].ClientRepresentativeID")) Then
                                tt = GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.ClientFirstName") & " " & GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.ClientLastName")
                                If Len(Trim(GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.TitleProfessional"))) <> 0 Then
                                    tt = GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.TitleProfessional") & " " & tt
                                End If
                                If Len(Trim(GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.TitleAfter"))) <> 0 Then
                                    tt = tt & ", " & GetProp("AuthorizedPersonCollection[" & j & "].ClientPersonal.TitleAfter")
                                End If
                            End If
                        Next j
                    End If
                    If Len(Trim(GetProp("ClientRepresentativeCollection[" & i & "].Position"))) <> 0 Then
                        tt = tt & ", " & GetProp("ClientRepresentativeCollection[" & i & "].Position")
                    End If
                    SetProp "NV.PK" & i, tt
                End If
            Next i
            
            
            For i = 0 To 30
                If GetProp("NV.PK" & i) = "" Then Exit For
                If i = 0 Then Form_VyberPodpisovatelov.CheckBox1.Caption = GetProp("NV.PK" & i)
                If i = 1 Then Form_VyberPodpisovatelov.CheckBox2.Caption = GetProp("NV.PK" & i)
                If i = 2 Then Form_VyberPodpisovatelov.CheckBox3.Caption = GetProp("NV.PK" & i)
                If i = 3 Then Form_VyberPodpisovatelov.CheckBox4.Caption = GetProp("NV.PK" & i)
                If i = 4 Then Form_VyberPodpisovatelov.CheckBox5.Caption = GetProp("NV.PK" & i)
                If i = 5 Then Form_VyberPodpisovatelov.CheckBox6.Caption = GetProp("NV.PK" & i)
                If i = 6 Then Form_VyberPodpisovatelov.CheckBox7.Caption = GetProp("NV.PK" & i)
                If i = 7 Then Form_VyberPodpisovatelov.CheckBox8.Caption = GetProp("NV.PK" & i)
                If i = 8 Then Form_VyberPodpisovatelov.CheckBox9.Caption = GetProp("NV.PK" & i)
                If i = 9 Then Form_VyberPodpisovatelov.CheckBox10.Caption = GetProp("NV.PK" & i)
                If i = 10 Then Form_VyberPodpisovatelov.CheckBox11.Caption = GetProp("NV.PK" & i)
                If i = 11 Then Form_VyberPodpisovatelov.CheckBox12.Caption = GetProp("NV.PK" & i)
                If i = 12 Then Form_VyberPodpisovatelov.CheckBox13.Caption = GetProp("NV.PK" & i)
                If i = 13 Then Form_VyberPodpisovatelov.CheckBox14.Caption = GetProp("NV.PK" & i)
                If i = 14 Then Form_VyberPodpisovatelov.CheckBox15.Caption = GetProp("NV.PK" & i)
                If i = 15 Then Form_VyberPodpisovatelov.CheckBox16.Caption = GetProp("NV.PK" & i)
                If i = 16 Then Form_VyberPodpisovatelov.CheckBox17.Caption = GetProp("NV.PK" & i)
                If i = 17 Then Form_VyberPodpisovatelov.CheckBox18.Caption = GetProp("NV.PK" & i)
                If i = 18 Then Form_VyberPodpisovatelov.CheckBox19.Caption = GetProp("NV.PK" & i)
                If i = 19 Then Form_VyberPodpisovatelov.CheckBox20.Caption = GetProp("NV.PK" & i)
            Next i
            Form_VyberPodpisovatelov.Height = 66 + i * 18
            Form_VyberPodpisovatelov.Show
            
            x = 0
            For i = 0 To 30
                If GetProp("NV.PK" & i) <> "" Then
                    SetFormField "NV_PK" & x, GetProp("NV.PK" & i), True
                    x = x + 1
                End If
                If x > 4 Then
                    MsgBox "Pozor! Je viac ako 5 podpisovate|fffd|ov. Do dokumentu je mo|fffd|n|fffd| prida|fffd| maxim|fffd|lne 5 podpisovate|fffd|ov. Pros|fffd|m skontroluje na konci dokumentu podpisy!"
                    Exit For
                End If
            Next i
        
        ' AK NE EXISTUJE ClientRepresentativeCollection
        Else
            x = 0
            If PridatNaPrveMiestoPodpisovatelovMajitelaUctu Then
                SetProp "NV.PK" & x, majitel_meno
                x = x + 1
            End If
            For i = 0 To prepojenia_ZoznamPodpisyKlient_lastIndex ' SKONTROLUJEME VSETKY ZAZNAMY Z "prepojenia"
                If prepojenia_ZoznamPodpisyKlient(i).klient_Meno <> "VYNECHAT!" Then
                    If Trim(prepojenia_ZoznamPodpisyKlient(i).kodVztahuText) = "" Then
                        SetProp "NV.PK" & x, prepojenia_ZoznamPodpisyKlient(i).klient_Meno
                    Else
                        SetProp "NV.PK" & x, prepojenia_ZoznamPodpisyKlient(i).klient_Meno & " - " & prepojenia_ZoznamPodpisyKlient(i).kodVztahuText
                    End If
                    x = x + 1
                End If
            Next i
            
            For i = 0 To 30
                If GetProp("NV.PK" & i) = "" Then Exit For
                If i = 0 Then Form_VyberPodpisovatelov.CheckBox1.Caption = GetProp("NV.PK" & i)
                If i = 1 Then Form_VyberPodpisovatelov.CheckBox2.Caption = GetProp("NV.PK" & i)
                If i = 2 Then Form_VyberPodpisovatelov.CheckBox3.Caption = GetProp("NV.PK" & i)
                If i = 3 Then Form_VyberPodpisovatelov.CheckBox4.Caption = GetProp("NV.PK" & i)
                If i = 4 Then Form_VyberPodpisovatelov.CheckBox5.Caption = GetProp("NV.PK" & i)
                If i = 5 Then Form_VyberPodpisovatelov.CheckBox6.Caption = GetProp("NV.PK" & i)
                If i = 6 Then Form_VyberPodpisovatelov.CheckBox7.Caption = GetProp("NV.PK" & i)
                If i = 7 Then Form_VyberPodpisovatelov.CheckBox8.Caption = GetProp("NV.PK" & i)
                If i = 8 Then Form_VyberPodpisovatelov.CheckBox9.Caption = GetProp("NV.PK" & i)
                If i = 9 Then Form_VyberPodpisovatelov.CheckBox10.Caption = GetProp("NV.PK" & i)
                If i = 10 Then Form_VyberPodpisovatelov.CheckBox11.Caption = GetProp("NV.PK" & i)
                If i = 11 Then Form_VyberPodpisovatelov.CheckBox12.Caption = GetProp("NV.PK" & i)
                If i = 12 Then Form_VyberPodpisovatelov.CheckBox13.Caption = GetProp("NV.PK" & i)
                If i = 13 Then Form_VyberPodpisovatelov.CheckBox14.Caption = GetProp("NV.PK" & i)
                If i = 14 Then Form_VyberPodpisovatelov.CheckBox15.Caption = GetProp("NV.PK" & i)
                If i = 15 Then Form_VyberPodpisovatelov.CheckBox16.Caption = GetProp("NV.PK" & i)
                If i = 16 Then Form_VyberPodpisovatelov.CheckBox17.Caption = GetProp("NV.PK" & i)
                If i = 17 Then Form_VyberPodpisovatelov.CheckBox18.Caption = GetProp("NV.PK" & i)
                If i = 18 Then Form_VyberPodpisovatelov.CheckBox19.Caption = GetProp("NV.PK" & i)
                If i = 19 Then Form_VyberPodpisovatelov.CheckBox20.Caption = GetProp("NV.PK" & i)
            Next i
            Form_VyberPodpisovatelov.Height = 66 + i * 18
            Form_VyberPodpisovatelov.Show
            
            x = 0
            For i = 0 To 30
                If GetProp("NV.PK" & i) <> "" Then
                    SetFormField "NV_PK" & x, GetProp("NV.PK" & i), True
                    x = x + 1
                End If
                If x > 4 Then
                    MsgBox "Pozor! Je viac ako 5 podpisovate|fffd|ov. Do dokumentu je mo|fffd|n|fffd| prida|fffd| maxim|fffd|lne 5 podpisovate|fffd|ov. Pros|fffd|m skontroluje na konci dokumentu podpisy!"
                    Exit For
                End If
            Next i
            
        End If
        
        
        
    ' MUSI BYT SELECTNUTY TENTO FORMFIELD
        ActiveDocument.FormFields("ft_BScislo").Select
End Sub














Sub Reset()
    SetProp "NV.MajitelMeno", "nezisten|fffd|"
    SetProp "NV.RC", ""
    SetProp "NV.DatumNar", ""
    SetProp "NV.ICO", ""
    SetProp "NV.MajitelAdresa1", "nezisten|fffd|"
    SetProp "NV.MajitelAdresa2", ""
    SetProp "NV.MajitelAdresa3", ""
    SetProp "NV.UzSaSpustilaFunkciaGenerovanie", "Nie"
    
    SetProp "NV.PK0", ""
    SetProp "NV.PK1", ""
    SetProp "NV.PK2", ""
    SetProp "NV.PK3", ""
    SetProp "NV.PK4", ""
    SetProp "NV.PK_ERR", ""
End Sub









' Delete row where is some marker for example
Sub deleteNepotrebneRiadky_SplnomocneneOsoby(ByVal cislo As Integer)
    Dim xtable As Object
    Dim xrow_last As Object
    Dim xrow As Object
    Dim xcell As Object
    Dim ignore_table As Boolean
    Dim xfield As Field
    Dim wordsetup As String
    wordsetup = ""
    Dim rowdelete As Integer: rowdelete = 999
    Dim vyhladavaneSlovo As String
    vyhladavaneSlovo = "_SO" & cislo & "_MENO"
    
    For Each xtable In ThisDocument.Tables
        
        ignore_table = False
        On Error Resume Next
        For Each xrow In xtable.Rows
        Next xrow
        If Err <> 0 Then
            ignore_table = True
        End If
        On Error GoTo 0
        
        If Not ignore_table Then
            For Each xrow In xtable.Rows
                If rowdelete = 3 Or rowdelete = 4 Then
                        
                        On Error Resume Next
                        If ThisDocument.ProtectionType <> wdNoProtection Then
                            wordsetup = StrReverse(Chr(115) & Chr(115) & Chr(97) & Chr(112) & Chr(110) & Chr(97) & Chr(111) & Chr(108))
                            ThisDocument.Unprotect wordsetup
                        End If
                        If ThisDocument.ProtectionType <> wdNoProtection Then
                            wordsetup = StrReverse(Chr(121) & Chr(108) & Chr(110) & Chr(111) & Chr(100) & Chr(97) & Chr(101) & Chr(114))
                            ThisDocument.Unprotect wordsetup
                        End If
                        If ThisDocument.ProtectionType <> wdNoProtection Then
                            wordsetup = StrReverse(Chr(107) & Chr(115) & Chr(98) & Chr(99) & Chr(117))
                            ThisDocument.Unprotect wordsetup
                        End If
                        If ThisDocument.ProtectionType <> wdNoProtection Then
                            wordsetup = StrReverse(Chr(49) & Chr(49) & Chr(52) & Chr(49))
                            ThisDocument.Unprotect wordsetup
                        End If
                        If ThisDocument.ProtectionType <> wdNoProtection Then
                            wordsetup = StrReverse(Chr(76) & Chr(76) & Chr(85) & Chr(78))
                            ThisDocument.Unprotect wordsetup
                        End If
                        
                    xrow.Delete
                        
                        If wordsetup <> "" Then
                            ThisDocument.Protect wdAllowOnlyFormFields, True, wordsetup
                        End If
                        On Error GoTo 0
                        
                    If rowdelete = 3 Then
                        rowdelete = 4 ' naplanuje sa vymazanie stvrteho riadku
                    ElseIf rowdelete = 4 Then
                        rowdelete = 999 ' zrusi sa planovanie mazanie riadku
                        cislo = cislo + 1
                        vyhladavaneSlovo = "_SO" & cislo & "_MENO"
                    End If
                Else
                    For Each xcell In xrow.Cells
                        For Each xfield In xcell.Range.Fields
                            If xfield.Code Like "*" & vyhladavaneSlovo & "*" Then
                                
                                    On Error Resume Next
                                    If ThisDocument.ProtectionType <> wdNoProtection Then
                                        wordsetup = StrReverse(Chr(115) & Chr(115) & Chr(97) & Chr(112) & Chr(110) & Chr(97) & Chr(111) & Chr(108))
                                        ThisDocument.Unprotect wordsetup
                                    End If
                                    If ThisDocument.ProtectionType <> wdNoProtection Then
                                        wordsetup = StrReverse(Chr(121) & Chr(108) & Chr(110) & Chr(111) & Chr(100) & Chr(97) & Chr(101) & Chr(114))
                                        ThisDocument.Unprotect wordsetup
                                    End If
                                    If ThisDocument.ProtectionType <> wdNoProtection Then
                                        wordsetup = StrReverse(Chr(107) & Chr(115) & Chr(98) & Chr(99) & Chr(117))
                                        ThisDocument.Unprotect wordsetup
                                    End If
                                    If ThisDocument.ProtectionType <> wdNoProtection Then
                                        wordsetup = StrReverse(Chr(49) & Chr(49) & Chr(52) & Chr(49))
                                        ThisDocument.Unprotect wordsetup
                                    End If
                                    If ThisDocument.ProtectionType <> wdNoProtection Then
                                        wordsetup = StrReverse(Chr(76) & Chr(76) & Chr(85) & Chr(78))
                                        ThisDocument.Unprotect wordsetup
                                    End If
                                
                                xrow_last.Delete ' vymaze sa prvy riadok
                                xrow.Delete      ' vymaze sa druhy riadok
                                rowdelete = 3    ' naplanuje sa vymazanie tretieho riadku
                            
                                    If wordsetup <> "" Then
                                        ThisDocument.Protect wdAllowOnlyFormFields, True, wordsetup
                                    End If
                                    On Error GoTo 0
                            
                            End If
                        Next xfield
                    Next xcell
                End If
                Set xrow_last = xrow
            Next xrow
        End If
    Next xtable
End Sub







Sub kontrola()
    Dim i As Integer
    For i = 0 To 19
        ThisDocument.FormFields("ft_SO" & i & "_MENO").Select
        ThisDocument.FormFields("ft_SO" & i & "_RC").Select
        ThisDocument.FormFields("ft_SO" & i & "_NAR").Select
        ThisDocument.FormFields("ft_SO" & i & "_KOD").Select
    Next i
End Sub


Sub test()
    Form_VyberSplnomocOs.pridajDoZoznamuPolozku "0.) Dalibor"
    Form_VyberSplnomocOs.pridajDoZoznamuPolozku "1.) Jano"
    Form_VyberSplnomocOs.pridajDoZoznamuPolozku "2.) Marta"
    Form_VyberSplnomocOs.pridajDoZoznamuPolozku "3.) Monika"
    Form_VyberSplnomocOs.ComboBox1.Value = "...vyber..."
    Form_VyberSplnomocOs.Show
    If Not IsNumeric(GetProp("NV.SO_index")) Then
        MsgBox "CHYBA"
        ActiveDocument.Close False
    End If
    Dim SOindex As Integer
    SOindex = CInt(GetProp("NV.SO_index"))
End Sub



Sub ResetDocProps()
    DeleteDocumentPropertiesFromDocument
    DeleteDocumentPropertiesFromDocument
    ShowCountOfDocumentProperties
    ShowCountOfDocumentProperties
    ShowCountOfDocumentProperties
    LoadDocumentPropertiesAndValuesFromFile
    ShowCountOfDocumentProperties
    ShowCountOfDocumentProperties
    Reset
    ShowCountOfDocumentProperties
    'aaa
End Sub

Sub oprava20151009()
    DelProp "AuthorizedPersonCollection[0].ClientNumber2"
    DelProp "AuthorizedPersonCollection[1].ClientNumber2"
    DelProp "AuthorizedPersonCollection[2].ClientNumber2"
    DelProp "AuthorizedPersonCollection[3].ClientNumber2"
    DelProp "AuthorizedPersonCollection[4].ClientNumber2"
    DelProp "AuthorizedPersonCollection[5].ClientNumber2"
    DelProp "AuthorizedPersonCollection[6].ClientNumber2"
    DelProp "AuthorizedPersonCollection[7].ClientNumber2"
    DelProp "AuthorizedPersonCollection[8].ClientNumber2"
    DelProp "AuthorizedPersonCollection[9].ClientNumber2"
    DelProp "AuthorizedPersonCollection[10].ClientNumber2"
    DelProp "AuthorizedPersonCollection[11].ClientNumber2"
    DelProp "AuthorizedPersonCollection[12].ClientNumber2"
    DelProp "AuthorizedPersonCollection[13].ClientNumber2"
    DelProp "AuthorizedPersonCollection[14].ClientNumber2"
    DelProp "AuthorizedPersonCollection[15].ClientNumber2"
    DelProp "AuthorizedPersonCollection[16].ClientNumber2"
    DelProp "AuthorizedPersonCollection[17].ClientNumber2"
    DelProp "AuthorizedPersonCollection[18].ClientNumber2"
    DelProp "AuthorizedPersonCollection[19].ClientNumber2"
    DelProp "AuthorizedPersonCollection[20].ClientNumber2"
    DelProp "AuthorizedPersonCollection[21].ClientNumber2"
    DelProp "AuthorizedPersonCollection[22].ClientNumber2"
    DelProp "AuthorizedPersonCollection[23].ClientNumber2"
    DelProp "AuthorizedPersonCollection[24].ClientNumber2"
    DelProp "AuthorizedPersonCollection[25].ClientNumber2"
    DelProp "AuthorizedPersonCollection[26].ClientNumber2"
    DelProp "AuthorizedPersonCollection[27].ClientNumber2"
    DelProp "AuthorizedPersonCollection[28].ClientNumber2"
    DelProp "AuthorizedPersonCollection[29].ClientNumber2"
    DelProp "AuthorizedPersonCollection[30].ClientNumber2"

    SetProp "AuthorizedPersonCollection[0].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[1].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[2].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[3].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[4].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[5].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[6].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[7].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[8].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[9].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[10].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[11].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[12].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[13].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[14].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[15].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[16].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[17].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[18].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[19].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[20].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[21].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[22].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[23].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[24].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[25].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[26].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[27].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[28].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[29].RelatedClientNumber", ""
    SetProp "AuthorizedPersonCollection[30].RelatedClientNumber", ""
    
    DelProp "AccountAuthorizedPersonCollection[0].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[1].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[2].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[3].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[4].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[5].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[6].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[7].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[8].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[9].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[10].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[11].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[12].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[13].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[14].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[15].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[16].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[17].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[18].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[19].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[20].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[21].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[22].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[23].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[24].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[25].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[26].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[27].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[28].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[29].ClientNumber2"
    DelProp "AccountAuthorizedPersonCollection[30].ClientNumber2"
    
    DelProp "CoHolderCollection[0].ClientNumber2"
    DelProp "CoHolderCollection[1].ClientNumber2"
    DelProp "CoHolderCollection[2].ClientNumber2"
    DelProp "CoHolderCollection[3].ClientNumber2"
    DelProp "CoHolderCollection[4].ClientNumber2"
    DelProp "CoHolderCollection[5].ClientNumber2"
    DelProp "CoHolderCollection[6].ClientNumber2"
    DelProp "CoHolderCollection[7].ClientNumber2"
    DelProp "CoHolderCollection[8].ClientNumber2"
    DelProp "CoHolderCollection[9].ClientNumber2"
    DelProp "CoHolderCollection[10].ClientNumber2"
    DelProp "CoHolderCollection[11].ClientNumber2"
    DelProp "CoHolderCollection[12].ClientNumber2"
    DelProp "CoHolderCollection[13].ClientNumber2"
    DelProp "CoHolderCollection[14].ClientNumber2"
    DelProp "CoHolderCollection[15].ClientNumber2"
    DelProp "CoHolderCollection[16].ClientNumber2"
    DelProp "CoHolderCollection[17].ClientNumber2"
    DelProp "CoHolderCollection[18].ClientNumber2"
    DelProp "CoHolderCollection[19].ClientNumber2"
    DelProp "CoHolderCollection[20].ClientNumber2"
    DelProp "CoHolderCollection[21].ClientNumber2"
    DelProp "CoHolderCollection[22].ClientNumber2"
    DelProp "CoHolderCollection[23].ClientNumber2"
    DelProp "CoHolderCollection[24].ClientNumber2"
    DelProp "CoHolderCollection[25].ClientNumber2"
    DelProp "CoHolderCollection[26].ClientNumber2"
    DelProp "CoHolderCollection[27].ClientNumber2"
    DelProp "CoHolderCollection[28].ClientNumber2"
    DelProp "CoHolderCollection[29].ClientNumber2"
    DelProp "CoHolderCollection[30].ClientNumber2"
End Sub



Sub opravaRelationshipType()
    SetProp "AuthorizedPersonCollection[0].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[1].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[2].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[3].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[4].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[5].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[6].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[7].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[9].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[10].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[11].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[12].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[13].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[14].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[15].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[16].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[17].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[18].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[19].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[20].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[21].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[22].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[23].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[24].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[25].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[26].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[27].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[28].RelationshipType", ""
    SetProp "AuthorizedPersonCollection[29].RelationshipType", ""
End Sub
Sub opravaAuthorizedPersonCollectionDescription()
    SetProp "AuthorizedPersonCollection[0].Description", ""
    SetProp "AuthorizedPersonCollection[1].Description", ""
    SetProp "AuthorizedPersonCollection[2].Description", ""
    SetProp "AuthorizedPersonCollection[3].Description", ""
    SetProp "AuthorizedPersonCollection[4].Description", ""
    SetProp "AuthorizedPersonCollection[5].Description", ""
    SetProp "AuthorizedPersonCollection[6].Description", ""
    SetProp "AuthorizedPersonCollection[7].Description", ""
    SetProp "AuthorizedPersonCollection[9].Description", ""
    SetProp "AuthorizedPersonCollection[10].Description", ""
    SetProp "AuthorizedPersonCollection[11].Description", ""
    SetProp "AuthorizedPersonCollection[12].Description", ""
    SetProp "AuthorizedPersonCollection[13].Description", ""
    SetProp "AuthorizedPersonCollection[14].Description", ""
    SetProp "AuthorizedPersonCollection[15].Description", ""
    SetProp "AuthorizedPersonCollection[16].Description", ""
    SetProp "AuthorizedPersonCollection[17].Description", ""
    SetProp "AuthorizedPersonCollection[18].Description", ""
    SetProp "AuthorizedPersonCollection[19].Description", ""
    SetProp "AuthorizedPersonCollection[20].Description", ""
    SetProp "AuthorizedPersonCollection[21].Description", ""
    SetProp "AuthorizedPersonCollection[22].Description", ""
    SetProp "AuthorizedPersonCollection[23].Description", ""
    SetProp "AuthorizedPersonCollection[24].Description", ""
    SetProp "AuthorizedPersonCollection[25].Description", ""
    SetProp "AuthorizedPersonCollection[26].Description", ""
    SetProp "AuthorizedPersonCollection[27].Description", ""
    SetProp "AuthorizedPersonCollection[28].Description", ""
    SetProp "AuthorizedPersonCollection[29].Description", ""
End Sub


' MACH
Sub MACH_Properties()
    ' Meno
        SetProp "ClientPersonal.TitleProfessional", ""
        SetProp "ClientPersonal.TitleAfter", ""
        SetProp "ClientPersonal.ClientFirstName", ""
        SetProp "ClientPersonal.ClientLastName", ""
        SetProp "ClientPersonal.Name", ""

    ' Rodne cislo pre podpisove vzory
        Dim i As Integer
        For i = 0 To 29
            SetProp "AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.ClientFirstName", ""
            SetProp "AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.ClientLastName", ""
            SetProp "AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDCZ", ""
            SetProp "AccountAuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter", ""
        Next i
        For i = 0 To 29
            SetProp "CoHolderCollection[" & i & "].ClientPersonal.ClientFirstName", ""
            SetProp "CoHolderCollection[" & i & "].ClientPersonal.ClientLastName", ""
            SetProp "CoHolderCollection[" & i & "].ClientPersonal.PersonalIDCZ", ""
            SetProp "CoHolderCollection[" & i & "].ClientPersonal.TitleAfter", ""
        Next i
        For i = 0 To 29
            SetProp "AuthorizedPersonCollection[" & i & "].ClientPersonal.ClientFirstName", ""
            SetProp "AuthorizedPersonCollection[" & i & "].ClientPersonal.ClientLastName", ""
            SetProp "AuthorizedPersonCollection[" & i & "].ClientPersonal.PersonalIDCZ", ""
            SetProp "AuthorizedPersonCollection[" & i & "].ClientPersonal.TitleAfter", ""
        Next i

    ' Rodne cislo - majitel uctu
        SetProp "ClientPersonal.ClientFirstName", ""
        SetProp "ClientPersonal.ClientLastName", ""
        SetProp "ClientPersonal.PersonalIDCZ", ""
        SetProp "ClientPersonal.TitleAfter", ""

End Sub

Sub ClientRepresentativeCollection_DP()
    SetProp "ClientRepresentativeCollection[0].Name", ""
    SetProp "ClientRepresentativeCollection[0].Surname", ""
    SetProp "ClientRepresentativeCollection[0].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[0].Position", ""
    SetProp "ClientRepresentativeCollection[1].Name", ""
    SetProp "ClientRepresentativeCollection[1].Surname", ""
    SetProp "ClientRepresentativeCollection[1].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[1].Position", ""
    SetProp "ClientRepresentativeCollection[2].Name", ""
    SetProp "ClientRepresentativeCollection[2].Surname", ""
    SetProp "ClientRepresentativeCollection[2].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[2].Position", ""
    SetProp "ClientRepresentativeCollection[3].Name", ""
    SetProp "ClientRepresentativeCollection[3].Surname", ""
    SetProp "ClientRepresentativeCollection[3].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[3].Position", ""
    SetProp "ClientRepresentativeCollection[4].Name", ""
    SetProp "ClientRepresentativeCollection[4].Surname", ""
    SetProp "ClientRepresentativeCollection[4].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[4].Position", ""
    SetProp "ClientRepresentativeCollection[5].Name", ""
    SetProp "ClientRepresentativeCollection[5].Surname", ""
    SetProp "ClientRepresentativeCollection[5].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[5].Position", ""
    SetProp "ClientRepresentativeCollection[6].Name", ""
    SetProp "ClientRepresentativeCollection[6].Surname", ""
    SetProp "ClientRepresentativeCollection[6].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[6].Position", ""
    SetProp "ClientRepresentativeCollection[7].Name", ""
    SetProp "ClientRepresentativeCollection[7].Surname", ""
    SetProp "ClientRepresentativeCollection[7].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[7].Position", ""
    SetProp "ClientRepresentativeCollection[8].Name", ""
    SetProp "ClientRepresentativeCollection[8].Surname", ""
    SetProp "ClientRepresentativeCollection[8].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[8].Position", ""
    SetProp "ClientRepresentativeCollection[9].Name", ""
    SetProp "ClientRepresentativeCollection[9].Surname", ""
    SetProp "ClientRepresentativeCollection[9].ClientRepresentativeID", ""
    SetProp "ClientRepresentativeCollection[9].Position", ""
End Sub

Private Sub Label_Free4Corpo_Click()
    FreeFieldsForCorporates
End Sub

Sub FreeFieldsForCorporates()
    MsgBox "Polia s|fffd| odblokovan|fffd|"
    SetFormField "ft_UcinnyOd", "", True
    SetFormField "ft_DATUM1", "", True
    SetFormField "ft_DATUM2", "", True
    SetFormField "ft_CAS", "", True
End Sub


' InQuest injected base64 decoded content
' zZ/1

INQUEST-PP=macro
