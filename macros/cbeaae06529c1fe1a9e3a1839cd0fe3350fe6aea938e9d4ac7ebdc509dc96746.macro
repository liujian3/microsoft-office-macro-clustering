Attribute VB_Name = "DisplayDate"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private WithEvents pDateLabel As MSForms.Label
Attribute pDateLabel.VB_VarHelpID = -1
Private pCalendarForm As UserForm

Public Sub BindWithControl(DateLabel As MSForms.Label, CalendarForm As UserForm)
    Set pDateLabel = DateLabel          '|fffd|J|fffd||fffd||fffd||fffd||fffd|_|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||313||fffd||fffd|t|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
    Set pCalendarForm = CalendarForm        '|fffd|J|fffd||fffd||fffd||fffd||fffd|_|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
End Sub

Private Sub pDateLabel_Click()
    '|fffd|J|fffd||fffd||fffd||fffd||fffd|_|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||313||fffd||fffd|t|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||242||fffd||fffd||303|C|fffd|x|fffd||fffd||fffd|g|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||fffd||fffd|B
    'pDateLabel|fffd||fffd|Tag|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||242||341|A|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
    frmCalendar.ParentForm.Controls(frmCalendar.EntryControl).Text = pDateLabel.Tag
    Unload pCalendarForm                '|fffd|J|fffd||fffd||fffd||fffd||fffd|_|fffd|[|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|End Sub
End Sub
Attribute VB_Name = "FunctionList"
Option Explicit

Public Function GetGoukeiKingaku(ByVal ColumnNo As Integer, ByVal LB As MSForms.ListBox) As Long
    '|fffd||fffd|2|fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||242||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||317||fffd||30d||fffd||fffd|v|fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd||590||fffd|
    Dim c As Integer
    c = LB.ListCount - 1
    If c = -1 Then
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||341|A|fffd||7c2||fffd|l0
        GetGoukeiKingaku = 0
        Exit Function
    End If
    Dim ans As Long
    ans = 0
    Dim i As Integer
    For i = 0 To c
        ans = ans + LB.List(i, ColumnNo)
    Next
    GetGoukeiKingaku = ans
End Function

Public Function GetCompanyInfo() As String
    '|fffd||fffd||40f||fffd||fffd||15d8e||fffd||fffd||fffd||182||fffd||fffd||10e||64fe|
    With Worksheets("|fffd||752||fffd|")
        '|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||512|n|fffd||fffd||3d0||fffd||fffd||251||fffd||fffd|
        Dim InfoRange As Range
        Set InfoRange = .Range("D1:D4")
        Dim s As String
        s = ""
        Dim r As Range
        For Each r In InfoRange
            s = s & r.Value & vbNewLine
        Next
    End With
    GetCompanyInfo = s
End Function

Public Function FormatAddSpace(ByVal strName As String, _
                                                    ByVal intMojiCount As Integer, _
                                                    Optional ByVal isTop As Boolean = True) As String
    '|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||356||fffd||fffd||fffd||fffd||243|X|fffd|y|fffd|[|fffd|X|fffd||fffd|}|fffd||fffd||fffd||fffd||fffd||fffd||590||fffd|
    '|fffd||fffd||fffd||fffd|strName|fffd|F|fffd||38f||6c2||182||202||9576||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd||fffd|intMojiCount|fffd|F|fffd|X|fffd|y|fffd|[|fffd|X|fffd|}|fffd||fffd||fffd||fffd||311|S|fffd||302||315||fffd||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd||fffd|isTop|fffd|F|fffd|s|fffd||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||fffd||fffd||fffd|(True)|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||fffd||fffd||fffd|(False)|fffd||fffd||fffd|i|fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|j
    Dim n As Integer
    n = intMojiCount - Len(strName)
    If isTop Then
        strName = Space(n) & strName
    Else
        strName = strName & Space(n) & "A"  '|fffd||fffd||fffd||fffd||fffd||254|C|fffd||4c2||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||1c9||fffd|
    End If
    FormatAddSpace = strName
End Function

Public Function TrimSpecial(goodsName As String) As String
    '|fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3d0||fffd|n|fffd||251||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim n As Integer
    n = Len(goodsName)
    '|fffd||fffd||fffd||fffd||fffd||312|l|fffd||fffd||fffd||7596||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3d0||fffd|ans|fffd||251||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim ans As String
    ans = Left(goodsName, n - 1)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|y|fffd|[|fffd|X|fffd||242||202||fffd||fffd||fffd||fffd||302||fffd|Trim|fffd||590||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||103|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
    TrimSpecial = Trim(ans)
End Function

Public Function checkNum(ByVal KeyAscii As Integer) As Integer
    '0|fffd|`9|fffd||341|AKeyAscii|fffd||fffd|48|fffd|`57|fffd||182||202||fffd|
    If (KeyAscii >= 48) And (KeyAscii <= 57) Then
        checkNum = KeyAscii
    Else
        checkNum = 0
    End If
End Function

Public Function IsEntryData(ByRef TargetForm As UserForm) As Boolean
    Dim ctrl As Control
    For Each ctrl In TargetForm.Controls
        If ctrl.Tag <> "" Then
            If ctrl.Text = "" Then
                MsgBox ctrl.Tag & " |fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbExclamation, "|fffd|m|fffd|F"
                ctrl.SetFocus
                IsEntryData = False
                Exit Function
            End If
        End If
    Next
    IsEntryData = True
End Function





































Attribute VB_Name = "Module1"
Option Explicit

Public Sub ShowForm()
    frmMenu.Show
End Sub

Public Sub ClearMeisaiRecord(TargetForm As MSForms.UserForm)
    '|fffd||fffd||fffd||5cd|s|fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||312|l|fffd||fffd||fffd|N|fffd||fffd||fffd|A
    With TargetForm
        .cboGoodsID.Text = ""
        .txtGoodsName.Text = ""
        .txtGoodsPrice.Text = ""
        .txtGoodsUnit.Text = ""
        .txtQuantity.Text = ""
        .txtAmount.Text = ""
        .txtTax.Text = ""
        .txtSumWithTax.Text = ""
    End With
End Sub

Public Sub MyCalc(TargetForm As MSForms.UserForm)
    '|fffd||fffd||fffd|z|fffd|E|fffd||fffd||fffd||fffd||141|E|fffd||14d||fffd||fffd||fffd||fffd|z|fffd||30c|v|fffd|Z
    Const taxRate As Integer = 8
    With TargetForm
        '|fffd|P|fffd||fffd||fffd|E|fffd||fffd||fffd||283|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||d74c2||30f||a347||fffd||341|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|g|fffd||fffd||fffd|b|fffd|v|fffd||fffd||fffd||fffd|
        On Error GoTo eh
        Dim Kingaku As Long
        Kingaku = .txtGoodsPrice.Text * .txtQuantity.Text
        '|fffd|G|fffd||fffd||fffd|[|fffd||303|g|fffd||fffd||fffd|b|fffd|v|fffd|I|fffd||fffd|
        On Error GoTo 0
        '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||252|l|fffd||fffd||fffd||fffd|
        .txtAmount.Text = Format(Kingaku, "#,##0")
        .txtTax.Text = Format(Kingaku * taxRate / 100, "#,##0")
        .txtSumWithTax.Text = Format(Kingaku * (1 + taxRate / 100), "#,##0")
        Exit Sub
eh:
        .txtAmount.Text = ""
        .txtTax.Text = ""
        .txtSumWithTax.Text = ""
    End With
End Sub

Public Sub AdvancedFilter(DataRange As Range, _
                                            Criteria As Range, _
                                            CopyTo As Range, _
                                            blnUnique As Boolean)
    '|fffd||fffd||fffd||fffd| DataRange|fffd|F|fffd||fffd||fffd|o|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||348||342||30a||e3c0||fffd|Z|fffd||fffd|
    '|fffd||fffd||fffd||fffd| Criteria|fffd|F|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||303|Z|fffd||fffd||fffd||348||fffd|
    '|fffd||fffd||fffd||fffd| CopyTo|fffd|F|fffd||fffd||fffd|o|fffd||fffd||303|Z|fffd||fffd||fffd||348||fffd|
    '|fffd||fffd||fffd||fffd| blnUnique|fffd|F|fffd|d|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||16cce||fffd||fffd||fffd||fffd||90a9|
    DataRange.CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _
                        CriteriaRange:=Criteria, CopyToRange:=CopyTo, Unique:=blnUnique
End Sub









Attribute VB_Name = "Module2"
Option Explicit

Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'
    Range("C2").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|").Range("A1:E8").AdvancedFilter Action:=xlFilterCopy, _
        CriteriaRange:=Range("A1:O2"), CopyToRange:=Range("A10:D10"), Unique:= _
        False
    Range("K20").Select
End Sub
Sub Macro2()
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5d7|p|fffd||255||fffd||fffd||5d1||582||fffd|
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Activate
    With ActiveSheet.Sort
        .SortFields.Clear
        .SortFields.Add Key:=Range("M10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SortFields.Add Key:=Range("L10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SortFields.Add Key:=Range("K10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SetRange Range("K10").CurrentRegion
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub





Sub Macro22()
Attribute Macro22.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
'
    Range("K10").Select
    ActiveWorkbook.Worksheets("|fffd||fffd||fffd||348a||fffd|o").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("|fffd||fffd||fffd||348a||fffd|o").Sort.SortFields.Add2 Key:=Range("M11:M16") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("|fffd||fffd||fffd||348a||fffd|o").Sort.SortFields.Add2 Key:=Range("L11:L16") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("|fffd||fffd||fffd||348a||fffd|o").Sort.SortFields.Add2 Key:=Range("K11:K16") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("|fffd||fffd||fffd||348a||fffd|o").Sort
        .SetRange Range("K10:Y16")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub




Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
    '------------------------------------
    '|fffd|J|fffd||fffd||fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||90b1||fffd||fffd|
'    Application.Visible = False
    '------------------------------------
'    ShowForm
End Sub
Attribute VB_Name = "frmBill"
Attribute VB_Base = "0{B827A44F-9AC1-44A1-BDD8-8E2B9BC6AE0E}{522710D0-28D1-4DAA-86E5-53CF049C7796}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnPrint_Click()
    '|fffd||fffd||fffd||fffd|p|fffd||303|V|fffd|[|fffd|g|fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd|
    Dim myMsg As String, Title As String
    myMsg = "|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd||fffd||fffd||fffd||30a|m|fffd|F"
    Dim res As Integer
    res = MsgBox(myMsg, vbYesNo + vbInformation, Title)
    '|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd|u|fffd||342||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||383|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If res <> vbYes Then Exit Sub
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||311||38f||6ca||fffd||fffd||502||fffd||3d0||fffd||fffd||251||fffd||fffd|
    Dim Nen As Integer, Tsuki As Integer
    Nen = frmBillOption.cmbYear.Value
    Tsuki = frmBillOption.cmbMonth.Value
    '|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||243|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|
    With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        .Range("B9").Value = lblCustomerName.Caption
        Dim TargetRow As Integer
        TargetRow = CInt(txtCustomerID.Text) + 1
        .Range("B5").Value = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(TargetRow, 4).Value '|fffd|X|fffd||594||50d||fffd|
        .Range("B6").Value = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(TargetRow, 5).Value '|fffd|Z|fffd||fffd|
        .Range("B7").Value = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(TargetRow, 6).Value 'TEL
        .Range("J3").Value = Format(txtDate.Text, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|")
        .Range("C16").Value = Nen & "|fffd|N" & Tsuki & "|fffd||fffd|"
        .Range("C18").Value = Format(DateSerial(Nen, Tsuki + 2, 1) - 1, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|")
        '|fffd||fffd||fffd||5c3|f|fffd|[|fffd|^|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Dim ws As Worksheet
        Set ws = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o")
        Dim LastRow As Integer
        LastRow = ws.Range("K" & Rows.Count).End(xlUp).Row
        Dim TenkisakiRow As Integer
        TenkisakiRow = 24
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||751|O|fffd||256||fffd||fffd||5c3|f|fffd|[|fffd|^|fffd||303|N|fffd||fffd||fffd|A
        .Range("B24:K47").ClearContents
        '|fffd||fffd||fffd||5c3|f|fffd|[|fffd|^|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Dim i As Integer
        For i = 11 To LastRow
            .Cells(TenkisakiRow, 2).Value = ws.Cells(i, 12).Value
            .Cells(TenkisakiRow, 3).Value = ws.Cells(i, 13).Value
            .Cells(TenkisakiRow, 4).Value = ws.Cells(i, 16).Value
            .Cells(TenkisakiRow, 5).Value = ws.Cells(i, 17).Value
            .Cells(TenkisakiRow, 6).Value = ws.Cells(i, 18).Value
            .Cells(TenkisakiRow, 7).Value = ws.Cells(i, 19).Value
            .Cells(TenkisakiRow, 8).Value = ws.Cells(i, 20).Value
            .Cells(TenkisakiRow, 9).Value = ws.Cells(i, 21).Value
            .Cells(TenkisakiRow, 10).Value = ws.Cells(i, 22).Value
            .Cells(TenkisakiRow, 11).Value = ws.Cells(i, 23).Value
            TenkisakiRow = TenkisakiRow + 1
        Next
        '|fffd|Y|fffd||fffd||fffd||fffd||fffd||5d4||50d||fffd||fffd||30d|s|fffd||254||fffd||fffd|s|fffd||3c2||742||303|}|fffd|[|fffd|L|fffd||fffd||fffd|O
        Dim r As Integer
        For i = 11 To LastRow
            r = ws.Cells(i, 11).Value   '|fffd||fffd||fffd||5d4||50d||fffd||fffd||fffd||fffd||64fe|
            Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Cells(r + 1, 14).Value = txtDate.Text
        Next
        '|fffd||fffd||fffd||fffd|i|fffd|J|fffd||fffd||fffd||fffd||fffd||242||341|A|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd|j
'        .PrintOut
    End With
End Sub

Private Sub UserForm_Initialize()
    lblCompany.Caption = GetCompanyInfo()   '|fffd||fffd||fffd||fffd||590||fffd||fffd||149||fffd||40f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||103||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
    With lstMeisai      '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
        .ColumnCount = 10
        .ColumnWidths = "30,70,30,110,60,50,30,70,50,60"
    End With
    txtDate.Text = Format(Now, "yyyy/m/d")      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||250||752||fffd|
    With frmBillOption      '|fffd|e|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||312|l|fffd||fffd||fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||250||752||fffd|
        txtCustomerID.Text = .lstCustomer.Value
        lblCustomerName.Caption = .lstCustomer.List(.lstCustomer.ListIndex, 1) & "|fffd|@|fffd||4486|"
        lblSpan.Caption = _
                Format(.StartDay, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|") & "|fffd|`" & Format(.EndDay, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|")
    End With
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Select
    Dim i As Integer, LastRow As Integer
    LastRow = Range("K" & Rows.Count).End(xlUp).Row
    With lstMeisai      '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||256||fffd||fffd||5c3|f|fffd|[|fffd|^|fffd||fffd|\|fffd||fffd|
        For i = 11 To LastRow
            .AddItem Cells(i, 12).Value
            .List(.ListCount - 1, 1) = Cells(i, 13).Value
            .List(.ListCount - 1, 2) = Cells(i, 16).Value
            .List(.ListCount - 1, 3) = FormatAddSpace(Cells(i, 17).Value, 30, False)
            .List(.ListCount - 1, 4) = Format(Cells(i, 18).Value, "#,##0")
            .List(.ListCount - 1, 5) = Cells(i, 19).Value
            .List(.ListCount - 1, 6) = Cells(i, 20).Value
            .List(.ListCount - 1, 7) = Format(Cells(i, 21).Value, "#,##0")
            .List(.ListCount - 1, 8) = Format(Cells(i, 22).Value, "#,##0")
            .List(.ListCount - 1, 9) = Format(Cells(i, 23).Value, "#,##0")
        Next
    End With
    '|fffd||fffd||fffd|v|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
    lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(9, lstMeisai), "#,##0 |fffd|~")
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    frmBillOption.SettingCustomerList
End Sub































Attribute VB_Name = "frmBillOption"
Attribute VB_Base = "0{801DA0B3-2E11-4243-98DE-07D6E0234CF1}{308103AF-8938-46EE-938D-2D1E8FB0BBE6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Public StartDay As Date
Public EndDay As Date

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnMakeBill_Click()
    If lstCustomer.ListIndex = -1 Then
        MsgBox "|fffd||68b|q|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd|m|fffd|F"
        Exit Sub
    End If
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Select
    '|fffd||fffd||fffd||502||18c||68b|qID|fffd||143|f|fffd|[|fffd|^|fffd||312||fffd||fffd|o
    Range("A2:O2").ClearContents
    Range("N2").Value = "<>1"
    Range("B2").Value = ">=" & StartDay
    Range("O2").Value = "<=" & EndDay
    Range("C2").Value = lstCustomer.Value
    Dim DataRange As Range, Criteria As Range, CopyTo As Range
    Dim blnUnique As Boolean
    Set DataRange = Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Range("A1")
    Set Criteria = Range("A1:O2")
    Set CopyTo = Range("K10:Y10")
    blnUnique = False
    'AdvancedFilter|fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||112||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|s
    AdvancedFilter DataRange, Criteria, CopyTo, blnUnique
    Sort_Date_ID        '|fffd||fffd||fffd||5d1||582||fffd||fffd||fffd|
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
    frmBill.Show
End Sub

Private Sub cmbMonth_Change()
    '|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    SettingCustomerList
End Sub

Private Sub cmbYear_Change()
    '|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    SettingCustomerList
End Sub

Private Sub lstCustomer_Change()
    '|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||242||fffd||fffd||fffd|
    btnMakeBill.Enabled = True
End Sub

Private Sub UserForm_Initialize()
    Dim i As Integer
    With cmbYear    '|fffd|N|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
        Dim FromYear As Integer, ToYear As Integer
        FromYear = Year(Date) - 2
        ToYear = Year(Date)
        For i = FromYear To ToYear
            cmbYear.AddItem i
        Next
        .Value = Year(Date)
    End With
    For i = 1 To 12     '|fffd||fffd||fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
        cmbMonth.AddItem i
    Next
    With lstCustomer    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
        .ColumnCount = 3
        .ColumnWidths = "50;200;200"
    End With
    lblMsg.ForeColor = vbBlue
    lblMsg.Visible = False
    btnMakeBill.Enabled = False
    '|fffd||fffd||40f||fffd||42a93|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||383|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
    Do Until CheckCompanyInfo()
        MsgBox "|fffd||fffd||40f||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd||314||fffd||fffd|s|fffd||255|K|fffd|v|fffd||182||202||fffd||702||fffd||fffd|B", _
                        vbExclamation, "|fffd||fffd||40f||fffd||fffd|"
        frmComInfo.Show
    Loop
    '|fffd||fffd||fffd||fffd||590||fffd||fffd||149||fffd||40f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
    lblCompany.Caption = GetCompanyInfo()
End Sub

Private Function CheckCompanyInfo() As Boolean
    '|fffd||fffd||40f||fffd||fffd|4|fffd||fffd||fffd||691|S|fffd||113|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||381|ATrue
    Dim i As Integer
    For i = 1 To 4
        If Worksheets("|fffd||752||fffd|").Cells(i, 3).Value = "" Then
            CheckCompanyInfo = False
            Exit Function
        End If
    Next
    CheckCompanyInfo = True
End Function

Public Sub SettingCustomerList()
    '|fffd|N|fffd||18c||fffd||fffd||303|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||249||fffd||fffd||fffd||fffd||101|A|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||68b|q|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|\|fffd||fffd|
    If cmbYear.Value = "" Then Exit Sub
    If cmbMonth.Value = "" Then Exit Sub
    If Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Range("A1").CurrentRegion.Rows.Count = 1 Then Exit Sub
    
    '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||fffd||fffd||730e||fffd||fffd||fffd||18c||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
    StartDay = DateSerial(cmbYear.Value, cmbMonth.Value, 1)
    EndDay = DateSerial(cmbYear.Value, cmbMonth.Value + 1, 1) - 1
    '|fffd||fffd||fffd||313||fffd||fffd|t|fffd||1228f|o|fffd||fffd||fffd||fffd||fffd||24e|w|fffd||80b5||fffd||103|t|fffd|B|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Select
    Range("A2:O2").ClearContents
    Range("N2").Value = "<>1"
    Range("B2").Value = ">=" & StartDay
    Range("O2").Value = "<=" & EndDay
    Dim DataRange As Range, Criteria As Range, CopyTo As Range
    Dim blnUnique As Boolean
    Set DataRange = Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Range("A1")
    Set Criteria = Range("A1:O2")
    Set CopyTo = Range("B10:D10")
    blnUnique = True
    AdvancedFilter DataRange, Criteria, CopyTo, blnUnique
    Sort_CustomerID         '|fffd||68b|qID|fffd||143|\|fffd|[|fffd|g
    
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||282||fffd||fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||250||752||fffd|
    lstCustomer.Clear
    Dim LastRow As Integer
    LastRow = Range("B65536").End(xlUp).Row
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||282||fffd||fffd||202||fffd||fffd||a347||fffd||341|A|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If LastRow = 10 Then Exit Sub
    
    Dim i As Integer
    With lstCustomer
        For i = 11 To LastRow
            .AddItem Cells(i, 2).Value
            .List(.ListCount - 1, 1) = Cells(i, 3).Value
            '|fffd||fffd||fffd|s|fffd||3c2||742||311||38d||fffd|
            If Cells(i, 4).Value > 0 Then
                .List(.ListCount - 1, 2) = Cells(i, 4).Value & " |fffd||fffd||fffd|s"
            End If
        Next
    End With
    lblMsg.Visible = True
End Sub

Private Sub Sort_CustomerID()
    '|fffd|N|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||282||fffd||fffd||68b|qID|fffd||143|\|fffd|[|fffd|g
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Activate
    With ActiveSheet.Sort
        .SortFields.Clear
        .SortFields.Add Key:=Range("B10"), _
            SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SetRange Range("B10").CurrentRegion
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

Private Sub Sort_Date_ID()
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5d7|p|fffd||255||fffd||fffd||5d1||582||fffd|
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o").Activate
    With ActiveSheet.Sort
        .SortFields.Clear
        .SortFields.Add Key:=Range("M10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SortFields.Add Key:=Range("L10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SortFields.Add Key:=Range("K10") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
        .SetRange Range("K10").CurrentRegion
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub















Attribute VB_Name = "frmCalendar"
Attribute VB_Base = "0{6E5E4C82-B75E-4897-9A20-DE3D6EF5DB69}{455B8040-0328-476D-97BC-8CDAC14A3788}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private DisplayDates() As New DisplayDate
Public EntryControl As String
Public ParentForm As UserForm

Private Sub cmbMonth_Change()
    If CheckParam() Then
        makeCalendar cmbYear.Value, cmbMonth.Value
    End If
End Sub

Private Sub cmbYear_Change()
    If CheckParam() Then
        makeCalendar cmbYear.Value, cmbMonth.Value
    End If
End Sub

Private Function CheckParam() As Boolean
    '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||fffd||fffd|w|fffd||80b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||381|AFalse
    If cmbYear.Value = "" Then
        CheckParam = False
        Exit Function
    End If
     If cmbMonth.Value = "" Then
        CheckParam = False
        Exit Function
    End If
   CheckParam = True
End Function

Private Sub SpinButton1_SpinDown()
    If cmbMonth.Value = 1 Then
        cmbMonth.Value = 12
        cmbYear.Value = cmbYear.Value - 1
    Else
        cmbMonth.Value = cmbMonth.Value - 1
    End If
End Sub

Private Sub SpinButton1_SpinUp()
    If cmbMonth.Value = 12 Then
        cmbMonth.Value = 1
        cmbYear.Value = cmbYear.Value + 1
    Else
        cmbMonth.Value = cmbMonth.Value + 1
    End If
End Sub

Private Sub UserForm_Initialize()
    Dim lbl As MSForms.Label
    Dim i As Integer, j As Integer, c As Integer
    Dim Weekdays() As Variant   '|fffd|f|fffd|[|fffd|^|fffd|^|fffd||252||fffd||fffd||fffd|
    Weekdays() = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd|y")
    For i = 1 To 7
        Set lbl = Me.Controls.Add("Forms.Label.1", , True)
        With lbl
            .Caption = Weekdays(i - 1)
            .Width = 15
            .Height = 15
            .Left = 5 + (.Width + 2) * (i - 1)
            .Top = 20
            .BorderColor = &H666666
            .BorderStyle = fmBorderStyleSingle
            .Font.Size = 11
        End With
    Next
    c = 1
    For i = 1 To 6      '|fffd|c|fffd||fffd||fffd||fffd|
        For j = 1 To 7      '|fffd||fffd||fffd||fffd||fffd||fffd|
            Set lbl = Me.Controls.Add("Forms.Label.1", , True)
            With lbl
                .Width = 15
                .Height = 15
                .Left = 5 + (j - 1) * (.Width + 2)
                .Top = 20 + i * (.Height + 2)
                .BorderColor = &H666666
                .BorderStyle = fmBorderStyleSingle
                .Font.Size = 11
                .TextAlign = fmTextAlignRight
                .Name = "D" & c
                ReDim Preserve DisplayDates(c)
                DisplayDates(c).BindWithControl lbl, Me   '|fffd|N|fffd||fffd||fffd|X|fffd||183||fffd||fffd|x|fffd||fffd||fffd||fffd|R|fffd||c2||fffd||fffd||fffd|
                c = c + 1
            End With
        Next
    Next
    For i = Year(Date) - 3 To Year(Date) + 3
        cmbYear.AddItem i
    Next
    For i = 1 To 12
        cmbMonth.AddItem i
    Next
    '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||181|AChange|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    cmbYear.Value = Year(Date)
    cmbMonth.Value = Month(Date)
    'Public|fffd||3d0||fffd||fffd||24c||102||44f|o|fffd||fffd||fffd||fffd||fffd||303|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd|[
    Set ParentForm = frmSalesSearch
End Sub

Private Sub makeCalendar(y As Integer, m As Integer)
    Dim i As Integer, c As Integer
    Dim WeekDay_of_firstday As Integer
    Dim lastDay As Integer
    Dim myDate As Date
    '|fffd||fffd||fffd|x|fffd||fffd||fffd||315|\|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
    For i = 1 To 42
        Controls("D" & i).Caption = ""
    Next
    c = 1
    WeekDay_of_firstday = getWeekday1st(y, m)   '|fffd||fffd||fffd||fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
    lastDay = Day(DateSerial(y, m + 1, 1) - 1) - 1
    For i = WeekDay_of_firstday To WeekDay_of_firstday + lastDay
        Controls("D" & i).Caption = c
        Controls("D" & i).Tag = CStr(DateSerial(y, m, c))
        Controls("D" & i).ForeColor = vbBlack
        c = c + 1
    Next
    '|fffd|O|fffd||fffd||fffd||313||fffd||fffd|t|fffd||310||752||fffd|
    myDate = DateSerial(y, m, 1) - 1
    c = Day(myDate)
    For i = WeekDay_of_firstday - 1 To 1 Step -1
        Controls("D" & i).Caption = c
        Controls("D" & i).Tag = CStr(DateSerial(Year(myDate), Month(myDate), c))
        Controls("D" & i).ForeColor = RGB(100, 100, 100)
        c = c - 1
    Next
    '|fffd||fffd||fffd||fffd||fffd||313||fffd||fffd|t|fffd||310||752||fffd|
    myDate = DateSerial(y, m + 1, 1)
    c = 1
    For i = WeekDay_of_firstday + lastDay + 1 To 42
        Controls("D" & i).Caption = c
        Controls("D" & i).Tag = CStr(DateSerial(Year(myDate), Month(myDate), c))
        Controls("D" & i).ForeColor = RGB(100, 100, 100)
        c = c + 1
    Next
End Sub

Private Function getWeekday1st(y As Integer, m As Integer) As Integer
    '|fffd||fffd||fffd||fffd||fffd||314|N|fffd||18c||fffd||fffd||24a||582||fffd||fffd||101|A1|fffd||fffd||fffd||317|j|fffd||fffd||fffd||1050e||fffd||fffd||14e||64fe||fffd|i|fffd||fffd||fffd||fffd|1|fffd|A|fffd||fffd||fffd||fffd|2|fffd|E|fffd|E|fffd|E|fffd|j
    Dim firstDay As Date
    firstDay = DateSerial(y, m, 1)
    getWeekday1st = Weekday(firstDay, vbSunday)
End Function



















Attribute VB_Name = "frmComInfo"
Attribute VB_Base = "0{582C86BC-B766-4305-A23D-703467A2E862}{5B31F540-902A-40B4-ACFF-550B0F700F1C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnEntry_Click()
    '|fffd|V|fffd|[|fffd|g|fffd||253|]|fffd|L|fffd||fffd||fffd||115||82||fffd||fffd||fffd|
    With Worksheets("|fffd||752||fffd|")
        .Range("C1").Value = txtCom.Text
        .Range("C2").Value = txtPost.Text
        .Range("C3").Value = txtAddress.Text
        .Range("C4").Value = txtTEL.Text
    End With
    Unload Me
End Sub

Private Sub UserForm_Initialize()
    '|fffd|V|fffd|[|fffd|g|fffd||312|l|fffd||fffd||fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||250||752||fffd|
'    With Worksheets("|fffd||752||fffd|")
'        txtCom.Text = .Range("C1").Value
'        txtPost.Text = .Range("C2").Value
'        txtAddress.Text = .Range("C3").Value
'        txtTEL.Text = .Range("C4").Value
'    End With
    With Worksheets("|fffd||752||fffd|")
        Dim ctrl As Control
        For Each ctrl In Me.Controls
            If ctrl.Tag <> "" Then
                ctrl.Text = .Range(ctrl.Tag).Value
            End If
        Next
    End With
End Sub
Attribute VB_Name = "frmCustomerEntry"
Attribute VB_Base = "0{44C1AD38-97EB-4238-B57A-24DE46AAC1A1}{5321BAD3-78A5-47E7-A189-37BAC5483F88}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnEntry_Click()
    '|fffd||fffd||fffd||355|K|fffd|{|fffd||fffd||fffd||682||fffd||fffd||fffd||fffd||fffd||fffd||342||202||fffd|A|fffd|I|fffd||fffd||fffd|i|fffd|o|fffd|^|fffd||fffd||fffd||202||fffd||fffd|j
    If txtCustomerName.Text = "" Then
        MsgBox "|fffd||68b|q|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd|m|fffd|F"
        Exit Sub
    End If
    If txtKana.Text = "" Then
        MsgBox "|fffd|t|fffd||fffd||fffd|K|fffd|i|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd|m|fffd|F"
        Exit Sub
    End If

    '|fffd|e|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||253|]|fffd|L
    Dim TargetRow As Integer
    TargetRow = Range("A65536").End(xlUp).Offset(1).Row
    Range("A" & TargetRow).Value = TargetRow - 1
    Range("B" & TargetRow).Value = txtCustomerName.Text
    Range("C" & TargetRow).Value = txtKana.Text
    Range("D" & TargetRow).Value = txtPost.Text
    Range("E" & TargetRow).Value = txtAddress.Value
    Range("F" & TargetRow).Value = txtTEL.Text
    Range("G" & TargetRow).Value = txtFAX.Text

    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||252||1c9||fffd|
    lstCustomer.AddItem TargetRow - 1
    lstCustomer.List(lstCustomer.ListCount - 1, 1) = txtCustomerName.Text
    lstCustomer.List(lstCustomer.ListCount - 1, 2) = txtKana.Text
    lstCustomer.List(lstCustomer.ListCount - 1, 3) = txtPost.Text
    lstCustomer.List(lstCustomer.ListCount - 1, 4) = txtAddress.Text
    lstCustomer.List(lstCustomer.ListCount - 1, 5) = txtTEL.Text
    lstCustomer.List(lstCustomer.ListCount - 1, 6) = txtFAX.Text
    
    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||303|N|fffd||fffd||fffd|A
    txtCustomerName.Text = ""
    txtKana.Text = ""
    txtPost.Text = ""
    txtAddress.Text = ""
    txtTEL.Text = ""
    txtFAX.Text = ""
End Sub

Private Sub UserForm_Initialize()
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Activate
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
    With lstCustomer
        .Font.Size = 10
        .ColumnCount = 7
        .ColumnWidths = "20;120;90;50;130;70;70"
        .TextAlign = fmTextAlignLeft
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||24c||68b|q|fffd||fffd||fffd||fffd||1c9||fffd|
        Dim i As Integer
        Dim LastRow As Integer
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Cells(i, 8).Value <> 1 Then
                .AddItem Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Cells(i, 3).Value
                .List(.ListCount - 1, 3) = Cells(i, 4).Value
                .List(.ListCount - 1, 4) = Cells(i, 5).Value
                .List(.ListCount - 1, 5) = Cells(i, 6).Value
                .List(.ListCount - 1, 6) = Cells(i, 7).Value
            End If
        Next
    End With
End Sub
Attribute VB_Name = "frmCustomerUpdate"
Attribute VB_Base = "0{28A32F5A-88C6-4CED-93AB-A826BDA5D611}{AEC81E9F-47CD-4764-95C9-BABAAEC96F21}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnDelete_Click()
    Dim strMsg As String
    Dim strTitle As String
    Dim res As Integer  'MsgBox|fffd||316||7c2||fffd|l|fffd||fffd||fffd|i|fffd|[
    strMsg = lstCustomer.List(lstCustomer.ListIndex, 1)
    strMsg = strMsg & " |fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    strTitle = "|fffd||d3dc||fffd||30a|m|fffd|F"
    res = MsgBox(strMsg, vbYesNo + vbExclamation + vbDefaultButton2, strTitle)
    If res = vbNo Then Exit Sub
    
    '|fffd||d3dc||fffd||30f||fffd||fffd||fffd|
    Dim TargetRow As Integer
    TargetRow = lstCustomer.Value + 1
    Cells(TargetRow, 8).Value = 1
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30d|X|fffd|V
    lstCustomer.RemoveItem lstCustomer.ListIndex
End Sub

Private Sub btnUpdate_Click()
    Dim Msg As String, Title As String
    Msg = "|fffd|C|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd|C|fffd||fffd||fffd||30a|m|fffd|F"
    Dim res As Integer
    res = MsgBox(Msg, vbYesNo + vbInformation, Title)
    If res <> vbYes Then Exit Sub
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|X|fffd|V
    With lstCustomer
        Dim TargetIndex As Integer
        TargetIndex = .ListIndex
        .List(TargetIndex, 1) = txtCustomerName.Text
        .List(TargetIndex, 2) = txtKana.Text
        .List(TargetIndex, 3) = txtPost.Text
        .List(TargetIndex, 4) = txtAddress.Text
        .List(TargetIndex, 5) = txtTEL.Text
        .List(TargetIndex, 6) = txtFAX.Text
    End With
    '|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|X|fffd|V
    Dim TargetRow As Integer
    TargetRow = CInt(txtID.Text) + 1
    Cells(TargetRow, 2).Value = txtCustomerName.Text
    Cells(TargetRow, 3).Value = txtKana.Text
    Cells(TargetRow, 4).Value = txtPost.Text
    Cells(TargetRow, 5).Value = txtAddress.Text
    Cells(TargetRow, 6).Value = txtTEL.Text
    Cells(TargetRow, 7).Value = txtFAX.Text
    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|N|fffd||fffd||fffd|A
    Dim ctrl As Control
    For Each ctrl In Me.Controls
        If Left(ctrl.Name, 3) = "txt" Then
            ctrl.Text = ""
        End If
    Next
End Sub

Private Sub lstCustomer_Change()
    '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||a0bd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|i|fffd|s|fffd|j|fffd||fffd||fffd|A|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||255|\|fffd||fffd|
    Dim TargetRow As Integer
    TargetRow = lstCustomer.ListIndex
    txtID.Text = lstCustomer.Value
    txtCustomerName.Text = lstCustomer.List(TargetRow, 1)
    txtKana.Text = lstCustomer.List(TargetRow, 2)
    txtPost.Text = lstCustomer.List(TargetRow, 3)
    txtAddress.Text = lstCustomer.List(TargetRow, 4)
    txtTEL.Text = lstCustomer.List(TargetRow, 5)
    txtFAX.Text = lstCustomer.List(TargetRow, 6)
    
    '|fffd|C|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||18d||d3dc||fffd|{|fffd|^|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||242||fffd||fffd||fffd|
    btnUpdate.Enabled = True
    btnDelete.Enabled = True
End Sub

Private Sub UserForm_Initialize()
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Activate
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
    With lstCustomer
        .Font.Size = 10
        .ColumnCount = 7
        .ColumnWidths = "20;120;90;50;130;70;70"
        .TextAlign = fmTextAlignLeft
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||24c||68b|q|fffd||fffd||fffd||fffd||1c9||fffd|
        Dim i As Integer
        Dim LastRow As Integer
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Cells(i, 8).Value <> 1 Then
                .AddItem Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Cells(i, 3).Value
                .List(.ListCount - 1, 3) = Cells(i, 4).Value
                .List(.ListCount - 1, 4) = Cells(i, 5).Value
                .List(.ListCount - 1, 5) = Cells(i, 6).Value
                .List(.ListCount - 1, 6) = Cells(i, 7).Value
            End If
        Next
    End With
    'ID|fffd||341|A|fffd||3cd|X|fffd|s|fffd|\|fffd||242||fffd||fffd||fffd|
    txtID.Locked = True
    '|fffd|C|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||18d||d3dc||fffd|{|fffd|^|fffd||fffd||fffd||16ccc||fffd||fffd||242||fffd||fffd||102||fffd||fffd||fffd|
    btnUpdate.Enabled = False
    btnDelete.Enabled = False
End Sub



Attribute VB_Name = "frmGoodsEntry"
Attribute VB_Base = "0{9C393D34-29DB-4A0B-80AF-22E77CC4DA26}{29ADCA61-9E4C-4705-ADF5-C3A7788AF135}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnEntry_Click()
    If Not IsEntryData(Me) Then Exit Sub
    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||312|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||253|]|fffd|L
    Dim r As Integer
    r = Range("A" & Rows.Count).End(xlUp).Offset(1).Row
    Range("A" & r).Value = r - 1
    Range("B" & r).Value = txtGoods.Text
    Range("C" & r).Value = cboCategory.Text
    Range("D" & r).Value = txtMaker.Text
    Range("E" & r).Value = txtPrice.Text
    Range("F" & r).Value = txtUnit.Text
    Range("G" & r).Value = txtRemark.Text
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||243|f|fffd|[|fffd|^|fffd||fffd||1c9||fffd|
    With ListBox1
        .AddItem FormatAddSpace(CStr(r - 1), 4) '|fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd|
        .List(.ListCount - 1, 1) = txtGoods.Text
        .List(.ListCount - 1, 2) = cboCategory.Text
        .List(.ListCount - 1, 3) = txtMaker.Text
        .List(.ListCount - 1, 4) = FormatAddSpace(Format(txtPrice.Text, "#,##0"), 10)
        .List(.ListCount - 1, 5) = txtUnit.Text
        .List(.ListCount - 1, 6) = txtRemark.Text
    End With
    
    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||312|l|fffd||303|N|fffd||fffd||fffd|A
    txtGoods.Text = ""
    cboCategory.Text = ""
    txtMaker.Text = ""
    txtPrice.Text = ""
    txtUnit.Text = ""
    txtRemark.Text = ""
End Sub

Private Sub txtPrice_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = checkNum(KeyAscii)
End Sub

Private Sub UserForm_Initialize()
    Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Select
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
    With ListBox1
        .Font.Size = 10
        .ColumnCount = 7
        .ColumnWidths = "50;100;80;80;100;30;70"
        .TextAlign = fmTextAlignLeft
        .Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
        
        Dim i As Integer
        Dim LastRow As Integer
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Cells(i, 8).Value <> 1 Then
                .AddItem FormatAddSpace(Cells(i, 1).Value, 4)
                .List(.ListCount - 1, 1) = Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Cells(i, 3).Value
                .List(.ListCount - 1, 3) = Cells(i, 4).Value
                .List(.ListCount - 1, 4) = FormatAddSpace(Format(Cells(i, 5).Value, "#,##0"), 10)
                .List(.ListCount - 1, 5) = Cells(i, 6).Value
                .List(.ListCount - 1, 6) = Cells(i, 7).Value
            End If
        Next
    End With
    
    '|fffd||fffd||fffd||796||fffd||fffd||1228f|o
    If Range("A1").CurrentRegion.Rows.Count > 1 Then
        Worksheets("|fffd||fffd||fffd||792||fffd||fffd|o").Activate
        Dim DataRange As Range, Criteria As Range, CopyTo As Range
        Dim blnUnique As Boolean
        Set DataRange = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Range("A1")
        Set Criteria = Range("A1:A2")
        Set CopyTo = Range("A10")
        blnUnique = True
        AdvancedFilter DataRange, Criteria, CopyTo, blnUnique
        '|fffd||fffd||fffd|o|fffd||fffd||fffd||282||fffd||fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303||fffd||fffd|X|fffd|g|fffd||250||752||fffd|
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        For i = 11 To LastRow
            cboCategory.AddItem Cells(i, 1).Value
        Next
    End If
    Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Activate
End Sub












Attribute VB_Name = "frmGoodsUpdate"
Attribute VB_Base = "0{8816E6CF-FA8C-4790-83DF-C989455D97C5}{25F67547-954F-4D4E-9ACB-A72ECD3CD258}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnDelete_Click()
    '|fffd|s|fffd||30d||d3dc|
    Dim strMsg As String
    Dim strTitle As String
    Dim res As Integer          'MsgBox|fffd||316||7c2||fffd|l|fffd||fffd||fffd|i|fffd|[
    
    strMsg = ListBox1.List(ListBox1.ListIndex, 1)
    strMsg = strMsg & "|fffd|@|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    strTitle = "|fffd||d3dc||fffd||30a|m|fffd|F"
    res = MsgBox(strMsg, vbYesNo + vbExclamation, strTitle)
    If res = vbNo Then Exit Sub
    
    '|fffd||d3dc||fffd||30f||fffd||fffd||fffd|
    Dim TargetRow As Integer
    TargetRow = ListBox1.Value + 1
    Cells(TargetRow, 8).Value = 1
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30d|X|fffd|V
    ListBox1.RemoveItem ListBox1.ListIndex
End Sub

Private Sub btnUpdate_Click()
    Dim Msg As String, Title As String
    Msg = "|fffd|C|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd|C|fffd||fffd||fffd||30a|m|fffd|F"
    
    Dim res As Integer
    res = MsgBox(Msg, vbYesNo + vbInformation, Title)
    If res = vbNo Then Exit Sub
    
    '|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|
    With ListBox1   '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30d|X|fffd|V
        Dim TargetIndex As Integer
        TargetIndex = .ListIndex
        .List(TargetIndex, 1) = txtGoods.Text
        .List(TargetIndex, 2) = cboCategory.Value
        .List(TargetIndex, 3) = txtMaker.Text
        .List(TargetIndex, 4) = FormatAddSpace(Format(txtPrice.Text, "#,##0"), 10)
        .List(TargetIndex, 5) = txtUnit.Text
        .List(TargetIndex, 6) = txtRemark.Text
    End With
    
    '|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|X|fffd|V
    Dim TargetRow As Integer
    TargetRow = CInt(txtID.Text) + 1
    Cells(TargetRow, 2).Value = txtGoods.Text
    Cells(TargetRow, 3).Value = cboCategory.Text
    Cells(TargetRow, 4).Value = txtMaker.Text
    Cells(TargetRow, 5).Value = txtPrice.Text
    Cells(TargetRow, 6).Value = txtUnit.Text
    Cells(TargetRow, 7).Value = txtRemark.Text
    
    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||303|N|fffd||fffd||fffd|A
    txtID.Text = ""
    txtGoods.Text = ""
    cboCategory.Text = ""
    txtMaker.Text = ""
    txtPrice.Text = ""
    txtUnit.Text = ""
    txtRemark.Text = ""
End Sub

Private Sub ListBox1_Change()
    With ListBox1
        Dim TargetRow As Integer
        TargetRow = .ListIndex
    
        txtID.Text = .Text
        txtGoods.Text = .List(TargetRow, 1)
        cboCategory.Text = .List(TargetRow, 2)
        txtMaker.Text = .List(TargetRow, 3)
        txtPrice.Value = Trim(.List(TargetRow, 4))   '|fffd|X|fffd|y|fffd|[|fffd|X|fffd||d3dc|
        txtUnit.Text = .List(TargetRow, 5)
        txtRemark.Text = .List(TargetRow, 6)
    End With
    
    '|fffd|C|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||18d||d3dc||fffd|{|fffd|^|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||242||fffd||fffd||fffd|
    btnUpdate.Enabled = True
    btnDelete.Enabled = True
End Sub

Private Sub UserForm_Initialize()
    Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Select
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||310||752||fffd|
    With ListBox1
        .Font.Size = 10
        .ColumnCount = 7
        .ColumnWidths = "50;100;80;80;100;30;70"
        .TextAlign = fmTextAlignLeft
        .Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
        
        Dim i As Integer
        Dim LastRow As Integer
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Cells(i, 8).Value <> 1 Then
                .AddItem FormatAddSpace(Cells(i, 1).Value, 4)
                .List(.ListCount - 1, 1) = Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Cells(i, 3).Value
                .List(.ListCount - 1, 3) = Cells(i, 4).Value
                .List(.ListCount - 1, 4) = FormatAddSpace(Format(Cells(i, 5).Value, "#,##0"), 10)
                .List(.ListCount - 1, 5) = Cells(i, 6).Value
                .List(.ListCount - 1, 6) = Cells(i, 7).Value
            End If
        Next
    End With
    
    '|fffd||fffd||fffd|iID|fffd||fffd||3cd|X|fffd|s|fffd||82||242||fffd||fffd||fffd|
    txtID.Locked = True
    '|fffd|C|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||18d||d3dc||fffd|{|fffd|^|fffd||fffd||fffd||16ccc||fffd||fffd||242||fffd||fffd||102||fffd||fffd||fffd|
    btnUpdate.Enabled = False
    btnDelete.Enabled = False
End Sub

















Attribute VB_Name = "frmMeisai"
Attribute VB_Base = "0{479C577E-0473-478E-9028-42F6938871A8}{FE97C116-03A4-440C-BF41-CD58675E075E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Public ParentForm As MSForms.UserForm

Private Sub btnCancel_Click()
    Unload Me
End Sub

Private Sub btnUpdate_Click()
    '|fffd|e|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||fffd||fffd|X|fffd|V
    With ParentForm
        .lstMeisai.List(Me.Tag, 1) = cboGoodsID.Value
        .lstMeisai.List(Me.Tag, 2) = FormatAddSpace(txtGoodsName.Text, 30, False)
        .lstMeisai.List(Me.Tag, 3) = txtGoodsPrice.Text
        .lstMeisai.List(Me.Tag, 4) = txtQuantity.Text
        .lstMeisai.List(Me.Tag, 5) = txtGoodsUnit.Text
        .lstMeisai.List(Me.Tag, 6) = txtAmount.Text
        .lstMeisai.List(Me.Tag, 7) = txtTax.Text
        .lstMeisai.List(Me.Tag, 8) = txtSumWithTax.Text
        '|fffd||fffd||fffd|v|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
        .lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, .lstMeisai), "#,##0")
    End With
    '|fffd||fffd||fffd||303|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    Unload Me
End Sub

Private Sub cboGoodsID_Change()
    '|fffd||fffd||fffd|iID|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|2|fffd||fffd||682||fffd||fffd||fffd|4|fffd||fffd||682||312|l|fffd||fffd||fffd||fffd|
    With cboGoodsID
        If .ListIndex = -1 Then Exit Sub
        txtGoodsName.Text = .List(.ListIndex, 1)
        txtGoodsPrice.Text = .List(.ListIndex, 2)
        txtGoodsUnit.Text = .List(.ListIndex, 3)
    End With
End Sub

Private Sub txtGoodsPrice_AfterUpdate()
    MyCalc Me       '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z
End Sub

Private Sub txtQuantity_AfterUpdate()
    MyCalc Me       '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z
End Sub

Private Sub UserForm_Initialize()
    Dim ws As Worksheet
    Set ws = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^")
    Dim LastRow As Integer
    Dim i As Integer
    
    'cboGoodsID|fffd|i|fffd||fffd||fffd|iID|fffd|j|fffd||310||752||fffd|
    With cboGoodsID
        .Font.Size = 12
        .ColumnCount = 4
        .ColumnWidths = "30;150;0;0"
        .ListWidth = 180
        LastRow = ws.Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If ws.Cells(i, 8).Value <> 1 Then
                .AddItem ws.Cells(i, 1).Value
                .List(.ListCount - 1, 1) = ws.Cells(i, 2).Value
                .List(.ListCount - 1, 2) = ws.Cells(i, 5).Value
                .List(.ListCount - 1, 3) = ws.Cells(i, 6).Value
            End If
        Next
    End With
End Sub


Attribute VB_Name = "frmMenu"
Attribute VB_Base = "0{0247AEEA-9DB9-4BBF-B24D-152180070CF0}{8A68A844-ADE8-41ED-BE0A-EA78F9E71994}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnBill_Click()
    frmBillOption.Show
End Sub

Private Sub btnComInfo_Click()
    frmComInfo.Show
End Sub

Private Sub btnCustomerEntry_Click()
    frmCustomerEntry.Show
End Sub

Private Sub btnCustomerUpdate_Click()
    frmCustomerUpdate.Show
End Sub

Private Sub btnGoodsEntry_Click()
    frmGoodsEntry.Show
End Sub

Private Sub btnGoodsUpdate_Click()
    frmGoodsUpdate.Show
End Sub

Private Sub btnQuit_Click()
    '--------------------------------------
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||90b1||fffd||fffd|
    Application.Visible = True
    '--------------------------------------
    Unload Me
End Sub

Private Sub btnSalesEntry_Click()
    frmSalesEntry.Show
End Sub

Private Sub btnSalesUpdate_Click()
    frmSalesSearch.Show
End Sub

Private Sub UserForm_Initialize()
    lblDate.Caption = Format(Now, "yyyy/m/d  hh:mm")
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
'    ActiveWorkbook.Save
'    Application.Quit
End Sub
Attribute VB_Name = "frmSalesEntry"
Attribute VB_Base = "0{FD88BF41-E780-418F-866C-F17ED4AE6FFB}{15ABDB78-DAAF-4236-A795-B1B112766ABC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnAdd_Click()
    '|fffd||fffd||fffd||5cd|s|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||592||1c9||fffd|
    With lstMeisai
        .AddItem 0
        .List(.ListCount - 1, 1) = cboGoodsID.Text
        .List(.ListCount - 1, 2) = FormatAddSpace(txtGoodsName.Text, 30, False)
        .List(.ListCount - 1, 3) = Format(txtGoodsPrice.Text, "#,##0")
        .List(.ListCount - 1, 4) = Format(txtQuantity.Text, "#,##0")
        .List(.ListCount - 1, 5) = txtGoodsUnit.Text
        .List(.ListCount - 1, 6) = txtAmount.Text
        .List(.ListCount - 1, 7) = txtTax.Text
        .List(.ListCount - 1, 8) = txtSumWithTax.Text
    End With
    '|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|(|fffd||fffd||fffd||fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd|j
    lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, lstMeisai), "#,##0")
    '|fffd||fffd||fffd||5cd|s|fffd||312|l|fffd||fffd||fffd|N|fffd||fffd||fffd|A
    ClearMeisaiRecord Me
    '|fffd||fffd||fffd|iID|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||243|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||fffd||fffd||693||fffd|
    cboGoodsID.SetFocus
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd|s|fffd|\|fffd||242||fffd||fffd||fffd|
    btnAdd.Enabled = False
End Sub

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnDelete_Click()
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||303||fffd||fffd|R|fffd|[|fffd|h|fffd|i|fffd|s|fffd|j|fffd||30d||d3dc|
    With lstMeisai
        Dim r As Integer
        r = .ListIndex
        If r = -1 Then Exit Sub
        
        Dim Msg As String, Title As String
        Msg = "|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||95be||fffd||5cd|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||256||7c2||fffd||702||fffd||fffd||fffd|B" & vbNewLine
        Msg = Msg & "|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H "
        Title = "|fffd||d3dc||fffd||30a|m|fffd|F"
        Dim res As Integer
        res = MsgBox(Msg, vbYesNo + vbExclamation + vbDefaultButton2, Title)
        If res <> vbYes Then Exit Sub
        
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||fffd||fffd||d3dc|
        .RemoveItem r
        '|fffd||fffd||fffd|v|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
        lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, lstMeisai), "#,##0")
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||311|I|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|
        .ListIndex = -1
        '|fffd|u|fffd||d3dc||fffd|v|fffd|u|fffd|C|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||16ccc||fffd||fffd||242||fffd||fffd||fffd|
        btnDelete.Enabled = False
        btnUpdate.Enabled = False
    End With
End Sub

Private Sub btnEntry_Click()
    '|fffd|o|fffd|^|fffd||fffd||fffd||fffd|
    Dim RecordCount As Integer
    RecordCount = lstMeisai.ListCount
    '|fffd||fffd||fffd||5cd|s|fffd||fffd|0|fffd||fffd||fffd||30f||a347||fffd||341|A|fffd|I|fffd||fffd|
    If RecordCount = 0 Then
        MsgBox "|fffd||fffd||fffd||35be||fffd||5c2||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbInformation, "|fffd|m|fffd|F"
        Exit Sub
    End If
    
    Dim res As Integer
    Dim Msg As String, Title As String
    Msg = "|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd|m|fffd|F"
    res = MsgBox(Msg, vbYesNo + vbInformation, Title)
    '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|{|fffd|b|fffd|N|fffd|X|fffd||301|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||341|A|fffd|I|fffd||fffd|
    If res = vbNo Then Exit Sub
    
    '|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|v|fffd||253|o|fffd|^
    Dim TargetRow As Integer
    With Worksheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|")
        TargetRow = .Range("A" & Rows.Count).End(xlUp).Offset(1).Row
        .Cells(TargetRow, 1).Value = txtSlipNo.Text
        .Cells(TargetRow, 2).Value = txtSlipDate.Text
        .Cells(TargetRow, 3).Value = cboCustomerID.Text
        .Cells(TargetRow, 4).Value = lblCustomerName.Caption
    End With
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||35be||fffd||5c1|v|fffd||253|o|fffd|^
    With Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|")
        TargetRow = .Range("A65536").End(xlUp).Offset(1).Row
        Dim i As Integer
        For i = 0 To RecordCount - 1
            .Cells(TargetRow, 1).Value = TargetRow - 1
            .Cells(TargetRow, 2).Value = txtSlipNo.Text
            .Cells(TargetRow, 3).Value = txtSlipDate.Text
            .Cells(TargetRow, 4).Value = cboCustomerID.Text
            .Cells(TargetRow, 5).Value = lblCustomerName.Caption
            .Cells(TargetRow, 6).Value = lstMeisai.List(i, 1)
            .Cells(TargetRow, 7).Value = TrimSpecial(lstMeisai.List(i, 2))      '|fffd||fffd||fffd|i|fffd||fffd||fffd||343|X|fffd|y|fffd|[|fffd|X|fffd||d3dc||fffd||fffd||fffd||fffd|
            .Cells(TargetRow, 8).Value = lstMeisai.List(i, 3)
            .Cells(TargetRow, 9).Value = lstMeisai.List(i, 4)
            .Cells(TargetRow, 10).Value = lstMeisai.List(i, 5)
            .Cells(TargetRow, 11).Value = lstMeisai.List(i, 6)
            .Cells(TargetRow, 12).Value = lstMeisai.List(i, 7)
            .Cells(TargetRow, 13).Value = lstMeisai.List(i, 8)
            TargetRow = TargetRow + 1   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||78d|s|fffd||50d||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
        Next
        MsgBox "|fffd||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||702||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
        '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||312|l|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||10e||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd|
        cboCustomerID.Text = ""
        lblCustomerName.Caption = ""
        lblGoukeiKingaku.Caption = ""
        ClearMeisaiRecord Me
        lstMeisai.Clear
        '|fffd|`|fffd|[|fffd||50d||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
        txtSlipNo.Text = CInt(txtSlipNo.Text) + 1
    End With
End Sub

Private Sub btnUpdate_Click()
    '|fffd|C|fffd||fffd||fffd|p|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
    With lstMeisai
        Dim r As Integer
        r = .ListIndex
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||341|Ar|fffd||fffd|-1|fffd||242||202||fffd|B|fffd||fffd||fffd||30e||fffd||fffd||341|A|fffd|I|fffd||fffd|
        If r = -1 Then Exit Sub
        '|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||312|l|fffd||fffd||fffd|C|fffd||fffd||fffd|p|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30a|e|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||251||fffd||fffd|
        frmMeisai.cboGoodsID.Text = .List(r, 1)
        frmMeisai.txtGoodsName.Text = .List(r, 2)
        frmMeisai.txtGoodsPrice.Text = .List(r, 3)
        frmMeisai.txtQuantity.Text = .List(r, 4)
        frmMeisai.txtGoodsUnit.Text = .List(r, 5)
        frmMeisai.txtAmount.Text = .List(r, 6)
        frmMeisai.txtTax.Text = .List(r, 7)
        frmMeisai.txtSumWithTax.Text = .List(r, 8)
        '|fffd|I|fffd||fffd||fffd|s|fffd||314||50d||fffd||fffd||fffd|frmMeisai|fffd||252|m|fffd||70b9||fffd||fffd|
        frmMeisai.Tag = r
        'frmMeisai|fffd||fffd|Pulic|fffd||3d0||fffd||fffd||242||fffd||fffd||303|t|fffd|H|fffd|[|fffd||fffd||fffd||582||30e|Q|fffd||182||fffd||fffd||fffd|
        Set frmMeisai.ParentForm = Me
        frmMeisai.Show
    End With
End Sub

Private Sub cboCustomerID_Change()
    With cboCustomerID
        '|fffd|s|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        If .ListIndex = -1 Then Exit Sub
        '2|fffd||fffd||682||312|l|fffd||fffd|lblCustomerName|fffd||255|\|fffd||fffd|
        lblCustomerName.Caption = .List(.ListIndex, 1)
    End With
    
    '|fffd||fffd||fffd||5cd|s|fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    cboGoodsID.Enabled = True
    txtGoodsPrice.Enabled = True
    txtQuantity.Enabled = True
    
    '|fffd|o|fffd|^|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    btnEntry.Enabled = True
End Sub

Private Sub cboGoodsID_Change()
    '|fffd||fffd||fffd|iID|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|2|fffd||fffd||682||fffd||fffd||fffd|4|fffd||fffd||682||312|l|fffd||fffd||fffd||fffd|
    With cboGoodsID
        If .ListIndex = -1 Then Exit Sub
        txtGoodsName.Text = .List(.ListIndex, 1)
        txtGoodsPrice.Text = .List(.ListIndex, 2)
        txtGoodsUnit.Text = .List(.ListIndex, 3)
    End With
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Sub cboGoodsID_Enter()
    '|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||64fe||fffd||fffd||fffd||243||fffd||fffd|X|fffd|g|fffd||fffd|\|fffd||fffd|
    cboGoodsID.DropDown
End Sub

Private Sub lstMeisai_Change()
    '|fffd|u|fffd|C|fffd||fffd||fffd|v|fffd|u|fffd||d3dc||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||317|L|fffd||fffd||fffd||fffd|
    btnUpdate.Enabled = True
    btnDelete.Enabled = True
End Sub

Private Sub txtGoodsPrice_AfterUpdate()
    '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z|fffd|@Module1|fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||102||fffd||fffd||fffd|
    MyCalc Me
End Sub

Private Sub txtGoodsPrice_Change()
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Sub txtQuantity_AfterUpdate()
    '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z|fffd|@Module1|fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||102||fffd||fffd||fffd|
    MyCalc Me
End Sub

Private Sub txtQuantity_Change()
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Function CheckEntry() As Boolean
    'Tag|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||310||752||80b3||fffd||fffd||102||fffd||fffd||fffd|S|fffd||102||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||242||82||fffd||fffd||fffd|
    '|fffd|l|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd|True|fffd|A|fffd||fffd||fffd||fffd||20a|O|fffd||fffd|False
    Dim ctrl As Control
    For Each ctrl In Me.Controls
        If ctrl.Tag <> "" Then
            If ctrl.Value = "" Then
                CheckEntry = False
                Exit Function
            End If
        End If
    Next
    CheckEntry = True
End Function

Private Sub UserForm_Initialize()
    '|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd|B
    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||310||752||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B

    '|fffd|e|fffd|{|fffd|^|fffd||fffd||fffd||316||fffd||fffd||fffd||fffd||fffd|
    btnAdd.Enabled = False
    btnUpdate.Enabled = False
    btnDelete.Enabled = False
    btnEntry.Enabled = False
     '|fffd||fffd||fffd||fffd||fffd||313||fffd||fffd|t|fffd||fffd|\|fffd||fffd|
    txtSlipDate.Text = Format(Date, "yyyy/m/d")
    
    '|fffd|`|fffd|[No|fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    txtSlipNo.Text = Worksheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|").Range("A" & Rows.Count).End(xlUp).Row

    Dim i As Integer
    Dim LastRow As Integer
    'cboCustomerID|fffd|i|fffd||68b|qID|fffd|j|fffd||310||752||fffd|
    With cboCustomerID
        .Font.Size = 12
        .ColumnCount = 2
        .ColumnWidths = "30;150"
        .ListWidth = 180
        LastRow = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 8).Value <> 1 Then
                .AddItem Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 2).Value
            End If
        Next
    End With
    
    'cboGoodsID|fffd|i|fffd||fffd||fffd|iID|fffd|j|fffd||310||752||fffd|
    With cboGoodsID
        .Font.Size = 12
        .ColumnCount = 4
        .ColumnWidths = "30;150;0;0"
        .ListWidth = 180
        LastRow = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 8).Value <> 1 Then
                .AddItem Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 5).Value
                .List(.ListCount - 1, 3) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 6).Value
            End If
        Next
    End With
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    With lstMeisai
        .ColumnCount = 9
        .ColumnWidths = "0;36;156;72;54;42;72;62;72"
        .TextAlign = fmTextAlignRight
        .Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
    End With
    
    '|fffd||68b|q|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||310||752||fffd|
    lblCustomerName.Caption = "|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

    '|fffd||fffd||fffd||5cd|s|fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||16ccc||fffd||fffd||242||fffd||fffd||fffd|
    cboGoodsID.Enabled = False
    txtGoodsPrice.Enabled = False
    txtQuantity.Enabled = False
End Sub

'|fffd||209||fffd||fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||355|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||248||693||fffd||fffd||fffd||fffd||fffd||fffd||302||14d||d3dc||fffd||fffd||fffd||102||fffd||fffd||60a2|
'Private Sub MyCalc()
'    '|fffd||fffd||fffd|z|fffd|E|fffd||fffd||fffd||fffd||141|E|fffd||14d||fffd||fffd||fffd||fffd|z|fffd||30c|v|fffd|Z
'    Const taxRate As Integer = 8
'    '|fffd|P|fffd||fffd||fffd|E|fffd||fffd||fffd||283|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||d74c2||30f||a347||fffd||341|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|g|fffd||fffd||fffd|b|fffd|v|fffd||fffd||fffd||fffd|
'    On Error GoTo eh
'    Dim Kingaku As Long
'    Kingaku = txtGoodsPrice.Text * txtQuantity.Text
'    '|fffd|G|fffd||fffd||fffd|[|fffd||303|g|fffd||fffd||fffd|b|fffd|v|fffd|I|fffd||fffd|
'    On Error GoTo 0
'    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||252|l|fffd||fffd||fffd||fffd|
'    txtAmount.Text = Format(Kingaku, "#,##0")
'    txtTax.Text = Format(Kingaku * taxRate / 100, "#,##0")
'    txtSumWithTax.Text = Format(Kingaku * (1 + taxRate / 100), "#,##0")
'    Exit Sub
'eh:
'    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'End Sub

Attribute VB_Name = "frmSalesSearch"
Attribute VB_Base = "0{84463AE3-F94C-4613-A7B2-75407E296C60}{000EA334-465B-40E4-AA91-50CD2727BE9D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnDispCalendar1_Click()
    frmCalendar.EntryControl = "txtDate1"
    frmCalendar.Show
End Sub

Private Sub btnDispCalendar2_Click()
    frmCalendar.EntryControl = "txtDate2"
    frmCalendar.Show
End Sub

Private Sub btnSalesDelete_Click()
    'lstinfo|fffd||242||fffd||fffd||fffd||fffd||101|A|fffd||1c2||30d|s|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||381|A|fffd|I|fffd||fffd|
    If lstInfo.ListIndex = -1 Then Exit Sub
    
    Dim res As Integer
    Dim Msg As String, Title As String
    Msg = "|fffd|`|fffd|[|fffd||50d||fffd||fffd|F" & lstInfo.Value & "|fffd|@|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd|m|fffd|F"
    res = MsgBox(Msg, vbYesNo + vbExclamation + vbDefaultButton2, Title)
    If res = vbNo Then Exit Sub
    
    '|fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|v|fffd||30a|Y|fffd||fffd||fffd|s|fffd||301|u|fffd||d3dc||fffd|v|fffd||fffd||fffd|1|fffd||fffd||fffd||fffd|
    Dim TargetRow As Integer
    TargetRow = lstInfo.Value + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|").Cells(TargetRow, 5).Value = 1
    '|fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||35be||fffd||5c1|v|fffd||30a|Y|fffd||fffd||fffd|s|fffd||301|u|fffd||d3dc||fffd|v|fffd||fffd||fffd|1|fffd||fffd||fffd||fffd|
    Dim c As Integer
    c = lstInfoMeisai.ListCount     '|fffd||fffd||fffd||5cd|s|fffd||30d|s|fffd||fffd||fffd||fffd|c|fffd||251||fffd||fffd|
    Dim i As Integer
    Dim r As Integer
    For i = 0 To c - 1
        r = lstInfoMeisai.List(i, 0)
        Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Cells(r + 1, 15).Value = 1
    Next
    'lstinfo|fffd||fffd||fffd||fffd|A|fffd|s|fffd||fffd||fffd||d3dc|
    lstInfo.RemoveItem lstInfo.ListIndex
    'lstinfomeisai|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A
    lstInfoMeisai.Clear
End Sub

Private Sub btnSalesUpdate_Click()
    '|fffd||48f|W|fffd|p|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|ufmSalesUpdate|fffd|v|fffd||fffd|\|fffd||fffd|
    If lstInfo.ListIndex = -1 Then
        MsgBox "|fffd||fffd||303||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||48f|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                    vbInformation, "|fffd||fffd||fffd||80a2|"
        Exit Sub
    End If
    frmSalesUpdate.Show
End Sub

Private Sub btnSearch_Click()
    If txtDate1.Text = "" Or txtDate2.Text = "" Then
        MsgBox "|fffd||fffd||fffd||50e|w|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd|m|fffd|F"
        Exit Sub
    End If
    If Worksheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|").Range("A1").CurrentRegion.Rows.Count = 1 Then Exit Sub
    
    Worksheets("|fffd||fffd||fffd||348a||fffd|o").Activate
    Range("A2").Value = ""      '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    Range("N2").Value = "<>1"
    Range("B2").Value = ">=" & txtDate1.Text
    Range("O2").Value = "<=" & txtDate2.Text
    '|fffd||fffd||fffd|o
    Sheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|").Range("A1").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _
        CriteriaRange:=Range("A1:O2"), CopyToRange:=Range("A10:D10"), Unique:=True
    Dim DataRange As Range, Criteria As Range, CopyTo As Range
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||a0bd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||3554||fffd||303||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||255|\|fffd||fffd|
    With lstInfo
        .Clear      '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        Dim startRow As Integer
        Dim LastRow As Integer
        startRow = 11
        LastRow = Range("A" & Rows.Count).End(xlUp).Row
        Dim i As Integer
        For i = startRow To LastRow
            .AddItem Cells(i, 1).Value
            .List(.ListCount - 1, 1) = Cells(i, 2).Value
            .List(.ListCount - 1, 2) = Cells(i, 3).Value
            .List(.ListCount - 1, 3) = Cells(i, 4).Value
        Next
    End With
    lstInfoMeisai.Clear
End Sub

Private Sub lstInfo_Change()
    Worksheets("|fffd||fffd||fffd||348a||fffd|o").Activate
    Range("N2").Value = "<>1"       '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    Range("A2").Value = lstInfo.Value
    '|fffd||fffd||fffd|o
    Sheets("|fffd||fffd||fffd||35be||fffd||fffd|").Range("A1").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _
        CriteriaRange:=Range("A1:O2"), CopyToRange:=Range("K10:Y10"), Unique:=False
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||255|\|fffd||fffd|
    With lstInfoMeisai
        .Clear      '|fffd||fffd||fffd|X|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        Dim startRow As Integer, LastRow As Integer
        startRow = 11
        LastRow = Range("K" & Rows.Count).End(xlUp).Row
        Dim i As Integer
        For i = startRow To LastRow
            .AddItem Cells(i, 11).Value
            .List(.ListCount - 1, 1) = Cells(i, 16).Value
            .List(.ListCount - 1, 2) = FormatAddSpace(Cells(i, 17).Value, 30, False)
            .List(.ListCount - 1, 3) = Format(Cells(i, 18).Value, "#,##0")
            .List(.ListCount - 1, 4) = Cells(i, 19).Value
            .List(.ListCount - 1, 5) = Format(Cells(i, 20).Value, "#,##0")
            .List(.ListCount - 1, 6) = Format(Cells(i, 21).Value, "#,##0")
            .List(.ListCount - 1, 7) = Format(Cells(i, 22).Value, "#,##0")
            .List(.ListCount - 1, 8) = Format(Cells(i, 23).Value, "#,##0")
        Next
    End With
    '2|fffd||82||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    btnSalesUpdate.Enabled = True
    btnSalesDelete.Enabled = True
End Sub

Private Sub UserForm_Initialize()
    With lstInfo
        .ColumnCount = 4
        .ColumnWidths = "50;150;50;310"
        .TextAlign = fmTextAlignLeft
    End With
    With lstInfoMeisai
        .ColumnCount = 9
        .ColumnWidths = "0;36;150;72;54;42;72;62;72"
        .TextAlign = fmTextAlignRight
        .Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
    End With
    '2|fffd||82||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd|s|fffd|\|fffd||242||fffd||fffd||fffd|
    btnSalesUpdate.Enabled = False
    btnSalesDelete.Enabled = False
End Sub
Attribute VB_Name = "frmSalesUpdate"
Attribute VB_Base = "0{6E690DA0-86A4-4728-8692-C9D64AB5BB81}{18C5F5DA-17C4-4940-9033-16AA9E2C2116}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btnAdd_Click()
    '|fffd||fffd||fffd||5cd|s|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||592||1c9||fffd|
    With lstMeisai
        .AddItem 0
        .List(.ListCount - 1, 1) = cboGoodsID.Text
        .List(.ListCount - 1, 2) = FormatAddSpace(txtGoodsName.Text, 30, False)
        .List(.ListCount - 1, 3) = Format(txtGoodsPrice.Text, "#,##0")
        .List(.ListCount - 1, 4) = Format(txtQuantity.Text, "#,##0")
        .List(.ListCount - 1, 5) = txtGoodsUnit.Text
        .List(.ListCount - 1, 6) = txtAmount.Text
        .List(.ListCount - 1, 7) = txtTax.Text
        .List(.ListCount - 1, 8) = txtSumWithTax.Text
    End With
    '|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|(|fffd||fffd||fffd||fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd|j
    lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, lstMeisai), "#,##0")
    '|fffd||fffd||fffd||5cd|s|fffd||312|l|fffd||fffd||fffd|N|fffd||fffd||fffd|A
    ClearMeisaiRecord Me
    '|fffd||fffd||fffd|iID|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||243|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||fffd||fffd||693||fffd|
    cboGoodsID.SetFocus
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd|s|fffd|\|fffd||242||fffd||fffd||fffd|
    btnAdd.Enabled = False
End Sub

Private Sub btnClose_Click()
    Unload Me
End Sub

Private Sub btnDelete_Click()
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||303||fffd||fffd|R|fffd|[|fffd|h|fffd|i|fffd|s|fffd|j|fffd||30d||d3dc|
    With lstMeisai
        Dim r As Integer
        r = .ListIndex
        If r = -1 Then Exit Sub
        
        Dim Msg As String, Title As String
        Msg = "|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||95be||fffd||5cd|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||256||7c2||fffd||702||fffd||fffd||fffd|B" & vbNewLine
        Msg = Msg & "|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H "
        Title = "|fffd||d3dc||fffd||30a|m|fffd|F"
        Dim res As Integer
        res = MsgBox(Msg, vbYesNo + vbExclamation + vbDefaultButton2, Title)
        If res <> vbYes Then Exit Sub
        
        Dim MeisaiNo As Integer
        MeisaiNo = .List(r, 0)
        If MeisaiNo > 0 Then    '|fffd|V|fffd|[|fffd|g|fffd||253|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd|0|fffd||242||202||fffd|
            '|fffd|u|fffd||fffd||fffd||35be||fffd||5c1|v|fffd|V|fffd|[|fffd|g|fffd||30d||d3dc||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|").Cells(MeisaiNo + 1, 15).Value = 1
        End If
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||fffd||fffd||d3dc|
        .RemoveItem r
        '|fffd||fffd||fffd|v|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|
        lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, lstMeisai), "#,##0")
        '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||311|I|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|
        .ListIndex = -1
        '|fffd|u|fffd||d3dc||fffd|v|fffd|u|fffd|C|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||16ccc||fffd||fffd||242||fffd||fffd||fffd|
        btnDelete.Enabled = False
        btnUpdate.Enabled = False
    End With
End Sub

Private Sub btnEntry_Click()
    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd||209||fffd||fffd||fffd|2|fffd||82||303|V|fffd|[|fffd|g|fffd||254||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd|F|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|A|fffd||fffd||fffd||35be||fffd||fffd|
    Dim res As Integer
    Dim Msg As String, Title As String
    Msg = "|fffd||fffd||fffd||313||fffd||fffd|e|fffd||14d|X|fffd|V|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
    Title = "|fffd|m|fffd|F"
    res = MsgBox(Msg, vbYesNo + vbInformation, Title)
    '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|{|fffd|b|fffd|N|fffd|X|fffd||301|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||341|A|fffd|I|fffd||fffd|
    If res = vbNo Then Exit Sub

    '|fffd|u|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d|X|fffd|V
    Dim TargetRow As Integer
    With Worksheets("|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|")
        TargetRow = txtSlipNo.Text + 1
        .Cells(TargetRow, 2).Value = txtSlipDate.Text
        .Cells(TargetRow, 3).Value = cboCustomerID.Text
        .Cells(TargetRow, 4).Value = lblCustomerName.Caption
    End With
     '|fffd|u|fffd||fffd||fffd||35be||fffd||5c1|v|fffd|V|fffd|[|fffd|g|fffd||30d|X|fffd|V
     'lstmeisai|fffd||fffd|1|fffd||fffd||682||242||341|A|fffd||fffd||fffd||5d4||50d||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
     '|fffd||fffd||fffd||5d4||50d||fffd|+1|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||78d|s|fffd||314||50d||fffd||fffd||182||202||fffd|
     Dim ws As Worksheet
     Set ws = Worksheets("|fffd||fffd||fffd||35be||fffd||fffd|")
     Dim c As Integer
     c = lstMeisai.ListCount
     Dim i As Integer, j As Integer, r As Integer
     For i = 0 To c - 1
        r = lstMeisai.List(i, 0) + 1
        If r = 1 Then       '|fffd||fffd||fffd||5d4||50d||fffd||fffd||fffd|0|fffd||202||fffd|A|fffd|V|fffd|K|fffd||1c9||fffd||fffd||fffd||fffd||fffd|
            r = ws.Range("A65536").End(xlUp).Offset(1).Row
            ws.Cells(r, 1).Value = r - 1
        End If
        ws.Cells(r, 2).Value = txtSlipNo.Text
        ws.Cells(r, 3).Value = txtSlipDate.Text
        ws.Cells(r, 4).Value = cboCustomerID.Text
        ws.Cells(r, 5).Value = lblCustomerName.Caption
        For j = 1 To 8
            ws.Cells(r, j + 5).Value = TrimSpecial(lstMeisai.List(i, j))    '|fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd||fffd||d3dc|
        Next
     Next
     MsgBox "|fffd|X|fffd|V|fffd||fffd||fffd||702||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
     '|fffd|e|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd||115|`|fffd||fffd|
     With frmSalesSearch.lstInfo
        Dim lstInfoRow  As Integer
        lstInfoRow = .ListIndex
        .ListIndex = -1
        .ListIndex = lstInfoRow
     End With
     Unload Me
End Sub

Private Sub btnUpdate_Click()
    '|fffd|C|fffd||fffd||fffd|p|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
    With lstMeisai
        Dim r As Integer
        r = .ListIndex
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||341|Ar|fffd||fffd|-1|fffd||242||202||fffd|B|fffd||fffd||fffd||30e||fffd||fffd||341|A|fffd|I|fffd||fffd|
        If r = -1 Then Exit Sub
        '|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||312|l|fffd||fffd||fffd|C|fffd||fffd||fffd|p|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30a|e|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||251||fffd||fffd|
        frmMeisai.cboGoodsID.Text = .List(r, 1)
        frmMeisai.txtGoodsName.Text = .List(r, 2)
        frmMeisai.txtGoodsPrice.Text = .List(r, 3)
        frmMeisai.txtQuantity.Text = .List(r, 4)
        frmMeisai.txtGoodsUnit.Text = .List(r, 5)
        frmMeisai.txtAmount.Text = .List(r, 6)
        frmMeisai.txtTax.Text = .List(r, 7)
        frmMeisai.txtSumWithTax.Text = .List(r, 8)
        '|fffd|I|fffd||fffd||fffd|s|fffd||314||50d||fffd||fffd||fffd|frmMeisai|fffd||252|m|fffd||70b9||fffd||fffd|
        frmMeisai.Tag = r
        'frmMeisai|fffd||fffd|Pulic|fffd||3d0||fffd||fffd||242||fffd||fffd||303|t|fffd|H|fffd|[|fffd||fffd||fffd||582||30e|Q|fffd||182||fffd||fffd||fffd|
        Set frmMeisai.ParentForm = Me
        frmMeisai.Show
    End With
End Sub

Private Sub cboCustomerID_Change()
    With cboCustomerID
        '|fffd|s|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        If .ListIndex = -1 Then Exit Sub
        '2|fffd||fffd||682||312|l|fffd||fffd|lblCustomerName|fffd||255|\|fffd||fffd|
        lblCustomerName.Caption = .List(.ListIndex, 1)
    End With
    
    '|fffd||fffd||fffd||5cd|s|fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    cboGoodsID.Enabled = True
    txtGoodsPrice.Enabled = True
    txtQuantity.Enabled = True
    
    '|fffd|o|fffd|^|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    btnEntry.Enabled = True
End Sub

Private Sub cboGoodsID_Change()
    '|fffd||fffd||fffd|iID|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|2|fffd||fffd||682||fffd||fffd||fffd|4|fffd||fffd||682||312|l|fffd||fffd||fffd||fffd|
    With cboGoodsID
        If .ListIndex = -1 Then Exit Sub
        txtGoodsName.Text = .List(.ListIndex, 1)
        txtGoodsPrice.Text = .List(.ListIndex, 2)
        txtGoodsUnit.Text = .List(.ListIndex, 3)
    End With
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Sub cboGoodsID_Enter()
    '|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||64fe||fffd||fffd||fffd||243||fffd||fffd|X|fffd|g|fffd||fffd|\|fffd||fffd|
    cboGoodsID.DropDown
End Sub

Private Sub lstMeisai_Change()
    '|fffd|u|fffd|C|fffd||fffd||fffd|v|fffd|u|fffd||d3dc||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||317|L|fffd||fffd||fffd||fffd|
    btnUpdate.Enabled = True
    btnDelete.Enabled = True
End Sub

Private Sub txtGoodsPrice_AfterUpdate()
    '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z|fffd|@Module1|fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||102||fffd||fffd||fffd|
    MyCalc Me
End Sub

Private Sub txtGoodsPrice_Change()
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Sub txtQuantity_AfterUpdate()
    '|fffd||fffd||fffd|z|fffd||30c|v|fffd|Z|fffd|@Module1|fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||102||fffd||fffd||fffd|
    MyCalc Me
End Sub

Private Sub txtQuantity_Change()
    '|fffd|u|fffd||fffd||fffd||5cd|s|fffd||312||1c9||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||310||752||fffd|
    btnAdd.Enabled = CheckEntry()
End Sub

Private Function CheckEntry() As Boolean
    'Tag|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||310||752||80b3||fffd||fffd||102||fffd||fffd||fffd|S|fffd||102||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||242||82||fffd||fffd||fffd|
    '|fffd|l|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd|True|fffd|A|fffd||fffd||fffd||fffd||20a|O|fffd||fffd|False
    Dim ctrl As Control
    For Each ctrl In Me.Controls
        If ctrl.Tag <> "" Then
            If ctrl.Value = "" Then
                CheckEntry = False
                Exit Function
            End If
        End If
    Next
    CheckEntry = True
End Function

Private Sub UserForm_Initialize()
    '|fffd|e|fffd|{|fffd|^|fffd||fffd||fffd||316||fffd||fffd||fffd||fffd||fffd|
    btnAdd.Enabled = False
    btnUpdate.Enabled = False
    btnDelete.Enabled = False
    
    Dim i As Integer
    Dim LastRow As Integer
    'cboCustomerID|fffd|i|fffd||68b|qID|fffd|j|fffd||310||752||fffd|
    With cboCustomerID
        .Font.Size = 12
        .ColumnCount = 2
        .ColumnWidths = "30;150"
        .ListWidth = 180
        LastRow = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 8).Value <> 1 Then
                .AddItem Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Worksheets("|fffd||68b|q|fffd|}|fffd|X|fffd|^").Cells(i, 2).Value
            End If
        Next
    End With
    'cboGoodsID|fffd|i|fffd||fffd||fffd|iID|fffd|j|fffd||310||752||fffd|
    With cboGoodsID
        .Font.Size = 12
        .ColumnCount = 4
        .ColumnWidths = "30;150;0;0"
        .ListWidth = 180
        LastRow = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Range("A" & Rows.Count).End(xlUp).Row
        For i = 2 To LastRow
            If Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 8).Value <> 1 Then
                .AddItem Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 1).Value
                .List(.ListCount - 1, 1) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 2).Value
                .List(.ListCount - 1, 2) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 5).Value
                .List(.ListCount - 1, 3) = Worksheets("|fffd||fffd||fffd|i|fffd|}|fffd|X|fffd|^").Cells(i, 6).Value
            End If
        Next
    End With
    
    '|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    With lstMeisai
        .ColumnCount = 9
        .ColumnWidths = "0;36;150;72;54;42;72;62;72"
        .TextAlign = fmTextAlignRight
        .Font.Name = "|fffd|l|fffd|r |fffd|S|fffd|V|fffd|b|fffd|N"
    End With
    
    '|fffd|f|fffd|[|fffd|^|fffd||313||1c2||74d||fffd||fffd||fffd|
    With frmSalesSearch.lstInfo
        txtSlipNo.Text = .List(.ListIndex, 0)
        txtSlipDate.Text = .List(.ListIndex, 1)
        cboCustomerID.Text = .List(.ListIndex, 2)
        lblCustomerName.Caption = .List(.ListIndex, 3)
    End With
    With frmSalesSearch.lstInfoMeisai
        LastRow = .ListCount - 1
        For i = 0 To LastRow
            lstMeisai.AddItem .List(i, 0)
            lstMeisai.List(lstMeisai.ListCount - 1, 1) = .List(i, 1)
            lstMeisai.List(lstMeisai.ListCount - 1, 2) = .List(i, 2)
            lstMeisai.List(lstMeisai.ListCount - 1, 3) = .List(i, 3)
            lstMeisai.List(lstMeisai.ListCount - 1, 4) = .List(i, 4)
            lstMeisai.List(lstMeisai.ListCount - 1, 5) = .List(i, 5)
            lstMeisai.List(lstMeisai.ListCount - 1, 6) = .List(i, 6)
            lstMeisai.List(lstMeisai.ListCount - 1, 7) = .List(i, 7)
            lstMeisai.List(lstMeisai.ListCount - 1, 8) = .List(i, 8)
        Next
    End With
    '|fffd||fffd||fffd|v|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||255|\|fffd||fffd|(|fffd||fffd||fffd||fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd|j
    lblGoukeiKingaku.Caption = Format(GetGoukeiKingaku(8, lstMeisai), "#,##0")
End Sub

'|fffd||209||fffd||fffd||303|T|fffd|u|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||355|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||248||693||fffd||fffd||fffd||fffd||fffd||fffd||302||14d||d3dc||fffd||fffd||fffd||102||fffd||fffd||60a2|
'Private Sub MyCalc()
'    '|fffd||fffd||fffd|z|fffd|E|fffd||fffd||fffd||fffd||141|E|fffd||14d||fffd||fffd||fffd||fffd|z|fffd||30c|v|fffd|Z
'    Const taxRate As Integer = 8
'    '|fffd|P|fffd||fffd||fffd|E|fffd||fffd||fffd||283|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||d74c2||30f||a347||fffd||341|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|g|fffd||fffd||fffd|b|fffd|v|fffd||fffd||fffd||fffd|
'    On Error GoTo eh
'    Dim Kingaku As Long
'    Kingaku = txtGoodsPrice.Text * txtQuantity.Text
'    '|fffd|G|fffd||fffd||fffd|[|fffd||303|g|fffd||fffd||fffd|b|fffd|v|fffd|I|fffd||fffd|
'    On Error GoTo 0
'    '|fffd|e|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||252|l|fffd||fffd||fffd||fffd|
'    txtAmount.Text = Format(Kingaku, "#,##0")
'    txtTax.Text = Format(Kingaku * taxRate / 100, "#,##0")
'    txtSumWithTax.Text = Format(Kingaku * (1 + taxRate / 100), "#,##0")
'    Exit Sub
'eh:
'    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'End Sub




INQUEST-PP=macro
