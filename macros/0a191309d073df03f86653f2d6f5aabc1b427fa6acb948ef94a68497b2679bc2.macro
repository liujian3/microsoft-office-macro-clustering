Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Option Explicit
Public g_cot(1 To 15), g_kot(15), g_oz(15), g_ozi(15) As String
Public g_zh(15), g_hl(15), g_ot(15), g_zi(15), g_p(15), g_sp(15), g_sv(15), g_pro(15), g_proti(15), g_zdr(15), g_list(7) As String
'
'   obecn|fffd| konstanty
Public Const g_titulek As String = "Vyberte slo|fffd|ku a zadejte n|fffd|zev souboru k ulo|fffd|en|fffd|"
'   na listu "hlasov|fffd|n|fffd|"
Public Const g_z_p As String = "z_p|fffd||fffd|tomni", g_prit As String = "p|fffd||fffd|tomni", g_z_pi As String = "zam_prit"
Public Const g_mes01 As String = "z|fffd|mky aplikov|fffd|ny"
Public Const g_mes02 As String = "p|fffd||fffd|tomnosti u n|fffd|kter|fffd| ot|fffd|zky nen|fffd| nastavena - zobrazena chyba" & vbCrLf & "ot|fffd|zka nebude zamknuta opravte!!!"
Public Const g_mes03 As String = "nekompletn|fffd| vypln|fffd|n|fffd| hlasov|fffd|n|fffd| nelze zamknout !!!!"
Public Const g_var01 As String = "pro p|fffd|ehled p|fffd||fffd|tomn|fffd|ch nen|fffd| v z|fffd|mku uvedena hodnota ANO |fffd|i NE - opravte!!!"
Public Const g_var02_01 As String = "pro ot|fffd|zku |fffd|. ", g_var02_02 As String = " nen|fffd| v z|fffd|mku uvedena hodnota ANO |fffd|i NE - opravte!!!"
Public Const g_var03 As String = "p|fffd||fffd|tomnost nen|fffd| v |fffd|erven|fffd| podbarven|fffd|ch bu|fffd|k|fffd|ch nastavena " & vbCrLf & "opravte!!!"
Public Const g_mes_pocprit As String = "data pro po|fffd||fffd|te|fffd|n|fffd| p|fffd||fffd|tomnost jsou zamknuta" & vbCrLf & "odemkn|fffd|te z|fffd|mek"
Public Const g_mes_prit_01 As String = "data pro p|fffd||fffd|tomnost pro ot|fffd|zku |fffd|. "
Public Const g_mes_prit_02 As String = " jsou zamknuta" & vbCrLf & "odemkn|fffd|te z|fffd|mek"
Public Const g_mes_otazka As String = "data pro ot|fffd|zku jsou zamknuta" & vbCrLf & "odemkn|fffd|te z|fffd|mek"
'   na listu "ot|fffd|zky"
Public Const g_otazky_tisk As String = "otazky_tisk", g_ot_home As String = "ot_home"
'   na listech generov|fffd|n|fffd| pdf, nastaven|fffd| z|fffd|hlav|fffd| a z|fffd|pat|fffd|, v|fffd|choz|fffd| nastaven|fffd|
Public Const g_mes_listy As String = "  <-- list tohoto jm|fffd|na nebyl nalezen" & vbCrLf & "zpracov|fffd|n|fffd| bylo ukon|fffd|eno!!!"

'   na listu "nastaven|fffd| z|fffd|hlav|fffd| a z|fffd|pat|fffd|"
Public Const g_h_lh As String = "h_lh", g_h_lf As String = "h_lf"       '   list "hlasov|fffd|n|fffd|"
Public Const g_o_lh As String = "o_lh", g_o_lf As String = "o_lf"       '   list "ot|fffd|zky"
Public Const g_pl_lh As String = "pl_lh", g_pl_lf As String = "pl_lf"   '   list "prezen|fffd|n|fffd| listina"
Public Const g_vl_lh As String = "vl_lh", g_vl_lf As String = "vl_lf"   '   list "vlastn|fffd|ci k datu hlasov|fffd|n|fffd|"
Public Const g_si_lh As String = "si_lh", g_si_lf As String = "si_lf"   '   list "souhrnn|fffd| informace"
Public Const g_pi_lh As String = "pi_lh", g_pi_lf As String = "pi_lf"   '   list "podrobn|fffd| informace"
Public Const g_svj As String = "SVJ", g_dks As String = "DKS"           '   list "hlasovac|fffd| l|fffd|stek"
'
'   na listu "v|fffd|choz|fffd| nastaven|fffd|"
Public Const g_vn_mes00 As String = "potvr|fffd|te, |fffd|e pro v|fffd|echny ot|fffd|zky po|fffd|adujete " & vbCrLf & "- nakop|fffd|rovat p|fffd||fffd|tomnost podle p|fffd||fffd|tomnosti na za|fffd||fffd|tku shrom|fffd|d|fffd|n|fffd|" & vbCrLf & _
"- stejn|fffd| p|fffd|edvyplnit pro tyto ot|fffd|zky i hlasy PRO?" & vbCrLf & "- nastavit z|fffd|mky u v|fffd|ech ot|fffd|zek na ANO a ot|fffd|zky zamknout" & vbCrLf & "na listu ot|fffd|zky zamknout v|fffd|echny ot|fffd|zky"
Public Const g_vn_nav01 As String = "potvrzen|fffd| p|fffd|edvypln|fffd|n|fffd| hlasov|fffd|n|fffd| - 1. potvrzen|fffd| ze dvou"
Public Const g_vn_nav02 As String = "potvrzen|fffd| p|fffd|edvypln|fffd|n|fffd| hlasov|fffd|n|fffd| - 2. potvrzen|fffd| ze dvou"
Public Const g_vn_mes01_01 As String = "nastaven|fffd| p|fffd||fffd|tomnosti pro po|fffd|ad|fffd| |fffd||fffd|slo "
Public Const g_vn_mes01_02 As String = " mus|fffd| b|fffd|t 0 nebo 1" & vbCrLf & "opravte!!!"
Public Const g_vn_mes11 As String = "nakop|fffd|rov|fffd|no"

'   stavy
Public Const g_zam As String = "zamknuto", g_odem As String = "odemknuto"
Public Const g_list_zam As String = "list je zamknut", g_list_odem As String = "list je odemmknut"
Public Const g_mes_nastaveni As String = "nastaven|fffd| bylo provedeno"
Public Const g_ano As String = "ANO", g_ne As String = "NE"
Public Const g_1 As String = "1", g_0 As String = "0"
Public Const g_mes_range As String = "  <-- oblast tohoto jm|fffd|na nebyla nalezena" & vbCrLf & "zpracov|fffd|n|fffd| bylo ukon|fffd|eno!!!"

Private Sub ini()
'   napln|fffd|n|fffd| glob|fffd|ln|fffd|ch prom|fffd|nn|fffd|ch
'
'   n|fffd|zvy list|fffd|
g_list(1) = "ot|fffd|zky": g_list(2) = "souhrnn|fffd| informace": g_list(3) = "vlastn|fffd|ci k datu hlasov|fffd|n|fffd|": g_list(4) = "podrobn|fffd| informace"
g_list(5) = "prezen|fffd|n|fffd| listina": g_list(6) = "hlasovac|fffd| l|fffd|stek": g_list(7) = "hlasov|fffd|n|fffd|"
'
'   na listu "ot|fffd|zky" bu|fffd|ka s textem ot|fffd|zky
g_cot(1) = "cot_01": g_cot(2) = "cot_02": g_cot(3) = "cot_03": g_cot(4) = "cot_04": g_cot(5) = "cot_05"
g_cot(6) = "cot_06": g_cot(7) = "cot_07": g_cot(8) = "cot_08": g_cot(9) = "cot_09": g_cot(10) = "cot_10"
g_cot(11) = "cot_11": g_cot(12) = "cot_12": g_cot(13) = "cot_13": g_cot(14) = "cot_14": g_cot(15) = "cot_15"
'
'   na listu "ot|fffd|zky" bu|fffd|ka s textem kvora
g_kot(1) = "kot_01": g_kot(2) = "kot_02": g_kot(3) = "kot_03": g_kot(4) = "kot_04": g_kot(5) = "kot_05"
g_kot(6) = "kot_06": g_kot(7) = "kot_07": g_kot(8) = "kot_08": g_kot(9) = "kot_09": g_kot(10) = "kot_10"
g_kot(11) = "kot_11": g_kot(12) = "kot_12": g_kot(13) = "kot_13": g_kot(14) = "kot_14": g_kot(15) = "kot_15"
'
'   na listu "ot|fffd|zky" bu|fffd|ka z|fffd|mek
g_oz(1) = "oz_01": g_oz(2) = "oz_02": g_oz(3) = "oz_03": g_oz(4) = "oz_04": g_oz(5) = "oz_05"
g_oz(6) = "oz_06": g_oz(7) = "oz_07": g_oz(8) = "oz_08": g_oz(9) = "oz_09": g_oz(10) = "oz_10"
g_oz(11) = "oz_11": g_oz(12) = "oz_12": g_oz(13) = "oz_13": g_oz(14) = "oz_14": g_oz(15) = "oz_15"
'
'   na listu "ot|fffd|zky" bu|fffd|ka stav z|fffd|mku
g_ozi(1) = "ozi_01": g_ozi(2) = "ozi_02": g_ozi(3) = "ozi_03": g_ozi(4) = "ozi_04": g_ozi(5) = "ozi_05"
g_ozi(6) = "ozi_06": g_ozi(7) = "ozi_07": g_ozi(8) = "ozi_08": g_ozi(9) = "ozi_09": g_ozi(10) = "ozi_10"
g_ozi(11) = "ozi_11": g_ozi(12) = "ozi_12": g_ozi(13) = "ozi_13": g_ozi(14) = "ozi_14": g_ozi(15) = "ozi_15"
'
'   na listu "hlasov|fffd|n|fffd|" sloupec PRO
g_pro(1) = "pro_01": g_pro(2) = "pro_02": g_pro(3) = "pro_03": g_pro(4) = "pro_04": g_pro(5) = "pro_05"
g_pro(6) = "pro_06": g_pro(7) = "pro_07": g_pro(8) = "pro_08": g_pro(9) = "pro_09": g_pro(10) = "pro_10"
g_pro(11) = "pro_11": g_pro(12) = "pro_12": g_pro(13) = "pro_13": g_pro(14) = "pro_14": g_pro(15) = "pro_15"
'
'   na listu "hlasov|fffd|n|fffd|" sloupec PROTI
g_proti(1) = "proti_01": g_proti(2) = "proti_02": g_proti(3) = "proti_03": g_proti(4) = "proti_04": g_proti(5) = "proti_05"
g_proti(6) = "proti_06": g_proti(7) = "proti_07": g_proti(8) = "proti_08": g_proti(9) = "proti_09": g_proti(10) = "proti_10"
g_proti(11) = "proti_11": g_proti(12) = "proti_12": g_proti(13) = "proti_13": g_proti(14) = "proti_14": g_proti(15) = "proti_15"
'
'   na listu "hlasov|fffd|n|fffd|" sloupec ZDR|fffd|
g_zdr(1) = "zdr_01": g_zdr(2) = "zdr_02": g_zdr(3) = "zdr_03": g_zdr(4) = "zdr_04": g_zdr(5) = "zdr_05"
g_zdr(6) = "zdr_06": g_zdr(7) = "zdr_07": g_zdr(8) = "zdr_08": g_zdr(9) = "zdr_09": g_zdr(10) = "zdr_10"
g_zdr(11) = "zdr_11": g_zdr(12) = "zdr_12": g_zdr(13) = "zdr_13": g_zdr(14) = "zdr_14": g_zdr(15) = "zdr_15"
'
'   na listu "hlasov|fffd|n|fffd|" po|fffd|et p|fffd||fffd|tomn|fffd|ch
g_sp(1) = "sp_01": g_sp(2) = "sp_02": g_sp(3) = "sp_03": g_sp(4) = "sp_04": g_sp(5) = "sp_05"
g_sp(6) = "sp_06": g_sp(7) = "sp_07": g_sp(8) = "sp_08": g_sp(9) = "sp_09": g_sp(10) = "sp_10"
g_sp(11) = "sp_11": g_sp(12) = "sp_12": g_sp(13) = "sp_13": g_sp(14) = "sp_14": g_sp(15) = "sp_15"
'
'   na listu "hlasov|fffd|n|fffd|" po|fffd|et spr|fffd|vn|fffd| zadan|fffd|ch hlas|fffd|
g_sv(1) = "sv_01": g_sv(2) = "sv_02": g_sv(3) = "sv_03": g_sv(4) = "sv_04": g_sv(5) = "sv_05"
g_sv(6) = "sv_06": g_sv(7) = "sv_07": g_sv(8) = "sv_08": g_sv(9) = "sv_09": g_sv(10) = "sv_10"
g_sv(11) = "sv_11": g_sv(12) = "sv_12": g_sv(13) = "sv_13": g_sv(14) = "sv_14": g_sv(15) = "sv_15"
'
'   na listu "hlasov|fffd|n|fffd|" z|fffd|mek
g_zh(1) = "z_01": g_zh(2) = "z_02": g_zh(3) = "z_03": g_zh(4) = "z_04": g_zh(5) = "z_05"
g_zh(6) = "z_06": g_zh(7) = "z_07": g_zh(8) = "z_08": g_zh(9) = "z_09": g_zh(10) = "z_10"
g_zh(11) = "z_11": g_zh(12) = "z_12": g_zh(13) = "z_13": g_zh(14) = "z_14": g_zh(15) = "z_15"
'
'   na listu "hlasov|fffd|n|fffd|" stav z|fffd|mku
g_zi(1) = "zi_01": g_zi(2) = "zi_02": g_zi(3) = "zi_03": g_zi(4) = "zi_04": g_zi(5) = "zi_05"
g_zi(6) = "zi_06": g_zi(7) = "zi_07": g_zi(8) = "zi_08": g_zi(9) = "zi_09": g_zi(10) = "zi_10"
g_zi(11) = "zi_11": g_zi(12) = "zi_12": g_zi(13) = "zi_13": g_zi(14) = "zi_14": g_zi(15) = "zi_15"
'
'   na listu "hlasov|fffd|n|fffd|" text ot|fffd|zky
g_ot(1) = "ot_01": g_ot(2) = "ot_02": g_ot(3) = "ot_03": g_ot(4) = "ot_04": g_ot(5) = "ot_05"
g_ot(6) = "ot_06": g_ot(7) = "ot_07": g_ot(8) = "ot_08": g_ot(9) = "ot_09": g_ot(10) = "ot_10"
g_ot(11) = "ot_11": g_ot(12) = "ot_12": g_ot(13) = "ot_13": g_ot(14) = "ot_14": g_ot(15) = "ot_15"
'
'   na listu "hlasov|fffd|n|fffd|" pro ka|fffd|dou ot|fffd|zku sloupec p|fffd||fffd|tomnosti
g_p(1) = "p_01": g_p(2) = "p_02": g_p(3) = "p_03": g_p(4) = "p_04": g_p(5) = "p_05"
g_p(6) = "p_06": g_p(7) = "p_07": g_p(8) = "p_08": g_p(9) = "p_09": g_p(10) = "p_10"
g_p(11) = "p_11": g_p(12) = "p_12": g_p(13) = "p_13": g_p(14) = "p_14": g_p(15) = "p_15"
'
'   na listu "hlasov|fffd|n|fffd|" sloupce p|fffd||fffd|tomni, pro, proti, zdr|fffd|
g_hl(1) = "hlas01": g_hl(2) = "hlas02": g_hl(3) = "hlas03": g_hl(4) = "hlas04": g_hl(5) = "hlas05"
g_hl(6) = "hlas06": g_hl(7) = "hlas07": g_hl(8) = "hlas08": g_hl(9) = "hlas09": g_hl(10) = "hlas10"
g_hl(11) = "hlas11": g_hl(12) = "hlas12": g_hl(13) = "hlas13": g_hl(14) = "hlas14": g_hl(15) = "hlas15"
'
'   kontrola existence list|fffd|
    Call kontrola_existence_list|fffd|

'   kontrola existence pojmenovan|fffd|ch oblast|fffd|
    Call kontrola_existence_range

End Sub
Private Sub zamek_otazek()
Dim i, j, k As Integer
'
Call ini
For i = 1 To 15
    If (Range(g_oz(i)).Value <> g_ano And Range(g_oz(i)).Value <> g_ne) Then
        MsgBox g_var02_01 & i & g_var02_02
        Exit Sub
    End If
Next i
ActiveSheet.Unprotect
'
For i = 1 To 15
    If Range(g_oz(i)).Value = g_ne Then
        '   odemknout
        Range(g_cot(i)).Locked = False
        Range(g_kot(i)).Locked = False
        Range(g_ozi(i)).Value = g_odem
    Else:
        '   zamknout
        Range(g_cot(i)).Locked = True
        Range(g_kot(i)).Locked = True
        Range(g_ozi(i)).Value = g_zam
    End If
Next i
'
k = 0
For j = 15 To 1 Step -1
    If Len(Trim(Range(g_cot(j)).Value)) > 0 Then
        k = j
        Exit For
    End If
Next j
'
ActiveSheet.PageSetup.PrintArea = Range(g_otazky_tisk).Cells(1, 1).Address & ":" & Range(g_otazky_tisk).Cells(2 + k, 5).Address
Range(g_ot_home).Select
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
'
End Sub
Private Sub z|fffd|mek()
'   z|fffd|mkne oblasti podle zadan|fffd|ch z|fffd|mk|fffd|
Dim pr_s, mes01, mes02, mes03 As String
Dim m_row, m_col As Long
Dim i, j, iot, pocet, iprot As Integer
Dim vypl As Boolean
'
Call ini
mes01 = g_mes01: mes02 = "": mes03 = ""
iprot = 0
'
If (Range(g_z_p).Value <> g_ano And Range(g_z_p).Value <> g_ne) Then
     MsgBox g_var01
        Exit Sub
End If
'
For i = 1 To 15
    If (Range(g_zh(i)).Value <> g_ano And Range(g_zh(i)).Value <> g_ne) Then
        MsgBox g_var02_01 & i & g_var02_02
        Exit Sub
    End If
Next i
'
pocet = Range(g_prit).Rows.Count
For i = 1 To pocet
    pr_s = CStr(Range(g_prit).Cells(i, 1).Value)
    If (pr_s <> g_1 And pr_s <> g_0) Then
        MsgBox g_var03
        Exit Sub
    End If
Next i
'
Application.ScreenUpdating = False
ActiveSheet.Unprotect
'
'   o|fffd|et|fffd|en|fffd| p|fffd||fffd|tomnosti pro usn|fffd|en|fffd|schopnost
'
If Range(g_z_p).Value = g_ne Then
        Range(g_prit).Locked = False
        Range(g_z_pi).Value = g_odem
        Call prit_format(g_prit, iprot)
    Else
        Call prit_format(g_prit, iprot)
        Range(g_prit).Locked = True
        Range(g_z_pi).Value = g_zam
End If
'
'   o|fffd|et|fffd|en|fffd| jednotliv|fffd|ch blok|fffd| ot|fffd|zek
'
m_col = Range(g_z_p).Column
ActiveSheet.Unprotect
For i = 1 To 15
    If Range(g_zh(i)).Value = g_ne Then
        '   odemknout
        Range(g_hl(i)).Locked = False
        Range(g_zi(i)).Value = g_odem
    End If
    '
    If Range(g_zh(i)).Value = g_ano And Range(g_zi(i)).Value = g_odem Then
        '   zamknout
        If Len(Range(g_ot(i)).Value) = 0 Then     '   vy|fffd|ist|fffd| data v oblasti, kde nen|fffd| zadan|fffd| ot|fffd|zka
            Range(g_hl(i)).ClearContents
            Range(g_p(i)).Value = Range(g_prit).Value
            Call prit_format(g_p(i), iprot)
            Call pro_format(g_pro(i), g_p(i), iprot)
            Call proti_format(g_proti(i), g_p(i), iprot)
            Call zdr_format(g_zdr(i), g_p(i), iprot)
            Range(g_hl(i)).Locked = True
            Range(g_zi(i)).Value = g_zam
        Else                                    '   nenulov|fffd| d|fffd|lka ot|fffd|zky, uzamkne pouze pokud je kompletn|fffd| vypln|fffd|n|fffd| nebo kompletn|fffd| vymazan|fffd|
            vypl = False
            For j = 1 To pocet                  '   vy|fffd|i|fffd|t|fffd|n|fffd| oblast
                If Len(Range(g_pro(i)).Cells(j, 1).Value) > 0 Or Len(Range(g_proti(i)).Cells(j, 1).Value) > 0 Or Len(Range(g_zdr(i)).Cells(j, 1).Value) > 0 Then
                    vypl = True
                    Exit For
                End If
            Next j
            '
            If Len(mes02) = 0 Then
                For iot = 1 To pocet    '   p|fffd||fffd|tomnost nen|fffd| 0 nebo 1
                    pr_s = CStr(Range(g_p(i)).Cells(iot, 1).Value)
                    If (pr_s <> g_1 And pr_s <> g_0) Then
                        mes02 = g_mes02
                        Calculate
                        Exit For
                    End If
                Next iot
            End If
            '
            If Range(g_sp(i)).Value = Range(g_sv(i)).Value Then
                Call prit_format(g_p(i), iprot)
                Call pro_format(g_pro(i), g_p(i), iprot)
                Call proti_format(g_proti(i), g_p(i), iprot)
                Call zdr_format(g_zdr(i), g_p(i), iprot)
                Range(g_hl(i)).Locked = True
                Range(g_zi(i)).Value = g_zam
            Else                                '   nekompletn|fffd| zadan|fffd| hlasov|fffd|n|fffd|
                If vypl = False Then            '   pokud je hlasov|fffd|n|fffd| vy|fffd|i|fffd|t|fffd|n|fffd|, pak zamkne
                    Call prit_format(g_p(i), iprot)
                    Call pro_format(g_pro(i), g_p(i), iprot)
                    Call proti_format(g_proti(i), g_p(i), iprot)
                    Call zdr_format(g_zdr(i), g_p(i), iprot)
                    Range(g_hl(i)).Locked = True
                    Range(g_zi(i)).Value = g_zam
                Else
                    mes03 = g_mes03
                End If
            End If
        End If
    End If
Next i
'
'   na|fffd|ten|fffd| prav|fffd|ho doln|fffd|ho konce tiskov|fffd| oblasti pro posledn|fffd|ho vlastn|fffd|ka (|fffd||fffd|dek) a posledn|fffd| ot|fffd|zku (sloupec) - nastaven|fffd| oblasti tisku
'
For i = 1 To 15
    If Len(Trim(Range(g_ot(i)).Value)) > 0 Then m_col = Range(g_zh(i)).Column
Next i
m_row = Range(g_prit).Cells(Range(g_prit).Rows.Count, 1).Row

ActiveSheet.PageSetup.PrintArea = Range(Cells(1, 1), Cells(m_row, m_col)).Address

ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
Application.ScreenUpdating = True
MsgBox mes01 & vbCrLf & mes02 & vbCrLf & mes03
'
End Sub
Private Sub p|fffd|edvypln|fffd|n|fffd|()
'   p|fffd|edvypln|fffd| v|fffd|choz|fffd| nastaven|fffd|
Dim zprava, pr_s, navesti As String
Dim i, j, k, iot As Integer
Dim ans, config, m_row, m_col, pocet_bytu As Long
'
iot = 0
Call ini
'
'   hlasov|fffd|n|fffd|
Sheets(g_list(7)).Select
pocet_bytu = Range(g_prit).Rows.Count
For i = 1 To pocet_bytu
    pr_s = CStr(Range(g_prit).Cells(i, 1).Value)
    If (pr_s <> g_1 And pr_s <> g_0) Then
        MsgBox g_vn_mes01_01 & i & g_vn_mes01_02
        Exit Sub
    End If
Next i
'
zprava = g_vn_mes00
navesti = g_vn_nav01
config = vbYesNo + vbDefaultButton2
ans = MsgBox(zprava, config, navesti)
On Error Resume Next
If ans = vbNo Then Exit Sub
'
navesti = g_vn_nav02
config = vbYesNo + vbDefaultButton2
ans = MsgBox(zprava, config, navesti)
On Error Resume Next
If ans = vbNo Then Exit Sub
'
Application.ScreenUpdating = False
Sheets(g_list(7)).Unprotect
'   v|fffd|choz|fffd| p|fffd||fffd|tomnost
    Range(g_z_p).Value = g_ano
    Range(g_prit).Locked = False
    Call prit_format(g_prit, iot)
    Range(g_prit).Locked = True
    Range(g_z_pi).Value = g_zam
'   jednotliv|fffd| ot|fffd|zky
    For i = 1 To 15
        Range(g_hl(i)).Locked = False
        Range(g_hl(i)).ClearContents
        Range(g_p(i)).Value = Range(g_prit).Value
        Call prit_format(g_p(i), iot)
        Call pro_format(g_pro(i), g_p(i), iot)
        Call proti_format(g_proti(i), g_p(i), iot)
        Call zdr_format(g_zdr(i), g_p(i), iot)
        Range(g_zh(i)).Value = g_ano
        Range(g_hl(i)).Locked = True
        Range(g_zi(i)).Value = g_zam
    Next i

'   nastaven|fffd| tiskov|fffd| oblasti
For i = 1 To 15
    If Len(Trim(Range(g_ot(i)).Value)) > 0 Then m_col = Range(g_zh(i)).Column
Next i
m_row = Range(g_prit).Cells(Range(g_prit).Rows.Count, 1).Row

Worksheets(g_list(7)).PageSetup.PrintArea = Range(Cells(1, 1), Cells(m_row, m_col)).Address
'
Sheets(g_list(7)).Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
'   list ot|fffd|zek
Sheets(g_list(1)).Unprotect
'
For i = 1 To 15
    Range(g_oz(i)).Value = g_ano
    Range(g_cot(i)).Locked = True
    Range(g_kot(i)).Locked = True
    Range(g_ozi(i)).Value = g_zam
Next i
'
k = 0
For j = 15 To 1 Step -1
    If Len(Trim(Range(g_cot(j)).Value)) > 0 Then
        k = j
        Exit For
    End If
Next j
'
Worksheets(g_list(1)).PageSetup.PrintArea = Range(g_otazky_tisk).Cells(1, 1).Address & ":" & Range(g_otazky_tisk).Cells(2 + k, 5).Address
Range(g_oz(1)).Select
Sheets(g_list(1)).Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
'
Application.ScreenUpdating = True
MsgBox g_vn_mes11
End Sub
Private Sub nastaven|fffd|_z|fffd|hlav|fffd|_a_z|fffd|pat|fffd|()
'
Call ini
    
    '
    With Worksheets(g_list(1)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_o_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_o_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    With Worksheets(g_list(7)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_h_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_h_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    With Worksheets(g_list(5)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_pl_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_pl_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    With Worksheets(g_list(2)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_si_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_si_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    With Worksheets(g_list(4)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_pi_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_pi_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    With Worksheets(g_list(3)).PageSetup
        .LeftHeader = "&""Times New Roman,Tu|fffd|n|fffd|""&14" & Range(g_vl_lh).Value
        .CenterHeader = ""
        .RightHeader = "&""Times New Roman""&12 Str|fffd|nka &P z &N"
        .LeftFooter = "&""Times New Roman""&14" & Range(g_vl_lf).Value
        .CenterFooter = ""
        .RightFooter = "&""Times New Roman""&12 &D/&T"
    End With
    '
    MsgBox g_mes_nastaveni
End Sub
Private Sub hlasovaci_listky_format()
Dim hom As String
Dim i, imax, j, ip As Long
'
Call ini
imax = 60000
j = 6
hom = "A1"
Application.ScreenUpdating = False
ActiveSheet.Unprotect
With ActiveSheet
    For i = 1 To imax
        ip = i - 1
        If .Cells(i, j).Value = 0 Then Exit For
        Rows(i).RowHeight = .Cells(i, j).Value
    Next i
    Cells.Select
    Selection.EntireRow.Hidden = False
    Range(hom).Select
    .PageSetup.PrintArea = "$A$1:$d$" & ip
End With

ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
Application.ScreenUpdating = True
MsgBox g_mes_nastaveni
End Sub
Private Sub tlprit_00()
'   tla|fffd||fffd|tko p|fffd|edvypln|fffd|n|fffd| po|fffd||fffd|te|fffd|n|fffd| p|fffd||fffd|tomnosti
Dim p_zdroj, text As String
Dim iot As Integer
iot = 99
Call ini
text = g_mes_pocprit
p_zdroj = g_prit
'
If Range(p_zdroj).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_zdroj, iot)
    Range(p_zdroj).Value = 1
Application.ScreenUpdating = True

End Sub

Private Sub tlprit_01()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti pro ot|fffd|zku |fffd|. 1
Dim p_c|fffd|l, p_zdroj, tot, pritom, text, p As String
Dim iot As Integer
Call ini
iot = 1
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_prit
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_02()
'
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
'
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 2
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_03()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 3
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_04()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 4
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_05()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 5
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_06()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 6
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_07()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 7
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_08()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 8
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_09()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 9
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_10()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 10
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_11()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 11
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_12()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 12
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_13()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 13
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_14()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 14
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlprit_15()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti z ot|fffd|zky ot_zdroj do ot|fffd|zky ot_cil
Dim p_c|fffd|l, p_zdroj, text As String
Dim iot As Integer
Call ini
iot = 15
text = g_mes_prit_01 & CStr(iot) & g_mes_prit_02
p_zdroj = g_p(iot - 1)
p_c|fffd|l = g_p(iot)
'
If Range(p_c|fffd|l).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Call prit_format(p_c|fffd|l, iot)
    Range(p_c|fffd|l).Value = Range(p_zdroj).Value
Application.ScreenUpdating = True
End Sub
Private Sub tlpro_01()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 1
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i
    
Application.ScreenUpdating = True
End Sub
Private Sub tlproti_01()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 1
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_01()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 1
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_02()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 2
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

    
Application.ScreenUpdating = True
End Sub
Private Sub tlproti_02()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 2
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

    
Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_02()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 2
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_03()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 3
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_03()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 3
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_03()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 3
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_04()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 4
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_04()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 4
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_04()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 4
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_05()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 5
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_05()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 5
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_05()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 5
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_06()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 6
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_06()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 6
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_06()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 6
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_07()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 7
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_07()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 7
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_07()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 7
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_08()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 8
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_08()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 8
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_08()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 8
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_09()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 9
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_09()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 9
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_09()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 9
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_10()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 10
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_10()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 10
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_10()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 10
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_11()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 11
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_11()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 11
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_11()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 11
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_12()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 12
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_12()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 12
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_12()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 12
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_13()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 13
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_13()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 13
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_13()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 13
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_14()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 14
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_14()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 14
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_14()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 14
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlpro_15()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PRO
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 15
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(pro).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(zdr).Value = ""
    Call pro_format(pro, g_p(iot), iot)
    Range(pro).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(pro).Cells(i, 1).Value = 0 Then Range(pro).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlproti_15()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce PROTI
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 15
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(proti).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(pro).Value = ""
    Range(zdr).Value = ""
    Call proti_format(proti, g_p(iot), iot)
    Range(proti).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(proti).Cells(i, 1).Value = 0 Then Range(proti).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub tlzdr_15()
'   tla|fffd||fffd|tko nakop|fffd|rov|fffd|n|fffd| p|fffd||fffd|tomnosti v ot|fffd|zce do sloupce ZDR
Dim pro, proti, zdr, p, text As String
Dim i, pocet, iot As Integer
Call ini
text = g_mes_otazka
iot = 15
pro = g_pro(iot): proti = g_proti(iot): zdr = g_zdr(iot): p = g_p(iot)
'
If Range(zdr).Locked = True Then
    MsgBox text
    Exit Sub
End If
'
Application.ScreenUpdating = False
    Range(proti).Value = ""
    Range(pro).Value = ""
    Call zdr_format(zdr, g_p(iot), iot)
    Range(zdr).Value = Range(p).Value
    
    pocet = Range(p).Rows.Count
    For i = 1 To pocet
        If Range(zdr).Cells(i, 1).Value = 0 Then Range(zdr).Cells(i, 1).ClearContents
    Next i

Application.ScreenUpdating = True
End Sub
Private Sub pdf_protokol()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev, myarray(3) As String
Dim mujsoubor As Variant
Call ini
myarray(0) = g_list(1): myarray(1) = g_list(2): myarray(2) = g_list(3): myarray(3) = g_list(4)

Application.ScreenUpdating = False
Set wsA = ActiveSheet

'Sheets(Array("ot|fffd|zky", "souhrnn|fffd| informace", "vlastn|fffd|ci k datu hlasov|fffd|n|fffd|", "podrobn|fffd| informace")).Select
Sheets(myarray()).Select
Sheets(g_list(1)).Activate
Set wsB = ActiveSheet

soubor = "protokol"
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_prezencni_listina()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(5)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_hlasovaci_listek()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(6)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_otazky()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(1)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_souhrn()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(2)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_detail()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(4)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_vlastnici()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(3)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub pdf_hlasovani()
Dim wsA, wsB As Worksheet
Dim soubor, soubor_nazev As String
Dim mujsoubor As Variant
Call ini
soubor = g_list(7)
Application.ScreenUpdating = False
Set wsA = ActiveSheet
Sheets(soubor).Select
Set wsB = ActiveSheet
soubor_nazev = soubor & ".pdf"

mujsoubor = Application.GetSaveAsFilename _
    (InitialFileName:=soubor_nazev, FileFilter:="PDF Files (*.pdf), *.pdf", Title:=g_titulek)

'export do PDF
If mujsoubor <> "False" Then
    wsB.ExportAsFixedFormat _
        Type:=xlTypePDF, _
        Filename:=mujsoubor, _
        Quality:=xlQualityStandard, _
        IncludeDocProperties:=True, _
        IgnorePrintAreas:=False, _
        OpenAfterPublish:=False
End If

wsA.Select
Application.ScreenUpdating = True

End Sub
Private Sub prit_format(p, i)
'   nastaven|fffd| form|fffd|tov|fffd|n|fffd| sloupce p|fffd||fffd|tomnost (pozad|fffd| 204,204,255 a chyba 255,0,0 a ohrani|fffd|en|fffd|)
'   pouze jeden parametr, proto|fffd|e bu|fffd|ka ve vzorci je ze stejn|fffd|ho sloupce
'
If i > 0 Then ActiveSheet.Unprotect
    Range(p).Select
    Selection.FormatConditions.Delete
    Range(p).Cells(1, 1).Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="D|fffd|LKA=(" & Range(p).Cells(1, 1).Address(rowabsolute:=False, columnabsolute:=False) & ")"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 0, 0)
        .TintAndShade = 0
    End With
    
    Range(p).Cells(1, 1).Select
    Selection.Copy
    Range(p).Select
    Selection.PasteSpecial Paste:=xlPasteFormats
    
    Range(p).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = RGB(204, 204, 255)
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
If i > 0 Then ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True

End Sub
Private Sub pro_format(p, prit, i)
'   nastaven|fffd| form|fffd|tov|fffd|n|fffd| sloupce pro - oblast "p" (b|fffd|l|fffd| pozad|fffd| 255,255,255 a hn|fffd|d|fffd| pozad|fffd| pro p|fffd||fffd|tomnost 255,204,153 a ohrani|fffd|en|fffd|)
'   dva parametr, proto|fffd|e bu|fffd|ka ve vzorci je z sloupce p|fffd||fffd|tomnost
'
If i > 0 Then ActiveSheet.Unprotect
    Range(p).Select
    Selection.FormatConditions.Delete
    Range(p).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 255, 255)
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range(p).Cells(1, 1).Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=" & Range(prit).Cells(1, 1).Address(rowabsolute:=False, columnabsolute:=False) & "= 1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 204, 153)
        .TintAndShade = 0
    End With
    
    Range(p).Cells(1, 1).Select
    Selection.Copy
    Range(p).Select
    Selection.PasteSpecial Paste:=xlPasteFormats
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With

If i > 0 Then ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True

End Sub
Private Sub proti_format(p, prit, i)
'   nastaven|fffd| form|fffd|tov|fffd|n|fffd| sloupce proti - oblast "p" (b|fffd|l|fffd| pozad|fffd| 255,255,255 a hn|fffd|d|fffd| pozad|fffd| pro p|fffd||fffd|tomnost 255,204,153 a ohrani|fffd|en|fffd|)
'   dva parametr, proto|fffd|e bu|fffd|ka ve vzorci je z sloupce p|fffd||fffd|tomnost
'
If i > 0 Then ActiveSheet.Unprotect
    Range(p).Select
    Selection.FormatConditions.Delete
    Range(p).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 255, 255)
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range(p).Cells(1, 1).Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=" & Range(prit).Cells(1, 1).Address(rowabsolute:=False, columnabsolute:=False) & "= 1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 204, 153)
        .TintAndShade = 0
    End With
    
    Range(p).Cells(1, 1).Select
    Selection.Copy
    Range(p).Select
    Selection.PasteSpecial Paste:=xlPasteFormats
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
If i > 0 Then ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True

End Sub
Private Sub zdr_format(p, prit, i)
'   nastaven|fffd| form|fffd|tov|fffd|n|fffd| sloupce zdr - oblast "p" (b|fffd|l|fffd| pozad|fffd| 255,255,255 a hn|fffd|d|fffd| pozad|fffd| pro p|fffd||fffd|tomnost 255,204,153 a ohrani|fffd|en|fffd|)
'   dva parametr, proto|fffd|e bu|fffd|ka ve vzorci je z sloupce p|fffd||fffd|tomnost
'
If i > 0 Then ActiveSheet.Unprotect
    Range(p).Select
    Selection.FormatConditions.Delete
    Range(p).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 255, 255)
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range(p).Cells(1, 1).Select
    
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=" & Range(prit).Cells(1, 1).Address(rowabsolute:=False, columnabsolute:=False) & "= 1"
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = RGB(255, 204, 153)
        .TintAndShade = 0
    End With
    
    Range(p).Cells(1, 1).Select
    Selection.Copy
    Range(p).Select
    Selection.PasteSpecial Paste:=xlPasteFormats
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDot
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
If i > 0 Then ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True

End Sub
Private Sub list_prot()
'   podle statusu odemkne aktivn|fffd| list, pokud je zamknut a zamkne aktivn|fffd| list, pokud je odemknut
If ActiveSheet.ProtectContents = True Then
    ActiveSheet.Unprotect
    MsgBox g_list_odem
Else
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
    MsgBox g_list_zam
End If

End Sub
Private Sub kontrola_existence_list|fffd|()
Dim temp, l_name As String
'   kontrola existence list|fffd|
On Error GoTo chyba
    l_name = g_list(1)
    temp = Worksheets(l_name).Name
    l_name = g_list(2)
    temp = Worksheets(l_name).Name
    l_name = g_list(3)
    temp = Worksheets(l_name).Name
    l_name = g_list(4)
    temp = Worksheets(l_name).Name
    l_name = g_list(5)
    temp = Worksheets(l_name).Name
    l_name = g_list(6)
    temp = Worksheets(l_name).Name
    l_name = g_list(7)
    temp = Worksheets(l_name).Name
Exit Sub
chyba:
    Err.Clear
    MsgBox l_name & g_mes_listy
    End
End Sub
Private Sub kontrola_existence_range()
Dim i As Integer
Dim r_n As String
Dim rngtest As Range

'   kontrola existence pojmenovan|fffd|ch oblast|fffd|
On Error GoTo chyba
    For i = 1 To 15
        r_n = g_cot(i)
        Set rngtest = Range(r_n)
        r_n = g_kot(i)
        Set rngtest = Range(r_n)
        r_n = g_oz(i)
        Set rngtest = Range(r_n)
        r_n = g_ozi(i)
        Set rngtest = Range(r_n)
        r_n = g_zh(i)
        Set rngtest = Range(r_n)
        r_n = g_hl(i)
        Set rngtest = Range(r_n)
        r_n = g_ot(i)
        Set rngtest = Range(r_n)
        r_n = g_zi(i)
        Set rngtest = Range(r_n)
        r_n = g_p(i)
        Set rngtest = Range(r_n)
        r_n = g_sp(i)
        Set rngtest = Range(r_n)
        r_n = g_sv(i)
        Set rngtest = Range(r_n)
        r_n = g_pro(i)
        Set rngtest = Range(r_n)
        r_n = g_proti(i)
        Set rngtest = Range(r_n)
        r_n = g_zdr(i)
        Set rngtest = Range(r_n)
    Next i
    r_n = g_ot_home
    Set rngtest = Range(r_n)
    r_n = g_h_lh
    Set rngtest = Range(r_n)
    r_n = g_h_lf
    Set rngtest = Range(r_n)
    r_n = g_o_lh
    Set rngtest = Range(r_n)
    r_n = g_o_lf
    Set rngtest = Range(r_n)
    r_n = g_pl_lh
    Set rngtest = Range(r_n)
    r_n = g_pl_lf
    Set rngtest = Range(r_n)
    r_n = g_vl_lh
    Set rngtest = Range(r_n)
    r_n = g_vl_lf
    Set rngtest = Range(r_n)
    r_n = g_si_lh
    Set rngtest = Range(r_n)
    r_n = g_si_lf
    Set rngtest = Range(r_n)
    r_n = g_pi_lh
    Set rngtest = Range(r_n)
    r_n = g_pi_lf
    Set rngtest = Range(r_n)
    r_n = g_svj
    Set rngtest = Range(r_n)
    r_n = g_dks
    Set rngtest = Range(r_n)
Exit Sub
chyba:
    Err.Clear
    MsgBox r_n & g_mes_range
    End
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
