Attribute VB_Name = "AttachedFile"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'---------------------------------------------------------------------------------------
' Class Module      : AttachedFile
' |fffd||fffd||fffd||fffd||fffd|     : EducatedFool  (|fffd||fffd||fffd||fffd||fffd|)                    |fffd||fffd||fffd||fffd|: 19.08.2012
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Microsoft Excel
' http://ExcelVBA.ru/          ICQ: 5836318           Skype: ExcelVBA.ru
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: http://ExcelVBA.ru/payments
'---------------------------------------------------------------------------------------

Public filename As String    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Public AttachDate As Date    ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Public FileSize As Long    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Public FileRange As Range    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Public Parent As AttachedFiles
Const BYTES_PER_CELL& = 500


Sub Run()
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    On Error Resume Next
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    tmpPath$ = Environ("temp") & "\" & filename
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd|
    If Me.SaveAs(tmpPath$) Then CreateObject("wscript.shell").Run """" & tmpPath$ & """"
End Sub


Function IsCorrect() As Boolean
    On Error Resume Next: Err.Clear
    If FileRange Is Nothing Then Exit Function
    txt$ = Range2Text(GetDataRange.Value)
    If Len(txt) = 0 Then Exit Function
    IsCorrect = FileSize = (Len(txt) / 2)
End Function

Function SaveAs(Optional ByVal filepath$) As Boolean
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| TRUE, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    On Error Resume Next: Err.Clear
    If filepath$ = "" Then    ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        Title = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & filename & "|fffd|"
        InitialFileName = Me.Parent.WB.Path & "\" & filename
        DialogResult = Application.GetSaveAsFilename(InitialFileName, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (*.*),", , Title, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        If VarType(DialogResult) = vbBoolean Then Exit Function
        filepath$ = DialogResult
    End If


    If FileRange Is Nothing Then Exit Function

    status_text$ = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & filename & "|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & Parent.WB.Name & "|fffd|"
    If Not SilentMode Then Application.StatusBar = status_text$

    txt$ = Range2Text(GetDataRange.Value)
    If Len(txt) = 0 Then Exit Function

    status_text$ = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & filename & "|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & Parent.WB.Name & "|fffd|"
    If Not SilentMode Then Application.StatusBar = status_text$

    buffer$ = "": buffer2$ = "": Const BufferLen& = 5000: t = Timer
    For i = 1 To Len(txt) / 2
        letter& = Val("&H" & Mid(txt, 2 * i - 1, 2))
        buffer$ = buffer$ & Chr(letter&)
        If Len(buffer$) > BufferLen& Then
            buffer2$ = buffer2$ & buffer$: buffer$ = "": DoEvents

            If Len(buffer2$) > BufferLen& * 10 Then
                res$ = res$ & buffer2$: buffer2$ = ""
                Percent = Format(Len(res$) / (Len(txt) / 2) * 100, "##") & " %"
                If Not SilentMode Then Application.StatusBar = status_text$ & ": |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Percent & "   (" & _
                   Format(Len(res$) / 1000, "# ###") & _
                   " |fffd||fffd| |fffd||fffd| " & Format((Len(txt) / 2), "# ### ###") & " |fffd||fffd|)" & _
                   " |fffd||fffd| " & Format(Timer - t, "0.0") & " |fffd||fffd||fffd||fffd||fffd||fffd|"
                DoEvents
            End If
        End If
    Next
    res$ = res$ & buffer2$ & buffer$
    If Not SilentMode Then Debug.Print "BufferLen = " & BufferLen& & ", Done in " & Format(Timer - t, "0.0") & " |fffd||fffd||fffd||fffd||fffd||fffd|"

    If Not SilentMode Then Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| " & filepath$
    ff& = FreeFile
    Open filepath$ For Binary Access Write As #ff
    Put #ff, , res$
    Close #ff
    If Not SilentMode Then Application.StatusBar = False
    SaveAs = Err = 0
End Function

Private Function Range2Text(ByRef arr) As String
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Arr |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|,
    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| buffer$ |fffd| buffer2$
    ' On Error Resume Next
    buffer$ = "": buffer2$ = "": Const BufferLen& = 50000: rc& = UBound(arr): t = Timer
    On Error Resume Next: Err.Clear
    For i = LBound(arr) To UBound(arr)
        buffer$ = buffer$ & arr(i, 1)
        If Len(buffer$) > BufferLen& Then
            buffer2$ = buffer2$ & buffer$: buffer$ = ""
            If Len(buffer2$) > BufferLen& * 25 Then
                Range2Text = Range2Text & buffer2$: buffer2$ = "": DoEvents
            End If
        End If
        n& = n& + 1
        If n = 2000 Then
            Percent = Format(i / rc& * 100, "##") & " %"
            If Not SilentMode Then Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Percent & "   (" & _
               i & " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & rc& & _
               ") |fffd||fffd| " & Format(Timer - t, "0.0") & " |fffd||fffd||fffd||fffd||fffd||fffd|"
            n = 0: DoEvents
        End If
    Next i
    Range2Text = Range2Text & buffer2$ & buffer$
    ' Debug.Print "BufferLen = " & BufferLen& & ", Done in " & Format(Timer - t, "0.0") & " |fffd||fffd||fffd||fffd||fffd||fffd|"
    If Not SilentMode Then Application.StatusBar = False
End Function

Sub Delete()
    On Error Resume Next
    Me.FileRange.EntireColumn.Delete
    If Me.Parent.AutoSaveWorkbook Then Me.Parent.WB.Save
End Sub

Function LoadFileData(ByVal filepath$) As Boolean
    On Error Resume Next: Err.Clear
    If FileRange Is Nothing Then Exit Function
    FileRange.Cells(2).Resize(5).ClearContents
    'FileRange.Cells(1) = dir(filepath$)
    FileRange.Cells(2) = Now
    FileRange.Cells(3) = FileLen(filepath$)

    arr = FileToArray(filepath$)
    If Not IsArray(arr) Then Exit Function

    With GetDataRange
        .ClearContents
        .Cells(1).Resize(UBound(arr), 1).Value = arr
    End With
    LoadFileData = Err = 0
End Function

Function FileSizeTXT() As String
    On Error Resume Next
    FileSizeTXT = Me.Parent.FileOrFolderSize(Me.FileSize)
End Function


Private Function FileToArray(ByVal filename$) As Variant
    On Error Resume Next: Err.Clear
    ff& = FreeFile
    Open filename$ For Binary Access Read As #ff
    fs& = LOF(ff)
    txt$ = String(fs&, Chr(0))
    Get #ff, , txt$
    Close #ff

    rc& = Application.RoundUp(fs& / BYTES_PER_CELL&, 0)
    ReDim arr(1 To rc&, 1 To 1): Dim n&: t = Timer

    status_text$ = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & Dir(filename$) & "|fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & Parent.WB.Name & "|fffd|"
    If Not SilentMode Then Application.StatusBar = status_text$
    For i = 1 To Len(txt$)
        r& = Asc(Mid(txt, i, 1))
        res$ = res$ & IIf(Len(Hex(r)) = 1, "0", "") & Hex(r)
        If i Mod BYTES_PER_CELL& = 0 Then
            arr(i / BYTES_PER_CELL&, 1) = "'" & res
            res = "": n = n + 1: DoEvents
            If n Mod 200 = 0 Then
                Percent = Format(n * BYTES_PER_CELL& / fs& * 100, "##") & " %"
                If Not SilentMode Then Application.StatusBar = status_text$ & ": |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Percent & "   (" & _
                   Format(n * BYTES_PER_CELL& / 1000, "# ###") & _
                   " |fffd||fffd| |fffd||fffd| " & Format(fs& / 1000, "# ### ###") & " |fffd||fffd|)" & _
                   " |fffd||fffd| " & Format(Timer - t, "0.0") & " |fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
        End If
    Next
    If Len(res) Then arr(rc&, 1) = "'" & res
    If Not SilentMode Then Application.StatusBar = False
    If Err = 0 Then FileToArray = arr
End Function

Private Function GetDataRange() As Range
    On Error Resume Next: Err.Clear
    Set GetDataRange = Intersect(FileRange.Worksheet.Range("7:" & FileRange.Worksheet.Rows.Count), _
                                 FileRange.EntireColumn, FileRange.Worksheet.UsedRange)
    If Err <> 0 Then Set GetDataRange = Nothing
    If GetDataRange Is Nothing Then Set GetDataRange = FileRange.EntireColumn.Cells(7): Exit Function
    If GetDataRange.Row < 7 Then Set GetDataRange = FileRange.EntireColumn.Cells(7)
End Function

Attribute VB_Name = "AttachedFiles"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'---------------------------------------------------------------------------------------
' Class Module      : AttachedFiles
' |fffd||fffd||fffd||fffd||fffd|     : EducatedFool  (|fffd||fffd||fffd||fffd||fffd|)                    |fffd||fffd||fffd||fffd|: 19.08.2012
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Microsoft Excel
' http://ExcelVBA.ru/          ICQ: 5836318           Skype: ExcelVBA.ru
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: http://ExcelVBA.ru/payments
'---------------------------------------------------------------------------------------

Public WB As Workbook    ' |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Public AutoSaveWorkbook As Boolean
Public SilentMode As Boolean    ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd|.|fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Private Const FILES_SHEET_NAME$ = "SheetForAttachedFiles"
Private Const BYTES_PER_CELL& = 500

Private Sub Class_Initialize()
    Set WB = ThisWorkbook
End Sub

Function MaxFileSize() As Long
    If WB Is Nothing Then Exit Function
    MaxFileSize = BYTES_PER_CELL& * (GetFilesSheet.Rows.Count - 6)
End Function

Sub DeleteAllAttachments()
    On Error Resume Next: Err.Clear
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    GetFilesSheet(False).Visible = xlSheetVisible
    GetFilesSheet(False).Delete
    Application.DisplayAlerts = True
    If Me.AutoSaveWorkbook Then Me.WB.Save
End Sub

Function GetAllFilenames() As Collection
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next: Err.Clear
    Set GetAllFilenames = New Collection: Dim ra As Range, cell As Range
    If WB Is Nothing Then Exit Function
    Set ra = GetFilesSheet(False).Range("1:1").SpecialCells(xlCellTypeConstants)
    If Err Then Exit Function    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For Each cell In ra.Cells
        GetAllFilenames.Add CStr(cell), CStr(cell)
    Next cell
End Function

Function GetAllFiles() As Collection
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile
    Set GetAllFiles = New Collection
    On Error Resume Next

    Dim File As AttachedFile
    For Each Item In Me.GetAllFilenames
        Set File = Nothing: Set File = Me.GetAttachment(Item)
        If Not File Is Nothing Then GetAllFiles.Add File
    Next
End Function

Function AttachmentExist(ByVal filename$)
    On Error Resume Next
    Dim File As AttachedFile
    Set File = GetAttachment(filename$)
    AttachmentExist = Not (File Is Nothing)
End Function

Function GetAttachment(ByVal filename$) As AttachedFile
    If WB Is Nothing Then Exit Function
    On Error Resume Next: Err.Clear
    Dim ra As Range, col As Range
    Set col = GetFilesSheet(False).Range("1:1").Find(filename$, , xlValues, xlWhole, , , False).EntireColumn
    If Err Then Exit Function    ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    Set GetAttachment = New AttachedFile
    With GetAttachment
        Set .Parent = Me
        Set .FileRange = col
        .filename = filename$
        .AttachDate = CDate(col.Cells(2))
        .FileSize = Val(col.Cells(3))
    End With
End Function

Function AttachNewFile(Optional ByVal filepath$, Optional ByVal filename$, Optional Overwrite As Boolean = True) As Boolean
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| filepath$, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Filename$
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    If WB Is Nothing Then Exit Function
    On Error Resume Next: Err.Clear
    If filepath$ = "" Then    ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        With Application.FileDialog(msoFileDialogOpen)
            .ButtonName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|": .Title = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & WB.Name & "|fffd|"
            .Filters.Clear: .InitialFileName = WB.Path
            If .Show <> -1 Then Exit Function
            filepath$ = .SelectedItems(1)
        End With
    End If

    fname$ = Dir(filepath$, vbNormal): If fname$ = "" Then Exit Function    ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    If filename$ = "" Then filename$ = fname$    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd||fffd||fffd||fffd|

    If SilentMode Then Overwrite = True
    Dim File As AttachedFile, res As Boolean
    Set File = Me.GetAttachment(filename$)
    If Not File Is Nothing Then    ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| Excel
        If Not Overwrite Then    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            msg = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & WB.Name & "|fffd|" & vbNewLine & vbNewLine & _
                  "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| " & FileOrFolderSize(File.FileSize) & ") |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| " & FileOrFolderSize(filepath$) & ")?"
            If MsgBox(msg, vbQuestion + vbYesNo + vbDefaultButton2, "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?") = vbNo Then Exit Function
        End If
    Else
        Set File = CreateNewAttach
    End If

    File.FileRange.Cells(1) = filename$

    AttachNewFile = File.LoadFileData(filepath$)
    If AttachNewFile Then If Me.AutoSaveWorkbook Then Me.WB.Save
End Function

' ======================================= private functions ==================================

Private Function CreateNewAttach() As AttachedFile
    On Error Resume Next: Err.Clear
    Dim col As Range
    Set col = GetFilesSheet.Range("1:1").Find("", , xlValues, xlWhole, , , False).EntireColumn
    If Err <> 0 Then Exit Function    ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Set CreateNewAttach = New AttachedFile
    Set CreateNewAttach.FileRange = col
    Set CreateNewAttach.Parent = Me
End Function

Function FileOrFolderSize(ByVal s) As String
    On Error Resume Next: Err.Clear
    If Not IsNumeric(s) Then s = FileLen(s)
    If Err Then
        If Not SilentMode Then Debug.Print "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd|" & s & "|fffd|"
        Exit Function
    End If
    Size = Fix(Val(s))
    Select Case Size
        Case Is < 1000: FileOrFolderSize = Size & " |fffd||fffd||fffd||fffd|"
        Case Is < 10000: FileOrFolderSize = FormatNumber(Size / 1024, 1) & " |fffd||fffd|"
        Case Is < 1000000: FileOrFolderSize = FormatNumber(Size \ 1024, 0) & " |fffd||fffd|"
        Case Is < 10000000: FileOrFolderSize = FormatNumber(Size / 1024 / 1024, 1) & " M|fffd|"
        Case Is < 1000000000: FileOrFolderSize = FormatNumber(Size / 1024 / 1024, 0) & " |fffd||fffd|"
        Case Else: FileOrFolderSize = FormatNumber(Size / 1024 / 1024 / 1024, 1) & " |fffd||fffd|"
    End Select
End Function

Private Function GetFilesSheet(Optional ByVal CreateSheet As Boolean = True) As Worksheet
    On Error Resume Next: Err.Clear
    Dim sh As Worksheet
    x = WB.Worksheets(FILES_SHEET_NAME$).[a1]
    If Err = 0 Then    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Set GetFilesSheet = WB.Worksheets(FILES_SHEET_NAME$): Exit Function
    Else    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
        If Not CreateSheet Then Exit Function
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Application.ScreenUpdating = False
        Err.Clear: Set sh = WB.Worksheets.Add(, WB.Worksheets(WB.Worksheets.Count))
        If Err Then
            If Not SilentMode Then MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", _
               vbCritical, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
            Exit Function
        End If
        With sh
            .Name = FILES_SHEET_NAME$
            .Visible = xlSheetVeryHidden
            .Range("2:2").NumberFormat = "dd/mm/yy"
            .Range("3:3").NumberFormat = "#,##0"
            .Range("1:6").Font.Bold = True
        End With
        Set GetFilesSheet = sh
    End If
End Function

Sub OpenFolder(ByVal FolderPath$)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| FolderPath$ |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Windows
    On Error Resume Next
    CreateObject("wscript.shell").Run "explorer.exe /e, """ & FolderPath$ & """"
End Sub
Attribute VB_Name = "Module1"
Sub SendSheet()
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Copy
    With ActiveWorkbook
        .SendMail Recipients:="insurance@aps-solver.com", Subject:="|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        .Close SaveChanges:=False
    End With
End Sub

Attribute VB_Name = "Module2"
Sub SendSheet()
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|").Copy
    With ActiveWorkbook
        .SendMail Recipients:="gibroker@mail.ru", Subject:="|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        .Close SaveChanges:=False
    End With
End Sub


Attribute VB_Name = "Module3"

Sub |fffd||fffd||fffd||fffd||fffd||fffd|4(ByVal Target As Range)
    If Target.Column <> 5 Then Exit Sub
    Dim c&, r&: r = Target.Row
    If r < 3 Then Exit Sub
    c = 1
    If Len(Cells(r, c).Value) Then c = 3
    Cells(r, c) = Environ$("UserName")
    Cells(r, c + 1) = Now
    ActiveWorkbook.Save
    Windows("____.xlsm").Activate
    ActiveCell.Offset(15, 2).Range("A1").Select
    Windows("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.xlsb").Activate
    Windows("____.xlsm").Activate
    ActiveWorkbook.Save
    Windows("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.xlsb").Activate
    ActiveCell.Offset(12, 1).Range("A1:E1").Select
    ActiveCell.FormulaR1C1 = "800"
    ActiveCell.Offset(16, 6).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-14, -3).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[2]C[10]"
    ActiveCell.Offset(1, 0).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-33, -10).Range("A1:J1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(6, 1).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(17, 10).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-7, -1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[19]C[10]"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(0, 4).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(-1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "5"
    ActiveCell.Select
    ActiveCell.FormulaR1C1 = "36"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "65"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "12"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "213"
    ActiveCell.Offset(-3, 0).Range("A1:A3").Select
    Selection.ClearContents
    ActiveCell.Offset(3, 0).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(-2, -2).Range("A1:B1").Select
    ActiveCell.Offset(-2, -1).Range("A1").Activate
    Selection.ClearContents
    ActiveCell.Offset(2, -1).Range("A1:B1").Select
    Selection.ClearContents
    ActiveCell.Offset(-1, 2).Range("A1").Select
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveCell.Offset(-2, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "50"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "514"
    ActiveCell.Offset(-1, 0).Range("A1:A2").Select
    Selection.ClearContents
    ActiveCell.Offset(1, 6).Range("A1:A3").Select
    Selection.ClearContents
    ActiveCell.Offset(-1, -10).Range("A1:L1").Select
    Selection.AutoFill Destination:=ActiveCell.Range("A1:L4"), Type:= _
        xlFillDefault
    ActiveCell.Range("A1:L4").Select
    ActiveCell.Offset(1, 4).Range("A1").Select
    ActiveCell.FormulaR1C1 = "5813"
    ActiveCell.Select
    Selection.ClearContents
    ActiveCell.Offset(-1, 0).Rows("1:4").EntireRow.Select
    Selection.Delete Shift:=xlUp
    ActiveCell.Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[19]C[10]"
    ActiveCell.Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(0, -7).Range("A1:E1").Select
    ActiveCell.FormulaR1C1 = "800"
    ActiveCell.Offset(0, 6).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, -7).Range("A1:E1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 7).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, -1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(3, -5).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(3, 2).Range("A1:B1").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=6
    ActiveCell.Offset(6, 2).Range("A1").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-51
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|'!R[51]C[-1]"
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[33]C[1]:R[33]C[7]"
    ActiveCell.Offset(0, 2).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[19]C:R[19]C[4]"
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[19]C[4]"
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[22]C[-1]"
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|'!R[43]C[-3]:R[43]C[1]"
    ActiveCell.Offset(0, 1).Range("A1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.FormulaR1C1 = "=RC[-5]*RC[-3]*'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[31]C"
    ActiveCell.Offset(-1, 1).Range("A1").Select
    ActiveCell.Columns("A:A").EntireColumn.ColumnWidth = 26.29
    ActiveCell.Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    ActiveCell.FormulaR1C1 = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(0, -2).Range("A1").Select
    ActiveCell.FormulaR1C1 = "800"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(3, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "800"
    ActiveCell.Offset(1, 0).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 2).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(-3, -10).Range("A1:K1").Select
    Selection.Cut
    ActiveCell.Offset(4, 0).Range("A1").Select
    ActiveSheet.Paste
    ActiveCell.Offset(0, 8).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 2).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(-5, -10).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 26
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 28
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 28
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 26
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 18
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveCell.Offset(0, 1).Range("A1:A5").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.FormulaR1C1 = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ActiveCell.Offset(5, 0).Range("A1").Select
    ActiveCell.Columns("A:A").EntireColumn.ColumnWidth = 18.14
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveCell.Offset(9, -8).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.SmallScroll Down:=-12
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
    ActiveWindow.SmallScroll Down:=-12
    ActiveSheet.Unprotect
    ActiveCell.Offset(0, 1).Columns("A:D").EntireColumn.Select
    Selection.EntireColumn.Hidden = True
    ActiveCell.Offset(10, 11).Range("A1").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|").Select
    ActiveWindow.SmallScroll Down:=-51
    Application.PrintCommunication = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = ""
        .PrintTitleColumns = ""
    End With
    Application.PrintCommunication = True
    ActiveSheet.PageSetup.PrintArea = ""
    Application.PrintCommunication = False
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.708661417322835)
        .RightMargin = Application.InchesToPoints(0.708661417322835)
        .TopMargin = Application.InchesToPoints(0.748031496062992)
        .BottomMargin = Application.InchesToPoints(0.748031496062992)
        .HeaderMargin = Application.InchesToPoints(0.31496062992126)
        .FooterMargin = Application.InchesToPoints(0.31496062992126)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .PrintQuality = 600
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = 1
        .PrintErrors = xlPrintErrorsDisplayed
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .ScaleWithDocHeaderFooter = True
        .AlignMarginsHeaderFooter = True
        .EvenPage.LeftHeader.Text = ""
        .EvenPage.CenterHeader.Text = ""
        .EvenPage.RightHeader.Text = ""
        .EvenPage.LeftFooter.Text = ""
        .EvenPage.CenterFooter.Text = ""
        .EvenPage.RightFooter.Text = ""
        .FirstPage.LeftHeader.Text = ""
        .FirstPage.CenterHeader.Text = ""
        .FirstPage.RightHeader.Text = ""
        .FirstPage.LeftFooter.Text = ""
        .FirstPage.CenterFooter.Text = ""
        .FirstPage.RightFooter.Text = ""
    End With
    Application.PrintCommunication = True
    ActiveWorkbook.Save
    ChDir _
        "C:\Users\Medved_Mihail\Desktop\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|\BETA TEST"
    ActiveWorkbook.SaveAs filename:= _
        "C:\Users\Medved_Mihail\Desktop\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|\BETA TEST\BETA vers.xlsb" _
        , FileFormat:=xlExcel12, CreateBackup:=False
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|").Select
    ActiveWindow.SelectedSheets.Visible = False
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.SelectedSheets.Visible = False
    ActiveWindow.SmallScroll Down:=-30
    ActiveWorkbook.Save
    ActiveCell.Offset(11, -17).Range("A1:F1").Select
    ActiveCell.FormulaR1C1 = "58"
    ActiveCell.Offset(1, -4).Range("A1:J1").Select
    ActiveWorkbook.Save
    Workbooks.Open filename:= _
        "U:\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 08.05.2017\|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| JOUANEL INDUSTRIE.xlsx"
    ActiveCell.Offset(2, -12).Range("A1:J3").Select
    ActiveCell.Offset(4, -4).Range("A1").Activate
    Selection.Copy
    Application.CutCopyMode = False
    ActiveWindow.SmallScroll Down:=-9
    ActiveCell.Offset(-12, -8).Range("A1:J1").Select
    ActiveCell.Offset(-12, -4).Range("A1").Activate
    Selection.Copy
    ActiveWindow.Close
    ActiveCell.Offset(-1, 4).Range("A1:F1").Select
    ActiveCell.FormulaR1C1 = "58"
    ActiveCell.Offset(0, 10).Columns("A:A").EntireColumn.Select
    ActiveSheet.Unprotect
    ActiveCell.Offset(0, -5).Columns("A:F").EntireColumn.Select
    ActiveCell.Activate
    Selection.EntireColumn.Hidden = False
    ActiveCell.Offset(21, -10).Range("A1:F1").Select
    ActiveCell.FormulaR1C1 = "58"
    ActiveCell.Offset(0, 6).Range("A1").Select
    Selection.ClearContents
    Workbooks.Open filename:= _
        "U:\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 08.05.2017\|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| JOUANEL INDUSTRIE.xlsx"
    ActiveWindow.SmallScroll Down:=-9
    ActiveWindow.Close
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveWorkbook.Save
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
    ActiveCell.Offset(-9, -3).Range("A1").Select
    Selection.ClearContents
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(0, -7).Range("A1:F1").Select
    ActiveCell.FormulaR1C1 = "58"
    ActiveCell.Offset(1, -4).Range("A1:J1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 31
    ActiveWindow.ScrollColumn = 39
    ActiveWindow.ScrollColumn = 49
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 54
    ActiveWindow.ScrollColumn = 65
    ActiveWindow.ScrollColumn = 72
    ActiveWindow.ScrollColumn = 73
    ActiveWindow.ScrollColumn = 87
    ActiveCell.Offset(-1, 118).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[16]C[118]"
    ActiveCell.Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(0, -115).Range("A1:F1").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 47
    ActiveWindow.ScrollColumn = 58
    ActiveWindow.ScrollColumn = 65
    ActiveWindow.ScrollColumn = 87
    ActiveCell.Offset(0, 114).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 81
    ActiveWindow.ScrollColumn = 75
    ActiveWindow.ScrollColumn = 65
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 1
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
    ActiveCell.Offset(5, -115).Range("A1:B1").Select
    ActiveCell.FormulaR1C1 = "1/25/1900"
    ActiveCell.Offset(1, 0).Range("A1:B1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(-1, 0).Range("A1:B1").Select
    ActiveCell.FormulaR1C1 = "5/25/2017"
    ActiveCell.Offset(1, 0).Range("A1:B1").Select
    ActiveCell.FormulaR1C1 = "5/25/2017"
    ActiveCell.Offset(1, -4).Range("A1:J1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 47
    ActiveWindow.ScrollColumn = 70
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 85
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 85
    ActiveWindow.ScrollColumn = 79
    ActiveWindow.ScrollColumn = 76
    ActiveWindow.ScrollColumn = 75
    ActiveWindow.ScrollColumn = 65
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 45
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-8, 4).Range("A1:E1").Select
    ActiveCell.FormulaR1C1 = "150000"
    ActiveCell.Offset(1, 0).Range("A1:F1").Select
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 18
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 83
    ActiveWindow.ScrollColumn = 67
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 0).Range("A1:E1").Select
    Selection.ClearContents
    ActiveCell.Offset(6, 3).Range("A1:B1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-3, -2).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(3, -1).Range("A1:B1").Select
    Selection.ClearContents
    ActiveCell.Offset(1, 0).Range("A1:B1").Select
    Selection.ClearContents
    ActiveWorkbook.Save
    ActiveCell.Offset(-7, 0).Range("A1:E1").Select
    ActiveCell.FormulaR1C1 = "20"
    ActiveCell.Offset(1, 0).Range("A1:F1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(-1, 0).Range("A1:E1").Select
    ActiveCell.FormulaR1C1 = "20"
    ActiveCell.Offset(0, 5).Range("A1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(1, -5).Range("A1:F1").Select
    ActiveCell.FormulaR1C1 = "848"
    ActiveCell.Offset(-1, 0).Range("A1:F2").Select
    Selection.ClearContents
    ActiveCell.Offset(-19, 7).Range("A1").Select
    ActiveSheet.Unprotect
    ActiveCell.Offset(2, -1).Range("A1").Select
    ActiveWindow.SmallScroll Down:=9
    ActiveCell.Offset(31, 0).Range("A1").Select
    ActiveWindow.SmallScroll Down:=-12
    ActiveCell.Offset(-20, 0).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(33, 1).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(7, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = ""
    ActiveCell.Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$E$22<>"""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.AddIconSetCondition
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1)
        .ReverseOrder = False
        .ShowIconOnly = False
        .IconSet = ActiveWorkbook.IconSets(xl3Symbols)
    End With
    With Selection.FormatConditions(1).IconCriteria(2)
        .Type = xlConditionValuePercent
        .Value = 33
        .Operator = 7
    End With
    With Selection.FormatConditions(1).IconCriteria(3)
        .Type = xlConditionValuePercent
        .Value = 67
        .Operator = 7
    End With
    ActiveCell.Offset(0, -6).Range("A1:F1").Select
    ActiveCell.Range("A1:F1").Select
    ActiveWindow.SmallScroll Down:=6
    ActiveCell.Offset(13, 6).Range("A1").Select
    ActiveCell.FormulaR1C1 = ""
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveWindow.SmallScroll Down:=-36
    ActiveCell.Offset(-1, 0).Range("A1").Select
    ActiveWindow.SmallScroll Down:=6
    ActiveCell.Select
    Selection.FormatConditions.AddIconSetCondition
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1)
        .ReverseOrder = False
        .ShowIconOnly = False
        .IconSet = ActiveWorkbook.IconSets(xl3Symbols2)
    End With
    With Selection.FormatConditions(1).IconCriteria(2)
        .Type = xlConditionValuePercent
        .Value = 33
        .Operator = 7
    End With
    With Selection.FormatConditions(1).IconCriteria(3)
        .Type = xlConditionValuePercent
        .Value = 67
        .Operator = 7
    End With
    ActiveCell.Select
    ActiveCell.FormulaR1C1 = "1"
    ActiveCell.Select
    Selection.ClearContents
    ActiveCell.FormulaR1C1 = "1"
    ActiveCell.Select
    Selection.ClearContents
    ActiveCell.Offset(0, -7).Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "1"
    ActiveCell.Range("A1:G1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 7).Range("A1").Select
    ActiveCell.FormulaR1C1 = "=|fffd||fffd||fffd||fffd|"
    ActiveCell.Select
    Selection.ClearContents
    ActiveCell.Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-7]<>"""",""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"","""")"
    ActiveCell.Offset(0, -7).Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "2"
    ActiveCell.Range("A1:G1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 7).Range("A1").Select
    With Selection.Font
        .Name = "Times New Roman"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection.Font
        .Name = "Times New Roman"
        .Size = 14
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 16
    Selection.Font.Size = 18
    Selection.Font.Size = 20
    Selection.Font.Size = 22
    Selection.Font.Size = 20
    Selection.Font.Size = 18
    Selection.Font.Size = 16
    ActiveCell.Select
    ActiveWorkbook.Save
    ActiveCell.Offset(0, -7).Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "155"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 41
    ActiveWindow.ScrollColumn = 45
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 69
    ActiveWindow.ScrollColumn = 78
    ActiveWindow.ScrollColumn = 81
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 88
    ActiveCell.Offset(-14, 118).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(13, -1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(-2, -4).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.Offset(-33, -1).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 81
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 55
    ActiveWindow.ScrollColumn = 34
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(2, -113).Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "200"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 31
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 70
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 85
    ActiveWindow.ScrollColumn = 73
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 3).Range("A1:G1").Select
    Selection.ClearContents
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 66
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 26
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "155"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.SmallScroll ToRight:=4
    ActiveWindow.ScrollColumn = 91
    ActiveWindow.ScrollColumn = 90
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 85
    ActiveWindow.ScrollColumn = 78
    ActiveWindow.ScrollColumn = 63
    ActiveWindow.ScrollColumn = 53
    ActiveWindow.ScrollColumn = 31
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 3).Range("A1:G1").Select
    Selection.ClearContents
    ActiveWorkbook.Save
    ActiveCell.Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "555"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 39
    ActiveWindow.ScrollColumn = 59
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 68
    ActiveWindow.ScrollColumn = 55
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 3).Range("A1:G1").Select
    Selection.ClearContents
    ActiveWorkbook.Save
    ActiveCell.Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "54546546546"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 42
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 55
    ActiveWindow.ScrollColumn = 59
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 70
    ActiveWindow.ScrollColumn = 77
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 88
    ActiveCell.Offset(-29, 118).Range("A1:C43").Select
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(28, -115).Range("A1:G1").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-60
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWindow.SmallScroll Down:=12
    ActiveCell.Range("A1:G1").Select
    ActiveCell.FormulaR1C1 = "15"
    ActiveCell.Offset(1, -3).Range("A1:F2").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 43
    ActiveWindow.ScrollColumn = 59
    ActiveWindow.ScrollColumn = 64
    ActiveWindow.ScrollColumn = 76
    ActiveWindow.ScrollColumn = 77
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 83
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 48
    ActiveWindow.ScrollColumn = 49
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 75
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.LargeScroll ToRight:=-1
    ActiveWindow.ScrollColumn = 53
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 22
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 3).Range("A1:G1").Select
    Selection.ClearContents
    ActiveCell.Offset(0, 7).Range("A1").Select
    ActiveWorkbook.Save
    ActiveCell.Offset(-3, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "5"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 57
    ActiveWindow.ScrollColumn = 66
    ActiveWindow.ScrollColumn = 69
    ActiveWindow.ScrollColumn = 76
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 84
    ActiveWindow.ScrollColumn = 88
    ActiveWindow.ScrollColumn = 87
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 77
    ActiveWindow.ScrollColumn = 72
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 46
    ActiveWindow.ScrollColumn = 41
    ActiveWindow.ScrollColumn = 18
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(-1, 0).Range("A1").Select
    Selection.ClearContents
    ActiveCell.Offset(1, -10).Range("A1:I1").Select
    ActiveCell.FormulaR1C1 = _
        "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|  % |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 0.2%)|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ActiveCell.Offset(0, 9).Range("A1").Select
    Selection.FormatConditions.Delete
    ActiveCell.Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveCell.Offset(0, -9).Range("A1:J1").Select
    ActiveCell.Activate
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    ActiveCell.Offset(0, 10).Range("A1").Select
    Selection.Locked = False
    Selection.FormulaHidden = True
    ActiveCell.Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    ActiveCell.Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=$K$33<>"""""
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .Pattern = xlPatternLinearGradient
        .Gradient.Degree = 90
        .Gradient.ColorStops.Clear
    End With
    With Selection.FormatConditions(1).Interior.Gradient.ColorStops.Add(0)
        .Color = 10092441
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior.Gradient.ColorStops.Add(1)
        .Color = 10092441
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    ActiveCell.Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 65
    ActiveWindow.ScrollColumn = 79
    ActiveWindow.ScrollColumn = 88
    ActiveCell.Offset(-1, 98).Range("A1").Select
    ActiveWindow.ScrollColumn = 86
    ActiveWindow.ScrollColumn = 82
    ActiveWindow.ScrollColumn = 60
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 46
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 1
    ActiveCell.Offset(1, -98).Range("A1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 61
    ActiveWindow.ScrollColumn = 70
    ActiveWindow.ScrollColumn = 76
    ActiveWindow.ScrollColumn = 77
    ActiveWindow.ScrollColumn = 79
    ActiveWindow.ScrollColumn = 81
    ActiveWindow.ScrollColumn = 84
    ActiveWindow.ScrollColumn = 85
    ActiveWindow.ScrollColumn = 86
    ActiveCell.Offset(0, 98).Range("A1").Select
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveCell.FormulaR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|'!R[27]C[108]"
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 42
    ActiveWindow.ScrollColumn = 44
    ActiveWindow.ScrollColumn = 47
    ActiveWindow.ScrollColumn = 49
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 53
    ActiveWindow.ScrollColumn = 52
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 48
    ActiveWindow.ScrollColumn = 45
    ActiveWindow.ScrollColumn = 43
    ActiveWindow.ScrollColumn = 40
    ActiveWindow.ScrollColumn = 39
    ActiveWindow.ScrollColumn = 38
    ActiveWindow.ScrollColumn = 37
    ActiveWindow.ScrollColumn = 36
    ActiveWindow.ScrollColumn = 35
    ActiveWindow.ScrollColumn = 34
    ActiveWindow.ScrollColumn = 33
    ActiveWindow.ScrollColumn = 32
    ActiveWindow.ScrollColumn = 31
    ActiveWindow.ScrollColumn = 30
    ActiveWindow.ScrollColumn = 29
    ActiveWindow.ScrollColumn = 28
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 26
    ActiveWindow.ScrollColumn = 25
    ActiveWindow.ScrollColumn = 24
    ActiveWindow.ScrollColumn = 23
    ActiveWindow.ScrollColumn = 22
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 18
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 15
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.LargeScroll ToRight:=-1
    ActiveWindow.ScrollColumn = 51
    ActiveWindow.ScrollColumn = 50
    ActiveWindow.ScrollColumn = 44
    ActiveWindow.ScrollColumn = 42
    ActiveWindow.ScrollColumn = 31
    ActiveWindow.ScrollColumn = 27
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 1
    ActiveWorkbook.Save
    ActiveWindow.SmallScroll Down:=-36
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
        :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
        AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
        AllowUsingPivotTables:=True
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 12
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 20
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 22
    ActiveWindow.ScrollColumn = 21
    ActiveWindow.ScrollColumn = 19
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Workbooks.Open filename:= _
        "U:\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 08.05.2017\|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| JOUANEL INDUSTRIE.xlsx"
    ActiveCell.Offset(2, -12).Range("A1:J3").Select
    ActiveCell.Offset(4, -4).Range("A1").Activate
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-9
    ActiveCell.Offset(-17, -8).Range("A1:J1").Select
    ActiveCell.Offset(-17, -5).Range("A1").Activate
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.SmallScroll Down:=-15
    ActiveCell.Offset(5, -3).Range("A1:J1").Select
    ActiveCell.Offset(5, 1).Range("A1").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Windows("BETA vers.xlsb").Activate
    Application.WindowState = xlNormal
    Windows("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| JOUANEL INDUSTRIE.xlsx").Activate
    ActiveWindow.Close
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    ActiveWindow.SelectedSheets.Visible = False
    ActiveCell.Offset(-4, -94).Range("A1").Select
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWorkbook.Save
    ActiveWindow.SmallScroll Down:=-33
    ActiveCell.Offset(-5, -3).Range("A1").Select
    ActiveWindow.SmallScroll Down:=24
    ActiveWorkbook.Save
    ActiveWorkbook.Save
End Sub
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Column <> 5 Then Exit Sub
    Dim c&, r&: r = Target.Row
    If r < 3 Then Exit Sub
    c = 1
    If Len(Cells(r, c).Value) Then c = 3
    Cells(r, c) = Environ$("UserName")
    Cells(r, c + 1) = Now
End Sub
Attribute VB_Name = "Module4"
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{7F9DD364-0604-4E8A-AD47-5CEA3DC67221}{EA8CD052-77D1-4C36-A687-1BF71F548665}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{F83596A1-BC46-412B-A97C-0A716BA7EC5A}{6F1221DF-88A2-40B4-96E7-0D416BD41199}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{5461ADD8-1AB8-48E7-8993-556FBAE3B419}{F1C5AC06-B384-40A8-8F7C-3A637187A20B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{0DD6A41B-C2D7-4C47-B11E-F4AF444D5184}{38B71678-1750-4B40-8587-F33A98EB56B8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "mod_SimpleTest"
'---------------------------------------------------------------------------------------
' Module        : mod_SimpleTest
' |fffd||fffd||fffd||fffd||fffd|     : EducatedFool  (|fffd||fffd||fffd||fffd||fffd|)                    |fffd||fffd||fffd||fffd|: 19.08.2012
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Microsoft Excel
' http://ExcelVBA.ru/          ICQ: 5836318           Skype: ExcelVBA.ru
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: http://ExcelVBA.ru/payments
'---------------------------------------------------------------------------------------


' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| Excel
    Dim FileManager As New AttachedFiles, res As Boolean
    res = FileManager.AttachNewFile("C:\WINDOWS\notepad.exe")
End Sub



' |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()    ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim FileManager As New AttachedFiles, res As Boolean
    On Error Resume Next ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| notepad.exe
    res = FileManager.GetAttachment("notepad.exe").SaveAs("C:\MyProgram.exe")
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()    ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd| |fffd||fffd||fffd||fffd|
    Dim FileManager As New AttachedFiles
    On Error Resume Next ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| notepad.exe
    FileManager.GetAttachment("notepad.exe").Run
End Sub
Attribute VB_Name = "mod_TestAttachments"
'---------------------------------------------------------------------------------------
' Module        : mod_TestAttachments
' |fffd||fffd||fffd||fffd||fffd|     : EducatedFool  (|fffd||fffd||fffd||fffd||fffd|)                    |fffd||fffd||fffd||fffd|: 19.08.2012
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Microsoft Excel
' http://ExcelVBA.ru/          ICQ: 5836318           Skype: ExcelVBA.ru
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: http://ExcelVBA.ru/payments
'---------------------------------------------------------------------------------------

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_Excel()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, res As Boolean

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    FileManager.AutoSaveWorkbook = True

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| AttachNewFile |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|,
    ' |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
    res = FileManager.AttachNewFile

    ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| res |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (TRUE |fffd||fffd||fffd| FALSE)
    '    If res Then
    '        MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| Excel", vbInformation
    '    Else
    '        MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", vbExclamation
    '    End If
End Sub



Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd|()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile, res As Boolean

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    filename$ = SelectedAttachment: If filename$ = "" Then Exit Sub

    If Not FileManager.AttachmentExist(filename$) Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel", vbCritical
        Exit Sub
    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile
    ' |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| SaveAs |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|,
    ' |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
    res = FileManager.GetAttachment(filename$).SaveAs

    ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| res |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (TRUE |fffd||fffd||fffd| FALSE)
    If res Then
        MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd| |fffd||fffd||fffd||fffd|", vbInformation
    Else
        MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", vbExclamation
    End If
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile, res As Boolean

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    filename$ = SelectedAttachment: If filename$ = "" Then Exit Sub

    If Not FileManager.AttachmentExist(filename$) Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel", vbCritical
        Exit Sub
    End If

    Folder$ = "c:\test\"    ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    On Error Resume Next: MkDir Folder$    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile
    ' |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| SaveAs |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ' (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|,
    ' |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
    res = FileManager.GetAttachment(filename$).SaveAs(Folder$ & filename$)

    ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| res |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (TRUE |fffd||fffd||fffd| FALSE)
    If res Then
        MsgBox "|fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel |fffd||fffd| |fffd||fffd||fffd||fffd|" & vbNewLine & vbNewLine & _
               "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| " & Folder$ & filename$, vbInformation
    Else
        MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd|", vbExclamation
    End If
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile, res As Boolean

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    filename$ = SelectedAttachment: If filename$ = "" Then Exit Sub

    If Not FileManager.AttachmentExist(filename$) Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & filename$ & "|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel", vbCritical
        Exit Sub
    End If

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile
    ' |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Run (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
    FileManager.GetAttachment(filename$).Run

End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile, res As Boolean

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    filename$ = SelectedAttachment: If filename$ = "" Then Exit Sub

    On Error Resume Next    ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd| GetAttachment |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile
    ' |fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| AttachedFile |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Delete
    FileManager.GetAttachment(filename$).Delete


    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|()
    On Error Resume Next
    Dim sh As Worksheet, n&: Set sh = ActiveSheet
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    sh.Range("7:" & sh.Rows.Count).ClearContents

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile

    For Each File In FileManager.GetAllFiles
        n& = n& + 1
        SumSize& = SumSize& + File.FileSize    ' FileSize - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ' |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If CBool([a1]) Then |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(File.IsCorrect, "|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

        sh.Range("a" & sh.Rows.Count).End(xlUp).Offset(1).Resize(, 5).Value = _
        Array(n, File.filename, File.FileSizeTXT, File.AttachDate, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    Next

    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = FileManager.FileOrFolderSize(SumSize&)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|EXCEL = FileManager.FileOrFolderSize(ThisWorkbook.FullName)

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    sh.Range("a" & sh.Rows.Count).End(xlUp).Offset(2).Resize(, 3).Value = _
    Array("", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)

    sh.Range("a" & sh.Rows.Count).End(xlUp).Offset(3).Resize(, 3).Value = _
    Array("", "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|EXCEL)

End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|()

    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| FileManager |fffd||fffd||fffd||fffd| AttachedFiles
    Dim FileManager As New AttachedFiles, File As AttachedFile, OK As Long, n As Long

    ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Folder$ = CreateObject("WScript.Shell").SpecialFolders("Desktop") & "\Excel Attach\"
    On Error Resume Next: MkDir Folder$    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For Each File In FileManager.GetAllFiles
        n = n + 1
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        OK = OK - File.SaveAs(Folder$ & File.filename)
    Next

    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & OK & " |fffd||fffd| " & n & " |fffd||fffd||fffd||fffd||fffd||fffd|" & vbNewLine & vbNewLine & _
           "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & Folder$, vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd|"

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Windows
    FileManager.OpenFolder Folder$
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|()
    Dim FileManager As New AttachedFiles
    FileManager.DeleteAllAttachments

End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_regedit_exe()
    File$ = Environ("WinDir") & "\regedit.exe"
    If Dir(File$) = "" Then MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd|" & File$ & "|fffd|", vbCritical: Exit Sub

    Dim FileManager As New AttachedFiles
    If FileManager.AttachNewFile(File$) Then Debug.Print "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|
End Sub


Function SelectedAttachment() As String
    On Error Resume Next
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| filename$
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = ActiveCell.EntireRow.Cells(1)

    If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Like String(Len(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|), "#") Then
        filename$ = Trim(ActiveCell.EntireRow.Cells(2))
        If filename$ = "" Then
            MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
            Exit Function
        End If
    Else
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Function
    End If
    SelectedAttachment = filename$
End Function
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Column <> 11 Then Exit Sub
    Dim c&, r&: r = Target.Row
    If r < 3 Then Exit Sub
    c = 109
    If Len(Cells(r, c).Value) Then c = 110
    Cells(r, c) = Environ$("UserName")
    Cells(r, c + 1) = Now
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Column <> 9 Then Exit Sub
    Dim c&, r&: r = Target.Row
    If r < 3 Then Exit Sub
    c = 11
    If Len(Cells(r, c).Value) Then c = 199
    Cells(r, c) = Environ$("UserName")
    Cells(r, c + 1) = Now
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
