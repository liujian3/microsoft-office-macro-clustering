Attribute VB_Name = "Foglio1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 9").Visible = True Then
ActiveSheet.ChartObjects("Grafico 9").Visible = False
Else
ActiveSheet.ChartObjects("Grafico 9").Visible = True
End If

If ActiveSheet.ChartObjects("Grafico 10").Visible = True Then
ActiveSheet.ChartObjects("Grafico 10").Visible = False
Else
ActiveSheet.ChartObjects("Grafico 10").Visible = True
End If

End Sub


Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub




'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub

Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub
Attribute VB_Name = "Foglio10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()


Range("b8:c8").Hyperlinks.Delete
Range("b8:c8").ClearContents
   
keystat
End Sub

Private Sub CommandButton2_Click()
 
  
   
   Range("e8:g8").Hyperlinks.Delete
Range("e8:g8").ClearContents

    
    Range("e9:g9").Hyperlinks.Delete
Range("e9:g9").ClearContents

    '

income
End Sub

Private Sub CommandButton3_Click()
Range("b12:c12").Hyperlinks.Delete
Range("b12:c12").ClearContents

COMPETITORS
End Sub

Attribute VB_Name = "Foglio11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton5, 25, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton4, 23, 1, MSForms, SpinButton"
Attribute VB_Control = "SpinButton1, 3, 2, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 4, 3, MSForms, SpinButton"
Attribute VB_Control = "SpinButton3, 9, 4, MSForms, SpinButton"

Private Sub Worksheet_Activate()
On Error Resume Next
Application.ScreenUpdating = False
Sheets("Financial Structure").Unprotect

ActiveSheet.Shapes.Range(Array("Estrazione 5")).Select
    Selection.ShapeRange.Height = 276.094488189 * Worksheets("how does it pay").Range("H7")
    Selection.ShapeRange.Top = 146.7 '137.5
    Selection.ShapeRange.ZOrder msoBringToFront
    DoEvents
resetfinstr
DoEvents
Sheets("Financial Structure").Protect
Application.ScreenUpdating = True
Exit Sub

'MsgBox Worksheets("how does it pay").Range("H7")
Application.ScreenUpdating = False
Sheets("Financial Structure").Unprotect


Range("E3").Select
    'ActiveCell.FormulaR1C1 = "=+R[-2]C"
     ActiveCell.Formula = "=+E1-P4"
    Range("Q4") = 0
     Range("O4") = 0
    Range("R4") = 0
 Range("A1").Select
 
'ActiveSheet.ChartObjects("Grafico 3").Activate
   ' ActiveChart.Shapes.Range(Array("Rounded Rectangle 1")).Select
 'Selection.ShapeRange.Height = -276 * Worksheets("how does it pay").Range("g16") / Worksheets("how does it pay").Range("g8")

'Selection.ShapeRange.Top = 38

ActiveSheet.Shapes.Range(Array("Estrazione 5")).Select
    Selection.ShapeRange.Height = 276.094488189 * Worksheets("how does it pay").Range("H7")
    Selection.ShapeRange.Top = 137.5
    
    ActiveSheet.Shapes.Range(Array("Oval 6")).Select
    ActiveSheet.Shapes.Range(Array("Ovale 6")).Select

    Selection.ShapeRange.Height = 276.094488189 * (Worksheets("how does it pay").Range("g10") - ActiveSheet.Range("k21") + ActiveSheet.Range("k19")) / Worksheets("how does it pay").Range("g8")
    

    Selection.ShapeRange.Top = 137.5
    Selection.ShapeRange.ZOrder msoBringToFront
  'ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
        
        '----------------
       ' ActiveSheet.Shapes.Range(Array("Flowchart: Extract 5")).Select
   ' Selection.ShapeRange.IncrementLeft 3.75
    'Selection.ShapeRange.IncrementTop 22.5
    'ActiveSheet.Shapes.Range(Array("Oval 6")).Select
    'Selection.ShapeRange.IncrementTop 22.5
    'Range("A1:D1").Select
     '----------------
        
        
 ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:=True
        Range("A1").Select
        
        
        With Application
        .Calculation = xlCalculationAutomatic
        .Iteration = True
        .MaxIterations = 100
        .MaxChange = 0.001
    End With
        
    
        
    Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Foglio15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image4, 12, 0, MSForms, Image"


Private Sub Image1_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Image1.Visible = False
End Sub

Private Sub Image2_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub Image2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Image2.Visible = False
End Sub

Private Sub Image3_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub Image3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Image3.Visible = False
End Sub

Private Sub Worksheet_Deactivate()
Image4.Visible = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Foglio2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 6").Visible = True Then
ActiveSheet.ChartObjects("Grafico 6").Visible = False
Else
ActiveSheet.ChartObjects("Grafico 6").Visible = True
End If

If ActiveSheet.ChartObjects("Grafico 8").Visible = True Then
ActiveSheet.ChartObjects("Grafico 8").Visible = False
Else
ActiveSheet.ChartObjects("Grafico 8").Visible = True


End If

End Sub

Private Sub Worksheet_Activate()
''''''Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub

Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub

Attribute VB_Name = "Foglio20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio211"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub CommandButton1_Click()
Columns("L:O").Select
    Selection.Copy
    Range("B1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("B1").Select
End Sub

Private Sub CommandButton2_Click()

End Sub
Attribute VB_Name = "Foglio25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub CommandButton1_Click()
'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

On Error Resume Next

If Range("F17") <> 0 Then
ThisWorkbook.FollowHyperlink "http://www.google.com/search?q=" & Range("F17").Text
DoEvents
End If

ThisWorkbook.FollowHyperlink "http://www.google.com/search?q=" & Range("F1").Text
DoEvents

End Sub



Private Sub Worksheet_Activate()
On Error Resume Next
'If Salvo = 1 Then
Application.Calculation = xlManual
DoEvents

Worksheets("ID card").Range("f1") = Worksheets("ID card").Range("m1").Value
Worksheets("ID card").Range("f12") = Worksheets("ID card").Range("m12").Value
'Worksheets("ID card").Range("f13") = Worksheets("ID card").Range("m13").Value
Worksheets("ID card").Range("f17") = Worksheets("ID card").Range("m17").Value
Worksheets("ID card").Range("f19") = Worksheets("ID card").Range("m19").Value

Application.Calculation = xlAutomatic
'End If
''''''Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

'On Error Resume Next

Application.DisplayAlerts = False

If Selection.Locked = True Then
Cancel = True
Application.DisplayAlerts = True
Exit Sub
End If



If ((Target = Range("F1") Or Target = Range("F12") Or Target = Range("F17") Or Target = Range("F19")) And (Target <> 0 And Target <> "Nd" And Target <> "nd" And Target <> "true" And Target <> "True" And Target <> "false" And Target <> "False")) Then

If IsNumeric(Target) Then
Target = "CODICI ATECO ISTAT " & Target
End If


Application.Calculation = xlManual
Application.ScreenUpdating = False
DoEvents

With Target
      .Hyperlinks.Add Target, Address:="http://www.google.it"
      DoEvents
      .Hyperlinks(1).SubAddress = "hl=it&q=" & .Value
      DoEvents
      .Hyperlinks(1).Follow NewWindow:=False
      DoEvents
      .Hyperlinks(1).Delete
      DoEvents
          End With
              
               ActiveCell.Select
               ActiveSheet.Unprotect ("ballaredo55")
              
             With Selection
            Selection.Locked = False
            End With
               DoEvents
    
    
    
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    DoEvents
    
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    DoEvents
    
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    DoEvents
    
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '----****
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    '----****
    
     Selection.NumberFormat = "General"
    
    
    
    DoEvents
    
    ActiveSheet.Protect "ballaredo55", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ' ActiveSheet.Protect ("ballaredo55")
    Application.Calculation = xlAutomatic
    Application.ScreenUpdating = True
    
    
    End If
    
    SendKeys "{ESC}"
    
End Sub


Attribute VB_Name = "Foglio32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton3, 7, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 2, 1, MSForms, SpinButton"
Attribute VB_Control = "SpinButton1, 1, 2, MSForms, SpinButton"
Attribute VB_Control = "SpinButton4, 23, 3, MSForms, SpinButton"
Private Sub Worksheet_Activate()

'Exit Sub
On Error Resume Next


'MsgBox Worksheets("how does it pay").Range("H7")
Application.ScreenUpdating = False
Sheets("Financial Structure post Budget").Unprotect


Range("E3").Select
    'ActiveCell.FormulaR1C1 = "=+R[-2]C"
     ActiveCell.Formula = "=+E1-P4"
    Range("Q4") = 0
    Range("O4") = 0
    Range("R4") = 0
 Range("A1").Select

'ActiveSheet.ChartObjects("Grafico 3").Activate
   ' ActiveChart.Shapes.Range(Array("Rounded Rectangle 1")).Select
 'Selection.ShapeRange.Height = -276 * Worksheets("how does it pay").Range("g16") / Worksheets("how does it pay").Range("g8")

'Selection.ShapeRange.Top = 38

ActiveSheet.Shapes.Range(Array("Estrazione 2")).Select
    Selection.ShapeRange.Height = 276.094488189 * (Worksheets("BUDGETING").Range("F4") - Worksheets("SINTETIC").Range("F8")) / Worksheets("BUDGETING").Range("F53")
    Selection.ShapeRange.Top = 146.7  '140.5
    
    ActiveSheet.Shapes.Range(Array("Oval 9")).Select
    ActiveSheet.Shapes.Range(Array("Ovale 9")).Select

    Selection.ShapeRange.Height = 276.094488189 * (Worksheets("BUDGETING").Range("F4") - Worksheets("SINTETIC").Range("F8")) / Worksheets("BUDGETING").Range("F53") * Worksheets("BUDGETING").Range("AA10") / 100
    Selection.ShapeRange.Top = 146.7 '140.5
    Selection.ShapeRange.ZOrder msoBringToFront
  'ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
        
        '----------------
    '    ActiveSheet.Shapes.Range(Array("Flowchart: Extract 2")).Select
    'Selection.ShapeRange.IncrementLeft 3.75
    'Selection.ShapeRange.IncrementTop 22.5
    'ActiveSheet.Shapes.Range(Array("Oval 9")).Select
    'Selection.ShapeRange.IncrementTop 22.5
    'Range("A1:D1").Select
     '----------------
        
        
        ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:=True
        Range("A1").Select
    Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Foglio34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox2, 30, 0, MSForms, CheckBox"
Attribute VB_Control = "TextBox1, 3, 1, MSForms, TextBox"
Attribute VB_Control = "CheckBox1, 27, 2, MSForms, CheckBox"
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 20").Visible = True Then
ActiveSheet.ChartObjects("Grafico 20").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 20").Visible = True

End If
End Sub

Private Sub CommandButton2_Click()
'CommandButton2.AutoSize = False
'CommandButton2.AutoSize = True

'CommandButton2.AutoLoad = False
'CommandButton2.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 24").Visible = True Then
ActiveSheet.ChartObjects("Grafico 24").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 24").Visible = True

End If
End Sub


Private Sub CheckBox1_Click()

End Sub

Private Sub CheckBox2_Click()

End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub


Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub


Attribute VB_Name = "Foglio341"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "TextBox1, 198, 0, MSForms, TextBox"
Attribute VB_Control = "Label1, 15, 1, MSForms, Label"
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 4").Visible = True Then
ActiveSheet.ChartObjects("Grafico 4").Visible = False
Else

'Application.ScreenUpdating = False
'ActiveSheet.Range("k28") = FALSO
'DoEvents
ActiveSheet.ChartObjects("Grafico 4").Visible = True
'Application.ScreenUpdating = True

End If

End Sub


Private Sub Label1_Click()
If ActiveSheet.Shapes("Grafico 2").ZOrder(0) Then
    ActiveSheet.Shapes("Grafico 2").ZOrder.msoBringToFront
        End If
End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub

Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub

Attribute VB_Name = "Foglio342"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio343"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 4").Visible = True Then
ActiveSheet.ChartObjects("Grafico 4").Visible = False
Else

'Application.ScreenUpdating = False
'ActiveSheet.Range("k28") = FALSO
'DoEvents
ActiveSheet.ChartObjects("Grafico 4").Visible = True
'Application.ScreenUpdating = True

End If

End Sub


Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub

Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub

Attribute VB_Name = "Foglio35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label8, 76, 0, MSForms, Label"
Attribute VB_Control = "Label7, 75, 1, MSForms, Label"
Attribute VB_Control = "CheckBox1, 50, 2, MSForms, CheckBox"
Attribute VB_Control = "Label5, 48, 3, MSForms, Label"
Attribute VB_Control = "ComboBox2, 33, 4, MSForms, ComboBox"
Attribute VB_Control = "TextBox1, 29, 5, MSForms, TextBox"
Attribute VB_Control = "CommandButton1, 21, 6, MSForms, CommandButton"
Attribute VB_Control = "ComboBox1, 23, 7, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 34, 8, MSForms, ComboBox"
Attribute VB_Control = "Label1, 41, 9, MSForms, Label"
Attribute VB_Control = "Label2, 42, 10, MSForms, Label"
Attribute VB_Control = "Label3, 43, 11, MSForms, Label"
Attribute VB_Control = "Label4, 45, 12, MSForms, Label"
Attribute VB_Control = "Label6, 52, 13, MSForms, Label"
Attribute VB_Control = "TextBox2, 72, 14, MSForms, TextBox"
Option Explicit









Private Sub ComboBox1_Change()
On Error Resume Next



If Sheets("COVER").ComboBox1.Value <> "" Then
Range("O4") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0
End If

DoEvents
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox1.Value
DoEvents
'apri

End Sub

Private Sub ComboBox1_Click()
On Error Resume Next
Range("O4") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0

DoEvents

End Sub

Private Sub ComboBox1_DropButtonClick()
On Error Resume Next
Range("O4") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0

DoEvents

End Sub

Private Sub ComboBox1_LostFocus()
On Error Resume Next
Range("O4") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0
DoEvents
End Sub

Private Sub ComboBox2_Change()

On Error Resume Next

Range("O5") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0
DoEvents
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox2.Value
DoEvents
'apri

End Sub

Private Sub ComboBox2_Click()
On Error Resume Next
Range("O5") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0


DoEvents
End Sub

Private Sub ComboBox2_DropButtonClick()
On Error Resume Next
Range("O5") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0


DoEvents

End Sub

Private Sub ComboBox2_LostFocus()
On Error Resume Next
Range("O5") = ""
Range("O6") = ""
Sheets("COVER").Range("IA2") = 0
DoEvents
End Sub

Private Sub ComboBox3_Change()

On Error Resume Next


If Sheets("COVER").ComboBox3.Value <> "" Then
Range("O4") = ""
Range("O5") = ""
End If

DoEvents
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox3.Value
DoEvents
'apri
End Sub

Private Sub ComboBox3_Click()
On Error Resume Next
Range("O5") = ""
Range("O4") = ""


DoEvents
End Sub

Private Sub ComboBox3_DropButtonClick()
On Error Resume Next
Range("O5") = ""
Range("O4") = ""


DoEvents
End Sub

Private Sub ComboBox3_LostFocus()
On Error Resume Next
Range("O5") = ""
Range("O4") = ""
DoEvents
End Sub

'Private Sub ComboBox2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)

'Sheets("COVER").ComboBox1.Value = ""

'End Sub

Private Sub CommandButton1_Click()

On Error Resume Next



Form_Load
ButtonReset
End Sub



Private Sub CommandButton3_Click()
On Error Resume Next
    Dim lPid As Long, hwnd As Long
    Dim paths As String


'CommandButton3.Visible = False
Dim FOO
Dim fNameAndPath
Dim conta
paths = ActiveWorkbook.Path


'''fNameAndPath = Application.GetOpenFilename(FileFilter:="Zip & pdf Files,*.zip;*.pdf", Title:="Select File To Search In")
'''If fNameAndPath = False Then Exit Sub
'Workbooks.Open Filename:=fNameAndPath
'MsgBox fNameAndPath
'Stop
'''FOO = LTrim(RTrim(fNameAndPath))
'DA QUESTA MACRO FUNZIONA SOLO SE SCELGO DEI FILES PDF NON SO PERCHE' NON VA SE SCELGO UNO ZIP
'POI FUNZIA SOLO SE IL NOME DELLA DIR NON CONTIENE SPAZI
'POI BISOGNEREBBE PRIMA DARE UN COMANDO DI CLEAR SELECTION ALTRIMENTI CERCA SEMPRE NEI FILES VECCHI
'|fffd| necessario che la directory e il file abbiano un nome senza spazi; in talcaso funziona; per farlo funzionare con nomi contenenti spazi non so come fare
'FOO = "C:\ITALY2013\CERAMICA_CASTELVETRO_13.pdf"

lPid = Shell(paths & "\PowerGREP4\PowerGREP4.exe " & paths & "\PowerGREP4\mypgaction2.pga /simple ", vbNormalFocus)
        hwnd = HwndFromPID(lPid)
    hwnd = GetWindow(hwnd, GW_CHILD)


'Shell paths & "\PowerGREP4\PowerGREP4.exe " & paths & "\PowerGREP4\mypgaction.pga /simple ", vbNormalFocus
'Application.Cursor = xlDefault
DoEvents

sleep (20)
'CommandButton3.Visible = True
End Sub

Private Sub CommandButton4_Click()
ActiveWindow.ScrollRow = 29
'Label1.Visible = False

'ActiveSheet.Range("a29").Select
End Sub

Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Image1.Visible = False
End Sub


Private Sub Label5_Click()
On Error Resume Next
READFILE2
End Sub

Private Sub Label6_Click()
TextBox2.Visible = False
Label6.Visible = False
End Sub

Private Sub TextBox2_Change()
On Error Resume Next
TextBox2.Visible = False
Label6.Visible = False

End Sub

Private Sub TextBox2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
TextBox2.Visible = False
Label6.Visible = False

End Sub

Private Sub TextBox2_GotFocus()
On Error Resume Next
TextBox2.Visible = False
Label6.Visible = False
End Sub

Private Sub TextBox2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
TextBox2.Visible = False
Label6.Visible = False

End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub

Private Sub Worksheet_Activate()
On Error Resume Next
'CommandButton3.Visible = False
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
Application.OnKey "{F4}", "stampareport"
TextBox2.Visible = True
Label6.Visible = True
End Sub


Attribute VB_Name = "Foglio351"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image2, 4, 1, MSForms, Image"
Attribute VB_Control = "Image1, 3, 2, MSForms, Image"
Attribute VB_Control = "CommandButton1, 2, 3, MSForms, CommandButton"
Private Sub ComboBox1_Change()
Image1.Visible = True
Image2.Visible = True

End Sub

Private Sub CommandButton1_Click()
'If Sheets("COVER").Range("O4") = "" Then
'ULTIMONUMERO = 153
'Else
'ULTIMONUMERO = 199
'End If


Dim ws As Worksheet
    Set ws = ActiveSheet
    For Each cell In ws.Columns(12).Cells
        If cell = 0 Then
        If IsEmpty(cell) = False Then ULTIMONUMERO = cell.Row - 1: Exit For
        End If
       Next cell

Application.ScreenUpdating = False

Range("G2:H300").Select
    Selection.Copy
    Range("L6").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    'Columns("L:L").EntireColumn.AutoFit
    
    
    
    
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 80
    ActiveWindow.ScrollRow = 82
    ActiveWindow.ScrollRow = 86
    ActiveWindow.ScrollRow = 91
    ActiveWindow.ScrollRow = 93
    ActiveWindow.ScrollRow = 96
    ActiveWindow.ScrollRow = 98
    ActiveWindow.ScrollRow = 99
    ActiveWindow.ScrollRow = 100
    ActiveWindow.ScrollRow = 102
    ActiveWindow.ScrollRow = 104
    ActiveWindow.ScrollRow = 105
    ActiveWindow.ScrollRow = 106
    ActiveWindow.ScrollRow = 109
    ActiveWindow.ScrollRow = 112
    ActiveWindow.ScrollRow = 124
    ActiveWindow.ScrollRow = 126
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 133
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 140
    ActiveWindow.ScrollRow = 142
    ActiveWindow.ScrollRow = 144
    ActiveWindow.ScrollRow = 150
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 153
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 151
    ActiveWindow.ScrollRow = 150
    ActiveWindow.ScrollRow = 149
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 145
    ActiveWindow.ScrollRow = 142
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 127
    ActiveWindow.ScrollRow = 119
    ActiveWindow.ScrollRow = 111
    ActiveWindow.ScrollRow = 98
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 1
    Application.CutCopyMode = False
    
    
    
    
    'ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    'ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range("M6:M100" _
    '    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    'With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
     '   .SetRange Range("L6:M100")
     '   .Header = xlGuess
     '   .MatchCase = False
     '   .Orientation = xlTopToBottom
     '   .SortMethod = xlPinYin
     '   .Apply
    'End With
    
    ActiveSheet.Unprotect
    ' Range("L6:S207").Select
    'Selection.Sort Key1:=Range("M6"), Order1:=xlDescending, _
     '   OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    'Range("L5").Select
     '  ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
      '  , AllowSorting:=True, AllowFiltering:=True
    
    
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "M6:M" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    
    Range("N6").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("N7").Select
    ActiveCell.FormulaR1C1 = "=+R[-1]C+1"
    Range("N7").Select
    Selection.Copy
    Range("N8:N207").Select
    ActiveSheet.Paste
    Range("N6:N207").Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("L1").Select
    Selection.Copy
    Range("L1").Select
     
    
    
    
    'Selection.AutoFilter
    'Columns("M:M").EntireColumn.AutoFit
    'Range("L6:O6").Select
    'Selection.AutoFilter
    'Range("L5:O166").Select
    'ActiveWindow.ScrollRow = 138
    'ActiveWindow.ScrollRow = 134
    'ActiveWindow.ScrollRow = 101
    'ActiveWindow.ScrollRow = 55
    'ActiveWindow.ScrollRow = 38
    'ActiveWindow.ScrollRow = 37
    'ActiveWindow.ScrollRow = 32
    'ActiveWindow.ScrollRow = 25
    'ActiveWindow.ScrollRow = 16
    'ActiveWindow.ScrollRow = 15
    'ActiveWindow.ScrollRow = 11
    'ActiveWindow.ScrollRow = 9
    'ActiveWindow.ScrollRow = 6
    'ActiveWindow.ScrollRow = 5
    'ActiveWindow.ScrollRow = 4
    'ActiveWindow.ScrollRow = 1
    'Selection.AutoFilter
    Range("l1").Select
     
    Image1.Visible = False
    Image2.Visible = False
    Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"

If Sheets("COVER").Range("O4") = "" Then
If Range("C1") <> "" Then
classifiche_sostituisci_da3a2
DoEvents
CommandButton1_Click
End If
Else
If Range("C1") = "" Then
classifiche_sostituisci_da2a3
DoEvents
CommandButton1_Click
End If

End If



Application.OnKey "{F3}", "stampare"

If Sheets("COVER").Range("O4") = "" Then
ULTIMONUMERO = 140
Else
ULTIMONUMERO = 199
End If

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Foglio37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox2, 71, 0, MSForms, CheckBox"
Attribute VB_Control = "ScrollBar1, 60, 1, MSForms, ScrollBar"
Attribute VB_Control = "CheckBox1, 46, 2, MSForms, CheckBox"
Attribute VB_Control = "OptionButton2, 36, 3, MSForms, OptionButton"
Attribute VB_Control = "OptionButton1, 35, 4, MSForms, OptionButton"
Attribute VB_Control = "Label2, 28, 5, MSForms, Label"
Attribute VB_Control = "Label1, 27, 6, MSForms, Label"
Attribute VB_Control = "TextBox2, 26, 7, MSForms, TextBox"
Attribute VB_Control = "TextBox1, 1, 8, MSForms, TextBox"
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 20").Visible = True Then
ActiveSheet.ChartObjects("Grafico 20").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 20").Visible = True

End If
End Sub

Private Sub CommandButton2_Click()
'CommandButton2.AutoSize = False
'CommandButton2.AutoSize = True

'CommandButton2.AutoLoad = False
'CommandButton2.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 24").Visible = True Then
ActiveSheet.ChartObjects("Grafico 24").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 24").Visible = True

End If
End Sub



Private Sub OptionButton1_Click()
Range("n18") = ""
Range("o18") = "X"
End Sub

Private Sub OptionButton2_Click()
Range("n18") = "X"
Range("o18") = ""
End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Worksheets("BUDGETING").Calculate
Application.OnKey "{F3}", "stampare"

End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub


Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'MsgBox Target.Offset(0, 1).Address
'ActiveSheet.Shapes.Range(Array("ScrollBar1")).Select
'If Target.Address = "L20" Or Target.Address = "L21" Or Target.Address = "L24" Then
'With ActiveSheet.Shapes("ScrollBar1").ControlFormat
        '.Min = 1
        '.Max = 400
        '.SmallChange = 5
        '.LargeChange = 40
        If Target.Offset(0, 0).Address = "$L$20" Then
            ScrollBar1.LinkedCell = "$M$20"
            End If
            If Target.Offset(0, 0).Address = "$L$21" Then
            ScrollBar1.LinkedCell = "$M$21"
            End If
            
            If Target.Offset(0, 0).Address = "$L$24" Then
            ScrollBar1.LinkedCell = "$M$24"
            End If
            
    'End With
    DoEvents
    
    'MsgBox ActiveSheet.Shapes("ScrollBar1").LinkedCell
'End If
End Sub
Attribute VB_Name = "Foglio39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "TextBox1, 1, 0, MSForms, TextBox"
Attribute VB_Control = "CommandButton1, 6, 1, MSForms, CommandButton"
Attribute VB_Control = "Label1, 39, 2, MSForms, Label"
Option Explicit

Private Sub CommandButton1_Click()
Cells.Select


    Selection.Copy
    Workbooks.Add
    'ATTENTO SE METTI WINDOWS AL POSTO DI SHEETS ALCUNI EXCEL NON FANNO PARTIRE WIFROM !!!!
   ' Windows( _
        "294 CORRETTE ALTRE LIBRERIE MODULI 4 7 9 PER 64 BIT  budget 2016 32 e 64 bit.xlsm" _
        ).Activate
    On Error Resume Next
    'Sheets("Foglio1").Activate
    'Sheets("Cartel1").Activate
   'ActiveSheet.Paste
               
    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
        , SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
 'ELIMINA TUTTI I COLLEGAMENTI ALL ALTRO FOGLIO
Dim Links As Variant
Dim I As Variant
Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
For I = 1 To UBound(Links)
ActiveWorkbook.BreakLink _
    Name:=Links(I), _
    Type:=xlLinkTypeExcelLinks
Next I

    ActiveSheet.Range("A1").Select
   
'Dim Links As Variant
'Dim I
'Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
'For I = 1 To UBound(Links)
'ActiveWorkbook.BreakLink _
    'Name:=Links(I), _
    'Type:=xlLinkTypeExcelLinks
'Next I

End Sub

Private Sub CommandButton2_Click()
'CommandButton2.AutoSize = False
'CommandButton2.AutoSize = True

'CommandButton2.AutoLoad = False
'CommandButton2.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 24").Visible = True Then
ActiveSheet.ChartObjects("Grafico 24").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 24").Visible = True

End If
End Sub



Private Sub Label1_Click()
ActiveSheet.Label1.Visible = False
End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
Application.OnKey "{F3}", "stampare"
ActiveSheet.Label1.Visible = True
End Sub

'Private Sub Image1_Click()
'Image1.Visible = False
'End Sub


Private Sub Worksheet_Deactivate()
'Image1.Visible = True
End Sub


Attribute VB_Name = "Foglio4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
iniziale = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")

End Sub

Private Sub Worksheet_Calculate()
On Error Resume Next
iniziale = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
iniziale = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")
End Sub
Attribute VB_Name = "Foglio42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image1, 11, 0, MSForms, Image"
Private Sub Image1_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Image1.Visible = False
End Sub

Private Sub Worksheet_Activate()
inserito = 0
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Foglio43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image1, 7, 0, MSForms, Image"

Private Sub Image1_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ActiveSheet.Image1.Visible = False
End Sub

Private Sub Worksheet_Activate()
iniziale2 = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")

End Sub

Private Sub Worksheet_Calculate()
On Error Resume Next
iniziale2 = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
iniziale2 = Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")
End Sub
Attribute VB_Name = "Foglio44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True




Attribute VB_Name = "Foglio45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Foglio52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image1, 18, 0, MSForms, Image"
Attribute VB_Control = "TextBox1, 14, 1, MSForms, TextBox"
Attribute VB_Control = "TextBox2, 15, 2, MSForms, TextBox"
Attribute VB_Control = "TextBox3, 16, 3, MSForms, TextBox"
Attribute VB_Control = "ListBox1, 20, 4, MSForms, ListBox"







Private Sub Image1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Image1.Visible = False
End Sub

Private Sub ListBox1_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub ListBox1_Click()

'If ListBox1.List(ListBox1.ListIndex, -1) / 2 - Int(ListBox1.List(ListBox1.ListIndex, -1) / 2) = 0 Then


'MsgBox Cells(ActiveCell.Row + 1, "M").Address
''''Cells(ActiveCell.Row + 1, "M").Select
'DoEvents
'MsgBox Cells(ActiveCell.Row, "M").Address
'DoEvents

'Else




'End If
End Sub

Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'On Error Resume Next

'If ActiveCell.Column = 13 Then
'Cells(ActiveCell.Row - 1, "M").Select
'DoEvents
'Exit Sub
'End If

    
    


End Sub









Private Sub Worksheet_Activate()
Application.ScreenUpdating = False
Application.OnDoubleClick = "selectaccountsstatement"

 'perqualedisco
If xinp = 0 Then
 Sheets("INPUT Statement").ListBox1.Height = 65
Sheets("INPUT Statement").ListBox1.Width = 262
Columns("A:J").Select
    
        Selection.EntireColumn.Hidden = False
        Selection.EntireColumn.Hidden = True
End If
xinp = 0

'ThisWorkbook.Sheets("INPUT Statement").EnableCalculation = True
End Sub



Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)


Cancel = True

If ActiveCell.Column = 15 Then
Cancel = True
'ListBox1.TopIndex = Abs(Cells(Selection.End(xlUp).Row, Selection.End(xlUp).Column - 2)) + 1
pastenumbersstatement

Exit Sub
End If



'If ListBox1.List(ListBox1.ListIndex, -1) / 2 - Int(ListBox1.List(ListBox1.ListIndex, -1) / 2) = 0 Then
If ActiveCell.Column = 13 Then
If IsEmpty(ActiveCell) = True Then
ActiveCell = ListBox1.Value
End If
End If


If ActiveCell.Column = 12 Then
If IsEmpty(ActiveCell) = True Then
ActiveCell = -ListBox1.Value
End If
End If







End Sub

Private Sub Worksheet_Calculate()

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
'WRITEONFILEsicurezza
End Sub

Private Sub Worksheet_Deactivate()
'Application.OnKey "{ENTER}"
'Application.OnKey "{UP}"
'Application.OnKey "{DOWN}"
'Application.OnKey "{LEFT}"
'Application.OnKey "{RIGHT}"

Application.OnDoubleClick = ""

Sheets("INPUT Statement").ListBox1.Height = 1.65
Sheets("INPUT Statement").ListBox1.Width = 2

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)


End Sub
Attribute VB_Name = "Foglio53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label1, 20, 0, MSForms, Label"
Option Explicit

Private Sub CommandButton1_Click()

'CommandButton1.AutoSize = False
'CommandButton1.AutoSize = True

'CommandButton1.AutoLoad = False
'CommandButton1.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 20").Visible = True Then
ActiveSheet.ChartObjects("Grafico 20").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 20").Visible = True

End If
End Sub

Private Sub CommandButton2_Click()
'CommandButton2.AutoSize = False
'CommandButton2.AutoSize = True

'CommandButton2.AutoLoad = False
'CommandButton2.AutoLoad = True

If ActiveSheet.ChartObjects("Grafico 24").Visible = True Then
ActiveSheet.ChartObjects("Grafico 24").Visible = False

Else
ActiveSheet.ChartObjects("Grafico 24").Visible = True

End If
End Sub






Private Sub Label1_Click()
ActiveSheet.Label1.Visible = False
End Sub

Private Sub Worksheet_Activate()
'Application.OnKey "^{F3}", "RestoreToolbars"
ActiveSheet.Label1.Visible = True
Application.OnKey "{F3}", "stampaunoodue"
Application.OnKey "{F4}", "stampaquattro"
primaschedalite

End Sub


Private Sub Worksheet_Deactivate()
Application.OnKey "{F3}", "stampare"
Application.OnKey "{F4}", "stampareport"
End Sub


Attribute VB_Name = "Foglio54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton100_Click()
GoToWebSiteAndPlayAround
End Sub

Private Sub CommandButton200_Click()
'GoToWebSiteAndPlayAround2
End Sub

'Private Sub CommandButton300_Click()
'ReadTextFile
'End Sub

Private Sub CommandButton400_Click()
'nomecognomeemail
 
'GoToWebSiteAndPlayAround98
 

End Sub

Private Sub CommandButton300_Click()
'GoToWebSiteAndPlayAround3
End Sub

Private Sub CommandButton500_Click()
'GoToWebSiteAndPlayAround99    'nometitolareemail
End Sub

Private Sub CommandButton600_Click()
'WriteTextFile
End Sub

Private Sub CommandButton700_Click()
'ReadTextFile
End Sub



Private Sub Worksheet_Activate()
'ReadTextFile
End Sub


Attribute VB_Name = "Foglio8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()


Range("b8:c8").Hyperlinks.Delete
Range("b8:c8").ClearContents
   
keystat
End Sub

Private Sub CommandButton2_Click()
 
  
   
   Range("e8:g8").Hyperlinks.Delete
Range("e8:g8").ClearContents

    
    Range("e9:g9").Hyperlinks.Delete
Range("e9:g9").ClearContents

    '

income
End Sub

Private Sub CommandButton3_Click()
Range("b12:c12").Hyperlinks.Delete
Range("b12:c12").ClearContents

COMPETITORS
End Sub

Attribute VB_Name = "Modulo1"
Public xinp
Public dd
Public xx
Public ddd
Public inserito
Public iniziale As Integer
Public iniziale2 As Integer
Public Salvo As Integer
Public newnow
Public SONOinSI
Option Explicit
 
 'per EVITARE CHE CHIEDA DI SALVARE IN CHIUSURA IMPORTANTE
 'PERCHE' ALTRIMENTI SI POTREBBE TROVARE IL MODO DI FAR RIAPPARIRE IL MENU'
 'SEMPLICEMENTE PREMENDO ANNULLA QUANDO TI CHIEDE DI SALVARE
 'PERCHE' IN WORKBOOK BEFORE CLOSE HA GIA' RIATTIVATO I TASTI ECC
 
Sub Auto_Close()
    ThisWorkbook.Saved = True
End Sub

Public Function MBSerialNumber() As String
'SERVE PER CONOSCERE IL CODICE DELLA MOTHER BOARD DEL COMPUTER
Dim objs As Object
Dim obj As Object
Dim WMI As Object
Dim sAns As String
Set WMI = GetObject("WinMgmts:")
Set objs = WMI.InstancesOf("Win32_BaseBoard")
For Each obj In objs
    sAns = sAns & obj.SerialNumber
    If sAns < objs.Count Then sAns = sAns & ","
Next
MBSerialNumber = sAns

End Function

Public Function estraicifre(Num) As Double
'SERVE PER ESTRARRE I SOLI NUMERI DEL CODICE DELLA MOTHER BOARD DEL PC PER POTERCI APPLICARE L'ALGORITMO CHE DA' LA PASSWORD UNICA PER IL PC DI UTILIZZO
Dim t As String
Dim c As String
Dim I As Integer
Dim IsNumero As Boolean
Application.Volatile True
t = Num
c = ""
IsNumero = False
For I = 1 To Len(t)
If Mid(t, I, 1) = "," And IsNumero = True Then
c = c + ","
IsNumero = False
End If
If Mid(t, I, 1) <= "9" And Mid(t, I, 1) >= "0" Then
c = c + Mid(t, I, 1)
IsNumero = True
Else
IsNumero = False
End If
Next I
estraicifre = CDbl(c)

End Function




Sub income()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    Application.ScreenUpdating = False
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
    
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
   ' Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
   ' End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    Sheets("WORLD Quoted Data").Activate
    
    Dim I
        
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & "&annual"
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & "&annual"
        conName = "is?s=" & txtSymbols(0, I) & "+Income+Statement&annual"
        'MsgBox conString
        Sheets("WORLD Quoted Data").Range("$G$63") = "Income Statement"
      Sheets("WORLD Quoted Data").Range("$e$8") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$8"), Address:=conStr
      DoEvents
      
       conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & "&annual"
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & "&annual"
        conName = "is?s=" & txtSymbols(0, I) & "+Income+Statement&annual"
        'MsgBox conString
        Sheets("WORLD Quoted").Range("$G$63") = "Income Statement"
      Sheets("WORLD Quoted").Range("$e$8") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted").Range("$e$8"), Address:=conStr
      DoEvents
      
    
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$62"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
        Rows("62:62").Select
    ActiveSheet.Unprotect
    Selection.NumberFormat = "m/d/yyyy"
     
        
        
          If Sheets("WORLD Quoted").Range("$H$4") <> "" And Sheets("WORLD Quoted").Range("$H$4") = Sheets("WORLD Quoted").Range("$K$4") And Sheets("WORLD Quoted").Range("$H$5") = Sheets("WORLD Quoted").Range("$K$5") Then
          Exit Sub
          Else
          
          Sheets("WORLD Quoted Data").Range("g60:iv300").ClearContents
 Sheets("WORLD Quoted Data").Unprotect
 
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$64"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
        Range("H64:EK64").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
     
     End If
        
    Next I
    DoEvents
    'Sheets("WORLD Quoted Data").Range("$i$63").Select
End Sub
Sub balance()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    Application.ScreenUpdating = False
    Sheets("WORLD Quoted Data").Unprotect
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
    
   ' If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
    'LINGUA = "it."
    'Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
    'End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    
     Sheets("WORLD Quoted Data").Activate
    Dim I
        
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    
        
        
        'Sheets("WORLD Quoted Data").Range("$i$63").Select
        
        'Sheets.Add After:=Sheets(Sheets.Count)
        'ActiveSheet.Name = txtSymbols(0, i) & " BS"
         conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & "&annual"
         conStr = "http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & "&annual"
        conName = "bs?s=" & txtSymbols(0, I) & "+Balance+Sheet&annual"
        Sheets("WORLD Quoted Data").Range("$e$9") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$9"), Address:=conStr
   DoEvents
        Sheets("WORLD Quoted Data").Range("$G$115") = "Balance Sheet"
        
        
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & "&annual"
         conStr = "http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & "&annual"
        conName = "bs?s=" & txtSymbols(0, I) & "+Balance+Sheet&annual"
        Sheets("WORLD Quoted").Range("$e$9") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted").Range("$e$9"), Address:=conStr
   DoEvents
        Sheets("WORLD Quoted").Range("$G$115") = "Balance Sheet"
        
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$114"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
     DoEvents
     Range("H114:EK114").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
    
     If Sheets("WORLD Quoted").Range("$H$4") <> "" And Sheets("WORLD Quoted").Range("$H$4") = Sheets("WORLD Quoted").Range("$K$4") And Sheets("WORLD Quoted").Range("$H$5") = Sheets("WORLD Quoted").Range("$K$5") Then
          Exit Sub
          Else
                    Sheets("WORLD Quoted Data").Range("g114:iv300").ClearContents
 Sheets("WORLD Quoted Data").Unprotect
 
 With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$116"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
     DoEvents
     Range("H116:EK116").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
 End If
    Next I
    DoEvents
    Sheets("WORLD Quoted Data").Range("$i$63").Select
End Sub

Sub keystat()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Sheets("WORLD Quoted").Unprotect
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    txtSymbols(0, 2) = "CSCO"
    
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
    Dim LINGUA
    'LINGUA = "it."
   ' Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
    'End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
     Sheets("WORLD Quoted Data").Activate
    Dim I
    
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        ''''Sheets.Add After:=Sheets(Sheets.Count)
        ''''ActiveSheet.Name = txtSymbols(0, i) & " KS"
        
    
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/ks?s=" & txtSymbols(0, I) '& "+Key+Statistics"
conStr = "http://" & LINGUA & "finance.yahoo.com/q/ks?s=" & txtSymbols(0, I) '& "+Key+Statistics"
        conName = "ks?s=" & txtSymbols(0, I) & "+Key+Statistics"
     DoEvents
          
     Sheets("WORLD Quoted Data").Range("$b$8") = conStr
     ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$b$8"), Address:=conStr
     'Sheets("WORLD Quoted Data").Range("$b$8").Hyperlinks(conStr).Follow
       Sheets("WORLD Quoted Data").Range("$G$13") = "Key Statistics"
        DoEvents
        
         Sheets("WORLD Quoted").Range("$b$8") = conStr
     ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted").Range("$b$8"), Address:=conStr
     'Sheets("WORLD Quoted Data").Range("$b$8").Hyperlinks(conStr).Follow
       Sheets("WORLD Quoted").Range("$G$13") = "Key Statistics"
        DoEvents
        
        
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$14"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = True
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
    Next I
    Sheets("WORLD Quoted").Protect
    Sheets("WORLD Quoted").Activate
    
         Sheets("WORLD Quoted").Range("$i$13").Select
End Sub

Sub COMPETITORS()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    txtSymbols(0, 2) = "CSCO"
    
    Dim LINGUA
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
    'Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
   ' End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
     Sheets("WORLD Quoted Data").Activate
     Sheets("WORLD Quoted").Unprotect
    Dim I
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
       ' Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " Competitors"
        
    Sheets("WORLD Quoted Data").Range("$G$175") = "Competitors"
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/co?s=" & txtSymbols(0, I) '& "+Competitors"
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/co?s=" & txtSymbols(0, I)
        conName = "co?s=" & txtSymbols(0, I) & "+Competitors"
        DoEvents
        Sheets("WORLD Quoted Data").Range("$b$12") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$b$12"), Address:=conStr
        
        
      Sheets("WORLD Quoted").Range("$G$175") = "Competitors"
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/co?s=" & txtSymbols(0, I) '& "+Competitors"
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/co?s=" & txtSymbols(0, I)
        conName = "co?s=" & txtSymbols(0, I) & "+Competitors"
        DoEvents
        Sheets("WORLD Quoted").Range("$b$12") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted").Range("$b$12"), Address:=conStr
        
        
        
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$176"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = True
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
    Next I
    Sheets("WORLD Quoted").Protect
     Sheets("WORLD Quoted").Activate
    Sheets("WORLD Quoted").Range("$i$175").Select
End Sub

Sub FindStockSymbol()
Application.ScreenUpdating = False
'Sheets("WORLD Quoted Data").Activate

Sheets("WORLD Search ticker").Unprotect
Sheets("WORLD Quoted").Unprotect

Sheets("WORLD Quoted Data").Range("g13:iv300").ClearContents
Sheets("WORLD Quoted Data").Range("g13:iv300").ClearContents
Sheets("WORLD Quoted Data").Range("b8:c8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b8:c8").ClearContents

Sheets("WORLD Quoted Data").Range("e8:g8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e8:g8").ClearContents
    
Sheets("WORLD Quoted Data").Range("e9:g9").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e9:g9").ClearContents

Sheets("WORLD Quoted Data").Range("b12:c12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b12:c12").ClearContents

Sheets("WORLD Quoted Data").Range("E12:G12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("E12:G12").ClearContents

Sheets("WORLD Quoted").Range("b8:c8").Hyperlinks.Delete
Sheets("WORLD Quoted").Range("b8:c8").ClearContents

Sheets("WORLD Quoted").Range("b8:c8").Locked = False
    Sheets("WORLD Quoted").Range("b8:c8").FormulaHidden = False


'ActiveSheet.Unprotect
  '  Range("E8:G8").Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False
   ' Range("E9:G9").Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False
   ' Range("E12:G12").Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False


Sheets("WORLD Quoted").Range("e8:g8").Hyperlinks.Delete
Sheets("WORLD Quoted").Range("e8:g8").ClearContents
    
    Sheets("WORLD Quoted").Range("e8:g8").Locked = False
    Sheets("WORLD Quoted").Range("e8:g8").FormulaHidden = False
    
    
Sheets("WORLD Quoted").Range("e9:g9").Hyperlinks.Delete
Sheets("WORLD Quoted").Range("e9:g9").ClearContents

Sheets("WORLD Quoted").Range("e9:g9").Locked = False
    Sheets("WORLD Quoted").Range("e9:g9").FormulaHidden = False

Sheets("WORLD Quoted").Range("b12:c12").Hyperlinks.Delete
Sheets("WORLD Quoted").Range("b12:c12").ClearContents

Sheets("WORLD Quoted").Range("b12:c12").Locked = False
Sheets("WORLD Quoted").Range("b12:c12").FormulaHidden = False


Sheets("WORLD Quoted").Range("E12:G12").Hyperlinks.Delete
Sheets("WORLD Quoted").Range("E12:G12").ClearContents

Sheets("WORLD Quoted").Range("e12:g12").Locked = False
Sheets("WORLD Quoted").Range("e12:g12").FormulaHidden = False


Sheets("WORLD Quoted").Range("e12").VerticalAlignment = xlCenter
       Sheets("WORLD Quoted").Range("B12").VerticalAlignment = xlCenter


Sheets("WORLD Search ticker").Activate

Dim strSymbol As String

'Application.ScreenUpdating = True



strSymbol = [rngNameToFind]
If strSymbol <> "" Then
Range([tblWebQueryNYSESymbol].Cells(1, 1), Cells.SpecialCells(xlCellTypeLastCell)).ClearContents

Searchterm _
         strSheetName:="WORLD Search ticker", _
         strConn:="URL;http://finance.yahoo.com/lookup?s=" & strSymbol, _
         strQryTblName:="tblWebQuerySymbol", _
         strDestRange:="B3", _
         strSrcTblList:="2"
         Macro1
Else
   MsgBox "No company name entered"
End If


Sheets("WORLD Quoted").Protect
Sheets("WORLD Search ticker").Protect

End Sub
Sub pippo()
Application.ScreenUpdating = False
Sheets("WORLD Quoted Data").Range("g13:iv62").ClearContents


Sheets("WORLD Quoted Data").Range("b8:c8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b8:c8").ClearContents
'   Sheets("WORLD Quoted").Range("b8:c8").Locked = False
    'Sheets("WORLD Quoted").Range("b8:c8").FormulaHidden = False
    
   Application.ScreenUpdating = False
keystat

'Columns("h:h").ColumnWidth = 8
'Columns("J:J").ColumnWidth = 14.14
'Columns("I:I").ColumnWidth = 24
  
  Range("i13") = Range("b3")
        Application.GoTo Reference:=Range("A13"), _
 Scroll:=True
        Application.ScreenUpdating = True
End Sub
Sub pluto()

Sheets("COVER").Range("IA1") = 1
 
Application.ScreenUpdating = False
Sheets("WORLD Quoted Data").Activate
Sheets("WORLD Quoted").Unprotect

Sheets("WORLD Quoted Data").Range("g60:iv300").ClearContents

 
 Sheets("WORLD Quoted Data").Unprotect
     
   Sheets("WORLD Quoted Data").Range("e8:g8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e8:g8").ClearContents
Sheets("WORLD Quoted").Range("e8:g8").Locked = False
    Sheets("WORLD Quoted").Range("e8:g8").FormulaHidden = False
    
    Sheets("WORLD Quoted Data").Range("e9:g9").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e9:g9").ClearContents
Sheets("WORLD Quoted").Range("e9:g9").Locked = False
    Sheets("WORLD Quoted").Range("e9:g9").FormulaHidden = False

    '
Application.ScreenUpdating = False

DoEvents
income
DoEvents
Application.ScreenUpdating = False
balance
DoEvents

Columns("h:h").ColumnWidth = 8
Columns("J:J").ColumnWidth = 14.14
Columns("I:I").ColumnWidth = 24

Range("i63") = Range("b3")
Range("i115") = Range("b3")
       Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
      
         
      Application.ScreenUpdating = False
        minnie
        DoEvents
        
        Application.ScreenUpdating = False
        Cells.Select
    Selection.Replace What:="- ", Replacement:="0", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
         
 If Sheets("WORLD Quoted").Range("K65") > 0 Or Sheets("WORLD Quoted").Range("K63") > 0 Then
 Sheets("COVER").Range("ZZ2") = 2
 End If
 
  
 
 
DoEvents


Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
 DoEvents

 Application.ScreenUpdating = False
 
    Sheets("WORLD Quoted").Activate
   ' Columns("k:k").ColumnWidth = 11
'Columns("l:l").ColumnWidth = 11
'Columns("m:m").ColumnWidth = 11
'Columns("n:n").ColumnWidth = 11

    
        
    '''Sheets("WORLD Quoted").Range("H13").Select
   ''' Selection.Copy
    '''Sheets("WORLD Quoted").Range("I58:N400").Select
    '''Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
    '''    SkipBlanks:=False, Transpose:=False
        
        
        
        Range("g403:h403").Select
    Selection.Copy
        Range("K149").Select
            ActiveSheet.Paste
  
  Range("J149").Select
 
' Range("K149:L149").Select
   ' With Selection.Interior
       ' .Pattern = xlSolid
       ' .PatternColorIndex = xlAutomatic
       ' .ThemeColor = xlThemeColorDark2
        '.TintAndShade = -0.749992370372631
       ' .PatternTintAndShade = 0
    'End With
 
 
  Range("g402:h402").Select
    Application.CutCopyMode = False
    Selection.Copy
        Range("K136").Select
    ActiveSheet.Paste
    Range("J136").Select
 
 'Range("K136:L136").Select
    'With Selection.Interior
       ' .Pattern = xlSolid
       ' .PatternColorIndex = xlAutomatic
       ' .ThemeColor = xlThemeColorDark2
       ' .TintAndShade = -0.749992370372631
       ' .PatternTintAndShade = 0
   ' End With
    Range("J136").Select
    
    
    Range("g401:h401").Select
    Application.CutCopyMode = False
    Selection.Copy
        Range("K125").Select
    ActiveSheet.Paste
    
    'Range("K125:L125").Select
    'With Selection.Interior
     '   .Pattern = xlSolid
     '   .PatternColorIndex = xlAutomatic
      '  .ThemeColor = xlThemeColorDark2
      '  .TintAndShade = -0.749992370372631
      '  .PatternTintAndShade = 0
    'End With
    Range("J125").Select
    
    
    Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
 DoEvents
        
   
    Sheets("WORLD Quoted").Range("K9").Select


          
    
    
    
    
    

Sheets("WORLD Quoted").Protect


 
 Application.ScreenUpdating = True
End Sub
Sub topolino()
Application.ScreenUpdating = False
    Sheets("WORLD Quoted Data").Activate
Sheets("WORLD Quoted Data").Range("g175:iv209").ClearContents

Sheets("WORLD Quoted Data").Range("b12:c12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b12:c12").ClearContents
DoEvents

COMPETITORS
Range("i175") = Range("b3")
Application.GoTo Reference:=Range("A175"), _
 Scroll:=True
End Sub

Sub cashfs()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    Application.ScreenUpdating = False
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
        Sheets("WORLD Quoted Data").Activate
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
   ' Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
   ' End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    Dim I
        
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & "&annual"
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & "&annual"
        conName = "is?s=" & txtSymbols(0, I) & "+Cash Flow +Statement&annual"
        
        DoEvents
        'MsgBox conString
        Sheets("WORLD Quoted Data").Range("$G$210") = "Cash Flow Statement"
      Sheets("WORLD Quoted Data").Range("$e$12") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$12"), Address:=conStr
      DoEvents
      
      Sheets("WORLD Quoted").Range("$G$210") = "Cash Flow Statement"
      Sheets("WORLD Quoted").Range("$e$12") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted").Range("$e$12"), Address:=conStr
      DoEvents
      
      Sheets("WORLD Quoted").Range("e12:g12").Locked = False
    Sheets("WORLD Quoted").Range("e12:g12").FormulaHidden = False
    
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$208"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
        
        
    Next I
    DoEvents
    'Sheets("WORLD Quoted Data").Range("$i$210").Select
    Sheets("WORLD Quoted Data").Range("$i$63").Select
    Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
End Sub

Sub minnie()
 
  
   Application.ScreenUpdating = False
   Sheets("WORLD Quoted Data").Range("e12:g12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e12:g12").ClearContents

    DoEvents
    
    '
Application.ScreenUpdating = False
DoEvents
cashfs
DoEvents
Columns("h:h").ColumnWidth = 8
Columns("J:J").ColumnWidth = 14.14
Columns("I:I").ColumnWidth = 24

Range("i210") = Range("b3")

       Application.GoTo Reference:=Range("A210"), _
 Scroll:=True
      
         
        Application.ScreenUpdating = True
End Sub




Sub income2()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
    
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
    'Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
    'End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    Dim I
            Sheets("WORLD Quoted Data").Activate
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
       DoEvents
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & ""
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & ""
        conName = "is?s=" & txtSymbols(0, I) & "+Income+Statement"
        DoEvents
        'MsgBox conString
        Sheets("WORLD Quoted Data").Range("$G$63") = "Income Statement"
      Sheets("WORLD Quoted Data").Range("$e$8") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$8"), Address:=conStr
      DoEvents
      
      
       conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & ""
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/is?s=" & txtSymbols(0, I) & ""
        conName = "is?s=" & txtSymbols(0, I) & "+Income+Statement"
        DoEvents
        'MsgBox conString
        Sheets("World Quoted").Range("$G$63") = "Income Statement"
      Sheets("World Quoted").Range("$e$8") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("World Quoted").Range("$e$8"), Address:=conStr
      DoEvents
      
      
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$62"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
        Rows("62:62").Select
    ActiveSheet.Unprotect
    Selection.NumberFormat = "m/d/yyyy"
     
        
        
          If Sheets("WORLD Quoted").Range("$H$4") <> "" And Sheets("WORLD Quoted").Range("$H$4") = Sheets("WORLD Quoted").Range("$K$4") And Sheets("WORLD Quoted").Range("$H$5") = Sheets("WORLD Quoted").Range("$K$5") Then
          Exit Sub
          Else
          
          Sheets("WORLD Quoted Data").Range("g60:iv300").ClearContents
 Sheets("WORLD Quoted Data").Unprotect
 
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$64"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        DoEvents
        Range("H64:EK64").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
     
     End If
        
    Next I
    DoEvents
    Sheets("WORLD Quoted Data").Range("$i$63").Select
End Sub
Sub balance2()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
    
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
   ' Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
    'End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    Dim I
          Sheets("WORLD Quoted Data").Activate
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    DoEvents
       
        
        'Sheets("WORLD Quoted Data").Range("$i$63").Select
        
        'Sheets.Add After:=Sheets(Sheets.Count)
        'ActiveSheet.Name = txtSymbols(0, i) & " BS"
         conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & ""
         conStr = "http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & ""
        conName = "bs?s=" & txtSymbols(0, I) & "+Balance+Sheet"
        DoEvents
        Sheets("WORLD Quoted Data").Range("$e$9") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$9"), Address:=conStr
        DoEvents
        Sheets("WORLD Quoted Data").Range("$G$115") = "Balance Sheet"
        
        
        
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & ""
         conStr = "http://" & LINGUA & "finance.yahoo.com/q/bs?s=" & txtSymbols(0, I) & ""
        conName = "bs?s=" & txtSymbols(0, I) & "+Balance+Sheet"
        DoEvents
        Sheets("World Quoted").Range("$e$9") = conStr
        ActiveSheet.Hyperlinks.Add Anchor:=Sheets("World Quoted").Range("$e$9"), Address:=conStr
        DoEvents
        Sheets("World Quoted").Range("$G$115") = "Balance Sheet"
        
        
        
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$114"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
     DoEvents
     Range("H114:EK114").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
    
     If Sheets("WORLD Quoted").Range("$H$4") <> "" And Sheets("WORLD Quoted").Range("$H$4") = Sheets("WORLD Quoted").Range("$K$4") And Sheets("WORLD Quoted").Range("$H$5") = Sheets("WORLD Quoted").Range("$K$5") Then
          Exit Sub
          Else
                    Sheets("WORLD Quoted Data").Range("g114:iv300").ClearContents
 Sheets("WORLD Quoted Data").Unprotect
 
 With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$116"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = False
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
     DoEvents
     Range("H116:EK116").Select
   Sheets("WORLD Quoted").Unprotect
    Selection.NumberFormat = "m/d/yyyy"
 End If
    Next I
    DoEvents
    Sheets("WORLD Quoted Data").Range("$i$63").Select
End Sub

Sub pluto2()
 Sheets("COVER").Range("IA1") = 1
Application.ScreenUpdating = False
Sheets("WORLD Quoted Data").Activate
Sheets("WORLD Quoted").Unprotect
Sheets("WORLD Quoted Data").Range("g60:iv300").ClearContents

 
 
     
   Sheets("WORLD Quoted Data").Range("e8:g8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e8:g8").ClearContents
Sheets("WORLD Quoted").Range("e8:g8").Locked = False
    Sheets("WORLD Quoted").Range("e8:g8").FormulaHidden = False

    
    Sheets("WORLD Quoted Data").Range("e9:g9").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e9:g9").ClearContents
Sheets("WORLD Quoted").Range("e9:g9").Locked = False
    Sheets("WORLD Quoted").Range("e9:g9").FormulaHidden = False

    '
Application.ScreenUpdating = False

DoEvents
income2
DoEvents
balance2
DoEvents

Columns("h:h").ColumnWidth = 8
Columns("J:J").ColumnWidth = 14.14
Columns("I:I").ColumnWidth = 24

Range("i63") = Range("b3")
Range("i115") = Range("b3")
       Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
      
         
        DoEvents
        minnie2
        DoEvents
        
        Application.ScreenUpdating = False
        Cells.Select
    Selection.Replace What:="- ", Replacement:="0", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
         
If Sheets("WORLD Quoted").Range("K65") > 0 Or Sheets("WORLD Quoted").Range("K63") > 0 Then
 Sheets("COVER").Range("ZZ2") = 2
 End If
 
  
 
DoEvents

Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
 DoEvents

 Sheets("WORLD Quoted").Activate
'    Columns("k:k").ColumnWidth = 11
'Columns("l:l").ColumnWidth = 11
'Columns("m:m").ColumnWidth = 11
'Columns("n:n").ColumnWidth = 11

        
   ''' Sheets("WORLD Quoted").Range("H13").Select
    '''Selection.Copy
    '''Sheets("WORLD Quoted").Range("I58:N400").Select
    '''Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
      '''  SkipBlanks:=False, Transpose:=False
        
        
        
        Range("g403:h403").Select
    Selection.Copy
        Range("K149").Select
            ActiveSheet.Paste
  
  Range("J149").Select
 
' Range("K149:L149").Select
   ' With Selection.Interior
       ' .Pattern = xlSolid
       ' .PatternColorIndex = xlAutomatic
       ' .ThemeColor = xlThemeColorDark2
        '.TintAndShade = -0.749992370372631
       ' .PatternTintAndShade = 0
    'End With
 
 
  Range("g402:h402").Select
    Application.CutCopyMode = False
    Selection.Copy
        Range("K136").Select
    ActiveSheet.Paste
    Range("J136").Select
 
 'Range("K136:L136").Select
    'With Selection.Interior
       ' .Pattern = xlSolid
       ' .PatternColorIndex = xlAutomatic
       ' .ThemeColor = xlThemeColorDark2
       ' .TintAndShade = -0.749992370372631
       ' .PatternTintAndShade = 0
   ' End With
    Range("J136").Select
    
    
    Range("g401:h401").Select
    Application.CutCopyMode = False
    Selection.Copy
        Range("K125").Select
    ActiveSheet.Paste
    
    'Range("K125:L125").Select
    'With Selection.Interior
     '   .Pattern = xlSolid
     '   .PatternColorIndex = xlAutomatic
      '  .ThemeColor = xlThemeColorDark2
      '  .TintAndShade = -0.749992370372631
      '  .PatternTintAndShade = 0
    'End With
    Range("J125").Select
    
    
    Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
 DoEvents
        
   
    Sheets("WORLD Quoted").Range("K9").Select


          
    
    Sheets("WORLD Quoted").Protect
    
    
    




 Application.ScreenUpdating = True
End Sub

Sub cashfs2()
    Dim conString As String
    Dim conStr As String
    Dim conName As String
    Dim txtSymbols(0, 2) As String
    Dim LINGUA
    txtSymbols(0, 1) = Sheets("WORLD Quoted Data").Range("A3")
    
    txtSymbols(0, 2) = "CSCO"
    
    'If Sheets("WORLD Quoted Data").Range("$f$3") = "I" Or Sheets("WORLD Quoted Data").Range("$f$3") = "i" Then
   ' LINGUA = "it."
    'Else
    LINGUA = Sheets("WORLD Quoted Data").Range("$f$3")
   ' End If
    LINGUA = RTrim(LINGUA)
    LINGUA = LTrim(LINGUA)
    
    Dim I
        
    For I = 1 To 1 'ANZICH|fffd| 2 PER FARE SOLO 1 SIMBOLO ALLA VOLTA
        
        'Sheets.Add After:=Sheets(Sheets.Count)
       ' ActiveSheet.Name = txtSymbols(0, i) & " IS"
            
    
        conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & ""
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & ""
        conName = "is?s=" & txtSymbols(0, I) & "+Cash Flow +Statement"
        'MsgBox conString
        Sheets("WORLD Quoted Data").Range("$G$210") = "Cash Flow Statement"
      Sheets("WORLD Quoted Data").Range("$e$12") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("WORLD Quoted Data").Range("$e$12"), Address:=conStr
      
      
       conString = "URL;http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & ""
        conStr = "http://" & LINGUA & "finance.yahoo.com/q/cf?s=" & txtSymbols(0, I) & ""
        conName = "is?s=" & txtSymbols(0, I) & "+Cash Flow +Statement"
        'MsgBox conString
        Sheets("World Quoted").Range("$G$210") = "Cash Flow Statement"
      Sheets("World Quoted").Range("$e$12") = conStr
      ActiveSheet.Hyperlinks.Add Anchor:=Sheets("World Quoted").Range("$e$12"), Address:=conStr
   
      Sheets("WORLD Quoted").Range("e12:g12").Locked = False
    Sheets("WORLD Quoted").Range("e12:g12").FormulaHidden = False

      
      
        With ActiveSheet.QueryTables.Add(Connection:=conString, Destination:=Range("$i$208"))
            .Name = conName
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = True
            .RefreshStyle = xlOverwriteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            .WebSelectionType = xlSpecifiedTables
            .WebFormatting = xlWebFormattingNone
            .WebTables = """yfncsubtit"",8,10,11,13,15,17,19,21,23"
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = False
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        End With
        
        
        
    Next I
    DoEvents
    'Sheets("WORLD Quoted Data").Range("$i$210").Select
    Sheets("WORLD Quoted Data").Range("$i$63").Select
    Application.GoTo Reference:=Range("A63"), _
 Scroll:=True
End Sub

Sub minnie2()
 
  
   
   Sheets("WORLD Quoted Data").Range("e12:g12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e12:g12").ClearContents

    
    
    '
Application.ScreenUpdating = False

cashfs2

Columns("h:h").ColumnWidth = 8
Columns("J:J").ColumnWidth = 14.14
Columns("I:I").ColumnWidth = 24

Range("i210") = Range("b3")

       Application.GoTo Reference:=Range("A210"), _
 Scroll:=True
      
         
        Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "Modulo10"

Sub idcard()

On Error Resume Next

If Range("F17") <> 0 Then

If Range("F17") <> "xxx" Then
ThisWorkbook.FollowHyperlink "http://www.google.com/search?q=" & Range("F17").Text
End If

DoEvents
End If

ThisWorkbook.FollowHyperlink "http://www.google.com/search?q=" & Range("F1").Text
DoEvents
End Sub

Sub grafwork()


If Sheets("how does it work").ChartObjects("Grafico 9").Visible = True Then
Sheets("how does it work").ChartObjects("Grafico 9").Visible = False
Else
Sheets("how does it work").ChartObjects("Grafico 9").Visible = True
End If

If Sheets("how does it work").ChartObjects("Grafico 10").Visible = True Then
Sheets("how does it work").ChartObjects("Grafico 10").Visible = False
Else
Sheets("how does it work").ChartObjects("Grafico 10").Visible = True
End If

If Sheets("how does it work").ChartObjects("Grafico 26").Visible = True Then
Sheets("how does it work").ChartObjects("Grafico 26").Visible = False
Else
Sheets("how does it work").ChartObjects("Grafico 26").Visible = True
End If

End Sub

Sub grafpay()

If Sheets("how does it pay").ChartObjects("Grafico 6").Visible = True Then
Sheets("how does it pay").ChartObjects("Grafico 6").Visible = False
Else
Sheets("how does it pay").ChartObjects("Grafico 6").Visible = True
End If

If Sheets("how does it pay").ChartObjects("Grafico 8").Visible = True Then
Sheets("how does it pay").ChartObjects("Grafico 8").Visible = False
Else
Sheets("how does it pay").ChartObjects("Grafico 8").Visible = True


End If
End Sub

Sub grafworth()


If Sheets("how much it's worth ").ChartObjects("Grafico 4").Visible = True Then
Sheets("how much it's worth ").ChartObjects("Grafico 4").Visible = False
Else

'Application.ScreenUpdating = False
'ActiveSheet.Range("k28") = FALSO
'DoEvents
Sheets("how much it's worth ").ChartObjects("Grafico 4").Visible = True
'Application.ScreenUpdating = True

End If
End Sub

Sub grafworth2()


If Sheets("how much it's w. after Budget").ChartObjects("Grafico 8").Visible = True Then


Sheets("how much it's w. after Budget").ChartObjects("Grafico 8").Visible = False
Else

'Application.ScreenUpdating = False
'ActiveSheet.Range("k28") = FALSO
'DoEvents
Sheets("how much it's w. after Budget").ChartObjects("Grafico 8").Visible = True
'Application.ScreenUpdating = True

End If
End Sub

Sub grafforecast()

If Sheets("full screening").ChartObjects("Grafico 20").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 20").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 20").Visible = True

End If
End Sub

Sub grafcompetit()

If Sheets("full screening").ChartObjects("Grafico 24").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 24").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 24").Visible = True

End If
End Sub
Sub grafsagomino()
GoTo qui
If Sheets("full screening").ChartObjects("Grafico 26").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 26").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 26").Visible = True

End If
qui:

If Sheets("full screening").ChartObjects("Grafico 35").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 35").Visible = False

Else
ActiveWindow.Zoom = 50
ActiveSheet.Range("A2").Select
ActiveWindow.ScrollRow = Selection.Row
Sheets("full screening").ChartObjects("Grafico 35").Visible = True

End If
End Sub
Sub grafsagomino2()
GoTo qui
If Sheets("full screening").ChartObjects("Grafico 28").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 28").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 28").Visible = True

End If
qui:

If Sheets("full screening").ChartObjects("Grafico 36").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 36").Visible = False

Else
ActiveWindow.Zoom = 50
ActiveSheet.Range("A2").Select
ActiveWindow.ScrollRow = Selection.Row
Sheets("full screening").ChartObjects("Grafico 36").Visible = True

End If
End Sub
Sub grafsagomino3()
GoTo qui
If Sheets("full screening").ChartObjects("Grafico 30").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 30").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 30").Visible = True

End If
qui:

If Sheets("full screening").ChartObjects("Grafico 37").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 37").Visible = False

Else
ActiveWindow.Zoom = 50
ActiveSheet.Range("A2").Select
ActiveWindow.ScrollRow = Selection.Row
Sheets("full screening").ChartObjects("Grafico 37").Visible = True

End If
End Sub
Sub grafsagomino4()

If Sheets("full screening").ChartObjects("Grafico 32").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 32").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 32").Visible = True

End If
End Sub
Sub grafsagomino44()

If Sheets("full screening").ChartObjects("Grafico 61").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 61").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 61").Visible = True

End If
End Sub


Sub grafforecastBUD()

If Sheets("BUDGETING").ChartObjects("Grafico 35").Visible = True Then
Sheets("BUDGETING").ChartObjects("Grafico 35").Visible = False

Else
Sheets("BUDGETING").ChartObjects("Grafico 35").Visible = True

End If
End Sub

Sub grafcompetitBUD()

If Sheets("BUDGETING").ChartObjects("Grafico 33").Visible = True Then
Sheets("BUDGETING").ChartObjects("Grafico 33").Visible = False

Else
Sheets("BUDGETING").ChartObjects("Grafico 33").Visible = True

End If
End Sub


Sub helpme()
Sheets("cover").Activate
ActiveWindow.ScrollRow = 28
'Sheets("cover").Label1.Visible = False

'ActiveSheet.Range("a29").Select
End Sub

Sub RITORNA()
 'Label1.Visible = True
ActiveSheet.Range("a1").Select
End Sub

Sub grafsagomino5()

If Sheets("full screening").ChartObjects("Grafico 26").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 26").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 26").Visible = True

End If
Exit Sub
If Sheets("full screening").ChartObjects("Grafico 35").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 35").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 35").Visible = True

End If
End Sub
Sub grafsagomino6()

If Sheets("full screening").ChartObjects("Grafico 28").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 28").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 28").Visible = True

End If
Exit Sub
If Sheets("full screening").ChartObjects("Grafico 36").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 36").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 36").Visible = True

End If
End Sub
Sub grafsagomino7()

If Sheets("full screening").ChartObjects("Grafico 30").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 30").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 30").Visible = True

End If
Exit Sub
If Sheets("full screening").ChartObjects("Grafico 37").Visible = True Then
Sheets("full screening").ChartObjects("Grafico 37").Visible = False

Else
Sheets("full screening").ChartObjects("Grafico 37").Visible = True

End If
End Sub

Attribute VB_Name = "Modulo100"
Sub VEDEREBARRAFORMULA()
Attribute VEDEREBARRAFORMULA.VB_ProcData.VB_Invoke_Func = "f\n14"
'
' Macro77 Macro
'

'
If Application.DisplayFormulaBar = False Then
    Application.DisplayFormulaBar = True
    Else
    Application.DisplayFormulaBar = False
    End If
    
End Sub
Attribute VB_Name = "Modulo101"
Sub Macro77()
Attribute Macro77.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro77 Macro
'

'
    Windows("Cartel1").Activate
    Range("F86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    Range("H86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    Range("J86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    Range("J87").Select
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 2
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo102"
Sub Macro78()
Attribute Macro78.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro78 Macro
'

'
    ActiveWindow.SmallScroll ToRight:=3
    ActiveSheet.Shapes.Range(Array("Button 18")).Select
    Range("G3").Select
End Sub
Sub copiajobschart()
Attribute copiajobschart.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro79 Macro
'

'

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

On Error Resume Next

Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
MsgBox "Press the button Cut Excel Sheet before!"
Exit Sub
End If
Application.ScreenUpdating = False
ActiveSheet.Unprotect ("ballaredo55")
ActiveSheet.Unprotect

Sheets("full screening").ChartObjects("Grafico 32").Visible = True
    ActiveSheet.ChartObjects("Grafico 32").Activate
    ActiveSheet.ChartObjects("Grafico 32").Activate
    ActiveChart.ChartArea.Copy
    
   ' ActiveWindow.SmallScroll ToRight:=4
    'ActiveWindow.SmallScroll Down:=-6
    ActiveWindow.ActivateNext
    Range("L8").Select
    ActiveSheet.Paste
    
    
    
    
   ' DA QUI PRESO DA SOTTO QUANDO HO MESSO L'EXITSUB QUI PERCHE' NON MI INTERESSAVA LA STORIA DEL CHECK
    
    'ELIMINA I COLLEGAMENTI ALL ALTRO FOGLIO
    Dim Links As Variant
Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
For I = 1 To UBound(Links)
ActiveWorkbook.BreakLink _
    Name:=Links(I), _
    Type:=xlLinkTypeExcelLinks
Next I
   
    Range("a1").Select
     DoEvents
   Windows(MIONOME).Activate
   DoEvents
       Range("G3").Select
        'ActiveSheet.Unprotect ("ballaredo55")
    ActiveSheet.Protect ("ballaredo55")
    ' A QUI PRESO DA SOTTO QUANDO HO MESSO L'EXITSUB QUI PERCHE' NON MI INTERESSAVA LA STORIA DEL CHECK
    
    Exit Sub
    
    'ActiveWindow.SmallScroll ToRight:=6
    'Application.WindowState = xlMaximized
    
    For I = 1 To ActiveSheet.ChartObjects.Count
    Next I
    
    ActiveSheet.ChartObjects(I).Activate
    
    'ActiveSheet.ChartObjects("Grafico 1").Activate
    'ActiveSheet.ChartObjects("Grafico 9").Activate
    
    
    ActiveChart.PlotArea.Select
    ActiveChart.FullSeriesCollection(1).Values = "=Foglio1!$AC$1"
    ActiveChart.FullSeriesCollection(2).Values = "=Foglio1!$AD$1"
    
    ActiveChart.FullSeriesCollection(2).DataLabels.Select
    Application.CommandBars("Format Object").Visible = False
    ActiveChart.FullSeriesCollection(2).DataLabels.Select
    ActiveChart.SeriesCollection(2).DataLabels.Format.TextFrame2.TextRange. _
        InsertChartField msoChartFieldRange, "=Foglio1!$AF$1", 0
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    Application.CommandBars("Format Object").Visible = False
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.SeriesCollection(1).DataLabels.Format.TextFrame2.TextRange. _
        InsertChartField msoChartFieldRange, "=Foglio1!$AE$1", 0
    
    Dim MIONOME2
    MIONOME2 = Application.ActiveWorkbook.Name
    
   ' ActiveWindow.SmallScroll ToRight:=-10
   DoEvents
   Windows(MIONOME).Activate
   DoEvents
   
   ActiveSheet.Shapes.Range(Array("CheckBox1")).Select
    Application.CutCopyMode = False
    Selection.Copy
    DoEvents
    Windows(MIONOME2).Activate
    DoEvents
    Range("A13").Select
    ActiveSheet.Paste
    DoEvents
    Range("G3").Select
   
     DoEvents
   Windows(MIONOME).Activate
   DoEvents
   
    Range("G3").Select
    
    'ActiveSheet.Unprotect ("ballaredo55")
    ActiveSheet.Protect ("ballaredo55")
    
    'Application.WindowState = xlNormal
    'ActiveWindow.SmallScroll ToRight:=2
End Sub

Sub Macro81()
Attribute Macro81.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro81 Macro
'

'
    Windows("Cartel4").Activate
    ActiveChart.FullSeriesCollection(2).DataLabels.Select
    Application.CommandBars("Format Object").Visible = False
    ActiveChart.FullSeriesCollection(2).DataLabels.Select
    ActiveChart.SeriesCollection(2).DataLabels.Format.TextFrame2.TextRange. _
        InsertChartField msoChartFieldRange, "=Foglio1!$AF$1", 0
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    Application.CommandBars("Format Object").Visible = False
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.SeriesCollection(1).DataLabels.Format.TextFrame2.TextRange. _
        InsertChartField msoChartFieldRange, "=Foglio1!$AE$1", 0
    Range("G3").Select
    Windows("934.xlsm").Activate
End Sub
Attribute VB_Name = "Modulo103"
Sub Macro79()
Attribute Macro79.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro79 Macro
'

'

    ActiveSheet.ChartObjects("Grafico 32").Activate
    ActiveSheet.ChartObjects("Grafico 32").Activate
    ActiveChart.ChartArea.Copy
    Range("G3").Select
    Windows("Cartel5").Activate
    Range("L8:N8").Select
    ActiveSheet.Paste
End Sub
Attribute VB_Name = "Modulo104"
Sub Macro80()
Attribute Macro80.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro80 Macro
'

'
    ActiveSheet.Range("$L$1:$P$4095").AutoFilter Field:=2, Criteria1:=Array("0" _
        , "1", "10", "100", "101", "102", "103", "104", "105", "108", "109", "117", "118", "119", _
        "120", "121", "-121", "125", "-125", "126", "-126", "127", "128", "-128", "129", "13", _
        "130", "-130", "131", "-131", "132", "-132", "133", "-133", "134", "-134", "139", "14", _
        "140", "-140", "141", "-141", "145", "146", "-146", "15", "150", "152", "-152", "-153", _
        "155", "-155", "16", "160", "-160", "162", "-162", "165", "17", "20", "21", "22", "23", "24" _
        , "25", "26", "27", "3", "33", "34", "35", "36", "37", "4", "40", "41", "42", "43", "44", "45", _
        "-45", "48", "49", "5", "50", "51", "52", "55", "6", "60", "68", "-68", "69", "7", "70", "71", _
        "74", "75", "78", "79", "8", "80", "83", "85", "86", "87", "88", "89", "9", "90", "91", "92", _
        "93", "94", "95", "96", "97", "98", "99"), Operator:=xlFilterValues
End Sub
Sub Macro82()
Attribute Macro82.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro82 Macro
'

'
    ActiveSheet.Range("$L$1:$P$4095").AutoFilter Field:=2, Criteria1:="<>-", _
        Operator:=xlAnd, Criteria2:="<>"
End Sub
Attribute VB_Name = "Modulo105"
Sub Macro83()
Attribute Macro83.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro83 Macro
'

'
    ActiveSheet.Range("l:p").AutoFilter Field:=2, Criteria1:=("<>-"), Operator:=xlFilterValues
    ActiveSheet.Range("l:p").AutoFilter Field:=3, Criteria1:=(WrdArray(III)), Operator _
        :=xlFilterValues
End Sub
Attribute VB_Name = "Modulo106"
Sub Macro84()
Attribute Macro84.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro84 Macro
'

'
    'Range("L23:P23").Select
   ' ActiveCell.FormulaR1C1 = clipboard
    'Range("L25:P25").Select
    
    
    
    
    

'Set MyData = New DataObject
'MyData.SetText ""
'MyData.PutInClipboard

'This is how to get the text on the clipboard into a string variable:


Dim MyData As DataObject
Dim strClip As String

Set MyData = New DataObject
MyData.GetFromClipboard
strClip = MyData.GetText
ActiveCell.FormulaR1C1 = strClip
End Sub
Attribute VB_Name = "Modulo107"
Sub Pulsante19_Click()
Dim paswo

paswo = InputBox("Enter password to import SAP data")
If paswo <> "ASCOT" Then
Exit Sub
End If



Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If






Dim disco


disco = InputBox("The letter of disk from wich to read? (without : please)")
  
  If disco = "" Then
  Windows(MIONOME).Activate
  Sheets("INPUT Statement").Select
  Application.Cursor = xlDefault          ' Puntatore normale

Application.Visible = True
DoEvents
Application.ScreenUpdating = True
DoEvents
    Exit Sub
End If
    
    'The full path of the text file that will be opened
    '''sFName = disco & ":\users\public\PROVARE.txt"
    
    '----------
    Dim intChoice As Integer
Dim strPath As String


ChDir "c:\users\public\"
 
MsgBox "Il file PROVA ASCOT 5.xls  deve essere nella directory c:\users\public\ "


Application.ScreenUpdating = False

On Error GoTo fuori
Workbooks.Open Filename:="c:\users\public\PROVA ASCOT 5.xls"
On Error GoTo 0

'only allow the user to select one file

'make the file dialog visible to the user
MsgBox "Scegliere il file in formato xls proveniente da SAP"
With Application.FileDialog(msoFileDialogOpen)
.AllowMultiSelect = False
.Filters.Add "Text File", "*.xls"
.FilterIndex = 1
If disco <> "c" And disco <> "C" Then
ChDir disco & ":\"
.InitialFileName = disco & ":\*.xls"
Else
'ChDir "c:\users\public\"
.InitialFileName = "c:\users\public\*.xls"
End If


intChoice = .Show
End With


   
    

'determine what choice the user made
If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
        
        MsgBox "E' necessario aprire il file in formato xls proveniente da SAP"
        Windows(MIONOME).Activate
        Sheets("INPUT Statement").Select
        Application.Cursor = xlDefault          ' Puntatore normale

Application.Visible = True
DoEvents
Application.ScreenUpdating = True
DoEvents
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath














Application.Visible = False
DoEvents
Application.ScreenUpdating = False
DoEvents

MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
    Application.Cursor = xlWait              ' Clessidra
'Application.Cursor = xlDefault          ' Puntatore normale

'Application.Visible = true
'DoEvents
'Application.ScreenUpdating = true
'DoEvents



Workbooks.Open Filename:=SFNAME

FileNameFromPath = Right(SFNAME, Len(SFNAME) - InStrRev(SFNAME, "\"))



Dim fileNa As String
fileNa = FileNameFromPath


Application.Visible = False
DoEvents
Application.ScreenUpdating = False
DoEvents


'Application.Cursor = xlDefault          ' Puntatore normale

'Application.Visible = true
'DoEvents
'Application.ScreenUpdating = true
'DoEvents

'-----------

    Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Windows(MIONOME).Activate
    Sheets("INPUT Statement").Select
    Range("O1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("P1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    'Windows("prova sp 5.XLS").Activate
    Windows(fileNa).Activate
    
    
    Range("A7").Select
    Application.CutCopyMode = False
    Selection.Copy
    Windows(MIONOME).Activate
    Sheets("INPUT Statement").Select
    Range("O2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("P2").Select
     Windows(fileNa).Activate
    Range("A8").Select
    Application.CutCopyMode = False
    Selection.Copy
    Windows(MIONOME).Activate
    Sheets("INPUT Statement").Select
    Range("P2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O1").Select

'-----------
   

    Windows(fileNa).Activate
    Columns("A:N").Select
    Selection.Copy
     Windows("PROVA ASCOT 5.xls").Activate
    Sheets("Foglio 0").Select
    
     Application.Range("A1").Select
    
     
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 8
    Columns("P:P").Select
    Application.CutCopyMode = False
    Selection.AutoFilter
    Range("P1").Select
    ActiveSheet.Range("$P$1:$P$6104").AutoFilter Field:=1, Criteria1:="<>"
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 1
    Columns("A:S").Select
    ActiveWindow.SmallScroll ToRight:=1
    Selection.Copy
    Sheets("Foglio1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("S1").Select
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 8
    ActiveSheet.Range("W:W").AutoFilter Field:=1, Criteria1:="<>"
    Range("W4:Z4").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 103
    ActiveWindow.ScrollRow = 113
    ActiveWindow.ScrollRow = 121
    ActiveWindow.ScrollRow = 131
    ActiveWindow.ScrollRow = 140
    ActiveWindow.ScrollRow = 167
    ActiveWindow.ScrollRow = 175
    ActiveWindow.ScrollRow = 182
    ActiveWindow.ScrollRow = 188
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 197
    ActiveWindow.ScrollRow = 221
    ActiveWindow.ScrollRow = 224
    ActiveWindow.ScrollRow = 227
    ActiveWindow.ScrollRow = 228
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 231
    ActiveWindow.SmallScroll Down:=8
    Range("W4:Z263").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Windows(MIONOME).Activate
    Sheets("INPUT Statement").Select
    Range("M4040").Select
    Windows("PROVA ASCOT 5.xls").Activate
    Selection.Copy
    Windows(MIONOME).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("M4040").Select
    Windows(MIONOME).Activate
    Application.Cursor = xlDefault          ' Puntatore normale

Application.Visible = True
DoEvents
Application.ScreenUpdating = True
DoEvents
    Exit Sub
fuori:
    MsgBox "File c:\users\public\PROVA ASCOT 5.xls non trovato"
    Windows(MIONOME).Activate
    Sheets("COVER").Select
     Application.Cursor = xlDefault          ' Puntatore normale

Application.Visible = True
DoEvents
Application.ScreenUpdating = True
DoEvents
End Sub
Attribute VB_Name = "Modulo108"
Sub Macro85()
Attribute Macro85.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro85 Macro
'

'
    Windows("prova sp 5.xls").Activate
    ActiveWindow.ActivateNext
End Sub
Sub Macro86()
Attribute Macro86.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro86 Macro
'

'
    
    ActiveWindow.ActivateNext
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("P1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.ActivateNext
    Range("A7").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("O2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("P2").Select
    ActiveWindow.ActivateNext
    Range("A8").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O1").Select
End Sub
Attribute VB_Name = "Modulo109"
Function Col_Letter(lngCol As Long) As String
    Dim vArr
    vArr = Split(Cells(1, lngCol).Address(True, False), "$")
    Col_Letter = vArr(0)
End Function
Sub incollaindici()
Attribute incollaindici.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro87 Macro
'

'

Dim LastCol As Long
    With ActiveSheet
        LastCol = .Cells(7, .Columns.Count).End(xlToLeft).Column
    End With
    LastCol = LastCol + 1
    
    If LastCol = 6 Then
    LastCol = 9
    End If
    
    'MsgBox LastCol
    'Exit Sub
    
    Range("C7:C43").Select
    
    Selection.Copy
    
    
   Range(Col_Letter(LastCol) & "7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("C2:E2").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    
    Range(Col_Letter(LastCol) & "2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("C2:E2").Select
End Sub


Sub cancellaindici()

On Error Resume Next

Dim LastCol As Long
    With ActiveSheet
        LastCol = .Cells(7, .Columns.Count).End(xlToLeft).Column
    End With
    
    
    Range("I2:" & Col_Letter(LastCol) & "43").ClearContents
   ' ActiveSheet.Protect ("ballaredo55")
    
End Sub

Sub graficodaindici()
    If ActiveCell.Row < 7 Then
MsgBox "Scegli la riga con i dati da mettere in grafico; go to the row wit data to design in chart"
Exit Sub
End If

ActiveSheet.Unprotect ("ballaredo55")
   

Dim LastCol As Long
    With ActiveSheet
        LastCol = .Cells(7, .Columns.Count).End(xlToLeft).Column
    End With
    
    
    Range("I" & (ActiveCell.Row) & ":" & Col_Letter(LastCol) & (ActiveCell.Row) & ",I2:" & Col_Letter(LastCol) & "2").Select
    
    Dim ciao As String
   ciao = Range("B" & (ActiveCell.Row))
    
    Dim RANG1 As Range
    Dim RANG2 As Range
    
    
    Set RANG1 = Range("I" & (ActiveCell.Row) & ":" & Col_Letter(LastCol) & (ActiveCell.Row))
    
    Set RANG2 = Range("I2:" & Col_Letter(LastCol) & "2")
    
    'MsgBox ("I" & (ActiveCell.Row) & ":" & Col_Letter(LastCol) & (ActiveCell.Row))
    'MsgBox ("I2:" & Col_Letter(LastCol) & "2")
    
    Range("I2").Activate
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    Range("I7:K7").Select
    ActiveSheet.Shapes.AddChart.Select
    ActiveChart.SetSourceData Source:=RANG1
    ActiveChart.ChartType = xlColumnClustered
    ActiveChart.ClearToMatchStyle
    ActiveChart.ChartStyle = 16
    ActiveChart.ClearToMatchStyle
    ActiveChart.PlotArea.Select
    ActiveChart.SeriesCollection(1).Name = ciao
     'ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Legend.Select
    Selection.Delete
    ''''''''''''''''''''"='Standard Ratios'!$B$8"
    Range("A1").Select
    
    
    ''''''''''''''''''''''''''''''''''''''''''ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select
    'ActiveChart.SetSourceData Source:=Range( _
        "'Standard Ratios'!$I$15:$M$15,'Standard Ratios'!$I$2:$M$2")
      ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''ActiveChart.ClearToMatchStyle
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''ActiveChart.ChartStyle = 340



'ActiveChart.SetSourceData Source:=Range( _
        "'Standard Ratios'!" & RANG1 & ",'Standard Ratios'!" & RANG2)
         
         
'''''''''''''''''''''''''''''''''''''''''''''''''''''    ActiveChart.ChartTitle.Select
   ' Range("B" & (ActiveCell.Row)).Select
    'Application.CutCopyMode = False
    'Selection.Copy
    'ActiveSheet.ChartObjects("Grafico 1").Activate
    'ActiveChart.ChartTitle.Select
   ' ActiveChart.Paste
   
  
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''ActiveChart.ChartTitle.Text = ciao
    Range("C2:E2").Select
    ActiveSheet.Protect Password:="ballaredo55", DrawingObjects:=False, Contents:=True, Scenarios:= _
        False
     'ActiveSheet.Protect ("ballaredo55")

End Sub

Attribute VB_Name = "Modulo11"
Sub Macro1()
'
' Macro1 Macro
'

'

Application.ScreenUpdating = False
    Range("B3:G68").Select
    With Selection.Font
        .Name = "Arial"
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    Columns("C:C").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("B3").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    Range("B3:G68").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ThemeColor = 4
        .TintAndShade = 0.599963377788629
        .Weight = xlThin
    End With
    Application.GoTo Reference:=Range("A1"), _
 Scroll:=True
 Range("B1").Select
        Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Modulo110"
Sub macro88()
Attribute macro88.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro88 Macro
'

'
    Range("I15:M15,I2:M2").Select
    Range("I2").Activate
    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select
    ActiveChart.SetSourceData Source:=Range( _
        "'Standard Ratios'!$I$15:$M$15,'Standard Ratios'!$I$2:$M$2")
    ActiveChart.ChartTitle.Select
    Range("B15").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.ChartTitle.Select
    ActiveChart.Paste
    ActiveChart.ChartTitle.Text = "gg.Incasso     "
    Range("C2:E2").Select
End Sub
Sub Macro89()
Attribute Macro89.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro89 Macro
'

'
    ActiveChart.ClearToMatchStyle
    ActiveChart.ChartStyle = 340
End Sub
Attribute VB_Name = "Modulo111"
Sub Macro92()
Attribute Macro92.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro92 Macro
'

'
    ActiveChart.ClearToMatchStyle
    ActiveChart.ChartType = xlColumnClustered
    ActiveSheet.Shapes("Grafico 10").ScaleHeight 1.0989533679, msoFalse, _
        msoScaleFromTopLeft
    ActiveChart.Axes(xlCategory).Select
    ActiveChart.Axes(xlCategory).HasMajorGridlines = True
    ActiveChart.ChartArea.Select
    ActiveChart.Axes(xlCategory).Select
    ActiveChart.Axes(xlCategory).CategoryType = xlCategoryScale
    ActiveChart.Axes(xlCategory).CategoryType = xlAutomatic
    ActiveChart.Axes(xlCategory).TickLabelSpacing = 1
    ActiveChart.ChartArea.Select
    ActiveChart.PlotArea.Select
    Application.CutCopyMode = False
    Application.CutCopyMode = False
    ActiveChart.FullSeriesCollection(1).XValues = "='Standard Ratios'!$I$2:$O$2"
    ActiveChart.ChartArea.Select
    ActiveChart.Parent.Delete
    Range("C2:E2").Select
End Sub
Attribute VB_Name = "Modulo112"
Sub Macro87()
Attribute Macro87.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro87 Macro
'

'
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
End Sub
Sub Macro90()
Attribute Macro90.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro90 Macro
'

'
    ActiveSheet.Unprotect
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
End Sub
Attribute VB_Name = "Modulo113"
Public top1
Public top2
Public left1
Public left2
Public hi1
Public hi2
Public wi1
Public wi2
Sub AUMENTAGRAF1()
Attribute AUMENTAGRAF1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro93 Macro
'

'
On Error Resume Next
Application.ScreenUpdating = False
ActiveSheet.Unprotect
top1 = ActiveSheet.ChartObjects("Grafico 8").Top
left1 = ActiveSheet.ChartObjects("Grafico 8").Left
hi1 = ActiveSheet.ChartObjects("Grafico 8").Height
wi1 = ActiveSheet.ChartObjects("Grafico 8").Width

ActiveSheet.Range("cc1") = top1
ActiveSheet.Range("cc2") = left1
ActiveSheet.Range("cc3") = hi1
ActiveSheet.Range("cc4") = wi1

    ActiveSheet.ChartObjects("Grafico 8").Activate
' MsgBox top1
 
    
    With ActiveChart.Parent
         .Height = 700 ' resize
         .Width = 1000  ' resize
         .Top = 100    ' reposition
         .Left = 100   ' reposition
     End With
     
     ActiveSheet.Shapes("Grafico 8").ZOrder msoBringToFront
     
     ActiveSheet.Protect
     Application.ScreenUpdating = True
     End Sub
     
     Sub G1RITORNA()
     On Error Resume Next
     ActiveSheet.Unprotect
     Application.ScreenUpdating = False
     ActiveSheet.ChartObjects("Grafico 8").Activate
    With ActiveChart.Parent
         .Height = hi1 ' resize
         .Width = wi1  ' resize
         .Top = top1    ' reposition
         .Left = left1   ' reposition
         
         .Top = ActiveSheet.Range("cc1")
.Left = ActiveSheet.Range("cc2")
.Height = ActiveSheet.Range("cc3")
.Width = ActiveSheet.Range("cc4")
     End With
     
     
    'ActiveChart.PlotArea.Select
    'ActiveChart.ChartArea.Select
    Range("E1").Select
    '''ActiveSheet.ChartObjects("Grafico 9").Activate
    '''With ActiveChart.Parent
       '''  .Height = 325 ' resize
         '''.Width = 500  ' resize
         '''.Top = 100    ' reposition
         '''.Left = 100   ' reposition
     '''End With
    'ActiveChart.PlotArea.Select
    'Range("E1").Select
    'ActiveSheet.ChartObjects("Grafico 8").Activate
    'Range("E1").Select
    'ActiveSheet.ChartObjects("Grafico 9").Activate
    'Range("E1").Select
    ActiveSheet.Protect
    Application.ScreenUpdating = True
End Sub
Sub AUMENTAGRAF2()
'
' Macro93 Macro
'

'
On Error Resume Next
ActiveSheet.Unprotect
Application.ScreenUpdating = False

top2 = ActiveSheet.ChartObjects("Grafico 9").Top
left2 = ActiveSheet.ChartObjects("Grafico 9").Left
hi2 = ActiveSheet.ChartObjects("Grafico 9").Height
wi2 = ActiveSheet.ChartObjects("Grafico 9").Width

ActiveSheet.Range("cd1") = top2
ActiveSheet.Range("cd2") = left2
ActiveSheet.Range("cd3") = hi2
ActiveSheet.Range("cd4") = wi2
    ActiveSheet.ChartObjects("Grafico 9").Activate
' MsgBox top1
 
    
    With ActiveChart.Parent
         .Height = 700 ' resize
         .Width = 1000  ' resize
         .Top = 100    ' reposition
         .Left = 100   ' reposition
     End With
     ActiveSheet.Shapes("Grafico 9").ZOrder msoBringToFront
     ActiveSheet.Protect
     Application.ScreenUpdating = True
     End Sub
     
     Sub G2RITORNA()
     On Error Resume Next
     Application.ScreenUpdating = False
     ActiveSheet.Unprotect
     ActiveSheet.ChartObjects("Grafico 9").Activate
    With ActiveChart.Parent
         .Height = hi2 ' resize
         .Width = wi2  ' resize
         .Top = top2    ' reposition
         .Left = left2   ' reposition
         .Top = ActiveSheet.Range("cd1")
.Left = ActiveSheet.Range("cd2")
.Height = ActiveSheet.Range("cd3")
.Width = ActiveSheet.Range("cd4")
     End With
     
     
    'ActiveChart.PlotArea.Select
    'ActiveChart.ChartArea.Select
    Range("E1").Select
    '''ActiveSheet.ChartObjects("Grafico 9").Activate
    '''With ActiveChart.Parent
       '''  .Height = 325 ' resize
         '''.Width = 500  ' resize
         '''.Top = 100    ' reposition
         '''.Left = 100   ' reposition
     '''End With
    'ActiveChart.PlotArea.Select
    'Range("E1").Select
    'ActiveSheet.ChartObjects("Grafico 8").Activate
    'Range("E1").Select
    'ActiveSheet.ChartObjects("Grafico 9").Activate
    'Range("E1").Select
    ActiveSheet.Protect
    Application.ScreenUpdating = True
End Sub
Sub Macro94()
Attribute Macro94.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro94 Macro
'

'
On Error Resume Next
ActiveSheet.Unprotect
    ActiveSheet.ChartObjects("Grafico 8").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveSheet.Shapes("Grafico 8").ZOrder msoBringToFront
End Sub
Attribute VB_Name = "Modulo114"
Sub Macro91()
Attribute Macro91.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro91 Macro
'

'
    ActiveSheet.Shapes.Range(Array("ScrollBar1")).Select
End Sub
Attribute VB_Name = "Modulo115"
Sub Macro93()
Attribute Macro93.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro93 Macro
'

'
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False
    ActiveSheet.Unprotect
    Application.GoTo Reference:="Macro93"
End Sub
Attribute VB_Name = "Modulo116"
Sub Macro96()
Attribute Macro96.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro96 Macro
'

'
    Range("T29:U29").Select
    Selection.Copy
    Range("N29:O29").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Range("L16:N17").Select
End Sub
Attribute VB_Name = "Modulo117"
Sub Macro97()
Attribute Macro97.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro97 Macro
'

'
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=1/(R[-11]C[-6]/(R[-10]C[-6]-R[-9]C[-6]))+R[-9]C[-5]"
    Range("L21").Select
End Sub
Sub Macro98()
Attribute Macro98.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro98 Macro
'

'
    Range("L20").Select
    ActiveCell.FormulaR1C1 = "=R[-11]C[-6]/(R[-10]C[-6]-R[-9]C[-6])"
    Range("L21").Select
End Sub
Sub Macro99()
Attribute Macro99.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro99 Macro
'

'
    Range("L20").Formula = "=" & Range("g3") & "/(F10-F11)-1"
   ' Range("L21").Select
End Sub

Sub aggiornadebitifin()
On Error Resume Next
ActiveSheet.Unprotect
Application.ScreenUpdating = False
ActiveSheet.Shapes.Range(Array("Oval 6")).Select
ActiveSheet.Shapes.Range(Array("Ovale 6")).Select
On Error GoTo versione
    Selection.ShapeRange.Height = 276.094488189 * (Worksheets("how does it pay").Range("g10") - ActiveSheet.Range("k21") + ActiveSheet.Range("k19")) / Worksheets("how does it pay").Range("g8")
    Selection.ShapeRange.Top = 146.7 '137.5
    Selection.ShapeRange.ZOrder msoBringToFront
    ActiveSheet.Protect
        Application.ScreenUpdating = True
        
        Exit Sub
versione:
ActiveSheet.Protect
Application.ScreenUpdating = True
MsgBox "O si sta elaborando un bilancio abbreviato senza dettaglio debiti finanziari o la versione di Excel non supporta la gestione automatica delle forme geometriche indipendenti. Quindi per favore, NON TENERE CONTO DELL'OVALE DEI CEBITI e del triangolo delle vendite. Probably your version of Excel does not support automatic management of independent geometric shapes. So please do not take into account the oval of debts and the sales triangle."

End Sub

Sub sproteggifoglio()
ActiveSheet.Unprotect
End Sub
Attribute VB_Name = "Modulo118"
Sub Macro95()
Attribute Macro95.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro95 Macro
'

'
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.PlotArea.Select
    ActiveWindow.ScrollWorkbookTabs Sheets:=1
    ActiveWindow.ScrollWorkbookTabs Sheets:=1
    ActiveWindow.ScrollWorkbookTabs Sheets:=1
    
    Sheets("Financial Structure post Budget").Select
    ActiveSheet.Shapes.Range(Array("Oval 9")).Select
    ActiveSheet.Shapes.Range(Array("Oval 9", "Flowchart: Extract 2")).Select
    Range("Q4").Select
    ActiveSheet.Unprotect
    ActiveWindow.ScrollColumn = 1
    ActiveSheet.Shapes.Range(Array("Oval 9")).Select
    ActiveSheet.Shapes.Range(Array("Oval 9", "Flowchart: Extract 2")).Select
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Selection.ShapeRange.IncrementTop 0.8333070866
    Range("A1:D1").Select
End Sub
Attribute VB_Name = "Modulo119"
Sub Macro100()
Attribute Macro100.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro100 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Legend.Select
    Selection.Delete
End Sub
Attribute VB_Name = "Modulo12"
Sub Macro2()
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
'

'
    Cells.Select
    Selection.Replace What:="- ", Replacement:="0", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
End Sub
Attribute VB_Name = "Modulo120"
Sub basepercentuale()
Attribute basepercentuale.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro101 Macro
'

'
    On Error Resume Next
       ActiveSheet.Unprotect
    Range("S6:S320").Select
    
    Selection.NumberFormat = "0.00%"
    
    Range("L1").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub basegenerale()
Attribute basegenerale.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro102 Macro
'

'
   On Error Resume Next
   
   
   ActiveSheet.Unprotect
    
      
    Range("S6:S320").Select
    Selection.NumberFormat = "General"
    
    Selection.NumberFormat = "#,##0"
     Range("L1").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
   
End Sub


Sub sceglibase()
On Error Resume Next
If Range("IV4") = False Then
basepercentuale
Else
basegenerale
End If
End Sub
Attribute VB_Name = "Modulo121"
Sub Macro103()
Attribute Macro103.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro103 Macro
'

'
    ActiveSheet.Unprotect
    Selection.NumberFormat = "General"
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
    Range("L1").Select
End Sub
Attribute VB_Name = "Modulo122"
Sub Pulsante31_Click()
Attribute Pulsante31_Click.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Pulsante31_Click Macro
'

'
    Range("N16:N18").Select
    ActiveCell.FormulaR1C1 = "=+'CE1'!R[43]C[-8]"
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo123"
Sub Macro101()
Attribute Macro101.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro101 Macro
'

'
    Sheets("INPUT Statement").Select
    Range("O1").Select
    Sheets("COVER").Select
End Sub
Attribute VB_Name = "Modulo124"
Sub Macro102()
Attribute Macro102.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro102 Macro
'

'
    Range("M3378").Select
End Sub
Attribute VB_Name = "Modulo125"
Sub Pulsante22_Click()
'Cells(Selection.End(xlDown).Row, "k").Select
Range("N" & Rows.Count).End(xlUp).Select
End Sub

Sub investingcom()
'Cells(Selection.End(xlDown).Row, "k").Select
Range("k3820").Select
End Sub

Sub spaincons()
'Cells(Selection.End(xlDown).Row, "k").Select
Application.Calculation = xlAutomatic
Range("k4149").Select
End Sub
Sub spainnorm()
'Cells(Selection.End(xlDown).Row, "k").Select
Application.Calculation = xlAutomatic
Range("k4341").Select
End Sub

Attribute VB_Name = "Modulo126"
Sub nascondirighesintetici()

'
' Macro112 Macro
'

'
    Rows("5:7").Select
    Selection.EntireRow.Hidden = True
    Rows("11:16").Select
    Selection.EntireRow.Hidden = True
    Rows("18:21").Select
    Selection.EntireRow.Hidden = True
    Rows("23:24").Select
    Selection.EntireRow.Hidden = True
    Rows("30:30").Select
    ActiveWindow.SmallScroll Down:=54
    Rows("95:97").Select
    Selection.EntireRow.Hidden = True
    Rows("101:106").Select
    Selection.EntireRow.Hidden = True
    Rows("108:111").Select
    Selection.EntireRow.Hidden = True
    Rows("113:114").Select
    Selection.EntireRow.Hidden = True
    Rows("116:116").Select
    ActiveWindow.SmallScroll Down:=8
    Rows("122:126").Select
    Selection.EntireRow.Hidden = True
    Rows("129:140").Select
    Selection.EntireRow.Hidden = True
    ActiveWindow.SmallScroll Down:=-44
    Rows("32:36").Select
    Selection.EntireRow.Hidden = True
    Rows("39:50").Select
    Selection.EntireRow.Hidden = True
    Rows("55:61").Select
    Selection.EntireRow.Hidden = True
    Rows("65:79").Select
    Selection.EntireRow.Hidden = True
    Rows("85:88").Select
    Selection.EntireRow.Hidden = True
    ActiveWindow.SmallScroll Down:=9
    Rows("145:151").Select
    Selection.EntireRow.Hidden = True
    Rows("155:169").Select
    Selection.EntireRow.Hidden = True
    Rows("175:178").Select
    Selection.EntireRow.Hidden = True
    Range("B181").Select
End Sub


Sub memorizza4sinteticinosalvati()
'
' Macro114 Macro
'


 
On Error Resume Next

 Application.Cursor = xlWait              ' Clessidra

Application.ScreenUpdating = False


Dim foglioattuale
foglioattuale = ActiveSheet.Name

If foglioattuale <> "lite screening" Then
Sheets("lite screening").Activate
End If
ActiveSheet.Unprotect
Range("A91:aa179").Select
  Selection.UnMerge
  
    Range("A91:K179").Select
    Application.CutCopyMode = False
  
    
    Selection.Copy
    Range("Q91").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
  
    
    
    
    Range("u94:u100").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    Range("u152:u173").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    
    Range("Q1:AA89").Select
    Application.CutCopyMode = False
       Selection.UnMerge
    
    Selection.Copy
    Range("A91").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        Range("u4:u10").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    Range("u62:u83").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
        
        
        
        
         Range("E94:E100").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    Range("E152:E173").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
        
        
        Range("A1:aa89").Select
       Selection.UnMerge
       
    Range("A1:K89").Select
   Application.CutCopyMode = False
    
    
    Selection.Copy
    Range("Q1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    
    Range("E4:E10").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    Range("E62:E83").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
     Range("u4:u10").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    Range("u62:u83").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    
    
    
    
 '   ActiveWindow.SmallScroll Down:=-19
   ' Range("E4:E10,U4:U10,E62:E83,U62:U83").Select
    'Range("U62").Activate
  '  ActiveWindow.SmallScroll Down:=10
    'Range("E4:E10,U4:U10,E62:E83,U62:U83,E94:E100,U94:U100").Select
    'Range("U94").Activate
   ' ActiveWindow.Zoom = 55
    'ActiveWindow.SmallScroll Down:=13
    Range("E4:E10,U4:U10,E62:E83,U62:U83,E94:E100,U94:U100,E152:E173,U152:U173"). _
        Select
    Range("U152").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
   ' ActiveWindow.SmallScroll Down:=-29
   ' Range("A1").Select
    
    
    
    
    
    
    
    
    
    
    
    Range("A1").Select
    
    
    Application.CutCopyMode = False
       
    'If foglioattuale <> "lite screening" Then
     '   Sheets(foglioattuale).Activate
    'End If
    ActiveSheet.Protect
    Application.Cursor = Default
End Sub




Attribute VB_Name = "Modulo127"
Sub vuotalitescreening()
'
' Macro104 Macro
'

'
    Sheets("lite screening").Activate
    ActiveSheet.Unprotect
    Range("A91").Select
    Application.CutCopyMode = False
    Range("A91:AA179").Select
    Selection.ClearContents
    
    Range("Q1:AA89").Select
    Selection.ClearContents
    Range("A1").Select
    ActiveSheet.Protect
    primaschedalite
    
End Sub

Attribute VB_Name = "Modulo128"
Sub primaschedalite()
'
' Macro105 Macro
'

'
Application.ScreenUpdating = False


Dim foglioattuale
foglioattuale = ActiveSheet.Name
If foglioattuale <> "lite screening" Then
Sheets("lite screening").Activate
DoEvents
End If
ActiveSheet.Unprotect
Application.ScreenUpdating = False
DoEvents
    Application.CutCopyMode = False
    
    Range("VHL1:VHV89").Select
    Selection.Copy
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    ActiveSheet.Protect
    Application.ScreenUpdating = False
    
    If foglioattuale <> "lite screening" Then
    Sheets("COVER").Activate
    End If
    
  Application.ScreenUpdating = True
Application.Cursor = xlDefault

DoEvents

    
End Sub



Attribute VB_Name = "Modulo129"
Sub Macro104()
Attribute Macro104.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro104 Macro
'

'
    Range("O1").Select
End Sub
Sub Macro105()
Attribute Macro105.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro105 Macro
'

'
    
    Columns("A:J").Select
    
    Selection.EntireColumn.Hidden = True
    Selection.EntireColumn.Hidden = False
    Selection.EntireColumn.Hidden = True
End Sub
Attribute VB_Name = "Modulo13"
Sub Macro3()
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
'

Range("l149").Select
    ActiveCell.FormulaR1C1 = _
        "=+R[-14]C-R[7]C-R[8]C+R[9]C-R[10]C-R[11]C-SUM(R[-10]C:R[-8]C)-SUM(R[-5]C:R[-1]C)"
    Range("K149").Select
    ActiveCell.FormulaR1C1 = _
        "=+R[-14]C-R[7]C-R[8]C+R[9]C-R[10]C-R[11]C-SUM(R[-10]C:R[-8]C)-SUM(R[-5]C:R[-1]C)"
    Range("K150").Select
End Sub
Sub Macro4()
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
'

'
    Range("K149").Select
    Selection.Copy
    Range("L149").Select
    ActiveSheet.Paste
    Range("J149").Select
End Sub
Sub Macro5()
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro5 Macro
'

'
    Range("K149").Select
    ActiveCell.FormulaR1C1 = _
        "=+R[-14]C-R[4]C-R[5]C-R[6]C-R[7]C-R[8]C-R[9]C-R[10]C-R[11]C-SUM(R[-10]C:R[-8]C)-SUM(R[-5]C:R[-1]C)"
    Range("L149").Select
    ActiveCell.FormulaR1C1 = _
        "=+R[-14]C-R[4]C-R[5]C-R[6]C-R[7]C-R[8]C-R[9]C-R[10]C-R[11]C-SUM(R[-10]C:R[-8]C)-SUM(R[-5]C:R[-1]C)"
    Range("J149").Select
End Sub
Attribute VB_Name = "Modulo130"
Sub Macro106()
Attribute Macro106.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro106 Macro
'

'
    ActiveChart.ChartArea.Select
    ActiveSheet.Shapes("Grafico 12").IncrementLeft -472.5
    ActiveSheet.Shapes("Grafico 12").IncrementTop 2.1428346457
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.FullSeriesCollection(1).Points(1).Select
    Selection.Explosion = 5
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.FullSeriesCollection(1).Points(2).Select
    Selection.Explosion = 2
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.FullSeriesCollection(1).Points(2).DataLabel.Select
    Selection.Left = 255.317
    Selection.Top = 181.455
    ActiveChart.FullSeriesCollection(1).Points(1).DataLabel.Select
    Selection.Left = 255.47
    Selection.Top = 91.422
    ActiveChart.ChartArea.Select
    ActiveSheet.ChartObjects("Grafico 13").Activate
    ActiveSheet.Shapes("Grafico 13").IncrementLeft -957.8570866142
    ActiveSheet.Shapes("Grafico 13").IncrementTop 2.1429133858
    ActiveSheet.ChartObjects("Grafico 13").Activate
    ActiveChart.FullSeriesCollection(1).Select
End Sub
Sub Macro107()
Attribute Macro107.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro107 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.Shapes("Grafico 12").IncrementLeft -485.3571653543
    ActiveSheet.Shapes("Grafico 12").IncrementTop 1.0714173228
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.ChartArea.Select
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.FullSeriesCollection(1).Points(1).Select
    Selection.Explosion = 5
    ActiveChart.FullSeriesCollection(1).Points(2).Select
    Selection.Explosion = 3
    Range("AH18").Select
    ActiveSheet.ChartObjects("Grafico 13").Activate
    ActiveSheet.Shapes("Grafico 13").IncrementLeft -956.7857480315
    ActiveSheet.Shapes("Grafico 13").IncrementTop 4.2856692913
    ActiveSheet.ChartObjects("Grafico 13").Activate
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.FullSeriesCollection(1).Points(4).Select
    Selection.Explosion = 3
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.FullSeriesCollection(1).Select
    ActiveChart.FullSeriesCollection(1).DataLabels.Select
    ActiveChart.FullSeriesCollection(1).Points(4).DataLabel.Select
    Selection.Left = 164.972
    Selection.Top = 87.315
    Range("R6").Select
End Sub
Attribute VB_Name = "Modulo131"
Sub nopatsopra()
Attribute nopatsopra.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro108 Macro
'

'
    'ActiveChart.PlotArea.Select
    'Range("Q5").Select
    'ActiveSheet.ChartObjects("Grafico 2").Activate
    'ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveSheet.Shapes("Grafico 2").ZOrder msoSendToBack
    ActiveSheet.Shapes("Grafico 11").ZOrder msoSendToBack
    'ActiveSheet.ChartObjects("Grafico 2").Activate
    'ActiveSheet.Shapes("Grafico 2").ZOrder msoBringToFront
End Sub

Sub nopatstto()
 ActiveSheet.Shapes("Grafico 2").ZOrder msoBringToFront
  ActiveSheet.Shapes("Grafico 11").ZOrder msoSendToBack
  
End Sub

Sub waccsopra()
ActiveSheet.Shapes("Grafico 11").ZOrder msoBringToFront
End Sub

Sub waccsotto()
ActiveSheet.Shapes("Grafico 11").ZOrder msoSendToBack
End Sub

Attribute VB_Name = "Modulo132"
Sub Macro108()
Attribute Macro108.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro108 Macro
'

'
End Sub
Attribute VB_Name = "Modulo133"
Sub multiplo()
MsgBox "Utilizzare il MULTIPLO di un risultato economico per ottenere il valore di un'impresa significa considerare il RENDIMENTO di quel valore, anche se alla rovescio! " & vbNewLine & vbNewLine & "Attenzione a non confondere l'obiettivo di UN INVESTITORE PASSIVO, che non pu|fffd| e non vuole fare altro che godere di una regola certa per remunerare il suo capitale, CON UN INVESTITORE ATTIVO, in particolare un imprenditore, il cui obiettivo |fffd| quello di AUMENTARE IL RENDIMENTO DELL'IMPRESA ACQUISITA AGENDO SU CHI PRODUCE VALORE ALL'INTERNO DELL'AZIENDA."

End Sub


Sub valorefinale()
MsgBox "What is the perpetual growth DCF terminal value formula? The perpetual growth method of calculating a terminal value formula is the preferred method among academics as it has the mathematical theory behind it.|fffd| This method assumes the business will continue to generate|fffd|Free Cash Flow (FCF)|fffd|at a normalized state forever (perpetuity). The formula for calculating the terminal value is: TV |fffd|= |fffd|(FCF x (1 + g)) |fffd|/ |fffd|(WACC |fffd| g) Where: TV = terminal value FCF = free cash flow g = perpetual growth rate of FCF WACC =|fffd|weighted average cost ofcapita. Terminal Value The|fffd|terminal value|fffd|is a very important part of a DCF model.|fffd| It often makes up more than 50% of the net present value of the business, especially if the forecast period is 5 years or less.|fffd| There are two ways to calculate the terminal value: the perpetual growth rate approach and the exit multiple approaches. "

MsgBox "The perpetual growth rate assumes that the cash flow generated at the end of the forecast period grows at a constant rate forever.|fffd| So, for example, the cash flow of the business is $10 million and grows at 2% forever, with a cost of capital of 15%.|fffd| The terminal value is $10 million / (15% |fffd| 2%) = $77 million. With the EXIT MULTIPLE APPROACH, the business is assumed to be sold for what a reasonable buyer would pay for it.|fffd| This typically means an|fffd|EV/EBITDA multiple|fffd|at or near current trading values for comparable companies.|fffd| As you can see in the example below, if the business has $6.3 million of|fffd|EBITDA|fffd|and similar companies are trading at 8x then the terminal value is $6.3 million x 8 = $50 million. That value is then discounted back to the present to get the NPV of the terminal|fffd|value."

End Sub

Sub acquistaremaggioranza()
MsgBox "Mentre il rendimento di un bond |fffd| il semplice corrispettivo per il servizio del debito e per l'investitore il rischio |fffd| quello dell'insolvenza ma non ha incertezza sull'entit|fffd| del rendimento a scadenza " & vbNewLine & vbNewLine & " Il profitto |fffd| invece valore creato dall'abilit|fffd| umana nell'ideare, produrre e vendere. " & vbNewLine & vbNewLine & "Chi acquisisce la maggioranza di una societ|fffd| industriale influisce sulla creazione di valore relativa al profitto ottenuto dall'impresa e crede di poter migliorarlo decisamente ottenendo ingenti rendimenti dall'investimento; dispone e gode del dividendo ma dispone prima ancora del cash flow" & vbNewLine & vbNewLine & "Invece chi acquista una minoranza o poche azioni gode del maggior valore dovuto agli utili (subendo eventuali manovre sugli stessi) solo se si rispecchia in variazioni positive e non temporanee della quotazione; dispone solamente dell'eventuale dividendo e subisce sia il rischio di insolvenza, sia il rischio volatilit|fffd|."

End Sub

Sub enterprisevalue()
MsgBox "L'Enterprise Value o in italiano Valore dell'Impresa |fffd| il valore corretto da cui partire per chi acquista una maggioranza societaria. " & vbNewLine & vbNewLine & "Sappiamo che dal valore dell'impresa dobbiamo sottrarre almeno il valore dei debiti finanziari per arrivare al cosiddetto Equity Value, cio|fffd| il valore pagato per l'acquisto delle azioni. " & vbNewLine & vbNewLine & "Ma quest'ultima sottrazione fa parte di una ulteriore considerazione ed eventualmente trattativa, in quanto l'acquirente potrebbe anche voler modificare la struttura finanziaria in modo radicale fin dall'inizio"

End Sub

Sub perchenodeltawc()
MsgBox "Si |fffd| scelto di non considerare la variazione del circolante netto operativo (scorte, clienti e altri crediti meno fornitori e altri debiti non finanziari) nel valore attuale del flusso reddituale futuro " & vbNewLine & vbNewLine & "perch|fffd| occorre attualizzare un flusso medio annuo e la variazione del circolante non pu|fffd| essere considerata ripetitiva in modo continuo e costante. " & vbNewLine & vbNewLine & "La variazione del circolante si contegger|fffd| AUTOMATICAMENTE invece, nel valore di terzi TPV, il valore attuale della crescita annua del circolante, qualora si inserisca una ipotesi di crescita annua costante del fatturato."

End Sub

Sub cambiaonoilvalore()
MsgBox "? CAMBIA L'ENTERPRISE VALUE ?:" & vbNewLine & "Se otteniamo un mutuo bancario?" & vbNewLine & "Se aumentano i debiti verso i fornitori? per > costi o per dilazioni" & vbNewLine & "Se aumentiamo il capitale sociale? " & vbNewLine & "Se aumentano le immobilizzazioni? " & vbNewLine & "Se aumenta il magazzino? " & vbNewLine & "Se aumentano i crediti ai clienti?" & vbNewLine & "Se aumenta la liquidit|fffd|?" & vbNewLine & "Se una voce dell'attivo aumenta dobbiamo chiederci perch|fffd| aumenta, in che modo?" & vbNewLine & "E se aumenta il fatturato?" & vbNewLine & "Se aumentano gli acquisti? Per quantit|fffd| o prezzo.." & vbNewLine & "Se aumenta il personale?"

End Sub

Sub warrenerror()
MsgBox "Uno dei peggiori investimenti di Warren Buffett fu la Dexter Shoe nel 1993 acquistata per un Equity Value di 434 milioni di dollari pari ad un multiplo di circa 11 volte l'Ebitda di allora," & vbNewLine & vbNewLine & " e visto il disprezzo di WB per le compagnie indebitate si pu|fffd| ipotizzare che il multiplo EV/EBITDA fosse di poco superiore." & vbNewLine & vbNewLine & " L'EBITDA era quasi il 15% rispetto alle vendite. " & vbNewLine & vbNewLine & "Il multiplo Price / Sales fu di poco meno di 2 volte il fatturato" & vbNewLine & vbNewLine & " Il problema vero non fu tanto la valutazione statica quando il non aver pevisto una repentina perdita di competitivit|fffd|."

End Sub

Sub sinteticmultipl()
MsgBox "NON E' UNO SCIOGLILINGUA: utilizzare un moltiplicatore per l'Ebitda EQUIVALE ad attualizzare l'Ebitda futuro al tasso = 1 / moltiplicatore " & vbNewLine & vbNewLine & " Ad esempio: usare un moltiplicatore 10, significa attualizzare l'Ebitda futuro al 10%; usare un moltiplicatore 8 significa attualizzare l'Ebitda futuro al tasso 1/8 = 12,5%"

End Sub

Sub analiticmultipl()
MsgBox "Dato che il Valore Finale di tale metodo |fffd| calcolato utilizzando il moltiplicatore per il flusso di cassa dell'ultimo anno considerato nell'analitico," & vbNewLine & vbNewLine & " impostando a zero gli anni considerati (quindi rimanendo nell'anno presente) l'EV coincide con il solo Final Value che corrisponde esattamente a quello del moltiplicatore"

End Sub

Sub perchesimisto()

MsgBox "Si |fffd| scelto di utilizzare il metodo misto in quanto l'alternativa all'acquisto dell'intera azienda |fffd| la costruzione da zero. " & vbNewLine & vbNewLine & " Partendo da zero occorre investire nel patrimonio costituito dagli asset tangibili e dal circolante (valore patrimoniale) soprattutto laddove vi |fffd| pi|fffd| necessit|fffd| tecnologica  " & vbNewLine & vbNewLine & " e occorre investire nel personale e nel know how, che si traduce in capacit|fffd| strategica, organizzativa e di mercato" & vbNewLine & vbNewLine & " e il VALORE DELL'IMPRESA sar|fffd| dunque proporzionato sia agli investimenti materiali (parte patrimoniale della valutazione) tanto pi|fffd| necessari quanto maggiore la rilevanza tecnologica del settore, sia agli investimenti immateriali (parte reddituale attesa dal futuro della valutazione) corretti dalla necessit|fffd| di rinnovamento evidenziata dal capex cio|fffd| dagli ammortamenti tecnici "
MsgBox " La correzione del Capex ci permette di mantenere nella valutazione il valore presente degli asset (che andrebbero riportati al valore di mercato) al netto di una svalutazione prudenziale; " & vbNewLine & vbNewLine & " mentre il circolante presente a bilancio viene anch'esso mantenuto nella valutazione in quanto valore presente prodotto dall'ultimo esercizio passato e liquidabile al netto di una svalutazione prudenziale; " & vbNewLine & vbNewLine & "i flussi di reddito futuri considerati al netto del capex (capital expenditure) e pienamente tassati ed attualizzati a oggi costituiscono il valore insito nelle qualit|fffd| immateriali dell'impresa e che determina un moltiplicatore Price / Book superiore all'unit|fffd| tanto pi|fffd| quanto pi|fffd| le attese future sono positive."

End Sub

Sub perchenoimmat()
MsgBox "Non considerare i valori immateriali nel patrimonio significa eliminarli dal calcolo del valore patrimoniale di liquidazione o di sostituzione (caso in cui vogliamo costruire da zero stessa azienda)" & vbNewLine & vbNewLine & "Nello stesso tempo si aumenta il valore di funzionamento in quanto diminuisce il tasso di attualizzazione a causa della diminuzione del WACC." & vbNewLine & vbNewLine & " Come per gli altri valori anche questi dovranno essere sottoposti alle verifiche necessarie"

End Sub

Sub leasingREGISTRAZIONE()
MsgBox "Il metodo italiano della registrazione col metodo patrimoniale registra i canoni tra i costi di godimento beni di terzi." & vbNewLine & "  In nota integrativa si indica la simulazione del metodo finanziario, preferito dagl IAS (che in generale chiedono il fair value dei beni con impairment di verifica sul loro valore rispetto al costo storico), cio|fffd| bene iscritto nelle immobilizzazioni, rilevazione del debito finanziario, registrazione di ammortamenti e interessi passivi"

End Sub


Sub leasingNELLAvalutazione()
MsgBox "Una registrazione patrimoniale del leasing influenza con i canoni solo il valore operativo di funzionamento. " & vbNewLine & " La registrazione finanziaria del leasing porta ad un maggiore EV, perch|fffd| aggiunge il valore del bene in attivo, ma riequilibra la situazione nell'Equity Value abbassato dal debito finanziario verso la societ|fffd| di leasing"

End Sub

Attribute VB_Name = "Modulo134"
Sub SCURO()
Attribute SCURO.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro109 Macro
'

        
'
Application.ScreenUpdating = False
    ActiveSheet.Shapes.Range(Array("Rectangle 57")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
    .ForeColor.Brightness = 0
        
        
        .Transparency = 0
      
                .Solid
    End With
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("C30").Select
End Sub

Sub CHIARO()
'
' Macro109 Macro
'

'
   
      ActiveSheet.Shapes.Range(Array("Rectangle 57")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
       .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0.7499999762
        .Solid
    End With
    Selection.ShapeRange.ZOrder msoSendToBack
    Range("C30").Select
End Sub


Sub SCURO3()
'
' Macro109 Macro
'

'
Application.ScreenUpdating = False
    ActiveSheet.Shapes.Range(Array("Rectangle 63")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = 0
        
        
        .Transparency = 0
      
                .Solid
    End With
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("P14").Select
End Sub

Sub CHIARO3()
'
' Macro109 Macro
'

'
   
      ActiveSheet.Shapes.Range(Array("Rectangle 63")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
       .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0.7499999762
        .Solid
    End With
    Selection.ShapeRange.ZOrder msoSendToBack
    Range("P14").Select
End Sub
Sub SCURO2()
'
' Macro109 Macro
'

'
Application.ScreenUpdating = False
    ActiveSheet.Shapes.Range(Array("Rectangle 60")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
    .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
       .ForeColor.Brightness = 0
        
        
        .Transparency = 0
      
                .Solid
    End With
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("AV23").Select
End Sub

Sub CHIARO2()
'
' Macro109 Macro
'

'
   
      ActiveSheet.Shapes.Range(Array("Rectangle 60")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0.7499999762
        .Solid
    End With
    Selection.ShapeRange.ZOrder msoSendToBack
    Selection.ShapeRange.Fill.Visible = msoFalse
    Range("AV23").Select
End Sub

Sub SCURO4()
'
' Macro109 Macro
'

'
Application.ScreenUpdating = False
    ActiveSheet.Shapes.Range(Array("Rectangle 3")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
    .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
       .ForeColor.Brightness = 0
        
        
        .Transparency = 0
      
                .Solid
    End With
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("p1").Select
End Sub

Sub CHIARO4()
'
' Macro109 Macro
'

'
   
      ActiveSheet.Shapes.Range(Array("Rectangle 3")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0.7499999762
        .Solid
    End With
    Selection.ShapeRange.ZOrder msoSendToBack
    Selection.ShapeRange.Fill.Visible = msoFalse
    Range("A1").Select
End Sub

Sub SCURO5()
'
' Macro109 Macro
'

'
Application.ScreenUpdating = False
    ActiveSheet.Shapes.Range(Array("Rectangle 61")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
    .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
       .ForeColor.Brightness = 0
        
        
        .Transparency = 0
      
                .Solid
    End With
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("am1").Select
End Sub

Sub CHIARO5()
'
' Macro109 Macro
'

'
   
      ActiveSheet.Shapes.Range(Array("Rectangle 61")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = -0.5
        .Transparency = 0.7499999762
        .Solid
    End With
    Selection.ShapeRange.ZOrder msoSendToBack
    Range("Am1").Select
End Sub

Attribute VB_Name = "Modulo135"
Sub falliment()
'
' Macro107 Macro
'

'
    Range("BH62").Select
    ActiveCell.FormulaR1C1 = "20%"
    Range("BH60").Select
    ActiveCell.FormulaR1C1 = "-23296"
    Range("BH64").Select
    ActiveCell.FormulaR1C1 = "-56701"
    Range("BH64").Select
    ActiveCell.FormulaR1C1 = "-56791"
    Range("BH66").Select
    ActiveCell.FormulaR1C1 = "573"
    Range("BH68").Select
    ActiveCell.FormulaR1C1 = "5"
    Range("BH67").Select
    ActiveCell.FormulaR1C1 = "7.89%"
    Range("BH71").Select
    ActiveCell.FormulaR1C1 = "-7912"
    Range("AY72:BI72").Select
End Sub
Sub ripristfallim()
'
' Macro108 Macro
'

'
    Range("BH60").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH71").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH68").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH67").Select
    ActiveCell.FormulaR1C1 = "0%"
    Range("BH66").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH64").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH62").Select
    ActiveCell.FormulaR1C1 = "0%"
    Range("BH60").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("BH61").Select
End Sub

Sub resetparametri()
'
' Macro109 Macro
'

'
Application.Calculation = xlManual
    
    Range("N6") = "2"
    Range("N9") = "10%"
    Range("N10") = "20%"
    Range("N11") = "0%"
    Range("N12") = "5%"
    Range("N13") = "80%"
    Range("N14") = "0.75%"
    Range("N15") = "5"
    Range("N19") = "1.2"
    Range("N20") = "5%"
    Range("N21") = "3.5"
    Range("N22") = "3.90%"
    Range("N23") = "24%"
    Range("N25") = "2.15%"
    Range("N26") = "2.11%"
    Range("N27") = "20%"
    Range("N28").Select
    'ActiveWindow.SmallScroll Down:=-9
    Range("N6").Select
    Application.Calculation = xlAutomatic
End Sub

Attribute VB_Name = "Modulo136"
Sub duplicagrafspagna()
Attribute duplicagrafspagna.VB_ProcData.VB_Invoke_Func = " \n14"
'grafspagna
' Macro109 Macro
'

On Error Resume Next
    'ActiveSheet.ChartObjects("Grafico 61").Activate
    ActiveSheet.ChartObjects("Grafico 61").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Copy
    Range("P1").Select
    DoEvents
    ActiveSheet.Paste
    'ActiveSheet.Shapes.Range(Array("TextBox 21")).Select
    'ActiveSheet.ChartObjects("Grafico 65").Activate
    'ActiveChart.ChartTitle.Select
    Selection.Left = 94.345 + 478.75 + 600 + 300
    Selection.Top = 18.414 + 120
    
  
    
    Range("G3").Select
End Sub
Sub duplicagrafitalia()
'grafspagna
' Macro109 Macro
'

On Error Resume Next
    'ActiveSheet.ChartObjects("Grafico 61").Activate
    ActiveSheet.ChartObjects("Grafico 32").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Copy
    Range("P1").Select
    DoEvents
    ActiveSheet.Paste
    'ActiveSheet.Shapes.Range(Array("TextBox 21")).Select
    'ActiveSheet.ChartObjects("Grafico 65").Activate
    'ActiveChart.ChartTitle.Select
    Selection.Left = 94.345 + 478.75 + 600
    Selection.Top = 18.414 + 120
    
  
    
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo137"
Sub coloritalia()
Attribute coloritalia.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro110 Macro
'

'
    Range("F28:G30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("H28:I30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("J28:K30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5724159
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F28").Select
End Sub
Sub colorispagna()
Attribute colorispagna.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro111 Macro
'

'
    Range("F28:K28").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 192
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 246
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F30:K30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 246
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F29:K29").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 58087
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F28").Select
End Sub
Sub coloribianco()
Attribute coloribianco.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro112 Macro
'

'
    Range("F28:K30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F28").Select
End Sub
Attribute VB_Name = "Modulo138"
Sub CoeffPanaria173Q()
Attribute CoeffPanaria173Q.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro110 Macro
'

'
    
    Range("M15").Select
    ActiveCell.FormulaR1C1 = "1.22"
    Range("M16").Select
        ActiveCell.FormulaR1C1 = "1.288"
    Range("M17").Select
        ActiveCell.FormulaR1C1 = "0.98"
    Range("M18").Select
        ActiveCell.FormulaR1C1 = "0.07"
    Range("M19").Select
        ActiveCell.FormulaR1C1 = "1.22"
    Range("G3").Select
End Sub
Sub CoeffA1()
Attribute CoeffA1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro111 Macro
'

'
    Range("M15").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("M16").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("M17").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("M18").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("M19").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo139"
Sub primedueinvestingcom()
Attribute primedueinvestingcom.VB_ProcData.VB_Invoke_Func = " \n14"
 Range("O3914:P3915").Select
    Selection.Copy
    ActiveWindow.ScrollColumn = 15
    Range("AB3914").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3914").Select
' primedueinvestingcom Macro
'

'
    Range("S3822").Select
   ' ActiveWindow.SmallScroll Down:=8
   ' ActiveWindow.LargeScroll Down:=4
    Range("S3822:T3932").Select
    Selection.Copy
    'ActiveWindow.LargeScroll Down:=-4
    Range("O3822").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3822").Select
End Sub
Sub ripristinainvestingcom()
Attribute ripristinainvestingcom.VB_ProcData.VB_Invoke_Func = " \n14"

Range("z3822").Select
   ' ActiveWindow.SmallScroll Down:=8
   ' ActiveWindow.LargeScroll Down:=4
    Range("z3822:aa3932").Select
    Selection.Copy
    'ActiveWindow.LargeScroll Down:=-4
    Range("O3822").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3822").Select
    
     Range("AB3914:AC3915").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("O3914").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3914").Select
    
End Sub
Attribute VB_Name = "Modulo14"
Sub Macro6()
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
'

'
    Range("K136").Select
    ActiveCell.FormulaR1C1 = _
        "='WORLD Quoted Data'!R[-1]C-'WORLD Quoted Data'!R[-10]C-SUM('WORLD Quoted Data'!R[-9]C:'WORLD Quoted Data'!R[-3]C)"
    Range("L136").Select
    ActiveCell.FormulaR1C1 = _
        "='WORLD Quoted Data'!R[-1]C-'WORLD Quoted Data'!R[-10]C-SUM('WORLD Quoted Data'!R[-9]C:'WORLD Quoted Data'!R[-3]C)"
    Range("J136").Select
End Sub
Sub Macro7()
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro7 Macro
'

'
    Range("K136:L136").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -0.749992370372631
        .PatternTintAndShade = 0
    End With
    Range("J136").Select
End Sub
Sub Macro8()
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
'

'
    Range("K125").Select
    ActiveCell.FormulaR1C1 = _
        "=('WORLD Quoted Data'!R[1]C11-SUM('WORLD Quoted Data'!R[-5]C11:'WORLD Quoted Data'!R[-1]C11))"
    Range("L125").Select
    ActiveCell.FormulaR1C1 = _
        "=('WORLD Quoted Data'!R[1]C11-SUM('WORLD Quoted Data'!R[-5]C11:'WORLD Quoted Data'!R[-1]C11))"
    Range("K125:L125").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -0.749992370372631
        .PatternTintAndShade = 0
    End With
    Range("J125").Select
End Sub
Attribute VB_Name = "Modulo140"
Sub Macro109()
Attribute Macro109.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro109 Macro
'

'
    Range("O3914:P3915").Select
    Selection.Copy
    ActiveWindow.ScrollColumn = 15
    Range("AB3914").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3914").Select
End Sub
Sub Macro110()
Attribute Macro110.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro110 Macro
'

'
    Range("AB3914:AC3915").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("O3914").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O3914").Select
End Sub
Attribute VB_Name = "Modulo141"
Sub stampaunoodue()
Attribute stampaunoodue.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro111 Macro
'

'

MSG1 = MsgBox("Do you want print 2 statement ?", vbYesNo, "yes=2 no=1?")

If MSG1 = vbNo Then
    Range("A1").Select
    ActiveSheet.Unprotect
    Range("A1:K89").Select
    Selection.PrintOut Copies:=1, Collate:=True
    Range("A1").Select
    ActiveSheet.Protect
    Else
  
    Range("A1").Select
    ActiveSheet.Unprotect
    Range("A1:AA89").Select
    Selection.PrintOut Copies:=1, Collate:=True
    Range("A1").Select
    ActiveSheet.Protect
     End If
End Sub

Sub stampaquattro()
Range("A1").Select
    ActiveSheet.Unprotect
    Range("A1:AA179").Select
    Selection.PrintOut Copies:=1, Collate:=True
    Range("A1").Select
    ActiveSheet.Protect


End Sub
Attribute VB_Name = "Modulo142"
'** Functions available are:

'** FuzzyCount
'** ==========
'**    Utility giving a simple count of (Fuzzy) Matching strings equal to or above NFPercent threshold
'**    Parameters are
'**      LookupValue: Mandatory String
'**      TableArray : Mandatory Range
'**      NFPercent  : Minimum %age match for the entry to be deemed as matching. Default 5%
'**      Algorithm  : Algorithm to be used, default 3
'**
'** FuzzyPercent
'** ============
'**    Return a percentage match on two strings
'**    Parameters are
'**      String1   : Mandatory first string to be compared
'**      String2   : Mandatory second string to be compared
'**      Algorithm : Algorithm to be used for comparison, default 3
'**                  This parameter can take one of the following values:
'**                  Algorithm = 1:
'**                    This algorithm is best suited for matching mis-spellings.
'**                    For each character in 'String1', a search is performed on 'String2'.
'**                    The search is deemed successful if a character is found in 'String2'
'**                    within 3 characters of the current position.
'**                    A score is kept of matching characters which is returned as a
'**                    percentage of the total possible score.
'**                  Algorithm = 2:
'**                    This algorithm is best suited for matching sentences, or
'**                    'firstname lastname' compared with 'lastname firstname' combinations
'**                    A count of matching pairs, triplets, quadruplets etc. in 'String1' and
'**                    'String2' is returned as a percentage of the total possible.
'**                  Algorithm = 3:
'**                    Both Algorithms 1 and 2 are performed.                      **
'**                  Algorithm = 4:
'**                    Levenshtein Distance algorithm is used.
'**      Normalised: For efficiency set this boolean to True if both strings have been 'Normalised'
'**                  A Normalised string has been converted to all lower or all upper case,
'**                  and has all leading, trailing and multiple internal spaces removed.
'**                  Default False.

'** FuzzyVLookup
'** ============
'** Function to Fuzzy match LookupValue with entries in specified column (default 1)
'** of lookup table specified by TableArray.
'**    Parameters are
'**      LookupValue:    Value to be matched
'**      TableArray :    Look up table
'**      IndexNum   :    The column number of the entry in TableArray required to be
'**                      returned, as follows:
'**                      If IndexNum > 0 and the 'Rank' percentage match is >= NFPercent
'**                      (Default 5%) the column entry indicated by IndexNum is returned.
'**                      if IndexNum = 0 and the 'Rank' percentage match is >= NFPercent
'**                      (Default 5%) the corresponding value in the offset row (starting at 1
'**                      is returned. This returned value can be used to directly feed the 'Index' function.
'**      NFPercent  :    This parameter defines the percentage below which two strings are
'**                      defined as not matching, and can be expressed as either a value between 0.001 to 1
'**                      or an integer between 2 and 100 optionally followed by '%'
'**                      The parameter can optionally be followed by a seperator '~' and then
'**                      a 'high' percentage value (default 100%), above which a string is not considered
'**                      a candidate for matching.
'**                      Valid examples of this parametert are:
'**                      .5           - Entries below 50% match are ignored
'**                      50           - Entries below 50% match are ignored
'**                      50%          - Entries below 50% match are ignored
'**                      50~99        - Only entries between 50% and 99% are candidates for matching
'**                      50%~.99      - Only entries between 50% and 99% are candidates for matching
'**                      If no entries are equal to or above NFPercent, #N/A is returned.
'**      Rank          : Defines the value(s) to be returned within the NFPercent range.
'**                      This parameter is specified as an integer defining which value is to be returned.
'**                      The integer can optiolnally be followed by a string and another rank integer.
'**                      Ifd this is the case, the function will return each value within the rank range,
'**                      seperated by the non-numeric string
'**                      For example the value "1, 10" (without the quotes) will return the best to the 10th
'**                      best matching values, seperated by comma and space, with highest ranking to lowest ranking.
'**                      And the value "10 1" (without the quotes) will return the 10th
'**                      best matching value to the best matching value, seperated by a space.
'**                      If the 'Rank' match percentage is lower than NFPercent #N/A is returned.
'**      Algorithm     : Described in FuzzyPercent
'**      AdditionalCols: Defines additionbal columns within the lookup table which are to be concatenated
'**                      before matching the lookup value. Default 0.
'**      LookupColOffset: Defines offset position within the lookup table of the value(s) to be compared
'**                      Default 0.
'**    The following parameters allow matching by group, and only those values
'**    which are in the group specified will be considered for matching.
'**      GroupColOffset: This parameter specifies the offset column which contains the group values.
'**                      To trigger group matching, this must be a non-zero integer
'**      GroupValue    : This parameter specifies the Group to be considered for matching

'** GetLevenshteinPercentMatch
'** ==========================
'**    Return a percentage match on two strings using the Levenshtein distance method.
'**    This is the function called by FuzzyVLookup if Algorithm is set to 4.
'**    Parameters are
'**      String1   : Mandatory first string to be compared
'**      String2   : Mandatory second string to be compared
'**      Normalised: For efficiency set this boolean to True if both strings have been 'Normalised'
'**                  A Normalised string has been converted to all lower or all upper case,
'**                  and has all leading, trailing and multiple internal spaces removed.
'**                  Default False.

'** LevenshteinDistance
'** ===================
'** Compute Levenshtein Distance between two strings.
'**    Parameters are
'**      String1   : Mandatory first string to be compared
'**      String2   : Mandatory second string to be compared
'************************************************************************************************************


Type RankInfo
    Offset As Long
    Percentage As Single
End Type

Dim mudRankData() As RankInfo
Dim mlBestMatchPtr As Long

Dim TopMatch         As Long
Dim strCompare       As String

Function FuzzyCount(ByVal LookupValue As String, _
                      ByVal TableArray As Range, _
                      Optional NFPercent As Single = 0.05, _
                      Optional Algorithm As Integer = 3) As Long
'**********************************************************************
'** Simple count of (Fuzzy) Matching strings >= NFPercent threshold  **
'**********************************************************************
Dim lMatchCount As Long

Dim rCur As Range

Dim sString1 As String
Dim sString2 As String

'** Normalise lookup value **
sString1 = LCase$(Application.Trim(LookupValue))

For Each rCur In Intersect(TableArray.Resize(, 1), Sheets(TableArray.Parent.Name).UsedRange)

    '** Normalise current Table entry **
    sString2 = LCase$(Application.Trim(CStr(rCur)))
    
    If sString2 <> "" Then
        If FuzzyPercent(String1:=sString1, _
                        String2:=sString2, _
                        Algorithm:=Algorithm, _
                        Normalised:=True) >= NFPercent Then
            lMatchCount = lMatchCount + 1
        End If
    End If
Next rCur

FuzzyCount = lMatchCount

End Function

Function FuzzyPercent(ByVal String1 As String, _
                      ByVal String2 As String, _
                      Optional Algorithm As Integer = 3, _
                      Optional Normalised As Boolean = False) As Single
'*************************************
'** Return a % match on two strings **
'*************************************
Dim intLen1 As Integer, intLen2 As Integer
Dim intCurLen As Integer
Dim intTo As Integer
Dim intPos As Integer
Dim intPtr As Integer
Dim intScore As Integer
Dim intTotScore As Integer
Dim intStartPos As Integer
Dim sngScore As Single
Dim strWork As String

'-------------------------------------------------------
'-- If strings havent been normalised, normalise them --
'-------------------------------------------------------
If Normalised = False Then
    String1 = LCase$(Application.Trim(String1))
    String2 = LCase$(Application.Trim(String2))
End If

'----------------------------------------------
'-- Give 100% match if strings exactly equal --
'----------------------------------------------
If String1 = String2 Then
    FuzzyPercent = 1
    Exit Function
End If

intLen1 = Len(String1)
intLen2 = Len(String2)

If intLen1 = 0 Or intLen2 = 0 Then
    FuzzyPercent = 0
    Exit Function
End If

'----------------------------------------
'-- Give 0% match if string length < 2 --
'----------------------------------------
If intLen1 < 2 Then
    FuzzyPercent = 0
    Exit Function
End If

intTotScore = 0                   'initialise total possible score
intScore = 0                      'initialise current score

'--------------------------------------------------------
'-- If Algorithm = 1 or 3, Search for single characters --
'--------------------------------------------------------
If (Algorithm And 1) <> 0 Then
    If intLen1 < intLen2 Then
        FuzzyAlg1 String1, String2, intScore, intTotScore
    Else
        FuzzyAlg1 String2, String1, intScore, intTotScore
    End If
End If

'-----------------------------------------------------------
'-- If Algorithm = 2 or 3, Search for pairs, triplets etc. --
'-----------------------------------------------------------
If (Algorithm And 2) <> 0 Then
    If intLen1 < intLen2 Then
        FuzzyAlg2 String1, String2, intScore, intTotScore
    Else
        FuzzyAlg2 String2, String1, intScore, intTotScore
    End If
End If

'-------------------------------------------------------------
'-- If Algorithm = 4,5,6,7, use Levenstein Distance method  --
'-- (Algorithm 4 was Dan Ostrander's code)                  --
'-------------------------------------------------------------
If (Algorithm And 4) <> 0 Then
    If intLen1 < intLen2 Then
'        sngScore = FuzzyAlg4(String1, String1)
        sngScore = GetLevenshteinPercentMatch(String1:=String1, _
                                              String2:=String2, _
                                              Normalised:=True)
    Else
'        sngScore = FuzzyAlg4(String2, String1)
        sngScore = GetLevenshteinPercentMatch(String1:=String2, _
                                              String2:=String1, _
                                              Normalised:=True)
    End If
    intScore = intScore + (sngScore * 100)
    intTotScore = intTotScore + 100
End If

FuzzyPercent = intScore / intTotScore

End Function

Private Sub FuzzyAlg1(ByVal String1 As String, _
                      ByVal String2 As String, _
                      ByRef Score As Integer, _
                      ByRef TotScore As Integer)
Dim intLen1 As Integer, intPos As Integer, intPtr As Integer, intStartPos As Integer

intLen1 = Len(String1)
TotScore = TotScore + intLen1              'update total possible score
intPos = 0
For intPtr = 1 To intLen1
    intStartPos = intPos + 1
    intPos = InStr(intStartPos, String2, Mid$(String1, intPtr, 1))
    If intPos > 0 Then
        If intPos > intStartPos + 3 Then     'No match if char is > 3 bytes away
            intPos = intStartPos
        Else
            Score = Score + 1          'Update current score
        End If
    Else
        intPos = intStartPos
    End If
Next intPtr
End Sub
Private Sub FuzzyAlg2(ByVal String1 As String, _
                        ByVal String2 As String, _
                        ByRef Score As Integer, _
                        ByRef TotScore As Integer)
Dim intCurLen As Integer, intLen1 As Integer, intTo As Integer, intPtr As Integer, intPos As Integer
Dim strWork As String

intLen1 = Len(String1)
For intCurLen = 1 To intLen1
    strWork = String2                          'Get a copy of String2
    intTo = intLen1 - intCurLen + 1
    TotScore = TotScore + Int(intLen1 / intCurLen)  'Update total possible score
    For intPtr = 1 To intTo Step intCurLen
        intPos = InStr(strWork, Mid$(String1, intPtr, intCurLen))
        If intPos > 0 Then
            Mid$(strWork, intPos, intCurLen) = String$(intCurLen, &H0) 'corrupt found string
            Score = Score + 1     'Update current score
        End If
    Next intPtr
Next intCurLen

End Sub
Private Function FuzzyAlg4(strIn1 As String, strIn2 As String) As Single

Dim L1               As Integer
Dim In1Mask(1 To 24) As Long     'strIn1 is 24 characters max
Dim iCh              As Integer
Dim N                As Long
Dim strTry           As String
Dim strTest          As String

TopMatch = 0
L1 = Len(strIn1)
strTest = UCase(strIn1)
strCompare = UCase(strIn2)
For iCh = 1 To L1
    In1Mask(iCh) = 2 ^ iCh
Next iCh      'Loop thru all ordered combinations of characters in strIn1
For N = 2 ^ (L1 + 1) - 1 To 1 Step -1
    strTry = ""
    For iCh = 1 To L1
        If In1Mask(iCh) And N Then
            strTry = strTry & Mid(strTest, iCh, 1)
        End If
    Next iCh
    If Len(strTry) > TopMatch Then FuzzyAlg4Test strTry
Next N
FuzzyAlg4 = TopMatch / CSng(L1)
End Function
Sub FuzzyAlg4Test(strIn As String)

Dim l          As Integer
Dim strTry   As String
Dim iCh        As Integer

l = Len(strIn)
If l <= TopMatch Then Exit Sub
strTry = "*"
For iCh = 1 To l
    strTry = strTry & Mid(strIn, iCh, 1) & "*"
Next iCh
If strCompare Like strTry Then
    If l > TopMatch Then TopMatch = l
End If
End Sub

Public Function GetLevenshteinPercentMatch(ByVal String1 As String, _
                                            ByVal String2 As String, _
                                            Optional Normalised As Boolean = False) As Single
Dim iLen As Integer
If Normalised = False Then
    String1 = UCase$(WorksheetFunction.Trim(String1))
    String2 = UCase$(WorksheetFunction.Trim(String2))
End If
iLen = WorksheetFunction.Max(Len(String1), Len(String2))
GetLevenshteinPercentMatch = (iLen - LevenshteinDistance(String1, String2)) / iLen
End Function

'*******************************
'*** Get minimum of three values
'*******************************

Private Function Minimum(ByVal a As Integer, _
                         ByVal b As Integer, _
                         ByVal c As Integer) As Integer
Dim mi As Integer

  mi = a
  If b < mi Then
    mi = b
  End If
  If c < mi Then
    mi = c
  End If

  Minimum = mi

End Function

'********************************
'*** Compute Levenshtein Distance
'********************************

Public Function LevenshteinDistance(ByVal s As String, ByVal t As String) As Integer
Dim d() As Integer ' matrix
Dim m As Integer ' length of t
Dim N As Integer ' length of s
Dim I As Integer ' iterates through s
Dim j As Integer ' iterates through t
Dim s_i As String ' ith character of s
Dim t_j As String ' jth character of t
Dim cost As Integer ' cost

  ' Step 1

  N = Len(s)
  m = Len(t)
  If N = 0 Then
    LevenshteinDistance = m
    Exit Function
  End If
  If m = 0 Then
    LevenshteinDistance = N
    Exit Function
  End If
  ReDim d(0 To N, 0 To m) As Integer

  ' Step 2

  For I = 0 To N
    d(I, 0) = I
  Next I

  For j = 0 To m
    d(0, j) = j
  Next j

  ' Step 3

  For I = 1 To N

    s_i = Mid$(s, I, 1)

    ' Step 4

    For j = 1 To m

      t_j = Mid$(t, j, 1)

      ' Step 5

      If s_i = t_j Then
        cost = 0
      Else
        cost = 1
      End If

      ' Step 6

      d(I, j) = Minimum(d(I - 1, j) + 1, d(I, j - 1) + 1, d(I - 1, j - 1) + cost)

    Next j

  Next I

  ' Step 7

  LevenshteinDistance = d(N, m)

End Function

Function FuzzyVLookup(ByVal LookupValue As String, _
                      ByVal TableArray As Range, _
                      ByVal IndexNum As Integer, _
                      Optional NFPercent As String = "5%", _
                      Optional Rank As String = "1", _
                      Optional Algorithm As Integer = 3, _
                      Optional AdditionalCols As Integer = 0, _
                      Optional LookupColOffset As Integer = 0, _
                      Optional GroupColOffset As Integer = 0, _
                      Optional GroupValue As Variant = "") As Variant
'********************************************************************************
'** Function to Fuzzy match LookupValue with entries in                        **
'** table specified by TableArray.                                            **
'********************************************************************************
Dim bWanted As Boolean
Dim bError As Boolean

Dim iPtr1 As Integer
Dim iPtr2 As Integer
Dim iaRank() As Integer
Dim iaRankLowHigh() As Integer
Dim iRankHigh As Integer
Dim iRankLow As Long
Dim iRankStep As Integer
Dim lEndRow As Long

Dim rCur As Range
Dim rSearchRange As Range

Dim sngNFPercent As Single
Dim sngaNFPercent() As Single

Dim sChar As String
Dim sPrevChar As String
Dim sRankDelimiter As String
Dim sResult As String
Dim strNFPercent As String
Dim straNFPercent() As String

Dim vCurValue As Variant
Dim wsTable As Worksheet

'--------------------------------------------------------------
'--    Validation                                            --
'--------------------------------------------------------------

LookupValue = LCase$(Application.Trim(LookupValue))

If IsMissing(NFPercent) Then
    sngaNFPercent(0) = 0.05
    sngaNFPercent(1) = 1
'    sngMinPercent = 0.05
'    sngMaxPercent = 1
Else
    straNFPercent = Split(NFPercent, "~")
    ReDim sngaNFPercent(0 To 1)
    If UBound(straNFPercent) = 0 Then
        ReDim Preserve straNFPercent(0 To 1)
        straNFPercent(1) = "1"
    End If
    For iPtr1 = 0 To 1
        sngaNFPercent(iPtr1) = Val(straNFPercent(iPtr1))
        If sngaNFPercent(iPtr1) > 1 Then sngaNFPercent(iPtr1) = sngaNFPercent(iPtr1) / 100
        If (sngaNFPercent(iPtr1) <= 0) Or (sngaNFPercent(iPtr1) > 1) Then
            FuzzyVLookup = "*** 'NFPercent' is invalid ***"
            Exit Function
        End If
    Next iPtr1
    sngNFPercent = sngaNFPercent(0)
    If sngaNFPercent(0) > sngaNFPercent(1) Then
        sngNFPercent = sngaNFPercent(1)
        sngaNFPercent(1) = sngaNFPercent(0)
        sngaNFPercent(0) = sngNFPercent
    End If
End If

ReDim iaRank(1 To 2)
sRankDelimiter = ""

If IsNumeric(Rank) Then
    iaRank(1) = Val(Rank)
    iaRank(2) = iaRank(1)
    iRankLow = iaRank(1)
    iRankHigh = iaRank(1)
    If iaRank(1) < 1 Then
        FuzzyVLookup = "*** 'Rank' must be a positive integer or format integer-delimiter-integer ***"
        Exit Function
    End If
    iRankStep = 1
Else
    iPtr2 = 1
    sPrevChar = "0"
    For iPtr1 = 1 To Len(Rank)
         sChar = Mid$(Rank, iPtr1, 1)
         If IsNumeric(sChar) Then
            iaRank(iPtr2) = (iaRank(iPtr2) * 10) + Val(sChar)
         Else
            If IsNumeric(sPrevChar) Then
                If iPtr2 = 2 Then Exit For
                iPtr2 = 2
            End If
            sRankDelimiter = sRankDelimiter & sChar
         End If
         sPrevChar = sChar
    Next iPtr1
    bError = False
    If iaRank(1) < 1 Then bError = True
    If iaRank(2) < 1 Then bError = True
    If bError Then
        FuzzyVLookup = "*** 'Rank' must be a positive integer or format integer-delimiter-integer ***"
        Exit Function
    End If
    If iaRank(2) < iaRank(1) Then
        iRankStep = -1
        iRankLow = iaRank(2)
        iRankHigh = iaRank(1)
    Else
        iRankStep = 1
        iRankLow = iaRank(1)
        iRankHigh = iaRank(2)
    End If
End If

Set wsTable = Sheets(TableArray.Parent.Name)

ReDim mudRankData(1 To iRankHigh)

lEndRow = TableArray.Rows.Count
If VarType(TableArray.Cells(lEndRow, 1).Value) = vbEmpty Then
    lEndRow = TableArray.Cells(lEndRow, 1).End(xlUp).Row
End If
Set rSearchRange = Intersect(TableArray.Resize(, 1), wsTable.UsedRange)
If rSearchRange Is Nothing Then
    FuzzyVLookup = CVErr(xlErrNA)
Else


    '---------------
    '-- Main loop --
    '---------------
    
    If Len(GroupValue) <> 0 Then
        With rSearchRange.Offset(, GroupColOffset)
            For Each rCur In rSearchRange.Offset(, GroupColOffset)
                vCurValue = rCur.Value
                If VarType(vCurValue) = vbString Then
                    bWanted = LCase$(CStr(vCurValue)) = LCase$(CStr(GroupValue))
                Else
                    bWanted = Val(vCurValue) = Val(GroupValue)
                End If
                If bWanted Then
                    FuzzyVlookupMain LookupValue:=LookupValue, _
                                    TableArray:=rCur.Offset(, GroupColOffset * -1), _
                                    IndexNum:=IndexNum, _
                                    NFPercent:=sngNFPercent, _
                                    Rank:=iRankHigh, _
                                    Algorithm:=Algorithm, _
                                    AdditionalCols:=AdditionalCols, _
                                    LookupColOffset:=LookupColOffset
                End If
            Next rCur
        End With
    Else
        For Each rCur In rSearchRange
            FuzzyVlookupMain LookupValue:=LookupValue, _
                            TableArray:=rCur, _
                            IndexNum:=IndexNum, _
                            NFPercent:=sngNFPercent, _
                            Rank:=iRankHigh, _
                            Algorithm:=Algorithm, _
                            AdditionalCols:=AdditionalCols, _
                            LookupColOffset:=LookupColOffset
        Next rCur
    End If
    
    If (mudRankData(iaRank(1)).Percentage < sngNFPercent) _
    And (mudRankData(iaRank(2)).Percentage < sngNFPercent) Then
        '--------------------------------------
        '-- Return '#N/A' if below NFPercent --
        '--------------------------------------
        FuzzyVLookup = CVErr(xlErrNA)
    Else
        sResult = ""
        For iPtr2 = iaRank(1) To iaRank(2) Step iRankStep
            If (mudRankData(iPtr2).Percentage >= sngaNFPercent(0)) _
            And (mudRankData(iPtr2).Percentage <= sngaNFPercent(1)) Then
                mlBestMatchPtr = mudRankData(iPtr2).Offset - TableArray.Cells(1, 1).Row + 1
                If sResult <> "" Then sResult = sResult & sRankDelimiter
            
                If IndexNum > 0 Then
                    '-----------------------------------
                    '-- Return column entry specified --
                    '-----------------------------------
                    sResult = sResult & CStr(TableArray.Cells(mlBestMatchPtr, IndexNum))
                Else
                    '-----------------------
                    '-- Return offset row --
                    '-----------------------
                    sResult = sResult & CStr(mlBestMatchPtr)
                End If
            End If
        Next iPtr2
        FuzzyVLookup = sResult
    End If
    
End If          'If rSearchRange Is Nothing Then
End Function
Private Sub FuzzyVlookupMain(ByVal LookupValue As String, _
                                    ByVal TableArray As Range, _
                                    ByVal IndexNum As Integer, _
                                    Optional NFPercent As Single = 0.05, _
                                    Optional Rank As Integer = 1, _
                                    Optional Algorithm As Integer = 3, _
                                    Optional AdditionalCols As Integer = 0, _
                                    Optional LookupColOffset As Integer = 0)
Dim I As Integer
Dim intRankPtr As Integer
Dim intRankPtr1 As Integer
Dim strListString As String
Dim sngCurPercent As Single
Dim sngMinPercent As Single
Dim vCurValue As Variant

vCurValue = ""
For I = 0 To AdditionalCols
    vCurValue = vCurValue & CStr(TableArray.Offset(0, I + LookupColOffset).Value)
Next I
If VarType(vCurValue) = vbString Then
    strListString = LCase$(Application.Trim(vCurValue))
    
    '------------------------------------------------
    '-- Fuzzy match strings & get percentage match --
    '------------------------------------------------
    sngCurPercent = FuzzyPercent(String1:=LookupValue, _
                                 String2:=strListString, _
                                 Algorithm:=Algorithm, _
                                 Normalised:=True)
    
    If sngCurPercent >= NFPercent Then
        '---------------------------
        '-- Store in ranked array --
        '---------------------------
        For intRankPtr = 1 To Rank
            If sngCurPercent > mudRankData(intRankPtr).Percentage Then
                For intRankPtr1 = Rank To intRankPtr + 1 Step -1
                    With mudRankData(intRankPtr1)
                        .Offset = mudRankData(intRankPtr1 - 1).Offset
                        .Percentage = mudRankData(intRankPtr1 - 1).Percentage
                    End With
                Next intRankPtr1
                With mudRankData(intRankPtr)
                    .Offset = TableArray.Row
                    .Percentage = sngCurPercent
                End With
                Exit Sub
            End If
        Next intRankPtr
    End If
    
End If
End Sub


Attribute VB_Name = "Modulo143"
Sub Macro111()
Attribute Macro111.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro111 Macro
'

'
    Range("F17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
    Range("F20").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
        
    Range("B22").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
    
    '*********************************
      
      Range("B22").Select
        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("F20").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("F17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
End Sub
Attribute VB_Name = "Modulo144"
Sub ListBox7_Cambia()

If SONOinSI = 1 Then
If Sheets("COVER").Range("ZZ1") = 1 Then
Sheets("COVER").Label7.Visible = True
Sheets("COVER").Label8.Visible = False
Else
Sheets("COVER").Label7.Visible = False
Sheets("COVER").Label8.Visible = True
End If
End If

End Sub
Attribute VB_Name = "Modulo145"
Sub Macro112()
Attribute Macro112.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro112 Macro
'

'
    Range("A17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
End Sub
Attribute VB_Name = "Modulo15"

Public ULTIMONUMERO As Integer
Function AddSomeNumbers() As Integer
    ULTIMONUMERO = 207
End Function


Sub numero()
Attribute numero.VB_ProcData.VB_Invoke_Func = " \n14"

ActiveSheet.Unprotect
Application.ScreenUpdating = False
'
' numero Macro
'

'
        Range("R6:s354").Select
        Selection.NumberFormat = "0.00"
    
    
    Range("L1").Select
    Application.ScreenUpdating = True
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub percentuale()
Attribute percentuale.VB_ProcData.VB_Invoke_Func = " \n14"
'
' percentuale Macro
'

'
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("R6:S354").Select
    Selection.NumberFormat = "0.00%"
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ordina1()
Attribute ordina1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' ordina1 Macro
'

'
   ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "M6:M" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA2()
Attribute ORDINA2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' ORDINA2 Macro
'

'
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "M6:M" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA3()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "O6:O" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA4()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "O6:O" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA5()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "R6:R" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub ORDINA6()

ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "R6:R" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub ORDINA7()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "S6:S" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub ORDINA8()

ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "S6:S" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub image1e2()
ActiveSheet.Unprotect
ActiveSheet.Image1.Visible = True
ActiveSheet.Image2.Visible = True
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub Image2()
ActiveSheet.Unprotect
If ActiveSheet.Range("iv3") = True Then
ActiveSheet.Image2.Visible = False
Else
ActiveSheet.Image2.Visible = True
End If
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub

Sub ordina55()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "Q6:Q" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA66()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "Q6:Q" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ordina33()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "L6:L" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub
Sub ORDINA44()
ActiveSheet.Unprotect
Application.ScreenUpdating = False
    
    Range("L6:S" & ULTIMONUMERO).Select
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CLASSIFICHE").Sort.SortFields.Add Key:=Range( _
        "L6:L" & ULTIMONUMERO), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CLASSIFICHE").Sort
        .SetRange Range("L6:S" & ULTIMONUMERO)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("L1").Select
    Application.ScreenUpdating = True
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowSorting:=True, AllowFiltering:=True
End Sub


Attribute VB_Name = "Modulo16"
Sub RICOPIA()
Sheets("CHOICE FROM DATABASE").Activate
Columns("L:O").Select
    Selection.Copy
    Range("B1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("B1").Select
End Sub
Attribute VB_Name = "Modulo17"
Sub Pulsantediopzione22_Click()
On Error Resume Next
Application.ScreenUpdating = False
SONOinSI = 1

'------------*******************

'prima elimina il file di testo se per caso  avevamo scelto txt senza fare update e poi siamo passati qui
Sheets("COVER").Range("IA2") = 0
On Error Resume Next
Dim SFNAME
Dim paths As String
   paths = ActiveWorkbook.Path
SFNAME = paths & "\testoASB.txt"
    'CANCELLA IL FILE DI TESTO
   Dim TEST2
      TEST2 = Dir(SFNAME)
      DoEvents
If Not TEST2 = "" Then
DoEvents
    Kill (SFNAME)
    DoEvents
        DoEvents
End If

'--------------***************

ActiveSheet.Unprotect ("ballaredo55")
ActiveSheet.Unprotect

'-------------------------------------***
Range("F17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
    Range("F20").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
        
    Range("B22").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
    End With
    
    '*********************************
      Range("A17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    
'-------------------------------------***
Range("f7").Select


ActiveSheet.Protect ("ballaredo55")






Sheets("full screening").Range("N16").FormulaLocal = "=+'CE1'!F59"
Sheets("full screening").Range("O16").FormulaLocal = "=+'CE1'!G59"


Sheets("COVER").CommandButton1.Visible = False
Sheets("COVER").Label5.Visible = False
Sheets("COVER").ComboBox1.Visible = True
Sheets("COVER").ComboBox2.Visible = True
Sheets("COVER").ComboBox3.Visible = True
Sheets("COVER").Label1.Visible = False
Sheets("COVER").Label2.Visible = True
Sheets("COVER").Label3.Visible = True
Sheets("COVER").Label4.Visible = True
If Sheets("COVER").TextBox1.Value <> 0 Then
Sheets("COVER").TextBox1.Visible = True
End If


If Sheets("COVER").Range("ZZ1") = 1 Then
Sheets("COVER").Label7.Visible = True
Sheets("COVER").Label8.Visible = False
Else
Sheets("COVER").Label7.Visible = False
Sheets("COVER").Label8.Visible = True
End If



Sheets("how much it's worth ").Shapes("Casella di controllo 6").OLEFormat.Object.Value = True
Sheets("how much it's worth ").Shapes("Check Box 6").OLEFormat.Object.Value = True

Sheets("how much it's w. after Budget").Shapes("Casella di controllo 1").OLEFormat.Object.Value = True
Sheets("how much it's w. after Budget").Shapes("Check Box 1").OLEFormat.Object.Value = True

End Sub
Sub Pulsantediopzione20_Click()
On Error Resume Next
Application.ScreenUpdating = False
SONOinSI = 0

'--------------***************

ActiveSheet.Unprotect ("ballaredo55")
ActiveSheet.Unprotect

'-------------------------------------***

 '-------------------------------------***
    '*********************************
      
      Range("B22").Select
        With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("F20").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("F17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
'-------------------------------------***

Range("A17").Select
    
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With

'-------------------------------------***
Range("f7").Select


ActiveSheet.Protect ("ballaredo55")














Sheets("full screening").Range("N16") = 0
Sheets("full screening").Range("O16") = 0



Sheets("COVER").CommandButton1.Visible = True
Sheets("COVER").Label5.Visible = False
Sheets("COVER").ComboBox1.Visible = False
Sheets("COVER").ComboBox2.Visible = False
Sheets("COVER").ComboBox3.Visible = False
Sheets("COVER").Label1.Visible = False
Sheets("COVER").Label2.Visible = False
Sheets("COVER").Label3.Visible = False
Sheets("COVER").Label4.Visible = False
Sheets("COVER").TextBox1.Visible = False
Sheets("COVER").Label7.Visible = False
Sheets("COVER").Label8.Visible = False

Application.ScreenUpdating = False
Sheets("how much it's worth ").Shapes("Casella di controllo 6").OLEFormat.Object.Value = False
Sheets("how much it's worth ").Shapes("Check Box 6").OLEFormat.Object.Value = False

Sheets("how much it's w. after Budget").Shapes("Casella di controllo 1").OLEFormat.Object.Value = False
Sheets("how much it's w. after Budget").Shapes("Check Box 1").OLEFormat.Object.Value = False
apri
End Sub
Attribute VB_Name = "Modulo18"
Sub ButtonReset()
Dim ButtonCount As Integer
Dim MyShapes As OLEObjects
Dim ButtonSelected As OLEObject


'OLE Programmatic Identifiers for Commandbuttons = Forms.CommandButton.1
Set MyShapes = ActiveSheet.OLEObjects
For Each ButtonSelected In MyShapes
'Remove this line if fixing active object other than buttons
If ButtonSelected.progID = "Forms.CommandButton.1" Then
'MsgBox "motet|fffd|!"
ButtonSelected_Height = 88.5
ButtonSelected_Top = 246
ButtonSelected_Left = 333
ButtonSelected_Width = 146.25


ButtonSelected.Placement = 3

'ButtonSelected.Left = ButtonSelected.Left + 1
'ButtonSelected.Top = ButtonSelected.Top + 1
'ButtonSelected.Left = 10
'ButtonSelected.Width = 10


ButtonSelected.Height = ButtonSelected_Height
ButtonSelected.Top = ButtonSelected_Top
ButtonSelected.Left = ButtonSelected_Left
ButtonSelected.Width = ButtonSelected_Width


End If
Next
End Sub
Attribute VB_Name = "Modulo19"

Attribute VB_Name = "Modulo2"
Option Explicit
'''Function FileExists(ByVal FileToTest As String) As Boolean
  ''' FileExists = (Dir(FileToTest) <> "")
'''End Function

Sub AREEDISTAMPA()
Attribute AREEDISTAMPA.VB_ProcData.VB_Invoke_Func = " \n14"
'
' AREEDISTAMPA Macro
'

'
'Application.Cursor = xlWait
'Application.Calculation = xlManual

On Error Resume Next

Sheets("full screening").Select
    Application.GoTo Reference:="Print_Area"
   ' ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$A$1:$O$88"
    Range("g3").Select
    Sheets("how much is worth ").Select
    Application.GoTo Reference:="Print_Area"
   ' ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$b$1:$o$44"
    Range("n9").Select
    Sheets("how does it pay").Select
    Application.GoTo Reference:="Print_Area"
   ' ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$A$1:$R$34"
    Range("i7").Select
    Sheets("how does it work").Select
    Application.GoTo Reference:="Print_Area"
   ' ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$A$1:$q$32"
    Range("i7").Select
    Sheets("ID card").Select
    Application.GoTo Reference:="Print_Area"
    'ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$e$1:$g$23"
    Range("f1").Select
    Sheets("COVER").Select
    Application.GoTo Reference:="Print_Area"
    'ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.PageSetup.PrintArea = "$b$1:$t$32"
    Range("a1").Select
    Range("o2").Select
    
    'Application.Calculation = xlAutomatic
    'MsgBox "FINITO"
    'Application.Cursor = xlDefault
End Sub

Sub aggiornare()
On Error Resume Next
Application.DisplayAlerts = False
Application.ScreenUpdating = False

Application.Sheets("full screening").Range("N16").FormulaLocal = "=+'CE1'!F59"
Application.Sheets("full screening").Range("O16").FormulaLocal = "=+'CE1'!G59"

'''Sheets("INPUT Statement").ListBox1.Height = 1.65
'''Sheets("INPUT Statement").ListBox1.Width = 2
    xinp = 1

If Application.Sheets("COVER").CheckBox1.Value = True Then
memorizza4sinteticinosalvati
End If


'''--**----**************
Dim paths As String
   paths = ActiveWorkbook.Path
   
Dim SFNAME
Dim sfname2
Dim SFNAME3

SFNAME = paths & "\testoASB.txt"
sfname2 = paths & "\testoASB.xlsx"
SFNAME3 = paths & "\MODELLO NORMALE.xbrl.csv"
    'MsgBox SFNAME
   'CERCA IL FILE DI TESTO
   
   
   '''If FileExists(SFNAME) Then 'See above
      ' First remove readonly attribute, if set
      '''SetAttr SFNAME, vbNormal
      ' Then delete the file
      'MsgBox "trovatofileditesto parto con readfile222"
      
      
'qui guarda se l'utente ha richiesto per ultimo il txt o il csv per capire quale dei due elaborare se presenti entrambi
  Dim datacsv
  Dim dataxlsx
  
  dataxlsx = FileDateTime(sfname2)
   datacsv = FileDateTime(SFNAME3)
   
   If dataxlsx >= datacsv Then
  ' MsgBox "VAI CON TXT"
              Dim TEST
      TEST = Dir(SFNAME)
      DoEvents
If Not TEST = "" Then

'''MsgBox "I files Txt richiedono qualche secono in pi|fffd| di attesa The txt files require some second more waiting"
    READFILE222
    On Error Resume Next
     'Application.Calculation = xlAutomatic
    DoEvents
   Application.ScreenUpdating = False
'LASCIARE QUI SU IL RICALCOLO AUTOMATICO; SE LO METTO PIU' GIU' QUANDO FACCIO PRIMA UNA SPAGNOLA POI AL PRIMO COLPO NON AGGIORNA SE SCELGO IL TXT
Application.Calculation = xlAutomatic
   Application.Sheets("COVER").Range("O4") = ""
   DoEvents
Application.Sheets("COVER").Range("O5") = ""
DoEvents
Application.Sheets("COVER").Range("IA2") = 2
DoEvents

'MsgBox Sheets("COVER").Range("IA2")
    DoEvents
       '''End If
       
       
       'Application.Calculation = xlAutomatic
Application.Visible = True
DoEvents

 DoEvents
       
End If

Else

'------------*******************

'se non ha usato il txt lo elimina
Application.Sheets("COVER").Range("IA2") = 0
On Error Resume Next
       'CANCELLA IL FILE DI TESTO
   Dim TEST2
      TEST2 = Dir(SFNAME)
      DoEvents
If Not TEST2 = "" Then
DoEvents
    Kill (SFNAME)
    DoEvents
        DoEvents
End If

'--------------***************

   End If 'FINE SE DATAXLSX
  



'''--*************-------------




DoEvents

'MsgBox Sheets("COVER").Range("IA2")
apri

'If Sheets("COVER").CheckBox1.Value = True Then
'primaschedalite
'End If
xinp = 0



End Sub
Sub apri()


If Sheets("COVER").Range("ZY1") = 0 Then
Sheets("COVER").TextBox1.Visible = 0
Else
Sheets("COVER").TextBox1.Visible = 1
End If

If Sheets("COVER").Range("IA2") = 2 Then
Sheets("COVER").ComboBox3.Value = Sheets("CHOICE FROM DATABASE").Range("M150")
End If

If Sheets("COVER").Range("O2") = "x" Or Sheets("COVER").Range("O2") = "X" Or Sheets("COVER").Range("IA2") = 2 Then
'Sheets("COVER").Range("IA2") SIGNIFICA CHE PARTIAMO DA FILE TXT PRESO CON ASB
'****************
Dim III
Application.ScreenUpdating = False
DoEvents
If Sheets("COVER").Range("O5") <> "" Then
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox1.Value
Else
If Sheets("COVER").Range("O4") <> "" Then
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox2.Value
Else
If Sheets("COVER").Range("O6") <> "" Then
Sheets("CHOICE FROM DATABASE").Range("AB1") = Sheets("COVER").ComboBox3.Value
End If
End If
End If


Application.ScreenUpdating = False

'Sheets("CHOICE FROM DATABASE").Activate

    'Sheets("CHOICE FROM DATABASE").Range("AA2:AA320").Select
    'Selection.ClearContents
    'Selection.Copy
    
    'Sheets("CHOICE FROM DATABASE").Range("B2").Select
    'ActiveSheet.Paste
    'Sheets("CHOICE FROM DATABASE").Range("D2").Select
    'ActiveSheet.Paste

For III = 1 To 6
If Sheets("CHOICE FROM DATABASE").Range("AD1").Value > 0 Then
'MsgBox Sheets("CHOICE FROM DATABASE").Range("AD1").Value

'MsgBox Sheets("CHOICE FROM DATABASE").Range("B" & Sheets("CHOICE FROM DATABASE").Range("AD1").Value + 1)
Sheets("CHOICE FROM DATABASE").Range("B" & Sheets("CHOICE FROM DATABASE").Range("AD1").Value + 1) = ""

Application.ScreenUpdating = False

'MsgBox Sheets("CHOICE FROM DATABASE").Range("d" & Sheets("CHOICE FROM DATABASE").Range("AD1").Value + 1)
Sheets("CHOICE FROM DATABASE").Range("D" & Sheets("CHOICE FROM DATABASE").Range("AE1").Value + 1) = ""


Application.ScreenUpdating = False
End If
Next
Application.ScreenUpdating = False
On Error Resume Next
Sheets("CHOICE FROM DATABASE").Range("B" & Sheets("CHOICE FROM DATABASE").Range("Z1").Value + 1) = "X"
Application.ScreenUpdating = False
Sheets("CHOICE FROM DATABASE").Range("D" & Sheets("CHOICE FROM DATABASE").Range("Z1").Value + 1) = "X"
Application.ScreenUpdating = False
'Sheets("CHOICE FROM DATABASE").Range("B1").Select
'Application.ScreenUpdating = True
'Sheets("COVER").Activate

'****************

Else




Dim paths As String

Sheets("COVER").Range("ZZ2") = "" 'PER FAR FUNZIONARE IN ULTIMO LE FORMULE CHE PRENDONO IL BILANCIO DAL FILE E NON DAL FOGLIO DELLE QUOTATE

''QUANDO SI PREME F9 APRE IL FILE .CSV RICALCOLA E RICHIUDE IL FILE .CSV; DA TENERE SOLO PER IL CSV ED EVENT L'EXE FATTO CON DONEEX XCEL


''''On Error GoTo 1
On Error Resume Next

'MsgBox "WAIT A MOMENT PLEASE"

Application.ScreenUpdating = False
''''Sheets("SINTVALUE").Range("M13") = 0

paths = ActiveWorkbook.Path     '"C:\users\public\IFRx-O-Matic"
'MsgBox Path
Application.Iteration = True
Application.DisplayAlerts = False



'''--***--
 Dim TEST
      TEST = Dir(paths + "\MODELLO NORMALE.xbrl.csv")
      DoEvents
If Not TEST = "" Then
      
       
     Workbooks.Open Filename:= _
        paths + "\MODELLO NORMALE.xbrl.csv"
        
          Range("A1:A505").Select
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), _
        TrailingMinusNumbers:=True
       
    Range("F16").Select
    ActiveWindow.Visible = False
  '  Application.WindowState = xlMinimized

DoEvents
        
      
   ' Windows("Apri.xlsm").Activate
        
        
    'Workbooks.Open Filename:= _
      '  Path + "\IFRX Italian Firms RX csv 2014" _
       ' , UpdateLinks:=3
        
        
         
   'aa = Shell(Path + "\IFRX Italian Firms RX csv 2014.exe", 0)
   
     
    ' MsgBox "WAIT A MOMENT PLEASE"
    
1
    On Error GoTo 2
    
           '''' Windows("IFRX Italian Firms RX csv 2014.xlsm").Activate
           '''' DoEvents
            
'Sheets("SINTVALUE").Range("M13").FormulaLOCAL = "=ABS(IF(VALUE!I51>ABS(I15);(M16/SINTETIC!G17-1)/M15;((ABS(I15)-VALUE!I51)/SINTETIC!F17)/M15))"
''''Sheets("SINTVALUE").Range("M13").FormulaLocal = "=ASS(SE(VALUE!I51>ASS(I15);(M16/SINTETIC!G17-1)/M15;((ASS(I15)-VALUE!I51)/SINTETIC!F17)/M15))"

           ' Application.CalculateFull
            
            DoEvents
            
            'Application.WindowState = xlMaximized

         
' Windows("MODELLO NORMALE.xbrl.csv").Activate
'DoEvents
'pau = 3000
   ' While pau > 0
    'DoEvents
    'pau = pau - 1
    'DoEvents
    'Wend
Workbooks("MODELLO NORMALE.xbrl.csv").Close savechanges:=False
DoEvents



 'Windows("Apr2i.xlsm").Activate


'Workbooks("Apr2i.xlsm").Close SaveChanges:=False
DoEvents

 DoEvents
End If
'''------****----


2
'Application.WindowState = xlMaximized


Application.DisplayAlerts = True
'Application.ScreenUpdating = True
DoEvents

End If
End Sub





Sub Searchterm( _
   strSheetName As String, _
   strConn As String, _
   strQryTblName As String, _
   strDestRange As String, _
   strSrcTblList As String)
   
   With ThisWorkbook.Sheets(strSheetName)
      With .QueryTables.Add( _
         Connection:=strConn, _
         Destination:=Range(strDestRange))
        .Name = strQryTblName
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = False
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlNone
        .WebTables = strSrcTblList
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .Refresh BackgroundQuery:=False
      End With
      .Rows.AutoFit
   End With
    
End Sub




Attribute VB_Name = "Modulo20"
Attribute VB_Name = "Modulo21"
Attribute VB_Name = "Modulo22"
Sub Macro9()
Attribute Macro9.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro9 Macro
'

'
    ActiveSheet.Unprotect
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("B12:C12").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
End Sub
Sub Macro10()
Attribute Macro10.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro10 Macro
'

'
    ActiveSheet.Unprotect
    Range("E8:G8").Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("E9:G9").Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("E12:G12").Select
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Attribute VB_Name = "Modulo23"
Sub GetData()
    Dim DataSheet As Worksheet
    Dim endDate As String
    Dim startDate As String
    Dim fromCurr As String
    Dim toCurr As String
    Dim str As String
    Dim LastRow As Integer
    Dim bam As String

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    'Application.Calculation = xlCalculationManual
    
'With Application
'.DecimalSeparator = "."
'.ThousandsSeparator = ","
'End With

Application.DecimalSeparator = "."
 Application.ThousandsSeparator = ","
 Application.UseSystemSeparators = False



    Sheets("Data").Cells.Clear

    Set DataSheet = ActiveSheet

    startDate = DataSheet.Range("startDate").Value
    endDate = DataSheet.Range("endDate").Value
    fromCurr = DataSheet.Range("fromCurr").Value
    toCurr = DataSheet.Range("toCurr").Value

    If DataSheet.Range("bam") = "b" Then
        bam = "bid"
    ElseIf DataSheet.Range("bam") = "a" Then
        bam = "ask"
    ElseIf DataSheet.Range("bam") = "m" Then
        bam = "mid"
    End If


    str = "https://www.oanda.com/currency/historical-rates/download?quote_currency=" _
        & fromCurr _
        & "&end_date=" _
        & Year(endDate) & "-" & Month(endDate) & "-" & Day(endDate) _
        & "&start_date=" _
        & Year(startDate) & "-" & Month(startDate) & "-" & Day(startDate) _
        & "&period=daily&display=absolute&rate=0&data_range=c&price=" & bam & "&view=table&base_currency_0=" _
        & toCurr _
        & "&base_currency_1=&base_currency_2=&base_currency_3=&base_currency_4=&download=csv"
        
        
QueryQuote:
    With Sheets("Data").QueryTables.Add(Connection:="URL;" & str, Destination:=Sheets("Data").Range("a1"))
        .BackgroundQuery = True
        .TablesOnlyFromHTML = False
        .Refresh BackgroundQuery:=False
        .SaveData = True
    End With

    Sheets("Data").Range("a5").CurrentRegion.TextToColumns Destination:=Sheets("Data").Range("a5"), DataType:=xlDelimited, _
                                                           TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
                                                           Semicolon:=False, Comma:=True, Space:=False, Other:=True, OtherChar:=",", FieldInfo:=Array(1, 2)

    Sheets("Data").Columns("A:B").ColumnWidth = 12
    Sheets("Data").Range("A1:b2").Clear
    
    Sheets("Data").Columns("B").NumberFormat = "#,##0.0000;-#,##0.0000"

    LastRow = Sheets("Data").UsedRange.Row - 6 + Sheets("Data").UsedRange.Rows.Count

    Sheets("Data").Range("A" & LastRow + 2 & ":b" & LastRow + 5).Clear

    Sheets("Data").Sort.SortFields.Add Key:=Range("A5:A" & LastRow), _
                                       SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Sheets("Data").Sort
        .SetRange Range("A5:b" & LastRow)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
        .SortFields.Clear
    End With

    DeleteCharts

    'Application.DisplayAlerts = True

    ActiveSheet.Unprotect
With ActiveSheet.ChartObjects.Add _
         (Left:=Range("k14").Left, Width:=550, Top:=Range("k14").Top, Height:=400)
        .Chart.SetSourceData Source:=Sheets("Data").Range("A5:b" & LastRow)
        .Chart.ChartType = xlLine
    End With

    Dim ch As ChartObject
    For Each ch In ActiveSheet.ChartObjects
        ch.Select
        ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.Min(Sheets("Data").Range("b5:b" & LastRow))
        ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.Max(Sheets("Data").Range("b5:b" & LastRow))
        ActiveChart.Legend.Select
        Selection.Delete
    Next ch
With Application
.DecimalSeparator = ","
.ThousandsSeparator = "."
End With

ActiveSheet.Range("O3") = Sheets("Data").Range("B" & LastRow)
ActiveSheet.Range("O2") = Sheets("Data").Range("A" & LastRow)
 
 
 Application.GoTo Reference:=Range("h13"), _
 Scroll:=True

ActiveSheet.Protect
End Sub
Sub DeleteCharts()
On Error GoTo ExitChart
ActiveSheet.Unprotect
Dim ws As Worksheet
Dim chObj As ChartObject
Application.DisplayAlerts = False

'For Each ws In ActiveWorkbook.Worksheets
For Each chObj In ActiveSheet.ChartObjects
chObj.Delete
Next chObj
'Next ws

'ActiveWorkbook.Charts.Delete
 Application.GoTo Reference:=Range("A13"), _
 Scroll:=True
ExitChart:
'Application.DisplayAlerts = True
 Application.GoTo Reference:=Range("A13"), _
 Scroll:=True
ActiveSheet.Protect
Exit Sub
ActiveSheet.Protect
End Sub


Attribute VB_Name = "Modulo24"
Sub Macro12()
Attribute Macro12.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro12 Macro
'

'
    Columns("B:B").Select
    Selection.NumberFormat = "#,##0.0;-#,##0.0"
    Selection.NumberFormat = "#,##0.00_);(#,##0.00)"
    Selection.NumberFormat = "#,##0.000;-#,##0.000"
    Selection.NumberFormat = "#,##0.0000;-#,##0.0000"
    Selection.NumberFormat = "#,##0.00000;-#,##0.00000"
    Selection.NumberFormat = "#,##0.0000;-#,##0.0000"
    Range("C6").Select
End Sub
Attribute VB_Name = "Modulo25"
Sub Macro11()
Attribute Macro11.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro11 Macro
'

'
    Rows("62:62").Select
    ActiveSheet.Unprotect
    Selection.NumberFormat = "m/d/yyyy"
    Range("G63").Select
End Sub
Sub Macro13()
Attribute Macro13.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro13 Macro
'

'
    Range("H62:EK62").Select
End Sub
Attribute VB_Name = "Modulo26"
Sub Macro14()
Attribute Macro14.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro14 Macro
'

'
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Attribute VB_Name = "Modulo27"
Sub Macro18()
Attribute Macro18.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro18 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.PlotArea.Select
    ActiveWindow.SelectedSheets.PrintPreview
    ExecuteExcel4Macro "PRINT(1,,,1,,FALSE,,,,,,2,,,TRUE,,FALSE)"
    Range("M9:N10").Select
End Sub
Sub printchart()
Dim ch As ChartObject
Sheets("WORLD Quoted").Unprotect
    For Each ch In ActiveSheet.ChartObjects
        ch.Select
        ActiveChart.PlotArea.Select
    ActiveWindow.SelectedSheets.PrintPreview
    'ExecuteExcel4Macro "PRINT(1,,,1,,FALSE,,,,,,2,,,TRUE,,FALSE)"
        'Selection.Delete
    Next ch
Sheets("WORLD Quoted").Protect
End Sub
Attribute VB_Name = "Modulo28"
Sub formulX()
Dim formu1
Dim formu2

'fromu2 = "=SE(INDIRETTO(G$3)<>0;F14/INDIRETTO(G$3);0)"
'Range("g14").FormulaLocal = formu2

'formu1 = "=INDIRETTO(G$3)*G14"
'Range("f14").FormulaLocal = formu1

End Sub

Sub fATTURATO()
If xx <> 1 Then
MsgBox "Please press first the X button! Then during budget, if you want calculate markup, press Y button! "
Exit Sub
End If
xx = 0

If Range("N29") = 0 Then
MsgBox "Not possible in Profit & Loss with Cost of Sales reclassification"
Exit Sub
End If


Application.Cursor = xlWait
'Application.Cursor = xlDefault
Application.ScreenUpdating = False
ActiveSheet.Unprotect
StopMacros = 0
Dim prima
Dim DOPO
Dim zzz
zzz = 0
Range("AQ1:AQ300") = ""
Range("N29") = Range("N29")
Dim g10prima
Dim VAprima
Dim ACprima
g10prima = Range("G10")
VAprima = Range("F9")

ACprima = Range("F10")



 Range("F8,F10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    
    If Range("O18") = "x" Or Range("O18") = "X" Then
     Range("F34").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    End If
    
    
    If Range("O28") = "x" Or Range("O28") = "X" Then
     Range("N29").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    End If
    
    
    If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F14").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
End If
'ActiveSheet.Shapes("Grafico 12").ZOrder msoBringToFront
Application.ScreenUpdating = True
    
   DoEvents


If Range("O28") = "x" Or Range("O28") = "X" Then
Range("N28") = ""
End If

'Range("N29") = Range("N29") / 10

On Error Resume Next
While Range("N19") < 0 Or Range("F4") < 0
zzz = zzz + 1
prima = Range("g17")
Range("F38").FormulaLocal = "=(SINTETIC!F38+F5-SINTETIC!F5)"

Range("F8") = Range("F8") + Range("F4") * 0.001

Range("G10") = 1 / (1 + Range("L20")) + Range("G11")

'PER LA PARTE DI  aumento di fatturato che non deriva da aumento della produzione secondo la % impostata in L21, li pesco da magazzino, MA AGGIUNGO LA NECESSITA' DI MAGAZZINO INSITA IN OGNI AUMENTO DI FATTURATO
' il valore della merce a magazzino lo ipotizzo complementare del valore aggiunto anzich|fffd| la percentuale dei soli acquisti in casella 10
Range("F5") = Range("F5") - Range("F4") * 0.001 * (1 - Range("g13")) * (1 - Range("L21")) + Range("F4") * 0.001 * Range("L21") / Range("M79")

If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F14") = (Range("F8") + Range("F4") - Range("SINTETIC!F8")) / Range("N29") 'F4-SINTETIC!F8+F8
End If

DOPO = Range("g17")

Range("AQ" & zzz) = Range("g17")

DoEvents
DoEvents


'If dopo < prima * 1.01 Then
'MsgBox "This is the max  Ebitda% obtained with growth of sales!"
'StopMacros = 1
'End If


'DoEvents
 If StopMacros Then
 'Application.Cursor = xlWait
Application.Cursor = xlDefault
 'formulX
Range("N29").FormulaLocal = "=(F4-SINTETIC!F8+F8)/F14"
Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"
DoEvents
Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If

Wend


'On Error Resume Next
'If HH = Range("I3") Then
'Range("G4") = Range("G4") / 10
'Range("G3") = Range("G3") + 2 * Range("G4")
'End If
While Range("N19") > 0 And Range("F4") > 0
zzz = zzz + 1
'HH = Range("I3")
Range("F38").FormulaLocal = "=(SINTETIC!F38+F5-SINTETIC!F5)"
Range("F8") = Range("F8") - Range("F4") * 0.001
'Range("g10") = Range("g10") - Range("G10") * Range("L20")

' il valore della merce a magazzino lo ipotizzo complementare del valore aggiunto anzich|fffd| la percentuale dei soli acquisti in casella 10
Range("F5") = Range("F5") + Range("F4") * 0.001 * (1 - Range("g13")) * (1 - Range("L21")) - Range("F4") * 0.001 * Range("L21") / Range("M79")


If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F14") = (Range("F8") + Range("F4") - Range("SINTETIC!F8")) / Range("N29")
End If
Range("AQ" & zzz) = Range("g17")
DoEvents
DoEvents

'Range("G4") = Range("G4") * 10
 If StopMacros Then
 'Application.Cursor = xlWait
Application.Cursor = xlDefault
 'formulX
Range("N29").FormulaLocal = "=(F4-SINTETIC!F8+F8)/F14"
Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"
DoEvents

Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If
Wend
'formulX
Range("N29").FormulaLocal = "=(F4-SINTETIC!F8+F8)/F14"
Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"
Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Application.Cursor = xlDefault
End Sub

Sub ADATTA_ACQUISTI_AL_RICARICO()

Range("L20") = Range("L20").Value
Range("G10") = 1 / (1 + Range("L20")) + Range("G11")
xx = 1
End Sub
Attribute VB_Name = "Modulo29"
Public StopMacros As Boolean
Sub ARRESTA()
StopMacros = 1
'Range("L16").Select
' ActiveSheet.Protect
'Application.ScreenUpdating = True

End Sub

Sub ARRESTATESO()
StopMacros = 1
Range("B1").Select
 ActiveSheet.Protect
Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Modulo3"
Option Explicit


Sub chiudere()
Application.Cursor = xlDefault
ThisWorkbook.Close savechanges:=False
End Sub

Sub convertifile()
'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
    ''''DoEvents
    
Dim paths
On Error Resume Next
Application.ScreenUpdating = False
paths = ActiveWorkbook.Path     '"C:\users\public\IFRx-O-Matic"
'MsgBox Path
Application.Iteration = True
Application.DisplayAlerts = False

        
     Workbooks.Open Filename:= _
        paths + "\output.xlsx"

''''Application.WindowState = xlMinimized

DoEvents

AppActivate "output.xlsx"

DoEvents

Sheets("output").Select
DoEvents

     
    
    Columns("A:G").Select
    Selection.Replace What:="", Replacement:="""""", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="""""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        DoEvents
        DoEvents
        Range("A1").Select
    
    Sheets("output").Name = "output"
    DoEvents
    Sheets("output").Name = "MODELLO NORMALE.xbrl"
    DoEvents
    
    
    Application.DisplayAlerts = False
            ActiveWorkbook.SaveAs Filename:= _
        paths + "\MODELLO NORMALE.xbrl.csv", FileFormat:= _
        xlCSV, CreateBackup:=False
    
    DoEvents
    
   ' sleep (1)
    DoEvents
    
    'Application.CalculateFull 'FA ANDARE IN CRASH EXCEL !!!!!!!!!
    'forse perch|fffd| non avevo salvato questo file con il giusto file CSV aperto distribuendo anche quello asieme a questo !!
    
    'DoEvents
    'DoEvents
    
    
    
    Workbooks("MODELLO NORMALE.xbrl.csv").Close savechanges:=False
DoEvents
    
        DoEvents

''''Application.WindowState = xlMaximized
DoEvents
Application.DisplayAlerts = True
Application.ScreenUpdating = True
DoEvents
    

End Sub
Attribute VB_Name = "Modulo30"
Sub provar()
Dim formu
formu = "=INDIRETTO(G$3)*G14"
Range("f14").FormulaLocal = formu
End Sub

Sub VALOREAGG()

If Range("N29") = 0 Then
MsgBox "Not possible in Profit & Loss with Cost of Sales reclassification"
Exit Sub
End If


Application.Cursor = xlWait
'Application.Cursor = xlDefault
Dim zzz
zzz = 0

StopMacros = 0
'Range("N29") = Range("N29") / 10
Application.ScreenUpdating = False
ActiveSheet.Unprotect
Range("AQ1:AQ300") = ""
If Range("O28") = "x" Or Range("O28") = "X" Then
Range("N28") = ""
End If

Range("F10, F8, F5, N29").Select

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
        End With

'Range("F38").Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = True
    

'ActiveSheet.Shapes("Grafico 12").ZOrder msoBringToFront
Application.ScreenUpdating = True
    
   DoEvents
    



On Error Resume Next
' il valore della merce a magazzino lo ipotizzo complementare del valore aggiunto anzich|fffd| la percentuale dei soli acquisti in casella 10
 'quello che diminuisco come fatturato lo devo mettere a magazzino perch|fffd| comunque lo produco
'''Range("F5") = Range("F5") - Range("F4") * (1 - Range("g13")) * Range("L24")

Range("F5") = Range("F5") - Range("F4") * (1 - Range("g13")) * Range("L24") / Range("M79")
Range("F8") = Range("F8") - Range("F4") * Range("L24")

While Range("N22") < 0 And Range("F10") > 0
zzz = zzz + 1

Range("F38").FormulaLocal = "=(SINTETIC!F38+F5-SINTETIC!F5)"

Range("g10") = Range("g10") - 0.001
'''Range("F8") = -Range("F4") * Range("L24")  'Range("F8") - Range("F4") * Range("L24")

' il valore della merce a magazzino lo ipotizzo complementare del valore aggiunto anzich|fffd| la percentuale dei soli acquisti in casella 10
 'quello che diminuisco come fatturato lo devo mettere a magazzino perch|fffd| comunque lo produco
 'Range("F5") = Range("F5") + Range("F4") * (1 - Range("g13")) * Range("L24")


'Range("g10") = Range("g10") - Range("G10") * 0.001
'Range("F8") = Range("F8") - (Range("F4") - Range("SINTETIC!F8")) * Range("L24")
'Range("F5") = Range("F5") + (Range("F4") - Range("SINTETIC!F8")) * Range("g10") * Range("L24")

'Range("F38") = Range("F38") + Range("F4") * 0.001 * Range("g10") * Range("L24")
'Range("M79").FormulaLocal = "=F38/(F4-SINTETIC!F8)"
Range("AQ" & zzz) = Range("g17")
DoEvents
DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
 If StopMacros Then
Application.Cursor = xlDefault

Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"

 'Range("F38").Select
       ' Selection.Locked = True
   ' Selection.FormulaHidden = True
 
 Range("L16").Select
 ActiveSheet.Protect
 Application.ScreenUpdating = True
 Exit Sub
 End If

Wend


'On Error Resume Next
'If HH = Range("I3") Then
'Range("G4") = Range("G4") / 10
'Range("G3") = Range("G3") + 2 * Range("G4")
'End If
While Range("N22") > 0 Or Range("F10") < 0
zzz = zzz + 1
'HH = Range("I3")

Range("F38").FormulaLocal = "=(SINTETIC!F38+F5-SINTETIC!F5)"

Range("g10") = Range("g10") + 0.001
'Range("F8") = Range("F8") + Range("F4") * Range("L24")

' il valore della merce a magazzino lo ipotizzo complementare del valore aggiunto anzich|fffd| la percentuale dei soli acquisti in casella 10
'Range("F5") = Range("F5") - Range("F4") * (1 - Range("g13")) * Range("L24")

'Range("G10") = Range("G10") + Range("G10") * 0.001
'Range("F8") = Range("F8") + (Range("F4") - Range("SINTETIC!F8")) * Range("L24")
'Range("F5") = Range("F5") - (Range("F4") - Range("SINTETIC!F8")) * Range("g10") * Range("L24")

''Range("F38") = Range("F38") - Range("F4") * 0.001 * Range("g10") * Range("L24")

Range("AQ" & zzz) = Range("g17")
DoEvents
DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'DoEvents
'Range("G4") = Range("G4") * 10
 If StopMacros Then
Application.Cursor = xlDefault

Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"
 'Range("F38").Select
        'Selection.Locked = True
    'Selection.FormulaHidden = True
 Range("L16").Select
 ActiveSheet.Protect
 Application.ScreenUpdating = True
 
 Exit Sub
 End If

Wend
'Range("F38").Select
        'Selection.Locked = True
    'Selection.FormulaHidden = True
    
    Range("M79") = (Range("F4") - Range("SINTETIC!F8") + Range("F8")) / Range("F38")
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"

Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Application.Cursor = xlDefault
End Sub
Sub WORKSCOST()

If Range("N29") = 0 Then
MsgBox "Not possible in Profit & Loss with Cost of Sales reclassification"
Exit Sub
End If


Dim fatsulav
Dim precf8
Dim prf8
Dim zzz
zzz = 0
Application.Cursor = xlWait
'Application.Cursor = xlDefault

StopMacros = 0
ActiveSheet.Unprotect
Range("AQ1:AQ300") = ""
If Range("O25") - Range("G17") > Range("G14") Then
MsgBox "EBITDA NOT OBTAINABLE NOT EVEN ELIMINATING WORK'S COST"
Exit Sub
End If

Application.ScreenUpdating = False
 

Range("F14").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With

If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F34, F8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
        End With
End If

 If Range("O28") = "x" Or Range("O28") = "X" Then
     Range("N29").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    End If

'ActiveSheet.Shapes("Grafico 12").ZOrder msoBringToFront
Application.ScreenUpdating = True
    
   DoEvents


If Range("O28") = "x" Or Range("O28") = "X" Then
Range("N28") = ""
End If


'precf8 = Range("F8")
fatsulav = (Range("F4") + Range("F8") - Range("SINTETIC!F8")) / Range("F14")

'Range("N29") = Range("N29") / 10

On Error Resume Next
While Range("N25") < 0 And Range("F14") > 0
zzz = zzz + 1
prf8 = Range("F8")
Range("f14") = Range("f14") - Range("f14") * 0.001 'Range("N29") / Range("F4")
Range("AQ" & zzz) = Range("g17")
DoEvents
DoEvents


If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F8") = Range("F14") * fatsulav - (Range("F4") - Range("SINTETIC!F8"))
End If

'DoEvents
 If StopMacros Then
Application.Cursor = xlDefault
 Range("L16").Select
 ActiveSheet.Protect
 Application.ScreenUpdating = True

 Exit Sub
 End If

Wend


'On Error Resume Next
'If HH = Range("I3") Then
'Range("G4") = Range("G4") / 10
'Range("G3") = Range("G3") + 2 * Range("G4")
'End If
While Range("N25") > 0 Or Range("F14") < 0
zzz = zzz + 1
'HH = Range("I3")
prf8 = Range("F8")
Range("f14") = Range("f14") + Range("f14") * 0.001 'Range("N29") / Range("F4")
Range("AQ" & zzz) = Range("g17")
DoEvents
DoEvents

If Range("O28") <> "x" And Range("O28") <> "X" Then
Range("F8") = Range("F14") * fatsulav - (Range("F4") - Range("SINTETIC!F8"))
End If
'DoEvents
'Range("G4") = Range("G4") * 10
 If StopMacros Then
Application.Cursor = xlDefault
 Application.ScreenUpdating = True
 Range("L16").Select
 ActiveSheet.Protect
 Exit Sub
 End If

Wend
Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Application.Cursor = xlDefault
End Sub
Attribute VB_Name = "Modulo31"
Sub Pulsantediopzione16_Click()
Range("n28") = "X"
Range("o28") = ""
End Sub
Sub Pulsantediopzione17_Click()
Range("o28") = "X"
Range("n28") = ""
End Sub
Sub Pulsantediopzione18_Click()
Range("n18") = "X"
Range("o18") = ""
End Sub
Sub Pulsantediopzione19_Click()
Range("o18") = "X"
Range("n18") = ""
End Sub


Attribute VB_Name = "Modulo32"
Sub ricalcolaricarico()
ActiveSheet.Range("L20").FormulaLocal = "=(" & Range("g3") & "/(F10-F11)-1)+(1000-M20)*0,0005"
End Sub

Sub RESETSFONDI()
 
Application.Cursor = xlDefault
Application.ScreenUpdating = False
ActiveSheet.Unprotect
Range("F5").FormulaLocal = "=+SINTETIC!F5*$D$2"
Range("AQ1:AQ300") = ""
Range("F8") = 0
Range("G10").FormulaLocal = "=+'full screening'!$G10"
Range("F14").FormulaLocal = "=+'full screening'!$F14"
Range("F38").FormulaLocal = "=(F4-SINTETIC!F8+F8)/M79"
Range("M79").FormulaLocal = "='full screening'!M79"
Range("N29").FormulaLocal = "=(F4-SINTETIC!F8+F8)/F14"
Range("M20") = 1000
Range("M21") = 1000
Range("M24") = 1000
 Range("L20").FormulaLocal = "=(" & Range("g3") & "/(F10-F11)-1)+(1000-M20)*0,0005"
Range("L21").FormulaLocal = "= 100%+(1000-M21)*0,0005"
Range("L24").FormulaLocal = "= 3%+(1000-M24)*0,0005"

Range("F34, F10, F8, F5, F14, M79").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("M79:M83").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
        .PatternTintAndShade = 0
    End With
    
     Range("T29:U29").Select
    Selection.Copy
    Range("N29:O29").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Range("L16:N17").Select
    
    DoEvents
    
    
    'ActiveSheet.Shapes.Range(Array("Picture 2")).Select
    'Selection.ShapeRange.ZOrder msoBringToFront
    'DoEvents
    'DoEvents
    'Selection.ShapeRange.ZOrder msoSendToBack
    'ActiveSheet.ChartObjects("Grafico 12").Select
     ' ActiveSheet.ChartObjects("Grafico 12").Activate
    'ActiveSheet.Shapes("Grafico 12").ZOrder msoSendToBack
    'DoEvents
    'DoEvents
        
Range("L16").Select
ActiveSheet.Protect
Application.ScreenUpdating = True

 

End Sub

Sub RESETTESO()
Application.Cursor = xlDefault
Application.ScreenUpdating = False
ActiveSheet.Unprotect
Range("AA12").Formula = "=Int((AF60 ) / (F39 ) * 100)"
Range("F50").FormulaLocal = "=+SINTETIC!F50*$D$2"

Range("F68").FormulaLocal = "=+SINTETIC!F68*$D$2"
Range("F55").FormulaLocal = "=+SINTETIC!F55*$D$2"


Range("M79").FormulaLocal = "='full screening'!M79"
Range("M80").FormulaLocal = "='full screening'!M80"
Range("M81").FormulaLocal = "='full screening'!M81"
Range("M82").FormulaLocal = "='full screening'!M82"
Range("M83").FormulaLocal = "='full screening'!M83"


Range("F48, F50, F68,M79, M80, M81, M82, M83").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("M79:M83").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
        .PatternTintAndShade = 0
    End With
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Modulo33"
Sub Macro15()
Attribute Macro15.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro15 Macro
'

'
    Range("F38").Select
    Selection.Locked = False
    Selection.FormulaHidden = True
    Selection.Locked = True
    Selection.FormulaHidden = True
End Sub
Attribute VB_Name = "Modulo34"
Sub Macro16()
Attribute Macro16.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro16 Macro
'

'
zzz = 3
    'Range("AQ1:AQ3").Select
    ActiveSheet.Shapes.AddChart2(227, xlLine).Select
    ActiveChart.SetSourceData Source:=Range("BUDGETING!$AQ$1:$AQ$" & zzz)
    ActiveChart.ChartTitle.Select
    ActiveChart.ChartTitle.Text = "EBITDA%"
    Selection.Format.TextFrame2.TextRange.Characters.Text = "EBITDA%"
    With Selection.Format.TextFrame2.TextRange.Characters(1, 7).ParagraphFormat
        .TextDirection = msoTextDirectionLeftToRight
        .Alignment = msoAlignCenter
    End With
    With Selection.Format.TextFrame2.TextRange.Characters(1, 7).Font
        .BaselineOffset = 0
        .Bold = msoFalse
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.RGB = RGB(89, 89, 89)
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 14
        .Italic = msoFalse
        .Kerning = 12
        .Name = "+mn-lt"
        .UnderlineStyle = msoNoUnderline
        .Spacing = 0
        .Strike = msoNoStrike
    End With
    Range("AT13").Select
End Sub
Attribute VB_Name = "Modulo35"
Sub tesoreria()
If Range("AA12") > 100 Then
'Range("AA12") = 98
MsgBox " Input a % Cust < 100 please!"
Exit Sub

End If


'On Error Resume Next
'If Range("AA12") < 0 Or Range("AA12") >= 100 Then
'MsgBox " Porta, nella casella gialla, la % necessit|fffd| fin. a breve ad un numero >0 o <100 rispetto ai crediti clienti! Change, in the yellow box, the % of short financial need to a number > 0 or <100 after the claims of customers!"
'Exit Sub
'End If

Range("AA12") = Range("AA12").Value

    Application.Cursor = xlWait
'Application.Cursor = xlDefault

Application.ScreenUpdating = False
ActiveSheet.Unprotect
StopMacros = 0
Dim prima
Dim DOPO
Dim zzz
'zzz = 0
'Range("N29") = Range("N29")

'Range("AQ1:AQ300") = ""
 Range("M79, M80, M81, M82, M83, F68, F48").Select

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
        .PatternTintAndShade = 0
    End With
    
     Range("b1").Select
    
Application.ScreenUpdating = True
    
   DoEvents

'On Error Resume Next
'MsgBox (Range("AF60") + Range("AF63")) / (Range("f39") + Range("Af59"))
'MsgBox Range("AA12")/100 * 1.5
prima = Range("f39")
'****************************
'While (Range("AF60") + Range("AF63")) / (Range("f39") + Range("Af59")) > Range("AA12") / 100 * 1.5 'LA NECESS FIN A BREVE tolta la copertura infragruppo SUPERA I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12
 While (Range("AF60")) / (Range("f39")) > Range("AA12") / 100 '* 1.5   'LA NECESS FIN A BREVE ******************************* SUPERA del 50% I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12
'MsgBox "MANOVRO CIRCOLA"
Range("m79") = Range("m79") * 1.01
Range("m80") = Range("m80") * 0.995
Range("m81") = Range("m81") * 0.995
Range("m82") = Range("m82") * 1.003
Range("m83") = Range("m83") * 1.003
DoEvents
DoEvents
DoEvents


 If StopMacros Then
 StopMacros = 0
 GoTo SALTAACCN
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If

Wend

DoEvents


'On Error Resume Next
'If HH = Range("I3") Then
'Range("G4") = Range("G4") / 10
'Range("G3") = Range("G3") + 2 * Range("G4")
'End If

SALTAACCN:
prima = Abs(Range("AF62"))
While Range("AF62") < 0  'LA TESORERIA, CIO|fffd| LA DISP FIN A LUNGO MENO NECESSITA' FIN A BREVE, E' NEGATIVA...
If Range("j1") = False Then
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'
Else
Range("F55") = Range("F55") + prima / 30  'AUMENTA Il CAPITALE di un terzo risp al debito 3 di debito e 1 di cap
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'

End If
'MsgBox "QUI NO"
DoEvents
DoEvents
DoEvents

'Range("G4") = Range("G4") * 10
 If StopMacros Then
 StopMacros = 0
  GoTo SALTAACCN0
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If
Wend
'formulX
'MsgBox "AF62 DIVENTATO 0 "
SALTAACCN0:
prima = Abs(Range("AF59"))
While Range("AF59") < 0
If Range("j1") = False Then
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'
Else
Range("F55") = Range("F55") + prima / 30  'AUMENTA Il CAPITALE di un terzo risp al debito 3 di debito e 1 di cap
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'

End If

DoEvents
DoEvents
DoEvents

'Range("G4") = Range("G4") * 10
 If StopMacros Then
  Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If
Wend

'formulX









prima = Range("f39")
'While Range("AF60") + Range("AF63") > (Range("f39") + Range("Af59")) * Range("AA12") / 100 'LA NECESS FIN A BREVE tolta la copertura infragruppo SUPERA I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12
 While Range("AF60") > (Range("f39")) * Range("AA12") / 100   'LA NECESS FIN A BREVE ******** SUPERA I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12

Range("m79") = Range("m79") * 1.01
Range("m80") = Range("m80") * 0.995
Range("m81") = Range("m81") * 0.995
Range("m82") = Range("m82") * 1.003
Range("m83") = Range("m83") * 1.003
DoEvents
DoEvents
DoEvents



 If StopMacros Then
 StopMacros = 0
 GoTo SALTAACCN1
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If

Wend

'Range("AA12").Formula = "=Int((AF60 + AF63) / (F39 + AF59) * 100)"


'While Range("AF60") + Range("AF63") < (Range("f39") + Range("Af59")) * Range("AA12") / 100 'LA NECESS FIN A BREVE tolta la copertura infragruppo SUPERA I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12
 While Range("AF60") < (Range("f39")) * Range("AA12") / 100 And Range("AF60") > 0 'LA NECESS FIN A BREVE ******** SUPERA I CLIENTI DI UNA PERCENTUALE SEGNATA IN AA12

Range("m79") = Range("m79") * 0.99
Range("m80") = Range("m80") * 1.005
Range("m81") = Range("m81") * 1.005
Range("m82") = Range("m82") * 0.997
Range("m83") = Range("m83") * 0.997
DoEvents
DoEvents
DoEvents


 If StopMacros Then
 StopMacros = 0
 GoTo SALTAACCN1
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If

Wend

SALTAACCN1:
'//////////
prima = Abs(Range("AF59"))
While Range("AF59") < 0
If Range("j1") = False Then
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'
Else
Range("F55") = Range("F55") + prima / 30  'AUMENTA Il CAPITALE di un terzo risp al debito 3 di debito e 1 di cap
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'

End If

DoEvents
DoEvents
DoEvents

'Range("G4") = Range("G4") * 10
 If StopMacros Then
 StopMacros = 0
  GoTo SALTAACCN2
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If
Wend

DoEvents

'Application.ScreenUpdating = True
'Application.Cursor = xlDefault
'Stop

SALTAACCN2:

prima = Abs(Range("AF62"))
While Range("AF62") < 0  'LA TESORERIA, CIO|fffd| LA DISP FIN A LUNGO MENO NECESSITA' FIN A BREVE, E' NEGATIVA...
If Range("j1") = False Then
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'
Else
Range("F55") = Range("F55") + prima / 30  'AUMENTA Il CAPITALE di un terzo risp al debito 3 di debito e 1 di cap
Range("F68") = Range("F68") + prima / 10  'AUMENTA I DEBITI VERSO BANCHE A MEDIO CHE FANNO AUMENTARE GLI ALTRI TITOLI A BREVE CHE FANNO PARTE DELLA LIQUIDITA'

End If

DoEvents
DoEvents
DoEvents

'Range("G4") = Range("G4") * 10
 If StopMacros Then
 
 Application.Cursor = xlDefault
 'formulX
Range("B1").Select
ActiveSheet.Protect
Application.ScreenUpdating = True
Exit Sub
End If
Wend
DoEvents





'Range("AA12").Formula = "=Int((AF60 + AF63) / (F39 + AF59) * 100)"
Range("AA12").Formula = "=Int((AF60 ) / (F39 ) * 100)"

'MsgBox "La variazione del magazzino qui proposta per un maggiore finanziario equilibrio, |fffd| teorica e deve essere applicata ripartendola sulle vendite a conto economico in uno o pi|fffd| esercizi.; The change in the stock here proposal to improve the financial balance, is theoretical and should be applied to the income statement splitting it on the sales of one or more exercises."

ActiveSheet.Protect
Application.ScreenUpdating = True
Application.Cursor = xlDefault



End Sub
Attribute VB_Name = "Modulo36"
Sub Macro17()
Attribute Macro17.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro17 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.Shapes("Grafico 12").ZOrder msoSendToBack
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveChart.Axes(xlCategory).Select
    ActiveChart.ChartArea.Select
    ActiveSheet.Shapes("Grafico 12").ZOrder msoBringToFront
End Sub
Sub Macro19()
Attribute Macro19.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro19 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 12").Activate
'    ActiveChart.Axes(xlCategory).Select
    Range("P8").Select
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.Shapes("Grafico 12").ZOrder msoSendToBack
End Sub
Sub Macro20()
Attribute Macro20.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro20 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.Shapes("Grafico 12").ZOrder msoSendToBack
    ActiveCell.Offset(2, -4).Range("A1:B2").Select
End Sub
Sub DimmiNomeGrafico()
 On Error Resume Next  'per evitare errore di debug se non si |fffd| selezionato il grafico
 With ActiveChart
 MsgBox "Sono il Grafico " & .Name & " e di tipo " & .ChartType
 End With
 Resume
 End Sub
Sub Macro21()
Attribute Macro21.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro21 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Picture 2")).Select
    Selection.ShapeRange.ZOrder msoBringToFront
    Range("L16:M17").Select
End Sub
Attribute VB_Name = "Modulo37"
Sub Pulsantediopzione33_Click()

End Sub
Attribute VB_Name = "Modulo38"
Sub Macro22()
Attribute Macro22.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro22 Macro
'

'
    Range("M79:M83").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
        .PatternTintAndShade = 0
    End With
    Range("P79").Select
End Sub

Sub Chartlist()
 Dim wks As Worksheet
 Dim lngS As Long, lngC As Long, lngX As Long

 Set wks = ActiveWorkbook.Worksheets.Add
 For lngS = 1 To ActiveWorkbook.Sheets.Count
 With ActiveWorkbook.Sheets(lngS)
 For lngC = 1 To .ChartObjects.Count
 lngX = lngX + 1
 wks.Cells(lngX, 1).Value = .Name & "; " & .ChartObjects(lngC).Name
 Next lngC
 End With
 Next lngS
 wks.Columns(1).WrapText = False
 wks.Columns(1).EntireColumn.AutoFit
 Set wks = Nothing
 End Sub
Attribute VB_Name = "Modulo39"
Sub Prepara()
'
' Macro23 Macro
'

'

Sheets("BUDGETING").Select
ActiveSheet.Unprotect
    Columns("Q:Q").Select
    ActiveWindow.LargeScroll ToRight:=1
    Columns("Q:AQ").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Selection.ColumnWidth = 1
    Range("L16:N17").Select
    ActiveWindow.SmallScroll ToRight:=-6
     ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
    Sheets("COVER").Select
    
    On Error Resume Next
    ActiveSheet.Shapes.Range(Array("TextBox 15")).Select
     ActiveSheet.Shapes.Range(Array("CasellaDiTesto 15")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("TextBox 12")).Select
    ActiveSheet.Shapes.Range(Array("CasellaDiTesto 12")).Select
    Selection.Delete
    ActiveWindow.SmallScroll Down:=12
    ActiveSheet.Shapes.Range(Array("TextBox 7")).Select
    ActiveSheet.Shapes.Range(Array("CasellaDiTesto 7")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Button 18")).Select
    ActiveSheet.Shapes.Range(Array("Pulsante 18")).Select
    Selection.Delete
    Range("J22:P25").Select
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("J22").Select

    Range("F7").Select
    Sheets("ULTIMO").Select
    
    ActiveSheet.Shapes.Range(Array("Rectangle 2")).Select
        ActiveSheet.Shapes.Range(Array("Rettangolo 2")).Select

    Selection.ShapeRange.Height = 34639.3700787402
    Selection.ShapeRange.Width = 15335.4330708661
    Application.CommandBars("Format Object").Visible = False
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub
Attribute VB_Name = "Modulo4"
Option Explicit
'Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long

#If VBA7 Then
Private Declare PtrSafe Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#Else
Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#End If



Private Const SW_SHOWMAXIMIZED = 1


#If VBA7 Then
     Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hwnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
 #Else
     Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hwnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
 #End If

'Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe



Private Const GW_HWNDNEXT As Long = 2&
#If VBA7 Then
Private Declare PtrSafe Function FindWindow Lib "user32" _
Alias "FindWindowA" _
(ByVal lpClassName As Long, _
ByVal lpWindowName As Long) As Long
#Else
Private Declare Function FindWindow Lib "user32" _
Alias "FindWindowA" _
(ByVal lpClassName As Long, _
ByVal lpWindowName As Long) As Long
#End If


#If VBA7 Then
Private Declare PtrSafe Function GetParent Lib "user32" _
(ByVal hwnd As Long) As Long

#Else
Private Declare Function GetParent Lib "user32" _
(ByVal hwnd As Long) As Long
#End If

#If VBA7 Then
Private Declare PtrSafe Function GetWindowThreadProcessId Lib "user32" _
(ByVal hwnd As Long, _
lpdwProcessId As Long) As Long

#Else
Private Declare Function GetWindowThreadProcessId Lib "user32" _
(ByVal hwnd As Long, _
lpdwProcessId As Long) As Long
#End If

#If VBA7 Then
Public Declare PtrSafe Function GetWindow Lib "user32" _
(ByVal hwnd As Long, _
ByVal wCmd As Long) As Long
#Else
Public Declare Function GetWindow Lib "user32" _
(ByVal hwnd As Long, _
ByVal wCmd As Long) As Long
#End If

#If VBA7 Then
Private Declare PtrSafe Function SendMessageByString Lib "user32" _
Alias "SendMessageA" _
(ByVal hwnd As Long, _
ByVal wMsg As Long, _
ByVal wParam As Long, _
ByVal lParam As String) As Long
#Else
Private Declare Function SendMessageByString Lib "user32" _
Alias "SendMessageA" _
(ByVal hwnd As Long, _
ByVal wMsg As Long, _
ByVal wParam As Long, _
ByVal lParam As String) As Long
#End If


Private Const WM_SETTEXT = &HC
Public Const GW_CHILD = 5
Public lPid As Long, hwnd As Long

Public Function HwndFromPID(ByVal pid As Long) As Long
    Dim lHWND As Long, lPid As Long
    
    lHWND = FindWindow(ByVal 0&, ByVal 0&)
    Do While lHWND <> 0&
        If GetParent(lHWND) = 0& Then
            Call GetWindowThreadProcessId(lHWND, lPid)
            If lPid = pid Then
                HwndFromPID = lHWND
                Exit Do
            End If
        End If
        lHWND = GetWindow(lHWND, GW_HWNDNEXT)
    Loop

End Function
Sub sleep(I)

Dim newHour
Dim newMinute
Dim newSecond
Dim waitTime

newHour = Hour(Now())
newMinute = Minute(Now())
newSecond = Second(Now()) + I
waitTime = TimeSerial(newHour, newMinute, newSecond)
'Application.Cursor = xlDefault
Application.Wait waitTime

End Sub

Sub TEST2()

    On Error Resume Next
    
'serve per aprire e dare la password a ASB.exe
    'Dim lPid As Long, hwnd As Long
    Dim paths As String
    
    'Application.ScreenUpdating = False
    
    'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
   '''' DoEvents
    
    
   paths = ActiveWorkbook.Path
   'MsgBox path
   
    lPid = Shell(paths & "\ASB.exe ", vbNormalFocus)
        hwnd = HwndFromPID(lPid)
    hwnd = GetWindow(hwnd, GW_CHILD)
    'MsgBox hwnd
    
    ' VERSIONE 187 FACCIO USCIRE QUI DALLA SUB PERCHE' LE RIGHE SUCCESSIVE FANNO PIANTARE EXCEL IN WINDOWS 10 SENZA DARE ERRORI IN PARTICOLARE
    'INVECE ANDAVANO BENE E NON DAVANO ERRORI FINO ALLA VERSIONE 186
    Exit Sub
    
    
    DoEvents
    
    'Dim aaa
    'For aaa = 1 To 100000
    'If hwnd Then
    'MsgBox "atlavivadet!"
   ' sleep (1)
                               '''''''''''''''''''''''''''''AppActivate "Exe Lock"
   AppActivate "Analisi Studio Ballarini" ''''''''''''''''''''''''''''''''''''''''
  DoEvents
   
   'sleep (1)
'doEvents
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("yalps1d")
DoEvents
'sleep (1)
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("{ENTER}")
    DoEvents
    
    AppActivate "Analisi Studio Ballarini"
    ' Application.ScreenUpdating = True
    'GoTo 1500
    'End If
'Next

'1500
End Sub

Sub Form_Load()
 Dim MyHandle As Long
 
If Sheets("COVER").Range("O2") = "x" Or Sheets("COVER").Range("O2") = "X" Then
Sheets("CHOICE FROM DATABASE").Activate
Else

 
'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
    DoEvents

    'Note Might Not Work On Windows 2000
    Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Analisi Studio Ballarini - Corporate Finance's Analysis")  'check to see if window exist and obtain its handle
    If Whnd <> 0 Then 'if Whnd isnt 0 then window exists
        MsgBox "STILL OPEN"
        
On Error Resume Next
AppActivate "Analisi Studio Ballarini - Corporate Finance's Analysis"
        
        'Dim MyHandle As Long
             MyHandle = Whnd 'FindtheWindow(myProcessID)
             ShowWindow MyHandle, SW_SHOWMAXIMIZED

        DoEvents
        
        
        Whnd = 0 'blank Whnd
        Else
         'MsgBox "E' CHIUSA !!"
         TEST2
    End If

 End If
 
       
End Sub




Attribute VB_Name = "Modulo40"
Sub riportapulsante()
Attribute riportapulsante.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro23 Macro
'

'
Sheets("COVER").Shapes("Button 24").Select
    Selection.ShapeRange.IncrementLeft 332.25
    'Stop
    Selection.ShapeRange.IncrementTop -78.75
End Sub

Sub spostapulsante()
Sheets("COVER").Shapes("Button 24").Select
 Selection.ShapeRange.IncrementLeft -332.25
   ' Stop
    Selection.ShapeRange.IncrementTop 78.75
End Sub
Sub Macro25()
Attribute Macro25.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro25 Macro
'

'
    Selection.ShapeRange.ScaleWidth 2#, msoFalse, msoScaleFromBottomRight
    Selection.ShapeRange.ScaleWidth 0.5, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.ScaleWidth 0.04, msoFalse, msoScaleFromBottomRight
    Selection.ShapeRange.ScaleHeight 2#, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.ScaleHeight 0.5, msoFalse, msoScaleFromBottomRight
    Selection.ShapeRange.ScaleHeight 0.05, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.Flip msoFlipHorizontal
    Selection.ShapeRange.Flip msoFlipVertical
End Sub
Attribute VB_Name = "Modulo41"
Sub rimpiccioliscipulsante()
Attribute rimpiccioliscipulsante.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro23 Macro
'

'
    Sheets("COVER").Shapes("Button 24").Select
    Selection.ShapeRange.LockAspectRatio = msoFalse
    Selection.ShapeRange.Height = 4.5
    Selection.ShapeRange.Width = 6#
End Sub

Sub RINGRANDISCIPULSANTE()
Sheets("COVER").Shapes("Button 24").Select
     Selection.ShapeRange.LockAspectRatio = msoFalse
    Selection.ShapeRange.Height = 42#
    Selection.ShapeRange.Width = 55.5
End Sub
Sub Macro24()
Attribute Macro24.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro24 Macro
'

'
    ActiveSheet.Shapes("Button 24").Select
    Selection.ShapeRange.LockAspectRatio = msoFalse
    Selection.ShapeRange.Height = 4.5
    Selection.ShapeRange.Width = 6#
    Selection.ShapeRange.LockAspectRatio = msoFalse
    Selection.ShapeRange.Height = 42#
    Selection.ShapeRange.Width = 55.5
End Sub
Attribute VB_Name = "Modulo42"
Sub Macro23()
Attribute Macro23.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro23 Macro
'

'
    Range("J4:K88").Select
    Selection.Copy
    Application.CutCopyMode = False
End Sub
Sub coloretestodelta()
Attribute coloretestodelta.VB_ProcData.VB_Invoke_Func = " \n14"


'''Sheets("full screening").Unprotect
If Range("I3") = "H9" Or Range("I3") = "h9" Then
    Range("K3") = "F9"
    Range("I3") = "F9"
      
    Range("K31") = "F53"
    Range("I31") = "F53"
    
    Range("K54") = "F83"
    Range("I54") = "F83"
    
    Else
    
    Range("K3") = "H9"
    Range("I3") = "H9"
      
    Range("K31") = "H53"
    Range("I31") = "H53"
    
    Range("K54") = "H83"
    Range("I54") = "H83"
    
    End If


If Range("j2") = 1 Then
Application.ScreenUpdating = False


'0.0435035802, msoFalse,
ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.Shapes("Grafico 15").ScaleWidth 0.044, msoFalse, _
        msoScaleFromBottomRight

 'ActiveSheet.ChartObjects("Grafico 15").Activate
  '  ActiveSheet.Shapes("Grafico 15").ScaleWidth 22.7782759903, msoFalse, _
   '     msoScaleFromBottomRight

Range("O44,O58").Select
    Range("O58").Activate
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
        
      

    Range("J4:K83").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
'   Stop
    Range("J84:K88").Select
    'With Selection.Font
     '   .ThemeColor = xlThemeColorDark1
      '  .TintAndShade = -4.99893185216834E-02
    'End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
    End With
    
    
    '----------------
     Range("J17:K17").Select
    
    Range("J17:K17,J28,K28").Select
    Range("K28").Activate
    
    Range("J17:K17,J28,K28,J38,K38").Select
    Range("K38").Activate
    
    Range("J17:K17,J28,K28,J38,K38,J62,K62").Select
    Range("K62").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    '------------------
    ''Range("J4").Select
    Range("j2") = 0
    Range("a1").Select
   Sheets("full screening").Protect
    Exit Sub
    Else
    
    Application.ScreenUpdating = False

On Error Resume Next
ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.Shapes("Grafico 15").ScaleWidth 1 / 0.044, msoFalse, _
        msoScaleFromBottomRight
Range("O44,O58").Select
    Range("O58").Activate
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
    
 ' ActiveSheet.ChartObjects("Grafico 15").Activate
  '  ActiveSheet.Shapes("Grafico 15").ScaleWidth 0.0435035802, msoFalse, _
   '     msoScaleFromBottomRight
    
    
'    Stop
    Range("H4:I88").Select
    Selection.Copy
    
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Range("J4").Select
    
    '-----------------------
     Range("K4:K88").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    '------------------------------
    Range("J4").Select
    Range("j2") = 1
   End If
   Range("a1").Select
  ''' Sheets("full screening").Protect
End Sub
Sub Macro27()
Attribute Macro27.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro27 Macro
'

'
    
    Range("K4:K88").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ThemeColor = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("J17:K17").Select
    
    Range("J17:K17,J28,K28").Select
    Range("K28").Activate
    
    Range("J17:K17,J28,K28,J38,K38").Select
    Range("K38").Activate
    
    Range("J17:K17,J28,K28,J38,K38,J62,K62").Select
    Range("K62").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Range("J4").Select
End Sub
Attribute VB_Name = "Modulo43"
Sub sbloccainfragruppodaysinbudget()
Attribute sbloccainfragruppodaysinbudget.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro26 Macro
'

'
   Application.ScreenUpdating = False
   
    BUDGETING!Range("M81,M83").Select
   
    BUDGETING!Selection.Locked = False
    Selection.FormulaHidden = True
    BUDGETING!Range("M83").Select
End Sub
Attribute VB_Name = "Modulo44"
Attribute VB_Name = "Modulo45"
Sub Macro26()
Attribute Macro26.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro26 Macro
'

'
    Range("H21").Select
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.Shapes.Range(Array("Rounded Rectangle 2")).Select
    Selection.ShapeRange.IncrementLeft -3
    Selection.ShapeRange.IncrementTop 50.25
    Selection.ShapeRange.ScaleHeight 1.7241472315, msoFalse, _
        msoScaleFromBottomRight
    Range("G17").Select
End Sub
Attribute VB_Name = "Modulo46"
Sub Macro28()
Attribute Macro28.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro28 Macro
'

'
If Range("I3") = "H9" Or Range("I3") = "h9" Then
    Range("K3") = "F9"
    Range("I3") = "F9"
      
    Range("K31") = "F53"
    Range("I31") = "F53"
    
    Range("K54") = "F83"
    Range("I54") = "F83"
    
    Else
    
    Range("K3") = "H9"
    Range("I3") = "H9"
      
    Range("K31") = "H53"
    Range("I31") = "H53"
    
    Range("K54") = "H83"
    Range("I54") = "H83"
    
    End If
    
    
End Sub
Attribute VB_Name = "Modulo47"
Sub resetfinstr()
Attribute resetfinstr.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo versione


Application.ScreenUpdating = False
ActiveSheet.Unprotect

ActiveSheet.SpinButton1.SmallChange = Range("i28")
ActiveSheet.SpinButton2.SmallChange = Range("i28")
ActiveSheet.SpinButton3.SmallChange = Range("i28")
ActiveSheet.SpinButton4.SmallChange = Range("i28")
ActiveSheet.SpinButton5.SmallChange = Range("i28")
DoEvents

'
' Macro29 Macro
'


    Range("E3").Select
    'ActiveCell.FormulaR1C1 = "=+R[-2]C"
    ActiveCell.Formula = "=+E1-P4-O4"
    Range("Q4") = 0
    Range("O4") = 0
    Range("O5") = 0
    Range("R4") = 0
    ' Range("O4") = 0
    'Range("F4").Select
    'ActiveCell.FormulaR1C1 = "=+R[-3]C[2]"
    Range("A1").Select
    aggiornadebitifin
    ActiveSheet.Protect
        Application.ScreenUpdating = True
        
        Exit Sub
versione:
ActiveSheet.Protect
Application.ScreenUpdating = True
MsgBox "O si sta elaborando un bilancio abbreviato senza dettaglio debiti finanziari o la versione di Excel non supporta la gestione automatica delle forme geometriche indipendenti. Quindi per favore, NON TENERE CONTO DELL'OVALE DEI CEBITI e del triangolo delle vendite. Probably your version of Excel does not support automatic management of independent geometric shapes. So please do not take into account the oval of debts and the sales triangle."
End Sub
Attribute VB_Name = "Modulo48"
Sub Macro29()
Attribute Macro29.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro29 Macro
'

'
    ActiveSheet.Unprotect
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
End Sub
Attribute VB_Name = "Modulo49"
Sub Macro30()
Attribute Macro30.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro30 Macro
'

'
 ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.Shapes("Grafico 15").ScaleWidth 0.0435035802, msoFalse, _
        msoScaleFromBottomRight
    Range("O54").Select
   
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.Shapes("Grafico 15").ScaleWidth 22.7782759903, msoFalse, _
        msoScaleFromBottomRight
    Range("P32").Select
End Sub
Sub Macro31()
Attribute Macro31.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro31 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.Shapes("Grafico 15").ScaleWidth 25.2293293177, msoFalse, _
        msoScaleFromBottomRight
    Range("P54").Select
End Sub
Sub Macro32()
Attribute Macro32.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro32 Macro
'

'
    Range("O44,O58").Select
    Range("O58").Activate
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Range("O44,O58").Select
    Range("O58").Activate
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
    ActiveWindow.LargeScroll Down:=-1
    Range("R9").Select
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo5"
Public CelaSvela As Boolean ' Definita a livello modulo (Dichiarazioni)
Sub CelaSvelaRibbon()
  If Not CelaSvela Then
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
    'RemoveToolbars
    
  Else
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",True)"
    'RestoreToolbars
    
  End If
  CelaSvela = Not CelaSvela
  
  'per riattivare il right click sulle etichette col nome dei fogli
Application.CommandBars("Ply").Enabled = True
'per riabilitare il right click sulle celle che NON SO dove cavolo l'ho disabilitato
Application.CommandBars("Cell").Enabled = True
End Sub

'------------------------------------------------
'NON UTILIZZARE QUESTE SUB CHE FANNO TORNARE I MENU QUANDO TOLGO MASSIMIZZAZIONE FINESTRA
'Sub RemoveToolbars()

    'On Error Resume Next

       ' With Application

          ' .DisplayFullScreen = True

           '.CommandBars("Full Screen").Visible = False

           '.CommandBars("MyToolbar").Enabled = True

           '.CommandBars("MyToolbar").Visible = True

           '.CommandBars("Worksheet Menu Bar").Enabled = False

        'End With

    'On Error GoTo 0

'End Sub

'Sub RestoreToolbars()

    'On Error Resume Next

       ' With Application

         '  .DisplayFullScreen = False

           '.CommandBars("MyToolbar").Enabled = False

           '.CommandBars("Worksheet Menu Bar").Enabled = True

       ' End With

    'On Error GoTo 0

'End Sub
'------------------------------------------------

Sub fainiente()
MsgBox "If you want to print, press only F3"
End Sub


Attribute VB_Name = "Modulo50"
Sub infragruppolungo()
Attribute infragruppolungo.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro33 Macro
'

'

   Application.ScreenUpdating = False
   ActiveSheet.Unprotect
    Range("V1:Y1").Select
    Selection.Copy
    
    Range("E1").Select
    ActiveSheet.Paste
    
    
     Range("T1:U1").Select
    Selection.Copy
    
    Range("I1").Select
    ActiveSheet.Paste
    
    
    Range("V2:W2").Select
    Selection.Copy
    
    Range("E2").Select
    ActiveSheet.Paste
    
    
    
    Range("V3:W6").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Range("E3").Select
    ActiveSheet.Paste
    Range("A1:D1").Select
    Range("I7") = "X"
    Range("I11") = ""
    ActiveSheet.Protect
    Application.ScreenUpdating = True
End Sub
Sub infragrupponormale()
Attribute infragrupponormale.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro34 Macro
'

Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    Range("AA1:AD1").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.LargeScroll ToRight:=-1
    Range("E1").Select
    ActiveSheet.Paste
    
    
     Range("AN1:AO1").Select
    Selection.Copy
    
    Range("I1").Select
    ActiveSheet.Paste
    
     Range("AA2:AB2").Select
    Selection.Copy
    
    Range("E2").Select
    ActiveSheet.Paste
    
    
    
    
    Range("AA3:AB6").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Range("E3").Select
    ActiveSheet.Paste
    Range("A1:D1").Select
    Range("I7") = ""
    Range("I11") = "X"
    ActiveSheet.Protect
        Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Modulo51"
Sub Macro33()
Attribute Macro33.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro33 Macro
'

'
    ActiveSheet.Unprotect
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub

Sub sommaafogliogiaaperto()
'
' Macro36 Macro
'
On Error Resume Next

Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
MsgBox "Press the button Cut Excel Sheet before!"
Exit Sub
End If
If wbs.Count > 2 Then
MsgBox "Leave only opened the one Sheet to add!"
Exit Sub
End If

Application.Visible = False
DoEvents
Application.ScreenUpdating = False
DoEvents


Dim nome1 As String
Dim nome2 As String
 nome1 = Range("B1")
         ActiveWindow.ActivateNext
    nome2 = Range("B1")
    Range("B1") = nome1 & " " & nome2
ActiveWindow.ActivateNext




    'ActiveWindow.ActivateNext
    Range("F4").Select
    ActiveWindow.SmallScroll Down:=3
    Range("F4:F30").Select
    Selection.Copy
    Range("a1").Select
    ActiveWindow.ActivateNext
    DoEvents
    If Range("K1").Value <> "Eur/1000 x D2 or E2" Then
    If Range("K1").Value <> "Cur./1000 x D2 or E2" Then
    MsgBox "K1 is not Euro/1000 pheraps there are other sheets! Close your other sheets!"
     
    Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
    Exit Sub
    End If
    End If
    
    If Range("K2").Value <> "H4" Then
    MsgBox "K2 is not H4 pheraps there are other sheets! Close your other sheets!"
    
    Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
Exit Sub
    End If
    
    MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
    Application.Cursor = xlWait              ' Clessidra
'Application.Cursor = xlDefault          ' Puntatore normale
     'SE TROVA ALTROGRAFICO   LO CANCELLA
      Dim sh As Shape
For Each sh In ActiveSheet.Shapes
    sh.Delete
Next sh
    
    DoEvents
    DoEvents
    DoEvents
    
    Range("F4").Select
   
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    ActiveWindow.ActivateNext
    Range("H4:H30").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("H4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    Range("J4").Select
    ActiveWindow.ActivateNext
    Range("J4:J30").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
   
    Range("F32").Select
    ActiveWindow.ActivateNext
    
    Range("F32:F53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    Range("H32").Select
    ActiveWindow.ActivateNext
    Range("H32:H53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    Range("J32").Select
    ActiveWindow.ActivateNext
    Range("J32:J53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    
    Range("F55").Select
    ActiveWindow.ActivateNext
    
    Range("F55:F88").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    DoEvents
    DoEvents
    DoEvents
    
    
    Range("L57").Select
    ActiveWindow.ActivateNext
       
    Range("L57").Select
    Range("L57:M57").Select
               Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("L57").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
        Range("L1").Select
    ActiveWindow.ActivateNext
        Range("L1").Select
                   Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("L1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
        
        
        
        Range("H55").Select
    ActiveWindow.ActivateNext
        Range("H88").Select
    
    Range("H55:H88").Select
    Range("H88").Activate
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    Range("J55").Select
    ActiveWindow.ActivateNext
    Range("J55").Select
    
    Range("J55:J88").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    
    Range("F55").Select
    
    Range("F4:K16").Select
    Application.CutCopyMode = False
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveWindow.SmallScroll Down:=3
    
    Range("F18:K27").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F29:K30").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Range("F32:K37").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("F39:K53").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Range("F86:J86").Select
    Selection.ClearContents
    
    Range("A1").Select
    
    DoEvents
    DoEvents
    DoEvents
    
    
      Range("K4").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("M22").Select
    Selection.ClearContents
    Range("M24:M30").Select
    Selection.ClearContents
    
    Range("M44:N44").Select
    Selection.ClearContents
    Range("O44").Select
    Selection.ClearContents
    Range("L44").Select
    Selection.ClearContents
    
    Range("L58:O58").Select
    Selection.ClearContents
    
    Range("M68:O71").Select
    Selection.ClearContents
   ' Range("N73:N77").Select
   ' Selection.ClearContents
    Range("M79:O83").Select
    Selection.ClearContents
    
    
    Range("F86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    Range("H86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    Range("J86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    
    
    'ActiveWindow.SmallScroll ToRight:=-8
    Range("A1").Select
    ActiveWindow.ActivateNext
    Range("A1").Select
    'ActiveWindow.ActivateNext
    DoEvents
    DoEvents
    DoEvents
    
    Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    Application.Visible = True
    DoEvents
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub sottraiafogliogiaaperto()

'Application.Visible = True
' Application.Cursor = xlDefault
'Exit Sub
'
' Macro36 Macro
'
On Error Resume Next

Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
MsgBox "Press the button Cut Excel Sheet before!"
Exit Sub
End If
If wbs.Count > 2 Then
MsgBox "Leave only opened the one Sheet to add!"
Exit Sub
End If



Dim Cel As Range, Range As Range
Dim Word As String
    'Set Range = ActiveSheet.Range("B1")
    Word = ActiveSheet.Range("B1")


Application.Visible = False
DoEvents
Application.ScreenUpdating = False
DoEvents


'***********
       ' Dim Cel As Range, Range As Range
'Dim Word As String
    'Set Range = Range("B1")
    'Word = "Theword"
        
   ' Application.ScreenUpdating = False
    'For Each Cel In Range
    ActiveWindow.ActivateNext
    Dim nome2 As String
    Dim nome3 As String
    nome2 = ActiveSheet.Range("B1")
    nome3 = ActiveSheet.Range("B1")
    
     Set Cel = ActiveSheet.Range("B1")
     
     
     Dim s As String, lPosition As Long, rPosition As Long
    s = nome3
    ' Prints John
    If Cel Like "*" & Word & "*" Then
    lPosition = InStr(s, Word) - 1
   ' MsgBox lPosition
    If lPosition < 0 Then
    lPosition = 0
    End If
    'MsgBox Len(Word)
       Cel = Left(s, lPosition) + Right(s, Len(s) - lPosition - Len(Word)) 'Left(s, lPosition) +
      'MsgBox Cel
       ''Application.Visible = True
       'Exit Sub
       
Else
     
        'If Cel Like "*" & Word & "*" Then
           ' Cel = Replace(Cel, Word, "")
           ''To remove the double space that follows ..
           ' Cel = Replace(Cel, "  ", " ")
           ' Else
            
            MsgBox "The firm name to subtract was not found in other sheet"
     
    ActiveWindow.ActivateNext
    Application.Visible = True
    Exit Sub
        End If
    'Next Cel
    'Application.ScreenUpdating = True
    
    '************


'Dim nome1 As String
'Dim nome2 As String
 'nome1 = Range("B1")
     '    ActiveWindow.ActivateNext
    'nome2 = Range("B1")
    'Range("B1") = nome1 & " " & nome2
ActiveWindow.ActivateNext




    'ActiveWindow.ActivateNext
    ActiveSheet.Range("F4").Select
    ActiveWindow.SmallScroll Down:=3
     ActiveSheet.Range("F4:F30").Select
    Selection.Copy
    ActiveSheet.Range("a1").Select
    ActiveWindow.ActivateNext
    DoEvents
    If ActiveSheet.Range("K1").Value <> "Eur/1000 x D2 or E2" Then
    If ActiveSheet.Range("K1").Value <> "Cur./1000 x D2 or E2" Then
  'MsgBox ActiveSheet.Range("K1")
    MsgBox "K1 is not Euro/1000 pheraps there are other sheets! Close your other sheets!"
     
    ActiveSheet.Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
    Exit Sub
    End If
    End If
    
    If ActiveSheet.Range("K2").Value <> "H4" Then
    MsgBox "K2 is not H4 pheraps there are other sheets! Close your other sheets!"
    
    ActiveSheet.Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
Exit Sub
    End If
    
    
    
    
    
    MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
    Application.Cursor = xlWait              ' Clessidra
'Application.Cursor = xlDefault          ' Puntatore normale
     'SE TROVA ALTROGRAFICO   LO CANCELLA
      Dim sh As Shape
For Each sh In ActiveSheet.Shapes
    sh.Delete
Next sh
    
    DoEvents
    DoEvents
    DoEvents
    
    ActiveSheet.Range("F4").Select
   
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    ActiveWindow.ActivateNext
    
                          
    ActiveSheet.Range("H4:H30").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    ActiveSheet.Range("H4").Select
    
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    Range("J4").Select
    
    ActiveWindow.ActivateNext
    ActiveSheet.Range("J4:J30").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    ActiveSheet.Range("j4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
   
    ActiveSheet.Range("F32").Select
    ActiveWindow.ActivateNext
    
    ActiveSheet.Range("F32:F53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    ActiveSheet.Range("H32").Select
    ActiveWindow.ActivateNext
    ActiveSheet.Range("H32:H53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    ActiveSheet.Range("J32").Select
    ActiveWindow.ActivateNext
    ActiveSheet.Range("J32:J53").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    
    ActiveSheet.Range("F55").Select
    ActiveWindow.ActivateNext
    
    ActiveSheet.Range("F55:F88").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    DoEvents
    DoEvents
    DoEvents
    
    
    ActiveSheet.Range("L57").Select
    ActiveWindow.ActivateNext
       
    ActiveSheet.Range("L57").Select
    ActiveSheet.Range("L57:M57").Select
               Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    ActiveSheet.Range("L57").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
        ActiveSheet.Range("L1").Select
    ActiveWindow.ActivateNext
        ActiveSheet.Range("L1").Select
                   Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    ActiveSheet.Range("L1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
        
        
        
        ActiveSheet.Range("H55").Select
    ActiveWindow.ActivateNext
        Range("H88").Select
    
    ActiveSheet.Range("H55:H88").Select
    ActiveSheet.Range("H88").Activate
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    ActiveSheet.Range("J55").Select
    ActiveWindow.ActivateNext
    ActiveSheet.Range("J55").Select
    
    ActiveSheet.Range("J55:J88").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract, SkipBlanks:= _
        False, Transpose:=False
    
    ActiveSheet.Range("F55").Select
    
    ActiveSheet.Range("F4:K16").Select
    Application.CutCopyMode = False
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveWindow.SmallScroll Down:=3
    
    ActiveSheet.Range("F18:K27").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveSheet.Range("F29:K30").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    ActiveSheet.Range("F32:K37").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveSheet.Range("F39:K53").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    ActiveSheet.Range("F86:J86").Select
    Selection.ClearContents
    
    ActiveSheet.Range("A1").Select
    
    DoEvents
    DoEvents
    DoEvents
    
    
      ActiveSheet.Range("K4").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -1
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    ActiveSheet.Range("M22").Select
    Selection.ClearContents
    ActiveSheet.Range("M24:M30").Select
    Selection.ClearContents
    
    ActiveSheet.Range("M44:N44").Select
    Selection.ClearContents
    ActiveSheet.Range("O44").Select
    Selection.ClearContents
    ActiveSheet.Range("L44").Select
    Selection.ClearContents
    
    ActiveSheet.Range("L58:O58").Select
    Selection.ClearContents
    
    ActiveSheet.Range("M68:O71").Select
    Selection.ClearContents
   ' ActiveSheet.Range("N73:N77").Select
    'Selection.ClearContents
        ActiveSheet.Range("M79:O83").Select
    Selection.ClearContents
    
    
     ActiveSheet.Range("F86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    ActiveSheet.Range("H86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    ActiveSheet.Range("J86").Select
    ActiveCell.FormulaR1C1 = "=+IF(R[-24]C>0,R[-6]C/R[-24]C,0)"
    
   
    
   ' ActiveWindow.SmallScroll ToRight:=-8
    ActiveSheet.Range("A1").Select
    ActiveWindow.ActivateNext
    ActiveSheet.Range("A1").Select
    'ActiveWindow.ActivateNext
    DoEvents
    DoEvents
    DoEvents
    
    Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    Application.Visible = True
    DoEvents
End Sub

Attribute VB_Name = "Modulo52"
Sub CREA_GRAFICI_FOGLIO_STACCATO()
Dim answer As Integer
answer = MsgBox("ATTENZIONE prosegui solo se hai minimizzato o chiuso tutte le finestre NON Excel !!, PROSEGUIRE?", vbYesNo + vbQuestion, "ATTENZIONE !!")
If answer = vbNo Then
    Exit Sub
End If



Dim grap As String

On Error Resume Next

'controlla che ci sia aperto il secondo foglio
Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
MsgBox "Press the button Cut Excel Sheet before!"
Exit Sub
End If
If wbs.Count > 2 Then
'MsgBox "Leave only opened the one Sheet to add!"
'Exit Sub
End If



 


Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If


Application.Visible = False
DoEvents
Application.ScreenUpdating = False

'MI ERA SEMBRATO CHE METTERE APPLICATION.SCREENUPDATING FALSO FACESSE SBALLARE LA MACRO MA SEMBRA DI NO E VA MOLTO PIU' VELOCE!



Dim I As Variant
'grafico in alto

ActiveSheet.ChartObjects("Grafico 15").Activate
DoEvents
    ActiveChart.ChartArea.Copy
    Range("A1").Select
    
    ActiveWindow.ActivateNext
       
    'controlla di non essere su un foglio qualsiasi di excel dimenticato aperto
    If Range("K1").Value <> "Eur/1000 x D2 or E2" Then
    If Range("K1").Value <> "Cur./1000 x D2 or E2" Then
    MsgBox "Close your other sheets!"
    Application.Visible = True
    Exit Sub
    End If
    End If
    
    If Range("K2").Value <> "H4" Then
    MsgBox "Close your other sheets!"
    Application.Visible = True
Exit Sub
    End If
    
    
    
    
   
    
    MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
  Application.Cursor = xlWait              ' Clessidra
'Application.Cursor = xlDefault          ' Puntatore normale
    
    
    
    '----------------------
     Dim DFL1
    Dim DFL2
    Dim DFL3
        
    'DFL1 = Worksheets("SINTETIC").Range("AF59") ' Range("F62") + Range("F63") + Range("F64") + Range("F66") + Range("F68") + Range("F70") + Range("F72") + Range("F76") + Range("F74") + Range("F79") - Range("F37") - Range("F40") - Range("F43")
'DFL2 = Worksheets("SINTETIC").Range("AH59") ' Range("H62") + Range("H63") + Range("H64") + Range("H66") + Range("H68") + Range("H70") + Range("H72") + Range("H76") + Range("H74") + Range("H79") - Range("H37") - Range("H40") - Range("H43")
 'DFL3 = Worksheets("SINTETIC").Range("AJ59") ' Range("J62") + Range("J63") + Range("J64") + Range("J66") + Range("J68") + Range("J70") + Range("J72") + Range("J76") + Range("J74") + Range("J79") - Range("J37") - Range("J40") - Range("J43")
    
DFL1 = Range("F62") + Range("F63") + Range("F64") + Range("F66") + Range("F68") + Range("F70") + Range("F72") + Range("F76") + Range("F74") + Range("F79") - Range("F37") - Range("F40") - Range("F43")
DFL2 = Range("H62") + Range("H63") + Range("H64") + Range("H66") + Range("H68") + Range("H70") + Range("H72") + Range("H76") + Range("H74") + Range("H79") - Range("H37") - Range("H40") - Range("H43")
 DFL3 = Range("J62") + Range("J63") + Range("J64") + Range("J66") + Range("J68") + Range("J70") + Range("J72") + Range("J76") + Range("J74") + Range("J79") - Range("J37") - Range("J40") - Range("J43")
    
    
    DFL1 = Int(DFL1)
    DFL2 = Int(DFL2)
    DFL3 = Int(DFL3)
    
    
     Dim NFB1
    Dim NFB2
    Dim NFB3
    
       
   ' NFB1 = Worksheets("SINTETIC").Range("AF60") 'Range("F38") + Range("F39") + Range("F42") - Range("F44") + Range("F52") - Range("F73") - Range("F78") - Range("F81")
'If Range("F41") - Range("F77") > 0 Then
'NFB1 = NFB1 + Range("F41") - Range("F77")
'End If

'NFB2 = Worksheets("SINTETIC").Range("AH60") ' Range("H38") + Range("H39") + Range("H42") - Range("H44") + Range("H52") - Range("H73") - Range("H78") - Range("H81")
'If Range("H41") - Range("H77") > 0 Then
'NFB2 = NFB2 + Range("H41") - Range("H77")
'End If
  
'NFB3 = Worksheets("SINTETIC").Range("AJ60") 'Range("J38") + Range("J39") + Range("J42") - Range("J44") + Range("J52") - Range("J73") - Range("J78") - Range("J81")
'If Range("J41") - Range("J77") > 0 Then
'NFB3 = NFB3 + Range("J41") - Range("J77")
'End If


NFB1 = Range("F38") + Range("F39") + Range("F42") - Range("F44") + Range("F52") - Range("F73") - Range("F78") - Range("F81")
If Range("F41") - Range("F77") > 0 Then
NFB1 = NFB1 + Range("F41") - Range("F77")
End If

NFB2 = Range("H38") + Range("H39") + Range("H42") - Range("H44") + Range("H52") - Range("H73") - Range("H78") - Range("H81")
If Range("H41") - Range("H77") > 0 Then
NFB2 = NFB2 + Range("H41") - Range("H77")
End If
  
NFB3 = Range("J38") + Range("J39") + Range("J42") - Range("J44") + Range("J52") - Range("J73") - Range("J78") - Range("J81")
If Range("J41") - Range("J77") > 0 Then
NFB3 = NFB3 + Range("J41") - Range("J77")
End If

  
  NFB1 = Int(NFB1)
  NFB2 = Int(NFB2)
  NFB3 = Int(NFB3)
        
   Dim C1
    Dim C2
    Dim C3
    
       
    'C1 = Worksheets("SINTETIC").Range("AF66") ' DFL1 + Range("F39")
'C2 = Worksheets("SINTETIC").Range("AH66") ' DFL2 + Range("H39")
'C3 = Worksheets("SINTETIC").Range("AJ66") ' DFL3 + Range("J39")

C1 = DFL1 + Range("F39")
C2 = DFL2 + Range("H39")
C3 = DFL3 + Range("J39")


C1 = Int(C1)
C2 = Int(C2)
C3 = Int(C3)

'SE(AF63<0;-AF63;0)))     ----   'full screening'!F41-'full screening'!F77)

Dim CI1
    Dim CI2
    Dim CI3
    
       
    'CI1 = 0
    'If Range("F41") - Range("F77") < 0 Then
    'CI1 = Worksheets("SINTETIC").Range("AF68") ' -Range("F41") + Range("F77")
    'End If
    
 'CI2 = 0
    'If Range("H41") - Range("H77") < 0 Then
   ' CI2 = Worksheets("SINTETIC").Range("AH68") ' -Range("H41") + Range("H77")
   ' End If
    
' CI3 = 0
 '   If Range("J41") - Range("J77") < 0 Then
 '   CI3 = Worksheets("SINTETIC").Range("AJ68") ' -Range("J41") + Range("J77")
 '   End If
    
    
    CI1 = 0
    If Range("F41") - Range("F77") < 0 Then
    CI1 = -Range("F41") + Range("F77")
    End If
    
 CI2 = 0
    If Range("H41") - Range("H77") < 0 Then
    CI2 = -Range("H41") + Range("H77")
    End If
    
 CI3 = 0
    If Range("J41") - Range("J77") < 0 Then
    CI3 = -Range("J41") + Range("J77")
    End If
    
    


CI1 = Int(CI1)
CI2 = Int(CI2)
CI3 = Int(CI3)


   
    
    
    '-----------------------
    
    
    
    'SE TROVA ALTROGRAFICO   LO CANCELLA
    
    'On Error Resume Next
    
   Dim sh As Shape
For Each sh In ActiveSheet.Shapes
    sh.Delete
Next sh
    
      
    
    
    
'On Error Resume Next
'ActiveSheet.ChartObjects("1").Activate
    'ActiveChart.Parent.Delete
    '---------
       
    Range("L1:N1").Select
    ActiveSheet.Paste
    
    'ELIMINA I COLLEGAMENTI ALL ALTRO FOGLIO
    Dim Links As Variant
Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
For I = 1 To UBound(Links)
ActiveWorkbook.BreakLink _
    Name:=Links(I), _
    Type:=xlLinkTypeExcelLinks
Next I
    
    'DA IL NOME 1 AL GRAFICO
     For I = 1 To ActiveSheet.ChartObjects.Count
    ActiveSheet.ChartObjects(I).Name = I
  Next I
    
   
    
    ActiveSheet.ChartObjects("1").Activate
    ActiveChart.SeriesCollection(2).Select
    
    ActiveChart.SeriesCollection(1).Name = _
        "=""DISPONIBILITA' FINANZ. A LUNGO"""
ActiveChart.SeriesCollection(1).Values = "={" & DFL1 & ";" & DFL2 & ";" & DFL3 & "}"

ActiveChart.SeriesCollection(2).Name = _
        "=""NECESSITA' FINANZ. A BREVE"""
ActiveChart.SeriesCollection(2).Values = "={" & NFB1 & ";" & NFB2 & ";" & NFB3 & "}"

ActiveChart.SeriesCollection(3).Name = _
        "=""CLIENTI"""
ActiveChart.SeriesCollection(3).Values = "={" & C1 & ";" & C2 & ";" & C3 & "}"

ActiveChart.SeriesCollection(4).Name = _
        "=""COPERTURA INFRAGRUPPO"""
ActiveChart.SeriesCollection(4).Values = "={" & CI1 & ";" & CI2 & ";" & CI3 & "}"



    'ActiveWindow.SmallScroll ToRight:=3
    
    
    'finegrafico in alto
    

    
'RESTA NELLA PAGINA NUOVA


' ActiveWindow.ActivateNext
'ActiveSheet.ChartObjects("Grafico 2").Activate
  '  ActiveChart.PlotArea.Select
   ' ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12")).Select
   ' ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3")).Select
    'ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3", _
        "Grafico 14")).Select
        
        
      'CONTROLLA SE CI SONO GIA' GRAFICI
     
    Range("A1").Select
On Error Resume Next
For I = 1 To ActiveSheet.ChartObjects.Count
    ActiveSheet.ChartObjects(I).Name = I
   Next I

'For I = 1 To 30
'ActiveSheet.Shapes.Range(Array(I)).Deselect
'ActiveSheet.Shapes.Range(Array(I)).Deactivate

'DoEvents
'Next I

Range("A1").Select


'cancella quelli che trova eccetto il numero 1

For I = 2 To 7
''''''''ActiveSheet.Shapes.Range(Array(I)).Select
ActiveSheet.ChartObjects(I).Activate
    
ActiveSheet.ChartObjects(Array(I)).Activate
'Selection.Delete
        'Selection.Delete
        ActiveChart.Parent.Delete
                      Next I
    '---------
        
        
        
   'TORNA NEL WORKBOOK PRINCIPALE PER COPIARE I GRAFICI
   Windows(MIONOME).Activate
  
        
        
        

    
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveSheet.ChartObjects("Chart 2").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveSheet.ChartObjects("Chart 2").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("L36").Select
    ActiveSheet.Paste
   Windows(MIONOME).Activate
    
    
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.ChartObjects("Chart 12").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 12").Activate
    ActiveSheet.ChartObjects("Chart 12").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("M36").Select
    ActiveSheet.Paste
    Windows(MIONOME).Activate
    
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveSheet.ChartObjects("Chart 3").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveSheet.ChartObjects("Chart 3").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("L51").Select
    ActiveSheet.Paste
   Windows(MIONOME).Activate
    
    ActiveSheet.ChartObjects("Grafico 14").Activate
    ActiveSheet.ChartObjects("Chart 14").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 14").Activate
    ActiveSheet.ChartObjects("Chart 14").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("M51").Select
    ActiveSheet.Paste
    
    '--------------
    Windows(MIONOME).Activate
    
    
    ActiveSheet.ChartObjects("Grafico 19").Activate
    ActiveSheet.ChartObjects("Chart 19").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 19").Activate
    ActiveSheet.ChartObjects("Chart 19").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("L59").Select
    ActiveSheet.Paste
    Windows(MIONOME).Activate
    
    ActiveSheet.ChartObjects("Grafico 20").Activate
    ActiveSheet.ChartObjects("Chart 20").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.ChartObjects("Grafico 20").Activate
    ActiveSheet.ChartObjects("Chart 20").Activate
    ActiveChart.ChartArea.Select
    ActiveChart.ChartArea.Copy
    ActiveWindow.ActivateNext
        Range("N59").Select
    ActiveSheet.Paste
   
      
    '--------------
    
    
    For I = 1 To ActiveSheet.ChartObjects.Count
    ActiveSheet.ChartObjects(I).Name = I
   Next I
   
        
        
    'ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3", _
        "Grafico 14")).Select
    'Selection.Copy
    'Range("A1").Select
    'ActiveWindow.ActivateNext
    
    
    
    
    
    
    'SPOSTA UN PO A DESTRA I GRAFICI INDEBITAMENTO PER NONN SOVRAPPORRE LINEA DEL BORDO TABELLA
    
    For I = 2 To 5
      ActiveSheet.ChartObjects(I).Select
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Selection.ShapeRange.IncrementLeft 0.8333070866
    Next I

    
     'SPOSTA UN PO A SX IL GRAFICO INDEBITAMENTO
    
    For I = 7 To 7
      ActiveSheet.ChartObjects(I).Select
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Selection.ShapeRange.IncrementLeft -0.8333070866
    Next I
    
    
    'VA A PRENDERE IL GRAFICO TENDENZA PFN CON I.G.
    '''Windows(MIONOME).Activate
    '''ActiveSheet.ChartObjects("Chart 78").Activate
    '''ActiveChart.ChartArea.Copy
    '''ActiveWindow.ActivateNext
    '''Range("L62").Select
    '''ActiveSheet.Paste
    '''ActiveSheet.Shapes("Chart 78").IncrementLeft 0.8333070866
    '''ActiveSheet.Shapes("Chart 78").IncrementLeft 0.8333070866
    '''ActiveSheet.Shapes("Chart 78").IncrementLeft 0.8333070866
    '''ActiveSheet.Shapes("Chart 78").IncrementLeft 0.8333070866
    
    
    
     'ELIMINA I COLLEGAMENTI ALL ALTRO FOGLIO
Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
For I = 1 To UBound(Links)
ActiveWorkbook.BreakLink _
    Name:=Links(I), _
    Type:=xlLinkTypeExcelLinks
Next I
    
    'RINOMINA ALLA FINE I GRAFICI DA 1 IN AVANTI
         For I = 1 To ActiveSheet.ChartObjects.Count
    ActiveSheet.ChartObjects(I).Name = I
Next I
    
    
    'primo grafico anni di rientro
    Dim AF34
    Dim ANNIRIENTRO
    Dim complementareanni
    Dim result
    
    'AF34 = Range("F65") + Range("F66") + Range("F67") + Range("F68") + Range("F69") + Range("F70") + Range("F71") + Range("F72") + Range("F75") + Range("F76") - Range("F50") - Range("F46") - Range("F47") - Range("F48")
    AF34 = Range("L57")
    If AF34 < 0 Then
    AF34 = 0
    End If
    AF34 = Int(AF34)
    
    
    If AF34 >= 0 Then
    If Range("F84") <> 0 Then
    If AF34 / Range("F84") >= 0 Then
   '|fffd||fffd||fffd||fffd|****
    ANNIRIENTRO = AF34 / (Range("F84") * 12 / Range("G2"))
   '|fffd||fffd||fffd||fffd|
    Else
    ANNIRIENTRO = 10
    End If
    Else
    ANNIRIENTRO = 10
    End If
    Else
    ANNIRIENTRO = "nd"
    End If
    
    
    result = WorksheetFunction.Min(10, ANNIRIENTRO)
    
    complementareanni = 10 - result
       
      result = Int(result * 10)
       complementareanni = Int(10 * complementareanni)
       
       
  grap = "={" & CStr(result) & ";" & CStr(complementareanni) & "}"
    ActiveSheet.ChartObjects("2").Activate
    'ActiveChart.PlotArea.Select
    ActiveChart.SeriesCollection(1).Values = grap
      Range("L44") = result / 10
    
    'fineprimo grafico anni di rientro
 
        'secondo grafico anni di rientro
    
    Dim AH34
    'AH34 = Range("H65") + Range("H66") + Range("H67") + Range("H68") + Range("H69") + Range("H70") + Range("H71") + Range("H72") + Range("H75") + Range("H76") - Range("H50") - Range("H46") - Range("H47") - Range("H48")
    AH34 = Range("M57")
    If AH34 < 0 Then
    AH34 = 0
    End If
    AH34 = Int(AH34)
    
    If AH34 >= 0 Then
   ' If Range("h84") <> 0 Then
    If Range("h84") > 0 Then
    If AH34 / Range("h84") >= 0 Then
'|fffd||fffd||fffd||fffd|****
    ANNIRIENTRO = AH34 / (Range("h84") * 12 / Range("I2"))
'|fffd||fffd||fffd||fffd|
    Else
    ANNIRIENTRO = 10
    End If
    Else
    ANNIRIENTRO = 10
    End If
    Else
    ANNIRIENTRO = "nd"
    End If
    
    'MsgBox ANNIRIENTRO
    
   
    result = WorksheetFunction.Min(10, ANNIRIENTRO)
        complementareanni = 10 - result
           result = Int(result * 10)
       complementareanni = Int(10 * complementareanni)
      grap = "={" & CStr(result) & ";" & CStr(complementareanni) & "}"
  
  'MsgBox result
 ' MsgBox grap
  
    ActiveSheet.ChartObjects("3").Activate
    'ActiveChart.PlotArea.Select
    ActiveChart.SeriesCollection(1).Values = grap
     Range("M44") = result / 10
    Range("O44") = Range("L44") - Range("M44")
    'finesecondo grafico anni di rientro
    
    
    'secondo grafico pfn
    
    Dim PFN
    Dim PFN2
    Dim complementarePFN
    
    
    '''AH34 = Range("H65") + Range("H66") + Range("H67") + Range("H68") + Range("H69") + Range("H70") + Range("H71") + Range("H72") + Range("H75") + Range("H76") - Range("H50") - Range("H46") - Range("H47") - Range("H48")
   '''AH34 = Int(AH34)
   '|fffd||fffd||fffd||fffd|****
   PFN2 = AH34 / (Range("H4") * 12 / Range("I2")) * 100
    PFN = AH34 / (Range("H4") * 12 / Range("I2")) * 100
    '|fffd||fffd||fffd||fffd|
    If AH34 < 0 Then
    PFN = 0
    End If
    
    PFN = Int(PFN)
    complementarePFN = 100 - PFN
    If complementarePFN < 0 Then
    complementarePFN = 0
    End If
       
  grap = "={" & CStr(PFN) & ";" & CStr(complementarePFN) & "}"
    ActiveSheet.ChartObjects("5").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.SeriesCollection(1).Values = grap
      '------->>>>>>>>>>>>>>>>>>>
      Range("M58") = PFN2 / 100
     
    'finesecondo grafico pfn
    
    
    'primo grafico pfn
    
    
    '''AF34 = Range("F65") + Range("F66") + Range("F67") + Range("F68") + Range("F69") + Range("F70") + Range("F71") + Range("F72") + Range("F75") + Range("F76") - Range("F50") - Range("F46") - Range("F47") - Range("F48")
    '''AF34 = Int(AF34)
    
   '|fffd||fffd||fffd||fffd|****
   PFN2 = AF34 / (Range("F4") * 12 / Range("G2")) * 100
    PFN = AF34 / (Range("F4") * 12 / Range("G2")) * 100
    '|fffd||fffd||fffd||fffd|
    If AF34 < 0 Then
    PFN = 0
    End If
     PFN = Int(PFN)
    
    complementarePFN = 100 - PFN
    If complementarePFN < 0 Then
    complementarePFN = 0
    End If
       
  grap = "={" & CStr(PFN) & ";" & CStr(complementarePFN) & "}"
    ActiveSheet.ChartObjects("4").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.SeriesCollection(1).Values = grap
    '-->>>>>>>>>>>>>>>
    Range("L58") = PFN2 / 100
     
    
    
     ''' Range("L58") = PFN / 100
    '''Range("O58") = (Range("L58") - Range("M58"))
    'fineprimo grafico pfn
    
   
    
'FORMULE PREVISIONI
        Range("N73").FormulaLocal = "=SE(I17<>0;DEV.ST.VALORI(F17/F9;H17/H9);"""")"
        Range("N74").FormulaLocal = "=SE(I17<>0;MEDIA(F17/F9;H17/H9);"""")"
        Range("N75").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);DISTRIB.NORM.ST((G17-N74)/N73-1);"""")"
    Range("N76").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);1-DISTRIB.NORM.ST((G17-N74)/N73+1);"""")"
    Range("N77").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);1-N75-N76;"""")"
    'fine formule previsioni
    
    
    'formule ratios
    '=(+'full screening'!G17+'full screening'!G22)*100
    Range("M68").FormulaLocal = "=(G17+G22)"
    Range("N68").FormulaLocal = "=(I17+I22)"
    Range("O68").FormulaLocal = "=(M68-N68)"
    
    Range("M69").FormulaLocal = "=+SE( F10<>0;F9/(F10-F11)-1;0)"
    Range("N69").FormulaLocal = "=+SE( H10<>0;H9/(H10-H11)-1;0)"
    Range("O69").FormulaLocal = "=M69-N69"
    
    Range("M70").FormulaLocal = "=+SE(F62<>0;F28/F62;0)"
    Range("N70").FormulaLocal = "=+SE(H62<>0;H28/H62;0)"
    Range("O70").FormulaLocal = "=M70-N70"
    
    Range("M71").FormulaLocal = "=+SE(F62<>0;F53/F62;0)"
    Range("N71").FormulaLocal = "=+SE(H62<>0;H53/H62;0)"
    Range("O71").FormulaLocal = "=M71-N71"
'FINE formule ratios


 
'FORMULE VARIAZIONI
Range("M22").FormulaLocal = "=SE(H4>0;F4/H4-1;0)"
Range("M24").FormulaLocal = "=SE(I13<>0;ARROTONDA(G13;4)-ARROTONDA(I13;4);0)"
Range("M25").FormulaLocal = "=SE(I17<>0;ARROTONDA(G17;4)-ARROTONDA(I17;4);0)"
Range("M26").FormulaLocal = "=SE(I21<>0;ARROTONDA(G21;4)-ARROTONDA(I21;4);0)"

Range("M27").FormulaLocal = "=SE(I23<>0;ARROTONDA(G23;4)-ARROTONDA(I23;4);0)"
Range("M28").FormulaLocal = "=SE(I26<>0;ARROTONDA(G26;4)-ARROTONDA(I26;4);0)"
Range("M29").FormulaLocal = "=SE(I28<>0;ARROTONDA(G28;4)-ARROTONDA(I28;4);0)"
Range("M30").FormulaLocal = "=SE(I84<>0;ARROTONDA(G84;4)-ARROTONDA(I84;4);0)"

'FINEFORMULE VARIAZIONI

'FORMULE CICLO
'|fffd||fffd||fffd||fffd|****

Range("M79").FormulaLocal = "=-SE.ERRORE(F38/(F4*12/G2)*360;0)"
Range("M80").FormulaLocal = "=-SE.ERRORE((F39+F40)/(F4*12/G2)*360;0)"
Range("M81").FormulaLocal = "=-SE.ERRORE((F39+F40-F44+F41)/(F4*12/G2)*360;0)"
Range("M82").FormulaLocal = "=SE.ERRORE((F73+F74)/((F10+F12)*12/G2)*360;0)"
Range("M83").FormulaLocal = "=SE.ERRORE((F73+F74+F77)/((F10+F12)*12/G2)*360;0)"

Range("n79").FormulaLocal = "=-SE.ERRORE(H38/(H4*12/I2)*360;0)"
Range("n80").FormulaLocal = "=-SE.ERRORE((H39+H40)/(H4*12/I2)*360;0)"
Range("n81").FormulaLocal = "=-SE.ERRORE((H39+H40-H44+H41)/(H4*12/I2)*360;0)"
Range("n82").FormulaLocal = "=SE.ERRORE((H73+H74)/((H10+H12)*12/I2)*360;0)"
Range("n83").FormulaLocal = "=SE.ERRORE((H73+H74+H77)/((H10+H12)*12/I2)*360;0)"

'|fffd||fffd||fffd||fffd|

'FINE FORMULE CICLO FINNZIARIO



'GRAFICO LIQ E IND
Dim AF17
Dim AG17
Dim AH17
Dim YY1
Dim YY2
Dim YY3


AF17 = Int(Range("AC62"))
AG17 = Int(Range("AC63"))
AH17 = Int(Range("AC64"))

ActiveSheet.ChartObjects("6").Activate
    ActiveChart.SeriesCollection(1).Select
    ActiveChart.SeriesCollection(1).Values = "={" & AF17 & ";" & AG17 & ";" & AH17 & "}"
    
    
    'If Range("F65") <> "" Then
    YY1 = Range("AB62")
     YY2 = Range("AB63")
     YY3 = Range("AB64")
         ' YY1 = Int(YY1)
     'YY2 = Int(YY2)
     
     'End If
    
    
    ActiveSheet.ChartObjects("6").Activate
    ActiveChart.SeriesCollection(1).Select
    ActiveChart.SeriesCollection(1).XValues = "={" & YY3 & ";" & YY2 & ";" & YY1 & "}"
            
            DoEvents
            
            
            AF17 = Int(Range("AD62"))
AG17 = Int(Range("AD63"))
AH17 = Int(Range("AD64"))

ActiveSheet.ChartObjects("7").Activate
    ActiveChart.SeriesCollection(1).Select
    ActiveChart.SeriesCollection(1).Values = "={" & AF17 & ";" & AG17 & ";" & AH17 & "}"
    
    
    'If Range("F65") <> "" Then
    YY1 = Range("AB62")
     YY2 = Range("AB63")
     YY3 = Range("AB64")
         ' YY1 = Int(YY1)
     'YY2 = Int(YY2)
     
     'End If
    
    
    ActiveSheet.ChartObjects("6").Activate
    ActiveChart.SeriesCollection(1).Select
    ActiveChart.SeriesCollection(1).XValues = "={" & YY3 & ";" & YY2 & ";" & YY1 & "}"
            
            
           ' Range("L58:N58").Select
    'Selection.NumberFormat = "0.00%"
   
            Range("G3").Select
             Windows(MIONOME).Activate
             Range("G3").Select
'FINE GRAFICO TREND PFN CON INFRAG
            

'ActiveWindow.ActivateNext
 '   ActiveSheet.ChartObjects("Chart 78").Activate
  '  ActiveChart.ChartArea.Copy
   ' ActiveWindow.ActivateNext
    'Range("L62").Select
    'ActiveSheet.Paste
    
      
   ''''''''''''''' ActiveSheet.ChartObjects("Chart 78").Activate




   Application.Cursor = xlDefault          ' Puntatore normale
    Application.Visible = True


End Sub

Sub VISUALIZZARE()
            '//////////////////
            Application.Cursor = xlWait              ' Clessidra
Application.Cursor = xlDefault          ' Puntatore normale
 Application.Visible = True


Exit Sub

'//////////////////
    End Sub

Attribute VB_Name = "Modulo53"
Sub Macro34()
Attribute Macro34.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro34 Macro
'

'
    
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.PlotArea.Select
    ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12")).Select
    ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3")).Select
    ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3", _
        "Grafico 14")).Select
    ActiveSheet.Shapes.Range(Array("Chart 2", "Grafico 12", "Chart 3", _
        "Grafico 14", "Grafico 1")).Select
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("L36").Select
    ActiveSheet.Paste
    
    Range("L34:O34").Select
    ActiveSheet.ChartObjects("Grafico 4").Activate
    ActiveChart.SeriesCollection(1).Select
End Sub


Sub VISUALIZZARE2()

   Application.Cursor = xlWait              ' Clessidra
Application.Cursor = xlDefault          ' Puntatore normale
 Application.Visible = True
End Sub

Sub sparisci()

'apri                  'convertifile
Image1.Visible = False
CommandButton2.Visible = False


End Sub
Attribute VB_Name = "Modulo54"

Attribute VB_Name = "Modulo55"
Sub Macro35()
Attribute Macro35.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro35 Macro
'

'
    Range("G2").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 104
    ActiveWindow.ScrollRow = 123
    ActiveWindow.ScrollRow = 134
    ActiveWindow.ScrollRow = 144
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 148
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 190
    ActiveWindow.ScrollRow = 203
    ActiveWindow.ScrollRow = 211
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 215
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 217
    ActiveWindow.ScrollRow = 218
    ActiveWindow.ScrollRow = 220
    ActiveWindow.ScrollRow = 222
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 227
    ActiveWindow.ScrollRow = 228
    ActiveWindow.ScrollRow = 229
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 232
    ActiveWindow.ScrollRow = 234
    ActiveWindow.ScrollRow = 235
    ActiveWindow.ScrollRow = 237
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 239
    ActiveWindow.ScrollRow = 241
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 247
    ActiveWindow.ScrollRow = 250
    ActiveWindow.ScrollRow = 254
    ActiveWindow.ScrollRow = 255
    ActiveWindow.ScrollRow = 256
    ActiveWindow.ScrollRow = 258
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 260
    ActiveWindow.ScrollRow = 261
    ActiveWindow.ScrollRow = 264
    ActiveWindow.ScrollRow = 267
    ActiveWindow.ScrollRow = 271
    ActiveWindow.ScrollRow = 272
    ActiveWindow.ScrollRow = 273
    ActiveWindow.ScrollRow = 274
    ActiveWindow.ScrollRow = 275
    ActiveWindow.ScrollRow = 276
    ActiveWindow.ScrollRow = 277
    ActiveWindow.ScrollRow = 278
    ActiveWindow.ScrollRow = 279
    ActiveWindow.ScrollRow = 280
    ActiveWindow.ScrollRow = 281
    ActiveWindow.ScrollRow = 282
    ActiveWindow.ScrollRow = 283
    ActiveWindow.ScrollRow = 284
    Range("G2:H300").Select
    Selection.Copy
    ActiveWindow.ScrollRow = 283
    ActiveWindow.ScrollRow = 282
    ActiveWindow.ScrollRow = 276
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 1
    Range("G2:H15").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("L6").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("G16").Select
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    Range("G16:H36").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    Range("L20").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    Range("G37").Select
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 80
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 92
    ActiveWindow.ScrollRow = 94
    ActiveWindow.ScrollRow = 100
    ActiveWindow.ScrollRow = 105
    ActiveWindow.ScrollRow = 111
    ActiveWindow.ScrollRow = 117
    ActiveWindow.ScrollRow = 121
    ActiveWindow.ScrollRow = 125
    ActiveWindow.ScrollRow = 132
    ActiveWindow.ScrollRow = 133
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 150
    ActiveWindow.ScrollRow = 164
    ActiveWindow.ScrollRow = 166
    ActiveWindow.ScrollRow = 167
    ActiveWindow.ScrollRow = 169
    ActiveWindow.ScrollRow = 170
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 172
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 174
    ActiveWindow.ScrollRow = 176
    ActiveWindow.ScrollRow = 179
    ActiveWindow.ScrollRow = 182
    ActiveWindow.ScrollRow = 185
    ActiveWindow.ScrollRow = 189
    ActiveWindow.ScrollRow = 190
    ActiveWindow.ScrollRow = 192
    ActiveWindow.ScrollRow = 193
    Range("G203:I254").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ScrollRow = 237
    ActiveWindow.ScrollRow = 235
    ActiveWindow.ScrollRow = 232
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 229
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 224
    ActiveWindow.ScrollRow = 223
    ActiveWindow.ScrollRow = 221
    ActiveWindow.ScrollRow = 220
    ActiveWindow.ScrollRow = 219
    ActiveWindow.ScrollRow = 217
    ActiveWindow.ScrollRow = 215
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 212
    ActiveWindow.ScrollRow = 210
    ActiveWindow.ScrollRow = 208
    ActiveWindow.ScrollRow = 207
    ActiveWindow.ScrollRow = 206
    ActiveWindow.ScrollRow = 205
    ActiveWindow.ScrollRow = 204
    ActiveWindow.ScrollRow = 203
    ActiveWindow.ScrollRow = 202
    ActiveWindow.ScrollRow = 201
    ActiveWindow.ScrollRow = 199
    ActiveWindow.ScrollRow = 197
    ActiveWindow.ScrollRow = 196
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 194
    ActiveWindow.ScrollRow = 193
    ActiveWindow.ScrollRow = 192
    ActiveWindow.ScrollRow = 187
    ActiveWindow.ScrollRow = 182
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 110
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 83
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 78
    ActiveWindow.ScrollRow = 105
    ActiveWindow.ScrollRow = 108
    ActiveWindow.ScrollRow = 111
    ActiveWindow.ScrollRow = 116
    ActiveWindow.ScrollRow = 123
    ActiveWindow.ScrollRow = 129
    ActiveWindow.ScrollRow = 134
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 136
    ActiveWindow.ScrollRow = 138
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 140
    ActiveWindow.ScrollRow = 142
    ActiveWindow.ScrollRow = 143
    ActiveWindow.ScrollRow = 144
    ActiveWindow.ScrollRow = 145
    ActiveWindow.ScrollRow = 146
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 149
    ActiveWindow.ScrollRow = 150
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 153
    ActiveWindow.ScrollRow = 154
    ActiveWindow.ScrollRow = 155
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 159
    ActiveWindow.ScrollRow = 162
    ActiveWindow.ScrollRow = 163
    ActiveWindow.ScrollRow = 166
    ActiveWindow.ScrollRow = 167
    ActiveWindow.ScrollRow = 168
    ActiveWindow.ScrollRow = 169
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 172
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 174
    ActiveWindow.ScrollRow = 175
    ActiveWindow.ScrollRow = 176
    ActiveWindow.ScrollRow = 179
    ActiveWindow.ScrollRow = 180
    ActiveWindow.ScrollRow = 183
    ActiveWindow.ScrollRow = 188
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 193
    ActiveWindow.ScrollRow = 194
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 196
    ActiveWindow.ScrollRow = 197
    ActiveWindow.ScrollRow = 198
    Range("L208").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("L208:M208").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("L209:L314").Select
    ActiveSheet.Paste
    Range("G203").Select
    ActiveWindow.ScrollRow = 198
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 188
    ActiveWindow.ScrollRow = 187
    ActiveWindow.ScrollRow = 181
    ActiveWindow.ScrollRow = 175
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    Range("M38").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("M39").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 1
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 78
    ActiveWindow.ScrollRow = 80
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 92
    ActiveWindow.ScrollRow = 94
    ActiveWindow.ScrollRow = 95
    ActiveWindow.ScrollRow = 96
    ActiveWindow.ScrollRow = 98
    ActiveWindow.ScrollRow = 101
    ActiveWindow.ScrollRow = 105
    ActiveWindow.ScrollRow = 107
    ActiveWindow.ScrollRow = 108
    ActiveWindow.ScrollRow = 109
    ActiveWindow.ScrollRow = 110
    ActiveWindow.ScrollRow = 112
    ActiveWindow.ScrollRow = 113
    ActiveWindow.ScrollRow = 120
    ActiveWindow.ScrollRow = 129
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 145
    ActiveWindow.ScrollRow = 151
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 154
    ActiveWindow.ScrollRow = 155
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 158
    ActiveWindow.ScrollRow = 159
    ActiveWindow.ScrollRow = 160
    ActiveWindow.ScrollRow = 161
    ActiveWindow.ScrollRow = 164
    ActiveWindow.ScrollRow = 167
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 175
    ActiveWindow.ScrollRow = 176
    ActiveWindow.ScrollRow = 178
    ActiveWindow.ScrollRow = 179
    ActiveWindow.ScrollRow = 181
    ActiveWindow.ScrollRow = 184
    ActiveWindow.ScrollRow = 187
    ActiveWindow.ScrollRow = 188
    ActiveWindow.ScrollRow = 189
    ActiveWindow.ScrollRow = 190
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 192
    ActiveWindow.ScrollRow = 193
    ActiveWindow.ScrollRow = 194
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 196
    ActiveWindow.ScrollRow = 197
    ActiveWindow.ScrollRow = 199
    ActiveWindow.ScrollRow = 200
    ActiveWindow.ScrollRow = 204
    ActiveWindow.ScrollRow = 207
    ActiveWindow.ScrollRow = 208
    ActiveWindow.ScrollRow = 209
    ActiveWindow.ScrollRow = 210
    ActiveWindow.ScrollRow = 211
    ActiveWindow.ScrollRow = 213
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 215
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 217
    ActiveWindow.ScrollRow = 218
    ActiveWindow.ScrollRow = 219
    ActiveWindow.ScrollRow = 220
    ActiveWindow.ScrollRow = 221
    ActiveWindow.ScrollRow = 222
    ActiveWindow.ScrollRow = 223
    ActiveWindow.ScrollRow = 224
    ActiveWindow.ScrollRow = 225
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 228
    ActiveWindow.ScrollRow = 229
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 232
    ActiveWindow.ScrollRow = 233
    ActiveWindow.ScrollRow = 234
    ActiveWindow.ScrollRow = 235
    ActiveWindow.ScrollRow = 237
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 239
    ActiveWindow.ScrollRow = 240
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 243
    ActiveWindow.ScrollRow = 244
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 248
    ActiveWindow.ScrollRow = 250
    ActiveWindow.ScrollRow = 253
    ActiveWindow.ScrollRow = 254
    ActiveWindow.ScrollRow = 256
    ActiveWindow.ScrollRow = 255
    ActiveWindow.ScrollRow = 254
    ActiveWindow.ScrollRow = 252
    ActiveWindow.ScrollRow = 250
    ActiveWindow.ScrollRow = 249
    ActiveWindow.ScrollRow = 248
    ActiveWindow.ScrollRow = 247
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 243
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 237
    ActiveWindow.ScrollRow = 215
    ActiveWindow.ScrollRow = 162
    ActiveWindow.ScrollRow = 141
    ActiveWindow.ScrollRow = 127
    ActiveWindow.ScrollRow = 109
    ActiveWindow.ScrollRow = 106
    ActiveWindow.ScrollRow = 94
    ActiveWindow.ScrollRow = 92
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 1
    Range("Q6").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(VLOOKUP(RC[-5],R2C[-10]:R203C[-6],5,0),"""")"
    Range("Q6").Select
    Selection.Copy
    Range("Q7:Q300").Select
    ActiveSheet.Paste
    ActiveWindow.SmallScroll ToRight:=2
    Sheets("ULTIMO (2)").Select
    ActiveWindow.LargeScroll ToRight:=-3
    ActiveWindow.LargeScroll Down:=12
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 236
    ActiveWindow.ScrollRow = 232
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 221
    ActiveWindow.ScrollRow = 217
    ActiveWindow.ScrollRow = 215
    ActiveWindow.ScrollRow = 213
    ActiveWindow.ScrollRow = 197
    ActiveWindow.ScrollRow = 94
    ActiveWindow.ScrollRow = 78
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 2
    Sheets("CLASSIFICHE").Select
    ActiveWindow.LargeScroll Down:=4
    Range("Q99").Select
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 1
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 3
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 2
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollColumn = 7
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 17
    ActiveWindow.ScrollColumn = 16
    ActiveWindow.ScrollColumn = 14
    ActiveWindow.ScrollColumn = 13
    ActiveWindow.ScrollRow = 83
    ActiveWindow.ScrollRow = 80
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 1
    Range("Q6").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(VLOOKUP(RC[-5],R2C[-10]:R300C[-6],5,0),"""")"
    Range("Q6").Select
    Selection.Copy
    Range("Q7:Q300").Select
    ActiveSheet.Paste
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 70
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 75
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 77
    ActiveWindow.ScrollRow = 79
    ActiveWindow.ScrollRow = 80
    ActiveWindow.ScrollRow = 82
    ActiveWindow.ScrollRow = 83
    ActiveWindow.ScrollRow = 84
    ActiveWindow.ScrollRow = 85
    ActiveWindow.ScrollRow = 86
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 88
    ActiveWindow.ScrollRow = 89
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 81
    ActiveWindow.ScrollRow = 74
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 71
    ActiveWindow.ScrollRow = 69
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll ToRight:=-2
    Range("M6").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("M6:M304").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 72
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 98
    ActiveWindow.ScrollRow = 110
    ActiveWindow.ScrollRow = 112
    ActiveWindow.ScrollRow = 115
    ActiveWindow.ScrollRow = 119
    ActiveWindow.ScrollRow = 120
    ActiveWindow.ScrollRow = 121
    ActiveWindow.ScrollRow = 122
    ActiveWindow.ScrollRow = 123
    ActiveWindow.ScrollRow = 124
    ActiveWindow.ScrollRow = 126
    ActiveWindow.ScrollRow = 128
    ActiveWindow.ScrollRow = 132
    ActiveWindow.ScrollRow = 134
    ActiveWindow.ScrollRow = 136
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 140
    ActiveWindow.ScrollRow = 141
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 151
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 153
    ActiveWindow.ScrollRow = 154
    ActiveWindow.ScrollRow = 157
    ActiveWindow.ScrollRow = 158
    ActiveWindow.ScrollRow = 160
    ActiveWindow.ScrollRow = 162
    ActiveWindow.ScrollRow = 164
    ActiveWindow.ScrollRow = 165
    ActiveWindow.ScrollRow = 166
    ActiveWindow.ScrollRow = 168
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 176
    ActiveWindow.ScrollRow = 178
    ActiveWindow.ScrollRow = 179
    ActiveWindow.ScrollRow = 180
    ActiveWindow.ScrollRow = 183
    ActiveWindow.ScrollRow = 184
    ActiveWindow.ScrollRow = 186
    ActiveWindow.ScrollRow = 190
    ActiveWindow.ScrollRow = 196
    ActiveWindow.ScrollRow = 203
    ActiveWindow.ScrollRow = 206
    ActiveWindow.ScrollRow = 207
    ActiveWindow.ScrollRow = 208
    ActiveWindow.ScrollRow = 209
    ActiveWindow.ScrollRow = 211
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 219
    ActiveWindow.ScrollRow = 220
    ActiveWindow.ScrollRow = 222
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 229
    ActiveWindow.ScrollRow = 231
    ActiveWindow.ScrollRow = 234
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 239
    ActiveWindow.ScrollRow = 240
    ActiveWindow.ScrollRow = 241
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 243
    ActiveWindow.ScrollRow = 244
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 247
    ActiveWindow.ScrollRow = 248
    ActiveWindow.ScrollRow = 249
    Range("W262").Select
    ActiveWindow.ScrollRow = 250
    ActiveWindow.ScrollRow = 249
    ActiveWindow.ScrollRow = 247
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 244
    ActiveWindow.ScrollRow = 243
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 237
    ActiveWindow.ScrollRow = 235
    ActiveWindow.ScrollRow = 234
    ActiveWindow.ScrollRow = 233
    ActiveWindow.ScrollRow = 232
    ActiveWindow.ScrollRow = 231
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 227
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 220
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 211
    ActiveWindow.ScrollRow = 209
    ActiveWindow.ScrollRow = 203
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 179
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 123
    ActiveWindow.ScrollRow = 119
    ActiveWindow.ScrollRow = 113
    ActiveWindow.ScrollRow = 108
    ActiveWindow.ScrollRow = 107
    ActiveWindow.ScrollRow = 108
    ActiveWindow.ScrollRow = 109
    ActiveWindow.ScrollRow = 114
    ActiveWindow.ScrollRow = 119
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 138
    ActiveWindow.ScrollRow = 137
    ActiveWindow.ScrollRow = 134
    ActiveWindow.ScrollRow = 126
    ActiveWindow.ScrollRow = 101
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 1
    Range("N8").Select
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 84
    ActiveWindow.ScrollRow = 95
    ActiveWindow.ScrollRow = 96
    ActiveWindow.ScrollRow = 103
    ActiveWindow.ScrollRow = 107
    ActiveWindow.ScrollRow = 111
    ActiveWindow.ScrollRow = 112
    ActiveWindow.ScrollRow = 115
    ActiveWindow.ScrollRow = 117
    ActiveWindow.ScrollRow = 118
    ActiveWindow.ScrollRow = 119
    ActiveWindow.ScrollRow = 120
    ActiveWindow.ScrollRow = 121
    ActiveWindow.ScrollRow = 122
    ActiveWindow.ScrollRow = 123
    ActiveWindow.ScrollRow = 124
    ActiveWindow.ScrollRow = 127
    ActiveWindow.ScrollRow = 128
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 131
    ActiveWindow.ScrollRow = 134
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 136
    ActiveWindow.ScrollRow = 137
    ActiveWindow.ScrollRow = 138
    ActiveWindow.ScrollRow = 139
    ActiveWindow.ScrollRow = 142
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 151
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 153
    ActiveWindow.ScrollRow = 154
    ActiveWindow.ScrollRow = 155
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 158
    ActiveWindow.ScrollRow = 160
    ActiveWindow.ScrollRow = 162
    ActiveWindow.ScrollRow = 163
    ActiveWindow.ScrollRow = 166
    ActiveWindow.ScrollRow = 167
    ActiveWindow.ScrollRow = 169
    ActiveWindow.ScrollRow = 170
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 172
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 174
    ActiveWindow.ScrollRow = 175
    ActiveWindow.ScrollRow = 178
    ActiveWindow.ScrollRow = 180
    ActiveWindow.ScrollRow = 183
    ActiveWindow.ScrollRow = 187
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 192
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 194
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 191
    ActiveWindow.ScrollRow = 181
    ActiveWindow.ScrollRow = 163
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 155
    ActiveWindow.ScrollRow = 152
    ActiveWindow.ScrollRow = 149
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 76
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("N15").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=+R[-1]C+1"
    Range("N15").Select
    Selection.Copy
    Range("N16:N300").Select
    ActiveSheet.Paste
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 37
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 73
    ActiveWindow.ScrollRow = 82
    ActiveWindow.ScrollRow = 92
    ActiveWindow.ScrollRow = 96
    ActiveWindow.ScrollRow = 100
    ActiveWindow.ScrollRow = 101
    ActiveWindow.ScrollRow = 102
    ActiveWindow.ScrollRow = 107
    ActiveWindow.ScrollRow = 112
    ActiveWindow.ScrollRow = 121
    ActiveWindow.ScrollRow = 131
    ActiveWindow.ScrollRow = 135
    ActiveWindow.ScrollRow = 142
    ActiveWindow.ScrollRow = 147
    ActiveWindow.ScrollRow = 151
    ActiveWindow.ScrollRow = 153
    ActiveWindow.ScrollRow = 156
    ActiveWindow.ScrollRow = 161
    ActiveWindow.ScrollRow = 171
    ActiveWindow.ScrollRow = 176
    ActiveWindow.ScrollRow = 180
    ActiveWindow.ScrollRow = 181
    ActiveWindow.ScrollRow = 182
    ActiveWindow.ScrollRow = 185
    ActiveWindow.ScrollRow = 189
    ActiveWindow.ScrollRow = 192
    ActiveWindow.ScrollRow = 193
    ActiveWindow.ScrollRow = 195
    ActiveWindow.ScrollRow = 198
    ActiveWindow.ScrollRow = 201
    ActiveWindow.ScrollRow = 206
    ActiveWindow.ScrollRow = 207
    ActiveWindow.ScrollRow = 210
    ActiveWindow.ScrollRow = 211
    ActiveWindow.ScrollRow = 212
    ActiveWindow.ScrollRow = 213
    ActiveWindow.ScrollRow = 214
    ActiveWindow.ScrollRow = 219
    ActiveWindow.ScrollRow = 221
    ActiveWindow.ScrollRow = 226
    ActiveWindow.ScrollRow = 230
    ActiveWindow.ScrollRow = 231
    ActiveWindow.ScrollRow = 233
    ActiveWindow.ScrollRow = 236
    ActiveWindow.ScrollRow = 238
    ActiveWindow.ScrollRow = 240
    ActiveWindow.ScrollRow = 242
    ActiveWindow.ScrollRow = 244
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 248
    ActiveWindow.ScrollRow = 250
    ActiveWindow.ScrollRow = 253
    ActiveWindow.ScrollRow = 255
    ActiveWindow.ScrollRow = 256
    ActiveWindow.ScrollRow = 258
    ActiveWindow.ScrollRow = 262
    ActiveWindow.ScrollRow = 263
    ActiveWindow.ScrollRow = 262
    ActiveWindow.ScrollRow = 261
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 258
    ActiveWindow.ScrollRow = 257
    ActiveWindow.ScrollRow = 256
    ActiveWindow.ScrollRow = 254
    ActiveWindow.ScrollRow = 257
    ActiveWindow.ScrollRow = 266
    ActiveWindow.ScrollRow = 280
    ActiveWindow.ScrollRow = 282
    ActiveWindow.ScrollRow = 283
    ActiveWindow.ScrollRow = 286
    ActiveWindow.ScrollRow = 289
    ActiveWindow.ScrollRow = 292
    ActiveWindow.ScrollRow = 294
    ActiveWindow.ScrollRow = 295
    Range("P300").Select
    ActiveWindow.ScrollRow = 294
    ActiveWindow.ScrollRow = 291
    ActiveWindow.ScrollRow = 283
    ActiveWindow.ScrollRow = 266
    ActiveWindow.ScrollRow = 183
    ActiveWindow.ScrollRow = 90
    ActiveWindow.ScrollRow = 68
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 1
    Range("P6:P300").Select
    Range("P300").Activate
    Application.CutCopyMode = False
    Selection.Copy
    Range("P6").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("P7:P300").Select
    ActiveSheet.Paste
    Range("N6:N300").Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("M5").Select
    ActiveSheet.Shapes.Range(Array("Button 12")).Select
    Application.CutCopyMode = False
    ActiveSheet.Shapes.Range(Array("Button 11")).Select
    ActiveSheet.Shapes.Range(Array("Button 17")).Select
End Sub
Attribute VB_Name = "Modulo56"
Attribute VB_Name = "Modulo57"
Attribute VB_Name = "Modulo58"
Function Col_Letter(lngCol As Long) As String
Dim vArr
vArr = Split(Cells(1, lngCol).Address(True, False), "$")
Col_Letter = vArr(0)
End Function

Sub Caselladiselezione1_Cambia()
On Error Resume Next
Application.ScreenUpdating = False
ActiveSheet.Unprotect

    
If Range("B23") > 10 Then
   
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = Range("B23") + 3
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
    ActiveSheet.Range("E1").Select
    Else
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = 10
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
        ActiveSheet.Range("E1").Select
    End If
    'Application.CommandBars("Format Object").Visible = False
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sheets("Come nasce la (il) liquidit|fffd|").Activate
    
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sheets("Come nasce la (il) liquidit|fffd|").Shapes.Range(Array("Rounded Rectangle 4")).Select
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sheets("Come nasce la (il) liquidit|fffd|").Shapes.Range(Array("Rettangolo con angoli arrotondati 4")).Select

'DoEvents
'MsgBox iniziale
'MsgBox Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1")

    'Selection.ShapeRange.IncrementLeft -57.187480315
    '''If Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1") > iniziale2 Then
    
   'MsgBox ("p" & Range("aa1") + 1)
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Selection.ShapeRange.Left = Range(Col_Letter(Range("aa1") + 1) & 12).Left 'Selection.ShapeRange.IncrementLeft 54.3750393701
    'DoEvents
    'DoEvents
    
   ''' Else
    'Selection.ShapeRange.IncrementLeft -54.3750393701
    '''Selection.ShapeRange.Left = Range("p" & Columns(Range("aa1") + 1)).Left
    'DoEvents
    'DoEvents
   ''' MsgBox Range("p" & Columns(Range("aa1") + 1))
   ''' End If
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Range("E1").Select
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''Sheets("Come nascono debiti e liquidit|fffd|").Activate
    ActiveSheet.Protect
    
    
Application.ScreenUpdating = True
End Sub


Sub Caselladiselezione4_Cambia()
On Error Resume Next
Application.ScreenUpdating = False
ActiveSheet.Unprotect
If Range("ac27") > 10 Then
    
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = Range("ac27") + 3
     ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
    ActiveSheet.Range("E1").Select
    Else
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = 10
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
        ActiveSheet.Range("E1").Select
        
   End If
    'Application.CommandBars("Format Object").Visible = False
    
ActiveSheet.Shapes.Range(Array("Rounded Rectangle 4")).Select
        Sheets("Come nasce la (il) liquidit|fffd|").Shapes.Range(Array("Rettangolo con angoli arrotondati 4")).Select


    'Selection.ShapeRange.IncrementLeft -57.187480315
   ''' If Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1") > iniziale Then
    '''Selection.ShapeRange.IncrementLeft 54.3750393701
    'DoEvents
    'DoEvents
    '''Else
    Selection.ShapeRange.IncrementLeft -54.3750393701
    'DoEvents
    'DoEvents
    '''End If
   
   Selection.ShapeRange.Left = Range(Col_Letter(Range("aa1") + 1) & 12).Left
   
    Range("E1").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
        
       
    Application.ScreenUpdating = True
End Sub
Sub Caselladiselezione5_Cambia()
On Error Resume Next
Application.ScreenUpdating = False
ActiveSheet.Unprotect
If Range("ac27") > 10 Then
    
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = Range("ac27") + 3
     ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
    ActiveSheet.Range("E1").Select
    Else
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = 10
    ActiveChart.Axes(xlValue).MaximumScaleIsAuto = True
        ActiveSheet.Range("E1").Select
   End If
    'Application.CommandBars("Format Object").Visible = False
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 4")).Select
            Sheets("Come nasce la (il) liquidit|fffd|").Shapes.Range(Array("Rettangolo con angoli arrotondati 4")).Select

    'Selection.ShapeRange.IncrementLeft -57.187480315
    
    '''If Sheets("Come nasce la (il) liquidit|fffd|").Range("AA1") > iniziale Then
   ''' Selection.ShapeRange.IncrementLeft 11 * 54.3750393701
   ''' DoEvents
    '''DoEvents
    '''Else
    '''Selection.ShapeRange.IncrementLeft -54.3750393701 * 11
   ''' DoEvents
   ''' DoEvents
   ''' End If
    Selection.ShapeRange.Left = Range(Col_Letter(Range("aa1") + 1) & 12).Left
    
    Range("E1").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
        
 Application.ScreenUpdating = True
End Sub

Sub FlussoCanalizzatore()
' a1b2c3d4e5f6g7h8i9j10k11L12m13n14o15p16q17r18s19t20u21v22w23x24y25z26
'aa27ab28ac29ad30ae31af32ag33ah34ai35aj36ak37aL38am39an40ao41ap42aq43ar44as45at46au47av48aw49ax50ay51az52



'set Rng = Range("N15:W19")
Dim Col
Dim LETCOL As Long
Dim LETTERA
Dim allontana
LETCOL = Sheets("Come nasce la (il) liquidit|fffd|").Range("AB17").Value
LETTERA = Col_Letter(LETCOL)

'MsgBox LETTERA
'Exit Sub

allontana = 20


'FORNITORI
Col = 25 + 1 - Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22")

If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22") = 0 Then
Set rng = Range("Y17:" & Cells(17, 25).Address)
Else
Set rng = Range("Y15:" & Cells(19, Col).Address)
End If

Set rng1 = Range("D17:" & Cells(17, Col).Address)

Set rng2 = Range("D8:D16")
Set rng3 = Range("D8:M8")




'MAGAZZINO
Col = 14 - 1 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "18")
Set rng4 = Range("N6:" & Cells(10, Col).Address)

'Set Rng6 = Range("AI6:ANallontana")

'CLIENTI
Col2 = allontana + 35 - 1 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "19")
Set rng6 = Range(Col_Letter(35 + allontana) & "6:" & Cells(10, Col2).Address)
'MsgBox (Col_Letter(35 + allontana) & "6:" & Cells(10, Col2 + allontana).Address)
'Exit Sub

Set rng5 = Range(Cells(8, Col + 1).Address & ":" & Cells(8, Col2).Address)
Set rng10 = Range(Cells(8, Col2 + 1).Address & ":" & Cells(8, Col2 + 1 + 7).Address)
Set rng11 = Range(Cells(9, Col2 + 1 + 7 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20")).Address & ":" & Cells(17, Col2 + 1 + 7 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20")).Address)   'VERTICALE
'MsgBox Cells(9, Col2 + 1 + 7).Address & ":" & Cells(17, Col2 + 1 + 7).Address
'Exit Sub

'CASSA
Col20 = Col2 + 1 + 7 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20")
If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20") > 0 Then
Set rng20 = Range(Cells(6, Col2 + 1 + 7).Address & ":" & Cells(10, Col20).Address)
Else
Set rng20 = Range(Cells(8, Col2 + 1).Address) 'Range(Cells(8, Col2 + 1 + 7).Address & ":" & Cells(8, Col2 + 1 + 7).Address)
End If



'BANCHE A BREVE
Dim xx
If -Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") < 1 Then
xx = -1
Else
xx = Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23")
End If


col3 = 40 + 1 + xx 'Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23")
'MsgBox Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23")
'Exit Sub

If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") = 0 Then
Set rng7 = Range(Cells(17, col3 + allontana).Address & ":" & Col_Letter(40 + allontana) & "17")
Else
Set rng7 = Range(Cells(15, col3 + allontana).Address & ":" & Col_Letter(40 + allontana) & "19")
End If

'Set Rng7 = Range("aN15:" & Cells(19, Col).Address)
'MsgBox Cells(15, Col3 + allontana).Address & ":" & Col_Letter(40 + allontana) & "19"
'Exit Sub


Set rng12 = Range(Cells(17, Col2 + 1 + 7 + Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20")).Address & ":" & Col_Letter(40 + allontana + 1) & "17")
' Cells(17, Col3 + allontana).Address)
'MsgBox Cells(17, Col2 + 1 + 7).Address & ":" & Cells(17, Col3 + allontana).Address
'Exit Sub

''''Set Rng8 = Range("Z17:" & Cells(17, Col3 - 1).Address)



'COPERTURA FORNITORI
If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22") = 0 Then
Col = 25 - 1
Else
If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") = 0 Then
Col = 25 + 1 - WorksheetFunction.Min(Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "19"), Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22"))

Else
Col = 25 + 1 - WorksheetFunction.Min(-Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23"), Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "19"), Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22"))
End If
End If

If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "22") = 0 Then
Set rng9 = Range("Y17:" & Cells(17, 25).Address)
Else
Set rng9 = Range("Y15:" & Cells(19, Col).Address)
End If
'MsgBox "Y15:" & Cells(19, Col).Address
'Exit Sub



'CHIUSURA BANCHE

'Col = 40 + 1 - WorksheetFunction.Min(-Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23"), Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "19"))

Col = 40 + 1 - WorksheetFunction.Min(-xx, Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "19"))

'''''''Set Rng13 = Range("aN15:" & Cells(19, Col).Address)
If -Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") > 0 Then
Set rng13 = Range(Cells(15, Col + allontana).Address & ":" & Col_Letter(40 + allontana) & "19")
Else
Set rng13 = Range(Cells(17, Col + allontana).Address & ":" & Col_Letter(40 + allontana) & "17")
End If

'Set Rng8 = Range("Z17:" & Cells(17, Col + allontana - 1).Address)
Set rng8 = Range("Z17:" & Cells(17, col3 + allontana - 1).Address)
'MsgBox "Z17:" & Cells(17, Col - 1).Address
'Exit Sub



  Dim reng As Range
 Dim aa
 Dim bb
 
 aa = rng.Columns.Count
 
 
  Range("L22:V22").Select
    Application.CutCopyMode = False
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    'MsgBox ""
        
    Range("L22:AD22").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    'MsgBox ""
 
 Application.GoTo Reference:=Range("a1"), Scroll:=True  'POSIZIONA L'ANGOLO ALTO FINESTRA IN A1
 
    Range("AD18:AD22").Select
    Range("AD22").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    
     Range("z17:AD17").Select
    Range("AD17").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    'MsgBox ""
 
 
 
'For Each reng In rng.Columns
If Range("A2") = 1 Then
MsgBox "Gli acquisti aprono i FORNITORI per l'importo corrispondente al credito medio ottenuto"
End If

For bb = 0 To aa - 1
rng.Columns(aa - bb).Activate
    'Range("N15:W19").Select
    
    
    With Selection.Interior
        Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
    ActiveCell.Value = 1 + bb
    
    Next bb
    Range("Y17") = "FORNITORI"
    If Range("A2") = 1 Then

MsgBox "Gli acquisti e la produzione determinano le SCORTE A MAGAZZINO per l'importo corrispondente alla giacenza media"
End If

  
  
     
     
   ' For Each reng In rng1.Columns
'reng.Activate
aa = rng1.Columns.Count
For bb = 0 To aa - 1
rng1.Columns(aa - bb).Activate
    With Selection.Interior
        Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
        Next bb
        
        For Each reng In rng2.Columns
reng.Activate
    'Range("D8:D16").Select
    'Range("D16").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 192
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
   DoEvents
    DoEvents
     Next reng
    
    For Each reng In rng3.Columns
reng.Activate
    'Range("D8:M8").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .Color = 6299648
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
     Next reng
    
    bb = 0
    For Each reng In rng4.Columns
reng.Activate
   ' Range("N6:Q10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 6299648
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
 DoEvents
    DoEvents
    ActiveCell.Value = 1 + bb
    bb = bb + 1
     Next reng
     Range("N8") = "MAGAZZINO"
     
     If Range("A2") = 1 Then
     'MsgBox "Gli acquisti e la produzione determinano le SCORTE A MAGAZZINO per l'importo corrispondente alla giacenza media"
     MsgBox "Le vendite di prodotto finito determinano il fatturato e l'apertura di CREDITI VERSO CLIENTI per l'importo corrispondente al tempo medio di incasso contrattato"
     End If
     
     
     Range("L1").Select
    Selection.Copy
    Range("B4:B20").Select
    Range("B20").Activate
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
       ' MsgBox ""
        
         Application.GoTo Reference:=Range("a1"), Scroll:=True  'POSIZIONA L'ANGOLO ALTO FINESTRA IN A1
        
    Range("C4:R4").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
     'MsgBox ""
        
    Range("R5:R7").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        'MsgBox ""
        
     
     
     
     For Each reng In rng5.Columns
reng.Activate
    'Range("R8:AH8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 3000000
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
     Next reng
     
     bb = 0
     For Each reng In rng6.Columns
reng.Activate
    'Range("AI6:AN10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 3000000
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
    ActiveCell.Value = 1 + bb
    bb = bb + 1
     Next reng
     Range(Col_Letter(35 + allontana) & "8") = "CLIENTI"
     
     If Range("A2") = 1 Then
     'MsgBox "Le vendite di prodotto finito determinano il fatturato e l'apertura di CREDITI VERSO CLIENTI per l'importo corrispondente al tempo medio di incasso contrattato"
    MsgBox "Se arrivano a scadenza dei fornitori prima dell'incasso dai clienti si aprono i DEBITI VS BANCHE per l'importo corrispondente ai fornitori scaduti"
     End If
      
      
    ' For Each reng In rng7.Columns
'reng.Activate
aa = rng7.Columns.Count
For bb = 0 To aa - 1
rng7.Columns(aa - bb).Activate

    'Range("AI15:AN19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 192
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
   DoEvents
    DoEvents
    ActiveCell.Value = 1 + bb
   
     Next bb
     
     If -Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") > 0 Then
     Range(Cells(17, col3 + allontana).Address) = "BANCHE A BREVE"
     If Range("A2") = 1 Then
    ' MsgBox "Se arrivano a scadenza dei fornitori prima dell'incasso dai clienti si aprono i DEBITI VS BANCHE per l'importo corrispondente ai fornitori scaduti"
   MsgBox "Con i fidi ottenuti dalle banche paghiamo i Fornitori scaduti."
     End If
     End If
     
         
     
      For Each reng In rng20.Columns
reng.Activate
    'Range("AI6:AN10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
     Next reng
     
     If Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "20") > 0 Then
     Range(Cells(8, Col2 + 1 + 7).Address) = "CASSA"
     If Range("A2") = 1 Then
     MsgBox "L'incasso di importi in eccesso agli acquisti determina il formarsi di liquidit|fffd| dopo aver ripianato eventuali debiti verso banche"
     End If
     End If
     
 

aa = rng8.Cells.Count
For bb = 0 To aa - 1
rng8.Cells(aa - bb).Activate
    'Range("X17:AH17").Select
    'Range("AH17").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
         Next bb
     
     
    'sbagliato! saltare questo pezzo! E' sbagliato perch|fffd| i fornitori aperti non sono pagati, quelli pagati sono gi|fffd| stati chiusi all'apertura delle banche
    ' ma no va bene! |fffd| solo a fini didattici come se fossimo al momento 0 !!
           
        If Range("A2") = 1 Then
           If -Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") > 0 Then
     'MsgBox "Con i fidi ottenuti dalle banche paghiamo i Fornitori scaduti."
     
     Else
          MsgBox "Con gli incassi delle scadenze dei clienti paghiamo i Fornitori scaduti."
     End If
     End If
     
     For Each cell In rng9
cell.Activate
    
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
    DoEvents
     Next cell
     
     'fine sbagliato
     If Range("A2") = 1 Then
     MsgBox "I bonifici dei clienti arrivati a scadenza coprono i debiti a breve verso banche"
     End If
          
      ' MsgBox "10"
     For Each reng In rng10.Columns
reng.Activate
    'Range("AO8:AV8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
     Next reng
     
        
    
   
  
   
   
   
     
     'MsgBox "11"
     For Each reng In rng11.Columns
reng.Activate
    'Range("AV9:AV17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
  DoEvents
    DoEvents
     Next reng
    
    
    
     'MsgBox "12"
     'For Each reng In rng12.Columns
'reng.Activate

aa = rng12.Columns.Count
For bb = 0 To aa - 1
rng12.Columns(aa - bb).Activate

    'Range("AO17:AU17").Select
    'Range("AU17").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
   DoEvents
    DoEvents
     Next bb
     
     
      If -Sheets("Come nasce la (il) liquidit|fffd|").Range(LETTERA & "23") > 0 Then
      If Range("A2") = 1 Then
    ' MsgBox "I bonifici dei clienti arrivati a scadenza coprono i debiti a breve verso banche"
     '''''''''''''MsgBox "I bonifici dei clienti arrivati a scadenza coprono i debiti a breve verso banche"
     End If
     End If
     
     For Each cell In rng13
cell.Activate
    'Range("AI15:AN19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    DoEvents
    DoEvents
         Next cell
         
         
         If Range("A2") = 1 Then
                
                  MsgBox " Abbiamo tracciato il percorso del flusso di cassa totale"
         End If
         
          Range("AA12").Select
    'With Selection.Font
     '   .Color = -10477568
      '  .TintAndShade = 0
    'End With
         
     With Selection.Font
        .Name = "Calibri"
        .Size = 20
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
         'Rows("12:12").Select
    Rows("12:12").EntireRow.AutoFit
         
     Range("aa12") = "Percorso del Flusso di Valore"
    Range("A2").Select
End Sub

Sub Flusso_cancella()
Range("A3:EA38").Select
        Selection.ClearContents
        Selection.RowHeight = 12.75
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A2").Select
End Sub

Attribute VB_Name = "Modulo59"
Sub Macro36()
Attribute Macro36.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro36 Macro
'

'
    Range("D8:M8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 6299648
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("N6:AM10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 6299648
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("AN8:AR8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = -0.499984740745262
        .PatternTintAndShade = 0
    End With
    Range("AS6:AX10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = -0.499984740745262
        .PatternTintAndShade = 0
    End With
    Range("R15:S19").Select
    With Selection.Font
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Range("J10").Select
End Sub
Sub Macro37()
Attribute Macro37.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro37 Macro
'

'
    Range("R15:S19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Range("Q15").Select
End Sub
Sub Macro38()
Attribute Macro38.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro38 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MaximumScale = 12
    Range("E1").Select
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.Axes(xlValue).Select
    Range("E1").Select
    ExecuteExcel4Macro "SCALE(,10,,,,,,,,,,1)"
    ActiveSheet.ChartObjects("Grafico 2").Activate
    ActiveChart.PlotArea.Select
    Range("E1").Select
End Sub
Attribute VB_Name = "Modulo6"


Sub stampare()
Attribute stampare.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    ExecuteExcel4Macro "PRINT(1,,,1,,,,,,,,2,,,TRUE,,FALSE)"
End Sub
Sub stampareport()
Dim disco
MSG1 = MsgBox("Really do you want print this Report ?", vbYesNo, "Print?")
If MSG1 = vbYes Then
On Error GoTo err
disco = InputBox("The letter of disk on wich to save? (without : please)")
  If disco = "" Then
    Exit Sub
    End If
    

Application.ScreenUpdating = False
On Error Resume Next

'messo adesso perch|fffd| a volte stampavo report con lite non aggiornato
aggiornare

Dim FolderPath As String
Dim folius As String
folius = ActiveSheet.Name
'MsgBox folius

If disco <> "c" And disco <> "C" Then
FolderPath = disco & ":\BallariniPDFs"
Else
FolderPath = "C:\Users\Public\BallariniPDFs"
End If

'MsgBox FolderPath
MkDir FolderPath


DoEvents
On Error GoTo -1
err.Clear
'MsgBox err.Number

Sheets("how much it's worth ").Shapes("Casella di controllo 6").OLEFormat.Object.Value = False
Sheets("how much it's worth ").Shapes("Check Box 6").OLEFormat.Object.Value = False
On Error GoTo TROUBLEe

    Sheets(Array("lite screening")).Select
  
    Dim nomerep
  nomerep = Sheets("COVER").Range("B8")
  nomerep = Replace(nomerep, "/", "_")
  nomerep = Replace(nomerep, ",", "")
  nomerep = Replace(nomerep, ";", "")
  
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=FolderPath & "\Report LITE " & nomerep, _
        openafterpublish:=False, ignoreprintareas:=False
    
    DoEvents
    
    Sheets(Array("COVER", "full screening", "Financial Structure", "how does it work", "how does it pay", "Ratings", "Standard Ratios", "RF", "how much it's worth ")).Select
  
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=FolderPath & "\Report " & nomerep, _
        openafterpublish:=False, ignoreprintareas:=False
DoEvents
    
MsgBox "Pdf Reports " & FolderPath & Sheets("COVER").Range("B8") & " has been successfully exported."
DoEvents
Sheets(folius).Select
DoEvents
Application.ScreenUpdating = True
Exit Sub
Else
Application.ScreenUpdating = True
        Exit Sub
        End If
        

TROUBLEe:
Sheets(folius).Select
Application.ScreenUpdating = True
DoEvents
MsgBox "Error printing in pdf"
Exit Sub
Application.ScreenUpdating = True
err:   MsgBox "wrong disk letter?"

End Sub

Sub scandire()
On Error Resume Next
    Dim hwnd As Long
    Dim paths As String


'CommandButton3.Visible = False
Dim FOO
Dim fNameAndPath
Dim conta
paths = ActiveWorkbook.Path

MsgBox "Needs a license for an external software!"


Exit Sub
'ADESSO FERMO QUI CHE TANTO NON SERVE, SE SERVISSE TOLGO QUESTO BLOCCO E TESTO BENE LA QUESTIONE DELLA PROTEZIONE
'RICORDA DI TENERE O METTERE COLORE BIANCO NEL TESTO DELLA CASELLA L23

Dim MyData As DataObject
Dim strClip As String
Set MyData = New DataObject
MyData.GetFromClipboard
strClip = MyData.GetText

If Right(strClip, 3) = "zip" Or Right(strClip, 3) = "ZIP" Then

Const wsPass As String = "ballaredo55" '//Change to your password


   ActiveSheet.Unprotect wsPass
   ActiveSheet.Range("L23").Cells.Locked = False
   


ActiveSheet.Range("L23").Select
'MsgBox strClip
ActiveCell.FormulaR1C1 = strClip


 ActiveSheet.Protect wsPass
End If




If Right(ActiveSheet.Range("L23"), 3) <> "zip" And Right(ActiveSheet.Range("L23"), 3) <> "ZIP" Then
MsgBox "You've to change Financial Statement before."
ActiveSheet.Protect wsPass
Exit Sub
End If




'MsgBox paths & "\PowerGREP4\mypgaction2.pga /simple /folder " & "C:\IFRx-O-Matic migliore di tutti PER PROTEZIONE CON XLSTOEXE\OK OK DA COPIARE SU CHIAVETTA O CD SENZA INSTALLAZIONE IFRx-O-Matic Ok KEYKEY scadenza 14 12 14\BILANCI ITALIA 2013 xxx\CERAMICA_AET_13.zip"
'Exit Sub



'''fNameAndPath = Application.GetOpenFilename(FileFilter:="Zip & pdf Files,*.zip;*.pdf", Title:="Select File To Search In")
'''If fNameAndPath = False Then Exit Sub
'Workbooks.Open Filename:=fNameAndPath
'MsgBox fNameAndPath
'Stop
'''FOO = LTrim(RTrim(fNameAndPath))
'DA QUESTA MACRO FUNZIONA SOLO SE SCELGO DEI FILES PDF NON SO PERCHE' NON VA SE SCELGO UNO ZIP
'POI FUNZIA SOLO SE IL NOME DELLA DIR NON CONTIENE SPAZI
'POI BISOGNEREBBE PRIMA DARE UN COMANDO DI CLEAR SELECTION ALTRIMENTI CERCA SEMPRE NEI FILES VECCHI
'|fffd| necessario che la directory e il file abbiano un nome senza spazi; in talcaso funziona; per farlo funzionare con nomi contenenti spazi non so come fare
'FOO = "C:\ITALY2013\CERAMICA_CASTELVETRO_13.pdf"


Dim lPid As Long
Dim FAIL
FAIL = ActiveSheet.Range("L23")

lPid = Shell(paths & "\PowerGREP4\PowerGREP4.exe " & paths & "\PowerGREP4\mypgaction3.pga /reuse /execute " & "/folderrecurse """ & FAIL & "::\&""", vbNormalFocus)
      '  hwnd = HwndFromPID(lPid)
    'hwnd = GetWindow(hwnd, GW_CHILD)
    If lPid = 0 Then
    lPid = Shell(paths & "\PowerGREP4\PowerGREP4.exe " & paths & "\PowerGREP4\mypgaction3.pga /execute " & "/folderrecurse """ & FAIL & "::\&""", vbNormalFocus)
    
    End If
    'PowerGREP4.exe /search /regex "foo|bar" /folder "C:\My Documents" /masks "*.txt" "*.bak" 0 /preview

'Shell paths & "\PowerGREP4\PowerGREP4.exe " & paths & "\PowerGREP4\mypgaction.pga /simple ", vbNormalFocus
'Application.Cursor = xlDefault
DoEvents

'''sleep (20)
'CommandButton3.Visible = True
'ActiveSheet.Range("F7").Select
End Sub
Attribute VB_Name = "Modulo60"
Sub Macro39()
Attribute Macro39.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro39 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 4")).Select
    Selection.ShapeRange.IncrementLeft -57.187480315
    Selection.ShapeRange.IncrementLeft -54.3750393701
    Selection.ShapeRange.IncrementTop -0.9375590551
    Selection.ShapeRange.IncrementLeft -56.25
    Selection.ShapeRange.IncrementTop 2.812519685
End Sub
Attribute VB_Name = "Modulo61"
Sub Macro40()
Attribute Macro40.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro40 Macro
'

'
    Range("A3:EA38").Select
        Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A1").Select
End Sub
Attribute VB_Name = "Modulo62"
Sub SPINGIGIU()
Attribute SPINGIGIU.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro41 Macro
'

'
    Range("A5:BQ20").Select
    Selection.Insert Shift:=xlDown
    Range("A1").Select
End Sub
Attribute VB_Name = "Modulo63"
Sub prova()
Attribute prova.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro42 Macro
'

'
    
    Range("BG15:BH19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 192
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("BG4:BH21").Select
    Selection.Insert Shift:=xlToRight
    Range("A1").Select
End Sub
Sub inserisciperditaclienti()
Attribute inserisciperditaclienti.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro43 Macro
'

'



If inserito = 1 Then
Range("Be5:Be21").Select
    Selection.Delete Shift:=xlToLeft
    'Range("A1").Select
    inserito = 0
    Range("bd6") = dd
    Range("bd15") = ddd
    Range("A2").Select
    Exit Sub
    End If
dd = Range("bd6")
ddd = Range("bd15")

    Range("Bd6:Bd10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A2").Select
    MsgBox ""
    Range("Bd5:Bd20").Select
    Selection.Insert Shift:=xlToRight
    Range("A2").Select
    MsgBox ""
    Range("Be15:Be19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 192
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    inserito = 1
    Range("A2").Select
'    MsgBox ""
End Sub

Sub Macro45()
Attribute Macro45.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro45 Macro
'

'
    Range("BI5:BJ21").Select
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select
End Sub
Attribute VB_Name = "Modulo64"
Sub utileclientiperflusso()
Attribute utileclientiperflusso.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro41 Macro
'

'
    Range("BI6:BJ10").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .Color = 50377
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    MsgBox "Qui vediamo una ULTERIORE FETTA DI CLIENTI derivante dal fatto che abbiamo venduto a prezzi pi|fffd| elevati.Quando questo importo arriver|fffd| a scadenza  NON DOVRA' ESSERE RESTITUITO A NESSUNO ! "
    Range("BI6:BJ19").Select
    Selection.Insert Shift:=xlToRight
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    Range("BI17:BJ17").Select
    Range("BJ17").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
     
    Range("BI8:BJ8").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
     'MsgBox ""
    Range("BK15:BL19").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = -0.499984740745262
        .PatternTintAndShade = 0
    End With
     'MsgBox ""
    Range("BK6:BL10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5296274
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    MsgBox "Dunque la fetta in pi|fffd| di clienti corrisponde ad un..."
    
    Range("BK20").Select
    ActiveCell.FormulaR1C1 = "Utile"
    Range("BK20").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("a2").Select
     MsgBox "Utile di esercizio"
    Range("BK5").Select
    ActiveCell.FormulaR1C1 = "Cassa"
    
        
    Range("BK5").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("a2").Select
    MsgBox "Cassa"
    Range("BK4:BL21").Select
    Selection.ClearContents
    Selection.Delete Shift:=xlToLeft
    Range("A2").Select
End Sub
Attribute VB_Name = "Modulo65"
Sub Macro41()
Attribute Macro41.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro41 Macro
'

'
    Range("E28:BO28").Select
    Selection.Copy
    Range("E12").Select
    ActiveSheet.Paste
End Sub
Sub Macro42()
Attribute Macro42.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro42 Macro
'

'
    Range("AA12").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
End Sub
Sub Macro43()
Attribute Macro43.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro43 Macro
'

'
    Range("AA12").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 20
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
End Sub
Attribute VB_Name = "Modulo66"
Sub Clienti_DebFinBr()

Application.ScreenUpdating = False
 ActiveSheet.Unprotect
    Range("E6").Select
    Selection.ClearContents
    Range("i1").Select
    Selection.ClearContents
    Range("j1").Select
    Selection.ClearContents
    Range("E4").Select
    Selection.ClearContents
    Range("E5").Select
    Selection.ClearContents
    Range("F3").Select
    Selection.ClearContents
    Range("F5").Select
    Selection.ClearContents
    Range("F6").Select
    Selection.ClearContents
    Range("F7").Select
   ' ActiveChart.ChartArea.Select
    'ActiveChart.ChartType = xlColumnStacked
    
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ChartType = xlColumnStacked
   ' ActiveChart.ChartType = xlColumnStacked100
      Range("a1").Select
      ActiveSheet.Protect
    Application.ScreenUpdating = True
    
End Sub

Sub Clienti_DebFinBr2()

Application.ScreenUpdating = False
 ActiveSheet.Unprotect
    Range("E6").Select
    Selection.ClearContents
    Range("E4").Select
    Selection.ClearContents
    Range("E5").Select
    Selection.ClearContents
    Range("F3").Select
    Selection.ClearContents
    Range("F5").Select
    Selection.ClearContents
    Range("F6").Select
    Selection.ClearContents
    Range("F7").Select
   ' ActiveChart.ChartArea.Select
    'ActiveChart.ChartType = xlColumnStacked
    
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ChartType = xlColumnStacked
   ' ActiveChart.ChartType = xlColumnStacked100
      Range("a1").Select
      ActiveSheet.Protect
    Application.ScreenUpdating = True
    
End Sub

Attribute VB_Name = "Modulo67"
Sub Macro49()
Attribute Macro49.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro49 Macro
'

'
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ChartType = xlColumnStacked
    ActiveChart.ChartType = xlColumnStacked100
End Sub
Sub RESET_GRAFICO()
Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    Range("AA1:AD1").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.LargeScroll ToRight:=-1
    Range("E1").Select
    ActiveSheet.Paste
    
    Range("AA2:AB6").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Range("E2").Select
    ActiveSheet.Paste
    
    
    Range("An1:Ao1").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Range("i1").Select
    ActiveSheet.Paste
    
    
    
    Range("A1:D1").Select
    Range("I7") = ""
    Range("I11") = "X"
    Range("O4") = 0
    ActiveSheet.ChartObjects("Grafico 3").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ChartType = xlColumnStacked100
    
    DoEvents
      Range("a1").Select
        Application.ScreenUpdating = True
         ActiveSheet.Protect

End Sub
Sub RESET_GRAFICO2()
Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    Range("AA1:AD1").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.LargeScroll ToRight:=-1
    Range("E1").Select
    ActiveSheet.Paste
    
    Range("AA3:AB6").Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Range("E3").Select
    ActiveSheet.Paste
    Range("A1:D1").Select
    Range("I7") = ""
    Range("O4") = 0
    Range("I11") = "X"
    ActiveSheet.ChartObjects("Grafico 1").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ChartType = xlColumnStacked100
    
    DoEvents
    
    Range("a1").Select
        Application.ScreenUpdating = True
         ActiveSheet.Protect

End Sub
Attribute VB_Name = "Modulo68"
Sub Macro44()
Attribute Macro44.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro44 Macro
'

'
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
End Sub
Attribute VB_Name = "Modulo69"
Sub Macro46()
Attribute Macro46.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro46 Macro
'

'
    Range("E1").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True
End Sub
Attribute VB_Name = "Modulo7"
'Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long



#If VBA7 Then
Private Declare PtrSafe Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#Else
Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#End If


Private Const SW_SHOWMAXIMIZED = 3
Function GetIE() As Object
  On Error Resume Next
  Set GetIE = CreateObject("InternetExplorer.Application")
End Function
Sub GoToWebSiteAndPlayAround()
 
Dim appIE As Object
Dim appIE2 As Object ' InternetExplorer.Application
Dim sURL As String
Dim sURL2 As String

Dim UserN As Object ' MSHTML.IHTMLElement
Dim PW As Object ' MSHTML.IHTMLElement
Dim Element As Object ' HTMLButtonElement
Dim btnInput As Object ' MSHTML.HTMLInputElement
Dim ElementCol As Object ' MSHTML.IHTMLElementCollection
Dim Link As Object ' MSHTML.HTMLAnchorElement
Dim strCountBody As String
Dim lStartPos As Long
Dim lEndPos As Long
Dim TextIWant As String
Dim shellwins As New ShellWindows
 
On Error Resume Next
Set appIE = GetIE

For Each appIE In shellwins
sURL2 = appIE.LocationName
'MsgBox sURL
If sURL2 = "Registro Imprese" Then
'MsgBox sURL
AppActivate "Registro Imprese - Internet Explorer"
AppActivate "Registro Imprese - Microsoft Edge"

GoTo 55
End If
Next
'''appIE = 0


'Application.ScreenUpdating = False
'On Error Resume Next
Set appIE = GetIE
 sURL = "http://www.registroimprese.it/ricerca-libera-e-acquisto"
With appIE
    .Navigate sURL
    ' uncomment the line below if you want to watch the code execute, or for debugging
    .Visible = True
End With
DoEvents
appIE.Visible = xlMax
DoEvents
AppActivate appIE
DoEvents
 ' loop until the page finishes loading

'appIE.Activate
Dim II
DoEvents

55

'For II = 1 To 300
'DoEvents
'Next

' Stop
' enter username and password in textboxes
'Set UserN = appIE.Document.getElementsByName("_ricercaportlet_WAR_ricercaRIportlet_ricerca")
'If Not UserN Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    'On Error Resume Next
   'For II = 1 To 600
'DoEvents
'Next
  
    'For II = 1 To 400
'DoEvents
'Next
'End If

 
 'Application.ScreenUpdating = True
 
 'Set appIE = Nothing
appIE.Visible = xlNormal
 
 
 Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Registro Imprese - Internet Explorer")  'check to see if window exist and obtain its handle
On Error Resume Next
AppActivate "Registro Imprese - Internet Explorer"
        
        Dim MyHandle As Long
             MyHandle = Whnd 'FindtheWindow(myProcessID)
             'ShowWindow MyHandle, SW_SHOWMAXIMIZED

        DoEvents
 
 
 
 
 
 
 
 appIE Quit
 
 
 
 
 
End Sub

Sub GoToWebSiteAndPlayAround2()
 
Dim appIE As Object ' InternetExplorer.Application
Dim sURL As String
Dim UserN As Object ' MSHTML.IHTMLElement
Dim PW As Object ' MSHTML.IHTMLElement
Dim Element As Object ' HTMLButtonElement
Dim btnInput As Object ' MSHTML.HTMLInputElement
Dim ElementCol As Object ' MSHTML.IHTMLElementCollection
Dim Link As Object ' MSHTML.HTMLAnchorElement
Dim strCountBody As String
Dim lStartPos As Long
Dim lEndPos As Long
Dim TextIWant As String
 



'Application.ScreenUpdating = False
On Error Resume Next
Set appIE = GetIE
 
sURL = "https://www.infoimprese.it/impr/index.jsp?p=Avanzata"
 
With appIE
    .Navigate sURL
    ' uncomment the line below if you want to watch the code execute, or for debugging
    .Visible = True
End With

appIE.Visible = xlMax

AppActivate appIE

DoEvents
 
' loop until the page finishes loading
Do While appIE.Busy
Loop
'appIE.Activate

Dim II

DoEvents


' Stop
' enter username and password in textboxes
Set UserN = appIE.Document.getElementsByName("parola")
'If Not UserN Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    'On Error Resume Next
    DoEvents
    UserN(0).Click
    DoEvents
    For II = 1 To 50
DoEvents
Next
    
    UserN(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("d15")
    
    For II = 1 To 50
DoEvents
Next
    
    
    
'End If
Do While appIE.Busy
Loop
 DoEvents
 
 
 
 


appIE.Visible = xlNormal
 
 
End Sub


Sub GoToWebSiteAndPlayAround3()
 
Dim appIE As Object ' InternetExplorer.Application
Dim sURL As String
Dim UserN As Object ' MSHTML.IHTMLElement
Dim PW As Object ' MSHTML.IHTMLElement
Dim Element As Object ' HTMLButtonElement
Dim btnInput As Object ' MSHTML.HTMLInputElement
Dim ElementCol As Object ' MSHTML.IHTMLElementCollection
Dim Link As Object ' MSHTML.HTMLAnchorElement
Dim strCountBody As String
Dim lStartPos As Long
Dim lEndPos As Long
Dim TextIWant As String
 



'Application.ScreenUpdating = False
On Error Resume Next
Set appIE = GetIE
 
sURL = "https://telematici.agenziaentrate.gov.it/VerificaPIVA/Scegli.do?parameter=verificaPiva"
 
With appIE
    .Navigate sURL
    ' uncomment the line below if you want to watch the code execute, or for debugging
    .Visible = True
End With

appIE.Visible = xlMax

AppActivate appIE

DoEvents
 
' loop until the page finishes loading
Do While appIE.Busy
Loop
'appIE.Activate

Dim II

DoEvents


' Stop
' enter username and password in textboxes
Set UserN = appIE.Document.getElementsByName("piva")
'If Not UserN Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    'On Error Resume Next
    DoEvents
    UserN(0).Click
    DoEvents
    For II = 1 To 50
DoEvents
Next
    
    UserN(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("i15")
    
    For II = 1 To 50
DoEvents
Next
    
    
    
'End If
Do While appIE.Busy
Loop
 DoEvents
 
 
 
 


 
 'Set appIE = Nothing
appIE.Visible = xlNormal
 
 
End Sub



Attribute VB_Name = "Modulo70"
Sub CONTO_ECONOMICO_FLUSSO()
Attribute CONTO_ECONOMICO_FLUSSO.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro47 Macro
'

'
    Range("L1").Select
    Selection.Copy
    Range("D21:K32").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        Range("B21:C32").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    ActiveCell.FormulaR1C1 = "FATTURATO"
    Range("B21:C32").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
        .ThemeFont = xlThemeFontMinor
    End With
    'With Selection
     '   .HorizontalAlignment = xlCenter
      '  .VerticalAlignment = xlBottom
       ' .WrapText = False
        '.Orientation = -90
 '       .AddIndent = False
  '      .IndentLevel = 0
   '     .ShrinkToFit = False
    '    .ReadingOrder = xlContext
     '   .MergeCells = True
   ' End With
   
    
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 90
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
'    With Selection
 '       .HorizontalAlignment = xlCenter
  '      .VerticalAlignment = xlCenter
   '     .WrapText = False
    '    .Orientation = 90
     '   .AddIndent = False
      '  .IndentLevel = 0
       ' .ShrinkToFit = False
  '      .ReadingOrder = xlContext
   '     .MergeCells = True
   ' End With
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    Range("B21:C32").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 52176
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A2:B2").Select
   
   If Range("A2") = 1 Then
            MsgBox "Il Fatturato |fffd| la causa principale del flusso di valore in entrata per mezzo della gestione"
          End If
        
    Range("G1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("N21:U27").Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        
        DoEvents
         DoEvents
          DoEvents
           DoEvents
            DoEvents
             DoEvents
              DoEvents
               DoEvents
                DoEvents
                 DoEvents
                  DoEvents
                   DoEvents
                    DoEvents
            
       ' MsgBox ""
        
        
    Application.CutCopyMode = False
    Selection.Cut Destination:=Range("D21:K27")
    
     Range("M23").Select
     With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '.Bold = True
    
    ActiveCell.FormulaR1C1 = "COSTI PER ACQUISTI"
    Range("M23").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Bold = True
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    If Range("A2") = 1 Then
     MsgBox "Gli Acquisti sono invece la causa principale del flusso di valore in uscita per mezzo della gestione"
     'xxxxxxxxxxxxxxxxxxx
    End If
    
   GoTo 10
   
    Range("N28:U29").Select
    'With Selection.Interior
     '   .Pattern = xlSolid
      '  .PatternColorIndex = xlAutomatic
       ' .Color = 192
        '.TintAndShade = 0
        '.PatternTintAndShade = 0
    'End With
    'MsgBox "" 'ROSSO COSTO DEL LAVORO
        
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 250
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ' MsgBox "" 'ROSSO COSTO DEL LAVORO
     
     DoEvents
         DoEvents
          DoEvents
           DoEvents
            DoEvents
             DoEvents
              DoEvents
               DoEvents
                DoEvents
                 DoEvents
                  DoEvents
                   DoEvents
                    DoEvents
    
    Selection.Cut Destination:=Range("D28:K29")
    
    Range("M29").Select
    
       With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '.Bold = True
    
    
    ActiveCell.FormulaR1C1 = "COSTO DEL LAVORO"
    Range("M29").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Bold = True
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
     
     If Range("A2") = 1 Then
        MsgBox "Altra voce importante di fuoriuscita di flusso di valore |fffd| il Costo del Lavoro" 'ROSSO COSTO DEL LAVORO
        'yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy
     End If
    
    Range("N30:U30").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    
   ' MsgBox "" 'ROSSO AMMORTAMENTI
     DoEvents
         DoEvents
          DoEvents
           DoEvents
            DoEvents
             DoEvents
              DoEvents
               DoEvents
                DoEvents
                 DoEvents
                  DoEvents
                   DoEvents
                    DoEvents
     
    Selection.Cut Destination:=Range("D30:K30")
    
    'Range("M22").Select
    'Selection.Cut Destination:=Range("M21")
    Range("M30").Select
    
       With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '.Bold = True
    ActiveCell.FormulaR1C1 = "AMMORTAMENTI"
    Range("M30").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Bold = True
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    If Range("A2") = 1 Then
    'zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz
    MsgBox "NON FUORIESCE INVECE ALCUN FLUSSO DI VALORE a causa della voce AMMORTAMENTI che rileva solo una perdita di valore per vetust|fffd| dei beni immobili aziendali" 'ROSSO ALTRI COSTI NON OPERATIVI
    End If
     
     
     '''''''-----------------------------
      Range("N31:U31").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        '.TintAndShade = -0.249977111117893
        '.PatternTintAndShade = 0
        .Color = 5287936
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
   ' MsgBox "" 'ROSSO ALTRI COSTI NON OPERATIVI
     DoEvents
         DoEvents
          DoEvents
           DoEvents
            DoEvents
             DoEvents
              DoEvents
               DoEvents
                DoEvents
                 DoEvents
                  DoEvents
                   DoEvents
                    DoEvents
     
    Selection.Cut Destination:=Range("D31:K31")
    
    'Range("M22").Select
    'Selection.Cut Destination:=Range("M21")
    Range("M31").Select
    
       With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '.Bold = True
    ActiveCell.FormulaR1C1 = "COSTI NON OPERATIVI"
    Range("M31").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Bold = True
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    If Range("A2") = 1 Then
    'zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz
    MsgBox "Poi il flusso di valore fuoriesce anche a causa dei costi non operativi come oneri finanziari, imposte" 'ROSSO ALTRI COSTI NON OPERATIVI
     End If
     
     
     '''''''-----------------------------
     
     
     
     
    Range("D32:D32,K32:K32").Select
    Range("K32").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = -0.499984740745262
        .PatternTintAndShade = 0
    End With
    
    Range("M32").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    '.Bold = True
    ActiveCell.FormulaR1C1 = "UTILE"
    Range("M32").Select
    With Selection.Font
        .Color = -10477568
        .TintAndShade = 0
        .Bold = True
    End With
    
    
'    With Selection.Font
 '       .Name = "Calibri"
  '      .Size = 14
   '     .Strikethrough = False
    '    .Superscript = False
     '   .Subscript = False
      '  .OutlineFont = False
       ' .Shadow = False
        '.Underline = xlUnderlineStyleNone
 '       .Color = -10477568
  '      .TintAndShade = 0
   '     .ThemeFont = xlThemeFontMinor
    'End With
   ' With Selection.Font
    '    .Name = "Calibri"
     '   .Size = 16
      '  .Strikethrough = False
       ' .Superscript = False
        '.Subscript = False
   '     .OutlineFont = False
    '    .Shadow = False
     '   .Underline = xlUnderlineStyleNone
      '  .Color = -10477568
       ' .TintAndShade = 0
      '  .ThemeFont = xlThemeFontMinor
    'End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Bold = True
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    If Range("A2") = 1 Then
        MsgBox "Alla fine rimane il risultato di esercizio" 'UTILE
     End If
     
    
10
        
        
   ' Range("B21:C32").Select
   Application.GoTo Reference:=Range("a1"), Scroll:=True  'POSIZIONA L'ANGOLO ALTO FINESTRA IN A1
   Range("a2").Select
End Sub
Sub CANCELLA_FLUSSO_CONTOEC()
Attribute CANCELLA_FLUSSO_CONTOEC.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro48 Macro
'

'
On Error Resume Next
Dim Shp As Shape

For Each Shp In ActiveSheet.Shapes
    If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl) Then Shp.Delete
Next Shp

    
    Range("AD18:AD20").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("B21:AD32").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.ClearContents
    Range("B21:C32").Select
    Selection.UnMerge
    Range("B4:B20").Select
    Range("B20").Activate
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("C4:R4").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("R5:R7").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A2:B2").Select
End Sub
Attribute VB_Name = "Modulo71"
Sub Macro47()
Attribute Macro47.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro47 Macro
'

'
    Range("BE17").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
        .ThemeFont = xlThemeFontMinor
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
        .ThemeFont = xlThemeFontMinor
    End With
    Range("A2:B2").Select
End Sub
Sub Macro48()
Attribute Macro48.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro48 Macro
'

'
    Range("M23").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("M21").Select
    Selection.Font.Bold = True
End Sub
Sub sposta_a_dx_primo_grafico()
Attribute sposta_a_dx_primo_grafico.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro50 Macro
'

'
Range("D6:BM19").Select
    Selection.Cut Destination:=Range("EN6:GX19")
    'Range("EN6:GX19").Select
    
    
    Range("A2:B2").Select
    
End Sub
Sub sposta_a_sx_primo_grafico()
'
' Macro50 Macro
'

'

    
    Range("EN6:GW19").Select
    Selection.Cut Destination:=Range("D6:BM19")
    Rows("12:12").Select
    Selection.RowHeight = 26.25
    Range("A2:B2").Select
    
End Sub
Sub Macro51()
Attribute Macro51.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro51 Macro
'

'
    Rows("12:12").Select
    Selection.RowHeight = 26.25
    Range("A2:B2").Select
End Sub
Attribute VB_Name = "Modulo72"
Sub Macro50()
Attribute Macro50.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro50 Macro
'

'
On Error Resume Next

    ActiveSheet.Shapes.Range(Array("Flowchart: Extract 5")).Select
    Selection.ShapeRange.IncrementLeft 3.75
    Selection.ShapeRange.IncrementTop 22.5
    ActiveSheet.Shapes.Range(Array("Oval 6")).Select
    ActiveSheet.Shapes.Range(Array("Ovale 6")).Select

    Selection.ShapeRange.IncrementTop 22.5
    Range("A1:D1").Select
End Sub
Attribute VB_Name = "Modulo73"
Sub Macro52()
Attribute Macro52.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro52 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Straight Arrow Connector 12")).Select
    Selection.ShapeRange.IncrementLeft 1.8749606299
    Selection.ShapeRange.IncrementTop -24.3750393701
    ActiveWindow.SmallScroll Down:=-15
    Range("A2:B2").Select
End Sub
Sub Macro53()
Attribute Macro53.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro53 Macro
'

'
    Range("B21:C32").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5296274
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("B21:C32").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 52176
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A2:B2").Select
End Sub
Sub Macro54()
Attribute Macro54.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro54 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Straight Arrow Connector 228416")).Select
    Selection.ShapeRange.IncrementLeft 2.812519685
    Selection.ShapeRange.IncrementTop -118.1250393701
    ActiveSheet.Shapes.Range(Array("Straight Arrow Connector 228417")).Select
    Range("A2:B2").Select
End Sub
Attribute VB_Name = "Modulo74"
Sub Macro55()
Attribute Macro55.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro55 Macro
'

'
    Range("D28:K32").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Range("A2:B2").Select
End Sub
Sub COLORA_VALORE_AGG_IN_FLUS_CAN()
 Range("D28:K32").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Range("A2:B2").Select
End Sub
Attribute VB_Name = "Modulo75"
Sub classifiche_sostituisci_da2a3()
Attribute classifiche_sostituisci_da2a3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro56 Macro
'

'
Application.ScreenUpdating = False
    Cells.Select
    Selection.Replace What:="ULTIMO (2)'!", Replacement:="ULTIMO (3)'!", _
        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:= _
        False, ReplaceFormat:=False
    Range("L1").Select
    Application.ScreenUpdating = True
End Sub
Sub classifiche_sostituisci_da3a2()
Attribute classifiche_sostituisci_da3a2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro57 Macro
'

'
Application.ScreenUpdating = False
    Cells.Select
    Range("H1").Activate
    Selection.Replace What:="ULTIMO (3)'!", Replacement:="ULTIMO (2)'!", _
        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:= _
        False, ReplaceFormat:=False
    Range("L1").Select
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Modulo76"
Public MacroRunning As Boolean

Sub WRITEONFILEsicurezza()


If MacroRunning = False Then
    
    'Write data to a text file
    'By Christos Samaras
    
    'Declaring variables
    Dim sDrawing As String
    Dim sWeld As String
    Dim sWelder As String
    Dim intSize As Integer
    Dim dDate As Date
    Dim sMaterial As String
    
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lCounter As Long
    Dim lLastRow As Long
    Dim disco As String
    Dim dovesono As Variant
    
    DoEvents
    DoEvents
    DoEvents
    DoEvents
    
     If QUALEDISCO = "" Then
    Exit Sub
    End If
    
    
    dovesono = ActiveCell.Address
    
    
    
 ' disco = InputBox("The letter of disk on wich to save? (without : please)")
  
  
  '----
  ChDir "c:\users\public\"
 

'only allow the user to select one file

'make the file dialog visible to the user

    '----------
    
    'Just showing where the input data are
    'Sheet2.Activate
   ActiveSheet.Range("K1").Select
    
    'Find the last row that contains data
    With ActiveSheet
        lLastRow = .Cells(.Rows.Count, "N").End(xlUp).Row
    End With
    
    '-----
    
    
    
    If QUALEDISCO <> "c" And QUALEDISCO <> "C" Then
   
    SFNAME = QUALEDISCO & ":\" & ActiveSheet.Range("O1") & ".txt"
    
    Else
    SFNAME = "C:\users\public\" & ActiveSheet.Range("O1") & ".txt"
    End If
   
    
    
    
    '------
    
    
    
    'Setting the name and the path of text file based on workbook path
    'sFName = disco & ":\users\public\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
        
    'Get an unused file number
    intFNumber = FreeFile
    
    'Create a new file (or overwrite an existing one)

'MsgBox QUALEDISCO
Open SFNAME For Output As #intFNumber
        
    For lCounter = 1 To lLastRow

     'Read specific data from the worksheet
        With ActiveSheet
        s11 = .Cells(lCounter, 11)
            s12 = .Cells(lCounter, 12)
            s13 = .Cells(lCounter, 13)
            s14 = .Cells(lCounter, 14)
            s15 = .Cells(lCounter, 15)
            s16 = .Cells(lCounter, 16)
            'sMaterial = .Cells(lCounter, 10)
        End With
        
        If s11 = "" Then
        s11 = "-"
        End If
        If s12 = "" Then
        s12 = 0
        End If
        If s13 = "" Then
        s13 = 0
        End If
        If s14 = "" Then
        s14 = 0
        End If
        If s15 = "" Then
        s15 = 0
        End If
        If s16 = "" Then
        s16 = 0
        End If
        
        'Write selected data to text file
        Write #intFNumber, s11, s12, s13, s14, s15, s16
        
    'Continue looping until the last row
    Next lCounter
    
    'Close the text file
    Close #intFNumber
    
    'Inform the user about the process
   ' MsgBox "Values from sheet '" & ActiveSheet.Name & "' were written to '" & sFName & "' file!", vbInformation
   
  Range(dovesono).Select
   
  End If
  
End Sub



Sub WRITEONFILE()
MacroRunning = True



On Error GoTo err

MSG1 = MsgBox("Really do you want save statement ?", vbYesNo, "Save?")

If MSG1 = vbYes Then
    
    'Write data to a text file
    'By Christos Samaras
    
    'Declaring variables
    Dim sDrawing As String
    Dim sWeld As String
    Dim sWelder As String
    Dim intSize As Integer
    Dim dDate As Date
    Dim sMaterial As String
    
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lCounter As Long
    Dim lLastRow As Long
    Dim disco As String
    
    'AGGIUNGENDO TESTO DI NUOVI BILANCI ELIMINARE LE VIRGOLE e i punti e virgola PRIMA DI SALVARE
    
    Columns("K:N").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("o1").Select
    
    Columns("K:N").Select
    Selection.Replace What:=";", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("o1").Select
    
  disco = InputBox("The letter of disk on wich to save? (without : please)")
  
   If disco = "" Then
  Application.Calculation = xlAutomatic
MacroRunning = False
    Exit Sub
End If
  
  '----
  ChDir "c:\users\public\"
 
 
 'If disco <> "c" And disco <> "C" Then
'sFName = disco & ":\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
'Else
 '   sFName = "C:\users\public\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
  '  End If
 
 
 If disco = "" Then
    SFNAME = "C:\users\public\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
    Else
    If disco <> "c" And disco <> "C" Then
SFNAME = disco & ":\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
Else
    SFNAME = "C:\users\public\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
    End If
    End If
 
 
 
'only allow the user to select one file

'make the file dialog visible to the user

With Application.FileDialog(msoFileDialogSaveAs)
.AllowMultiSelect = False
'''.Filters.Add "Text File", "*.txt"
'''.FilterIndex = 1
'''If disco <> "c" And disco <> "C" Then
'''ChDir disco & ":\"
.InitialFileName = SFNAME & ".txt" 'disco & ":\*.txt"
.FilterIndex = 12
'''Else
'ChDir "c:\users\public\"
'''.InitialFileName = "c:\users\public\*.txt"
'''End If


intChoice = .Show
End With

If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
Application.Calculation = xlAutomatic
MacroRunning = False
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath

    '----------
    
    'Just showing where the input data are
    'Sheet2.Activate
    ActiveSheet.Range("k1").Select
    
    'Find the last row that contains data
    With ActiveSheet
        lLastRow = .Cells(.Rows.Count, "N").End(xlUp).Row
    End With
    
    '-----
    
     
    
    
    
    '------
    
    
    
    'Setting the name and the path of text file based on workbook path
    'sFName = disco & ":\users\public\" & ActiveSheet.Range("O1") & "_" & Right(ActiveSheet.Range("O2"), 2) & ".txt"
        
    'Get an unused file number
    intFNumber = FreeFile
    
    'Create a new file (or overwrite an existing one)
    Open SFNAME For Output As #intFNumber
        
    For lCounter = 1 To lLastRow

     'Read specific data from the worksheet
        With ActiveSheet
         s11 = .Cells(lCounter, 11)
            s12 = .Cells(lCounter, 12)
            s13 = .Cells(lCounter, 13)
            s14 = .Cells(lCounter, 14)
            s15 = .Cells(lCounter, 15)
            s16 = .Cells(lCounter, 16)
            'sMaterial = .Cells(lCounter, 10)
        End With
        
        
        If s11 = "" Then
        s11 = "-"
        End If
        If s12 = "" Then
        s12 = 0
        End If
        If s13 = "" Then
        s13 = 0
        End If
        If s14 = "" Then
        s14 = 0
        End If
        If s15 = "" Then
        s15 = 0
        End If
        If s16 = "" Then
        s16 = 0
        End If
        
        'Write selected data to text file
        Write #intFNumber, s11, s12, s13, s14, s15, s16
        
    'Continue looping until the last row
    Next lCounter
    
    'Close the text file
    Close #intFNumber
    
    'Inform the user about the process
    MsgBox "Values from sheet '" & ActiveSheet.Name & "' were written to '" & SFNAME & "' file!", vbInformation
   
   Else
   End If
   Application.Calculation = xlAutomatic
MacroRunning = False

  Exit Sub
  Application.Calculation = xlAutomatic
MacroRunning = False

err: MsgBox "wrong disk letter?"
End Sub



Sub READFILE()

On Error GoTo err
MacroRunning = True
Application.ScreenUpdating = False
Sheets("full screening").Range("N16").FormulaLocal = "=+'CE1'!F59"
Sheets("full screening").Range("O16").FormulaLocal = "=+'CE1'!G59"


Application.Calculation = xlManual


    
    'To read "string" data, the string must be split in order to locate the values
    'By Christos Samaras
    
    'Declaring variables
    Dim sLine As String
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lRow As Long
    Dim lColumn As Long
    Dim vDataValues As Variant
    Dim intCount As Integer
    Dim disco As String
    Dim MIONOME2
    Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If
    
    
  disco = InputBox("The letter of disk from wich to read? (without : please)")
  
  If disco = "" Then
  Application.Calculation = xlAutomatic
MacroRunning = False
    Exit Sub
End If
    
    'The full path of the text file that will be opened
    '''sFName = disco & ":\users\public\PROVARE.txt"
    
    '----------
    Dim intChoice As Integer
Dim strPath As String


ChDir "c:\users\public\"
 

'only allow the user to select one file

'make the file dialog visible to the user

With Application.FileDialog(msoFileDialogOpen)
.AllowMultiSelect = False
.Filters.Add "Text File", "*.txt"
.FilterIndex = 1
If disco <> "c" And disco <> "C" Then
ChDir disco & ":\"
.InitialFileName = disco & ":\*.txt"
Else
'ChDir "c:\users\public\"
.InitialFileName = "c:\users\public\*.txt"
End If


intChoice = .Show
End With


   
    

'determine what choice the user made
If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
Application.Calculation = xlAutomatic
MacroRunning = False
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath
    '----------
    
    
    'FA SCOMPARIRE L'APPLICAZIONE E METTE CURSORE DI ATTESA
   ' Application.Visible = False
DoEvents
' MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
    Application.Cursor = xlWait
DoEvents
    
    'CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI
Application.Calculation = xlManual


Application.ScreenUpdating = False

    Range("O1:P1").Select
    Selection.ClearContents
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "12/31/2016"
    Range("P2").Select
    ActiveCell.FormulaR1C1 = "12/31/2015"
    Range("O3:P6029").Select
    Selection.ClearContents
    Range("Q1").Select
    
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
'FINE CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI
    
  On Error GoTo 0
  On Error Resume Next
  
    
 
 Workbooks.OpenText Filename:= _
        SFNAME, Origin:=xlWindows, _
        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=False _
        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
    Workbooks.Open Filename:= _
        SFNAME
        DoEvents
         MIONOME2 = Application.ActiveWorkbook.Name
         DoEvents
    Columns("A:A").Select
    Selection.Replace What:=",", Replacement:=";", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), _
        TrailingMinusNumbers:=True
      

    Columns("A:F").Select
        
    Selection.Copy
 
  
  
    Windows(MIONOME).Activate
    DoEvents
    
    Range("k1").Select
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("K1").Select
    
Windows(MIONOME2).Activate
DoEvents
    ActiveWindow.Close
    DoEvents
    
  
    
    Windows(MIONOME).Activate
    DoEvents
    
    
    
    '------
    Columns("L:P").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="#", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("K1").Select
    
    '------
       
      
       
    
    Columns("K:K").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("K1").Select
    
    Columns("N:N").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("o1").Select
    
    If Range("O3") > 0 Then
    GoTo DOPO
    Else
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
DOPO:
    End If
     If Range("P3") > 0 Then
     GoTo AUANTI
     Else
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
AUANTI:
        End If
        Range("P1").Select
    
    Application.Calculation = xlAutomatic
    
    Application.ScreenUpdating = True
    
    Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    'Application.Visible = True
    DoEvents
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    'messo da poco richiamo all'aggiornamento perch|fffd| stampavo il report con il lite non aggiornato
    Sheets("COVER").Range("IA1") = 2
    DoEvents
    Sheets("COVER").ComboBox3.Value = Sheets("INPUT Statement").Range("O1")
DoEvents
    aggiornare
    DoEvents
    
    'Inform the user about the process
    MsgBox "Values from file '" & SFNAME & "' were imported to sheet '" & ActiveSheet.Name & "'!", vbInformation
    MacroRunning = False
    Application.CutCopyMode = False
Exit Sub
err: MsgBox "wrong disk letter?"
Application.Calculation = xlAutomatic
MacroRunning = False
Application.ScreenUpdating = True
Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    'Application.Visible = True
    DoEvents
Application.CutCopyMode = False
End Sub

'*****************
Sub READFILE2()

On Error GoTo err
MacroRunning = True
Application.ScreenUpdating = False
Sheets("full screening").Range("N16").FormulaLocal = "=+'CE1'!F59"
Sheets("full screening").Range("O16").FormulaLocal = "=+'CE1'!G59"
Application.Calculation = xlManual


    
    'To read "string" data, the string must be split in order to locate the values
    'By Christos Samaras
    
    'Declaring variables
    Dim sLine As String
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lRow As Long
    Dim lColumn As Long
    Dim vDataValues As Variant
    Dim intCount As Integer
    Dim disco As String
    Dim MIONOME2
    Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If
    
    
  disco = InputBox("The letter of disk from wich to read? (without : please)")
  
  If disco = "" Then
  Application.Calculation = xlAutomatic
MacroRunning = False
    Exit Sub
End If
    
    'The full path of the text file that will be opened
    '''sFName = disco & ":\users\public\PROVARE.txt"
    
    '----------
    Dim intChoice As Integer
Dim strPath As String


ChDir "c:\users\public\"
 

'only allow the user to select one file

'make the file dialog visible to the user

With Application.FileDialog(msoFileDialogOpen)
.AllowMultiSelect = False
.Filters.Add "Text File", "*.txt"
.FilterIndex = 1
If disco <> "c" And disco <> "C" Then
ChDir disco & ":\"
.InitialFileName = disco & ":\*.txt"
Else
'ChDir "c:\users\public\"
.InitialFileName = "c:\users\public\*.txt"
End If


intChoice = .Show
End With


   
    

'determine what choice the user made
If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
Application.Calculation = xlAutomatic
MacroRunning = False
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath
    '----------
    
    
    'FA SCOMPARIRE L'APPLICAZIONE E METTE CURSORE DI ATTESA
   ' Application.Visible = False
DoEvents
' MsgBox "WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)"
    Application.Cursor = xlWait
DoEvents
    
    
    Sheets("INPUT Statement").ListBox1.Height = 1.65
Sheets("INPUT Statement").ListBox1.Width = 2
    xinp = 1
    Sheets("INPUT Statement").Activate
    Range("O1").Select
    
    
    
    
    
    'CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI
Application.Calculation = xlManual


Application.ScreenUpdating = False

    Range("O1:P1").Select
    Selection.ClearContents
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "12/31/2016"
    Range("P2").Select
    ActiveCell.FormulaR1C1 = "12/31/2015"
    Range("O3:P3029").Select
    Selection.ClearContents
    Range("Q1").Select
    
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
'FINE CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI
    
  On Error GoTo 0
  On Error Resume Next
  
    
 
 Workbooks.OpenText Filename:= _
        SFNAME, Origin:=xlWindows, _
        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=False _
        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
    Workbooks.Open Filename:= _
        SFNAME
        DoEvents
         MIONOME2 = Application.ActiveWorkbook.Name
         DoEvents
    Columns("A:A").Select
    Selection.Replace What:=",", Replacement:=";", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=".", Replacement:=",", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), _
        TrailingMinusNumbers:=True
      

    Columns("A:F").Select
        
    Selection.Copy
 
  ActiveWindow.Visible = False
  
    Windows(MIONOME).Activate
    DoEvents
    
    Range("k1").Select
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("K1").Select
    
    
    
    Windows(MIONOME2).Close
'''Windows(MIONOME2).Activate
'''DoEvents
    '''ActiveWindow.Close
    DoEvents
    
  
    
   ''' Windows(MIONOME).Activate
   ''' DoEvents
    
    
    
    '------
    Columns("L:P").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="#", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("K1").Select
    
    '------
       
      
       
    
    Columns("K:K").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("K1").Select
    
    Columns("N:N").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("o1").Select
    
    If Range("O3") > 0 Then
    GoTo DOPO
    Else
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
DOPO:
    End If
     If Range("P3") > 0 Then
     GoTo AUANTI
     Else
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
AUANTI:
        End If
        Range("P1").Select
    
    
    Application.ScreenUpdating = False
    
    '^^^^^^^^^^^^^^^^^^^^^
    Sheets("COVER").Activate
    Pulsantediopzione22_Click
    '^^^^^^^^^^^^^^^^^^^^^^^^
    
    Application.Sheets("COVER").TextBox1.Visible = False
    
    Application.Calculation = xlAutomatic
    
    Application.ScreenUpdating = True
    
    Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    'Application.Visible = True
    DoEvents
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    'Inform the user about the process
    MsgBox "Values from file '" & SFNAME & "' were imported and you can choose it in the combobox below " '!", vbInformation
    MacroRunning = False
    
    Application.CutCopyMode = False
    
Exit Sub
err: MsgBox "wrong disk letter?"
Application.Calculation = xlAutomatic
MacroRunning = False
Application.ScreenUpdating = True
Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
    'Application.Visible = True
    DoEvents
    Application.CutCopyMode = False

End Sub

'----********------***************--------------
'*****************
Sub READFILE222()

On Error GoTo err
MacroRunning = True
Application.ScreenUpdating = False
DoEvents
'''Sheets("full screening").Range("N16").FormulaLocal = "=+'CE1'!F59"
'''Sheets("full screening").Range("O16").FormulaLocal = "=+'CE1'!G59"
Application.Calculation = xlManual


    
    'To read "string" data, the string must be split in order to locate the values
    'By Christos Samaras
    
    'Declaring variables
    Dim sLine As String
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lRow As Long
    Dim lColumn As Long
    Dim vDataValues As Variant
    Dim intCount As Integer
    Dim disco As String
    Dim MIONOME2
    Dim MIONOME
    Dim MIONOME3
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
MIONOME3 = Application.ActiveWorkbook.Name
Else
MIONOME = Application.ActiveWorkbook.Name
MIONOME3 = Application.ActiveWorkbook.Name
End If
    
    
'''  disco = InputBox("The letter of disk from wich to read? (without : please)")
  
 ''' If disco = "" Then
 ''' Application.Calculation = xlAutomatic
'''MacroRunning = False
  '''  Exit Sub
'''End If
    
    'The full path of the text file that will be opened
    '''sFName = disco & ":\users\public\PROVARE.txt"
    
    '----------
    Dim intChoice As Integer
Dim strPath As String

Dim paths As String
   paths = ActiveWorkbook.Path
'ChDir "c:\users\public\"
ChDir paths
 

'only allow the user to select one file

'make the file dialog visible to the user

'''With Application.FileDialog(msoFileDialogOpen)
'''.AllowMultiSelect = False
'''.Filters.Add "Text File", "*.txt"
'''.FilterIndex = 1
'''If disco <> "c" And disco <> "C" Then
'''ChDir disco & ":\"
'''.InitialFileName = disco & ":\*.txt"
'''Else
'ChDir "c:\users\public\"
'''.InitialFileName = "c:\users\public\*.txt"
'''End If
'''intChoice = .Show
'''End With


   
    

'determine what choice the user made
'''If intChoice <> 0 Then
'get the file path selected by the user
'''strPath = Application.FileDialog( _
'''msoFileDialogOpen).SelectedItems(1)
'''Else
'''Application.Calculation = xlAutomatic
'''MacroRunning = False
'''        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
'''End If

''' sFName = strPath


SFNAME = paths & "\testoASB.txt"
    '----------
    
    
    'FA SCOMPARIRE L'APPLICAZIONE E METTE CURSORE DI ATTESA
    'Application.Visible = False
DoEvents
 ''MsgBox "Mi nascondo un attimo poi ritorno! (Clickare OK per continuare..) - WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)- I files Txt richiedono qualche secono in pi|fffd| di attesa The txt files require some second more waiting"
    Application.Cursor = xlWait
DoEvents
    
    
    '''Sheets("INPUT Statement").ListBox1.Height = 1.65
    '''Sheets("INPUT Statement").ListBox1.Width = 2
    
    xinp = 1
    Application.Sheets("INPUT Statement").Activate
    DoEvents
    Application.Sheets("INPUT Statement").ListBox1.Height = 1.65
    Application.Sheets("INPUT Statement").ListBox1.Width = 2
    DoEvents
    
    Range("O1").Select
    
    
    
    
    
    'CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI
Application.Calculation = xlManual


Application.ScreenUpdating = False
DoEvents

   ' Range("O1:P1").Select
    'Selection.ClearContents
    'Range("O1").Select
    'ActiveCell.FormulaR1C1 = "NAME"
    'Range("P1").Select
    'ActiveCell.FormulaR1C1 = "NAME"
    'Range("O2").Select
    'ActiveCell.FormulaR1C1 = "12/31/2018"
    'Range("P2").Select
    'ActiveCell.FormulaR1C1 = "12/31/2017"
    Range("O800:P6029").Clear
    'Selection.ClearContents
    'Range("Q1").Select
    
    'Range("O3").Select
    'ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    'Range("P3").Select
    'ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    'Range("P1").Select
'FINE CANCELLA DATI PRECEDENTI EVENTUALMENTE PRESENTI

DoEvents
DoEvents
DoEvents
    
  On Error GoTo 0
  On Error Resume Next
  
    
 
' Workbooks.OpenText Filename:= _
       SFNAME, Origin:=xlWindows, _
        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=False _
        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
        
        
        Workbooks.OpenText Filename:= _
        SFNAME, Origin:=xlWindows, _
        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        Semicolon:=True ', ConsecutiveDelimiter:=False,Tab:=False, Comma:=False _
        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
        
        
        '''ActiveWindow.WindowState = xlMinimized
        DoEvents
         
DoEvents
DoEvents


'Stop


 '''TOLTO ADESSO NELLE PROVE X TABLET NON SO COSA SERVIVA  Workbooks.Open Filename:= _
       ' SFNAME
       
         
  
        
        'MsgBox "Fase 1 importazione dati. Please press ok"
        
        Application.ScreenUpdating = False
        
         MIONOME2 = Application.ActiveWorkbook.Name
         DoEvents
         
         
         
ActiveSheet.Columns("A").Replace _
 What:=",", Replacement:=";", _
 SearchOrder:=xlByRows, MatchCase:=False
  DoEvents
ActiveSheet.Columns("A").Replace _
 What:=".", Replacement:=",", _
 SearchOrder:=xlByRows, MatchCase:=False
          DoEvents
         
    'Columns("A").Select
     '   Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), _
        TrailingMinusNumbers:=True
        
        
         Dim rng As Range
    Dim sh As Worksheet

    Set sh = ActiveWorkbook.Worksheets("testoASB")
    With sh
        Set rng = .Columns("A")
        Set rng = .Range(rng, .Cells(.Rows.Count, rng.Column).End(xlUp))

        rng.TextToColumns Destination:=rng, DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, _
        Tab:=False, _
        Semicolon:=True, _
        Comma:=False, _
        Space:=False, _
        Other:=False, _
        FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1)), _
        TrailingMinusNumbers:=True
    End With
      
      
      DoEvents
DoEvents
DoEvents



'SOSTITUITO IL PRECEDENTE SELECT TROPPO LENTO
 
   
Workbooks(MIONOME2).Worksheets("testoASB").Range("A1:F6000").Copy Workbooks(MIONOME3).Worksheets("INPUT Statement").Range("K1")
    
   

  '''''  Range("A1:F6000").Select
        
   ''''' Selection.Copy
 
  ''ActiveWindow.Visible = False
 ''' ActiveWindow.WindowState = xlMinimized
    '''''Windows(MIONOME).Activate
   ''' ActiveWindow.WindowState = xlMinimized
    DoEvents
    
   ''''' Range("k1").Select
    
   ''''' Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
     '''''   :=False, Transpose:=False
   ''''' Range("K1").Select
    
    DoEvents
    Application.DisplayAlerts = False
DoEvents
DoEvents
    
    Windows(MIONOME2).Close
'''Windows(MIONOME2).Activate
'''DoEvents
    '''ActiveWindow.Close
    DoEvents
    DoEvents
    Application.ScreenUpdating = False
DoEvents
DoEvents
  
'''ActiveWindow.WindowState = xlMinimized
    
   ''' Windows(MIONOME).Activate
   ''' DoEvents
    'MsgBox "Fase 2: preparazione dati. Please press ok!"
    
    
    '------ HO SOSTITUITO LA L CON IL K PER ELIMINARE LE RIGHE SOTTO
    
    'SOSTITUITO IL PRECEDENTE SELECT TROPPO LENTO
    ActiveSheet.Range("K1:P6000").Replace _
 What:="""", Replacement:="", _
 SearchOrder:=xlByRows, MatchCase:=False
  DoEvents
    
    'Range("K1:P6000").Select
    'Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
     '   SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
      '  ReplaceFormat:=False
        DoEvents
DoEvents
DoEvents

'SOSTITUITO IL PRECEDENTE SELECT TROPPO LENTO anche sotto gli altri..
ActiveSheet.Range("L1:P6000").Replace _
 What:="#", Replacement:="", _
 SearchOrder:=xlByRows, MatchCase:=False
  DoEvents

'Range("L1:P6000").Select
 '   Selection.Replace What:="#", Replacement:="", LookAt:=xlPart, _
  '      SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
   '     ReplaceFormat:=False
        DoEvents
        
       ' MsgBox "Mi nascondo un attimo poi ritorno! (Clickare OK per continuare..) - WAIT A MOMENT PLEASE: I DISAPPEAR FOR A FEW SECONDS AND THEN I GO BACK! (Click Ok please)- I files Txt richiedono qualche secono in pi|fffd| di attesa The txt files require some second more waiting"
        'Application.Visible = False
  DoEvents
  Application.ScreenUpdating = False
        DoEvents
        
DoEvents
DoEvents
    'Range("K1").Select
    DoEvents
DoEvents
DoEvents
    '------
       
      
       
    
    'Columns("K:K").Select
    'Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
     '   SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
      '  ReplaceFormat:=False
    DoEvents
DoEvents
DoEvents
    'Range("K1").Select
    
    
    'AVENDO CAMBIATO SOPRA LA VIRGOLA COL PUNTOEVIRGOLA NON CI SONO PIU VIRGOLE QUINDI QUESTE RIGHE SOTTO NON SERVONO
    'Columns("N:N").Select
    'Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
     '   SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
      '  ReplaceFormat:=False
    
  DoEvents
DoEvents
DoEvents
    Range("o1").Select
    
    If Range("O3") > 0 Then
    GoTo DOPO
    Else
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
DOPO:
    End If
     If Range("P3") > 0 Then
     GoTo AUANTI
     Else
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
AUANTI:
        End If
        Range("P1").Select
    
    
    
    
     ''' Application.ScreenUpdating = False
    
    
    
    On Error Resume Next
   'CANCELLA IL FILE DI TESTO
   Dim TEST
      TEST = Dir(SFNAME)
      DoEvents
If Not TEST = "" Then
If SFNAME = paths & "\testoASB.txt" Then
DoEvents
    Kill (SFNAME)
    DoEvents
    DoEvents
DoEvents
DoEvents
    End If
    DoEvents
End If
   
   



    '^^^^^^^^^^^^^^^^^^^^^
    Application.Sheets("COVER").Activate
    DoEvents
    Application.ScreenUpdating = False
    
    '''Pulsantediopzione22_Click
    '^^^^^^^^^^^^^^^^^^^^^^^^
    
    Application.Sheets("COVER").TextBox1.Visible = False
    
   ' Application.Calculation = xlAutomatic
    
    '''Application.ScreenUpdating = True
    
    Application.Cursor = xlDefault          ' Puntatore normale
    '''Application.ScreenUpdating = True
    DoEvents
   'Application.Visible = True
    DoEvents
    
    
    
    'MsgBox "Fase 3: elaborazione. Please press ok!"
    
    
    
    
    
    
    
    
    
    
    
    DoEvents
DoEvents
DoEvents
    
    'Inform the user about the process
    ''MsgBox "Values from file '" & SFNAME & "' were imported and you can choose it in the combobox below " '!", vbInformation
    MacroRunning = False
    
    Application.CutCopyMode = False
    
Exit Sub
err:

Application.Visible = True
MsgBox "Problema nella lettura del file .txt?"
    DoEvents
Application.Calculation = xlAutomatic
MacroRunning = False
Application.ScreenUpdating = True
Application.Cursor = xlDefault          ' Puntatore normale
    Application.ScreenUpdating = True
    DoEvents
        Application.CutCopyMode = False


DoEvents
DoEvents
DoEvents

End Sub

Attribute VB_Name = "Modulo77"
Sub Macro58()
Attribute Macro58.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro58 Macro
'

'
End Sub
Attribute VB_Name = "Modulo78"
Sub virgola()
Attribute virgola.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro56 Macro
'

'
    With Application
        .DecimalSeparator = ","
        .ThousandsSeparator = "."
    End With
    
End Sub

Sub punto()
'
' Macro56 Macro
'

'
   
    With Application
        .DecimalSeparator = "."
        .ThousandsSeparator = ","
    End With
End Sub

Attribute VB_Name = "Modulo79"
Sub CLEARDATASTATEMENT()
Attribute CLEARDATASTATEMENT.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro56 Macro
'

'
MacroRunning = True

MSG1 = MsgBox("Really do you want clear data ?", vbYesNo, "Clear?")

If MSG1 = vbYes Then
  
Application.Calculation = xlManual


Application.ScreenUpdating = False

    Range("O1:P1").Select
    Selection.ClearContents
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "12/31/2018"
    Range("P2").Select
    ActiveCell.FormulaR1C1 = "12/31/2017"
    Range("O3:P6029").Select
    Selection.ClearContents
    Range("Q1").Select
    
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
        
    
     MSG1 = ""
    MSG1 = MsgBox("Really do you want also  restore code & accounts ?", vbYesNo, "Restore?")

If MSG1 = vbYes Then
        
        
        
    READFILEcodeaccounts
    Columns("K:K").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
                
    Range("K1").Select
      
      Else
      End If
    
    
    
    
    Application.ScreenUpdating = True
    
    Else
    End If
    Application.Calculation = xlAutomatic
MacroRunning = False

End Sub
Attribute VB_Name = "Modulo8"
Sub WriteTextFile()
    MsgBox "Attenzione che i dati della vostra carta di credito vengono salvati nella directory pubblica di questo computer, seppure dopo averli leggermente modificati per sicurezza! Prestate attenzione che il computer sia solo a Vostro uso personale oppure cancellate i 2 files c:\users\public\pubtemp1.txt e  c:\users\public\pubtemp2.txt dopo l'uso !"
    MsgBox "Warning that the data of your credit card are saved in the public directory of this computer, even after they have been slightly modified to safety! Make sure that the computer is only your personal use or delete the two files c: \ users \ public \ pubtemp1.txt c: \ users \ public \ pubtemp2.txt after use!"
    'Write data to a text file
    'By Christos Samaras
    
    'Declaring variables
    Dim sDrawing As String
    Dim sWeld As String
    Dim sWelder As String
    Dim intSize As Integer
    Dim dDate As Date
    Dim sMaterial As String
    
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lCounter As Long
    Dim lLastRow As Long
    
    'Just showing where the input data are
'    activeworksheet.Activate
    Range("A1").Select
    
    'Find the last row that contains data
    With ActiveSheet
        lLastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    End With
    
    'Setting the name and the path of text file based on workbook path
    SFNAME = "c:\users\public\pubtemp1.txt"
        
    'Get an unused file number
    intFNumber = FreeFile
    
    'Create a new file (or overwrite an existing one)
    Open SFNAME For Output As #intFNumber
        
    '''For lCounter = 1 To 2

     'Read specific data from the worksheet Sheets("BUY ITALIAN ANNUAL REPORT")
        With ActiveSheet
        If .Range("b9") <> "" Then
            sDrawing = .Range("b9")
            Write #intFNumber, sDrawing
            End If
            If .Range("c9") <> "" Then
            sDrawing = .Range("c9")
            Write #intFNumber, sDrawing
            End If
            
             If .Range("b11") <> "" Then
            sDrawing = .Range("b11")
            Write #intFNumber, sDrawing
            End If
            If .Range("c11") <> "" Then
            sDrawing = .Range("c11")
            Write #intFNumber, sDrawing
            End If
             'Close the text file
    'Close #intFNumber
            'MsgBox "scritto nulla"
            
            'Exit Sub
                       
            
            'sWeld = .Cells(lCounter, 3)
           ' sWelder = .Cells(lCounter, 4)
            'intSize = .Cells(lCounter, 5)
            'dDate = .Cells(lCounter, 7)
            'sMaterial = .Cells(lCounter, 10)
        End With
        
        'Write selected data to text file
        'Write #intFNumber, sDrawing    ', sWeld, sWelder, intSize, dDate, sMaterial
        
    'Continue looping until the last row
    '''Next lCounter
    
    'Close the text file
    Close #intFNumber
    
    'Inform the user about the process
    MsgBox "Values from sheet '" & ActiveSheet.Name & "' were written to '" & SFNAME & "' file!", vbInformation
  '-------------------------------
   'Setting the name and the path of text file based on workbook path
    SFNAME = "c:\users\public\pubtemp2.txt"
        
    'Get an unused file number
    intFNumber = FreeFile
    
    'Create a new file (or overwrite an existing one)
    Open SFNAME For Output As #intFNumber
        
    '''For lCounter = 1 To 2

     'Read specific data from the worksheet Sheets("BUY ITALIAN ANNUAL REPORT")
        With ActiveSheet
        If .Range("h12") <> "" Then
        If .Range("h12") > 90 Then
        sDrawing = .Range("h12") + 58
        Else
            sDrawing = .Range("h12")
            End If
            Write #intFNumber, sDrawing
            End If
            If .Range("j12") <> "" Then
            If Val(.Range("j12")) > 9 * 1259 Then
            sDrawing = CStr(Format(Val(Left(.Range("j12"), Len(.Range("j12")) - 1)) + 1259, 0)) & CStr(Right(.Range("j12"), 1)) 'CStr(Format(Val(.Range("j12")) + 1259, 0))
            
        
            Else
            sDrawing = CStr(.Range("j12"))
            End If
            Write #intFNumber, sDrawing
            End If
            End With
     
    Close #intFNumber
    
    'Inform the user about the process
    MsgBox "Values from sheet '" & ActiveSheet.Name & "' were written to '" & SFNAME & "' file!", vbInformation
  
  
End Sub

Sub ReadTextFile()

    'Read data from a text file
    'By Christos Samaras
    
    'Declaring variables
    Dim sDrawing As String
    Dim sWeld As String
    Dim sWelder As String
    Dim intSize As Integer
    Dim dDate As Date
    Dim sMaterial As String
    
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lRow As Long
    
    'The full path of the text file that will be opened
    SFNAME = "c:\users\public\pubtemp1.txt"
    
    'Get an unused file number
    intFNumber = FreeFile
    
    On Error Resume Next
    
    'Prepare text file for reading
    Open SFNAME For Input As #intFNumber
    
    'Check if the text file was found
    If err.Number <> 0 Then
        MsgBox "Non hai ancora salvato Nome, Email e dati Carta di Credito; You have not saved Name, Email and Credit card data ", vbCritical, "Error!"
        Exit Sub
    End If
    
    On Error GoTo 0

    
    'Clearing the sheet
    'ActiveSheet.Cells.Clear
    
    lRow = 1
    
    'Loop until the end of file
    'Do While Not EOF(intFNumber)
        
        'Read data from the text file
'        Input #intFNumber, sDrawing      ', sWeld, sWelder, intSize, dDate, sMaterial

        'Write selected data to the worksheet
        With ActiveSheet
            '.Cells(lRow, 1) = sDrawing
           ' .Range("b9") = sDrawing
          '  .Range("c9") = sDrawing
           ' .Range("b11") = sDrawing
           ' .Range("c11") = sDrawing
            '.Cells(lRow, 2) = sWeld
            '.Cells(lRow, 3) = sWelder
            '.Cells(lRow, 4) = intSize
            '.Cells(lRow, 5) = dDate
            '.Cells(lRow, 6) = sMaterial
            
            Input #intFNumber, sDrawing
            If .Range("b9") = "" Then
            .Range("b9") = sDrawing
             End If
             Input #intFNumber, sDrawing
            If .Range("C9") = "" Then
            .Range("C9") = sDrawing
             End If
            Input #intFNumber, sDrawing
             If .Range("b11") = "" Then
            .Range("b11") = sDrawing
             End If
             Input #intFNumber, sDrawing
            If .Range("C11") = "" Then
            .Range("C11") = sDrawing
             End If
            
            
            
            
        End With

        'Address next row of worksheet
        lRow = lRow + 1

    'Loop
      
    'Close the text file
    Close #intFNumber
        
    'Fitting column width
    'ActiveSheet.Cells.EntireColumn.AutoFit

    'Just showing where the output data are
    ActiveSheet.Activate
    Range("A1").Select
    
    'Inform the user about the process
    MsgBox "Values from file '" & SFNAME & "' were imported to sheet '" & ActiveSheet.Name & "'!", vbInformation
'---------------------

 SFNAME = "c:\users\public\pubtemp2.txt"
    
    'Get an unused file number
    intFNumber = FreeFile
    
    On Error Resume Next
    
    'Prepare text file for reading
    Open SFNAME For Input As #intFNumber
    
    'Check if the text file was found
    If err.Number <> 0 Then
            MsgBox "Non hai ancora salvato Nome, Email e dati Carta di Credito; You have not saved Name, Email and Credit card data ", vbCritical, "Error!"
        Exit Sub
    End If
    
    On Error GoTo 0
       
    
        With ActiveSheet
                     On Error GoTo 88
            Input #intFNumber, sDrawing
            
            If .Range("h12") = "" Then
            If sDrawing > 90 Then
             .Range("h12") = sDrawing - 58
             Else
            .Range("h12") = sDrawing
            End If
             End If
             
             Input #intFNumber, sDrawing
            If .Range("j12") = "" Then
            If Val(sDrawing) > 9 * 1259 Then
            .Range("j12") = CStr(Format(Val(Left(sDrawing, Len(sDrawing) - 1)) - 1259, 0)) & CStr(Right(sDrawing, 1))
            Else
            .Range("j12") = CStr((sDrawing))
            End If
             End If
            End With
     'Close the text file
88
    Close #intFNumber
    ActiveSheet.Activate
    Range("A1").Select
    
    'Inform the user about the process
    MsgBox "Values from file '" & SFNAME & "' were imported to sheet '" & ActiveSheet.Name & "'!", vbInformation


End Sub


Attribute VB_Name = "Modulo80"
Public premutoprimopulsante
Public III As Variant
Public IIII As Variant
Public VII As Variant
Public II As Variant
Public WrdArray() As String
Public lPid2 As Long, hwnd2 As Long



Sub selectaccountsstatement()
levafiltro

Dim MyClipObj As New DataObject
    Dim c As Range
    Dim obj As New DataObject
    Dim pval As String
    Dim ce
    Dim pv
    Dim pv2
    Dim pv3
    Dim pval2 As String
    Dim strg
    Dim strg2
    Dim pippo
    
    strg2 = "properties"
    
     
     
     
On Error Resume Next

     'Temporarily save clipboard data
    obj.GetFromClipboard
    pval = obj.GetText
    'MsgBox pval
    If pval = "" Then Exit Sub
     
        
    pval = Replace(pval, "|fffd|", "")
    ' pval = Replace(pval, "l", "")
    
     pval = Replace(pval, "_", " ")
     pval = Replace(pval, "/", " ")
    
    pval = Replace(pval, ",", "")
    'pval = Replace(pval, "(", "")
   ' pval = Replace(pval, ")", "")
    pval = Replace(pval, ".", "")
     'pval = Replace(pval, "I", "")
     pval = Replace(pval, "|", "")
     pval = Replace(pval, "[", "")
     pval = Replace(pval, "]", "")
     pval = Replace(pval, "'", "")
      pval = Replace(pval, "I", "")
      
      pval = Replace(pval, Chr(10), " ")
     '--------
     
'MsgBox pval

'Dim WrdArray2() As String


WrdArray() = Split(pval, " ")

premutoprimopulsante = 1
Dim s1 As String
    Dim s2 As String
    Dim pos As Integer
    

For I = LBound(WrdArray) To UBound(WrdArray)
 If IsNumeric(Mid(WrdArray(I), 2, 1)) = True Then
 'pval = Replace(pval, "-", "")
    
   WrdArray(I) = Replace(WrdArray(I), "|fffd|", "")
    WrdArray(I) = Replace(WrdArray(I), "l", "")
    
    WrdArray(I) = Replace(WrdArray(I), "_", " ")
    WrdArray(I) = Replace(WrdArray(I), "/", " ")
    
   WrdArray(I) = Replace(WrdArray(I), ",", "")
    ' WrdArray(I) = Replace(wrdarray(I), "(", "")
   'wrdarray(I) = Replace(wrdarray(I), ")", "")
   WrdArray(I) = Replace(WrdArray(I), ".", "")
    WrdArray(I) = Replace(WrdArray(I), "I", "")
    WrdArray(I) = Replace(WrdArray(I), "|", "")
    WrdArray(I) = Replace(WrdArray(I), "[", "")
    WrdArray(I) = Replace(WrdArray(I), "]", "")
    End If
    Next I
    
    
 
     
 
inizio:


'For I = LBound(WrdArray) To UBound(WrdArray)
  'strg = WrdArray(I)
  
  'MsgBox WrdArray(III)
 If WrdArray(III) = " " Then
 'WrdArray(I) = WrdArray(I - 1)
 III = III + 1
End If
  
  
   If Len(WrdArray(III)) < 4 Then
   If WrdArray(III) <> "Tax" Then
   If WrdArray(III) <> "tax" Then
   If WrdArray(III) <> "TAX" Then
   
     III = III + 1 'WrdArray(I) = WrdArray(I - 1)
    End If
    End If
    End If
    End If
    
    
   'MsgBox WrdArray(III)
   
   'If IsNumeric(WrdArray(III)) = False Then
   If IsNumeric(Mid(WrdArray(III), 2, 1)) = False Then
 WrdArray(III) = "*" & WrdArray(III) & "*"
 Else
 
 Do While IsNumeric(Mid(WrdArray(III), 2, 1)) = True Or WrdArray(III) = " " Or Len(WrdArray(III)) < 2
 
 If III < UBound(WrdArray) Then
        III = III + 1
    If Len(WrdArray(III)) > 2 Then
       WrdArray(III) = "*" & WrdArray(III) & "*"
       End If
       
       pippo = 1
        Else
        III = 0
        Call levafiltro
                Exit Sub
        End If
 
  Loop
  If pippo = 1 Then
  pippo = 0
  GoTo restadentro
  End If
  'MsgBox III
 Exit Sub
 End If
 
'  End If

restadentro:

'Next I

'For I = LBound(WrdArray) To UBound(WrdArray)
 'MsgBox WrdArray(0)
' Next I
     
     '---------
     
     
   '''  pos = InStr(WrdArray(III), "-")
   ''' If pos > 0 Then
   ''' If WrdArray(III) <> "-" Then
    '''  s1 = Left(WrdArray(III), pos - 1)
    '''  s2 = Right(WrdArray(III), pos - 2)
      'MsgBox s1
      ' MsgBox s2
'WrdArray(I) = Replace(WrdArray(I), "-", " ")
'''With ActiveSheet
         '''   .AutoFilterMode = False
         '''   .Range("l:p").AutoFilter
'''.Range("n:n").AutoFilter Field:=3, Criteria1:=Array(s1, s2), Operator:=xlFilterValues
'''MsgBox WrdArray(III)
    '''End With
    '''End If
     
     '''Else

If WrdArray(III) <> "" And WrdArray(III) <> "**" Then

ActiveSheet.Range("l:p").AutoFilter Field:=2, Criteria1:=("<>-"), Operator:=xlFilterValues
    ActiveSheet.Range("l:p").AutoFilter Field:=3, Criteria1:=(WrdArray(III)), Operator _
        :=xlFilterValues


If IsNumeric(Mid(WrdArray(III), 3, 1)) = True Then
        Exit Sub
        End If

        
  MSG1 = MsgBox(WrdArray(III) & " Ok this ?", vbYesNoCancel, "?")
   If MSG1 = vbYes Then
   
   For III = III To UBound(WrdArray) 'LBound(WrdArray) To UBound(WrdArray)
  'strg = WrdArray(I)
     If IsNumeric(Mid(WrdArray(III), 2, 1)) = True Then
        Exit Sub
        End If
        Next III
   End If
   
   If MSG1 = vbNo Then
   '' GoTo inizio2
   End If
   
    If MSG1 = vbCancel Then
'''levafiltro
Exit Sub
End If

   
    End If
    
   ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' End If
   ' If IsNumeric(Mid(WrdArray(III + 1), 2, 1)) = True Then
    
    'III = 0
    'Exit Sub
    ' End If
    
    'MsgBox WrdArray(III + 1)
    
''inizio2:
    
        If III < UBound(WrdArray) Then
        III = III + 1
   Else
        III = 0
        ''Exit Sub
        End If
        
        GoTo inizio
        
        
End Sub

Sub levafiltro()
With ActiveSheet

            .AutoFilterMode = False

            .Range("l:p").AutoFilter

            '.Range("n:n").AutoFilter Field:=3, Criteria1:="*" & pval & "*"

    End With
    III = 0
    
End Sub

Sub pastenumbersstatement()
Sheets("input sTATEMENT").ListBox1.TopIndex = Abs(Cells(Selection.End(xlUp).Row, Selection.End(xlUp).Column - 2)) + 1

Dim obj As New DataObject
If premutoprimopulsante = 1 Then
premutoprimopulsante = 0
Else
'MsgBox "First press the up button"
'Exit Sub
 obj.GetFromClipboard
    pval = obj.GetText
    'MsgBox pval
    If pval = "" Then Exit Sub
     
        
    pval = Replace(pval, "|fffd|", "")
    ' pval = Replace(pval, "l", "")
    
     pval = Replace(pval, "_", " ")
     pval = Replace(pval, "/", " ")
    
    pval = Replace(pval, ",", "")
    'pval = Replace(pval, "(", "")
   ' pval = Replace(pval, ")", "")
    pval = Replace(pval, ".", "")
     'pval = Replace(pval, "I", "")
     pval = Replace(pval, "|", "")
     pval = Replace(pval, "[", "")
     pval = Replace(pval, "]", "")
     pval = Replace(pval, "'", "")
      pval = Replace(pval, "I", "")
      
      pval = Replace(pval, Chr(10), " ")
     '--------
     
'MsgBox pval

'Dim WrdArray2() As String


WrdArray() = Split(pval, " ")
For I = LBound(WrdArray) To UBound(WrdArray)
 If IsNumeric(Mid(WrdArray(I), 2, 1)) = True Then
 'pval = Replace(pval, "-", "")
    
   WrdArray(I) = Replace(WrdArray(I), "|fffd|", "")
    WrdArray(I) = Replace(WrdArray(I), "l", "")
    
    WrdArray(I) = Replace(WrdArray(I), "_", " ")
    WrdArray(I) = Replace(WrdArray(I), "/", " ")
    
   WrdArray(I) = Replace(WrdArray(I), ",", "")
    ' WrdArray(I) = Replace(wrdarray(I), "(", "")
   'wrdarray(I) = Replace(wrdarray(I), ")", "")
   WrdArray(I) = Replace(WrdArray(I), ".", "")
    WrdArray(I) = Replace(WrdArray(I), "I", "")
    WrdArray(I) = Replace(WrdArray(I), "|", "")
    WrdArray(I) = Replace(WrdArray(I), "[", "")
    WrdArray(I) = Replace(WrdArray(I), "]", "")
    End If
    Next I

End If

Dim MyClipObj As New DataObject
    Dim c As Range
    'Dim obj As New DataObject
    Dim pval2 As Variant
    Dim pv As Variant
    Dim pv2 As Variant
    Dim pv3 As Variant
    Dim myValue As Variant

    Dim ce As Variant
    On Error Resume Next
    
    
     If ActiveCell.Column <> 15 Then
     MsgBox "You must activate a cell in column O"
     Exit Sub
     
     End If
    GoTo SALTA:
     
     'Temporarily save clipboard data
    obj.GetFromClipboard
On Error Resume Next
pval2 = obj.GetText
     
    If pval2 = "" Then Exit Sub
     If ActiveCell.Column <> 15 Then
     MsgBox "You must activate a cell in column O"
     Exit Sub
     End If
     pval2 = Replace(pval2, "I", "")
     pval2 = Replace(pval2, "|", "")
     pval2 = Replace(pval2, "I", "")
   'MsgBox pval2
   ce = 0
For pv = 1 To Len(pval2)
If Mid(pval2, pv, 1) = " " Then
ce = 1
pv2 = Left(pval2, pv)
pv3 = pv
ActiveCell.Value = pv2
End If
Next
'MsgBox (Len(pval2) - PV3)
'For pv = pv To Len(pval2)
'If Mid(pval2, pv, 1) = " " Then

 pv2 = Right(pval2, Len(pval2) - pv3)
 
 If ce = 0 Then
 ActiveCell.Value = pv2
 Else
ActiveCell.Offset(, 1).Resize(1, 1).Value = pv2
End If

'MsgBox pv2
'End If
'Next
SALTA:


Dim FIRSTNUM As Variant
Dim SECONDNUM As Variant
Dim THIRDNUM As Variant

'MsgBox FIRSTNUM


For IIII = III To UBound(WrdArray) 'LBound(WrdArray) To UBound(WrdArray)
  'strg = WrdArray(I)
  
 
  
   If IsNumeric(Mid(WrdArray(IIII), 2, 1)) = True Then
      WrdArray(IIII) = Replace(WrdArray(IIII), "*", "")
 'MsgBox WrdArray(II)
   
   'MSG1 = MsgBox(WrdArray(IIII) & " Is this the first numeric data to paste ?", vbYesNoCancel, "Clear?")
   
  myValue = InputBox(" Is this the first numeric data to paste ?", "Write STOP to stop; Annulla = jump this number", WrdArray(IIII))

   If myValue = "stop" Or myValue = "Stop" Or myValue = "STOP" Then
      'If MSG1 = vbCancel Then
   Exit Sub
   End If
   
'If MSG1 = vbYes Then

                                   
If myValue <> vbNullString Then
                If IsNumeric(Mid(WrdArray(IIII + 1), 3, 1)) = False Then
MSG1 = MsgBox("Is it perhaps empty the data in first most recent year's column?", vbYesNo, "Clear?")
If MSG1 = vbYes Then

myValue = Replace(myValue, Chr(13), "")
ActiveCell.Offset(, 1).Resize(1, 1).Value = myValue  'WrdArray(IIII)
Exit Sub
End If
End If

    ActiveCell.Value = myValue  'WrdArray(IIII)
    
    Dim CONTAR
For CONTAR = IIII + 1 To UBound(WrdArray)
If WrdArray(CONTAR) <> "" And WrdArray(CONTAR) <> " " Then
IIII = CONTAR - 1
Exit For
End If
Next CONTAR
    
    If Right(WrdArray(IIII + 1), 1) = Chr(13) Then
    GoTo salsa
    End If
    
     myValue = InputBox("Do I have to paste the first number next? ", "This?", WrdArray(IIII + 1))
    'MSG1 = MsgBox("Do I have to paste the first number next? " & WrdArray(IIII + 1), vbYesNo, "Clear?")
If myValue <> vbNullString Then
'If MSG1 = vbYes Then

'Dim CONTAR
'For CONTAR = II + 1 To UBound(WrdArray)
'If WrdArray(CONTAR) <> "" And WrdArray(CONTAR) <> " " Then
'II = CONTAR - 1
'Exit For
'End If
'Next CONTAR
GoTo doposalsa
salsa:
myValue = WrdArray(IIII + 1)
doposalsa:
myValue = Replace(myValue, Chr(13), "")
'WrdArray(IIII + 1) = Replace(WrdArray(IIII + 1), Chr(13), "")

    'ActiveCell.Offset(, 1).Resize(1, 1).Value = WrdArray(IIII + 1)
    ActiveCell.Offset(, 1).Resize(1, 1).Value = myValue
    Else
    myValue = Replace(WrdArray(IIII + 2), Chr(13), "")
    'WrdArray(IIII + 2) = Replace(WrdArray(IIII + 2), Chr(13), "")
    'ActiveCell.Offset(, 1).Resize(1, 1).Value = WrdArray(IIII + 2)
    ActiveCell.Offset(, 1).Resize(1, 1).Value = myValue
    End If
    
    '---------------
    For III = III To UBound(WrdArray) 'LBound(WrdArray) To UBound(WrdArray)
  'strg = WrdArray(I)
     If IsNumeric(Mid(WrdArray(III), 2, 1)) = True Then
        Exit Sub
        End If
        Next III
    '---------------
    
    
    
    
    Exit Sub
  End If
    End If
    
    
  
Next IIII
    




    
    
End Sub

Sub Test3()


Dim bIs64Bit As Boolean
#If Win64 Then
    bIs64Bit = True
#End If
'MsgBox "This is 64bit office: " & bIs64Bit
'Exit Sub

    On Error Resume Next
    
'serve per aprire CAPTURE2TEXT
    'Dim lPid2 As Long, hwnd As Long
    Dim paths As String
    
    'Application.ScreenUpdating = False
    
    'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
   '''' DoEvents
    
    
   paths = ActiveWorkbook.Path
   'MsgBox path
   
   If bIs64Bit <> True Then
    lPid2 = Shell(paths & "\Capture2Text_v4.2.0_32bit\Capture2Text.exe ", vbNormalFocus)
        hwnd = HwndFromPID(lPid2)
    hwnd2 = GetWindow(hwnd2, GW_CHILD)
    'MsgBox hwnd
    Else
    lPid2 = Shell(paths & "\Capture2Text_v4.2.0_64bit\Capture2Text.exe ", vbNormalFocus)
        hwnd = HwndFromPID(lPid2)
    hwnd2 = GetWindow(hwnd2, GW_CHILD)
    End If
    DoEvents
    DoEvents
    DoEvents
    DoEvents
    
    
    
    ' VERSIONE 187 FACCIO USCIRE QUI DALLA SUB PERCHE' LE RIGHE SUCCESSIVE FANNO PIANTARE EXCEL IN WINDOWS 10 SENZA DARE ERRORI IN PARTICOLARE
    'INVECE ANDAVANO BENE E NON DAVANO ERRORI FINO ALLA VERSIONE 186
    Exit Sub
    
    
    DoEvents
    
    'Dim aaa
    'For aaa = 1 To 100000
    'If hwnd Then
    'MsgBox "atlavivadet!"
   ' sleep (1)
                               '''''''''''''''''''''''''''''AppActivate "Exe Lock"
   ''''''AppActivate "Analisi Studio Ballarini" ''''''''''''''''''''''''''''''''''''''''
  DoEvents
   
   'sleep (1)
'doEvents
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("yalps1d")
DoEvents
'sleep (1)
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("{ENTER}")
    DoEvents
    
    '''''AppActivate "Analisi Studio Ballarini"
    ' Application.ScreenUpdating = True
    'GoTo 1500
    'End If
'Next

'1500
End Sub


Attribute VB_Name = "Modulo81"

Public QUALEDISCO As String


Sub perqualedisco()
On Error GoTo err
 QUALEDISCO = InputBox("The letter of disk on wich to save? (without : please) IF NO LETTER THEN NO ONE IMEDIATE BACKUP ON DISK ")
 Exit Sub
 
err:  MsgBox "There some problem with letter!"
 
End Sub



Sub WRITEONFILEcodeaccounts()



MSG1 = MsgBox("Really do you want save code & accounts? Press yes only if you have on screen the most updated version and you have added new accounts or code !", vbYesNo, "Save?")

If MSG1 = vbYes Then
MacroRunning = True
Application.Calculation = xlManual

    'Write data to a text file
    'By Christos Samaras
    On Error GoTo err

    'Declaring variables
    Dim sDrawing As String
    Dim sWeld As String
    Dim sWelder As String
    Dim intSize As Integer
    Dim dDate As Date
    Dim sMaterial As String
    
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lCounter As Long
    Dim lLastRow As Long
    Dim disco As String
    
    
    Columns("N:N").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("o1").Select
    
    
    
  disco = InputBox("The letter of disk on wich to save? (without : please)")
  
   If disco = "" Then
  Application.Calculation = xlAutomatic
MacroRunning = False
    Exit Sub
End If
  
  
  '----
  ChDir "c:\users\public\"
  'Setting the name and the path of text file based on workbook path
  
    
    If disco = "" Then
    SFNAME = "C:\users\public\code&account_" & Now & ".txt"
    Else
    If disco <> "c" And disco <> "C" Then
SFNAME = disco & ":\" & Now & ".txt"
Else
    SFNAME = "C:\users\public\code&account_" & Now & ".txt"
    End If
    End If
    
 'Create a new file (or overwrite an existing one)
SFNAME = Replace(SFNAME, "/", "_")
SFNAME = Replace(SFNAME, ":", "_")
SFNAME = Replace(SFNAME, "_\", ":\")
'only allow the user to select one file

'make the file dialog visible to the user

With Application.FileDialog(msoFileDialogSaveAs)
.AllowMultiSelect = False
'.Filter = "*.txt"


'''If disco <> "c" And disco <> "C" Then
'''ChDir disco & ":\"
.InitialFileName = SFNAME & ".txt"  ' disco & ":\*.txt"
.FilterIndex = 12
'''Else
'ChDir "c:\users\public\"
'''.InitialFileName = "c:\users\public\*.txt"
'End If

intChoice = .Show
End With


If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
Application.Calculation = xlAutomatic
MacroRunning = False
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath

    '----------
    
    
    'Get an unused file number
  '''  intFNumber = FreeFile
    
   ''' On Error Resume Next
    
    'Prepare text file for reading
   ''' Open sFName For Input As #intFNumber
  '------
    
    'Just showing where the input data are
    'Sheet2.Activate
    ActiveSheet.Range("k1").Select
    
    'Find the last row that contains data
    With ActiveSheet
        lLastRow = .Cells(.Rows.Count, "N").End(xlUp).Row
    End With
    
   
    
    
        
    'Get an unused file number
    intFNumber = FreeFile
    
   

'MsgBox sFName
Open SFNAME For Output As #intFNumber
        
    For lCounter = 1 To lLastRow

     'Read specific data from the worksheet
        With ActiveSheet
        s11 = .Cells(lCounter, 11)
            s12 = .Cells(lCounter, 12)
            s13 = .Cells(lCounter, 13)
            s14 = .Cells(lCounter, 14)
            s15 = .Cells(lCounter, 15)
            s16 = .Cells(lCounter, 16)
            s17 = .Cells(lCounter, 17)
            s18 = .Cells(lCounter, 18)
            s19 = .Cells(lCounter, 19)
            s20 = .Cells(lCounter, 20)
            s21 = .Cells(lCounter, 21)
            'sMaterial = .Cells(lCounter, 10)
        End With
        
        If s11 = "" Then
        s11 = "-"
        End If
        
        If s12 = "" Then
        s12 = 0
        End If
        If s13 = "" Then
        s13 = 0
        End If
        If s14 = "" Then
        s14 = 0
        End If
        If s15 = "" Then
        s15 = 0
        End If
        If s16 = "" Then
        s16 = 0
        End If
        If s17 = "" Then
        s17 = "-"
        End If
        If s18 = "" Then
        s18 = "-"
        End If
        If s19 = "" Then
        s19 = "-"
        End If
        If s20 = "" Then
        s20 = "-"
        End If
        If s21 = "" Then
        s21 = "-"
        End If
        
        
        'Write selected data to text file
        Write #intFNumber, s11, s12, s13, s14, s15, s16, s17, s18, s19, s20, s21
        
    'Continue looping until the last row
    Next lCounter
    
    'Close the text file
    Close #intFNumber
    
    'Inform the user about the process
    MsgBox "Values from sheet '" & ActiveSheet.Name & "' were written to '" & SFNAME & "' file!", vbInformation
   
   Else
   End If
   Application.Calculation = xlAutomatic
MacroRunning = False

   Exit Sub
   Application.Calculation = xlAutomatic
MacroRunning = False

err: MsgBox "wrong disk letter?"
End Sub


Sub READFILEcodeaccounts()
MacroRunning = True
Application.ScreenUpdating = False
Application.Calculation = xlManual
    
    'To read "string" data, the string must be split in order to locate the values
    'By Christos Samaras
    
    'Declaring variables
    Dim sLine As String
    Dim SFNAME As String
    Dim intFNumber As Integer
    Dim lRow As Long
    Dim lColumn As Long
    Dim vDataValues As Variant
    Dim intCount As Integer
    Dim disco As String
    
    On Error GoTo err
    
  disco = InputBox("The letter of disk from wich to read? (without : please)")
  
   If disco = "" Then
  Application.Calculation = xlAutomatic
MacroRunning = False
    Exit Sub
End If
    
    'The full path of the text file that will be opened
    '''sFName = disco & ":\users\public\PROVARE.txt"
    
    '----------
    Dim intChoice As Integer
Dim strPath As String


ChDir "C:\users\public\"
 
'--------
'only allow the user to select one file
'''Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False
'make the file dialog visible to the user
'''intChoice = Application.FileDialog(msoFileDialogOpen).Show
'----------
With Application.FileDialog(msoFileDialogOpen)
.AllowMultiSelect = False
.Filters.Add "Text File", "*.txt"
.FilterIndex = 1
If disco <> "c" And disco <> "C" Then
ChDir disco & ":\"
.InitialFileName = disco & ":\*.txt"
Else
'ChDir "c:\users\public\"
.InitialFileName = "c:\users\public\*.txt"
End If


intChoice = .Show
End With

'---------




'determine what choice the user made
If intChoice <> 0 Then
'get the file path selected by the user
strPath = Application.FileDialog( _
msoFileDialogOpen).SelectedItems(1)
Else
Application.Calculation = xlAutomatic
MacroRunning = False
        Exit Sub
        
'print the file path to sheet 1
'Cells(2, 1) = strPath
End If
 SFNAME = strPath
    '----------
    
    
    'Get an unused file number
    intFNumber = FreeFile
    
    On Error Resume Next
    
    'Prepare text file for reading
    Open SFNAME For Input As #intFNumber
    
    'Check if the text file was found
    If err.Number <> 0 Then
        MsgBox "Text file not found!", vbCritical, "Error!"
        Application.Calculation = xlAutomatic
        MacroRunning = False
        Exit Sub
    End If
    
    On Error GoTo 0
    
    'Clearing the sheet
   ''' Sheet3.Cells.Clear
    
    'First row for data
    lRow = 1
    
    'Loop until the end of file
    Do While Not EOF(intFNumber)
        
        'Read data from file
        Line Input #intFNumber, sLine
        
        'Split values apart into an array
        vDataValues = Split(sLine, ",")
        
        With ActiveSheet
            
            'First column for data
            lColumn = 11
            
            'Process each value in the array
            For intCount = LBound(vDataValues) To UBound(vDataValues)
            
                'Write the value to the worksheet
                .Cells(lRow, lColumn) = vDataValues(intCount)
                
                'Increase column count
                lColumn = lColumn + 1
            Next intCount
            
        End With
        
        'Next row of the worksheet
        lRow = lRow + 1
               
    Loop
    
    'Close the file
    Close #intFNumber
    
    'Fitting column width
    ''Sheet3.Cells.EntireColumn.AutoFit

    'Just showing where the output data are
    ActiveSheet.Activate
    Range("L1").Select
    
    '------
    Columns("L:U").Select
    Selection.Replace What:="""", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="#", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("K1").Select
    
    '------
       
      
    Application.Calculation = xlAutomatic
    Application.ScreenUpdating = True
    'Inform the user about the process
    MsgBox "Values from file '" & SFNAME & "' were imported to sheet '" & ActiveSheet.Name & "'!", vbInformation
Application.Calculation = xlAutomatic
MacroRunning = False

Exit Sub
Application.Calculation = xlAutomatic
MacroRunning = False

err: MsgBox "wrong disk letter?"
End Sub

Attribute VB_Name = "Modulo82"
Sub Macro57()
Attribute Macro57.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro57 Macro
'

'
    Range("M79:N79").Select
    Selection.NumberFormat = "0.0"
    Range("M79").Select
End Sub
Attribute VB_Name = "Modulo83"
Sub STACCAFOGLIO()
Cells.Select


    Selection.Copy
    Workbooks.Add
    'ATTENTO SE METTI WINDOWS AL POSTO DI SHEETS ALCUNI EXCEL NON FANNO PARTIRE WIFROM !!!!
   ' Windows( _
        "294 CORRETTE ALTRE LIBRERIE MODULI 4 7 9 PER 64 BIT  budget 2016 32 e 64 bit.xlsm" _
        ).Activate
    On Error Resume Next
    
    Cells.Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("A1").Select
    
    
    
    'Sheets("Foglio1").Activate
    'Sheets("Cartel1").Activate
   'ActiveSheet.Paste
               
    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
        , SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        
        'FORMULE PREVISIONI
        Range("N73").FormulaLocal = "=SE(I17<>0;DEV.ST.VALORI(F17/F9;H17/H9);"""")"
        Range("N74").FormulaLocal = "=SE(I17<>0;MEDIA(F17/F9;H17/H9);"""")"
        Range("N75").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);DISTRIB.NORM.ST((G17-N74)/N73-1);"""")"
    Range("N76").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);1-DISTRIB.NORM.ST((G17-N74)/N73+1);"""")"
    Range("N77").FormulaLocal = "=SE(E(N73<>"""";N74<>"""";N73<>0;N74<>0);1-N75-N76;"""")"
    'fine formule previsioni
        
        
 'ELIMINA TUTTI I COLLEGAMENTI ALL ALTRO FOGLIO
Dim Links As Variant
Dim I As Variant
Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
For I = 1 To UBound(Links)
ActiveWorkbook.BreakLink _
    Name:=Links(I), _
    Type:=xlLinkTypeExcelLinks
Next I

    ActiveSheet.Range("A1").Select
    ActiveWindow.DisplayGridlines = False
   With ActiveWindow
        .SplitColumn = 0
        .SplitRow = 1
    End With
    ActiveWindow.FreezePanes = True
    Range("G3").Select
'Dim Links As Variant
'Dim I
'Links = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)
'For I = 1 To UBound(Links)
'ActiveWorkbook.BreakLink _
    'Name:=Links(I), _
    'Type:=xlLinkTypeExcelLinks
'Next I

MsgBox "Adeguare P20 - P24 ai numeri dei nomi di cartella aperti se si vogliono confrontare"

End Sub
Attribute VB_Name = "Modulo84"
Sub Macro56()
Attribute Macro56.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro56 Macro
'

'
    Columns("N:N").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
End Sub
Attribute VB_Name = "Modulo85"
Sub contiaggregazioni()
Attribute contiaggregazioni.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro59 Macro
'

'
    Application.GoTo Reference:="R2561C11"
End Sub
Attribute VB_Name = "Modulo86"
Public xcarat

Sub Macro59()
Attribute Macro59.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro59 Macro
'

'
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
End Sub
Sub Macro60()
Attribute Macro60.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro60 Macro
'

'
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
End Sub

Sub caratteremenopiu()

Dim carat
carat = Range("B1:J1").Font.Size
'MsgBox carat

   Range("B1:J1").Select
    With Selection.Font
   .Size = carat + Range("AG1") - 1
   End With
   
    Range("G3").Select
End Sub

Sub caratteremenopiu2()

Dim carat
Dim carat2
 On Error Resume Next

carat = Range("B1:J1").Font.Size
'MsgBox carat

   Range("B1:J1").Select
    With Selection.Font
   .Size = carat + Range("AG1") - 1
   End With
   xcarat = Range("AG1")
    Range("G3").Select
    
    
Dim SOLOUNA
SOLOUNA = 0

Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
'''MsgBox "Press the button Cut Excel Sheet before!"
'''Exit Sub
SOLOUNA = 1
End If
'If wbs.Count > 2 Then
'MsgBox "Leave only opened the one Sheet to add!"
'Exit Sub
'End If

'Application.Visible = False
DoEvents
Application.ScreenUpdating = False
DoEvents


Dim nome1 As String
Dim nome2 As String
 nome1 = Range("B1")
        
        
        If SOLOUNA = 0 Then
        
ActiveWindow.ActivateNext
     carat2 = Range("B1:J1").Font.Size
'MsgBox carat

   Range("B1:J1").Select
    With Selection.Font
   .Size = carat2 + xcarat - 1
   End With
   
    Range("G3").Select
      ActiveWindow.ActivateNext
    'Application.Visible = True
    
    End If
    
    
End Sub

Attribute VB_Name = "Modulo87"
Sub Macro64()
Attribute Macro64.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro64 Macro
'

'
    Range("G3").Select
    ActiveWindow.ActivateNext
    Range("B1:J1").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 14
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    ActiveWindow.ActivateNext
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo88"
Sub Macro61()
Attribute Macro61.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro61 Macro
'

'
    Range("G3").Select
End Sub
Sub Macro62()
Attribute Macro62.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro62 Macro
'

'
    Windows.Arrange ArrangeStyle:=xlTiled
    Windows("Cartel1").Activate
    Application.Left = 148
    Application.Top = 1
    Application.Width = 536.25
    Application.Height = 288.75
    Application.Left = 3.25
    Application.Top = 4.75
    Application.Width = 510.75
    Application.Height = 288.75
    Application.Left = 514.75
    Application.Top = 1
    Application.Width = 511.5
    Application.Height = 288.75
    Windows("Cartel3").Activate
    Application.Left = 517
    Application.Top = 4.75
    Windows("Cartel2").Activate
    Application.Left = 4.75
    Application.Top = 293.5
    Application.Width = 509.25
    Application.Height = 288.75
    Application.Left = 516.25
    Application.Top = 289
    Application.Width = 510
    Application.Height = 288.75
    Windows("Cartel4").Activate
    Application.Left = 517
    Application.Top = 292
    Windows("Cartel1").Activate
    ActiveWindow.Zoom = 28
    ActiveWindow.Zoom = 98
    ActiveWindow.Zoom = 78
    ActiveWindow.Zoom = 70
    ActiveWindow.Zoom = 60
    ActiveWindow.Zoom = 50
    Windows("Cartel3").Activate
    ActiveWindow.Zoom = 90
    ActiveWindow.Zoom = 80
    ActiveWindow.Zoom = 70
    ActiveWindow.Zoom = 60
    ActiveWindow.Zoom = 50
    Windows("Cartel4").Activate
    ActiveWindow.Zoom = 90
    ActiveWindow.Zoom = 80
    ActiveWindow.Zoom = 70
    ActiveWindow.Zoom = 60
    ActiveWindow.Zoom = 50
    Windows("Cartel2").Activate
    ActiveWindow.Zoom = 90
    ActiveWindow.Zoom = 80
    ActiveWindow.Zoom = 70
    ActiveWindow.Zoom = 60
    ActiveWindow.Zoom = 50
    Application.WindowState = xlNormal
    Windows("806.xlsm").Activate
End Sub
Sub windowstiles()
Attribute windowstiles.VB_ProcData.VB_Invoke_Func = " \n14"
Application.ScreenUpdating = False

' Macro63 Macro
'
On Error Resume Next
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")


Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate

    
    Windows("Cartel" & FIN2 & "").Activate
   ' RemoveToolbars
    
    ActiveWindow.Zoom = 60
    
    
    Windows("Cartel" & FIN1 & "").Activate
   ' RemoveToolbars
    
    ActiveWindow.Zoom = 60
    
    Windows("Cartel" & FIN3 & "").Activate
   ' RemoveToolbars
    
    ActiveWindow.Zoom = 60
    
    Windows("Cartel" & FIN4 & "").Activate
    'RemoveToolbars
    
    ActiveWindow.Zoom = 60
    
    'Windows("806.xlsm").Activate
     Windows("Cartel" & FIN3 & "").Activate
     Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
     Application.DisplayStatusBar = True
    Windows("Cartel" & FIN2 & "").Activate
     Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
     Application.DisplayStatusBar = True
    Windows("Cartel" & FIN4 & "").Activate
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
    Application.DisplayStatusBar = True
    Windows("Cartel" & FIN1 & "").Activate
     Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
     Application.DisplayStatusBar = True
    Windows(MIONOME).Activate
     Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
     Application.DisplayStatusBar = True
    Windows.Arrange ArrangeStyle:=xlTiled
    
    
   


    
    
End Sub

Sub windowsdown()

Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4


FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate


  On Error Resume Next
  
  
  If Range("J3") = "" Then
 Range("J3") = 1
 End If
 
 If Range("J3") <= 0 Then
 Range("J3") = 1
 End If
 
 Dim QUANTOSPOSTO
 QUANTOSPOSTO = Range("J3")
  
  If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    DoEvents
   ActiveWindow.SmallScroll Down:=QUANTOSPOSTO
   DoEvents
   End If
   
vai:
'On Error GoTo vai2
If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   DoEvents
   ActiveWindow.SmallScroll Down:=QUANTOSPOSTO
   DoEvents
   End If
   
vai2:
'On Error GoTo vai3
If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
   DoEvents
   ActiveWindow.SmallScroll Down:=QUANTOSPOSTO
   DoEvents
   End If
   
vai3:
'On Error GoTo vai4
If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
   DoEvents
   ActiveWindow.SmallScroll Down:=QUANTOSPOSTO
   DoEvents
   End If
   
vai4:

 

 
 
On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
ActiveWindow.SmallScroll Down:=QUANTOSPOSTO
End If



   
End Sub

Sub windowsup()
'
' Macro63 Macro
'
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")


Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate


 On Error Resume Next
 
  If Range("J3") = "" Then
 Range("J3") = 1
 End If
 
 If Range("J3") <= 0 Then
 Range("J3") = 1
 End If
 
 Dim QUANTOSPOSTO
 QUANTOSPOSTO = Range("J3")
 
 If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
   ActiveWindow.SmallScroll up:=QUANTOSPOSTO
    End If
vai5:
    'On Error GoTo vai6
    If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ActiveWindow.SmallScroll up:=QUANTOSPOSTO
   End If
   
vai6:
    'On Error GoTo vai7
    If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
   ActiveWindow.SmallScroll up:=QUANTOSPOSTO
   End If
vai7:
    'On Error GoTo vai8
    If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
   ActiveWindow.SmallScroll up:=QUANTOSPOSTO
   End If
   
vai8:
  
'On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
ActiveWindow.SmallScroll up:=QUANTOSPOSTO
End If


   
End Sub

'@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@|fffd|
Sub windowsdx()

Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")


Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'Windows(MIONOME).Activate


   On Error Resume Next
   
   If Range("J3") = "" Then
 Range("J3") = 1
 End If
 
 If Range("J3") <= 0 Then
 Range("J3") = 1
 End If
 
 Dim QUANTOSPOSTO
 QUANTOSPOSTO = 1 'Range("J3")
   
    If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    DoEvents
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn + QUANTOSPOSTO
   DoEvents
   End If
   
vai:
'On Error GoTo vai2
 If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   DoEvents
  ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn + QUANTOSPOSTO
   DoEvents
   End If
vai2:
'On Error GoTo vai3
 If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
   DoEvents
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn + QUANTOSPOSTO
   DoEvents
   End If
   
vai3:
'On Error GoTo vai4
 If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
   DoEvents
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn + QUANTOSPOSTO
   DoEvents
   End If
   
   
vai4:

'On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn + QUANTOSPOSTO
End If
   
   
End Sub

Sub windowssx()
'
' Macro63 Macro
'
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate


 On Error Resume Next
 
 If Range("J3") = "" Then
 Range("J3") = 1
 End If
 
 If Range("J3") <= 0 Then
 Range("J3") = 1
 End If
 
 Dim QUANTOSPOSTO
 QUANTOSPOSTO = 1  'Range("J3")
 
  If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    If ActiveWindow.ScrollColumn - 1 >= 1 Then
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn - QUANTOSPOSTO
   End If
   End If
   
    
vai5:
    'On Error GoTo vai6
    
     If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   If ActiveWindow.ScrollColumn - 1 >= 1 Then
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn - QUANTOSPOSTO
   End If
   End If
   
   
vai6:
    'On Error GoTo vai7
     If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
   If ActiveWindow.ScrollColumn - 1 >= 1 Then
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn - QUANTOSPOSTO
   End If
   End If
   
   
vai7:
    'On Error GoTo vai8
     If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
   If ActiveWindow.ScrollColumn - 1 >= 1 Then
   ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn - QUANTOSPOSTO
   End If
   End If
   
   
vai8:

'On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
 ActiveWindow.ScrollColumn = ActiveWindow.ScrollColumn - QUANTOSPOSTO
End If

   
End Sub



Sub zum60()
ActiveWindow.Zoom = ActiveWindow.Zoom + 10
End Sub
Sub zum30()
ActiveWindow.Zoom = ActiveWindow.Zoom - 10
End Sub



Sub zoomup()
'
' Macro63 Macro
'
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate

Application.ScreenUpdating = False

    
 On Error Resume Next
 

    
  If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom + 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If

    
vai5:
    'On Error GoTo vai6
    
     If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom + 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If

   
vai6:
    'On Error GoTo vai7
     If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom + 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If

   
vai7:
    'On Error GoTo vai8
     If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom + 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If

DoEvents

   
vai8:
  
'On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom + 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If


   
End Sub

Sub zoomdown()
'
' Macro63 Macro
'
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4


FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate

Application.ScreenUpdating = False
    

 On Error Resume Next
  If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    
    If ActiveWorkbook.Name <> MIONOME Then
    
    ActiveWindow.VisibleRange.Select

     ActiveWindow.SmallScroll Down:=0
       ActiveWindow.Zoom = ActiveWindow.Zoom - 10
       ActiveWindow.VisibleRange.Cells(1).Select
              
End If
End If


    
vai5:
    'On Error GoTo vai6
    
     If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select

    ActiveWindow.SmallScroll Down:=0
       ActiveWindow.Zoom = ActiveWindow.Zoom - 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If

   
vai6:
    'On Error GoTo vai7
     If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select

    ActiveWindow.SmallScroll Down:=0
       ActiveWindow.Zoom = ActiveWindow.Zoom - 10
       ActiveWindow.VisibleRange.Cells(1).Select
 End If
 End If

 
   
vai7:
    'On Error GoTo vai8
     If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    ActiveWindow.VisibleRange.Select

    ActiveWindow.SmallScroll Down:=0
       ActiveWindow.Zoom = ActiveWindow.Zoom - 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
End If


DoEvents
   
vai8:
  
'On Error Resume Next
Windows(MIONOME).Activate

If Range("P24") = 100 Then
ActiveWindow.VisibleRange.Select
       ActiveWindow.Zoom = ActiveWindow.Zoom - 10
       ActiveWindow.VisibleRange.Cells(1).Select
End If
   
End Sub

Sub centrafinestre()
'
' Macro63 Macro
'
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4


FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim PIVENTIQUAT
Dim RAN
Dim Cel
Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

'On Error Resume Next
'Windows(MIONOME).Activate

Application.ScreenUpdating = False
    
   Windows(MIONOME).Activate
   PIVENTIQUAT = Range("P24")

 On Error Resume Next
 
 
 'SE DICO CHE SI DEVE MUOVERE ANCHE LA FINESTRA DI WIFROM ALLORA E' TALE FINESTRA CHE DICE ALLE ALTRE DOVE POSIZIONARSI......
 
 If PIVENTIQUAT = 100 Then
 Windows(MIONOME).Activate
'Range(ran).Select
   ' Range(cel).Select
    'ActiveWindow.ScrollRow = ActiveCell.Row
     'ActiveWindow.ScrollColumn = ActiveCell.Column
     
     RAN = ActiveWindow.VisibleRange.Address
       Cel = ActiveWindow.VisibleRange.Cells(1).Address
End If
 
 
 
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    
    If PIVENTIQUAT = 100 Then
    Range(RAN).Select
    Range(Cel).Select
    ActiveWindow.ScrollRow = ActiveCell.Row
    ActiveWindow.ScrollColumn = ActiveCell.Column
    Else
    
'........ALTRIMENTI SE P24 NON E' 100 E' QUESTA LA FINESTRA CHE DICE ALLE ALTRE COME POSIZIONARSI
        If ActiveWorkbook.Name <> MIONOME Then
        RAN = ActiveWindow.VisibleRange.Address
        Cel = ActiveWindow.VisibleRange.Cells(1).Address
        End If

    End If
End If


    
vai5:
    'On Error GoTo vai6
    
     If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    Range(RAN).Select
    Range(Cel).Select
    ActiveWindow.ScrollRow = ActiveCell.Row
    ActiveWindow.ScrollColumn = ActiveCell.Column
End If
End If

   
vai6:
    'On Error GoTo vai7
     If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    Range(RAN).Select
    Range(Cel).Select
    ActiveWindow.ScrollRow = ActiveCell.Row
     ActiveWindow.ScrollColumn = ActiveCell.Column
 End If
 End If

 
   
vai7:
    'On Error GoTo vai8
     If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
     If ActiveWorkbook.Name <> MIONOME Then
    Range(RAN).Select
    Range(Cel).Select
    ActiveWindow.ScrollRow = ActiveCell.Row
     ActiveWindow.ScrollColumn = ActiveCell.Column
End If
End If


DoEvents
   
vai8:
  
'On Error Resume Next
Windows(MIONOME).Activate

'If Range("P24") = 100 Then
'Range(ran).Select
    'Range(cel).Select
    'ActiveWindow.ScrollRow = ActiveCell.Row
    ' ActiveWindow.ScrollColumn = ActiveCell.Column
'End If
   
End Sub

Sub COPIABASIPERC()
Attribute COPIABASIPERC.VB_ProcData.VB_Invoke_Func = "b\n14"
'
' Macro78 Macro
'

'
    
Dim FIN1
Dim FIN2
Dim FIN3
Dim FIN4

FIN2 = Range("P22")
FIN3 = Range("P23")
FIN4 = Range("P20")
FIN1 = Range("P21")

Dim MIONOME
If InStr(Application.ActiveWorkbook.Path, "Temp") <> 0 Or InStr(Application.ActiveWorkbook.Path, "tmp") <> 0 Then
MIONOME = Application.ActiveWorkbook.Name
MIONOME = Left(MIONOME, Len(MIONOME) - 4) & "exe (Read-Only)"
Else
MIONOME = Application.ActiveWorkbook.Name
End If

If Left(MIONOME, 6) = "Cartel" Then
Exit Sub
End If


 On Error Resume Next


    Application.ScreenUpdating = False
    
    Range("G3").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("G3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("G3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("G3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("G3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("G3").Select
    
    
    '********
    
    
      Range("I3").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("I3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("I3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("I3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("I3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("I3").Select
    
    
      '********
    
    
      Range("G31").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("G31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("G31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("G31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("G31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("G31").Select
    
    
    
    
      '********
    
    
      Range("I31").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("I31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("I31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("I31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("I31").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("I31").Select
    
      
      '********
    
    
      Range("G54").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("G54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("G54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("G54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("G54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("G54").Select
    
    
    
         '********
    
    
      Range("I54").Select
    Selection.Copy
 If FIN4 <> "" Then
    Windows("Cartel" & FIN4 & "").Activate
    'Windows("Cartel1").Activate
    Range("I54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN1 <> "" Then
    Windows("Cartel" & FIN1 & "").Activate
   ' Windows("Cartel2").Activate
    Range("I54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If


If FIN2 <> "" Then
    Windows("Cartel" & FIN2 & "").Activate
    'Windows("Cartel3").Activate
    Range("I54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

If FIN3 <> "" Then
    Windows("Cartel" & FIN3 & "").Activate
    'Windows("Cartel4").Activate
    Range("I54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End If

Windows(MIONOME).Activate
    'Windows("908.xlsm").Activate
    Range("G3").Select
    
    End Sub
    
Attribute VB_Name = "Modulo89"
Sub Macro63()
Attribute Macro63.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro63 Macro
'

'
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 20.3571653543, _
        196.0714173228, 727.5, 21.4285826772).Select
    Application.CommandBars("Format Object").Visible = False
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("F13").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 326.7857480315, _
        282.8571653543, 138.2142519685, 22.5).Select
    Selection.Copy
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("F17").Select
    ActiveSheet.Paste
    Selection.ShapeRange.IncrementTop -2.1428346457
    Selection.ShapeRange.ScaleHeight 0.9047629046, msoFalse, msoScaleFromTopLeft
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 22.5, 753.2142519685, _
        443.5714173228, 37.5).Select
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("H28:K36").Select
    Range("K36").Activate
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        1008.2142519685, 373.9285826772, 28.9285826772).Select
    Selection.ShapeRange.ScaleHeight 0.814816831, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.ScaleHeight 0.8181842476, msoFalse, _
        msoScaleFromBottomRight
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    
    
    '///////
    
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 22.5, 1371.4285826772, _
        442.5, 22.5).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B81").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        1511.7857480315, 376.0714173228, 19.2856692913).Select
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 1
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("G3").Select
    
    '------------------
    
    
    
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 21.4285826772, _
        1369.2857480315, 445.7142519685, 24.6428346457).Select
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 24.6428346457, _
        1505.3571653543, 369.6429133858, 23.5714173228).Select
    Selection.ShapeRange.ScaleHeight 0.8636377302, msoFalse, _
        msoScaleFromBottomRight
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 67
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 745.7142519685, _
        1461.4285826772, 160.7143307087, 103.9285826772).Select
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 1
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("G3").Select
End Sub
Sub Macro65()
Attribute Macro65.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro65 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 16")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 18")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 45")).Select
    Selection.Delete
    ActiveWindow.LargeScroll Down:=1
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 19")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 20")).Select
    Selection.Delete
    ActiveWindow.LargeScroll Down:=1
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 21")).Select
    Selection.Delete
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 22")).Select
    Selection.Delete
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 23")).Select
    Selection.Delete
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 1
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo9"
'Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long

#If VBA7 Then
Private Declare PtrSafe Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#Else
Private Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long 'Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#End If


Private Const SW_SHOWMAXIMIZED = 3
' Option Explicit

#If VBA7 Then
Declare PtrSafe Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hwnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#Else
Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hwnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
'la riga sopra serve per Form_Load che verifica se ASB.exe |fffd| aperto lo attiva altrimenti lo carica chiamando Test2
'sotto fino a test2 serve per test2 che apre ASB.exe
#End If


Private Const GW_HWNDNEXT As Long = 2&
#If VBA7 Then
Private Declare PtrSafe Function FindWindow Lib "user32" _
Alias "FindWindowA" _
(ByVal lpClassName As Long, _
ByVal lpWindowName As Long) As Long
#Else
Private Declare Function FindWindow Lib "user32" _
Alias "FindWindowA" _
(ByVal lpClassName As Long, _
ByVal lpWindowName As Long) As Long
#End If


#If VBA7 Then
Private Declare PtrSafe Function GetParent Lib "user32" _
(ByVal hwnd As Long) As Long
#Else
Private Declare Function GetParent Lib "user32" _
(ByVal hwnd As Long) As Long
#End If


#If VBA7 Then
Private Declare PtrSafe Function GetWindowThreadProcessId Lib "user32" _
(ByVal hwnd As Long, _
lpdwProcessId As Long) As Long
#Else
Private Declare Function GetWindowThreadProcessId Lib "user32" _
(ByVal hwnd As Long, _
lpdwProcessId As Long) As Long
#End If


#If VBA7 Then
Public Declare PtrSafe Function GetWindow Lib "user32" _
(ByVal hwnd As Long, _
ByVal wCmd As Long) As Long
#Else
Public Declare Function GetWindow Lib "user32" _
(ByVal hwnd As Long, _
ByVal wCmd As Long) As Long
#End If


#If VBA7 Then
Private Declare PtrSafe Function SendMessageByString Lib "user32" _
Alias "SendMessageA" _
(ByVal hwnd As Long, _
ByVal wMsg As Long, _
ByVal wParam As Long, _
ByVal lParam As String) As Long
#Else
Private Declare Function SendMessageByString Lib "user32" _
Alias "SendMessageA" _
(ByVal hwnd As Long, _
ByVal wMsg As Long, _
ByVal wParam As Long, _
ByVal lParam As String) As Long
#End If


Private Const WM_SETTEXT = &HC
'Public Const GW_CHILD = 5

'Public Function HwndFromPID(ByVal pid As Long) As Long
 '   Dim lHWND As Long, lPid As Long
    
  '  lHWND = FindWindow(ByVal 0&, ByVal 0&)
   ' Do While lHWND <> 0&
    '    If GetParent(lHWND) = 0& Then
       '     Call GetWindowThreadProcessId(lHWND, lPid)
           ' If lPid = pid Then
              '  HwndFromPID = lHWND
               ' Exit Do
            'End If
        'End If
        'lHWND = GetWindow(lHWND, GW_HWNDNEXT)
    'Loop

'End Function
''''Sub sleep(i)

''''Dim newHour
''''Dim newMinute
''''Dim newSecond
''''Dim waitTime

''''newHour = Hour(Now())
''''newMinute = Minute(Now())
''''newSecond = Second(Now()) + i
''''waitTime = TimeSerial(newHour, newMinute, newSecond)
'Application.Cursor = xlDefault
''''Application.Wait waitTime

''''End Sub

Sub Test2222222222222222() 'era Test2 ma essendo un doppione di quella in modulo 4 l'ho praticamente eliminata cambiandole nome

    On Error Resume Next
    
'serve per aprire e dare la password a ASB.exe
    Dim lPid As Long, hwnd As Long
    Dim paths As String
    
    'Application.ScreenUpdating = False
    
    'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
   '''' DoEvents
    
    
   paths = ActiveWorkbook.Path
   'MsgBox path
   
    lPid = Shell(paths & "\ASB.exe ", vbNormalFocus)
        hwnd = HwndFromPID(lPid)
    hwnd = GetWindow(hwnd, GW_CHILD)
    'MsgBox hwnd
    DoEvents
    
    'Dim aaa
    'For aaa = 1 To 100000
    'If hwnd Then
    'MsgBox "atlavivadet!"
   ' sleep (1)
   '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''AppActivate "Exe Lock"
   AppActivate "Analisi Studio Ballarini"  ''''''''''''''''''''''''''''''''''''''''''''''''''
  DoEvents
   
   'sleep (1)
'doEvents
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("yalps1d")
DoEvents
'sleep (1)
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''SendKeys ("{ENTER}")
    DoEvents
    
    AppActivate "Analisi Studio Ballarini"
    ' Application.ScreenUpdating = True
    'GoTo 1500
    'End If
'Next

'1500
End Sub


Sub nomecognomeemail()

 
  Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Ricerca e acquisto - Registro Imprese - Internet Explorer")  'check to see if window exist and obtain its handle
    
    
    
    If Whnd <> 0 Then 'if Whnd isnt 0 then window exists
                
    On Error GoTo 22
    
    
 
AppActivate "Ricerca e acquisto - Registro Imprese - Internet Explorer"
Else
MsgBox "Ricerca e acquisto NOT OPEN"
Exit Sub

End If

Dim aa

SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("b9")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("c9")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("b11")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("c11")
For aa = 1 To 300
DoEvents
Next
Exit Sub
22
MsgBox "Ricerca e acquisto NOT OPEN"
End Sub
Sub nometitolareemail()


MSG1 = MsgBox("Are you in the credit card form and is the cursor in the field of credit card's number? If you press yes credit card's data will be input. ", vbYesNo, "Input Credit Card's Data")

If MSG1 = vbYes Then
  
 
  Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Portal Payment - Internet Explorer")  'check to see if window exist and obtain its handle
    
    
   If Whnd <> 0 Then 'if Whnd isnt 0 then window exists
                

 On Error GoTo 33
AppActivate "Portal Payment - Internet Explorer"
Else
MsgBox "Portal Payment NOT OPEN"
Exit Sub

End If


SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("j12")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys "{TAB}"
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("h12")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys "{TAB}"
'SendKeys "8"
'For aa = 1 To 300
'DoEvents
'Next
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
SendKeys "{TAB}"
'SendKeys "2017"
'For aa = 1 To 300
'DoEvents
'Next
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
'SendKeys "{DOWN}"
SendKeys "{TAB}"

SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("c9")
For aa = 1 To 300
DoEvents
Next
SendKeys " "
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("b9")
For aa = 1 To 300
DoEvents
Next
SendKeys "{TAB}"
SendKeys Sheets("BUY ITALIAN ANNUAL REPORT").Range("b11")
For aa = 1 To 300
DoEvents
Next
Exit Sub
33
MsgBox "Ricerca e acquisto NOT OPEN"
Exit Sub

Else
  
End If
End Sub
 
 
 
Sub GoToWebSiteAndPlayAround98()

'Dim shellwins As New shellwindows


Dim appIE3 As Object ' InternetExplorer.Application
Dim sURL2 As String
Dim cognome As Object ' MSHTML.IHTMLElement
Dim bilancio As Object ' MSHTML.IHTMLElement
Dim nome As Object ' MSHTML.IHTMLElement
Dim email As Object ' MSHTML.IHTMLElement
Dim email2 As Object ' MSHTML.IHTMLElement
Dim condizioni As Object ' MSHTML.IHTMLElement
Dim PW As Object ' MSHTML.  IHTMLElement
Dim Element As Object ' HTMLButtonElement
Dim btnInput As Object ' MSHTML.HTMLInputElement
Dim ElementCol As Object ' MSHTML.IHTMLElementCollection
Dim Link As Object ' MSHTML.HTMLAnchorElement
Dim strCountBody As String
Dim lStartPos As Long
Dim lEndPos As Long
Dim TextIWant As String
 
 Set appIE3 = GetIE
Dim shellwins2 As New ShellWindows
On Error Resume Next

For Each appIE3 In shellwins2
sURL2 = appIE3.LocationName
'MsgBox sURL
If sURL2 = "Ricerca e acquisto - Registro Imprese" Then
'MsgBox sURL
AppActivate "Ricerca e acquisto - Registro Imprese - Internet Explorer"

Set cognome = appIE3.Document.getElementsByName("cognome")
If Not cognome Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    cognome(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("b9")
End If

Set bilancio = appIE3.Document.getElementsByName("documenti.label.nome.bilancio")
If Not bilancio Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    bilancio(0).Click
End If

Set nome = appIE3.Document.getElementsByName("nome")
If Not nome Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    nome(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("c9")
End If

Set email = appIE3.Document.getElementsByName("email")
If Not email Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    email(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("b11")
End If

Set email2 = appIE3.Document.getElementsByName("email2")
If Not email2 Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    email2(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("c11")
End If

Set condizioni = appIE3.Document.getElementsByName("condizioni")
If Not condizioni Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    condizioni(0).Click
End If


 Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Ricerca e acquisto - Registro Imprese - Internet Explorer")  'check to see if window exist and obtain its handle
On Error Resume Next
AppActivate "Ricerca e acquisto - Registro Imprese - Internet Explorer"
        
        Dim MyHandle As Long
             MyHandle = Whnd 'FindtheWindow(myProcessID)
             ShowWindow MyHandle, SW_SHOWMAXIMIZED

        DoEvents
 




Exit Sub

End If

Next


MsgBox "Portal NOT OPEN"


'appIE3.Quit
End Sub


Sub GoToWebSiteAndPlayAround99()

'Dim shellwins As New shellwindows


Dim appIE4 As Object ' InternetExplorer.Application
Dim sURL8 As String
Dim cognome As Object ' MSHTML.IHTMLElement
Dim bilancio As Object ' MSHTML.IHTMLElement
Dim nome As Object ' MSHTML.IHTMLElement
Dim email As Object ' MSHTML.IHTMLElement
Dim email2 As Object ' MSHTML.IHTMLElement
Dim condizioni As Object ' MSHTML.IHTMLElement
Dim PW As Object ' MSHTML.  IHTMLElement
Dim Element As Object ' HTMLButtonElement
Dim btnInput As Object ' MSHTML.HTMLInputElement
Dim ElementCol As Object ' MSHTML.IHTMLElementCollection
Dim Link As Object ' MSHTML.HTMLAnchorElement
Dim strCountBody As String
Dim lStartPos As Long
Dim lEndPos As Long
Dim TextIWant As String
 On Error Resume Next
 
 Set appIE4 = GetIE
Dim shellwins4 As New ShellWindows

For Each appIE4 In shellwins4
sURL8 = appIE4.LocationName
'MsgBox sURL
If sURL8 = "Portal Payment" Then
'MsgBox sURL
AppActivate "Portal Payment - Internet Explorer"

Set card = appIE4.Document.getElementsByName("Ecom_Payment_Card_Number")
If Not card Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    card(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("j12")
End If


Set ccvxx = appIE4.Document.getElementsByName("Ecom_Payment_Card_Verification")
If Not ccvxx Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    ccvxx(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("h12")
End If
DoEvents


Set tito = appIE4.Document.getElementsByName("Ecom_Payment_Card_Name")
If Not tito Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    tito(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("c9") & " " & Sheets("BUY ITALIAN ANNUAL REPORT").Range("b9")
End If
DoEvents
Set email2 = appIE4.Document.getElementsByName("Ecom_Consumer_EMail_Address")
If Not email2 Is Nothing Then
    ' fill in first element named "username", assumed to be the login name field
    email2(0).Value = Sheets("BUY ITALIAN ANNUAL REPORT").Range("b11")
End If


Dim Whnd As Long 'set variable
    Whnd = FindWindowEx(0, 0, vbNullString, "Portal Payment - Internet Explorer")  'check to see if window exist and obtain its handle
On Error Resume Next
AppActivate "Portal Payment - Internet Explorer"
        
        Dim MyHandle As Long
             MyHandle = Whnd 'FindtheWindow(myProcessID)
             ShowWindow MyHandle, SW_SHOWMAXIMIZED

        DoEvents



Exit Sub


End If

Next
MsgBox "Portal Payment NOT OPEN"
appIE4.Quit
End Sub


Attribute VB_Name = "Modulo90"
Sub Macro66()
Attribute Macro66.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro66 Macro
'

'
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        198.2142519685, 19.2857480315, 13.9285826772).Select
    Range("C8").Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 16")).Select
    Selection.Delete
End Sub
Sub Macro67()
Attribute Macro67.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro67 Macro
'

'
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        198.2142519685, 442.5, 18.2143307087).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B10:E10").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        235.7142519685, 442.5, 13.9285826772).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, 285, _
        440.3571653543, 18.2142519685).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 24.6428346457, _
        351.4285826772, 438.2143307087, 19.2856692913).Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B38").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, 750, _
        440.3571653543, 40.7142519685).Select
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B52").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 24.6428346457, _
        1011.4285826772, 437.1429133858, 20.3571653543).Select
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 43
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 46
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B73").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 23.5714173228, _
        1374.6428346457, 371.7857480315, 17.1429133858).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("B81").Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 387.8571653543, _
        1172.1428346457, 72, 72).Select
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 25.7142519685, _
        1509.6428346457, 371.7857480315, 19.2857480315).Select
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 1
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
    Range("G3").Select
    Application.CommandBars("Format Object").Visible = False
End Sub
Sub Macro68()
Attribute Macro68.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro68 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17")).Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", _
        "Rounded Rectangle 18")).Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19")).Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19", "Rounded Rectangle 20")).Select
    ActiveWindow.LargeScroll Down:=1
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19", "Rounded Rectangle 20", "Rounded Rectangle 21")). _
        Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19", "Rounded Rectangle 20", "Rounded Rectangle 21", _
        "Rounded Rectangle 22")).Select
    ActiveWindow.LargeScroll Down:=1
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19", "Rounded Rectangle 20", "Rounded Rectangle 21", _
        "Rounded Rectangle 22", "Rounded Rectangle 23")).Select
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 17", "Rounded Rectangle 18" _
        , "Rounded Rectangle 19", "Rounded Rectangle 20", "Rounded Rectangle 21", _
        "Rounded Rectangle 22", "Rounded Rectangle 23", "Rounded Rectangle 25")). _
        Select
    Selection.Delete
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 2
End Sub
Sub Macro69()
Attribute Macro69.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro69 Macro
'

'
    ActiveSheet.Shapes.AddShape(msoShapeRoundedRectangle, 746.7857480315, _
        1461.4285826772, 156.428503937, 100.7142519685).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(162, 0, 0)
        .Transparency = 0.6999999881
        .Solid
    End With
End Sub
Sub Macro70()
Attribute Macro70.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro70 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Rounded Rectangle 27")).Select
    Selection.Delete
    ActiveWindow.ScrollRow = 66
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 25
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
End Sub
Attribute VB_Name = "Modulo91"
Sub EVIDENZE()
Attribute EVIDENZE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro71 Macro
'

'
On Error Resume Next
ActiveSheet.Unprotect
Application.ScreenUpdating = False

Range("B5:G5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone


    Range("B8:G8").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B10:G10").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B13:G13").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B17:G17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B8:G8").Select
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B10:G10").Select
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B13:G13").Select
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B17:G17").Select
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 40
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B17:E17").Select
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 11
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 29
    Range("B38:G39").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 40
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B52:G52").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B52").Select
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 53
    Range("B73:G73").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("B81:G81").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    DoEvents
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("L79:M83").Select
    With Selection.Interior
        .Pattern = xlGray16
        .PatternColor = 65535
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    DoEvents
    Range("L79").Select
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 48
    ActiveWindow.ScrollRow = 45
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 29
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 1
    Range("G3").Select
End Sub
Sub CANCELLAEVIDENZE()
Attribute CANCELLAEVIDENZE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro72 Macro
'

'
On Error Resume Next
ActiveSheet.Unprotect
Application.ScreenUpdating = False

    Range("B8:G8,B10:G10,B13:G13,B17:G17").Select
    Range("B17").Activate
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 17
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 19
    ActiveWindow.ScrollRow = 23
    ActiveWindow.ScrollRow = 26
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 31
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 33
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 35
    Range("B8:G8,B10:G10,B13:G13,B17:G17,B38:G39,B52:G52").Select
    Range("B52").Activate
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 38
    ActiveWindow.ScrollRow = 40
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 50
    ActiveWindow.ScrollRow = 51
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 65
    ActiveWindow.ScrollRow = 66
    Range("B5:G5,B8:G8,B10:G10,B13:G13,B17:G17,B38:G39,B52:G52,B73:G73,B81:F81,L79:M83"). _
        Select
    Range("L79").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("G81").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("L79:M83").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("B4:E81").Select
    Range("B81").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("F4:F81").Select
    Range("F81").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("H4:H81").Select
    Range("H81").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("H82").Select
    ActiveWindow.ScrollRow = 64
    ActiveWindow.ScrollRow = 63
    ActiveWindow.ScrollRow = 62
    ActiveWindow.ScrollRow = 61
    ActiveWindow.ScrollRow = 60
    ActiveWindow.ScrollRow = 59
    ActiveWindow.ScrollRow = 58
    ActiveWindow.ScrollRow = 57
    ActiveWindow.ScrollRow = 56
    ActiveWindow.ScrollRow = 55
    ActiveWindow.ScrollRow = 54
    ActiveWindow.ScrollRow = 52
    ActiveWindow.ScrollRow = 49
    ActiveWindow.ScrollRow = 47
    ActiveWindow.ScrollRow = 42
    ActiveWindow.ScrollRow = 39
    ActiveWindow.ScrollRow = 36
    ActiveWindow.ScrollRow = 34
    ActiveWindow.ScrollRow = 32
    ActiveWindow.ScrollRow = 30
    ActiveWindow.ScrollRow = 28
    ActiveWindow.ScrollRow = 27
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 18
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 7
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 1
    Range("G3").Select
End Sub
Attribute VB_Name = "Modulo92"
Sub evidenpers()
Attribute evidenpers.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro71 Macro
'

'
On Error Resume Next
Application.ScreenUpdating = False

    ActiveSheet.Unprotect
    Range("B14:G14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    
     ActiveSheet.Unprotect
    Range("B17:G17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    
    Range("G3").Select
End Sub
Sub Macro72()
Attribute Macro72.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro72 Macro
'

'
End Sub
Sub CANCELLAEVIDENPERS()
Attribute CANCELLAEVIDENPERS.VB_ProcData.VB_Invoke_Func = " \n14"
On Error Resume Next
'
' Macro73 Macro
'

'
Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    Range("B14:G14").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B14:E14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("G14").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
   ' Range("G3").Select
    
    
    
    Range("B17:G17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B17:E17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("G17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("G3").Select
    
    
    
    
End Sub


Sub evidenbilantres()
'
' Macro71 Macro
'

'
On Error Resume Next
Application.ScreenUpdating = False

    ActiveSheet.Unprotect
    Range("m79:m83").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    If Range("J1") = True Then
    
     ActiveSheet.Unprotect
    Range("B48:G48").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    ActiveSheet.Unprotect
    Range("B55:G55").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
   End If
    
    
    ActiveSheet.Unprotect
    Range("B52:G52").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    '////////////////
    
    ActiveSheet.Unprotect
    Range("B81:G81").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    '////////////////
    
    ActiveSheet.Unprotect
    Range("B68:G68").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    '////////////////
    
    
    ActiveSheet.Unprotect
    Range("B39:G39").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    
    
    
    ActiveSheet.Unprotect
    Range("B38:G38").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
    
       
    
    ActiveSheet.Unprotect
    Range("B73:G73").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Color = -16711681
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlGray8
        .PatternColor = 65535
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    
 
    
    '///////////
     ActiveSheet.Shapes.Range(Array("TextBox 1")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 255, 0)
        .Transparency = 0
        .Solid
    End With
    ActiveSheet.Shapes.Range(Array("TextBox 39")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 255, 0)
        .Transparency = 0
        .Solid
    End With
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveSheet.ChartObjects("Grafico 15").Activate
    Range("L1:O1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("G3").Select
  
End Sub



Sub CANCELLABALANTRES()
'
' Macro73 Macro
'

'

Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.ChartObjects("Grafico 15").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    Range("L1:O1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveSheet.Shapes.Range(Array("TextBox 1")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = 0
        .Transparency = 0
        .Solid
    End With
    ActiveSheet.Shapes.Range(Array("TextBox 39")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorBackground1
        .ForeColor.TintAndShade = 0
        .ForeColor.Brightness = 0
        .Transparency = 0
        .Solid
    End With
    ActiveWindow.ScrollRow = 2
    ActiveWindow.ScrollRow = 3
    ActiveWindow.ScrollRow = 4
    ActiveWindow.ScrollRow = 5
    ActiveWindow.ScrollRow = 6
    ActiveWindow.ScrollRow = 8
    ActiveWindow.ScrollRow = 9
    ActiveWindow.ScrollRow = 10
    ActiveWindow.ScrollRow = 12
    ActiveWindow.ScrollRow = 13
    ActiveWindow.ScrollRow = 14
    ActiveWindow.ScrollRow = 15
    ActiveWindow.ScrollRow = 16
    ActiveWindow.ScrollRow = 20
    ActiveWindow.ScrollRow = 21
    ActiveWindow.ScrollRow = 22
    ActiveWindow.ScrollRow = 24
    ActiveWindow.ScrollRow = 25
    Range("B38:G39").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlSolid
        .PatternThemeColor = xlThemeColorDark1
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B38:E39").Select
    Range("E38").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F38:F39").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ActiveWindow.SmallScroll Down:=6
    Range("B48:G48").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternThemeColor = xlThemeColorDark1
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("B48:E48").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F48").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ActiveWindow.SmallScroll Down:=15
    Range("B52:G52,B81:G81,B55:G55,B68:G68,B73:G73").Select
    Range("B73").Activate
    ActiveWindow.SmallScroll Down:=9
    Range("B52:G52,B81:G81,B55:G55,B68:G68,B73:G73,M79:M83").Select
    Range("M79").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    With Selection.Interior
        .Pattern = xlSolid
        .PatternThemeColor = xlThemeColorDark1
        .ColorIndex = 2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("M79:M83").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("B68:E74").Select
    ActiveWindow.SmallScroll Down:=-6
    Range("B68:E74,B55:E55").Select
    Range("B55").Activate
    ActiveWindow.SmallScroll Down:=-9
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ActiveWindow.SmallScroll Down:=9
    Range("F55:F74").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    '///////////////////----
    
     Range("F52").Select
    'Selection.Borders(xlDiagonalDown).LineStyle = xlNone
   ' Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    'With Selection.Borders(xlEdgeLeft)
      '  .LineStyle = xlContinuous
       ' .ColorIndex = 0
       ' .TintAndShade = 0
        '.Weight = xlThin
    'End With
    'Selection.Borders(xlEdgeTop).LineStyle = xlNone
    'Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    'Selection.Borders(xlEdgeRight).LineStyle = xlNone
    'Selection.Borders(xlInsideVertical).LineStyle = xlNone
    'Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    'Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    'Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F39").Select
    ActiveWindow.SmallScroll Down:=23
    Range("F81").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Sheets("BUDGETING").Select
    '///////////////////----
    
    
    
    Range("F64").Select
    ActiveWindow.SmallScroll Down:=-63
    Range("G3").Select
End Sub

Sub COPIAAGGREGATO()
MSG1 = MsgBox("Really do you want copy data ?", vbYesNo, "Clear?")

If MSG1 = vbYes Then


'*********************************
    On Error Resume Next
Application.ScreenUpdating = False
DoEvents
     Sheets("INPUT Statement").Select
    MacroRunning = True


  
Application.Calculation = xlManual


Application.ScreenUpdating = False

    Range("O1:P1").Select
    Selection.ClearContents
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "12/31/2018"
    Range("P2").Select
    ActiveCell.FormulaR1C1 = "12/31/2017"
    Range("O3:P15029").Select
    Selection.ClearContents
    Range("Q1").Select
    
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "=+R[165]C[-8]"
    Range("P1").Select
        
    
     MSG1 = ""
    
     Sheets("FREE full screening").Select
     
     Application.Calculation = xlAutomatic
MacroRunning = False
     
     '********************

On Error Resume Next
Application.ScreenUpdating = False
Set objExcel = GetObject(, "Excel.Application")
Set WB = objExcel.ActiveWorkbook
Set wbs = objExcel.Workbooks
If wbs.Count < 2 Then
MsgBox "Press the button Cut Excel Sheet before!"
Exit Sub
End If
If wbs.Count > 2 Then
MsgBox "Leave only opened the one Sheet to add!"
Exit Sub
End If


    ActiveWindow.ActivateNext
    
    
    DoEvents
    If Range("K1").Value <> "Eur/1000 x D2 or E2" Then
    If Range("K1").Value <> "Cur./1000 x D2 or E2" Then
    MsgBox "K1 is not Euro/1000 pheraps there are other sheets! Close your other sheets!"
     'Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
    Exit Sub
    End If
    End If
    
    If Range("K2").Value <> "H4" Then
    MsgBox "K2 is not H4 pheraps there are other sheets! Close your other sheets!"
    '    Range("B1") = nome2
    ActiveWindow.ActivateNext
    Application.Visible = True
Exit Sub
    End If
    
    
    
    
    
    Application.ScreenUpdating = False
    
    Range("F4:F88").Select
    Selection.Copy
    ActiveWindow.ActivateNext
    Sheets("INPUT Statement").Select
    Range("O2562").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.ActivateNext
    
   
    Range("H4:H88").Select
    Range("H88").Activate
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    Range("P2562").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O2561").Select
    
    
    
     ActiveWindow.ActivateNext
    Range("B1:J1").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveWindow.ActivateNext
    
    Range("O1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("P1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O1:P1").Select
    With Selection.Font
        .Name = "Arial"
        .Size = 6
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -10477568
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    
    Range("q3820:r3932").ClearContents
    
    
    Range("O1").Select
    
    Else
    End If
    
End Sub

Attribute VB_Name = "Modulo93"
Sub PERP24()
If Range("DT1") = True Then
Range("P24") = 100
Else: Range("P24") = ""
End If

End Sub
Attribute VB_Name = "Modulo94"
Sub flussicanalizzatori()
Attribute flussicanalizzatori.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro71 Macro
'

'
On Error GoTo saltare

Application.ScreenUpdating = False
ActiveSheet.Image4.Visible = False

   Range("A2").Select
   
If Range("F9") > 0 Then
    'ActiveSheet.Shapes.Range(Array("TextBox 22")).Select
    'ActiveSheet.Shapes.Range(Array("TextBox 22", "Picture 13")).Select
    ActiveSheet.Shapes.Range(Array("TextBox 22", "Picture 13", "Right Arrow 37" _
        )).Visible = False
        ActiveSheet.Shapes.Range(Array("TextBox 36")).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 38")).Visible = True
   ActiveSheet.Shapes.Range(Array("Block Arc 1")).Visible = False
 
    
    Else
    ActiveSheet.Shapes.Range(Array("TextBox 22", "Picture 13", "Right Arrow 37" _
        )).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 38")).Visible = False
    ActiveSheet.Shapes.Range(Array("TextBox 36")).Visible = False
    
    ActiveSheet.Shapes.Range(Array("Block Arc 1")).Visible = True
   
End If


If Range("AB1") > 0 Then
    
    ActiveSheet.Shapes.Range(Array("TextBox 44", "Picture 5", "Right Arrow 20" _
        )).Visible = False
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 32")).Visible = True
    ActiveSheet.Shapes.Range(Array("TextBox 39")).Visible = True
    ActiveSheet.Shapes.Range(Array("Block Arc 48")).Visible = False
   
     Else
     
       ActiveSheet.Shapes.Range(Array("TextBox 44", "Picture 5", "Right Arrow 20" _
        )).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 32")).Visible = False
    ActiveSheet.Shapes.Range(Array("TextBox 39")).Visible = False
     ActiveSheet.Shapes.Range(Array("Block Arc 48")).Visible = True
End If

If Range("AB2") > 0 Then
    
    ActiveSheet.Shapes.Range(Array("TextBox 45", "Picture 6", "Right Arrow 42" _
        )).Visible = False
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 41")).Visible = True
    ActiveSheet.Shapes.Range(Array("TextBox 47")).Visible = True
   ActiveSheet.Shapes.Range(Array("Block Arc 51")).Visible = True 'False
     Else
     
       ActiveSheet.Shapes.Range(Array("TextBox 45", "Picture 6", "Right Arrow 42" _
        )).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 41")).Visible = False
        ActiveSheet.Shapes.Range(Array("TextBox 47")).Visible = False
ActiveSheet.Shapes.Range(Array("Block Arc 51")).Visible = False 'True
    
End If


If Range("AB3") > 0 Then
    
    ActiveSheet.Shapes.Range(Array("TextBox 46", "Picture 12", "Right Arrow 35" _
        )).Visible = False
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 34")).Visible = True
    ActiveSheet.Shapes.Range(Array("TextBox 49")).Visible = True
      ActiveSheet.Shapes.Range(Array("Block Arc 50")).Visible = False

     Else
     
         ActiveSheet.Shapes.Range(Array("TextBox 46", "Picture 12", "Right Arrow 35" _
        )).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 34")).Visible = False
       ActiveSheet.Shapes.Range(Array("TextBox 49")).Visible = False
 ActiveSheet.Shapes.Range(Array("Block Arc 50")).Visible = True
    
End If

 
 
 If Range("AB4") > 0 Then
 
 ActiveSheet.Shapes.Range(Array("Picture 21")).Visible = True
    ActiveSheet.Shapes.Range(Array("Picture 7")).Visible = False
    
    ActiveSheet.Shapes.Range(Array("TextBox 30")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    End If
    
    If Range("F9") > 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 16")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    End If
    
    If Range("AB1") > 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 17")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    End If
    
    If Range("AB2") > 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 18")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    End If
    
    If Range("AB3") > 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 19")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    End If
      
 
   If Range("AB4") < 0 Then
   
   ActiveSheet.Shapes.Range(Array("Picture 21")).Visible = False
    ActiveSheet.Shapes.Range(Array("Picture 7")).Visible = True
   
    ActiveSheet.Shapes.Range(Array("TextBox 30")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
     End If
     
     
     If Range("F9") < 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 16")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
     End If
     
     If Range("AB1") < 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 17")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
     End If
     
     If Range("AB2") < 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 18")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
     End If
    
    If Range("AB3") < 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 19")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
     End If
    
    
saltare:
ActiveSheet.Shapes.Range(Array("Right Arrow 38")).Visible = False
   
    
ActiveSheet.Shapes.Range(Array("TextBox 22", "Picture 13", "Right Arrow 37" _
        )).Visible = True
    ActiveSheet.Shapes.Range(Array("Block Arc 1")).Visible = False
ActiveSheet.Shapes.Range(Array("TextBox 36")).Visible = True
ActiveSheet.Shapes.Range(Array("Block Arc 48")).Visible = False
ActiveSheet.Shapes.Range(Array("Right Arrow 32")).Visible = True
    ActiveSheet.Shapes.Range(Array("TextBox 39")).Visible = True
ActiveSheet.Shapes.Range(Array("TextBox 45", "Picture 6", "Right Arrow 42")).Visible = True
ActiveSheet.Shapes.Range(Array("Right Arrow 41")).Visible = True
        ActiveSheet.Shapes.Range(Array("TextBox 47")).Visible = True
ActiveSheet.Shapes.Range(Array("Block Arc 51")).Visible = False

ActiveSheet.Shapes.Range(Array("Block Arc 50")).Visible = False
ActiveSheet.Shapes.Range(Array("Right Arrow 34")).Visible = True
       ActiveSheet.Shapes.Range(Array("TextBox 49")).Visible = True
ActiveSheet.Shapes.Range(Array("Picture 7")).Visible = True
ActiveSheet.Shapes.Range(Array("Picture 21")).Visible = True

ActiveSheet.Shapes.Range(Array("TextBox 44", "Picture 5", "Right Arrow 20" _
        )).Visible = True
         ActiveSheet.Shapes.Range(Array("Block Arc 48")).Visible = False
         
         ActiveSheet.Shapes.Range(Array("TextBox 22", "Picture 13", "Right Arrow 37" _
        )).Visible = True
        ActiveSheet.Shapes.Range(Array("TextBox 36")).Visible = True
    
    ActiveSheet.Shapes.Range(Array("Right Arrow 38")).Visible = True
   ActiveSheet.Shapes.Range(Array("Block Arc 1")).Visible = False
    
    
    
    
    Range("A2").Select
End Sub
Attribute VB_Name = "Modulo95"
Sub Macro73()
Attribute Macro73.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro73 Macro
'

'

If Range("AB4") > 0 Then
    ActiveSheet.Shapes.Range(Array("TextBox 30")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(255, 0, 0)
        .Transparency = 0
        .Solid
    End With
    Range("A2").Select
    Else
    ActiveSheet.Shapes.Range(Array("TextBox 30")).Select
    With Selection.ShapeRange.TextFrame2.TextRange.Font.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(0, 64, 192)
        .Transparency = 0
        .Solid
    End With
    Range("A2").Select
    End If
    
End Sub
Attribute VB_Name = "Modulo96"
Sub Macro71()
Attribute Macro71.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro71 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Block Arc 1")).Select
    ActiveSheet.Shapes.Range(Array("Block Arc 1", "Block Arc 48")).Select
    ActiveSheet.Shapes.Range(Array("Block Arc 51")).Select
    Selection.ShapeRange.IncrementRotation 4.3057666667
    ActiveSheet.Shapes.Range(Array("Block Arc 50")).Select
    Selection.ShapeRange.IncrementLeft -3
    Selection.ShapeRange.IncrementTop -1.5
    Selection.ShapeRange.IncrementRotation 2.2227333333
    Selection.ShapeRange.IncrementLeft 1.5
    Selection.ShapeRange.IncrementTop 1.5
    Selection.ShapeRange.IncrementRotation -3.3704
    Range("R20").Select
End Sub
Attribute VB_Name = "Modulo97"
Sub Macro74()
Attribute Macro74.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro74 Macro
'

'
    ActiveSheet.Shapes.Range(Array("Picture 21")).Select
    ActiveSheet.Shapes.Range(Array("Picture 7")).Select
    Selection.ShapeRange.IncrementLeft -163.5
    Selection.ShapeRange.IncrementTop -3
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .UserPicture "C:\Users\Alfredo\Pictures\mulinello-nel-lavandino-32012403.jpg"
        .TextureTile = msoFalse
    End With
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .UserPicture "C:\Users\Alfredo\Pictures\mulinello-nel-lavandino-32012403.jpg"
        .TextureTile = msoFalse
        .RotateWithObject = msoTrue
    End With
    Selection.ShapeRange.ScaleWidth 1.3620696209, msoFalse, msoScaleFromBottomRight
    Selection.ShapeRange.ScaleHeight 1.3620701924, msoFalse, _
        msoScaleFromBottomRight
    Selection.ShapeRange.ScaleWidth 1.1645585097, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.ScaleHeight 1.164558157, msoFalse, msoScaleFromTopLeft
    Selection.ShapeRange.Fill.Visible = msoFalse
    Selection.ShapeRange.ZOrder msoSendToBack
    ActiveSheet.Shapes.Range(Array("Picture 21")).Select
    Range("A2").Select
End Sub
Attribute VB_Name = "Modulo98"
Sub Macro75()
Attribute Macro75.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro75 Macro
'

'
    Range("U8").Select
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlSubtract, _
        SkipBlanks:=False, Transpose:=False
End Sub
Attribute VB_Name = "Modulo99"
Function Col_Letter(lngCol As Long) As String
Dim vArr
vArr = Split(Cells(1, lngCol).Address(True, False), "$")
Col_Letter = vArr(0)
End Function
Sub Macro76()
Attribute Macro76.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro76 Macro
'

'
    ActiveWindow.SmallScroll Down:=1
End Sub

Sub MyZoom1()
On Error Resume Next
    Dim zArea As String
    'Application.ScreenUpdating = False
    zArea = "A13:B20"
    Range(zArea).Select
    ActiveWindow.Zoom = True
    'Application.ScreenUpdating = True
  End Sub
  
  Sub MyZoom1RETURN()
  On Error Resume Next
  Dim zArea As String
    zArea = "A13:B20"
    Range(zArea).Select
    ActiveWindow.Zoom = 60
    Range("A1").Select
End Sub

Sub MyZoom2()
On Error Resume Next
    Dim zArea As String
    'Application.ScreenUpdating = False
    zArea = "A21:B28"
    Range(zArea).Select
    ActiveWindow.Zoom = True
    'Application.ScreenUpdating = True
  End Sub
  
  Sub MyZoom2RETURN()
  On Error Resume Next
  Dim zArea As String
    zArea = "A21:B28"
    Range(zArea).Select
    ActiveWindow.Zoom = 60
    Range("A1").Select
End Sub

Sub MyZoom3()
On Error Resume Next
    Dim zArea As String
    'MsgBox Col_Letter(Range("aa1") + 1) & "12:" & Col_Letter(Range("aa1") + 1) & "26"
    'Exit Sub
    
    zArea = Col_Letter(Range("aa1") + 1) & "12:" & Col_Letter(Range("aa1") + 1) & "26"
    Range(zArea).Select
    ActiveWindow.Zoom = True
  End Sub
  
  Sub MyZoom3RETURN()
  On Error Resume Next
  Dim zArea As String
     zArea = Col_Letter(Range("aa1") + 1) & "12:" & Col_Letter(Range("aa1") + 1) & "26"
    Range(zArea).Select
    ActiveWindow.Zoom = 70
    Range("A1").Select
End Sub

Sub ELIMINA_fogli_per_exe()
Sheets("COVER").Select
    Sheets("Riclassificazioni economiche").Visible = True
    Sheets("Riclassificazioni economiche").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("INPUT Statement").Select
    Sheets("esempio fuzzy modulo142").Visible = True
    Sheets("esempio fuzzy modulo142").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("INPUT Statement").Select
    Sheets("BUY ITALIAN ANNUAL REPORT").Visible = True
    Sheets("BUY ITALIAN ANNUAL REPORT").Select
    Sheets("BUY ITALIAN ANNUAL REPORT").Move Before:=Sheets(16)
    ActiveWindow.ScrollWorkbookTabs Sheets:=1
    ActiveWindow.ScrollWorkbookTabs Sheets:=1
    Sheets("BUY ITALIAN ANNUAL REPORT").Select
    Sheets("BUY ITALIAN ANNUAL REPORT").Move Before:=Sheets(17)
    Sheets("BUY ITALIAN ANNUAL REPORT").Select
    Sheets("Stato Patrim x Checkup").Visible = True
    Sheets("Stato Patrim x Checkup").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("Conto Ec. x Checkup").Visible = True
    Sheets("Conto Ec. x Checkup").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("Check-Up").Visible = True
    Sheets("Check-Up").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("spiegacallequity").Visible = True
    Sheets("spiegacallequity").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("STIME").Visible = True
    Sheets("STIME").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("CLASSIFICHE").Select
    Sheets("ATECO").Visible = True
    Sheets("ATECO").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("Flusso Canalizzatore").Visible = True
    Sheets("Flusso Canalizzatore").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("full screening").Select
    Sheets("Chi crea VALORE AGGIUNTO").Visible = True
    Sheets("Chi crea VALORE AGGIUNTO").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("CHOICE FROM DATABASE").Select
    ActiveWindow.SelectedSheets.Visible = False
    Sheets("how much it's worth ").Select
    Sheets("% Dirigenti e Quadri").Visible = True
    Range("D18").Select
    Sheets("% Dirigenti e Quadri").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("how much it's worth ").Select
    Sheets("Approfondimento VALORE AGGIUNTO").Visible = True
    Sheets("Approfondimento VALORE AGGIUNTO").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("how much it's worth ").Select
    Sheets("Discounts and value added").Visible = True
    Sheets("Discounts and value added").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("how much it's worth ").Select
    Sheets("Come nascono debiti e liquidit|fffd|").Visible = True
    Sheets("Come nascono debiti e liquidit|fffd|").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("how much it's worth ").Select
    Sheets("Come nasce la (il) liquidit|fffd|").Visible = True
    Sheets("Come nasce la (il) liquidit|fffd|").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("how much it's worth ").Select
    ActiveWindow.ScrollWorkbookTabs Sheets:=-7
    ActiveWindow.ScrollWorkbookTabs Sheets:=-4
    Sheets("COVER").Select
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub cmdFindStockSymbol_Click()
Application.ScreenUpdating = False
Sheets("WORLD Quoted Data").Activate

Sheets("WORLD Quoted Data").Range("g13:z250").ClearContents
Sheets("WORLD Quoted Data").Range("b8:c8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b8:c8").ClearContents

Sheets("WORLD Quoted Data").Range("e8:g8").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e8:g8").ClearContents
    
Sheets("WORLD Quoted Data").Range("e9:g9").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("e9:g9").ClearContents

Sheets("WORLD Quoted Data").Range("b12:c12").Hyperlinks.Delete
Sheets("WORLD Quoted Data").Range("b12:c12").ClearContents

Sheets("WORLD Search ticker").Activate

Dim strSymbol As String

Application.ScreenUpdating = True



strSymbol = [rngNameToFind]
If strSymbol <> "" Then
Range([tblWebQueryNYSESymbol].Cells(1, 1), Cells.SpecialCells(xlCellTypeLastCell)).ClearContents

Searchterm _
         strSheetName:="WORLD Search ticker", _
         strConn:="URL;http://finance.yahoo.com/lookup?s=" & strSymbol, _
         strQryTblName:="tblWebQuerySymbol", _
         strDestRange:="B3", _
         strSrcTblList:="2"
Else
   MsgBox "No company name entered"
End If




End Sub

Private Sub Worksheet_Activate()

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit





'INTERESSANTE PER DISATTIVARE O ATTIVARE IL RIGHT CLICK SULLE CELLE
' Re: Enable Right Click Menu
   ' Open up the VBE (Alt+F11), open up the Immediate Window (if it isn't enabled) - Ctrl+G and type in there:
'Code:
'    Application.CommandBars("Cell").Enabled = True
'    and hit return. L'HO MESSO IN CELASVELARIBBON !

Private Sub Workbook_Activate()

'ActiveWorkbook.Protect Password:="28421284" 'NON SO PERCHE' MA FUNZIONA SOLO QUI IN ALTO! importantissima: SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO
'DoEvents
Application.DisplayAlerts = False  'importantissima: evita di vedere l'avviso che non si collega al file esterno perch|fffd| il csv se non |fffd| aperto non fornisce dati

'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice
 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
    DoEvents
    
'RemoveToolbars
Application.OnKey "{ESCAPE}", ""
Application.OnKey "%^+{RIGHT}", "CelaSvelaRibbon"
Application.OnKey "^{F3}", "fainiente"
Application.OnKey "^{F4}", "fainiente"
Application.OnKey "^{F6}", "fainiente"
Application.OnKey "^{F8}", "fainiente"
Application.OnKey "+{F3}", "fainiente"
Application.OnKey "{F3}", "stampare"
Application.OnKey "{F4}", "stampareport"
'per disattivare il right click sulle etichette col nome dei fogli
Application.CommandBars("Ply").Enabled = False

Application.OnKey "+{PGUP}", ""
Application.OnKey "+{PGDN}", ""

Application.OnKey "^{PGUP}", "zoomup"
Application.OnKey "^{PGDN}", "zoomdown"
Application.OnKey "^{RIGHT}", "windowsdx"
Application.OnKey "^{LEFT}", "windowssx"
Application.OnKey "^{UP}", "windowsup"
Application.OnKey "^{DOWN}", "windowsdown"
Application.OnKey "^{HOME}", "centrafinestre"

Application.OnKey "{F6}", "VISUALIZZARE"

End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)

On Error Resume Next



Call Shell("TaskKill /F /PID " & CStr(lPid))
        DoEvents
   


Call Shell("TaskKill /F /PID " & CStr(lPid2))
DoEvents


'in modulo1 ho messo la sub auto_close che impedisce venga chiesto il salvataggio in chiusura


'HO TOLTO I RIPRISTINI IN QUANTO METTO NELL'EXE CHE EXCEL SIA IN SESSIONE AUTONOMA
'ALTRIMENTI SE UNO FA ANNULLA IN CHIUSURA RIAPPARE IL MENU
'SERVE PER RIPRISTINARE IL NORMALE USO DEL TASTO F9
''''With Application
''''.OnKey "{ESCAPE}"
''''.OnKey "^{F3}"
''''.OnKey "+{F3}"
''''.OnKey "{F3}"
''''.OnKey "%^+{RIGHT}"
      ''''  .OnKey "{F8}"
      ''''  .OnKey "{F9}"
       '''' .OnKey "^{BREAK}"
         ''''End With
   ' RestoreToolbars
   ''''CelaSvelaRibbon
            
End Sub



Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

If Salvo = 1 Then
GoTo 44
End If

Dim msgpass
Dim mypass

'SERVE PER EVITARE IL SALVATAGGIO SOPRATTUTTO IN FORMATI DIVERSI CHE POSSONO FAR VEDERE IL CODICE NASCOSTO
Salvo = 0
msgpass = "Insert Password if you want to save:"
mypass = InputBox(msgpass, "Studio Alfredo Ballarini alfredo@ballarini.info", "")

If mypass = "28421284" Then
Salvo = 1
End If


44
If Salvo = 1 Then
'Application.Sheets("COVER").Image1.Visible = True
' importantissima: SE PROTEGGO LA CARTELLA DI LAVORO E SALVO NON PARTE PIU' L'EXE QUANDO COMPILO QUESTO FILE EXCEL CON XLSTOEXE (old SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO)
ActiveWorkbook.Unprotect Password:="28421284" 'PER EVITARE CHE QUANDO LO RIAPRO SIANO PIANTATE LE MACRO DI VISUAL BASIC
DoEvents
Salvo = 0
GoTo 4
End If


Dim lReply As Long
'''ThisWorkbook.ChangeFileAccess xlReadOnly
'If SaveAsUi = True Then
lReply = MsgBox("Protected copy: if you press Ok the workbook will be closed", vbQuestion + vbOKCancel)
Cancel = (lReply = vbCancel)
If Cancel = True Then

End
End If

'''''''''''''''''''''
Cancel = True
'''''''''''''''''''''
'MsgBox "chiuso"
'End If
ThisWorkbook.Close savechanges:=False
End
4

' importantissima: SE PROTEGGO LA CARTELLA DI LAVORO E SALVO NON PARTE PIU' L'EXE QUANDO COMPILO QUESTO FILE EXCEL CON XLSTOEXE (old SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO)
ActiveWorkbook.Unprotect Password:="28421284" 'PER EVITARE CHE QUANDO LO RIAPRO SIANO PIANTATE LE MACRO DI VISUAL BASIC
DoEvents
Salvo = 0




End Sub

Private Sub Workbook_Open()
'Application.Sheets("COVER").Image1.Visible = True
Application.ScreenUpdating = False
 Application.DecimalSeparator = ","
' importantissima: SE PROTEGGO LA CARTELLA DI LAVORO E SALVO NON PARTE PIU' L'EXE QUANDO COMPILO QUESTO FILE EXCEL CON XLSTOEXE (old SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO)
ActiveWorkbook.Protect Password:="28421284" 'NON SO PERCHE' MA FUNZIONA SOLO QUI IN ALTO! importantissima: SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO
DoEvents
Application.DisplayAlerts = False  'importantissima: evita di vedere l'avviso che non si collega al file esterno perch|fffd| il csv se non |fffd| aperto non fornisce dati
DoEvents
'SERVE PER FARE IN MODO CHE PREMENDO ctrl + pausa non si interrompa il codice

 Application.EnableCancelKey = xlDisabled
    'FINE SERVE PER TASTO
    DoEvents
    'Application.WindowState = xlMaximized
    'Application.Sheets("COVER").Image1.Visible = True
    
   ' Application.Cursor = xlWait              ' Clessidra
DoEvents

'////////////////////////////////// cambia collegamento formule alla dir di apertura di questo file
'Dim alinks As Variant

'alinks = ActiveWorkbook.LinkSources(Type:=xlExcelLinks)

 'ChDir ActiveWorkbook.Path
 
 
    'ActiveWorkbook.ChangeLink Name:=alinks(1), NewName:= _
        "MODELLO NORMALE.xbrl.csv", Type:=xlExcelLinks


'/////////////////////////////////


    
Salvo = 0  ' adesso serve per non far ricalcolare durante la creazione dell'area di stampa in id card mentre si apre il file, dopo invece la macro activate di id card deve funzionare
'servE DI NUOVO per poter salvare il file dopo aver impostato uno dei names con il valore che permette di lavorare solo su un pc

On Error Resume Next
Salvo = 0  ' adesso serve per non far ricalcolare durante la creazione dell'area di stampa in id card mentre si apre il file, dopo invece la macro activate di id card deve funzionare
'serviva per poter salvare il file dopo aver impostato uno dei names con il valore che permette di lavorare solo su un pc

Application.DisplayAlerts = False  'importantissima: evita di vedere l'avviso che non si collega al file esterno perch|fffd| il csv se non |fffd| aperto non fornisce dati
'ActiveWorkbook.Protect Password:="28421284" ' importantissima: SE PROTEGGO LA CARTELLA DI LAVORO DA MENU DI EXCEL E SALVO NON FUNZIONANO PIU' LE MACRO
Application.Iteration = True
'Application.ScreenUpdating = False



''''''''''''''''''Call GetiNetTime 'va a vedere la data su internet ************
'Call AREEDISTAMPA


'DoEvents
'Sheets("what it's worth").Range("M13") = 0
''''Sheets("what it's worth").Range("M13").FormulaLOCAL = "=ABS(IF(VALUE!I51>ABS(I15);(M16/SINTETIC!G17-1)/M15;((ABS(I15)-VALUE!I51)/SINTETIC!F17)/M15))"
'Sheets("what it's worth").Range("M13").FormulaLocal = "=ASS(SE(VALUE!I51>ASS(I15);(M16/SINTETIC!G17-1)/M15;((ASS(I15)-VALUE!I51)/SINTETIC!F17)/M15))"
            'Application.CalculateFull
              'DoEvents
'Application.DisplayAlerts = True

'Application.Cursor = xlDefault          ' Puntatore normale
'ActiveSheet.Image1.Visible = False

'Application.ScreenUpdating = True



'RemoveToolbars
CelaSvelaRibbon
ULTIMONUMERO = 300
Call apri

'Application.Sheets("COVER").Image1.Visible = False

Salvo = 0
Application.ScreenUpdating = True



'ThisWorkbook.Sheets("INPUT Statement").EnableCalculation = False

End Sub


' InQuest injected base64 decoded content
' j~4j
' tk.uk>v
' v+ZrX
' !P?I

INQUEST-PP=macro
