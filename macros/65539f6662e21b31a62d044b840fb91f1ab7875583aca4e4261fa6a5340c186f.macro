Attribute VB_Name = "CKP"
Option Private Module
Public query_result As String
Sub stahnout_ckp()
Application.ScreenUpdating = False

'Makro by pricing
'Pozn|fffd|mky Martina: pro|fffd| tady u toho n|fffd|co promaz|fffd|v|fffd|m? Druh a kod sazby? Jako|fffd|e kdy|fffd| u|fffd| m|fffd|m n|fffd|co vypln|fffd|n|fffd|ho, tak to sma|fffd|u a d|fffd|j se v|fffd|le bo|fffd||fffd|?
'Vy|fffd|aduje je|fffd|t|fffd| revizi

t = Now()

'Call odomkni Martina: smazat. Ne a ne a ne.



List43.Activate 'aktivace listu CKP_KT
ActiveSheet.PivotTables("KT_CKP").PivotCache.Refresh
ActiveSheet.PivotTables("KT_CKP_years").PivotCache.Refresh

Call STAHNI_ICO
    If vystup_ckp = 1 Then Exit Sub

Call main


'dopln|fffd|n|fffd| n|fffd|zvu firmy v p|fffd||fffd|pad|fffd|, |fffd|e jde o I|fffd|O
If List29.Range("pdb_poj_ico_rc") = "I|fffd|O" Then
    List29.Range("pdb_poj_on") = Sheets("oracle").Range("O_nazev_firmy")
End If

List34.Activate
List34.Range("sos_cas") = Format(Now() - t, "hh:mm:ss") ' cas - 8 sec

'Call zamkni pozn|fffd|mka Martina: ne ne ne a ne
End Sub


Sub main() 'upraveno pro agregovan|fffd| bonus
    Dim ICO_RC As String
    Dim name As String
    Dim length As Integer
    Dim state As String
    Dim result As String
    Dim error As String
    Dim radky As Integer
    
    Application.ScreenUpdating = False
    
    List53.Rows("2:1000000").EntireRow.ClearContents    'promaz|fffd|n|fffd| CKP DB
    'List53.Cells.Clear
    
    ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
    
    
    ICO_RC = List29.Range("pdb_poj_ic") 'zm|fffd|na na skute|fffd|n|fffd| I|fffd|O
    length = Len(ICO_RC)
    name = UCase(List29.Range("pdb_poj_on")) 'zm|fffd|na na skute|fffd|n|fffd| m|fffd|no
    state = List43.Range("ckp_stat")
    List43.Range("query_result") = ""
    
    
    Select Case length
        Case 9, 10
            List49.Visible = xlSheetVisible
            Call get_data("RC")
            'nakop|fffd|ruj data na list CKP_data
            List50.Range("A10:AJ100000").Clear 'vyma|fffd| data
            List50.Range("AK11:AR100000").Clear 'vyma|fffd| vzorce
            List49.Range("A1:AJ100000").Copy
            List50.Range("A10").PasteSpecial xlPasteValues
        Case 8
            List48.Visible = xlSheetVisible
            Call get_data("ICO")
            'nakop|fffd|ruj data na list CKP_data
            List50.Range("A10:AJ100000").Clear 'vyma|fffd| data
            List50.Range("AK11:AR100000").Clear 'vyma|fffd| vzorce
            List48.Range("A1:AJ100000").Copy
            List50.Range("A10").PasteSpecial xlPasteValues
    End Select
    
    List43.Range("query_result") = query_result
    result = List50.Range("B1")
    error = List50.Range("B2")
    'MsgBox ("V|fffd|sledek dotazu do |fffd|KP pro " & ICO_RC & ":" & Chr(13) & result & " " & error)
    If result = "KO" Then
        MsgBox ("Dotaz do |fffd|KP neprob|fffd|hl - dan|fffd| firma nem|fffd| |fffd||fffd|dnou historii. Bylo nastaveno z|fffd|kladn|fffd| pojistn|fffd|.")
        'Exit Sub
    End If
    
    'kopiruje vzorce
    radky = Application.WorksheetFunction.Max(0, Range("CKP_data!B4") - 1) 'pro p|fffd||fffd|pad, |fffd|e se nevr|fffd|t|fffd| |fffd||fffd|dn|fffd| z|fffd|zanm, radky mus|fffd| b|fffd|t >0
    Sheets("CKP_data").Range("I11:I100000").NumberFormat = "m/d/yyyy"


    List50.Range("AK9:AR9").Copy
    List50.Activate
    List50.Range("AK11", Range("AK11").Offset(radky, 7)).PasteSpecial
    Application.CutCopyMode = False
    
    'kopiruje poslednich apr sloupcu z listu ckp_data + dummy data na jeden list
    If result = "OK" Then
    List50.Range("AK10", Range("AK10").Offset(radky + 1, 7)).Copy
    Else
    List50.Range("AK10", Range("AK10").Offset(0, 7)).Copy
    End If
    
    List53.Activate
    List53.Range("A1").PasteSpecial xlPasteValues
    Application.CutCopyMode = False
    
    'upravit pro nov|fffd| kalend|fffd||fffd|n|fffd| rok kop|fffd|rovanou oblast, nebo p|fffd|idat budouc|fffd| dummy roky a upravit filtr roku v kont. tab!!!!!!
    List44.Range("A31:H272").Copy
    List53.Activate
    If result = "OK" Then
        List53.Range("A1").Offset(radky + 2, 0).PasteSpecial xlPasteValues
    Else
        List53.Range("A1").Offset(1, 0).PasteSpecial xlPasteValues
    End If
    
    Application.CutCopyMode = False
    
    'p|fffd|ejmenov|fffd|n|fffd| sloupc|fffd| do KT
     List53.Range("A1") = "year"
     List53.Range("B1") = "veh_id"
     List53.Range("C1") = "exposure"
     List53.Range("D1") = "claims"
     List53.Range("E1") = "payments"
     List53.Range("F1") = "rbns"
     List53.Range("G1") = "active"
     List53.Range("H1") = "veh"
   
    List43.Activate
    ActiveSheet.PivotTables("KT_CKP").PivotCache.Refresh
    ActiveSheet.PivotTables("KT_CKP_years").PivotCache.Refresh
   
    List48.Visible = xlSheetVeryHidden
    List49.Visible = xlSheetVeryHidden
    
    ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
End Sub


'D|fffd|le uveden|fffd| makra se vztahuj|fffd| ke sta|fffd|en|fffd| dat


'Public Const strTargetFile As String = "R:\!Pricing\VojtaH\!0 Velk|fffd| |fffd|koly (t|fffd|dny)\2018_01 volani CKP\response.xml"

'Public Const strTargetFile As String

'Dim strUserDocPath As String
'strUserDocPath = Environ("USERPROFILE") & "\My Documents"


Sub get_data(what As String) 'upraveno pro agregovan|fffd| bonus
  Dim sURL As String
  Dim sReq As String
  Dim user As String
  Dim Password As String
  Dim xmlhtp As New MSXML2.ServerXMLHTTP60
  Dim oXMLDoc As New MSXML2.DOMDocument60
  Dim strTargetFile As String
  Dim num As String
  Dim state As String
  Dim name As String
  'Dim query_result As String
  
 
  strTargetFile = Environ("USERPROFILE") & "\response.xml"
  num = List29.Range("pdb_poj_ic")
  state = List43.Range("ckp_stat")
  name = UCase(List29.Range("pdb_poj_on"))
  
  sURL = "https://esb-app-prod.allianz.cz:8000/CKPB1WS?wsdl"
  sReq = "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:ns=""http://www.syntea.cz/schema/ws/common/2012/03"" xmlns:ns1=""http://ws.ckp.cz/pis/bm/B1WS/2017/04"">" & vbCr
  sReq = sReq & "  <soapenv:Header/>" & vbCr
  sReq = sReq & "  <soapenv:Body>" & vbCr
  sReq = sReq & "    <ns1:Get_NositelPSPAgr>" & vbCr
  
  Select Case what
  Case "RC"
  sReq = sReq & "      <ns1:Nositel" & vbCr
  sReq = sReq & "                  Jmeno=" & Chr(34) & name & Chr(34) & vbCr
  sReq = sReq & "                  RC=" & Chr(34) & num & Chr(34) & vbCr
  sReq = sReq & "      />" & vbCr
  
  Case "ICO"
  sReq = sReq & "      <ns1:Nositel IC=" & Chr(34) & num & Chr(34) & " StatPrislusnost=" & Chr(34) & state & Chr(34) & "/>" & vbCr
  End Select
  
  sReq = sReq & "    </ns1:Get_NositelPSPAgr>" & vbCr
  sReq = sReq & "  </soapenv:Body>" & vbCr
  sReq = sReq & "</soapenv:Envelope>"
                              
  user = "af14kalk"
  Password = "8UMNugyKnz"

  xmlhtp.Open "POST", sURL, False
  xmlhtp.setRequestHeader "Content-Type", "text/xml"
  xmlhtp.setRequestHeader "Authorization", "Basic " & Base64Encode(user + ":" + Password)
  xmlhtp.send sReq
  query_result = xmlhtp.readyState
  
  
  oXMLDoc.LoadXML (xmlhtp.responseText)
  oXMLDoc.Save (strTargetFile)
  
  Call ImportXmlFromFile(what, strTargetFile)
  Kill (strTargetFile)
  
  Set oXMLDoc = Nothing
  Set xmlhtp = Nothing
End Sub
Function Base64Encode(sText) 'upraveno pro agregovan|fffd| bonus
  Dim oXML, oNode
  Set oXML = CreateObject("Msxml2.DOMDocument.3.0")
  Set oNode = oXML.createElement("base64")
  oNode.DataType = "bin.base64"
  oNode.nodeTypedValue = Stream_StringToBinary(sText)
  Base64Encode = oNode.text
  Set oNode = Nothing
  Set oXML = Nothing
End Function


Function Stream_StringToBinary(text) 'upraveno pro agregovan|fffd| bonus
  Const adTypeText = 2
  Const adTypeBinary = 1
  Dim BinaryStream 'As New Stream
  Set BinaryStream = CreateObject("ADODB.Stream")
  BinaryStream.Type = adTypeText
  BinaryStream.Charset = "us-ascii"
  BinaryStream.Open
  BinaryStream.WriteText text
  BinaryStream.Position = 0
  BinaryStream.Type = adTypeBinary
  BinaryStream.Position = 0
  Stream_StringToBinary = BinaryStream.Read
  Set BinaryStream = Nothing
End Function

Function Stream_BinaryToString(Binary) 'nov|fffd| pro agregovan|fffd| bonus
  Const adTypeText = 2
  Const adTypeBinary = 1
  Dim BinaryStream 'As New Stream
  Set BinaryStream = CreateObject("ADODB.Stream")
  BinaryStream.Type = adTypeBinary
  BinaryStream.Open
  BinaryStream.Write Binary
  BinaryStream.Position = 0
  BinaryStream.Type = adTypeText
  BinaryStream.Charset = "us-ascii"
  Stream_BinaryToString = BinaryStream.ReadText
  Set BinaryStream = Nothing
End Function

Sub ImportXmlFromFile(what As String, where As String) 'upraveno pro agregovan|fffd| bonus
  Select Case what
    Case "RC"
      List49.Activate
      ActiveWorkbook.XmlMaps("agr_RC").Import (where)
    Case "ICO"
      List48.Activate
      ActiveWorkbook.XmlMaps("agr_ICO").Import (where)
  End Select

End Sub



Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "rizdot_zpet, 2, 0, MSForms, CommandButton"
Private Sub rizdot_zpet_Click()
    List34.Activate
End Sub
Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "zamceni_kalkulacky, 1, 0, MSForms, CommandButton"

Private Sub zamceni_kalkulacky_Click()

ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")

jmeno_souboru = List10.Range("admin_uloz_jako") & ".xlsb"

List57.Range("vstup_pocet_vozidel") = 10
List57.Range("help_ulozeni") = False
List57.Range("help_mod_tisk") = False
List10.Range("Settings_user").ClearContents
List57.Range("help_ulozeni") = False
List57.Range("vstup_saz") = List57.Range("vstup_saz_akt")

'Nastaven|fffd| korekce slevy
List33.Activate
List33.Range("korekce_final").Copy
List33.Range("korekce_slevy").PasteSpecial xlPasteValues
Application.CutCopyMode = False

Call vycisti_nalevaci 'vy|fffd|ist|fffd| |fffd|daje na ZK a na nalevaci_af14

'p|fffd||fffd|prava listu s variantn|fffd| kalkulac|fffd|
Call zamkni_listy_typ_1(List6, "kalkv")

'p|fffd||fffd|prava listu se souhrnnou kalkulac|fffd|
Call zamkni_listy_typ_1(List22, "kalks")

'p|fffd||fffd|prava listu s povinn|fffd|m ru|fffd|en|fffd|m
Call zamkni_listy_typ_2(List60, "pr")

'p|fffd||fffd|prava listu s havarijn|fffd|m poji|fffd|t|fffd|n|fffd|m
Call zamkni_listy_typ_2(List59, "hp")
    
'p|fffd||fffd|prava listu s dopl|fffd|kov|fffd|m poji|fffd|t|fffd|n|fffd|m
Call zamkni_listy_typ_2(List19, "dp")

'p|fffd||fffd|prava listu s exportem
Call zamkni_listy_typ_1(List56, "export")


'dovymaz|fffd|n|fffd| listu se souhrnnou kalkulac|fffd|

    List34.Range("uw_adj_pr") = ""
    List34.Range("uw_adj_hp") = ""

'Vymaz|fffd|n|fffd| pdb
    List29.Range("pdb_poj_zaklad").ClearContents
    List29.Range("pdb_poj_tp").ClearContents
    List29.Range("pdb_poj_ka").ClearContents
    List29.Range("pdb_drz_zaklad").ClearContents
    List29.Range("pdb_drz_tp").ClearContents
    List29.Range("pdb_drz_ka").ClearContents
    List29.Range("pdb_vla_zaklad").ClearContents
    List29.Range("pdb_vla_tp").ClearContents
    List29.Range("pdb_vla_ka").ClearContents
    List29.Range("pdb_poj_dph") = False
    List29.Range("pdb_vla_dph") = False
    List29.Range("pdb_drz_dph") = False

'Vymaz|fffd|n|fffd| listu summary povinn|fffd|ho ru|fffd|en|fffd|
    List38.Range("prs_sleva_flotilova") = ""    'vymaz|fffd|n|fffd| flotilov|fffd| slevy na summary povinn|fffd|ho ru|fffd|en|fffd|
    List38.Range("prs_kusy") = ""   'vymaz|fffd|n|fffd| po|fffd|t|fffd| aut na summary povinn|fffd|ho ru|fffd|en|fffd|
    List57.Range("kalk_prs_pl") = False     'nastaven|fffd| p|fffd||fffd|m|fffd| likvidace na summary povinn|fffd|ho ru|fffd|en|fffd| na false

'vymaz|fffd|n|fffd| listu povinn|fffd| ru|fffd|en|fffd|
    List60.Range("pr_flotilova_sleva").ClearContents
    List60.Range("pr_limit").ClearContents
    List57.Range("pr_pl_volba") = False
    List57.Range("propojistenost_volba") = True

'vymaz|fffd|n|fffd| listu havarijn|fffd| poji|fffd|t|fffd|n|fffd|
    List59.Range("hp_flotilova_sleva").ClearContents
    List57.Range("hp_havarie_volba") = True
    List57.Range("hp_zivel_volba") = True
    List57.Range("hp_odcizeni_volba") = True
    List59.Range("hp_spoluucast") = ""
    List57.Range("propojistenost_volba") = True

'p|fffd||fffd|prava listu legenda_druh
List17.Unprotect Password:=List10.Range("pswd_view")
List17.Range("legenda_druh_skryt").EntireColumn.Hidden = True

'p|fffd||fffd|prava listu souhrn o spole|fffd|nosti
List34.Unprotect
List34.Range("sos_skryt").EntireRow.Hidden = True


'p|fffd||fffd|prava listu vstup
List18.Unprotect Password:=List10.Range("pswd_view")
If List18.Range("vstup_nemakra").EntireRow.Hidden Then List18.Range("vstup_nemakra").EntireRow.Hidden = False
List18.Activate
ActiveWindow.DisplayHeadings = False
List18.Range("A1").Activate

'nastaven|fffd| I|fffd|O / R|fffd| vstupn|fffd| obrazovky
form_vstup.combox_rc_ic.Value = "I|fffd|O"
form_vstup.textbox_prijmeni.Locked = True
    
For Each ws In Worksheets
    If ws.name <> "vstup" Then
        If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then 'zobraz|fffd| a zamkne
            Sheets(ws.name).Activate
            ActiveWindow.DisplayHeadings = False
            Sheets(ws.name).Range("A1").Activate
            Sheets(ws.name).Protect Password:=List10.Range("pswd_view"), AllowFormattingRows:=True, AllowFiltering:=True
        End If
        Sheets(ws.name).Visible = xlVeryHidden
    End If
Next ws

ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
List18.Activate

ActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path & "\" & jmeno_souboru
End Sub
Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "legenda_druh_zpet, 1, 0, MSForms, CommandButton"
Private Sub legenda_druh_zpet_Click()
    List60.Activate
End Sub
Attribute VB_Name = "List18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "dp_menu_kalkv, 9, 2, MSForms, Label"
Attribute VB_Control = "dp_menu_kalks, 8, 3, MSForms, Label"
Attribute VB_Control = "dp_menu_dp, 7, 4, MSForms, Label"
Attribute VB_Control = "dp_menu_hp, 6, 5, MSForms, Label"
Attribute VB_Control = "dp_menu_pr, 5, 6, MSForms, Label"
Attribute VB_Control = "dp_menu_prs, 4, 7, MSForms, Label"
Attribute VB_Control = "dp_menu_sos, 3, 8, MSForms, Label"
Private Sub dp_menu_kalkv_Click()
    List6.Activate
End Sub
Private Sub dp_menu_kalks_Click()
    List22.Activate
End Sub
Private Sub dp_menu_dp_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub

Private Sub dp_menu_hp_Click()
    List59.Activate
End Sub

Private Sub dp_menu_pr_Click()
    List60.Activate
End Sub

Private Sub dp_menu_prs_Click()
    List38.Activate
End Sub

Private Sub dp_menu_sos_Click()
    List34.Activate
End Sub



Private Sub Worksheet_Change(ByVal Target As Range)
    If List19.Range("dp_kontrola_uraz") > 0 Then
        MsgBox "Jednon|fffd|sobek je mo|fffd|n|fffd| sjednat maxim|fffd|ln|fffd| pro 75 m|fffd|st k sezen|fffd|, dvojn|fffd|sobek maxim|fffd|ln|fffd| pro 35 a trojn|fffd|sobek pro 25 m|fffd|st k sezen|fffd|."
    End If
    If List19.Range("dp_kontrola_skla") > 0 Then
        MsgBox "Zvolen|fffd| limit nen|fffd| povolen pro druh vozidla TAH, ABM, TBM, AB1B, AB2"
    End If
End Sub
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "kalks_menu_export, 10, 2, MSForms, Label"
Attribute VB_Control = "kalks_menu_kalkv, 7, 3, MSForms, Label"
Attribute VB_Control = "kalks_menu_kalks, 6, 4, MSForms, Label"
Attribute VB_Control = "kalks_menu_dp, 5, 5, MSForms, Label"
Attribute VB_Control = "kalks_menu_hp, 4, 6, MSForms, Label"
Attribute VB_Control = "kalks_menu_pr, 3, 7, MSForms, Label"
Attribute VB_Control = "kalks_menu_prs, 2, 8, MSForms, Label"
Attribute VB_Control = "kalks_menu_sos, 1, 9, MSForms, Label"
Private Sub kalks_menu_dp_Click()
    List19.Activate
End Sub

Private Sub kalks_menu_export_Click()
jmeno_listu = List22.name
Call export_listu(jmeno_listu)
End Sub

Private Sub kalks_menu_sos_Click()
    List34.Activate
End Sub


Private Sub kalks_menu_hp_Click()
    List59.Activate
End Sub

Private Sub kalks_menu_pr_Click()
    List60.Activate
End Sub
Private Sub kalks_menu_prs_Click()
    List38.Activate
End Sub

Private Sub kalks_menu_kalks_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub
Private Sub kalks_menu_kalkv_Click()
    List6.Activate
End Sub
Attribute VB_Name = "List23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "legenda_kod_zpet, 4, 0, MSForms, CommandButton"
Private Sub legenda_kod_zpet_Click()
    List59.Activate
End Sub
Attribute VB_Name = "List24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "sos_rizdot, 61, 2, MSForms, CommandButton"
Attribute VB_Control = "sos_export_dalsi, 60, 3, MSForms, CommandButton"
Attribute VB_Control = "sos_ckp, 57, 4, MSForms, CommandButton"
Attribute VB_Control = "sos_export, 55, 5, MSForms, CommandButton"
Attribute VB_Control = "sos_menu_kalkv, 51, 6, MSForms, Label"
Attribute VB_Control = "sos_menu_kalks, 50, 7, MSForms, Label"
Attribute VB_Control = "sos_menu_dp, 49, 8, MSForms, Label"
Attribute VB_Control = "sos_menu_hp, 48, 9, MSForms, Label"
Attribute VB_Control = "sos_menu_pr, 47, 10, MSForms, Label"
Attribute VB_Control = "sos_menu_prs, 46, 11, MSForms, Label"
Attribute VB_Control = "sos_menu_sos, 45, 12, MSForms, Label"
Attribute VB_Control = "sos_sleva_prirazka, 37, 13, MSForms, CommandButton"
Attribute VB_Control = "sos_info_spolecnost, 54, 14, MSForms, CommandButton"
Attribute VB_Control = "sos_mod_pro_tisk, 56, 15, MSForms, CheckBox"
Private Sub sos_sleva_prirazka_Click()

'Makro by pricing


If List57.Range("datum_rozdil").Value < 0 Then
    MsgBox "Skon|fffd|ila platnost kalkula|fffd|ky. Makro nelze spustit.", vbCritical
    Exit Sub
End If


provize = List40.Range("tp_provize")
pocet_aut_pov = List43.Range("ckp_pocet_pr")
pocet_aut_hav = List43.Range("ckp_pocet_hp")

pocet_aut_ckp = List43.Range("E32") 'je to sou|fffd|et kontingen|fffd|n|fffd| tabulky

If pocet_aut_pov = 0 And pocet_aut_hav = 0 Then
MsgBox ("|fffd||fffd|dn|fffd| auto v seznamu pro kalkulaci. P|fffd|idejte alespo|fffd| 1 auto.")
End
End If

If provize < 0 Or provize > 0.3 Or provize = "" Then
MsgBox ("Vypl|fffd|te provizi, mus|fffd| b|fffd|t mezi 0 a 30 %")
End
End If

sleva_pov = -List43.Range("ckp_sleva_pr") * 100
List60.Range("pr_flotilova_sleva") = sleva_pov / 100

sleva_hav = -List43.Range("ckp_sleva_pr") * 100
List59.Range("hp_flotilova_sleva") = sleva_hav / 100
'nastav|fffd| slevu POV (porovn|fffd| TP a cenu bez slevy), dojde k p|fffd|epo|fffd|tu pojistn|fffd|ho, zm|fffd|n|fffd| se ulae (% z poj po slev|fffd|)!
'proto nejd|fffd||fffd|v aplikuju p|fffd|vodn|fffd| slevu
'a mus|fffd|m j|fffd| p|fffd|epo|fffd||fffd|tat - pokud ji zaokrouhl|fffd|m, nemus|fffd|m to opakovat v|fffd|ckr|fffd|t:
'alternativn|fffd| po|fffd||fffd|tat ULAE z pojistn|fffd|ho p|fffd|ed slevou

sleva_pov = -List43.Range("ckp_sleva_pr") * 100
List60.Range("pr_flotilova_sleva") = sleva_pov / 100

sleva_hav = -List43.Range("ckp_sleva_hp") * 100
List59.Range("hp_flotilova_sleva") = sleva_hav / 100

If pocet_aut_pov = 0 Then
MsgBox ("|fffd||fffd|dn|fffd| auto s POV")
sleva_pov = 0
List60.Range("pr_flotilova_sleva") = 0
End If

If pocet_aut_hav = 0 Then
MsgBox ("|fffd||fffd|dn|fffd| auto s HAV")
sleva_hav = 0
List59.Range("hp_flotilova_sleva") = 0
End If


slpr_pov = "Sleva POV "
If sleva_pov > 0 Then slpr_pov = "P|fffd|ir|fffd|ka POV "

slpr_hav = "Sleva HAV "
If sleva_hav > 0 Then slpr_hav = "P|fffd|ir|fffd|ka HAV "


msg = "Po|fffd|et aut POV " & pocet_aut_pov
msg = msg & vbCrLf & "Po|fffd|et aut HAV " & pocet_aut_hav
msg = msg & vbCrLf & "Po|fffd|et aktivn|fffd|ch aut v |fffd|KP " & pocet_aut_ckp
msg = msg & vbCrLf & slpr_pov & sleva_pov & "%"
msg = msg & vbCrLf & slpr_hav & sleva_hav & "%"

MsgBox (msg)

End Sub



Private Sub sos_ckp_Click()

If List57.Range("datum_rozdil").Value < 0 Then
    MsgBox "Skon|fffd|ila platnost kalkula|fffd|ky. Makro nelze spustit.", vbCritical
    Exit Sub
End If

Application.ScreenUpdating = False
vystup_ckp = 0
Call stahnout_ckp

If vystup_ckp = 1 Then 'toto by |fffd|lo ur|fffd|it|fffd| do budoucna ud|fffd|lat inteligentn|fffd|ji
    MsgBox "Sta|fffd|en|fffd| a zpracov|fffd|n|fffd| dat |fffd|KP nebylo |fffd|sp|fffd|n|fffd|.", vbInformation
    ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other") 'toto d|fffd|l|fffd|m vylo|fffd|en|fffd| pro jistotu, aby se to fakt znovu zamklo, kdyby to bylo n|fffd|hodou odem|fffd|en|fffd|
    ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
    Application.ScreenUpdating = True
    Exit Sub
End If

ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other") 'toto d|fffd|l|fffd|m vylo|fffd|en|fffd| pro jistotu, aby se to fakt znovu zamklo, kdyby to bylo n|fffd|hodou odem|fffd|en|fffd|
ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
Application.ScreenUpdating = True

End Sub

Private Sub sos_export_Click()
'If List57.Range("datum_rozdil").Value < 0 Then    ... bylo rozhodnuto, |fffd|e export je mo|fffd|n|fffd| d|fffd|lat i po skon|fffd|en|fffd| kalkula|fffd|ky
'    MsgBox "Skon|fffd|ila platnost kalkula|fffd|ky. Makro nelze spustit.", vbCritical
'    Exit Sub
'End If
form_export_aut.Show
End Sub

Private Sub sos_export_dalsi_Click()
    List56.Activate
End Sub

Private Sub sos_info_spolecnost_Click()
If List57.Range("datum_rozdil").Value < 0 Then
    MsgBox "Skon|fffd|ila platnost kalkula|fffd|ky. Makro nelze spustit.", vbCritical
    Exit Sub
End If
form_info_spolecnost.Show
End Sub

Private Sub sos_menu_dp_Click()
    List19.Activate
End Sub

Private Sub sos_menu_hp_Click()
    List59.Activate
End Sub

Private Sub sos_menu_kalkv_Click()
    List6.Activate
End Sub
Private Sub sos_menu_kalks_Click()
    List22.Activate
End Sub

Private Sub sos_menu_pr_Click()
    List60.Activate
End Sub

Private Sub sos_menu_prs_Click()
    List38.Activate
End Sub

Private Sub sos_menu_sos_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub


Private Sub sos_rizdot_Click()
    List1.Activate
End Sub
Attribute VB_Name = "List35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "prs_menu_kalkv, 20, 7, MSForms, Label"
Attribute VB_Control = "prs_menu_kalks, 19, 8, MSForms, Label"
Attribute VB_Control = "prs_menu_dp, 18, 9, MSForms, Label"
Attribute VB_Control = "prs_menu_hp, 17, 10, MSForms, Label"
Attribute VB_Control = "prs_menu_pr, 16, 11, MSForms, Label"
Attribute VB_Control = "prs_menu_prs, 15, 12, MSForms, Label"
Attribute VB_Control = "prs_menu_sos, 14, 13, MSForms, Label"
Attribute VB_Control = "CheckBox1, 8, 14, MSForms, CheckBox"
Private Sub prs_menu_kalkv_Click()
    List6.Activate
End Sub
Private Sub prs_menu_kalks_Click()
    List22.Activate
End Sub

Private Sub prs_menu_dp_Click()
    List19.Activate
End Sub

Private Sub prs_menu_hp_Click()
    List59.Activate
End Sub

Private Sub prs_menu_pr_Click()
    List60.Activate
End Sub

Private Sub prs_menu_sos_Click()
    List34.Activate
End Sub

Private Sub prs_menu_prs_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub

Private Sub prs_skryti_moznosti_Click()
' Skr|fffd|v|fffd| a zobrazuje voliteln|fffd| mo|fffd|nosti na list|fffd| povinn|fffd| ru|fffd|en|fffd| summary

If ActiveSheet.Range("prs_vyber_moznosti").EntireRow.Hidden = False Then
    ActiveSheet.Range("prs_vyber_moznosti").EntireRow.Hidden = True
    ActiveSheet.Range("prs_skryti_nastaveni") = 1
Else
    ActiveSheet.Range("prs_vyber_moznosti").EntireRow.Hidden = False
    ActiveSheet.Range("prs_skryti_nastaveni") = 0
End If

End Sub

'Private Sub Worksheet_Change(ByVal Target As Range)
'    If List38.Range("prs_sleva_flotilova") <> List60.Range("pr_flotilova_sleva") Or List38.Range("prs_sleva_flotilova") <> List59.Range("hp_flotilova_sleva") Then
'        List60.Range("pr_flotilova_sleva") = List38.Range("prs_sleva_flotilova")
'        List59.Range("hp_flotilova_sleva") = List38.Range("prs_sleva_flotilova")
'        MsgBox "Flotilov|fffd| sleva byla zm|fffd|n|fffd|na i na povinn|fffd|m ru|fffd|en|fffd| a havarijn|fffd|m poji|fffd|t|fffd|n|fffd|."
'    End If
'End Sub
Attribute VB_Name = "List39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List56"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ev_zpet, 1, 0, MSForms, CommandButton"
Private Sub ev_zpet_Click()
    List34.Activate
End Sub
Attribute VB_Name = "List57"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List58"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List59"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "hp_menu_kalkv, 28, 9, MSForms, Label"
Attribute VB_Control = "hp_menu_kalks, 27, 10, MSForms, Label"
Attribute VB_Control = "hp_menu_dp, 26, 11, MSForms, Label"
Attribute VB_Control = "hp_menu_hp, 25, 12, MSForms, Label"
Attribute VB_Control = "hp_menu_pr, 24, 13, MSForms, Label"
Attribute VB_Control = "hp_menu_prs, 23, 14, MSForms, Label"
Attribute VB_Control = "hp_menu_sos, 22, 15, MSForms, Label"
Attribute VB_Control = "CheckBox5, 13, 16, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 12, 17, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 11, 18, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 10, 19, MSForms, CheckBox"
Attribute VB_Control = "hp_skryti_moznosti, 3, 20, MSForms, Label"
Attribute VB_Control = "hp_mod_pro_tisk, 44, 21, MSForms, CheckBox"
Private Sub hp_form_akce_Click()
    form_akce.Show
End Sub

Private Sub hp_form_prirazky_Click()
    form_prirazky.Show
End Sub

Private Sub hp_form_zabezpeceni_Click()
    form_zabezpeceni.Show
End Sub

Private Sub hp_menu_kalkv_Click()
    List6.Activate
End Sub
Private Sub hp_menu_kalks_Click()
    List22.Activate
End Sub

Private Sub hp_menu_dp_Click()
    List19.Activate
End Sub

Private Sub hp_menu_hp_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub

Private Sub hp_menu_pr_Click()
    List60.Activate
End Sub

Private Sub hp_menu_prs_Click()
    List38.Activate
End Sub

Private Sub hp_menu_sos_Click()
    List34.Activate
End Sub

Private Sub hp_skryti_moznosti_Click()
If ActiveSheet.Range("hp_vyber_moznosti").EntireRow.Hidden = False Then
    ActiveSheet.Range("hp_vyber_moznosti").EntireRow.Hidden = True
    ActiveSheet.Range("hp_skryti_nastaveni") = 1
Else
    ActiveSheet.Range("hp_vyber_moznosti").EntireRow.Hidden = False
    ActiveSheet.Range("hp_skryti_nastaveni") = 0
End If
End Sub

'Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, cancel As Boolean)
'If Not Intersect(Target, Range("hp_pocatek_pojisteni")) Is Nothing Then
'   List57.Range("datum_hp_zvolene").Value = List57.Range("datum_hp_nastavit").Value
'   form_kalendar_tab.Show
'End If
'cancel = True
'End Sub

'Private Sub Worksheet_Change(ByVal Target As Range)
'    If List59.Range("hp_flotilova_sleva") <> List60.Range("pr_flotilova_sleva") Or List59.Range("hp_flotilova_sleva") <> List38.Range("prs_sleva_flotilova") Then
'        List60.Range("pr_flotilova_sleva") = List59.Range("hp_flotilova_sleva")
'        List38.Range("prs_sleva_flotilova") = List59.Range("hp_flotilova_sleva")
'        MsgBox "Flotilov|fffd| sleva byla zm|fffd|n|fffd|na i na povinn|fffd|m ru|fffd|en|fffd|."
'    End If
'End Sub
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "kalkv_menu_kalkv, 14, 7, MSForms, Label"
Attribute VB_Control = "kalkv_menu_kalks, 13, 8, MSForms, Label"
Attribute VB_Control = "kalkv_menu_dp, 12, 9, MSForms, Label"
Attribute VB_Control = "kalkv_menu_hp, 11, 10, MSForms, Label"
Attribute VB_Control = "kalk_menu_pr, 10, 11, MSForms, Label"
Attribute VB_Control = "kalkv_menu_prs, 9, 12, MSForms, Label"
Attribute VB_Control = "kalkv_menu_sos, 8, 13, MSForms, Label"
Private Sub kalkv_menu_dp_Click()
    List19.Activate
End Sub
Private Sub kalkv_menu_sos_Click()
    List34.Activate
End Sub
Private Sub kalkv_menu_hp_Click()
    List59.Activate
End Sub

Private Sub kalkv_menu_pr_Click()
    List60.Activate
End Sub
Private Sub kalkv_menu_prs_Click()
    List38.Activate
End Sub
Private Sub kalkv_menu_kalkv_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub
Private Sub kalkv_menu_kalks_Click()
    List22.Activate
End Sub

Attribute VB_Name = "List60"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "pr_menu_kalkv, 10, 0, MSForms, Label"
Attribute VB_Control = "pr_menu_kalks, 9, 1, MSForms, Label"
Attribute VB_Control = "pr_menu_dp, 8, 2, MSForms, Label"
Attribute VB_Control = "pr_menu_hp, 7, 3, MSForms, Label"
Attribute VB_Control = "pr_menu_pr, 6, 4, MSForms, Label"
Attribute VB_Control = "pr_menu_prs, 5, 5, MSForms, Label"
Attribute VB_Control = "pr_menu_sos, 4, 6, MSForms, Label"
Attribute VB_Control = "CheckBox2, 3, 7, MSForms, CheckBox"
Attribute VB_Control = "CheckBox1, 2, 8, MSForms, CheckBox"
Attribute VB_Control = "pr_skryti_moznosti, 1, 9, MSForms, Label"
Attribute VB_Control = "pr_mod_pro_tisk, 11, 10, MSForms, CheckBox"
Private Sub pr_menu_dp_Click()
    List19.Activate
End Sub

Private Sub pr_menu_hp_Click()
    List59.Activate
End Sub

Private Sub pr_menu_kalkv_Click()
    List6.Activate
End Sub
Private Sub pr_menu_kalks_Click()
    List22.Activate
End Sub

Private Sub pr_menu_pr_Click()
    MsgBox "Na t|fffd|to str|fffd|nce se aktu|fffd|ln|fffd| nach|fffd|z|fffd|te.", vbInformation
End Sub

Private Sub pr_menu_prs_Click()
    List38.Activate
End Sub

Private Sub pr_menu_sos_Click()
    List34.Activate
End Sub

Private Sub pr_skryti_moznosti_Click()
If ActiveSheet.Range("pr_vyber_moznosti").EntireRow.Hidden = False Then
    ActiveSheet.Range("pr_vyber_moznosti").EntireRow.Hidden = True
    ActiveSheet.Range("pr_skryti_nastaveni") = 1
Else
    ActiveSheet.Range("pr_vyber_moznosti").EntireRow.Hidden = False
    ActiveSheet.Range("pr_skryti_nastaveni") = 0
End If
End Sub


Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    If Target.SubAddress = "pr_zpusob_pouziti" Then
        form_zpusob_pouziti.Show
    End If
End Sub



'Private Sub Worksheet_Change(ByVal Target As Range)
'If List60.Range("pr_pom_radek").EntireRow.Hidden = False Then List60.Range("pr_pom_radek").EntireRow.Hidden = True
'End Sub
Attribute VB_Name = "List61"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List62"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List63"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List64"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List65"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List66"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List67"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List68"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List69"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List70"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List71"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List72"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List73"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List74"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List75"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ORA_DWH"
Option Private Module
Public conn_dwh As New Connection

Public Sub STAHNI_ICO()

Dim uspech_pripojeni As Boolean
Dim uspech_skriptu As Boolean

Dim RS As New ADODB.Recordset
Dim Cmd As New ADODB.Command

'PRIPOJENI K DATABAZI
uspech_pripojeni = False
If conn_dwh.state <> adStateOpen Then
    On Error Resume Next
    conn_dwh.Open "PROVIDER=ORAOLEDB.ORACLE;DATA SOURCE=" & Range("server") & ";USER ID=" & Range("username") & ";PASSWORD=" & Range("password")
    If Err.Number = 0 Then uspech_pripojeni = True
    Err.Clear
    On Error GoTo 0
Else
    uspech_pripojeni = True
End If

If Not uspech_pripojeni Then
    MsgBox ("Nep|fffd|ipojilo se k DWH.")
    vystup_ckp = 1
    Exit Sub
End If

'SPUSTENI SKRIPTU
Cmd.ActiveConnection = conn_dwh
Cmd.CommandType = adCmdText
Cmd.CommandText = Sheets("oracle").Range("skript")

uspech_skriptu = False
On Error Resume Next
Set RS = Cmd.Execute
If Err.Number = 0 Then uspech_skriptu = True
Err.Clear
On Error GoTo 0

If Not uspech_skriptu Then
    MsgBox ("Skript v DWH neprob|fffd|hl.")
    vystup_ckp = 1
    Exit Sub
End If

'VYPSANI VYSLEDKU
Range(Range("vystup"), Range("vystup").End(xlToRight).End(xlDown)).ClearContents

For x = 1 To RS.Fields.Count
    Range("vystup").Offset(0, x - 1) = RS.Fields(x - 1).name
Next x
Range("vystup").Offset(1, 0).CopyFromRecordset RS

End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, cancel As Boolean)
     'kdo s nab|fffd|dkova|fffd|em pracoval a kolik

        Application.EnableEvents = False
        Dim ws As Worksheet
        
             With Sheets("log").Cells(Rows.Count, 1).End(xlUp)
                   .Offset(1, 0).Value = Environ("UserName")
                   .Offset(1, 1) = Now
                   .Offset(1, 3) = ActiveWorkbook.name
                   .Offset(1, 5) = Now() - Sheets("log").Range("B1")
             End With
             Sheets("log").Range("B1") = Now()

        Application.EnableEvents = True
End Sub
Private Sub Workbook_BeforePrint(cancel As Boolean)

    tisk_zastav = 0
    If List57.Range("datum_rozdil").Value < 0 Then
        MsgBox "Skon|fffd|ila platnost kalkula|fffd|ky. Makro nelze spustit.", vbCritical
        cancel = True
        Exit Sub
    End If

    If Not List57.Range("kontrola_tisk") Then
        otazka = MsgBox(List57.Range("kontrola_tisk_hlaska") & "Chcete pokra|fffd|ovat?", vbYesNo, "Chyby ve vypln|fffd|n|fffd|ch datech")
        If otazka = vbNo Then
            cancel = True
            Exit Sub
        End If
    End If
    
    pocet_listu = 0
    For Each ws In ActiveWindow.SelectedSheets
        pocet_listu = pocet_listu + 1
    Next ws
    ReDim zvolene_listy(pocet_listu - 1)
    
    poloha = 0
    For Each ws In ActiveWindow.SelectedSheets
        zvolene_listy(poloha) = ws.name
        poloha = poloha + 1
    Next ws
   
    
    ukaz_tisk = 0
    For i = 0 To poloha - 1
        If zvolene_listy(i) = List60.name Or zvolene_listy(i) = List59.name Or zvolene_listy(i) = List19.name Or zvolene_listy(i) = List6.name Or zvolene_listy(i) = List22.name Then
            ukaz_tisk = 1
        End If
    Next i
    
    If ukaz_tisk = 1 Then
        tisk_zastav = 1
        form_tisk.Show
    Else
    
    End If
    
    If tisk_zastav = 1 Then
        cancel = True
        Exit Sub
    End If
    
    List34.Select
    If poloha > 1 Or (poloha = 1 And zvolene_listy(0) <> List34.name) Then
        Sheets(zvolene_listy()).Select
    End If

    If Not List57.Range("help_mod_tisk") Then
        List57.Range("help_mod_tisk") = True
    '    MsgBox "Syst|fffd|m byl p|fffd|enastaven na mod tisk. Po vyti|fffd|t|fffd|n|fffd| prove|fffd|te |fffd|pravu", vbInformation
    End If

    Application.OnTime Now(), ThisWorkbook.name & "!WorkbookAfterPrint"
End Sub

Private Sub Workbook_Open()
Application.ScreenUpdating = False
List10.Range("Settings_user").Value = Environ("UserName")

Application.Calculation = xlAutomatic

If Not List10.Range("Settings_user_kontrola") Then
    MsgBox "Je n|fffd|m lito, ale tato kalkula|fffd|ka je ur|fffd|ena pouze pro zam|fffd|stnance Allianz poji|fffd||fffd|ovny, a. s. D|fffd|kujeme za pochopen|fffd|.", vbCritical, "Neopr|fffd|vn|fffd|n|fffd| u|fffd|it|fffd|"
    Exit Sub
End If

'P|fffd||fffd|prava na kontrolu p|fffd|ipojen|fffd| k interentu
'If checkInternetConnection() = True Then
'    MsgBox "P|fffd|ipojen|fffd| k internetu je funk|fffd|n|fffd|. Gratulujeme.", vbInformation, "P|fffd|ipojen|fffd| k internetu"
'Else
'    MsgBox "Bez p|fffd|ipojen|fffd| k internetu nelze pokra|fffd|ovat. Prov|fffd||fffd|te pros|fffd|m sv|fffd| p|fffd|ipojen|fffd|.", vbCritical, "P|fffd|ipojen|fffd| k internetu"
'End If

List18.Activate


If List10.Range("Settings_mode") <> "Client" Then
    'Application.Speech.Speak "Weety " & Range("settings_oslovenie"), True
    hlaska = MsgBox("V|fffd|tej " & List10.Range("settings_oslovenie") & ". Tvoje pr|fffd|va jsou " & List10.Range("Settings_mode") & ". Chce|fffd| odemknout kalkula|fffd|ku v modu odpov|fffd|daj|fffd|c|fffd|m tv|fffd|m p|fffd||fffd|stup|fffd|m?", vbYesNo, "Velezdravice")
End If

If hlaska = vbYes And List10.Range("Settings_mode") = "Pricing" Then
    form_pricing.Show
    If pricing = 1 Then 'pokud pricing souhlasil s pravidly
        ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
        For Each ws In Worksheets
            If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Or Sheets(ws.name).Tab.Color = RGB(192, 80, 77) Or Sheets(ws.name).Tab.Color = RGB(146, 208, 80) Then
                Sheets(ws.name).Activate
                ActiveWindow.DisplayHeadings = True
                Sheets(ws.name).Visible = True
                If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then
                    Sheets(ws.name).Unprotect Password:=List10.Range("pswd_view")
                    Sheets(ws.name).Rows.EntireRow.Hidden = False
                    Sheets(ws.name).Columns.EntireColumn.Hidden = False
                End If
            Else
               Sheets(ws.name).Activate
               Sheets(ws.name).Visible = xlSheetVeryHidden
            End If
        Next ws
        List34.Activate
    End If
ElseIf hlaska = vbYes And List10.Range("Settings_mode") = "Admin" Then
    ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
    For Each ws In Worksheets
        Sheets(ws.name).Activate
        ActiveWindow.DisplayHeadings = True
        Sheets(ws.name).Visible = True
        If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then
            Sheets(ws.name).Unprotect Password:=List10.Range("pswd_view")
            Sheets(ws.name).Rows.EntireRow.Hidden = False
            Sheets(ws.name).Columns.EntireColumn.Hidden = False
        End If
    Next ws
    List10.Activate
Else
    If List57.Range("help_ulozeni") = False Then 'je|fffd|t|fffd| kalkula|fffd|ku nenav|fffd|t|fffd|vil => spou|fffd|t|fffd|m na listu vstupostatn|fffd| skryji (d|fffd|l|fffd|m pro jistotu je|fffd|t|fffd| jednou, a|fffd| zam|fffd|en|fffd| kalkula|fffd|ka by to nem|fffd|la pot|fffd|ebovat - pro p|fffd||fffd|pad, |fffd|e by se dostali k odem|fffd|en|fffd| kalkula|fffd|ce
        ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
        For Each ws In Worksheets
            If ws.name <> "vstup" Then Sheets(ws.name).Visible = xlVeryHidden
        Next ws
        List18.Activate
        ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
        If List57.Range("datum_rozdil").Value >= 0 Then 'pokud m|fffd| je|fffd|t|fffd| platnost => spou|fffd|t|fffd|m vstupn|fffd| formul|fffd||fffd|
            form_vstup.Show
        Else
            MsgBox "Platnost aplikace vypr|fffd|ela a nen|fffd| ji mo|fffd|n|fffd| nad|fffd|le vyu|fffd||fffd|vat." 'pokud nem|fffd| platnost => u|fffd| nic ned|fffd|l|fffd|m
        End If
    Else 'kalkula|fffd|ku u|fffd| nav|fffd|t|fffd|vil
        If List57.Range("datum_rozdil").Value >= 0 Then 'pokud m|fffd| je|fffd|t|fffd| platnost, preventivn|fffd| (kv|fffd|li 2010) proklik|fffd|m v|fffd|echny listy
            For Each ws In Worksheets '|fffd|ist|fffd| kv|fffd|li office10, aby si zapamatoval rozlo|fffd|en|fffd| tla|fffd||fffd|tek
                If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then 'standardn|fffd| pou|fffd||fffd|van|fffd| (tmav|fffd| modr|fffd|) listy
                    Sheets(ws.name).Activate
                End If
            Next ws
        Else 'u|fffd| nem|fffd| platnost => v|fffd|echny modr|fffd| listy pozamyk|fffd|m
            For Each ws In Worksheets '|fffd|ist|fffd| kv|fffd|li office10, aby si zapamatoval rozlo|fffd|en|fffd| tla|fffd||fffd|tek
                If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) And ws.name <> List56.name Then 'standardn|fffd| pou|fffd||fffd|van|fffd| (tmav|fffd| modr|fffd|) listy vyjma listu s podklady pro export
                    Sheets(ws.name).Unprotect Password:=List10.Range("pswd_view")
                    Sheets(ws.name).Cells.Locked = True
                    Sheets(ws.name).Cells.FormulaHidden = True
                    Sheets(ws.name).Protect Password:=List10.Range("pswd_view"), AllowFormattingRows:=False, AllowFiltering:=False
                    Sheets(ws.name).EnableSelection = xlNoRestrictions
                    'Sheets(ws.name).EnableSelection = xlNoSelection - takto by nebylo mo|fffd|n|fffd| ani kop|fffd|rovat.
                End If
            Next ws
        End If
        List34.Activate
    End If
End If

If List59.Range("hp_pocatek_pojisteni").Value < List57.Range("datum_dnes").Value Then
    MsgBox "Po|fffd||fffd|tek poji|fffd|t|fffd|n|fffd| byl automaticky upraven na dne|fffd|n|fffd| datum!"
    List59.Range("hp_pocatek_pojisteni") = List57.Range("datum_dnes")
End If
If List57.Range("datum_rozdil").Value < 31 And List57.Range("datum_rozdil").Value > 0 Then
    MsgBox "Platnost aplikace vypr|fffd||fffd| dne " & List57.Range("datum_zamek").Value
End If


Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "form_export_aut"
Attribute VB_Base = "0{DD91F954-51F0-4D79-9515-1590688BA3C3}{806BE2AA-5B35-4189-A32B-F81D2904348A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub cancel_button_Click()
List57.Range("export_pocet_aut").Value = ""
form_export_aut.Hide
End Sub



Private Sub run_button_Click()
If List57.Range("export_pocet_aut").Value > List57.Range("vstup_pocet_vozidel").Value Or List57.Range("export_pocet_aut").Value <= 0 Then
    MsgBox "Zadejte pros|fffd|m hodnotu v intervale 1 a|fffd| " & List57.Range("vstup_pocet_vozidel").Value, vbCritical
    List57.Range("export_pocet_aut").Value = ""
TextBox1.SetFocus
'Else
'If Sheets("assist").Range("H8").Value = 0 Or Sheets("assist").Range("H10").Value = 0 Then 'kontroln|fffd| hl|fffd|ky - zde napo|fffd||fffd|t|fffd|no po|fffd|et aut vs. nenulov|fffd|ch pojistn|fffd|ch
'MsgBox "Pozor! Nespo|fffd|etlo se pojistn|fffd| POV / HAV pro v|fffd|echny exportovan|fffd| vozidla!", vbCritical
'Else
'If Sheets("assist").Range("H12").Value = 0 Then 'kontrola na d|fffd|lku tov|fffd|rn|fffd| zna|fffd|ky - v povinne_ruceni AD30
'MsgBox "Pozor! Nazev zna|fffd|ky nesm|fffd| byt del|fffd||fffd| ne|fffd| 30 znak|fffd|!", vbCritical
Else
form_export_aut.Hide
If Not List57.Range("kontrola_export") Then
    otazka = MsgBox(List57.Range("kontrola_export_hlaska") & "Chcete pokra|fffd|ovat?", vbYesNo, "Chyby ve vypln|fffd|n|fffd|ch datech")
    If otazka = vbNo Then
        Exit Sub
    End If
End If
Call export_aut
'End If
'End If
End If
End Sub

Private Sub UserForm_Initialize()
TextBox1.SetFocus
End Sub

Private Sub UserForm_QueryClose(cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        cancel = True
        MsgBox "Pro zav|fffd|en|fffd| formul|fffd||fffd|e pou|fffd|ijte tla|fffd||fffd|tko Spusti export nebo Zav|fffd||fffd|t", vbCritical
    End If
     
End Sub


Attribute VB_Name = "form_info_spolecnost"
Attribute VB_Base = "0{8BA77FFD-A251-4F50-875E-4CF84DAC52C7}{051316BC-916C-4F70-98C8-AC640CAD1E4A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Bylo aktualizov|fffd|no 2018/06



Private Sub copy_trvaly_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_poj_tp").Copy
    List29.Range("pdb_poj_ka").PasteSpecial xlPasteValues
    Application.CutCopyMode = False
End Sub

Private Sub drzitel_equal_poj_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_poj_zaklad").Copy
    List29.Range("pdb_drz_zaklad").PasteSpecial xlPasteValues
    List29.Range("pdb_poj_tp").Copy
    List29.Range("pdb_drz_tp").PasteSpecial xlPasteValues
    List29.Range("pdb_poj_ka").Copy
    List29.Range("pdb_drz_ka").PasteSpecial xlPasteValues
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub




Private Sub vlastnik_equal_drz_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_drz_zaklad").Copy
    List29.Range("pdb_vla_zaklad").PasteSpecial xlPasteValues
    List29.Range("pdb_drz_tp").Copy
    List29.Range("pdb_vla_tp").PasteSpecial xlPasteValues
    List29.Range("pdb_drz_ka").Copy
    List29.Range("pdb_vla_ka").PasteSpecial xlPasteValues
    Application.CutCopyMode = False
    Application.ScreenUpdating = True
End Sub

Private Sub vlastnik_equal_poj_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_poj_zaklad").Copy
    List29.Range("pdb_vla_zaklad").PasteSpecial xlPasteValues
    List29.Range("pdb_poj_tp").Copy
    List29.Range("pdb_vla_tp").PasteSpecial xlPasteValues
    List29.Range("pdb_poj_ka").Copy
    List29.Range("pdb_vla_ka").PasteSpecial xlPasteValues
    Application.CutCopyMode = False
    Application.ScreenUpdating = False
End Sub
Private Sub button_smazat_poj_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_poj_tp").ClearContents
    List29.Range("pdb_poj_ka").ClearContents
    Application.ScreenUpdating = True
End Sub
Private Sub button_smazat_drzitel_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_drz_zaklad").ClearContents
    List29.Range("pdb_drz_tp").ClearContents
    List29.Range("pdb_drz_ka").ClearContents
    Application.ScreenUpdating = True
End Sub
Private Sub button_smazat_vlastnik_Click()
    Application.ScreenUpdating = False
    List29.Range("pdb_vla_zaklad").ClearContents
    List29.Range("pdb_vla_tp").ClearContents
    List29.Range("pdb_vla_ka").ClearContents
    Application.ScreenUpdating = True
End Sub



Attribute VB_Name = "form_info_stahovani"
Attribute VB_Base = "0{795AE73F-93C5-409A-BD03-2187B5E84C50}{49B6FD78-3E09-4E31-BEB1-E58E01F0A222}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "form_pricing"
Attribute VB_Base = "0{3A30E8AE-C25C-4621-9D16-EFCDB2A43E7B}{17DBFC4A-3D7B-4F89-861C-28B91F89E10D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub pricing_souhlas_Click()
    pricing = 1
    form_pricing.Hide
End Sub
Attribute VB_Name = "form_tisk"
Attribute VB_Base = "0{94314129-59CB-42EC-93DF-A66E43F035FC}{BC3C2F38-8FC4-4EA1-BB4B-B77545064A7B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub cancel_button_Click()
    
    List57.Range("tisk_radky") = List57.Range("vstup_pocet_vozidel")
    form_tisk.Hide
    tisk_zastav = 1

End Sub

Private Sub run_button_Click()
    If List57.Range("tisk_radky") > List57.Range("vstup_pocet_vozidel") Then
        MsgBox "Vytisknout lze maxim|fffd|ln|fffd| stejn|fffd| po|fffd|et |fffd||fffd|dk|fffd|, jako byl nastaven na po|fffd||fffd|tku.", vbCritical, "|fffd|patn|fffd| po|fffd|et |fffd||fffd|dk|fffd| k tisku"
    Else
        tisk_zastav = 0
        form_tisk.Hide
        Call tisk_skryti_radku
    End If
End Sub
Attribute VB_Name = "form_vstup"
Attribute VB_Base = "0{2BE646B2-C32E-4269-9F26-256376AF1FCA}{4E0DE10F-2BC4-45F5-9772-49746FE4E639}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub sazebnik_refresh_Click()
    myrange = sazebnik_vyber.RowSource
    sazebnik_vyber.RowSource = vbNullString
    sazebnik_vyber.RowSource = myrange
End Sub

Private Sub sazebnik_vyber_Change()
    Call sazebnik_refresh_Click
End Sub

Private Sub UserForm_Initialize()
    List57.Range("vstup_saz") = List57.Range("vstup_saz_akt")
    myrange = sazebnik_vyber.RowSource
    sazebnik_vyber.RowSource = vbNullString
    sazebnik_vyber.RowSource = myrange
End Sub




Private Sub combox_rc_ic_Change()
If combox_rc_ic.Value = "R|fffd|" Then
    textbox_prijmeni.Locked = False
Else
    textbox_prijmeni.Value = ""
    textbox_prijmeni.Locked = True
End If
End Sub




Private Sub vstup_ok_Click()
    If List29.Range("pdb_poj_ico_rc") = "I|fffd|O" And Not List57.Range("ico_kontrola") Then ' kontrola, |fffd|e je spr|fffd|vn|fffd| vypln|fffd|n|fffd| I|fffd|O
        MsgBox "|fffd|patn|fffd| uveden|fffd| I|fffd|O. Nelze pokra|fffd|ovat.", vbCritical, "Ne|fffd|pln|fffd| |fffd|i chybn|fffd| |fffd|daje"
        Exit Sub
    End If
    If List29.Range("pdb_poj_ico_rc") = "R|fffd|" And Not List57.Range("rc_kontrola") Then ' kontrola, |fffd|e je spr|fffd|vn|fffd| vypln|fffd|n|fffd| R|fffd|
        MsgBox "|fffd|patn|fffd| uveden|fffd| rodn|fffd| |fffd||fffd|slo. Nelze pokra|fffd|ovat.", vbCritical, "Ne|fffd|pln|fffd| |fffd|i chybn|fffd| |fffd|daje"
        Exit Sub
    End If
    If List29.Range("pdb_poj_ico_rc") = "R|fffd|" And textbox_prijmeni.Value = "" Then ' kontrola, |fffd|e je spr|fffd|vn|fffd| vypln|fffd|n|fffd| R|fffd|
        MsgBox "Vypl|fffd|te Jm|fffd|no a P|fffd||fffd|jmen|fffd| klienta (v tomto po|fffd|ad|fffd|) bez diakritiky.", vbCritical, "Ne|fffd|pln|fffd| |fffd|i chybn|fffd| |fffd|daje"
        Exit Sub
    End If
    If Not List57.Range("vstup_pocet_vozidel_kontrola") Then    ' kontrola, |fffd|e je n|fffd|co vypln|fffd|no ve vozidlech a spl|fffd|uje to pravidla
        MsgBox "Uve|fffd|te po|fffd|et vozidel, pro kter|fffd| chcete kalkula|fffd|ku p|fffd|ipravit, v rozmez|fffd| 10 - 50 000 ks.", vbCritical, "Chybn|fffd| |fffd|daje"
        Exit Sub
    End If
    If List57.Range("vstup_saz") = "" Or List57.Range("vstup_saz") = "x" Or List24.Range("vstup_saz_kontrola") = False Then ' kontrola, |fffd|e je vypln|fffd|n|fffd| sazebn|fffd|k
        MsgBox "Prove|fffd|te refresh sazebn|fffd|k|fffd| a vyberte spr|fffd|vn|fffd| sazebn|fffd|k ze seznamu.", vbCritical, "Chybn|fffd| zvolen|fffd| sazebn|fffd|k."
        Exit Sub
    End If
    
    'je v|fffd|e v po|fffd||fffd|dku? M|fffd||fffd|eme pokra|fffd|ovat...
    form_vstup.Hide
    

    form_info_stahovani.Show False
    'DoEvents
    
    'nyn|fffd| je |fffd|as st|fffd|hnout |fffd|KP
    Application.ScreenUpdating = False
    vystup_ckp = 0
    Call stahnout_ckp
    
    If vystup_ckp = 1 Then 'toto by |fffd|lo ur|fffd|it|fffd| do budoucna ud|fffd|lat inteligentn|fffd|ji
        form_vstup.Show
        ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other") 'toto d|fffd|l|fffd|m vylo|fffd|en|fffd| pro jistotu, aby se to fakt znovu zamklo, kdyby to bylo n|fffd|hodou odem|fffd|en|fffd|
        ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
        Application.ScreenUpdating = True
        Exit Sub
    End If

    'Nastaven|fffd| korekce slevy - potreba ak si chce zvoli|fffd| star|fffd||fffd| sazebn|fffd|k pri s|fffd|behu
    List33.Activate
    List33.Range("korekce_final").Copy
    List33.Range("korekce_slevy").PasteSpecial xlPasteValues
    Application.CutCopyMode = False

    'Zobrazen|fffd| spr|fffd|vn|fffd|ch list|fffd|
    ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
    For Each ws In Worksheets
        If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then 'standardn|fffd| pou|fffd||fffd|van|fffd| (tmav|fffd| modr|fffd|) listy
            Sheets(ws.name).Visible = True
        ElseIf Sheets(ws.name).Tab.Color = RGB(49, 134, 155) Then 'listy pro export (tyrkysov|fffd|)
            Sheets(ws.name).Visible = xlSheetHidden
        Else
            Sheets(ws.name).Visible = xlSheetVeryHidden 'v|fffd|echny ostatn|fffd| listy
        End If
    Next ws
    Call nastaveni_dle_poctu
     
    'dokon|fffd|en|fffd| |fffd|ar|fffd|dy
    
    List34.Unprotect Password:=List10.Range("pswd_view")
        If List29.Range("pdb_poj_on") = "" Then
            List34.Activate
            List34.Range("SoS_nazev_spolecnosti").Select
            Selection.Locked = False
            Selection.FormulaHidden = True
        Else
            List34.Activate
            List34.Range("SoS_nazev_spolecnosti").Select
            Selection.Locked = True
            Selection.FormulaHidden = True
        End If
    List34.Protect Password:=List10.Range("pswd_view")

    Application.ScreenUpdating = True
    form_info_stahovani.Hide
    List18.Visible = xlSheetVeryHidden
    ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
    List57.Range("help_ulozeni") = True
    
    
    For Each ws In Worksheets '|fffd|ist|fffd| kv|fffd|li office10, aby si zapamatoval rozlo|fffd|en|fffd| tla|fffd||fffd|tek
        If Sheets(ws.name).Tab.Color = RGB(31, 73, 125) Then 'standardn|fffd| pou|fffd||fffd|van|fffd| (tmav|fffd| modr|fffd|) listy
            Sheets(ws.name).Activate
        End If
    Next ws
    
    List57.Range("tisk_radky") = List57.Range("vstup_pocet_vozidel")
    
    List34.Activate

End Sub

Attribute VB_Name = "form_zpusob_pouziti"
Attribute VB_Base = "0{A76182FA-ECB4-42AB-A865-F459ACD43B1D}{A92BDBB5-91F3-483F-B416-3704426BCFA6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub cancel_button_Click()
    form_zpusob_pouziti.Hide
End Sub
Attribute VB_Name = "import_cars_poptavka"
Attribute VB_Base = "0{B72FAC0E-C524-4A5C-BBDA-E5E8C09980D8}{45DC47B8-C10A-4B67-8081-B4F9F551955B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub cancel_button_Click()
Sheets("assist").Range("H14").Value = ""
Sheets("assist").Range("H16").Value = "Vyberte soubor ->"
import_cars_poptavka.Hide
End Sub


Private Sub CommandButton1_Click()
Dim soubor As Variant, test As Variant
soubor = Application.GetOpenFilename("Sestava (*.xls),*.xls")
Sheets("assist").Range("H16").Value = soubor
test = Sheets("assist").Range("H16").Value
If test = False Or test = "Vyberte soubor ->" Then Sheets("assist").Range("H16").Value = "Vyberte soubor ->"
End Sub

Private Sub runn_button_Click()
If Sheets("assist").Range("H16").Value = False Or Sheets("assist").Range("H16").Value = "Vyberte soubor ->" Then
MsgBox ("Vyberte popt|fffd|vkov|fffd| tabulku AF14, ze kter|fffd| chcete exportovat data!")
Else
If Sheets("assist").Range("H14").Value > Sheets("assist").Range("F19").Value Or Sheets("assist").Range("H14").Value <= 0 Then
MsgBox "Zadejte pros|fffd|m hodnotu v intervale 1 a|fffd| " & Sheets("assist").Range("F19").Value, vbCritical
TextBox1.SetFocus
Sheets("assist").Range("H14").Value = ""
Else
import_cars_poptavka.Hide
Call Import2
End If
End If
End Sub

Private Sub UserForm_Initialize()
TextBox1.SetFocus
End Sub

Private Sub UserForm_QueryClose(cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        cancel = True
        MsgBox "Pro zav|fffd|en|fffd| formul|fffd||fffd|e pou|fffd|ijte tla|fffd||fffd|tko Spusti import nebo Zav|fffd||fffd|t", vbCritical
    End If
     
End Sub
Attribute VB_Name = "import_cars_sestava"
Attribute VB_Base = "0{E3C72AC3-2B77-4083-8FB3-13250A7E76FB}{73A39390-C502-45E0-B797-EBADC9F57773}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub cancel_button_Click()
Sheets("assist").Range("F25").Value = ""
Sheets("assist").Range("G30").Value = "Vyberte soubor ->"
import_cars_sestava.Hide
End Sub


Private Sub CommandButton1_Click()
Dim soubor As Variant, test As Variant
soubor = Application.GetOpenFilename("Sestava (*.xls),*.xls")
Sheets("assist").Range("G30").Value = soubor
test = Sheets("assist").Range("G30").Value
If test = False Or test = "Vyberte soubor ->" Then Sheets("assist").Range("G30").Value = "Vyberte soubor ->"
End Sub

Private Sub runn_button_Click()
If Sheets("assist").Range("G30").Value = False Or Sheets("assist").Range("G30").Value = "Vyberte soubor ->" Then
MsgBox ("Vyberte sestavu AF14, ze kter|fffd| chcete exportovat data!")
Else
If Sheets("assist").Range("F25").Value > Sheets("assist").Range("F19").Value Or Sheets("assist").Range("F25").Value <= 0 Then
MsgBox "Zadejte pros|fffd|m hodnotu v intervale 1 a|fffd| " & Sheets("assist").Range("F19").Value, vbCritical
TextBox1.SetFocus
Sheets("assist").Range("F25").Value = ""
Else
import_cars_sestava.Hide
Call Import
End If
End If
End Sub

Private Sub UserForm_Initialize()
TextBox1.SetFocus
End Sub

Private Sub UserForm_QueryClose(cancel As Integer, CloseMode As Integer)
     
    If CloseMode = 0 Then
        cancel = True
        MsgBox "Pro zav|fffd|en|fffd| formul|fffd||fffd|e pou|fffd|ijte tla|fffd||fffd|tko Spusti import nebo Zav|fffd||fffd|t", vbCritical
    End If
     
End Sub
Attribute VB_Name = "new_makra"
Option Private Module

Public pricing As Integer

Public tisk_zastav As Integer
    'mo|fffd|n|fffd| hodnoty pro tisk zastav:
        '0 - OK
        '1 - zru|fffd|it tisk
Public vystup_ckp As Integer
    'mo|fffd|n|fffd| hodnoty pro v|fffd|stup |fffd|KP:
        '0 - OK
        '1 - hodit zp|fffd|t na vstup
        
Public zvolene_listy() As String 'pou|fffd||fffd|v|fffd| se pro zapamatov|fffd|n|fffd| zvolen|fffd|ch list|fffd| (tisk)

Public poloha As Integer 'ur|fffd|uje po|fffd|et zvolen|fffd|ch list|fffd| (tisk)


Sub export_listu(jmeno_listu)
    
     '   copy the colors and themes
    '
    
    
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    kopirovany_soubor = ThisWorkbook.name
    Sheets(jmeno_listu).Copy
    ActiveSheet.Unprotect Password:="ammis"
    novy_soubor = ActiveWorkbook.name
    Windows(kopirovany_soubor).Activate
    Cells.Select
    Selection.Copy
    Windows(novy_soubor).Activate
    Sheets(jmeno_listu).Cells.Activate
    ActiveSheet.Paste
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    'Shapes.Range(Array("kalks_menu_sos", "kalks_menu_prs", "kalks_menu_pr", "kalks_menu_hp", "kalks_menu_dp", "kalks_menu_export", "kalks_menu_kalkv", "kalks_menu_kalks")).Delete
    
    Dim Shp As Shape

    For Each Shp In ActiveSheet.Shapes
        If Shp.name <> "kalks_nadpis" Then Shp.Delete
    Next Shp
      

      
    Sheets(jmeno_listu).Range("A1").Select
    ActiveWindow.DisplayHeadings = False
    If ActiveWindow.FreezePanes Then ActiveWindow.FreezePanes = False
    Application.CutCopyMode = False
    
    
    If List29.Range("pdb_poj_ic") = "" Then jak_ulozit = "bez_ico" Else jak_ulozit = List29.Range("pdb_poj_ic")
    
    ActiveWorkbook.SaveAs Filename:=jak_ulozit & "_export_kalkulace.xlsx", FileFormat:=51
    'Application.Dialogs(xlDialogSaveAs).Show

    Windows(kopirovany_soubor).Activate
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
   
End Sub



Sub tisk_skryti_radku()
    tisk_zastav = 0
    Application.ScreenUpdating = False
    If Not List57.Range("tisk_radky_kontrola") Then
        MsgBox List57.Range("tisk_radky_kontrola_hlaska"), vbCritical
        tisk_zastav = 1
        Exit Sub
    End If
    For i = 0 To poloha - 1
        If zvolene_listy(i) = List60.name Then Call tisk_skryj_radky(List60, "pr", 0)
        If zvolene_listy(i) = List59.name Then Call tisk_skryj_radky(List59, "hp", 0)
        If zvolene_listy(i) = List19.name Then Call tisk_skryj_radky(List19, "dp", 0)
        If zvolene_listy(i) = List6.name Then Call tisk_skryj_radky(List6, "kalkv", -1)
        If zvolene_listy(i) = List22.name Then Call tisk_skryj_radky(List22, "kalks", -1)
    Next i
    Application.ScreenUpdating = True
End Sub
Sub tisk_zobrazeni_radku()
    tisk_zastav = 0
    Application.ScreenUpdating = False
    For i = 0 To poloha - 1
        If zvolene_listy(i) = List60.name Then Call tisk_zobraz_radky(List60, "pr", 0)
        If zvolene_listy(i) = List59.name Then Call tisk_zobraz_radky(List59, "hp", 0)
        If zvolene_listy(i) = List19.name Then Call tisk_zobraz_radky(List19, "dp", 0)
        If zvolene_listy(i) = List6.name Then Call tisk_zobraz_radky(List6, "kalkv", -1)
        If zvolene_listy(i) = List22.name Then Call tisk_zobraz_radky(List22, "kalks", -1)
    Next i
    Application.ScreenUpdating = True
    List57.Range("tisk_radky") = List57.Range("vstup_pocet_vozidel")

End Sub



Sub WorkbookAfterPrint()
If List57.Range("help_mod_tisk") Then
    List57.Range("help_mod_tisk") = False
    'MsgBox "Mod pro tisk byl zru|fffd|en.", vbInformation
End If
Call tisk_zobrazeni_radku
List34.Select
If poloha > 1 Or (poloha = 1 And zvolene_listy(0) <> List34.name) Then
    Sheets(zvolene_listy()).Select
End If
End Sub
 
Sub export_aut()
    Dim wb1 As Workbook
    Dim wb2 As Workbook
    Dim DstFile As Variant
    Dim CompanyName As Variant 'nazev spolecnosti
    Dim n As Variant
    Dim k As Integer, i As Integer, m As Integer
    On Error GoTo ErrorWarning
    n = List57.Range("export_pocet_aut").Value 'A_pocet_aut_export
    k = List20.Range("M_pocet_dat_export").Value 'M_pocet_dat_export
    Set wb1 = ActiveWorkbook
    CompanyName = List29.Range("pdb_poj_on").Value
    Application.ScreenUpdating = False
    Call vycisti_nalevaci 'vyma|fffd|e data z listu nal|fffd|vac|fffd| tabulka a ZK
    
    For i = 1 To k
        source_sheet = List20.Cells(i + 2, 2) 'ukl|fffd|d|fffd| si z jak|fffd|ho listu |fffd|erpat
        source_cell = List20.Cells(i + 2, 4) 'ukl|fffd|d|fffd| si z jak|fffd| bu|fffd|ky |fffd|erpat
        target_sheet = List20.Cells(i + 2, 5) 'ukl|fffd|d|fffd| si na jak|fffd| list kop|fffd|rovat
        target_cell = List20.Cells(i + 2, 7) 'ukl|fffd|d|fffd| si do jak|fffd| bu|fffd|ky kop|fffd|rovat
        pom = List20.Cells(i + 2, 8) 'zda se m|fffd| kop|fffd|rovat cel|fffd| |fffd||fffd|dek nebo jen bu|fffd|ka
    
        If pom = "r" Then 'pokud jen |fffd||fffd|dek
            Range(Sheets(source_sheet).Range(source_cell), Sheets(source_sheet).Range(source_cell).Offset(n - 1, 0)).Copy
            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
            'zkop|fffd|ruj hodnoty na listu source_sheet od bu|fffd|ky source_cell dol|fffd| do listu target_sheet od bu|fffd|ky target_cell dol|fffd|
            Application.CutCopyMode = False
        End If
    
        If pom = "c" Then 'pokud jen sloupec
            Sheets(source_sheet).Range(source_cell).Copy
            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
            Application.CutCopyMode = False
        End If
    
    Next i
    
    'warning sezona - toto je|fffd|t|fffd| dopracovat
    'Sheets("assist").Range("C30").Copy 'A_export_sezona - kdy|fffd| m|fffd| min jendo vozidlo sjednanou sez|fffd|nu, vyskakuje zde hl|fffd|ka: Pozor! Minim|fffd|ln|fffd| jedno vozidlo ma sjednan|fffd| sez|fffd|nu
    'Sheets("nal|fffd|vac|fffd| tabulka AF14").Range("A" & 3 + n).PasteSpecial xlPasteValues 'm|fffd| vlo|fffd|it tuto hl|fffd|ku do bu|fffd|ky A(3+po|fffd|et vyexportovan|fffd|ch dat) asi jako upozorn|fffd|n|fffd| pod tabulkou
    'Application.CutCopyMode = False
    
    'warning uzemni platnost- toto je|fffd|t|fffd| dopracovat, dod|fffd|lat v|fffd|echny warningy
    'Sheets("assist").Range("D30").Copy 'A_export_uzemni_platnost - za podm|fffd|nky, kdy je |fffd|zemn|fffd| platnost n|fffd|jak|fffd|ho auta mimo |fffd|R, vyskakuje zde hl|fffd|ka: Pozor! Minim|fffd|ln|fffd| jedno vozidlo ma sjednanou |fffd|zemn|fffd| platnost |fffd|R
    'Sheets("nal|fffd|vac|fffd| tabulka AF14").Range("A" & 4 + n).PasteSpecial xlPasteValues 'm|fffd| vlo|fffd|it tuto hl|fffd|ku do bu|fffd|ky A(4+po|fffd|et vyexportovan|fffd|ch dat) asi jako upozorn|fffd|n|fffd| pod tabulkou
    'Application.CutCopyMode = False
    
    
    Call Export_SPZ
    
    List57.Range("export_pocet_aut").Value = "" 'vynuluje A_pocet_aut_export (n)
    
    ActiveWorkbook.Unprotect Password:=List10.Range("pswd_other")
    List11.Visible = True
    List27.Visible = True 'zobraz|fffd| listy nal|fffd|vac|fffd| tabulka a ZK
    
    
    Sheets(Array("nalevaci_af14", "zk")).Select 'vybere oba listy
    Sheets(Array("nalevaci_af14", "zk")).Copy 'zkop|fffd|ruje je
    wb1.Sheets("nalevaci_af14").Visible = xlSheetVeryHidden 'skryje list, ale kde? V nov|fffd|m se|fffd|it|fffd|?
    wb1.Sheets("zk").Visible = xlSheetVeryHidden 'skryje list, ale kde? V nov|fffd|m se|fffd|it|fffd|?
    ActiveWorkbook.Protect Password:=List10.Range("pswd_other")
    
    Set wb2 = ActiveWorkbook 'otev|fffd|e nov|fffd| Se|fffd|it
    Application.ScreenUpdating = True
        
    DstFile = Application.GetSaveAsFilename(InitialFileName:=CompanyName & "_nal|fffd|vac|fffd| tabulka AF14.xlsx", fileFilter:="Excel Files (*.xlsx), *.xlsx") 'ulo|fffd||fffd| Se|fffd|it wb2 pod t|fffd|mto n|fffd|zvem
        If DstFile = "False" Then
            MsgBox "Nal|fffd|vac|fffd| tabulka nebyla ulo|fffd|ena." 'pokud se ulo|fffd|en|fffd| nezda|fffd||fffd|, vysko|fffd||fffd| tato hl|fffd|ka
            Exit Sub
        Else
            wb2.SaveAs DstFile 'jinak se tento se|fffd|it pod n|fffd|zvem v|fffd||fffd|e ulo|fffd||fffd|
            wb2.Close 'a zav|fffd|e
            Application.ScreenUpdating = False
            wb1.Sheets("souhrn_o_spolecnosti").Activate 'v se|fffd|itu wb1 se zobraz|fffd| list Povinn|fffd| ru|fffd|en|fffd|
            Application.ScreenUpdating = True
            MsgBox ("Nal|fffd|vac|fffd| tabulka byla |fffd|sp|fffd|n|fffd| ulo|fffd|ena.")
        End If
       
    
ErrorWarning:
    If Err.Number <> 0 Then
        Application.ScreenUpdating = False
        Call vycisti_nalevaci
        Application.ScreenUpdating = True
        MsgBox ("Export neprob|fffd|hl |fffd|sp|fffd|n|fffd|!")
    End If
End Sub

Sub Export_SPZ()
Dim n As Integer
n = List57.Range("export_pocet_aut").Value
Dim i As Integer
For i = 1 To n
     pom = List11.Cells(i + 1, 48)
     If pom = "" Then
        List11.Cells(i + 1, 48).Value = " -"
     End If
Next i

End Sub


Sub prace_s_vybranymi_listy()
    Dim pocet_listu As Integer
    Dim zvolene_listy() As String
    pocet_listu = 0
    For Each ws In ActiveWindow.SelectedSheets
        pocet_listu = pocet_listu + 1
    Next ws
    ReDim zvolene_listy(pocet_listu - 1)
    poloha = 0
    For Each ws In ActiveWindow.SelectedSheets
        zvolene_listy(poloha) = ws.name
        poloha = poloha + 1
    Next ws
    Sheets("souhrn_o_spolecnosti").Select
    If poloha > 1 Then
        Sheets(zvolene_listy()).Select
    End If
End Sub

Attribute VB_Name = "new_procedury"
Option Private Module


Sub nastaveni_dle_poctu()

Application.ScreenUpdating = False

'inicializace listu s variantn|fffd| kalkulac|fffd|
    Call inc_typ_1(List6, "kalkv")

'inicializace listu se souhrnnou kalkulac|fffd|
    Call inc_typ_1(List22, "kalks")

'inicializace listu s povinn|fffd|m ru|fffd|en|fffd|m
    Call inc_typ_2(List60, "pr")

'inicializace listu s havarijn|fffd|m poji|fffd|t|fffd|n|fffd|m
    Call inc_typ_2(List59, "hp")
    
'inicializace listu s dopl|fffd|kov|fffd|m poji|fffd|t|fffd|n|fffd|m
    Call inc_typ_2(List19, "dp")

'inicializace listu s exportem
    Call inc_typ_1(List56, "export")
    
'inicializace listu s exportem
    Call inc_typ_1(List9, "pomocny")

Application.ScreenUpdating = True

End Sub

Sub zamkni_listy_typ_2(list As Object, pole)
    radek_inc = Sheets("help").Range("help_inc_radek_" & pole)
    list.Activate
    list.Unprotect Password:=List10.Range("pswd_view")
    ActiveWindow.ScrollRow = 1
    list.Rows.EntireRow.Hidden = False
    list.Columns.EntireColumn.Hidden = False
    'Skryt|fffd| sloupc|fffd|
    radek = list.Range(pole & "_sloupce").Row
    For i = 2 To list.Range(pole & "_sloupce") + 1
        If Not list.Cells(radek, i) Then list.Columns(i).EntireColumn.Hidden = True
    Next i
    
    'pr|fffd|ce se |fffd||fffd|dky
    list.Rows("1:" & Range("help_pocet_radku_skryt")).EntireRow.Hidden = True
    list.Rows(radek_inc + 1 & ":" & radek_inc + 105000).ClearContents
    list.Rows(radek_inc & ":" & radek_inc).EntireRow.Hidden = True
    
End Sub

Sub zamkni_listy_typ_1(list As Object, pole)
    radek_inc = Sheets("help").Range("help_inc_radek_" & pole)
    list.Activate
    list.Unprotect Password:=List10.Range("pswd_view")
    ActiveWindow.ScrollRow = 1
    list.Rows.EntireRow.Hidden = False
    list.Columns.EntireColumn.Hidden = False

    'pr|fffd|ce se |fffd||fffd|dky
    list.Rows(radek_inc + 1 & ":" & radek_inc + 105000).ClearContents
   
  
End Sub

Sub tisk_skryj_radky(list As Object, pole, x)
    radek_inc = List57.Range("help_inc_radek_" & pole)
    radek_tisk = List57.Range("tisk_radky")
    radek_zobraz = List57.Range("vstup_pocet_vozidel")
    
    list.Activate
    list.Rows(radek_inc + 1 + radek_tisk + x & ":" & radek_inc + 1 + radek_zobraz + x).EntireRow.Hidden = True

End Sub
Sub tisk_zobraz_radky(list As Object, pole, x)
    radek_inc = List57.Range("help_inc_radek_" & pole)
    radek_tisk = List57.Range("tisk_radky")
    radek_zobraz = List57.Range("vstup_pocet_vozidel")
    
    list.Activate
    list.Rows(radek_inc + 1 + radek_tisk + x & ":" & radek_inc + 1 + radek_zobraz + x).EntireRow.Hidden = False

End Sub

Sub inc_typ_2(list As Object, pole)
    radek_inc = Sheets("help").Range("help_inc_radek_" & pole)
    list.Activate
    list.Unprotect Password:=List10.Range("pswd_view")
    list.Rows.EntireRow.Hidden = False
    list.Columns.EntireColumn.Hidden = False
    
    'Skryt|fffd| sloupc|fffd|
    radek = list.Range(pole & "_sloupce").Row
    For i = 2 To list.Range(pole & "_sloupce") + 1
        If Not list.Cells(radek, i) Then list.Columns(i).EntireColumn.Hidden = True
    Next i
    
    'pr|fffd|ce se |fffd||fffd|dky
    list.Rows("1:" & Range("help_pocet_radku_skryt")).EntireRow.Hidden = True 'skr|fffd|v|fffd|m |fffd||fffd|dky s definic|fffd| typ|fffd| produkt|fffd|
    list.Rows(radek_inc + 1 & ":" & radek_inc + 105000).ClearContents 'Sma|fffd|u obsah p|fffd||fffd|padn|fffd|ch dat pro jednotliv|fffd| p|fffd|ihl|fffd|ky
    list.Rows(radek_inc & ":" & radek_inc).Copy 'nakop|fffd|ruji inicializa|fffd|n|fffd| |fffd||fffd|dek
    list.Rows(radek_inc + 1 & ":" & radek_inc + List57.Range("vstup_pocet_vozidel")).Select
    list.Paste ' rozkop|fffd|ruji dle ur|fffd|en|fffd|ho po|fffd|tu |fffd||fffd|dk|fffd|

    'skryt|fffd| nadbyte|fffd|n|fffd|ch |fffd||fffd|dk|fffd| v listu
    list.Rows(radek_inc + List57.Range("vstup_pocet_vozidel") + 1 & ":" & radek_inc + List57.Range("vstup_pocet_vozidel") + 1).Select
    Range(Selection, Selection.End(xlDown)).EntireRow.Hidden = True
    list.Rows(radek_inc & ":" & radek_inc).EntireRow.Hidden = True
    list.Rows(105000 & ":" & 105000).EntireRow.Hidden = False
    Application.CutCopyMode = False
    
    ActiveWindow.DisplayHeadings = False
      
    list.Rows(radek_inc).RowHeight = 1
    
    list.Protect Password:=List10.Range("pswd_view"), AllowFormattingRows:=True, AllowFiltering:=True
    list.Range("A1").Activate

End Sub

Sub inc_typ_1(list As Object, pole)
    radek_inc = Sheets("help").Range("help_inc_radek_" & pole)
    list.Activate
    list.Unprotect Password:=List10.Range("pswd_view")
    list.Rows.EntireRow.Hidden = False
    list.Rows(radek_inc + 1 & ":" & radek_inc + 105000).ClearContents
    list.Rows(radek_inc & ":" & radek_inc).Copy
    list.Rows(radek_inc + 1 & ":" & radek_inc + List57.Range("vstup_pocet_vozidel") - 1).Select
    list.Paste

    list.Rows(radek_inc + List57.Range("vstup_pocet_vozidel") & ":" & radek_inc + List57.Range("vstup_pocet_vozidel")).Select
    Range(Selection, Selection.End(xlDown)).EntireRow.Hidden = True
    list.Rows(105000 & ":" & 105000).EntireRow.Hidden = False
    list.Range("A1").Activate
    list.Protect Password:=List10.Range("pswd_view"), AllowFormattingRows:=True, AllowFiltering:=True
    Application.CutCopyMode = False
    ActiveWindow.DisplayHeadings = False
End Sub

Sub vycisti_nalevaci()

List11.Range("NT_vse").ClearContents
List27.Range("ZK_vse").ClearContents

End Sub


Function checkInternetConnection() As Integer

    On Error Resume Next
    checkInternetConnection = False
    Dim objSvrHTTP As ServerXMLHTTP
    Dim varProjectID, varCatID, strT As String
    Set objSvrHTTP = New ServerXMLHTTP
    objSvrHTTP.Open "GET", "http://www.google.com"
    objSvrHTTP.setRequestHeader "Accept", "application/xml"
    objSvrHTTP.setRequestHeader "Content-Type", "application/xml"
    objSvrHTTP.send strT
    If Err = 0 Then
        checkInternetConnection = True
    End If
    
End Function
Attribute VB_Name = "revize_import"
Option Private Module
'Private Sub import()
'Dim wb3 As Variant, wb4 As Variant, n As Variant, m As Variant, k As Integer
'n = Worksheets("assist").Range("F25").Value
'm = Worksheets("assist").Range("F19").Value
'k = Worksheets("mapping").Range("L1").Value
'wb3 = ActiveWorkbook.name
'Application.ScreenUpdating = False
'On Error GoTo ErrorWarning
'Workbooks.Open Filename:=Worksheets("assist").Range("G30").Value
'wb4 = ActiveWorkbook.name
'Workbooks(wb4).Activate
'Application.ScreenUpdating = False
'
'If Workbooks(wb4).ActiveSheet.Range("A1").Value = "skup_smlouva" Then 'overuje identifikator sestavy
'
'    Workbooks(wb3).Activate
'    Call vycisti_flotilu
'
'
'    Worksheets("assist").Range("F13").Value = "TRUE"  'propojistenost POV + HAV
'
'    For i = 1 To k
'        source_cell = Worksheets("mapping").Cells(i + 2, 11)
'        target_sheet = Worksheets("mapping").Cells(i + 2, 12)
'        target_cell = Worksheets("mapping").Cells(i + 2, 14)
'        source_sheet_1 = Worksheets("mapping").Cells(i + 2, 15)
'        source_cell_1 = Worksheets("mapping").Cells(i + 2, 17)
'        target_sheet_1 = Worksheets("mapping").Cells(i + 2, 18)
'        target_cell_1 = Worksheets("mapping").Cells(i + 2, 20)
'        pom = Worksheets("mapping").Cells(i + 2, 21)
'        If pom = "s" Then
'            Workbooks(wb4).Activate
'            Range(ActiveSheet.Range(source_cell), ActiveSheet.Range(source_cell).Offset(n - 1, 0)).Copy
'            Workbooks(wb3).Activate
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'        If pom = "d" Then
'            Workbooks(wb4).Activate
'            Range(ActiveSheet.Range(source_cell), ActiveSheet.Range(source_cell).Offset(n - 1, 0)).Copy
'            Workbooks(wb3).Activate
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Range(Sheets(source_sheet_1).Range(source_cell_1), Sheets(source_sheet_1).Range(source_cell_1).Offset(n - 1, 0)).Copy
'            Range(Sheets(target_sheet_1).Range(target_cell_1), Sheets(target_sheet_1).Range(target_cell_1).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'        If pom = "ds" Then
'            Workbooks(wb4).Activate
'            Range(ActiveSheet.Range(source_cell), ActiveSheet.Range(source_cell).Offset(n - 1, 0)).Copy
'            Workbooks(wb3).Activate
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Sheets(source_sheet_1).Range(source_cell_1).Copy
'            Sheets(target_sheet_1).Range(target_cell_1).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'        If pom = "i" Then
'            Range(Sheets(source_sheet_1).Range(source_cell), Sheets(source_sheet_1).Range(source_cell_1).Offset(n - 1, 0)).Copy
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet_1).Range(target_cell_1).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'
'    Next i
'
'    'skopiruje vycet pojistnych nebezpeci
'    Call Copy_HAV
'
'    Workbooks(wb4).Close SaveChanges:=False
'
'
'
'    'Workbooks(wb3).Save
'    Application.ScreenUpdating = True
'
'    Worksheets("assist").Range("G30").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("F25").Value = ""
'    MsgBox ("Import dat |fffd|sp|fffd|n|fffd| dokon|fffd|en")
'
'    Else
'    Workbooks(wb3).Activate
'    Application.ScreenUpdating = False
'    Workbooks(wb4).Close SaveChanges:=False
'    Workbooks(wb3).Activate
'    Worksheets("assist").Range("G30").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("F25").Value = ""
'    Application.ScreenUpdating = True
'    MsgBox ("Chybn|fffd| identifik|fffd|tor sestavy, vyberte pros|fffd|m spr|fffd|vnou verzi sestavy AF14.")
'End If
'
'ErrorWarning:
'If Err.Number <> 0 Then
'    Application.ScreenUpdating = False
'    Workbooks(wb4).Close SaveChanges:=False
'    Workbooks(wb3).Activate
'    Call vycisti_flotilu
'    Worksheets("assist").Range("G30").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("F25").Value = ""
'    Application.ScreenUpdating = True
'    MsgBox ("Import neprob|fffd|hl |fffd|sp|fffd|n|fffd|!")
'End If
'
'End Sub
'
'
'Sub Import2()
''Import popt|fffd|vka
'Dim wb3 As Variant, wb4 As Variant, n As Variant, m As Variant, k As Integer
'n = Worksheets("assist").Range("H14").Value
'm = Worksheets("assist").Range("F19").Value
'k = Worksheets("mapping").Range("Z1").Value
'wb3 = ActiveWorkbook.name
'Application.ScreenUpdating = False
'On Error GoTo ErrorWarning
'Workbooks.Open Filename:=Worksheets("assist").Range("H16").Value
'wb4 = ActiveWorkbook.name
'Workbooks(wb4).Activate
'Application.ScreenUpdating = False
'
'If Workbooks(wb4).Sheets("assist").Range("F2").Value = "N|fffd|zev spole|fffd|nosti:" Then 'overuje identifikator poptavkovej tabulky
'
'    Workbooks(wb3).Activate
'    Call vycisti_flotilu_3
'
''!!! Tohle je |fffd|pln|fffd| blb|fffd| - kdy|fffd| tak by m|fffd|l b|fffd|t link na assist
'    Worksheets("Povinn|fffd| ru|fffd|en|fffd| summary").Range("F13").Value = "TRUE"  'propojistenost POV + HAV
'
'    For i = 1 To k
'        source_sheet = Worksheets("mapping").Cells(i + 2, 24)
'        source_cell = Worksheets("mapping").Cells(i + 2, 25)
'        target_sheet = Worksheets("mapping").Cells(i + 2, 26)
'        target_cell = Worksheets("mapping").Cells(i + 2, 28)
'        source_sheet_1 = Worksheets("mapping").Cells(i + 2, 29)
'        source_cell_1 = Worksheets("mapping").Cells(i + 2, 31)
'        target_sheet_1 = Worksheets("mapping").Cells(i + 2, 32)
'        target_cell_1 = Worksheets("mapping").Cells(i + 2, 34)
'        pom = Worksheets("mapping").Cells(i + 2, 35)
'        If pom = "s" Then
'            Workbooks(wb4).Activate
'            Range(Sheets(source_sheet).Range(source_cell), Sheets(source_sheet).Range(source_cell).Offset(n - 1, 0)).Copy
'            Workbooks(wb3).Activate
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet).Range(target_cell).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'        If pom = "b" Then
'            Workbooks(wb4).Activate
'            Sheets(source_sheet).Range(source_cell).Copy
'            Workbooks(wb3).Activate
'            Sheets(target_sheet).Range(target_cell).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'        If pom = "ss" Then
'            Range(Sheets(source_sheet_1).Range(source_cell), Sheets(source_sheet_1).Range(source_cell_1).Offset(n - 1, 0)).Copy
'            Range(Sheets(target_sheet).Range(target_cell), Sheets(target_sheet_1).Range(target_cell_1).Offset(n - 1, 0)).PasteSpecial xlPasteValues, Operation:=xlNone
'            Application.CutCopyMode = False
'        End If
'
'
'    Next i
'
'    Workbooks(wb4).Close SaveChanges:=False
'
'
'
'    'Workbooks(wb3).Save
'    Application.ScreenUpdating = True
'
'    Worksheets("assist").Range("H16").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("H14").Value = ""
'    MsgBox ("Import dat |fffd|sp|fffd|n|fffd| dokon|fffd|en")
'
'    Else
'    Workbooks(wb3).Activate
'    Application.ScreenUpdating = False
'    Workbooks(wb4).Close SaveChanges:=False
'    Workbooks(wb3).Activate
'    Worksheets("assist").Range("H16").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("H14").Value = ""
'    Application.ScreenUpdating = True
'    MsgBox ("Chybn|fffd| identifik|fffd|tor popt|fffd|vkovej tabulky, vyberte pros|fffd|m spr|fffd|vnou verzi tabulky AF14.")
'End If
'
'ErrorWarning:
'If Err.Number <> 0 Then
'    Application.ScreenUpdating = False
'    Workbooks(wb4).Close SaveChanges:=False
'    Workbooks(wb3).Activate
'    Call vycisti_flotilu
'    Worksheets("assist").Range("H16").Value = "Vyberte soubor ->"
'    Worksheets("assist").Range("H14").Value = ""
'    Application.ScreenUpdating = True
'    MsgBox ("Import neprob|fffd|hl |fffd|sp|fffd|n|fffd|!")
'End If
'
'End Sub



INQUEST-PP=macro
