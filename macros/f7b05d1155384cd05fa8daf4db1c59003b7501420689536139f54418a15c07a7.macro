Attribute VB_Name = "Admin"
Option Private Module

'*************************************************************
'Diese Sub's sind Shortcuts zum steuern der Bearbeitungsmodis*
'by M.Becker 2015                                            *
'*************************************************************

'BEARBEITUNG EIN f|fffd|r aktives Tabellenblatt
Sub Administration()
Call Bearbeitung_Ein
End Sub

'BEARBEITUNG AUS f|fffd|r aktives Tabellenblatt
Sub Administration_Aus()
Call Bearbeitung_Aus
End Sub

'FREISCHALTUNG EIN (|fffd|ffnet Freischaltungsbereich)
Sub Administration_Freischaltung_Ein()
Call Bearbeitungsmodus_Ein_Freischaltung
End Sub

'FREISCHALTUNG AUS (schlie|fffd|t Freischaltungsbereich - start von hier normalerweise nicht notwendig)
Sub Administration_Freischaltung_Aus()
Call Bearbeitungsmodus_Aus_Freischaltung
End Sub

'MikroZ SPALTEN EIN (gilt nur f|fffd|r Schedule-Tabellenbl|fffd|tter)
Sub Administration_Schedule_Spalten_Ein()
Call Bearbeitung_Ein_Zwei
End Sub

'MikroZ SPALTEN AUS Split-Schedule (gilt nur f|fffd|r Split Schedule-Tabellenblatt)
Sub Administration_Schedule_Split_Spalten_Aus()
Call Bearbeitung_Aus_Zwei
End Sub

'MikroZ SPALTEN AUS Ganz-Schedule (gilt nur f|fffd|r Ganzheitliche Schedule-Tabellenblatt)
Sub Administration_Schedule_Ganz_Spalten_Aus()
Call Bearbeitung_Aus_Drei
End Sub

'---------------------------END------------------------------------------------------
Attribute VB_Name = "Aufloesung"
Option Explicit

Declare PtrSafe Function GetDeviceCaps Lib "gdi32" _
(ByVal hdc As LongPtr, ByVal nIndex As LongPtr) As LongPtr

Declare PtrSafe Function GetDC Lib "user32" (ByVal hWnd As LongPtr) As LongPtr

Declare PtrSafe Function ReleaseDC Lib "user32" _
(ByVal hWnd As LongPtr, ByVal hdc As LongPtr) As LongPtr

Declare PtrSafe Sub ShowWindow Lib "user32" _
(ByVal hWnd As LongPtr, ByVal nCmdShow As LongPtr)

Const HORZRES = 8
Const VERTRES = 10

Function GetScreenRes()
  Dim lRval As LongPtr
  Dim lDC As LongPtr
  Dim lHSize As LongPtr
  Dim lVSize As LongPtr
  lDC = GetDC(0&)
  lHSize = GetDeviceCaps(lDC, HORZRES)
  lVSize = GetDeviceCaps(lDC, VERTRES)
  lRval = ReleaseDC(0, lDC)
  GetScreenRes = lHSize & "x" & lVSize
End Function
Attribute VB_Name = "Bearbeitungsmodus"
Option Private Module

Sub Bearbeitung_Ein()

' stellt in der Schedule die Arbeitsumgebung zur Bearbeitung ohne Einblenden aller Spalten/Zeilen her.
' ist bei der Datei-Programmversion zur Weitergabe zu l|fffd|schen.
    
    ActiveSheet.Unprotect Password:="Merlin1959!"
    Application.EnableEvents = False
    Application.Goto Reference:=Range("A1"), Scroll:=True
    With ActiveWindow
        .DisplayGridlines = True
        .DisplayWorkbookTabs = True
        .DisplayHeadings = True
        .Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = True
        .DisplayStatusBar = True
        .DisplayFullScreen = False
    End With

    If Application.DisplayFormulaBar = False Then
    Application.DisplayFormulaBar = True
    End If
    If Application.DisplayStatusBar = False Then
    Application.DisplayStatusBar = True
    End If
    
    ActiveSheet.DisplayAutomaticPageBreaks = True
    
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Ganzer Bildschirm").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Extras").Controls("Optionen...").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Symbolleisten").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Bearbeitungsleiste").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Format").Controls("Blatt").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Einf|fffd|gen").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt l|fffd|schen").Enabled = True
    Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt verschieben/kopieren...").Enabled = True
    Application.CommandBars("cell").Enabled = True
    Application.OnKey "{ESC}"
    'Tastenkombinationen aktivieren
    Application.OnKey "{F3}"
    Application.OnKey "{F5}"
    
    Range("A1").Select
    Application.EnableEvents = True

    End Sub

Sub Bearbeitung_Aus()

' hebt in der Schedule die Arbeitsumgebung zur Bearbeitung ohne Ausblenden aller Spalten/Zeilen auf.
' ist bei der Datei-Programmversion zur Weitergabe zu l|fffd|schen.
    
    Application.EnableEvents = False
    Application.Goto Reference:=Range("A1"), Scroll:=True
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        .Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With

    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
    
    ActiveSheet.DisplayAutomaticPageBreaks = False
    
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Ganzer Bildschirm").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Extras").Controls("Optionen...").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Symbolleisten").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Bearbeitungsleiste").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Format").Controls("Blatt").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Einf|fffd|gen").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt l|fffd|schen").Enabled = False
    Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt verschieben/kopieren...").Enabled = False
    Application.OnKey "{ESC}", ""
    Application.CommandBars("cell").Enabled = False
    'Tastenkombinationen deaktivieren
    Application.OnKey "{F3}", ""
    Application.OnKey "{F5}", ""
    
    Range("A1").Select
    Application.EnableEvents = True
    ActiveSheet.Protect Password:="Merlin1959!"

End Sub

Sub Bearbeitung_Ein_Zwei()
'Blendet in der Schedule zus|fffd|tzlich alle Spalten und Zeilen zur Bearbeitung ein

ActiveSheet.Unprotect Password:="Merlin1959!"

Application.ScreenUpdating = False

    Rows("30:39").Select
    Selection.EntireRow.Hidden = False
    Columns("B:DG").Select
    Selection.EntireColumn.Hidden = False
    Range("B3:F3").Select

Application.ScreenUpdating = True

End Sub
Sub Bearbeitung_Aus_Zwei()
'Blendet in der Schedule alle f|fffd|r die Ansicht nicht notwendigen Spalten und Zeilen nach einer Bearbeitung wieder aus

ActiveSheet.Unprotect Password:="Merlin1959!"
Application.ScreenUpdating = False

    Sheets("Schedule").Range("DG:DG,DC:DC,DB:DB,CY:CZ,CT:CU,CQ:CR,CL:CM,CI:CJ,CD:CE,CA:CB,BV:BW,BS:BT,BN:BO,BK:BL,BF:BG,BC:BD,AY:AY,AV:AW,AR:AR,AO:AP,AK:AK,AH:AI,AD:AD,AA:AB,W:W,T:U,P:P,M:N,I:I,F:G,C:C").EntireColumn.Hidden = True

    Sheets("Schedule").Rows("32:38").EntireRow.Hidden = True
    Range("B3:F3").Select

Application.ScreenUpdating = True
ActiveSheet.Protect Password:="Merlin1959!"

End Sub

Sub Bearbeitung_Aus_Drei()
'Blendet in der Schedule alle f|fffd|r die Ansicht nicht notwendigen Spalten und Zeilen nach einer Bearbeitung wieder aus

ActiveSheet.Unprotect Password:="Merlin1959!"
Application.ScreenUpdating = False

    Sheets("Schedule(2)").Range("DG:DG,DC:DC,DB:DB,CY:CZ,CT:CU,CQ:CR,CL:CM,CI:CJ,CD:CE,CA:CB,BV:BW,BS:BT,BN:BO,BK:BL,BF:BG,BC:BD,AY:AY,AV:AW,AR:AR,AO:AP,AK:AK,AH:AI,AD:AD,AA:AB,W:W,T:U,P:P,M:N,I:I,F:G,C:C").EntireColumn.Hidden = True

    Sheets("Schedule(2)").Rows("32:38").EntireRow.Hidden = True
    Range("B3:F3").Select

Application.ScreenUpdating = True
ActiveSheet.Protect Password:="Merlin1959!"

End Sub


Sub Bearbeitungsmodus_Ein_Freischaltung()
Call Bearbeitung_Ein
    Sheets("UserTime").Visible = True
    Sheets("UserTime").Select
    ActiveSheet.Unprotect Password:="Merlin1959!"
    Columns("A:L").EntireColumn.Hidden = False
    Range("L24").Select
End Sub

Sub Bearbeitungsmodus_Aus_Freischaltung()

If MsgBox("bisherige Datumseintr|fffd|ge zum Laufzeitstart l|fffd|schen?", vbYesNo + vbQuestion, _
"Datumsangaben Laufzeitstart l|fffd|schen") = vbYes Then GoTo Fortfahren Else GoTo EndeAbfrage

Fortfahren:

    Sheets("UserTime").Range("A21:A65536").Select
    Selection.ClearContents
    GoTo EndeAbfrage

EndeAbfrage:

    Sheets("UserTime").Range("M1").Select
    Columns("A:L").EntireColumn.Hidden = True
    ActiveSheet.Protect Password:="Merlin1959!"
    Sheets("UserTime").Visible = xlSheetVeryHidden
    Sheets("Start").Select
    Call Bearbeitung_Aus

End Sub

Attribute VB_Name = "Dat_MGrp"
Attribute VB_Base = "0{898F9C33-8890-42A0-9FF6-B8F68C0C472F}{AB0EF5FB-EDFA-4F69-8159-EBE7A8D7929F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
'Abbruch von Formulareingaben
Me.Hide
End Sub

Private Sub CommandButton2_Click()
'Beim Aufruf gestoppte Makros werden gestoppt
Application.EnableEvents = False

'|fffd|bernahme von |fffd|nderungen im Formular wenn auf Schlie|fffd|en geklickt wird

Sheets("Schedule").Range("A42").Value = Dat_MGrp.TextBox1.Value
Sheets("Schedule").Range("A43").Value = Dat_MGrp.TextBox14.Value
Sheets("Schedule").Range("A44").Value = Dat_MGrp.TextBox13.Value
Sheets("Schedule").Range("A45").Value = Dat_MGrp.TextBox15.Value
Sheets("Schedule").Range("A46").Value = Dat_MGrp.TextBox16.Value
Sheets("Schedule").Range("A47").Value = Dat_MGrp.TextBox8.Value
Sheets("Schedule").Range("A48").Value = Dat_MGrp.TextBox6.Value
Sheets("Schedule").Range("A49").Value = Dat_MGrp.TextBox10.Value
Sheets("Schedule").Range("A50").Value = Dat_MGrp.TextBox9.Value
Sheets("Schedule").Range("A51").Value = Dat_MGrp.TextBox11.Value
Sheets("Schedule").Range("A52").Value = Dat_MGrp.TextBox5.Value
Sheets("Schedule").Range("A53").Value = Dat_MGrp.TextBox7.Value
Sheets("Schedule").Range("A54").Value = Dat_MGrp.TextBox12.Value
Sheets("Schedule").Range("A55").Value = Dat_MGrp.TextBox18.Value
Sheets("Schedule").Range("A56").Value = Dat_MGrp.TextBox17.Value
Sheets("Schedule").Range("A57").Value = Dat_MGrp.TextBox19.Value
Me.Hide

'Beim Aufruf gestoppte Makros werden wieder aktiviert
Application.EnableEvents = True

End Sub

Private Sub CommandButton3_Click()
'Beim Aufruf gestoppte Makros werden gestoppt
Application.EnableEvents = False

'Reset der Eintr|fffd|ge auf Programmvorgabe

Sheets("Schedule").Range("A42").Value = "Komplex"
Dat_MGrp.TextBox1.Value = "Komplex"
Sheets("Schedule").Range("A43").Value = "Beine"
Dat_MGrp.TextBox14.Value = "Beine"
Sheets("Schedule").Range("A44").Value = "Beine Hint."
Dat_MGrp.TextBox13.Value = "Beine Hint."
Sheets("Schedule").Range("A45").Value = "Beine Vord."
Dat_MGrp.TextBox15.Value = "Beine Vord."
Sheets("Schedule").Range("A46").Value = "Waden"
Dat_MGrp.TextBox16.Value = "Waden"
Sheets("Schedule").Range("A47").Value = "R|fffd|cken"
Dat_MGrp.TextBox8.Value = "R|fffd|cken"
Sheets("Schedule").Range("A48").Value = "Brust"
Dat_MGrp.TextBox6.Value = "Brust"
Sheets("Schedule").Range("A49").Value = "Schultern"
Dat_MGrp.TextBox10.Value = "Schultern"
Sheets("Schedule").Range("A50").Value = "Schultern Seitl."
Dat_MGrp.TextBox9.Value = "Schultern Seitl."
Sheets("Schedule").Range("A51").Value = "Schultern Hint."
Dat_MGrp.TextBox11.Value = "Schultern Hint."
Sheets("Schedule").Range("A52").Value = "Bizeps"
Dat_MGrp.TextBox5.Value = "Bizeps"
Sheets("Schedule").Range("A53").Value = "Trizeps"
Dat_MGrp.TextBox7.Value = "Trizeps"
Sheets("Schedule").Range("A54").Value = "Core"
Dat_MGrp.TextBox12.Value = "Core"
Sheets("Schedule").Range("A55").Value = ""
Dat_MGrp.TextBox18.Value = ""
Sheets("Schedule").Range("A56").Value = ""
Dat_MGrp.TextBox17.Value = ""
Sheets("Schedule").Range("A57").Value = ""
Dat_MGrp.TextBox19.Value = ""

'Reset der angezeigten Markerfarben des Formulars auf Programmvorgabe
Dat_MGrp.TextBox1.BackColor = RGB(225, 219, 209)
Dat_MGrp.TextBox12.BackColor = RGB(255, 242, 204)
Dat_MGrp.TextBox14.BackColor = RGB(219, 253, 135)
Dat_MGrp.TextBox13.BackColor = RGB(235, 252, 192)
Dat_MGrp.TextBox15.BackColor = RGB(246, 254, 226)
Dat_MGrp.TextBox16.BackColor = RGB(239, 255, 248)
Dat_MGrp.TextBox8.BackColor = RGB(192, 184, 254)
Dat_MGrp.TextBox6.BackColor = RGB(121, 198, 255)
Dat_MGrp.TextBox10.BackColor = RGB(93, 226, 253)
Dat_MGrp.TextBox9.BackColor = RGB(140, 235, 254)
Dat_MGrp.TextBox11.BackColor = RGB(198, 245, 254)
Dat_MGrp.TextBox5.BackColor = RGB(221, 221, 255)
Dat_MGrp.TextBox7.BackColor = RGB(183, 224, 255)

'Beim Aufruf gestoppte Makros werden wieder aktiviert
Application.EnableEvents = True

End Sub

Private Sub UserForm_Initialize()
    Me.Left = 50
    Me.Top = 150
    
End Sub
Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
' Open Prozedur mit Laufzeitpr|fffd|fung f|fffd|r die zu ver|fffd|ffentlichen Trainingsprogramme. Steuerung |fffd|ber Sheet "UserTime"
' z.B. auf 30 Tage nach erstem |fffd|ffnen
Dim Zei As LongPtr

'---- Prozedur wenn Programm bereits freigeschaltet ----
If Sheets("UserTime").Range("H24").Value = Sheets("UserTime").Range("L24").Value Then

    Application.ScreenUpdating = False
    Sheets("Start").Select
    Call Format_StartMikroZ 'Formatierungscode der Startseite
Exit Sub
Else
'---- Prozedur zum tabellarischen einlesen des aktuellen Datums ----
    Application.ScreenUpdating = False
    Sheets("UserTime").Visible = True
    Sheets("UserTime").Select
    Sheets("UserTime").Unprotect Password:="Merlin1959!"
    Zei = Sheets("UserTime").Range("A65536").End(xlUp).Row + 1
    If Zei > 65536 Then
        MsgBox "Bitte pr|fffd|fen Sie, ob eine aktuellere Version erh|fffd|ltlich ist"
        Exit Sub
    End If
    If Zei < 10 Then Zei = 10
    Sheets("UserTime").Range("A" & Zei) = Date
    Sheets("UserTime").Range("A13").Select
    Selection.ClearContents
'---- 30 Tage Testphase ----
    Sheets("UserTime").Range("B10").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]+30" 'hier kann man die Laufzeit (in Tagen) |fffd|ndern |fffd|ndern z.B. in +30
    Sheets("UserTime").Range("B11").Select
    Sheets("UserTime").Protect Password:="Merlin1959!"
    Sheets("UserTime").Visible = xlSheetVeryHidden
    Sheets("Start").Select
    Call Format_StartMikroZ 'Formatierungcode der Startseite

'---- Workbook Save ----
    ActiveWorkbook.Save
    Application.ScreenUpdating = True

'---- Abgleich Verfallsdatum mit aktuellem Datum----
Dim Verfalldatum As Date
Verfalldatum = DateValue(Sheets("UserTime").Range("B10")) 'Hier Verfalldatum im Format 00.00.0000 eintragen (keine Anpassung, da Laufzeit nach Tagen)
    If Verfalldatum < Now Then
        Call Freischalten_MikroZ_Zeigen 'UserForm regelt schlie|fffd|en oder offen lassen und Freischalten des Programmes.
    End If
End If
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
        Dim intQuest As Integer
        'Unterdr|fffd|ckt die autom. Abfrage nach dem Speichern
        Application.DisplayAlerts = False
        'Abfrage nach dem Speichern der |fffd|nderungen
        intQuest = MsgBox("|fffd|nderungen in Planung Mikrozyklus -" & Chr(10) & "Trainingsplan der Woche" & Chr(10) & "speichern?", vbYesNoCancel + vbQuestion)
        If intQuest = 6 Then        '<-- Ja
            MsgBox "|fffd|nderungen werden gespeichert" & Chr(10) & "               SEE YOU AGAIN!"
            
With ActiveWorkbook.BuiltinDocumentProperties 'Setzt die Eigenschaften der aktiven Mappe
.Item("Title") = "MikroZ"
.Item("Keywords") = ""
.Item("Comments") = "Schedule zur Planung von Trainingseinheiten f|fffd|r einen Trainings-Zyklus von max. 2 Wochen (Mikrozyklus) mit Berechnung Regenerationszeiten."
.Item("Category") = "Trainingssteuerung u. Trainingsplanung"
.Item("Subject") = "Trainingsplan eines Mikrozyklus"
.Item("Hyperlink base") = ""
.Item("Creation date") = Now
.Item("Company") = "|fffd| Martin Becker Fitnesstrainer f|fffd|r Individualtraining"
.Item("Manager") = "Martin Becker"
.Item("Author") = "Martin Becker"
End With
            ThisWorkbook.Save
        
        ElseIf intQuest = 7 Then    '<-- Nein
            MsgBox "|fffd|nderungen werden nicht gespeichert" & Chr(10) & "                   SEE YOU LATER!"
            Else
            Cancel = True           '<-- Abbrechen
        Exit Sub
        End If
    
    'Code wird beim Schlie|fffd|en ausgef|fffd|hrt
    Application.EnableEvents = False

    Application.Goto Reference:=Range("B1"), Scroll:=True
    With ActiveWindow
        .DisplayGridlines = True
        .DisplayWorkbookTabs = True
        .DisplayHeadings = True
        .Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = True
        .DisplayStatusBar = True
        .DisplayFullScreen = False
    End With
    
    If Application.DisplayFormulaBar = False Then
    Application.DisplayFormulaBar = True
    End If
    If Application.DisplayStatusBar = False Then
    Application.DisplayStatusBar = True
    End If
    Application.EnableEvents = True
    
    Sheets("Schedule").Visible = xlSheetVeryHidden
    Sheets("Schedule(2)").Visible = xlSheetVeryHidden
    Sheets("DB_Split").Visible = xlSheetVeryHidden
    Sheets("DB_Ganz").Visible = xlSheetVeryHidden
    Sheets("Druckseite").Visible = xlSheetVeryHidden
    Sheets("Druckseite_Ganz").Visible = xlSheetVeryHidden
       
    ThisWorkbook.Saved = True
End Sub

Private Sub Workbook_Activate()
'Deaktiviert Men|fffd|punkte um Ver|fffd|nderungen zu verhindern:
Application.CommandBars("Full Screen").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Ganzer Bildschirm").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Extras").Controls("Optionen...").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Symbolleisten").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Bearbeitungsleiste").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Format").Controls("Blatt").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Einf|fffd|gen").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt l|fffd|schen").Enabled = False
Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt verschieben/kopieren...").Enabled = False
Application.OnKey "{ESC}", ""
Application.CommandBars("cell").Enabled = False
'Tastenkombinationen deaktivieren
Application.OnKey "{F3}", ""
Application.OnKey "{F5}", ""

With ActiveWorkbook.BuiltinDocumentProperties 'Setzt die Eigenschaften der aktiven Mappe
.Item("Title") = "MikroZ"
.Item("Keywords") = ""
.Item("Comments") = "Schedule zur Planung von Trainingseinheiten f|fffd|r einen Trainings-Zyklus von max. 2 Wochen (Mikrozyklus) mit Berechnung Regenerationszeiten."
.Item("Category") = "Trainingssteuerung u. Trainingsplanung"
.Item("Subject") = "Trainingsplan eines Mikrozyklus"
.Item("Hyperlink base") = ""
.Item("Creation date") = Now
.Item("Company") = "|fffd| Martin Becker Fitnesstrainer f|fffd|r Individualtraining"
.Item("Manager") = "Martin Becker"
.Item("Author") = "Martin Becker"
End With

End Sub

Private Sub Workbook_Deactivate()
'Aktiviert Men|fffd|punkte:
Application.CommandBars("Full Screen").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Ganzer Bildschirm").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Extras").Controls("Optionen...").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Symbolleisten").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Ansicht").Controls("Bearbeitungsleiste").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Format").Controls("Blatt").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Einf|fffd|gen").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt l|fffd|schen").Enabled = True
Application.CommandBars("Worksheet Menu Bar").Controls("Bearbeiten").Controls("Blatt verschieben/kopieren...").Enabled = True
Application.OnKey "{ESC}"
Application.CommandBars("cell").Enabled = True
'Tastenkombinationen aktivieren
Application.OnKey "{F3}"
Application.OnKey "{F5}"

With ActiveWorkbook.BuiltinDocumentProperties 'Setzt die Eigenschaften der aktiven Mappe
.Item("Title") = "MikroZ"
.Item("Keywords") = ""
.Item("Comments") = "Schedule zur Planung von Trainingseinheiten f|fffd|r einen Trainings-Zyklus von max. 2 Wochen (Mikrozyklus) mit Berechnung Regenerationszeiten."
.Item("Category") = "Trainingssteuerung u. Trainingsplanung"
.Item("Subject") = "Trainingsplan eines Mikrozyklus"
.Item("Hyperlink base") = ""
.Item("Creation date") = Now
.Item("Company") = "|fffd| Martin Becker Fitnesstrainer f|fffd|r Individualtraining"
.Item("Manager") = "Martin Becker"
.Item("Author") = "Martin Becker"
End With

End Sub

Private Sub Workbook_WindowResize(ByVal Wn As Window)
Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
'Call Bearbeitung_Ausschalten
End Sub

Attribute VB_Name = "Drucken"
Option Private Module

Sub Schedule_drucken()
'Druckt die Schedule auf 4 DIN A 4 Seiten komplett.

ActiveSheet.PageSetup.PrintArea = "$B$2:$DG$31"
ActiveSheet.PageSetup.LeftFooter = "&""Arial,Standard""&8" & _
Sheets("Hidden").Range("H2").Value & " " & Sheets("Hidden").Range("H3").Value & Chr(10) & Sheets("Hidden").Range("H4").Value
   
Call Bearbeitung_Ein
ActiveWindow.SelectedSheets.PrintPreview
Call Bearbeitung_Aus

End Sub


Sub Schedule_Kurzfassung_drucken()
'Druckt die Schedule f|fffd|r Split-Training auf 1 DIN A 4 Seite zusammengefasst.
'ActiveSheet.PageSetup.PrintArea = "$A$1:$N$40"

Sheets("Druckseite").PageSetup.LeftFooter = "&""Arial,Standard""&8" & _
Sheets("Hidden").Range("H2").Value & " " & Sheets("Hidden").Range("H3").Value & Chr(10) & Sheets("Hidden").Range("H4").Value
Sheets("Druckseite").Visible = True

Call Bearbeitung_Ein

Sheets("Druckseite").PrintPreview

Call Bearbeitung_Aus

'Nach Schlie|fffd|en der Preview Ansicht wird Programmumgebung wieder resetet.
    Application.EnableEvents = True
    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"


Sheets("Druckseite").Visible = xlSheetVeryHidden
Sheets("Schedule").Select
Range("B1").Select

End Sub

Sub Schedule_Kurzfassung_Ganz_drucken()
'Druckt die Schedule f|fffd|r ganzheitliches Training auf 1 DIN A 4 Seite zusammengefasst.
'ActiveSheet.PageSetup.PrintArea = "$A$1:$M$56"

Sheets("Druckseite_Ganz").PageSetup.LeftFooter = "&""Arial,Standard""&8" & _
Sheets("Hidden").Range("H2").Value & " " & Sheets("Hidden").Range("H3").Value & Chr(10) & Sheets("Hidden").Range("H4").Value
Sheets("Druckseite_Ganz").Visible = True

Call Bearbeitung_Ein

Sheets("Druckseite_Ganz").PrintPreview

Call Bearbeitung_Aus

Sheets("Druckseite_Ganz").Visible = xlSheetVeryHidden
Sheets("Schedule(2)").Select
Range("B1").Select

End Sub


Sub Druckfunktion_aufrufen()
Druckfunktion.Show
End Sub

Sub Druckfunktion_zwei_aufrufen()
Druckfunktion_zwei.Show
End Sub

Attribute VB_Name = "Druckfunktion"
Attribute VB_Base = "0{729FC719-E401-480B-A019-A7F94019A8AF}{C9A87887-F3A8-48BA-BED7-AFA3C843844F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Me.Hide
End Sub

Private Sub CommandButton2_Click()
Me.Hide
Call Schedule_drucken
Me.Hide
End Sub


Private Sub CommandButton3_Click()
Me.Hide
Call Schedule_Kurzfassung_drucken
End Sub

Private Sub UserForm_Initialize()
    Me.Left = 120
    Me.Top = 110
End Sub
Attribute VB_Name = "Druckfunktion_zwei"
Attribute VB_Base = "0{5AE00CB8-D9FA-4653-9550-87DFC020DE43}{A12A169F-63A7-423C-8EC3-89D631520FEE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Me.Hide
End Sub

Private Sub CommandButton2_Click()
Me.Hide
Call Schedule_drucken
Me.Hide
End Sub

Private Sub CommandButton3_Click()
Me.Hide
Call Schedule_Kurzfassung_Ganz_drucken
End Sub


Private Sub UserForm_Initialize()
    Me.Left = 120
    Me.Top = 110
End Sub

Attribute VB_Name = "Formatierung_Ganz_Schedule"
Option Private Module

Sub Stunden_setzen_Ganz()
'Setzt |fffd|ber das "Change" Ereignis in der Tabelle "Schedule" die Formatierung der Trainingsdauer

ActiveSheet.Unprotect Password:="Merlin1959!"

ActiveCell.Offset(0, -1).Select

If ActiveCell.Value = "Kraft 1h" Or ActiveCell.Value = "Ausdauer 1h" Or ActiveCell.Value = "Koordination 1h" Or ActiveCell.Value = "Ganzheitlich 1h" Or ActiveCell.Value = "Sonstiges 1h" Or ActiveCell.Value = "Beweglichkeit" Then
Call Stunden_Reset_Ganz
End If

If ActiveCell.Value = "Kraft 2h" Or ActiveCell.Value = "Ausdauer 2h" Or ActiveCell.Value = "Koordination 2h" Or ActiveCell.Value = "Ganzheitlich 2h" Or ActiveCell.Value = "Sonstiges 2h" Then
Call Stunden_Zwei_Ganz
End If

If ActiveCell.Value = "Kraft 3h" Or ActiveCell.Value = "Ausdauer 3h" Or ActiveCell.Value = "Koordination 3h" Or ActiveCell.Value = "Ganzheitlich 3h" Or ActiveCell.Value = "Sonstiges 3h" Then
Call Stunden_Drei_Ganz
End If

If ActiveCell.Value = "" Then
Call Stunden_Reset_zwei_Ganz
End If

ActiveCell.Offset(0, 1).Select

ActiveSheet.Protect Password:="Merlin1959!"

End Sub

Sub Stunden_Zwei_Ganz()
'
' formatiert die Trainingsauswahl auf 2 Stunden Dauer nur Farbe u. Linien
Dim Hinweis As LongPtr

If ActiveCell.Offset(1, 0).Range("A1").Value >= 1 Then
MsgBox "Achtung |fffd|berplanung der Dauer des Trainings,", vbOKOnly + vbInformation, "|fffd|berplanung"
ActiveCell.Value = ""
ActiveSheet.Unprotect Password:="Merlin1959!"
Call Stunden_Reset_zwei_Ganz
ActiveCell.Offset(0, -2).Select
Exit Sub

Else
    Call Stunden_Reset_Ganz
        
'Linien
    ActiveCell.Offset(0, -2).Range("A1:E2").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    'Selection.Borders(xlInsideVertical).LineStyle = xlContinuous
    'Selection.Borders(xlInsideVertical).Weight = xlHairline
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ActiveCell.Offset(0, 2).Range("A1").Select
    
    Call Linie_Finish_Zwei

'Farbe
    If ActiveCell.Offset(0, -1).Value = 1 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 14664123
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 2 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11389944
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 3 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15520438
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 4 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11649973
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 5 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 9692671
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 6 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 638975
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If

'Abschluss
    ActiveCell.Select
    Application.DisplayAlerts = True
End If
End Sub
Sub Stunden_Drei_Ganz()
'
' formatiert die Trainingsauswahl auf 3 Stunden Dauer nur Linien u. Farbe
    
Dim Hinweis As LongPtr

If ActiveCell.Offset(1, 0).Range("A1").Value >= 1 Or ActiveCell.Offset(2, 0).Range("A1").Value >= 1 Then
MsgBox "Achtung |fffd|berplanung der Dauer des Trainings,", vbOKOnly + vbInformation, "|fffd|berplanung"
ActiveCell.Value = ""
ActiveSheet.Unprotect Password:="Merlin1959!"
Call Stunden_Reset_zwei_Ganz
ActiveCell.Offset(0, -2).Select
Exit Sub

Else
        
    Call Stunden_Reset_Ganz

'Linien
    ActiveCell.Offset(0, -2).Range("A1:E3").Select
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    'Selection.Borders(xlInsideVertical).LineStyle = xlContinuous
    'Selection.Borders(xlInsideVertical).Weight = xlHairline
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    ActiveCell.Offset(0, 2).Range("A1").Select
    
    Call Linie_Finish_Zwei
   
'Farbe
    If ActiveCell.Offset(0, -1).Value = 1 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 14664123
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 2 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11389944
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 3 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15520438
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 4 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11649973
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 5 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 9692671
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 6 Then
    ActiveCell.Range("A1:C3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 638975
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If

'Abschluss
    ActiveCell.Select
    'Application.DisplayAlerts = True
End If
End Sub

Sub Stunden_Reset_Ganz()
'
' stellt Formatierung der Standarddauer des Trainings auf 1 h wieder her
'
    'Application.DisplayAlerts = False
    
'Linien
    ActiveCell.Offset(0, -2).Range("A1:E1").Select
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    'With Selection.Borders(xlInsideVertical)
    '    .LineStyle = xlContinuous
     '   .Weight = xlHairline
     '   .ColorIndex = xlAutomatic
    'End With
 
 'Farben
    ActiveCell.Offset(0, 2).Range("A1").Select
 
 'Original Farbe der Zellen-----------
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlGray50
        .PatternColorIndex = 19
    End With
 '------------------------------------
 
    If ActiveCell.Offset(0, -1).Value = 1 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 14664123
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 2 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11389944
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 3 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15520438
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 4 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 11649973
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 5 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 9692671
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Value = 6 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 638975
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    End If
    
 'Abschluss
    ActiveCell.Select
    Call Stunden_Linie_Finish
    Call Linie_Finish_Zwei
End Sub

Sub Stunden_Reset_zwei_Ganz()

' stellt Formatierung der nach L|fffd|schung eines Trainings wieder her
   Application.ScreenUpdating = False
 'Linien
    ActiveCell.Offset(0, -1).Range("A1").Select
        
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With


 'Farben und Linien finish
    ActiveCell.Offset(0, 2).Range("A1").Select
 
 'Original Farbe der Zellen herstellen unter Ber|fffd|cksichtigung von Nachbar-Trainingseinheiten-----------
    
    'Reset bei Trainingseinheit in Folgestunde---------------------------------------------------------
    If ActiveCell.Offset(1, -1).Range("A1").Value >= 1 Then
    ActiveCell.Range("A1:C1").Select
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlGray50
        .PatternColorIndex = 19
    End With
        With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    End If
    
    'Reset bei Folge-Trainingseinheit in 2 Stunden-------------------------------------------------------------
    If ActiveCell.Offset(1, -1).Range("A1").Value = "" And ActiveCell.Offset(2, -1).Range("A1").Value >= 1 Then
    ActiveCell.Range("A1:C2").Select
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlGray50
        .PatternColorIndex = 19
    End With
        With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    End If
'Reset bei Folge Trainingseinheit ab 3. Stunde---------------------------------------------------------------
    If ActiveCell.Offset(1, -1).Range("A1").Value = "" And ActiveCell.Offset(2, -1).Range("A1").Value = "" Then
    ActiveCell.Range("A1:C3").Select
    
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlGray50
        .PatternColorIndex = 19
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With

Call Linie_Finish_Zwei
End If
Application.ScreenUpdating = True

 '------------------------------------
End Sub
Attribute VB_Name = "Formatierung_Linien"
Option Private Module

Sub Stunden_Linie_Finish()
'
' Stellt nach Stunden_Reset die Linien im Schedule Bereich wieder her
'
    ActiveCell.Offset(0, -2).Range("A1:F3").Select
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    
    Selection.Borders(xlInsideHorizontal).LineStyle = xlDash
    
    ActiveCell.Offset(0, 2).Range("A1").Select
End Sub

Sub Linie_Finish_Zwei()
'
' Stellt die Linien am unteren Ende der Scedule wieder her
'
    Range("B28:DG29").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("B28:DG29").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("B28:DG29").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Range("B28:DG29").Borders(xlEdgeTop)
        .LineStyle = xlDash
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    With Range("B28:DG29").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Range("B28:DG29").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Range("B30:DG30").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Range("B28:DG29").Borders(xlInsideHorizontal).LineStyle = xlNone

    With Range("E5:E29").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    
    With Range("B30:DF30").Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

End Sub
Attribute VB_Name = "Freischalten_VersionMikroZ"
Attribute VB_Base = "0{BA061F5E-BD88-4DBF-B4F1-B9B5483314C6}{598F16BA-13F7-4B43-B27E-394813422E05}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
If TextBox1.Value = Sheets("UserTime").Range("L24").Value Then
Sheets("UserTime").Range("H24") = TextBox1.Value
ActiveWorkbook.Save
MsgBox "Vielen Dank f|fffd|r die Nutzung und die besten W|fffd|nsche f|fffd|r Ihren Trainingserfolg." & Chr(10) & "Ihr Programm zur Planung eines Mikrozyklus ist nun freigeschaltet", vbOKOnly + vbInformation, "Freischaltung erfolgreich"
Else
ActiveWorkbook.Save
Application.Quit
End If
Me.Hide

End Sub

Private Sub CommandButton2_Click()
MsgBox "das Programm wird nun geschlossen!,", vbOKOnly + vbInformation, "Aktivierung abgebrochen"
ActiveWorkbook.Save
Application.Quit

End Sub


Private Sub CommandButton3_Click()
MsgBox "das Programm wird nun geschlossen und Sie werden zur Website !!!! weitergeleitet." & Chr(10) & "Herzlichen Dank, dass Sie sich f|fffd|r eine weitere Nutzung entschieden haben", vbOKOnly + vbInformation, "Freischaltcode erwerben"
ActiveWorkbook.Save
    Set wshshell = CreateObject("WScript.Shell")
    wshshell.Run "www.MartinBecker-Trainingsplanung.de/s_forms/f_freischaltung.html"
Application.Quit

End Sub

Private Sub TextBox4_Change()
TextBox4.Value = Format(TextBox4.Value, """MikroZ ""000000")
End Sub

Private Sub UserForm_Initialize()
    Me.Left = 150
    Me.Top = 150
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
Cancel = 1
End Sub
Attribute VB_Name = "Help_Schedule_Ganz"
Attribute VB_Base = "0{B815B863-85C8-4E9C-8328-CBE3E628919A}{1276E05F-411A-4ECD-BE04-079709436C14}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub SpinButton1_SpinDown()
Me.MultiPage1.Value = 0
End Sub

Private Sub SpinButton1_SpinUp()
Me.MultiPage1.Value = 1
End Sub

Private Sub UserForm_Initialize()
    Me.Left = 50
    Me.Top = 60
End Sub

Private Sub CommandButton1_Click()
Me.Hide
End Sub
Attribute VB_Name = "Help_Schedule_Split"
Attribute VB_Base = "0{A807FADA-09CD-4DD2-9D20-43A79AD9380C}{35D7824D-315C-42D3-972B-F8525196440F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub Image11_Click()

End Sub

Private Sub Label131_Click()
Set wshshell = CreateObject("WScript.Shell")
    wshshell.Run "www.martinbecker-trainingsplanung.de/Trainingsplanung-Mesozyklus-Workouts.html"
End Sub

Private Sub SpinButton1_SpinDown()

If Me.MultiPage1.Value > 0 Then
MultiPage1.Value = MultiPage1.Value - 1
Else
'nichts passiert
End If

End Sub

Private Sub SpinButton1_SpinUp()

If Me.MultiPage1.Value < (MultiPage1.Pages.Count - 1) Then
MultiPage1.Value = MultiPage1.Value + 1
Else
'nichts passiert
End If

End Sub
Private Sub UserForm_Initialize()
    Me.Left = 50
    Me.Top = 60
End Sub

Private Sub CommandButton1_Click()
Me.Hide
End Sub
Attribute VB_Name = "Help_Start"
Attribute VB_Base = "0{F2592B0E-3F9C-4865-8139-F9226B707AE0}{150A1CAE-B8B4-4DAA-A077-93BE39AC79BC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton2_Click()
Me.Hide
End Sub


Private Sub Label177_Click()
Me.MultiPage1.Value = 1
End Sub

Private Sub SpinButton1_SpinDown()
Me.MultiPage1.Value = 0
End Sub

Private Sub SpinButton1_SpinUp()
Me.MultiPage1.Value = 1
End Sub

Private Sub UserForm_Initialize()
    Me.Left = 50
    Me.Top = 60
End Sub

Private Sub CheckBox1_Click()
    ActiveSheet.Unprotect Password:="Merlin1959!"
    If Me.CheckBox1.Value = True Then
    Sheets("Schedule").Range("B1").Value = "1"
    End If
    If Me.CheckBox1.Value = False Then
    Sheets("Schedule").Range("B1").Value = ""
    End If
    ActiveSheet.Protect Password:="Merlin1959!"

End Sub


Attribute VB_Name = "Info_Form_MikroZ"
Attribute VB_Base = "0{00BBC6E4-37C2-43AC-9E5A-42C95C4BA71E}{2EEF6C81-8CF6-4AB9-97D2-532B17A32BEA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Me.Hide
End Sub


Sub CommandButton2_Click()
MsgBox "Sie werden nun zur Website !!!! weitergeleitet." & Chr(10) & "Herzlichen Dank, dass Sie sich f|fffd|r eine weitere Nutzung entschieden haben", vbOKOnly + vbInformation, "Freischaltcode erwerben"
ActiveWorkbook.Save
    Set wshshell = CreateObject("WScript.Shell")
    wshshell.Run "www.MartinBecker-Trainingsplanung.de/s_forms/f_freischaltung.html"
End Sub

Private Sub CommandButton3_Click()
If Me.TextBox1.Value = Sheets("UserTime").Range("L24").Value Then
    Sheets("UserTime").Range("H24").Value = Me.TextBox1.Value
    Info_Form_MikroZ.Hide
    MsgBox "Vielen Dank f|fffd|r die Nutzung und die besten W|fffd|nsche f|fffd|r Ihren Trainingserfolg." & Chr(10) & "Ihr Programm zur Planung eines Mikrozyklus ist nun freigeschaltet", vbOKOnly + vbInformation, "Freischaltung erfolgreich"
    ActiveWorkbook.Save
Else
    MsgBox "Aktivierung nicht erfolgreich"
    Info_Form_MikroZ.TextBox1.SetFocus
    Info_Form_MikroZ.TextBox1.Value = ""
    Exit Sub
End If
End Sub

Private Sub Image5_Click()
Call Website_oeffnen
End Sub

Private Sub UserForm_Initialize()
    Me.Left = 100
    Me.Top = 150
End Sub

Private Sub TextBox4_Change()
TextBox4.Value = Format(TextBox4.Value, """MikroZ ""000000")
End Sub

Attribute VB_Name = "Schedule_Aus_Einblenden"
Option Private Module

'****************************************************
' Codes um freie Trainingstage ein- u. auszublenden *
'****************************************************

'-------------------------------------------------------------------
'Codes f|fffd|r 1. Woche
'-------------------------------------------------------------------

Sub Di_Wo1_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("H:H,J:J,K:K,L:L").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Di_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Di_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("H:H,J:J,K:K,L:L").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Di_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Mi_Wo1_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("O:O,Q:Q,R:R,S:S").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Mi_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Mi_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("O:O,Q:Q,R:R,S:S").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Mi_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Do_Wo1_aus()
Attribute Do_Wo1_aus.VB_Description = "Makro am 12.03.2015 von Martin Becker aufgezeichnet"
Attribute Do_Wo1_aus.VB_ProcData.VB_Invoke_Func = " \n14"
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("V:V,X:X,Y:Y,Z:Z").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Do_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Do_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("V:V,X:X,Y:Y,Z:Z").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Do_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Fr_Wo1_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AC:AC,AE:AE,AF:AF,AG:AG").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Fr_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Fr_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AC:AC,AE:AE,AF:AF,AG:AG").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Fr_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Sa_Wo1_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AJ:AJ,AL:AL,AM:AM,AN:AN").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Sa_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Sa_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AJ:AJ,AL:AL,AM:AM,AN:AN").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Sa_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub So_Wo1_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AQ:AQ,AS:AS,AT:AT,AU:AU").EntireColumn.Hidden = True
    ActiveSheet.Shapes("So_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub So_Wo1_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("AQ:AQ,AS:AS,AT:AT,AU:AU").EntireColumn.Hidden = False
    ActiveSheet.Shapes("So_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

'-------------------------------------------------------------------
'Codes f|fffd|r 2. Woche u.Mo 3. Woche
'-------------------------------------------------------------------

Sub Di_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BE:BE,BH:BH,BI:BI,BJ:BJ").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Di2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Di_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BE:BE,BH:BH,BI:BI,BJ:BJ").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Di2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Mi_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BM:BM,BP:BP,BQ:BQ,BR:BR").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Mi2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Mi_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BM:BM,BP:BP,BQ:BQ,BR:BR").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Mi2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Do_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BU:BU,BX:BX,BY:BY,BZ:BZ").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Do2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Do_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("BU:BU,BX:BX,BY:BY,BZ:BZ").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Do2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Fr_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CC:CC,CF:CF,CG:CG,CH:CH").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Fr2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Fr_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CC:CC,CF:CF,CG:CG,CH:CH").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Fr2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Sa_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CK:CK,CN:CN,CO:CO,CP:CP").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Sa2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Sa_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CK:CK,CN:CN,CO:CO,CP:CP").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Sa2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub So_Wo2_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CS:CS,CV:CV,CW:CW,CX:CX").EntireColumn.Hidden = True
    ActiveSheet.Shapes("So2_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub So_Wo2_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("CS:CS,CV:CV,CW:CW,CX:CX").EntireColumn.Hidden = False
    ActiveSheet.Shapes("So2_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub


Sub Mo_Wo3_aus()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("DA:DA,DD:DD,DE:DE,DF:DF").EntireColumn.Hidden = True
    ActiveSheet.Shapes("Mo3_aus").Select
    Selection.Font.ColorIndex = 3
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub Mo_Wo3_ein()
'
    ActiveSheet.Unprotect Password:="Merlin1959!"
    ActiveSheet.Range("DA:DA,DD:DD,DE:DE,DF:DF").EntireColumn.Hidden = False
    ActiveSheet.Shapes("Mo3_aus").Select
    Selection.Font.ColorIndex = 0
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

'-------------------------------------------------------------------------------
'-------------------------------------------------------------------------------

Attribute VB_Name = "Signatur"
Attribute VB_Base = "0{ADFF5495-9B3D-4BA9-983E-75B1928CC3A1}{E5CB2E92-4271-4686-AFC4-931DCCC05005}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Initialize()
    Me.Left = 70
    Me.Top = 120
End Sub

Private Sub CommandButton1_Click()
Me.Hide

End Sub

Private Sub CommandButton2_Click()
Sheets("Hidden").Range("H2").Value = Signatur.TextBox1.Value
Sheets("Hidden").Range("H3").Value = Signatur.TextBox2.Value
Sheets("Hidden").Range("H4").Value = Signatur.TextBox3.Value
Me.Hide

End Sub

Attribute VB_Name = "Split_Planung"
Option Private Module

Sub Woche_Zwei_aus()
' Blended die Zweite Planungswoche aus. (Standard)
    ActiveSheet.Unprotect Password:="Merlin1959!"
    Application.ScreenUpdating = False
    ActiveSheet.Rows("21:35").EntireRow.Hidden = True
    ActiveSheet.Shapes("Schaltfl|fffd|che 333").Visible = True
    ActiveSheet.Shapes("Schaltfl|fffd|che 334").Visible = False
    ActiveSheet.Protect Password:="Merlin1959!"
    Application.ScreenUpdating = True
End Sub

Sub Woche_Zwei_ein()
' Blended die Zweite Planungswoche ein. (user)
    ActiveSheet.Unprotect Password:="Merlin1959!"
    Application.ScreenUpdating = False
    ActiveSheet.Rows("21:35").EntireRow.Hidden = False
    ActiveSheet.Shapes("Schaltfl|fffd|che 333").Visible = False
    ActiveSheet.Shapes("Schaltfl|fffd|che 334").Visible = True
    ActiveSheet.Protect Password:="Merlin1959!"
    Application.ScreenUpdating = True
End Sub

Sub Admin_Schalter_ein()
' Blended beide Schalter f|fffd|r Ein- Ausblenden zu Admin Zwecken ein
    ActiveSheet.Unprotect Password:="Merlin1959!"
    Application.ScreenUpdating = False
    ActiveSheet.Shapes("Schaltfl|fffd|che 333").Visible = True
    ActiveSheet.Shapes("Schaltfl|fffd|che 334").Visible = True
    ActiveSheet.Protect Password:="Merlin1959!"
    Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Steuerung"
Option Private Module

Sub Programm_close()
Application.Quit
End Sub

Sub JumpStart()
' Springt zur Startseite

    Application.ScreenUpdating = False

    If ActiveWorkbook.ActiveSheet.Name = "Schedule" Then
    Sheets("Schedule").Visible = xlSheetVeryHidden
    End If
    
    If ActiveWorkbook.ActiveSheet.Name = "Schedule(2)" Then
    Sheets("Schedule(2)").Visible = xlSheetVeryHidden
    End If
    
    If ActiveWorkbook.ActiveSheet.Name = "DB_Ganz" Then
    Sheets("DB_Ganz").Visible = xlSheetVeryHidden
    End If

    If ActiveWorkbook.ActiveSheet.Name = "DB_Split" Then
    Sheets("DB_Split").Visible = xlSheetVeryHidden
    End If
    
    Sheets("Start").Select
    Application.Goto Reference:=Range("A1"), Scroll:=True
        
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        '.Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
       
    Range("C3").Select
    ActiveSheet.DisplayAutomaticPageBreaks = False
       
    Application.ScreenUpdating = True
    
Select Case GetScreenRes
    Case "1280x800"
      ActiveWindow.Zoom = 110
    Case "1280x768"
      ActiveWindow.Zoom = 105
    Case "1280x720"
      ActiveWindow.Zoom = 100
    Case "1280x600"
      ActiveWindow.Zoom = 90
    Case "1280x1024"
      ActiveWindow.Zoom = 120
    Case "1024x768"
      ActiveWindow.Zoom = 105
    Case "800x600"
      ActiveWindow.Zoom = 90
    Case "1366x768"
      ActiveWindow.Zoom = 110
    Case "1680x1050"
      ActiveWindow.Zoom = 120
    Case "1920x1080"
      ActiveWindow.Zoom = 135
    Case Else
      ActiveWindow.Zoom = 115
End Select
    
End Sub

Sub JumpSchedule()
' Springt zur Schedule f|fffd|r Split-Training
Dim Hinweis As LongPtr


    Application.ScreenUpdating = False
    
    Sheets("Schedule").Visible = True
    Sheets("Schedule").Select
    Application.Goto Reference:=Range("A3"), Scroll:=True
    
    ActiveSheet.Unprotect Password:="Merlin1959!"
    
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        '.Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
    ActiveSheet.DisplayAutomaticPageBreaks = False

    Application.ScreenUpdating = True
    
    ActiveSheet.Protect Password:="Merlin1959!"

End Sub

Sub JumpSchedule_Zwei()
' Springt zur Schedule f|fffd|r Ganzheitliches Training
Dim Hinweis As LongPtr


    Application.ScreenUpdating = False
    
    Sheets("Schedule(2)").Visible = True
    Sheets("Schedule(2)").Select
    Application.Goto Reference:=Range("B1"), Scroll:=True
    
    ActiveSheet.Unprotect Password:="Merlin1959!"
    
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        '.Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
    ActiveSheet.DisplayAutomaticPageBreaks = False

    Application.ScreenUpdating = True
    
    ActiveSheet.Protect Password:="Merlin1959!"
End Sub

Sub JumpDatenbank_Split()
' |fffd|ffnet Formular Datenbank Muskelgruppen f|fffd|r Split-Trainingsplanung

' gibt vorhandene Datenbankeintr|fffd|ge zur|fffd|ck.
Load Dat_MGrp
Dat_MGrp.TextBox1.Value = Sheets("Schedule").Range("A42")
Dat_MGrp.TextBox14.Value = Sheets("Schedule").Range("A43")
Dat_MGrp.TextBox13.Value = Sheets("Schedule").Range("A44")
Dat_MGrp.TextBox15.Value = Sheets("Schedule").Range("A45")
Dat_MGrp.TextBox16.Value = Sheets("Schedule").Range("A46")
Dat_MGrp.TextBox8.Value = Sheets("Schedule").Range("A47")
Dat_MGrp.TextBox6.Value = Sheets("Schedule").Range("A48")
Dat_MGrp.TextBox10.Value = Sheets("Schedule").Range("A49")
Dat_MGrp.TextBox9.Value = Sheets("Schedule").Range("A50")
Dat_MGrp.TextBox11.Value = Sheets("Schedule").Range("A51")
Dat_MGrp.TextBox5.Value = Sheets("Schedule").Range("A52")
Dat_MGrp.TextBox7.Value = Sheets("Schedule").Range("A53")
Dat_MGrp.TextBox12.Value = Sheets("Schedule").Range("A54")
Dat_MGrp.TextBox18.Value = Sheets("Schedule").Range("A55")
Dat_MGrp.TextBox17.Value = Sheets("Schedule").Range("A56")
Dat_MGrp.TextBox19.Value = Sheets("Schedule").Range("A57")

' stellt die Markerfarben (Feldhintergrund) ein.
    If Dat_MGrp.TextBox1.Value = "Komplex" Then
    Dat_MGrp.TextBox1.BackColor = RGB(225, 219, 209)
    Else
    Dat_MGrp.TextBox1.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox12.Value = "Core" Then
    Dat_MGrp.TextBox12.BackColor = RGB(255, 242, 204)
    Else
    Dat_MGrp.TextBox12.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox14.Value = "Beine" Then
    Dat_MGrp.TextBox14.BackColor = RGB(219, 253, 135)
    Else
    Dat_MGrp.TextBox14.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox13.Value = "Beine Hint." Then
    Dat_MGrp.TextBox13.BackColor = RGB(235, 252, 192)
    Else
    Dat_MGrp.TextBox13.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox15.Value = "Beine Vord." Then
    Dat_MGrp.TextBox15.BackColor = RGB(246, 254, 226)
    Else
    Dat_MGrp.TextBox15.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox16.Value = "Waden" Then
    Dat_MGrp.TextBox16.BackColor = RGB(239, 255, 248)
    Else
    Dat_MGrp.TextBox16.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox8.Value = "R|fffd|cken" Then
    Dat_MGrp.TextBox8.BackColor = RGB(192, 184, 254)
    Else
    Dat_MGrp.TextBox8.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox6.Value = "Brust" Then
    Dat_MGrp.TextBox6.BackColor = RGB(121, 198, 255)
    Else
    Dat_MGrp.TextBox6.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox10.Value = "Schultern" Then
    Dat_MGrp.TextBox10.BackColor = RGB(93, 226, 253)
    Else
    Dat_MGrp.TextBox10.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox9.Value = "Schultern Seitl." Then
    Dat_MGrp.TextBox9.BackColor = RGB(140, 235, 254)
    Else
    Dat_MGrp.TextBox9.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox11.Value = "Schultern Hint." Then
    Dat_MGrp.TextBox11.BackColor = RGB(198, 245, 254)
    Else
    Dat_MGrp.TextBox11.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox5.Value = "Bizeps" Then
    Dat_MGrp.TextBox5.BackColor = RGB(221, 221, 255)
    Else
    Dat_MGrp.TextBox5.BackColor = RGB(255, 255, 255)
    End If
    If Dat_MGrp.TextBox7.Value = "Trizeps" Then
    Dat_MGrp.TextBox7.BackColor = RGB(183, 224, 255)
    Else
    Dat_MGrp.TextBox7.BackColor = RGB(255, 255, 255)
    End If
    
Dat_MGrp.TextBox18.SetFocus

Dat_MGrp.Show

End Sub


Sub JumpDatenbank_Ganz()
' Springt zur Datenbank f|fffd|r Trainingseinheiten ganzheitliches Training

    Application.ScreenUpdating = False

    Sheets("DB_Ganz").Visible = True
    Sheets("DB_Ganz").Select
    
    Application.Goto Reference:=Range("A1"), Scroll:=True
        
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        '.Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
    ActiveSheet.DisplayAutomaticPageBreaks = False
    
    Range("A2").Select
    Application.ScreenUpdating = True
    
End Sub

Sub JumpDB_zurueck()
' Springt aus den Datenbanken zur|fffd|ck zur entsprechenden Schedule

    Application.ScreenUpdating = False

    If ActiveWorkbook.ActiveSheet.Name = "DB_Ganz" Then
    Sheets("DB_Ganz").Visible = xlSheetVeryHidden
    Sheets("Schedule(2)").Select
    End If
    
    If ActiveWorkbook.ActiveSheet.Name = "DB_Split" Then
    Sheets("DB_Split").Visible = xlSheetVeryHidden
    Sheets("Schedule").Select
    End If
    
    'Application.Goto Reference:=Range("B1"), Scroll:=True
        
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayWorkbookTabs = False
        .DisplayHeadings = False
        '.Zoom = 100
    End With

    With Application
        .DisplayFormulaBar = False
        .DisplayStatusBar = False
        .DisplayFullScreen = True
    End With
    
    If Application.DisplayFormulaBar = True Then
    Application.DisplayFormulaBar = False
    End If
    If Application.DisplayStatusBar = True Then
    Application.DisplayStatusBar = False
    End If
       
    'Range("B1").Select
    ActiveSheet.DisplayAutomaticPageBreaks = False
    
    Application.ScreenUpdating = True
    
End Sub

'Navigation in der Schedule----------------------------------------

Sub Jump_begin()
    Application.Goto Reference:=Range("B1"), Scroll:=True
End Sub
Sub Jump_mid()
    Application.Goto Reference:=Range("AX1"), Scroll:=True
End Sub
Sub Jump_end()
    Application.Goto Reference:=Range("CS1"), Scroll:=True
End Sub
Sub Jump_Di()
    Application.Goto Reference:=Range("H1"), Scroll:=True
End Sub
Sub Jump_Mi()
    Application.Goto Reference:=Range("O1"), Scroll:=True
End Sub
Sub Jump_Do()
    Application.Goto Reference:=Range("V1"), Scroll:=True
End Sub
Sub Jump_Fr()
    Application.Goto Reference:=Range("AC1"), Scroll:=True
End Sub
Sub Jump_Sa()
    Application.Goto Reference:=Range("AJ1"), Scroll:=True
End Sub
Sub Jump_So()
    Application.Goto Reference:=Range("AQ1"), Scroll:=True
End Sub
Sub Jump_Mo()
    Application.Goto Reference:=Range("AX1"), Scroll:=True
End Sub
Sub Jump_Di_zwei()
    Application.Goto Reference:=Range("BE1"), Scroll:=True
End Sub
Sub Jump_Mi_zwei()
    Application.Goto Reference:=Range("BM1"), Scroll:=True
End Sub
Sub Jump_Do_zwei()
    Application.Goto Reference:=Range("BU1"), Scroll:=True
End Sub
Sub Jump_Fr_zwei()
    Application.Goto Reference:=Range("CC1"), Scroll:=True
End Sub
Sub Jump_Sa_zwei()
    Application.Goto Reference:=Range("CK1"), Scroll:=True
End Sub
Sub Jump_So_zwei()
    Application.Goto Reference:=Range("CS1"), Scroll:=True
End Sub
Sub Jump_Mo_zwei()
    Application.Goto Reference:=Range("DA1"), Scroll:=True
End Sub
'Ende Navigation in der Schedule ------------------------------

Sub Info()
Load Info_Form
Info_Form.MultiPage1.Value = 0
Info_Form.Show
End Sub

Sub Signatur_zeigen()
Signatur.TextBox1.Value = Sheets("Hidden").Range("H2").Value
Signatur.TextBox2.Value = Sheets("Hidden").Range("H3").Value
Signatur.TextBox3.Value = Sheets("Hidden").Range("H4").Value
Signatur.Show
End Sub

Sub Starthilfe_aufrufen()
Load Help_Start
Help_Start.MultiPage1.Value = 0
Help_Start.Show
End Sub


Sub Hilfe_Schedule_Ganzheitlich()
Load Help_Schedule_Ganz
Help_Schedule_Ganz.MultiPage1.Value = 0
Help_Schedule_Ganz.Show
End Sub

Sub Hilfe_Schedule_Split()
Load Help_Schedule_Split
Help_Schedule_Split.MultiPage1.Value = 0
Help_Schedule_Split.Show
End Sub

Sub Website_oeffnen()
    
    Set wshshell = CreateObject("WScript.Shell")
    wshshell.Run "www.MartinBecker-Trainingsplanung.de/"

End Sub

Sub Speichern_aktuell()
ThisWorkbook.Save
End Sub
Sub Speichern_Unter()
Application.Dialogs(xlDialogSaveAs).Show
End Sub

Sub ZoomAufrufen()
Application.Dialogs(xlDialogZoom).Show
End Sub

Attribute VB_Name = "Steuerung_Freischaltung"
Option Private Module

Sub Info_FormVersionMikroZ_show()
Load Info_Form_MikroZ
Info_Form_MikroZ.MultiPage1.Value = 0

Info_Form_MikroZ.TextBox1.Value = ""
Info_Form_MikroZ.TextBox2.Value = Sheets("UserTime").Range("H24").Value
Info_Form_MikroZ.TextBox3.Value = Sheets("UserTime").Range("D10").Value
Info_Form_MikroZ.TextBox4.Value = Sheets("UserTime").Range("L28").Value

'unterschiedliche Anzeige der Steuerelemente der Testversion/Vollversion
If Sheets("UserTime").Range("H24").Value = Sheets("UserTime").Range("L24").Value Then
'Info_Form_MikroZ.Label11.Visible = True
'Info_Form_MikroZ.Label10.Visible = False
Info_Form_MikroZ.Label14.Visible = False
Info_Form_MikroZ.TextBox3.Visible = False
Info_Form_MikroZ.Label15.Visible = False
Info_Form_MikroZ.TextBox4.Visible = False
Info_Form_MikroZ.Label12.Visible = False
Info_Form_MikroZ.TextBox1.Visible = False
Info_Form_MikroZ.CommandButton3.Visible = False
Info_Form_MikroZ.Label13.Visible = True
Info_Form_MikroZ.TextBox2.Visible = True
Info_Form_MikroZ.CommandButton2.Visible = False
Info_Form_MikroZ.Label16.Visible = False

Else

'Info_Form_MikroZ.Label11.Visible = False
'Info_Form_MikroZ.Label10.Visible = True
Info_Form_MikroZ.Label14.Visible = True
Info_Form_MikroZ.TextBox3.Visible = True
Info_Form_MikroZ.Label15.Visible = True
Info_Form_MikroZ.TextBox4.Visible = True
Info_Form_MikroZ.Label12.Visible = True
Info_Form_MikroZ.TextBox1.Visible = True
Info_Form_MikroZ.CommandButton3.Visible = True
Info_Form_MikroZ.Label13.Visible = False
Info_Form_MikroZ.TextBox2.Visible = False
Info_Form_MikroZ.CommandButton2.Visible = True
Info_Form_MikroZ.Label16.Visible = True
End If

Info_Form_MikroZ.Show
End Sub

Sub Freischalten_MikroZ_Zeigen()
Freischalten_VersionMikroZ.TextBox4.Value = Sheets("UserTime").Range("L28").Value

Freischalten_VersionMikroZ.Show
End Sub

Sub Format_StartMikroZ()
 Application.Worksheets("Start").Select
 Application.ScreenUpdating = False
    
     Application.Goto Reference:=Range("A1"), Scroll:=True
     With ActiveWindow
         .DisplayGridlines = False
         .DisplayWorkbookTabs = False
         .DisplayHeadings = False
         .Zoom = 100
     End With
 
     With Application
         .DisplayFormulaBar = False
         .DisplayStatusBar = False
         .DisplayFullScreen = True
     End With
 
     If Application.DisplayFormulaBar = True Then
     Application.DisplayFormulaBar = False
     End If
     If Application.DisplayStatusBar = True Then
     Application.DisplayStatusBar = False
     End If
    
     Sheets("Schedule").Visible = xlSheetVeryHidden
     Sheets("Schedule(2)").Visible = xlSheetVeryHidden
     Sheets("DB_Ganz").Visible = xlSheetVeryHidden
     Sheets("DB_Split").Visible = xlSheetVeryHidden

Select Case GetScreenRes
    Case "1280x800"
      ActiveWindow.Zoom = 110
    Case "1280x768"
      ActiveWindow.Zoom = 105
    Case "1280x720"
      ActiveWindow.Zoom = 100
    Case "1280x600"
      ActiveWindow.Zoom = 90
    Case "1280x1024"
      ActiveWindow.Zoom = 120
    Case "1024x768"
      ActiveWindow.Zoom = 105
    Case "800x600"
      ActiveWindow.Zoom = 90
    Case "1366x768"
      ActiveWindow.Zoom = 110
    Case "1680x1050"
      ActiveWindow.Zoom = 120
    Case "1920x1080"
      ActiveWindow.Zoom = 135
    Case Else
      ActiveWindow.Zoom = 115
End Select

Range("C3").Select
 Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit


Private Sub Worksheet_Change(ByVal Target As Range)

If Target.Address <> "B5" And Range("B5") = "" Then
MsgBox "Nicht vergessen !!!. Sie m|fffd|ssen zur Berechnung der korrekten Regenerationszeiten zwingend ein ""Zyklus-Startdatum"" (ein x-beliebiges Datum, meistens ein ""Montag"") in der ""roten"" Zelle angeben. Format: TT.MM.JJ", vbOKOnly + vbInformation, "Startdatum angeben"

Range("B5").Select
End If

End Sub

Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
Dim Meldung As LongPtr
    Set Target = Intersect(Target, Range("D6:D28,J5:J28,Q5:Q28,X5:X28,AE5:AE28,AL5:AL28,AS5:AS28,AZ5:AZ28,BH5:BH28,BP5:BP28,BX5:BX28,CF5:CF28,CN5:CN28,CV5:CV28,DD5:DD28"))
    If Target Is Nothing Then
    Exit Sub
    Else
        
    ActiveSheet.Unprotect Password:="Merlin1959!"

    'ActiveCell.Offset(0, 1).Range("A1").Select
    'ActiveCell.Value = "Trainingseinheit?"
    
    End If
    
    Application.ScreenUpdating = False
    
    If ActiveCell.Offset(0, -1).Range("A1").Value = 1 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Kraft"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Range("A1").Value = 2 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Ausdauer"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Range("A1").Value = 3 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Koordination"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Range("A1").Value = 4 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Beweglichkeit"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If
    
    If ActiveCell.Offset(0, -1).Range("A1").Value = 5 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Ganzheitlich"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If

    If ActiveCell.Offset(0, -1).Range("A1").Value = 6 Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Value = "Trainingseinheit?"
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=TE_Sonstiges"
        .IgnoreBlank = False
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Fehlerhafte Eingabe"
        .InputMessage = ""
        .ErrorMessage = "W|fffd|hlen Sie einen Eintrag aus der Liste aus!"
        .ShowInput = True
        .ShowError = True
    End With
    End If
    
    'Trainingsinhalte l|fffd|schen/Schedule-Eintrag zur|fffd|cksetzen
    If ActiveCell.Value = "" Then
    ActiveCell.Offset(0, 1).Range("A1").Select
    ActiveCell.Validation.Delete
    ActiveCell.Value = ""
    ActiveCell.Offset(0, -2).Range("A1").Select
    Call Stunden_Reset_zwei_Ganz
    
    ActiveSheet.Protect Password:="Merlin1959!"
    Application.ScreenUpdating = True
    ActiveCell.Offset(0, 0).Range("A1").Select
    Exit Sub

    End If

    Call Stunden_setzen_Ganz
    
    ActiveSheet.Protect Password:="Merlin1959!"
    Application.ScreenUpdating = True

End Sub


Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
