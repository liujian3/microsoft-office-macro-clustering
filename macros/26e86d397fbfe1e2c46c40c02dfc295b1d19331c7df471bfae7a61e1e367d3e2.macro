Attribute VB_Name = "NewMacros"
'''''''''''''''''''''''''''''''''''''''''
'untenstehende Makros setzen die Formatvorlagen wider auf den Ursprung zur|fffd|ck, falls eine Formatierung
'zerst|fffd|rt worden ist
''''''''''''''''''''''''''''''''''''''

Sub |fffd|berschriften()
    On Error Resume Next

If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If

''Definieren |fffd|berschrift 1
    With ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").FONT
        .NameFarEast = "+|fffd|berschriften asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 16
        .Bold = True
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 14
        .NameBi = "+|fffd|berschriften CS"
        .BoldBi = True
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 0
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = True
        .KeepTogether = True
        .PageBreakBefore = True
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-1.5)
        .OutlineLevel = wdOutlineLevel1
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1"). _
        NoSpaceBetweenParagraphsOfSameStyle = False
    ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").ParagraphFormat.TabStops. _
        ClearAll
    ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").ParagraphFormat.TabStops.Add _
        Position:=CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").LanguageID = wdEnglishUK
    ThisDocument.Styles(|fffd|berschr1 & "HZI |fffd|1_H1").NoProofing = False

 With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(1)
    .NumberFormat = "%1"
    .TrailingCharacter = wdTrailingTab
    .NumberStyle = wdListNumberStyleArabic
    .NumberPosition = CentimetersToPoints(0)
    .Alignment = wdListLevelAlignLeft
    .TextPosition = CentimetersToPoints(0.76)
    .TabPosition = wdUndefined
    .ResetOnHigher = 0
    .StartAt = 1
    With .FONT
        .Bold = wdUndefined
        .Italic = wdUndefined
        .StrikeThrough = wdUndefined
        .Subscript = wdUndefined
        .Superscript = wdUndefined
        .Shadow = wdUndefined
        .Outline = wdUndefined
        .Emboss = wdUndefined
        .Engrave = wdUndefined
        .AllCaps = wdUndefined
        .Hidden = wdUndefined
        .Underline = wdUndefined
        .Color = wdUndefined
        .Size = wdUndefined
        .Animation = wdUndefined
        .DoubleStrikeThrough = wdUndefined
        .Name = ""
    End With
    ' .LinkedStyle = "|fffd|berschrift 1"
End With

'Definieren |fffd|berschrift 2
    With ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").FONT
        .NameFarEast = "+|fffd|berschriften asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 14
        .Bold = True
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 14
        .NameBi = "+|fffd|berschriften CS"
        .BoldBi = True
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 12
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = True
        .KeepTogether = True
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-1.5)
        .OutlineLevel = wdOutlineLevel1
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2"). _
        NoSpaceBetweenParagraphsOfSameStyle = False
    ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").ParagraphFormat.TabStops. _
        ClearAll
    ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").ParagraphFormat.TabStops.Add _
        Position:=CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").LanguageID = wdEnglishUK
    ThisDocument.Styles(|fffd|berschr2 & "HZI |fffd|2_H2").NoProofing = False



'Definieren |fffd|berschrift 3
    With ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").FONT
        .NameFarEast = "+|fffd|berschriften asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 12
        .Bold = True
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 14
        .NameBi = "+|fffd|berschriften CS"
        .BoldBi = True
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 12
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = True
        .KeepTogether = True
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-1.5)
        .OutlineLevel = wdOutlineLevel1
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3"). _
        NoSpaceBetweenParagraphsOfSameStyle = False
    ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").ParagraphFormat.TabStops. _
        ClearAll
    ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").ParagraphFormat.TabStops.Add _
        Position:=CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").LanguageID = wdEnglishUK
    ThisDocument.Styles(|fffd|berschr3 & "HZI |fffd|3_H3").NoProofing = False



'Definieren |fffd|berschrift 4
    With ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").FONT
        .NameFarEast = "+|fffd|berschriften asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = True
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 14
        .NameBi = "+|fffd|berschriften CS"
        .BoldBi = True
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 12
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = True
        .KeepTogether = True
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-1.5)
        .OutlineLevel = wdOutlineLevel1
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4"). _
        NoSpaceBetweenParagraphsOfSameStyle = False
    ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").ParagraphFormat.TabStops. _
        ClearAll
    ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").ParagraphFormat.TabStops.Add _
        Position:=CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").LanguageID = wdEnglishUK
    ThisDocument.Styles(|fffd|berschr4 & "HZI |fffd|4_H4").NoProofing = False

4
On Error GoTo 10
ThisDocument.Styles("Hyperlink").Delete
10
Call gliederung

End Sub

Sub gliederung()
If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If

On Error GoTo 1
  With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(1)
        .NumberFormat = "%1"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.76)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        ' .LinkedStyle = "|fffd|berschrift 1"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(2)
        .NumberFormat = "%1.%2"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.02)
        .TabPosition = wdUndefined
        .ResetOnHigher = 1
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        ' .LinkedStyle = "|fffd|berschrift 2"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(3)
        .NumberFormat = "%1.%2.%3"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.27)
        .TabPosition = wdUndefined
        .ResetOnHigher = 2
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        ' .LinkedStyle = "|fffd|berschrift 3"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(4)
        .NumberFormat = "%1.%2.%3.%4"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.52)
        .TabPosition = wdUndefined
        .ResetOnHigher = 3
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        ' .LinkedStyle = "|fffd|berschrift 4"
    End With
1
End Sub

Sub Standard()
On Error GoTo 2
If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If
'Standard Formatierung festlegen
    With ThisDocument.Styles(stand & "HZI Strd").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles(stand & "HZI Strd").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles(stand & "HZI Strd").NoSpaceBetweenParagraphsOfSameStyle = _
        False
    ThisDocument.Styles(stand & "HZI Strd").ParagraphFormat.TabStops.ClearAll
    ThisDocument.Styles(stand & "HZI Strd").ParagraphFormat.TabStops.Add Position:= _
        CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles(stand & "HZI Strd").LanguageID = wdEnglishUK
    ThisDocument.Styles(stand & "HZI Strd").NoProofing = False
    ThisDocument.Styles(stand & "HZI Strd").LanguageID = wdJapanese
    ThisDocument.Styles(stand & "HZI Strd").NoProofing = False

2

End Sub
Sub Strd_Center()

On Error GoTo 2
'-------------------------------------------------------------------------------
'Standard;Strd Zentriert Formatierung festlegen
    With ThisDocument.Styles("HZI Strd Center").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd Center").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphCenter
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd Center").NoSpaceBetweenParagraphsOfSameStyle = _
        False
    ThisDocument.Styles("HZI Strd Center").ParagraphFormat.TabStops.ClearAll
    ThisDocument.Styles("HZI Strd Center").ParagraphFormat.TabStops.Add Position:= _
        CentimetersToPoints(0), Alignment:=wdAlignTabLeft, Leader:= _
        wdTabLeaderSpaces
    ThisDocument.Styles("HZI Strd Center").LanguageID = wdEnglishUK
    ThisDocument.Styles("HZI Strd Center").NoProofing = False
    ThisDocument.Styles("HZI Strd Center").LanguageID = wdJapanese
    ThisDocument.Styles("HZI Strd Center").NoProofing = False
    
2
End Sub
'-------------------------------------------------------
Sub Strd_Left()
On Error GoTo 1

    With ThisDocument.Styles("HZI Strd Left").FONT
        .NameFarEast = "Arial"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorAutomatic
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 10
        .NameBi = "Times New Roman"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd Left"). _
        ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphLeft
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd Left"). _
        NoSpaceBetweenParagraphsOfSameStyle = False

1
End Sub

Sub Strd_Green()
On Error GoTo 1
 With ThisDocument.Styles("HZI Strd Green").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = 5287936
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd Green").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd Green"). _
        NoSpaceBetweenParagraphsOfSameStyle = False

1
End Sub
Sub Strd_DRed()

'strd dunkel rot
On Error GoTo 2

    With ThisDocument.Styles("HZI Strd D-Red").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = 192
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd D-Red"). _
        ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd D-Red"). _
        NoSpaceBetweenParagraphsOfSameStyle = False
    ThisDocument.Styles("HZI Strd D-Red").ParagraphFormat. _
        TabStops.ClearAll
    ThisDocument.Styles("HZI Strd D-Red").ParagraphFormat. _
        TabStops.Add Position:=CentimetersToPoints(0), Alignment:=wdAlignTabLeft, _
         Leader:=wdTabLeaderSpaces

2
End Sub
Sub Strd_Red()
On Error GoTo 3
'strd Rot
    With ThisDocument.Styles("HZI Strd Red").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = wdColorRed '12611584
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd Red").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd Red"). _
        NoSpaceBetweenParagraphsOfSameStyle = False

3
End Sub
Sub Strd_Blue()

On Error GoTo 4

    With ThisDocument.Styles("HZI Strd Blue").FONT
        .NameFarEast = "+Textk|fffd|rper asiatisch"
        .NameAscii = "Arial"
        .NameOther = "Arial"
        .Name = "Arial"
        .Size = 11
        .Bold = False
        .Italic = False
        .Underline = wdUnderlineNone
        .UnderlineColor = wdColorAutomatic
        .StrikeThrough = False
        .DoubleStrikeThrough = False
        .Outline = False
        .Emboss = False
        .Shadow = False
        .Hidden = False
        .SmallCaps = False
        .AllCaps = False
        .Color = 12611584
        .Engrave = False
        .Superscript = False
        .Subscript = False
        .Scaling = 100
        .Kerning = 0
        .Animation = wdAnimationNone
        .DisableCharacterSpaceGrid = False
        .EmphasisMark = wdEmphasisMarkNone
        .SizeBi = 11
        .NameBi = "+Textk|fffd|rper CS"
        .BoldBi = False
        .ItalicBi = False
        .Ligatures = wdLigaturesNone
        .NumberSpacing = wdNumberSpacingDefault
        .NumberForm = wdNumberFormDefault
        .StylisticSet = wdStylisticSetDefault
        .ContextualAlternates = 0
    End With
    With ThisDocument.Styles("HZI Strd Blue").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Strd Blue"). _
        NoSpaceBetweenParagraphsOfSameStyle = False

4
End Sub
Sub Listing()
On Error GoTo 1
    With ThisDocument.Styles("HZI Listing").ParagraphFormat
        .LeftIndent = CentimetersToPoints(1.37)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-0.63)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Listing"). _
        NoSpaceBetweenParagraphsOfSameStyle = True
    With ListGalleries(wdBulletGallery).ListTemplates(1).ListLevels(1)
        .NumberFormat = ChrW(61623)
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleBullet
        .NumberPosition = CentimetersToPoints(0.63)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.27)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "Symbol"
        End With
        ' .LinkedStyle = "HZI Listing"
    End With
    ThisDocument.Styles("HZI Listing").LinkToListTemplate _
        ListTemplate:=ListGalleries(wdBulletGallery).ListTemplates(1), _
        ListLevelNumber:=1


1
End Sub
Sub Numbering()

On Error GoTo 2
    With ThisDocument.Styles("HZI Numbering").ParagraphFormat
        .LeftIndent = CentimetersToPoints(1.27)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 6
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphJustify
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-0.63)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI Numbering"). _
        NoSpaceBetweenParagraphsOfSameStyle = True
    With ListGalleries(wdNumberGallery).ListTemplates(1).ListLevels(1)
        .NumberFormat = "%1."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.63)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.27)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .FONT
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        ' .LinkedStyle = "HZI Numbering"
    End With
    ThisDocument.Styles("HZI Numbering").LinkToListTemplate ListTemplate:= _
        ListGalleries(wdNumberGallery).ListTemplates(1), ListLevelNumber:=1

2
End Sub
Sub List_Letter()

'Buchstabenaufz|fffd|hlung
On Error GoTo 3
   With ThisDocument.Styles("HZI List Letter"). _
        ParagraphFormat
        .LeftIndent = CentimetersToPoints(1)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 12
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphLeft
        .WidowControl = True
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(-0.5)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .ReadingOrder = wdReadingOrderLtr
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    ThisDocument.Styles("HZI List Letter"). _
        NoSpaceBetweenParagraphsOfSameStyle = True

3
End Sub



Sub TextZwischenZweiTextmarkenMarkieren()
  Dim oDoc As Document
  Set oDoc = ActiveDocument
  If oDoc.Bookmarks.Exists("kommentar_text_anfang") And oDoc.Bookmarks.Exists("kommentar_text_ende") Then
    oDoc.Range(Start:=oDoc.Bookmarks("kommentar_text_anfang").Range.Start, _
               End:=oDoc.Bookmarks("kommentar_text_ende").Range.Start).Select
  End If
  Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
End Sub

Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.Makro1"
'
' Makro1 Makro
'
'

    Selection.FONT.Color = RGB(0, 176, 80)
    
End Sub
Attribute VB_Name = "Style_Name_|fffd|ndern"
Sub nameStyle()
On Error Resume Next


If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If

With ThisDocument
    .Styles("HZI List Letter").NameLocal = "HZI List Letter"
    .Styles("HZI Listing").NameLocal = "HZI Listing"
    .Styles("HZI Listing green").NameLocal = "HZI Listing green"
    .Styles("HZI Numbering").NameLocal = "HZI Numbering"
    .Styles("HZI Numbering green").NameLocal = "HZI Numbering green"
    .Styles("HZI Pic Title").NameLocal = "HZI Pic Title"
    .Styles(stand & "HZI Strd").NameLocal = "Standard;HZI Strd"
    .Styles("HZI Strd Blue").NameLocal = "HZI Strd Blue"
    .Styles("HZI Strd Center").NameLocal = "HZI Strd Center"
    .Styles("HZI Strd Green").NameLocal = "HZI Strd Green"
    .Styles("HZI Strd Left").NameLocal = "HZI Strd Left"
    .Styles("HZI Strd Red").NameLocal = "HZI Strd Red"
    .Styles("HZI Table Text").NameLocal = "HZI Table Text"
    .Styles("HZI Table Text Center").NameLocal = "HZI Table Text Center"
    .Styles("HZI Table Text green").NameLocal = "HZI Table Text green"
    .Styles("HZI Table Text small").NameLocal = "HZI Table Text small"
    .Styles("HZI Table Title").NameLocal = "HZI Table Title"
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").NameLocal = |fffd|berschr1 & "HZI |fffd|1_H1"
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").NameLocal = |fffd|berschr2 & "HZI |fffd|2_H2"
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").NameLocal = |fffd|berschr3 & "HZI |fffd|3_H3"
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").NameLocal = |fffd|berschr4 & "HZI |fffd|4_H4"
    For Each Style In ThisDocument.Styles
        Style.FONT.Name = "Arial"
    Next
End With
End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Private Sub Document_Open()
'''''''''''''''''''''''''''''''''''''
'beim |fffd|ffnen des Dokumentes werden verschiedene Einstellungen vorgenommen die mit der Ansicht zu tun haben
''''''''''''''''''''''''''''''''''''''

On Error Resume Next
    
    Application.TaskPanes(wdTaskPaneFormatting).Visible = True  'zeigt die Benutzerdefinierten Formatvorlagen an
    Application.DisplayStatusBar = True
    Application.ShowWindowsInTaskbar = True
    Application.ShowStartupDialog = True
    ActiveWindow.View.DisplayPageBoundaries = True              'zeigt die Kopf/Fusszeilen an => damit ganze Seite erscheint
    ActiveDocument.TrackRevisions = False   'der |fffd|berarbeitungsmodus wird deaktiviert
    
'Falls die Quelle das PIRS ist, so wird der Wert so gesetzt das die Startmaske nicht mehr angezeigt wird
    If ActiveDocument.CustomDocumentProperties("Quelle").Value = "PIRS" Then
        ActiveDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "nein"
        Call Rev_00_aus_PIRS
    End If
    
'Einschr|fffd|nkung welche Formatvorlagen angezeigt werden
    ActiveDocument.FormattingShowFilter = wdShowFilterStylesAvailable
    ActiveDocument.FormattingShowFont = False
    ActiveDocument.FormattingShowParagraph = False
    ActiveDocument.FormattingShowNumbering = False
    ThisDocument.ActiveWindow.View.TableGridlines = True 'Rahmenlinien von Tabellen werden angezeigt

 'die Ansicht der Formatvorlagen wird auf Standard gesetzt
    Call Ansicht
    
''beim Starten der Vorlage die startmaske angezeigt
    If ActiveDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "ja" Then
        frm_Rev0.Show
    End If
End Sub
Sub Ansicht()
 Dim styl As Word.Style
 
On Error Resume Next
 
If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If
 
'jede Formatvorlage (Style) wird ausgeblendet
 For Each styl In ThisDocument.Styles
     With ThisDocument.Content.Find
         styl.Visibility = True
     End With
 Next styl
 
'alle Standard Formatvorlagen werden eingeblendet (Visibility = False :-)
With ThisDocument
    .Styles("HZI List Letter").Visibility = False
    .Styles("HZI Listing").Visibility = False
    .Styles("HZI Listing green").Visibility = False
    .Styles("HZI Numbering").Visibility = False
    .Styles("HZI Numbering green").Visibility = False
    .Styles("HZI Pic Title").Visibility = False
    
    .Styles(stand & "HZI Strd").Visibility = False
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").Visibility = False
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").Visibility = False
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").Visibility = False
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").Visibility = False

    .Styles("HZI Strd Blue").Visibility = False
    .Styles("HZI Strd Center").Visibility = False
    .Styles("HZI Strd Green").Visibility = False
    .Styles("HZI Strd Left").Visibility = False
    .Styles("HZI Strd Red").Visibility = False
    '.Styles("Tabellenraster;HZI Table Grid").Visibility = False
    .Styles("HZI Table Text").Visibility = False
    .Styles("HZI Table Text Center").Visibility = False
    .Styles("HZI Table Text green").Visibility = False
    .Styles("HZI Table Text small").Visibility = False
    .Styles("HZI Table Title").Visibility = False

End With

'die Reihenfolge wie die Formatvorlagen angezeigt werden sollen wird festgelegt
With ThisDocument
    .Styles("HZI List Letter").Priority = 21
    .Styles("HZI Listing").Priority = 22
    .Styles("HZI Listing green").Priority = 23
    .Styles("HZI Numbering").Priority = 31
    .Styles("HZI Numbering green").Priority = 32
    .Styles("HZI Pic Title").Priority = 16
    
    .Styles(stand & "HZI Strd").Priority = 10
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").Priority = 50
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").Priority = 51
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").Priority = 52
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").Priority = 53

    .Styles("HZI Strd Center").Priority = 11
    .Styles("HZI Strd Left").Priority = 12
    .Styles("HZI Strd Green").Priority = 13
    .Styles("HZI Strd D-Red").Priority = 14
    .Styles("HZI Strd Red").Priority = 14
    .Styles("HZI Strd Blue").Priority = 15
    '.Styles("Tabellenraster;HZI Table Grid").Priority = 43
    .Styles("HZI Table Text").Priority = 41
    .Styles("HZI Table Text Center").Priority = 42
    .Styles("HZI Table Text green").Priority = 44
    .Styles("HZI Table Text small").Priority = 43
    .Styles("HZI Table Title").Priority = 40

End With

'die Optionen werden so eingestellt das nur noch die HZI-Vorlagen angezeigt werden
ThisDocument.FormattingShowNextLevel = False
ThisDocument.FormattingShowUserStyleName = True
ThisDocument.FormattingShowFilter = wdShowFilterStylesAvailable 'anzeigen im aktuellen Dokument
ThisDocument.StyleSortMethod = wdStyleSortRecommended 'sortieren wie empfohlen
Application.TaskPanes(wdTaskPaneFormatting).Visible = True 'das Fenster mit den Formatvorlagen wird angezeigt
Exit Sub

'Testmakro_Err:
'If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
'    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
'        y_fehlermeldung_40351.Show
'        Err.Clear
'        End     'makro wird beendet
'    Else
'        MsgBox "im Makro welches beim |fffd|ffnen des Dokumentes ausgef|fffd|hrt wird ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
'            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
'    End If
'End If
    Application.TaskPanes(wdTaskPaneFormatting).Visible = True 'das Fenster mit den Formatvorlagen wird angezeigt
End Sub
Private Sub entsperren()
On Error GoTo 1
    ThisDocument.Unprotect
1
End Sub




Attribute VB_Name = "bilder"
Attribute VB_Base = "0{51D07B73-058C-4446-84F7-0E999914B6E4}{DCF0CFF1-1501-410A-AF1C-331BFD191BC9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Public bezbild As Variant
Public beztabelle As Variant



Private Sub CommandButton1_Click()
    If OptionButton1.Value = False And OptionButton2.Value = False And OptionButton3.Value = False And OptionButton4.Value = False Then
    'If OptionButton3.Value = False Or OptionButton4.Value = False Then
    MsgBox "Choose a version to generate a picture frame"
    End If


    'es wird gepr|fffd|ft ob die gr|fffd|nen Mussfelder ausgef|fffd|llt sind
For Each objGr|fffd|neTextBoxen In Controls       'jedes Kontrollfeld wird gepr|fffd|ft (nicht nur Text Boxen)
    If TypeName(objGr|fffd|neTextBoxen) = "TextBox" Then     'es wird gepr|fffd|ft ob es sich bei der Control um eine TextBox handelt
        If objGr|fffd|neTextBoxen.BackColor = &HC0FFC0 Then          'falls das Feld gr|fffd|n ist...
            If objGr|fffd|neTextBoxen.Value = "" Then                '... und das Feld leer ist...
                MsgBox "enter a Title in the green field"    '... wird die MsgBox angezeigt
               ' frm_Rev0.Show
                Exit Sub
            End If
        End If
    End If
Next

    
    If OptionButton5.Value = True Then
    bezbild = "Picture"
    beztabelle = "Table"
    ElseIf OptionButton6.Value = True Then
    bezbild = "Bild"
    beztabelle = "Tabelle"
    End If
    
    
    If OptionButton1.Value = True Then
    Call bildgross
    ElseIf OptionButton2.Value = True Then
    Call bilddoppelt
    ElseIf OptionButton3.Value = True Or OptionButton4.Value = True Then
    Call bildklein
    End If

    CommandBars("Picture").Visible = True
     ActiveWindow.ActivePane.View.ShowAll = True     'Enter werden angezeigt
    ThisDocument.ActiveWindow.View.TableGridlines = True 'Rahmenlinien werden angezeigt
End Sub

Sub bildgross()
    titel = TextBox1.Text
    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.MoveUp Unit:=wdLine, Count:=1
    ThisDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
        1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
    With Selection.Tables(1)
       ' If .Style <> "Tabellengitternetz" Then
       '     .Style = "Tabellengitternetz"
       ' End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True
        .TopPadding = CentimetersToPoints(0)
        .BottomPadding = CentimetersToPoints(0)
        .LeftPadding = CentimetersToPoints(0)
        .RightPadding = CentimetersToPoints(0)
        .AllowPageBreaks = False
        .AllowAutoFit = True
    End With
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.InsertRows 1
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Style = ThisDocument.Styles("HZI Pic Title")
    CaptionLabels.Add Name:=bezbild
    Selection.InsertCaption Label:=bezbild, TitleAutoText:="", Title:="", _
        Position:=wdCaptionPositionBelow, ExcludeLabel:=0
    Selection.MoveLeft Unit:=wdWord, Count:=2, Extend:=wdExtend
    Selection.Cut
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection.PasteAndFormat (wdPasteDefault)
    Selection.TypeText Text:=": " & titel
    Unload Me
    
End Sub
Sub bilddoppelt()
    
'bestimmt die breite des dokumentes
    linkerrand = Selection.PageSetup.LeftMargin
    rechterrand = Selection.PageSetup.RightMargin
    lrand = PointsToCentimeters(linkerrand)
    rrand = PointsToCentimeters(rechterrand)
    
    If Selection.PageSetup.Orientation = wdOrientLandscape Then
    seitenbreite = 29.9
    Else
    seitenbreite = 21.2
    End If
    
    breitebild = (seitenbreite - (lrand + rrand)) / 2 - 0.3
    
    Titel2 = TextBox2.Text
    Titel3 = TextBox3.Text
    
    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.MoveUp Unit:=wdLine, Count:=2

    
    ThisDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
        3, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
    With Selection.Tables(1)
       ' If .Style <> "Tabellengitternetz" Then
       '     .Style = "Tabellengitternetz"
       ' End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True
        .TopPadding = CentimetersToPoints(0)
        .BottomPadding = CentimetersToPoints(0)
        .LeftPadding = CentimetersToPoints(0)
        .RightPadding = CentimetersToPoints(0)
        .AllowPageBreaks = False
        .AllowAutoFit = False
    End With
  
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.Range.Cells(1).PreferredWidthType = wdPreferredWidthPoints
    Selection.Range.Cells(1).PreferredWidth = CentimetersToPoints(0.4)
    Selection.Move Unit:=wdColumn, Count:=1
    Selection.SelectColumn
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    Selection.columns.PreferredWidthType = wdPreferredWidthPoints
    Selection.columns.PreferredWidth = CentimetersToPoints(breitebild)
    Selection.Move Unit:=wdColumn, Count:=1
    Selection.SelectColumn
    Selection.Move Unit:=wdColumn, Count:=1
    Selection.SelectColumn
    Selection.columns.PreferredWidthType = wdPreferredWidthPoints
    Selection.columns.PreferredWidth = CentimetersToPoints(breitebild)
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    Selection.Move Unit:=wdColumn, Count:=1
    Selection.SelectColumn
    Selection.columns.PreferredWidthType = wdPreferredWidthPoints
    
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.InsertRows 1

    Selection.Style = ThisDocument.Styles("HZI Pic Title")
    CaptionLabels.Add Name:=bezbild
    Selection.InsertCaption Label:=bezbild, TitleAutoText:="", Title:="", _
        Position:=wdCaptionPositionBelow, ExcludeLabel:=0
    Selection.MoveLeft Unit:=wdWord, Count:=2, Extend:=wdExtend
    Selection.Copy

    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection.PasteAndFormat (wdPasteDefault)
    Selection.TypeText Text:=": " & Titel2
    Selection.MoveRight Unit:=wdCharacter, Count:=2
    Selection.PasteAndFormat (wdPasteDefault)
    
    Selection.MoveLeft Unit:=wdCharacter, Count:=3, Extend:=wdExtend
    Selection.Fields.Update
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.TypeText Text:=": " & Titel3
    Selection.MoveDown Unit:=wdLine, Count:=1

    Selection.MoveLeft Unit:=wdWord, Count:=2
    Selection.MoveRight Unit:=wdWord, Count:=3, Extend:=wdExtend
    Selection.Delete Unit:=wdCharacter, Count:=1


    Unload Me
    
End Sub

Sub bildklein()
'pr|fffd|ft ob quer oder hochformat => |fffd|ndert dann die Rahmenbreite
    linkerrand = Selection.PageSetup.LeftMargin
    rechterrand = Selection.PageSetup.RightMargin
    lrand = PointsToCentimeters(linkerrand)
    rrand = PointsToCentimeters(rechterrand)
    
    If Selection.PageSetup.Orientation = wdOrientLandscape Then
    seitenbreite = 29.9
    Else
    seitenbreite = 21.2
    End If
    
    breitebild = (seitenbreite - (lrand + rrand)) / 2 - 0.3

    If OptionButton3.Value = True Then
    Titel4 = TextBox4.Text
    Position = wdTableLeft
    Else
    Titel4 = TextBox5.Text
    Position = wdTableRight
    End If
    
   Selection.TypeParagraph
   Selection.TypeParagraph
   Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.MoveUp Unit:=wdLine, Count:=3
    
  ThisDocument.Tables.Add Range:=Selection.Range, NumRows:=2, NumColumns:= _
        2, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
    With Selection.Tables(1)
       ' If .Style <> "Tabellengitternetz" Then
       '     .Style = "Tabellengitternetz"
       ' End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True

    End With
    
    Selection.MoveRight Unit:=wdCharacter, Count:=2, Extend:=wdExtend
    Selection.MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderHorizontal).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderVertical).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.columns.PreferredWidthType = wdPreferredWidthPoints
    Selection.columns.PreferredWidth = CentimetersToPoints(7)
    Selection.SelectColumn
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    Selection.columns.PreferredWidth = CentimetersToPoints(breitebild)
    Selection.Move Unit:=wdColumn, Count:=1
    Selection.SelectColumn
    Selection.columns.PreferredWidthType = wdPreferredWidthPoints
    Selection.columns.PreferredWidth = CentimetersToPoints(0.3)
    Selection.Collapse Direction:=wdCollapseStart
    Selection.Move Unit:=wdColumn, Count:=-1
    Selection.SelectColumn
    With Selection.Tables(1)
        .TopPadding = CentimetersToPoints(0)
        .BottomPadding = CentimetersToPoints(0)
        .LeftPadding = CentimetersToPoints(0)
        .RightPadding = CentimetersToPoints(0)
        .Spacing = 0
        .AllowPageBreaks = True
        .AllowAutoFit = False
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    CaptionLabels.Add Name:=bezbild
    Selection.InsertCaption Label:=bezbild, TitleAutoText:="", Title:="", _
        Position:=wdCaptionPositionBelow, ExcludeLabel:=0
    Selection.MoveLeft Unit:=wdWord, Count:=2, Extend:=wdExtend
    Selection.Cut
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection.PasteAndFormat (wdPasteDefault)
    Selection.TypeText Text:=": " & Titel4
    Selection.Style = ThisDocument.Styles("HZI Pic Title")
    Selection.MoveLeft Unit:=wdWord, Count:=1, Extend:=wdExtend
    Selection.Fields.Update
    With Selection.Tables(1).rows
        .WrapAroundText = True
        .HorizontalPosition = Position
        .RelativeHorizontalPosition = wdRelativeHorizontalPositionColumn
        .DistanceLeft = CentimetersToPoints(0.2)
        .DistanceRight = CentimetersToPoints(0.2)
        .VerticalPosition = CentimetersToPoints(0)
        .RelativeVerticalPosition = wdRelativeVerticalPositionParagraph
        .DistanceTop = CentimetersToPoints(0)
        .DistanceBottom = CentimetersToPoints(0)
        .AllowOverlap = False
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.Move Unit:=wdColumn, Count:=-1
    Unload Me
    MsgBox "move frame into text if necessary"
    
End Sub
Private Sub CommandButton2_Click()
    Unload Me
        
End Sub

Private Sub OptionButton1_Click()
    Me.TextBox1.BackColor = &HC0FFC0
    Me.TextBox2.BackColor = &H80000005
    Me.TextBox3.BackColor = &H80000005
    Me.TextBox4.BackColor = &H80000005
    Me.TextBox5.BackColor = &H80000005
End Sub

Private Sub OptionButton2_Click()
    Me.TextBox2.BackColor = &HC0FFC0
    Me.TextBox3.BackColor = &HC0FFC0
    
    Me.TextBox1.BackColor = &H80000005
    Me.TextBox4.BackColor = &H80000005
    Me.TextBox5.BackColor = &H80000005
End Sub
Private Sub OptionButton3_Click()
    Me.TextBox4.BackColor = &HC0FFC0
    
    Me.TextBox2.BackColor = &H80000005
    Me.TextBox3.BackColor = &H80000005
    Me.TextBox1.BackColor = &H80000005
    Me.TextBox5.BackColor = &H80000005
End Sub
Private Sub OptionButton4_Click()
    Me.TextBox5.BackColor = &HC0FFC0
    
    Me.TextBox2.BackColor = &H80000005
    Me.TextBox3.BackColor = &H80000005
    Me.TextBox4.BackColor = &H80000005
    Me.TextBox1.BackColor = &H80000005
End Sub

Private Sub UserForm_Initialize()

On Error GoTo Testmakro_Err
'''''''''''''''''''''''''''''''''''''''
'falls die Sprache auf Deutsch ist, so wird im Form der Knopf auf Deutsch gestellt,
'damit der Titel "Bild" heisst und nicht "Picture"
''''''''''''''''''''''''''''''''''''''
If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If

    Dim Sprache As Variant
    Sprache = ThisDocument.Styles(stand & "HZI Strd").LanguageID
    If Sprache = wdSwissGerman Then
        Me.OptionButton6.Value = True
    Else
        Me.OptionButton5.Value = True
    End If

Exit Sub


Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If


End Sub

Attribute VB_Name = "frmDocType"
Attribute VB_Base = "0{7BDEE3A8-3DD9-4E50-B9C1-C0BBC7D24CED}{39936A7E-6B11-41CA-8994-BD632F4401D6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub chkCConstruction_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkDDrawings_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkJProJectMan_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkLLists_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkMMinutes_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkOOM_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkPDiagrams_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkQDoc_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkRProcurement_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkSTimeSchedules_Click()
    Call einzelne_kategorieen
End Sub
Private Sub chkTTechnicalDoc_Click()
    Call einzelne_kategorieen
End Sub
Private Sub einzelne_kategorieen()
    zeilen = sheets("Makro Werte").UsedRange.rows.Count
    cur_ctrl = ActiveControl.Name               'name aktueller Textbox
    buchstabe = Left(Right(cur_ctrl, Len(cur_ctrl) - 3), 1)   'aktueller Name der Textbox ohne txt
    Me.lstSuchergebnis.Clear
    x = Range("excelDatei").Row + 1
    If ActiveControl.Value = True Then
        For x = 2 To zeilen
            If Left(sheets("Makro Werte").Range("A" & x & "").Value, 1) = buchstabe Then
              sheets("Makro Werte").Cells(x, Range("spezifisch").Column).Value = "x"
              y = x
            End If
        Next x
        sheets("Makro Werte").Cells(y + 1, Range("spezifisch").Column).Value = "x"
    Else
        For x = 2 To zeilen
            If Left(sheets("Makro Werte").Range("A" & x & "").Value, 1) = buchstabe Then
              sheets("Makro Werte").Cells(x, Range("spezifisch").Column).Value = ""
              y = x
            End If
        Next x
        sheets("Makro Werte").Cells(y + 1, Range("spezifisch").Column).Value = ""
    End If
    For x = 2 To zeilen
        If sheets("Makro Werte").Cells(x, Range("spezifisch").Column).Value = "x" Then
            Me.lstSuchergebnis.AddItem sheets("Makro Werte").Range("A" & x & "").Value
        End If
    Next x
End Sub
Private Sub chkNurExcel_Click()
    zeilen = sheets("Makro Werte").UsedRange.rows.Count
    Me.lstSuchergebnis.Clear
    x = Range("excelDatei").Row + 1
    For x = 2 To zeilen
        If sheets("Makro Werte").Cells(x, Range("excelDatei").Column).Value = "x" Then
            Me.lstSuchergebnis.AddItem sheets("Makro Werte").Range("A" & x & "").Value
        End If
    Next x
End Sub

Private Sub cmdAusf|fffd|hren_Click()
    If Me.txtKathegorie.Value = "" Then
        MsgBox "Document Category is Mandatory"
        Exit Sub
    End If
    
    Position = InStr(1, txtKathegorie, "=")

    ThisDocument.Bookmarks("doctype").Select
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        With Selection
            .FONT.Color = wdColorBlack
        End With
    Selection = Left(Me.txtKathegorie.Value, Position - 2)
    ThisDocument.CustomDocumentProperties("Document Type").Value = Left(Me.txtKathegorie.Value, Position - 2)
    
    Unload Me
End Sub
Private Sub cmdNurExcel_Click()
    zeilen = sheets("Makro Werte").UsedRange.rows.Count
    Me.lstSuchergebnis.Clear
    x = Range("excelDatei").Row + 1
    For x = 2 To zeilen
        If sheets("Makro Werte").Cells(x, Range("excelDatei").Column).Value = "x" Then
            Me.lstSuchergebnis.AddItem sheets("Makro Werte").Range("A" & x & "").Value
        End If
    Next x
End Sub

Private Sub cmd_all_cat_Click()
lstSuchergebnis.Clear
Call UserForm_Initialize

End Sub

Private Sub lstSuchergebnis_AfterUpdate()
    Me.txtKathegorie.Value = Me.lstSuchergebnis.Value
End Sub

Private Sub txtSuchwert_Change()
    Dim wert As String
    zeilen = sheets("Makro Werte").UsedRange.rows.Count
    For Each Control In frmDocType.Controls
        If TypeOf Control Is MSForms.CheckBox And Control.BackColor = &HC0C0FF Then
            Control.Value = False
        End If
    Next
    l|fffd|schZeile = Range("spezifisch").Row + 1
    l|fffd|schSpalte = Range("spezifisch").Column
    Range(Cells(l|fffd|schZeile, l|fffd|schSpalte), Cells(zeilen, l|fffd|schSpalte)).ClearContents
    Me.lstSuchergebnis.Clear
    wert = Me.txtSuchwert.Value
    Range("suchwert").Value = LCase(wert)
    x = 2
    
    For x = 2 To zeilen
    If Cells(x, Range("suchwert").Column).Value = "OK" Then
        Me.lstSuchergebnis.AddItem sheets("Makro Werte").Cells(x, 1).Value
    End If
    Next x
End Sub
Private Sub OptionButton1_Click()
    lstSuchergebnis.Clear
    Call UserForm_Initialize
End Sub
Private Sub optOperatingM_Click()
lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "OGE = OPERATING MANUAL GENERAL"
    Me.lstSuchergebnis.AddItem "OTR = Training Document"
End Sub
Private Sub optAngebote_Click()
    lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "AGE = ANGEBOTE GENERAL"
    Me.lstSuchergebnis.AddItem "ACA = Calculation"
    Me.lstSuchergebnis.AddItem "AGP = GP410 document"
    Me.lstSuchergebnis.AddItem "ALO = LOA document"
    Me.lstSuchergebnis.AddItem "AOF = Offer of HZI"
End Sub

Private Sub optConstruction_Click()
    lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "CGE = CONSTRUCTION SITE GENERAL"
    Me.lstSuchergebnis.AddItem "CBQ = Bill of Quantity"
    Me.lstSuchergebnis.AddItem "CLE = Leaflet"
    Me.lstSuchergebnis.AddItem "CMR = Method statement / Risk Assessment"
    Me.lstSuchergebnis.AddItem "CTR = Training"
End Sub

Private Sub optDrawings_Click()
    lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "DGE = DRAWINGS GENERAL"
Me.lstSuchergebnis.AddItem "DCA = Architectal Drawings"
Me.lstSuchergebnis.AddItem "DCI = Civil Indications"
Me.lstSuchergebnis.AddItem "DEO = Equipment Outline Drawing (EOD)"
Me.lstSuchergebnis.AddItem "DDT = Mechanical Construction Drawing"
Me.lstSuchergebnis.AddItem "DEI = EIC Drawing"
Me.lstSuchergebnis.AddItem "DLA = Plant Layout Drawing"
Me.lstSuchergebnis.AddItem "DPI = Piping Drawing / Isometric"
Me.lstSuchergebnis.AddItem "DST = Steelstructure Drawing"
Me.lstSuchergebnis.AddItem "DSY = Safety Drawing"
Me.lstSuchergebnis.AddItem "DCD = Civil Drawing"
Me.lstSuchergebnis.AddItem "DBS = Building Services Drawing"
Me.lstSuchergebnis.AddItem "DMA = Maintenance Drawing"
Me.lstSuchergebnis.AddItem "DER = Erection Drawing"
End Sub
Private Sub optLists_Click()
lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "LGE = LISTS GENERAL"
Me.lstSuchergebnis.AddItem "LCA = Cable List"
Me.lstSuchergebnis.AddItem "LCO = Comos Overall List"
Me.lstSuchergebnis.AddItem "LDO = Document List"
Me.lstSuchergebnis.AddItem "LDR = Drawing List"
Me.lstSuchergebnis.AddItem "LEC = E-Consumer List"
Me.lstSuchergebnis.AddItem "LEQ = Equipment List (AF; AE; AN; AT; AJ; AM; AP; BB)"
Me.lstSuchergebnis.AddItem "LEX = Supplier Data Exchange List"
Me.lstSuchergebnis.AddItem "LIF = Interface List"
Me.lstSuchergebnis.AddItem "LIN = Instrumentation List"
Me.lstSuchergebnis.AddItem "LOP = List of open points"
Me.lstSuchergebnis.AddItem "LPE = PED List"
Me.lstSuchergebnis.AddItem "LPI = Piping List"
Me.lstSuchergebnis.AddItem "LSI = Signal List"
Me.lstSuchergebnis.AddItem "LVA = Valve List"
End Sub

Private Sub optMoM_Click()
lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "MGE = MINUTES OF MEETING GENERAL"
Me.lstSuchergebnis.AddItem "MCI = MoM Civil"
Me.lstSuchergebnis.AddItem "MCO = MoM Customer"
Me.lstSuchergebnis.AddItem "MCS = MoM Consultant"
Me.lstSuchergebnis.AddItem "MIN = MoM Internal (CSP; FGT|fffd|)"
Me.lstSuchergebnis.AddItem "MPM = MoM Project Meeting HZI"
Me.lstSuchergebnis.AddItem "MSU = MoM Supplier"
Me.lstSuchergebnis.AddItem "MTP = MoM Third Party"
End Sub
Private Sub optProcessDiagramms_Click()
lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "PGE = (Process) DIAGRAMS GENERAL"
Me.lstSuchergebnis.AddItem "PFD = Process Flow Diagram"
Me.lstSuchergebnis.AddItem "PID = Piping and Instrumentation Diagram"
Me.lstSuchergebnis.AddItem "PIF = Interface Datasheet"
Me.lstSuchergebnis.AddItem "PDS = Functional Design Specification (FDS)"
End Sub

Private Sub optPRocurement_Click()
lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "RGE = PROCUREMENT GENERAL"
Me.lstSuchergebnis.AddItem "RCO = Contract Supplier"
Me.lstSuchergebnis.AddItem "RCR = Change Order Request"
Me.lstSuchergebnis.AddItem "RDC = Delivery Certificate"
Me.lstSuchergebnis.AddItem "RPO = Purchase Order"
Me.lstSuchergebnis.AddItem "RPR = Progress Report Supplier"
Me.lstSuchergebnis.AddItem "RRQ = Request for Quotation"
Me.lstSuchergebnis.AddItem "RTC = Technical and Commercial Comparison"
Me.lstSuchergebnis.AddItem "RTE = Tender"
End Sub

Private Sub optProJectManagement_Click()
lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "JGE = PROJECT MANAGEMENT GENERAL"
    Me.lstSuchergebnis.AddItem "JCO = Concept (Em Pow. Etc)"
    Me.lstSuchergebnis.AddItem "JCC = Contract Consortium"
    Me.lstSuchergebnis.AddItem "JCT = Contract Client"
    Me.lstSuchergebnis.AddItem "JEV = Events (DCR; NCR; DNR; AR)"
    Me.lstSuchergebnis.AddItem "JFO = Form"
    Me.lstSuchergebnis.AddItem "JGC = General Commercial"
    Me.lstSuchergebnis.AddItem "JGI = Guideline / Instruction"
    Me.lstSuchergebnis.AddItem "JPR = Progress Report (int.ext)"
    Me.lstSuchergebnis.AddItem "JQG = Project / Quality Gate Review"
    Me.lstSuchergebnis.AddItem "JRE = Report General"
    Me.lstSuchergebnis.AddItem "JRV = Project Review"
    Me.lstSuchergebnis.AddItem "JTE = Template"
    Me.lstSuchergebnis.AddItem "JTQ = Technical Query Customer Contract"
    Me.lstSuchergebnis.AddItem "JWI = Work Instruction (AA)"
End Sub

Private Sub optQdocuments_Click()
lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "QGE = Q-DOCUMENTS GENERAL"
    Me.lstSuchergebnis.AddItem "QCE = CE Conformity"
    Me.lstSuchergebnis.AddItem "QIC = Inspection Plan Comissioning"
    Me.lstSuchergebnis.AddItem "QIS = Q Inspection Protocol Site (MEC)"
    Me.lstSuchergebnis.AddItem "QIW = Q Inspection Protocol Workshop"
    Me.lstSuchergebnis.AddItem "QPS = I&T Plan Site"
    Me.lstSuchergebnis.AddItem "QPW = I&T Plan Workshop"
    Me.lstSuchergebnis.AddItem "QRE = Q-Records"
End Sub

Private Sub optTechnicalDoc_Click()
lstSuchergebnis.Clear
    Me.lstSuchergebnis.AddItem "TGE = TECHNICAL DOCUMENT GENERAL"
    Me.lstSuchergebnis.AddItem "TD2 = TSD Attachment 2"
    Me.lstSuchergebnis.AddItem "TD3 = TSD Attachment 3"
    Me.lstSuchergebnis.AddItem "TDA = TSD Attachment 1a"
    Me.lstSuchergebnis.AddItem "TDB = TSD Attachment 1b"
    Me.lstSuchergebnis.AddItem "TDE = Design Document"
    Me.lstSuchergebnis.AddItem "TII = Technical Implementation Instruction"
    Me.lstSuchergebnis.AddItem "TIN = Technical Instruction (TV)"
    Me.lstSuchergebnis.AddItem "TSD = Technical Specification Document"
End Sub

Private Sub optTimeSchedules_Click()
lstSuchergebnis.Clear
Me.lstSuchergebnis.AddItem "SGE = TIME SCHEDULES GENERAL"
Me.lstSuchergebnis.AddItem "SCC = CPC Client Progress Curves"
Me.lstSuchergebnis.AddItem "SCT = CPT Client Progress Tables "
Me.lstSuchergebnis.AddItem "SIC = IPC Internal Progress Curves"
Me.lstSuchergebnis.AddItem "SIT = IPT Internal Progress Tables"
Me.lstSuchergebnis.AddItem "SMA = MTS Master Time Schedule"
Me.lstSuchergebnis.AddItem "SMP = Monthly Progress Report"
Me.lstSuchergebnis.AddItem "SSU = Supplier Time Schedule"
Me.lstSuchergebnis.AddItem "SSY = STS System Time Schedule"
Me.lstSuchergebnis.AddItem "STE = TTS Tender Time Schedule"
End Sub

Private Sub txtKathegorie_Change()
If Left(Me.txtKathegorie.Value, 3) = "AGE" Then
    Me.lbl_info.Caption = "General proposal documents that cannot be assigned to one of its below categories."
ElseIf Left(Me.txtKathegorie.Value, 3) = "ACA" Then
    Me.lbl_info.Caption = "Calculations done by HZI to fix the price for a proposal"
ElseIf Left(Me.txtKathegorie.Value, 3) = "AGP" Then
    Me.lbl_info.Caption = "Documents of the HZI business process nr 410"
ElseIf Left(Me.txtKathegorie.Value, 3) = "ALO" Then
    Me.lbl_info.Caption = "Documents that need to be prepared for the internal approval for the submission of an offer."
ElseIf Left(Me.txtKathegorie.Value, 3) = "AOF" Then
    Me.lbl_info.Caption = "Documents that are part of the offer that HZI hands over to its client"
ElseIf Left(Me.txtKathegorie.Value, 3) = "CGE" Then
    Me.lbl_info.Caption = "General site documents that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "CBQ" Then
    Me.lbl_info.Caption = "Documents for quantity definitions like weight, lengths, numbers of parts a.s.o."
ElseIf Left(Me.txtKathegorie.Value, 3) = "CLE" Then
    Me.lbl_info.Caption = "Documents used as booklets, instructions, hand outs, news sheets"
ElseIf Left(Me.txtKathegorie.Value, 3) = "CMR" Then
    Me.lbl_info.Caption = "Documents as a part of workplace safety plan"
ElseIf Left(Me.txtKathegorie.Value, 3) = "CTR" Then
    Me.lbl_info.Caption = "Documents for the training of the personnel on site"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DGE" Then
    Me.lbl_info.Caption = "Sketches, Studies, site Infrastrutcure and remaining drawings, which can't be allocated in the other categories: "
ElseIf Left(Me.txtKathegorie.Value, 3) = "DBS" Then
    Me.lbl_info.Caption = "HVAC, water supply and discharge, sanitary, Earthing and Lighting*, security (access control, CCTV), small power and lighting*"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DCA" Then
    Me.lbl_info.Caption = "Architectural drawings, Finishes drawings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DCD" Then
    Me.lbl_info.Caption = "Underground works, General arrangement, Form work, Reinforcement, Masonry, Finishes, Road and traffic design, external layout/ landscaping"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DCI" Then
    Me.lbl_info.Caption = "Civil indication drawings, Load plans etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "DDT" Then
    Me.lbl_info.Caption = "engineering drawings internal  or external"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DEI" Then
    Me.lbl_info.Caption = "Cabletrays, Instrumentation and consumer drawings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DEO" Then
    Me.lbl_info.Caption = "Equipement Outline Drawing, System design of  Suppliers, engineering drawings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DER" Then
    Me.lbl_info.Caption = "Erection drawings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DLA" Then
    Me.lbl_info.Caption = "Plant layouts, sections and plan views"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DMA" Then
    Me.lbl_info.Caption = "Maintenance concepts and drawings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DPI" Then
    Me.lbl_info.Caption = "Piperouting drawings, isometric drawings etc"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DST" Then
    Me.lbl_info.Caption = "Structural steel and platform drawings, internal  or external"
ElseIf Left(Me.txtKathegorie.Value, 3) = "DSY" Then
    Me.lbl_info.Caption = "Safety drawings. Fire protection (detection and fighting etc.) Escape routing. Ex- Zones, Fire compartmentation drawings etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "JGE" Then
    Me.lbl_info.Caption = "General project management documents that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JCO" Then
    Me.lbl_info.Caption = "Noise Study, Emergency Power, Trafic Concept etc, Safety evaluations, "
ElseIf Left(Me.txtKathegorie.Value, 3) = "JCC" Then
    Me.lbl_info.Caption = "Contract document Consortium"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JCT" Then
    Me.lbl_info.Caption = "Contract document Client"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JEV" Then
    Me.lbl_info.Caption = "Events from PIRS Claim Tool, Design Change Request, Notification Change Request, Defect Notification Request, Accident Report, Supplier Claim"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JFO" Then
    Me.lbl_info.Caption = "Project specific form"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JGC" Then
    Me.lbl_info.Caption = "Commercial documents "
ElseIf Left(Me.txtKathegorie.Value, 3) = "JGI" Then
    Me.lbl_info.Caption = "General guidelines or instructions (TV)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JPR" Then
    Me.lbl_info.Caption = "Monthly Progress Report internal/external, not Supplier"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JQG" Then
    Me.lbl_info.Caption = "Project Review / Quality Gate Review Protocoll"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JRE" Then
    Me.lbl_info.Caption = "Internal and external reports"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JRV" Then
    Me.lbl_info.Caption = "MoM Project Review"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JTE" Then
    Me.lbl_info.Caption = "Project templates Word and Excel"
ElseIf Left(Me.txtKathegorie.Value, 3) = "JWI" Then
    Me.lbl_info.Caption = "Work Instruction of Business Process"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LGE" Then
    Me.lbl_info.Caption = "General lists that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LCA" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LCO" Then
    Me.lbl_info.Caption = "List that is exported out of Comos including several lists (valve, piping etc.)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LDO" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LDR" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LEC" Then
    Me.lbl_info.Caption = "List of Motors or other E-Consumers (Cabinets etc)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LEQ" Then
    Me.lbl_info.Caption = "All the lists that include equipment, such as conveyors, filters, pumps, tanks etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "LEX" Then
    Me.lbl_info.Caption = "List of (technical) data that the supplier has to distribute to HZI"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LIF" Then
    Me.lbl_info.Caption = "List with clear description of interfaces"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LIN" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LOP" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LPE" Then
    Me.lbl_info.Caption = "Pressure Equipment Device List"
ElseIf Left(Me.txtKathegorie.Value, 3) = "LPI" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LSI" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "LVA" Then
    Me.lbl_info.Caption = ""
ElseIf Left(Me.txtKathegorie.Value, 3) = "MGE" Then
    Me.lbl_info.Caption = "General minutes that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MCI" Then
    Me.lbl_info.Caption = "All minutes of meeting with the civil contractor"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MCO" Then
    Me.lbl_info.Caption = "All minutes of meeting with the customer"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MCS" Then
    Me.lbl_info.Caption = "All minutes of meeting with the consultant"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MIN" Then
    Me.lbl_info.Caption = "All minutes of meeting that take place within system groups"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MPM" Then
    Me.lbl_info.Caption = "All minutes of internal project meetings"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MSU" Then
    Me.lbl_info.Caption = "All minutes of meeting with the supplier"
ElseIf Left(Me.txtKathegorie.Value, 3) = "MTP" Then
    Me.lbl_info.Caption = "All minutes of meeting with third parties (non HZI)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "OGE" Then
    Me.lbl_info.Caption = "All operating manual documents"
ElseIf Left(Me.txtKathegorie.Value, 3) = "PGE" Then
    Me.lbl_info.Caption = "General diagrams that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "PDS" Then
    Me.lbl_info.Caption = "Former FuP and FuBe combined. Logic Diagram and verbal description as basis for the programming of the Process Control System"
ElseIf Left(Me.txtKathegorie.Value, 3) = "PFD" Then
    Me.lbl_info.Caption = "Basic diagrams that show different flows such as mass, fluids, energy etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "PID" Then
    Me.lbl_info.Caption = "Detailed diagrams that show all the components existing in the plant, such as piping, instruments, valves, motors, control cabinets, mechanical gear etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "PIF" Then
    Me.lbl_info.Caption = "Datasheet for each main interface => between system groups, customer etc"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QGE" Then
    Me.lbl_info.Caption = "General quality documents that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QPS" Then
    Me.lbl_info.Caption = "The inspection and test plan contains the inspection and test steps that are quality-relevant which have to be carried out prior to, during and following completion of the installation"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QCE" Then
    Me.lbl_info.Caption = "Documents that are part of the CE conformity declaration, either from the supplier or from HZI"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QIS" Then
    Me.lbl_info.Caption = "Report issued on site, including description, pictures and list of deviations, signed by HZI and Contractor"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QIW" Then
    Me.lbl_info.Caption = "Report issued in workshop, including description, pictures and list of deviations, signed by HZI and Contractor"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QPW" Then
    Me.lbl_info.Caption = "The inspection and test plan contains the inspection and test steps that are quality-relevant which have to be carried out prior to, during and following completion of the production"
ElseIf Left(Me.txtKathegorie.Value, 3) = "QRE" Then
    Me.lbl_info.Caption = "Inspection Reports (signed protocols)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RGE" Then
    Me.lbl_info.Caption = "General procurement documents that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RCO" Then
    Me.lbl_info.Caption = "General contract or agreement with a supplier"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RCR" Then
    Me.lbl_info.Caption = "Request from a supplier for a change of contract (extra work) => PIRS Claim tool?"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RDC" Then
    Me.lbl_info.Caption = "Approval form for the release of deliveries"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RPO" Then
    Me.lbl_info.Caption = "Purchase Order (contract with a supplier)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RPR" Then
    Me.lbl_info.Caption = "Monthly feedback from the supplier regarding the manufacturing or installation progress"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RRQ" Then
    Me.lbl_info.Caption = "Request for a quotation"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RTC" Then
    Me.lbl_info.Caption = "Excel sheet to compare tenders from different suppliers for a lot (system)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "RTE" Then
    Me.lbl_info.Caption = "Tender from a supplier"
ElseIf Left(Me.txtKathegorie.Value, 3) = "SGE" Then
    Me.lbl_info.Caption = "General time schedules that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "SCC" Then
    Me.lbl_info.Caption = "6 Progress Curves showing the progress of the project, as part of the progress report submitted on monthly basis (Project overall; Project Management & Engineering; Manufacturing & Transport; Civil Construction; Mech. & Electrical Erection; Commissioning )."
ElseIf Left(Me.txtKathegorie.Value, 3) = "SCT" Then
    Me.lbl_info.Caption = "One tabular report, listing in tables the progress of the different sections of the actual progress  As part of the progress report submitted on monthly basis. (Project overall; Project Management & Engineering; Manufacturing & Transport; Civil Construction; Mech. & Electrical Erection; Commissioning)."
ElseIf Left(Me.txtKathegorie.Value, 3) = "SIC" Then
    Me.lbl_info.Caption = "At least 6 Progress Curves showing the progress of the project with a larger detail then the client curves for the internal supervision of the project. Prepared on monthly basis. (Project overall; Project Management & Engineering; Manufacturing & Transport; Civil Construction; Mech. & Electrical Erection; Commissioning )"
ElseIf Left(Me.txtKathegorie.Value, 3) = "SIT" Then
    Me.lbl_info.Caption = "One or more  tabular reports, listing in tables the progress of the different sections of the actual progress  . As part of the progress report for the internal project control measurements. Prepared on monthly basis. (Project overall; Project Management & Engineering; Manufacturing & Transport; Civil Construction; Mech. & Electrical Erection; Commissioning separated by SU-funktion or disciplines)"
ElseIf Left(Me.txtKathegorie.Value, 3) = "SMP" Then
    Me.lbl_info.Caption = "Report that is created to explain the client the status of the project for the particular month"
ElseIf Left(Me.txtKathegorie.Value, 3) = "SPT" Then
    Me.lbl_info.Caption = "Project time schedule, main project program to steer the project during execution."
ElseIf Left(Me.txtKathegorie.Value, 3) = "SSU" Then
    Me.lbl_info.Caption = "Time schedule that is prepared and maintained by the supplier and send to HZI for the integration into the HZI schedule or the adaptation of progress in the internal programme."
ElseIf Left(Me.txtKathegorie.Value, 3) = "SSY" Then
    Me.lbl_info.Caption = "Is the next lower level of details for the Master Time Schedule (MTS) resp. Project Time Schedule (PTS) so called level 4 programme."
ElseIf Left(Me.txtKathegorie.Value, 3) = "STE" Then
    Me.lbl_info.Caption = "Schedule that is prepared to propose the execution of a project in a bar chart programme on a summarised view."
ElseIf Left(Me.txtKathegorie.Value, 3) = "TGE" Then
    Me.lbl_info.Caption = "General tecnical documents that cannot be assigned to one of its below categories"
ElseIf Left(Me.txtKathegorie.Value, 3) = "TD2" Then
    Me.lbl_info.Caption = "Schedule of documents that the supplier needs to hand over to HZI"
ElseIf Left(Me.txtKathegorie.Value, 3) = "TD3" Then
    Me.lbl_info.Caption = "Additional technical data in list form that are not part of the TSD"
ElseIf Left(Me.txtKathegorie.Value, 3) = "TDA" Then
    Me.lbl_info.Caption = "Document for each TSD / Order which contains a list of all the general technical attachments such as TIIs etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "TDB" Then
    Me.lbl_info.Caption = "Document for each TSD / Order which contains a list of all the specific technical attachments such as drawings, P&IDs etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "TDE" Then
    Me.lbl_info.Caption = "Documents that contain the technical design and / or calculation of a specific lot / system"
ElseIf Left(Me.txtKathegorie.Value, 3) = "TII" Then
    Me.lbl_info.Caption = "Documents with general technical information, wich is relevant and handed out do different suppliers of HZI"
ElseIf Left(Me.txtKathegorie.Value, 3) = "TSD" Then
    Me.lbl_info.Caption = "Documents that specifies the main technical issues of the purchase order for each supplier of HZI"
    
    
ElseIf Left(Me.txtKathegorie.Value, 3) = "JTQ" Then
    Me.lbl_info.Caption = "Question to the customer regarding ambiguities in the contract"
ElseIf Left(Me.txtKathegorie.Value, 3) = "OTR" Then
    Me.lbl_info.Caption = "Documents used in training, schedules, reports etc."
ElseIf Left(Me.txtKathegorie.Value, 3) = "QIC" Then
    Me.lbl_info.Caption = "The inspection plan contains the inspection and test steps that are quality-relevant which have to be carried out during comissioning phase."
ElseIf Left(Me.txtKathegorie.Value, 3) = "TIN" Then
    Me.lbl_info.Caption = "Company know-how used as a design instruction, guideline or checklist for a specific system/subject. The TI explains how the system is executed. The document will be used internally and externally. The execution of the system according to the TI is mandatory. The TI therefore will not be adjusted to the project"
    
    
End If

End Sub

Private Sub UserForm_Initialize()
'auflistung der HZI-Dokumenten Kathegorien, Word
    If ThisDocument.CustomDocumentProperties("Supplier") = "HZI" Then
    Me.lstSuchergebnis.AddItem "AGE = ANGEBOTE GENERAL"
    Me.lstSuchergebnis.AddItem "ACA = Calculation"
    Me.lstSuchergebnis.AddItem "AGP = GP410 document"
    Me.lstSuchergebnis.AddItem "ALO = LOA document"
    Me.lstSuchergebnis.AddItem "AOF = Offer of HZI"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "CGE = CONSTRUCTION SITE GENERAL"
    Me.lstSuchergebnis.AddItem "CBQ = Bill of Quantity"
    Me.lstSuchergebnis.AddItem "CLE = Leaflet"
    Me.lstSuchergebnis.AddItem "CMR = Method statement / Risk Assessment"
    Me.lstSuchergebnis.AddItem "CTR = Training"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "JGE = PROJECT MANAGEMENT GENERAL"
    Me.lstSuchergebnis.AddItem "JCO = Concept (Em Pow. Etc)"
    Me.lstSuchergebnis.AddItem "JCC = Contract Consortium"
    Me.lstSuchergebnis.AddItem "JCT = Contract Client"
    Me.lstSuchergebnis.AddItem "JEV = Events (DCR; NCR; DNR; AR)"
    Me.lstSuchergebnis.AddItem "JFO = Form"
    Me.lstSuchergebnis.AddItem "JGC = General Commercial"
    Me.lstSuchergebnis.AddItem "JGI = Guideline / Instruction"
    Me.lstSuchergebnis.AddItem "JPR = Progress Report (int.ext)"
    Me.lstSuchergebnis.AddItem "JQG = Project / Quality Gate Review"
    Me.lstSuchergebnis.AddItem "JRE = Report General"
    Me.lstSuchergebnis.AddItem "JRV = Project Review"
    Me.lstSuchergebnis.AddItem "JTE = Template"
    Me.lstSuchergebnis.AddItem "JTQ = Technical Query Customer Contract"
    Me.lstSuchergebnis.AddItem "JWI = Work Instruction (AA)"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "MGE = MINUTES OF MEETING GENERAL"
    Me.lstSuchergebnis.AddItem "MCI = MoM Civil"
    Me.lstSuchergebnis.AddItem "MCO = MoM Customer"
    Me.lstSuchergebnis.AddItem "MCS = MoM Consultant"
    Me.lstSuchergebnis.AddItem "MIN = MoM Internal (CSP; FGT|fffd|)"
    Me.lstSuchergebnis.AddItem "MPM = MoM Project Meeting HZI"
    Me.lstSuchergebnis.AddItem "MSU = MoM Supplier"
    Me.lstSuchergebnis.AddItem "MTP = MoM Third Party"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "OGE = OPERATING MANUAL GENERAL"
    Me.lstSuchergebnis.AddItem "OTR = Training Document"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "PGE = (Process) DIAGRAMS GENERAL"
    Me.lstSuchergebnis.AddItem "PDS = Functional Design Specification (FDS)"
    Me.lstSuchergebnis.AddItem "PIF = Interface Datasheet"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "QGE = Q-DOCUMENTS GENERAL"
    Me.lstSuchergebnis.AddItem "QCE = CE Conformity"
    Me.lstSuchergebnis.AddItem "QIC = Inspection Plan Comissioning"
    Me.lstSuchergebnis.AddItem "QIS = Q Inspection Protocol Site (MEC)"
    Me.lstSuchergebnis.AddItem "QIW = Q Inspection Protocol Workshop"
    Me.lstSuchergebnis.AddItem "QPS = I&T Plan Site"
    Me.lstSuchergebnis.AddItem "QPW = I&T Plan Workshop"
    Me.lstSuchergebnis.AddItem "QRE = Q-Records"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "RGE = PROCUREMENT GENERAL"
    Me.lstSuchergebnis.AddItem "RCO = Contract Supplier"
    Me.lstSuchergebnis.AddItem "RCR = Change Order Request"
    Me.lstSuchergebnis.AddItem "RDC = Delivery Certificate"
    Me.lstSuchergebnis.AddItem "RPO = Purchase Order"
    Me.lstSuchergebnis.AddItem "RPR = Progress Report Supplier"
    Me.lstSuchergebnis.AddItem "RRQ = Request for Quotation"
    Me.lstSuchergebnis.AddItem "RTC = Technical and Commercial Comparison"
    Me.lstSuchergebnis.AddItem "RTE = Tender"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "SSU = Supplier Time Schedule"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "TGE = TECHNICAL DOCUMENT GENERAL"
    Me.lstSuchergebnis.AddItem "TD2 = TSD Attachment 2"
    Me.lstSuchergebnis.AddItem "TD3 = TSD Attachment 3"
    Me.lstSuchergebnis.AddItem "TDA = TSD Attachment 1a"
    Me.lstSuchergebnis.AddItem "TDB = TSD Attachment 1b"
    Me.lstSuchergebnis.AddItem "TDE = Design Document"
    Me.lstSuchergebnis.AddItem "TII = Technical Implementation Instruction"
    Me.lstSuchergebnis.AddItem "TIN = Technical Instruction (TV)"
    Me.lstSuchergebnis.AddItem "TSD = Technical Specification Document"

Else

    Me.lstSuchergebnis.AddItem "CGE = CONSTRUCTION SITE GENERAL"
    Me.lstSuchergebnis.AddItem "CBQ = Bill of Quantity"
    Me.lstSuchergebnis.AddItem "CLE = Leaflet"
    Me.lstSuchergebnis.AddItem "CMR = Method statement / Risk Assessment"
    Me.lstSuchergebnis.AddItem "CTR = Training"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "MCI = MoM Civil"
    Me.lstSuchergebnis.AddItem "MSU = MoM Supplier"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "PGE = (Process) DIAGRAMS GENERAL"
    Me.lstSuchergebnis.AddItem "PDS = Functional Design Specification (FDS)"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "QGE = Q-DOCUMENTS GENERAL"
    Me.lstSuchergebnis.AddItem "QCE = CE Conformity"
    Me.lstSuchergebnis.AddItem "QIS = Q Inspection Protocol Site (MEC)"
    Me.lstSuchergebnis.AddItem "QIW = Q Inspection Protocol Workshop"
    Me.lstSuchergebnis.AddItem "QPS = I&T Plan Site"
    Me.lstSuchergebnis.AddItem "QPW = I&T Plan Workshop"
    Me.lstSuchergebnis.AddItem "QRE = Q-Records"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "RGE = PROCUREMENT GENERAL"
    Me.lstSuchergebnis.AddItem "RCO = Contract Supplier"
    Me.lstSuchergebnis.AddItem "RCR = Change Order Request"
    Me.lstSuchergebnis.AddItem "RDC = Delivery Certificate"
    Me.lstSuchergebnis.AddItem "RPR = Progress Report Supplier"
    Me.lstSuchergebnis.AddItem "RTE = Tender"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "SSU = Supplier Time Schedule"
    Me.lstSuchergebnis.AddItem ""
    Me.lstSuchergebnis.AddItem "TDE = Design Document"
End If

If ThisDocument.CustomDocumentProperties("Supplier").Value <> "HZI" Then
    MsgBox "Choos a proper document type from the following mask"
End If
End Sub
Attribute VB_Name = "frmFormate"
Attribute VB_Base = "0{D257ED1A-AD78-449E-ADEE-C44630F0BB08}{589DD56C-F283-446F-AB87-551B5C52B944}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    Dim chk As CheckBox
    Dim makro As Variant
    Dim makroname As String
    
    Application.DisplayAlerts = False
    For Each CheckBox In Controls
    makro = CheckBox.Name
        If Left(makro, 3) = "chk" Then
            If CheckBox.Value = True Then
                makroname = Right(makro, Len(makro) - 3)
                Application.Run makroname
                'falls die ansicht korrigiert wird, werden auch noch die Makronamen angepasst
'                If markoname = "Ansicht" Then
'                    Call nameStyle
'                End If
            End If
        End If
    Next
    
    Application.DisplayAlerts = True
Unload Me
    
End Sub

Private Sub CommandButton2_Click()
    Unload Me
End Sub

Private Sub CommandButton3_Click()
    Dim chk As CheckBox
    Dim makro As Variant
    Dim makroname As String
    
    'bei allen "Controls" welche mit chk beginnen werden aktiviert oder deaktiviert
    Application.DisplayAlerts = False
    For Each CheckBox In Controls
    On Error Resume Next
    If Left(CheckBox.Name, 3) = "chk" Then
            If CheckBox.Value = True Then
                CheckBox.Value = False
            Else
                CheckBox.Value = True
            End If
    End If
    Next
    
    Application.DisplayAlerts = True
End Sub

Attribute VB_Name = "frmKommentarTextL|fffd|schen"
Attribute VB_Base = "0{BDDD2C9F-466A-48A5-BA8D-6E68F059143B}{8F217DC3-1CF6-4D75-8DB8-E7828E2B22A1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
        On Error Resume Next
        
          Dim oDoc As Document
  Set oDoc = ActiveDocument
  If oDoc.Bookmarks.Exists("kommentar_text_anfang") And oDoc.Bookmarks.Exists("kommentar_text_ende") Then
    oDoc.Range(Start:=oDoc.Bookmarks("kommentar_text_anfang").Range.Start, _
               End:=oDoc.Bookmarks("kommentar_text_ende").Range.Start).Select
  End If
  Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
       ' Selection.GoTo What:=wdGoToBookmark, Name:="Kommentar_text"
        Selection.TypeBackspace
        Unload Me
End Sub

Private Sub CommandButton2_Click()
    Unload Me
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "frmRoterTextL|fffd|schen"
Attribute VB_Base = "0{5AB177CE-99B8-4804-8603-ACAFD5B445A3}{77A7E36E-6495-4E48-9BA9-53C12BCC8AA0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
  Call rote_eintr|fffd|geL|fffd|schen
  Unload Me
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    End
    
End Sub
Attribute VB_Name = "frm_AIC"
Attribute VB_Base = "0{C6679572-F745-4A27-B20C-29A2CE1FDDBC}{FF925E39-6295-4658-9C88-4D8A48B4A177}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
    ThisDocument.CustomDocumentProperties("AIC").Value = Me.TextBox1.Value
    Unload Me
    
End Sub

Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
 If KeyAscii > 96 And KeyAscii < 123 Then
       MsgBox "use CAPITAL letters"
   Else
   End If
 Select Case KeyAscii
       Case 8, 43 To 46, 48 To 57, 65 To 90, 142, 153 To 154
       Case Else
           KeyAscii = 0
   End Select
End Sub
Attribute VB_Name = "frm_Rev0"
Attribute VB_Base = "0{D95751FC-92C6-42C6-84A4-35E17F480C33}{9B3F9655-BA60-404C-9219-58EDD02C7148}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Public strDokNummer As Variant, erster_leerschlag As Variant
Public schwarz As Variant, projektnummer As Variant, projektname As Variant
Public titel As Variant, revision As Variant, Author As Variant
Public Reviewer As Variant, Approver As Variant
Public Rev_Date As Variant, AIC As Variant, dat As Variant, Description1 As Variant, Description2 As Variant

Private Sub CommandButton1_Click()
'Variablen Deklaration
Dim objGr|fffd|neTextBoxen As Control, strDokNummer As String, strDokNummervorlage As String, strRevVorlage As String
Dim strRev2 As String, strTextMarkEP As String, strTextMark As String, strTextMarkeO As String, strTextMarkeC As String
Dim strTextMarkeD  As String, strTextMarkeDesc2 As String, strTextMarkeDesc1 As String
Dim doctype As String, endung As String, lieferant As String

Application.ScreenUpdating = False

'es wird gepr|fffd|ft ob die gr|fffd|nen Mussfelder ausgef|fffd|llt sind
For Each objGr|fffd|neTextBoxen In Controls       'jedes Kontrollfeld wird gepr|fffd|ft (nicht nur Text Boxen)
    If TypeName(objGr|fffd|neTextBoxen) = "TextBox" Then     'es wird gepr|fffd|ft ob es sich bei der Control um eine TextBox handelt
        If objGr|fffd|neTextBoxen.BackColor = &HC0FFC0 Then          'falls das Feld gr|fffd|n ist...
            If objGr|fffd|neTextBoxen.Value = "" Then                '... und das Feld leer ist...
                MsgBox "all green fields must be filled out"    '... wird die MsgBox angezeigt
                frm_Rev0.Show
                Exit Sub
            End If
        End If
    End If
Next


        
'der Author und der Reviewer d|fffd|rfen nicht die selbe Person sein
If TextBox7.Value = TextBox8.Value Then
     MsgBox "Author and Reviewer can not be the same person => Four Eye Principle"
        TextBox8.Value = ""
        frm_Rev0.Show
    Exit Sub
End If



'die Farbe der Eintr|fffd|ge wird auf scharz gestellt, falls es sich nicht um ein Dokument f|fffd|r das Vorlagen-Projekt handelt
schwarz = ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value
    
'falls der |fffd|berarbeitungsmodus aktiviert ist wird er hier deaktiviert
If ThisDocument.TrackRevisions = True Then
   ThisDocument.TrackRevisions = Not ThisDocument.TrackRevisions
End If

Call dokument_entsperren    'das Dokument wird entsperrt, damit keine falschen Formatierungen eingetragen werden

'die Dokumentennummer und die Revision werden erfasst, um zu Bestimmen was die Vorlage f|fffd|r das neu erstellte Dokument war
ThisDocument.Bookmarks("dnummer").Select
Selection.MoveRight Unit:=wdWord, Count:=1, Extend:=wdExtend
strDokNummervorlage = Selection.Text
ThisDocument.Bookmarks("rev").Select
'Selection.MoveRight Unit:=wdWord, Count:=1
'Selection.MoveRight Unit:=wdWord, Count:=1, Extend:=wdExtend
Selection.MoveRight Unit:=wdCharacter, Count:=1
Selection.EndKey Unit:=wdLine, Extend:=wdExtend
Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
strRevVorlage = Selection.Text

lieferant = TextBox1.Text
projektnummer = TextBox2.Text
projektname = TextBox3.Text
titel = TextBox4.Text
strDokNummer = TextBox5.Text
AIC = TextBox6.Text
Author = TextBox7.Text
Reviewer = TextBox8.Text
Approver = TextBox9.Text
Rev_Date = TextBox11.Text

If lieferant <> "HZI" And ThisDocument.CustomDocumentProperties("Supplier") = "HZI" Then
Else
    ThisDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "nein"
End If
'falls es eine Vorlage f|fffd|r ein Projekt ist, so wird im Userform gefragt
'wie das Dokument gespeichert (mit Doktyp und Lieferant)werden soll
'und ob interne / externe Revisionen m|fffd|glich sein sollen
If projektnummer <> "P-9999" And ThisDocument.CustomDocumentProperties("Quelle").Value = "Vorlage" Then
    frm_makro_einstellungen.Show
End If



'falls erforderlich wird die maske mit den Dokumententypen gezeigt
'If ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "ja" Then
    frmDocType.Show
'    ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "nein"
'    ThisDocument.CustomDocumentProperties("Status").Value = "Projekt"
'End If

If ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "janein" Then
    ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "ja"
End If


If AIC = "" Then
    AIC = "000000"
End If

If ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" Then
    revision = "0.0"
ElseIf projektnummer = "P9999" Or projektnummer = "P-9999" Then
    revision = "V00"
Else
    revision = "00"
    ThisDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "nein"
End If

Call textmarken_zuweisen2

dat = 1
       
  ' mit der schleife werden die 3 Rev_Dates eingef|fffd|gt
  Selection = Rev_Date
   Do While dat < 3
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection = Rev_Date
    dat = dat + 1
   Loop

    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection = Approver
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    If Approver = "" Then GoTo 12
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
12
    Selection = Reviewer
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    If Reviewer = "" Then GoTo 13
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
13
    Selection = Author

   ThisDocument.Bookmarks("doktitel").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
     If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
    End If
   Selection.Text = titel

   ThisDocument.Bookmarks("AIC").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
      If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
    End If
   Selection.Text = AIC

    ThisDocument.Bookmarks("doctype").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    If ThisDocument.CustomDocumentProperties("Status").Value <> "Projektvorlage" Then
        Selection.FONT.Color = wdColorBlack
    End If
   ThisDocument.Bookmarks("dnummer").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = strDokNummer
   If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
   End If
   
   ThisDocument.Bookmarks("rev").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = "-" & revision
   If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
   End If
   
   ThisDocument.Bookmarks("dnummerrev").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = strDokNummervorlage & "-" & strRevVorlage
   If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
   End If
   
    ThisDocument.Bookmarks("supplier").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = lieferant

   
    ThisDocument.Bookmarks("pname").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    If ThisDocument.CustomDocumentProperties("Projektnummer").Value = "P-9999" Then
        Selection.Text = projektname
    End If
   If schwarz = "ja" Or ThisDocument.CustomDocumentProperties("Status").Value = "Projektvorlage" Then
        Selection.FONT.Color = wdColorBlack
   End If
   
   ThisDocument.Bookmarks("pnummer").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    If ThisDocument.CustomDocumentProperties("Projektnummer").Value = "P-9999" Then
        Selection.Text = projektnummer
    End If

   If schwarz = "ja" Or ThisDocument.CustomDocumentProperties("Status").Value = "Projektvorlage" Then
       Selection.FONT.Color = wdColorBlack
   End If
   
'die revisionstabelle wird schwarz eingef|fffd|rbt falls nicht Vorlagen-Projekt
    ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=6, Extend:=wdExtend
  Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend
   If schwarz = "ja" Then
        Selection.FONT.Color = wdBlack
   End If
   
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Die Kopfzeile wird angepasst
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
   Dim i As Long
   For i = 2 To ThisDocument.Sections.Count
        
   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 5).Range.Text = "-" & revision
   myHeader.Tables(1).Cell(3, 5).Select
   If schwarz = "ja" Or ThisDocument.CustomDocumentProperties("Status").Value <> "Projektvorlage" Then
        Selection.FONT.Color = wdColorBlack
   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(1, 3).Range.Text = projektname
    myHeader.Tables(1).Cell(1, 3).Select
   If schwarz = "ja" Or ThisDocument.CustomDocumentProperties("Status").Value = "Projektvorlage" Then
       Selection.FONT.Color = wdColorBlack
   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(2, 3).Range.Text = titel
   myHeader.Tables(1).Cell(2, 3).Select
   If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
   End If
   
   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 4).Range.Text = strDokNummer
   myHeader.Tables(1).Cell(3, 4).Select
   If schwarz = "ja" Then
       Selection.FONT.Color = wdColorBlack
   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 2).Range.Text = AIC
   myHeader.Tables(1).Cell(3, 2).Select
   If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
   End If
   Next i
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' die ansicht des Dokumentes wird auf standard gestellt
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
   Application.TaskPanes(wdTaskPaneFormatting).Visible = True
   CommandBars("Standard").Visible = True
   If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
       ActiveWindow.Panes(2).Close
   End If
   If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
       ActivePane.View.Type = wdOutlineView Then
       ActiveWindow.ActivePane.View.Type = wdPrintView
   End If
   ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
   ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'die Benutzerspezifischen Eigenschaften werden ausgef|fffd|llt

     With ThisDocument
           .CustomDocumentProperties("Author").Value = Author
           .CustomDocumentProperties("Reviewer").Value = Reviewer
           .CustomDocumentProperties("Approver").Value = Approver
            .CustomDocumentProperties("Rev Date").Value = Rev_Date
            .CustomDocumentProperties("AIC").Value = AIC
           .CustomDocumentProperties("Title").Value = titel
           .CustomDocumentProperties("Doc Number").Value = strDokNummer
           .CustomDocumentProperties("Revision").Value = revision
           .CustomDocumentProperties("Projektnummer").Value = projektnummer
           .CustomDocumentProperties("Projektname").Value = projektname
           .CustomDocumentProperties("Supplier").Value = lieferant
   End With
   
If ThisDocument.CustomDocumentProperties("Status").Value = "Projektvorlage" Then
    ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value = "ja"
End If
   
' Bestimmt den Pfad wo gespeichert werden soll (Desktop)
   Application.DisplayAlerts = False
   strPfad = Environ("UserProfile") & "\Desktop\"
'  ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'        UseIRM:=False, EnforceStyleLock:=True
' Speichert das Dokument
   ChangeFileOpenDirectory _
       strPfad
   
'einf|fffd|gen der Benutzerdefinierten Eigenschaften
   ThisDocument.CustomDocumentProperties("Title").Value = titel       'der Dokumententitel wird eingegeben
   ThisDocument.CustomDocumentProperties("Quelle").Value = ThisDocument.CustomDocumentProperties("Status").Value   'die Quelle ist nichtmehr Vorlage sondern Vorlagen-Projekt oder Projekt, wird verwendet

    endung = ".docm"
    If InStr(" ", ThisDocument.CustomDocumentProperties("Document Type").Value) > 0 Then
        erster_leerschlag = InStr(ThisDocument.CustomDocumentProperties("Document Type").Value, " ")
        doctype = Left(ThisDocument.CustomDocumentProperties("Document Type").Value, erster_leerschlag - 1)
    Else
        doctype = ThisDocument.CustomDocumentProperties("Document Type").Value
    End If
   ' lieferant = ThisDocument.CustomDocumentProperties("Supplier").Value
   
   If ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "ja" Then
        ThisDocument.SaveAs Filename:= _
        strPfad & doctype & "-" & lieferant & "-" & strDokNummer & "_" & revision & "_" & titel & endung
   Else
        ThisDocument.SaveAs Filename:= _
        strPfad & strDokNummer & "_" & revision & "_" & titel & endung
   End If

   Application.DisplayAlerts = True
   ThisDocument.CustomDocumentProperties("Title").Value = titel
   
   
   
   MsgBox "File saved on Desktop"
   Unload Me
      Application.ScreenUpdating = True
End Sub
Private Sub CommandButton2_Click()
     Unload Me
End Sub
Sub leerschlag_pr|fffd|fen()
    On Error Resume Next
    
End Sub
Public Sub textmarken_zuweisen2()

' wenn das dokument aus dem PIRS kommt, dann muss das 00 abenfalls geschrieben werden, weil das zuvor fon PIRS gel|fffd|scht wurde
     ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=1
  Selection.MoveUp Unit:=wdLine, Count:=5, Extend:=wdExtend
  Selection.Delete

    schwarz = ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value
    
  If schwarz = "ja" Then
    Selection.FONT.Color = wdColorBlack
  End If
  
  Selection.MoveDown Unit:=wdLine, Count:=5
  If ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" Then
    For i = 0 To 5
        Selection = i & ".0"
        Selection.MoveUp Unit:=wdLine, Count:=1
    Next
    Else
    For i = 0 To 5
        Selection = "0" & i
        Selection.MoveUp Unit:=wdLine, Count:=1
    Next
    End If
  
  'Selection.MoveDown Unit:=wdLine, Count:=6
   ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=1
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=1
  Selection.MoveDown Unit:=wdLine, Count:=1
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend
  Selection.MoveUp Unit:=wdLine, Count:=11, Extend:=wdExtend
  Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
  If schwarz = "ja" Then
    Selection.FONT.Color = wdColorBlack
  End If
  Selection.Delete
  
  ThisDocument.Bookmarks("first_issue").Select
'  Selection.MoveUp Unit:=wdLine, Count:=1
'  Selection.MoveRight Unit:=wdCharacter, Count:=7
 Selection = "First Issue"

  
  ThisDocument.Bookmarks("rev_start").Select
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=1
  Selection.MoveUp Unit:=wdLine, Count:=1
   
End Sub
Private Sub TextBox11_Enter()
   TextBox11.SelStart = 0
End Sub
Private Sub TextBox11_Exit(ByVal Cancel As MSForms.ReturnBoolean)
l|fffd|ngeRev_Date = Len(Me.TextBox11)
If l|fffd|ngeRev_Date <> 10 Or IsDate(TextBox11) = False Then

MsgBox "Date needs to be added in _dd.mm.yyyy_ format"
Exit Sub
Else
End If

End Sub
Private Sub TextBox3_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
   Select Case KeyAscii
       Case 8, 32, 43 To 46, 48 To 57, 65 To 90, 95, 97 To 122, 129 To 167, 181 To 183, 187 To 203, 208 To 218, 224 To 237
       Case Else
           KeyAscii = 0
          ' Me.Text0.SetFocus
   End Select
End Sub
Private Sub TextBox4_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  Select Case KeyAscii
       Case 8, 32, 43 To 46, 48 To 57, 65 To 90, 95, 97 To 122, 129 To 167, 181 To 183, 187 To 203, 208 To 218, 224 To 237, 252, 220, 246, 214
       Case Else
           KeyAscii = 0
          ' Me.Text0.SetFocus
   End Select
End Sub

Private Sub TextBox5_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  If ThisDocument.CustomDocumentProperties("Supplier") = "HZI" Then Exit Sub
  Select Case KeyAscii
       Case 48 To 57
       Case Else
           KeyAscii = 0
          MsgBox "Only numbers are allowed"
   End Select
End Sub

Private Sub TextBox6_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
 If KeyAscii > 96 And KeyAscii < 123 Then
       MsgBox "use CAPITAL letters"
   Else
   End If
 Select Case KeyAscii
       Case 8, 43 To 46, 48 To 57, 65 To 90, 142, 153 To 154
       Case Else
           KeyAscii = 0
   End Select
End Sub
Sub dokument_entsperren()
On Error GoTo 1
ThisDocument.Unprotect
1
End Sub
Private Sub UserForm_Initialize()
    Dim pnummer As String, pname As String, dnummer As String
    
    On Error GoTo Testmakro_Err
Testmakro_Err:
    If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
        If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
            y_fehlermeldung_40351.Show
            Err.Clear
            End     'makro wird beendet
        Else
            MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
        End If
    End If
    
    TextBox1.Value = ThisDocument.CustomDocumentProperties("Supplier").Value
    TextBox2.Value = ThisDocument.CustomDocumentProperties("Projektnummer").Value   'Projekt Nummer wird in Textbox eingetragen
    TextBox3.Value = ThisDocument.CustomDocumentProperties("Projektname").Value     'Projekt Nummer wird in Textbox eingetragen
    If ThisDocument.CustomDocumentProperties("Supplier").Value <> "HZI" Then
        TextBox7.Value = Application.UserName
        TextBox7.MaxLength = "80"
        TextBox8.MaxLength = "80"
        TextBox9.MaxLength = "80"
        TextBox5.MaxLength = "8"
        TextBox1.Enabled = False
        TextBox2.Enabled = False
        TextBox3.Enabled = False
        Me.lbl_approver_beschr.Caption = "Full Name"
        Me.lbl_author_beschr.Caption = "Full Name"
        Me.lbl_reviewer_beschr.Caption = "Full Name"
        Me.lbl_nr_beschreibung.Caption = "Number consisting of 8 digits"
    Else
        TextBox7.Value = Environ("Username")            'K|fffd|rzel wird in Textbox eingetragen
    End If
    TextBox11.Value = Format(Date, "dd.MM.yyyy")    'Datum wird in Textbox eingetragen
    
End Sub

Private Sub UserForm_Terminate()
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "frm_Rev1_plus"
Attribute VB_Base = "0{A616F9AE-E4CA-46F9-91A2-8AE1101F7650}{76BB2992-2977-4A49-B282-935ADBBCCDC1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Public revisionx As Variant, erster_leerschlag As Variant
Public revision2 As Variant, strDokNummer As Variant
Public Author As Variant, titel As Variant
Public Reviewer As Variant
Public Approver As Variant
Public revision As Variant
Public Rev_Date As Variant
Public dat As Variant
Public Description1 As Variant
Public AIC As Variant
Public Description2 As Variant
Public Dokumentennummer As Variant

Public Sub CommandButton1_Click()
    Application.ScreenUpdating = False
    
    If ThisDocument.ProtectionType <> wdNoProtection Then
        gesch|fffd|tzt = "ja"
    Else
        gesch|fffd|tzt = "nein"
    End If

    
    Call schutz_aufheben3
    
    Dim objGr|fffd|neTextBoxen As Control
    frm_Rev1_plus.Hide
    Call fehler
    

    If ThisDocument.TrackRevisions = True Then
       ThisDocument.TrackRevisions = Not ThisDocument.TrackRevisions
    End If
 
    'es wird gepr|fffd|ft ob die gr|fffd|nen Mussfelder ausgef|fffd|llt sind
For Each objGr|fffd|neTextBoxen In Controls       'jedes Kontrollfeld wird gepr|fffd|ft (nicht nur Text Boxen)
    If TypeName(objGr|fffd|neTextBoxen) = "TextBox" Then     'es wird gepr|fffd|ft ob es sich bei der Control um eine TextBox handelt
        If objGr|fffd|neTextBoxen.BackColor = &HC0FFC0 Then          'falls das Feld gr|fffd|n ist...
            If objGr|fffd|neTextBoxen.Value = "" Then                '... und das Feld leer ist...
                MsgBox "all green fields must be filled out"    '... wird die MsgBox angezeigt
                frm_Rev1_plus.Show
                Exit Sub
            End If
        End If
    End If
Next


    revision = Right(TextBox5.Text, 2)
    revision2 = TextBox5.Text
    Author = TextBox7.Text
    Reviewer = TextBox8.Text
    Approver = TextBox9.Text
    Rev_Date = TextBox11.Text
    Description2 = TextBox12.Text
    Description1 = TextBox13.Text
    strDokNummer = Me.txt_doc_number.Value 'ThisDocument.CustomDocumentProperties("Doc Number").Value
    titel = Me.txt_doc_name 'ThisDocument.CustomDocumentProperties("Title").Value
    
    If titel <> ThisDocument.CustomDocumentProperties("Title").Value Then
        ThisDocument.Bookmarks("doktitel").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = titel
    End If
    
    If strDokNummer <> ThisDocument.CustomDocumentProperties("Doc Number").Value Then
        ThisDocument.Bookmarks("dnummer").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = strDokNummer
    End If
    
    dat = 1
        
    l|fffd|ngeRevision = Len(revision)
    
    If l|fffd|ngeRevision < 2 Then
    revision = "0" & revision
    Else
    End If
    
    If revision < 6 Then
        Call revision1
    Else
        Call revision6
    End If
    
    If Left(revision2, 1) = "V" Then
        revisionx = revision2
    Else
        revisionx = revision
    End If
    
    
    ThisDocument.Bookmarks("rev").Select
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    ThisDocument.Bookmarks("rev").Range = "-" & revisionx
    
'    ThisDocument.Bookmarks("rev").Select
'    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
'    Selection.Delete
'    ThisDocument.Bookmarks("rev").Range = "-" & revisionx
    
    Call revision_kopfzeile
    Call eigenschaften_ausf|fffd|llen
    
   Application.TaskPanes(wdTaskPaneFormatting).Visible = True
    
    
    CommandBars("Standard").Visible = True
  '
  
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
        ActivePane.View.Type = wdOutlineView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    
   ' Call eigenschaften_ausf|fffd|llen
    
' Bestimmt den Pfad wo gespeichert werden soll (Desktop)
    Application.DisplayAlerts = False
    strPfad = Environ("UserProfile") & "\Desktop\"
    
 ' Speichert das Dokument
 
'    ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True
'
    endung = ".docm"
    If InStr(" ", ThisDocument.CustomDocumentProperties("Document Type").Value) > 0 Then
        erster_leerschlag = InStr(ThisDocument.CustomDocumentProperties("Document Type").Value, " ")
        doctype = Left(ThisDocument.CustomDocumentProperties("Document Type").Value, erster_leerschlag - 1)
    Else
        doctype = ThisDocument.CustomDocumentProperties("Document Type").Value
    End If
    lieferant = ThisDocument.CustomDocumentProperties("Supplier").Value
   
   'es wird sicher gestellt das die revision zweistellig ist
    l|fffd|ngeRevision = Len(revision2)
    If l|fffd|ngeRevision < 2 Then
        revision2 = "0" & revision2
    End If
   
   If ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "ja" Then
        ThisDocument.SaveAs Filename:= _
        strPfad & doctype & "-" & lieferant & "-" & strDokNummer & "_" & revision2 & "_" & titel & endung
   Else
        ThisDocument.SaveAs Filename:= _
        strPfad & strDokNummer & "_" & revision2 & "_" & titel & endung
   End If

    Application.DisplayAlerts = True
    
    MsgBox "File saved on Desktop"
    Unload Me
    
   Exit Sub
   
'   If gesch|fffd|tzt = "ja" Then
'        ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True
'    End If
   
   Application.ScreenUpdating = True
     
End Sub

Sub revision1()
    
   ' anzahl_hoch = Right(revision, 1)
    anzahl_hoch = Val(Right(Me.TextBox5, 2))
    
    ThisDocument.Bookmarks("rev_start").Select

    Selection.MoveRight Unit:=wdWord, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=(2 * anzahl_hoch) + 1

    dat = 1
       
  ' mit der schleife werden die 4 Rev_Dates eingef|fffd|gt
  Selection = Rev_Date
   Do While dat < 3
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Rev_Date
   dat = dat + 1
   Loop
    
    Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Description1
   Selection.MoveUp Unit:=wdLine, Count:=1
   Selection = Description2
   Selection.MoveLeft Unit:=wdCharacter, Count:=1
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        

    Selection = Approver
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Approver = "" Then GoTo 12
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
12
    Selection = Reviewer
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Reviewer = "" Then GoTo 13
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
13
    Selection = Author

    
End Sub
Sub revision6()

'        If ThisDocument.CustomDocumentProperties("RevType").Value = "internal" And Me.revInternal <> 1 Then GoTo 55
'    If Me.revInternal = 0 And interne_rev_eigensch <> 0 Then GoTo 55
    
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev02_ende").Range.Start).Copy
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev04").Range.Start, _
               End:=ThisDocument.Bookmarks("rev01_ende").Range.Start).Select
               
    Selection.PasteAndFormat (wdPasteDefault)
55
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev05_ende").Range.Start).Delete
    ThisDocument.Bookmarks("rev05").Range = revision
    ThisDocument.Bookmarks("d051").Range = Rev_Date
    ThisDocument.Bookmarks("d052").Range = Rev_Date
    ThisDocument.Bookmarks("d053").Range = Rev_Date
    ThisDocument.Bookmarks("descr105").Range = Description1
    ThisDocument.Bookmarks("descr205").Range = Description2
    
    ThisDocument.Bookmarks("p05").Range = Author
    ThisDocument.Bookmarks("r05").Range = Reviewer
    ThisDocument.Bookmarks("o05").Range = Approver
End Sub
Private Sub revision_kopfzeile()

    Dim i As Long
    For i = 2 To ThisDocument.Sections.Count
    
Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(3, 5).Range.Text = "- " & revisionx
    myHeader.Tables(1).Cell(2, 3).Range.Text = titel
    myHeader.Tables(1).Cell(3, 4).Range.Text = strDokNummer
Next i
    
    Set myHeader = ThisDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(1, 1).Select
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.Style = ThisDocument.Styles("w4 titelbl Revision klein")

End Sub
Private Sub eigenschaften_ausf|fffd|llen()

   With ThisDocument
            .CustomDocumentProperties("Author").Value = Author
            .CustomDocumentProperties("Reviewer").Value = Reviewer
            .CustomDocumentProperties("Approver").Value = Approver
             .CustomDocumentProperties("Rev Date").Value = Rev_Date
            .CustomDocumentProperties("Revision").Value = revisionx
            .CustomDocumentProperties("Title").Value = titel
            .CustomDocumentProperties("Doc Number").Value = strDokNummer
    End With

End Sub
Private Sub CommandButton2_Click()
    
    frm_Rev1_plus.Hide
    
End Sub
Private Sub CommandButton3_Click()

    Dim objControl As Control

   For Each objControl In Controls
      Select Case TypeName(objControl)
         Case "TextBox"
            objControl.Text = ""
      End Select
   Next

    Author = ThisDocument.CustomDocumentProperties("Author").Value
    Reviewer = ThisDocument.CustomDocumentProperties("Manager").Value
    


    revision = Right(ThisDocument.CustomDocumentProperties("Subject").Value, 2) + 1

    TextBox5.Text = revision
    TextBox7.Text = Author
    TextBox8.Text = Reviewer
    TextBox9.Text = Approver
    TextBox11.Text = Date
        
End Sub

Private Sub TextBox11_Exit(ByVal Cancel As MSForms.ReturnBoolean)

l|fffd|ngeRev_Date = Len(Me.TextBox11)
If l|fffd|ngeRev_Date <> 10 Or IsDate(TextBox11) = False Then

MsgBox "Date needs to be added in _dd.mm.yyyy_ format"
'UserForm1.Hide
'UserForm1.Show
Exit Sub
Else


End If

End Sub



Private Sub TextBox5_Exit(ByVal Cancel As MSForms.ReturnBoolean)

Dim lngLaenge As Long

lngLaenge = Len(Me.TextBox5)
    
    If lngLaenge = 1 Then
         TextBox5 = "0" & TextBox5
    End If
    
    If Left(ThisDocument.CustomDocumentProperties("Revision").Value, 1) = "V" And lngLaenge = 2 Then
        TextBox5 = "V0" & Right(TextBox5, 1)
    End If

End Sub

Sub fehler()
On Error GoTo 1

ThisDocument.Unprotect
1
End Sub

Private Sub UserForm_Initialize()
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    
    
    Dim objControl As Control

    aktrevision = Right(ThisDocument.CustomDocumentProperties("Revision").Value, 1)
    Author = ThisDocument.CustomDocumentProperties("Author").Value  ' 3 Autor = Author
    Reviewer = ThisDocument.CustomDocumentProperties("Reviewer").Value  '20 Manager = Reviewer
    Approver = ThisDocument.CustomDocumentProperties("Approver").Value
    If Left(ThisDocument.CustomDocumentProperties("Revision").Value, 1) = "V" Then     'Fals es eine Revision der Vorlage ist
        If Right(ThisDocument.CustomDocumentProperties("Revision").Value, 2) < 9 Then  'notwendig damit revision dreistellig wird/bleibt
            revision = "V" & "0" & Right(ThisDocument.CustomDocumentProperties("Revision").Value, 2) + 1
        Else
            revision = "V" & Right(ThisDocument.CustomDocumentProperties("Revision").Value, 2) + 1
        End If
    Else
        revision = ThisDocument.CustomDocumentProperties("Revision").Value + 1
    End If

    If Author = " " Then: Author = ""
    If Reviewer = " " Then: Reviewer = ""
    If Approver = " " Then: Approver = ""


    TextBox5.Text = revision
    TextBox7.Text = Author
    TextBox8.Text = Reviewer
    TextBox9.Text = Approver
    TextBox11.Text = Format(Date, "dd.mm.yyyy")
    Me.txt_doc_number.Value = ThisDocument.CustomDocumentProperties("Doc Number").Value
    Me.txt_doc_name.Value = ThisDocument.CustomDocumentProperties("Title").Value
        
End Sub
Attribute VB_Name = "frm_Rev1_plus_int_ext"
Attribute VB_Base = "0{0B668713-253C-433F-99C6-48C636C7211A}{FA844145-9B3C-447B-B8EA-FF05EC8FC124}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Public erster_leerschlag As Variant
Public revision As Variant, Author As Variant, Reviewer As Variant, Approver As Variant
Public Rev_Date As Variant, dat As Variant, Description1 As Variant
Public AIC As Variant, Description2 As Variant, Dokumentennummer As Variant, strDokNummer As Variant
Public interne_rev_eigensch As Variant, externe_rev_eigensch As Variant, titel As Variant

Public Sub CommandButton1_Click()
    Application.ScreenUpdating = False
    If ActiveDocument.ProtectionType <> wdNoProtection Then
        gesch|fffd|tzt = "ja"
    Else
        gesch|fffd|tzt = "nein"
    End If
    
    Call schutz_aufheben3
    
    frm_Rev1_plus_int_ext.Hide
    Call fehler
    
    If ThisDocument.TrackRevisions = True Then
       ThisDocument.TrackRevisions = Not ThisDocument.TrackRevisions
    End If
 
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    interne_rev_eigensch = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    externe_rev_eigensch = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    
    If interne_rev_eigensch = 0 And Me.revInternal <> 1 _
     And ThisDocument.CustomDocumentProperties("RevType").Value = "internal" Then
        MsgBox "The first internal Revision Number must be 1"
        Me.revInternal.Value = 1
        frm_Rev1_plus_int_ext.Show
    End If
    
    revision = Me.revCustomer.Text & "." & Me.revInternal
    Author = TextBox7.Text
    Reviewer = TextBox8.Text
    Approver = TextBox9.Text
    Rev_Date = TextBox11.Text
    Description2 = TextBox12.Text
    Description1 = TextBox13.Text
    Dokumentennummer = Me.txt_doc_number.Value 'ThisDocument.CustomDocumentProperties("Doc Number").Value
    titel = Me.txt_doc_name 'ThisDocument.CustomDocumentProperties("Title").Value
    
    If titel <> ThisDocument.CustomDocumentProperties("Title").Value Then
        ThisDocument.Bookmarks("doktitel").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = titel
    End If
    
    If Dokumentennummer <> ThisDocument.CustomDocumentProperties("Doc Number").Value Then
        ThisDocument.Bookmarks("dnummer").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = Dokumentennummer
    End If
    
   Dim objGr|fffd|neTextBoxen As Control
   
'es wird gepr|fffd|ft ob die gr|fffd|nen Mussfelder ausgef|fffd|llt sind
For Each objGr|fffd|neTextBoxen In Controls       'jedes Kontrollfeld wird gepr|fffd|ft (nicht nur Text Boxen)
    If TypeName(objGr|fffd|neTextBoxen) = "TextBox" Then     'es wird gepr|fffd|ft ob es sich bei der Control um eine TextBox handelt
        If objGr|fffd|neTextBoxen.BackColor = &HC0FFC0 Then          'falls das Feld gr|fffd|n ist...
            If objGr|fffd|neTextBoxen.Value = "" Then                '... und das Feld leer ist...
                MsgBox "all green fields must be filled out"    '... wird die MsgBox angezeigt
                frm_Rev1_plus_int_ext.Show
                Exit Sub
            End If
        End If
    End If
Next
    
    If revision = "0" Or revision = "00" Then
        MsgBox "this button shall only be used for revision 01 and higher"
        Exit Sub
    End If
       
    If externe_rev_eigensch > 5 Then
        Call revision6
    ElseIf Me.revCustomer = 5 And Me.revInternal > 0 Then
        Call revision6
    ElseIf Me.revCustomer > 5 Then
        Call revision6
    Else
        Call revision1
    End If
    
22
    ThisDocument.Bookmarks("rev").Select
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    'Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    'Selection.Delete
    ThisDocument.Bookmarks("rev").Range = "-" & revision
    
    Call revision_kopfzeile
    
    With ThisDocument
            .CustomDocumentProperties("Author").Value = Author
            .CustomDocumentProperties("Reviewer").Value = Reviewer
            .CustomDocumentProperties("Approver").Value = Approver
             .CustomDocumentProperties("Rev Date").Value = Rev_Date
            .CustomDocumentProperties("Revision").Value = revision
            .CustomDocumentProperties("Title").Value = titel
            .CustomDocumentProperties("Doc Number").Value = Dokumentennummer
    End With
    
   Application.TaskPanes(wdTaskPaneFormatting).Visible = True
    CommandBars("Standard").Visible = True
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
        ActivePane.View.Type = wdOutlineView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    
    
' Bestimmt den Pfad wo gespeichert werden soll (Desktop)
    Application.DisplayAlerts = False
    strPfad = Environ("UserProfile") & "\Desktop\"
    
 ' Speichert das Dokument
'    ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True

    endung = ".docm"
    If InStr(" ", ThisDocument.CustomDocumentProperties("Document Type").Value) > 0 Then
        erster_leerschlag = InStr(ThisDocument.CustomDocumentProperties("Document Type").Value, " ")
        doctype = Left(ThisDocument.CustomDocumentProperties("Document Type").Value, erster_leerschlag - 1)
    Else
        doctype = ThisDocument.CustomDocumentProperties("Document Type").Value
    End If
    lieferant = ThisDocument.CustomDocumentProperties("Supplier").Value
   
   If ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "ja" Then
        ThisDocument.SaveAs Filename:= _
        strPfad & doctype & "-" & lieferant & "-" & Dokumentennummer & "_" & revision & "_" & titel & endung
   Else
        ThisDocument.SaveAs Filename:= _
        strPfad & Dokumentennummer & "_" & revision & "_" & titel & endung
   End If
   
    Application.DisplayAlerts = True
    MsgBox "File saved on Desktop"
    Unload Me
   Exit Sub
    
'    If gesch|fffd|tzt = "ja" Then
'        ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True
'    End If
    Application.ScreenUpdating = False
End Sub

Sub revision1()

'    'anzahl_hoch = Val(externe_rev_eigensch)
'    anzahl_hoch = Val(Me.revCustomer)
    
    ThisDocument.Bookmarks("rev_start").Select

    Selection.MoveRight Unit:=wdWord, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=2
    
    If ThisDocument.CustomDocumentProperties("RevType").Value = "internal" Then
        anzahl_hoch = Val(externe_rev_eigensch)
        Selection.MoveUp Unit:=wdLine, Count:=(2 * anzahl_hoch) + 1
    Else
        anzahl_hoch = Val(Me.revCustomer)
        Selection.MoveUp Unit:=wdLine, Count:=(2 * anzahl_hoch) - 1
    End If
'aktuelle interne Revision wird gel|fffd|scht
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.MoveRight Unit:=wdCharacter, Count:=4, Extend:=wdExtend
    Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveDown Unit:=wdLine, Count:=1

    dat = 1
       
  ' mit der schleife werden die 4 Rev_Dates eingef|fffd|gt
  Selection = Rev_Date
   Do While dat < 3
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Rev_Date
   dat = dat + 1
   Loop
    
    Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Description1
   Selection.MoveUp Unit:=wdLine, Count:=1
   Selection = Description2
   Selection.MoveLeft Unit:=wdCharacter, Count:=1
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        

    Selection = Approver
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Approver = "" Then GoTo 12
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
12
    Selection = Reviewer
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Reviewer = "" Then GoTo 13
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
13
    Selection = Author
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Author = "" Then GoTo 14
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
14
        
    Selection = Me.revCustomer & "." & Me.revInternal
    
End Sub
Sub revision6()
   
    If ThisDocument.CustomDocumentProperties("RevType").Value = "internal" And Me.revInternal <> 1 Then GoTo 55
    If Me.revInternal = 0 And interne_rev_eigensch <> 0 Then GoTo 55
    
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev02_ende").Range.Start).Copy
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev04").Range.Start, _
               End:=ThisDocument.Bookmarks("rev01_ende").Range.Start).Select
               
    Selection.PasteAndFormat (wdPasteDefault)
55
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev05_ende").Range.Start).Delete
    ThisDocument.Bookmarks("rev05").Range = Me.revCustomer & "." & Me.revInternal
    ThisDocument.Bookmarks("d051").Range = Rev_Date
    ThisDocument.Bookmarks("d052").Range = Rev_Date
    ThisDocument.Bookmarks("d053").Range = Rev_Date
    ThisDocument.Bookmarks("descr105").Range = Description1
    ThisDocument.Bookmarks("descr205").Range = Description2
    
    ThisDocument.Bookmarks("p05").Range = Author
    ThisDocument.Bookmarks("r05").Range = Reviewer
    ThisDocument.Bookmarks("o05").Range = Approver
                      
End Sub
Private Sub revision_kopfzeile()

    Dim i As Long
   
    For i = 2 To ThisDocument.Sections.Count
    
 Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(3, 5).Range.Text = "- " & revision
    myHeader.Tables(1).Cell(2, 3).Range.Text = titel
    myHeader.Tables(1).Cell(3, 4).Range.Text = Dokumentennummer
    Next i

    Set myHeader = ThisDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(1, 1).Select
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.Style = ThisDocument.Styles("w4 titelbl Revision klein")

End Sub
Private Sub CommandButton2_Click()
    'frm_Rev1_plus_int_ext.Hide
    Unload Me
    End
    
End Sub



Private Sub revCustomer_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Dim revCust As Long
  If Not IsNumeric(Me.revCustomer.Value) Then 'KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
        Me.revCustomer.Value = ""
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
    
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, 1)
    
    If revCust + 1 > Me.revCustomer.Value Then
        MsgBox "This revision is already taken. Choose a higher number"
        Me.revCustomer.Value = revCust + 1
    End If
End Sub

Private Sub revInternal_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Dim revIntern As Long
   If Not IsNumeric(Me.revInternal.Value) Then 'KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
        Me.revInternal.Value = ""
    End If
  
'  Select Case KeyAscii
'        Case 48 To 57
'        Case Else
'            KeyAscii = 0
'    End Select
    
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    
    If revIntern + 1 > Me.revInternal.Value Then
        MsgBox "This revision is already taken. Choose a higher number"
        Me.revInternal.Value = revIntern + 1
    End If

End Sub

Private Sub TextBox11_Exit(ByVal Cancel As MSForms.ReturnBoolean)
l|fffd|ngedatum = Len(Me.TextBox11)
If l|fffd|ngedatum <> 10 Or IsDate(TextBox11) = False Then
    MsgBox "Date needs to be added in _dd.mm.yyyy_ format"
    Exit Sub
End If
End Sub
Private Sub TextBox5_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Dim lngLaenge As Long

lngLaenge = Len(Me.TextBox5)
    If lngLaenge = 1 Then
         TextBox5 = "0" & TextBox5
    End If
End Sub
Sub fehler()
On Error GoTo 1

ThisDocument.Unprotect
1
End Sub


Private Sub TextBox8_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    If LCase(Me.TextBox8.Text) = LCase(Me.TextBox7.Text) Then
        MsgBox "For quality reasons, Author and Reviewer might not be the same Person"
        Me.TextBox8.Value = ""
    End If
End Sub

Private Sub UserForm_Initialize()
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If

    Dim objControl As Control
    
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    
    aktrevision = Right(ThisDocument.CustomDocumentProperties("Revision").Value, 1)
    Author = ThisDocument.CustomDocumentProperties("Author").Value  ' 3 Autor = Author
    Reviewer = ThisDocument.CustomDocumentProperties("Reviewer").Value  '20 Manager = Reviewer
    Approver = ThisDocument.CustomDocumentProperties("Approver").Value
    If ThisDocument.CustomDocumentProperties("RevType").Value = "customer" Then     'Fals es eine Revision der Vorlage ist
        revCust = revCust + 1
        revIntern = 0
        Me.revInternal.Enabled = False
        Me.revCustomer.Enabled = True
    Else
        revIntern = revIntern + 1
        Me.revInternal.Enabled = True
        Me.revCustomer.Enabled = False
    End If
    
    
'wurde das dokument aus dem PIRS generiert, so sind die Standardwerte leer, und die werte aus xyz0 m|fffd|ssen |fffd|bernommen werden
'    If Left(ThisDocument.CustomDocumentProperties("Quelle").Value, 4) = "PIRS" And aktrevision = "0" Then
'        Author = ThisDocument.CustomDocumentProperties("Author0").Value
'        Reviewer = ThisDocument.CustomDocumentProperties("Reviewer0").Value
'        Approver = ThisDocument.CustomDocumentProperties("Approver0").Value
'    End If

    If Author = " " Then: Author = ""
    If Reviewer = " " Then: Reviewer = ""
    If Approver = " " Then: Approver = ""



    Me.revCustomer.Text = revCust
    Me.revInternal.Text = revIntern
    TextBox7.Text = Author
    TextBox8.Text = Reviewer
    TextBox9.Text = Approver
    TextBox11.Text = Format(Date, "dd.mm.yyyy")
    Me.txt_doc_number.Value = ThisDocument.CustomDocumentProperties("Doc Number").Value
    Me.txt_doc_name.Value = ThisDocument.CustomDocumentProperties("Title").Value
End Sub




Attribute VB_Name = "frm_Rev1_plus_int_ext_sprache"
Attribute VB_Base = "0{6F22CD77-BA77-4FC4-AF74-A0900D361F1D}{E0A36822-3686-44F8-986D-C0187EEAF3B3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Public erster_leerschlag As Variant
Public revision As Variant, revision_transl As Variant, Author As Variant, Reviewer As Variant, Approver As Variant
Public Rev_Date As Variant, dat As Variant, Description1 As Variant
Public AIC As Variant, Description2 As Variant, Dokumentennummer As Variant, strDokNummer As Variant
Public interne_rev_eigensch As Variant, externe_rev_eigensch As Variant, titel As Variant

Public Sub CommandButton1_Click()
    Application.ScreenUpdating = False
    If ActiveDocument.ProtectionType <> wdNoProtection Then
        gesch|fffd|tzt = "ja"
    Else
        gesch|fffd|tzt = "nein"
    End If
    
    Call schutz_aufheben3
    
    frm_Rev1_plus_int_ext.Hide
    Call fehler
    
    If ThisDocument.TrackRevisions = True Then
       ThisDocument.TrackRevisions = Not ThisDocument.TrackRevisions
    End If
 
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    interne_rev_eigensch = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    externe_rev_eigensch = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    
    If interne_rev_eigensch = 0 And Me.revInternal <> 1 _
     And ThisDocument.CustomDocumentProperties("RevType").Value = "internal" Then
        MsgBox "The first internal Revision Number must be 1"
        Me.revInternal.Value = 1
        frm_Rev1_plus_int_ext.Show
    End If
    
    revision = Me.revCustomer.Text & "." & Me.revInternal
    revision_transl = Me.revTranslation.Text
    Author = TextBox7.Text
    Reviewer = TextBox8.Text
    Approver = TextBox9.Text
    Rev_Date = TextBox11.Text
    Description2 = TextBox12.Text
    Description1 = TextBox13.Text
    Dokumentennummer = Me.txt_doc_number.Value 'ThisDocument.CustomDocumentProperties("Doc Number").Value
    titel = Me.txt_doc_name 'ThisDocument.CustomDocumentProperties("Title").Value
    
    If titel <> ThisDocument.CustomDocumentProperties("Title").Value Then
        ThisDocument.Bookmarks("doktitel").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = titel
    End If
    
    If Dokumentennummer <> ThisDocument.CustomDocumentProperties("Doc Number").Value Then
        ThisDocument.Bookmarks("dnummer").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Text = Dokumentennummer
    End If
    
   Dim objGr|fffd|neTextBoxen As Control
   
'es wird gepr|fffd|ft ob die gr|fffd|nen Mussfelder ausgef|fffd|llt sind
For Each objGr|fffd|neTextBoxen In Controls       'jedes Kontrollfeld wird gepr|fffd|ft (nicht nur Text Boxen)
    If TypeName(objGr|fffd|neTextBoxen) = "TextBox" Then     'es wird gepr|fffd|ft ob es sich bei der Control um eine TextBox handelt
        If objGr|fffd|neTextBoxen.BackColor = &HC0FFC0 Then          'falls das Feld gr|fffd|n ist...
            xdd = objGr|fffd|neTextBoxen.Name
            If objGr|fffd|neTextBoxen.Value = "" Then                '... und das Feld leer ist...
                MsgBox "all green fields must be filled out"    '... wird die MsgBox angezeigt
                frm_Rev1_plus_int_ext.Show
                Exit Sub
            End If
        End If
    End If
Next
    
    If revision = "0" Or revision = "00" Then
        MsgBox "this button shall only be used for revision 01 and higher"
        Exit Sub
    End If
    
    
        
       
    If externe_rev_eigensch > 5 Then
        Call revision6
    ElseIf Me.revCustomer = 5 And Me.revInternal > 0 Then
        Call revision6
    ElseIf Me.revCustomer > 5 Then
        Call revision6
    Else
        Call revision1
    End If
    
22
    ThisDocument.Bookmarks("rev").Select
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    'Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    'Selection.Delete
    ThisDocument.Bookmarks("rev").Range = "-" & revision & revision_transl
    
    Call revision_kopfzeile
    
    With ThisDocument
            .CustomDocumentProperties("Author").Value = Author
            .CustomDocumentProperties("Reviewer").Value = Reviewer
            .CustomDocumentProperties("Approver").Value = Approver
             .CustomDocumentProperties("Rev Date").Value = Rev_Date
            .CustomDocumentProperties("Revision").Value = revision
            If revision_transl = "" Then GoTo 99
            .CustomDocumentProperties("Rev_Translation").Value = Asc(revision_transl)
99
            .CustomDocumentProperties("Title").Value = titel
            .CustomDocumentProperties("Doc Number").Value = Dokumentennummer
    End With
    
   Application.TaskPanes(wdTaskPaneFormatting).Visible = True
    CommandBars("Standard").Visible = True
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
        ActivePane.View.Type = wdOutlineView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    
    
' Bestimmt den Pfad wo gespeichert werden soll (Desktop)
    Application.DisplayAlerts = False
    strPfad = Environ("UserProfile") & "\Desktop\"
    
 ' Speichert das Dokument
'    ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True

    endung = ".docm"
    If InStr(" ", ThisDocument.CustomDocumentProperties("Document Type").Value) > 0 Then
        erster_leerschlag = InStr(ThisDocument.CustomDocumentProperties("Document Type").Value, " ")
        doctype = Left(ThisDocument.CustomDocumentProperties("Document Type").Value, erster_leerschlag - 1)
    Else
        doctype = ThisDocument.CustomDocumentProperties("Document Type").Value
    End If
    lieferant = ThisDocument.CustomDocumentProperties("Supplier").Value
   
   If ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "ja" Then
        ThisDocument.SaveAs Filename:= _
        strPfad & doctype & "-" & lieferant & "-" & Dokumentennummer & "_" & revision & revision_transl & "_" & titel & endung
   Else
        ThisDocument.SaveAs Filename:= _
        strPfad & Dokumentennummer & "_" & revision & revision_transl & "_" & titel & endung
   End If
   
    Application.DisplayAlerts = True
    MsgBox "File saved on Desktop"
    Unload Me
   Exit Sub
    
'    If gesch|fffd|tzt = "ja" Then
'        ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True
'    End If
    Application.ScreenUpdating = False
End Sub

Sub revision1()

'    'anzahl_hoch = Val(externe_rev_eigensch)
'    anzahl_hoch = Val(Me.revCustomer)
    
    ThisDocument.Bookmarks("rev_start").Select

    Selection.MoveRight Unit:=wdWord, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=2
    
    If ThisDocument.CustomDocumentProperties("RevType").Value = "internal" Then
        anzahl_hoch = Val(externe_rev_eigensch)
        Selection.MoveUp Unit:=wdLine, Count:=(2 * anzahl_hoch) + 1
    Else
        anzahl_hoch = Val(Me.revCustomer)
        Selection.MoveUp Unit:=wdLine, Count:=(2 * anzahl_hoch) - 1
    End If
'aktuelle interne Revision wird gel|fffd|scht
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.MoveRight Unit:=wdCharacter, Count:=4, Extend:=wdExtend
    Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveDown Unit:=wdLine, Count:=1

    dat = 1
       
  ' mit der schleife werden die 4 Rev_Dates eingef|fffd|gt
  Selection = Rev_Date
   Do While dat < 3
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Rev_Date
   dat = dat + 1
   Loop
    
    Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Description1
   Selection.MoveUp Unit:=wdLine, Count:=1
   Selection = Description2
   Selection.MoveLeft Unit:=wdCharacter, Count:=1
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        
    Selection = Approver
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Approver = "" Then GoTo 12
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
12
    Selection = Reviewer
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Reviewer = "" Then GoTo 13
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
13
    Selection = Author
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Author = "" Then GoTo 14
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
14
        
    Selection = Me.revCustomer & "." & Me.revInternal
    
End Sub
Sub revision6()

    If ThisDocument.CustomDocumentProperties("RevType").Value = "internal" And Me.revInternal <> 1 Then GoTo 55
    If Me.revInternal = 0 And interne_rev_eigensch <> 0 Then GoTo 55
    
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev02_ende").Range.Start).Copy
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev04").Range.Start, _
               End:=ThisDocument.Bookmarks("rev01_ende").Range.Start).Select
               
    Selection.PasteAndFormat (wdPasteDefault)
55
    ThisDocument.Range(Start:=ThisDocument.Bookmarks("rev05").Range.Start, _
               End:=ThisDocument.Bookmarks("rev05_ende").Range.Start).Delete
    ThisDocument.Bookmarks("rev05").Range = Me.revCustomer & "." & Me.revInternal
    ThisDocument.Bookmarks("d051").Range = Rev_Date
    ThisDocument.Bookmarks("d052").Range = Rev_Date
    ThisDocument.Bookmarks("d053").Range = Rev_Date
    ThisDocument.Bookmarks("descr105").Range = Description1
    ThisDocument.Bookmarks("descr205").Range = Description2
    
    ThisDocument.Bookmarks("p05").Range = Author
    ThisDocument.Bookmarks("r05").Range = Reviewer
    ThisDocument.Bookmarks("o05").Range = Approver
                  
End Sub
Private Sub revision_kopfzeile()

    Dim i As Long
   
    For i = 2 To ThisDocument.Sections.Count
    
 Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(3, 5).Range.Text = "- " & revision & revision_transl
    myHeader.Tables(1).Cell(2, 3).Range.Text = titel
    myHeader.Tables(1).Cell(3, 4).Range.Text = Dokumentennummer
    Next i

    Set myHeader = ThisDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range
    myHeader.Tables(1).Cell(1, 1).Select
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.Style = ThisDocument.Styles("w4 titelbl Revision klein")

End Sub
Private Sub CommandButton2_Click()
    'frm_Rev1_plus_int_ext.Hide
    Unload Me
    End
    
End Sub
Private Sub revCustomer_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Dim revCust As Long
  If Not IsNumeric(Me.revCustomer.Value) Then 'KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
        Me.revCustomer.Value = ""
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
    
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, 1)
    
    If revCust + 1 > Me.revCustomer.Value Then
        MsgBox "This revision is already taken. Choose a higher number"
        Me.revCustomer.Value = revCust + 1
    End If
End Sub

Private Sub revInternal_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Dim revIntern As Long
   If Not IsNumeric(Me.revInternal.Value) Then 'KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
        Me.revInternal.Value = ""
    End If
  
'  Select Case KeyAscii
'        Case 48 To 57
'        Case Else
'            KeyAscii = 0
'    End Select
    
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    
    If revIntern + 1 > Me.revInternal.Value Then
        MsgBox "This revision is already taken. Choose a higher number"
        Me.revInternal.Value = revIntern + 1
    End If

End Sub

Private Sub TextBox11_Exit(ByVal Cancel As MSForms.ReturnBoolean)
l|fffd|ngedatum = Len(Me.TextBox11)
If l|fffd|ngedatum <> 10 Or IsDate(TextBox11) = False Then
    MsgBox "Date needs to be added in _dd.mm.yyyy_ format"
    Exit Sub
End If
End Sub
Private Sub TextBox5_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Dim lngLaenge As Long

lngLaenge = Len(Me.TextBox5)
    If lngLaenge = 1 Then
         TextBox5 = "0" & TextBox5
    End If
End Sub
Sub fehler()
On Error GoTo 1

ThisDocument.Unprotect
1
End Sub


Private Sub TextBox8_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    If LCase(Me.TextBox8.Text) = LCase(Me.TextBox7.Text) Then
        MsgBox "For quality reasons, Author and Reviewer might not be the same Person"
        Me.TextBox8.Value = ""
    End If
End Sub

Private Sub UserForm_Initialize()
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If

    Dim objControl As Control
    
    l|fffd|ngeRevision = Len(ThisDocument.CustomDocumentProperties("Revision").Value)
    punktPos = InStr(ThisDocument.CustomDocumentProperties("Revision").Value, ".")
    revCust = Left(ThisDocument.CustomDocumentProperties("Revision").Value, punktPos - 1)
    revIntern = Right(ThisDocument.CustomDocumentProperties("Revision").Value, l|fffd|ngeRevision - punktPos)
    
    aktrevision = Right(ThisDocument.CustomDocumentProperties("Revision").Value, 1)
    Author = ThisDocument.CustomDocumentProperties("Author").Value  ' 3 Autor = Author
    Reviewer = ThisDocument.CustomDocumentProperties("Reviewer").Value  '20 Manager = Reviewer
    Approver = ThisDocument.CustomDocumentProperties("Approver").Value
    If ThisDocument.CustomDocumentProperties("RevType").Value = "customer" Then     'Fals es eine Revision der Vorlage ist
        revCust = revCust + 1
        revIntern = 0
        Me.revInternal.Enabled = False
        Me.revCustomer.Enabled = True
    ElseIf ThisDocument.CustomDocumentProperties("RevType").Value = "internal" Then
        revIntern = revIntern + 1
        Me.revInternal.Enabled = True
        Me.revCustomer.Enabled = False
    Else
        Me.revInternal.Enabled = False
        Me.revCustomer.Enabled = False
        Me.revTranslation.Visible = True
        Me.revTranslation.BackColor = &HC0FFC0
        Me.Label25.Visible = True
        If ThisDocument.CustomDocumentProperties("Rev_Translation").Value = " " Then
            revTranslation = Chr$(65)
        Else
            revTranslation = Chr$(ThisDocument.CustomDocumentProperties("Rev_Translation").Value + 1)
        End If
    End If
    
    
'wurde das dokument aus dem PIRS generiert, so sind die Standardwerte leer, und die werte aus xyz0 m|fffd|ssen |fffd|bernommen werden
'    If Left(ThisDocument.CustomDocumentProperties("Quelle").Value, 4) = "PIRS" And aktrevision = "0" Then
'        Author = ThisDocument.CustomDocumentProperties("Author0").Value
'        Reviewer = ThisDocument.CustomDocumentProperties("Reviewer0").Value
'        Approver = ThisDocument.CustomDocumentProperties("Approver0").Value
'    End If

    If Author = " " Then: Author = ""
    If Reviewer = " " Then: Reviewer = ""
    If Approver = " " Then: Approver = ""


    Me.revCustomer.Text = revCust
    Me.revInternal.Text = revIntern
    Me.revTranslation.Text = revTranslation
    TextBox7.Text = Author
    TextBox8.Text = Reviewer
    TextBox9.Text = Approver
    TextBox11.Text = Format(Date, "dd.mm.yyyy")
    Me.txt_doc_number.Value = ThisDocument.CustomDocumentProperties("Doc Number").Value
    Me.txt_doc_name.Value = ThisDocument.CustomDocumentProperties("Title").Value
End Sub




Attribute VB_Name = "frm_ext_int_revision"
Attribute VB_Base = "0{AAB60703-97AF-4E24-988E-8AE8AE3B45F7}{9E638E8A-3882-46EF-ACAB-6A4B1D3F11C9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    ThisDocument.CustomDocumentProperties("RevType").Value = "internal"
    Unload Me
    frm_Rev1_plus_int_ext.Show
End Sub
Private Sub CommandButton2_Click()
    ThisDocument.CustomDocumentProperties("RevType").Value = "customer"
    Unload Me
    frm_Rev1_plus_int_ext.Show
End Sub

Attribute VB_Name = "frm_ext_int_revision_sprach"
Attribute VB_Base = "0{B7750A20-631E-4102-8AF0-49C51B2C082B}{F114DADA-B43D-4F25-B5A1-F5D81D740F1E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    ThisDocument.CustomDocumentProperties("RevType").Value = "internal"
    ThisDocument.CustomDocumentProperties("Rev_Translation").Value = " "    'wird eine h|fffd|here Revision erstellt, so ist der Translation-Index wieder leer
    Unload Me
    frm_Rev1_plus_int_ext.Show
End Sub
Private Sub CommandButton2_Click()
    ThisDocument.CustomDocumentProperties("RevType").Value = "customer"
    ThisDocument.CustomDocumentProperties("Rev_Translation").Value = " "    'wird eine h|fffd|here Revision erstellt, so ist der Translation-Index wieder leer
    Unload Me
    frm_Rev1_plus_int_ext.Show
End Sub
Private Sub CommandButton3_Click()
    ThisDocument.CustomDocumentProperties("RevType").Value = "translate"
    Unload Me
    frm_Rev1_plus_int_ext_sprache.Show
End Sub

Attribute VB_Name = "frm_makro_einstellungen"
Attribute VB_Base = "0{EDECAB0B-55A3-43B5-97F9-24BF5079ADEF}{A015E8F1-0C79-4439-8534-97E8D6C02543}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    If Me.opt_docType_n.Value = True Then
        ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "nein"
    Else
        ThisDocument.CustomDocumentProperties("DocType und Supplier vor Nummer anzeigen").Value = "ja"
        
    End If

    If Me.opt_intExt_n = True Then
        ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "nein"
    Else
        ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja"
    End If
    
    If Me.opt_Template_n = True Then
        ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value = "ja"
        ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "nein"
    Else
        ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value = "nein"
        'falls es eine Vorlage ist wird der DokTyp automatisch auf "JTE" gesetzt
        ThisDocument.Bookmarks("doctype").Select
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection = "JTE"
        ThisDocument.CustomDocumentProperties("Document Type").Value = "JTE"
        ThisDocument.CustomDocumentProperties("Maske mit Doktyp zeigen").Value = "janein"   'somit wird beim erstellen der Vorlage die DokTyp maske nicht angezeigt, anschliessend wird in der Vorlage auf "ja" umgestellt
        ThisDocument.CustomDocumentProperties("Status").Value = "Projektvorlage"
    End If
    
    If Me.opt_lang_y = True Then
        ThisDocument.CustomDocumentProperties("mit Revision f|fffd|r |fffd|bers").Value = "ja"
    Else
        ThisDocument.CustomDocumentProperties("mit Revision f|fffd|r |fffd|bers").Value = "nein"
    End If
    
    ThisDocument.CustomDocumentProperties("Quelle").Value = "Projekt"
    
    Unload Me
    
End Sub


Private Sub Label10_Click()

End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "frm_schutz_aktiv"
Attribute VB_Base = "0{5198139D-A9C6-4A1B-84F7-E67597036176}{CF4E2D47-3DC5-4CDA-8C37-C8F1D411D2FD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
    
End Sub
Attribute VB_Name = "frm_schutz_deaktiviert"
Attribute VB_Base = "0{7695D6B0-A4C5-4796-A126-F57106DD39A1}{4545727E-A1CC-45AF-BE97-427762FCF01F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
 Unload Me
 
End Sub
Attribute VB_Name = "info"
Attribute VB_Base = "0{C96FD165-4B7B-4926-B119-2D7EB462B48D}{296DAD94-6623-4C0E-8C75-0645416EE593}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label4_Click()
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    
    Unload Me
'    If ThisDocument.CustomDocumentProperties("Status").Value = "Vorlage" Then
'        ThisDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "ja"
'    Else
        ThisDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "nein"
'    End If
    ThisDocument.CustomDocumentProperties("Status").Value = "Vorlagen-Projekt"
    frm_Rev0.Show
End Sub

Private Sub Label5_Click()
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    
    
    Unload Me
    ThisDocument.CustomDocumentProperties("Startmaske anzeigen").Value = "nein"
   ThisDocument.CustomDocumentProperties("Status").Value = "Projekt"
    frm_Rev0.Show
    
End Sub


Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "modFehlerMeldung"
Sub fehler_meldung()


    If Err.Number = "40351" Then
        y_fehlermeldung_40351.Show
        
        'MsgBox ""
        Err.Clear
        End
    End If
End Sub
Attribute VB_Name = "modFormatierung_|fffd|ndern"
Sub alte_formatierung_auf_neue_anpassen()

'shortcut: Alt+f
'die Formatvorlagen aus den Office 2003-Vorlagen werden automatisch angepasst
On Error Resume Next
    Selection.Find.ClearFormatting
    Selection.Find.Style = ActiveDocument.Styles("Standard braun")
    Selection.Find.Replacement.ClearFormatting
    Selection.Find.Replacement.Style = ActiveDocument.Styles( _
        "HZI Pic Title")
        Selection.Find.Execute Replace:=wdReplaceAll
        
        
    Selection.Find.ClearFormatting
    Selection.Find.Style = ActiveDocument.Styles("Standard blaugr|fffd|n")
    Selection.Find.Replacement.ClearFormatting
    Selection.Find.Replacement.Style = ActiveDocument.Styles( _
        "HZI Strd Green")
        Selection.Find.Execute Replace:=wdReplaceAll

End Sub


Attribute VB_Name = "modHZI_Formatting"
'Formatierung erstellen gem|fffd|ss dem Reiter "HZI Formatting"
Sub fett(ctl As IRibbonControl)
    Selection.FONT.Bold = wdToggle
End Sub
Sub farbe_rot(ctl As IRibbonControl)
    If Selection.FONT.Color = wdColorRed Then
        Selection.FONT.Color = wdAuto
    Else
        Selection.FONT.Color = wdColorRed
    End If
End Sub
Sub farbe_gr|fffd|n(ctl As IRibbonControl)
    If Selection.FONT.Color = 5287936 Then
        Selection.FONT.Color = wdAuto
    Else
        Selection.FONT.Color = 5287936
    End If
End Sub
Sub farbe_blau(ctl As IRibbonControl)
    If Selection.FONT.Color = 12611584 Then
        Selection.FONT.Color = wdAuto
    Else
        Selection.FONT.Color = 12611584
    End If
End Sub
Sub farbe_drot(ctl As IRibbonControl)
    If Selection.FONT.Color = 192 Then
        Selection.FONT.Color = wdAuto
    Else
        Selection.FONT.Color = 192
    End If
End Sub
Sub markieren(ctl As IRibbonControl)
       If Selection.Range.HighlightColorIndex = wdYellow Then
            Selection.Range.HighlightColorIndex = wdNone
        Else
            Selection.Range.HighlightColorIndex = wdYellow
        End If
End Sub
Sub farbe_schwarz(ctl As IRibbonControl)
    Selection.FONT.Color = wdAuto
End Sub
Attribute VB_Name = "modQuer"
Sub querformat(ctl As IRibbonControl)
'
Dim lngAbschnitt As Long

    If MsgBox("Steht der Cursor am richtigen Ort?" & vbCrLf & "Cursor positioned on the right place?", vbYesNo) = vbNo Then
        Exit Sub
    End If
        
    Call schutz_aufheben3
    
    Selection.InsertBreak Type:=wdSectionBreakNextPage
    If Selection.PageSetup.Orientation = wdOrientPortrait Then
        Selection.PageSetup.Orientation = wdOrientLandscape
    Else
        Selection.PageSetup.Orientation = wdOrientPortrait
    End If
    Selection.InsertBreak Type:=wdSectionBreakNextPage
    If Selection.PageSetup.Orientation = wdOrientPortrait Then
        Selection.PageSetup.Orientation = wdOrientLandscape
    Else
        Selection.PageSetup.Orientation = wdOrientPortrait
    End If

    
    lngAbschnitt = Selection.Information(wdActiveEndSectionNumber)
    ThisDocument.Sections(lngAbschnitt).Footers(1).LinkToPrevious = False
    ThisDocument.Sections(lngAbschnitt).Headers(1).LinkToPrevious = False

    Selection.MoveUp Unit:=wdLine, Count:=1
    
    lngAbschnitt = Selection.Information(wdActiveEndSectionNumber)
    ThisDocument.Sections(lngAbschnitt).Footers(1).LinkToPrevious = False
    ThisDocument.Sections(lngAbschnitt).Headers(1).LinkToPrevious = False
   
   
    With Selection.PageSetup
        .LineNumbering.Active = False
        .Orientation = wdOrientLandscape
        .TopMargin = CentimetersToPoints(3.5) '3.5
        .BottomMargin = CentimetersToPoints(1.25) '1.25
        .LeftMargin = CentimetersToPoints(3.25)
        .RightMargin = CentimetersToPoints(1.2)
        .Gutter = CentimetersToPoints(0)
        .HeaderDistance = CentimetersToPoints(1)
        .FooterDistance = CentimetersToPoints(0.3)
        .PageWidth = CentimetersToPoints(29.7)
        .PageHeight = CentimetersToPoints(21)
        .FirstPageTray = wdPrinterDefaultBin
        .OtherPagesTray = wdPrinterDefaultBin
        .SectionStart = wdSectionNewPage
        .OddAndEvenPagesHeaderFooter = False
        .DifferentFirstPageHeaderFooter = False
        .VerticalAlignment = wdAlignVerticalTop
        .SuppressEndnotes = False
        .MirrorMargins = False
        .TwoPagesOnOne = False
        .BookFoldPrinting = False
        .BookFoldRevPrinting = False
        .BookFoldPrintingSheets = 1
        .GutterPos = wdGutterPosLeft
        .SectionDirection = wdSectionDirectionLtr
        .LayoutMode = wdLayoutModeDefault
    End With

    
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
        ActivePane.View.Type = wdOutlineView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader


     Set myFooter = ThisDocument.Sections(lngAbschnitt).Footers(wdHeaderFooterPrimary).Range

    myFooter.Tables(1).Cell(1, 2).Width = 480
    MsgBox "Tabellenbreite in Kopfzeile manuell anpassen" & vbCrLf & _
        "Adapt table width in header manually"
End Sub

Sub schutz_aufheben3()
On Error GoTo 1
    ThisDocument.Unprotect
1
End Sub

Attribute VB_Name = "modRev00_aus_PIRS_erstellen"
Sub Rev_00_aus_PIRS()
'Variablen Deklaration
Application.ScreenUpdating = False

Call schutz_aufheben3
    
    
    
'falls der |fffd|berarbeitungsmodus aktiviert ist wird er hier deaktiviert
If ThisDocument.TrackRevisions = True Then
   ThisDocument.TrackRevisions = Not ThisDocument.TrackRevisions
End If

If ThisDocument.CustomDocumentProperties("AIC maske anzeigen").Value = "ja" Then
    frm_AIC.Show
End If

'Call dokument_entsperren    'das Dokument wird entsperrt, damit keine falschen Formatierungen eingetragen werden

'die Dokumentennummer und die Revision werden erfasst, um zu Bestimmen was die Vorlage f|fffd|r das neu erstellte Dokument war
ThisDocument.Bookmarks("dnummer").Select
Selection.MoveRight Unit:=wdWord, Count:=1, Extend:=wdExtend
strDokNummervorlage = Selection.Text
ThisDocument.Bookmarks("rev").Select
Selection.MoveRight Unit:=wdWord, Count:=1
Selection.EndKey Unit:=wdLine, Extend:=wdExtend
Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
strRevVorlage = Selection.Text
If strRevVorlage = "" Then
    strRevVorlage = ThisDocument.CustomDocumentProperties("Revision").Value
End If



 
projektnummer = ThisDocument.CustomDocumentProperties("Projektnummer").Value
projektname = ThisDocument.CustomDocumentProperties("Projektname").Value
titel = ThisDocument.CustomDocumentProperties("Title").Value
strDokNummer = ThisDocument.CustomDocumentProperties("Doc Number").Value
AIC = ThisDocument.CustomDocumentProperties("AIC").Value
Author = ThisDocument.CustomDocumentProperties("Author").Value
Reviewer = ThisDocument.CustomDocumentProperties("Reviewer").Value
Approver = ThisDocument.CustomDocumentProperties("Approver").Value
Rev_Date = ThisDocument.CustomDocumentProperties("Rev Date").Value
If Rev_Date = "" Then Rev_Date = Date
revision = ThisDocument.CustomDocumentProperties("Revision").Value
doctype = ThisDocument.CustomDocumentProperties("Document Type").Value

'falls kein Revisionsdatum angegeben wurde, so wird heute gew|fffd|hlt
If Rev_Date = "" Then
    Rev_Date = Date
End If

   'falls aus dem PIRS nicht nur die 3 buchstaben |fffd|bernommen wurden, so wird der Dokumententyp hier angepasst
    If InStr(1, ThisDocument.CustomDocumentProperties("Document Type").Value, " ") > 0 Then
        erster_leerschlag = InStr(ThisDocument.CustomDocumentProperties("Document Type").Value, " ")
        doctype = Left(ThisDocument.CustomDocumentProperties("Document Type").Value, erster_leerschlag - 1)
        ThisDocument.CustomDocumentProperties("Document Type").Value = doctype
    End If

'die erste revision muss immer = 00 oder V00 sein
If ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" And revision <> "0.0" Then
    revision = "0.0"
    MsgBox "First Revision must be 0.0. Use Button under HZI Commands in order to create higher revisions"
    GoTo 25
ElseIf revision = "0.0" Then
    GoTo 25
ElseIf Left(revision, 1) = "V" Then
    If Right(revision, 2) <> "00" Then
        revision = "V00"
        MsgBox "First Revision must be V00. Use Button under HZI Commands in order to create higher revisions"
        GoTo 25
    End If
ElseIf Right(revision, 2) <> "00" Then
    revision = "00"
    MsgBox "First Revision must be 00. Use Button under HZI Commands in order to create higher revisions"
End If

25
If AIC = "" Then
    AIC = "000000"
End If

ThisDocument.CustomDocumentProperties("Revision").Value = revision

Call textmarken_zuweisen2

dat = 1
        
  ' mit der schleife werden die 4 Rev_Dates eingef|fffd|gt
  Selection = Rev_Date
   Do While dat < 3
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection.MoveRight Unit:=wdCharacter, Count:=1
   Selection = Rev_Date
   dat = dat + 1
   Loop

    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection = Approver
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Approver = "" Then GoTo 12
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
12
    Selection = Reviewer
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        If Reviewer = "" Then GoTo 13
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
13
    Selection = Author
       
    
   ThisDocument.Bookmarks("doktitel").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.Style = ActiveDocument.Styles( _
        "w6 titelbl Dokumentenname")
   Selection.Text = titel

   ThisDocument.Bookmarks("AIC").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.Style = ActiveDocument.Styles( _
        "w9 titelbl Projektname/AIC zentr")
   Selection.Text = AIC

    ThisDocument.Bookmarks("doctype").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        Selection.FONT.Color = wdColorBlack
        Selection.Text = doctype
        
   ThisDocument.Bookmarks("dnummer").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = strDokNummer
  ' If schwarz = "ja" Then
        Selection.Style = ActiveDocument.Styles( _
        "wz10 Titelb Dokumentennr")
 '  End If
   
   ThisDocument.Bookmarks("rev").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = "-" & revision
  ' If schwarz = "ja" Then
        Selection.Style = ActiveDocument.Styles( _
        "wz10 Titelb Dokumentennr")
  ' End If
   
   ThisDocument.Bookmarks("dnummerrev").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = strDokNummervorlage & "-" & strRevVorlage
  ' If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
  ' End If
   
'   ThisDocument.Bookmarks("pname").Select
'   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
'  ' Selection.Text = projektname
'  ' If schwarz = "ja" Then
'        Selection.Style = ActiveDocument.Styles( _
'        "w9 titelbl Projektname/AIC zentr")
'  ' End If
   
   ThisDocument.Bookmarks("pnummer").Select
   Selection.EndKey Unit:=wdLine, Extend:=wdExtend
   Selection.Text = projektnummer
  ' If schwarz = "ja" Then
        Selection.Style = ActiveDocument.Styles( _
        "w8 titelbl ProjektNr")
  ' End If
   
'die revisionstabelle wird schwarz eingef|fffd|rbt falls nicht Vorlagen-Projekt
    ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=6, Extend:=wdExtend
  Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend

  ' If schwarz = "ja" Then
        Selection.FONT.Color = wdBlack
  ' End If
   
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Die Kopfzeile wird angepasst
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
   Dim i As Long
   For i = 2 To ThisDocument.Sections.Count
        
   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 5).Range.Text = "-" & revision
   myHeader.Tables(1).Cell(3, 5).Select
 '  If schwarz = "ja" Then
        Selection.FONT.Color = wdColorBlack
'    Else
'        Selection.Font.Color = RGB(0, 176, 80)
'   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
 '  myHeader.Tables(1).Cell(1, 3).Range.Text = projektname
    myHeader.Tables(1).Cell(1, 3).Select
 '  If schwarz = "ja" Then
       Selection.FONT.Color = wdColorBlack
'    Else
'        Selection.Font.Color = RGB(0, 176, 80)
'   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(2, 3).Range.Text = titel
   myHeader.Tables(1).Cell(2, 3).Select
   Selection.FONT.Color = wdColorBlack
   
   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 4).Range.Text = strDokNummer
   myHeader.Tables(1).Cell(3, 4).Select
  ' If schwarz = "ja" Then
       Selection.FONT.Color = wdColorBlack
'    Else
'        Selection.Font.Color = RGB(0, 176, 80)
'   End If

   Set myHeader = ThisDocument.Sections(i).Headers(wdHeaderFooterPrimary).Range
   myHeader.Tables(1).Cell(3, 2).Range.Text = AIC
   myHeader.Tables(1).Cell(3, 2).Select
   Selection.FONT.Color = wdColorBlack
   Next i
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' die ansicht des Dokumentes wird auf standard gestellt
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
   Application.TaskPanes(wdTaskPaneFormatting).Visible = True
   CommandBars("Standard").Visible = True
   If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
       ActiveWindow.Panes(2).Close
   End If
   If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
       ActivePane.View.Type = wdOutlineView Then
       ActiveWindow.ActivePane.View.Type = wdPrintView
   End If
   ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
   ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'die Benutzerspezifischen Eigenschaften werden ausgef|fffd|llt

     With ThisDocument
           .CustomDocumentProperties("Author").Value = Author
           .CustomDocumentProperties("Reviewer").Value = Reviewer
           .CustomDocumentProperties("Approver").Value = Approver
            .CustomDocumentProperties("Rev Date").Value = Rev_Date
            .CustomDocumentProperties("AIC").Value = AIC
           .CustomDocumentProperties("Title").Value = titel
           .CustomDocumentProperties("Doc Number").Value = strDokNummer
           .CustomDocumentProperties("Revision").Value = revision
           .CustomDocumentProperties("Projektnummer").Value = projektnummer
      '     .CustomDocumentProperties("Projektname").Value = projektname
   End With
   
' Bestimmt den Pfad wo gespeichert werden soll (Desktop)
   Application.DisplayAlerts = False
   strPfad = Environ("UserProfile") & "\Desktop\"
'  ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'        UseIRM:=False, EnforceStyleLock:=True
' Speichert das Dokument
   ChangeFileOpenDirectory _
       strPfad
   
'einf|fffd|gen der Benutzerdefinierten Eigenschaften
   ThisDocument.CustomDocumentProperties("Title").Value = titel       'der Dokumententitel wird eingegeben
   
   ThisDocument.CustomDocumentProperties("Quelle").Value = "PIRS2"      '= das Dokument wurde aus dem PIRS heraus generiert, das Makro ist ausgef|fffd|hrt
                                                                       
   Call dok_sch|fffd|tzen
   
   ThisDocument.Save
   

   Application.DisplayAlerts = True
   ThisDocument.CustomDocumentProperties("Title").Value = titel
   MsgBox "File saved in PIRS"
 'Falls nicht das Vorlagenprojekt gemacht wird => Abfrage ob erste seite l|fffd|schen
    Application.ScreenUpdating = True
    
End Sub

Public Sub textmarken_zuweisen2()

' wenn das dokument aus dem PIRS kommt, dann muss das 00 abenfalls geschrieben werden, weil das zuvor fon PIRS gel|fffd|scht wurde

' wenn das dokument aus dem PIRS kommt, dann muss das 00 abenfalls geschrieben werden, weil das zuvor fon PIRS gel|fffd|scht wurde
     ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=1
  Selection.MoveUp Unit:=wdLine, Count:=5, Extend:=wdExtend
  Selection.Delete

    schwarz = ThisDocument.CustomDocumentProperties("Text schwarz auf Titelblatt").Value
    
  'If schwarz = "ja" Then
    Selection.FONT.Color = wdColorBlack
 ' End If
  
  Selection.MoveDown Unit:=wdLine, Count:=5
  If ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" Then
    For i = 0 To 5
        Selection = i & ".0"
        Selection.MoveUp Unit:=wdLine, Count:=1
    Next
    Else
    For i = 0 To 5
        Selection = "0" & i
        Selection.MoveUp Unit:=wdLine, Count:=1
    Next
    End If
  
    'Selection.MoveDown Unit:=wdLine, Count:=6
   ThisDocument.Bookmarks("rev_start").Select
  Selection.MoveUp Unit:=wdLine, Count:=1
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=1
  Selection.MoveDown Unit:=wdLine, Count:=1
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend
  Selection.MoveUp Unit:=wdLine, Count:=11, Extend:=wdExtend
  Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
 ' If schwarz = "ja" Then
    Selection.FONT.Color = wdColorBlack
 ' End If
  Selection.Delete
  
  ThisDocument.Bookmarks("first_issue").Select
'  Selection.MoveUp Unit:=wdLine, Count:=1
'  Selection.MoveRight Unit:=wdCharacter, Count:=7
 Selection = "First Issue"
  
  ThisDocument.Bookmarks("rev_start").Select
  Selection.EndKey Unit:=wdLine
  Selection.MoveRight Unit:=wdCharacter, Count:=1
  Selection.MoveUp Unit:=wdLine, Count:=1
   
End Sub


Attribute VB_Name = "modSchutz_Enter_l|fffd|schen"
Sub dok_sch|fffd|tzen()
Attribute dok_sch|fffd|tzen.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.schutz_aufheben"
'
'    ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
'         UseIRM:=False, EnforceStyleLock:=True
End Sub
Sub schutz_aufheben_einschalten()
'
    On Error GoTo 2
    ThisDocument.Unprotect
        frm_schutz_deaktiviert.Show
    Exit Sub
2
    ThisDocument.Protect Password:="", NoReset:=False, Type:=wdNoProtection, _
         UseIRM:=False, EnforceStyleLock:=True
         frm_schutz_aktiv.Show
End Sub
Sub enter_l|fffd|schen()
'shortcut: Alt+e
'alle doppelten "Enter" werden im Dokument gel|fffd|scht, da sie f|fffd|r die aktuelle Formatierung nicht
'n|fffd|tig sind

  

    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "^p^p"
        .Replacement.Text = "^p"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchKashida = False
        .MatchDiacritics = False
        .MatchAlefHamza = False
        .MatchControl = False
        .MatchByte = False
        .MatchAllWordForms = False
        .MatchSoundsLike = False
        .MatchWildcards = False
        .MatchFuzzy = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.Find.Execute Replace:=wdReplaceAll
End Sub
Sub rote_eintr|fffd|geL|fffd|schen()
'l|fffd|scht alle roten texte im Dokument, wenn man die Vorlage dem Kunden schicken will
    
    ThisDocument.Bookmarks("rev_start").Select

    Selection.MoveRight Unit:=wdWord, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.MoveRight Unit:=wdCharacter, Count:=5, Extend:=wdExtend
    Selection.MoveUp Unit:=wdLine, Count:=11, Extend:=wdExtend
    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    
   ' ThisDocument.Bookmarks("text_rot").Select
    Selection.FONT.Color = wdAuto           'die revisionseintr|fffd|ge welche nicht rot werden in schwarz ge|fffd|ndert => damit nicht gel|fffd|scht
       
            On Error Resume Next
        
          Dim oDoc As Document
  Set oDoc = ActiveDocument
  If oDoc.Bookmarks.Exists("kommentar_text_anfang") And oDoc.Bookmarks.Exists("kommentar_text_ende") Then
    oDoc.Range(Start:=oDoc.Bookmarks("kommentar_text_anfang").Range.Start, _
               End:=oDoc.Bookmarks("kommentar_text_ende").Range.Start).Select
  End If
  Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
       ' Selection.GoTo What:=wdGoToBookmark, Name:="Kommentar_text"
        Selection.TypeBackspace

    
'    ThisDocument.Bookmarks("Kommentar_text").Select
'    Selection.Delete
    Selection.Find.ClearFormatting
    Selection.Find.FONT.Color = wdColorRed
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = ""
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchKashida = False
        .MatchDiacritics = False
        .MatchAlefHamza = False
        .MatchControl = False
        .MatchByte = False
        .MatchAllWordForms = False
        .MatchSoundsLike = False
        .MatchWildcards = False
        .MatchFuzzy = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
'
End Sub

Attribute VB_Name = "modSprache"
Sub Sprache_|fffd|ndern(ctl As IRibbonControl)
    On Error Resume Next
    Dim Sprache

If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If

    Sprache = ThisDocument.Styles(stand & "HZI Strd").LanguageID
    If Sprache = wdSwissGerman Then
        Sprache = wdEnglishUK
        MsgBox "Language in Document is English (orthography)"
    Else
        Sprache = wdSwissGerman
        MsgBox "Dokumentensprache ist Deutsch (Rechtschreibung)"
    End If
    

'die Sprache wird umgestellt, entweder von englisch auf deutsch oder umgekehrt
    Selection.WholeStory
    Selection.LanguageID = Sprache
    
'allen Formatvorlagen wird die neue Sprache zugeordnet
With ThisDocument
    .Styles("HZI List Letter").LanguageID = Sprache
    .Styles("HZI Listing").LanguageID = Sprache
    .Styles("HZI Listing green").LanguageID = Sprache
    .Styles("HZI Numbering").LanguageID = Sprache
    .Styles("HZI Numbering green").LanguageID = Sprache
    .Styles("HZI Pic Title").LanguageID = Sprache
    .Styles(stand & "HZI Strd").LanguageID = Sprache
    .Styles("HZI Strd Center").LanguageID = Sprache
    .Styles("HZI Strd Left").LanguageID = Sprache
    .Styles("HZI Strd Green").LanguageID = Sprache
    .Styles("HZI Strd D-Red").LanguageID = Sprache
    .Styles("HZI Strd Red").LanguageID = Sprache
    .Styles("HZI Strd Blue").LanguageID = Sprache
    '.Styles("Tabellenraster;HZI Table Grid").LanguageID = Sprache
    .Styles("HZI Table Text").LanguageID = Sprache
    .Styles("HZI Table Text Center").LanguageID = Sprache
    .Styles("HZI Table Text green").LanguageID = Sprache
    .Styles("HZI Table Text small").LanguageID = Sprache
    .Styles("HZI Table Title").LanguageID = Sprache
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").LanguageID = Sprache
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").LanguageID = Sprache
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").LanguageID = Sprache
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").LanguageID = Sprache
End With

    Selection.MoveUp Unit:=wdLine, Count:=1
End Sub
Attribute VB_Name = "mod_HZI_Commands_Ribbon"
Sub HZI_rev00_formular(ctl As IRibbonControl)
    frm_Rev0.Show
End Sub
Sub HZI_rev01_formular(ctl As IRibbonControl)
'je nach vorgegebenen benutzerdefinierten eigenschaften wird die maske mit Sprache/Int.Revision angezeigt, oder nur Int.&Ext.Revision, oder nur Ext. revision
    If ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" And ThisDocument.CustomDocumentProperties("mit Revision f|fffd|r |fffd|bers").Value = "ja" Then
        frm_ext_int_revision_sprach.Show
    ElseIf ThisDocument.CustomDocumentProperties("Interne Revisionen").Value = "ja" Then
        frm_ext_int_revision.Show
    Else
        frm_Rev1_plus.Show
    End If
End Sub
Sub HZI_f|fffd|gt_Tabelle_in_das_Dokument(ctl As IRibbonControl)
    tabelle.Show
End Sub
Sub HZI_f|fffd|gt_Tabulator_in_das_Dokument(ctl As IRibbonControl)
    tabstop.Show
End Sub
Sub HZI_f|fffd|gt_Bilderrahmen_in_das_Dokument(ctl As IRibbonControl)
    bilder.Show
End Sub
Sub Repare_Formatting(ctl As IRibbonControl)
    frmFormate.Show
End Sub
Sub HZI_anleitung(ctl As IRibbonControl)
    z_Anleitung2.Show
End Sub
Sub schutz_aufheben(ctl As IRibbonControl)
    Call schutz_aufheben_einschalten
End Sub
Sub rot_l|fffd|schen(ctl As IRibbonControl)
    frmRoterTextL|fffd|schen.Show
End Sub
Sub enter_l|fffd|schen1(ctl As IRibbonControl)
    Call enter_l|fffd|schen
End Sub

Sub HZI_Ansicht(ctl As IRibbonControl)
   ' Call nameStyle
    Dim styl As Word.Style
 
On Error GoTo Testmakro_Err
 
'jede Formatvorlage (Style) wird ausgeblendet
 For Each styl In ThisDocument.Styles
     With ThisDocument.Content.Find
         styl.Visibility = True
     End With
 Next styl
 
 If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If
 
'alle Standard Formatvorlagen werden eingeblendet (Visibility = False :-)
With ThisDocument
    .Styles("HZI List Letter").Visibility = False
    .Styles("HZI Listing").Visibility = False
    .Styles("HZI Listing green").Visibility = False
    .Styles("HZI Numbering").Visibility = False
    .Styles("HZI Numbering green").Visibility = False
    .Styles("HZI Pic Title").Visibility = False
    .Styles(stand & "HZI Strd").Visibility = False
    .Styles("HZI Strd Blue").Visibility = False
    .Styles("HZI Strd Center").Visibility = False
    .Styles("HZI Strd Green").Visibility = False
    .Styles("HZI Strd Left").Visibility = False
    .Styles("HZI Strd Red").Visibility = False
    '.Styles("Tabellenraster;HZI Table Grid").Visibility = False
    .Styles("HZI Table Text").Visibility = False
    .Styles("HZI Table Text Center").Visibility = False
    .Styles("HZI Table Text green").Visibility = False
    .Styles("HZI Table Text small").Visibility = False
    .Styles("HZI Table Title").Visibility = False
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").Visibility = False
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").Visibility = False
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").Visibility = False
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").Visibility = False
End With

'die Reihenfolge wie die Formatvorlagen angezeigt werden sollen wird festgelegt
With ThisDocument
    .Styles("HZI List Letter").Priority = 21
    .Styles("HZI Listing").Priority = 22
    .Styles("HZI Listing green").Priority = 23
    .Styles("HZI Numbering").Priority = 31
    .Styles("HZI Numbering green").Priority = 32
    .Styles("HZI Pic Title").Priority = 16
    .Styles(stand & "HZI Strd").Priority = 10
    .Styles("HZI Strd Center").Priority = 11
    .Styles("HZI Strd Left").Priority = 12
    .Styles("HZI Strd Green").Priority = 13
    .Styles("HZI Strd D-Red").Priority = 14
    .Styles("HZI Strd Red").Priority = 14
    .Styles("HZI Strd Blue").Priority = 15
    '.Styles("Tabellenraster;HZI Table Grid").Priority = 43
    .Styles("HZI Table Text").Priority = 41
    .Styles("HZI Table Text Center").Priority = 42
    .Styles("HZI Table Text green").Priority = 44
    .Styles("HZI Table Text small").Priority = 43
    .Styles("HZI Table Title").Priority = 40
    .Styles(|fffd|berschr1 & "HZI |fffd|1_H1").Priority = 50
    .Styles(|fffd|berschr2 & "HZI |fffd|2_H2").Priority = 51
    .Styles(|fffd|berschr3 & "HZI |fffd|3_H3").Priority = 52
    .Styles(|fffd|berschr4 & "HZI |fffd|4_H4").Priority = 53
End With

 
'die Optionen werden so eingestellt das nur noch die HZI-Vorlagen angezeigt werden
ThisDocument.FormattingShowNextLevel = False
ThisDocument.FormattingShowUserStyleName = True
ThisDocument.FormattingShowFilter = wdShowFilterStylesAvailable 'anzeigen im aktuellen Dokument
ThisDocument.StyleSortMethod = wdStyleSortRecommended 'sortieren wie empfohlen
Application.TaskPanes(wdTaskPaneFormatting).Visible = True 'das Fenster mit den Formatvorlagen wird angezeigt
Exit Sub

Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro welches beim |fffd|ffnen des Dokumentes ausgef|fffd|hrt wird ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    Application.TaskPanes(wdTaskPaneFormatting).Visible = True 'das Fenster mit den Formatvorlagen wird angezeigt
End Sub

Attribute VB_Name = "mod_test"
Sub hallo()

If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard"
    |fffd|berschr = "|fffd|berschrift "
Else
    stand = "Normal"
    |fffd|berschr = "Heading "
End If

End Sub

Attribute VB_Name = "tabelle"
Attribute VB_Base = "0{76C2E0F0-C1F0-475E-B4E8-9B5A4B09C120}{0903B8BF-1182-4DD6-8933-37D9DE7F8602}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False






Public gesch|fffd|tzt As Variant
Public bezspalte As Variant
Public beztabelle As Variant

Private Sub CommandButton1_Click()
    Dim rows, columns, titel
    
    Call fehler
    
    If OptionButton1.Value = True Then
    bezspalte = "Descr."
    beztabelle = "Table"
    ElseIf OptionButton2.Value = True Then
    bezspalte = "|fffd|bers."
    beztabelle = "Tabelle"
    End If
    
    
    
    rows = TextBox1.Text
    columns = TextBox2.Text
    titel = TextBox3.Text
   
    If titel = "" Then
    MsgBox "field Title is mandatory"
    'tabelle.Show
    Exit Sub
    
    ElseIf rows = "" Then
    MsgBox "field Rows is mandatory"
    'tabelle.Show
    Exit Sub
        
    ElseIf columns = "" Then
    MsgBox "field Columns is mandatory"
    'tabelle.Show
    Exit Sub
    Else
    End If
    
    
        Selection.TypeParagraph
        Selection.TypeParagraph
        Selection.MoveUp Unit:=wdLine, Count:=1
    ThisDocument.Tables.Add Range:=Selection.Range, NumRows:=2, NumColumns:= _
        1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
    With Selection.Tables(1)
       ' If .Style <> "Tabellengitternetz" Then
       '     .Style = "Tabellengitternetz"
       ' End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True
    End With
    With Selection.Tables(1)
        .TopPadding = CentimetersToPoints(0)
        .BottomPadding = CentimetersToPoints(0.1)
        .LeftPadding = CentimetersToPoints(0)
        .RightPadding = CentimetersToPoints(0)
        .Spacing = 0
        .AllowPageBreaks = True
        .AllowAutoFit = True
    End With
     
    
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.Cells.Split NumRows:=1, NumColumns:=columns, MergeBeforeSplit:=False

    Selection.Style = ThisDocument.Styles("HZI Table Title")
    Selection.Shading.BackgroundPatternColor = wdColorGray125
    
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    Selection.Delete Unit:=wdWord, Count:=-1
    
    i = 1
    For i = 1 To columns
       
    Selection.TypeText Text:=bezspalte & i '& ""
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Next
    
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.InsertRows rows
    Selection.Style = ThisDocument.Styles("HZI Table Text")
    Selection.Shading.BackgroundPatternColor = wdColorAutomatic
    Selection.MoveUp Unit:=wdLine, Count:=2
    
    
    CaptionLabels.Add Name:=beztabelle
    Selection.InsertCaption Label:=beztabelle, TitleAutoText:="", Title:="", _
        Position:=wdCaptionPositionAbove, ExcludeLabel:=0
    Selection.MoveLeft Unit:=wdWord, Count:=2, Extend:=wdExtend
    Selection.Cut
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.PasteAndFormat (wdPasteDefault)

    Selection.TypeText Text:=": " & titel
    Selection.Style = ThisDocument.Styles("Standard dunkelrot")
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.MoveUp Unit:=wdLine, Count:=1
    Selection.Delete Unit:=wdCharacter, Count:=1
    Selection.MoveDown Unit:=wdLine, Count:=1
    'Selection.MoveLeft Unit:=wdWord, Count:=2
    Selection.EndKey Unit:=wdRow, Extend:=True
    Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
    Selection.rows.HeadingFormat = wdToggle
    Selection.MoveDown Unit:=wdLine, Count:=1
    
    Unload Me
    Selection.MoveDown Unit:=wdLine, Count:=-2
    Selection.MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend
    On Error GoTo 2
    Selection.rows.HeadingFormat = True
    GoTo 3
2
    On Error GoTo 4
    Selection.MoveDown Unit:=wdLine, Count:=2
    Selection.MoveDown Unit:=wdLine, Count:=-2
     Selection.MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend
     Selection.rows.HeadingFormat = True
3
    
    Selection.MoveDown Unit:=wdLine, Count:=-1
    
    ActiveWindow.ActivePane.View.ShowAll = True     'Enter werden angezeigt
    ThisDocument.ActiveWindow.View.TableGridlines = True 'Rahmenlinien werden angezeigt
4

End Sub

Private Sub CommandButton2_Click()
    Unload Me
        
End Sub


Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  If KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
    Else
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
    
   
End Sub
Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  If KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
    Else
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
   
End Sub

Sub fehler()
On Error GoTo 1

ThisDocument.Unprotect
gesch|fffd|tzt = "ja"
1
End Sub

Private Sub UserForm_Initialize()
If Left(System.LanguageDesignation, 7) = "Deutsch" Then
    stand = "Standard;"
    |fffd|berschr1 = "|fffd|berschrift 1;"
    |fffd|berschr2 = "|fffd|berschrift 2;"
    |fffd|berschr3 = "|fffd|berschrift 3;"
    |fffd|berschr4 = "|fffd|berschrift 4;"
Else
    stand = "Normal,"
    |fffd|berschr1 = "Heading 1,"
    |fffd|berschr2 = "Heading 2,"
    |fffd|berschr3 = "Heading 3,"
    |fffd|berschr4 = "Heading 4,"
End If
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    
    Dim Sprache As Variant
    
    Sprache = ThisDocument.Styles(stand & "HZI Strd").LanguageID
    If Sprache = wdSwissGerman Then
        Me.OptionButton2.Value = True
    Else
        Me.OptionButton1.Value = True
    End If
End Sub
Attribute VB_Name = "tabstop"
Attribute VB_Base = "0{5C8DA666-06EA-4191-9DEB-FF66953953B9}{0E675318-41A1-4A62-B653-4F0E568BD6D3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
    Dim rows, columns
    
On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If
    
    
    
    rows = TextBox1.Text
    columns = TextBox2.Text
   
    Selection.TypeParagraph
    ThisDocument.Tables.Add Range:=Selection.Range, NumRows:=rows, NumColumns:= _
        columns ', DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
    With Selection.Tables(1)
       ' If .Style <> "Tabellengitternetz" Then
       '     .Style = "Tabellengitternetz"
       ' End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=columns, Extend:=wdExtend
    Selection.MoveDown Unit:=wdLine, Count:=rows - 1, Extend:=wdExtend
    Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderHorizontal).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderVertical).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
    Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    Selection.Style = ThisDocument.Styles("HZI Strd Left")
    Selection.FONT.Size = 11
    Selection.MoveUp Unit:=wdLine, Count:=1
    ThisDocument.ActiveWindow.View.TableGridlines = True  'zeigt die "unsichtbaren" Rasterlinien an
    Unload Me
End Sub

Private Sub CommandButton2_Click()
    Unload Me
        
End Sub

Private Sub TextBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  If KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
    Else
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
    
   
End Sub
Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
  If KeyAscii < 47 Or KeyAscii > 58 Then
        MsgBox "use numbers"
    Else
    End If
  
  Select Case KeyAscii
        Case 48 To 57
        Case Else
            KeyAscii = 0
    End Select
    
   
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "y_fehlermeldung_40351"
Attribute VB_Base = "0{866D9765-499E-4D42-9021-39E9F2417901}{8DE74647-6699-404B-882E-3E70D7270605}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
    Unload Me
End Sub
Attribute VB_Name = "z_Ablauf"
Attribute VB_Base = "0{6AE7185F-38BC-456A-8F73-39E7C74C7E89}{C2B4D465-4AC6-4D59-B62D-793BD609BFB3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub

Private Sub UserForm_Initialize()


    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. In order to be able to use the Macros, choose [Enable Content]"
        Label2.Caption = "2. Use [Rev00] under [HZI Commands] and fill out the green fields in the mask as minimum. By pressing [OK], the new document will be saved on the Desktop automatically. From there, it can be saved to PIRS" & vbCrLf & vbCrLf _
        & "All fields in the header, footer and title sheet will be filled in CORRECTLY"
        Label3.Caption = "3. Copy the text from the old document into the new document, after the table of contents. The editing HAS TO BE RESTRICTED FOR THIS. Else, the old and corrupt styles will be transfered to the new document => Review => Restrict Editing => Yes, Start Enforcing Protection (or press Ctrl+Shift+S)"
        Label4.Caption = "4. When copying, the last Enter-Mark shall not be selected, since information about the header/footer is included in it. If it is also selected, the wrong/old header might be copied into the new document as well"
        Label5.Caption = "5. After copying the text into the new document, us the HZI-Styles to format the new document"
        Label6.Caption = "6. in order to use all the bold style or of colours need to be applied to the text, stop the protection of the document => Review => Restrict Editing => Stop Protection (or press Ctrl+Shift+S)"
        Label7.Caption = "7. Table, picture frame and Tab Stops (=> invisible Table) shall be added by using the buttons under HZI Commands"
        Label8.Caption = "8. after copying text into the table, check the style of the text => use Table Title and Table Text as style in the Table"
        Label9.Caption = "9. use Cross-Reverences under Reverences in order to rever to Tables, Pictures or Chapters"
        Label10.Caption = "10. the instructions on the first page need to be deleted"
        
        CommandButton1.Caption = "Close"
       
    End If
End Sub
Attribute VB_Name = "z_Anleitung2"
Attribute VB_Base = "0{5C29E72E-2F56-4037-B7D7-4CB2366B33BA}{1AF0285E-FFC1-47A6-BE57-3A1C2D08E7D8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Private Sub CommandButton1_Click()
    Unload Me
End Sub

Private Sub CommandButtonS_Click()
    
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Deutsch" Then
        Label5.Caption = "Click according area for more information"
        Label6.Caption = "Create Revisions"
        Label1.Caption = "Review Mode"
        Label2.Caption = "Restrict Editing"
        Label8.Caption = "Restrict available styles (if document is protected)"
        Label9.Caption = "General application to generate new Documents"
        ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch"
        CommandButtonS.Caption = "Deutsch"
        CommandButton1.Caption = "Close"
    ElseIf ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label5.Caption = "Bereich anklicken f|fffd|r weitere Informationen"
        Label6.Caption = "Revisionieren"
        Label1.Caption = "|fffd|berarbeitungsmodus"
        Label2.Caption = "Dokumente Sch|fffd|tzen"
        Label8.Caption = "Formatvorlagen einschr|fffd|nken (bei gesch|fffd|tztem Dokument)"
        Label9.Caption = "Generelle Anleitung bei neu Erstellung von Dokument"
        ThisDocument.CustomDocumentProperties("Sprache").Value = "Deutsch"
        CommandButtonS.Caption = "English"
        CommandButton1.Caption = "Schliessen"
    End If
        
End Sub

Private Sub Image1_Click()
    Unload Me
    z_sch|fffd|tzen.Show
End Sub

Private Sub Image2_Click()
    Unload Me
    z_formatvorlage.Show
End Sub

Private Sub Label1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub Label10_Click()

adresse = "http://intranet.inova.vonroll.ch/Rules%20and%20Tools/Projekthilfsmittel/Technische%20Vorschriften/Document%20Library/-_00_Wordbenutzung%20bei%20HZI,%20Tech.%20Dokumente.docm"
Set Ie = CreateObject("InternetExplorer.Application")
Ie.Visible = True
Ie.navigate adresse

End Sub
Private Sub Label2_Click()
    Unload Me
    z_sch|fffd|tzen.Show
End Sub
Private Sub Label4_Click()
    Unload Me
    z_revision1_generell.Show
End Sub
Private Sub Label6_Click()
    Unload Me
    z_revision1_generell.Show
End Sub
Private Sub Label7_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub
Private Sub Label8_Click()
    Unload Me
    z_formatvorlage.Show
End Sub
Private Sub Label9_Click()
    Unload Me
    z_Ablauf.Show
End Sub

Private Sub UserForm_Initialize()

On Error GoTo Testmakro_Err
Testmakro_Err:
If Not Err.Number = 0 Then  'wird nur durchlaufen wenn eine Fehlermeldung besteht
    If Err.Number = "40351" Then    'bei dieser fehlermeldung ist oft das "normal.dot" defekt
        y_fehlermeldung_40351.Show
        Err.Clear
        End     'makro wird beendet
    Else
        MsgBox "im Makro ist ein Fehler aufgetreten. Es kann sein das Funktionen eingeschr|fffd|nkt sind. Word oder Computer neu starten" & vbCrLf & vbCrLf & _
            "there has been a mistake in the Macro. Possibly some functions are limited. Start Word or Computer anew"
    End If
End If

        Label5.Caption = "Bereich anklicken f|fffd|r weitere Informationen"
        Label6.Caption = "Revisionieren"
        Label1.Caption = "|fffd|berarbeitungsmodus"
        Label2.Caption = "Dokumente Sch|fffd|tzen"
        Label8.Caption = "Formatvorlagen einschr|fffd|nken (bei gesch|fffd|tztem Dokument)"
        CommandButtonS.Caption = "English"
       x = ThisDocument.CustomDocumentProperties(2).Value
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label5.Caption = "Click according area for more information"
        Label6.Caption = "Create Revisions"
        Label1.Caption = "Review Mode"
        Label2.Caption = "Restrict Editing"
        Label8.Caption = "Restrict available styles (if document is protected"
        CommandButtonS.Caption = "Deutsch"
        CommandButton1.Caption = "Close"
    End If
    
End Sub
Attribute VB_Name = "z_formatvorlage"
Attribute VB_Base = "0{22F230C7-0C56-41E4-B03B-140A9707346F}{AB2D1702-6425-4CA3-86BA-C3B682024715}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub


Private Sub CommandButton2_Click()
    Unload Me
    z_formatvorlage2.Show
End Sub

Private Sub UserForm_Initialize()

    Label1.Caption = "1. Unter [|fffd|berpr|fffd|fen] folgendes Symbol klicken"
    Label2.Caption = "2. Anschliessend erscheint folgende Maske"
    Label3.Caption = "3. ist der Schutz noch NICHT aktiviert, k|fffd|nnen unter [Einstellungen] die Formatvorlagen gew|fffd|hlt werden welche NACH dem Sch|fffd|tzen des Dokumentes noch w|fffd|hlbar sind"
    
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. Choose [Review], after click symbol [Restrict Editing]"
        Label2.Caption = "2. After, the following screen apears"
        Label3.Caption = "3. if the protection is not yet activated, click [Settings] in order to choose the Styles that might be used in the document"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Choose default Styles"
    End If
End Sub
Attribute VB_Name = "z_formatvorlage2"
Attribute VB_Base = "0{CE34CB56-E2D2-444B-BAAB-477A2EF7595D}{B437536C-E7D1-4208-8A88-8CC6CDD9D586}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
    Unload Me
    z_formatvorlage.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_formatvorlage_standard.Show
End Sub

Private Sub UserForm_Initialize()

    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. Mark the box at 1, 2. Press [None], 3. choose the styles that shall be available"
        Label2.Caption = "IMPORTANT: after choosing [OK] press [No]. Else the styles in the header/footer will be over written"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Default HZI Styles"
    End If
            
End Sub
Attribute VB_Name = "z_formatvorlage_standard"
Attribute VB_Base = "0{2168F4DD-0BB0-4CAC-8F7A-ECD6113A4A91}{DE05195A-5CBD-457D-A530-F3D64D6751DE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Private Sub CommandButton1_Click()
    Unload Me
    z_formatvorlage.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_sch|fffd|tzen_aufheben.Show
End Sub

Private Sub UserForm_Initialize()
    Label1.Caption = "Unten aufgelistete Formatvorlagen werden bei HZI standardm|fffd|ssig verwendet"
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "The styles listed below are used on default at HZI"
        CommandButton1.Caption = "Close"
    End If
    
End Sub
Attribute VB_Name = "z_revision1_generell"
Attribute VB_Base = "0{E760A86D-A649-4BE2-9C45-7F28806A5D48}{22AC4351-1556-4B62-B0F4-30684B08E40A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton2_Click()
    Unload Me
    z_revision2_eigenschaften.Show
    
End Sub

Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub

Private Sub Label1_Click()

End Sub

Private Sub UserForm_Initialize()
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. In order to generate a new document, press the revision button (Rev00) which is found at [HZI Commands]. After that the fields need to be filled in (green = required field). By clicking OK, the document will be safed on the desktop. From there it can be stored in PIRS."
        Label2.Caption = "2. Additional revisions can be created by pressing the [Rev01 and higher]-Button"
        Label3.Caption = "3. New documents might also be generated without the revision button. The data for the Title-Sheet and Header needs to be filled out manually in this case. All blue-green text needs to be replaced"
        Label4.Caption = "4. in order to be albe to communicate with PIRS, the information will be stored under Advanced Properties. These can be changed manually"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Change Advanced Properties manually"
    End If
            
End Sub
Attribute VB_Name = "z_revision2_eigenschaften"
Attribute VB_Base = "0{67A2F7BD-640E-4FDC-A068-9F9B9FA9B5C5}{99AF7E07-E255-43C3-9CD2-292D1A64FEF6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
    z_revision1_generell.Show
End Sub

Private Sub UserForm_Initialize()
    If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Change Advanced Properties manually"
        Label2.Caption = "1. the values that are entered in the revision mask will be safed in the Advanced Properties. The information in the Advanced Properties is also used to communicate with PIRS "
        Label3.Caption = "File => Info => Properties => Advanced Properties"
        Label4.Caption = "2. choose the according name (1), change the Value (2) and press add (3). The value (2)shall not be empty, use Space instead"
        CommandButton1.Caption = "Close"
       ' CommandButton2.Caption = "Change Advanced Properties manually"
    End If
End Sub


Attribute VB_Name = "z_sch|fffd|tzen"
Attribute VB_Base = "0{36DA9F57-18D9-4A9F-B4B2-1A48E95A8458}{985EB3BC-DD6D-4B17-A622-339F0405181B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_sch|fffd|tzen_aufheben.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. Choose the symbol [Restrict Editing] under [Review]"
        Label2.Caption = "2. The following screen will apear"
        Label3.Caption = "3. mark the box at 1., after choose [Yes, Start Enforcing Protection] => safe without password => choose [Available styles] to use them for formatting"
        Label4.Caption = "You can also change the protection by pressing [Ctrl+Shift+S]"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Stop Protection"
    End If
End Sub
Attribute VB_Name = "z_sch|fffd|tzen_aufheben"
Attribute VB_Base = "0{BF3144A6-3FAA-4E5A-9E3E-04F0F0B91EE1}{1EAB446C-093E-46C3-820E-59A778E35FB1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_sch|fffd|tzen.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. Choose the symbol [Restrict Editing] under [Review]"
        Label2.Caption = "2. The following screen will apear"
        Label3.Caption = "3. Choose [Stop Protection]"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Enforce Protection"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten2_kommentar_bear"
Attribute VB_Base = "0{A9186D24-5965-4A25-B0BE-042C4477DC3A}{961C8D89-773A-4C57-92B8-B8BB3E4C76CE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten2_kommentar.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Move the mouse over the comment area and stay there for a short periode of time => the comment will apear (in example green area)"
        CommandButton1.Caption = "Close"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten1"
Attribute VB_Base = "0{3AE40F47-D843-46E4-98D8-A0410D963BE6}{0D37CD9B-2D3B-48E0-A15A-FF92FB4EF264}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    Unload Me
    z_Anleitung2.Show
End Sub

Private Sub Label1_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_akti.Show
End Sub

Private Sub Label12_Click()
    Unload Me
    z_|fffd|berarbeiten2_kommentar.Show
End Sub

Private Sub Label15_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_akti.Show
End Sub

Private Sub Label3_Click()
    Unload Me
    z_|fffd|berarbeiten3_markup.Show
End Sub

Private Sub Label4_Click()
    Unload Me
    z_|fffd|berarbeiten4_|fffd|nderungs.Show
End Sub

Private Sub Label5_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_pfe.Show
End Sub
Private Sub Label6_Click()
    Unload Me
    z_|fffd|berarbeiten5_|fffd|nderungen.Show
    
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "1. At HZI, changes between revisions shall be made in the [Track Changes]-Mode. Like this it will always be possible to track the changes. In adition, it is possible to make only certain changes visible, for example according to author"
        Label2.Caption = "2. choose [Review] to find the symbols as listed below. they are used for the Tracking Mode. Click on areas below for aditional information"
       
        CommandButton1.Caption = "Close"
        'CommandButton2.Caption = "Enforce Protection"
    End If
End Sub

Attribute VB_Name = "z_|fffd|berarbeiten2_kommentar"
Attribute VB_Base = "0{A6658A35-EB67-4790-A5DD-87428B3F7F23}{FF3E2FFE-66CB-465C-91DC-A8452B1DBFAB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_|fffd|berarbeiten2_kommentar_anz.Show
End Sub

Private Sub CommandButton3_Click()
    Unload Me
    z_|fffd|berarbeiten2_kommentar_bear.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Adds a new comment at the position of the cursor. Whole words or Paragraphs might be selected as well"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Show Comment"
        CommandButton3.Caption = "Edit Comment"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten2_kommentar_anz"
Attribute VB_Base = "0{7475F087-7E01-4A90-9249-118951C448CF}{CC56D79E-D2D3-4ABD-A64A-341DBE34C654}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten2_kommentar.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Move the mouse over the comment area and stay there for a short periode of time => the comment will apear (in example green area)"
        CommandButton1.Caption = "Close"
    End If
End Sub

Attribute VB_Name = "z_|fffd|berarbeiten3_markup"
Attribute VB_Base = "0{7DE5BABD-001C-419E-8028-4DC318AE4770}{55C6D0CB-9BB4-4FEB-BE08-56C245CF54D8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
    
End Sub
Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "[Show Markups] enables you to choose which changes shall be shown in the document. This option is especially interesting if there are different Reviewers"
        CommandButton1.Caption = "Close"
    End If
End Sub

Attribute VB_Name = "z_|fffd|berarbeiten3_|fffd|nder_akti"
Attribute VB_Base = "0{81C8EA43-5F95-42B1-BEBB-DCAD9F0DCE8F}{75E6856E-EEE4-4355-8B16-C8A4D255D822}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Click on symbol in oder to activate the Track Changes Mode"
        Label2.Caption = "Text that was inserted will be underlined, deleted text will be crossed out. Colour according to Author"
        CommandButton1.Caption = "Close"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten3_|fffd|nder_benutzer"
Attribute VB_Base = "0{6AFFDE3B-A5E3-4479-BDA4-07796DAB1890}{D617CDDC-CA59-4ACF-8DD2-74438EBE8551}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_pfe.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "User Name = FirstName LastName, Initials = HZI-Initials"
        CommandButton1.Caption = "Close"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten3_|fffd|nder_option"
Attribute VB_Base = "0{29ABC24A-D48E-4A16-9DA3-DD493A00DE4F}{ACC063DA-F45A-48AD-A183-A647EDB4D21A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_pfe.Show
    
End Sub

Private Sub UserForm_Click()
    
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "Adapt the Settings as shown above"
        CommandButton1.Caption = "Close"
    End If
End Sub

Attribute VB_Name = "z_|fffd|berarbeiten3_|fffd|nder_pfe"
Attribute VB_Base = "0{00AC36F1-958D-4A73-A866-8A6D75152319}{7139B423-EA6C-4264-BAF9-67F4F29B8F5C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub CommandButton2_Click()
    Unload Me
    z_|fffd|berarbeiten3_|fffd|nder_benutzer.Show
   ' z_|fffd|berarbeiten3_|fffd|nder_option.Show vbModeless
End Sub

Private Sub CommandButton3_Click()
    Unload Me
   ' z_|fffd|berarbeiten3_|fffd|nder_option.Show vbModeless
    z_|fffd|berarbeiten3_|fffd|nder_option.Show
End Sub
Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "The Options and the username might be changed"
        CommandButton1.Caption = "Close"
        CommandButton2.Caption = "Change Username"
        CommandButton3.Caption = "Change Options"
    End If
End Sub
Attribute VB_Name = "z_|fffd|berarbeiten4_|fffd|nderungs"
Attribute VB_Base = "0{E82B4197-13DB-4C4B-A7CE-E221FD5DF3E7}{3CEE51DB-0030-4044-B833-7BD15B12B20C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "The Reviewing Pane can be shown horizontal or vertical"
        Label2.Caption = "The Pane shows all the changes (Deleted,Inserted,Comments) that have been made. It also shows the Reviewer and the date of change. If you put the cursor in the according field, the changes on the page are selected automatically"
        CommandButton1.Caption = "Close"
    End If
End Sub

Attribute VB_Name = "z_|fffd|berarbeiten5_|fffd|nderungen"
Attribute VB_Base = "0{6149E3DE-8E37-4AB9-AEEC-EA9ABC26628A}{A16EEADA-B495-4AF5-9E44-718AF545EC30}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
    Unload Me
    z_|fffd|berarbeiten1.Show
End Sub

Private Sub UserForm_Initialize()
     If ThisDocument.CustomDocumentProperties("Sprache").Value = "Englisch" Then
        Label1.Caption = "The Symbols on the left are used to navigate forth and back, and to accept or reject the Changes"
        Label2.Caption = "if the arrow is pressed, there is an option to accept or reject all the changes in the document at one time"
        CommandButton1.Caption = "Close"
    End If
End Sub

' InQuest injected base64 decoded content
' _Z'm
' *':t
' 't	i
' zPhw$
' /j)ZnW

INQUEST-PP=macro
