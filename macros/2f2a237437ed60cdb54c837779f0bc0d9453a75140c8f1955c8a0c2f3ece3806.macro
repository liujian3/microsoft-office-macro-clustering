Attribute VB_Name = "ENCU"
Attribute VB_Base = "0{9805035D-1187-4DF3-BF9B-60F37E5664C1}{58356ADD-E91D-489D-B119-56ED64C56DCC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
    FORMATOSELECC = 5
    If OptionButton1.Value = True Then FORMATOSELECC = 1
    If OptionButton2.Value = True Then FORMATOSELECC = 2
    If OptionButton3.Value = True Then FORMATOSELECC = 3
    If OptionButton4.Value = True Then FORMATOSELECC = 4
    ENCU.Hide
End Sub
Private Sub CommandButton2_Click()
    FORMATOSELECC = 0
    ENCU.Hide
End Sub
Private Sub CommandButton3_Click()
    FORMATOSELECC = 5
    ENCU.Hide
End Sub
Private Sub UserForm_Activate()
   
    IDTRAB.Text = NIDENT
    NOMBRES.Text = NNOMBRE
    
    OptionButton1.Value = False
    OptionButton1.Enabled = False
    TextBox1.Value = "COMPLETADO"
    
    If DATESTGR Then
        OptionButton4.Value = True
        OptionButton4.Enabled = True
        TextBox4.Value = "PENDIENTE"
    Else
        OptionButton4.Value = False
        OptionButton4.Enabled = False
        TextBox4.Value = "COMPLETADO"
    End If
    
    If DATEXTRGR Then
        OptionButton3.Value = True
        OptionButton3.Enabled = True
        TextBox3.Value = "PENDIENTE"
    Else
        OptionButton3.Value = False
        OptionButton3.Enabled = False
        TextBox3.Value = "COMPLETADO"
    End If
    
    If DATINTRGR Then
        OptionButton2.Value = True
        OptionButton2.Enabled = True
        TextBox2.Value = "PENDIENTE"
    Else
        OptionButton2.Value = False
        OptionButton2.Enabled = False
        TextBox2.Value = "COMPLETADO"
    End If
    
End Sub
Attribute VB_Name = "Hoja10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "M|fffd|dulo1"
Public NTIPOCAR
Public NDIA
Public NMES
Public NANO
Public NIDENT
Public NNOMBRE
Public DATGENGR
Public DATINTRGR
Public DATEXTRGR
Public DATESTGR
Public FORMATOSELECC
Public DIRACT

Sub BORRARDATOS()
    
    Dim Mensaje, Estilo, T|fffd|tulo, Ayuda, Ctxt, Respuesta, MiCadena
    Mensaje = "|fffd|EST|fffd| SEGURO? " + Chr(13) + Chr(13) + "Esta instrucci|fffd|n graba el archivo actual, " + Chr(13) + "borra los datos de todas las inspecciones," + Chr(13) + "y le solicita un nombre y ruta " + Chr(13) + "para iniciar un nuevo archivo "
    Estilo = vbYesNo + vbExclamation + vbDefaultButton2
    T|fffd|tulo = " ADVERTENCIA"
    Respuesta = MsgBox(Mensaje, Estilo, T|fffd|tulo, Ayuda, Ctxt)
    If Respuesta = vbYes Then
        GoTo BORRAR
    Else
        Exit Sub
    End If

BORRAR:
    Application.ScreenUpdating = False
    ActiveWorkbook.Save
    
    Sheets("BDRtasA").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 2 Then GoTo 100
        Range(Cells(ndata, 1), Cells(3, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select
100:
    Sheets("BDRtasB").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 2 Then GoTo 200
        Range(Cells(ndata, 1), Cells(3, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select

200:
    Sheets("BDRtasEx").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 2 Then GoTo 300
        Range(Cells(ndata, 1), Cells(3, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select

300:
    Sheets("BDRtasEstr").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 2 Then GoTo 400
        Range(Cells(ndata, 1), Cells(3, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select

400:
    'Sheets("AuxResumen").Select
    'ActiveCell.SpecialCells(xlLastCell).Select
    'ndata = ActiveCell.Row
    'If ndata = 1 Then GoTo 500
    '    Range(Cells(ndata, 1), Cells(2, 1)).Select
    '    Selection.EntireRow.Delete
    '    Range("A1").Select

500:
    Sheets("BDRDG").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 2 Then GoTo 510
        Range(Cells(ndata, 1), Cells(3, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select
        
510:
    Sheets("DatosRPS").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ndata = ActiveCell.Row
    If ndata = 1 Then GoTo 600
        Range(Cells(ndata, 1), Cells(2, 1)).Select
        Selection.EntireRow.Delete
        Range("A1").Select
        
        
        
600:

    Sheets("DatGen").Select
    Application.Run "NuevoRegDATGEN"
    
    Sheets("ForA").Select
    Application.Run "NuevoRegINTRAA"
    
    Sheets("ForB").Select
    Application.Run "NuevoRegINTRAB"
    
    Sheets("ForEx").Select
    Application.Run "NuevoRegEXTRAL"
    
    Sheets("ForEstr").Select
    Application.Run "NuevoRegESTRES"

    Application.ScreenUpdating = True
    Sheets("PsicIn").Select
    Range("D4").Select
    
    Do
        FNAME = Application.GetSaveAsFilename
    Loop Until FNAME <> False
    
    ActiveWorkbook.SaveAs Filename:=FNAME & ".xls", FileFormat:=xlExcel8

End Sub
Sub NuevoRegDATGEN()
    Range("Q2").Value = Range("s2").Value
    Range( _
        "D5:F5,D7:F7,D9:I9,D11,D15,D17,D28,D42:I42,D45:I45,D46:I46,D48,D58,D63,D68:I68,D69:I69,D71,D73:I73,D75,D81,D83:I83,D87,D95,D97,d105,e105,f105,d107:g107" _
        ).ClearContents
    ActiveWindow.ScrollRow = 1
    Range("D5").Select
End Sub
Sub NuevoRegINTRAB()
    Range("Q2").Value = Range("s2").Value
    Range( _
        "H3:J4,E9:E20,E27:E29,E34:E38,E44:E45,E51:E56,E62:E68,E74:E75,E81:E83,E89:E92,E99,E105:E107,E113:E118,E125:E131,E136:E142,E149:E153,E159:E163,E170:E179,e186,E194:E202" _
        ).ClearContents
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
End Sub
Sub NuevoRegINTRAA()
    Range("Q2").Value = Range("s2").Value
    Range( _
        "H3:J4,E9:E20,E27:E29,E34:E39,E44:E45,E50:E56,E61:E68,E75:E83,E89:E93,E101:E107,E113:E115,E124:E136,E144:E157,E164:E168,E175:E185,E192,E200:E208,E216,E224:E232" _
        ).ClearContents
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
End Sub
Sub NuevoRegEXTRAL()
    Range("Q2").Value = Range("s2").Value
    Range("H3:J4,E9:E21,E29:E42,E48:E51").ClearContents
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
End Sub
Sub NuevoRegESTRES()
    Range("Q2").Value = Range("s2").Value
    Range("H3:J4,E9:E39").ClearContents
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
End Sub
Sub RevisarRegistroDATGEN()
    'PARA RECUPERAR INFORMACI|fffd|N DE REGISTRO EN DATOS GENERALES
    On Error GoTo 1
    MAXIM = Range("S2").Value
    NREG = InputBox("Numero de registro a revisar", "DATOS GENERALES")
    Range("Q1").Value = NREG + 1
    If NREG < 1 Then Exit Sub
    If Range("Q1").Value > MAXIM Then Exit Sub
    Range("Q2").Value = NREG
    Application.Run "RecupFormulasDatGen"
1:
    ActiveWindow.ScrollRow = 1
    Range("D2").Select
End Sub
Sub RevisarRegistroINTRAA()
    'PARA RECUPERAR INFORMACI|fffd|N DE REGISTRO EN INTRALABORAL FORMA A
    On Error GoTo 1
    MAXIM = Range("S2").Value
    NREG = InputBox("Numero de registro a revisar", "INTRALABORAL FORMA A")
    Range("Q1").Value = NREG + 1
    If NREG < 1 Then Exit Sub
    If Range("Q1").Value > MAXIM Then Exit Sub
    Range("Q2").Value = NREG
    Application.Run "RecuperarRegPreviosFormA"
1:
    ActiveWindow.ScrollRow = 1
    Range("E2").Select
End Sub
Sub RevisarRegistroINTRAB()
    'PARA RECUPERAR INFORMACI|fffd|N DE REGISTRO EN INTRALABORAL FORMA B
    On Error GoTo 1
    MAXIM = Range("S2").Value
    NREG = InputBox("Numero de registro a revisar", "INTRALABORAL FORMA B")
    Range("Q1").Value = NREG + 1
    If NREG < 1 Then Exit Sub
    If Range("Q1").Value > MAXIM Then Exit Sub
    Range("Q2").Value = NREG
    Application.Run "RecuperarRegPreviosFormB"
1:
    ActiveWindow.ScrollRow = 1
    Range("E2").Select
End Sub
Sub RevisarRegistroEXTRALAB()
    'PARA RECUPERAR INFORMACI|fffd|N DE REGISTRO EN FORMULARIO EXTRALABORAL
    On Error GoTo 1
    MAXIM = Range("S2").Value
    NREG = InputBox("Numero de registro a revisar", "RIESGO EXTRALABORAL")
    Range("Q1").Value = NREG + 1
    If NREG < 1 Then Exit Sub
    If Range("Q1").Value > MAXIM Then Exit Sub
    Range("Q2").Value = NREG
    Application.Run "RecuperarRegPreviosEXTRALAB"
1:
    ActiveWindow.ScrollRow = 1
    Range("E2").Select
End Sub
Sub RevisarRegistroESTRES()
    'PARA RECUPERAR INFORMACI|fffd|N DE REGISTRO EN FORMULARIO ESTRES
    On Error GoTo 1
    MAXIM = Range("S2").Value
    NREG = InputBox("Numero de registro a revisar", "EVALUACI|fffd|N S|fffd|NTOMAS DE ESTRES")
    Range("Q1").Value = NREG + 1
    If NREG < 1 Then Exit Sub
    If Range("Q1").Value > MAXIM Then Exit Sub
    Range("Q2").Value = NREG
    Application.Run "RecuperarRegPreviosESTRES"
1:
    ActiveWindow.ScrollRow = 1
    Range("E2").Select
End Sub
Sub RecupFormulasDatGen()
    Range("D5").FormulaR1C1 = "=R[-1]C[12]"
    Range("E5").FormulaR1C1 = "=R[-1]C[12]"
    Range("F5").FormulaR1C1 = "=R[-1]C[12]"
    Range("D7").FormulaR1C1 = "=R[-2]C[18]"
    Range("D9").FormulaR1C1 = "=R[-3]C[18]"
    Range("D11").FormulaR1C1 = "=R[-4]C[18]"
    Range("D15").FormulaR1C1 = "=R[-7]C[18]"
    Range("D17").FormulaR1C1 = "=R[-8]C[18]"
    Range("D28").FormulaR1C1 = "=R[-18]C[18]"
    Range("D42").FormulaR1C1 = "=R[-31]C[18]"
    Range("D45").FormulaR1C1 = "=R[-33]C[18]"
    Range("D46").FormulaR1C1 = "=R[-33]C[18]"
    Range("D48").FormulaR1C1 = "=R[-34]C[18]"
    Range("D58").FormulaR1C1 = "=R[-43]C[18]"
    Range("D63").FormulaR1C1 = "=R[-47]C[18]"
    Range("D68").FormulaR1C1 = "=R[-51]C[18]"
    Range("D69").FormulaR1C1 = "=R[-51]C[18]"
    Range("D71").FormulaR1C1 = "=R[-52]C[18]"
    Range("D73").FormulaR1C1 = "=R[-53]C[18]"
    Range("D75").FormulaR1C1 = "=R[-54]C[18]"
    Range("D81").FormulaR1C1 = "=R[-59]C[18]"
    Range("D83").FormulaR1C1 = "=R[-60]C[18]"
    Range("D87").FormulaR1C1 = "=R[-63]C[18]"
    Range("D95").FormulaR1C1 = "=R[-70]C[18]"
    Range("D97").FormulaR1C1 = "=R[-71]C[18]"
    Range("D105").FormulaR1C1 = "=R[-78]C[12]"
    Range("E105").FormulaR1C1 = "=R[-78]C[12]"
    Range("F105").FormulaR1C1 = "=R[-78]C[12]"
    Range("D107").FormulaR1C1 = "=R[-79]C[18]"
End Sub
Sub RecuperarRegPreviosFormA()
    Range("H3").FormulaR1C1 = "=DAY(R[1]C[14])"
    Range("I3").FormulaR1C1 = "=MONTH(R[1]C[13])"
    Range("J3").FormulaR1C1 = "=YEAR(R[1]C[12])"
    Range("H4").FormulaR1C1 = "=R[1]C[14]"
    Range("E9:e20").FormulaR1C1 = "=R[-3]C[17]"
    Range("E27:e29").FormulaR1C1 = "=R[-9]C[17]"
    Range("E34:e39").FormulaR1C1 = "=R[-13]C[17]"
    Range("E44:e45").FormulaR1C1 = "=R[-17]C[17]"
    Range("E50:e56").FormulaR1C1 = "=R[-21]C[17]"
    Range("E61:e68").FormulaR1C1 = "=R[-25]C[17]"
    Range("E75:e83").FormulaR1C1 = "=R[-31]C[17]"
    Range("E89:E93").FormulaR1C1 = "=R[-36]C[17]"
    Range("E101:E107").FormulaR1C1 = "=R[-43]C[17]"
    Range("E113:E115").FormulaR1C1 = "=R[-48]C[17]"
    Range("E124:E136").FormulaR1C1 = "=R[-56]C[17]"
    Range("E144:E157").FormulaR1C1 = "=R[-63]C[17]"
    Range("E164:E168").FormulaR1C1 = "=R[-69]C[17]"
    Range("E175:E185").FormulaR1C1 = "=R[-75]C[17]"
    Range("E200:E208").FormulaR1C1 = "=R[-89]C[17]"
    Range("E224:E232").FormulaR1C1 = "=R[-104]C[17]"
    Range("E192").FormulaR1C1 = "=IF(SUM(R[-81]C[17]:R[-73]C[17])>0,1,2)"
    Range("E216").FormulaR1C1 = "=IF(SUM(R[-96]C[17]:R[-88]C[17])>0,1,2)"
End Sub
Sub RecuperarRegPreviosFormB()
    Range("H3").FormulaR1C1 = "=DAY(R[1]C[14])"
    Range("I3").FormulaR1C1 = "=MONTH(R[1]C[13])"
    Range("J3").FormulaR1C1 = "=YEAR(R[1]C[12])"
    Range("H4:J4").FormulaR1C1 = "=R[1]C[14]"
    Range("E9:E20").FormulaR1C1 = "=R[-3]C[17]"
    Range("E27:E29").FormulaR1C1 = "=R[-9]C[17]"
    Range("E34:E38").FormulaR1C1 = "=R[-13]C[17]"
    Range("E44:E45").FormulaR1C1 = "=R[-18]C[17]"
    Range("E51:E56").FormulaR1C1 = "=R[-23]C[17]"
    Range("E62:E68").FormulaR1C1 = "=R[-28]C[17]"
    Range("E74:E75").FormulaR1C1 = "=R[-33]C[17]"
    Range("E81:E83").FormulaR1C1 = "=R[-38]C[17]"
    Range("E89:E92").FormulaR1C1 = "=R[-43]C[17]"
    Range("E99").FormulaR1C1 = "=R[-49]C[17]"
    Range("E105:E107").FormulaR1C1 = "=R[-54]C[17]"
    Range("E113:e118").FormulaR1C1 = "=R[-59]C[17]"
    Range("E125:e131").FormulaR1C1 = "=R[-65]C[17]"
    Range("E136:e142").FormulaR1C1 = "=R[-69]C[17]"
    Range("E149:e153").FormulaR1C1 = "=R[-75]C[17]"
    Range("E159:E163").FormulaR1C1 = "=R[-80]C[17]"
    Range("E170:E179").FormulaR1C1 = "=R[-86]C[17]"
    Range("E186").FormulaR1C1 = "=IF(SUM(R[-92]C[17]:R[-84]C[17])=0,2,1)"
    Range("E194:E202").FormulaR1C1 = "=R[-100]C[17]"
End Sub
Sub RecuperarRegPreviosEXTRALAB()
    Sheets("ForEx").Select
    Range("H3").FormulaR1C1 = "=DAY(R[1]C[14])"
    Range("I3").FormulaR1C1 = "=MONTH(R[1]C[13])"
    Range("J3").FormulaR1C1 = "=YEAR(R[1]C[12])"
    Range("H4").FormulaR1C1 = "=R[1]C[14]"
    Range("E9:e21").FormulaR1C1 = "=R[-3]C[17]"
    Range("E29:e42").FormulaR1C1 = "=R[-10]C[17]"
    Range("E48:e51").FormulaR1C1 = "=R[-15]C[17]"
End Sub
Sub RecuperarRegPreviosESTRES()
    Sheets("ForEstr").Select
    Range("H3").FormulaR1C1 = "=DAY(R[1]C[14])"
    Range("I3").FormulaR1C1 = "=MONTH(R[1]C[13])"
    Range("J3").FormulaR1C1 = "=YEAR(R[1]C[12])"
    Range("H4").FormulaR1C1 = "=R[1]C[14]"
    Range("E9:e39").FormulaR1C1 = "=R[-3]C[17]"
End Sub
Sub GrabarDatGEN()
    Application.ScreenUpdating = False
    
    
    PRIMERDATO = Range("D2").Value
    NDIA = Range("D5").Value
    NMES = Range("E5").Value
    NANO = Range("F5").Value
    NIDENT = Range("D7").Value
    NTIPOCAR = Range("D75").Value
    NNOMBRE = Range("D9").Value
    
    DATGENGR = False 'Range("Y12").Value
    DATINTRGR = Range("Y17").Value
    DATEXTRGR = Range("Y19").Value
    DATESTGR = Range("Y21").Value


    
    DATOSYAREG = Range("G7").Text
    If DATOSYAREG <> "" Then
        MsgBox "Datos Generales ya registrados con este documento de id." + Chr$(13) + "para modificar la informaci|fffd|n seleccione el registro n|fffd|mero " & Range("ac5").Value
        Application.ScreenUpdating = True
        Exit Sub
    End If
10:
    NDATOS = Range("x29").Value
    If NDATOS < 29 Then
        MsgBox "Debe completar los datos solicitados" + Chr$(13) + "Si no est|fffd| la respuesta en la encuesta" + Chr$(13) + "Registre 'No responde' o NR", , "Datos generales"
        Application.ScreenUpdating = True
        Exit Sub
    End If
        
    nuevo = Range("r1").Value
    Registro = Range("q2").Value
    identif = Range("D7").Value
    
    
    If nuevo = 0 Then GoTo 20
    
    'GRABA MODIFICACIONES
    'en la base de respuestas
    Sheets("BDRDG").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("DatGen").Select
    Range("t3:t28").Copy
    Sheets("BDRDG").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    
    ' graba en la base de datos consolidada
    
    Sheets("DatosRPS").Select
    Range("A1").Select
    
    Columns("A:A").Select
    
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("DatGen").Select
    Range("t30:t53").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    
    GoTo 30
Application.ScreenUpdating = True
Exit Sub
    
20:
    'GRABA DATOS NUEVOS
    'toma variables
    Sheets("DatGen").Select

    
    DATGENGR = False
    DATINTRGR = True
    DATEXTRGR = True
    DATESTGR = True

    'graba datos nuevos en base rtas DATOS GENERALES
    Range("t3:t28").Copy
    Sheets("BDRDG").Select
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    
    ' registra id y graba datos en base consolidad
    
    Sheets("DatosRPS").Select
    Range("A1").Select
    If PRIMERDATO = 1 Then
        Range("A2").Select
        GoTo 25
    End If
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
25:
    nfila = ActiveCell.Row
    Sheets("DatGen").Select
    Range("t30:t53").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    
    'Agrega formulas para riesgo total
    Cells(nfila, 93).FormulaR1C1 = _
        "=IF(OR(RC[-43]="""",RC[-9]=""""),""Invalido"",IF(OR(RC[-43]=""invalido"",RC[-9]=""invalido""),""Invalido"",RC[-43]+RC[-9]))"
    
    Cells(nfila, 94).FormulaR1C1 = _
        "=IF(RC[-1]=""Invalido"",""Invalido"",IF(RC[-75]=""A"",ROUND(RC[-1]*100/616,1),ROUND(RC[-1]*100/512,1)))"
    
    Cells(nfila, 95).FormulaR1C1 = _
        "=IF(RC[-2]=""Invalido"",""Invalido"",IF(RC[-76]=""A"",RC[5],IF(RC[-76]=""B"",RC[6],""INVALIDO"")))"
    
    Cells(nfila, 100).FormulaR1C1 = _
        "=IF(RC[-6]>Ptajes!R14C65,Ptajes!R7C66,(IF(RC[-6]>Ptajes!R14C64,Ptajes!R7C65,IF(RC[-6]>Ptajes!R14C63,Ptajes!R7C64,IF(RC[-6]>Ptajes!R14C62,Ptajes!R7C63,Ptajes!R7C62)))))"
    
    Cells(nfila, 101).FormulaR1C1 = _
        "=IF(RC[-7]>Ptajes!R15C65,Ptajes!R7C66,(IF(RC[-7]>Ptajes!R15C64,Ptajes!R7C65,IF(RC[-7]>Ptajes!R15C63,Ptajes!R7C64,IF(RC[-7]>Ptajes!R15C62,Ptajes!R7C63,Ptajes!R7C62)))))"
    
    
30:
    'borra formulario
    Sheets("DatGen").Select
    Range( _
        "D5:F5,D7:F7,D9:I9,D11,D15,D17,D28,D42:I42,D45:I45,D46:I46,D48,D58,D63,D68:I68,D69:I69,D71,D73:I73,D75,D81,D83:I83,D87,D95,D97" _
        ).ClearContents
    Application.ScreenUpdating = True
    Range("Q2").Value = Range("S2").Value
    Range("d5").Select
    ActiveWorkbook.Save

    'SE SOLICITA CUAL FORMATO SEGUIR
    'If nuevo = 0 Then
        Application.Run "SELECCFORM"
    'End If
End Sub
Sub GrabarDatIntA()
    Application.ScreenUpdating = False
    
    NDIA = Range("h3").Value
    NMES = Range("I3").Value
    NANO = Range("J3").Value
    NIDENT = Range("y10").Value
    NTIPOCAR = Range("O1").Value
    NNOMBRE = Range("y11").Value
    DATGENGR = Range("Y12").Value
    DATINTRGR = False
    DATEXTRGR = Range("Y19").Value
    DATESTGR = Range("Y21").Value

    
    'REVISA INFORMACION COMPLETA Y COHERENTE
    DATOSYAREG = Range("K3").Text
    If DATOSYAREG <> "" Then
        MsgBox "Ya se registr|fffd| una encuesta con este documento de id." + Chr$(13) + "para modificar la informaci|fffd|n seleccione el registro n|fffd|mero " & Range("ac5").Value
        Application.ScreenUpdating = True
        Exit Sub
    End If

    DATGEN = Range("Y1").Value
    If DATGEN = 0 Then
        MsgBox "Debe diligenciar previamente los Datos Generales para este trabajador", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    TIPOFORM = Range("O2").Value
    If TIPOFORM = 0 Then
        MsgBox "Este formulario no aplica para el tipo de cargo" + Chr$(13) + "Aplique el formulario TIPO B o revise el tipo de cargo", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    NDATOS = Range("n1").Value
    If NDATOS < 130 Then
        MsgBox "Debe completar los datos solicitados" + Chr$(13) + "Si no est|fffd| la respuesta en la encuesta" + Chr$(13) + "Registre 'No responde' o NR", , "INTRALABORAL FORMA A"
        Exit Sub
    End If
        
    nuevo = Range("r1").Value
    Registro = Range("q2").Value
    identif = Range("h4").Value
    
    
    If nuevo = 0 Then GoTo 20
    
    'MODIFICAR REGISTRO
    ' GRABA MODIFICACION -RESPUESTAS-
    Sheets("BDRtasA").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("ForA").Select
    Range("T3:T128").Copy
    Sheets("BDRtasA").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    'GRABA MODIFICACION -VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 25).Select
    Sheets("ForA").Select
    Range("U131:U180").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    GoTo 30
Exit Sub
20:
    'GRABAR NUEVO REGISTRO
    
    
    'graba respuestas
    Sheets("ForA").Select
    Range("T3:T128").Copy
    Sheets("BDRtasA").Select
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
        
    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 25).Select
    Sheets("ForA").Select
    Range("U131:U180").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False


30:
     
    Sheets("ForA").Select
    Range( _
        "H3:J4,E9:E20,E27:E29,E34:E39,E44:E45,E50:E56,E61:E68,E75:E83,E89:E93,E101:E107,E113:E115,E124:E136,E144:E157,E164:E168,E175:E185,E192,E200:E208,E216,E224:E232" _
        ).ClearContents
    Application.ScreenUpdating = True
    Range("Q2").Value = Range("S2").Value
    ActiveWorkbook.Save
    ActiveWindow.ScrollRow = 1
    Range("H3").Select

    'SE SOLICITA CUAL FORMATO SEGUIR
    ' If nuevo = 0 Then
        Application.Run "SELECCFORM"
    ' End If

End Sub
Sub GrabarDatIntB()
    Application.ScreenUpdating = False
    
    NDIA = Range("h3").Value
    NMES = Range("I3").Value
    NANO = Range("J3").Value
    NIDENT = Range("y10").Value
    NTIPOCAR = Range("O1").Value
    NNOMBRE = Range("y11").Value
    DATGENGR = Range("Y12").Value
    DATINTRGR = False
    DATEXTRGR = Range("Y19").Value
    DATESTGR = Range("Y21").Value
    
    
    DATOSYAREG = Range("K3").Text
    If DATOSYAREG <> "" Then
        MsgBox "Ya se registr|fffd| una encuesta con este documento de id." + Chr$(13) + "para modificar la informaci|fffd|n seleccione el registro n|fffd|mero " & Range("ac5").Value
        Application.ScreenUpdating = True
        Exit Sub
    End If
    
    DATGEN = Range("Y1").Value
    If DATGEN = 0 Then
        MsgBox "Debe diligenciar previamente los Datos Generales para este trabajador", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    TIPOFORM = Range("O2").Value
    If TIPOFORM = 0 Then
        MsgBox "Este formulario no aplica para el tipo de cargo" + Chr$(13) + "Aplique el formulario TIPO A o revise el tipo de cargo", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    NDATOS = Range("n1").Value
    If NDATOS < 102 Then
        MsgBox "Debe completar los datos solicitados" + Chr$(13) + "Si no est|fffd| la respuesta en la encuesta" + Chr$(13) + "Registre 'No responde' o NR", , "INTRALABORAL FORMA B"
        Exit Sub
    End If
        
    nuevo = Range("r1").Value
    Registro = Range("q2").Value
    identif = Range("h4").Value
    
    If nuevo = 0 Then GoTo 20
    
    'MODIFICAR REGISTRO
    
    Sheets("BDRtasB").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("ForB").Select
    Range("T3:T102").Copy
    Sheets("BDRtasB").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 25).Select
    Sheets("ForB").Select
    Range("U105:U154").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    GoTo 30
Exit Sub
20:
    'GRABAR NUEVO REGISTRO
        

    Sheets("ForB").Select
    Range("T3:T102").Copy
    Sheets("BDRtasB").Select
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    
    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 25).Select
    Sheets("ForB").Select
    Range("U105:U154").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    

30:
     
    Sheets("ForB").Select
    Range( _
        "H3:J4,E9:E20,E27:E29,E34:E38,E44:E45,E51:E56,E62:E68,E74:E75,E81:E83,E89:E92,E99,E105:E107,E113:E118,E125:E131,E136:E142,E149:E153,E159:E163,E170:E179,e186,E194:E202" _
        ).ClearContents
    Application.ScreenUpdating = True
    Range("Q2").Value = Range("S2").Value
    ActiveWorkbook.Save
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
    
    'SE SOLICITA CUAL FORMATO SEGUIR
    ' If nuevo = 0 Then
        Application.Run "SELECCFORM"
    ' End If

End Sub
Sub GrabarDatExt()
Attribute GrabarDatExt.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.ScreenUpdating = False
    NDIA = Range("h3").Value
    NMES = Range("I3").Value
    NANO = Range("J3").Value
    NIDENT = Range("y10").Value
    NTIPOCAR = Range("O1").Value
    NNOMBRE = Range("y11").Value
    DATGENGR = Range("Y12").Value
    DATINTRGR = Range("Y17").Value
    DATEXTRGR = False
    DATESTGR = Range("Y21").Value

    
    
    DATOSYAREG = Range("K3").Text
    If DATOSYAREG <> "" Then
        MsgBox "Ya se registr|fffd| una encuesta con este documento de id." + Chr$(13) + "para modificar la informaci|fffd|n seleccione el registro n|fffd|mero " & Range("ac5").Value
        Application.ScreenUpdating = True
        Exit Sub
    End If

    DATGEN = Range("Y1").Value
    If DATGEN = 0 Then
        MsgBox "Debe diligenciar previamente los Datos Generales para este trabajador", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    NDATOS = Range("n1").Value
    If NDATOS < 35 Then
        MsgBox "Debe completar los datos solicitados" + Chr$(13) + "Si no est|fffd| la respuesta en la encuesta" + Chr$(13) + "Registre 'No responde' o NR", , "INTRALABORAL FORMA B"
        Exit Sub
    End If
        
    nuevo = Range("r1").Value
    Registro = Range("q2").Value
    identif = Range("h4").Value
    
    If nuevo = 0 Then GoTo 20
    
    'MODIFICAR REGISTRO
    
    Sheets("BDRtasEx").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("ForEx").Select
    Range("T3:T36").Copy
    Sheets("BDRtasEx").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 75).Select
    Sheets("ForEx").Select
    Range("U39:U56").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    GoTo 30
Exit Sub
20:
    'GRABAR NUEVO REGISTRO
    
    
    Sheets("ForEx").Select
    Range("T3:T36").Copy
    Sheets("BDRtasEx").Select
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    
    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 75).Select
    Sheets("ForEx").Select
    Range("U39:U56").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False
    

30:
     
    Sheets("ForEx").Select
    Range("H3:J4,E9:E21,E29:E42,E48:E51").ClearContents
    Application.ScreenUpdating = True
    
    Range("Q2").Value = Range("S2").Value
    ActiveWorkbook.Save
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
    
    'SE SOLICITA CUAL FORMATO SEGUIR
    'If nuevo = 0 Then
        Application.Run "SELECCFORM"
    'End If

End Sub
Sub GrabarDatEstres()
    Application.ScreenUpdating = False
    NDIA = Range("h3").Value
    NMES = Range("I3").Value
    NANO = Range("J3").Value
    NIDENT = Range("y10").Value
    NTIPOCAR = Range("O1").Value
    NNOMBRE = Range("y11").Value
    DATGENGR = Range("Y12").Value
    DATINTRGR = Range("Y17").Value
    DATEXTRGR = Range("Y19").Value
    DATESTGR = False
    
    DATOSYAREG = Range("K3").Text
    If DATOSYAREG <> "" Then
        MsgBox "Ya se registr|fffd| una encuesta con este documento de id." + Chr$(13) + "para modificar la informaci|fffd|n seleccione el registro n|fffd|mero " & Range("ac5").Value
        Application.ScreenUpdating = True
        Exit Sub
    End If
    
    DATGEN = Range("Y1").Value
    If DATGEN = 0 Then
        MsgBox "Debe diligenciar previamente los Datos Generales para este trabajador", vbCritical, "BATERIA PSICOSOCIAL"
        Exit Sub
    End If

    NDATOS = Range("n1").Value
    If NDATOS < 35 Then
        MsgBox "Debe completar los datos solicitados" + Chr$(13) + "Si no est|fffd| la respuesta en la encuesta" + Chr$(13) + "Registre 'No responde' o NR", , "INTRALABORAL FORMA B"
        Exit Sub
    End If
        
    nuevo = Range("r1").Value
    Registro = Range("q2").Value
    identif = Range("h4").Value
    
    If nuevo = 0 Then GoTo 20
    
    'MODIFICAR REGISTRO
    
    Sheets("BDRtasEstr").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    Sheets("ForEstr").Select
    Range("T3:T36").Copy
    Sheets("BDRtasEstr").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate
    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 96).Select
    Sheets("ForEstr").Select
    Range("t38:t41").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False


    GoTo 30
Exit Sub
20:
    'GRABAR NUEVO REGISTRO
    

    
    Sheets("ForEstr").Select
    Range("T3:T36").Copy
    Sheets("BDRtasEstr").Select
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

    'GRABA datos PUNTAJES Y VALORACION DEL RIESGO en base consolidada-
    Sheets("DatosRPS").Select
    Columns("A:A").Select
    
    'Selection.Find(What:=Identif, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    
    
    Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=False, SearchFormat:=False).Activate

    ActiveCell.Select
    FILADAT = ActiveCell.Row
    Cells(FILADAT, 96).Select
    Sheets("ForEstr").Select
    Range("t38:t41").Copy
    Sheets("DatosRPS").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    Application.CutCopyMode = False

30:
     
    Sheets("ForEstr").Select
    Range("H3:J4,E9:E39").ClearContents
    Application.ScreenUpdating = True
    
    Range("Q2").Value = Range("S2").Value
    ActiveWorkbook.Save
    ActiveWindow.ScrollRow = 1
    Range("H3").Select
    
    'SE SOLICITA CUAL FORMATO SEGUIR
    If nuevo = 0 Then
        Application.Run "SELECCFORM"
    End If

End Sub
Sub Menu()
    Sheets("PsicIn").Select
    Range("A1").Select
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("D4").Select
End Sub
Sub ADatGen()
    Sheets("DatGen").Select
    Application.Run "NuevoRegDATGEN"
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("D5").Select
End Sub
Sub AFormA()
    Sheets("ForA").Select
    Application.Run "NuevoRegINTRAA"
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("H3").Select
End Sub
Sub AFormB()
    Sheets("ForB").Select
    Application.Run "NuevoRegINTRAB"
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("H3").Select
End Sub
Sub AFormExt()
    Sheets("ForEx").Select
    Application.Run "NuevoRegEXTRAL"
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("H3").Select
End Sub
Sub AFEstres()
    Sheets("ForEstr").Select
    Application.Run "NuevoRegESTRES"
    Range("e39").Select
    ActiveWindow.SmallScroll Down:=-35
    ActiveWindow.SmallScroll ToRight:=0
    Range("H3").Select
End Sub
Sub SELECCFORM()
        ENCU.Show
        seleccion = FORMATOSELECC
        Select Case seleccion
            Case 0
                'Queda en el mismo formulario
                Exit Sub
            Case 1
                'Sigue a datos generales, en ppio no se requeriria
                Sheets("DatGen").Select
                Application.Run "NuevoRegDATGEN"
            Case 2
                'Sigue intrlaboral
                If NTIPOCAR = 1 Or NTIPOCAR = 2 Then
                    Sheets("ForA").Select
                    Application.Run "NuevoRegINTRAA"
                Else
                    Sheets("ForB").Select
                    Application.Run "NuevoRegINTRAB"
                End If
                
                Range("h3").Value = NDIA
                Range("I3").Value = NMES
                Range("J3").Value = NANO
                Range("H4").Value = NIDENT
                Range("H4").Select

            Case 3
                'Sigue extralaboral
                Sheets("ForEx").Select
                Application.Run "NuevoRegEXTRAL"
                Range("h3").Value = NDIA
                Range("I3").Value = NMES
                Range("J3").Value = NANO
                Range("H4").Value = NIDENT
                Range("H4").Select

            Case 4
                'SIGUE ESTRES
                Sheets("ForEstr").Select
                Application.Run "NuevoRegESTRES"
                Range("h3").Value = NDIA
                Range("I3").Value = NMES
                Range("J3").Value = NANO
                Range("H4").Value = NIDENT
                Range("H4").Select
                
            Case 5
                'Regrasa a menu
                Sheets("PsicIn").Select
            Case Else
                Exit Sub
        End Select

End Sub
Sub DetallesDominios()
'Exit Sub
    
    A = ActiveCell.Row
    B = ActiveCell.Column
    
    'If A <> 9 Then Exit Sub
    'If B <> 6 Then Exit Sub
    'Range("e16").Select
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotCache.Refresh
    
    ocul = Range("a4").Text
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(ocul). _
        Orientation = xlHidden
    
    

    Campo = Range("a1").Text
    
    'ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(Campo). _
        Orientation = xlHidden
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(Campo)
        .Orientation = xlRowField
        .Position = 1
    End With
    
    Range("F7:J7").ClearContents
    Range("F7").Value = "*"



End Sub
Sub RESUMENDETALLADO()
    Sheets("DatosRPS").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    ULTIMFIL = ActiveCell.Row
    TOTALDATOS$ = "=DatosRPS!R1C1:R" & ULTIMFIL & "C99"
    ActiveWorkbook.Names.Add Name:="DATOSPSIC", RefersToR1C1:=TOTALDATOS$
    'Sheets("ResTOT").PivotTables("Tabla din|fffd|mica1").PivotCache.Refresh
    Sheets("TD_DomDim").Select
    Sheets("TD_DomDim").PivotTables("Tabla din|fffd|mica1").PivotCache.Refresh
    Range("F6:J6").Select
End Sub

Sub SELECCIONGRUPORESTOT()
    
    Grupo1 = Range("A2").Value
    Grupo2 = Range("A3").Value
    Grupo3 = Range("A4").Value
    GrupoNvo1 = Range("H7").Value
    GrupoNvo2 = Range("H8").Value
    GrupoNvo3 = Range("H9").Value
    RiesgoAct = Range("A7").Value
    RiesgoNvo = Range("H10").Value
    CumpleActualizar = Range("AB11").Value
    
    If CumpleActualizar = 0 Then
        MsgBox "Debe seleccionar tres grupos y un riesgo, todos deben ser diferentes"
        Exit Sub
    End If
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotCache.Refresh
    ActiveSheet.PivotTables("Tabla din|fffd|mica2").PivotCache.Refresh
    ActiveSheet.PivotTables("Tabla din|fffd|mica3").PivotCache.Refresh
    ActiveSheet.PivotTables("Tabla din|fffd|mica4").PivotCache.Refresh

    
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(Grupo1). _
        Orientation = xlHidden
    ActiveSheet.PivotTables("Tabla din|fffd|mica2").PivotFields(Grupo1). _
        Orientation = xlHidden
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(Grupo2). _
        Orientation = xlHidden
    ActiveSheet.PivotTables("Tabla din|fffd|mica3").PivotFields(Grupo2). _
        Orientation = xlHidden
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(Grupo3). _
        Orientation = xlHidden
    ActiveSheet.PivotTables("Tabla din|fffd|mica4").PivotFields(Grupo3). _
        Orientation = xlHidden
    
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(RiesgoAct). _
        Orientation = xlHidden
    
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(GrupoNvo3)
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("Tabla din|fffd|mica4").PivotFields(GrupoNvo3)
        .Orientation = xlRowField
        .Position = 1
    End With
    
    
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(GrupoNvo2)
        .Orientation = xlPageField
        .Position = 2
    End With
    With ActiveSheet.PivotTables("Tabla din|fffd|mica3").PivotFields(GrupoNvo2)
        .Orientation = xlRowField
        .Position = 1
    End With

    
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(GrupoNvo1)
        .Orientation = xlPageField
        .Position = 3
    End With
    With ActiveSheet.PivotTables("Tabla din|fffd|mica2").PivotFields(GrupoNvo1)
        .Orientation = xlRowField
        .Position = 1
    End With

    
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(RiesgoNvo)
        .Orientation = xlRowField
        .Position = 1
    End With

    
    Exit Sub
    
    
    'If SELECTACT = SELECTNVA Then Exit Sub
    'If RIESGOACT = RIESGONVO Then Exit Sub
    
    'ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(GRUPOACT).Orientation = xlHidden
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(RiesgoAct).Orientation = xlHidden
    
    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(GRUPONVO)
        .Orientation = xlPageField
        .Position = 1
    End With

    With ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotFields(RiesgoNvo)
        .Orientation = xlRowField
        .Position = 1
    End With


    Range("J7").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$O$7:$O$212"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With



End Sub
'

Sub ABRIR_INFIND_EXTRALABORAL()
 On Error GoTo 1

' Windows("Inf_Individual_Extralaboral.doc").Activate
' Exit Sub
' 1:
DIRACT = ActiveWorkbook.Path
Dim WORDARCH As Object
Set WORDARCH = CreateObject("word.Application")
    'RUTAACT = ActiveWorkbook.Path
    'Application.WindowState = xlMinimized
INFORME = DIRACT & "\Inf_Individual_Extralaboral.doc"

'
'
'WORDARCH.Open INFORME
WORDARCH.Visible = True

    With WORDARCH
    .Documents.Close INFORME
    '.Visible = True
    
    End With

1:
    With WORDARCH
    .Documents.Open INFORME
    .Visible = True
    
    End With
    
' Windows("Inf_Individual_Extralaboral.doc").Activate

End Sub
Sub ABRIR_INFIND_INTRALABORAL()
    'On Error GoTo 1
    DIRACT = ActiveWorkbook.Path
    Dim WORDARCH As Object
    Set WORDARCH = CreateObject("word.Application")
    INFORME = DIRACT & "\Inf_Individual_Intralaboral.doc"
    WORDARCH.Visible = True
    With WORDARCH
    .Documents.Open INFORME
    .Visible = True
    End With
1:
End Sub
Sub ABRIR_INFIND_ESTRES()
    'On Error GoTo 1
    DIRACT = ActiveWorkbook.Path
    Dim WORDARCH As Object
    Set WORDARCH = CreateObject("word.Application")
    INFORME = DIRACT & "\Inf_Individual_Estres.doc"
    WORDARCH.Visible = True
    With WORDARCH
    .Documents.Open INFORME
    .Visible = True
    End With
1:
End Sub

Sub RESUMENTOTAL()
    Sheets("DatosRPS").Select
    Sheets("DatosRPS").Rows("1:1").AutoFilter
    ActiveCell.SpecialCells(xlLastCell).Select
    ULTIMFIL = ActiveCell.Row
    TOTALDATOS$ = "=DatosRPS!R1C1:R" & ULTIMFIL & "C99"
    ActiveWorkbook.Names.Add Name:="DATOSPSIC", RefersToR1C1:=TOTALDATOS$
    
    
    'Sheets("DatosRPS").AutoFilter

    
    Sheets("ResTOT").Select
    ActiveSheet.Unprotect "RCG"
    Calculate
    
    NDATOS = Range("D4").Value + 1
    RANGODATOS1 = "=DatosRPS!$AW$2:$AW$" & NDATOS
    RANGODATOS3 = "=DatosRPS!$CE$2:$CE$" & NDATOS
    RANGODATOS4 = "=DatosRPS!$CP$2:$CP$" & NDATOS
    RANGODATOS9 = "=DatosRPS!$CT$2:$CT$" & NDATOS

    ActiveSheet.ChartObjects("1 Gr|fffd|fico").Activate
    ActiveChart.SeriesCollection(1).Values = RANGODATOS1
    
    ActiveSheet.ChartObjects("3 Gr|fffd|fico").Activate
    ActiveChart.SeriesCollection(1).Values = RANGODATOS3
    
    ActiveSheet.ChartObjects("4 Gr|fffd|fico").Activate
    ActiveChart.SeriesCollection(1).Values = RANGODATOS4
    
    ActiveSheet.ChartObjects("9 Gr|fffd|fico").Activate
    ActiveChart.SeriesCollection(1).Values = RANGODATOS9
    
    Range("B2").Select
    ActiveSheet.Protect "RCG"
    
End Sub

Attribute VB_Name = "M|fffd|dulo2"
Sub RECALCULARINTRALABORAL_A()
    Sheets("ForA").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosFormA"
    For i = 1 To MAXIM
        Range("Q2").Value = i
        Application.Run "GrabarDatIntA"
        Application.Run "RecuperarRegPreviosFormA"
    Next i
End Sub
Sub RECALCULARINTRALABORAL_B()
    Sheets("ForB").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosFormB"
    For i = 1 To MAXIM
        Range("Q2").Value = i
        Application.Run "GrabarDatIntB"
        Application.Run "RecuperarRegPreviosFormB"
    Next i
End Sub
Sub RECALCULAR_EXTRALABORAL()
    Sheets("ForEx").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosEXTRALAB"
    For i = 1 To MAXIM
        Range("Q2").Value = i
        Application.Run "GrabarDatExt"
        Application.Run "RecuperarRegPreviosEXTRALAB"
    Next i
End Sub

Sub ActualizaR()
'
' ActualizaR Macro
'

'
    Registro = Range("P2").Value
    
    
    Sheets("BDRtasB").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
    
    Sheets("BDPtajeB").Select
    Columns("A:A").Select
    Selection.Find(What:=Registro, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Activate
    ActiveCell.Select
End Sub

Sub REGRABARPTAJEBTO()

'
   
    For i = 1 To 45
    Sheets("ForB").Select
    Range("p2").Value = i
    pbr = Range("U151").Value
    Sheets("BDPtajeB").Select
    Cells(i + 2, 149).Value = pbr
    
    Next i
    
End Sub
Sub REGRABAR_DATGEN()
   Sheets("DatGen").Select
    ndat = Range("s2").Value - 1
    For i = 1 To ndat
        Sheets("DatGen").Select
        Range("q2").Value = i
        identif = Range("D7").Value
        Sheets("DatosRPS").Select
        Columns("A:A").Select
        Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False).Activate
        ActiveCell.Select
        Sheets("DatGen").Select
        Range("t30:t53").Copy
        Sheets("DatosRPS").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        Application.CutCopyMode = False
    Next i
End Sub
Sub REGRABAR_INTRALABORAL_A()
    Sheets("ForA").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosFormA"
    
    
    
    For i = 1 To MAXIM
        Sheets("ForA").Select
        Range("Q2").Value = i
        identif = Range("h4").Value
        
        
            Sheets("DatosRPS").Select
            Columns("A:A").Select
            Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
                LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                MatchCase:=False, SearchFormat:=False).Activate
            ActiveCell.Select
            FILADAT = ActiveCell.Row
            Cells(FILADAT, 25).Select
            Sheets("ForA").Select
            Range("U131:U180").Copy
            Sheets("DatosRPS").Select
            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
            Application.CutCopyMode = False
    Next i
End Sub
Sub REGRABAR_INTRALABORAL_B()
    Sheets("ForB").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosFormB"
    For i = 1 To MAXIM
        Sheets("ForB").Select
        Range("Q2").Value = i
        identif = Range("h4").Value
        
        Sheets("DatosRPS").Select
        Columns("A:A").Select
        Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False).Activate
        ActiveCell.Select
        FILADAT = ActiveCell.Row
        Cells(FILADAT, 25).Select
        Sheets("ForB").Select
        Range("U105:U154").Copy
        Sheets("DatosRPS").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        Application.CutCopyMode = False
    Next i
End Sub
Sub REGRABAR_EXTRALABORAL()
    Sheets("ForEx").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosEXTRALAB"
    For i = 1 To MAXIM
        Sheets("ForEx").Select
        Range("Q2").Value = i
        identif = Range("h4").Value
        Sheets("DatosRPS").Select
        Columns("A:A").Select
        Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False).Activate
        ActiveCell.Select
        FILADAT = ActiveCell.Row
        Cells(FILADAT, 75).Select
        Sheets("ForEx").Select
        Range("U39:U56").Copy
        Sheets("DatosRPS").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        Application.CutCopyMode = False
    
    Next i
End Sub
Sub REGRABAR_ESTRES()
    Sheets("ForEstr").Select
    MAXIM = Range("S2").Value
    If MAXIM < 1 Then Exit Sub
    Application.Run "RecuperarRegPreviosESTRES"
    For i = 1 To MAXIM
        Sheets("ForEstr").Select
        Range("Q2").Value = i
        identif = Range("h4").Value
        Sheets("DatosRPS").Select
        Columns("A:A").Select
        Selection.Find(What:=identif, After:=ActiveCell, LookIn:=xlValues, _
            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False).Activate
        ActiveCell.Select
        FILADAT = ActiveCell.Row
        Cells(FILADAT, 96).Select
        Sheets("ForEstr").Select
        Range("T38:T41").Copy
        Sheets("DatosRPS").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        Application.CutCopyMode = False
    
    Next i
End Sub

Sub Resumen()
'
' Resumen Macro
'

'
    Sheets("AuxResumen").Select
    Range("A2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range("A2:H47").Select
    Selection.ClearContents
    Range("A1").Select
    Sheets("BDRDG").Select
    Range("C3").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlToLeft)).Select
    Range("C3:D3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("BDRDG").Select
    Range("A3:D3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("AuxResumen").Select
    Range("B2").Select
    ActiveSheet.Paste
    Range("A2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Datos generales"
    Range("A2").Select
    Selection.AutoFill Destination:=Range("A2:A24")
    Range("A2:A24").Select
    Range("A3").Select
    Selection.End(xlDown).Select
    Range("A25").Select
    ActiveCell.FormulaR1C1 = "Intralaboral (A)"
    Range("A26").Select
    Sheets("BDRtasA").Select
    Range("A3:C3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("AuxResumen").Select
    Range("B25").Select
    ActiveSheet.Paste
    Range("A25").Select
    Application.CutCopyMode = False
    Selection.AutoFill Destination:=Range("A25:A36")
    Range("A25:A36").Select
    Range("A25").Select
    Selection.End(xlDown).Select
    Range("A37").Select
    ActiveCell.FormulaR1C1 = "Intralaboral (B)"
    Range("A38").Select
    Sheets("BDRtasB").Select
    Range("A3:C3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("AuxResumen").Select
    Range("B37").Select
    ActiveSheet.Paste
    Range("A37").Select
    Application.CutCopyMode = False
    Selection.AutoFill Destination:=Range("A37:A59")
    Range("A37:A59").Select
    Sheets("BDRtasEx").Select
    ActiveWindow.SmallScroll Down:=-30
    Range("A3:C3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("AuxResumen").Select
    Range("B35").Select
    Selection.End(xlDown).Select
    Range("B60").Select
    ActiveSheet.Paste
    Range("A60").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Extralaboral"
    Range("A60").Select
    Selection.AutoFill Destination:=Range("A60:A105")
    Range("A60:A105").Select
    Sheets("Hoja1").Select
    Range("E9").Select
    ActiveSheet.PivotTables("Tabla din|fffd|mica1").PivotCache.Refresh
    ActiveWindow.SmallScroll Down:=4
    Range("B9").Select
    Selection.AutoFill Destination:=Range("B5:B9"), Type:=xlFillDefault
    Range("B5:B9").Select
    Range("B5").Select
    Selection.AutoFill Destination:=Range("B5:B27")
    Range("B5:B27").Select
    ActiveWindow.SmallScroll Down:=12
    Selection.AutoFill Destination:=Range("B5:B31"), Type:=xlFillDefault
    Range("B5:B31").Select
    Range("B27").Select
    ActiveWindow.SmallScroll Down:=-13
End Sub
Sub SELECCSIG()
    NIDENT = Range("y10").Value
    NTIPOCAR = Range("D75").Value
    NNOMBRE = Range("y11").Value
    DATGENGR = Range("Y12").Value
    DATINTRGR = Range("Y17").Value
    DATEXTRGR = Range("Y19").Value
    DATESTGR = Range("Y21").Value
    
    

   ENCU.Show
End Sub



Attribute VB_Name = "M|fffd|dulo3"
Sub Macro17()
Attribute Macro17.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro17 Macro
'

'
    ActiveWindow.SmallScroll ToRight:=7
    Range("O6").Select
    With ActiveSheet.PivotTables("Tabla din|fffd|mica2").PivotFields("RESIDENCIA_CIUDAD" _
        )
        .Orientation = xlRowField
        .Position = 1
    End With
    Range("R6").Select
    ActiveWindow.SmallScroll ToRight:=2
    ActiveSheet.PivotTables("Tabla din|fffd|mica3").AddDataField ActiveSheet.PivotTables _
        ("Tabla din|fffd|mica3").PivotFields("Edad"), "Suma de Edad", xlSum
    With ActiveSheet.PivotTables("Tabla din|fffd|mica3").PivotFields("Edad")
        .Orientation = xlRowField
        .Position = 1
    End With
    ActiveWindow.SmallScroll ToRight:=2
    Range("U6").Select
    With ActiveSheet.PivotTables("Tabla din|fffd|mica4").PivotFields("TRABAJO_DPTO")
        .Orientation = xlRowField
        .Position = 1
    End With
    ActiveWindow.SmallScroll ToRight:=-6
    Range("K17").Select
End Sub
Sub Macro18()
Attribute Macro18.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro18 Macro
'

'
    Range("J7").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$O$7:$O$14"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("J8").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$R$7:$R$10"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Range("J9").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$U$7:$U$8"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    ActiveWindow.SmallScroll ToRight:=-13
End Sub
Sub PRUEBA()
'
' PRUEBA Macro
'

'
    Sheets("ResTOT2").Select
    Range("I4").Select
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
    Sheets("PsicIn").Select
    ActiveWindow.SmallScroll Down:=0
    ActiveWindow.SmallScroll ToRight:=0
    Range("D5").Select
End Sub

' InQuest injected base64 decoded content
' ]4@,
' ]4@,

INQUEST-PP=macro
