Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Modul1"

Sub ExportAll()
Attribute ExportAll.VB_ProcData.VB_Invoke_Func = "e\n14"

    Dim x, y, max, may, languages
    
    Do While Cells(1, x + 1).Value > "": x = x + 1: Loop
    Do While Cells(y + 1, 1).Value > "": y = y + 1: Loop
    
    max = x
    may = y
    
    For x = 7 To max
      languages = languages & Cells(1, x) & IIf(x < max, ",", "")
    Next x
    
    Open ActiveWorkbook.Path & "\Languages.ini" For Output As #1
    PrintHeader Cells(1, x).Value, languages
    
    For x = 7 To max
    
        Print #1, ""
        Print #1, "[" & Cells(1, x) & "]"
    
        For y = 2 To may
        
            If Cells(y, x).Value > "" Then
                If Cells(y, 6).Value > "" Then Print #1, "; " & Cells(y, 6).Value
                Print #1, "text" & Cells(y, 1).Value & "=""" & Cells(y, x).Value & """"
            End If
        Next y
        
    Next x
    
    Close #1

End Sub

Sub PrintHeader(ByVal Server As String, ByVal SupportedLanguages As String)

    Print #1, "; Language- inifile for BOM (biet-o-matic)"
    Print #1, ";"
    Print #1, "; this file describes the textstrings in BOM"
    Print #1, "; careful: max. linelength = 256 char for strings!"
    Print #1, ";"
    Print #1, "; if you want to install a new language, just translate"
    Print #1, "; and add your language under ""Supported"""
    Print #1, ";"
    Print #1, "; generated by Languages.xls"
    Print #1, ";"
    Print #1, "; Versioninfo BOM"
    Print #1, "[BOM]"
    Print #1, "Version=" & GetBOMVersion()
    Print #1, ""
    Print #1, "; Versioninfo languagefile"
    Print #1, "[Langfile]"
    Print #1, "Version=" & GetLangVersion()
    Print #1, ""
    Print #1, ";Languages in alphabetic order"
    Print #1, "Supported=" & SupportedLanguages

End Sub

Function GetBOMVersion() As String

    Dim inline As String
    Open ActiveWorkbook.Path & "\BOM.vbp" For Input As #2
    Do While Not EOF(2)
        Line Input #2, inline
        If inline Like "*MajorVer=*" Then Major = Mid(inline, InStr(1, inline, "=") + 1)
        If inline Like "*MinorVer=*" Then Minor = Mid(inline, InStr(1, inline, "=") + 1)
        If inline Like "*RevisionVer=*" Then Revision = Mid(inline, InStr(1, inline, "=") + 1)
    Loop
    Close #2
    If Major > "" And Minor > "" And Revision > "" Then GetBOMVersion = CStr(Major) & "." & CStr(Minor) & "." & CStr(Revision)
    If GetBOMVersion = "" Then MsgBox "No BOMVersion", vbCritical

End Function

Function GetLangVersion() As String

    Dim Major As String, Minor As String, Revision As String
    Dim inline As String
    Open ActiveWorkbook.Path & "\Modules\modLanguage.bas" For Input As #2
    Do While Not EOF(2)
        Line Input #2, inline
        If inline Like "*REQUIREDLANGUAGEVERSION*=*" Then
            GetLangVersion = Mid(inline, InStr(1, inline, """") + 1, Len(inline) - InStr(1, inline, """") - 1)
        End If
    Loop
    Close #2
    If GetLangVersion = "" Then MsgBox "No LangVersion", vbCritical
    
End Function

Sub Import()

    Dim file As String
    Dim inline As String
    Dim language As String
    Dim key As String
    Dim val As String
    Dim col As Long
    Dim i As Long
    
    file = ActiveWorkbook.Path & "\Languages.ini"
    col = 0
    
    Open file For Input As #2
    Do While Not EOF(2)
        Line Input #2, inline
        If Left(inline, 1) = "[" And Right(inline, 1) = "]" Then
          language = Mid(inline, 2, Len(inline) - 2)
          col = 0
          For i = 7 To 99
            If Cells(1, i).Value = language Then col = i: Exit For
          Next i
        End If
        
        If inline Like "text#*=*" And col > 0 Then
            key = Mid(inline, 5, InStr(1, inline, "=") - 5)
            val = Trim(Mid(inline, InStr(1, inline, "=") + 1))
            If Left(val, 1) = """" And Right(val, 1) = """" Then val = Mid(val, 2, Len(val) - 2)
            For i = 1 To 999
                If Cells(i, 1).Value = key Then
                    Cells(i, col).Value = val
                    Exit For
                End If
            Next i
            If i > 999 Then Stop
        End If
    Loop
    Close #2

End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' TDR 

INQUEST-PP=macro
