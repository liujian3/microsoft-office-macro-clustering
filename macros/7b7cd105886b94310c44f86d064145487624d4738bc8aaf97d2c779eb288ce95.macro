Attribute VB_Name = "Other"
Option Explicit
Global bflag1 As Boolean
Global bflag2 As Boolean
Sub |fffd||fffd||fffd||fffd||fffd||fffd|71_|fffd||fffd||fffd||fffd||fffd||fffd|()
    ActiveSheet.Unprotect "qwqw"
   ' Application.DisplayAlerts = False
    If [b23] = True Then
        [d23] = 1
        [i23] = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        
        [l23] = "|fffd||fffd||fffd||fffd||fffd|: " & vbCrLf & "roks/Shared Documents/16. |fffd||fffd||fffd|"
         [j25] = 8
    Else
        [d23] = 0
        [i23] = ""
        [l23] = ""
         [j25] = 0
    End If
    Call pProtect(ActiveSheet)
   ' Application.DisplayAlerts = True
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|72_|fffd||fffd||fffd||fffd||fffd||fffd|()
   ' Application.DisplayAlerts = False
    ActiveSheet.Unprotect "qwqw"
    If [b24] = True Then
        [d24] = 1
        [i24].FormulaLocal = "=""|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "" & K6"
        [l24] = ""
    Else
        [d24] = 0
        [i24] = ""
        [l24] = ""
    End If
    Call pProtect(ActiveSheet)
  ' Application.DisplayAlerts = True
End Sub
Sub OptionButton90_|fffd||fffd||fffd||fffd||fffd||fffd|()
        [i23] = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        [l23] = "|fffd||fffd||fffd||fffd||fffd|: " & vbCrLf & "roks/Shared Documents/16. |fffd||fffd||fffd|"
        [j25] = 8
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|91_|fffd||fffd||fffd||fffd||fffd||fffd|()
        [i23] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        [l23] = "|fffd||fffd||fffd||fffd||fffd|: " & vbCrLf & "roks/Shared Documents/16. |fffd||fffd||fffd|"
        [j25] = 0
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|92_|fffd||fffd||fffd||fffd||fffd||fffd|()
        [d24] = 1
        [i24].FormulaLocal = "=""|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "" & K6"
        [l24] = ""
        
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|93_|fffd||fffd||fffd||fffd||fffd||fffd|()
        [i24] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        [l24] = ""
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|79_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
        If [j25] <> 7 Then
            [l23] = "|fffd||fffd||fffd||fffd||fffd|: " & vbCrLf & "roks/Shared Documents/16. |fffd||fffd||fffd|"
        Else
            [l23] = "|fffd||fffd||fffd||fffd||fffd|: " & vbCrLf & "roks/Shared Documents/14. International Entities"
        End If
End Sub

Attribute VB_Name = "Util"
Option Explicit

Public SheetPassword As String
Public MaintMode As String
Public NachStrok   As Integer

    'Range("D41:L42").Select
    'ActiveSheet.ResetAllPageBreaks
    'Range("A43").Select
    'ActiveWindow.SelectedSheets.HPageBreaks.Add Before:=ActiveCell


Sub Auto_Open()

SheetPassword = "qwqw"
MaintMode = "Off"

End Sub

Public Function GetLastRow(sheet As Worksheet)
'getLastRow = sheet.Cells.SpecialCells(xlCellTypeLastCell).Row - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
GetLastRow = sheet.UsedRange.Rows.Count
End Function

Public Function GetLastCol(sheet As Worksheet)
'getLastCol = sheet.Cells.SpecialCells(xlCellTypeLastCell).Column - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
GetLastCol = sheet.UsedRange.Columns.Count
End Function

Sub zagalovok0(R As Range)
 With R
  .WrapText = True
  .Interior.ColorIndex = 34
  .HorizontalAlignment = xlCenter
  .VerticalAlignment = xlCenter
 End With
End Sub


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Range
' R - Range
' H - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub RazgRange(R As Range, H As Integer)
  If R.Columns.Count > 1 Then RazgLine R.Borders(xlInsideVertical), H
  If R.Rows.Count > 1 Then RazgLine R.Borders(xlInsideHorizontal), H
  RazgRangeG R, H
End Sub

Sub RazgRangeG(R As Range, H As Integer)
  RazgLine R.Borders(xlEdgeLeft), H
  RazgLine R.Borders(xlEdgeTop), H
  RazgLine R.Borders(xlEdgeBottom), H
  RazgLine R.Borders(xlEdgeRight), H
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
' L - |fffd||fffd||fffd||fffd||fffd|
' H - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub RazgLine(L, H As Integer)
  L.LineStyle = xlContinuous
  L.Weight = H
  L.ColorIndex = xlAutomatic
End Sub



Sub protect_all_nov()
    Dim i As Long
    
    Call Auto_Open
    
    Application.ScreenUpdating = False
    
    ThisWorkbook.Activate
    
    For i = 1 To ActiveWorkbook.Sheets.Count
        On Error Resume Next
            Sheets(i).Outline.ShowLevels RowLevels:=1
            Sheets(i).Outline.ShowLevels RowLevels:=0, ColumnLevels:=1
        On Error GoTo 0
    Next i
    
    For i = 1 To ActiveWorkbook.Sheets.Count
        On Error Resume Next
            Sheets(i).Cells(1, 1).Select
            Call pProtect(Sheets(i))
        On Error GoTo 0
    Next i
    
    On Error Resume Next
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd|").Visible = xlHidden
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|Sharepoint").Visible = xlHidden
   
    
    
    ActiveWorkbook.Protect Password:=SheetPassword, Structure:=True, Windows:=False
    On Error GoTo 0
    
    Application.ScreenUpdating = True
End Sub

Sub unprotect_all_nov()
    Dim i As Long
    Dim pw As String
    pw = InputBox("Enter Password")
        
    Application.ScreenUpdating = False
    
    ThisWorkbook.Activate
    
    ActiveWorkbook.Unprotect Password:=pw
    
    For i = 1 To ActiveWorkbook.Sheets.Count
        On Error Resume Next
            Sheets(i).Unprotect Password:=pw
            Sheets(i).Outline.ShowLevels RowLevels:=2, ColumnLevels:=2
            Sheets(i).Visible = xlSheetVisible
            Sheets(i).Cells(1, 1).Select
        On Error GoTo 0
    Next i
    
    Application.ScreenUpdating = True
End Sub


Sub pProtect(ASheet As Worksheet)
    ASheet.Protect Password:=SheetPassword, DrawingObjects:=True, Contents:=True, Scenarios:=True _
         , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowFiltering _
         :=True
End Sub
 
 Public Sub QuickSort(ByRef Field() As String, ByVal LB As Long, ByVal UB As Long)
    Dim P1 As Long, P2 As Long, Ref As String, TEMP As String

    P1 = LB
    P2 = UB
    Ref = Field((P1 + P2) / 2)

    Do
        Do While (Field(P1) < Ref)
            P1 = P1 + 1
        Loop

        Do While (Field(P2) > Ref)
            P2 = P2 - 1
        Loop

        If P1 <= P2 Then
            TEMP = Field(P1)
            Field(P1) = Field(P2)
            Field(P2) = TEMP

            P1 = P1 + 1
            P2 = P2 - 1
        End If
    Loop Until (P1 > P2)

    If LB < P2 Then Call QuickSort(Field, LB, P2)
    If P1 < UB Then Call QuickSort(Field, P1, UB)
End Sub
Public Sub QuickSortDoubleArray(ByRef Field As Variant, ByVal UB As Long)
    Dim i As Long
    Dim newarray() As String
    ReDim newarray(UB)
    For i = 0 To UB
        newarray(i) = Field(0, i)
    Next i
    Call QuickSort(newarray, 0, UB)
    For i = 0 To UB
         Field(0, i) = newarray(i)
    Next i
End Sub
Attribute VB_Name = "ZajClearExample"
Option Explicit
Sub Userdata_Clear()
    Call Userdata_Clear2
    Call ClearAll_top
    Call ClearAll_mid
    Call ClearAll_end
    
End Sub

Sub Userdata_Clear2()
   Dim ASheet As Worksheet
   Set ASheet = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
   ActiveSheet.Unprotect ("qwqw")
    [d23] = 0
    [i23] = ""
    [l23] = ""
    [d24] = ""
    [i24] = ""
    [l24] = ""
    [b23] = 0
    [b24] = 0
    [j25] = 0
    'Call pProtect(ActiveSheet)
   Call ClearAll_mid
   Call ClearAll_end

End Sub

Sub ClearAll_top()
    Dim i As Integer
    Dim ASheet As Worksheet

    Call Auto_Open

    Set ASheet = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
 
    ASheet.[a7] = False
    ASheet.[a8] = False
    ASheet.[a9] = False
    ASheet.[a10] = False
    ASheet.[a12] = False
    ASheet.[a13] = False
 
 
    ASheet.Cells(3, 9) = ""

    ASheet.Cells(6, 5) = ""
    ASheet.Cells(8, 5) = ""
    ASheet.Cells(10, 5) = ""
    ASheet.Cells(12, 5) = ""
    ASheet.Cells(14, 5) = ""
    ASheet.Cells(16, 5) = ""
    ASheet.Cells(18, 5) = ""
    ASheet.Cells(20, 5) = ""
 
    ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ASheet.Cells(6, 11) = ""
    ASheet.Cells(8, 11) = ""
    ASheet.Unprotect (SheetPassword)
    ASheet.Cells(12, 11) = ""

    ASheet.Cells(14, 11) = ""
    ASheet.Cells(16, 11) = ""
    ASheet.Cells(18, 11) = ""
    ASheet.Cells(20, 11) = ""

    i = ActiveWorkbook.Names("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefersToRange.Row
    ASheet.Cells(i, 4) = ""
    ASheet.Cells(i, 14) = ""
    ASheet.Range("A" & i & ":N" & i).Rows.AutoFit
 
    Call pProtect(ASheet)
End Sub

Sub ClearAll_mid()
    Dim i As Integer
    Dim j As Integer
    Dim ASheet As Worksheet
    
    Application.EnableEvents = False
    Set ASheet = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
     
    Call Auto_Open
    
    ASheet.Unprotect (SheetPassword)
    i = 10
    j = 0
    Do While ASheet.Cells(i, 1) <> "@@@1"
    
            If ASheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
               ASheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
               ASheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or _
               ASheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
               ASheet.Unprotect (SheetPassword)
               If j = 0 Then j = i
               If ASheet.Cells(i, 1) = ASheet.Cells(i + 1, 1) Then
                  ASheet.Rows(i).Delete
                  i = i - 1
               Else
                  ASheet.Cells(i, 2) = 1
                  ASheet.Cells(i, 3) = ""
               End If
            End If
           i = i + 1
             
            If i = 10000 Then
                MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| !"
                Exit Do
            End If
             
     Loop
     
    ASheet.Range("A" & j & ":N" & i - 1).Rows.AutoFit
    ASheet.Cells(27, 15) = ""
    
    Call pProtect(ASheet)
    
    Application.EnableEvents = True
End Sub


Sub ClearAll_end()
Dim i As Integer
Dim ASheet As Worksheet

Set ASheet = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Call Auto_Open

i = 10
Do While ASheet.Cells(i, 1) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"

    i = i + 1
    If i = 10000 Then
       MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| !"
       Exit Sub
    End If
Loop

NachStrok = i + 1

ASheet.Unprotect (SheetPassword)
For i = GetLastRow(ASheet) To NachStrok Step -1
   ASheet.Rows(i).Delete
Next i

i = ActiveWorkbook.Names("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefersToRange.Row
ASheet.Cells(i, 4) = ""
ASheet.Cells(i, 14) = ""
ASheet.Range("A" & i & ":N" & i).Rows.AutoFit
ASheet.[a11] = 0

Call pProtect(ASheet)
         
End Sub


Sub Userdata_Example()
 
 Dim ASheet As Worksheet
 
 Call Auto_Open
 
 Set ASheet = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
 
 ASheet.Cells(3, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|"

 ASheet.Cells(6, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
 ASheet.Cells(8, 5) = "|fffd||fffd||fffd||fffd|"
 ASheet.Cells(10, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 ASheet.Cells(12, 5) = "IvanovII@NorNik.ru"
 ASheet.Cells(14, 5) = "79260050505"
 ASheet.Cells(16, 5) = "74957875080"
 ASheet.Cells(18, 5) = "1234"
 ASheet.Cells(20, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 
 ASheet.Cells(6, 11) = "NPR\IvanovII"
 ASheet.Cells(8, 11) = "IVANOVII"
 ASheet.Unprotect (SheetPassword)
 ASheet.Cells(12, 11) = "31.12.9999"

 ASheet.Cells(14, 11) = "|fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" / OOO ""Direkciya proektami metalli Zabaikalia"""
 ASheet.Cells(16, 11) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ERP"
 ASheet.Cells(18, 11) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 ASheet.Cells(20, 11) = ""

 ASheet.[a7] = False
 ASheet.[a8] = False
 ASheet.[a9] = True
 ASheet.[a10] = False
 ASheet.[a11] = False
  Call Userdata_Clear2

 
 Call pProtect(ASheet)
 
 Call ClearAll_mid
 Call ClearAll_end
 

 
End Sub

Attribute VB_Name = "ZajPrint"
Option Explicit
Public XLSheet_Main As Worksheet

Sub Zaj_Print()

Dim NWBook As Workbook
Dim i As Integer

Set XLSheet_Main = Application.ActiveSheet
Set NWBook = Application.Workbooks.Add

Application.DisplayAlerts = False
Do While NWBook.Sheets.Count > 2
    NWBook.Sheets(NWBook.Sheets.Count).Delete
Loop
Do While NWBook.Sheets.Count < 2
    NWBook.Sheets.Add
Loop
NWBook.Sheets(1).Name = "|fffd||fffd||fffd||fffd||fffd||fffd|"
NWBook.Sheets(2).Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

With NWBook.Sheets(1)
    [b1] = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| SAP"
    [a3] = "|fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [b3] = XLSheet_Main.[I3]
    
    [a5] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [a6] = "|fffd||fffd||fffd|"
    [a7] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [a8] = "e-mail"
    [a9] = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|."
    [a10] = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd|."
    [a11] = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd|."
    [a12] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [a13] = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    [b5] = XLSheet_Main.[e6]
    [b6] = XLSheet_Main.[e8]
    [b7] = XLSheet_Main.[e10]
    [b8] = XLSheet_Main.[e12]
    [b9] = XLSheet_Main.[e14]
    [b10] = XLSheet_Main.[e16]
    [b11] = XLSheet_Main.[e18]
    [b12] = XLSheet_Main.[e20]
    [b13] = XLSheet_Main.[k12]

    [d5] = "|fffd||fffd||fffd||fffd||fffd| |fffd| NPR"
    [d6] = "|fffd||fffd||fffd||fffd||fffd| |fffd| SAP"
    [d7] = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    [e7] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [e8] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [e9] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    [d10] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [d11] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [d12] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    [d13] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"


    [e5] = XLSheet_Main.[k6]
    [e6] = XLSheet_Main.[k8]
    Call ZapRam([f7], XLSheet_Main.[a7])
    Call ZapRam([f8], XLSheet_Main.[a8])
    Call ZapRam([f9], XLSheet_Main.[a9])
    [e10] = XLSheet_Main.[k14]
    [e11] = XLSheet_Main.[k16]
    [e12] = XLSheet_Main.[k18]
    [e13] = XLSheet_Main.[k20]
    
 
    

     
    Range("B3:F3").Interior.ColorIndex = 19
    Range("B5:B13").Interior.ColorIndex = 19
    Range("E5:F6").Interior.ColorIndex = 19
    Range("F7:F9").Interior.ColorIndex = 19
    Range("E10:F13").Interior.ColorIndex = 19



    i = .Columns(1).ColumnWidth
    Columns(1).ColumnWidth = i * 3
    Columns(2).ColumnWidth = i * 2
    Columns(3).ColumnWidth = i * 0.5
    Columns(4).ColumnWidth = i * 2
    Columns(5).ColumnWidth = i * 1.5
    Columns(6).ColumnWidth = i * 0.22
    
    
    
End With


End Sub


Sub ZapRam(rez As Range, ist As Range)

Call RazgRangeG(rez, 1)
If ist Then
  RazgLine rez.Borders(xlDiagonalUp), 3
  RazgLine rez.Borders(xlDiagonalDown), 3
End If
End Sub

  
Attribute VB_Name = "ZajZap"
Option Explicit


Sub ZapisAll()
SheetPassword = "qwqw"
Dim i As Integer
Dim j As Integer

Dim Ins_R As String
Dim Del_R As String
Dim Ins_E As String
Dim Del_E As String

Dim Kod_S As String
Dim Kod_S_HANA As String

Dim priz As Boolean
Dim sStr As String
Dim sSs As String

Dim kol_ins As Integer
Dim kol_del As Integer

ReDim mas_Ins(1, 0) As Variant  ' |fffd||fffd||fffd||fffd||fffd| INS
ReDim mas_del(1, 0) As Variant  ' |fffd||fffd||fffd||fffd||fffd| DEL

Dim ParentRoli0 As String
Dim ParentRoli1 As String


    Ins_R = ","
    Del_R = ","
    Ins_E = ","
    Del_E = ","

    kol_ins = 0
    kol_del = 0

    Kod_S = ""
    Kod_S_HANA = ""
    
    
    
    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[e6] = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[e8] = "" Then
        MsgBox "|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[e10] = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[e12] = "" Then
        MsgBox "E_mail |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[k14] = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    ElseIf Not [a7] And Not [a8] And Not [a9] And Not [a10] And Not [a11] And Not [a13] And Not [a14] And Not [a15] And Not [a16] And Not [a17] Then
        MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    End If
    
    
    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(3, 9) <> "" Then
        For j = ActiveWorkbook.Names("T_Landsh").RefersToRange.Row To ActiveWorkbook.Names("T_Landsh").RefersToRange.Row + ActiveWorkbook.Names("T_Landsh").RefersToRange.Rows.Count - 1
            
            If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(3, 9) Then
                If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                   i = 7
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                   i = 8
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                   i = 9
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|" Then
                   i = 10
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|" Then
                   i = 11
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                   i = 13
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)" Then
                   i = 14
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)" Then
                   i = 15
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)" Then
                   i = 16
                ElseIf ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5) = "|fffd||fffd|-2 (|fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)" Then
                   i = 17
                Else
                   MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4) & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| !"
                   i = 12
                End If
                If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1) Then
                    Kod_S = Kod_S & "," & ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 6)
                    Kod_S_HANA = Kod_S_HANA & ", " & ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 7)
                End If
            End If
        Next j
        Kod_S = Mid(Kod_S, 2)
        Kod_S_HANA = Mid(Kod_S_HANA, 3)
    Else
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        Exit Sub
    End If
    i = 10
    
    ActiveSheet.Unprotect (SheetPassword)
    Do While ActiveSheet.Cells(i, 1) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        sStr = ActiveSheet.Cells(i, 3)
        sStr = Trim(sStr)
        
        If sStr <> "" Then
            If ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then
                Ins_R = Ins_R & sStr & ",_" & ActiveSheet.Cells(i, 11) & "_,"
            End If
            If ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then
                Del_R = Del_R & sStr & ","
            End If
            If ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
               Ins_E = Ins_E & Trim(Left(sStr, InStr(sStr, "-") - 1)) & ",_" & ActiveSheet.Cells(i, 11) & "_,"
            End If
            If ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                Del_E = Del_E & Trim(Left(sStr, InStr(sStr, "-") - 1)) & ",_" & ActiveSheet.Cells(i, 11) & "_,"
            End If
            i = i + 1
        Else
            If ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
               ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
               ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or _
               ActiveSheet.Cells(i, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
               ActiveSheet.Rows(i & ":" & i).RowHeight = 0
               i = i + 1
            Else
               i = i + 1
            End If
        End If
        
    
        If i = 10000 Then
            MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| !"
            Exit Sub
        End If
    Loop

   With Application
        .ScreenUpdating = False
        .EnableEvents = False
        .Calculation = xlCalculationManual
    End With
    
    
    Call ClearAll_end
    ActiveSheet.Unprotect (SheetPassword)
    
    NachStrok = i + 1
    Dim sTemp As String
    Dim sUnique As String
    sUnique = ""
    sTemp = ""
    For j = ActiveWorkbook.Names("T_FTexRol").RefersToRange.Row To ActiveWorkbook.Names("T_FTexRol").RefersToRange.Row + ActiveWorkbook.Names("T_FTexRol").RefersToRange.Rows.Count - 1
        sStr = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 3)
        sStr = Trim(sStr)
        If InStr(Ins_R, "," & sStr & ",") <> 0 Then
            sTemp = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5)
            If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[A1] <> 2 Or _
                (ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[A1] = 2 And _
                ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[I3] <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|") Or _
                (ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[A1] = 2 And _
                    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[I3] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|" And _
                    sTemp <> "Z_POA_BUI_FLEX_CLIENT" And _
                    sTemp <> "Z_POA_BUI_UM_USER" And _
                    sTemp <> "Z_BC_ALL_USERS") Then
                        If InStr(1, sUnique, sTemp) = 0 Then
                            ReDim Preserve mas_Ins(1, kol_ins)
                            mas_Ins(0, kol_ins) = sTemp
                            sUnique = sUnique & sTemp
                            sStr = Mid(Ins_R, InStr(Ins_R, "," & sStr & ",") + Len(sStr) + 3)
                            mas_Ins(1, kol_ins) = Left(sStr, InStr(sStr, "_") - 1)
                            kol_ins = kol_ins + 1
                        End If
            End If
        End If
    Next j
    
    If kol_ins > 0 Then Call QuickSortDoubleArray(mas_Ins, kol_ins - 1)
    
    
    
    Dim k As Long
    Dim sflag As Long
    sflag = 0
    sUnique = ""
    sTemp = ""
    k = 0
    For j = ActiveWorkbook.Names("T_FTexRol").RefersToRange.Row To ActiveWorkbook.Names("T_FTexRol").RefersToRange.Row + ActiveWorkbook.Names("T_FTexRol").RefersToRange.Rows.Count - 1
        sStr = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 3)
        sStr = Trim(sStr)
        sTemp = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 5).Value
        sflag = 0
        For k = 0 To kol_ins - 1
            If sTemp = mas_Ins(0, k) Then
                sflag = 1
                Exit For
            End If
        Next k
        If InStr(Del_R, "," & sStr & ",") <> 0 Then
            If sTemp <> "Z_POA_BUI_FLEX_CLIENT" And _
                sTemp <> "Z_POA_BUI_UM_USER" And _
                sTemp <> "Z_BC_ALL_USERS" And _
                sTemp <> "ZBPC_ZXU000001" Then
                    If sflag = 0 Then
                        If InStr(1, sUnique, sTemp) = 0 Then
                            ReDim Preserve mas_del(1, kol_del)
                            mas_del(0, kol_del) = sTemp
                            sUnique = sUnique & sTemp
                            kol_del = kol_del + 1
                        End If
                    End If
            End If
        End If
    Next j
    
    If kol_del > 0 Then Call QuickSortDoubleArray(mas_del, kol_del - 1)



    For j = ActiveWorkbook.Names("T_OrgRol").RefersToRange.Row To ActiveWorkbook.Names("T_OrgRol").RefersToRange.Row + ActiveWorkbook.Names("T_OrgRol").RefersToRange.Rows.Count - 1
         
        If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4) <> "" Then
            sStr = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4)
            sStr = Trim(sStr)
            If InStr(Ins_E, "," & sStr & ",") <> 0 Then
                sSs = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 6) & ","
                sStr = Mid(Ins_E, InStr(Ins_E, "," & sStr & ",") + Len(sStr) + 3)
                sStr = Left(sStr, InStr(sStr, "_") - 1)
                Do While InStr(sSs, ",") <> 0
                    ReDim Preserve mas_Ins(1, kol_ins)
                    mas_Ins(0, kol_ins) = Left(sSs, InStr(sSs, ",") - 1)
                    mas_Ins(1, kol_ins) = sStr
                    kol_ins = kol_ins + 1
                    sSs = Mid(sSs, InStr(sSs, ",") + 1)
                Loop
            End If
        End If
    Next j
    
            
    For j = ActiveWorkbook.Names("T_OrgRol").RefersToRange.Row To ActiveWorkbook.Names("T_OrgRol").RefersToRange.Row + ActiveWorkbook.Names("T_OrgRol").RefersToRange.Rows.Count - 1
         
        If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4) <> "" Then
            sStr = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4)
            sStr = Trim(sStr)
            If InStr(Del_E, "," & sStr & ",") <> 0 Then
                sSs = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 6) & ","
                sStr = Mid(Del_E, InStr(Del_E, "," & sStr & ",") + Len(sStr) + 3)
                
                sStr = Left(sStr, InStr(sStr, "_") - 1)
                
                Do While InStr(sSs, ",") <> 0
                    ReDim Preserve mas_del(1, kol_del)
                    mas_del(0, kol_del) = Left(sSs, InStr(sSs, ",") - 1)
                    kol_del = kol_del + 1
                    sSs = Mid(sSs, InStr(sSs, ",") + 1)
                Loop
           End If
        End If
    Next j
    
    
    If kol_ins <> 0 Then
        Call zag00("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", 1)
        For i = 0 To kol_ins - 1
        
            If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[I3] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|" Then
                ActiveSheet.Cells(NachStrok, 1) = "'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                ActiveSheet.Cells(NachStrok, 2) = i + 1
                ActiveSheet.Cells(NachStrok, 3) = mas_Ins(0, i)
                ActiveSheet.Cells(NachStrok, 6) = findroledescr(Trim(mas_Ins(0, i)))
                ActiveSheet.Cells(NachStrok, 10) = Kod_S
                
                ActiveSheet.Cells(NachStrok, 14).NumberFormat = "m/d/yyyy"
                ActiveSheet.Range("C" & NachStrok & ":E" & NachStrok).MergeCells = True
                ActiveSheet.Range("F" & NachStrok & ":I" & NachStrok).MergeCells = True
                ActiveSheet.Range("J" & NachStrok & ":M" & NachStrok).MergeCells = True
    
    
                ActiveSheet.Cells(NachStrok, 14) = mas_Ins(1, i)
                
                Call RazgRangeG(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 1)
                ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok).Font.Size = 8
            Else
                ActiveSheet.Cells(NachStrok, 1) = ""
                ActiveSheet.Cells(NachStrok, 2) = i + 1
                ActiveSheet.Cells(NachStrok, 3) = mas_Ins(0, i)
                
                If InStr(1, mas_Ins(0, i), "::") = 0 Then
                    ActiveSheet.Cells(NachStrok, 9) = Kod_S
                Else
                    ActiveSheet.Cells(NachStrok, 9) = Kod_S_HANA
                    ActiveSheet.Cells(NachStrok, 9).WrapText = True
                End If
                
                
                ActiveSheet.Cells(NachStrok, 11).NumberFormat = "m/d/yyyy"
                ActiveSheet.Range("K" & NachStrok & ":M" & NachStrok).MergeCells = True
                
                ActiveSheet.Cells(NachStrok, 11) = mas_Ins(1, i)
                
                Call RazgRangeG(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 1)

            End If
            NachStrok = NachStrok + 1
        Next i
    End If
    
    If kol_del <> 0 Then
        Call zag00("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", 2)
        For i = 0 To kol_del - 1
            
            If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[I3] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|" Then
            
                ActiveSheet.Cells(NachStrok, 1) = "'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                ActiveSheet.Cells(NachStrok, 2) = i + 1
                ActiveSheet.Cells(NachStrok, 3) = mas_del(0, i)
                ActiveSheet.Cells(NachStrok, 6) = findroledescr(Trim(mas_del(0, i)))
                ActiveSheet.Cells(NachStrok, 10) = Kod_S
                ActiveSheet.Cells(NachStrok, 14).NumberFormat = "m/d/yyyy"
                ActiveSheet.Range("C" & NachStrok & ":E" & NachStrok).MergeCells = True
                ActiveSheet.Range("F" & NachStrok & ":I" & NachStrok).MergeCells = True
                ActiveSheet.Range("J" & NachStrok & ":M" & NachStrok).MergeCells = True
                ActiveSheet.Cells(NachStrok, 14) = mas_del(1, i)
                
                
                ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok).Font.Size = 8
                
                Call RazgRangeG(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 1)
            
            Else
                ActiveSheet.Cells(NachStrok, 1) = ""
                ActiveSheet.Cells(NachStrok, 2) = i + 1
                ActiveSheet.Cells(NachStrok, 3) = mas_del(0, i)
                ActiveSheet.Cells(NachStrok, 9) = Kod_S
                   
                Call RazgRangeG(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 1)
            End If
            NachStrok = NachStrok + 1
        Next i
    End If
    
    
''''    ParentRoli0 = ""
''''    ParentRoli1 = ""
''''
''''    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
''''    For j = ActiveWorkbook.Names("BizRol").RefersToRange.Row To ActiveWorkbook.Names("BizRol").RefersToRange.Row + ActiveWorkbook.Names("BizRol").RefersToRange.Rows.Count - 1
''''      sStr = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Cells(j, 3)
''''      sStr = "," & Trim(sStr) & ","
''''
''''      If InStr(Ins_R, sStr) <> 0 Or InStr(Del_R, sStr) <> 0 Then
''''        ParentRoli0 = ParentRoli0 & ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Cells(j, 5) & Chr(10)
''''        ParentRoli1 = ParentRoli1 & "A" & Chr(10)
''''      End If
''''    Next j
''''
''''    j = ActiveWorkbook.Names("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefersToRange.Row
''''    ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 4) = ParentRoli0
''''    ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 14) = ParentRoli1
''''
''''    Range("A" & j & ":N" & j).Rows.AutoFit
    
    ActiveSheet.PageSetup.PrintArea = "$A$1:$N$" & NachStrok - 1
    
    ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[a11] = 1
    
    Call pProtect(ActiveSheet)
    
    With Application
        .ScreenUpdating = True
        .EnableEvents = True
        .Calculation = xlCalculationAutomatic
    End With
    
    
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| !", vbInformation
   
End Sub


Sub zag00(s As String, m As Integer)

    If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[I3] = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd|" Then
    

        ActiveSheet.Cells(NachStrok, 1) = s
        ActiveSheet.Cells(NachStrok, 2) = "|fffd|"
        ActiveSheet.Cells(NachStrok, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        ActiveSheet.Cells(NachStrok, 10) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        ActiveSheet.Cells(NachStrok, 6) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    
        If m = 1 Then
            ActiveSheet.Cells(NachStrok, 14) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        Call zagalovok0(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok))
        ActiveSheet.Range("C" & NachStrok & ":E" & NachStrok).MergeCells = True
        ActiveSheet.Range("F" & NachStrok & ":I" & NachStrok).MergeCells = True
        ActiveSheet.Range("J" & NachStrok & ":M" & NachStrok).MergeCells = True
        Call RazgRange(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 2)
        ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok).Font.Size = 10
        
    Else
        ActiveSheet.Cells(NachStrok, 1) = s
        ActiveSheet.Cells(NachStrok, 2) = "|fffd|"
        ActiveSheet.Cells(NachStrok, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        ActiveSheet.Cells(NachStrok, 9) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        If m = 1 Then
            ActiveSheet.Cells(NachStrok, 10) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        Call zagalovok0(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok))
        ActiveSheet.Range("C" & NachStrok & ":F" & NachStrok).MergeCells = True
        ActiveSheet.Range("G" & NachStrok & ":H" & NachStrok).MergeCells = True
        ActiveSheet.Range("J" & NachStrok & ":N" & NachStrok).MergeCells = True
        Call RazgRange(ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok), 2)
        ActiveSheet.Range("A" & NachStrok & ":N" & NachStrok).Font.Size = 10
    End If
    NachStrok = NachStrok + 1
    
End Sub
    
Sub DelZag00(s As String)
   If ActiveSheet.Cells(NachStrok - 1, 1) = s Then
       NachStrok = NachStrok - 1
       ActiveSheet.Rows(NachStrok).Delete
   End If
End Sub

Function findroledescr(ByVal s As String) As String
    Dim i As Long
    Dim res As String
    res = ""
    i = 1
    While ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Cells(i, 1).Value <> ""
        If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Cells(i, 1).Value = s Then
         res = res & ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Cells(i, 2).Value & "; "
         End If
        i = i + 1
    Wend
    If res = "" Then
        res = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        res = Left(res, Len(res) - 2)
    End If
    findroledescr = res
End Function


    
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Activate()
    Application.DisplayAlerts = False
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Dim x As Integer
Dim i As Integer
Dim j As Integer
Dim sStr As String


On Error GoTo Wixod
SheetPassword = "qwqw"
Application.EnableEvents = False
'************************************************************
If Target.Row() = 3 And Target.Column() = 9 Then
   sStr = Target.Formula
   ActiveSheet.Shapes("Check Box 7").Visible = InStr(sStr, "(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)") = 0
   
   If sStr <> ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 9).Value Then
     
     ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Unprotect (SheetPassword)
     ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Unprotect (SheetPassword)
     
     
     ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 9).Value = sStr
     
     i = 2
     j = 0
     Do While ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 13).Value <> ""
       If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 13).Value = sStr Then j = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 15).Value
       i = i + 1
     Loop

     sStr = j
    
     ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[a20] = sStr
             
     i = 6
     x = 2
     '**
     Do While ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Cells(i, 8).Value <> ""
        If InStr(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Cells(i, 8).Value, sStr) <> 0 Then
           ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 10) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Cells(i, 3).Value
           x = x + 1
        End If
        i = i + 1
     Loop
     If x = 2 Then
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 10).Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        x = x + 1
     End If
     ActiveWorkbook.Names("BizRol").RefersToR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'!R2C10:R" & (x - 1) & "C10"
     
     '**
     i = 5
     x = 0
     
     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 21.09.2017
     Dim ts As String
     ts = ""
     Dim tsmas(1000) As String
     Do While ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 7).Value <> ""
        If InStr(1, ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 7).Value, sStr) <> 0 Then
            If InStr(1, ts, ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 3).Text) = 0 Then
                tsmas(x) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 3).Text
                ts = ts & tsmas(x)
                x = x + 1
           End If
        End If
        i = i + 1
     Loop
     Call QuickSort(tsmas, LBound(tsmas), x)
     
     For i = 0 To x
         ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i + 1, 11).Value = tsmas(i)
     Next i
     
     
     
     
     x = x + 2
     If x = 2 Then
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 11).Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        x = x + 1
     End If
     ActiveWorkbook.Names("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefersToR1C1 = "='|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'!R2C11:R" & (x - 1) & "C11"
    
     Call pProtect(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"))
     Call pProtect(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|"))
    
   End If
End If
'************************************************************
If Target.Row() = 20 And Target.Column() = 5 Then
    ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Unprotect (SheetPassword)
    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(20, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(12, 11) = DateSerial(Year(Now()), Month(Now()), Day(Now()))
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(12, 11).Interior.ColorIndex = 19
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K12:M12").Locked = False
    Else
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(12, 11) = "31.12.9999"
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(12, 11).Interior.ColorIndex = 19 '15
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range("K12:M12").Locked = True
    End If
    Call pProtect(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|"))
End If

'************************************************************
If Target.Column() = 3 Then
    x = Target.Row()
    
    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then
        i = 29
        ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 8) = ""
        Do While ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 1) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
            If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 15) <> "" Then
                For j = i To 28 Step -1
                    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j, 15) <> "" Then
                        If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(Cells(j, 15), Cells(i, 15)).Value <> "" Then
                            sStr = """" & Cells(j, 3) & """ |fffd| """ & Cells(i, 3) & """, "
                            If InStr(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 8).Text, sStr) = 0 Then
                                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 8) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 8) & sStr & Chr(10)
                            End If
                        End If
                    End If
                Next j
            End If
            i = i + 1
        Loop
     ''''    Range("A" & j & ":N" & j).Rows.AutoFit
    End If
    
    If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 3) <> "" Then
        If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Or _
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or _
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Unprotect (SheetPassword)
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").[a11] = 0
            If ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x + 1, 1) = "" Or ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x + 1, 1) = "@@@1" Then
                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Rows(x + 1).Select
                Selection.Insert Shift:=xlDown
                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Rows(x).Copy
                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Rows(x + 1).PasteSpecial Paste:=xlPasteAll
                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x + 1, 2) = ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x + 1, 2) + 1
                ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(x + 1, 3) = ""
            End If
            Call pProtect(ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|"))
        End If
    End If
End If
'************************************************************
If Target.Column() = 11 And Target.Row() = 12 Then
sStr = Target.Formula
If Not IsDate(sStr) Then
If Len(sStr) = 8 Or Len(sStr) = 6 Then Target = Left(sStr, 2) & "." & Mid(sStr, 3, 2) & "." & Mid(sStr, 5)
   'Target = DateSerial(Mid(sStr, 5), Mid(sStr, 3, 2), Left(sStr, 2))
End If
sStr = Target.Formula
If Not sStr = "" Then
If Not IsDate(sStr) Then
  MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End If
End If

Wixod:

Application.EnableEvents = True


End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
''  Application.EnableEvents = False
''  If Target.Row() = 12 And Target.Column() = 11 Then
''    ActiveSheet.Unprotect (SheetPassword)
''    If Target.Parent.Cells(20, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
''       Range("K12:M12").Locked = True
''    Else
''       Range("K12:M12").Locked = False
''    End If
''  End If
''  Application.EnableEvents = True
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "FPMExcelClientSheetOptionstb1, 1, 0, MSForms, TextBox"
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "FPMExcelClientSheetOptionstb1, 1, 0, MSForms, TextBox"
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()

    Application.Calculation = xlCalculationAutomatic

End Sub


INQUEST-PP=macro
