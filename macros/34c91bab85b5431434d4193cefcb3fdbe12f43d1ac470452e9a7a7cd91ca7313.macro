Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Sub Case|fffd|cocher2_Clic()
 
'Case |fffd| cocher 2
'---------------
If Range("A4").Value = True Then
    'Il s'agit d'une seule soci|fffd|t|fffd|
    Range("B4").Value = False 'D|fffd|sactive la case Consortium
    Range("A5").Value = "Soci|fffd|t|fffd|"
    Range("A6").Value = "Soci|fffd|t|fffd|"
    
    'Cache les lignes pour le consortium
    Rows("15:140").EntireRow.Hidden = True
    If WorkSheetExist("Titre") Then Worksheets("Titre").Rows("19:46").Hidden = True
    If WorkSheetExist("Q_CA") Then Worksheets("Q_CA").Rows("8:35").Hidden = True
Else
    'il s'agit d'un consortium
    Range("B4").Value = True
    Range("A5").Value = "Communaut|fffd| de soumissionnaires"
    Range("A6").Value = "Soci|fffd|t|fffd| Pilote"

    'Affiche les lignes 13-148 pour les consortium
    Rows("15:140").EntireRow.Hidden = False
    If WorkSheetExist("Titre") Then Worksheets("Titre").Rows("19:46").Hidden = False
    If WorkSheetExist("Q_CA") Then Worksheets("Q_CA").Rows("8:35").Hidden = False
End If

End Sub
Sub Case|fffd|cocher1_Clic()

'Case |fffd| cocher 1
'---------------
If Range("B4").Value = True Then
    'il s'agit d'un consortium
    Range("B4").Value = True
    Range("A5").Value = "Communaut|fffd| de soumissionnaires"
    Range("A6").Value = "Soci|fffd|t|fffd| Pilote"

    'Affiche les lignes 13-148 pour les consortium
    Rows("15:140").EntireRow.Hidden = False
    If WorkSheetExist("Titre") Then Worksheets("Titre").Rows("19:46").Hidden = False
    If WorkSheetExist("Q_CA") Then Worksheets("Q_CA").Rows("8:35").Hidden = False
Else
    'Il s'agit d'une seule soci|fffd|t|fffd|
    Range("B4").Value = False 'D|fffd|sactive la case Consortium
    Range("A5").Value = "Soci|fffd|t|fffd|"
    Range("A6").Value = "Soci|fffd|t|fffd|"
    
    'Cache les lignes pour le consortium
    Rows("15:140").EntireRow.Hidden = True
    If WorkSheetExist("Titre") Then Worksheets("Titre").Rows("19:46").Hidden = True
    If WorkSheetExist("Q_CA") Then Worksheets("Q_CA").Rows("8:35").Hidden = True
End If

End Sub

Sub Prot|fffd|ger()
' Protection automatique de toutes les feuilles du classeur
Dim Motdepasse As String

Motdepasse = "ofrou"
For Each I In Worksheets
    I.Protect Password:=Motdepasse, AllowFormattingRows:=True
Next

If WorkSheetExist("Donn|fffd|es de base") Then Worksheets("Donn|fffd|es de base").Visible = False

End Sub

Sub D|fffd|prot|fffd|ger()
Attribute D|fffd|prot|fffd|ger.VB_ProcData.VB_Invoke_Func = "w\n14"
' D|fffd|protection automatique de toutes les feuilles d'un classeur
Dim Motdepasse As String

Motdepasse = "ofrou"
For Each I In Worksheets
    I.Unprotect Password:=Motdepasse
Next

If WorkSheetExist("Donn|fffd|es de base") Then Worksheets("Donn|fffd|es de base").Visible = True

End Sub

Function WorkSheetExist(Sheetname As String) As Boolean
'Teste l'existe de la feuille (onglet)
Dim wSheet As Worksheet
 
On Error Resume Next

Set wSheet = Sheets(Sheetname)
If wSheet Is Nothing Then
    WorkSheetExist = False
    On Error GoTo 0
Else 'Does exist
    WorkSheetExist = True
    On Error GoTo 0
End If

Set wSheet = Nothing
End Function

Attribute VB_Name = "Module2"
Sub CompositionIndex()
'Cette proc|fffd|dure permet de lister tous les onglets et de les inscrire dans l'Index dans l'ordre d|fffd|fini par l'ordre des onglets

Dim Feuille As Worksheet
Dim FeuilleData As Worksheet
Dim FeuilleIndex As Worksheet

Dim strFeuilleData As String
Dim strFeuilleTitre As String
Dim strFeuilleIndex As String
Dim strFeuilleVierge As String

Dim intLigneIndex As Integer
Dim incr As Integer

strFeuilleData = "Donn|fffd|es de base"
strFeuilleTitre = "Titre"
strFeuilleIndex = "Index"
strFeuilleVierge = "Vierge"

'D|fffd|but de la liste des onglets /feuilles
intLigneIndex = Range("Premi|fffd|reLigneIndex").Row
incr = 0

Set FeuilleData = Sheets(strFeuilleData)
Set FeuilleIndex = Sheets(strFeuilleIndex)

'On efface l'index
With FeuilleData
    .Range("A" & intLigneIndex & ":D" & intLigneIndex + 37).ClearContents
End With

For Each Feuille In ThisWorkbook.Worksheets

    If Feuille.Name = strFeuilleData Or Feuille.Name = strFeuilleTitre Or Feuille.Name = strFeuilleIndex Or Feuille.Name = strFeuilleVierge Then
        'on fait rien car ces feuilles ne doivent pas appara|fffd|tre dans l'index (Titre, Index, Vierge et donn|fffd|es de base)
    Else
        If Feuille.Visible = True Then
            incr = incr + 1
            With FeuilleData
                .Cells(intLigneIndex, 1) = incr
                .Cells(intLigneIndex, 2) = Feuille.Cells(1, 15)
                .Cells(intLigneIndex, 3) = Feuille.Cells(1, 1)
            End With
            intLigneIndex = intLigneIndex + 1
        End If
    End If
Next Feuille

FeuilleIndex.PageSetup.PrintArea = "$A$2:$D$" & incr + 1

End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
