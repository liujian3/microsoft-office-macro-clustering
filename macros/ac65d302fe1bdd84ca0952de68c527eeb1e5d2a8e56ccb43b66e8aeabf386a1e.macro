Attribute VB_Name = "Module1"
Public check As Boolean
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub Workbook_Open()
Application.DisplayAlerts = False
Application.Calculation = xlManual
Application.Interactive = False

check = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
 ThisWorkbook.Unprotect Password:=22
For Each sh In ThisWorkbook.Sheets
    If Not sh.Name Like "WARNING" Then
        sh.Visible = -1
    End If
Next sh
For Each sh In ThisWorkbook.Sheets
    If sh.Name Like "WARNING" Then
        sh.Visible = 2
    End If
Next sh
ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False

Application.ScreenUpdating = False
        Set shA = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
            shA.Activate
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If shA.ProtectContents = False Then
                shA.Protect 22, DrawingObjects:=True, Contents:=True, Scenarios:=True, UserInterfaceOnly:=True, _
                AllowFormattingColumns:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    End If
    If ThisWorkbook.ProtectStructure = False Then
        ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False
    End If
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If ThisWorkbook.Path = "" Then
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
                Application.Interactive = True
                check = True
                ThisWorkbook.Close , False
        End If
        If ThisWorkbook.FullName Like "*AppData*" Then
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
                Application.Interactive = True
                check = True
                ThisWorkbook.Close , False
        End If
        
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then
        ThisWorkbook.Unprotect Password:="22"
        shA.Unprotect Password:="22"
    End If
    shA.Columns(12).Locked = False
Application.ScreenUpdating = True
Application.DisplayAlerts = True
Application.Interactive = True
End Sub
Public Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
If Application.ScreenUpdating = True Then Application.ScreenUpdating = False
Application.StatusBar = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
Set shA = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
shA.Calculate
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
For Each sh In ThisWorkbook.Sheets
    For Each PT In sh.PivotTables
        PT.PivotCache.Refresh
        PT.SaveData = True
    Next PT
Next sh
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Set shA = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
            r = shA.Cells.Find("|fffd||fffd||fffd||fffd||fffd|:", SearchOrder:=xlByColumns).Row - 1
            mProg = Array("|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Discount", "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|)", "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|)", _
                          "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Discount", "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            For i = 1 To shA.UsedRange.Columns.Count
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS*" Then c1 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c2 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c3 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|*" Then c4 = i
            Next i
                For i = 6 To r
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    If shA.Cells(i, c) <> "" Then
                        If IsDate(shA.Cells(i, c)) = True Then
                        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = True
                        Else:
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & vbNewLine & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: 25.01.2016", vbCritical
                            shA.Cells(i, c).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                    End If
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS
                        If shA.Cells(i, c1) <> "" Then
                        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = True: shA.Cells(i, c2).Locked = True
                        Else:
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = False: shA.Cells(i, c2).Locked = False
                        End If
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If shA.Cells(i, c2) <> "" And (Not shA.Cells(i, c2) Like "*|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*") Then
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & "", vbCritical
                            shA.Cells(i, c2).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Or shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Then
                            For m = 0 To UBound(mProg)
                               If mProg(m) Like shA.Cells(i, c3) Then
                                    If (m Mod 2) = 1 Then shA.Cells(i, c3) = mProg(m - 1): shA.Cells(i, c3).Interior.Color = 13088573 ' |fffd||fffd||fffd||fffd||fffd|
                               End If
                            Next m
                        End If
                        If shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Or shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then
                            For m = 0 To UBound(mProg)
                               If mProg(m) Like shA.Cells(i, c3) Then
                                    If (m Mod 2) = 0 And m < 8 Then shA.Cells(i, c3) = mProg(m + 1): shA.Cells(i, c3).Interior.Color = 13088573 '|fffd||fffd||fffd|
                               End If
                            Next m
                        End If
                    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|.
                     With shA.Cells(i, c)
                     On Error Resume Next
                        If .Locked = True Then .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Else .Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                     On Error GoTo 0
                    End With
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                       If shA.Cells(i, c4) < 0 Then
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
                            shA.Cells(i, c4).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                Next i
        ThisWorkbook.Unprotect Password:=22
ii = ThisWorkbook.ActiveSheet.Index
Application.EnableEvents = False
If Application.ScreenUpdating = True Then Application.ScreenUpdating = False
If Application.Interactive = True Then Application.Interactive = False
ThisWorkbook.Unprotect Password:=22
If SaveAsUI = False Then
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            For Each sh In ThisWorkbook.Sheets
                If sh.Name Like "WARNING" Then
                        sh.Visible = True
                End If
            Next sh
            For Each sh In ThisWorkbook.Sheets
                If Not sh.Name Like "WARNING" Then
                        sh.Visible = 2
                End If
            Next sh
    ThisWorkbook.Sheets(ii).Activate
    ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ThisWorkbook.Save
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    ThisWorkbook.Unprotect Password:=22
            For Each sh In ThisWorkbook.Sheets
                If Not sh.Name Like "WARNING" Then
                    sh.Visible = -1
                End If
            Next sh
            For Each sh In ThisWorkbook.Sheets
                If sh.Name Like "WARNING" Then
                    sh.Visible = 2
                End If
            Next sh
    ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    Application.Interactive = True
    Application.StatusBar = False
    ThisWorkbook.Saved = True
Else:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!", vbCritical
    ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    Application.Interactive = True
    Application.StatusBar = False
End If
Cancel = True
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then
        ThisWorkbook.Unprotect Password:="22"
        shA.Unprotect Password:="22"
    End If
End Sub
Public Sub Workbook_BeforeClose(Cancel As Boolean)
If check = True Then
    ThisWorkbook.Saved = True
    GoTo ExitHandler
End If
If Application.ScreenUpdating = True Then Application.ScreenUpdating = False
If Application.DisplayAlerts = True Then Application.DisplayAlerts = False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If ThisWorkbook.Saved = True And Not ThisWorkbook.FullName Like "*AppData*" Then
    GoTo ExitHandler
Else:
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case MsgBox( _
                "C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & ThisWorkbook.Name & "?", _
                vbExclamation + vbYesNoCancel)
    Case vbYes
        If ThisWorkbook.Path = "" Then
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
            GoTo ExitHandler
        End If
        If ThisWorkbook.FullName Like "*AppData*" Then
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
                GoTo ExitHandler
        End If
    Application.StatusBar = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
        If Application.Interactive = True Then Application.Interactive = False
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    For Each sh In ThisWorkbook.Sheets
        For Each PT In sh.PivotTables
            PT.PivotCache.Refresh
            PT.SaveData = True
        Next PT
    Next sh
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Set shA = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
        shA.Calculate
            r = shA.Cells.Find("|fffd||fffd||fffd||fffd||fffd|:", SearchOrder:=xlByColumns).Row - 1
            mProg = Array("|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Discount", "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|)", "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|)", _
                          "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Discount", "|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "Off-trade |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", _
                          "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            For i = 1 To shA.UsedRange.Columns.Count
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS*" Then c1 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c2 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c3 = i
                If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|*" Then c4 = i
            Next i
                For i = 6 To r
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    If shA.Cells(i, c) <> "" Then
                        If IsDate(shA.Cells(i, c)) = True Then
                        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = True
                        Else:
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & vbNewLine & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: 25.01.2016", vbCritical
                            shA.Cells(i, c).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                    End If
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS
                        If shA.Cells(i, c1) <> "" Then
                        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|  |fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = True: shA.Cells(i, c2).Locked = True
                        Else:
                            If LCase(Environ("USERNAME")) = "sergey.batishev" Or LCase(Environ("USERNAME")) = "elena.prihodko" Or LCase(Environ("USERNAME")) = "natalya.sliepchenko" Or LCase(Environ("USERNAME")) = "pugachya" Or LCase(Environ("USERNAME")) = "treytyir" Or LCase(Environ("USERNAME")) = "gorokhna" Or LCase(Environ("USERNAME")) = "popovaan" Or LCase(Environ("USERNAME")) = "denisyel" Or LCase(Environ("USERNAME")) = "novitsek" Or LCase(Environ("USERNAME")) = "marina.vasileva" Or LCase(Environ("USERNAME")) = "chajkael" Then shA.Cells(i, c).Locked = False: shA.Cells(i, c2).Locked = False
                        End If
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If shA.Cells(i, c2) <> "" And (Not shA.Cells(i, c2) Like "*|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" And Not shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*") Then
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(34) & "", vbCritical
                            shA.Cells(i, c2).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Or shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Then
                            For m = 0 To UBound(mProg)
                               If mProg(m) Like shA.Cells(i, c3) Then
                                    If (m Mod 2) = 1 Then shA.Cells(i, c3) = mProg(m - 1): shA.Cells(i, c3).IFnterior.Color = 13088573 ' |fffd||fffd||fffd||fffd||fffd|
                               End If
                            Next m
                        End If
                        If shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Or shA.Cells(i, c2) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then
                            For m = 0 To UBound(mProg)
                               If mProg(m) Like shA.Cells(i, c3) Then
                                    If (m Mod 2) = 0 And m < 8 Then shA.Cells(i, c3) = mProg(m + 1): shA.Cells(i, c3).Interior.Color = 13088573 '|fffd||fffd||fffd|
                               End If
                            Next m
                        End If
                    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|.
                     With shA.Cells(i, c)
                     On Error Resume Next
                        If .Locked = True Then .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Else .Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                     On Error GoTo 0
                    End With
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                       If shA.Cells(i, c4) < 0 Then
                            MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Chr(34) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|" & Chr(34) & " |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
                            shA.Cells(i, c4).Activate
                            Cancel = True
                            Application.StatusBar = False
                            If Application.Interactive = False Then Application.Interactive = True
                            Exit Sub
                        End If
                Next i
        ThisWorkbook.Unprotect Password:=22
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        If Application.ScreenUpdating = True Then Application.ScreenUpdating = False
            For Each sh In ThisWorkbook.Sheets
                If sh.Name Like "WARNING" Then
                        sh.Visible = True
                End If
            Next sh
            For Each sh In ThisWorkbook.Sheets
                If Not sh.Name Like "WARNING" Then
                        sh.Visible = 2
                End If
            Next sh
    ThisWorkbook.Protect Password:=22, Structure:=True, Windows:=False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Application.EnableEvents = False
                ThisWorkbook.Save
            Application.EnableEvents = True
    Application.StatusBar = False
    Case vbNo
        ThisWorkbook.Saved = True
    Case Else
        Cancel = True
        GoTo ExitHandler
    End Select
End If
ExitHandler:
If Application.Interactive = False Then Application.Interactive = True
If Application.DisplayAlerts = False Then Application.DisplayAlerts = True
If Application.AskToUpdateLinks = False Then Application.AskToUpdateLinks = True
If Application.ScreenUpdating = False Then Application.ScreenUpdating = True
End Sub
Private Sub Workbook_BeforePrint(Cancel As Boolean)
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd|" Then
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" & vbNewLine & vbNewLine & _
    "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:" & vbNewLine & vbNewLine & _
    "-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;" & vbNewLine & vbNewLine & _
    "-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;" & vbNewLine & vbNewLine & _
    "-|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|;" & vbNewLine & vbNewLine & _
    "-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.", vbExclamation + vbYesNo)
        Case vbYes
            GoTo chang
        Case vbNo
            Exit Sub
    End Select
chang:
Dim masHid() As Integer
Application.DisplayAlerts = False
Application.ScreenUpdating = False
    Set shA = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
    Cancel = True
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    c = 0
    For i = 1 To 50
        If shA.Cells(1, i).EntireColumn.Hidden = True Then
            shA.Cells(1, i).EntireColumn.Hidden = False
            c = c + 1
            ReDim Preserve masHid(c)
            masHid(c) = i
        End If
    Next i
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 1 To shA.UsedRange.Columns.Count
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then c1 = i
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| TM |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*% |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*DSM*" Then shA.Cells(5, i).EntireColumn.Hidden = True: |fffd|3 = i
            If shA.Cells(5, i) Like "*TSS*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS*" Then shA.Cells(5, i).EntireColumn.Hidden = True: c2 = i
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd|*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| TM BSC*" Then shA.Cells(5, i).EntireColumn.Hidden = True
            If shA.Cells(5, i) Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.*" Then c4 = i
    Next i
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| TS (|fffd||fffd||fffd||fffd||fffd||fffd|) |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
       shA.Rows(5).AutoFilter Field:=c2, Criteria1:="="
       shA.Rows(5).AutoFilter Field:=c1, Criteria1:="<>"
       shA.Calculate
     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| autofit
     shirina = shA.Columns(c4).ColumnWidth
     shA.Cells(1, c4).EntireColumn.AutoFit
       
       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For Each cell In shA.Columns(c4 - 2).Cells
    If cell = "|fffd||fffd||fffd||fffd||fffd|:" Then r1 = cell.Row + 3: cc = cell.Column
Next cell
Range(shA.Cells(r1, |fffd|3), shA.Cells(r1 + 7, |fffd|3 + 4)).Copy
Range(shA.Cells(r1, cc + 1), shA.Cells(r1 + 7, cc + 5)).PasteSpecial xlPasteValues
Range(shA.Cells(r1, cc + 1), shA.Cells(r1 + 7, cc + 5)).PasteSpecial xlPasteFormats
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
r = r1 + 15
With shA.PageSetup
PrintRang = .PrintArea
    Application.PrintCommunication = False
        .PrintTitleRows = ""
        .PrintTitleColumns = ""
        .PrintArea = Range(shA.Cells(1, 1), shA.Cells(r, c1)).Address
        .Orientation = xlPortrait
        .RightHeader = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  &P |fffd||fffd| &N"
    Application.PrintCommunication = True
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
On Error GoTo ExitHandler
    Application.EnableEvents = False
        shA.PrintOut Copies:=1, Collate:=True
    Application.EnableEvents = True
ExitHandler:
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Application.PrintCommunication = False
        .PrintArea = PrintRang
        .Orientation = xlLandscape
    Application.PrintCommunication = True
 End With
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
shA.Cells.EntireColumn.Hidden = False
        For i = 1 To c
            shA.Cells(1, masHid(i)).EntireColumn.Hidden = True
        Next i
shA.Columns(c4).ColumnWidth = shirina
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Range(shA.Cells(r1, cc + 1), shA.Cells(r1 + 7, cc + 5)).ClearContents
 On Error Resume Next
  shA.ShowAllData
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Erase masHid
    Exit Sub
End If
End Sub






INQUEST-PP=macro
