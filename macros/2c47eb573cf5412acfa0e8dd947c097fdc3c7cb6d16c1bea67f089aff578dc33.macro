Attribute VB_Name = "EstaPasta_de_trabalho"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

































Attribute VB_Name = "M|fffd|d11Ident"
Public Identifi As Range
Public nInd As Single

Public Sub IdentificVBA()
    NomeArqHist = "Identifi.hst"
    Set Identifi = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Identifi")
    Application.ScreenUpdating = False
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value)    'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, True) Then
        ActiveWindow.Close False
    End If
    Application.ScreenUpdating = True
    'Ajuda
    I = InStr(1, Identifi(2).Value, "!"): bHtmlHelp = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("bHtmlHelp").Value
    'Com o proj. proteg. essa instru|fffd||fffd|o falha. A solu|fffd||fffd|o foi colocar ..\cpap.hlp nas propriedades e fazer o diret|fffd|rio do cpap ativo.
    'Application.VBE.VBProjects("VBAProjectCxIdent").HelpFile = Left(Identifi(2).Value, I - 1)
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDrive ThisWorkbook.Path
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDir ThisWorkbook.Path Else Application.Run "CPAP_EX8.MAC!DirectoryVBA", ThisWorkbook.Path, False
    nInd = Identifi(5).Value   'Aqui porque a pr|fffd|x. aciona o evento inicialize do form.
    UserForm1Ident.HelpContextID = Right(Identifi(2).Value, Len(Identifi(2).Value) - I)

    UserForm1Ident.Data_Cb.Value = Format(DateValue(Identifi(3).Value), "dd/mm/yy")
    'UserForm1Ident.|fffd|ndice_Cb.Value = Identifi(5).Value
    UserForm1Ident.UMonet_Cb.Value = Identifi(6).Value
    UserForm1Ident.Extenso_Cb.Value = Identifi(7).Value
    UserForm1Ident.Cliente_Cb.Value = Identifi(9).Value
    UserForm1Ident.NumPlan_Cb.Value = Identifi(10).Value
    UserForm1Ident.IdDoBem_Cb.Value = Identifi(12).Value
    UserForm1Ident.Grupo_Cb.Value = Identifi(13).Value
    UserForm1Ident.Seq|fffd||fffd|ncia_Cb.Value = Identifi(14).Value
    UserForm1Ident.Observ_Cb.Value = Identifi(16).Value
    vEnableEvents = True   'Application.EnableEvents = True
    Application.ScreenUpdating = True
    Application.StatusBar = False
    UserForm1Ident.Cliente_Cb.SetFocus
    UserForm1Ident.Show
    Application.ScreenUpdating = True
    Identifi(1).Value = BotAcionado
    If FecharArq Then Identifi(2).Value = "Fechar"
    If BotAcionado = 16 Or BotAcionado = 17 Or BotAcionado = 18 Or BotAcionado = 23 Or BotAcionado = 24 Then
        'Eliminar espa|fffd|os no final de textos desde que o controle aceite sem erro
        Application.ScreenUpdating = False
        On Error Resume Next
        For Each Ctr In UserForm1Ident.Controls
            If Right(Ctr.Name, 2) = "Cb" Then Ctr.Value = RTrim(Ctr.Value)
        Next
        On Error GoTo 0

        'Atualizar hist|fffd|rico
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            SalvarHist = False
            AtuHist "Data", UserForm1Ident.Data_Cb.Value, Format(DateValue(Identifi(3).Value), "dd/mm/yy")
            'AtuHist "|fffd|ndice", UserForm1Ident.|fffd|ndice_Cb.Value, Identifi(5).value
            AtuHist "UMonet", UserForm1Ident.UMonet_Cb.Value, Identifi(6).Value
            AtuHist "Extenso", UserForm1Ident.Extenso_Cb.Value, Identifi(7).Value
            AtuHist "Cliente", UserForm1Ident.Cliente_Cb.Value, Identifi(9).Value
            AtuHist "NumPlan", UserForm1Ident.NumPlan_Cb.Value, Identifi(10).Value
            AtuHist "IdDoBem", UserForm1Ident.IdDoBem_Cb.Value, Identifi(12).Value
            AtuHist "Grupo", UserForm1Ident.Grupo_Cb.Value, Identifi(13).Value
            AtuHist "Seq|fffd||fffd|ncia", UserForm1Ident.Seq|fffd||fffd|ncia_Cb.Value, Identifi(14).Value
            AtuHist "Observ", UserForm1Ident.Observ_Cb.Value, Identifi(16).Value
            If SalvarHist Then SalvandoHist Else Workbooks(NomeArqHist).Close False
        End If
        'Transferindo dados
        Identifi(3).Value = DateValue(UserForm1Ident.Data_Cb.Value)
        Identifi(5).Value = nInd
        Identifi(6).Value = UserForm1Ident.UMonet_Cb.Value
        Identifi(7).Value = UserForm1Ident.Extenso_Cb.Value
        Identifi(9).Value = UserForm1Ident.Cliente_Cb.Value
        Identifi(10).Value = UserForm1Ident.NumPlan_Cb.Value
        Identifi(12).Value = UserForm1Ident.IdDoBem_Cb.Value
        Identifi(13).Value = UserForm1Ident.Grupo_Cb.Value
        Identifi(14).Value = UserForm1Ident.Seq|fffd||fffd|ncia_Cb.Value
        Identifi(16).Value = UserForm1Ident.Observ_Cb.Value
        Application.ScreenUpdating = False
    End If
    Unload UserForm1Ident
    ThisWorkbook.Saved = True
End Sub

Attribute VB_Name = "M|fffd|d12Cad"
Public Cadastr As Range
Public Cliente As String

Public Sub CadastroVBA()
    NomeArqHist = "Cadastro.hst"
    Set Cadastr = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Cadast")
    Application.ScreenUpdating = False
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value)    'DirP = ThisWorkbook.Path
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, True) Then
        ActiveWindow.Close False
    End If
    Cliente = Cadastr(3).Value
    'Ajuda
    I = InStr(1, Cadastr(2).Value, "!"): bHtmlHelp = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("bHtmlHelp").Value
    'Application.VBE.VBProjects("VBAProjectCxCad").HelpFile = Left(Cadastr(2).Value, I - 1)
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDrive ThisWorkbook.Path
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDir ThisWorkbook.Path Else Application.Run "CPAP_EX8.MAC!DirectoryVBA", ThisWorkbook.Path, False
    UserForm2Cad.HelpContextID = Right(Cadastr(2).Value, Len(Cadastr(2).Value) - I)

    UserForm2Cad.Caption = "Cadastro de " & Cadastr(3).Value
    vEnableEvents = False    'Application.EnableEvents = False 'Alterei na vers|fffd|o 2007, pois n|fffd|o parece ter sentido no m|fffd|ximo deveria ser vEnableEvents = True
    UserForm2Cad.Endere|fffd|o_Cb.Value = Cadastr(4).Value
    UserForm2Cad.CidadeUf_Cb.Value = Cadastr(5).Value
    UserForm2Cad.CEP_Cb.Value = Cadastr(6).Value
    UserForm2Cad.Nacionalidade_Cb.Value = Cadastr(8).Value
    UserForm2Cad.Profiss|fffd|o_Cb.Value = Cadastr(9).Value
    UserForm2Cad.CNPJ_Cb.Value = Cadastr(14).Value
    UserForm2Cad.RG_Cb.Value = Cadastr(15).Value
    UserForm2Cad.Internet_Cb.Value = Cadastr(16).Value
    UserForm2Cad.Endere|fffd|oComercial_Cb.Value = Cadastr(17).Value
    UserForm2Cad.Outros1_Cb.Value = Cadastr(19).Value
    UserForm2Cad.Outros2_Cb.Value = Cadastr(20).Value

    vEnableEvents = True    '|fffd| necess|fffd|rio para criticar e ocultar elementos na caixa
    UserForm2Cad.EstCivil_Cb.Value = Cadastr(21).Value
    UserForm2Cad.Regime_Cb.Value = Cadastr(22).Value

    UserForm2Cad.FoneResPa|fffd|s_Cb.Value = Cadastr(23).Value
    UserForm2Cad.FoneResCid_Cb.Value = Cadastr(24).Value
    UserForm2Cad.FoneResLoc_Cb.Value = Cadastr(25).Value
    UserForm2Cad.FoneResRam_Cb.Value = Cadastr(26).Value
    UserForm2Cad.FoneTrabPa|fffd|s_Cb.Value = Cadastr(27).Value
    UserForm2Cad.FoneTrabCid_Cb.Value = Cadastr(28).Value
    UserForm2Cad.FoneTrabLoc_Cb.Value = Cadastr(29).Value
    UserForm2Cad.FoneTrabRam_Cb.Value = Cadastr(30).Value
    UserForm2Cad.FoneAltPa|fffd|s_Cb.Value = Cadastr(31).Value
    UserForm2Cad.FoneAltCid_Cb.Value = Cadastr(32).Value
    UserForm2Cad.FoneAltLoc_Cb.Value = Cadastr(33).Value
    UserForm2Cad.FoneAltRam_Cb.Value = Cadastr(34).Value
    UserForm2Cad.FoneCelPa|fffd|s_Cb.Value = Cadastr(35).Value
    UserForm2Cad.FoneCelCid_Cb.Value = Cadastr(36).Value
    UserForm2Cad.FoneCelLoc_Cb.Value = Cadastr(37).Value
    UserForm2Cad.FoneCelRam_Cb.Value = Cadastr(38).Value
    vEnableEvents = False

    UserForm2Cad.NomeC|fffd|njuge_Cb.Value = Cadastr(39).Value
    UserForm2Cad.Endere|fffd|oC|fffd|njuge_Cb.Value = Cadastr(40).Value
    UserForm2Cad.CidadeUfC|fffd|njuge_Cb.Value = Cadastr(41).Value
    UserForm2Cad.CepC|fffd|njuge_Cb.Value = Cadastr(42).Value
    UserForm2Cad.NacionalidadeC|fffd|njuge_Cb.Value = Cadastr(43).Value
    UserForm2Cad.CpfC|fffd|njuge_Cb.Value = Cadastr(44).Value
    UserForm2Cad.RgC|fffd|njuge_Cb.Value = Cadastr(45).Value
    UserForm2Cad.Profiss|fffd|oC|fffd|njuge_Cb.Value = Cadastr(46).Value

    vEnableEvents = True  'Application.EnableEvents = True 'Estava na vers|fffd|o 2002, mas n|fffd|o parece ter sentido no m|fffd|ximo deveria ser     vEnableEvents = True
    Application.ScreenUpdating = True
    Application.StatusBar = False
    UserForm2Cad.Endere|fffd|o_Cb.SetFocus
    UserForm2Cad.Show
    Application.ScreenUpdating = True
    Cadastr(1).Value = BotAcionado
    If BotAcionado < 3 Then
        'Eliminar espa|fffd|os no final de textos desde que o controle aceite sem erro
        Application.ScreenUpdating = False
        On Error Resume Next
        For Each Ctr In UserForm2Cad.Controls
            If Right(Ctr.Name, 2) = "Cb" Then Ctr.Value = RTrim(Ctr.Value)
        Next
        On Error GoTo 0

        'Atualizar hist|fffd|rico
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            SalvarHist = False
            AtuHist "Endere|fffd|o", UserForm2Cad.Endere|fffd|o_Cb.Value, Cadastr(4).Value
            AtuHist "CidadeUf", UserForm2Cad.CidadeUf_Cb.Value, Cadastr(5).Value
            AtuHist "Cep", UserForm2Cad.CEP_Cb.Value, Cadastr(6).Value
            AtuHist "Nacionalidade", UserForm2Cad.Nacionalidade_Cb.Value, Cadastr(8).Value
            AtuHist "Profiss|fffd|o", UserForm2Cad.Profiss|fffd|o_Cb.Value, Cadastr(9).Value
            AtuHist "Cnpj", UserForm2Cad.CNPJ_Cb.Value, Cadastr(14).Value
            AtuHist "Rg", UserForm2Cad.RG_Cb.Value, Cadastr(15).Value
            AtuHist "Internet", UserForm2Cad.Internet_Cb.Value, Cadastr(16).Value
            AtuHist "Endere|fffd|oComercial", UserForm2Cad.Endere|fffd|oComercial_Cb.Value, Cadastr(17).Value
            AtuHist "Outros1", UserForm2Cad.Outros1_Cb.Value, Cadastr(19).Value
            AtuHist "Outros2", UserForm2Cad.Outros2_Cb.Value, Cadastr(20).Value

            AtuHist "EstCivil", UserForm2Cad.EstCivil_Cb.Value, Cadastr(21).Value
            AtuHist "Regime", UserForm2Cad.Regime_Cb.Value, Cadastr(22).Value

            AtuHist "FoneResPa|fffd|s", UserForm2Cad.FoneResPa|fffd|s_Cb.Value, Cadastr(23).Value
            AtuHist "FoneResCid", UserForm2Cad.FoneResCid_Cb.Value, Cadastr(24).Value
            AtuHist "FoneResLoc", UserForm2Cad.FoneResLoc_Cb.Value, Cadastr(25).Value
            AtuHist "FoneResRam", UserForm2Cad.FoneResRam_Cb.Value, Cadastr(26).Value
            AtuHist "FoneTrabPa|fffd|s", UserForm2Cad.FoneTrabPa|fffd|s_Cb.Value, Cadastr(27).Value
            AtuHist "FoneTrabCid", UserForm2Cad.FoneTrabCid_Cb.Value, Cadastr(28).Value
            AtuHist "FoneTrabLoc", UserForm2Cad.FoneTrabLoc_Cb.Value, Cadastr(29).Value
            AtuHist "FoneTrabRam", UserForm2Cad.FoneTrabRam_Cb.Value, Cadastr(30).Value
            AtuHist "FoneAltPa|fffd|s", UserForm2Cad.FoneAltPa|fffd|s_Cb.Value, Cadastr(31).Value
            AtuHist "FoneAltCid", UserForm2Cad.FoneAltCid_Cb.Value, Cadastr(32).Value
            AtuHist "FoneAltLoc", UserForm2Cad.FoneAltLoc_Cb.Value, Cadastr(33).Value
            AtuHist "FoneAltRam", UserForm2Cad.FoneAltRam_Cb.Value, Cadastr(34).Value
            AtuHist "FoneCelPa|fffd|s", UserForm2Cad.FoneCelPa|fffd|s_Cb.Value, Cadastr(35).Value
            AtuHist "FoneCelCid", UserForm2Cad.FoneCelCid_Cb.Value, Cadastr(36).Value
            AtuHist "FoneCelLoc", UserForm2Cad.FoneCelLoc_Cb.Value, Cadastr(37).Value
            AtuHist "FoneCelRam", UserForm2Cad.FoneCelRam_Cb.Value, Cadastr(38).Value

            AtuHist "NomeC|fffd|njuge", UserForm2Cad.NomeC|fffd|njuge_Cb.Value, Cadastr(39).Value
            AtuHist "Endere|fffd|oC|fffd|njuge", UserForm2Cad.Endere|fffd|oC|fffd|njuge_Cb.Value, Cadastr(40).Value
            AtuHist "CidadeUfC|fffd|njuge", UserForm2Cad.CidadeUfC|fffd|njuge_Cb.Value, Cadastr(41).Value
            AtuHist "CepC|fffd|njuge", UserForm2Cad.CepC|fffd|njuge_Cb.Value, Cadastr(42).Value
            AtuHist "NacionalidadeC|fffd|njuge", UserForm2Cad.NacionalidadeC|fffd|njuge_Cb.Value, Cadastr(43).Value
            AtuHist "CpfC|fffd|njuge", UserForm2Cad.CpfC|fffd|njuge_Cb.Value, Cadastr(44).Value
            AtuHist "RgC|fffd|njuge", UserForm2Cad.RgC|fffd|njuge_Cb.Value, Cadastr(45).Value
            AtuHist "Profiss|fffd|oC|fffd|njuge", UserForm2Cad.Profiss|fffd|oC|fffd|njuge_Cb.Value, Cadastr(46).Value

            If SalvarHist Then SalvandoHist Else Workbooks(NomeArqHist).Close False
        End If
        'Transferindo dados
        Cadastr(4).Value = UserForm2Cad.Endere|fffd|o_Cb.Value
        Cadastr(5).Value = UserForm2Cad.CidadeUf_Cb.Value
        Cadastr(6).Value = UserForm2Cad.CEP_Cb.Value
        Cadastr(8).Value = UserForm2Cad.Nacionalidade_Cb.Value
        Cadastr(9).Value = UserForm2Cad.Profiss|fffd|o_Cb.Value
        Cadastr(14).Value = UserForm2Cad.CNPJ_Cb.Value
        Cadastr(15).Value = UserForm2Cad.RG_Cb.Value
        Cadastr(16).Value = UserForm2Cad.Internet_Cb.Value
        Cadastr(17).Value = UserForm2Cad.Endere|fffd|oComercial_Cb.Value
        Cadastr(19).Value = UserForm2Cad.Outros1_Cb.Value
        Cadastr(20).Value = UserForm2Cad.Outros2_Cb.Value

        Cadastr(21).Value = UserForm2Cad.EstCivil_Cb.Value
        Cadastr(22).Value = UserForm2Cad.Regime_Cb.Value

        Cadastr(23).Value = UserForm2Cad.FoneResPa|fffd|s_Cb.Value
        Cadastr(24).Value = UserForm2Cad.FoneResCid_Cb.Value
        Cadastr(25).Value = UserForm2Cad.FoneResLoc_Cb.Value
        Cadastr(26).Value = UserForm2Cad.FoneResRam_Cb.Value
        Cadastr(27).Value = UserForm2Cad.FoneTrabPa|fffd|s_Cb.Value
        Cadastr(28).Value = UserForm2Cad.FoneTrabCid_Cb.Value
        Cadastr(29).Value = UserForm2Cad.FoneTrabLoc_Cb.Value
        Cadastr(30).Value = UserForm2Cad.FoneTrabRam_Cb.Value
        Cadastr(31).Value = UserForm2Cad.FoneAltPa|fffd|s_Cb.Value
        Cadastr(32).Value = UserForm2Cad.FoneAltCid_Cb.Value
        Cadastr(33).Value = UserForm2Cad.FoneAltLoc_Cb.Value
        Cadastr(34).Value = UserForm2Cad.FoneAltRam_Cb.Value
        Cadastr(35).Value = UserForm2Cad.FoneCelPa|fffd|s_Cb.Value
        Cadastr(36).Value = UserForm2Cad.FoneCelCid_Cb.Value
        Cadastr(37).Value = UserForm2Cad.FoneCelLoc_Cb.Value
        Cadastr(38).Value = UserForm2Cad.FoneCelRam_Cb.Value

        If UserForm2Cad.MultiPage1(2).Enabled Then _
                Cadastr(39).Value = UserForm2Cad.NomeC|fffd|njuge_Cb.Value Else Cadastr(39).Value = ""
        Cadastr(40).Value = UserForm2Cad.Endere|fffd|oC|fffd|njuge_Cb.Value
        Cadastr(41).Value = UserForm2Cad.CidadeUfC|fffd|njuge_Cb.Value
        Cadastr(42).Value = UserForm2Cad.CepC|fffd|njuge_Cb.Value
        Cadastr(43).Value = UserForm2Cad.NacionalidadeC|fffd|njuge_Cb.Value
        Cadastr(44).Value = UserForm2Cad.CpfC|fffd|njuge_Cb.Value
        Cadastr(45).Value = UserForm2Cad.RgC|fffd|njuge_Cb.Value
        Cadastr(46).Value = UserForm2Cad.Profiss|fffd|oC|fffd|njuge_Cb.Value

        Application.ScreenUpdating = False
    End If
    Unload UserForm2Cad
    ThisWorkbook.Saved = True
End Sub
Attribute VB_Name = "M|fffd|d13Princ"
Public Princ As Range
Public Princ0 As Range
Public nDiasEntrg, nDiasPriPrest, nMesesEntrg, nMesesPriPrest As Single
Public PlnEqCal As Boolean

Public Sub PrincVBA()
    NomeArqHist = "CxPrinci.hst"   'uuuu
    Set Princ = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Princi")
    Set Princ0 = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Princi").Offset(0, -5)
    Application.ScreenUpdating = False
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value) 'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, True) Then
        ActiveWindow.Close False
    End If
    Application.ScreenUpdating = True
    'Ajuda
    I = InStr(1, Princ(2, 2).Value, "!"): bHtmlHelp = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("bHtmlHelp").Value
    'Com o proj. proteg. essa instru|fffd||fffd|o falha. A solu|fffd||fffd|o foi colocar ..\cpap.hlp nas propriedades e fazer o diret|fffd|rio do cpap ativo.
    'Application.VBE.VBProjects("VBAProjectCxIdent").HelpFile = Left(Princ(2,2).Value, I - 1)
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDrive ThisWorkbook.Path
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDir ThisWorkbook.Path Else Application.Run "CPAP_EX8.MAC!DirectoryVBA", ThisWorkbook.Path, False

    nDiasEntrg = Princ(6, 2).Value   'Aqui porque a pr|fffd|x. aciona o evento inicialize do form.
    nDiasPriPrest = Princ(33, 2).Value
    nMesesEntrg = Princ(5, 2).Value
    nMesesPriPrest = Princ(32, 2).Value
    UserForm3Princ.HelpContextID = Right(Princ(2, 2).Value, Len(Princ(2, 2).Value) - I)

    vEnableEvents = False
    UserForm3Princ.JurTaxa_Cb.Value = Format(Princ(7, 2).Value, "#,##0.00########")
    UserForm3Princ.QuantPriS|fffd|rie_Cb.Value = Princ(15, 2).Value
    UserForm3Princ.QuantSegS|fffd|rie_Cb.Value = Princ(17, 2).Value
    UserForm3Princ.QuantTerS|fffd|rie_Cb.Value = Princ(19, 2).Value
    UserForm3Princ.QuantQuaS|fffd|rie_Cb.Value = Princ(21, 2).Value
    UserForm3Princ.QuantQuiS|fffd|rie_Cb.Value = Princ(23, 2).Value
    UserForm3Princ.QuantSexS|fffd|rie_Cb.Value = Princ(25, 2).Value
    UserForm3Princ.QuantS|fffd|tS|fffd|rie_Cb.Value = Princ(27, 2).Value
    UserForm3Princ.QuantOitS|fffd|rie_Cb.Value = Princ(29, 2).Value

    UserForm3Princ.Saldo_Cb.Value = Format(Princ(50, 2).Value, "#,##0.00")
    UserForm3Princ.ValorEntrd_Cb.Value = Format(Princ(10, 2).Value, "#,##0.00")
    UserForm3Princ.ValorEntrg_Cb.Value = Format(Princ(11, 2).Value, "#,##0.00")
    UserForm3Princ.ValorPlano_Cb.Value = Format(Princ(3, 2).Value, "#,##0.00")
    UserForm3Princ.ValorPriS|fffd|rie_Cb.Value = Format(Princ(16, 2).Value, "#,##0.00")
    UserForm3Princ.ValorSegS|fffd|rie_Cb.Value = Format(Princ(18, 2).Value, "#,##0.00")
    UserForm3Princ.ValorTerS|fffd|rie_Cb.Value = Format(Princ(20, 2).Value, "#,##0.00")
    UserForm3Princ.ValorQuaS|fffd|rie_Cb.Value = Format(Princ(22, 2).Value, "#,##0.00")
    UserForm3Princ.ValorQuiS|fffd|rie_Cb.Value = Format(Princ(24, 2).Value, "#,##0.00")
    UserForm3Princ.ValorSexS|fffd|rie_Cb.Value = Format(Princ(26, 2).Value, "#,##0.00")
    UserForm3Princ.ValorS|fffd|tS|fffd|rie_Cb.Value = Format(Princ(28, 2).Value, "#,##0.00")
    UserForm3Princ.ValorOitS|fffd|rie_Cb.Value = Format(Princ(30, 2).Value, "#,##0.00")

    UserForm3Princ.JurAdicParc_Chb.Value = Princ(46, 2).Value
    UserForm3Princ.JurApartir_Chb.Value = Princ(8, 2).Value
    UserForm3Princ.JurMasCapt_Chb.Value = Princ(45, 2).Value
    UserForm3Princ.JurAteChave_Chb.Value = Princ(52, 2).Value
    UserForm3Princ.JurSimp_Chb.Value = Princ(43, 2).Value
    UserForm3Princ.JurSimplesApartir_Chb.Value = Princ(44, 2).Value
    UserForm3Princ.SaltaM|fffd|s_Chb.Value = Princ(47, 2).Value
    UserForm3Princ.SaltaVencBal|fffd|o_Chb.Value = Princ(34, 2).Value
    UserForm3Princ.RelBal|fffd|oComoPrest_Chb.Value = Princ(35, 2).Value

    UserForm3Princ.MesesEntrg_Lb.Caption = Princ(36, 2).Value
    UserForm3Princ.JurApartir_Chb.Caption = Princ(8, 1).Value
    UserForm3Princ.JurSimplesApartir_Chb.Caption = Princ(44, 1).Value
    UserForm3Princ.JurAteChave_Chb.Caption = Princ(52, 1).Value
    UserForm3Princ.JurAdicParc_Chb.Caption = Princ(46, 1).Value
    UserForm3Princ.SaltaVencBal|fffd|o_Chb.Caption = Princ(34, 1).Value
    UserForm3Princ.RelBal|fffd|oComoPrest_Chb.Caption = Princ(35, 1).Value

    UserForm3Princ.ValorEntrd_Lb.Caption = Princ(12, 2).Value
    UserForm3Princ.ValorEntrg_Lb.Caption = Princ(13, 2).Value
    UserForm3Princ.Bal|fffd|es_Bt.Caption = Princ(36, 1).Value

    UserForm3Princ.Caption = Princ(1, 1).Value
    UserForm3Princ.Totais_Tb.Text = Princ(48, 2).Value
    UserForm3Princ.Crit|fffd|rios_Tb.Text = Princ(49, 2).Value
    PlnEqCal = Princ(31, 2).Value
    OcultarExibControles3

    vEnableEvents = True
    Application.ScreenUpdating = True
    Application.StatusBar = False
    UserForm3Princ.ValorPlano_Cb.SetFocus
    UserForm3Princ.Show
    Application.ScreenUpdating = True
    Princ(1, 2).Value = BotAcionado
    If FecharArq Then Princ(2, 2).Value = "Fechar"
    If BotAcionado > 1 Then
        Application.ScreenUpdating = False
        'Atualizar hist|fffd|rico
        Application.ScreenUpdating = False
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            SalvarHist = False

            AtuHist "DataEntrg", UserForm3Princ.DataEntrg_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(5, 2).Value - 1) + Princ(6, 2).Value - 1, "dd/mm/yy")
            AtuHist "DataPriPrest", UserForm3Princ.DataPriPrest_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(32, 2).Value - 1) + Princ(33, 2).Value - 1, "dd/mm/yy")
            AtuHist "DiasEntrg", nDiasEntrg & "", Princ(6, 2).Value
            AtuHist "DiasPriPrest", nDiasPriPrest & "", Princ(33, 2).Value
            AtuHist "JurTaxa", UserForm3Princ.JurTaxa_Cb.Value, Format(Princ(7, 2).Value, "#,##0.00########")
            AtuHist "MesesEntrg", nMesesEntrg & "", Princ(5, 2).Value
            AtuHist "MesesPriPrest", nMesesPriPrest & "", Princ(32, 2).Value
            AtuHist "QuantPriS|fffd|rie", UserForm3Princ.QuantPriS|fffd|rie_Cb.Value, Princ(15, 2).Value
            AtuHist "QuantSegS|fffd|rie", UserForm3Princ.QuantSegS|fffd|rie_Cb.Value, Princ(17, 2).Value
            AtuHist "QuantTerS|fffd|rie", UserForm3Princ.QuantTerS|fffd|rie_Cb.Value, Princ(19, 2).Value
            AtuHist "QuantQuaS|fffd|rie", UserForm3Princ.QuantQuaS|fffd|rie_Cb.Value, Princ(21, 2).Value
            AtuHist "QuantQuiS|fffd|rie", UserForm3Princ.QuantQuiS|fffd|rie_Cb.Value, Princ(23, 2).Value
            AtuHist "QuantSexS|fffd|rie", UserForm3Princ.QuantSexS|fffd|rie_Cb.Value, Princ(25, 2).Value
            AtuHist "QuantS|fffd|tS|fffd|rie", UserForm3Princ.QuantS|fffd|tS|fffd|rie_Cb.Value, Princ(27, 2).Value
            AtuHist "QuantOitS|fffd|rie", UserForm3Princ.QuantOitS|fffd|rie_Cb.Value, Princ(29, 2).Value

            AtuHist "Saldo", UserForm3Princ.Saldo_Cb.Value, Format(Princ(50, 2).Value, "#,##0.00")
            AtuHist "ValorEntrd", UserForm3Princ.ValorEntrd_Cb.Value, Format(Princ(10, 2).Value, "#,##0.00")
            AtuHist "ValorEntrg", UserForm3Princ.ValorEntrg_Cb.Value, Format(Princ(11, 2).Value, "#,##0.00")
            AtuHist "ValorPlano", UserForm3Princ.ValorPlano_Cb.Value, Format(Princ(3, 2).Value, "#,##0.00")
            AtuHist "ValorPriS|fffd|rie", UserForm3Princ.ValorPriS|fffd|rie_Cb.Value, Format(Princ(16, 2).Value, "#,##0.00")
            AtuHist "ValorSegS|fffd|rie", UserForm3Princ.ValorSegS|fffd|rie_Cb.Value, Format(Princ(18, 2).Value, "#,##0.00")
            AtuHist "ValorTerS|fffd|rie", UserForm3Princ.ValorTerS|fffd|rie_Cb.Value, Format(Princ(20, 2).Value, "#,##0.00")
            AtuHist "ValorQuaS|fffd|rie", UserForm3Princ.ValorQuaS|fffd|rie_Cb.Value, Format(Princ(22, 2).Value, "#,##0.00")
            AtuHist "ValorQuiS|fffd|rie", UserForm3Princ.ValorQuiS|fffd|rie_Cb.Value, Format(Princ(24, 2).Value, "#,##0.00")
            AtuHist "ValorSexS|fffd|rie", UserForm3Princ.ValorSexS|fffd|rie_Cb.Value, Format(Princ(26, 2).Value, "#,##0.00")
            AtuHist "ValorS|fffd|tS|fffd|rie", UserForm3Princ.ValorS|fffd|tS|fffd|rie_Cb.Value, Format(Princ(28, 2).Value, "#,##0.00")
            AtuHist "ValorOitS|fffd|rie", UserForm3Princ.ValorOitS|fffd|rie_Cb.Value, Format(Princ(30, 2).Value, "#,##0.00")

            If SalvarHist Then SalvandoHist Else Workbooks(NomeArqHist).Close False
        End If
        'Transferindo dados

        Princ(6, 2).Value = nDiasEntrg
        Princ(33, 2).Value = nDiasPriPrest
        Princ(7, 2).Value = CDbl(UserForm3Princ.JurTaxa_Cb.Value)
        Princ(5, 2).Value = nMesesEntrg
        Princ(32, 2).Value = nMesesPriPrest
        Princ(15, 2).Value = UserForm3Princ.QuantPriS|fffd|rie_Cb.Value
        Princ(17, 2).Value = UserForm3Princ.QuantSegS|fffd|rie_Cb.Value
        Princ(19, 2).Value = UserForm3Princ.QuantTerS|fffd|rie_Cb.Value
        Princ(21, 2).Value = UserForm3Princ.QuantQuaS|fffd|rie_Cb.Value
        Princ(23, 2).Value = UserForm3Princ.QuantQuiS|fffd|rie_Cb.Value
        Princ(25, 2).Value = UserForm3Princ.QuantSexS|fffd|rie_Cb.Value
        Princ(27, 2).Value = UserForm3Princ.QuantS|fffd|tS|fffd|rie_Cb.Value
        Princ(29, 2).Value = UserForm3Princ.QuantOitS|fffd|rie_Cb.Value

        Princ(50, 2).Value = UserForm3Princ.Saldo_Cb.Value
        Princ(10, 2).Value = CDbl(UserForm3Princ.ValorEntrd_Cb.Value)
        Princ(11, 2).Value = CDbl(UserForm3Princ.ValorEntrg_Cb.Value)
        Princ(3, 2).Value = CDbl(UserForm3Princ.ValorPlano_Cb.Value)
        Princ(16, 2).Value = CDbl(UserForm3Princ.ValorPriS|fffd|rie_Cb.Value)
        Princ(18, 2).Value = CDbl(UserForm3Princ.ValorSegS|fffd|rie_Cb.Value)
        Princ(20, 2).Value = CDbl(UserForm3Princ.ValorTerS|fffd|rie_Cb.Value)
        Princ(22, 2).Value = CDbl(UserForm3Princ.ValorQuaS|fffd|rie_Cb.Value)
        Princ(24, 2).Value = CDbl(UserForm3Princ.ValorQuiS|fffd|rie_Cb.Value)
        Princ(26, 2).Value = CDbl(UserForm3Princ.ValorSexS|fffd|rie_Cb.Value)
        Princ(28, 2).Value = CDbl(UserForm3Princ.ValorS|fffd|tS|fffd|rie_Cb.Value)
        Princ(30, 2).Value = CDbl(UserForm3Princ.ValorOitS|fffd|rie_Cb.Value)

        Princ(46, 2).Value = UserForm3Princ.JurAdicParc_Chb.Value
        Princ(8, 2).Value = UserForm3Princ.JurApartir_Chb.Value
        Princ(45, 2).Value = UserForm3Princ.JurMasCapt_Chb.Value
        Princ(52, 2).Value = UserForm3Princ.JurAteChave_Chb.Value
        Princ(43, 2).Value = UserForm3Princ.JurSimp_Chb.Value
        Princ(44, 2).Value = UserForm3Princ.JurSimplesApartir_Chb.Value
        Princ(47, 2).Value = UserForm3Princ.SaltaM|fffd|s_Chb.Value
        Princ(34, 2).Value = UserForm3Princ.SaltaVencBal|fffd|o_Chb.Value
        Princ(35, 2).Value = UserForm3Princ.RelBal|fffd|oComoPrest_Chb.Value

        Application.ScreenUpdating = False
    End If
    Unload UserForm3Princ
    ThisWorkbook.Saved = True
End Sub

Sub OcultarExibControles3()
    With UserForm3Princ
        .ValorPlano_Cb.Locked = Princ0(3, 1).Value = 208
        .JurTaxa_Cb.Visible = Princ0(7, 1).Value > 0
        .JurTaxaCalculadora_Bt.Visible = .JurTaxa_Cb.Visible
        .JurTaxaEq_Bt.Visible = .JurTaxa_Cb.Visible
        .SinN|fffd|oFechado_Lb.Visible = Abs(.Saldo_Cb.Value) > 0.005

        .JurSimp_Chb.Visible = Princ0(43, 1).Value > 0
        .JurSimplesApartir_Chb.Visible = Princ0(44, 1).Value > 0
        .JurMasCapt_Chb.Visible = Princ0(45, 1).Value > 0
        .JurAteChave_Chb.Visible = Princ0(52, 1).Value > 0
        If Princ0(8, 1).Value = 0 Then
            .JurApartir_Chb.Visible = False
            .JurSimplesApartir_Chb.Top = .JurApartir_Chb.Top
            .JurSimplesApartir_Chb.Left = .JurApartir_Chb.Left
        End If

        .Ratear_Bt.Visible = Princ0(51, 1).Value
        .RelBal|fffd|oComoPrest_Chb.Visible = .SaltaVencBal|fffd|o_Chb.Value
        If .QuantS|fffd|tS|fffd|rie_Cb.Value + .QuantOitS|fffd|rie_Cb.Value = 0 Then
            .Width = 468
            .Height = 314
            .Scroll (5)
            .ScrollBars = fmScrollBarsNone
            .AumCx_Lb.Visible = True
        Else
            If Run("cpap_ex8.mac!apiGetSys", 0) > 640 Then
                .Width = 568
                .Height = 314
                .ScrollBars = fmScrollBarsNone
            Else
                .Width = 468
                .Height = 314 + 10
                .ScrollBars = fmScrollBarsBoth
                .Top = 0
            End If
            .AumCx_Lb.Visible = False
        End If
        .WhatsThis_Img.Top = -50: If bHtmlHelp Then .WhatsThis_Img.Top = -1: .WhatsThis_Img.Left = .Width - 10 + 1
        If PlnEqCal Then
            .MesesEntrg_Cb.Enabled = False
            .DiasEntrg_Cb.Enabled = False
            .DataEntrg_Cb.Enabled = False
            .DataEntrgCalend_Bt.Enabled = False
            .JurSimp_Chb.Enabled = False
            .JurSimplesApartir_Chb.Enabled = False
            .JurAteChave_Chb.Enabled = False
            .JurTaxa_Cb.Enabled = False
            .JurTaxaCalculadora_Bt.Enabled = False
            .JurTaxaEq_Bt.Enabled = False
            .JurApartir_Chb.Enabled = False
            .JurMasCapt_Chb.Enabled = False
            .JurAdicParc_Chb.Enabled = False
            .JurTaxa_Cb.BackColor = &HFF&
            .Totais_Tb.ForeColor = &HFF&
            .Finalizar_Bt.Caption = "Concluir"
            .Finalizar_Bt.ForeColor = &HFF&
            .Finalizar_Bt.Font.Bold = True
            .Finalizar_Bt.Font.Size = 10
        End If
    End With
End Sub
Attribute VB_Name = "M|fffd|d14Bal"
Public Bal As Range
Public Bal0 As Range
Public nDias1, nDias2, nDias3, nDias4, nMeses1, nMeses2, nMeses3, nMeses4 As Single

Public Sub BalVBA()
    NomeArqHist = "CxBaloes.hst"
    Set Bal = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Balo")
    Set Bal0 = Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Balo").Offset(0, -5)
    Application.ScreenUpdating = False
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value) 'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, True) Then
        ActiveWindow.Close False
    End If
    Application.ScreenUpdating = True
    'Ajuda
    I = InStr(1, Bal(2, 2).Value, "!"): bHtmlHelp = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("bHtmlHelp").Value
    'Com o proj. proteg. essa instru|fffd||fffd|o falha. A solu|fffd||fffd|o foi colocar ..\cpap.hlp nas propriedades e fazer o diret|fffd|rio do cpap ativo.
    'Application.VBE.VBProjects("VBAProjectCxIdent").HelpFile = Left(Bal(2,2).Value, I - 1)
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDrive ThisWorkbook.Path
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDir ThisWorkbook.Path Else Application.Run "CPAP_EX8.MAC!DirectoryVBA", ThisWorkbook.Path, False

    nMeses1 = Bal(5, 2).Value   'Aqui porque a pr|fffd|x. aciona o evento inicialize do form.
    nMeses2 = Bal(9, 2).Value
    nMeses3 = Bal(13, 2).Value
    nMeses4 = Bal(17, 2).Value
    nDias1 = Bal(6, 2).Value
    nDias2 = Bal(10, 2).Value
    nDias3 = Bal(14, 2).Value
    nDias4 = Bal(18, 2).Value

    UserForm4Bal.HelpContextID = Right(Bal(2, 2).Value, Len(Bal(2, 2).Value) - I)

    vEnableEvents = False
    UserForm4Bal.Valor1_Cb.Value = Format(Bal(4, 2).Value, "#,##0.00")
    UserForm4Bal.Valor2_Cb.Value = Format(Bal(8, 2).Value, "#,##0.00")
    UserForm4Bal.Valor3_Cb.Value = Format(Bal(12, 2).Value, "#,##0.00")
    UserForm4Bal.Valor4_Cb.Value = Format(Bal(16, 2).Value, "#,##0.00")

    UserForm4Bal.Num1_Lb.Caption = Format(Application.WorksheetFunction.Substitute(Bal(3, 1).Value, "&", ""), "00")
    UserForm4Bal.Num2_Lb.Caption = Format(Application.WorksheetFunction.Substitute(Bal(7, 1).Value, "&", ""), "00")
    UserForm4Bal.Num3_Lb.Caption = Format(Application.WorksheetFunction.Substitute(Bal(11, 1).Value, "&", ""), "00")
    UserForm4Bal.Num4_Lb.Caption = Format(Application.WorksheetFunction.Substitute(Bal(15, 1).Value, "&", ""), "00")
    UserForm4Bal.Num1_Lb.Accelerator = Right(UserForm4Bal.Num1_Lb.Caption, 1)
    UserForm4Bal.Num2_Lb.Accelerator = Right(UserForm4Bal.Num2_Lb.Caption, 1)
    UserForm4Bal.Num3_Lb.Accelerator = Right(UserForm4Bal.Num3_Lb.Caption, 1)
    UserForm4Bal.Num4_Lb.Accelerator = Right(UserForm4Bal.Num4_Lb.Caption, 1)

    UserForm4Bal.Caption = Bal(1, 1).Value
    OcultarExibControles4

    vEnableEvents = True
    Application.ScreenUpdating = True
    Application.StatusBar = False
    UserForm4Bal.Valor1_Cb.SetFocus
    UserForm4Bal.Show
    Application.ScreenUpdating = True
    Bal(1, 2).Value = BotAcionado
    If FecharArq Then Bal(2, 2).Value = "Fechar"
    If BotAcionado > 1 Then
        Application.ScreenUpdating = False
        'Atualizar hist|fffd|rico
        Application.ScreenUpdating = False
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            SalvarHist = False

            AtuHist "Data1", UserForm4Bal.Data1_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Bal(5, 2).Value - 1) + Bal(6, 2).Value - 1, "dd/mm/yy")
            AtuHist "Data2", UserForm4Bal.Data2_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Bal(9, 2).Value - 1) + Bal(10, 2).Value - 1, "dd/mm/yy")
            AtuHist "Data3", UserForm4Bal.Data3_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Bal(13, 2).Value - 1) + Bal(14, 2).Value - 1, "dd/mm/yy")
            AtuHist "Data4", UserForm4Bal.Data4_Cb.Value, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Bal(17, 2).Value - 1) + Bal(18, 2).Value - 1, "dd/mm/yy")
            AtuHist "Valor1", UserForm4Bal.Valor1_Cb.Value, Format(Bal(4, 2).Value, "#,##0.00")
            AtuHist "Valor2", UserForm4Bal.Valor2_Cb.Value, Format(Bal(8, 2).Value, "#,##0.00")
            AtuHist "Valor3", UserForm4Bal.Valor3_Cb.Value, Format(Bal(12, 2).Value, "#,##0.00")
            AtuHist "Valor4", UserForm4Bal.Valor4_Cb.Value, Format(Bal(16, 2).Value, "#,##0.00")

            If SalvarHist Then SalvandoHist Else Workbooks(NomeArqHist).Close False
        End If
        'Transferindo dados

        Bal(5, 2).Value = nMeses1
        Bal(9, 2).Value = nMeses2
        Bal(13, 2).Value = nMeses3
        Bal(17, 2).Value = nMeses4
        Bal(6, 2).Value = nDias1
        Bal(10, 2).Value = nDias2
        Bal(14, 2).Value = nDias3
        Bal(18, 2).Value = nDias4
        Bal(4, 2).Value = CDbl(UserForm4Bal.Valor1_Cb.Value)
        Bal(8, 2).Value = CDbl(UserForm4Bal.Valor2_Cb.Value)
        Bal(12, 2).Value = CDbl(UserForm4Bal.Valor3_Cb.Value)
        Bal(16, 2).Value = CDbl(UserForm4Bal.Valor4_Cb.Value)

        Application.ScreenUpdating = False
    End If
    Unload UserForm4Bal
    ThisWorkbook.Saved = True
End Sub

Sub OcultarExibControles4()
    With UserForm4Bal
        .Mais_bt.Enabled = Bal0(19, 1) <> 203
        .SetaEvol4_lb.Enabled = Bal0(30, 1) <> 0
        .WhatsThis_Img.Top = -50: If bHtmlHelp Then .WhatsThis_Img.Top = -1: .WhatsThis_Img.Left = .Width - 10
    End With
End Sub

Attribute VB_Name = "M|fffd|d2Comum"
Public Const MarcHist = "|fffd|Hist|fffd|rico|fffd|"
Public NomeArqHist As String
Public vEnableEvents As Boolean
Public BotAcionado As Variant
Public SalvarHist As Boolean
Public FormatoHist As String
Public HistEditCampo As String
Public vCloseMode As Integer
Public FecharArq As Boolean
Public NmesIndMax As Long: Public bHtmlHelp As Boolean

Sub AtuHist(vCampo As String, ValorCb As String, ValorOrig As String)
    If ValorCb = "" Or ValorCb = ValorOrig Then Exit Sub
    'Verificando exist|fffd|ncia - Sug. Fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo)
    j = 0
    For Each C In campo
        j = j + 1
        If j > 1 And IIf(IsError(C.Value), "", C.Value) = ValorCb Then Exit Sub
    Next

    'Verificando exist|fffd|ncia - Sug. Hist|fffd|ricas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
    If campo.Rows.Count > 10000 Then Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist")
    j = 0
    For Each C In campo
        j = j + 1
        If j > 1 And IIf(IsError(C.Value), "", C.Value) = ValorCb Then Exit Sub
    Next
    'Adicionando |fffd| lista de hist|fffd|rico
    campo.Rows(2).Insert Shift:=xlDown
    campo.Rows(2).Value = "'" & ValorCb   'O ap|fffd|strofo arquivo tudo como texto, previnindo erro em caso de f|fffd|rmula e altera no formato de n|fffd|meros pela planilha
    NumM|fffd|x = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").Offset(-1, 0).Value
    If campo.Rows.Count > NumM|fffd|x Then campo(NumM|fffd|x + 2).ClearContents
    SalvarHist = True
End Sub

Function MyOpenFile(vFileName As String, vReadOnly As Boolean)
    On Error Resume Next
Retry:
    Application.DisplayAlerts = False
    '                                                         bEnableEvents = Application.EnableEvents
    Application.Run "cpap_ex8.mac!EnableEventsVBA", False    'Application.EnableEvents = False
    Set I = Workbooks.Open(Filename:=vFileName, ReadOnly:=vReadOnly, Notify:=False)
    Application.Run "cpap_ex8.mac!EnableEventsVBA", True    'Application.EnableEvents = bEnableEvents

    'Testar integridade. Ver se abre como texto, se n|fffd|o existe o nome DadosHist, se A1&His<>Ahist
    t1 = I.FileFormat = xlCurrentPlatformText
    t2 = I.Sheets(1).Range("DadosHist").Value
    t2 = t2 = Empty
    If t2 = False Then t3 = I.Sheets(1).Range("DadosHist").Offset(1).Value <> I.Sheets(1).Range("A1").Value & "Hist" Else t3 = False
    If t1 Or t2 Or t3 Then I.Close False

    Application.DisplayAlerts = True
    If I.Name = "" Then
        Select Case MsgBox("O arquivo " & vFileName & " contendo o hist|fffd|rico das caixas de inclus|fffd|o n|fffd|o foi encontrado ou est|fffd| corrompido." & Chr(10) & Chr(10) & "Se acionar Ignorar, o arquivo ser|fffd| ignorado e um novo ser|fffd| gerado para iniciar outro hist|fffd|rico.", vbQuestion + vbAbortRetryIgnore + vbDefaultButton2, "CPAP|fffd| - Tentando Abrir Arquivo de Hist|fffd|rico")
        Case Is = vbRetry
            GoTo Retry
        Case Is = vbAbort
            MyOpenFile = False
            Exit Function
        Case Is = vbIgnore
            Application.Workbooks.Add xlWBATWorksheet
            ActiveWorkbook.Names.Add Name:="DadosHist", RefersToR1C1:=Cells(100, 1)
            If Dir(vFileName) <> "" Then Kill vFileName
            ActiveWorkbook.SaveAs vFileName, IIf(Val(Application.Version) >= 12, 56, xlWorkbookNormal)    'xlExcel8 56
            SalvandoHist
            GoTo Retry
        End Select
    End If
    On Error GoTo 0
    If vReadOnly = False And I.ReadOnly Then
        I.Close False
        j = j + 1
        If j < 4 Then
            Application.Wait Now + TimeValue("00:00:01")
            GoTo Retry
        Else
            If MsgBox("O arquivo " & vFileName & " contendo o hist|fffd|rico das caixas de inclus|fffd|o pode estar em uso por outra esta|fffd||fffd|o. Acione OK para continuar tentando ou Cancelar para desistir?", vbQuestion + vbOKCancel, "CPAP|fffd|") = vbOK Then
                GoTo Retry
            Else
                MyOpenFile = False
                Exit Function
            End If
        End If
    End If
    ActiveWorkbook.ActiveSheet.Unprotect "MP542"
    ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").CurrentRegion.ClearContents
    Set CopyRng = Range("A1").CurrentRegion
    Set PasteRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").CurrentRegion.ClearContents
    Set CopyRng = Range("DadosHist").CurrentRegion
    Set PasteRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2
    MyOpenFile = True
End Function

Sub SalvandoHist()
    Workbooks(NomeArqHist).Sheets(1).Range("A1").CurrentRegion.ClearContents
    Set CopyRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").CurrentRegion
    Set PasteRng = Workbooks(NomeArqHist).Sheets(1).Range("A1")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    Workbooks(NomeArqHist).Sheets(1).Range("DadosHist").CurrentRegion.ClearContents
    I = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").Row
    Workbooks(NomeArqHist).Names.Add Name:="DadosHist", RefersToR1C1:=Workbooks(NomeArqHist).Sheets(1).Cells(I, 1)
    Set CopyRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").CurrentRegion
    Set PasteRng = Workbooks(NomeArqHist).Sheets(1).Range("DadosHist")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    Workbooks(NomeArqHist).Activate
    ActiveWorkbook.ActiveSheet.Protect "MP542"
    If Run("cpap_ex8.mac!SaveVBA") Then ActiveWorkbook.Close False
End Sub

Sub ConfHist(vComboBox As Object, vOriginal As String, Optional SemEditSring As Boolean = False, Optional Formato As String)
    I = InStr(1, vComboBox.Name, "_")
    HistEditCampo = Left(vComboBox.Name, I - 1)
    I = MsgBox("OK  -  Configurar sugest|fffd|es fixas e hist|fffd|ricas;" & Chr(10) & Chr(10) & "Cancelar - Restaurar inicial.", vbQuestion + vbOKCancel, "Hist|fffd|rico de Inclus|fffd|es no Campo " & HistEditCampo) = vbOK
    If I Then
        FormatoHist = Formato
        UserFormEditHist.Nova_Bt.Enabled = Not SemEditSring
        UserFormEditHist.SugFixas_Ct.Enabled = Not SemEditSring
        UserFormEditHist.SugHist_Ct.Enabled = Not SemEditSring
        UserFormEditHist.Show
        Unload UserFormEditHist
    End If
    vComboBox.Value = vOriginal
    If I Then ListandoComboBox vComboBox, Formato
    SendKeys "{RIGHT}"
End Sub

Sub ListandoComboBox(vComboBox As Object, Optional Formato As String)
    I = InStr(1, vComboBox.Name, "_")
    vCampo = Left(vComboBox.Name, I - 1)
    'Limpando comboboxes
    While vComboBox.ListCount >= 1
        vComboBox.RemoveItem (0)
    Wend
    'Listando comboboxes - Lista de sug. fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo, ThisWorkbook.Sheets(NomeArqHist).Range(vCampo).End(xlDown))
    If campo.Rows.Count < 100 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), Formato)
            j = j + 1
            If j > 1 Then
                vRep = False
                For I = 1 To vComboBox.ListCount
                    If vComboBox.List(I - 1) = cf Then vRep = True
                Next
                If vRep = False And cf <> "" Then vComboBox.AddItem (cf)
            End If
        Next
    End If
    'Listando comboboxes - Lista de sug. hist|fffd|ricas
    vComboBox.AddItem (MarcHist)
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
    If campo.Rows.Count > 10000 Then Exit Sub
    j = 0
    For Each C In campo
        cf = Format(IIf(IsError(C.Value), "", C.Value), Formato)
        j = j + 1
        If j > 1 Then
            vRep = False
            For I = 1 To vComboBox.ListCount
                If vComboBox.List(I - 1) = cf Then vRep = True
            Next
            If vRep = False And cf <> "" Then vComboBox.AddItem (cf)
        End If
        Application.StatusBar = "Sugest|fffd|es Hist|fffd|ricas em " & vCampo & " " & j & "/" & campo.Rows.Count
    Next
    Application.StatusBar = False
End Sub


'EVENTOS DE CAIXA DE TEXTO PARA VALOR FINANCEIRO

Sub EvValor_Cb_MouseMove(Valor_Cb As Control, ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Valor_Cb.Locked = False
    sd = Application.International(xlDecimalSeparator)
    If Valor_Cb.Text = "0" Or Valor_Cb.Text = "0" & sd & "00" Then
        Valor_Cb.SelStart = 0
        Valor_Cb.SelLength = Len(Valor_Cb.Text)
    End If
End Sub

Sub EvValor_Cb_KeyDown(Valor_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    sd = Application.International(xlDecimalSeparator)
    vKeyCode = IIf(sd = ",", 188, 190)
    Valor_Cb.Locked = False
    If KeyCode = 37 Or (Shift = 2 And KeyCode = 86) Or (Shift = 1 And KeyCode = 45) Or (Shift = 2 And KeyCode = 88) Then Exit Sub   'Seta Esquerda e teclas do clipboard
    If KeyCode = 110 Or KeyCode = 190 Then KeyCode = vKeyCode
    If KeyCode = 188 Then If InStr(1, Valor_Cb.Value, sd) > 0 Then Valor_Cb.Locked = True
    If (KeyCode >= 96 And KeyCode <= 105) _
            Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) _
            Or KeyCode = 188 Or KeyCode = 8 Or KeyCode = 46 _
            Or KeyCode = 107 Or (KeyCode = 187 And Shift = 1) _
            Or KeyCode = 109 Or (KeyCode = 189 And Shift = 0) Then Else Valor_Cb.Locked = True
End Sub

Sub EvValor_Cb_Change(Valor_Cb As Control, Optional vAbs As Boolean = False)
    I = Valor_Cb.Value
    j = Valor_Cb.SelStart
    SinNeg = vAbs = False And InStr(1, I, "-") > 0 And InStr(1, I, "+") = 0
    I = Application.WorksheetFunction.Substitute(I, "-", "")
    I = Application.WorksheetFunction.Substitute(I, "+", "")
    PartInt = I
    sd = Application.International(xlDecimalSeparator)
    sm = Application.International(xlThousandsSeparator)
    k = InStr(1, I, sd)
    If k > 0 Then
        PartFrac = Mid(I, k + 1, 100)
        PartFrac = Application.WorksheetFunction.Substitute(PartFrac, sm, "")
        PartInt = Mid(I, 1, k - 1)
        If PartInt = "" Then PartInt = "0"
    End If
    TamPartInt = Len(PartInt)
    PartInt = Application.WorksheetFunction.Substitute(PartInt, sm, "")
    PartInt = Format(PartInt, "#,##0")
    RepCurs = Len(PartInt) - TamPartInt
    vEnableEvents = False
    Valor_Cb.Value = IIf(SinNeg, "-", "") & PartInt & IIf(PartInt = "" Or k = 0, "", sd) & PartFrac
    vEnableEvents = True
    j = -(j + RepCurs) * (j + RepCurs >= 0)
    If Left(Valor_Cb.Value, 2) = "0" & sd And j < 3 Then j = 2
    Valor_Cb.SelStart = j

    'Evita colar texto
    Static ValorOld
    If Valor_Cb.Value <> "" And Valor_Cb.Value <> "-" And Not (IsNumeric(Valor_Cb.Value)) Then
        MsgBox Valor_Cb.Value, vbCritical, "Valor Inv|fffd|lido!"
        Valor_Cb.Value = ValorOld
    Else
        ValorOld = Valor_Cb.Value
    End If
End Sub

Sub EvValor_Cb_Exit(Valor_Cb As Control, Cancel As MSForms.ReturnBoolean, Formato As String)
    If Valor_Cb.Value = "" Then Valor_Cb.Value = 0
    If IsNumeric(Valor_Cb.Value) Then
        If Valor_Cb.Value <> Format(Valor_Cb.Value, Formato) Then Valor_Cb.Value = Format(Valor_Cb.Value, Formato)
    Else
        MsgBox "Data inv|fffd|lida!", vbCritical, "CPAP|fffd|"
        Cancel = True
    End If
End Sub


Sub CalculadoraBtClick(vForm As Object, Valor_Cb As Control, Calculadora_Bt As Control, NumDecim As Integer)
    Calculadora_Bt.SpecialEffect = fmSpecialEffectSunken
    If IsNumeric(Valor_Cb.Value) Then CalculadoraValorIni = IIf(Valor_Cb.Value * 1 = 0, 0, Valor_Cb.Value) Else CalculadoraValorIni = 0
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalcVal").Value = CalculadoraValorIni
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalcDec").Value = NumDecim

    Application.ExecuteExcel4Macro ("cpap_pri.mac!CalcVBA()")

    Valor_Cb.Value = Workbooks("cpap_pri.mac").Sheets(1).Range("CalcVal").Value
    Valor_Cb.SetFocus
    Calculadora_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub



'EVENTOS DE CAIXA DE TEXTO DO CALEND|fffd|RIO

Sub EvCalend_Cb_MouseMove(Data_Cb As Control, ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Data_Cb.Locked = False
End Sub

Sub EvCalend_Cb_KeyDown(Data_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    j = Data_Cb.SelStart
    If KeyCode = 220 Or KeyCode = 191 Then KeyCode = 111   'Trocando \ por /
    If KeyCode = 8 Then KeyCode = 37    'Trocando Backspace por ser a esquerda

    'Setas, teclas do clipboard e /
    If KeyCode = 16 Or KeyCode = 17 _
            Or KeyCode = 37 Or KeyCode = 39 _
            Or (Shift = 2 And KeyCode = 67) _
            Or (Shift = 2 And KeyCode = 86) _
            Or (Shift = 1 And KeyCode = 45) _
            Or (Shift = 2 And KeyCode = 88) _
            Or (KeyCode = 111 And j > 0 And j < 8) Then
        Data_Cb.Locked = False
        Exit Sub
    End If
    If Data_Cb.SelLength > 1 Then Data_Cb.SelStart = j
    If j = 2 Or j = 5 Then Data_Cb.SelStart = j + 1
    Data_Cb.Locked = False
    If (KeyCode >= 96 And KeyCode <= 105) Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) Then Else Data_Cb.Locked = True
    If j >= 8 Then Data_Cb.Locked = True
End Sub

Sub EvCalend_Cb_Change(Data_Cb As Control)
    If vEnableEvents = False Then Exit Sub
    I = Data_Cb.Value
    j = Data_Cb.SelStart
    'Eliminando barra dupla
    iSbd = Application.WorksheetFunction.Substitute(I, "//", "/")
    If I <> iSbd Then
        vEnableEvents = False
        Data_Cb.Value = iSbd
        vEnableEvents = True
        j = InStr(1, I, "//")
        Data_Cb.SelStart = j
        Exit Sub
    End If
    'Prevendo e para manter o formato dd/mm/yy, substituir
    If Len(I) > 8 And j > 0 Then
        vEnableEvents = False
        Data_Cb.Value = Left(I, j) & Mid(I, j + 2, 200)
        vEnableEvents = True
        If j = 2 Or j = 5 Then
            Data_Cb.SelStart = j + 1
        Else
            Data_Cb.SelStart = j
        End If
    End If
    'Tentando limitar a parte do dia
    I = Data_Cb.Value
    If Mid(I, 3, 1) = "/" And IsNumeric(Left(I, 2)) Then
        If Left(I, 2) > 31 And Left(I, 2) < 40 Then
            vEnableEvents = False
            Data_Cb.Value = "30" & Mid(I, 3, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 1
        End If
        If Left(I, 2) > 39 Then
            vEnableEvents = False
            Data_Cb.Value = "0" & Left(I, 1) & Mid(I, 3, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 3
        End If
    End If
    'Tentando limitar a parte do m|fffd|s
    If Mid(I, 3, 1) = "/" And Mid(I, 6, 1) = "/" And IsNumeric(Mid(I, 4, 2)) Then
        If Mid(I, 4, 2) > 12 And Mid(I, 4, 2) < 20 Then
            vEnableEvents = False
            Data_Cb.Value = Left(I, 3) & "12" & Mid(I, 6, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 4
        End If
        If Mid(I, 4, 2) > 19 Then
            vEnableEvents = False
            Data_Cb.Value = Left(I, 3) & "0" & Mid(I, 4, 1) & Mid(I, 6, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 6
        End If
    End If
End Sub

Sub EvCalend_Cb_Exit(Data_Cb As Control, ByVal Cancel As MSForms.ReturnBoolean, Optional DataIni As Date)
    If DataIni = 0 Then DataIni = Now
    I = Data_Cb.Value
    If IsDate(I) Then
        If NmesIndMax = 0 Then NmesIndMax = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("NmesIndMax").Value
        If DateValue(I) < DateSerial(1970, 5, 15) Or DateValue(Data_Cb.Value) > DateSerial(1970, 5 + NmesIndMax, 1) Then
            MsgBox "Data inv|fffd|lida. Digite uma data entre " & Format(DateSerial(1970, 5, 15), "dd/mm/yyyy") & " e " & Format(DateSerial(1970, 5 + NmesIndMax, 1), "dd/mm/yyyy") & ".", vbCritical, "CPAP|fffd|"
            Cancel = True
        End If
        If I <> Format(DateValue(I), "dd/mm/yy") Then Data_Cb.Value = Format(DateValue(I), "dd/mm/yy")
    Else
        'Tentando resolver final de m|fffd|s
        z = InStr(1, I, "/")
        If z > 1 Then
            I1 = Left(I, z - 1)
            i2 = Mid(I, z, 250)
            If IsNumeric(I1) Then
                If IsDate(I1 - 1 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 1 & i2), "dd/mm/yy")
                    Exit Sub
                End If
                If IsDate(I1 - 2 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 2 & i2), "dd/mm/yy")
                    Exit Sub
                End If
                If IsDate(I1 - 3 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 3 & i2), "dd/mm/yy")
                    Exit Sub
                End If
            End If
        End If
        If MsgBox("OK  -  Restaurar inicial, " & Format(DataIni, "dd/mm/yy") & ";" & Chr(10) & Chr(10) & "Cancelar - Voltar para alterar.", vbQuestion + vbOKCancel, "Data Inv|fffd|lida!  Campo: " & Left(Data_Cb.Name, InStr(1, Data_Cb.Name, "_") - 1)) = vbOK Then
            Data_Cb.Value = Format(DataIni, "dd/mm/yy")
        Else
            Cancel = True
        End If
    End If
End Sub


Sub CalendBtClick(vForm As Object, Data_Cb As Control, Calend_Bt As Control)
    Calend_Bt.SpecialEffect = fmSpecialEffectSunken
    CalendDataIni = IIf(IsDate(Data_Cb.Value), Data_Cb.Value, Date)
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalendVal").Value = CalendDataIni

    Application.ExecuteExcel4Macro ("cpap_pri.mac!CalendVBA()")

    Data_Cb.Value = Format(Workbooks("cpap_pri.mac").Sheets(1).Range("CalendVal").Value, "dd/mm/yy")
    Data_Cb.SetFocus
    Calend_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub



'EVENTOS DE CAIXA DE TEXTO PARA N|fffd|MERO DE TELEFONE

Sub EvFone_Cb_Change(Fone_Cb As Control)
    I = Fone_Cb.Value
    j = Fone_Cb.SelStart
    k = Len(I)
    I = Application.WorksheetFunction.Substitute(I, ".", "")
    I = Application.WorksheetFunction.Substitute(I, "-", "")
    vEnableEvents = False
    Fone_Cb.Value = IIf(Len(I) > 3, Left(I, 3) & "-" & Mid(I, 4, 20), I)
    If Len(I) > 7 Then Fone_Cb.Value = Left(I, Len(I) + 4 * (Len(I) > 4)) & "-" & Right(I, 4)
    vEnableEvents = True
    If j < k Then Fone_Cb.SelStart = j
End Sub

Sub EvFone_Cb_KeyDown(Fone_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Fone_Cb.Locked = False
    If KeyCode = 37 Or (Shift = 2 And KeyCode = 86) Or (Shift = 1 And KeyCode = 45) Or (Shift = 2 And KeyCode = 88) Then Exit Sub   'Seta Esquerda e teclas do clipboard
    If KeyCode = 188 Then If InStr(1, Fone_Cb.Value, sd) > 0 Then Fone_Cb.Locked = True
    If (KeyCode >= 96 And KeyCode <= 105) Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) Or KeyCode = 188 Or KeyCode = 8 Or KeyCode = 46 Then Else Fone_Cb.Locked = True
End Sub

Sub DesvanecerMesmoPa|fffd|s(Fone_Cb As Control)
    Pa|fffd|sEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("Pa|fffd|sEmpr").Value & ""
    Fone_Cb.BackColor = IIf(Fone_Cb.Value = Pa|fffd|sEmpr, &H8000000F, &H80000005)
    Fone_Cb.ForeColor = IIf(Fone_Cb.Value = Pa|fffd|sEmpr, &H80000016, &H80000008)
End Sub

Sub DesvanecerMesmaCid(Fone_Cb As Control)
    CidEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("CidEmpr").Value & ""
    Fone_Cb.BackColor = IIf(Fone_Cb.Value = CidEmpr, &H8000000F, &H80000005)
    Fone_Cb.ForeColor = IIf(Fone_Cb.Value = CidEmpr, &H80000016, &H80000008)
End Sub


Attribute VB_Name = "M|fffd|d3VrfCNPJ"
Function DVCGC(CGC As String) As String
    On Error GoTo Err_CGC
    Dim I As Integer   'utilizada nos FOR... NEXT
    Dim strCGC As String   'armazena a parte do CGC entre /0001- ou seja 0001
    Dim strcampo As String   'armazena do CPF que ser|fffd| utilizada para o c|fffd|lculo
    Dim strCaracter As String   'armazena os digitos do CPF da direita para a esquerda
    Dim intNumero As Integer   'armazena o digito separado para c|fffd|lculo (uma a um)
    Dim intMais As Integer   'armazena o digito espec|fffd|fico multiplicado pela sua base
    Dim intSoma As Long   'armazena a soma dos digitos multiplicados pela sua base(intmais)
    Dim intSoma1 As Long   'armazena a soma dos 8 primeiros digitos multiplicados pela sua base(intmais)
    Dim intSoma2 As Long   ''armazena a soma dos 4 ultimos digitos multiplicados pela sua base(intmais)
    Dim dblDivisao As Double   'armazena a divis|fffd|o dos digitos*base por 11
    Dim intInteiro As Long   'armazena inteiro da divis|fffd|o
    Dim intResto As Integer   'armazena o resto
    Dim intDig1 As Integer   'armazena o 1|fffd| digito verificador
    Dim intDig2 As Integer   'armazena o 2|fffd| digito verificador
    Dim strConf As String   'armazena o digito verificador

    intSoma = 0
    intSoma1 = 0
    intSoma2 = 0
    intNumero = 0
    intMais = 0
    'Inicia c|fffd|lculos do 1|fffd| d|fffd|gito
    'Separa os d|fffd|gitos do CGC que ser|fffd|o multiplicados de 2 a 9.
    'Retira a "/" da m|fffd|scara de entrada.
    strCGC = Right(CGC, 7 - 1)   'Tirei 1 ao eliminar o h|fffd|fen
    strCGC = Left(strCGC, 4)
    strcampo = Left(CGC, 8)
    strcampo = Right(strcampo, 4) & strCGC
    For I = 2 To 9
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        intSoma1 = intSoma1 + intMais
    Next I
    'Separa os 4 primeiros d|fffd|gitos do CGC
    strcampo = Left(CGC, 4)
    For I = 2 To 5
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        intSoma2 = intSoma2 + intMais
    Next I
    intSoma = intSoma1 + intSoma2
    dblDivisao = intSoma / 11
    intInteiro = Int(dblDivisao) * 11
    intResto = intSoma - intInteiro
    If intResto = 0 Or intResto = 1 Then
        intDig1 = 0
    Else
        intDig1 = 11 - intResto
    End If
    intSoma = 0
    intSoma1 = 0
    intSoma2 = 0
    intNumero = 0
    intMais = 0
    'Inicia c|fffd|lculos do 2|fffd| d|fffd|gito
    strCGC = Right(CGC, 7 - 1)   'Tirei 1 ao eliminar o h|fffd|fen
    strCGC = Left(strCGC, 4)
    strcampo = Left(CGC, 8)
    strcampo = Right(strcampo, 3) & strCGC & intDig1
    For I = 2 To 9
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        intSoma1 = intSoma1 + intMais
    Next I
    strcampo = Left(CGC, 5)
    For I = 2 To 6
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        intSoma2 = intSoma2 + intMais
    Next I
    intSoma = intSoma1 + intSoma2
    dblDivisao = intSoma / 11
    intInteiro = Int(dblDivisao) * 11
    intResto = intSoma - intInteiro
    If intResto = 0 Or intResto = 1 Then
        intDig2 = 0
    Else
        intDig2 = 11 - intResto
    End If
    strConf = intDig1 & intDig2
    'Caso o CGC esteja errado dispara a mensagem
    If strConf <> Right(CGC, 2) Then
        DVCGC = "False"
    Else
        DVCGC = "True"
    End If
    Exit Function
Exit_CGC:
    Exit Function
Err_CGC:
    '    MsgBox Error$
    DVCGC = "False"   'Eu coloquei
    Resume Exit_CGC
End Function

Function DVCPF(CPF As String) As String
    On Error GoTo Err_CPF
    Dim I As Integer   'utilizada nos FOR... NEXT
    Dim strcampo As String   'armazena do CPF que ser|fffd| utilizada para o c|fffd|lculo
    Dim strCaracter As String   'armazena os digitos do CPF da direita para a esquerda
    Dim intNumero As Integer   'armazena o digito separado para c|fffd|lculo (uma a um)
    Dim intMais As Integer   'armazena o digito espec|fffd|fico multiplicado pela sua base
    Dim lngSoma As Long   'armazena a soma dos digitos multiplicados pela sua base(intmais)
    Dim dblDivisao As Double   'armazena a divis|fffd|o dos digitos*base por 11
    Dim lngInteiro As Long   'armazena inteiro da divis|fffd|o
    Dim intResto As Integer   'armazena o resto
    Dim intDig1 As Integer   'armazena o 1|fffd| digito verificador
    Dim intDig2 As Integer   'armazena o 2|fffd| digito verificador
    Dim strConf As String   'armazena o digito verificador

    If Len(CPF) < 11 Then
        DVCPF = "False"
        Exit Function
    End If

    lngSoma = 0
    intNumero = 0
    intMais = 0
    strcampo = Left(CPF, 9)

    'Inicia c|fffd|lculos do 1|fffd| d|fffd|gito
    For I = 2 To 10
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        lngSoma = lngSoma + intMais
    Next I
    dblDivisao = lngSoma / 11

    lngInteiro = Int(dblDivisao) * 11
    intResto = lngSoma - lngInteiro
    If intResto = 0 Or intResto = 1 Then
        intDig1 = 0
    Else
        intDig1 = 11 - intResto
    End If

    strcampo = strcampo & intDig1   'concatena o CPF com o primeiro digito verificador
    lngSoma = 0
    intNumero = 0
    intMais = 0
    'Inicia c|fffd|lculos do 2|fffd| d|fffd|gito
    For I = 2 To 11
        strCaracter = Right(strcampo, I - 1)
        intNumero = Left(strCaracter, 1)
        intMais = intNumero * I
        lngSoma = lngSoma + intMais
    Next I
    dblDivisao = lngSoma / 11
    lngInteiro = Int(dblDivisao) * 11
    intResto = lngSoma - lngInteiro
    If intResto = 0 Or intResto = 1 Then
        intDig2 = 0
    Else
        intDig2 = 11 - intResto
    End If
    strConf = intDig1 & intDig2
    'Caso o CPF esteja errado dispara a mensagem
    If strConf <> Right(CPF, 2) Then
        DVCPF = "False"
    Else
        DVCPF = "True"
    End If
    Exit Function
Exit_CPF:
    Exit Function
Err_CPF:
    '    MsgBox Error$
    DVCPF = "False"   'Eu coloquei
    Resume Exit_CPF
End Function

Public Function VerifCgcCnpj(I As String)
    I = Application.WorksheetFunction.Substitute(I, ".", "")
    I = Application.WorksheetFunction.Substitute(I, "-", "")
    I = Application.WorksheetFunction.Substitute(I, "/", "")
    Cnpj = DVCGC((I))
    CPF = DVCPF((I))
    If Cnpj = "True" And Len(I) >= 12 Then
        I = Left(I, Len(I) - 12) & "." & Mid(Right(I, 12), 1, 3) & "." & Mid(Right(I, 12), 4, 3) & "/" & Mid(Right(I, 12), 7, 4) & "-" & Right(I, 2)
    Else
        Cnpj = False
    End If
    If CPF = "True" And Len(I) >= 8 And Cnpj = False Then
        I = Left(I, Len(I) - 8) & "." & Mid(Right(I, 8), 1, 3) & "." & Mid(Right(I, 8), 4, 3) & "-" & Right(I, 2)
    Else
        CPF = False
    End If
    VerifCgcCnpj = False
    If Cnpj = "True" Or CPF = "True" Then VerifCgcCnpj = I
End Function

Sub tt()
    I = VerifCgcCnpj("09473513000194")
    j = VerifCgcCnpj("11638575304")
    MsgBox I & "  " & j
End Sub
Attribute VB_Name = "M|fffd|d4Editada"
Sub Editada()
    Dim WbEditada As Workbook
    Set WbEditada = ThisWorkbook
    Windows(WbEditada.Windows(1).Caption).Visible = True
    WbEditada.Activate

    For Each Sh In WbEditada.Sheets
        'Este loop |fffd| usado s|fffd| onde houver planilha de hist|fffd|rico
        If Right(Sh.Name, 4) = ".hst" Then
            Sh.Activate
            NumCampos = Range("A1").CurrentRegion.Columns.Count
            NumSugPadr = Range("A1").CurrentRegion.Rows.Count
            Set Campos = Range(Cells(1, 1), Cells(1, NumCampos))

            'Limpando
            Range("DadosFixos").CurrentRegion.Clear
            Range("DadosHist").CurrentRegion.Clear
            For Each Nome In ActiveWorkbook.ActiveSheet.Names
                Nome.Delete
            Next
            With ActiveWindow
                .SplitColumn = 0
                .SplitRow = 12
            End With

            'Redefinindo
            LFix = 4 + 100   'N|fffd|m de linhas reservadas para sug. fixas. Pode ser alterado o c|fffd|digo |fffd| flex|fffd|vel
            With ActiveWorkbook.ActiveSheet.Names
                Ref = "=" & ActiveWorkbook.ActiveSheet.Name & "!" & Cells(NumSugPadr + 4, 1).Address(ReferenceStyle:=xlR1C1)
                .Add Name:="DadosFixos", RefersToR1C1:=Ref
                Ref = "=" & ActiveWorkbook.ActiveSheet.Name & "!" & Cells(NumSugPadr + 4 + LFix + 1, 1).Address(ReferenceStyle:=xlR1C1)
                .Add Name:="DadosHist", RefersToR1C1:=Ref


                For Each C In Campos
                    .Add Name:=C.Value, RefersToR1C1:=Cells(NumSugPadr + 4, C.Column)
                    .Add Name:=C.Value & "Hist", RefersToR1C1:=Cells(NumSugPadr + 4 + LFix + 2, C.Column)
                    C.Offset(NumSugPadr + 4 + LFix, 0).Value = 15
                    C.Offset(NumSugPadr + 4 + LFix + 1, 0).Value = C.Value & "Hist"
                Next
            End With
            Range("A1").CurrentRegion.Copy
            Range("DadosFixos").PasteSpecial xlPasteValues
            Application.CutCopyMode = False

            ActiveWindow.Panes(1).Activate
            Application.GoTo Reference:="DadosFixos", Scroll:=True
            ActiveWindow.Panes(3).Activate
            Application.GoTo Reference:="DadosHist", Scroll:=True
        End If
    Next

    If WbEditada.ReadOnly Then WbEditada.ChangeFileAccess xlReadWrite
    If Val(Application.Version) < 9 Then If MsgBox(WbEditada.Name & ".  Indenter? (Distanciar margens)", vbOKCancel) = vbOK Then Run "Indenter97.xla!IndentProject"
    WbEditada.Sheets(1).Select
    If MsgBox(WbEditada.Name & ".  Limpar C|fffd|digo?", vbOKCancel) = vbOK Then
        Application.OnTime Now, "VBACodeCleaner.xla!CodeCleanerMain"
    Else
        WbEditada.Save
    End If
End Sub
Attribute VB_Name = "Plan1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

































Attribute VB_Name = "Plan2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


































Attribute VB_Name = "Plan3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

































Attribute VB_Name = "Plan4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

































Attribute VB_Name = "UserForm1Ident"
Attribute VB_Base = "0{B0414F78-3ABC-4916-9377-5E4CF313067B}{32EED0CB-9962-4262-A910-F00C8EC4A0B9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Necess|fffd|rio, devido bug Setfocus em textbox do Excel2k. Isto foi resolvido com SendKeys tamb|fffd|m
Public ControleAtivo As Control

'xxxxx
Private Declare Function GetWindowThreadProcessId Lib "user32" (ByVal hwnd As Long, lpdwprocessid As Long) As Long

Sub aa()
MsgBox ProcIDFromWnd(Application.hwnd)
End Sub

Function ProcIDFromWnd(ByVal hwnd As Long) As Long
    Dim idProc As Long
    GetWindowThreadProcessId hwnd, idProc 'Get PID for this HWnd
    ProcIDFromWnd = idProc
End Function

'xxxxxxxx

Private Sub UserForm_Activate()
    Continuar_Bt.SetFocus
    ControleAtivo.SetFocus
   Cliente_Lb = Cliente_Lb & "  " & ProcIDFromWnd(Application.hwnd)
End Sub
Private Sub UserForm_Deactivate()
    Set ControleAtivo = ActiveControl
End Sub

Private Sub UserForm_Initialize()
    vEnableEvents = True
    ListandoComboBox Data_Cb, "dd/mm/yy"
    'ListandoComboBox |fffd|ndice_Cb
    For I = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Indices1").Rows.Count
        |fffd|ndice_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Indices1").Item(I).Value)
    Next
    vEnableEvents = False
    |fffd|ndice_Cb.Value = |fffd|ndice_Cb.List(nInd + 1 * (nInd > 0))
    vEnableEvents = True
    ListandoComboBox UMonet_Cb
    ListandoComboBox Extenso_Cb
    ListandoComboBox Cliente_Cb
    ListandoComboBox NumPlan_Cb
    ListandoComboBox IdDoBem_Cb
    ListandoComboBox Grupo_Cb
    ListandoComboBox Seq|fffd||fffd|ncia_Cb
    ListandoComboBox Observ_Cb
    Set ControleAtivo = Cliente_Cb
    WhatsThis_Img.Top = -50: If bHtmlHelp Then WhatsThis_Img.Top = -1: WhatsThis_Img.Left = Width - 10
End Sub

Private Sub Calend_Bt_Click()
    CalendBtClick UserForm1Ident, Data_Cb, Calend_Bt
    Application.ScreenUpdating = True
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    BotAcionado = False
End Sub

Private Sub Continuar_Bt_Click()
    Hide
    BotAcionado = 16
End Sub

Private Sub Finalizar_Bt_Click()
    Hide
    BotAcionado = 17
End Sub

Private Sub Cadastro_Bt_Click()
    Hide
    BotAcionado = 18
End Sub

Private Sub Cancelar_Bt_Click()
    Hide
    BotAcionado = 19
End Sub

Private Sub Ajuda_Bt_Click()
    If bHtmlHelp Then Application.Run "CPAP_EX8.MAC!HelpVBA", ThisWorkbook.Path & "\CPAP.chm", HelpContextID, 2 Else Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub

Private Sub Data_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data_Cb, Button, Shift, x, y
End Sub
Private Sub Data_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Calend_Bt_Click
End Sub
Private Sub Data_Cb_Change()
    If Data_Cb.Value = MarcHist Then ConfHist Data_Cb, Format(DateValue(Identifi(3).Value), "dd/mm/yy"), False, "dd/mm/yy"
    EvCalend_Cb_Change Data_Cb
End Sub
Private Sub Data_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data_Cb, Cancel, DateValue(Identifi(3).Value)
End Sub

Private Sub |fffd|ndice_Cb_Click()
    I = |fffd|ndice_Cb.ListIndex + 1
    nTab = Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("nTab").Value
    |fffd|ndice_Cb.ControlTipText = IIf(Len(|fffd|ndice_Cb.Value) < 85, "", |fffd|ndice_Cb.Value)
    If I < 2 Or I = nTab + 1 Or I > 1 + nTab + 1 Then Frame1.Caption = "Tabela de |fffd|ndices:" Else Frame1.Caption = "Tabela de |fffd|ndices:  (" & |fffd|ndicesDispon|fffd|veis() & ")"
    Frame1.ForeColor = IIf(InStr(1, Frame1.Caption, "!") > 0, &HFF&, &H80000012)
    VisualTab_Chb.Enabled = I > 1

    If vEnableEvents = False Then Exit Sub
    Select Case I
    Case Is < 1 + nTab
        nInd = I
    Case Is = 1 + nTab
        t = |fffd|ndice_Cb.List(nInd - 1)
        Application.ExecuteExcel4Macro ("cpap_jap.mac!BancoTab()")
        'Limpando comboboxes
        vEnableEvents = False
        |fffd|ndice_Cb.ListIndex = -1
        While |fffd|ndice_Cb.ListCount >= 1
            |fffd|ndice_Cb.RemoveItem (0)
        Wend
        'Repovoando
        For j = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Indices1").Rows.Count
            |fffd|ndice_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Indices1").Item(j).Value)
        Next
        Err.Number = 0
        On Error Resume Next
        |fffd|ndice_Cb.Value = t
        If Err.Number <> 0 Then
            MsgBox "A tabela de |fffd|ndices " & t & " n|fffd|o foi encontrada. Pode ter sido exclu|fffd|da ou seu nome alterado. Indique uma nova tabela.", vbCritical, "Falha"
            |fffd|ndice_Cb.ListIndex = 0
            nInd = 1
        End If
        On Error GoTo 0
        vEnableEvents = True
    Case Is = 1 + nTab + 1
        nInd = I
    Case Is > 1 + nTab + 1
        vEnableEvents = False
        If Left(|fffd|ndice_Cb.Value, 1) = "|fffd|" Then
            MsgBox "Para editar sugest|fffd|es fixas ou hist|fffd|rico, acione Compor Tabela Mista e, no primeiro campo da caixa de di|fffd|logo, acione Hist|fffd|rico na lista de sugest|fffd|es.", vbInformation, "CPAP|fffd|"
            |fffd|ndice_Cb.Value = |fffd|ndice_Cb.List(nInd - 1)
        Else
            Application.Run "cpap_jap.mac!TabMAlt", |fffd|ndice_Cb.Value
            |fffd|ndice_Cb.List(1 + nTab + 1 - 1) = |fffd|ndice_Cb.Value
            |fffd|ndice_Cb.ListIndex = 1 + nTab + 1 - 1
            nInd = 1 + nTab + 1
        End If
        vEnableEvents = True
    End Select

    UMonet_Cb.Enabled = True
    If UMonet_Cb.Value = "R$" Then Extenso_Cb.Value = "real"
    If nInd > 1 Then
        UMonet_Cb.Value = Left(|fffd|ndice_Cb.Value, InStr(1, |fffd|ndice_Cb.Value, "//") - 1)    'UMonet_Cb.Value = Left(|fffd|ndice_Cb.Value, Application.WorksheetFunction.Find("//", |fffd|ndice_Cb.Value) - 1)
        If UMonet_Cb.Value = "R$" Then Extenso_Cb.Value = "real"
        UMonet_Cb.Enabled = False
    End If
    Application.ScreenUpdating = True
End Sub

Private Sub ComporTabMista_Chb_Click()
    Hide
    BotAcionado = 23
End Sub

Private Sub VisualTab_Chb_Click()
    Hide
    BotAcionado = 24
End Sub

Private Sub UMonet_Cb_Change()
    If UMonet_Cb.Value = MarcHist Then ConfHist UMonet_Cb, Identifi(6).Value
End Sub

Private Sub Extenso_Cb_Change()
    If Extenso_Cb.Value = MarcHist Then ConfHist Extenso_Cb, Identifi(7).Value
End Sub

Private Sub Cliente_Cb_Change()
    If Cliente_Cb.Value = MarcHist Then ConfHist Cliente_Cb, Identifi(9).Value
    I = Cliente_Cb.Value
    j = Cliente_Cb.SelStart
    k = Len(I)
    Cliente_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Cliente_Cb.Value))
    If j < k Then Cliente_Cb.SelStart = j
End Sub

Private Sub IdDoBem_Tb_Change()
    If IdDoBem_Tb.Value = MarcHist Then ConfHist IdDoBem_Cb, Identifi(12).Value
    I = IdDoBem_Tb.Value
    j = IdDoBem_Tb.SelStart
    k = Len(I)
    IdDoBem_Tb.Value = LTrim(UCase(Left(IdDoBem_Tb.Value, 1)) & Mid(IdDoBem_Tb.Value, 2, 254))
    If j < k Then IdDoBem_Tb.SelStart = j
End Sub

Private Sub IdDoBem_Cb_Change()
    IdDoBem_Tb.Value = IdDoBem_Cb.Value
    On Error Resume Next   'Se altera|fffd||fffd|es forem detectada ao fechar a caixa, o controle j|fffd| n|fffd|o poder|fffd| ser focado
    IdDoBem_Tb.SetFocus
End Sub

Private Sub IdDoBem_Tb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    IdDoBem_Cb.Value = IdDoBem_Tb.Value
End Sub

Private Sub Grupo_Cb_Change()
    If Grupo_Cb.Value = MarcHist Then ConfHist Grupo_Cb, Identifi(13).Value
    I = Grupo_Cb.Value
    j = Grupo_Cb.SelStart
    k = Len(I)
    Grupo_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Grupo_Cb.Value))
    If j < k Then Grupo_Cb.SelStart = j
End Sub

Private Sub Seq|fffd||fffd|ncia_Cb_Change()
    If Seq|fffd||fffd|ncia_Cb.Value = MarcHist Then ConfHist Seq|fffd||fffd|ncia_Cb, Identifi(14).Value
    I = Seq|fffd||fffd|ncia_Cb.Value
    j = Seq|fffd||fffd|ncia_Cb.SelStart
    k = Len(I)
    Seq|fffd||fffd|ncia_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Seq|fffd||fffd|ncia_Cb.Value))
    If j < k Then Seq|fffd||fffd|ncia_Cb.SelStart = j
End Sub

Private Sub Observ_Tb_Change()
    If Observ_Tb.Value = MarcHist Then ConfHist Observ_Cb, Identifi(16).Value
    I = Observ_Tb.Value
    j = Observ_Tb.SelStart
    k = Len(I)
    Observ_Tb.Value = LTrim(UCase(Left(Observ_Tb.Value, 1)) & Mid(Observ_Tb.Value, 2, 254))
    If j < k Then Observ_Tb.SelStart = j
End Sub

Private Sub Observ_Cb_Change()
    Observ_Tb.Value = Observ_Cb.Value
    On Error Resume Next   'Se altera|fffd||fffd|es forem detectada ao fechar a caixa, o controle j|fffd| n|fffd|o poder|fffd| ser focado
    Observ_Tb.SetFocus
End Sub

Private Sub Observ_Tb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Observ_Cb.Value = Observ_Tb.Value
End Sub

Private Sub CaptNumSalv_Chb_Click()
    If vEnableEvents = False Then Exit Sub
    I = Application.Run("cpap_jap.mac!CaptDad", 2)
    If I <> False Then
        Observ_Tb.Value = Observ_Tb.Value & I
        Observ_Tb.SetFocus
    End If
    vEnableEvents = False
    CaptNumSalv_Chb.Value = False
    vEnableEvents = True
    AppActivate Caption
    Application.ScreenUpdating = True
End Sub

Private Sub CaptNumASalv_Chb_Click()
    If vEnableEvents = False Then Exit Sub
    I = Application.Run("cpap_jap.mac!CaptDad", 1)
    If MsgBox(I & " ser|fffd| o n|fffd|mero do pr|fffd|ximo plano a ser salvo pelo M|fffd|dulo de Planos de Pagamentos." & Chr(10) & "Inserir na caixa de observa|fffd||fffd|es?", vbQuestion + vbOKCancel, "Pr|fffd|ximo N|fffd|mero") = vbOK Then
        Observ_Tb.Value = Observ_Tb.Value & I
        Observ_Tb.SetFocus
    End If
    vEnableEvents = False
    CaptNumASalv_Chb.Value = False
    vEnableEvents = True
    Application.ScreenUpdating = True
End Sub

Private Sub Agenda_Click()
    Application.ExecuteExcel4Macro ("cpap_pri.mac!Calendario()")
End Sub


Function |fffd|ndicesDispon|fffd|veis()
    Dim DC As Single   'Resolve erro 2015
    With Application.Workbooks("cpap_jap.mac").Sheets(1)
        Col = .Range("C|fffd|lRef").Column + 1
        If NmesIndMax = 0 Then NmesIndMax = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("NmesIndMax").Value
        Set vRange|fffd|nd = .Range(.Cells(5, Col), .Cells(4 + NmesIndMax, Col))
    End With
    t = |fffd|ndice_Cb.Value
    DC = Identifi(17).Value
    Cfg = Identifi(18).Value
    If Len(Cfg) < 5 Then DInd = -1 Else DInd = Choose(Int(Mid(Cfg, 2, 1)), -2, -1, 0)
    I = Application.WorksheetFunction.Substitute(t, " at|fffd| Entrg", " at|fffd| " & Format(DateSerial(Year(DC), Month(DC) + DInd, Day(DC)), "mm/yy")) _
            = vRange|fffd|nd.Cells(-2, 1).Value
    If I = False Then I = Application.Run("cpap_jap.mac!CaptTabM", t, |fffd|ndice_Cb.ListIndex + 1, DC, Cfg)
    If IsError(I) Then   'Ocorre erro 2015 s|fffd| no Excel97-port, necessita acionar o bot|fffd|o Calcular para captura a tabela. Foi resolvido com DC as Single
        |fffd|ndicesDispon|fffd|veis = "??"
        Exit Function
    End If
    If I Then
        vInd1 = ""
        vInd2 = ""
        vInd3 = ""
        For I = vRange|fffd|nd.Rows.Count To 1 Step -1
            vValor = vRange|fffd|nd.Cells(I, 1).Value
            If vValor <> "" And vInd1 = "" Then vInd1 = I
            If vValor = "" And vInd1 <> "" And vInd2 = "" Then vInd2 = I
            If vValor <> "" And vInd2 <> "" Then vInd3 = I
        Next
        If vInd1 <> "" Then
            vM|fffd|s1 = Format(Application.Run("Cpap_ex8.mac!MyEdate", DateSerial(1970, 5, 1) * 1, vInd1 - 1), "mmm/yy")
            vM|fffd|s2 = Format(Application.Run("Cpap_ex8.mac!MyEdate", DateSerial(1970, 5, 1) * 1, IIf(vInd2 = "", 0, vInd2)), "mmm/yy")
        End If
        If vInd3 <> "" Then
            vM|fffd|s2 = Format(Application.Run("Cpap_ex8.mac!MyEdate", DateSerial(1970, 5, 1) * 1, vInd2 - 1), "mmm/yy")
            vM|fffd|s3 = Format(Application.Run("Cpap_ex8.mac!MyEdate", DateSerial(1970, 5, 1) * 1, vInd3 - 1), "mmm/yy")
        End If
        If vInd1 = "" And vInd2 = "" And vInd3 = "" Then vRet = "Dispon|fffd|veis: Nenhum"
        If vInd1 <> "" And vInd3 = "" Then vRet = "Dispon|fffd|veis: " & vM|fffd|s2 & " a " & vM|fffd|s1
        If vInd1 <> "" And vInd3 <> "" Then vRet = "Dispon|fffd|veis: " & vM|fffd|s3 & " a " & vM|fffd|s1 & " - FALHA!: " & vM|fffd|s2
    Else
        vRet = "N|fffd|o Encontrada ou Faltam Componentes!"
    End If
    vRet = Application.WorksheetFunction.Substitute(vRet, " a dez/20", " ao fim")
    |fffd|ndicesDispon|fffd|veis = vRet
End Function

Private Sub WhatsThis_Img_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Static cHHelpWhatsThis1 As Object
    If cHHelpWhatsThis1 Is Nothing Then Set cHHelpWhatsThis1 = Application.Run("CPAP_EX8.MAC!New_cHHelpWhatsThis")
    cHHelpWhatsThis1.WhatsThis_Img_MouseDown Button, Shift, x, y, Me
    If WhatsThis_Img.BackStyle = fmBackStyleOpaque Then Set cHHelpWhatsThis1 = Nothing
End Sub


Attribute VB_Name = "UserForm2Cad"
Attribute VB_Base = "0{0A4B72CF-36B0-4B33-922B-A01B7DF8DF6E}{062A7F81-1677-410E-9B9C-F6960024E09D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Necess|fffd|rio, devido bug Setfocus em textbox do Excel2k. Isto foi resolvido com SendKeys tamb|fffd|m
Public ControleAtivo As Control

Private Sub MesmoPa|fffd|sCid_Chb_Click()
    Pa|fffd|sEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("Pa|fffd|sEmpr").Value & ""
    CidEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("CidEmpr").Value & ""
    FoneResPa|fffd|s_Cb.Value = Pa|fffd|sEmpr
    FoneResCid_Cb.Value = CidEmpr
    FoneTrabPa|fffd|s_Cb.Value = Pa|fffd|sEmpr
    FoneTrabCid_Cb.Value = CidEmpr
    FoneAltPa|fffd|s_Cb.Value = Pa|fffd|sEmpr
    FoneAltCid_Cb.Value = CidEmpr
    FoneCelPa|fffd|s_Cb.Value = Pa|fffd|sEmpr
    FoneCelCid_Cb.Value = CidEmpr
    MesmoPa|fffd|sCid_Chb.Value = False
End Sub

Private Sub UserForm_Activate()
    CidadeUf_Cb.SetFocus
    ControleAtivo.SetFocus
End Sub
Private Sub UserForm_Deactivate()
    Set ControleAtivo = ActiveControl
End Sub

Private Sub UserForm_Initialize()
    ListandoComboBox Endere|fffd|o_Cb
    ListandoComboBox CidadeUf_Cb
    ListandoComboBox CEP_Cb
    ListandoComboBox Nacionalidade_Cb
    ListandoComboBox Profiss|fffd|o_Cb
    ListandoComboBox CNPJ_Cb
    ListandoComboBox RG_Cb
    ListandoComboBox Internet_Cb
    ListandoComboBox Endere|fffd|oComercial_Cb
    ListandoComboBox Outros1_Cb
    ListandoComboBox Outros2_Cb

    ListandoComboBox EstCivil_Cb
    ListandoComboBox Regime_Cb

    ListandoComboBox FoneResPa|fffd|s_Cb
    ListandoComboBox FoneResCid_Cb
    ListandoComboBox FoneResLoc_Cb
    ListandoComboBox FoneResRam_Cb
    ListandoComboBox FoneTrabPa|fffd|s_Cb
    ListandoComboBox FoneTrabCid_Cb
    ListandoComboBox FoneTrabLoc_Cb
    ListandoComboBox FoneTrabRam_Cb
    ListandoComboBox FoneAltPa|fffd|s_Cb
    ListandoComboBox FoneAltCid_Cb
    ListandoComboBox FoneAltLoc_Cb
    ListandoComboBox FoneAltRam_Cb
    ListandoComboBox FoneCelPa|fffd|s_Cb
    ListandoComboBox FoneCelCid_Cb
    ListandoComboBox FoneCelLoc_Cb
    ListandoComboBox FoneCelRam_Cb

    ListandoComboBox NomeC|fffd|njuge_Cb
    ListandoComboBox Endere|fffd|oC|fffd|njuge_Cb
    ListandoComboBox CidadeUfC|fffd|njuge_Cb
    ListandoComboBox CepC|fffd|njuge_Cb
    ListandoComboBox NacionalidadeC|fffd|njuge_Cb
    ListandoComboBox CpfC|fffd|njuge_Cb
    ListandoComboBox RgC|fffd|njuge_Cb
    ListandoComboBox Profiss|fffd|oC|fffd|njuge_Cb

    MultiPage1.Value = 0
    Set ControleAtivo = Endere|fffd|o_Cb
    WhatsThis_Img.Top = -50: If bHtmlHelp Then WhatsThis_Img.Top = -1: WhatsThis_Img.Left = Width - 10
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    BotAcionado = 3
End Sub

Private Sub Continuar_Bt_Click()
    If CadCriticar Then
        Hide
        BotAcionado = 1
    End If
End Sub

Private Sub Finalizar_Bt_Click()
    If CadCriticar Then
        Hide
        BotAcionado = 2
    End If
End Sub

Private Sub Cancelar_Bt_Click()
    Hide
    BotAcionado = 3
End Sub

Private Sub Importar_Bt_Click()
    Hide
    BotAcionado = 5
End Sub

Private Sub Discar_Bt_Click()
    FoneRes = IIf(FoneResLoc_Cb.Value = "", "", FoneResPa|fffd|s_Cb.Value & "(" & FoneResCid_Cb.Value & ")" & FoneResLoc_Cb.Value & "|fffd|" & FoneResRam_Cb.Value)
    FoneTrab = IIf(FoneTrabLoc_Cb.Value = "", "", FoneTrabPa|fffd|s_Cb.Value & "(" & FoneTrabCid_Cb.Value & ")" & FoneTrabLoc_Cb.Value & "|fffd|" & FoneTrabRam_Cb.Value)
    FoneAlt = IIf(FoneAltLoc_Cb.Value = "", "", FoneAltPa|fffd|s_Cb.Value & "(" & FoneAltCid_Cb.Value & ")" & FoneAltLoc_Cb.Value & "|fffd|" & FoneAltRam_Cb.Value)
    FoneCel = IIf(FoneCelLoc_Cb.Value = "", "", FoneCelPa|fffd|s_Cb.Value & "(" & FoneCelCid_Cb.Value & ")" & FoneCelLoc_Cb.Value & "|fffd|" & FoneCelRam_Cb.Value)
    Application.Run "cpap_pri.mac!Discar", Cliente, FoneRes, FoneTrab, FoneAlt, FoneCel
End Sub

Private Sub Endere|fffd|o_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Endere|fffd|o_Cb.Value = MarcHist Then ConfHist Endere|fffd|o_Cb, Cadastr(4).Value
    I = Endere|fffd|o_Cb.Value
    j = Endere|fffd|o_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Endere|fffd|o_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Endere|fffd|o_Cb.Value))
    vEnableEvents = True
    If j < k Then Endere|fffd|o_Cb.SelStart = j
End Sub
Private Sub CidadeUf_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If CidadeUf_Cb.Value = MarcHist Then ConfHist CidadeUf_Cb, Cadastr(5).Value
    I = CidadeUf_Cb.Value
    j = CidadeUf_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    CidadeUf_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", CidadeUf_Cb.Value))
    vEnableEvents = True
    If j < k Then CidadeUf_Cb.SelStart = j
End Sub
Private Sub CEP_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If CEP_Cb.Value = MarcHist Then ConfHist CEP_Cb, Cadastr(6).Value
    I = CEP_Cb.Value
    j = CEP_Cb.SelStart
    k = Len(I)
    I = Application.WorksheetFunction.Substitute(I, ".", "")
    I = Application.WorksheetFunction.Substitute(I, "-", "")
    vEnableEvents = False
    CEP_Cb.Value = Mid(I, 1, 2) & IIf(Len(I) > 2, "." & Mid(I, 3, 3) & IIf(Len(I) > 5, "-" & Mid(I, 6, 3), ""), "")
    vEnableEvents = True
    If j < k Then CEP_Cb.SelStart = j
End Sub

Private Sub Nacionalidade_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Nacionalidade_Cb.Value = MarcHist Then ConfHist Nacionalidade_Cb, Cadastr(8).Value
    I = Nacionalidade_Cb.Value
    j = Nacionalidade_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Nacionalidade_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Nacionalidade_Cb.Value))
    vEnableEvents = True
    If j < k Then Nacionalidade_Cb.SelStart = j
End Sub

Private Sub Profiss|fffd|o_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Profiss|fffd|o_Cb.Value = MarcHist Then ConfHist Profiss|fffd|o_Cb, Cadastr(9).Value
    I = Profiss|fffd|o_Cb.Value
    j = Profiss|fffd|o_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Profiss|fffd|o_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Profiss|fffd|o_Cb.Value))
    vEnableEvents = True
    If j < k Then Profiss|fffd|o_Cb.SelStart = j
End Sub

Private Sub CNPJ_Cb_Change()
    If CNPJ_Cb.Value = MarcHist Then ConfHist CNPJ_Cb, Cadastr(14).Value
End Sub

Private Sub CNPJ_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Dim I As String
    I = CNPJ_Cb.Value
    j = CNPJ_Cb.SelStart
    k = Len(I)
    If k = 0 Then Exit Sub
    I1 = VerifCgcCnpj(I)
    If Not I1 = False Then
        CNPJ_Cb.Value = I1
        CNPJ_Cb.ForeColor = RGB(0, 0, 0)
    Else
        If MsgBox("N|fffd|mero inv|fffd|lido para CPF e para CNPJ! Continua assim mesmo?", vbQuestion + vbOKCancel, "N|fffd|mero Inv|fffd|lido") = vbCancel Then Cancel = True
        CNPJ_Cb.ForeColor = RGB(255, 0, 0)  'Cor - Ciano
        If j < k Then CNPJ_Cb.SelStart = j
    End If
End Sub

Private Sub RG_Cb_Change()
    If RG_Cb.Value = MarcHist Then ConfHist RG_Cb, Cadastr(15).Value
End Sub
Private Sub Internet_Cb_Change()
    If Internet_Cb.Value = MarcHist Then ConfHist Internet_Cb, Cadastr(16).Value
End Sub

Private Sub Endere|fffd|oComercial_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Endere|fffd|oComercial_Cb.Value = MarcHist Then ConfHist Endere|fffd|oComercial_Cb, Cadastr(17).Value
    I = Endere|fffd|oComercial_Cb.Value
    j = Endere|fffd|oComercial_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Endere|fffd|oComercial_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Endere|fffd|oComercial_Cb.Value))
    vEnableEvents = True
    If j < k Then Endere|fffd|oComercial_Cb.SelStart = j
End Sub

Private Sub Outros1_Cb_Change()
    If Outros1_Cb.Value = MarcHist Then ConfHist Outros1_Cb, Cadastr(19).Value
End Sub
Private Sub Outros2_Cb_Change()
    If Outros2_Cb.Value = MarcHist Then ConfHist Outros2_Cb, Cadastr(20).Value
End Sub



Private Sub EstCivil_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If EstCivil_Cb.Value = MarcHist Then ConfHist EstCivil_Cb, Cadastr(21).Value
    I = EstCivil_Cb.Value
    j = EstCivil_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    EstCivil_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", EstCivil_Cb.Value))
    vEnableEvents = True
    If j < k Then EstCivil_Cb.SelStart = j

    If InStr(1, LCase(EstCivil_Cb.Value), "casad") = 0 Then
        Regime_Cb.Value = ""
        Regime_Cb.Enabled = False
        MultiPage1(2).Enabled = False
    Else
        Regime_Cb.Enabled = True
        MultiPage1(2).Enabled = True
    End If
End Sub

Private Sub Regime_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Regime_Cb.Value = MarcHist Then ConfHist Regime_Cb, Cadastr(22).Value
    I = Regime_Cb.Value
    j = Regime_Cb.SelStart
    k = Len(I)
    '    Regime_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Regime_Cb.Value))
    If j < k Then Regime_Cb.SelStart = j
End Sub



Private Sub FoneResPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneResPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResPa|fffd|s_Cb.Value = MarcHist Then ConfHist FoneResPa|fffd|s_Cb, Cadastr(23).Value
    EvFone_Cb_Change FoneResPa|fffd|s_Cb
    DesvanecerMesmoPa|fffd|s FoneResPa|fffd|s_Cb
End Sub

Private Sub FoneResCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneResCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResCid_Cb.Value = MarcHist Then ConfHist FoneResCid_Cb, Cadastr(24).Value
    EvFone_Cb_Change FoneResCid_Cb
    DesvanecerMesmaCid FoneResCid_Cb
End Sub


Private Sub FoneResLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneResLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResLoc_Cb.Value = MarcHist Then ConfHist FoneResLoc_Cb, Cadastr(25).Value
    EvFone_Cb_Change FoneResLoc_Cb
End Sub

Private Sub FoneResRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneResRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResRam_Cb.Value = MarcHist Then ConfHist FoneResRam_Cb, Cadastr(26).Value
    EvFone_Cb_Change FoneResRam_Cb
End Sub




Private Sub FoneTrabPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabPa|fffd|s_Cb.Value = MarcHist Then ConfHist FoneTrabPa|fffd|s_Cb, Cadastr(27).Value
    EvFone_Cb_Change FoneTrabPa|fffd|s_Cb
    DesvanecerMesmoPa|fffd|s FoneTrabPa|fffd|s_Cb
End Sub

Private Sub FoneTrabCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabCid_Cb.Value = MarcHist Then ConfHist FoneTrabCid_Cb, Cadastr(28).Value
    EvFone_Cb_Change FoneTrabCid_Cb
    DesvanecerMesmaCid FoneTrabCid_Cb
End Sub

Private Sub FoneTrabLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabLoc_Cb.Value = MarcHist Then ConfHist FoneTrabLoc_Cb, Cadastr(29).Value
    EvFone_Cb_Change FoneTrabLoc_Cb
End Sub

Private Sub FoneTrabRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabRam_Cb.Value = MarcHist Then ConfHist FoneTrabRam_Cb, Cadastr(30).Value
    EvFone_Cb_Change FoneTrabRam_Cb
End Sub




Private Sub FoneAltPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltPa|fffd|s_Cb.Value = MarcHist Then ConfHist FoneAltPa|fffd|s_Cb, Cadastr(31).Value
    EvFone_Cb_Change FoneAltPa|fffd|s_Cb
    DesvanecerMesmoPa|fffd|s FoneAltPa|fffd|s_Cb
End Sub

Private Sub FoneAltCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltCid_Cb.Value = MarcHist Then ConfHist FoneAltCid_Cb, Cadastr(32).Value
    EvFone_Cb_Change FoneAltCid_Cb
    DesvanecerMesmaCid FoneAltCid_Cb
End Sub

Private Sub FoneAltLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltLoc_Cb.Value = MarcHist Then ConfHist FoneAltLoc_Cb, Cadastr(33).Value
    EvFone_Cb_Change FoneAltLoc_Cb
End Sub

Private Sub FoneAltRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltRam_Cb.Value = MarcHist Then ConfHist FoneAltRam_Cb, Cadastr(34).Value
    EvFone_Cb_Change FoneAltRam_Cb
End Sub





Private Sub FoneCelPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelPa|fffd|s_Cb.Value = MarcHist Then ConfHist FoneCelPa|fffd|s_Cb, Cadastr(35).Value
    EvFone_Cb_Change FoneCelPa|fffd|s_Cb
    DesvanecerMesmoPa|fffd|s FoneCelPa|fffd|s_Cb
End Sub

Private Sub FoneCelCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelCid_Cb.Value = MarcHist Then ConfHist FoneCelCid_Cb, Cadastr(36).Value
    EvFone_Cb_Change FoneCelCid_Cb
    DesvanecerMesmaCid FoneCelCid_Cb
End Sub

Private Sub FoneCelLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelLoc_Cb.Value = MarcHist Then ConfHist FoneCelLoc_Cb, Cadastr(37).Value
    EvFone_Cb_Change FoneCelLoc_Cb
End Sub

Private Sub FoneCelRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelRam_Cb.Value = MarcHist Then ConfHist FoneCelRam_Cb, Cadastr(38).Value
    EvFone_Cb_Change FoneCelRam_Cb
End Sub



Private Sub NomeC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If NomeC|fffd|njuge_Cb.Value = MarcHist Then ConfHist NomeC|fffd|njuge_Cb, Cadastr(4).Value
    I = NomeC|fffd|njuge_Cb.Value
    j = NomeC|fffd|njuge_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    NomeC|fffd|njuge_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", NomeC|fffd|njuge_Cb.Value))
    vEnableEvents = True
    If j < k Then NomeC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub MesmoEndTitular_Chb_Click()
    MesmoEndTitular_Chb.Value = False
    Endere|fffd|oC|fffd|njuge_Cb.Value = Endere|fffd|o_Cb.Value
    CidadeUfC|fffd|njuge_Cb.Value = CidadeUf_Cb.Value
    CepC|fffd|njuge_Cb.Value = CEP_Cb.Value
End Sub

Private Sub Endere|fffd|oC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Endere|fffd|oC|fffd|njuge_Cb.Value = MarcHist Then ConfHist Endere|fffd|oC|fffd|njuge_Cb, Cadastr(4).Value
    I = Endere|fffd|oC|fffd|njuge_Cb.Value
    j = Endere|fffd|oC|fffd|njuge_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Endere|fffd|oC|fffd|njuge_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Endere|fffd|oC|fffd|njuge_Cb.Value))
    vEnableEvents = True
    If j < k Then Endere|fffd|oC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub CidadeUfC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If CidadeUfC|fffd|njuge_Cb.Value = MarcHist Then ConfHist CidadeUfC|fffd|njuge_Cb, Cadastr(5).Value
    I = CidadeUfC|fffd|njuge_Cb.Value
    j = CidadeUfC|fffd|njuge_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    CidadeUfC|fffd|njuge_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", CidadeUfC|fffd|njuge_Cb.Value))
    vEnableEvents = True
    If j < k Then CidadeUfC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub CEPC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If CepC|fffd|njuge_Cb.Value = MarcHist Then ConfHist CepC|fffd|njuge_Cb, Cadastr(6).Value
    I = CepC|fffd|njuge_Cb.Value
    j = CepC|fffd|njuge_Cb.SelStart
    k = Len(I)
    I = Application.WorksheetFunction.Substitute(I, ".", "")
    I = Application.WorksheetFunction.Substitute(I, "-", "")
    vEnableEvents = False
    CepC|fffd|njuge_Cb.Value = Mid(I, 1, 2) & IIf(Len(I) > 2, "." & Mid(I, 3, 3) & IIf(Len(I) > 5, "-" & Mid(I, 6, 3), ""), "")
    vEnableEvents = True
    If j < k Then CepC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub NacionalidadeC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If NacionalidadeC|fffd|njuge_Cb.Value = MarcHist Then ConfHist NacionalidadeC|fffd|njuge_Cb, Cadastr(8).Value
    I = NacionalidadeC|fffd|njuge_Cb.Value
    j = NacionalidadeC|fffd|njuge_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    NacionalidadeC|fffd|njuge_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", NacionalidadeC|fffd|njuge_Cb.Value))
    vEnableEvents = True
    If j < k Then NacionalidadeC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub Profiss|fffd|oC|fffd|njuge_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Profiss|fffd|oC|fffd|njuge_Cb.Value = MarcHist Then ConfHist Profiss|fffd|oC|fffd|njuge_Cb, Cadastr(9).Value
    I = Profiss|fffd|oC|fffd|njuge_Cb.Value
    j = Profiss|fffd|oC|fffd|njuge_Cb.SelStart
    k = Len(I)
    vEnableEvents = False
    Profiss|fffd|oC|fffd|njuge_Cb.Value = LTrim(Application.Run("Cpap_pri.mac!PROPERx", Profiss|fffd|oC|fffd|njuge_Cb.Value))
    vEnableEvents = True
    If j < k Then Profiss|fffd|oC|fffd|njuge_Cb.SelStart = j
End Sub

Private Sub CpfC|fffd|njuge_Cb_Change()
    If CpfC|fffd|njuge_Cb.Value = MarcHist Then ConfHist CpfC|fffd|njuge_Cb, Cadastr(14).Value
End Sub

Private Sub CpfC|fffd|njuge_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Dim I As String
    I = CpfC|fffd|njuge_Cb.Value
    j = CpfC|fffd|njuge_Cb.SelStart
    k = Len(I)
    If k = 0 Then Exit Sub
    I1 = VerifCgcCnpj(I)
    If Not I1 = False Then
        CpfC|fffd|njuge_Cb.Value = I1
        CpfC|fffd|njuge_Cb.ForeColor = RGB(0, 0, 0)
    Else
        If MsgBox("N|fffd|mero inv|fffd|lido para CPF e para CNPJ! Continua assim mesmo?", vbQuestion + vbOKCancel, "N|fffd|mero Inv|fffd|lido") = vbCancel Then Cancel = True
        CpfC|fffd|njuge_Cb.ForeColor = RGB(255, 0, 0)  'Cor - Ciano
        If j < k Then CpfC|fffd|njuge_Cb.SelStart = j
    End If
End Sub

Private Sub RgC|fffd|njuge_Cb_Change()
    If RgC|fffd|njuge_Cb.Value = MarcHist Then ConfHist RgC|fffd|njuge_Cb, Cadastr(15).Value
End Sub


Private Function CadCriticar() As Boolean
'Tamanho m|fffd|ximo do id do conjuge de 255 caract.
    CadCriticar = True
    I = Len(NomeC|fffd|njuge_Cb.Value & Endere|fffd|oC|fffd|njuge_Cb.Value & CidadeUfC|fffd|njuge_Cb.Value & CepC|fffd|njuge_Cb.Value & NacionalidadeC|fffd|njuge_Cb.Value & CpfC|fffd|njuge_Cb.Value & RgC|fffd|njuge_Cb.Value & Profiss|fffd|oC|fffd|njuge_Cb.Value)
    If I > 255 - 8 Then
        MsgBox "O total de caracteres na identifica|fffd||fffd|o do c|fffd|njuge n|fffd|o pode passar de 247. H|fffd| " & I - 247 & " a mais. Tente reduzir fazendo contra|fffd||fffd|es.", vbCritical + vbOKOnly, " Id. do C|fffd|njuge, Excesso de Caracteres"
        CadCriticar = False
        MultiPage1.Value = 2
    End If
    I = Len(Endere|fffd|o_Cb.Value & CidadeUf_Cb.Value & Profiss|fffd|o_Cb.Value)
    If Len(FoneCelLoc_Cb.Value) < 7 And I > 3 And CadCriticar Then
        If MsgBox("Voc|fffd| n|fffd|o informou o Celular do cliente. Continua assim mesmo?", vbQuestion + vbYesNo, "N|fffd|mero do Celular") = vbNo Then
            CadCriticar = False
            MultiPage1.Value = 1
            FoneCelLoc_Cb.SetFocus
        End If
    End If
End Function

Private Sub WhatsThis_Img_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Static cHHelpWhatsThis1 As Object
    If cHHelpWhatsThis1 Is Nothing Then Set cHHelpWhatsThis1 = Application.Run("CPAP_EX8.MAC!New_cHHelpWhatsThis")
    cHHelpWhatsThis1.WhatsThis_Img_MouseDown Button, Shift, x, y, Me
    If WhatsThis_Img.BackStyle = fmBackStyleOpaque Then Set cHHelpWhatsThis1 = Nothing
End Sub



Attribute VB_Name = "UserForm3Princ"
Attribute VB_Base = "0{1243040E-5303-4D62-8C48-335C1C140176}{A94811C2-7ED1-4D16-9D0E-796FD83A173D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Necess|fffd|rio, devido bug Setfocus em textbox do Excel2k. Isto foi resolvido com SendKeys tamb|fffd|m
Public ControleAtivo As Control

Private Sub UserForm_Activate()
    If PlnEqCal Then ValorPlano_Cb.SetFocus Else MesesEntrg_Cb.SetFocus
    ControleAtivo.SetFocus
End Sub
Private Sub UserForm_Deactivate()
    Set ControleAtivo = ActiveControl
End Sub


Private Sub UserForm_Initialize()
    vEnableEvents = True
    'ListandoComboBox Meses
    For I = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Meses").Rows.Count
        MesesEntrg_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Meses").Item(I).Value)
        MesesPriPrest_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Meses").Item(I).Value)
    Next
    MesesEntrg_Cb.Value = MesesEntrg_Cb.List(nMesesEntrg + 1 * (nMesesEntrg > 0))
    MesesPriPrest_Cb.Value = MesesPriPrest_Cb.List(nMesesPriPrest + 1 * (nMesesPriPrest > 0))
    'ListandoComboBox MaisDias
    For I = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Dias").Rows.Count
        DiasEntrg_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Dias").Item(I).Value)
        DiasPriPrest_Cb.AddItem (Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Dias").Item(I).Value)
    Next
    DiasEntrg_Cb.Value = DiasEntrg_Cb.List(nDiasEntrg + 1 * (nDiasEntrg > 0))
    DiasPriPrest_Cb.Value = DiasPriPrest_Cb.List(nDiasPriPrest + 1 * (nDiasPriPrest > 0))

    ListandoComboBox DataEntrg_Cb, "dd/mm/yy"
    ListandoComboBox DataPriPrest_Cb, "dd/mm/yy"
    ListandoComboBox JurTaxa_Cb, "#,##0.00########"
    ListandoComboBox QuantPriS|fffd|rie_Cb
    ListandoComboBox QuantSegS|fffd|rie_Cb
    ListandoComboBox QuantTerS|fffd|rie_Cb
    ListandoComboBox QuantQuaS|fffd|rie_Cb
    ListandoComboBox QuantQuiS|fffd|rie_Cb
    ListandoComboBox QuantSexS|fffd|rie_Cb
    ListandoComboBox QuantS|fffd|tS|fffd|rie_Cb
    ListandoComboBox QuantOitS|fffd|rie_Cb

    ListandoComboBox Saldo_Cb, "#,##0.00"
    ListandoComboBox ValorEntrd_Cb, "#,##0.00"
    ListandoComboBox ValorEntrg_Cb, "#,##0.00"
    ListandoComboBox ValorPlano_Cb, "#,##0.00"
    ListandoComboBox ValorPriS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorSegS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorTerS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorQuaS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorQuiS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorSexS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorS|fffd|tS|fffd|rie_Cb, "#,##0.00"
    ListandoComboBox ValorOitS|fffd|rie_Cb, "#,##0.00"

    Set ControleAtivo = ValorPlano_Cb
    Top = Application.Top + IIf(Val(Application.Version) < 12, 45 + 11, 95 + 35): Left = Application.Left + 3 'Com StartUpPosition Manual.
End Sub


Private Sub DataEntrgCalend_Bt_Click()
    CalendBtClick UserForm3Princ, DataEntrg_Cb, DataEntrgCalend_Bt
    Calcular_Bt.SetFocus: DataEntrg_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub
Private Sub DataPriPrestCalend_Bt_Click()
    CalendBtClick UserForm3Princ, DataPriPrest_Cb, DataPriPrestCalend_Bt
    Calcular_Bt.SetFocus: DataPriPrest_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub


Private Sub JurTaxaCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, JurTaxa_Cb, JurTaxaCalculadora_Bt, 5
End Sub
Private Sub ValorPlanoCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorPlano_Cb, ValorPlanoCalculadora_Bt, 2
End Sub
Private Sub SaldoCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, Saldo_Cb, SaldoCalculadora_Bt, 2
End Sub
Private Sub ValorEntrdCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorEntrd_Cb, ValorEntrdCalculadora_Bt, 2
End Sub
Private Sub ValorEntrgCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorEntrg_Cb, ValorEntrgCalculadora_Bt, 2
End Sub
Private Sub QuantPriS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantPriS|fffd|rie_Cb, QuantPriS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantSegS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantSegS|fffd|rie_Cb, QuantSegS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantTerS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantTerS|fffd|rie_Cb, QuantTerS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantQuaS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantQuaS|fffd|rie_Cb, QuantQuaS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantQuiS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantQuiS|fffd|rie_Cb, QuantQuiS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantSexS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantSexS|fffd|rie_Cb, QuantSexS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantS|fffd|tS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantS|fffd|tS|fffd|rie_Cb, QuantS|fffd|tS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub QuantOitS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, QuantOitS|fffd|rie_Cb, QuantOitS|fffd|rieCalculadora_Bt, 0
End Sub
Private Sub ValorPriS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorPriS|fffd|rie_Cb, ValorPriS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorSegS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorSegS|fffd|rie_Cb, ValorSegS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorTerS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorTerS|fffd|rie_Cb, ValorTerS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorQuaS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorQuaS|fffd|rie_Cb, ValorQuaS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorQuiS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorQuiS|fffd|rie_Cb, ValorQuiS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorSexS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorSexS|fffd|rie_Cb, ValorSexS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorS|fffd|tS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorS|fffd|tS|fffd|rie_Cb, ValorS|fffd|tS|fffd|rieCalculadora_Bt, 2
End Sub
Private Sub ValorOitS|fffd|rieCalculadora_Bt_Click()
    CalculadoraBtClick UserForm3Princ, ValorOitS|fffd|rie_Cb, ValorOitS|fffd|rieCalculadora_Bt, 2
End Sub

Private Sub JurTaxaEq_Bt_Click()
    JurTaxaEq_Bt.SpecialEffect = fmSpecialEffectSunken
    If IsNumeric(JurTaxa_Cb.Value) Then TaxaValorIni = IIf(JurTaxa_Cb.Value * 1 = 0, 0, JurTaxa_Cb.Value) Else TaxaValorIni = 0
    Workbooks("cpap_jap.mac").Sheets(1).Range("TxJurCx").Value = TaxaValorIni
    Application.ExecuteExcel4Macro ("cpap_jap.mac!ConversaoCx()")
    JurTaxa_Cb.Value = Workbooks("cpap_jap.mac").Sheets(1).Range("TxJurCx").Value
    JurTaxa_Cb.SetFocus
    JurTaxaEq_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub
Private Sub JurTaxaEq_Bt_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
'Estes eventos |fffd| s|fffd| para d|fffd| din|fffd|mica ao bot|fffd|o, pois a execu|fffd||fffd|o |fffd| demorada
    JurTaxaEq_Bt.SpecialEffect = fmSpecialEffectSunken
End Sub
Private Sub JurTaxaEq_Bt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    JurTaxaEq_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    BotAcionado = False
End Sub

Private Sub JurApartir_Chb_Click()
    Hide
    BotAcionado = 7
End Sub
Private Sub JurAdicParc_Chb_Click()
    Hide
    BotAcionado = 45
End Sub
Private Sub JurAteChave_Chb_Click()
    Hide
    BotAcionado = 36    'Bot|fffd|o calcular
End Sub
Private Sub JurMasCapt_Chb_Click()
    Hide
    BotAcionado = 44
End Sub

Private Sub JurSimp_Chb_Click()
    Hide
    BotAcionado = 42
End Sub

Private Sub JurSimplesApartir_Chb_Click()
    Hide
    BotAcionado = 43
End Sub

Private Sub Bal|fffd|es_Bt_Click()
    Hide
    BotAcionado = 35
End Sub

Private Sub Calcular_Bt_Click()
    Calcular_Bt.SetFocus
    Hide
    BotAcionado = 36
End Sub

Private Sub Finalizar_Bt_Click()
    Hide
    BotAcionado = 37
End Sub

Private Sub Cancelar_Bt_Click()
    Hide
    BotAcionado = 39
End Sub

Private Sub Voltar_Bt_Click()
    Hide
    BotAcionado = 38
End Sub

Private Sub Ajuda_Bt_Click()
    If bHtmlHelp Then Application.Run "CPAP_EX8.MAC!HelpVBA", ThisWorkbook.Path & "\CPAP.chm", HelpContextID, 2 Else Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub

Private Sub Ratear_Bt_Click()
    Hide
    BotAcionado = 50
End Sub
Private Sub Totais_Tb_Enter()
    If Abs(Saldo_Cb.Value) < 0.005 And JurAdicParc_Chb.Value And PlnEqCal = False Then
        Hide
        BotAcionado = 47
    Else
        Calcular_Bt.SetFocus
    End If
End Sub

Private Sub Crit|fffd|rios_Tb_Enter()
    If PlnEqCal = False Then
        Hide
        BotAcionado = 48
    End If
End Sub

Private Sub SaltaVencBal|fffd|o_Chb_Click()
    Hide
    BotAcionado = 33
End Sub

Private Sub SaltaM|fffd|s_Chb_Click()
    Hide
    BotAcionado = 46
End Sub


'COMBOBOXES COM HIST|fffd|RICO

Private Sub ValorPlano_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorPlano_Cb, Button, Shift, x, y
End Sub
Private Sub ValorPlano_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorPlano_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorPlanoCalculadora_Bt_Click
End Sub
Private Sub ValorPlano_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorPlano_Cb.Value = MarcHist Then ConfHist ValorPlano_Cb, Format(Princ(3, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorPlano_Cb, True
End Sub
Private Sub ValorPlano_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorPlano_Cb, Cancel, "#,##0.00"
End Sub


Private Sub Saldo_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove Saldo_Cb, Button, Shift, x, y
End Sub
Private Sub Saldo_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown Saldo_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then SaldoCalculadora_Bt_Click
End Sub
Private Sub Saldo_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Saldo_Cb.Value = MarcHist Then ConfHist Saldo_Cb, Format(Princ(50, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change Saldo_Cb
End Sub
Private Sub Saldo_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit Saldo_Cb, Cancel, "#,##0.00"
End Sub


Private Sub DataEntrg_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove DataEntrg_Cb, Button, Shift, x, y
End Sub
Private Sub DataEntrg_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown DataEntrg_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then DataEntrgCalend_Bt_Click
End Sub
Private Sub DataEntrg_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If DataEntrg_Cb.Value = MarcHist Then
        ConfHist DataEntrg_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(5, 2).Value - 1) + Princ(6, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        DiasEntrg_Cb.SetFocus
        DataEntrg_Cb.SetFocus
    End If
    EvCalend_Cb_Change DataEntrg_Cb
End Sub
Private Sub DataEntrg_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit DataEntrg_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(5, 2).Value - 1) + Princ(6, 2).Value - 1
    If Not Cancel Then
        If DateValue(DataEntrg_Cb.Value) * 1 < Princ(14, 2).Value Then
            DataEntrg_Cb.Value = Format(Princ(14, 2).Value, "dd/mm/yy")
            MsgBox "N|fffd|o pode ser anterior a " & Format(Princ(14, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
        End If
        MesesEntrg_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Princ(14, 2).Value, DateValue(DataEntrg_Cb.Value) * 1)
        DiasEntrg_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub


Private Sub JurTaxa_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove JurTaxa_Cb, Button, Shift, x, y
End Sub
Private Sub JurTaxa_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown JurTaxa_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then JurTaxaCalculadora_Bt_Click
End Sub
Private Sub JurTaxa_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If JurTaxa_Cb.Value = MarcHist Then ConfHist JurTaxa_Cb, Format(Princ(7, 2).Value, "#,##0.00########"), False, "#,##0.00########"
    EvValor_Cb_Change JurTaxa_Cb, True
End Sub
Private Sub JurTaxa_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit JurTaxa_Cb, Cancel, "#,##0.00########"
End Sub


Private Sub ValorEntrd_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorEntrd_Cb, Button, Shift, x, y
End Sub
Private Sub ValorEntrd_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorEntrd_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorEntrdCalculadora_Bt_Click
End Sub
Private Sub ValorEntrd_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorEntrd_Cb.Value = MarcHist Then ConfHist ValorEntrd_Cb, Format(Princ(11, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorEntrd_Cb, True
End Sub
Private Sub ValorEntrd_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorEntrd_Cb, Cancel, "#,##0.00"
End Sub


Private Sub ValorEntrg_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorEntrg_Cb, Button, Shift, x, y
End Sub
Private Sub ValorEntrg_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorEntrg_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorEntrgCalculadora_Bt_Click
End Sub
Private Sub ValorEntrg_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorEntrg_Cb.Value = MarcHist Then ConfHist ValorEntrg_Cb, Format(Princ(11, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorEntrg_Cb, True
End Sub
Private Sub ValorEntrg_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorEntrg_Cb, Cancel, "#,##0.00"
End Sub


Private Sub QuantPriS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantPriS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantPriS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantPriS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantPriS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantPriS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantPriS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantPriS|fffd|rie_Cb, Format(Princ(15, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantPriS|fffd|rie_Cb, True
End Sub
Private Sub QuantPriS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantPriS|fffd|rie_Cb, Cancel, "0"
End Sub


Private Sub QuantSegS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantSegS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantSegS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantSegS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantSegS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantSegS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantSegS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantSegS|fffd|rie_Cb, Format(Princ(17, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantSegS|fffd|rie_Cb, True
End Sub
Private Sub QuantSegS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantSegS|fffd|rie_Cb, Cancel, "0"
End Sub


Private Sub QuantTerS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantTerS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantTerS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantTerS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantTerS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantTerS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantTerS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantTerS|fffd|rie_Cb, Format(Princ(19, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantTerS|fffd|rie_Cb, True
End Sub
Private Sub QuantTerS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantTerS|fffd|rie_Cb, Cancel, "0"
End Sub


Private Sub QuantQuaS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantQuaS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantQuaS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantQuaS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantQuaS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantQuaS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantQuaS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantQuaS|fffd|rie_Cb, Format(Princ(21, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantQuaS|fffd|rie_Cb, True
End Sub
Private Sub QuantQuaS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantQuaS|fffd|rie_Cb, Cancel, "0"
End Sub


Private Sub QuantQuiS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantQuiS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantQuiS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantQuiS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantQuiS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantQuiS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantQuiS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantQuiS|fffd|rie_Cb, Format(Princ(23, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantQuiS|fffd|rie_Cb, True
End Sub
Private Sub QuantQuiS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantQuiS|fffd|rie_Cb, Cancel, "0"
End Sub

Private Sub QuantSexS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantSexS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantSexS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantSexS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantSexS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantSexS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantSexS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantSexS|fffd|rie_Cb, Format(Princ(25, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantSexS|fffd|rie_Cb, True
End Sub
Private Sub QuantSexS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantSexS|fffd|rie_Cb, Cancel, "0"
End Sub

Private Sub QuantS|fffd|tS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantS|fffd|tS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantS|fffd|tS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantS|fffd|tS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantS|fffd|tS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantS|fffd|tS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantS|fffd|tS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantS|fffd|tS|fffd|rie_Cb, Format(Princ(27, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantS|fffd|tS|fffd|rie_Cb, True
    OcultarExibControles3
End Sub
Private Sub QuantS|fffd|tS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantS|fffd|tS|fffd|rie_Cb, Cancel, "0"
End Sub

Private Sub QuantOitS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove QuantOitS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub QuantOitS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown QuantOitS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then QuantOitS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub QuantOitS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If QuantOitS|fffd|rie_Cb.Value = MarcHist Then ConfHist QuantOitS|fffd|rie_Cb, Format(Princ(29, 2).Value, "#,##0.00")
    EvValor_Cb_Change QuantOitS|fffd|rie_Cb, True
    OcultarExibControles3
End Sub
Private Sub QuantOitS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit QuantOitS|fffd|rie_Cb, Cancel, "0"
End Sub



Private Sub ValorPriS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorPriS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorPriS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorPriS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorPriS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorPriS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorPriS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorPriS|fffd|rie_Cb, Format(Princ(16, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorPriS|fffd|rie_Cb, True
End Sub
Private Sub ValorPriS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorPriS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorSegS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorSegS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorSegS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorSegS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorSegS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorSegS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorSegS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorSegS|fffd|rie_Cb, Format(Princ(18, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorSegS|fffd|rie_Cb, True
End Sub
Private Sub ValorSegS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorSegS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorTerS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorTerS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorTerS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorTerS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorTerS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorTerS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorTerS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorTerS|fffd|rie_Cb, Format(Princ(20, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorTerS|fffd|rie_Cb, True
End Sub
Private Sub ValorTerS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorTerS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorQuaS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorQuaS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorQuaS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorQuaS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorQuaS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorQuaS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorQuaS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorQuaS|fffd|rie_Cb, Format(Princ(22, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorQuaS|fffd|rie_Cb, True
End Sub
Private Sub ValorQuaS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorQuaS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorQuiS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorQuiS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorQuiS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorQuiS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorQuiS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorQuiS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorQuiS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorQuiS|fffd|rie_Cb, Format(Princ(24, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorQuiS|fffd|rie_Cb, True
End Sub
Private Sub ValorQuiS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorQuiS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorSexS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorSexS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorSexS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorSexS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorSexS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorSexS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorSexS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorSexS|fffd|rie_Cb, Format(Princ(26, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorSexS|fffd|rie_Cb, True
End Sub
Private Sub ValorSexS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorSexS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorS|fffd|tS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorS|fffd|tS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorS|fffd|tS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorS|fffd|tS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorS|fffd|tS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorS|fffd|tS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorS|fffd|tS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorS|fffd|tS|fffd|rie_Cb, Format(Princ(28, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorS|fffd|tS|fffd|rie_Cb, True
End Sub
Private Sub ValorS|fffd|tS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorS|fffd|tS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub

Private Sub ValorOitS|fffd|rie_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove ValorOitS|fffd|rie_Cb, Button, Shift, x, y
End Sub
Private Sub ValorOitS|fffd|rie_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown ValorOitS|fffd|rie_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then ValorOitS|fffd|rieCalculadora_Bt_Click
End Sub
Private Sub ValorOitS|fffd|rie_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If ValorOitS|fffd|rie_Cb.Value = MarcHist Then ConfHist ValorOitS|fffd|rie_Cb, Format(Princ(30, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change ValorOitS|fffd|rie_Cb, True
End Sub
Private Sub ValorOitS|fffd|rie_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit ValorOitS|fffd|rie_Cb, Cancel, "#,##0.00"
End Sub


Private Sub DataPriPrest_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove DataPriPrest_Cb, Button, Shift, x, y
End Sub
Private Sub DataPriPrest_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown DataPriPrest_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then DataPriPrestCalend_Bt_Click
End Sub
Private Sub DataPriPrest_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If DataPriPrest_Cb.Value = MarcHist Then
        ConfHist DataPriPrest_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(32, 2).Value - 1) + Princ(33, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        DiasPriPrest_Cb.SetFocus
        DataPriPrest_Cb.SetFocus
    End If
    EvCalend_Cb_Change DataPriPrest_Cb
End Sub
Private Sub DataPriPrest_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit DataPriPrest_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, Princ(32, 2).Value - 1) + Princ(33, 2).Value - 1
    If Not Cancel Then
        If DateValue(DataPriPrest_Cb.Value) * 1 < Princ(14, 2).Value Then
            DataPriPrest_Cb.Value = Format(Princ(14, 2).Value, "dd/mm/yy")
            MsgBox "N|fffd|o pode ser anterior a " & Format(Princ(14, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
        End If
        MesesPriPrest_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Princ(14, 2).Value, DateValue(DataPriPrest_Cb.Value) * 1)
        DiasPriPrest_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub



'COMBOBOXEX SEM HIST|fffd|RICOS

Private Sub MesesEntrg_Cb_Click()
    For I = 1 To MesesEntrg_Cb.ListCount
        If MesesEntrg_Cb.List(I - 1) = MesesEntrg_Cb.Value Then Exit For
    Next
    nMesesEntrg = I
    If DiasEntrg_Cb.Value <> "" Then DataEntrg_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, MesesEntrg_Cb.ListIndex) + DiasEntrg_Cb.ListIndex, "dd/mm/yy")
End Sub

Private Sub DiasEntrg_Cb_Change()
    For I = 1 To DiasEntrg_Cb.ListCount
        If DiasEntrg_Cb.List(I - 1) = DiasEntrg_Cb.Value Then Exit For
    Next
    nDiasEntrg = I
    If MesesEntrg_Cb.Value <> "" Then DataEntrg_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, MesesEntrg_Cb.ListIndex) + DiasEntrg_Cb.ListIndex, "dd/mm/yy")
End Sub

Private Sub MesesPriPrest_Cb_Change()
    For I = 1 To MesesPriPrest_Cb.ListCount
        If MesesPriPrest_Cb.List(I - 1) = MesesPriPrest_Cb.Value Then Exit For
    Next
    nMesesPriPrest = I
    If DiasPriPrest_Cb.Value <> "" Then DataPriPrest_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, MesesPriPrest_Cb.ListIndex) + DiasPriPrest_Cb.ListIndex, "dd/mm/yy")
End Sub

Private Sub DiasPriPrest_Cb_Change()
    For I = 1 To DiasPriPrest_Cb.ListCount
        If DiasPriPrest_Cb.List(I - 1) = DiasPriPrest_Cb.Value Then Exit For
    Next
    nDiasPriPrest = I
    If MesesPriPrest_Cb.Value <> "" Then DataPriPrest_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Princ(14, 2).Value, MesesPriPrest_Cb.ListIndex) + DiasPriPrest_Cb.ListIndex, "dd/mm/yy")
End Sub

Private Sub Agenda_Click()
    Application.ExecuteExcel4Macro ("cpap_pri.mac!Calendario()")
End Sub

Private Sub AumCx_Lb_Click()
    QuantS|fffd|tS|fffd|rie_Cb = 1
    vEnableEvents = False
    QuantS|fffd|tS|fffd|rie_Cb = 0
    vEnableEvents = True
    Scroll (6)
End Sub

Private Sub WhatsThis_Img_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Static cHHelpWhatsThis1 As Object
    If cHHelpWhatsThis1 Is Nothing Then Set cHHelpWhatsThis1 = Application.Run("CPAP_EX8.MAC!New_cHHelpWhatsThis")
    cHHelpWhatsThis1.WhatsThis_Img_MouseDown Button, Shift, x, y, Me
    If WhatsThis_Img.BackStyle = fmBackStyleOpaque Then Set cHHelpWhatsThis1 = Nothing
End Sub

Attribute VB_Name = "UserForm4Bal"
Attribute VB_Base = "0{5EC95796-28DA-4FCE-8AB5-16A5785D1E63}{DC62FD14-7C77-47D0-9A0A-331C6D46B1A9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Necess|fffd|rio, devido bug Setfocus em textbox do Excel2k. Isto foi resolvido com SendKeys tamb|fffd|m
Public ControleAtivo As Control
Private Sub UserForm_Activate()
    Meses1_Cb.SetFocus
    ControleAtivo.SetFocus
End Sub
Private Sub UserForm_Deactivate()
    Set ControleAtivo = ActiveControl
End Sub


Private Sub UserForm_Initialize()
    vEnableEvents = True
    'ListandoComboBox Meses
    For I = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Meses").Rows.Count
        I1 = Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Meses").Item(I).Value
        Meses1_Cb.AddItem (I1)
        Meses2_Cb.AddItem (I1)
        Meses3_Cb.AddItem (I1)
        Meses4_Cb.AddItem (I1)
    Next
    Meses1_Cb.Value = Meses1_Cb.List(nMeses1 + 1 * (nMeses1 > 0))
    Meses2_Cb.Value = Meses2_Cb.List(nMeses2 + 1 * (nMeses2 > 0))
    Meses3_Cb.Value = Meses3_Cb.List(nMeses3 + 1 * (nMeses3 > 0))
    Meses4_Cb.Value = Meses4_Cb.List(nMeses4 + 1 * (nMeses4 > 0))
    '   MesesPriPrest_Cb.Value = MesesPriPrest_Cb.List(nMesesPriPrest + 1 * (nMesesPriPrest > 0))
    'ListandoComboBox MaisDias
    For I = 1 To Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Dias").Rows.Count
        I1 = Application.Workbooks("cpap_jap.mac").Excel4MacroSheets(1).Range("Dias").Item(I).Value
        Dias1_Cb.AddItem (I1)
        Dias2_Cb.AddItem (I1)
        Dias3_Cb.AddItem (I1)
        Dias4_Cb.AddItem (I1)
    Next
    Dias1_Cb.Value = Dias1_Cb.List(nDias1 + 1 * (nDias1 > 0))
    Dias2_Cb.Value = Dias2_Cb.List(nDias2 + 1 * (nDias2 > 0))
    Dias3_Cb.Value = Dias3_Cb.List(nDias3 + 1 * (nDias3 > 0))
    Dias4_Cb.Value = Dias4_Cb.List(nDias4 + 1 * (nDias4 > 0))

    ListandoComboBox Valor1_Cb, "#,##0.00"
    ListandoComboBox Valor2_Cb, "#,##0.00"
    ListandoComboBox Valor3_Cb, "#,##0.00"
    ListandoComboBox Valor4_Cb, "#,##0.00"
    ListandoComboBox Data1_Cb, "dd/mm/yy"
    ListandoComboBox Data2_Cb, "dd/mm/yy"
    ListandoComboBox Data3_Cb, "dd/mm/yy"
    ListandoComboBox Data4_Cb, "dd/mm/yy"
    Set ControleAtivo = Valor1_Cb
End Sub


Private Sub Data1Calend_Bt_Click()
    CalendBtClick UserForm4Bal, Data1_Cb, Data1Calend_Bt
    Calcular_Bt.SetFocus: Data1_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub
Private Sub Data2Calend_Bt_Click()
    CalendBtClick UserForm4Bal, Data2_Cb, Data2Calend_Bt
    Calcular_Bt.SetFocus: Data2_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub
Private Sub Data3Calend_Bt_Click()
    CalendBtClick UserForm4Bal, Data3_Cb, Data3Calend_Bt
    Calcular_Bt.SetFocus: Data3_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub
Private Sub Data4Calend_Bt_Click()
    CalendBtClick UserForm4Bal, Data4_Cb, Data4Calend_Bt
    Calcular_Bt.SetFocus: Data4_Cb.SetFocus
    Application.ScreenUpdating = True
End Sub


Private Sub Valor1Calculadora_Bt_Click()
    CalculadoraBtClick UserForm4Bal, Valor1_Cb, Valor1Calculadora_Bt, 2
End Sub
Private Sub Valor2Calculadora_Bt_Click()
    CalculadoraBtClick UserForm4Bal, Valor2_Cb, Valor2Calculadora_Bt, 2
End Sub
Private Sub Valor3Calculadora_Bt_Click()
    CalculadoraBtClick UserForm4Bal, Valor3_Cb, Valor3Calculadora_Bt, 2
End Sub
Private Sub Valor4Calculadora_Bt_Click()
    CalculadoraBtClick UserForm4Bal, Valor4_Cb, Valor4Calculadora_Bt, 2
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    BotAcionado = False
End Sub

Private Sub Mais_bt_Click()
    Calcular_Bt.SetFocus
    Hide
    BotAcionado = 18
End Sub

Private Sub Calcular_Bt_Click()
    Calcular_Bt.SetFocus
    Hide
    BotAcionado = 19
End Sub

Private Sub Voltar_Bt_Click()
    Hide
    BotAcionado = 20
End Sub

Private Sub Cancelar_Bt_Click()
    Hide
    BotAcionado = 21
End Sub

Private Sub Ins_Bt_Click()
    Hide
    BotAcionado = 24
End Sub

Private Sub Exc_Bt_Click()
    Hide
    BotAcionado = 25
End Sub

Private Sub Ajuda_Bt_Click()
    If bHtmlHelp Then Application.Run "CPAP_EX8.MAC!HelpVBA", ThisWorkbook.Path & "\CPAP.chm", HelpContextID, 2 Else Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub


Private Sub SetaEvol1_lb_Click()
    Meses1_Cb.SetFocus
    Hide
    BotAcionado = 26
End Sub

Private Sub SetaEvol2_lb_Click()
    Meses2_Cb.SetFocus
    Hide
    BotAcionado = 27
End Sub

Private Sub SetaEvol3_lb_Click()
    Meses3_Cb.SetFocus
    Hide
    BotAcionado = 28
End Sub

Private Sub SetaEvol4_lb_Click()
    Meses4_Cb.SetFocus
    Hide
    BotAcionado = 29
End Sub



'COMBOBOXES COM HIST|fffd|RICO

Private Sub Valor1_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove Valor1_Cb, Button, Shift, x, y
End Sub
Private Sub Valor1_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown Valor1_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Valor1Calculadora_Bt_Click
End Sub
Private Sub Valor1_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Valor1_Cb.Value = MarcHist Then ConfHist Valor1_Cb, Format(Bal(4, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change Valor1_Cb, True
End Sub
Private Sub Valor1_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit Valor1_Cb, Cancel, "#,##0.00"
End Sub

Private Sub Valor2_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove Valor2_Cb, Button, Shift, x, y
End Sub
Private Sub Valor2_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown Valor2_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Valor2Calculadora_Bt_Click
End Sub
Private Sub Valor2_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Valor2_Cb.Value = MarcHist Then ConfHist Valor2_Cb, Format(Bal(8, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change Valor2_Cb, True
End Sub
Private Sub Valor2_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit Valor2_Cb, Cancel, "#,##0.00"
End Sub

Private Sub Valor3_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove Valor3_Cb, Button, Shift, x, y
End Sub
Private Sub Valor3_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown Valor3_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Valor3Calculadora_Bt_Click
End Sub
Private Sub Valor3_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Valor3_Cb.Value = MarcHist Then ConfHist Valor3_Cb, Format(Bal(12, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change Valor3_Cb, True
End Sub
Private Sub Valor3_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit Valor3_Cb, Cancel, "#,##0.00"
End Sub

Private Sub Valor4_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvValor_Cb_MouseMove Valor4_Cb, Button, Shift, x, y
End Sub
Private Sub Valor4_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvValor_Cb_KeyDown Valor4_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Valor4Calculadora_Bt_Click
End Sub
Private Sub Valor4_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Valor4_Cb.Value = MarcHist Then ConfHist Valor4_Cb, Format(Bal(16, 2).Value, "#,##0.00"), False, "#,##0.00"
    EvValor_Cb_Change Valor4_Cb, True
End Sub
Private Sub Valor4_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvValor_Cb_Exit Valor4_Cb, Cancel, "#,##0.00"
End Sub







Private Sub Data1_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data1_Cb, Button, Shift, x, y
End Sub
Private Sub Data1_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data1_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Data1Calend_Bt_Click
End Sub
Private Sub Data1_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Data1_Cb.Value = MarcHist Then
        ConfHist Data1_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(5, 2).Value - 1) + Bal(6, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        Dias1_Cb.SetFocus
        Data1_Cb.SetFocus
    End If
    EvCalend_Cb_Change Data1_Cb
End Sub
Private Sub Data1_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data1_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(5, 2).Value - 1) + Bal(6, 2).Value - 1
    If Not Cancel Then
        If DateValue(Data1_Cb.Value) * 1 < Bal(19, 2).Value Then
            MsgBox "N|fffd|o pode ser anterior a " & Format(Bal(19, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
            Data1_Cb.Value = Format(Bal(19, 2).Value, "dd/mm/yy")
        End If
        Meses1_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Bal(3, 2).Value, DateValue(Data1_Cb.Value) * 1)
        Dias1_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub


Private Sub Data2_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data2_Cb, Button, Shift, x, y
End Sub
Private Sub Data2_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data2_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Data2Calend_Bt_Click
End Sub
Private Sub Data2_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Data2_Cb.Value = MarcHist Then
        ConfHist Data2_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(9, 2).Value - 1) + Bal(10, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        Dias2_Cb.SetFocus
        Data2_Cb.SetFocus
    End If
    EvCalend_Cb_Change Data2_Cb
End Sub
Private Sub Data2_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data2_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(9, 2).Value - 1) + Bal(10, 2).Value - 1
    If Not Cancel Then
        If DateValue(Data2_Cb.Value) * 1 < Bal(19, 2).Value Then
            Data2_Cb.Value = Format(Bal(19, 2).Value, "dd/mm/yy")
            MsgBox "N|fffd|o pode ser anterior a " & Format(Bal(19, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
        End If
        Meses2_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Bal(3, 2).Value, DateValue(Data2_Cb.Value) * 1)
        Dias2_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub


Private Sub Data3_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data3_Cb, Button, Shift, x, y
End Sub
Private Sub Data3_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data3_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Data3Calend_Bt_Click
End Sub
Private Sub Data3_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Data3_Cb.Value = MarcHist Then
        ConfHist Data3_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(13, 2).Value - 1) + Bal(14, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        Dias3_Cb.SetFocus
        Data3_Cb.SetFocus
    End If
    EvCalend_Cb_Change Data3_Cb
End Sub
Private Sub Data3_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data3_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(13, 2).Value - 1) + Bal(14, 2).Value - 1
    If Not Cancel Then
        If DateValue(Data3_Cb.Value) * 1 < Bal(19, 2).Value Then
            Data3_Cb.Value = Format(Bal(19, 2).Value, "dd/mm/yy")
            MsgBox "N|fffd|o pode ser anterior a " & Format(Bal(19, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
        End If
        Meses3_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Bal(3, 2).Value, DateValue(Data3_Cb.Value) * 1)
        Dias3_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub


Private Sub Data4_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data4_Cb, Button, Shift, x, y
End Sub
Private Sub Data4_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data4_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Data4Calend_Bt_Click
End Sub
Private Sub Data4_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Data4_Cb.Value = MarcHist Then
        ConfHist Data4_Cb, Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(17, 2).Value - 1) + Bal(18, 2).Value - 1, "dd/mm/yy"), False, "dd/mm/yy"
        Dias4_Cb.SetFocus
        Data4_Cb.SetFocus
    End If
    EvCalend_Cb_Change Data4_Cb
End Sub
Private Sub Data4_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data4_Cb, Cancel, Application.Run("Cpap_ex8.mac!MyEdate", Bal(19, 2).Value, Bal(17, 2).Value - 1) + Bal(18, 2).Value - 1
    If Not Cancel Then
        If DateValue(Data4_Cb.Value) * 1 < Bal(19, 2).Value Then
            Data4_Cb.Value = Format(Bal(19, 2).Value, "dd/mm/yy")
            MsgBox "N|fffd|o pode ser anterior a " & Format(Bal(19, 2).Value, "dd/mm/yy") & ", data do plano.", vbCritical, "CPAP|fffd| - Data inv|fffd|lida!"
        End If
        Meses4_Cb.ListIndex = Application.Run("cpap_jap.mac!M.F", Bal(3, 2).Value, DateValue(Data4_Cb.Value) * 1)
        Dias4_Cb.ListIndex = Workbooks("cpap_jap.mac").Sheets(1).Range("M.FretDias").Value
    End If
End Sub


'COMBOBOXEX SEM HIST|fffd|RICOS

Private Sub Meses1_Cb_Click()
    For I = 1 To Meses1_Cb.ListCount
        If Meses1_Cb.List(I - 1) = Meses1_Cb.Value Then Exit For
    Next
    nMeses1 = I
    If Dias1_Cb.Value <> "" Then Data1_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses1_Cb.ListIndex) + Dias1_Cb.ListIndex, "dd/mm/yy")
End Sub
Private Sub Meses2_Cb_Click()
    For I = 1 To Meses2_Cb.ListCount
        If Meses2_Cb.List(I - 1) = Meses2_Cb.Value Then Exit For
    Next
    nMeses2 = I
    If Dias2_Cb.Value <> "" Then Data2_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses2_Cb.ListIndex) + Dias2_Cb.ListIndex, "dd/mm/yy")
End Sub
Private Sub Meses3_Cb_Click()
    For I = 1 To Meses3_Cb.ListCount
        If Meses3_Cb.List(I - 1) = Meses3_Cb.Value Then Exit For
    Next
    nMeses3 = I
    If Dias3_Cb.Value <> "" Then Data3_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses3_Cb.ListIndex) + Dias3_Cb.ListIndex, "dd/mm/yy")
End Sub
Private Sub Meses4_Cb_Click()
    For I = 1 To Meses4_Cb.ListCount
        If Meses4_Cb.List(I - 1) = Meses4_Cb.Value Then Exit For
    Next
    nMeses4 = I
    If Dias4_Cb.Value <> "" Then Data4_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses4_Cb.ListIndex) + Dias4_Cb.ListIndex, "dd/mm/yy")
End Sub


Private Sub Dias1_Cb_Change()
    For I = 1 To Dias1_Cb.ListCount
        If Dias1_Cb.List(I - 1) = Dias1_Cb.Value Then Exit For
    Next
    nDias1 = I
    If Meses1_Cb.Value <> "" Then Data1_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses1_Cb.ListIndex) + Dias1_Cb.ListIndex, "dd/mm/yy")

    If Num1_Lb.Caption = "01" Then
        Hide
        BotAcionado = 5
    End If
End Sub
Private Sub Dias2_Cb_Change()
    For I = 1 To Dias2_Cb.ListCount
        If Dias2_Cb.List(I - 1) = Dias2_Cb.Value Then Exit For
    Next
    nDias2 = I
    If Meses2_Cb.Value <> "" Then Data2_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses2_Cb.ListIndex) + Dias2_Cb.ListIndex, "dd/mm/yy")
End Sub
Private Sub Dias3_Cb_Change()
    For I = 1 To Dias3_Cb.ListCount
        If Dias3_Cb.List(I - 1) = Dias3_Cb.Value Then Exit For
    Next
    nDias3 = I
    If Meses3_Cb.Value <> "" Then Data3_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses3_Cb.ListIndex) + Dias3_Cb.ListIndex, "dd/mm/yy")
End Sub
Private Sub Dias4_Cb_Change()
    For I = 1 To Dias4_Cb.ListCount
        If Dias4_Cb.List(I - 1) = Dias4_Cb.Value Then Exit For
    Next
    nDias4 = I
    If Meses4_Cb.Value <> "" Then Data4_Cb.Value = Format(Application.Run("Cpap_ex8.mac!MyEdate", Bal(3, 2).Value, Meses4_Cb.ListIndex) + Dias4_Cb.ListIndex, "dd/mm/yy")
End Sub

Private Sub Agenda_Click()
    Application.ExecuteExcel4Macro ("cpap_pri.mac!Calendario()")
End Sub

Private Sub WhatsThis_Img_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Static cHHelpWhatsThis1 As Object
    If cHHelpWhatsThis1 Is Nothing Then Set cHHelpWhatsThis1 = Application.Run("CPAP_EX8.MAC!New_cHHelpWhatsThis")
    cHHelpWhatsThis1.WhatsThis_Img_MouseDown Button, Shift, x, y, Me
    If WhatsThis_Img.BackStyle = fmBackStyleOpaque Then Set cHHelpWhatsThis1 = Nothing
End Sub

Attribute VB_Name = "UserFormEditHist"
Attribute VB_Base = "0{2CA1308F-737A-4131-BEB4-5CA77DC6D160}{FF05EEB3-593E-4261-BCBF-326C7622B65D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private vListBox As Control
Private vTextBox As Control
Private SemAltera|fffd||fffd|es As Boolean


Private Sub Ajuda_Bt_Click()
    If bHtmlHelp Then Application.Run "CPAP_EX8.MAC!HelpVBA", ThisWorkbook.Path & "\CPAP.chm", HelpContextID, 2 Else Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub

Private Sub UserForm_Initialize()
    vEnableEvents = True
    Caption = "Editando Sugest|fffd|es do Campo " & HistEditCampo
    'Listando listboxes - Lista de sug fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo, ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).End(xlDown))
    If campo.Rows.Count < 100 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), FormatoHist)
            j = j + 1
            If j > 1 Then
                vRep = False
                For I = 1 To SugFixas_Lb.ListCount
                    If SugFixas_Lb.List(I - 1) = cf Then vRep = True
                Next
                If vRep = False Then SugFixas_Lb.AddItem (cf)
            End If
        Next
    End If

    'Listando ListBox - Sugest Hist|fffd|ricas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").End(xlDown))
    If campo.Rows.Count < 10000 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), FormatoHist)
            j = j + 1
            If j > 1 Then
                vRep = False
                For I = 1 To SugHist_Lb.ListCount
                    If SugHist_Lb.List(I - 1) = cf Then vRep = True
                Next
                If vRep = False And cf <> "" Then SugHist_Lb.AddItem (cf)
            End If
        Next
    End If
    NumMax_Ct.Value = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(-1, 0)
    MultiPage1.Value = 0
    MultiPage1_Change
    SemAltera|fffd||fffd|es = True
    OcultarExibControlesHist
End Sub

Private Sub NumMax_Ct_Change()
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub NumMax_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    If IsNumeric(NumMax_Ct.Value) Then
        If NumMax_Ct.Value < 0 Then NumMax_Ct.Value = 0
        If NumMax_Ct.Value > 100 Then NumMax_Ct.Value = 100
    Else
        NumMax_Ct.Value = 15
    End If
End Sub

Private Sub Fechar_Bt_Click()
    Hide
    If SemAltera|fffd||fffd|es = True Then Exit Sub
    If MsgBox("Salvar altera|fffd||fffd|es nas sugest|fffd|es para o campo " & HistEditCampo & "?", vbQuestion + vbOKCancel, "CPAP|fffd|") = vbCancel Then Exit Sub
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value) 'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
        'Limpando c|fffd|lulas
        Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo, ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).End(xlDown))
        If campo.Rows.Count < 100 Then
            I = campo(1)
            campo.ClearContents
            campo(1) = I
        End If
        Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").End(xlDown))
        If campo.Rows.Count > 10000 Then
        Else
            I = campo(1)
            campo.ClearContents
            campo(1) = I
        End If

        'Descaregando comboboxes - Sug. Fixas
        k = 0
        NumM|fffd|x = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").Row - ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").Row - 3
        For j = 1 To SugFixas_Lb.ListCount
            If j > NumM|fffd|x Then Exit For
            vRep = False
            If j > 1 Then
                For I = 1 To j
                    If ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).Offset(I, 0) = SugFixas_Lb.List(j - 1) Then vRep = True
                Next
            End If
            If vRep = False Then
                k = k + 1
                ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).Offset(k, 0) = SugFixas_Lb.List(j - 1)
            End If
        Next

        'Descarregando comboboxes - Sug. Hist|fffd|ricas
        k = 0
        For j = 1 To SugHist_Lb.ListCount
            If j > NumMax_Ct.Value * 1 Then Exit For
            vRep = False
            If j > 1 Then
                For I = 1 To j
                    If ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(I, 0) = SugHist_Lb.List(j - 1) Then vRep = True
                Next
            End If
            If vRep = False Then
                k = k + 1
                ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(k, 0) = SugHist_Lb.List(j - 1)
            End If
        Next
    End If
    ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(-1, 0) = NumMax_Ct.Value
    SalvandoHist
    Application.ScreenUpdating = True
End Sub

Private Sub Mover_Sb_SpinUp()
    I = vListBox.ListIndex
    If I < 1 Then Exit Sub
    vListBox.AddItem vListBox.List(I), I - 1
    vListBox.RemoveItem I + 1
    vListBox.Selected(I - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Mover_Sb_SpinDown()
    I = vListBox.ListIndex
    If I < 0 Or I + 1 >= vListBox.ListCount Then Exit Sub
    vListBox.AddItem vListBox.List(I), I + 2
    vListBox.RemoveItem I
    vListBox.Selected(I + 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Transf_Bt_Click()
    I = vListBox.ListIndex
    If I < 0 Then Exit Sub
    If vListBox.Selected(I) Then
        I1 = vListBox.Value
        vListBox.RemoveItem I
        vEnableEvents = False
        If vListBox.ListIndex = -1 Then vTextBox.Value = ""
        vEnableEvents = True
    End If
    If MultiPage1.Value = 0 Then MultiPage1.Value = 1 Else MultiPage1.Value = 0
    vListBox.AddItem I1
    vListBox.Selected(vListBox.ListCount - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Excluir_Bt_Click()
    I = vListBox.ListIndex
    If I < 0 Then Exit Sub
    If vListBox.Selected(I) Then vListBox.RemoveItem I
    vEnableEvents = False
    If vListBox.ListIndex = -1 Then vTextBox.Value = ""
    vEnableEvents = True
    OcultarExibControlesHist
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Nova_Bt_Click()
    vListBox.AddItem "Nova Sugest|fffd|o" & vListBox.ListCount + 1
    vListBox.Selected(vListBox.ListCount - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub MultiPage1_Change()
    If MultiPage1.Value = 0 Then
        Set vListBox = SugHist_Lb
        Set vTextBox = SugHist_Ct
    Else
        Set vListBox = SugFixas_Lb
        Set vTextBox = SugFixas_Ct
    End If
    OcultarExibControlesHist
End Sub

Private Sub SugFixas_Ct_Change()
    If vEnableEvents = False Then Exit Sub
    I = SugFixas_Lb.ListIndex
    I1 = SugFixas_Ct.SelStart
    If I < 0 Then
        j = SugFixas_Ct.Value
        Nova_Bt_Click
        SugFixas_Ct.Value = j
        I = SugFixas_Lb.ListCount - 1
    End If
    SugFixas_Lb.AddItem SugFixas_Ct.Value, I
    SugFixas_Lb.RemoveItem I + 1
    SugFixas_Lb.Selected(I) = True
    SugFixas_Ct.SelStart = I1
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub SugFixas_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    I = SugFixas_Lb.ListIndex
    If SugFixas_Ct.Value <> "" Or I < 0 Then Exit Sub
    SugFixas_Lb.RemoveItem I
End Sub

Private Sub SugFixas_LB_Click()
    vEnableEvents = False
    SugFixas_Ct.Value = SugFixas_Lb.Value
    If SugFixas_Ct.Enabled Then SugFixas_Ct.SetFocus
    vEnableEvents = True
    OcultarExibControlesHist
End Sub

Private Sub SugHist_Ct_Change()
    If vEnableEvents = False Then Exit Sub
    I = SugHist_Lb.ListIndex
    I1 = SugHist_Ct.SelStart
    If I < 0 Then
        j = SugHist_Ct.Value
        Nova_Bt_Click
        SugHist_Ct.Value = j
        I = SugHist_Lb.ListCount - 1
    End If
    SugHist_Lb.AddItem SugHist_Ct.Value, I
    SugHist_Lb.RemoveItem I + 1
    SugHist_Lb.Selected(I) = True
    SugHist_Ct.SelStart = I1
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub SugHist_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    I = SugHist_Lb.ListIndex
    If SugHist_Ct.Value <> "" Or I < 0 Then Exit Sub
    SugHist_Lb.RemoveItem I
End Sub

Private Sub SugHist_Lb_Click()
    vEnableEvents = False
    SugHist_Ct.Value = SugHist_Lb.Value
    If SugHist_Ct.Enabled Then SugHist_Ct.SetFocus
    vEnableEvents = True
    OcultarExibControlesHist
End Sub

Sub OcultarExibControlesHist()
    I = vListBox.ListIndex > -1
    Excluir_Bt.Enabled = I
    Mover_Sb.Enabled = I
    Mover_Lb.Enabled = I
    Transf_Bt.Enabled = I
    Transf_Bt.ControlTipText = "Transfere para " & IIf(MultiPage1.Value = 0, "Fixas", "Hist|fffd|ricas")
    WhatsThis_Img.Top = -50: If bHtmlHelp Then WhatsThis_Img.Top = -1: WhatsThis_Img.Left = Width - 10
End Sub

Private Sub WhatsThis_Img_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Static cHHelpWhatsThis1 As Object
    If cHHelpWhatsThis1 Is Nothing Then Set cHHelpWhatsThis1 = Application.Run("CPAP_EX8.MAC!New_cHHelpWhatsThis")
    cHHelpWhatsThis1.WhatsThis_Img_MouseDown Button, Shift, x, y, Me
    If WhatsThis_Img.BackStyle = fmBackStyleOpaque Then Set cHHelpWhatsThis1 = Nothing
End Sub



INQUEST-PP=macro
