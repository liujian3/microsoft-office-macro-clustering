Attribute VB_Name = "Module1"
Sub Instructions()
Attribute Instructions.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Instructions Macro
'

'
    Sheets("Main").Select
    Sheets("Instructions").Visible = True
    Sheets("Instructions").Select
End Sub
Sub HideInstructions()
Attribute HideInstructions.VB_ProcData.VB_Invoke_Func = " \n14"
'
' HideInstructions Macro
'

'
    Sheets("Instructions").Select
    ActiveWindow.SelectedSheets.Visible = False
    Sheets("Main").Select
End Sub
Attribute VB_Name = "Module10"
Sub USPS()
On Error GoTo eh
Dim SA As String
Dim CY As String
Dim ST As String
Dim ZC As String
SA = Sheets("Automation Data").Range("K33").Value
CY = Sheets("Automation Data").Range("L33").Value
ST = Sheets("Automation Data").Range("M33").Value
ZC = Sheets("Automation Data").Range("N33").Value
Dim objIE As InternetExplorerMedium
Dim aEle As HTMLLinkElement
Set objIE = New InternetExplorerMedium
objIE.Visible = True
objIE.navigate "https://tools.usps.com/zip-code-lookup.htm?byaddress"
Do Until objIE.readyState = 4
DoEvents
Loop
objIE.document.getElementById("tAddress").Value = SA
objIE.document.getElementById("tCity").Value = CY
objIE.document.getElementById("tState").Value = ST
objIE.document.getElementById("tZip-byaddress").Value = ZC
objIE.document.getElementById("zip-by-address").Click
Exit Sub
eh:
   Logger "Error", Err.Source, Err.Description
End Sub

Sub FloodCert()
On Error GoTo eh
Dim objIE As InternetExplorer
Dim aEle As HTMLLinkElement
Set objIE = New InternetExplorer
objIE.Visible = True
objIE.navigate "https://infopro.floodapp.com/Login.aspx"
Do Until objIE.readyState = 4
DoEvents
Loop
objIE.document.getElementById("Content_Main_ctl00_txtUserName").Value = "MACU1234"
objIE.document.getElementById("Content_Main_ctl00_txtPassword").Value = "Flood!425"
objIE.document.getElementById("Content_Main_ctl00_btnLogin").Click
Exit Sub
eh:
   Logger "Error", Err.Source, Err.Description
End Sub


Attribute VB_Name = "Module11"
Sub ScheduleClosing()
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Schedule Closing")
If answer = vbNo Then
Exit Sub
End If
ScheduleClosingForm.Show
   
End Sub

Attribute VB_Name = "Module12"
Sub CondititonstoProcessing()
On Error GoTo eh
'***************************************************************************
'Purpose: The following section confirms that the button was not accidentaly
'clicked.
'***************************************************************************
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Conditions to Processing")
If answer = vbNo Then
Exit Sub
End If

    Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    
    
    
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    Dim PN As String
    PN = Sheets("Conditions").Range("J6").Value
    Dim AT As String
    AT = Sheets("Conditions").Range("B22").Value
    
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "underwriting@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = "loanprocessing@marinecu.com"
        'Cc
        
        'Subject
        objMail.Subject = LN + ", " + FN + ", " + AN1 + " has been reviewd by Underwriting"
        'Email Body
        objMail.HTMLBody = "The file for " & LN & ", " & FN & " has been reviewed by Underwriting and is ready to send to the branch." & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to loan processing."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description

        
End Sub
Attribute VB_Name = "Module2"

Public Function GetSignature(Spath As String) As String
  On Error GoTo eh
    Dim fso As Object
    Dim TSet As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set TSet = fso.GetFile(Spath).OpenAsTextStream(1, -2)
    GetSignature = TSet.readall
    TSet.Close
Exit Function
eh:
Logger "Error", Err.Source, Err.Description
End Function
Public Function FileName()
FileName = ActiveWorkbook.Name
End Function

Public Sub SubmissionToProcessing()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Submission To Processing")
If answer = vbNo Then
Exit Sub
End If
'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If

Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'To
    Dim TO1 As String
    TO1 = Sheets("Automation Data").Range("K2").Value
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("K15").Value
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    Dim PN As String
    PN = Sheets("Conditions").Range("J6").Value
    Dim AT As String
    AT = Sheets("Conditions").Range("B22").Value
    
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = TO1
        'Cc
        objMail.CC = CC1
        'Subject
        objMail.Subject = LN + ", " + FN + ", " + AN1 + " Recieved in Processing"
        'Email Body
        objMail.HTMLBody = "This file has been recieved in processing and will be assigned to " & PN & "." & "<br>" & "<br>" & "Appraisal Type: " & AT & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to the MLR and BM."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description

        
End Sub


Attribute VB_Name = "Module3"
'Error Procedure
Public Sub Logger(sType As String, sSource As String, sDetails As String)
   Dim TI As Date
   TI = Now()
    Dim sFilename As String
    sFilename = "S:\Community Banking\Consumer Loan Docs\Consumer Funding Text Files\Error Logger.txt"
    
    ' Archive file at certain size
    If FileLen(sFilename) > 20000 Then
        FileCopy sFilename _
            , Replace(sFilename, ".txt", Format(Now, "ddmmyyyy hhmmss.txt"))
        Kill sFilename
    End If
    
    ' Open the file to write
    Dim filenumber As Variant
    filenumber = FreeFile
    Open sFilename For Append As #filenumber
    
    Print #filenumber, CStr(Now) & "," & sType & "," & sSource _
                                & "," & sDetails & "," & Application.USERNAME & "," & ActiveWorkbook.Name
                                
    
    Close #filenumber
    
    If MsgBox("An unexpected error has occured. Would you like to report this error to consumer processing?", vbYesNo, "Error") = vbYes Then
    
    Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    
        
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        
        'Importance
        objMail.Importance = 2
        'To
        objMail.To = "trevor.mergen@marinecu.com"
        'Cc
        
        objMail.Subject = "The following error has occured."
        'Email Body
        objMail.Body = "Please refer to the error log event recorded at " & TI
        
        objMail.Send
        'Close the object
        Set objMail = Nothing
        MsgBox "An email has been sent to Trevor Mergen."
    
End If
    
End Sub

Attribute VB_Name = "Module4"
Sub SubmissionToUW()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Submission to Underwriting")
If answer = vbNo Then
Exit Sub
End If
'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If

Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'Loan Officer
    Dim LO As String
    LO = Sheets("Conditions").Range("J3").Value
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("D2").Value
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    
    'Loan Amount
    Dim LA As String
    LA = Sheets("Conditions").Range("O8").Value
    
    'Loan Purpose
    Dim LP As String
    LP = Sheets("Conditions").Range("O3").Value
    
    'Property Type
    Dim PT As String
    PT = Sheets("Conditions").Range("O4").Value
    
    'Branch
    Dim BR As String
    BR = Sheets("Conditions").Range("J4").Value
    
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    
    
    
    Dim Spath As String
    Dim StrSignature As String
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
        
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = "underwriting@marinecu.com"
        'Cc
        'objMail.CC =
        'Subject
        objMail.Subject = "New Submission, " & LN & ", " & FN & ", " & AN1
        'Email Body
        objMail.HTMLBody = "Loan Amount: " & LA & "<br>" & "Loan Purpose: " & LP & "<br>" & "Property Type: " & PT & "<br>" & "Loan Officer: " & LO & _
        "<br>" & "Branch: " & BR & "<br>" & "<br>" & StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to underwriting."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description
End Sub
Attribute VB_Name = "Module5"
Public Sub TitleReceipt()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Title Reciept")
If answer = vbNo Then
Exit Sub
End If
'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If

Call MoveTitle


Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'To
    Dim TO1 As String
    TO1 = Sheets("Automation Data").Range("K2").Value
    
    Dim TO2 As String
    TO2 = Sheets("Automation Data").Range("K15").Value
    
    Dim TO3 As String
    TO3 = "underwriting@marinecu.com"
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("K15").Value
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    Dim UN As String
    UN = Sheets("Conditions").Range("J7").Value
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = TO1 & ";" & TO2 & ";" & TO3
        'Cc
        'objMail.CC =
        'Subject
        objMail.Subject = "Title, " & LN & ", " & FN & ", " & AN1 & ", " & UN
        'Email Body
        objMail.HTMLBody = "Title work for " & LN & ", " & FN & " has been recieved and ready for review." & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to the MLR, BM, and Underwriting."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description

        
End Sub

Attribute VB_Name = "Module6"
Public Sub AppraisalReceipt()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Appraisal Reciept")
If answer = vbNo Then
Exit Sub
End If
'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If
    
Call MoveAppraisal


Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'To
    Dim TO1 As String
    TO1 = Sheets("Automation Data").Range("K2").Value
    
    Dim TO2 As String
    TO2 = Sheets("Automation Data").Range("K15").Value
    
    Dim TO3 As String
    TO3 = "underwriting@marinecu.com"
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("K15").Value
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    Dim UN As String
    UN = Sheets("Conditions").Range("J7").Value
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = TO1 & ";" & TO2 & ";" & TO3
        'Cc
        'objMail.CC =
        'Subject
        objMail.Subject = "Appraisal, " & LN & ", " & FN & ", " & AN1 & ", " & UN
        'Email Body
        objMail.HTMLBody = "Appraisal for " & LN & ", " & FN & " has been recieved and ready for review." & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to the MLR, BM, and Underwriting. Please remember to send a invoice to accounting if applicable."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description

        
End Sub

Attribute VB_Name = "Module7"
Function USERNAME()
USERNAME = Application.USERNAME
End Function
Sub Browse()

    Dim fd As FileDialog
    Dim oFD As Variant
    Dim FilePath As String
    
    Set fd = Application.FileDialog(msoFileDialogFolderPicker)
    With fd
        .ButtonName = "Select"
        .AllowMultiSelect = False
        .Title = "Select a folder name"
        .InitialView = msoFileDialogViewDetails
        .Show
        
        For Each oFD In .SelectedItems
            FilePath = oFD
        Next oFD
        On Error GoTo 0
    End With
    
    
    Range("AB3").Value = FilePath


    
    
End Sub

Sub MLRBrowse()
    Dim fd As FileDialog
    Dim oFD As Variant
    Dim MLRFilePath As String
    
    Set fd = Application.FileDialog(msoFileDialogFolderPicker)
    With fd
        .ButtonName = "Select"
        .AllowMultiSelect = False
        .Title = "Select a folder name"
        .InitialView = msoFileDialogViewDetails
        .Show
        
        For Each oFD In .SelectedItems
            MLRFilePath = oFD
        Next oFD
        On Error GoTo 0
    End With
    
    
    Range("AB6").Value = MLRFilePath
    
    
End Sub

Public Sub MLRSave()
Dim FilePath As String
Dim FileName As String
FileName = Sheets("Automation Data").Range("K18").Value
Dim M1 As String
M1 = Sheets("Automation Data").Range("K21").Value
Dim D1 As String
D1 = Sheets("Automation Data").Range("K22").Value
Dim Y1 As String
Y1 = Sheets("Automation Data").Range("K23").Value
FilePath = Sheets("Conditions").Range("AB6").Value
Sheets("Conditions").Copy
Application.DisplayAlerts = False
ActiveSheet.ExportAsFixedFormat _
Type:=x1TypePDF, FileName:=FilePath & "\" & FileName & ", " & M1 & "-" & D1 & "-" & Y1
ActiveWorkbook.Close
Application.DisplayAlerts = True
End Sub

Public Sub MoveTitle()
Dim fd1 As FileDialog
    Dim oFD1 As Variant
    Dim MLRFilePath1 As String
    Dim FilePath1 As String
    MLRFilePath1 = Sheets("Conditions").Range("AB6").Value
    Dim LN1 As String
    Dim FN1 As String
    LN1 = Sheets("Automation Data").Range("K26").Value
    FN1 = Sheets("Automation Data").Range("K29").Value
    
    Set fd1 = Application.FileDialog(msoFileDialogFilePicker)
    With fd1
        .ButtonName = "Select"
        .AllowMultiSelect = False
        .Title = "Select the title work to copy."
        .InitialView = msoFileDialogViewDetails
        .Show
        
        For Each oFD1 In .SelectedItems
            FilePath1 = oFD1
        Next oFD1
        
    End With
    Dim Source As String
    Dim Desitination As String
    Source = FilePath1
    Desitination = MLRFilePath1 & "\" & "150" & ", " & LN1 & "," & FN1 & ", " & "Title Work.pdf"
    
    If FilePath1 <> "" Then
    FileCopy Source, Desitination
    FilePath1 = ""
    End If
 
End Sub

Public Sub MoveAppraisal()
Dim fd1 As FileDialog
    Dim oFD1 As Variant
    Dim MLRFilePath1 As String
    Dim FilePath1 As String
    MLRFilePath1 = Sheets("Conditions").Range("AB6").Value
    Dim LN1 As String
    Dim FN1 As String
    LN1 = Sheets("Automation Data").Range("K26").Value
    FN1 = Sheets("Automation Data").Range("K29").Value
    
    Set fd1 = Application.FileDialog(msoFileDialogFilePicker)
    With fd1
        .ButtonName = "Select"
        .AllowMultiSelect = False
        .Title = "Select the title work to copy."
        .InitialView = msoFileDialogViewDetails
        .Show
        
        For Each oFD1 In .SelectedItems
            FilePath1 = oFD1
        Next oFD1
        
    End With
    Dim Source As String
    Dim Desitination As String
    Source = FilePath1
    Desitination = MLRFilePath1 & "\" & "300" & ", " & LN1 & "," & FN1 & ", " & "Appraisal.pdf"
    
    If FilePath1 <> "" Then
    FileCopy Source, Desitination
    FilePath1 = ""
    End If
 
End Sub



Attribute VB_Name = "Module8"
Sub ConditionsFromUW()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Conditions from Underwriting")
If answer = vbNo Then
Exit Sub
End If
'Save PDF
Dim FilePath As String
Dim FileName As String
FileName = Sheets("Automation Data").Range("K18").Value
Dim M1 As String
M1 = Sheets("Automation Data").Range("K21").Value
Dim D1 As String
D1 = Sheets("Automation Data").Range("K22").Value
Dim Y1 As String
Y1 = Sheets("Automation Data").Range("K23").Value
FilePath = Sheets("Conditions").Range("AB3").Value
Sheets("Conditions").Copy
Application.DisplayAlerts = False
ActiveSheet.ExportAsFixedFormat _
Type:=x1TypePDF, FileName:=FilePath & "\" & FileName & ", " & M1 & "-" & D1 & "-" & Y1
ActiveWorkbook.Close
Application.DisplayAlerts = True

Call MLRSave



'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If
'Sending Notification
Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'To
    Dim TO1 As String
    TO1 = Sheets("Automation Data").Range("K2").Value
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("K15").Value
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    
    
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = TO1
        'Cc
        objMail.CC = CC1
        'Subject
        objMail.Subject = "Updated Conditions for " & LN & ", " & FN & ", " & AN1
        'Email Body
        objMail.HTMLBody = "Please find attached the Underwriting condititions for the member listed above." & "<br>" & "<br>" & _
        "Please send the requested documents to the S:\Community Banking\Mortgage Loan Docs\Branch folder along with an email to the Loan Processing Inbox stating the conditions have been placed in the appropriate folder." _
        & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        objMail.Attachments.Add FilePath & "\" & FileName & ", " & M1 & "-" & D1 & "-" & Y1 & ".pdf"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
MsgBox "A notification has been succesfully sent to the MLR and BM."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description
End Sub

Attribute VB_Name = "Module9"
Sub CleartoClose()
On Error GoTo eh
Dim answer As String
answer = MsgBox("Please confirm that you want to complete this step.", vbYesNo + vbQuestion, "Clear to Close")
If answer = vbNo Then
Exit Sub
End If
'Save PDF
Dim FilePath As String
Dim FileName As String
FileName = Sheets("Automation Data").Range("K18").Value
Dim M1 As String
M1 = Sheets("Automation Data").Range("K21").Value
Dim D1 As String
D1 = Sheets("Automation Data").Range("K22").Value
Dim Y1 As String
Y1 = Sheets("Automation Data").Range("K23").Value
FilePath = Sheets("Conditions").Range("AB3").Value
Sheets("Conditions").Copy
Application.DisplayAlerts = False
ActiveSheet.ExportAsFixedFormat _
Type:=x1TypePDF, FileName:=FilePath & "\" & FileName & ", " & M1 & "-" & D1 & "-" & Y1 & ", " & "Clear"
ActiveWorkbook.Close
Application.DisplayAlerts = True

Call MLRSave



'Checking Required fields for this step
If Sheets("Conditions").Range("J4").Value = "" Or Sheets("Conditions").Range("J4").Value = " " Or Sheets("Conditions").Range("J3").Value = " " _
Or Sheets("Conditions").Range("J3").Value = "" Or Sheets("Conditions").Range("J2").Value = " " Or Sheets("Conditions").Range("J2").Value = "" Then

MsgBox "Please make sure that the Application #, Loan Officer:, and Branch: fields are complete.", vbExclamation, "UW Condition Sheet"
Exit Sub
End If
'Sending Notification
Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    'To
    Dim TO1 As String
    TO1 = Sheets("Automation Data").Range("K2").Value
    
    'CC
    Dim CC1 As String
    CC1 = Sheets("Automation Data").Range("K15").Value
    
    Dim LN As String
    LN = Sheets("Automation Data").Range("K26").Value
    Dim FN As String
    FN = Sheets("Automation Data").Range("K29").Value
    Dim DA As String
    If Sheets("Conditions").Range("O2").Value = "HELOC" Or Sheets("Conditions").Range("O4").Value = "Mobile Home w/o land" Then
    DA = "2"
    Else
    DA = "6"
    End If
    
    'Application #
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim Spath As String
    Dim StrSignature As String
    
    
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
    
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = TO1
        'Cc
        objMail.CC = CC1
        'Subject
        objMail.Subject = LN & ", " & FN & ", " & AN1
        'Email Body
        objMail.HTMLBody = "This file is clear to close.  Please schedule a closing no less than " & DA & " days (not including holidays, Saturdays, and Sundays) from notification " _
        & "to loanprocessing@marinecu.com of the date and time. If this is not possible, please complete the respective " & DA & " day exception to close form to your branch manager to begin the approval " _
        & "process as to why the file needs to close earlier. The Clear to Close condition sheet is saved in the S Drive." & "<br>" & "<br>" & "Thank you," & "<br>" & "<br>" & StrSignature
        'Add Attachment
        objMail.Attachments.Add FilePath & "\" & FileName & ", " & M1 & "-" & D1 & "-" & Y1 & ", " & "Clear" & ".pdf"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
        
        

        
MsgBox "A notification has been succesfully sent to the MLR and BM."

Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description
End Sub
Attribute VB_Name = "ScheduleClosingForm"
Attribute VB_Base = "0{19437B86-4D90-4045-9DF3-F2C9A48F7413}{08901C4C-3FAF-4B96-AD73-7517FEBD9A52}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CancelBtn_Click()
On Error GoTo eh
ScheduleClosingForm.Hide
eh:
   Logger "Error", Err.Source, Err.Description
End Sub

Private Sub SubmitBtn_Click()
On Error GoTo eh
    ScheduleClosingForm.Hide

    'To
    Dim MLREmail As String
    MLREmail = Sheets("Automation Data").Range("K2").Value
    
    'CC
    Dim AN1 As String
    AN1 = Sheets("Conditions").Range("J2").Value
    Dim BMEmail As String
    BMEmail = Sheets("Automation Data").Range("K15").Value
    Dim LastName As String
    LastName = Sheets("Automation Data").Range("K26").Value
    Dim FirstName As String
    FirstName = Sheets("Automation Data").Range("K29").Value
    Dim ProcessorName As String
    ProcessorName = Sheets("Conditions").Range("J6").Value
    Dim AT As String
    AT = Sheets("Conditions").Range("B22").Value
    Dim LoanAmount As String
    LoanAmount = Sheets("Conditions").Range("O8").Value
    Dim DateOfClosing As String
    DateOfClosing = DateOfClosingTxt.Text
    Dim DateOfClosing1 As Date
    DateOfClosing1 = DateOfClosingTxt.Text
    Dim TimeOfClosing As String
    TimeOfClosing = TimeOfClosingTxt.Text
    Dim TitleCompanyClosing As String
    TitleCompanyClosing = TitleCompanyClosingTxt.Text
    Dim DateOfFunding As String
    DateOfFunding = FundingDateTxt.Text
    Dim MLR As String
    MLR = Sheets("Conditions").Range("J3").Value
    Dim LoanPurpose As String
    LoanPurpose = Sheets("Conditions").Range("O3").Value
    Dim LoanType As String
    LoanType = Sheets("Conditions").Range("O2").Value
    Dim PropertyType As String
    PropertyType = Sheets("Conditions").Range("O4").Value
    Dim Supervisor As String
    Supervisor = Sheets("Automation Data").Range("K12").Value
    Dim CentralLending As String
    If Sheets("Automation Data").Range("M2").Value = "Centralized" Then
    CentralLending = "Y"
    Else
    CentralLending = "N"
    End If
    
    Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim lCounter As Long
    'Set objects
    Set objOutlook = Outlook.Application
    'Read details from Excel sheet and send emails
    
    Dim Spath As String
    Dim StrSignature As String
    
   
        
        Spath = Environ("appdata") & "\Microsoft\Signatures\signature.htm"
        signImageFolderName = "Signature_files"
        completeFolderPath = Environ("appdata") & "\Microsoft\Signatures\" & signImageFolderName
        StrSignature = GetSignature(Spath)
        StrSignature = VBA.Replace(StrSignature, signImageFolderName, completeFolderPath)
        
        'Create a new email item
        Set objMail = objOutlook.CreateItem(olMailItem)
        'Sent from
        objMail.SentOnBehalfOfName = "loanprocessing@marinecu.com"
        'Importance
        objMail.Importance = 1
        'To
        objMail.To = MLREmail
        'Cc
        objMail.CC = BMEmail
        'Subject
        objMail.Subject = "Closing scheduled for " & LastName & ", " & FirstName & ", " & AN1
        'Email Body
        objMail.HTMLBody = "The closing for " + LastName + ", " + FirstName + ", " + AN1 + " has been scheduled for " + DateOfClosing + " at " + TimeOfClosing + "." + "<br>" + "<br>" + "Thankyou," + "<br>" + "<br>" + StrSignature
        'Add Attachment
        'objMail.Attachments.Add "S:\Community Banking\"
        'objMail.Attachments.Add "S:\Community Banking\"
        'Send email
        objMail.Display
        objMail.Send
        'Close the object
        Set objMail = Nothing
    
Dim TimeOfClosingArray(1 To 2) As String
    TimeOfClosingArray(1) = "3:00:00 PM"
    TimeOfClosingArray(2) = TimeOfClosing
    
Dim CalendarNameArray(1 To 2) As String
    CalendarNameArray(1) = "loan.funding@marinecu.com"
    CalendarNameArray(2) = "loanprocessing@marinecu.com"
    
Dim RequiredAttendeesArray(1 To 2) As String
    RequiredAttendeesArray(1) = ""
    RequiredAttendeesArray(2) = MLREmail + ";" + BMEmail
    
For i = 1 To 2
    
     Dim oApp As Outlook.Application
     Dim oAppt As Outlook.AppointmentItem
     
     Dim oNamespace As Outlook.Namespace
     Dim oFolder As Outlook.Folder
     Dim oRecipient As Outlook.Recipient
     
     Set oApp = CreateObject("outlook.application")
     Set oNamespace = oApp.GetNamespace("MAPI")
     Set oRecipient = oNamespace.CreateRecipient(CalendarNameArray(i))
     oRecipient.Resolve
         
     Set oFolder = oNamespace.GetSharedDefaultFolder(oRecipient, olFolderCalendar)

     Set oAppt = oFolder.Items.Add(olAppointmentItem)
     With oAppt
 
 .MeetingStatus = olMeeting
 .Start = DateOfClosing1 + TimeOfClosingArray(i)
 .Duration = "30"
 .Subject = LastName + " " + DateOfClosing + "-" + DateOfFunding + ", " & ProcessorName + ", " + CentralLending
 .Body = "Name (Last,First): " + LastName + ", " + FirstName + vbNewLine + _
         "Account Number: " + AN1 + vbNewLine + _
         "Loan Amount: " + LoanAmount + vbNewLine + _
         "TC Closing (Y/N): " + TitleCompanyClosing + vbNewLine + _
         "Date of Funding: " + DateOfFunding + vbNewLine + _
         "Time of Closing: " + TimeOfClosing + vbNewLine + _
         "MLR: " + MLR + vbNewLine + _
         "Processor: " + ProcessorName + vbNewLine + _
         "Loan Purpose: " + LoanPurpose + vbNewLine + _
         "Loan Type: " + LoanType + vbNewLine + _
         "Property Type: " + PropertyType + vbNewLine + _
         "Central Lending (Y/N): " + CentralLending
 .ResponseRequested = False
 .RequiredAttendees = RequiredAttendeesArray(i)
 .Send
 .Save
 End With
Next i
 
 MsgBox ("The closing has been added to the funding calendar and a notification has been sent to the MLR and BM. Please remember to adjust the appointment on the funding calendar so it is in the correct time slot.")

 Exit Sub

eh:
   Logger "Error", Err.Source, Err.Description
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub ComboBox1_Change()

End Sub

Private Sub CheckBox1_Click()

End Sub

Private Sub OptionButton1_Click()

End Sub
Private Sub Worksheet_Change(ByVal Target As Excel.Range)
        With Target
            If .Count > 1 Then Exit Sub
            If Not Intersect(Range("c24:c92"), .Cells) Is Nothing Then
                Application.EnableEvents = False
                If IsEmpty(.Value) Then
                    .Offset(0, 1).ClearContents
                Else
                    With .Offset(0, 1)
                        .NumberFormat = "m/d/yy h:mm"
                        .Value = Now
                    End With
                End If
                Application.EnableEvents = True
            End If
        End With
    End Sub


Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
    Dim FilePath As String
    Dim MLRFilePath As String
    
    FilePath = Sheets("Conditions").Range("AB3").Value
    MLRFilePath = Sheets("Conditions").Range("AB6").Value
    
    Dim i As Integer
    
    Dim FilePathVariable(1 To 2) As String
    
    FilePathVariable(1) = FilePath
    FilePathVariable(2) = MLRFilePath
    
    Dim SectionNameVariable(1 To 2) As String
    
    SectionNameVariable(1) = "folder location"
    SectionNameVariable(2) = "MLR folder location"
    
    Dim BrowseMacro(1 To 2) As String
    
    BrowseMacro(1) = "Browse"
    BrowseMacro(2) = "MLRBrowse"
    
    For i = 1 To 2
    
        If FilePathVariable(i) = "" Or FilePathVariable(i) = " " Then
    
            MsgBox "Please complete the " & SectionNameVariable(i) & " section to the right."
            Application.Run BrowseMacro(i)
            
            
        
        ElseIf Dir(FilePathVariable(i), vbDirectory) = "" Then
    
            MsgBox "The file path in the " & SectionNameVariable(i) & " section is invalid please reselect this location."
            Application.Run BrowseMacro(i)
                
        
        
        End If
    
    Next i

End Sub



' InQuest injected base64 decoded content
' N+ex*&

INQUEST-PP=macro
