Attribute VB_Name = "Hoja01"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja02"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

    Call Apertura

End Sub

Public Function Apertura()

    Application.ScreenUpdating = False
    Range("C3:X62").Select
    ActiveWindow.Zoom = True
    ScrollArea = "C3:C4"
    Application.ScreenUpdating = True
    
    Range("A1").Select

End Function

Sub AreaDelScroll2()

    ScrollArea = "C3:Z40"

End Sub
Attribute VB_Name = "Hoja05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

    ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
    Range("A1").Select
    ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=True, Contents:=True, Scenarios:=False
    
End Sub


Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  ' Punteo Facil de una fila de informaci|fffd|n sobre la columna 5

    If (Target.Column = 7 And Target.Row >= 10 And Target.Row <= 110) Then
        If Cells(Target.Row, 7) = "SI" Then
            Cells(Target.Row, 7) = ""
            Else
            Cells(Target.Row, 7) = "SI"
            Cells(Target.Row, 8) = ""
        End If
    End If
    
    If (Target.Column = 8 And Target.Row >= 10 And Target.Row <= 110) Then
        If Cells(Target.Row, 8) = "NO" Then
            Cells(Target.Row, 8) = ""
            Else
            Cells(Target.Row, 8) = "NO"
            Cells(Target.Row, 7) = ""
        End If
    End If
    
End Sub
Attribute VB_Name = "Hoja06"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

   ' ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
   ' Range("A1").Select
   ' ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=True, Contents:=True, Scenarios:=False
    
End Sub
Attribute VB_Name = "Hoja10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

    ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
    ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=True, Contents:=True, Scenarios:=False
    
End Sub

Attribute VB_Name = "Hoja12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

    ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
    ActiveSheet.PivotTables("TablaDin|fffd|mica1").PivotCache.Refresh
    ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=True, Contents:=True, Scenarios:=False, AllowInsertingHyperlinks:=True, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    
End Sub
Attribute VB_Name = "Hoja20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Worksheet_Activate()

    ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
    Call CopiarDatosParaExportar
    ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=False, Contents:=True, Scenarios:=False

End Sub
Attribute VB_Name = "Hoja30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "M|fffd|dulo1"
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Sub BorrarDatos()
  ' Borrar el contenido de los test, para realizar uno nuevo
    
    Sheets("1 - TEST").Range("G11:H110").ClearContents
    Sheets("1 - TEST").Range("E4").Value = "Por favor, introduzca aqu|fffd| el Nombre del Alumno"
    Sheets("1 - TEST").Select
    Range("G11").Select
    
    Sheets("2 - PERFIL").Range("E8:E35").ClearContents
    Sheets("2 - PERFIL").Select
    Range("E8").Select
    
    Sheets("PORTADA").Select
    
    MsgBox "Los resultados de este test han sido borrados."
    
End Sub

Sub CopiarDatosParaExportar()

    ActiveSheet.Unprotect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn"
    
    Sheets("DATOS").Select
    Sheets("DATOS").Range("B10:G138").ClearContents

    Sheets("DATOS").Range("B10").Value = "Linea"
    Sheets("DATOS").Range("C10").Value = "Empleado"
    Sheets("DATOS").Range("D10").Value = "Tipo"
    Sheets("DATOS").Range("E10").Value = "Num Pregunta"
    Sheets("DATOS").Range("F10").Value = "Respuesta Test"
    Sheets("DATOS").Range("G10").Value = "Respuesta Perfil"
    Sheets("DATOS").Range("B11").Value = "1"
    Sheets("DATOS").Range("B12").Value = "2"
    Sheets("DATOS").Range("B11:B12").Select
    Selection.AutoFill Destination:=Range("B11:B138"), Type:=xlFillDefault
    
    Sheets("DATOS").Range("C11:C138").Value = WorksheetFunction.Proper(Sheets("1 - TEST").Range("E4").Value)           ' Nombre del Empleado
    
    Sheets("DATOS").Range("D11:D110").Value = "Test"                                         ' Tipo
    Sheets("DATOS").Range("E11:E110").Value = Sheets("1 - TEST").Range("E11:E110").Value     ' Num Pregunta
    Sheets("DATOS").Range("F11:F110").Value = Sheets("1 - TEST").Range("I11:I110").Value     ' Respuesta Test

    Sheets("DATOS").Range("D111:D138").Value = "Perfil"                                      ' Tipo
    Sheets("DATOS").Range("E111:E138").Value = Sheets("2 - PERFIL").Range("D8:D35").Value    ' Num Pregunta
    Sheets("DATOS").Range("G111:G138").Value = Sheets("2 - PERFIL").Range("E8:E35").Value    ' Respuesta Perfil
    
    '    Range("B11:G138").Select
    '    Selection.Copy
    Range("B11").Select
    ActiveSheet.Protect Password:="SMFIEmxctUWaYPZGrJyC0H8N9Hsn", DrawingObjects:=False, Contents:=True, Scenarios:=False
    
End Sub


Sub OrdenarDatos()
Attribute OrdenarDatos.VB_ProcData.VB_Invoke_Func = " \n14"
  ' OrdenarDatos Macro

    Range("Tabla1[#All]").Select
    Application.Goto Reference:="Tabla1"
    ActiveWorkbook.Worksheets("1 - TEST").ListObjects("Tabla1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("1 - TEST").ListObjects("Tabla1").Sort.SortFields.Add _
        Key:=Range("Tabla1[T]"), SortOn:=xlSortOnValues, Order:=xlAscending, _
        DataOption:=xlSortNormal
    ActiveWorkbook.Worksheets("1 - TEST").ListObjects("Tabla1").Sort.SortFields.Add _
        Key:=Range("Tabla1[Pregunta]"), SortOn:=xlSortOnValues, Order:= _
        xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("1 - TEST").ListObjects("Tabla1").Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("B12").Select

End Sub


Sub Usuario()

    MsgBox Application.UserName

End Sub
Attribute VB_Name = "M|fffd|dulo2"
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Sub TablaMostrar()
Attribute TablaMostrar.VB_ProcData.VB_Invoke_Func = " \n14"
    
    ActiveSheet.PivotTables("TablaDin|fffd|mica1").PivotFields("T E M A").ShowDetail = True
    
End Sub

Sub TablaOcultar()
    
    ActiveSheet.PivotTables("TablaDin|fffd|mica1").PivotFields("T E M A").ShowDetail = False
    
End Sub


Attribute VB_Name = "M|fffd|dulo3"
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Sub Ir_a_Test()
Attribute Ir_a_Test.VB_ProcData.VB_Invoke_Func = " \n14"
    
    Sheets("1 - TEST").Select
    Range("G11").Select

End Sub

Sub Ir_a_PerfilProfesional()
    
    Sheets("2 - PERFIL").Select
    Range("E8").Select

End Sub

Sub Ir_NombreAlumno()

    Dim Alumno As String
    Alumno = InputBox("Por favor, introduzca el Nombre del Alumno", "DATOS DE IDENTIFICACI|fffd|N")
    If Alumno = vbNullString Then Exit Sub
    
    Sheets("1 - Test").Range("E4").Value = Alumno
    ChDir ThisWorkbook.Path
    ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - " & Alumno & ".xlsb", FileFormat:=xlExcel12, CreateBackup:=False
    Kill ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - NOMBRE DEL ALUMNO.xlsb"

End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
' CODIGO FUENTE DESARROLLADO POR "ABERTIA CONSULTING AND SERVICES SLP", COPYRIGHT 2015, TODOS LOS DERECHOS RESERVADOS, PROHIBIDA SU COPIA Y COMERCIALIZACI|fffd|N
' **********************************************************************************************************************************************************

Private Sub Workbook_Open()

    Sheets("PORTADA").Activate
    
    If Application.UserName <> "Tarantino" And Range("ALUMNO").Value = "Por favor, introduzca aqu|fffd| el Nombre del Alumno" Then
    
        Dim Respuesta As String
        Respuesta = InputBox("Por favor, introduzca aqu|fffd| su Nombre y Apellidos para indicarlo en el libro. Muchas gracias.", "Nombre Alumno", Application.UserName)
        
        If Respuesta <> "" Then
             ThisWorkbook.Sheets("1 - Test").Range("E4").Value = Alumno
             ChDir ThisWorkbook.Path
             ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - " & Alumno & ".xlsb", FileFormat:=xlExcel12, CreateBackup:=False
             Kill ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - NOMBRE DEL ALUMNO.xlsb"
             Else
        End If

    End If

End Sub


Private Sub Workbook_BeforeClose(Cancel As Boolean)
    
    If Application.UserName <> "Tarantino" And ThisWorkbook.Sheets("1 - Test").Range("E4").Value = "Por favor, introduzca aqu|fffd| el Nombre del Alumno" Then
    
        Sheets("1 - TEST").Select
        Range("E4:G4").Select
        Dim Respuesta As String
        Respuesta = InputBox("Por favor, introduzca aqu|fffd| su Nombre y Apellidos para indicarlo en el libro. Muchas gracias.", "Nombre Alumno", Application.UserName)
        
        If Respuesta <> "" Then
             ThisWorkbook.Sheets("1 - Test").Range("E4").Value = Alumno
             ChDir ThisWorkbook.Path
             ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - " & Alumno & ".xlsb", FileFormat:=xlExcel12, CreateBackup:=False
             Kill ThisWorkbook.Path & "\" & "00 TEST DE EXCEL- Evaluacion de Competencias - APD - NOMBRE DEL ALUMNO.xlsb"
             Else
        End If
        
    End If

End Sub

Sub Usuario()

    MsgBox Application.UserName
    
End Sub


INQUEST-PP=macro
