Attribute VB_Name = "Module1"
Sub auto_open()
AddIns("Analysis ToolPak").Installed = True
If Range("autoopen").Value = True Then
Module3.dimmacro
Module3.dimsheet
Module3.dimprotect
Module2.hidesheets
If Range("datecheck").Value < 1 Then
Style = vbOKCancel + vbDefaultButton2
Message = "Press OK to Update Rates.  Press Cancel to Exit."
Title = "Interest Rates Are Not Valid."
response = MsgBox(Message, Style, Title)
  If response = vbOK Then
  Load RatePassword
  RatePassword.Show
  Else
    ActiveWorkbook.Close (False)
  End If
End If
End If

End Sub
Sub Macro1()
Attribute Macro1.VB_Description = "Macro recorded 6/18/99 by Jason Rabineau"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"

    Application.Calculation = xlManual
    y = Range("data").Count / 4
    policy = 0
    Range("Cp").Value = "Policies Calculated"
    Range("Pr").Value = "Policies Remaining"
    
    For x = 1 To y
        If Range("data").Cells(x, 1).Value <> "" Then
            
            Range("Curr").Value = policy
            Range("remain").Value = Range("policycount").Value - policy
            
            
            Range("Ann1Age").Value = Range("data").Cells(x, 2).Value
            Range("Ann1Sex").Value = Range("data").Cells(x, 1).Value
            Range("Ann2Age").Value = Range("data").Cells(x, 4).Value
            Range("Ann2Sex").Value = Range("data").Cells(x, 3).Value
            Range("Payment").Value = Range("data").Cells(x, 5).Value
            
            Calculate
            
            Range("Solution").Cells(x, 1).Value = Range("Factor").Value
            
            policy = policy + 1
            
        End If
        
    Next x
    
    Range("Cp").Value = ""
    Range("Pr").Value = ""
    Range("Curr").Value = ""
    Range("remain").Value = ""
    
    Application.Calculation = xlAutomatic
End Sub

Attribute VB_Name = "Module2"
Public Sub Selection()

    If Range("IRR").Value = True And Range("CB").Value = True And Range("ATPlink").Value = 1 Then
    Sheets("IRRCBATP1").Activate
    ActiveSheet.Visible = xlSheetVisible
    ElseIf Range("CB").Value = True And Range("ATPlink").Value = 1 Then
    Sheets("ATP1").Activate
    ActiveSheet.Visible = xlSheetVisible
        If Range("option").Value = 1 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 54
        Rows("44:44").RowHeight = 80
        ElseIf Range("option").Value = 3 Or Range("option").Value = 7 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 104
        Rows("44:44").RowHeight = 30
        Else
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 68
        Rows("44:44").RowHeight = 68
        End If
    ElseIf Range("IRR").Value = True And Range("CB").Value = True Then
    Sheets("IRRCB1").Activate
    ActiveSheet.Visible = xlSheetVisible
    ElseIf Range("IRR").Value = True And Range("ATPlink").Value = 1 Then
    Sheets("IRRATP1").Activate
    ActiveSheet.Visible = xlSheetVisible
    ElseIf Range("CB").Value = True Then
    Sheets("CB1").Activate
    ActiveSheet.Visible = xlSheetVisible
        If Range("option").Value = 1 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 54
        Rows("44:44").RowHeight = 125
        ElseIf Range("option").Value = 3 Or Range("option").Value = 7 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 102
        Rows("44:44").RowHeight = 72
        Else
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 68
        Rows("44:44").RowHeight = 110
        End If
    ElseIf Range("ATPlink").Value = 1 Then
    Sheets("ATP1").Activate
    ActiveSheet.Visible = xlSheetVisible
        If Range("option").Value = 1 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 54
        Rows("44:44").RowHeight = 102
        ElseIf Range("option").Value = 3 Or Range("option").Value = 7 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 102
        Rows("44:44").RowHeight = 50
        Else
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 68
        Rows("44:44").RowHeight = 88
        End If
    ElseIf Range("IRR").Value = True Then
    Sheets("IRR1").Activate
    ActiveSheet.Visible = xlSheetVisible
    Else
    Sheets("Standard").Activate
    ActiveSheet.Visible = xlSheetVisible
        If Range("option").Value = 1 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 54
        Rows("44:44").RowHeight = 125
        ElseIf Range("option").Value = 3 Or Range("option").Value = 7 Then
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 102
        Rows("44:44").RowHeight = 102
        Else
        Rows("17:17").RowHeight = 39
        Rows("19:19").RowHeight = 68
        Rows("44:44").RowHeight = 125
        End If
    
    End If
    
End Sub
Sub printillustration()
    
    Selection
    ActiveWindow.SelectedSheets.PrintOut Copies:=1
    ActiveSheet.Visible = xlSheetVeryHidden

    
End Sub
Sub IMRVersionhide()
    
    Sheets("user").Activate
    Rows("18:22").EntireRow.Hidden = True
    
End Sub
Sub IMRVersionunhide()
    
    Sheets("user").Activate
    Rows("17:21").EntireRow.Hidden = False
    
End Sub


Sub hidesheets()

    Sheet1.Visible = xlSheetVeryHidden
    Sheet2.Visible = xlSheetVeryHidden
    Sheet3.Visible = xlSheetVeryHidden
    Sheet4.Visible = xlSheetVeryHidden
    Sheet5.Visible = xlSheetVeryHidden
    Sheet6.Visible = xlSheetVeryHidden
    Sheet7.Visible = xlSheetVeryHidden
    Sheet8.Visible = xlSheetVeryHidden
    Sheet9.Visible = xlSheetVeryHidden
    Sheet10.Visible = xlSheetVeryHidden
    Sheet11.Visible = xlSheetVeryHidden
    Sheet12.Visible = xlSheetVeryHidden
    Sheet15.Visible = xlSheetVeryHidden
    Sheet23.Visible = xlSheetVeryHidden
    Sheet24.Visible = xlSheetVeryHidden
    Sheet25.Visible = xlSheetVeryHidden
    Sheet26.Visible = xlSheetVeryHidden
    Sheet27.Visible = xlSheetVeryHidden
    Sheet29.Visible = xlSheetVeryHidden
    Sheet30.Visible = xlSheetVeryHidden
    Sheet31.Visible = xlSheetVeryHidden
    Sheet32.Visible = xlSheetVeryHidden
    Sheet33.Visible = xlSheetVeryHidden


End Sub

Sub showsheets()

    Module3.undimmacro
    Module3.undimprotect
    Module3.undimsheet
    Sheet1.Visible = xlSheetVisible
    Sheet2.Visible = xlSheetVisible
    Sheet3.Visible = xlSheetVisible
    Sheet4.Visible = xlSheetVisible
    Sheet5.Visible = xlSheetVisible
    Sheet6.Visible = xlSheetVisible
    Sheet7.Visible = xlSheetVisible
    Sheet8.Visible = xlSheetVisible
    Sheet9.Visible = xlSheetVisible
    Sheet10.Visible = xlSheetVisible
    Sheet11.Visible = xlSheetVisible
    Sheet12.Visible = xlSheetVisible
    Sheet15.Visible = xlSheetVisible
    Sheet23.Visible = xlSheetVisible
    Sheet24.Visible = xlSheetVisible
    Sheet25.Visible = xlSheetVisible
    Sheet26.Visible = xlSheetVisible
    Sheet27.Visible = xlSheetVisible
    Sheet29.Visible = xlSheetVisible
    Sheet30.Visible = xlSheetVisible
    Sheet31.Visible = xlSheetVisible
    Sheet32.Visible = xlSheetVisible
    Sheet33.Visible = xlSheetVisible
End Sub

Attribute VB_Name = "Module3"
Sub resetjoint()
Attribute resetjoint.VB_Description = "Macro recorded 9/18/2001 by Jwvaugh"
Attribute resetjoint.VB_ProcData.VB_Invoke_Func = " \n14"

    Range("F3").ClearContents
    Range("F4").ClearContents
    Range("F6").Value = 1
    Range("secondsex").Value = 3
    Range("seccredit").Value = 1
    
End Sub

Sub resetmisc()
Attribute resetmisc.VB_Description = "Macro recorded 9/18/2001 by Jwvaugh"
Attribute resetmisc.VB_ProcData.VB_Invoke_Func = " \n14"

    Range("F10").Value = 0
    Range("F12").Value = 0
    Range("F13").Value = 0
    Range("F15").Value = 0
    Range("F16").Value = 0
    Worksheets("user").CheckBox1.Value = False
    Worksheets("user").CheckBox2.Value = False
    Worksheets("user").CheckBox3.Value = False
    Worksheets("user").CheckBox6.Value = False
    
End Sub
Sub dimsheet()
    MenuBars(xlWorksheet).Menus("Format").MenuItems("Sheet").Enabled = False
    
End Sub

Sub undimsheet()
    MenuBars(xlWorksheet).Menus("Format").MenuItems("sheet").Enabled = True

End Sub
Sub dimmacro()
    MenuBars(xlWorksheet).Menus("Tools").MenuItems("Macro").Enabled = False
    
End Sub

Sub undimmacro()
    MenuBars(xlWorksheet).Menus("Tools").MenuItems("Macro").Enabled = True

End Sub
Sub dimprotect()
    MenuBars(xlWorksheet).Menus("Tools").MenuItems("Protection").Enabled = False
    
End Sub

Sub undimprotect()
    MenuBars(xlWorksheet).Menus("Tools").MenuItems("Protection").Enabled = True

End Sub
Attribute VB_Name = "Module4"
Sub Solve()
Attribute Solve.VB_Description = "Macro recorded 7/16/99 by Jason Rabineau"
Attribute Solve.VB_ProcData.VB_Invoke_Func = " \n14"
   
    'Determine which curve to use.
    'k=1 use Spot Rate, K=2 use Level Rate, K=3 use LP Curve
    'Solve for Premium = 1, Solve for Payment = 2
    k = 0
    premiumlimit = 2500000
    LPresult = 0
    Spotresult = 0
    
    Range("acqexp").Value = 110.41
    override = Range("RateOverride").Value
    
    If override = 1 Then
        k = Range("rateselection").Value
    ElseIf override = 2 Then
      If Range("prempmt").Value = 2 Then
         PCresult = Range("Cperiod").Value
        LPresult = Range("Premium").Value
        PayOption = Range("Option").Value
        
        If PayOption = 4 Then
            If LPresult > premiumlimit Or PCresult < 60 Then
                k = 1
              
            Else
              
                k = 3
            End If
        Else
            If LPresult > premiumlimit Then
                k = 1
            Else
                k = 3
            End If
                    
              
        End If
      ElseIf Range("prempmt").Value = 1 Then
        'Solve using LPcurve
        Range("rateselection").Value = 3
        LPresult = Range("Premium").Value
        PCresult = Range("Cperiod").Value
        PayOption = Range("Option").Value
        Application.Calculate
        If PayOption = 4 Then
            If LPresult > premiumlimit Or PCresult < 60 Then
                k = 1
              
            Else
              
                k = 3
            End If
        Else
            If LPresult > premiumlimit Then
                k = 1
            Else
                k = 3
            End If
                    
              
        End If
        End If
    End If
    
    'Solve using selected curve
    Range("rateselection").Value = k
    If k = 1 Then
       For x = 1 To 3
        k = Range("spread").Value
        Range("spread").Value = k - Range("diff").Value
       Next x
    ElseIf k = 2 Then
       'Automatically Solves
    ElseIf k = 3 Then
       'Automatically Solves
    End If
       
       'Acquisition Expense
     'If Range("Premium") >= 98650 And Range("Premium") < 100000 Then
     'Range("acqexp").Value = 1350 - 1250 * ((100000 - Range("Premium").Value) / 1350)
     'ElseIf Range("Premium") >= 100000 Then
     'Range("acqexp").Value = 1350
     
     'End If
     'If Range("option").Value = 4 Then
     'Range("acqexp").Value = 100
     
     'End If
      
      
      
      
    End Sub

Sub premiumpayment()

    If Sheet11.Range("prempmt").Value = 1 Then
    Sheet4.SolvePrem.Value = True
    Sheet4.Range("inputpay").Value = Sheet13.Range("enter").Value
    Else
    Sheet4.SolvePaym.Value = True
    Sheet4.Range("inputprem").Value = Sheet13.Range("enter").Value
    End If

End Sub
Sub VerifyInputs(feedback)

    minagelife = Range("minagelife").Value
    MaxAgeLife = Range("maxagelife").Value
    minagepc = Range("minagepc").Value
    MaxAgePC = Range("maxagepc").Value
    maxpremium = Range("maxpremium").Value
    minpc = Range("minpc").Value
    maxpc = Range("maxpc").Value
   
    feedback = True
    
If Range("datecheck").Value < 1 Then
Style = vbOKCancel + vbDefaultButton2
Message = "Interest rates are not valid" & Chr(13) & "Press OK to Update Rates." & Chr(13) & "Press Cancel to Exit."
response = MsgBox(Message, Style, "Interest Rates Not Valid.")
  If response = vbOK Then
  Load RatePassword
  RatePassword.Show
  End If
Else
    
    
    If Sheet11.Range("prempmt").Value = 1 Then
    Sheet4.Range("inputpay").Value = Sheet13.Range("enter").Value
    Else
    Sheet4.Range("inputprem").Value = Sheet13.Range("enter").Value
    End If

    'Premium Limits
    If Range("Premium").Value > maxpremium And Range("prempmt").Value = 2 And Sheet24.Range("C3").Value = True Then
        response = MsgBox("Premium must be less than $1,000,000.", vbExclamation)
        feedback = False
    ElseIf Range("Premium").Value > maxpremium And Range("prempmt").Value = 2 Then
        response = MsgBox("Premium must be less than $5,000,000.", vbExclamation)
        feedback = False
    
    
    'Primary Annuitant's Info
    ElseIf Range("name1").Value = 0 Then
    response = MsgBox("Enter Annuitant's Name", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 4 And Range("Ann1Age").Value > MaxAgePC Or Range("Ann1Age") < minagepc Then
    response = MsgBox("Annuitant's age must be between 0 and 95", vbExclamation)
    feedback = False
    ElseIf Range("option").Value < 4 And (Range("Ann1Age").Value > MaxAgeLife Or Range("Ann1Age") < minagelife) Then
    response = MsgBox("Annuitant's age must be between 5 and 85", vbExclamation)
    feedback = False
    ElseIf Range("option").Value > 4 And (Range("Ann1Age").Value > MaxAgeLife Or Range("Ann1Age") < minagelife) Then
    response = MsgBox("Annuitant's age must be between 5 and 85", vbExclamation)
    feedback = False
    
    'Joint Annuitant's Info
    ElseIf Range("option").Value > 4 And Range("name2").Value = 0 Then
    response = MsgBox("Enter Joint Annuitant's Name", vbExclamation)
    feedback = False
    ElseIf Range("option").Value > 4 And (Range("Ann2Age").Value > MaxAgeLife Or Range("Ann2Age").Value < minagelife) Then
    response = MsgBox("Joint Annuitant's age must be between 5 and 85", vbExclamation)
    feedback = False
    ElseIf Range("option").Value > 4 And Range("secondsex").Value = 3 Then
    response = MsgBox("Joint Annuitant's Sex Not Selected.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value < 5 And Range("name2").Value = 1 Then
    response = MsgBox("Delete Joint Annuitant's Name", vbExclamation)
    feedback = False
    ElseIf Range("option").Value < 5 And Range("Ann2Age").Value > 0 Then
    response = MsgBox("Delete Joint Annuitant's age", vbExclamation)
    feedback = False
    ElseIf Range("option").Value < 5 And Range("secondsex").Value < 3 Then
    response = MsgBox("Select 'None' for Joint Annuitant's Sex.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value > 4 And (Range("jpercent").Value > 1 Or Range("jpercent").Value < 0) Then
    response = MsgBox("Joint Percent must be between 0 and 100%.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 5 And Not (Range("jpercent").Value = 1) Then
    response = MsgBox("Joint Percent must be 100%.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 8 And Not (Range("jpercent").Value = 1) Then
    response = MsgBox("Joint Percent must be 100%.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 6 And (Range("jpercent").Value = 1 Or Range("jpercent").Value = 0) Then
    response = MsgBox("Joint Percent must be greater than 0% and less than 100%.", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 7 And (Range("jpercent").Value = 1 Or Range("jpercent").Value = 0) Then
    response = MsgBox("Joint Percent must be greater than 0% and less than 100%.", vbExclamation)
    feedback = False
    
    
    
    'Months until first payment
    ElseIf Range("deferral").Value > 13 Then
    response = MsgBox("Deferral period must be 13 months or less", vbExclamation)
    feedback = False
    
    'Certain Period
    ElseIf Range("option").Value = 2 And Range("certperiod").Value > maxpc Then
    response = MsgBox("Certain period must be less than 240 months", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 4 And Range("certperiod").Value > maxpc Then
    response = MsgBox("Certain period must be less than 240 months", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 8 And Range("certperiod").Value > maxpc Then
    response = MsgBox("Certain period must be less than 240 months", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 2 And Range("certperiod").Value < minpc Then
    response = MsgBox("Certain period must be greater than 60 months", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 4 And Range("certperiod").Value < minpc And Not (Range("tilrunsout")) Then
    response = MsgBox("Certain period must be greater than 60 months", vbExclamation)
    feedback = False
    ElseIf Range("option").Value = 8 And Range("certperiod").Value < minpc And Not (Range("tilrunsout")) Then
    response = MsgBox("Certain period must be greater than 60 months", vbExclamation)
    feedback = False
    
    'Cost Basis
    ElseIf Range("ccTaxStatus").Value = 1 And Range("cblink").Value > 0 Then
    response = MsgBox("Cost Basis is not available for Qualified Annuities", vbExclamation)
    feedback = False
    
    
    'Lump Sum
    ElseIf (Not Range("option").Value = 4) And Range("lumpsum").Value > 0 Then
    response = MsgBox("Lump sum available only for Period Certain", vbExclamation)
    Worksheets("user").CheckBox1.Value = False
    feedback = False
    
    'IRR
    ElseIf (Not Range("option").Value = 4) And Range("IRRlink").Value = 1 Then
    response = MsgBox("IRR available only for Period Certain", vbExclamation)
    feedback = False
        
    'Cost of living adjustment
    'ElseIf Not (Range("COLA").Value = 0) Then
    'response = MsgBox("Cost of Living Adjustment is not available", vbExclamation)
    'ElseIf Range("cblink").Value > 0 And Range("COLA").Value > 0 Then
    'response = MsgBox("Cost Basis is not available with the Cost of Living Adjustment feature.", vbExclamation)
    'Range("cblink").Value = 0
    'Worksheets("user").CheckBox1.Value = False
    'ElseIf Range("option").Value = 3 And Range("COLA").Value > 0 Then
    'response = MsgBox("Cost of Living Adjustment is not available with Life with Period Certain.", vbExclamation)
    'Range("COLA").Value = 0
    Else
    End If
End If


End Sub

Sub UserSolve(feedback)

    printable = feedback
    
    Call VerifyInputs(feedback)
    If feedback = False Then
        Exit Sub
    End If
    
    'Begin Solving
    printable = True
    If Range("tilrunsout").Value Then
        Call IncomeOfFixedAmount(feedback)
        printable = feedback
        If Range("Cperiod").Value < Range("minpc").Value Then
            response = MsgBox("Resulting Certain Period is less than 60 months.", vbExclamation)
            printable = False
        End If
        If Range("Cperiod").Value > Range("maxpc").Value Then
            response = MsgBox("Resulting Certain Period is more than 240 months.", vbExclamation)
            printable = False
        End If
    Else
        Solve
    End If
    
    If Range("option").Value = 3 Then
        Call InstallmentRefund(feedback)
        printable = feedback
        If Range("Cperiod").Value < Range("minpc").Value Then
            response = MsgBox("Resulting Certain Period is less than 60 months.", vbExclamation)
            printable = False
        End If
        If Range("Cperiod").Value > Range("maxpc").Value Then
            response = MsgBox("Resulting Certain Period is more than 240 months.", vbExclamation)
            printable = False
        End If
    Else
        Solve
    End If
   
End Sub

Attribute VB_Name = "Module5"
Sub RateSetting()

    
     
    For x = 1 To 21
     Range("primaryage").Value = Range("ageinputs").Cells(x, 1).Value
    For y = 1 To 2
    Range("primarysex").Value = Range("y").Cells(y, 1).Value
    Solve
    Range("rates").Cells(x, y).Value = Range("Outputpay").Value
    Range("D").Cells(x, y).Value = Range("ld").Value
    Range("T").Cells(x, y).Value = Range("Treasury").Value
    Next y
    Next x
    
    
End Sub
Attribute VB_Name = "Module6"
Sub PrintOuput()
Attribute PrintOuput.VB_Description = "Macro recorded 8/18/99 by Jason Rabineau"
Attribute PrintOuput.VB_ProcData.VB_Invoke_Func = " \n14"

    Sheets("Inputs").Select
    Range("A1").Select
    Range("inputprem").Value = 100000
    
    For x = 1 To 7
     Range("RSpayments").Cells(x, 1).Value = 0
    Next x
    
    For x = 1 To 7
     Range("Type").Value = Range("RSinputs").Cells(x, 1).Value
     Range("Certperiod").Value = Range("RSinputs").Cells(x, 2).Value
     Range("Ann1Sex").Value = Range("RSinputs").Cells(x, 3).Value
     Range("Ann1Age").Value = Range("RSinputs").Cells(x, 4).Value
     Range("InvestSpread").Value = Range("RSinputs").Cells(x, 6).Value
     Solve
     Range("RSpayments").Cells(x, 1).Value = Range("Outputpay").Value
     ActiveWindow.SelectedSheets.PrintOut Copies:=1
    Next x
    Range("updated").Value = Range("CurrDate").Value
    
End Sub
Attribute VB_Name = "Module7"
Sub IncomeOfFixedAmount(feedback)
    Premium = Range("enter").Value
    fixedpayment = Range("FixedPayment").Value
    pmtperyear = Range("PPyear").Value
    feedback = True
    
    If Sheet11.Range("prempmt").Value = 1 Then
    Sheet4.Range("inputpay").Value = Sheet13.Range("enter").Value
    Else
    Sheet4.Range("inputprem").Value = Sheet13.Range("enter").Value
    End If
    
    
    'solve for period
    Range("option").Value = 4
    
    guess = Round(Premium / fixedpayment, 0)
    newguess = guess * 12 / pmtperyear - 12 / pmtperyear
    
    Range("lumpsum").Value = 0
    counter = 0
    Do
        Range("cperiod").Value = newguess
        Solve
        Payment = Range("PaymentResult").Value
        If Payment > fixedpayment Then
            oldguess = newguess
            newguess = newguess + 12 / pmtperyear
        End If
        counter = counter + 1
    Loop Until Payment < fixedpayment Or counter = 100
    Period = oldguess
    'Check for Error
    If counter = 100 Then
        response = MsgBox("Solution could not be found.  Please verify inputs.", vbExclamation)
        feedback = False
    End If
    
    'solve for lumpsum
    Max = fixedpayment
    Min = 0
    newguess = (Max + Min) / 2
    counter = 0
    Do
        Range("lumpsum").Value = newguess
        Solve
        diff = Round(Range("lumpDiff").Value, 2)
        If diff > 0 Then
            'lumpsum too small
            k = newguess
            newguess = (newguess + Max) / 2
            Min = k
        ElseIf diff < 0 Then
            'lumpsum is too large
            k = newguess
            newguess = (newguess + Min) / 2
            Max = k
        End If
        counter = counter + 1
    Loop Until diff = 0 Or counter = 100
    'Check for Error
    If counter = 100 Then
        response = MsgBox("Solution could not be found.  Please verify inputs.", vbExclamation)
        feedback = False
    End If
    lumpsum = k
    
End Sub
Sub InstallmentRefund(feedback)

    Premium = Range("Premium").Value
    Payment = Range("PaymentResult").Value
    pmtperyear = Range("PPyear").Value
    feedback = True
    
    If Sheet11.Range("prempmt").Value = 1 Then
    Sheet4.Range("inputpay").Value = Sheet13.Range("enter").Value
    Else
    Sheet4.Range("inputprem").Value = Sheet13.Range("enter").Value
    End If
    
    
    'solve for period
    Range("option").Value = 3
    
    guess = Round(Premium / Payment, 0)
    newguess = guess * 12 / pmtperyear - 12 / pmtperyear
    
    counter = 0
    Do
        Range("cperiod").Value = newguess
        Solve
        If Range("IRcheck").Value < 0 Then
            oldguess = newguess
            newguess = newguess + 12 / pmtperyear
        End If
        counter = counter + 1
    Loop Until Range("IRcheck").Value > 0 Or counter = 100

    
    'Check for Error
    If counter = 100 Then
        response = MsgBox("Solution could not be found.  Please verify inputs.", vbExclamation)
        feedback = False
    End If

    
End Sub

Attribute VB_Name = "Module8"
Attribute VB_Name = "Module9"
Sub GetNewRates()

    '   Turn off Screen Updating
    Application.ScreenUpdating = True 'False
    
    ' Define Variables.
    Dim Opt As Integer
    Opt = Range("option").Value
    Dim rDestination As Excel.Range
    Set rDestination = Range("LPCurve")
    Dim rOriginal As Excel.Range
    Set rOriginal = Range("OldD")
    Dim rNew As Excel.Range
    Set rNew = Range("NewD")
    
    ' Select the default yield curve and paste to the Rate Update Sheet.
    rDestination.Value = Range("Default").Value
        
    'Clear Original and New ModD
    rOriginal.ClearContents
    rNew.ClearContents
    
    ' Life + IR Set to 0
    If Opt = 3 And Range("Cperiod").Value <> 0 Then
        Range("Cperiod").Value = 0
    Else
    End If
    
    ' Solve from inputs (UserSolve macro).
    Call UserSolve(feedback)
    
    'Input Original ModD to Rate Update worksheet.
    rOriginal.Value = Range("Duration!K11").Value
    
    ' Grab rates from Expanded SPIA table and input to Rate Update worksheet.
    If Opt < 4 And rOriginal.Value < 6 Then
        rDestination.Value = Range("Single1").Value
        Range("BandName").Value = "Band: Single 1"
    ElseIf Opt < 4 And 6 <= rOriginal.Value And rOriginal.Value < 11 Then
        rDestination.Value = Range("Single2").Value
        Range("BandName").Value = "Band: Single 2"
    ElseIf Opt < 4 And 11 <= rOriginal.Value And rOriginal.Value < 16 Then
        rDestination.Value = Range("Single3").Value
        Range("BandName").Value = "Band: Single 3"
    ElseIf Opt < 4 And 16 <= rOriginal.Value Then
        rDestination.Value = Range("Single4").Value
        Range("BandName").Value = "Band: Single 4"
    ElseIf Opt > 4 And rOriginal.Value < 6 Then
        rDestination.Value = Range("Joint1").Value
        Range("BandName").Value = "Band: Joint 1"
    ElseIf Opt > 4 And 6 <= rOriginal.Value And rOriginal.Value < 11 Then
        rDestination.Value = Range("Joint2").Value
        Range("BandName").Value = "Band: Joint 2"
    ElseIf Opt > 4 And 11 <= rOriginal.Value And rOriginal.Value < 16 Then
        rDestination.Value = Range("Joint3").Value
        Range("BandName").Value = "Band: Joint 3"
    ElseIf Opt > 4 And 16 <= rOriginal.Value Then
        rDestination.Value = Range("Joint4").Value
        Range("BandName").Value = "Band: Joint 4"
    ElseIf Opt = 4 And Range("Cperiod").Value < 72 Then
        rDestination.Value = Range("PC1").Value
        Range("BandName").Value = "Band: Period Certain 1"
    ElseIf Opt = 4 And 72 <= Range("Cperiod").Value And Range("Cperiod").Value < 132 Then
        rDestination.Value = Range("PC2").Value
        Range("BandName").Value = "Band: Period Certain 2"
    ElseIf Opt = 4 And 132 <= Range("Cperiod").Value And Range("Cperiod").Value < 192 Then
        rDestination.Value = Range("PC3").Value
        Range("BandName").Value = "Band: Period Certain 3"
    ElseIf Opt = 4 And 192 <= Range("Cperiod").Value Then
        rDestination.Value = Range("PC4").Value
        Range("BandName").Value = "Band: Period Certain 4"
    Else
    End If
    
    'Solve again with new yield curve.
    If Opt = 3 Then
        Range("Cperiod").Value = 0
        Call UserSolve(feedback)
    Else
    Application.Calculate
    End If
    
    ' Input new ModD value to Rate Update worksheet.
    rNew.Value = Range("Duration!K11").Value
    
    ' End on worksheet designated by input
    Selection
    Application.CutCopyMode = False



End Sub

Sub GetNewRatesPrint()

    ' Run GetNewRates Macro
    Call GetNewRates
    
    'Print
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True


End Sub

Attribute VB_Name = "RatePassword"
Attribute VB_Base = "0{6EE363EC-A9C7-4A8C-AADE-FBF6EF0A7E80}{FF450870-FDB3-4072-A545-389C8AA372D8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub TextBox1_Change()

End Sub

Public Sub Passwordtext_Change()
    pword = Passwordtext.Text
    If pword = "itsmybag" Then
        RatePassword.Hide
        showsheets
        Module3.undimmacro
        Module3.undimsheet
    End If
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox6, 66, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox5, 65, 1, MSForms, CheckBox"
Attribute VB_Control = "ComboBox2, 64, 2, MSForms, ComboBox"
Attribute VB_Control = "ComboBox1, 63, 3, MSForms, ComboBox"
Attribute VB_Control = "CheckBox4, 62, 4, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 59, 5, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 48, 6, MSForms, CheckBox"
Attribute VB_Control = "CheckBox1, 47, 7, MSForms, CheckBox"
Sub CheckBox1_Click()
  k = Worksheets("user").Range("COLA").Value
  j = Worksheets("Premium Tax").Range("ccTaxStatus").Value
  
  If CheckBox1.Value = False Then
  Worksheets("user").Range("cblink").Value = 0
  End If
  
  If CheckBox1.Value = True Then
    If k > 0 Then
      response = MsgBox("Cost Basis is not available with the Cost of Living Adjustment feature.", vbExclamation)
      CheckBox1.Value = False
      Worksheets("user").Range("cblink").Value = 0
      
    ElseIf j = 1 Then
      response = MsgBox("Cost Basis is not available for Qualified Annuities.", vbExclamation)
      CheckBox1.Value = False
    
    End If
  End If
End Sub

Sub CheckBox2_Click()
  k = Worksheets("IllList").Range("Option").Value
  
  If (k = 5) Or (k = 6) Or (k = 7) Or (k = 8) Then
    ActiveSheet.unprotect
    Range("E2:F2").Interior.ColorIndex = 6
    Range("E3:F7").Interior.ColorIndex = 2
    Range("F3").Select
    ActiveSheet.Protect
  Else
    ActiveSheet.unprotect
    Range("E2:F2").Interior.ColorIndex = 48
    Range("E3:F7").Interior.ColorIndex = 48
    Range("C12").Select
    ActiveSheet.Protect
  End If
  
  If CheckBox2.Value = True Then
    If Not (k = 4) Then
      response = MsgBox("IRR is only available for Period Certain.", vbExclamation)
      CheckBox2.Value = False
    End If
  End If
  
  If CheckBox3.Value = True Then
    If Not (k = 4) Then
      response = MsgBox("Payment Until Money Runs Out is only available for Period Certain.", vbExclamation)
      CheckBox3.Value = False
    End If
  End If
  
End Sub

Sub CheckBox3_Click()

  k = Worksheets("IllList").Range("Option").Value
  If CheckBox3.Value = True Then
    If Not (k = 4) Then
      response = MsgBox("Payment Until Money Runs Out is only available for Period Certain.", vbExclamation)
      CheckBox3.Value = False
    End If
  End If
End Sub

Sub CheckBox6_Click()
    If CheckBox6.Value = False Then
    Range("taxbracket").Value = 0
    End If
    
End Sub
'this was used for USPIA's
'Sub CheckBox7_Click()
'If CheckBox7.Value = False Then
'Worksheets("Lists").Range("primarycredit").Value = 1
  'End If
'End Sub

'Private Sub CheckBox8_Click()
'If CheckBox8.Value = False Then
'Worksheets("Lists").Range("seccredit").Value = 1
  'End If
'End Sub

Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox11, 11, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox10, 10, 1, MSForms, CheckBox"
Attribute VB_Control = "CheckBox9, 9, 2, MSForms, CheckBox"
Attribute VB_Control = "CheckBox8, 8, 3, MSForms, CheckBox"
Attribute VB_Control = "CheckBox7, 7, 4, MSForms, CheckBox"
Attribute VB_Control = "CheckBox6, 6, 5, MSForms, CheckBox"
Attribute VB_Control = "CheckBox5, 5, 6, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 4, 7, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 3, 8, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 2, 9, MSForms, CheckBox"
Attribute VB_Control = "CheckBox1, 1, 10, MSForms, CheckBox"
Sub CheckBox1_Click()

    If Worksheets("Edits").CheckBox1.Value = False Then
    Worksheets("User").ComboBox1.Visible = False
    Worksheets("User").ComboBox1.Value = "NON-BINDING"
    ElseIf Worksheets("Edits").CheckBox1.Value = True Then
    Worksheets("User").ComboBox1.Visible = True
    End If
    
End Sub

Sub CheckBox10_Click()
    
    Worksheets("User").Select
    ActiveSheet.unprotect
    If Worksheets("Edits").CheckBox10.Value = True Then
    Worksheets("Edits").CheckBox1.Value = False
    Worksheets("Edits").CheckBox2.Value = False
    Worksheets("Edits").CheckBox3.Value = False
    Worksheets("Edits").CheckBox4.Value = True
    Worksheets("Edits").CheckBox5.Value = True
    Worksheets("Edits").CheckBox6.Value = True
    Worksheets("Edits").CheckBox7.Value = False
    Worksheets("Edits").CheckBox9.Value = True
    Module1.auto_open
    Module2.IMRVersionhide
    Worksheets("User").ComboBox2.Value = "Settlement"
    Worksheets("User").ComboBox1.Value = "Binding"
    Worksheets("user").Range("F18").Value = True
    Worksheets("user").Range("lumpsum").Select
    Selection.Font.ColorIndex = 48
    Selection.Locked = True
    Worksheets("user").Range("COLA").Select
    Selection.Font.ColorIndex = 48
    Selection.Locked = True
    Worksheets("user").Range("primaryann").Select
    Else
    Worksheets("Edits").CheckBox1.Value = True
    Worksheets("Edits").CheckBox2.Value = True
    Worksheets("Edits").CheckBox3.Value = True
    Worksheets("Edits").CheckBox4.Value = False
    Worksheets("Edits").CheckBox5.Value = False
    Worksheets("Edits").CheckBox6.Value = False
    Worksheets("Edits").CheckBox7.Value = True
    Worksheets("Edits").CheckBox9.Value = False
    Module3.undimmacro
    Module3.undimsheet
    Module2.showsheets
    Module2.IMRVersionunhide
    Worksheets("user").Range("F18").Value = False
    Worksheets("user").Range("lumpsum").Select
    Selection.Font.ColorIndex = 5
    Selection.Locked = False
    Worksheets("user").Range("COLA").Select
    Selection.Font.ColorIndex = 5
    Selection.Locked = False
    Worksheets("user").Range("primaryann").Select
    End If
    ActiveSheet.Protect
    
End Sub

Private Sub CheckBox11_Click()

End Sub

Sub CheckBox2_Click()

    If Worksheets("Edits").CheckBox2.Value = False Then
    Worksheets("User").ComboBox2.Visible = False
    Worksheets("User").ComboBox2.Value = "SPIA"
    ElseIf Worksheets("Edits").CheckBox2.Value = True Then
    Worksheets("User").ComboBox2.Visible = True
    End If

End Sub

Sub CheckBox3_Click()

    If Worksheets("Edits").CheckBox3.Value = False Then
    Worksheets("User").CheckBox4.Visible = False
    Worksheets("User").CheckBox4.Value = False
    ElseIf Worksheets("Edits").CheckBox3.Value = True Then
    Worksheets("User").CheckBox4.Visible = True
    End If

End Sub

Sub CheckBox7_Click()
    
    If Worksheets("Edits").CheckBox7.Value = False Then
    Worksheets("User").CheckBox5.Visible = False
    Worksheets("User").CheckBox5.Value = False
    ElseIf Worksheets("Edits").CheckBox7.Value = True Then
    Worksheets("User").CheckBox5.Visible = True
    End If
End Sub

Sub CheckBox8_Click()

    Worksheets("User").Select
    ActiveSheet.unprotect
    If Worksheets("Edits").CheckBox8.Value = True Then
    Worksheets("Edits").CheckBox1.Value = False
    Worksheets("Edits").CheckBox2.Value = False
    Worksheets("Edits").CheckBox3.Value = False
    Worksheets("Edits").CheckBox4.Value = True
    Worksheets("Edits").CheckBox5.Value = True
    Worksheets("Edits").CheckBox6.Value = True
    Worksheets("Edits").CheckBox7.Value = False
    Worksheets("Edits").CheckBox9.Value = True
    Module1.auto_open
    Module2.IMRVersionhide
    Worksheets("User").ComboBox2.Value = "SPIA"
    Worksheets("User").ComboBox1.Value = "NON-BINDING"
    'Worksheets("user").Range("lumpsum").Select
    'Selection.Font.ColorIndex = 48
    'Selection.Locked = True
    Worksheets("user").Range("primaryann").Select
    Else
    Worksheets("Edits").CheckBox1.Value = True
    Worksheets("Edits").CheckBox2.Value = True
    Worksheets("Edits").CheckBox3.Value = True
    Worksheets("Edits").CheckBox4.Value = False
    Worksheets("Edits").CheckBox5.Value = False
    Worksheets("Edits").CheckBox6.Value = False
    Worksheets("Edits").CheckBox7.Value = True
    Worksheets("Edits").CheckBox9.Value = False
    Module3.undimmacro
    Module3.undimsheet
    Module2.showsheets
    Module2.IMRVersionunhide
    'Worksheets("user").Range("lumpsum").Select
    'Selection.Font.ColorIndex = 5
    'Selection.Locked = False
    Worksheets("user").Range("primaryann").Select
    End If
    ActiveSheet.Protect
    

End Sub
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OptionButton2, 15, 0, MSForms, OptionButton"
Attribute VB_Control = "OptionButton1, 14, 1, MSForms, OptionButton"
Public Sub SolvePaym_Click()
    Range("Inputprem").Value = Range("Storeprem").Value
    Range("Storepay").Value = Range("inputpay").Value
    Range("Inputpay").Value = ""
End Sub

Public Sub SolvePrem_Click()
    Range("Inputpay").Value = Range("Storepay").Value
    Range("Storeprem").Value = Range("inputprem").Value
    Range("Inputprem").Value = ""
End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
