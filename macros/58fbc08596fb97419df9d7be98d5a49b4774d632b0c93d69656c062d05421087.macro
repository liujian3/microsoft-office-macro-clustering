Attribute VB_Name = "CreatingNewDocs"
Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|]\|fffd||fffd||fffd||fffd|.docx"
Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|]\|fffd||fffd||fffd|.docx"
Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|]\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|.docx"
Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|]\|fffd||fffd||fffd||fffd||fffd||fffd|.xlsx"
'Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Columns.Count
Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = ".docx"


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Columns.Count
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = NewFolderName & Application.PathSeparator
    Dim row As Range, pi As New ProgressIndicator
    
    'r = Cells(Rows.Count, "A").End(xlUp).row: rc = r - 2
    rall = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Rows.Count
    rc = 0
    'If rc < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
    If Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Rows.Count < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
       For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Rows
        With row
        If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
          rc = rc + 1
        End If
        End With
    Next row
    
    pi.Show "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|": pi.ShowPercents = True: s1 = 10: s2 = 90: p = s1: a = (s2 - s1) / rc
    pi.StartNewAction , s1, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word"

    ' Dim WA As Word.Application, WD As Word.Document: Set WA = New Word.Application    ' c |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    Dim WA As Object, WD As Object: Set WA = CreateObject("Word.Application")    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    sform = 0
    

    
    
   'coln = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column
   'Msg = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column
   ' For Each row In ActiveSheet.Rows("3:" & r)
   Dim rF As Object
    For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Rows
        With row
       ' If IsEmpty(.Cells(12)) Then
       If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
           ' |fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd||fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd|.]").Column))
           ' |fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) & "-" & [|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|3] & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd|").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd|").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column))
            |fffd||fffd||fffd| = Replace_symbols(Trim$(.Cells(Range("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|").Column)))
            Filename = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & |fffd||fffd||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            pi.StartNewAction p, p + a / 3, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", |fffd||fffd||fffd|
            Set WD = WA.Documents.Add(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|): DoEvents

            pi.StartNewAction p + a / 3, p + a * 2 / 3, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|
            On Error Resume Next
            For i = 1 To |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                FindText = Cells(2, i): ReplaceText = Trim$(.Cells(i))

                ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                'WA.Selection.Find.Execute FindText, , , , , , , wdFindContinue, False, ReplaceText, True

                pi.line3 = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & FindText
                'WA.Visible = True
                
                If Not FindText = "" Then
                'Set rF = WD.Bookmarks.Item(FindText)
              
                    If Not WD.Bookmarks.Item(FindText) Is Nothing Then
                                       
                    WD.Bookmarks.Item(FindText).Range.Text = ReplaceText
                    End If
                
                End If
                DoEvents
            Next i
            pi.StartNewAction p + a * 2 / 3, p + a, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|, " "
            WD.SaveAs Filename: WD.Close False: DoEvents
            p = p + a
            sform = sform + 1
        End If
        End With
    Next row

    pi.StartNewAction s2, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word", " ", " "
    WA.Quit False: pi.Hide
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & sform & " |fffd||fffd| " & rall & ". |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|" & vbNewLine & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    MsgBox Msg, vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Columns.Count
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = NewFolderNameAOK & Application.PathSeparator
    Dim row As Range, pi As New ProgressIndicator
    'r = Cells(Rows.Count, "A").End(xlUp).row: rc = r - 2
    rall = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Rows.Count
    rc = 0
    'If rc < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
    If Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Rows.Count < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
       For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Rows
        With row
        If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
          rc = rc + 1
        End If
        End With
    Next row
    
    If Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Rows.Count < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub

    pi.Show "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|": pi.ShowPercents = True: s1 = 10: s2 = 90: p = s1: a = (s2 - s1) / rc
    pi.StartNewAction , s1, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word"

    ' Dim WA As Word.Application, WD As Word.Document: Set WA = New Word.Application    ' c |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    Dim WA As Object, WD As Object: Set WA = CreateObject("Word.Application")    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    sform = 0
   'coln = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column
   'Msg = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column
   ' For Each row In ActiveSheet.Rows("3:" & r)
   
    For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|14").Rows
        With row
       ' If IsEmpty(.Cells(12)) Then
       If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
           ' |fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd||fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd|.]").Column))
           ' |fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) & " |fffd||fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd|").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd|").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column))
            |fffd||fffd||fffd| = Replace_symbols(Trim$(.Cells(Range("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)))
            
            Filename = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & |fffd||fffd||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            pi.StartNewAction p, p + a / 3, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", |fffd||fffd||fffd|
            Set WD = WA.Documents.Add(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|): DoEvents

            pi.StartNewAction p + a / 3, p + a * 2 / 3, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|
            On Error Resume Next
            For i = 1 To |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                FindText = Cells(2, i): ReplaceText = Trim$(.Cells(i))

                ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                'WA.Selection.Find.Execute FindText, , , , , , , wdFindContinue, False, ReplaceText, True

                pi.line3 = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & FindText
                
                If Not FindText = "" Then
                'Set rF = WD.Bookmarks.Item(FindText)
              
                    If Not WD.Bookmarks.Item(FindText) Is Nothing Then
                                       
                    WD.Bookmarks.Item(FindText).Range.Text = ReplaceText
                    End If
                
                End If
                DoEvents
            Next i
            pi.StartNewAction p + a * 2 / 3, p + a, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|, " "
            WD.SaveAs Filename: WD.Close False: DoEvents
            p = p + a
            sform = sform + 1
        End If
        End With
    Next row

    pi.StartNewAction s2, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word", " ", " "
    WA.Quit False: pi.Hide
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & sform & " |fffd||fffd| " & rall & ". |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|" & vbNewLine & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    MsgBox Msg, vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Columns.Count
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = NewFolderNameID & Application.PathSeparator
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    Dim row As Range, pi As New ProgressIndicator
    'r = Cells(Rows.Count, "A").End(xlUp).row: rc = r - 2
    rc = 0
    rall = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows.Count
    'If rc < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
    If Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows.Count < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub
       For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows
        With row
        If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
          rc = rc + 1
        End If
        End With
    Next row
    If Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows.Count < 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical: Exit Sub

    pi.Show "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": pi.ShowPercents = True: s1 = 10: s2 = 90: p = s1: a = (s2 - s1) / rc
    pi.StartNewAction , s1, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word"

    ' Dim WA As Word.Application, WD As Word.Document: Set WA = New Word.Application    ' c |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    Dim WA As Object, WD As Object: Set WA = CreateObject("Word.Application")    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Word
    sform = 0
   'coln = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column
   'Msg = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column
   ' For Each row In ActiveSheet.Rows("3:" & r)
   Application.ScreenUpdating = False
    For Each row In Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Rows
        With row
       ' If IsEmpty(.Cells(12)) Then
       If IsEmpty(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) Then
           ' |fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column)) & " |fffd||fffd|" & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|]").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd|.]").Column))
            '|fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column)) & " " & Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd|").Column))
             |fffd||fffd||fffd| = Replace_symbols(Trim$(.Cells(Range("|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|").Column)))
            'MsgBox |fffd||fffd||fffd|
            Filename = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "|fffd||fffd||fffd||fffd||fffd| " & |fffd||fffd||fffd| & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            FilenameXL = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "|fffd||fffd||fffd||fffd||fffd||fffd| " & |fffd||fffd||fffd| & ".xlsx"
            |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column))
            |fffd||fffd||fffd||fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Column))
            |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd||fffd|").Column))
     '''''''''''''''''''''''''
   'NomerID = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd|").Column))
    'Msg = NomerID
    'MsgBox NomerID
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = Trim$(.Cells(Range("|fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd|").Column))
    'MsgBox Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value
    Set BASE = ActiveWorkbook

    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").AutoFilter Field:=5, Criteria1:="<>"
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[[|fffd| |fffd|/|fffd|]:[|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|]]").Copy
    Workbooks.Add Template:=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("|fffd||fffd||fffd||fffd||fffd||fffd|").Value = |fffd||fffd||fffd||fffd||fffd||fffd|
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("A7").Select
    ''ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.SaveAs Filename:=FilenameXL _
        , FileFormat:=xlOpenXMLWorkbook, Password:="", WriteResPassword:="", ReadOnlyRecommended:=False _
        , CreateBackup:=False
    ActiveWorkbook.Close
    BASE.Activate
    '''''''''''''''''''''''''
            pi.StartNewAction p, p + a / 3, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", |fffd||fffd||fffd|
            Set WD = WA.Documents.Add(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|): DoEvents

            pi.StartNewAction p + a / 3, p + a * 2 / 3, "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|
            On Error Resume Next
            For i = 1 To |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                FindText = Cells(2, i): ReplaceText = Trim$(.Cells(i))

                ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                'WA.Selection.Find.Execute FindText, , , , , , , wdFindContinue, False, ReplaceText, True

                pi.line3 = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| " & FindText
                
                If Not FindText = "" Then
                'Set rF = WD.Bookmarks.Item(FindText)
              
                    If Not WD.Bookmarks.Item(FindText) Is Nothing Then
                                       
                    WD.Bookmarks.Item(FindText).Range.Text = ReplaceText
                    End If
                
                End If
                DoEvents
                        
            Next i
            pi.StartNewAction p + a * 2 / 3, p + a, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ...", |fffd||fffd||fffd|, " "
            WD.SaveAs Filename: WD.Close False: DoEvents
            p = p + a
            sform = sform + 1
        
        End If
    
        End With
    Next row

    pi.StartNewAction s2, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Microsoft Word", " ", " "
    WA.Quit False: pi.Hide
        Application.ScreenUpdating = True
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & sform & " |fffd||fffd| " & rall & ". |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|" & vbNewLine & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    MsgBox Msg, vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Function NewFolderName() As String
NewFolderName = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
If Dir(NewFolderName, vbDirectory) = "" Then MkDir NewFolderName
NewFolderName = NewFolderName & "\|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| " & Get_Now
MkDir NewFolderName
End Function
Function NewFolderNameAOK() As String
NewFolderNameAOK = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
If Dir(NewFolderNameAOK, vbDirectory) = "" Then MkDir NewFolderNameAOK
NewFolderNameAOK = NewFolderNameAOK & "\|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| " & Get_Now
MkDir NewFolderNameAOK
End Function
Function NewFolderNameID() As String

NewFolderNameID = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, "|fffd||fffd|")
If Dir(NewFolderNameID, vbDirectory) = "" Then MkDir NewFolderNameID
NewFolderNameID = NewFolderNameID & "\|fffd||fffd| |fffd||fffd| " & Get_Now
MkDir NewFolderNameID
        
End Function

Function Get_Date() As String: Get_Date = Replace(Replace(DateValue(Now), "/", "-"), ".", "-"): End Function
Function Get_Time() As String: Get_Time = Replace(TimeValue(Now), ":", "-"): End Function
Function Get_Now() As String: Get_Now = Get_Date & " |fffd| " & Get_Time: End Function


Function Replace_symbols(ByVal txt As String) As String
    St$ = "~!@/\#$%^&*=|`"""
    For i% = 1 To Len(St$)
        txt = Replace(txt, Mid(St$, i, 1), "_")
    Next
    Replace_symbols = txt
End Function
Attribute VB_Name = "F_Progress"
Attribute VB_Base = "0{F15C07B1-66CC-47AD-9291-D4C8DAAC0FE4}{D8FE8929-4E39-4F6E-AD0E-4781F14621DA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal Y As Single)
    If Button = 2 Then Unload Me
End Sub

Private Sub UserForm_Initialize()
    Me.PrBar.Caption = ""
End Sub



Attribute VB_Name = "Module1"
Option Explicit

Sub refresh_all()
'ThisWorkbook.RefreshAll
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|").PivotTables("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").PivotCache.Refresh
End Sub

Sub |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Dim x1 As Long
    x1 = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value
    [|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1].AutoFilter Field:=Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column, Criteria1:=x1, _
    Operator:=xlOr, Criteria2:=("*" & x1 & "*")
End Sub

Sub |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|()
Dim x2 As Long
    x2 = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Value
    [|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1].AutoFilter Field:=Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd||fffd||fffd|]").Column, Criteria1:=x2, _
    Operator:=xlOr, Criteria2:=("*" & x2 & "*")
End Sub

Sub |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|()
Dim x3 As Long
    x3 = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|").Value
    [|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1].AutoFilter Field:=Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1[|fffd||fffd||fffd||fffd|]").Column, Criteria1:=x3, _
    Operator:=xlOr, Criteria2:=("*" & x3 & "*")
End Sub

Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(ByRef |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Range, ByVal |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String, ByRef |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Range, Optional |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String = " ", Optional |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Boolean = False) As String
    Dim li As Long, sStr As String, avItem, avDateArr(), avRezArr(), lUBnd As Long
    If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Count > 1 Then
        avDateArr = Intersect(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Parent.UsedRange).Value
        avRezArr = Intersect(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Parent.UsedRange).Value
        If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Rows.Count = 1 Then
            avDateArr = Application.Transpose(avDateArr)
            avRezArr = Application.Transpose(avRezArr)
        End If
    Else
        ReDim avDateArr(1, 1): ReDim avRezArr(1, 1)
        avDateArr(1, 1) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value
        avRezArr(1, 1) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value
    End If
    lUBnd = UBound(avDateArr, 1)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim objRegExp As Object, objMatches As Object
    Set objRegExp = CreateObject("VBScript.RegExp")
    objRegExp.Global = False: objRegExp.Pattern = "=|<>|=>|>=|<=|=<|>|<"
    Set objMatches = objRegExp.Execute(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If objMatches.Count > 0 Then
        Dim sStrMatch As String
        sStrMatch = objMatches.Item(0)
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Replace(Replace(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, sStrMatch, "", 1, 1), Chr(34), "", 1, 2)
        Select Case sStrMatch
        Case "="
            For li = 1 To lUBnd
                If avDateArr(li, 1) = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        Case "<>"
            For li = 1 To lUBnd
                If avDateArr(li, 1) <> |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        Case ">=", "=>"
            For li = 1 To lUBnd
                If avDateArr(li, 1) >= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        Case "<=", "=<"
            For li = 1 To lUBnd
                If avDateArr(li, 1) <= |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        Case ">"
            For li = 1 To lUBnd
                If avDateArr(li, 1) > |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        Case "<"
            For li = 1 To lUBnd
                If avDateArr(li, 1) < |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                    If Trim(avRezArr(li, 1)) <> "" Then _
                       sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
                End If
            Next li
        End Select
    Else    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        For li = 1 To lUBnd
            If avDateArr(li, 1) Like |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
                If Trim(avRezArr(li, 1)) <> "" Then _
                   sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & avRezArr(li, 1)
            End If
        Next li
    End If
    
    If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
        Dim oDict As Object, sTmpStr
        Set oDict = CreateObject("Scripting.Dictionary")
        sTmpStr = Split(sStr, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        On Error Resume Next
        For li = LBound(sTmpStr) To UBound(sTmpStr)
            oDict.Add sTmpStr(li), sTmpStr(li)
        Next li
        sStr = ""
        sTmpStr = oDict.keys
        For li = LBound(sTmpStr) To UBound(sTmpStr)
            sStr = sStr & IIf(sStr <> "", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "") & sTmpStr(li)
        Next li
    End If
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = sStr
End Function

Public Function Substrings(txt, Delimiter, n) As String
Dim x As Variant
    x = Split(txt, Delimiter)
    If n > 0 And n - 1 <= UBound(x) Then
        Substrings = x(n - 1)
    Else
        Substrings = ""
    End If
End Function
Attribute VB_Name = "ProgressIndicator"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public FP As New F_Progress

Public CurActionIndex As Single, CurActionCount As Single
Public ShowPercents As Boolean
Const ProgressBar_Default_Width = 300
Private PrS As Integer, PrE As Integer

Private Sub Class_Initialize()
    Set FP = New F_Progress: ShowPercents = False
    PrS = 0: PrE = 100: Set_ProgressBar 0: FP.PrBar.Caption = ""
End Sub

Sub Show(ByVal Caption As String)
    FP.Caption = Caption: 'ShowCloseButton FP, True
    FP.Tag = Caption: FP.Show: FP.Repaint: DoEvents
End Sub

Sub Hide()
    Unload FP
End Sub

Sub Move(ByVal Position As Integer)
    If Abs(Position) > 3 Then Exit Sub
    FP.Top = FP.Top + FP.Height * Position
End Sub

Public Property Let line1(ByVal NewValue As String): FP.L1.Caption = NewValue: End Property
Public Property Let line2(ByVal NewValue As String): FP.L2.Caption = NewValue: End Property
Public Property Let line3(ByVal NewValue As String): FP.L3.Caption = NewValue: End Property
Public Property Let Caption(ByVal NewValue As String): FP.Caption = NewValue: End Property




' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Progress Bar
Sub CurAction(ByVal Action_Ind As Single, ByVal Actions_Count As Single, _
              Optional ByVal L1_txt As String = "", Optional ByVal L2_txt As String = "", _
              Optional ByVal L3_txt As String = "")


    If L1_txt <> "" Then FP.L1.Caption = L1_txt
    If L2_txt <> "" Then FP.L2.Caption = L2_txt
    If L3_txt <> "" Then FP.L3.Caption = L3_txt

    If CurActionCount > 0 Then
        If CurActionIndex > CurActionCount Then CurActionIndex = CurActionCount
        Percent = PrS + (PrE - PrS) * (CurActionIndex / CurActionCount)
    Else
        If Actions_Count <= 0 Then Exit Sub
        If Action_Ind > Actions_Count Then Action_Ind = Actions_Count
        Percent = PrS + (PrE - PrS) * (Action_Ind / Actions_Count)
    End If
    CurActionIndex = CurActionIndex + 1
    Set_ProgressBar Percent: DoEvents
End Sub
Sub StartNewAction(Optional ByVal Pr_Start As Integer = 0, Optional ByVal Pr_End As Integer = 100, _
                   Optional ByVal L1_txt As String = "", Optional ByVal L2_txt As String = "", Optional ByVal L3_txt As String = "")

    PrS = Pr_Start: PrE = Pr_End: CurActionIndex = 1: CurActionCount = 0
    If L1_txt <> "" Then FP.L1.Caption = L1_txt
    If L2_txt <> "" Then FP.L2.Caption = L2_txt
    If L3_txt <> "" Then FP.L3.Caption = L3_txt
    Set_ProgressBar PrS
End Sub
Sub Set_ProgressBar(ByVal Percent As Double)
    If Percent > 100 Then Percent = 100
    If Percent < 0 Then Percent = 0
    FP.PrBar.Width = Int(Percent * ProgressBar_Default_Width / 100)
    If ShowPercents Then FP.Caption = Fix(Percent) & " %    " & FP.Tag
    FP.Repaint
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Public bIgnore As Boolean



Private Sub Worksheet_Change(ByVal Target As Range)
Dim newVal, oldval, newVal2, oldval2 As String
    On Error Resume Next
    If Not Intersect(Target, Range("|fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|")) Is Nothing And Target.Cells.Count = 1 Then
        Application.EnableEvents = False
        newVal = Target
        Application.Undo
        oldval = Target
        If Len(oldval) <> 0 And oldval <> newVal Then
            Target = Target & "; " & newVal
        Else
            Target = newVal
        End If
        If Len(newVal) = 0 Then Target.ClearContents
        Application.EnableEvents = True
    End If
    If Not Intersect(Target, Range("|fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|")) Is Nothing And Target.Cells.Count = 1 Then
        Application.EnableEvents = False
        newVal2 = Target
        Application.Undo
        oldval2 = Target
        If Len(oldval2) <> 0 And oldval2 <> newVal2 Then
            Target = Target & "; " & newVal2
        Else
            Target = newVal2
        End If
        If Len(newVal2) = 0 Then Target.ClearContents
        Application.EnableEvents = True
    End If
    
    
    
End Sub

'Private Sub Worksheet_Change(ByVal Target As Range)
'If Target.Address = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Address Then
 '       |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'End If
'If Target.Address = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Address Then
'        |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|
'End If
'If Target.Address = Range("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|").Address Then
'        |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|
'End If
'End Sub

Sub material()
Dim a, i As Long, e

    'If ActiveCell.Column = Range("|fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Column And ActiveCell.row > 3 And ActiveCell.row < Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Rows.Count + 4 Then
        InitListbox
        
        'Stop
        With ListBox1
            .Visible = False
            .Top = ActiveCell.Top + ActiveCell.Height
            .Left = ActiveCell.Left
            a = Split(ActiveCell, ";")
            For i = LBound(a) To UBound(a)
                a(i) = Trim(a(i))
            Next
            bIgnore = True
            For i = LBound(.List, 1) To UBound(.List, 1)
                .Selected(i) = False
                For Each e In a
                    If .List(i, 0) = e Then .Selected(i) = True: Exit For
                Next
            Next
            bIgnore = False
            .Visible = True
    
        End With
    'Else
       ' ListBox1.Visible = False
   ' End If

End Sub



Sub AllShow()
Application.ScreenUpdating = False
ActiveSheet.Range(Cells(1, 4), Cells(1, 6)).ClearContents
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1").Select
If ActiveSheet.FilterMode = True Then _
      ActiveSheet.ShowAllData

'ActiveSheet.ShowAllData

Range("D1").Select
   ' Selection.End(xlDown).Select
   ' Set n = ActiveCell.Offset(1, 0)
    Application.ScreenUpdating = True
    'N.Select
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
 Option Explicit
Public bIgnore As Boolean

Private Sub Worksheet_Activate()
refresh_all
End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
 Option Explicit
Public bIgnore As Boolean




Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit






INQUEST-PP=macro
