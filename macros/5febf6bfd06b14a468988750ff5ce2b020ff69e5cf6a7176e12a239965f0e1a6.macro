Attribute VB_Name = "Email"
Option Explicit
Option Compare Text

Sub Email()
Dim mMessage As Object
Dim mConfig As Object
Dim mChps
    
    Set mConfig = CreateObject("CDO.Configuration")
    
    mConfig.Load -1
    Set mChps = mConfig.Fields
    With mChps
        .Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
        'Adapter suivant votre serveur de mail. (exemple pour Gmail.)=> Hormail "smtp.live.com"
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "smtp.gmail.com"
        'En principe, 25 fonctionne avec tout les serveurs.
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 465
        
        'Vous pouvez essayer sans ces trois lignes
        'Mais si votre serveur demande une authentification,
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpauthenticate") = "1"
        .Item("http://schemas.microsoft.com/cdo/configuration/sendusername") = "rapport.ctc.303@gmail.com"
        .Item("http://schemas.microsoft.com/cdo/configuration/sendpassword") = "R@pportmagasin#303"
        'Si votre serveur demande une connexion s|fffd|re (SSL)
        .Item("http://schemas.microsoft.com/cdo/configuration/smtpusessl") = "true"
        .Update
    End With
    
    Set mMessage = CreateObject("CDO.Message")
    With mMessage
    Set .Configuration = mConfig
        .To = "stephanegiguere99@gmail.com"
        .From = "rapport.ctc.303@gmail.com"
        .Subject = "Vente Cat|fffd|gorie " & Format(Date - 1, "dd-mm-yyyy")
        .TextBody = "Email g|fffd|n|fffd|r|fffd| par Excel pour le rapport Vente Cat|fffd|gorie."
        'Pour ajouter une pi|fffd|ce jointe, un fichier, classeur, image etc.
        .AddAttachment ThisWorkbook.Path & "\" & "Vente Cat|fffd|gorie " & Format(Date - 1, "dd-mm-yyyy") & ".xlsm"
        .Send
    End With
    Set mMessage = Nothing
   
    'Lib|fffd|re les ressources
    Set mConfig = Nothing
    Set mChps = Nothing
End Sub
Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 42, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 43, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 44, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 45, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 46, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 47, 5, MSForms, CommandButton"
Attribute VB_Control = "CommandButton7, 48, 6, MSForms, CommandButton"
Attribute VB_Control = "CommandButton8, 49, 7, MSForms, CommandButton"
Attribute VB_Control = "CommandButton9, 50, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton10, 51, 9, MSForms, CommandButton"
Attribute VB_Control = "CommandButton11, 52, 10, MSForms, CommandButton"
Attribute VB_Control = "CommandButton12, 53, 11, MSForms, CommandButton"
Attribute VB_Control = "CommandButton13, 54, 12, MSForms, CommandButton"
Attribute VB_Control = "CommandButton14, 55, 13, MSForms, CommandButton"
Attribute VB_Control = "CommandButton15, 56, 14, MSForms, CommandButton"
Attribute VB_Control = "CommandButton16, 57, 15, MSForms, CommandButton"
Attribute VB_Control = "CommandButton17, 58, 16, MSForms, CommandButton"
Attribute VB_Control = "CommandButton18, 59, 17, MSForms, CommandButton"
Attribute VB_Control = "CommandButton19, 60, 18, MSForms, CommandButton"
Attribute VB_Control = "CommandButton20, 61, 19, MSForms, CommandButton"
Attribute VB_Control = "CommandButton21, 62, 20, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Call ThisWorkbook.Trier_Categorie_2019
End Sub

Private Sub CommandButton10_Click()
Call ThisWorkbook.Trier_Semaine_Diff_Plus_Dollars
End Sub

Private Sub CommandButton11_Click()
Call ThisWorkbook.Trier_Semaine_Diff_Moins_Dollars
End Sub

Private Sub CommandButton12_Click()
Call ThisWorkbook.Trier_Annee_2019
End Sub

Private Sub CommandButton13_Click()
Call ThisWorkbook.Trier_Annee_Diff_Plus_Pourcentage
End Sub

Private Sub CommandButton14_Click()
Call ThisWorkbook.Trier_Annee_Diff_Moins_Pourcentage
End Sub

Private Sub CommandButton15_Click()
Call ThisWorkbook.Trier_Annee_Diff_Plus_Dollars
End Sub

Private Sub CommandButton16_Click()
Call ThisWorkbook.Trier_Annee_Diff_Moins_Dollars
End Sub

Private Sub CommandButton17_Click()
Call ThisWorkbook.Trier_Inventaire_2019
End Sub

Private Sub CommandButton18_Click()
Call ThisWorkbook.Trier_Inventaire_Diff_Plus_Pourcentage
End Sub

Private Sub CommandButton19_Click()
Call ThisWorkbook.Trier_Inventaire_Diff_Moins_Pourcentage
End Sub

Private Sub CommandButton2_Click()
Call ThisWorkbook.Trier_Quotidien_2019
End Sub

Private Sub CommandButton20_Click()
Call ThisWorkbook.Trier_Inventaire_Diff_Plus_Dollars
End Sub

Private Sub CommandButton21_Click()
Call ThisWorkbook.Trier_Inventaire_Diff_Moins_Dollars
End Sub

Private Sub CommandButton3_Click()
Call ThisWorkbook.Trier_Quotidien_Diff_Plus_Pourcentage
End Sub

Private Sub CommandButton4_Click()
Call ThisWorkbook.Trier_Quotidien_Diff_Moins_Pourcentage
End Sub

Private Sub CommandButton5_Click()
Call ThisWorkbook.Trier_Quotidien_Diff_Plus_Dollars
End Sub

Private Sub CommandButton6_Click()
Call ThisWorkbook.Trier_Quotidien_Diff_Moins_Dollars
End Sub

Private Sub CommandButton7_Click()
Call ThisWorkbook.Trier_Semaine_2019
End Sub

Private Sub CommandButton8_Click()
Call ThisWorkbook.Trier_Semaine_Diff_Plus_Pourcentage
End Sub

Private Sub CommandButton9_Click()
Call ThisWorkbook.Trier_Semaine_Diff_Moins_Pourcentage
End Sub
Attribute VB_Name = "Feuil11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Worksheet_Activate()
'ThisWorkbook.Protect "kt38ax"
'End Sub
 
'Private Sub Worksheet_Deactivate()
'ThisWorkbook.Unprotect "kt38ax"
'End Sub
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 5, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 6, 4, MSForms, CommandButton"
'Private Sub Worksheet_Activate()
'ThisWorkbook.Protect "kt38ax"
'End Sub
 
'Private Sub Worksheet_Deactivate()
'ThisWorkbook.Unprotect "kt38ax"
'End Sub

Private Sub CommandButton1_Click()
Call TrierProduit
End Sub

Private Sub CommandButton2_Click()
Call TrierNetSlsQty
End Sub

Private Sub CommandButton3_Click()
Call TrierNetSlsDollars
End Sub

Private Sub CommandButton4_Click()
Call Select_Reg
End Sub

Private Sub CommandButton5_Click()
Call Annuler_Filtre
End Sub
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Worksheet_Activate()
'ThisWorkbook.Protect "kt38ax"
'End Sub
 
'Private Sub Worksheet_Deactivate()
'ThisWorkbook.Unprotect "kt38ax"
'End Sub
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton3, 23, 8, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 22, 9, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataArticleCreer, 2, 10, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataArticleExecuter, 5, 11, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataArticleDownload, 8, 12, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataCategorieCreer, 15, 13, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataCategorieExecuter, 16, 14, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataCategorieDownload, 17, 15, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataInvHebdoCreer, 18, 16, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataInvHebdoExecuter, 19, 17, MSForms, CommandButton"
Attribute VB_Control = "BoutonDataInvHebdoDownload, 20, 18, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 21, 19, MSForms, CommandButton"
Private Sub BoutonDataArticleDownload_Click()
Dim totalrow0, storenum As Integer
Dim ausername, apassword As String
Dim complmessage As String
On Error GoTo errhandler

'setup expected rows array
Dim expcol0() As String
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Vente Article").Range("A5:P1000").Value = ""

expcol0 = Split("NECONB NEFUTO NEE2ST NEE1ST NEZLQU NEQVVA NEEKPR NEYSQU NECBQT NECCQT NECDQT NECEQT NELBNB NEGKTO BLINE3 C@ALIGN", " ")
storenum = CInt(Worksheets("Setting").Cells(1, 2).Value)
ausername = Worksheets("Setting").Cells(2, 2).Value
apassword = Worksheets("Setting").Cells(3, 2).Value

complmessage = "Tranfert de donn|fffd|es compl|fffd|t|fffd|. " & Chr(10) & "Data Transfer completed. "
parmerror = "# de magasin, utilisateur ou mot de passe incomplet." & Chr(10) & "Store #, user or password incomplete"

If Not (ausername <> "" And apassword <> "" And storenum > 0) Then
MsgBox parmerror
Exit Sub
End If

'download data
totalrow0 = downloaddata(CStr(calcip(storenum, "as400")), CStr(ausername), CStr(apassword), "CTCMASTCTL", "RPTPRDPRF", Worksheets("Vente Article"), 1, 5, False, , expcol0())

MsgBox "RPTPRDPRF: " & totalrow0 & Chr(10) & "Transfert compl|fffd|t|fffd| / Transfer Completed"

Worksheets("Vente Article").Activate
MiseEnFormeVenteArticle

Worksheets("Rapport").Activate

Worksheets("Rapport").Cells(11, 3).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataArticleExecuter_Click()
On Error GoTo errhandler
rundealreportDataArticle
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(9, 3).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataCategorieDownload_Click()
Dim totalrow0, storenum As Integer
Dim ausername, apassword As String
Dim complmessage As String
On Error GoTo errhandler

'setup expected rows array
Dim expcol0() As String
ActiveSheet.Unprotect ("kt38ax")
expcol0 = Split("NCLBNB NCGKTO BASE NCO0VA NCM7PC NCM8PC NCO1VA NCM9PC NCNAPC NCO2VA NCNBPC NCNCPC NCO3VA NCNDPC NCNEPC Q700DTL1 NCQNVA NCNFPC NCNGPC NCQOVA NCNHPC NCNIPC NCQPVA NCNJPC NCNKPC NCQQVA NCNLPC NCNMPC Q700DTL2 NCRAVA NCNVPC NCNZPC NCRBVA NCNWPC NCN0PC NCRCVA NCNXPC NCN1PC NCRDVA NCNYPC NCN2PC Q700DTL3 NETDLYDIF Q700DTL4 NETWTDDIF Q700DTL5 NETPTDDIF Q700DTL6 NETYTDDIF", " ")
storenum = CInt(Worksheets("Setting").Cells(1, 2).Value)
ausername = Worksheets("Setting").Cells(2, 2).Value
apassword = Worksheets("Setting").Cells(3, 2).Value

complmessage = "Tranfert de donn|fffd|es compl|fffd|t|fffd|. " & Chr(10) & "Data Transfer completed. "
parmerror = "# de magasin, utilisateur ou mot de passe incomplet." & Chr(10) & "Store #, user or password incomplete"

If Not (ausername <> "" And apassword <> "" And storenum > 0) Then
MsgBox parmerror
Exit Sub
End If

'download data
totalrow0 = downloaddata(CStr(calcip(storenum, "as400")), CStr(ausername), CStr(apassword), "CTCMASTCTL", "RPTSLSTD", Worksheets("DataCategorie"), 1, 2, False, , expcol0())

MsgBox "RPTSLSTD: " & totalrow0 & Chr(10) & "Transfert compl|fffd|t|fffd| / Transfer Completed"

Worksheets("Rapport").Cells(11, 6).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataCategorieExecuter_Click()
On Error GoTo errhandler
rundealreportDataCategorie
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(9, 6).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataInvHebdoDownload_Click()
Dim totalrow0, storenum As Integer
Dim ausername, apassword As String
Dim complmessage As String
On Error GoTo errhandler

'setup expected rows array
Dim expcol0() As String
ActiveSheet.Unprotect ("kt38ax")
expcol0 = Split("BRKLVL OVRFLO M4LBNB M4X6QUSM M4EVPRSM M4EXPRSM M4E9PRSM M4EZPRSM M4E5PRSM M4E2PRSM M4PBVASM OHDIFFSM RETAILDISM PREDISDISM INVDIFFSM CALC3301 CALC3302", " ")
storenum = CInt(Worksheets("Setting").Cells(1, 2).Value)
ausername = Worksheets("Setting").Cells(2, 2).Value
apassword = Worksheets("Setting").Cells(3, 2).Value

complmessage = "Tranfert de donn|fffd|es compl|fffd|t|fffd|. " & Chr(10) & "Data Transfer completed. "
parmerror = "# de magasin, utilisateur ou mot de passe incomplet." & Chr(10) & "Store #, user or password incomplete"

If Not (ausername <> "" And apassword <> "" And storenum > 0) Then
MsgBox parmerror
Exit Sub
End If

'download data
totalrow0 = downloaddata(CStr(calcip(storenum, "as400")), CStr(ausername), CStr(apassword), "CTCMASTCTL", "RPTINVELCP", Worksheets("DataInv"), 1, 2, False, , expcol0())

MsgBox "RPTINVELCP: " & totalrow0 & Chr(10) & "Transfert compl|fffd|t|fffd| / Transfer Completed"

Worksheets("Rapport").Cells(11, 9).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataInvHebdoExecuter_Click()
On Error GoTo errhandler
rundealreportDataInventaireHebdomadaire
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(9, 9).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox "Error / Erreur: " & Err.Number & " " & Chr(10) & Err.Description
Err.Clear
End Sub

Private Sub BoutonDataInvHebdoCreer_Click()
On Error GoTo errhandler
createuniversalreportDataInvHebdo Sheets("DATA-INVENTAIRE HEBDOMADAIRE")
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(7, 9).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox Err.Description

End Sub

Private Sub BoutonDataArticleCreer_Click()
On Error GoTo errhandler
createuniversalreport Sheets("DATA - ARTICLE")
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(7, 3).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox Err.Description

End Sub

Private Sub BoutonDataCategorieCreer_Click()
On Error GoTo errhandler
createuniversalreport Sheets("DATA - CAT|fffd|GORIE")
ActiveSheet.Unprotect ("kt38ax")
Worksheets("Rapport").Cells(7, 6).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Exit Sub
errhandler:
MsgBox Err.Description

End Sub

Private Sub CommandButton1_Click()
Application.DisplayFullScreen = True
    With Worksheets("Vente Cat|fffd|gorie")
        .Unprotect ("kt38ax")
        .Activate
        .Columns("A:S").AutoFit
    .Range("A8:S8").Select
     ActiveWindow.Zoom = 80
    .Columns("A:S").AutoFit
    .Range("A8:S8").Select
     ActiveWindow.Zoom = True
    .Range("A6").Select
    .Protect ("kt38ax")
    End With
End Sub

Private Sub CommandButton2_Click()
Worksheets("Vente Cat|fffd|gorie").Activate
Call ThisWorkbook.Trier_Quotidien_2019
Application.Wait (Now + TimeValue("00:00:02"))
Worksheets("Rapport").Activate

ActiveSheet.Unprotect ("kt38ax")
ActiveWorkbook.SaveCopyAs Filename:=ThisWorkbook.Path & "\" & "Vente Cat|fffd|gorie " & Format(Date - 1, "dd-mm-yyyy") & ".xlsm"
Application.DisplayAlerts = False

Workbooks.Open Filename:=ThisWorkbook.Path & "\" & "Vente Cat|fffd|gorie " & Format(Date - 1, "dd-mm-yyyy") & ".xlsm"
Worksheets("Rapport").Unprotect ("kt38ax")
Worksheets("Rapport").Visible = xlSheetVeryHidden
Worksheets("Rapport").Protect ("kt38ax")
ActiveWorkbook.Save
Application.DisplayAlerts = False
ActiveWorkbook.Close

Application.DisplayAlerts = False
Worksheets("Rapport").Cells(13, 4).Value = "OK"
ActiveSheet.Protect ("kt38ax")
Worksheets("Rapport").Activate
End Sub

Private Sub CommandButton3_Click()
Call Email.Email
Worksheets("Rapport").Unprotect ("kt38ax")
Worksheets("Rapport").Cells(13, 9).Value = "OK"
Worksheets("Rapport").Protect ("kt38ax")
End Sub
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Feuil9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Fonction"
'Sub cleanupworksheets()
'clear
'clearfromrow 3, Worksheets("DownloadDataCategorie")
'Worksheets("DownloadDataCategorie").Range("A2:AW2").Clear
'Clean Up
'result1 = ClearExcessRowsAndColumns(Worksheets("DownloadDataCategorie"))
'End Sub

'Function clearfromrow(startrow As Long, wrksheet As Worksheet)
'Dim last As Long

'last = findlastrowsearchfnc(wrksheet)
'If last > 0 And last >= startrow Then
'wrksheet.Range("A" & startrow).Resize((last - startrow) + 1, 1).EntireRow.Clear
'wrksheet.Range("A" & startrow).Resize((last - startrow) + 1, 1).EntireRow.RowHeight = wrksheet.StandardHeight
'End If

'End Function

Sub rundealreportDataArticle()
Dim premessage As String
Dim endmessage As String
Dim parmerror As String
Dim reportname As String
Dim submittedmessage As String

reportname = "DATA - ARTICLE"
premessage = "Avant d'appuyer sur OK, assurez vous d'avoir une seule session AS/400 d'ouverte. Celle-ci doit |fffd|tre au menu principal d'|fffd|quit|fffd|" & Chr(10) & "Before clicking OK, make sure you have only one AS/400 session opened. Also, it must be sitting at Equity Master Menu."

If MsgBox(premessage, vbOKCancel) = vbCancel Then Exit Sub

If sessionexists Then

Dim autECLPSObj As Object
Dim autECLConnList As Object
Dim autECLOIAObj As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")
Set autECLConnList = CreateObject("PCOMM.autECLConnList")
Set autECLOIAObj = CreateObject("PCOMM.autECLOIA")

' Initialize the connection
autECLConnList.Refresh
autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)
autECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)


'go to 10
If ((autECLPSObj.SearchText("MENU:  EQ")) = False) And ((autECLPSObj.SearchText("Menu:  EQ")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Session AS/400 n'es pas au Menu Principal |fffd|quit|fffd|" & Chr(10) & Chr(10) & "AS/400 Session not at Equity Master Menu"
autECLPSObj.SendKeys "10", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'go to 01
If ((autECLPSObj.SearchText("MENU:  EF")) = False) And ((autECLPSObj.SearchText("Menu:  EF")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Menu des rapports non-disponible" & Chr(10) & Chr(10) & "Report Menu not available"
autECLPSObj.SendKeys "01", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

frow = 1
fcol = 1
Do Until (autECLPSObj.SearchText("" & reportname & "", 1, frow, fcol))
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
If (autECLOIAObj.InputInhibited = 5) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
Loop

autECLPSObj.SendKeys "6", frow, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

autECLPSObj.SendKeys " [tab]" & "3" & "[field+][enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
autECLPSObj.SendKeys "13[tab][enter]"

'make sure it worked
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
If ((autECLPSObj.SearchText("Job submitted to job queue.")) = False) And ((autECLPSObj.SearchText("Le travail a |fffd|t|fffd| soumis |fffd| la file d'attente de traitement.")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport non ex|fffd|cut|fffd|." & Chr(10) & Chr(10) & "Report not submitted"
submittedmessage = autECLPSObj.GetText(24, 1, 80)
autECLPSObj.SendKeys "[pf12][pf12]"
MsgBox submittedmessage
End If

End Sub

Sub rundealreportDataCategorie()
Dim premessage As String
Dim endmessage As String
Dim parmerror As String
Dim reportname As String
Dim submittedmessage As String

reportname = "DATA - CAT|fffd|GORIE"
premessage = "Avant d'appuyer sur OK, assurez vous d'avoir une seule session AS/400 d'ouverte. Celle-ci doit |fffd|tre au menu principal d'|fffd|quit|fffd|" & Chr(10) & "Before clicking OK, make sure you have only one AS/400 session opened. Also, it must be sitting at Equity Master Menu."

If MsgBox(premessage, vbOKCancel) = vbCancel Then Exit Sub

If sessionexists Then

Dim autECLPSObj As Object
Dim autECLConnList As Object
Dim autECLOIAObj As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")
Set autECLConnList = CreateObject("PCOMM.autECLConnList")
Set autECLOIAObj = CreateObject("PCOMM.autECLOIA")

' Initialize the connection
autECLConnList.Refresh
autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)
autECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)


'go to 10
If ((autECLPSObj.SearchText("MENU:  EQ")) = False) And ((autECLPSObj.SearchText("Menu:  EQ")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Session AS/400 n'es pas au Menu Principal |fffd|quit|fffd|" & Chr(10) & Chr(10) & "AS/400 Session not at Equity Master Menu"
autECLPSObj.SendKeys "10", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'go to 01
If ((autECLPSObj.SearchText("MENU:  EF")) = False) And ((autECLPSObj.SearchText("Menu:  EF")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Menu des rapports non-disponible" & Chr(10) & Chr(10) & "Report Menu not available"
autECLPSObj.SendKeys "01", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

frow = 1
fcol = 1
Do Until (autECLPSObj.SearchText("" & reportname & "", 1, frow, fcol))
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
If (autECLOIAObj.InputInhibited = 5) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
Loop

autECLPSObj.SendKeys "6", frow, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

autECLPSObj.SendKeys "[enter]"
autECLPSObj.SendKeys "[pf10]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
autECLPSObj.SendKeys "13[tab][enter]"

'make sure it worked
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
If ((autECLPSObj.SearchText("Job submitted to job queue.")) = False) And ((autECLPSObj.SearchText("Le travail a |fffd|t|fffd| soumis |fffd| la file d'attente de traitement.")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport non ex|fffd|cut|fffd|." & Chr(10) & Chr(10) & "Report not submitted"
submittedmessage = autECLPSObj.GetText(24, 1, 80)
autECLPSObj.SendKeys "[pf12][pf12]"
MsgBox submittedmessage
End If

End Sub

Sub rundealreportDataInventaireHebdomadaire()
Dim premessage As String
Dim endmessage As String
Dim parmerror As String
Dim reportname As String
Dim submittedmessage As String

reportname = "DATA-INVENTAIRE HEBDOMADAIRE"
premessage = "Avant d'appuyer sur OK, assurez vous d'avoir une seule session AS/400 d'ouverte. Celle-ci doit |fffd|tre au menu principal d'|fffd|quit|fffd|" & Chr(10) & "Before clicking OK, make sure you have only one AS/400 session opened. Also, it must be sitting at Equity Master Menu."

If MsgBox(premessage, vbOKCancel) = vbCancel Then Exit Sub

If sessionexists Then

Dim autECLPSObj As Object
Dim autECLConnList As Object
Dim autECLOIAObj As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")
Set autECLConnList = CreateObject("PCOMM.autECLConnList")
Set autECLOIAObj = CreateObject("PCOMM.autECLOIA")

' Initialize the connection
autECLConnList.Refresh
autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)
autECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)


'go to 10
If ((autECLPSObj.SearchText("MENU:  EQ")) = False) And ((autECLPSObj.SearchText("Menu:  EQ")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Session AS/400 n'es pas au Menu Principal |fffd|quit|fffd|" & Chr(10) & Chr(10) & "AS/400 Session not at Equity Master Menu"
autECLPSObj.SendKeys "10", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'go to 01
If ((autECLPSObj.SearchText("MENU:  EF")) = False) And ((autECLPSObj.SearchText("Menu:  EF")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Menu des rapports non-disponible" & Chr(10) & Chr(10) & "Report Menu not available"
autECLPSObj.SendKeys "01", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

frow = 1
fcol = 1
Do Until (autECLPSObj.SearchText("" & reportname & "", 1, frow, fcol))
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
If (autECLOIAObj.InputInhibited = 5) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
Loop

autECLPSObj.SendKeys "6", frow, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

autECLPSObj.SendKeys "[enter]"
autECLPSObj.SendKeys "[pf10]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
autECLPSObj.SendKeys "13[tab][enter]"

'make sure it worked
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
If ((autECLPSObj.SearchText("Job submitted to job queue.")) = False) And ((autECLPSObj.SearchText("Le travail a |fffd|t|fffd| soumis |fffd| la file d'attente de traitement.")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport non ex|fffd|cut|fffd|." & Chr(10) & Chr(10) & "Report not submitted"
submittedmessage = autECLPSObj.GetText(24, 1, 80)
autECLPSObj.SendKeys "[pf12][pf12]"
MsgBox submittedmessage
End If

End Sub
Attribute VB_Name = "Module1"
Sub Select_Reg()
    ActiveSheet.Unprotect ("kt38ax")
    RegSelect.Show
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Annuler_Filtre()
  ActiveSheet.Unprotect ("kt38ax")
  Sheets("Vente article").Cells.EntireRow.Hidden = False
  Call TrierNetSlsDollars
  'ActiveSheet.Protect ("kt38ax")
End Sub
Attribute VB_Name = "Module2"
Function sessionexists()
Dim autECLConnList As Object
Dim Num As Long
Dim nosession As String
Dim moresession As String

Set autECLConnList = CreateObject("PCOMM.autECLConnList")
autECLConnList.Refresh
Num = autECLConnList.Count

nosession = "Aucune session AS/400 ouverte. Vous devez ouvrir une session AS/400 et la laisser au menu principal d'|fffd|quit|fffd| avant d'ex|fffd|cuter. Annul|fffd|." & Chr(10) & "No AS/400 terminal session found. You must open an AS/400 session and leave it at Equity Master Menu before executing this. Exitting."
moresession = "Plus d'une session AS/400 pr|fffd|sentement ouverte. Vous devez seulement avoir une session ouverte pour ex|fffd|cuter cette fonction. Annul|fffd|" & Chr(10) & "More than 1 AS/400 terminal session opened. You must only have one session opened to run this. Exitting"

Select Case Num
Case 0
MsgBox nosession
sessionexists = False
Case 1
sessionexists = True
Case Is > 1
MsgBox moresession
sessionexists = False
End Select

End Function
Attribute VB_Name = "Module3"
Function createuniversalreport(parmsheet As Worksheet) As Boolean
Dim reportname As String
Dim row As Integer
Dim wholeline As String
Dim premessage As String
Dim endmessage As String
Dim found As Boolean
Dim found1 As Boolean
Dim firstpage As Boolean
Dim firstpage1 As Boolean
Dim rfound As Range
Dim prevrangetype As String
Dim frow As Integer
Dim fcol As Integer
Dim entryrow As Integer
Dim sumextraF12 As Integer
Dim prevcriteria As String
Dim triggeror As Boolean
Dim triedtoaddcriteria As Boolean
Dim totalpgdown As Integer
Dim pctoffieldarray() As String
Dim looppctarray As Integer
Dim plussignrow As Integer
Dim plussigncol As Integer
Dim plusfound As Boolean
Dim loopday As Integer
Dim currentrow As Integer

reportname = Left(Trim(parmsheet.Name), 30)
premessage = "Avant d'appuyer sur OK, assurez vous d'avoir une seule session AS/400 d'ouverte. Celle-ci doit |fffd|tre au menu principal d'|fffd|quit|fffd|" & Chr(10) & "Before clicking OK, make sure you have only one AS/400 session opened. Also, it must be sitting at Equity Master Menu."
endmessage = "Rapport Cr|fffd|e avec succ|fffd|s. / Report successfully created. (" & reportname & ")"


If MsgBox(premessage, vbOKCancel) = vbCancel Then Exit Function

If sessionexists() Then


Dim autECLPSObj As Object
Dim autECLConnList As Object
Dim autECLOIAObj As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")
Set autECLConnList = CreateObject("PCOMM.autECLConnList")
Set autECLOIAObj = CreateObject("PCOMM.autECLOIA")

' Initialize the connection
autECLConnList.Refresh
autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)
autECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)

'GoTo starthere:

'go to 10
If ((autECLPSObj.SearchText("MENU:  EQ")) = False) And ((autECLPSObj.SearchText("Menu:  EQ")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Session AS/400 n'es pas au Menu Principal |fffd|quit|fffd|" & Chr(10) & Chr(10) & "AS/400 Session not at Equity Master Menu"
autECLPSObj.SendKeys "10", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'go to 01
If ((autECLPSObj.SearchText("MENU:  EF")) = False) And ((autECLPSObj.SearchText("Menu:  EF")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Menu des rapports non-disponible" & Chr(10) & Chr(10) & "Report Menu not available"
autECLPSObj.SendKeys "01", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'make sure we got there
If (autECLPSObj.SearchText("EQOSDFR")) = False Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Option Rapports de Gestion non-disponible" & Chr(10) & Chr(10) & "Management Report Option not available"

'find report to copy
found = False
firstpage = True
Do Until autECLPSObj.GetText(21, 79, 1) = " " Or found = True

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 6 To 23
wholeline = autECLPSObj.GetText(row, 1, 80)
'english or french
If (InStr(wholeline, Trim(parmsheet.Cells(5, 4))) And InStr(wholeline, Trim(parmsheet.Cells(6, 4)))) Or _
(InStr(wholeline, Trim(parmsheet.Cells(5, 10))) And InStr(wholeline, Trim(parmsheet.Cells(6, 4)))) Then
found = True
Exit For
End If
Next

Loop

If Not found Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
End If

'copy report
autECLPSObj.SendKeys "3", row, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
autECLPSObj.SendKeys reportname
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'retrieve copied report
firstpage = True
Do Until autECLPSObj.GetText(21, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If
Loop

found = False
For row = 23 To 6 Step -1
wholeline = autECLPSObj.GetText(row, 1, 80)
If InStr(wholeline, Trim(reportname)) And InStr(wholeline, Trim(parmsheet.Cells(6, 4))) And InStr(wholeline, "0/00/00") Then
found = True
Exit For
End If
Next

If Not found Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
End If

'edit report
autECLPSObj.SendKeys "2", row, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)


'Setup Columns
sumextraF12 = 0
firstpage = True
Do Until autECLPSObj.GetText(20, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 10 To 20
wholeline = Trim(autECLPSObj.GetText(row, 6, 47))

Set rfound = parmsheet.Columns(1).Find(What:=wholeline, After:=parmsheet.Cells(10, 1), LookIn:=xlFormulas, LookAt:= _
            xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
            , SearchFormat:=False)
                
If Not rfound Is Nothing And wholeline <> "" Then
    If autECLPSObj.GetText(row, 4, 1) = " " Then autECLPSObj.SendKeys "1[tab]", row, 2
    If rfound.Cells(1, 2) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 2).Value & "[tab]", row, 53
    If rfound.Cells(1, 4) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 4).Value & "[tab]", row, 74
    If rfound.Cells(1, 5) = "Y" Then sumextraF12 = sumextraF12 + 1
Else
    If autECLPSObj.GetText(row, 4, 1) = "*" Then autECLPSObj.SendKeys "1[tab]", row, 2
End If

Next

Loop

autECLPSObj.SendKeys "[enter]"
'process sumextraF12 to get out of field with a second select screen
Do Until sumextraF12 = 0
autECLPSObj.SendKeys "[PF12]"
sumextraF12 = sumextraF12 - 1
Loop

autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)


'setup sort fields. setup sort asc or desc
firstpage = True
Do Until autECLPSObj.GetText(20, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 10 To 20
wholeline = Trim(autECLPSObj.GetText(row, 6, 47))

Set rfound = parmsheet.Columns(1).Find(What:=wholeline, After:=parmsheet.Cells(10, 1), LookIn:=xlValues, LookAt:= _
            xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
            , SearchFormat:=False)
                
If Not rfound Is Nothing And wholeline <> "" Then
    If rfound.Cells(1, 3) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 3).Value & "[tab]", row, 66
End If

Next

Loop

autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'Product ranges
autECLPSObj.SendKeys "[PF13][PF13]Y[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'enter ranges
row = 11
prevrangetype = ""
firstpage = True
While parmsheet.Cells(row, 7).Value <> ""

    'add new if required
    If parmsheet.Cells(row, 7).Value <> prevrangetype Then
    prevrangetype = parmsheet.Cells(row, 7).Value
    
    If Not firstpage Then
    autECLPSObj.SendKeys "[tab][enter][enter]"
    Else
    firstpage = False
    autECLPSObj.SendKeys "[PF6]"
    End If
    
    entryrow = 0
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    frow = 1
    fcol = 1
    found = False
    found = autECLPSObj.SearchText(prevrangetype, 1, frow, fcol)
    
    If found = False Then
    'range type not found but cannot report since it could be a french type
    prevrangetype = ""
    GoTo continuewhile1
    End If
    
    autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    autECLPSObj.SendKeys "[enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    
    End If

    'send
    autECLPSObj.SendKeys parmsheet.Cells(row, 8).Value & "[tab]" & parmsheet.Cells(row, 9).Value & "[tab]"
    entryrow = entryrow + 1
    If entryrow = 10 Then
    autECLPSObj.SendKeys "[pagedn]"
    entryrow = 0
    End If
continuewhile1:
row = row + 1
Wend

'return to main report screen only if ranges were processed based on firstpage being modified
If firstpage = False Then autECLPSObj.SendKeys "[tab][enter][enter][pf12][pf12]" Else autECLPSObj.SendKeys "[pf12]"


'Report Criteria F15

autECLPSObj.SendKeys "[PF15][PF13]Y[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'enter criterias
row = 11
prevcriteria = ""
triedtoaddcriteria = False
triggeror = False

While parmsheet.Cells(row, 11).Value <> ""
If triggeror Then autECLPSObj.SendKeys "[PF12]"
If parmsheet.Cells(row, 11).Value = "OR" Then row = row + 1
'next time here need to do or !
triggeror = True

autECLPSObj.SendKeys "[PF6]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
'find the + sign for the window we just opened
plussignrow = 1
plussigncol = 1
plusfound = False
plusfound = autECLPSObj.SearchText("  +", 1, plussignrow, plussigncol)
If plusfound = False Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Erreur d'entr|fffd|e de crit|fffd|re de s|fffd|lection" & Chr(10) & Chr(10) & "Error while adding selection criteria"

'this is set so we can cleanly exit
triedtoaddcriteria = True


    While parmsheet.Cells(row, 11).Value <> "" And parmsheet.Cells(row, 11).Value <> "OR"
        
        found = False
        firstpage = True
        totalpgdown = 0
        ReDim pctoffieldarray(0)
        Do Until autECLPSObj.GetText(plussignrow, plussigncol + 2, 1) = " " Or found

            If firstpage Then
            firstpage = False
            Else
            autECLPSObj.SendKeys "[pagedn]"
            totalpgdown = totalpgdown + 1
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            End If


            frow = 1
            fcol = 1
            found = False
            found = autECLPSObj.SearchText(Trim(parmsheet.Cells(row, 11)) & "  ", 1, frow, fcol)
            
            
            If found Then
            prevcriteria = Trim(parmsheet.Cells(row, 11))
            autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
            autECLPSObj.SendKeys "[enter]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'enter data
            'capture current row in order to be able to position to next line if next crit is same !
            currentrow = autECLPSObj.CursorPosRow
            autECLPSObj.SendKeys "[tab]" & parmsheet.Cells(row, 12) & "[field+]" & parmsheet.Cells(row, 13) & "[field+]" & parmsheet.Cells(row, 14) & "[field+]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'enter supplemental data
            If parmsheet.Cells(row, 16) <> "" Then
            autECLPSObj.SendKeys parmsheet.Cells(row, 15) & "[field+]" & "?"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'make note of compare field so it can be entered after when pressing enter
            pctoffieldarray(UBound(pctoffieldarray)) = parmsheet.Cells(row, 16)
            ReDim Preserve pctoffieldarray(UBound(pctoffieldarray) + 1)
            Else
            'prepare for next line and position cursor on next row
                Do Until autECLPSObj.CursorPosRow = currentrow + 1
                autECLPSObj.SendKeys "[tab]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                Loop
                
            End If
            'get all iterations of the same criteria
            entryrow = 1
            While Trim(parmsheet.Cells(row + 1, 11)) = prevcriteria
                row = row + 1
                'enter data
                'capture current row in order to be able to position to next line if next crit is same !
                currentrow = autECLPSObj.CursorPosRow
                autECLPSObj.SendKeys "[tab]" & parmsheet.Cells(row, 12) & "[field+]" & parmsheet.Cells(row, 13) & "[field+]" & parmsheet.Cells(row, 14) & "[field+]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                'enter supplemental data
                If parmsheet.Cells(row, 16) <> "" Then
                autECLPSObj.SendKeys parmsheet.Cells(row, 15) & "[field+]" & "?"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                'make note of compare field so it can be entered after when pressing enter
                pctoffieldarray(UBound(pctoffieldarray)) = parmsheet.Cells(row, 16)
                ReDim Preserve pctoffieldarray(UBound(pctoffieldarray) + 1)
                Else
                    Do Until autECLPSObj.CursorPosRow = currentrow + 1
                    autECLPSObj.SendKeys "[tab]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    Loop
                End If
                
                entryrow = entryrow + 1
                If entryrow = 9 Then
                autECLPSObj.SendKeys "[pagedn]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                totalpgdown = totalpgdown + 1
                entryrow = 0
                End If

            Wend
            
            'take care of pctoffield
            If UBound(pctoffieldarray) > 0 Then
            autECLPSObj.SendKeys "[enter]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            For looppctarray = 0 To UBound(pctoffieldarray) - 1
                found1 = False
                firstpage1 = True
                While found1 = False
                    If firstpage1 Then
                    firstpage1 = False
                    Else
                    autECLPSObj.SendKeys "[pagedn]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    If (autECLOIAObj.InputInhibited = 5) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Champ de comparaison introuvable" & Chr(10) & Chr(10) & "Compare field not found"
                    End If
                frow = 1
                fcol = 1
                found1 = False
                found1 = autECLPSObj.SearchText(pctoffieldarray(looppctarray) & "  ", 1, frow, fcol)
                    If found1 Then
                    autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
                    autECLPSObj.SendKeys "[enter]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    End If
                Wend
            
            Next
            
            End If
            
            
            autECLPSObj.SendKeys "[enter][enter][pf12]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            End If
            
        Loop
    'go back all the way up
    Do Until totalpgdown = 0
    autECLPSObj.SendKeys "[pageup]"
    totalpgdown = totalpgdown - 1
    Loop
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    row = row + 1
    Wend
Wend

'return to main report screen only if ranges were processed based on found being modified
If triedtoaddcriteria = True Then autECLPSObj.SendKeys "[pf12][pf12]" Else autECLPSObj.SendKeys "[pf12]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)


'Schedule
autECLPSObj.SendKeys "[pf18]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'send criterias
autECLPSObj.SendKeys Trim(parmsheet.Cells(9, 20)) & "[tab]"
autECLPSObj.SendKeys Trim(parmsheet.Cells(11, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(12, 20)) & "[field+]"
autECLPSObj.SendKeys Trim(parmsheet.Cells(13, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(14, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(15, 20))


autECLPSObj.SendKeys "[enter][enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
'set list name if output is 4
If Trim(parmsheet.Cells(9, 20)) = 4 Then
autECLPSObj.SendKeys Left(Trim(parmsheet.Cells(10, 22)), 30) & "[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If


If Trim(parmsheet.Cells(15, 20)) = 2 Then
    autECLPSObj.SendKeys "[pf18]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    autECLPSObj.SendKeys "[backtab][backtab][backtab][backtab][backtab][backtab][backtab]"
    'build day array
    Dim dayarray(6) As String
    Dim inputdayarray() As String
    inputdayarray = Split(parmsheet.Cells(16, 20), ",")
    For loopday = 0 To UBound(inputdayarray)
    dayarray(inputdayarray(loopday) - 1) = "Y"
    Next

    For loopday = 0 To UBound(dayarray)
    If dayarray(loopday) = "Y" Then autECLPSObj.SendKeys "Y" Else autECLPSObj.SendKeys "N"
    Next

    autECLPSObj.SendKeys "[enter][enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    'set list name if output is 4
    If Trim(parmsheet.Cells(9, 20)) = 4 Then
    autECLPSObj.SendKeys Left(Trim(parmsheet.Cells(10, 22)), 30) & "[enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    End If
End If




' return to master menu
autECLPSObj.SendKeys "[pf12][pf12][pf12]"

MsgBox endmessage
End If
End Function

Function createuniversalreportDataInvHebdo(parmsheet As Worksheet) As Boolean
Dim reportname As String
Dim row As Integer
Dim wholeline As String
Dim premessage As String
Dim endmessage As String
Dim found As Boolean
Dim found1 As Boolean
Dim firstpage As Boolean
Dim firstpage1 As Boolean
Dim rfound As Range
Dim prevrangetype As String
Dim frow As Integer
Dim fcol As Integer
Dim entryrow As Integer
Dim sumextraF12 As Integer
Dim prevcriteria As String
Dim triggeror As Boolean
Dim triedtoaddcriteria As Boolean
Dim totalpgdown As Integer
Dim pctoffieldarray() As String
Dim looppctarray As Integer
Dim plussignrow As Integer
Dim plussigncol As Integer
Dim plusfound As Boolean
Dim loopday As Integer
Dim currentrow As Integer

reportname = Left(Trim(parmsheet.Name), 30)
premessage = "Avant d'appuyer sur OK, assurez vous d'avoir une seule session AS/400 d'ouverte. Celle-ci doit |fffd|tre au menu principal d'|fffd|quit|fffd|" & Chr(10) & "Before clicking OK, make sure you have only one AS/400 session opened. Also, it must be sitting at Equity Master Menu."
endmessage = "Rapport Cr|fffd|e avec succ|fffd|s. / Report successfully created. (" & reportname & ")"


If MsgBox(premessage, vbOKCancel) = vbCancel Then Exit Function

If sessionexists() Then


Dim autECLPSObj As Object
Dim autECLConnList As Object
Dim autECLOIAObj As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")
Set autECLConnList = CreateObject("PCOMM.autECLConnList")
Set autECLOIAObj = CreateObject("PCOMM.autECLOIA")

' Initialize the connection
autECLConnList.Refresh
autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)
autECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)

'GoTo starthere:

'go to 10
If ((autECLPSObj.SearchText("MENU:  EQ")) = False) And ((autECLPSObj.SearchText("Menu:  EQ")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Session AS/400 n'es pas au Menu Principal |fffd|quit|fffd|" & Chr(10) & Chr(10) & "AS/400 Session not at Equity Master Menu"
autECLPSObj.SendKeys "10", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'go to 01
If ((autECLPSObj.SearchText("MENU:  EF")) = False) And ((autECLPSObj.SearchText("Menu:  EF")) = False) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Menu des rapports non-disponible" & Chr(10) & Chr(10) & "Report Menu not available"
autECLPSObj.SendKeys "01", 20, 45
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'make sure we got there
If (autECLPSObj.SearchText("EQOSDFR")) = False Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Option Rapports de Gestion non-disponible" & Chr(10) & Chr(10) & "Management Report Option not available"

'find report to copy
found = False
firstpage = True
Do Until autECLPSObj.GetText(21, 79, 1) = " " Or found = True

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 6 To 23
wholeline = autECLPSObj.GetText(row, 1, 80)
'english or french
If (InStr(wholeline, Trim(parmsheet.Cells(5, 4))) And InStr(wholeline, Trim(parmsheet.Cells(6, 4)))) Or _
(InStr(wholeline, Trim(parmsheet.Cells(5, 10))) And InStr(wholeline, Trim(parmsheet.Cells(6, 4)))) Then
found = True
Exit For
End If
Next

Loop

If Not found Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
End If

'copy report
autECLPSObj.SendKeys "3", row, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)
autECLPSObj.SendKeys reportname
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)

'retrieve copied report
firstpage = True
Do Until autECLPSObj.GetText(21, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If
Loop

found = False
For row = 23 To 6 Step -1
wholeline = autECLPSObj.GetText(row, 1, 80)
If InStr(wholeline, Trim(reportname)) And InStr(wholeline, Trim(parmsheet.Cells(6, 4))) And InStr(wholeline, "0/00/00") Then
found = True
Exit For
End If
Next

If Not found Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Rapport Introuvable" & Chr(10) & Chr(10) & "Report not found"
End If

'edit report
autECLPSObj.SendKeys "2", row, 2
autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (10000)
autECLOIAObj.WaitForInputReady (10000)


'Setup Columns
sumextraF12 = 0
firstpage = True
Do Until autECLPSObj.GetText(20, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 10 To 20
wholeline = Trim(autECLPSObj.GetText(row, 6, 47))

Set rfound = parmsheet.Columns(1).Find(What:=wholeline, After:=parmsheet.Cells(10, 1), LookIn:=xlFormulas, LookAt:= _
            xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
            , SearchFormat:=False)
                
If Not rfound Is Nothing And wholeline <> "" Then
    If autECLPSObj.GetText(row, 4, 1) = " " Then autECLPSObj.SendKeys "1[tab]", row, 2
    If rfound.Cells(1, 2) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 2).Value & "[tab]", row, 53
    If rfound.Cells(1, 4) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 4).Value & "[tab]", row, 74
    If rfound.Cells(1, 5) = "Y" Then sumextraF12 = sumextraF12 + 1
Else
    If autECLPSObj.GetText(row, 4, 1) = "*" Then autECLPSObj.SendKeys "1[tab]", row, 2
End If

Next

Loop

autECLPSObj.SendKeys "[enter]"
'process sumextraF12 to get out of field with a second select screen
Do Until sumextraF12 = 0
autECLPSObj.SendKeys "[PF12]"
sumextraF12 = sumextraF12 - 1
Loop

autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)


'setup sort fields. setup sort asc or desc
firstpage = True
Do Until autECLPSObj.GetText(20, 79, 1) = " "

If firstpage Then
firstpage = False
Else
autECLPSObj.SendKeys "[pagedn]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If

For row = 10 To 20
wholeline = Trim(autECLPSObj.GetText(row, 6, 47))

Set rfound = parmsheet.Columns(1).Find(What:=wholeline, After:=parmsheet.Cells(10, 1), LookIn:=xlValues, LookAt:= _
            xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
            , SearchFormat:=False)
                
If Not rfound Is Nothing And wholeline <> "" Then
    If rfound.Cells(1, 3) <> "" Then autECLPSObj.SendKeys rfound.Cells(1, 3).Value & "[tab]", row, 66
End If

Next

Loop

autECLPSObj.SendKeys "[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'Product ranges
autECLPSObj.SendKeys "[PF13][PF13]Y[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'enter ranges
row = 11
prevrangetype = ""
firstpage = True
While parmsheet.Cells(row, 7).Value <> ""

    'add new if required
    If parmsheet.Cells(row, 7).Value <> prevrangetype Then
    prevrangetype = parmsheet.Cells(row, 7).Value
    
    If Not firstpage Then
    autECLPSObj.SendKeys "[tab][enter][enter]"
    Else
    firstpage = False
    autECLPSObj.SendKeys "[PF6]"
    End If
    
    entryrow = 0
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    frow = 1
    fcol = 1
    found = False
    found = autECLPSObj.SearchText(prevrangetype, 1, frow, fcol)
    
    If found = False Then
    'range type not found but cannot report since it could be a french type
    prevrangetype = ""
    GoTo continuewhile1
    End If
    
    autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    autECLPSObj.SendKeys "[enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    
    End If

    'send
    autECLPSObj.SendKeys parmsheet.Cells(row, 8).Value & "[tab]" & parmsheet.Cells(row, 9).Value & "[tab]"
    entryrow = entryrow + 1
    If entryrow = 10 Then
    autECLPSObj.SendKeys "[pagedn]"
    entryrow = 0
    End If
continuewhile1:
row = row + 1
Wend

'return to main report screen only if ranges were processed based on firstpage being modified
If firstpage = False Then autECLPSObj.SendKeys "[tab][enter][enter][pf12][pf12]" Else autECLPSObj.SendKeys "[pf12]"


'Report Criteria F15

autECLPSObj.SendKeys "[PF15][PF13]Y[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'enter criterias
row = 11
prevcriteria = ""
triedtoaddcriteria = False
triggeror = False

While parmsheet.Cells(row, 11).Value <> ""
If triggeror Then autECLPSObj.SendKeys "[PF12]"
If parmsheet.Cells(row, 11).Value = "OR" Then row = row + 1
'next time here need to do or !
triggeror = True

autECLPSObj.SendKeys "[PF6]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
'find the + sign for the window we just opened
plussignrow = 1
plussigncol = 1
plusfound = False
plusfound = autECLPSObj.SearchText("  +", 1, plussignrow, plussigncol)
If plusfound = False Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Erreur d'entr|fffd|e de crit|fffd|re de s|fffd|lection" & Chr(10) & Chr(10) & "Error while adding selection criteria"

'this is set so we can cleanly exit
triedtoaddcriteria = True


    While parmsheet.Cells(row, 11).Value <> "" And parmsheet.Cells(row, 11).Value <> "OR"
        
        found = False
        firstpage = True
        totalpgdown = 0
        ReDim pctoffieldarray(0)
        Do Until autECLPSObj.GetText(plussignrow, plussigncol + 2, 1) = " " Or found

            If firstpage Then
            firstpage = False
            Else
            autECLPSObj.SendKeys "[pagedn]"
            totalpgdown = totalpgdown + 1
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            End If


            frow = 1
            fcol = 1
            found = False
            found = autECLPSObj.SearchText(Trim(parmsheet.Cells(row, 11)) & "  ", 1, frow, fcol)
            
            
            If found Then
            prevcriteria = Trim(parmsheet.Cells(row, 11))
            autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
            autECLPSObj.SendKeys "[enter]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'enter data
            'capture current row in order to be able to position to next line if next crit is same !
            currentrow = autECLPSObj.CursorPosRow
            autECLPSObj.SendKeys "[tab]" & parmsheet.Cells(row, 12) & "[field+]" & parmsheet.Cells(row, 13) & "[field+]" & parmsheet.Cells(row, 14) & "[field+]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'enter supplemental data
            If parmsheet.Cells(row, 16) <> "" Then
            autECLPSObj.SendKeys parmsheet.Cells(row, 15) & "[field+]" & "?"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            'make note of compare field so it can be entered after when pressing enter
            pctoffieldarray(UBound(pctoffieldarray)) = parmsheet.Cells(row, 16)
            ReDim Preserve pctoffieldarray(UBound(pctoffieldarray) + 1)
            Else
            'prepare for next line and position cursor on next row
                Do Until autECLPSObj.CursorPosRow = currentrow + 1
                autECLPSObj.SendKeys "[tab]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                Loop
                
            End If
            'get all iterations of the same criteria
            entryrow = 1
            While Trim(parmsheet.Cells(row + 1, 11)) = prevcriteria
                row = row + 1
                'enter data
                'capture current row in order to be able to position to next line if next crit is same !
                currentrow = autECLPSObj.CursorPosRow
                autECLPSObj.SendKeys "[tab]" & parmsheet.Cells(row, 12) & "[field+]" & parmsheet.Cells(row, 13) & "[field+]" & parmsheet.Cells(row, 14) & "[field+]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                'enter supplemental data
                If parmsheet.Cells(row, 16) <> "" Then
                autECLPSObj.SendKeys parmsheet.Cells(row, 15) & "[field+]" & "?"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                'make note of compare field so it can be entered after when pressing enter
                pctoffieldarray(UBound(pctoffieldarray)) = parmsheet.Cells(row, 16)
                ReDim Preserve pctoffieldarray(UBound(pctoffieldarray) + 1)
                Else
                    Do Until autECLPSObj.CursorPosRow = currentrow + 1
                    autECLPSObj.SendKeys "[tab]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    Loop
                End If
                
                entryrow = entryrow + 1
                If entryrow = 9 Then
                autECLPSObj.SendKeys "[pagedn]"
                autECLOIAObj.WaitForAppAvailable (3000)
                autECLOIAObj.WaitForInputReady (3000)
                totalpgdown = totalpgdown + 1
                entryrow = 0
                End If

            Wend
            
            'take care of pctoffield
            If UBound(pctoffieldarray) > 0 Then
            autECLPSObj.SendKeys "[enter]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            For looppctarray = 0 To UBound(pctoffieldarray) - 1
                found1 = False
                firstpage1 = True
                While found1 = False
                    If firstpage1 Then
                    firstpage1 = False
                    Else
                    autECLPSObj.SendKeys "[pagedn]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    If (autECLOIAObj.InputInhibited = 5) Then Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Champ de comparaison introuvable" & Chr(10) & Chr(10) & "Compare field not found"
                    End If
                frow = 1
                fcol = 1
                found1 = False
                found1 = autECLPSObj.SearchText(pctoffieldarray(looppctarray) & "  ", 1, frow, fcol)
                    If found1 Then
                    autECLPSObj.SendKeys "1[tab]", frow, fcol - 3
                    autECLPSObj.SendKeys "[enter]"
                    autECLOIAObj.WaitForAppAvailable (3000)
                    autECLOIAObj.WaitForInputReady (3000)
                    End If
                Wend
            
            Next
            
            End If
            
            
            autECLPSObj.SendKeys "[enter][enter][pf12]"
            autECLOIAObj.WaitForAppAvailable (3000)
            autECLOIAObj.WaitForInputReady (3000)
            End If
            
        Loop
    'go back all the way up
    Do Until totalpgdown = 0
    autECLPSObj.SendKeys "[pageup]"
    totalpgdown = totalpgdown - 1
    Loop
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    row = row + 1
    Wend
Wend

'return to main report screen only if ranges were processed based on found being modified
If triedtoaddcriteria = True Then autECLPSObj.SendKeys "[pf12][pf12]" Else autECLPSObj.SendKeys "[pf12]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)


'Schedule
autECLPSObj.SendKeys "[pf18]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)

'send criterias
autECLPSObj.SendKeys Trim(parmsheet.Cells(9, 20)) & "[tab]"
autECLPSObj.SendKeys Trim(parmsheet.Cells(10, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(11, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(12, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(13, 20)) & "[field+]"
autECLPSObj.SendKeys Trim(parmsheet.Cells(14, 20))
autECLPSObj.SendKeys Trim(parmsheet.Cells(15, 20))


autECLPSObj.SendKeys "[enter][enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
'set list name if output is 4
If Trim(parmsheet.Cells(9, 20)) = 4 Then
autECLPSObj.SendKeys Left(Trim(parmsheet.Cells(10, 22)), 30) & "[enter]"
autECLOIAObj.WaitForAppAvailable (3000)
autECLOIAObj.WaitForInputReady (3000)
End If


If Trim(parmsheet.Cells(15, 20)) = 2 Then
    autECLPSObj.SendKeys "[pf18]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    autECLPSObj.SendKeys "[backtab][backtab][backtab][backtab][backtab][backtab][backtab]"
    'build day array
    Dim dayarray(6) As String
    Dim inputdayarray() As String
    inputdayarray = Split(parmsheet.Cells(16, 20), ",")
    For loopday = 0 To UBound(inputdayarray)
    dayarray(inputdayarray(loopday) - 1) = "Y"
    Next

    For loopday = 0 To UBound(dayarray)
    If dayarray(loopday) = "Y" Then autECLPSObj.SendKeys "Y" Else autECLPSObj.SendKeys "N"
    Next

    autECLPSObj.SendKeys "[enter][enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    'set list name if output is 4
    If Trim(parmsheet.Cells(9, 20)) = 4 Then
    autECLPSObj.SendKeys Left(Trim(parmsheet.Cells(10, 22)), 30) & "[enter]"
    autECLOIAObj.WaitForAppAvailable (3000)
    autECLOIAObj.WaitForInputReady (3000)
    End If
End If




' return to master menu
autECLPSObj.SendKeys "[pf12][pf12][pf12]"

MsgBox endmessage
End If
End Function

Attribute VB_Name = "Module4"
Sub TrierProduit()
Attribute TrierProduit.VB_ProcData.VB_Invoke_Func = " \n14"

    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    Range("A4:M4").Select
    Selection.Font.ColorIndex = 1
    Range("A5:M5000").Select
    Selection.Font.Bold = False
    Range("A4").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Add Key:= _
        ActiveCell.Range("A5:A5000"), SortOn:=xlSortOnValues, Order:=xlAscending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Article").Sort
        .SetRange Range("A4:M5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.CommandButton1.ForeColor = vbRed
    Range("A4").Select
    Selection.Font.ColorIndex = 3
    Range("A5:A5000").Select
    Selection.Font.Bold = True
    Range("A1").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub TrierNetSlsQty()

    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    Range("A4:M4").Select
    Selection.Font.ColorIndex = 1
    Range("A5:M5000").Select
    Selection.Font.Bold = False
    Range("A4").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Add Key:= _
        ActiveCell.Range("E5:E5000"), SortOn:=xlSortOnValues, Order:=xlDescending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Article").Sort
        .SetRange Range("A4:M5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.CommandButton2.ForeColor = vbRed
    Range("E5:E5000").Select
    Selection.Font.Bold = True
    Range("E4").Select
    Selection.Font.ColorIndex = 3
    Range("A1").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub TrierNetSlsDollars()
Attribute TrierNetSlsDollars.VB_ProcData.VB_Invoke_Func = " \n14"

    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    Range("A4:M4").Select
    Selection.Font.ColorIndex = 1
    Range("A5:M5000").Select
    Selection.Font.Bold = False
    Range("A4").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Add Key:= _
        ActiveCell.Range("F5:F5000"), SortOn:=xlSortOnValues, Order:=xlDescending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Article").Sort
        .SetRange Range("A4:M5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.CommandButton3.ForeColor = vbRed
    Range("F5:F5000").Select
    Selection.Font.Bold = True
    Range("F4").Select
    Selection.Font.ColorIndex = 3
    Range("A1").Select
    ActiveSheet.Protect ("kt38ax")
End Sub
Attribute VB_Name = "Module5"
Sub MiseEnFormeVenteArticle()
Attribute MiseEnFormeVenteArticle.VB_ProcData.VB_Invoke_Func = "f\n14"

     ActiveSheet.Unprotect ("kt38ax")
     Columns("N").Delete
     Range("B5").Select
     Range(Selection, Selection.End(xlToRight)).Select
     Range(Selection, Selection.End(xlDown)).Select
     With Selection
         .HorizontalAlignment = xlCenter
     End With
     ' Faire le quadrillage
      Range("A4").Select
      'Selection.End(xlUp).Select
      Range(Selection, Selection.End(xlToRight)).Select
      Range(Selection, Selection.End(xlDown)).Select
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      Selection.Borders(xlEdgeLeft).LineStyle = xlNone
      Selection.Borders(xlEdgeTop).LineStyle = xlNone
      Selection.Borders(xlEdgeBottom).LineStyle = xlNone
      Selection.Borders(xlEdgeRight).LineStyle = xlNone
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      With Selection.Borders(xlEdgeLeft)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlMedium
      End With
      With Selection.Borders(xlEdgeTop)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlMedium
      End With
      With Selection.Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlMedium
      End With
      With Selection.Borders(xlEdgeRight)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlMedium
      End With
      Selection.Borders(xlInsideVertical).LineStyle = xlNone
      Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
      With Selection.Borders(xlEdgeLeft)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlEdgeTop)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlEdgeRight)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlInsideVertical)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlInsideHorizontal)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlInsideHorizontal)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      Range("A4").Select
      Range(Selection, Selection.End(xlToRight)).Select
      Range(Selection, Selection.End(xlDown)).Select
      ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Clear
      ActiveWorkbook.Worksheets("Vente Article").Sort.SortFields.Add Key:= _
      ActiveCell.Range("A5:A5000"), SortOn:=xlSortOnValues, Order:=xlAscending, _
      DataOption:=xlSortNormal
      With ActiveWorkbook.Worksheets("Vente Article").Sort
        .SetRange Range("A4:M5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
      End With
      'Supprime la colonne "A" avant l'insertion des nouvelles donn|fffd|es
      Sheets("DataFiltrer").Columns("A").Delete
      'Copie la colonne "M" et la recopie dans la feuille "DataFiltrer" et supprime les doublons pour alimenter le ListBox
      Sheets("Vente Article").Range("M5").Select
      Range(Selection, Selection.End(xlDown)).Copy Sheets("DataFiltrer").Columns(1)
      Sheets("DataFiltrer").UsedRange.RemoveDuplicates Columns:=1, Header:=xlNo
      Sheets("DataFiltrer").Activate
      Range("A1").Select
      Range(Selection, Selection.End(xlDown)).Select
      ActiveWorkbook.Worksheets("DataFiltrer").Sort.SortFields.Clear
      ActiveWorkbook.Worksheets("DataFiltrer").Sort.SortFields.Add Key:= _
          ActiveCell.Range("A1:A5000"), SortOn:=xlSortOnValues, Order:=xlAscending, _
          DataOption:=xlSortNormal
      With ActiveWorkbook.Worksheets("DataFiltrer").Sort
          .SetRange Range("A1:A5000")
          .Header = xlYes
          .MatchCase = False
          .Orientation = xlTopToBottom
          .SortMethod = xlPinYin
          .Apply
      End With
      Range("A1").Select
      Sheets("Vente Article").Activate
      Call TrierNetSlsDollars
      Range("A1").Select
End Sub
Attribute VB_Name = "Module6"
Function downloaddata(as400ip As String, user As String, password As String, library As String, file As String, worksheetdownloadto As Worksheet, startcol As Long, startrow As Long, loadheaders As Boolean, Optional sqlstm As String, Optional expcol As Variant) As String
Dim connstr As String

Set conn = CreateObject("adodb.connection")
Set rcd = CreateObject("adodb.recordset")

cnnstr = "DRIVER={Client Access ODBC Driver (32-bit)};SYSTEM=" & as400ip & ";USERID=" & user & ";PWD=" & password & ";ForceTranslation=1"

conn.Open cnnstr
Set rcd.ActiveConnection = conn

If sqlstm = "" Then

Select Case library
Case ""
sqlstm = "SELECT * FROM " & file
Case Else
sqlstm = "SELECT * FROM " & library & "." & file
End Select

End If

rcd.Open sqlstm

'load data
Set flds = rcd.Fields

'check headers if specified
If Not IsMissing(expcol) Then
For i = 0 To flds.Count - 1
If Not (expcol(i) = flds(i).Name) Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "Downloaded data not as expected. Review report selection. " & Chr(10) & Chr(10) & "Transfert de donn|fffd|es incorrect. R|fffd|visez votre s|fffd|lection de donn|fffd|es."
End If
Next i
End If

If loadheaders Then
'load headers
For i = 0 To flds.Count - 1
worksheetdownloadto.Cells(startrow, i + startcol).Value = flds(i).Name
Next i
End If

'load rows
j = startrow
If loadheaders Then j = j + 1

Do While Not (rcd.EOF)

For i = 0 To flds.Count - 1
worksheetdownloadto.Cells(j, i + startcol).Value = flds(i).Value
Next i

rcd.movenext
j = j + 1
Loop

downloaddata = j - 4

If downloaddata = 0 Then
Err.Raise Number:=vbObjectError + 2, Description:=Chr(10) & "No data found for downloading" & Chr(10) & Chr(10) & "Aucune donn|fffd|e |fffd| transf|fffd|rer"
End If

Set rcd = Nothing
Set conn = Nothing
End Function

Function calcip(store As Integer, hostname As String) As String
Dim a, b, c, d, a1, b1, c1, d1 As Integer

a = Int(store / 127.1)
b = Int(a * 127)
c = (a + 60)
d = (store - b) * 2

a1 = Int(store / 128.1)
b2 = Int(a1 * 128)
c1 = (a1 + 240)
d1 = (store - 1 - b1) * 2

Select Case hostname
Case "as400"
calcip = "42." & CStr(c) & "." & CStr(d - 1) & ".13"
End Select

End Function
Attribute VB_Name = "Module7"
Function ClearExcessRowsAndColumns(wksWks As Worksheet) As Boolean
   Dim ar As Range, r As Double, c As Double, tr As Double, tc As Double
   Dim ur As Range, arCount As Integer, i As Integer
   Dim shp As Shape

   On Error Resume Next
      Err.Clear
         r = 0
         c = 0

         'Determine if the sheet contains both formulas and constants
         Set ur = Union(wksWks.UsedRange.SpecialCells(xlCellTypeConstants), _
               wksWks.UsedRange.SpecialCells(xlCellTypeFormulas))
         'If both fails, try constants only
         If Err.Number = 1004 Then
            Err.Clear
            Set ur = wksWks.UsedRange.SpecialCells(xlCellTypeConstants)
         End If
         'If constants fails then set it to formulas
         If Err.Number = 1004 Then
            Err.Clear
            Set ur = wksWks.UsedRange.SpecialCells(xlCellTypeFormulas)
         End If
         'If there is still an error then the worksheet is empty
         If Err.Number <> 0 Then
            Err.Clear
            If wksWks.UsedRange.Address <> "$A$1" Then
               ur.EntireRow.Delete
            Else
               Set ur = Nothing
            End If
         End If
         'On Error GoTo 0
         If Not ur Is Nothing Then
            arCount = ur.Areas.Count
            'determine the last column and row that contains data or formula
            For Each ar In ur.Areas
               i = i + 1
               tr = ar.Range("A1").row + ar.Rows.Count - 1
               tc = ar.Range("A1").Column + ar.Columns.Count - 1
               If tc > c Then c = tc
               If tr > r Then r = tr
            Next
            'Determine the area covered by shapes
            'so we don't remove shading behind shapes
            For Each shp In wksWks.Shapes
               tr = shp.BottomRightCell.row
               tc = shp.BottomRightCell.Column
               If tc > c Then c = tc
               If tr > r Then r = tr
            Next
            Set ur = wksWks.Rows(r + 1 & ":" & wksWks.Rows.Count)
               ur.Clear
            'Reset row height which can also cause the lastcell to be innacurate
            ur.EntireRow.RowHeight = _
                  wksWks.StandardHeight
            Set ur = wksWks.Range(wksWks.Cells(1, c + 1), _
                  wksWks.Cells(1, 256)).EntireColumn
            'Reset column width which can also cause the lastcell to be innacurate
            ur.EntireColumn.ColumnWidth = _
                  wksWks.StandardWidth
         End If
      On Error GoTo 0
End Function

Attribute VB_Name = "RegSelect"
Attribute VB_Base = "0{FACF6B9F-E8A2-47C5-B8CA-C53556F83F73}{945F3116-87A1-493B-A49D-1CCEE2531EE7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Sub Annuler_Click()
  ActiveSheet.Unprotect ("kt38ax")
  Unload Me
  ActiveSheet.Protect ("kt38ax")
End Sub

Public Sub Filtrer_Click()
 ActiveSheet.Unprotect ("kt38ax")
 ActiveSheet.CommandButton1.ForeColor = vbBlack
 ActiveSheet.CommandButton2.ForeColor = vbBlack
 ActiveSheet.CommandButton3.ForeColor = vbBlack
 ActiveSheet.CommandButton4.ForeColor = vbBlack
 Range("A4:M4").Select
 Selection.Font.ColorIndex = 1
 Range("A5:M5000").Select
 Selection.Font.Bold = False
 Application.ScreenUpdating = False
 Set d = CreateObject("scripting.dictionary")
 Set f = Sheets("Vente article")
 For i = 0 To Me.ListBox1.ListCount - 1
     If Me.ListBox1.Selected(i) = True Then d(Me.ListBox1.List(i)) = ""
 Next i
 If d.Count > 0 Then
   For Each c In f.Range("M5:M" & f.[M65000].End(xlUp).row)
     c.EntireRow.Hidden = IsError(Application.Match(c, d.keys, 0))
   Next c
 End If
 ActiveSheet.CommandButton4.ForeColor = vbRed
 Range("M5:M5000").Select
 Selection.Font.Bold = True
 Range("M4").Select
 Selection.Font.ColorIndex = 3
 Unload Me
 Range("A1").Select
 ActiveSheet.Protect ("kt38ax")
End Sub

Public Sub UserForm_Initialize()
  ActiveSheet.Unprotect ("kt38ax")
  Me.StartUpPosition = 1
  Sheets("Vente article").Cells.EntireRow.Hidden = False
  nbLignes = Sheets("DataFiltrer").Cells(Rows.Count, "A").End(xlUp).row
  ListBox1.MultiSelect = fmMultiSelectMulti
  ListBox1.List = Sheets("DataFiltrer").Range("A1:A" & nbLignes).Value
  ActiveSheet.Protect ("kt38ax")
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Shapes("Rounded Rectangle 5").Visible = False
Worksheets("Rapport").Unprotect ("kt38ax")
Worksheets("Rapport").Cells(7, 3).Value = ""
Worksheets("Rapport").Cells(9, 3).Value = ""
Worksheets("Rapport").Cells(11, 3).Value = ""
Worksheets("Rapport").Cells(7, 6).Value = ""
Worksheets("Rapport").Cells(9, 6).Value = ""
Worksheets("Rapport").Cells(11, 6).Value = ""
Worksheets("Rapport").Cells(7, 9).Value = ""
Worksheets("Rapport").Cells(9, 9).Value = ""
Worksheets("Rapport").Cells(11, 9).Value = ""
Worksheets("Rapport").Cells(13, 4).Value = ""
Worksheets("Rapport").Cells(13, 9).Value = ""
Worksheets("Rapport").Protect ("kt38ax")
End Sub
Private Sub Workbook_BeforeSave(ByVal SaveAsUi As Boolean, Cancel As Boolean)
ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Shapes("Rounded Rectangle 5").Visible = True
End Sub
Private Sub Workbook_AfterSave(ByVal Success As Boolean)
ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Shapes("Rounded Rectangle 5").Visible = False
End Sub

Private Sub Workbook_Activate()
    Application.DisplayFullScreen = True
    With Worksheets("Vente Cat|fffd|gorie")
        .Unprotect ("kt38ax")
        .Activate
        .Columns("A:S").AutoFit
    .Range("A8:S8").Select
     ActiveWindow.Zoom = 80
    .Columns("A:S").AutoFit
    .Range("A8:S8").Select
     ActiveWindow.Zoom = True
    .Range("A6").Select
    .Protect ("kt38ax")
    End With
End Sub


Sub Trier_Quotidien_Diff_Plus_Dollars()
Attribute Trier_Quotidien_Diff_Plus_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"

    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "F9:F93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton5.ForeColor = vbRed
    Range("F8").Select
    Selection.Font.ColorIndex = 3
    Range("F9:F93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Quotidien_Diff_Moins_Dollars()
Attribute Trier_Quotidien_Diff_Moins_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"

' Trier_Quotidien_Diff_Moins_Dollars Macro
' Touche de raccourci du clavier: Ctrl+Maj+R

    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "F9:F93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton6.ForeColor = vbRed
    Range("F8").Select
    Selection.Font.ColorIndex = 3
    Range("F9:F93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Quotidien_Diff_Plus_Pourcentage()
Attribute Trier_Quotidien_Diff_Plus_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Quotidien_Diff_Plus_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+J
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "G9:G93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton3.ForeColor = vbRed
    Range("G8").Select
    Selection.Font.ColorIndex = 3
    Range("G9:G93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Quotidien_Diff_Moins_Pourcentage()
Attribute Trier_Quotidien_Diff_Moins_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Quotidien_Diff_Moins_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+R
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Selection.Font.ColorIndex = 1
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "G9:G93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton4.ForeColor = vbRed
    Range("G8").Select
    Selection.Font.ColorIndex = 3
    Range("G9:G93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Quotidien_2019()
Attribute Trier_Quotidien_2019.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Quotidien_2019 Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+Q
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "D9:D93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton2.ForeColor = vbRed
    Range("D8").Select
    Selection.Font.ColorIndex = 3
    Range("D9:D93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Semaine_Diff_Plus_Pourcentage()
Attribute Trier_Semaine_Diff_Plus_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Semaine_Diff_Plus_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+T
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "K9:K93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton8.ForeColor = vbRed
    Range("K8").Select
    Selection.Font.ColorIndex = 3
    Range("K9:K93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Semaine_Diff_Moins_Pourcentage()
Attribute Trier_Semaine_Diff_Moins_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Semaine_Diff_Moins_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+Y
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "K9:K93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton9.ForeColor = vbRed
    Range("K8").Select
    Selection.Font.ColorIndex = 3
    Range("K9:K93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Semaine_Diff_Plus_Dollars()
Attribute Trier_Semaine_Diff_Plus_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Semaine_Diff_Plus_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+T
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "J9:J93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton10.ForeColor = vbRed
    Range("J8").Select
    Selection.Font.ColorIndex = 3
    Range("J9:J93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Semaine_Diff_Moins_Dollars()
Attribute Trier_Semaine_Diff_Moins_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Semaine_Diff_Moins_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+Y
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "J9:J93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton11.ForeColor = vbRed
    Range("J8").Select
    Selection.Font.ColorIndex = 3
    Range("J9:J93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Semaine_2019()
Attribute Trier_Semaine_2019.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Semaine_2019 Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+S
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "H9:H93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton7.ForeColor = vbRed
    Range("H8").Select
    Selection.Font.ColorIndex = 3
    Range("H9:H93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Annee_Diff_Plus_Pourcentage()
Attribute Trier_Annee_Diff_Plus_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Annee_Diff_Plus_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+E
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "O9:O93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton13.ForeColor = vbRed
    Range("O8").Select
    Selection.Font.ColorIndex = 3
    Range("O9:O93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Annee_Diff_Moins_Pourcentage()
Attribute Trier_Annee_Diff_Moins_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Annee_Diff_Moins_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+O
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "O9:O93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton14.ForeColor = vbRed
    Range("O8").Select
    Selection.Font.ColorIndex = 3
    Range("O9:O93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Annee_Diff_Plus_Dollars()
Attribute Trier_Annee_Diff_Plus_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Annee_Diff_Plus_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+E
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "N9:N93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton15.ForeColor = vbRed
    Range("N8").Select
    Selection.Font.ColorIndex = 3
    Range("N9:N93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Annee_Diff_Moins_Dollars()
Attribute Trier_Annee_Diff_Moins_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Annee_Diff_Moins_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+O
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "N9:N93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton16.ForeColor = vbRed
    Range("N8").Select
    Selection.Font.ColorIndex = 3
    Range("N9:N93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Annee_2019()
Attribute Trier_Annee_2019.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Annee_2019 Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+A
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "L9:L93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton12.ForeColor = vbRed
    Range("L8").Select
    Selection.Font.ColorIndex = 3
    Range("L9:L93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub


Sub Trier_Inventaire_Diff_Plus_Pourcentage()
Attribute Trier_Inventaire_Diff_Plus_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Inventaire_Diff_Plus_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+D
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "S9:S93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton18.ForeColor = vbRed
    Range("S8").Select
    Selection.Font.ColorIndex = 3
    Range("S9:S93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Inventaire_Diff_Moins_Pourcentage()
Attribute Trier_Inventaire_Diff_Moins_Pourcentage.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Inventaire_Diff_Moins_Pourcentage Macro
'
' Touche de raccourci du clavier: Ctrl+B
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "S9:S93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton19.ForeColor = vbRed
    Range("S8").Select
    Selection.Font.ColorIndex = 3
    Range("S9:S93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Inventaire_2019()
Attribute Trier_Inventaire_2019.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Inventaire_2019 Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+I
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "P9:P93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton17.ForeColor = vbRed
    Range("P8").Select
    Selection.Font.ColorIndex = 3
    Range("P9:P93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Inventaire_Diff_Plus_Dollars()
Attribute Trier_Inventaire_Diff_Plus_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Inventaire_Diff_Plus_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+D
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "R9:R93"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton20.ForeColor = vbRed
    Range("R8").Select
    Selection.Font.ColorIndex = 3
    Range("R9:R93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Inventaire_Diff_Moins_Dollars()
Attribute Trier_Inventaire_Diff_Moins_Dollars.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Inventaire_Diff_Moins_Dollars Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+B
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "R9:R93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton21.ForeColor = vbRed
    Range("R8").Select
    Selection.Font.ColorIndex = 3
    Range("R9:R93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

Sub Trier_Categorie_2019()
Attribute Trier_Categorie_2019.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Trier_Categorie_2019 Macro
'
' Touche de raccourci du clavier: Ctrl+Maj+C
'
    ActiveSheet.Unprotect ("kt38ax")
    ActiveSheet.CommandButton1.ForeColor = vbBlack
    ActiveSheet.CommandButton2.ForeColor = vbBlack
    ActiveSheet.CommandButton3.ForeColor = vbBlack
    ActiveSheet.CommandButton4.ForeColor = vbBlack
    ActiveSheet.CommandButton5.ForeColor = vbBlack
    ActiveSheet.CommandButton6.ForeColor = vbBlack
    ActiveSheet.CommandButton7.ForeColor = vbBlack
    ActiveSheet.CommandButton8.ForeColor = vbBlack
    ActiveSheet.CommandButton9.ForeColor = vbBlack
    ActiveSheet.CommandButton10.ForeColor = vbBlack
    ActiveSheet.CommandButton11.ForeColor = vbBlack
    ActiveSheet.CommandButton12.ForeColor = vbBlack
    ActiveSheet.CommandButton13.ForeColor = vbBlack
    ActiveSheet.CommandButton14.ForeColor = vbBlack
    ActiveSheet.CommandButton15.ForeColor = vbBlack
    ActiveSheet.CommandButton16.ForeColor = vbBlack
    ActiveSheet.CommandButton17.ForeColor = vbBlack
    ActiveSheet.CommandButton18.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton19.ForeColor = vbBlack
    ActiveSheet.CommandButton20.ForeColor = vbBlack
    ActiveSheet.CommandButton21.ForeColor = vbBlack
    Range("B8:S8").Select
    Selection.Font.ColorIndex = 1
    Range("B9:S93").Select
    Selection.Font.Bold = False
    Range("B8:S93").Select
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort.SortFields.Add Key:=Range( _
        "B9:B93"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Vente Cat|fffd|gorie").Sort
        .SetRange Range("B8:S93")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
    ActiveSheet.CommandButton1.ForeColor = vbRed
    Range("B8").Select
    Selection.Font.ColorIndex = 3
    Range("B9:B93").Select
    Selection.Font.Bold = True
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = 80
    'Worksheets("Vente Cat|fffd|gorie").Columns("A:S").AutoFit
    'Range("A8:S8").Select
    'ActiveWindow.Zoom = True
    Range("A6").Select
    ActiveSheet.Protect ("kt38ax")
End Sub

' InQuest injected base64 decoded content
' '%x*

INQUEST-PP=macro
