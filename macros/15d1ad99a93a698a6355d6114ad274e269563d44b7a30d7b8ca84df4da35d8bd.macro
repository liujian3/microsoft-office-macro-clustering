Attribute VB_Name = "Module02"
Option Explicit


Sub PreWork(strOpenFile As String)
' |fffd|^|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||75ce||fffd||182||fffd||fffd||fffd||fffd||fffd|CSV|fffd||349||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83dc||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'  |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||fffd||fffd||182||fffd||fffd||117||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'
  Const WRITEFILENAME As String = "\|fffd||fffd||fffd||fffd||fffd||fffd|.csv"  ' |fffd||fffd||fffd||fffd||fffd||3c3|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|

  Dim objFileSys As Object
  Dim objTextStream As Object
  Dim objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objTextStream = objFileSys.OpenTextFile(strOpenFile, 1)
  Set objWriteStream = objFileSys.OpenTextFile(Environ("TMP") & WRITEFILENAME, 2, True)
 
'----- |fffd|s|fffd|[|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd| -----
  Dim tAll As String             ' |fffd|S|fffd||302||315||fffd||fffd||fffd||fffd||fffd|
  tAll = objTextStream.ReadAll
  
'----- |fffd||1c2||74d||fffd||fffd||742||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd| -----
  objTextStream.Close
  Set objTextStream = Nothing
  
  Dim i As Long  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||3d0||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||742||30f||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||292|u
  Dim j As Long  ' "|fffd|iChr34)|fffd||30c||90||fffd|
  i = 0
  j = 0
  
  Do
    i = i + 1
    If Mid(tAll, i, 1) = Chr(34) Then
      j = j + 1
    End If

    If j Mod 2 <> 0 Then
      If Mid(tAll, i, 1) = vbLf Or Mid(tAll, i, 1) = vbCr Then
      Else
        objWriteStream.Write Mid(tAll, i, 1)
      End If
    Else
      objWriteStream.Write Mid(tAll, i, 1)
    End If
  Loop Until i = Len(tAll)
  
'----- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd| -----
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub


Sub InputCSVFile(FILEPATH As String)
' CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd||83dc||fffd||fffd||fffd||113||1c2||74d||fffd||fffd||781|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F  |fffd||1c2||74d||fffd||fffd||783|^|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd|f|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'
  Call PreWork(FILEPATH)  ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|

  With Worksheets(1).QueryTables.Add(Connection:="TEXT;" & Environ("TMP") & "\|fffd||fffd||fffd||fffd||fffd||fffd|.csv", _
                                     Destination:=Worksheets(1).Range("$A$2"))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 932
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _
                                         2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _
                                         2, 2, 2)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False

  End With

End Sub

Attribute VB_Name = "Module2"
Option Explicit

Sub OpenFukutuPro()
' |fffd||fffd||fffd|R|fffd||289|^|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd|A|fffd||fffd||fffd||fffd||fffd||103|t|fffd|@|fffd|C|fffd||fffd||fffd|J|fffd||fffd||fffd|B
'
  Const FUKUTUCSV As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv"
  Const FUKUTUPRO As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\new|fffd||fffd||fffd||283|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|.xlsm"

  Dim objWShell As Object, objExcel As Object
  Set objWShell = CreateObject("WScript.Shell")
  objWShell.Run "C:\Progra~2\Ass|fffd||fffd||fffd||fffd||fffd|Pro\AssOPJ.exe fukutu011R " & FUKUTUCSV & " 1", vbNormalFocus, False
  Set objWShell = Nothing
  
  Set objExcel = CreateObject("Excel.Application")
  objExcel.Workbooks.Open FUKUTUPRO
  objExcel.Visible = True
  Set objExcel = Nothing

End Sub
Sub DeleteConnections()
' |fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||310||691||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|B
'  |fffd||fffd|Info|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||193||fffd||fffd||c0aa||fffd|d|fffd||fffd||fffd||202||fffd|B
'
  Do While ActiveWorkbook.Connections.Count > 0
    ActiveWorkbook.Connections.Item(ActiveWorkbook.Connections.Count).Delete

  Loop


End Sub
 
Sub DeleteNames()
' |fffd||fffd|`|fffd||316||fffd||fffd|O|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|B
'
'
  Do While ActiveWorkbook.Names.Count > 0
    ActiveWorkbook.Names.Item(ActiveWorkbook.Names.Count).Delete

  Loop

End Sub

Attribute VB_Name = "Module_Main"
Option Explicit

Sub Main()



End Sub


Sub CancelIssu(EXPCOM As String, DELIVERYID As String)
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd|^|fffd||fffd||fffd||fffd||416||fffd|
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd|z|fffd||fffd||fffd|h|fffd|c
'
  Dim strTargetCSVFile As String
  Select Case EXPCOM
   Case "|fffd||fffd||fffd||fffd|}|fffd||fffd|"
     Open CSVFILEPATH_SAGAWA For Input As #1
     strTargetCSVFile = CSVFILEPATH_SAGAWA
   Case "|fffd||fffd||fffd|Z|fffd|^|fffd|A"
     Open CSVFILEPATH_SEINO For Input As #1
     strTargetCSVFile = CSVFILEPATH_SEINO
    Case "|fffd||fffd||fffd|Z|fffd|~|fffd|j"
     Open CSVFILEPATH_SEINO For Input As #1
     strTargetCSVFile = CSVFILEPATH_SEINO
   Case "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A"
     Open CSVFILEPATH_YAMATO For Input As #1
     strTargetCSVFile = CSVFILEPATH_YAMATO
   Case "|fffd||fffd||fffd|R|fffd||289|^"
     Open CSVFILEPATH_FUKUYAMA_MOTO For Input As #1
     strTargetCSVFile = CSVFILEPATH_FUKUYAMA_MOTO
   Case "|fffd||fffd||fffd|R|fffd||289|^|fffd|@|fffd||fffd||fffd||fffd||fffd|"
     Open CSVFILEPATH_FUKUYAMA_DAIB For Input As #1
     strTargetCSVFile = CSVFILEPATH_FUKUYAMA_DAIB
   Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g", "|fffd|X|fffd||583|p|fffd|b|fffd|N", "|fffd|X|fffd||583|p|fffd|b|fffd|N|fffd|@|fffd||fffd||fffd||fffd||fffd|"
     Open CSVFILEPATH_JAPANPOST For Input As #1
     strTargetCSVFile = CSVFILEPATH_JAPANPOST
  End Select

  Dim strTmpCSVFile As String        ' |fffd||a39e||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
  strTmpCSVFile = Environ("TMP") & "\tmpFile100.csv"
  Open strTmpCSVFile For Output As #10

  Dim varOrder As Variant, strTemp As String
  Do
    Line Input #1, strTemp
    varOrder = Split(Replace(strTemp, Chr(34), ""), ",")

    If UBound(varOrder) <> -1 Then
      Select Case EXPCOM
       Case "|fffd||fffd||fffd||fffd|}|fffd||fffd|"
        If varOrder(8) <> DELIVERYID Then    ' |fffd|z|fffd||fffd|ID|fffd||342|X|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If

       Case "|fffd||fffd||fffd|Z|fffd|^|fffd|A"
        If varOrder(1) <> DELIVERYID Then    ' |fffd|z|fffd||fffd|ID|fffd||342|Q|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If
        
        Case "|fffd||fffd||fffd|Z|fffd|~|fffd|j"
        If varOrder(1) <> DELIVERYID Then    ' |fffd|z|fffd||fffd|ID|fffd||342|Q|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If

       Case "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A"
        If varOrder(4) <> DELIVERYID Then    ' |fffd|z|fffd||fffd|ID|fffd||342|T|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If

       Case "|fffd||fffd||fffd|R|fffd||289|^"
        If varOrder(20) <> DELIVERYID Then   ' |fffd|z|fffd||fffd|ID|fffd||342|Q|fffd|P|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If

       Case "|fffd||fffd||fffd|R|fffd||289|^|fffd|@|fffd||fffd||fffd||fffd||fffd|"
        If varOrder(29) <> DELIVERYID Then   ' |fffd|z|fffd||fffd|ID|fffd||342|R|fffd|O|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If

       Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g", "|fffd|X|fffd||583|p|fffd|b|fffd|N", "|fffd|X|fffd||583|p|fffd|b|fffd|N|fffd|@|fffd||fffd||fffd||fffd||fffd|"
        If varOrder(0) <> DELIVERYID Then    ' |fffd|z|fffd||fffd|ID|fffd||342|P|fffd|s|fffd||fffd|
          Print #10, strTemp
        End If
      
    
      End Select

    Else
      Print #10, strTemp

    End If
  Loop Until EOF(1)

  Close #1
  Close #10

  Kill strTargetCSVFile
  FileCopy strTmpCSVFile, strTargetCSVFile

End Sub



Attribute VB_Name = "Module_SQLCode"
Option Explicit

  Const CONNECTIONSTR As String = "Provider=SQLOLEDB; Data source=192.168.2.182,1433; " & _
                                  "Initial Catalog=master; User ID=sa; Password=Yabu1005;"



Sub DataADD(strOrderID As String, strExpCom As String)
' |fffd|^|fffd||fffd||fffd||fffd||402||312||1c9||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'  |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd||fffd|ID|fffd|A|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|^|fffd||fffd||fffd||fffd||fffd|
'
  Dim CN As ADODB.Connection: Set CN = New ADODB.Connection
  Dim RS As ADODB.Recordset:  Set RS = New ADODB.Recordset
  CN.connectionString = CONNECTIONSTR

  Dim strSQLSelect As String
  strSQLSelect = "Select COUNT(ID) As |fffd|o|fffd|^|fffd||fffd||fffd||fffd| From master.dbo.|fffd|m|fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|;"
  Dim strSQLInsert As String
  strSQLInsert = "Insert Into master.dbo.|fffd|m|fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|(|fffd|o|fffd|^|fffd||fffd||fffd||fffd|, |fffd||fffd|ID, |fffd|^|fffd||fffd||fffd||fffd||fffd|) " & _
                 "Values (GetDate(), '" & strOrderID & "', '" & strExpCom & "');"

  Dim countOrders As String  ' |fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd|B
  CN.Open
  CN.BeginTrans

  RS.Open strSQLSelect, CN, adOpenForwardOnly, adLockPessimistic
  If RS.EOF = False Then
    countOrders = RS!|fffd|o|fffd|^|fffd||fffd||fffd||fffd|
    RS.Close
    CN.Execute strSQLInsert

    RS.Open strSQLSelect, CN, adOpenForwardOnly, adLockPessimistic
    If RS!|fffd|o|fffd|^|fffd||fffd||fffd||fffd| = countOrders + 1 Then
      CN.CommitTrans
    Else
      CN.RollbackTrans
    End If
  End If

  RS.Close: Set RS = Nothing
  CN.Close: Set CN = Nothing


End Sub


Sub SQLSelectOut(CSVExpressCom As String)
' |fffd|^|fffd|e|fffd||fffd||fffd|||fffd||a287||fffd||48f|W|fffd|p|fffd||fffd|CSV|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd|@|fffd|o|fffd||350||fffd||303|t|fffd||fffd||fffd|p|fffd|X
'
  Dim strSQLSelect As String
  strSQLSelect = "Set NoCount ON " & _
                 "Select |fffd||fffd|ID, |fffd|^|fffd||fffd||fffd||fffd||fffd| From |fffd|m|fffd||fffd|^|fffd||fffd||fffd||fffd||fffd| " & _
                 "Where |fffd|o|fffd|^|fffd||fffd||fffd||fffd| >= '" & Format(Now(), "Short Date") & "' And |fffd|o|fffd|^|fffd||fffd||fffd||fffd| < '" & Format(DateAdd("d", 1, Now()), "Short Date") & "' " & _
                 "Order By ID ASC;"

  Dim wShell As WshShell
  Set wShell = New WshShell
  wShell.Run "%ComSpec% /c sqlcmd -S 192.168.2.182 -U sa -P Yabu1005 -d master -Q " & Chr(34) & strSQLSelect & Chr(34) & " -s, -W -h -1 -o " & CSVExpressCom, 0, True


End Sub


Attribute VB_Name = "Module_Utils"
Option Explicit

Function SNameToIndex(strSName As String) As Long
' |fffd|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||50d||fffd||fffd||fffd||502||fffd|
'  |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd|T|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|i|fffd||fffd|F"CSV|fffd||fffd||fffd|f|fffd|[|fffd|^"|fffd|j
'  |fffd||502||fffd|l|fffd|F|fffd|@|fffd||fffd||fffd||fffd||a347||fffd||343|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||50d||fffd|, |fffd||202||fffd||fffd||a347||fffd||343|[|fffd||fffd||fffd|B
'
  Dim objWS As Object
  For Each objWS In Worksheets
    If objWS.Name = strSName Then
      SNameToIndex = objWS.Index
      Exit Function
    End If

  Next
  
  SNameToIndex = 0
  
End Function


Sub WorkSheetAdd(strSheetName As String)
' |fffd|V|fffd|[|fffd|g|fffd||16594||fffd||fffd||252||1c9||fffd||fffd||fffd||fffd||103|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||3cd|X|fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|
'
  Dim newWS As Worksheet
  Set newWS = Worksheets.Add(after:=Worksheets(Worksheets.Count))
  newWS.Name = strSheetName
  Set newWS = Nothing

End Sub


Function LastRow(lngWSN As Long, strTargetColumn As String, lngInitNum As Long) As Long
' |fffd|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||50d||fffd||fffd||14e|w|fffd||80b3||fffd||a0bd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||14c||fffd||30d|s|fffd||50d||fffd||fffd||12c82||5c2||fffd|B
'   |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd||fffd||fffd||5c2||fffd|V|fffd|[|fffd|g|fffd||50d||fffd||fffd|i|fffd||fffd|F|fffd|Q|fffd||501|j
'   |fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd||fffd||fffd||5c2||fffd|s|fffd|i|fffd||fffd|F|fffd|`|fffd||fffd|j
'   |fffd||fffd||fffd||fffd||fffd|R|fffd|F|fffd||fffd||fffd||5ce|n|fffd||7c2||fffd|s|fffd||50d||fffd|
'   |fffd||502||fffd|l|fffd|F|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||14c||fffd||30d|s|fffd||50d||fffd|
'
  Dim row_i As Long  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||3d0||fffd||fffd||fffd||fffd||fffd||44d|s|fffd||fffd|
  row_i = lngInitNum
  Do Until IsEmpty(Sheets(lngWSN).Range(strTargetColumn & CStr(row_i)).Value)
    row_i = row_i + 1
  Loop

  If row_i = 1 Then
    LastRow = 0
  Else
    LastRow = row_i - 1
  End If

End Function


Function LastColumn(lngWSN As Long, lngTargetRow As Long, lngInitNum As Long) As Long
' |fffd|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||50d||fffd||fffd||14e|w|fffd||80b3||fffd||a0bd||fffd|s|fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||14c||fffd||317||fffd||50d||fffd||fffd||12c82||5c2||fffd|B
'   |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd||fffd||fffd||5c2||fffd|V|fffd|[|fffd|g|fffd||50d||fffd||fffd|i|fffd||fffd|F|fffd|Q|fffd||501|j
'   |fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd||fffd||fffd||5c2||fffd|s|fffd|i|fffd||fffd|F|fffd|T|fffd||501|j
'   |fffd||fffd||fffd||fffd||fffd|R|fffd|F|fffd||fffd||fffd||5ce|n|fffd||7c2||fffd||fffd||50d||fffd||fffd|i|fffd||fffd|F|fffd|P|fffd||fffd||681|j
'   |fffd||502||fffd|l|fffd|F|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||14c||fffd||317||fffd||50d||fffd|

  Dim i As Long, j As Long  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||3d0||fffd||fffd||fffd||fffd||fffd||457||fffd|
  i = lngInitNum
  j = 1
  Do Until IsEmpty(Sheets(lngWSN).Cells(lngTargetRow, i).Value)
    i = i + 1
    j = j + 1
  Loop

  If j = 1 Then
    LastColumn = 0
  Else
    LastColumn = j - 1
  End If

End Function

Function BookCheck(strBookName As String) As Boolean
' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
'   |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd|u|fffd|b|fffd|N|fffd||316||fffd||fffd|O|fffd|i|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|j
'   |fffd||502||fffd|l|fffd|F|fffd|@|fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd| True|fffd|A|fffd||82||fffd||fffd||102||fffd||fffd||fffd||fffd| False
' |fffd||fffd||fffd||fffd||fffd||4c1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||30a|g|fffd||fffd||fffd|q|fffd||343|V|fffd|X|fffd|e|fffd||fffd||fffd||24f||fffd||fffd||fffd|

  Dim i As Long
  For i = 1 To Application.Workbooks.Count
    If Workbooks(i).Name = strBookName Then
      BookCheck = True
      Exit For
    Else
      BookCheck = False
    End If
  Next
  
End Function


Function ColToNum(strColumn As String) As Long
' |fffd|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd|\|fffd|L|fffd||317||fffd||502||1050e||fffd||fffd||314||50d||fffd||fffd||fffd||fffd||fffd|B
'   |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||317||fffd||50d||fffd||fffd|i|fffd||fffd|F"B"|fffd|j
'   |fffd||502||fffd|l|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|\|fffd|L|fffd||317||fffd||50d||fffd|
'
  ColToNum = Range(strColumn & "1").Column
  
End Function
Attribute VB_Name = "Module_|fffd|^|fffd||fffd||fffd||fffd||40f||fffd||fffd||fffd|"
Option Explicit


'### |fffd|o|fffd||350||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd| #######################
  Public CSVFILEPATH_SEINO As String           ' |fffd||fffd||fffd|Z|fffd|^|fffd|A
  Public CSVFILEPATH_SAGAWA As String          ' |fffd||fffd||fffd||fffd|}|fffd||fffd|
  Public CSVFILEPATH_YAMATO As String          ' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A
  Public CSVFILEPATH_JAPANPOST As String       ' |fffd||fffd||fffd|{|fffd|X|fffd||fffd|
  Public CSVFILEPATH_FUKUYAMA_MOTO As String   ' |fffd||fffd||fffd|R|fffd||289|^ |fffd||fffd||fffd||fffd||fffd||fffd|
  Public CSVFILEPATH_FUKUYAMA_DAIB As String   ' |fffd||fffd||fffd|R|fffd||289|^ |fffd||fffd||fffd||fffd||fffd|


Sub CSVFileCreates()
'
'
'### |fffd|e|fffd|^|fffd||fffd||fffd||fffd||402||30e||635e||fffd|pCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c| #####
  Call CSVFileCreate_JapanPost(CSVFILEPATH_JAPANPOST)
  Call CSVFileCreate_SagawaExp(CSVFILEPATH_SAGAWA)
  Call CSVFileCreate_SeinoTrans(CSVFILEPATH_SEINO)
  Call CSVFileCreate_FukuyamaExp(CSVFILEPATH_FUKUYAMA_MOTO, CSVFILEPATH_FUKUYAMA_DAIB)
  Call CSVFileCreate_YamatoTrans(CSVFILEPATH_YAMATO)


End Sub


Sub CSVFileCreate_JapanPost(CSVFileName As String)
' |fffd||fffd||fffd|{|fffd|X|fffd||582||30a||fffd|{|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' CSV|fffd||302|P|fffd|s|fffd||682||30d||fffd||fffd||696||fffd||fffd||fffd||fffd||c42c||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'
  Dim row_i As Long
  Dim strRow As String
  Dim lngLastRowNumber As Long

  With Worksheets(2)
    lngLastRowNumber = LastRow(2, "A", 1)

    For row_i = 2 To lngLastRowNumber
     If row_i = lngLastRowNumber Then
       strRow = strRow & Chr(34) & .Cells(row_i, 1).Value & Chr(34) & vbCrLf
     Else
       strRow = strRow & Chr(34) & .Cells(row_i, 1).Value & Chr(34) & Chr(44)
     End If
    Next
  End With

  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CSVFileName, 2, True)
  objWriteStream.Write (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub

Sub CSVFileCreate_FukuyamaExp(Moto_CSVFileName As String, Dai_CSVFileName As String)
' |fffd||fffd||fffd|R|fffd||289|^|fffd||30a||fffd|{|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||30d||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")

  Set objWriteStream = objFileSys.OpenTextFile(Moto_CSVFileName, 2, True)
  objWriteStream.Close
  Set objWriteStream = objFileSys.OpenTextFile(Dai_CSVFileName, 2, True)
  objWriteStream.Write (vbCrLf)  ' |fffd||fffd||fffd||fffd||fffd||fffd|P|fffd|s|fffd||682||34b||fffd|s
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub


Sub CSVFileCreate_SagawaExp(CSVFileName As String)
' |fffd||fffd||fffd||fffd|}|fffd||582||30a||fffd|{|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CSVFileName, 2, True)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub



Sub CSVFileCreate_SeinoTrans(CSVFileName As String)
' |fffd||fffd||fffd|Z|fffd|^|fffd|A|fffd||30a||fffd|{|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CSVFileName, 2, True)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub


Sub CSVFileCreate_YamatoTrans(CSVFileName As String)
' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd||30a||fffd|{|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||c42c||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||141|j
'
  Dim row_i As Long
  Dim strRow As String
  Dim lngLastRowNumber As Long

  With Worksheets(2)
    lngLastRowNumber = LastRow(2, "B", 1)

    For row_i = 2 To lngLastRowNumber
     If row_i = lngLastRowNumber Then
       strRow = strRow & Chr(34) & .Cells(row_i, 2).Value & Chr(34) & vbCrLf
     Else
       strRow = strRow & Chr(34) & .Cells(row_i, 2).Value & Chr(34) & Chr(44)
     End If
    Next
  End With

  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CSVFileName, 2, True)
  objWriteStream.Write (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing

End Sub


Sub CSVFileOut_FukuyamaExp_Daibiki(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|R|fffd||289|^|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd||fffd||fffd||342||fffd||fffd||65bc|
    strRow = Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    If InStr(1, .Cells(RowNumber, 3).Value, "-") Then
      strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44)
    Else
      strRow = strRow & Chr(34) & Mid(.Cells(RowNumber, 3).Value, 1, 3) & "-" & Mid(.Cells(RowNumber, 3).Value, 4, 7) & Chr(34) & Chr(44)
    End If
    ' |fffd|Z|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 6).Value & Chr(34) & Chr(44)
    ' |fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd|w|fffd||fffd||fffd|
    If .Cells(RowNumber, 28).Value <> "" Then
      strRow = strRow & Chr(34) & "|fffd|z|fffd|B|fffd|w|fffd||fffd||fffd||fffd|F|fffd|@" & Mid(.Cells(RowNumber, 28).Value, 6) & Chr(34) & Chr(44)
    Else
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    End If
    ' |fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd|z|fffd|B|fffd|w|fffd||839e||fffd||501|F|fffd||7d1|O|fffd||fffd|" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd|z|fffd|B|fffd|w|fffd||839e||fffd||501|F|fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd|z|fffd|B|fffd|w|fffd||839e||fffd||501|F|fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd|z|fffd|B|fffd|w|fffd||839e||fffd||501|F|fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    End Select
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)
    ' |fffd||90||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 25).Value & Chr(34) & Chr(44)
    ' |fffd|o|fffd||5d7|\|fffd||fffd||fffd|
    strRow = strRow & Chr(34) & Format(Now, "YYYY/MM/DD") & Chr(34) & Chr(44)
    
    For count_j = 1 To 4
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44)

    For count_j = 1 To 7
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd|d|fffd||28e|w|fffd||fffd|
    strRow = strRow & Chr(34) & "10" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|^|fffd|e|fffd||fffd||fffd||ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 43).Value & Chr(34) & Chr(44)
    ' |fffd|z|fffd||fffd|ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34)

  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub


Sub CSVFileOut_SagawaExp(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd||fffd|}|fffd||582||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd|Z|fffd||fffd||fffd|^|fffd|R|fffd|[|fffd|h|fffd|i|fffd||fffd||fffd||fffd||202||fffd||fffd||18e||635e||fffd||fffd||fffd||255||22ae||fffd||fffd||fffd||fffd||fffd|j
    strRow = Chr(34) & Replace(.Cells(RowNumber, 2).Value, "-", "") & Chr(34) & Chr(44)
    ' |fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44)
    ' |fffd|Z|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 4).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 5).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 6).Value & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|t|fffd||65bc||fffd|i|fffd|t|fffd||fffd||fffd|K|fffd|i|fffd||34f||fffd||fffd||fffd||fffd|j
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd||fffd|ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44)
    
    For count_j = 1 To 10
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)
    For count_j = 1 To 4
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||90||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 25).Value & Chr(34) & Chr(44)
    ' |fffd||58e||fffd||781|i|fffd||fffd|r|fffd||fffd|z|fffd||582||14c||152||fffd|j
    strRow = strRow & Chr(34) & "000" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd|
    strRow = strRow & Chr(34) & Replace(.Cells(RowNumber, 28).Value, "/", "") & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd||50e|w|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 29).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)
    
    For count_j = 1 To 8
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' SRC|fffd||656a||fffd|i|fffd|w|fffd||fffd||202||fffd||fffd||14c||152||fffd|j
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||656a||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||14c||152||fffd|j
    strRow = strRow & Chr(34) & "1" & Chr(34) & Chr(44)
    ' |fffd|^|fffd|e|fffd||fffd||fffd||ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 43).Value & Chr(34)

  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub


Sub CSVFileOut_SeinoTrans(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|Z|fffd|^|fffd|A|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object

  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim tmpAdd As String
  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    strRow = Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Format(Now, "YYYYMMDD") & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd||fffd|ID
    If frmSelectExpCom.opExp8.Value = True Then
      strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & "1" & Chr(34) & Chr(44) & Chr(34) & "1" & Chr(34) & Chr(44)
    ElseIf frmSelectExpCom.opExp9.Value = True Then
      strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & "1" & Chr(34) & Chr(44) & Chr(34) & "3" & Chr(34) & Chr(44)
    End If
    ' |fffd||90||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 25).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|d|fffd||281|i|fffd||752||fffd|T|fffd|L|fffd||fffd||fffd|j
    strRow = strRow & Chr(34) & "5" & Chr(34) & Chr(44)

    For count_j = 1 To 8
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd|X|fffd||594||50d||fffd||fffd||191||fffd||fffd|t|fffd||65bc||fffd||fffd|
    strRow = strRow & Chr(34) & Replace(.Cells(RowNumber, 3).Value, "-", "") & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|t|fffd||fffd|Z|fffd||fffd|
    tmpAdd = .Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & .Cells(RowNumber, 6).Value
    strRow = strRow & Chr(34) & Mid(tmpAdd, 1, 29) & Chr(34) & Chr(44) & Chr(34) & Mid(tmpAdd, 30) & Chr(34) & Chr(44)
    ' |fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44)

    For count_j = 1 To 8
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next

    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)

    For count_j = 1 To 3
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next

    ' |fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd||fffd||fffd||50e|w|fffd||fffd|F|fffd|y|fffd||7d1|O|fffd||fffd||fffd|z" & Chr(34) & Chr(44)
     Case "12" ' |fffd|P|fffd|Q|fffd|||fffd|P|fffd|S|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd||fffd||fffd||50e|w|fffd||fffd|F|fffd|y|fffd|P|fffd|Q|fffd|`|fffd|P|fffd|S|fffd||fffd||fffd|z" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd||fffd||fffd||50e|w|fffd||fffd|F|fffd|y|fffd|P|fffd|S|fffd|`|fffd|P|fffd|U|fffd||fffd||fffd|z" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd||fffd||fffd||50e|w|fffd||fffd|F|fffd|y|fffd|P|fffd|U|fffd|`|fffd|P|fffd|W|fffd||fffd||fffd|z" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
      strRow = strRow & Chr(34) & "|fffd||fffd||fffd||50e|w|fffd||fffd|F|fffd|y|fffd|P|fffd|W|fffd|`|fffd|Q|fffd|O|fffd||fffd||fffd|z" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    End Select

    ' |fffd||fffd||fffd|t|fffd|w|fffd||fffd|
    If .Cells(RowNumber, 28).Value <> "" Then
      strRow = strRow & Chr(34) & Mid(Replace(.Cells(RowNumber, 28).Value, "/", ""), 5)

      Select Case .Cells(RowNumber, 29).Value
       Case "01"                   ' |fffd||7d1|O|fffd||fffd|
        strRow = strRow & "1" & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & "02" & Chr(34) & Chr(44)
       Case "12", "14", "16", "04" ' |fffd||7cc||fffd|
        strRow = strRow & "2" & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & "02" & Chr(34) & Chr(44)
       Case Else                   ' |fffd|w|fffd||fffd||202||fffd|
        strRow = strRow & "0" & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & "02" & Chr(34) & Chr(44)
      End Select
    ElseIf .Cells(RowNumber, 29).Value <> "" Then
      Select Case .Cells(RowNumber, 29).Value
       Case "01"                   ' |fffd||7d1|O|fffd||fffd|
        strRow = strRow & Chr(34) & "00001" & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & "02" & Chr(34) & Chr(44)
       Case "12", "14", "16", "04" ' |fffd||7cc||fffd|
        strRow = strRow & Chr(34) & "00002" & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & "02" & Chr(34) & Chr(44)
      End Select
    Else
      strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & "03" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    End If

    For count_j = 1 To 2
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34)
    
  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub

Sub CSVFileOut_YamatoTrans(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd|o|fffd||5d7|\|fffd||fffd||fffd|
    strRow = Chr(34) & Format(Now, "YYYY/MM/DD") & Chr(34) & Chr(44)
    ' |fffd|z|fffd||fffd|ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|O|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|Q|fffd|A|fffd|l|fffd|R|fffd|||fffd|X|fffd|F|fffd|V|fffd|A|fffd|R|fffd||fffd||fffd|p|fffd|N|fffd|g|fffd|F|fffd|W|fffd|A|fffd|R|fffd||fffd||fffd|p|fffd|N|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|X|fffd|j
    If .Cells(RowNumber, 31).Value = "" Then
      If frmSelectExpCom.opExp3.Value = True Then       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd||58e|w|fffd||fffd|
        strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
      ElseIf frmSelectExpCom.opExp7.Value = True Then   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd||fffd||fffd|p|fffd|N|fffd|g|fffd|w|fffd||fffd|
        strRow = strRow & Chr(34) & "8" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
      ElseIf frmSelectExpCom.opExp4.Value = True Then   ' |fffd|l|fffd|R|fffd|||fffd|X
        strRow = strRow & Chr(34) & "7" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
      End If

    Else
      If frmSelectExpCom.opExp3.Value = True Then       ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd||58e|w|fffd||fffd|
        strRow = strRow & Chr(34) & "2" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
      ElseIf frmSelectExpCom.opExp7.Value = True Then   ' |fffd||fffd||fffd||fffd||fffd||fffd|R|fffd||fffd||fffd|p|fffd|N|fffd|g|fffd|w|fffd||fffd|
        strRow = strRow & Chr(34) & "9" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
      End If

    End If
    ' |fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|t|fffd||65bc||fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & Replace(.Cells(RowNumber, 3).Value, "-", "") & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|t|fffd||fffd|Z|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & Chr(34) & Chr(44)
    strRow = strRow & Chr(34) & .Cells(RowNumber, 6).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)

    For count_j = 1 To 13
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)

    For count_j = 1 To 5
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd|
    strRow = strRow & Chr(34) & Replace(.Cells(RowNumber, 28).Value, "/", "") & Chr(34) & Chr(44)

    ' |fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
      strRow = strRow & Chr(34) & "0812" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
      strRow = strRow & Chr(34) & "1416" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
      strRow = strRow & Chr(34) & "1618" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
      strRow = strRow & Chr(34) & "1820" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    End Select

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)

    For count_j = 1 To 30
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd|ID
    strRow = strRow & Chr(34) & .Cells(RowNumber, 43).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34)


  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub



Sub CSVFileOut_FukuyamaExp_Motobarai(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|R|fffd||289|^|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd|d|fffd|b|fffd||50d||fffd||fffd||18f|Z|fffd||fffd|
    strRow = Chr(34) & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & .Cells(RowNumber, 6).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd|O
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||5d1||fffd||fffd|l|fffd|R|fffd|[|fffd|h|fffd|i|fffd||2d7||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|j|fffd||18c||90||fffd|
    strRow = strRow & Chr(34) & "0849435102" & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 25).Value & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
      strRow = strRow & Chr(34) & "100" & Chr(34) & Chr(44) & Chr(34) & "110" & Chr(34) & Chr(44)
     Case "12" ' |fffd|P|fffd|Q|fffd|||fffd|P|fffd|S|fffd||fffd|
      strRow = strRow & Chr(34) & "100" & Chr(34) & Chr(44) & Chr(34) & "112" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
      strRow = strRow & Chr(34) & "100" & Chr(34) & Chr(44) & Chr(34) & "114" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
      strRow = strRow & Chr(34) & "100" & Chr(34) & Chr(44) & Chr(34) & "116" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
      strRow = strRow & Chr(34) & "100" & Chr(34) & Chr(44) & Chr(34) & "118" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
      strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    End Select
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd|
    strRow = strRow & Chr(34) & Replace(.Cells(RowNumber, 28).Value, "/", "") & Chr(34) & Chr(44)
    ' |fffd|z|fffd||fffd||fffd|h|fffd|c
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "1" & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Format(Now, "YYYYMMDD") & Chr(34) & Chr(44) & Chr(34) & Chr(34)
 
  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub



Sub CSVFileOut_JapanPost_Yupacket(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|{|fffd|X|fffd||581|i|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd|j|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd||fffd||fffd|q|fffd|l|fffd||1d7||fffd||fffd||50d||fffd||fffd|i|fffd|z|fffd||fffd|ID|fffd|j
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|
    strRow = strRow & Chr(34) & Format(Now, "YYYY/MM/DD") & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||58e||fffd||fffd|
    strRow = strRow & Chr(34) & "9" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd|or|fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "1800800001" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44)
    ' #######  |fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd|i|fffd||c42c||fffd||481|F|fffd||fffd||fffd||fffd||fffd|j###############
    Dim i As Long, cnt As Long, s_pos As Long
    cnt = 0
    Dim myAddress As String, str As String
    myAddress = Trim(.Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & .Cells(RowNumber, 6).Value)
    Do While Len(myAddress) > 25
      cnt = cnt + 1
            
      If Mid(myAddress, 25, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 25, 1) Like "[|fffd||]" Then     '|fffd|O-|fffd|X|fffd||181|||fffd||302||754||fffd||fffd||fffd||fffd||fffd|
        If Mid(myAddress, 26, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 26, 1) Like "[|fffd||]" Then   '|fffd|Q|fffd|T|fffd||182|Q|fffd|U|fffd||30b||fffd||fffd||fffd|

          ' ########  |fffd||fffd||fffd||fffd||fffd||181|u0-9, -|fffd|v|fffd||30b||fffd||fffd||694||fffd||fffd|f  ############
          For i = 24 To 2 Step -1
            str = Mid(myAddress, i, 1)                             ' |fffd|P|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
            If str Like "[|fffd|O-|fffd|X]" Or str Like "[|fffd||]" Then
            Else
              s_pos = i
              Exit For
            End If
          Next i
                
          strRow = strRow & Chr(34) & Left(myAddress, s_pos) & Chr(34) & Chr(44)  '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd||38f||fffd|
          myAddress = Mid(myAddress, s_pos + 1, Len(myAddress) - s_pos)           '|fffd|c|fffd||fffd|
        Else
          strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)     '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|T|fffd||fffd||fffd|@|fffd||38f||6ca|O
          myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                 '|fffd|c|fffd||fffd|
        End If
      Else
        strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)       '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|A|fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|}|fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|@|fffd|`|fffd|Q|fffd|O|fffd|U|fffd|@|fffd||38f||6ca|O
        myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                   '|fffd|c|fffd||fffd|
      End If
    Loop
     
    strRow = strRow & Chr(34) & myAddress & Chr(34) & Chr(44)      '|fffd||14c||fffd|

    ' |fffd|Z|fffd||fffd||fffd|Q|fffd|A|fffd|R|fffd||316||fffd||fffd||7cd||fffd||fffd|
    Select Case cnt
     Case 0
       strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
     Case 1
       strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    End Select
    ' ####################################################

    ' |fffd||fffd||fffd||342||fffd||fffd||65bc||fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 8).Value & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||342||fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & StrConv(.Cells(RowNumber, 2).Value, vbNarrow) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    For count_j = 1 To 31
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd|T|fffd|C|fffd|Y|fffd||656a|
    strRow = strRow & Chr(34) & "30" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd||50e|w|fffd||fffd|
    strRow = strRow & Chr(34) & "00" & Chr(34) & Chr(44)
    For count_j = 1 To 17
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next

    ' |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||681|i|fffd|d|fffd|b|fffd|T|fffd|C|fffd|g|fffd||30e||d2354||50d||fffd||fffd|j
    strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    For count_j = 1 To 14
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)

    For count_j = 1 To 3
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)

    For count_j = 1 To 15
      If count_j = 15 Then
        strRow = strRow & Chr(34) & Chr(34)
      Else
        strRow = strRow & Chr(34) & Chr(34) & Chr(44)
      End If
    Next
  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing

End Sub

Sub CSVFileOut_JapanPost_Daibiki(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|{|fffd|X|fffd||581|i|fffd|X|fffd|p|fffd|b|fffd|N|fffd||311||fffd||fffd||fffd||fffd||fffd|j|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd||fffd||fffd|q|fffd|l|fffd||1d7||fffd||fffd||50d||fffd||fffd|i|fffd|z|fffd||fffd|ID|fffd|j
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|
    strRow = strRow & Chr(34) & Format(Now, "YYYY/MM/DD") & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||58e||fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd|or|fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "2" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||297|X|fffd||595||fffd||fffd||314|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "1100783003" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44)
    ' #######  |fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd|i|fffd||c42c||fffd||481|F|fffd||fffd||fffd||fffd||fffd|j###############
    Dim i As Long, cnt As Long, s_pos As Long
    cnt = 0
    Dim myAddress As String, str As String
    myAddress = Trim(.Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & .Cells(RowNumber, 6).Value)
    Do While Len(myAddress) > 25
      cnt = cnt + 1
            
      If Mid(myAddress, 25, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 25, 1) Like "[|fffd||]" Then     '|fffd|O-|fffd|X|fffd||181|||fffd||302||754||fffd||fffd||fffd||fffd||fffd|
        If Mid(myAddress, 26, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 26, 1) Like "[|fffd||]" Then   '|fffd|Q|fffd|T|fffd||182|Q|fffd|U|fffd||30b||fffd||fffd||fffd|

          ' ########  |fffd||fffd||fffd||fffd||fffd||181|u0-9, -|fffd|v|fffd||30b||fffd||fffd||694||fffd||fffd|f  ############
          For i = 24 To 2 Step -1
            str = Mid(myAddress, i, 1)                             ' |fffd|P|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
            If str Like "[|fffd|O-|fffd|X]" Or str Like "[|fffd||]" Then
            Else
              s_pos = i
              Exit For
            End If
          Next i
                
          strRow = strRow & Chr(34) & Left(myAddress, s_pos) & Chr(34) & Chr(44)  '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd||38f||fffd|
          myAddress = Mid(myAddress, s_pos + 1, Len(myAddress) - s_pos)           '|fffd|c|fffd||fffd|
        Else
          strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)     '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|T|fffd||fffd||fffd|@|fffd||38f||6ca|O
          myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                 '|fffd|c|fffd||fffd|
        End If
      Else
        strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)       '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|A|fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|}|fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|@|fffd|`|fffd|Q|fffd|O|fffd|U|fffd|@|fffd||38f||6ca|O
        myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                   '|fffd|c|fffd||fffd|
      End If
    Loop
     
    strRow = strRow & Chr(34) & myAddress & Chr(34) & Chr(44)      '|fffd||14c||fffd|

    ' |fffd|Z|fffd||fffd||fffd|Q|fffd|A|fffd|R|fffd||316||fffd||fffd||7cd||fffd||fffd|
    Select Case cnt
     Case 0
       strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
     Case 1
       strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    End Select
    ' ####################################################

    ' |fffd||fffd||fffd||342||fffd||fffd||65bc||fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 8).Value & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||342||fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    For count_j = 1 To 31
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd|T|fffd|C|fffd|Y|fffd||656a|
    strRow = strRow & Chr(34) & "060" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    If .Cells(RowNumber, 28).Value <> "" Then
      strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 28).Value & Chr(34) & Chr(44)
    Else
      strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    End If
  
    ' |fffd|z|fffd|B|fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
       strRow = strRow & Chr(34) & "51" & Chr(34) & Chr(44)
     Case "12" ' |fffd|P|fffd|Q|fffd|||fffd|P|fffd|S|fffd||fffd|
       strRow = strRow & Chr(34) & "52" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
       strRow = strRow & Chr(34) & "53" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
       strRow = strRow & Chr(34) & "54" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
       strRow = strRow & Chr(34) & "55" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
       strRow = strRow & Chr(34) & "00" & Chr(34) & Chr(44)
    End Select

    For count_j = 1 To 17
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next

    ' |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||681|i|fffd|d|fffd|b|fffd|T|fffd|C|fffd|g|fffd||30e||d2354||50d||fffd||fffd|j
    strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    For count_j = 1 To 14
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)

    For count_j = 1 To 3
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)

    For count_j = 1 To 15
      If count_j = 15 Then
        strRow = strRow & Chr(34) & Chr(34)
      Else
        strRow = strRow & Chr(34) & Chr(34) & Chr(44)
      End If
    Next
  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing


End Sub



Sub CSVFileOut_JapanPost_Motobarai(CsvFilePath As String, RowNumber As Long)
' |fffd||fffd||fffd|{|fffd|X|fffd||581|i|fffd|X|fffd|p|fffd|b|fffd|N|fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||253||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B
' |fffd|f|fffd|[|fffd|^|fffd||c42c||fffd|{|fffd||302||302||741|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||1c9||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||30d|s|fffd||50d||fffd|
'
  Dim strRow As String
  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CsvFilePath, 8, True)

  Dim row_i As Long, count_j As Long
  With Worksheets(1)
    ' |fffd||fffd||fffd|q|fffd|l|fffd||1d7||fffd||fffd||50d||fffd||fffd|i|fffd|z|fffd||fffd|ID|fffd|j
    strRow = strRow & Chr(34) & .Cells(RowNumber, 9).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|
    strRow = strRow & Chr(34) & Format(Now, "YYYY/MM/DD") & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||58e||fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd|or|fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||297|X|fffd||582||314|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    strRow = strRow & Chr(34) & "1100783001" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|X|fffd||594||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 3).Value & Chr(34) & Chr(44)
    ' #######  |fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd|i|fffd||c42c||fffd||481|F|fffd||fffd||fffd||fffd||fffd|j###############
    Dim i As Long, cnt As Long, s_pos As Long
    cnt = 0
    Dim myAddress As String, str As String
    myAddress = Trim(.Cells(RowNumber, 4).Value & .Cells(RowNumber, 5).Value & .Cells(RowNumber, 6).Value)
    Do While Len(myAddress) > 25
      cnt = cnt + 1
            
      If Mid(myAddress, 25, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 25, 1) Like "[|fffd||]" Then     '|fffd|O-|fffd|X|fffd||181|||fffd||302||754||fffd||fffd||fffd||fffd||fffd|
        If Mid(myAddress, 26, 1) Like "[|fffd|O-|fffd|X]" Or Mid(myAddress, 26, 1) Like "[|fffd||]" Then   '|fffd|Q|fffd|T|fffd||182|Q|fffd|U|fffd||30b||fffd||fffd||fffd|

          ' ########  |fffd||fffd||fffd||fffd||fffd||181|u0-9, -|fffd|v|fffd||30b||fffd||fffd||694||fffd||fffd|f  ############
          For i = 24 To 2 Step -1
            str = Mid(myAddress, i, 1)                             ' |fffd|P|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
            If str Like "[|fffd|O-|fffd|X]" Or str Like "[|fffd||]" Then
            Else
              s_pos = i
              Exit For
            End If
          Next i
                
          strRow = strRow & Chr(34) & Left(myAddress, s_pos) & Chr(34) & Chr(44)  '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd||38f||fffd|
          myAddress = Mid(myAddress, s_pos + 1, Len(myAddress) - s_pos)           '|fffd|c|fffd||fffd|
        Else
          strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)     '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|T|fffd||fffd||fffd|@|fffd||38f||6ca|O
          myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                 '|fffd|c|fffd||fffd|
        End If
      Else
        strRow = strRow & Chr(34) & Left(myAddress, 25) & Chr(34) & Chr(44)       '|fffd|Z|fffd||fffd|cnt     |fffd||fffd||fffd|||fffd||fffd||fffd|A|fffd||fffd||fffd|||fffd||fffd||fffd|@|fffd|}|fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|@|fffd|`|fffd|Q|fffd|O|fffd|U|fffd|@|fffd||38f||6ca|O
        myAddress = Mid(myAddress, 25 + 1, Len(myAddress) - 25)                   '|fffd|c|fffd||fffd|
      End If
    Loop
     
    strRow = strRow & Chr(34) & myAddress & Chr(34) & Chr(44)      '|fffd||14c||fffd|

    ' |fffd|Z|fffd||fffd||fffd|Q|fffd|A|fffd|R|fffd||316||fffd||fffd||7cd||fffd||fffd|
    Select Case cnt
     Case 0
       strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
     Case 1
       strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    End Select
    ' ####################################################

    ' |fffd||fffd||fffd||342||fffd||fffd||65bc||fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 7).Value & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 8).Value & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    ' |fffd||fffd||fffd||342||fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 2).Value & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    strRow = strRow & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & "0" & Chr(34) & Chr(44)
    For count_j = 1 To 31
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd|T|fffd|C|fffd|Y|fffd||656a|
    strRow = strRow & Chr(34) & "060" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    ' |fffd|z|fffd|B|fffd||fffd||fffd|w|fffd||fffd||317|L|fffd||fffd|
    If .Cells(RowNumber, 28).Value <> "" Then
      strRow = strRow & Chr(34) & "3" & Chr(34) & Chr(44) & Chr(34) & .Cells(RowNumber, 28).Value & Chr(34) & Chr(44)
    Else
      strRow = strRow & Chr(34) & "0" & Chr(34) & Chr(44) & Chr(34) & Chr(34) & Chr(44)
    End If
    ' |fffd|z|fffd|B|fffd||fffd||fffd||50e|w|fffd||fffd|
    Select Case .Cells(RowNumber, 29).Value
     Case "01" ' |fffd||7d1|O|fffd||fffd|
       strRow = strRow & Chr(34) & "51" & Chr(34) & Chr(44)
     Case "12" ' |fffd|P|fffd|Q|fffd|||fffd|P|fffd|S|fffd||fffd|
       strRow = strRow & Chr(34) & "52" & Chr(34) & Chr(44)
     Case "14" ' |fffd|P|fffd|S|fffd|||fffd|P|fffd|U|fffd||fffd|
       strRow = strRow & Chr(34) & "53" & Chr(34) & Chr(44)
     Case "16" ' |fffd|P|fffd|U|fffd|||fffd|P|fffd|W|fffd||fffd|
       strRow = strRow & Chr(34) & "54" & Chr(34) & Chr(44)
     Case "04" ' |fffd|P|fffd|W|fffd|||fffd|Q|fffd|O|fffd||fffd|
       strRow = strRow & Chr(34) & "55" & Chr(34) & Chr(44)
     Case Else ' |fffd|w|fffd||fffd||202||fffd|
       strRow = strRow & Chr(34) & "00" & Chr(34) & Chr(44)
    End Select

    For count_j = 1 To 17
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||681|i|fffd|d|fffd|b|fffd|T|fffd|C|fffd|g|fffd||30e||d2354||50d||fffd||fffd|j
    strRow = strRow & Chr(34) & Chr(34) & Chr(44)

    For count_j = 1 To 14
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z
    strRow = strRow & Chr(34) & .Cells(RowNumber, 31).Value & Chr(34) & Chr(44)

    For count_j = 1 To 3
      strRow = strRow & Chr(34) & Chr(34) & Chr(44)
    Next
    ' |fffd||fffd||fffd|i|fffd||fffd|
    strRow = strRow & Chr(34) & .Cells(RowNumber, 20).Value & Chr(34) & Chr(44)

    For count_j = 1 To 15
      If count_j = 15 Then
        strRow = strRow & Chr(34) & Chr(34)
      Else
        strRow = strRow & Chr(34) & Chr(34) & Chr(44)
      End If
    Next
  End With

  objWriteStream.WriteLine (strRow)
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing

End Sub


Sub DataImport(FILEPATH As String)
Attribute DataImport.VB_ProcData.VB_Invoke_Func = " \n14"
' CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd||83dc||fffd||fffd||fffd||113||1c2||74d||fffd||fffd||781|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F  |fffd||1c2||74d||fffd||fffd||783|^|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd|f|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'
  Call PreWork(FILEPATH)  ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|

  With Worksheets(1).QueryTables.Add(Connection:="TEXT;" & Environ("TMP") & "\|fffd||fffd||fffd||fffd||fffd||fffd|.csv", _
                                     Destination:=Worksheets(1).Range("$A$2"))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 932
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _
                                         2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _
                                         2, 2, 2)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False

  End With

End Sub


Sub DataImport_Order(FILEPATH As String)
' |fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|OrderCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||781|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F  |fffd||1c2||74d||fffd||fffd||fffd|order.csv|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'
  Call PreWork(FILEPATH)  ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|

  With Worksheets("o|fffd|x|fffd||fffd||fffd||fffd||fffd|@").QueryTables.Add(Connection:="TEXT;" & Environ("TMP") & "\|fffd||fffd||fffd||fffd||fffd||fffd|.csv", _
                                     Destination:=Worksheets("o|fffd|x|fffd||fffd||fffd||fffd||fffd|@").Range("$A$1"))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 932
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(2, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 2, 9, 9, 9, 9, _
                                         9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, _
                                         9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, _
                                         9, 9, 9)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False

  End With

End Sub


Sub DataImport_Edit(FILEPATH As String)
' |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||781|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F  |fffd||1c2||74d||fffd||fffd||783|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X
'
  With Worksheets("|fffd||a287||fffd||48f|W").QueryTables.Add(Connection:="TEXT;" & FILEPATH, _
                                              Destination:=Worksheets("|fffd||a287||fffd||48f|W").Range("$A$2"))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 932
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(2, 2)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False

  End With

End Sub



Sub DuplicateRows(lngStartRow As Long, lngEndRow As Long)
' |fffd||fffd||fffd|q|fffd|l|fffd||1d7||fffd||fffd|i|fffd||fffd||fffd|o|fffd|[|fffd|i|fffd|z|fffd||fffd||fffd|h|fffd|c|fffd|j|fffd||183|^|fffd|e|fffd||fffd||fffd|||fffd||d2342|h|fffd|c|fffd||14f|d|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||24e||fffd||835e||fffd||702||a0bd||fffd||fffd||fffd||fffd||fffd||5c2||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd||fffd||fffd||fffd||fffd||348||351||38f||6c2|P|fffd||fffd||fffd||fffd|Q|fffd|O|fffd|O
'|fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd|d|fffd||fffd||fffd||38f||6c2||303|X|fffd|^|fffd|[|fffd|g|fffd|s
'|fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd|d|fffd||fffd||fffd||38f||6c2||303|G|fffd||fffd||fffd|h|fffd|s
'
  Range("A" & CStr(lngStartRow) & ":AQ" & CStr(lngEndRow)).RemoveDuplicates Columns:=Array(9, 43), Header:=xlYes


End Sub


Sub FoundCell(strTarget As String, strSheetName As String, strTRange As String, strBookName As String)
' |fffd|V|fffd|[|fffd|g|fffd||194||348||342||fffd||fffd|w|fffd||80b5||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'  |fffd||fffd||fffd||fffd||fffd|P|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9576||fffd||fffd||fffd||fffd|
'  |fffd||fffd||fffd||fffd||fffd|Q|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|V|fffd|[|fffd|g|fffd||fffd|
'  |fffd||fffd||fffd||fffd||fffd|R|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||348||341|i|fffd||fffd|F"L:L"|fffd|j
'|fffd|@|fffd||fffd||fffd||fffd||fffd|S|fffd|F|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd|
'
  Dim com_i As Control, count_j As Long, lngBaseColor As Long
  Dim FindCell As Range, FirstCell As Range, TargetCell As Range

  With Workbooks(strBookName).Worksheets(strSheetName).Range(strTRange)
    Set FindCell = .Find(strTarget, LookAt:=xlWhole)
    If FindCell Is Nothing Then
      lngBaseColor = frmSelectExpCom.BackColor
      frmSelectExpCom.BackColor = RGB(255, 0, 0)
      Application.Wait [now() + "0:00:00.2"]
      frmSelectExpCom.BackColor = lngBaseColor
      Exit Sub
    Else
      Set FirstCell = FindCell
      Set TargetCell = FindCell
    End If

  
    Do
      Set FindCell = .FindNext(FindCell)
      If FindCell.Address = FirstCell.Address Then
        If Range("A" & CStr(FindCell.Row)).Value = "" Then
          Range("A" & CStr(FindCell.Row)).NumberFormatLocal = "@"
        Else
          Call CancelIssu(Range("A" & CStr(FindCell.Row)).Value, Range("I" & CStr(FindCell.Row)).Value)
        End If

        For Each com_i In frmSelectExpCom.Frame1.Controls
          If com_i.Value = True Then
            Select Case com_i.Caption
             Case "|fffd||fffd||fffd||fffd|}|fffd||fffd|"
               Range("A" & CStr(FindCell.Row)).Value = "|fffd||fffd||fffd||fffd|}|fffd||fffd|"
               Call CSVFileOut_SagawaExp(CSVFILEPATH_SAGAWA, FindCell.Row)

             Case "|fffd||fffd||fffd|Z|fffd|^|fffd|A"
                Range("A" & CStr(FindCell.Row)).Value = "|fffd||fffd||fffd|Z|fffd|^|fffd|A"
               For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                 Call CSVFileOut_SeinoTrans(CSVFILEPATH_SEINO, FindCell.Row)
               Next
               
              Case "|fffd||fffd||fffd|Z|fffd|~|fffd|j"
                Range("A" & CStr(FindCell.Row)).Value = "|fffd||fffd||fffd|Z|fffd|~|fffd|j"
               For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                 Call CSVFileOut_SeinoTrans(CSVFILEPATH_SEINO, FindCell.Row)
               Next

             Case "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A", "|fffd|l|fffd|R|fffd|||fffd|X|fffd|i|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|j", "|fffd|l|fffd|R|fffd|R|fffd||fffd||fffd|p"
               If com_i.Caption = "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A" Then
                 Range("A" & CStr(FindCell.Row)).Value = "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A"
               ElseIf com_i.Caption = "|fffd|l|fffd|R|fffd|||fffd|X|fffd|i|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|j" Then
                 Range("A" & CStr(FindCell.Row)).Value = "|fffd|l|fffd|R|fffd|||fffd|X|fffd|i|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|j"
               ElseIf com_i.Caption = "|fffd|l|fffd|R|fffd|R|fffd||fffd||fffd|p" Then
                 Range("A" & CStr(FindCell.Row)).Value = "|fffd|l|fffd|R|fffd|R|fffd||fffd||fffd|p"
               End If
               Call CSVFileOut_YamatoTrans(CSVFILEPATH_YAMATO, FindCell.Row)

             Case "|fffd||fffd||fffd|R|fffd||289|^"
               If Range("AE" & CStr(FindCell.Row)).Value <> "" Then
                 Range("A" & CStr(FindCell.Row)).Value = "|fffd||fffd||fffd|R|fffd||289|^|fffd|@|fffd||fffd||fffd||fffd||fffd|"
                 If Len(FindCell.Offset(0, -39).Value & FindCell.Offset(0, -38).Value & FindCell.Offset(0, -37).Value) >= 13 Then
                   Range("D" & CStr(FindCell.Row) & ":F" & CStr(FindCell.Row)).NumberFormatLocal = "@"
                   FindCell.Offset(0, -37).Value = StrConv(Mid(FindCell.Offset(0, -38).Value, 14 - Len(FindCell.Offset(0, -39).Value)) & FindCell.Offset(0, -37).Value, vbWide)
                   FindCell.Offset(0, -38).Value = StrConv(Left(FindCell.Offset(0, -38).Value, 13 - Len(FindCell.Offset(0, -39).Value)), vbWide)
                 End If
                 For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                   Call CSVFileOut_FukuyamaExp_Daibiki(CSVFILEPATH_FUKUYAMA_DAIB, FindCell.Row)
                 Next
               Else
                 Range("A" & CStr(FindCell.Row)).Value = com_i.Caption
                 For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                   Call CSVFileOut_FukuyamaExp_Motobarai(CSVFILEPATH_FUKUYAMA_MOTO, FindCell.Row)
                 Next
               End If

             Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
               Range("A" & CStr(FindCell.Row)).Value = com_i.Caption
               If Len(FindCell.Offset(0, -39).Value & FindCell.Offset(0, -38).Value & FindCell.Offset(0, -37).Value) >= 20 Then
                 Range("D" & CStr(FindCell.Row) & ":F" & CStr(FindCell.Row)).NumberFormatLocal = "@"
                 FindCell.Offset(0, -37).Value = StrConv(Mid(FindCell.Offset(0, -38).Value, 19 - Len(FindCell.Offset(0, -39).Value)) & FindCell.Offset(0, -37).Value, vbWide)
                 FindCell.Offset(0, -38).Value = StrConv(Left(FindCell.Offset(0, -38).Value, 18 - Len(FindCell.Offset(0, -39).Value)), vbWide)
               End If
               Call CSVFileOut_JapanPost_Yupacket(CSVFILEPATH_JAPANPOST, FindCell.Row)
             Case "|fffd|X|fffd||583|p|fffd|b|fffd|N"
               If Range("AE" & CStr(FindCell.Row)).Value <> "" Then
                 Range("A" & CStr(FindCell.Row)).Value = "|fffd|X|fffd||583|p|fffd|b|fffd|N|fffd|@|fffd||fffd||fffd||fffd||fffd|"
                 For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                   Call CSVFileOut_JapanPost_Daibiki(CSVFILEPATH_JAPANPOST, FindCell.Row)
                 Next
               Else
                 Range("A" & CStr(FindCell.Row)).Value = com_i.Caption
                 For count_j = 1 To frmSelectExpCom.txtIssuItem.Value
                   Call CSVFileOut_JapanPost_Motobarai(CSVFILEPATH_JAPANPOST, FindCell.Row)
                 Next
               End If

            End Select
            Exit For
          End If
        Next
        Call DataADD(Range("AQ" & CStr(FindCell.Row)).Value, Range("A" & CStr(FindCell.Row)).Value)

        Exit Do
      Else
        ' |fffd||fffd||fffd||fffd||fffd||8c||fffd||fffd|p

      End If
    Loop

  End With

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
'
'
'###### |fffd|^|fffd|e|fffd||fffd||fffd|| |fffd|z|fffd||fffd||fffd|o|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X  ###########
'  Const SECTIONPERSON As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\_|fffd|z|fffd||fffd||fffd|o|fffd||341|@|fffd|R|fffd|e.csv"
'  Const SECTIONPERSON As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\_|fffd|z|fffd||fffd||fffd|o|fffd||341|@|fffd||fffd||fffd|v|fffd||fffd|.csv"
Const SECTIONPERSON As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\_|fffd|z|fffd||fffd||fffd|o|fffd||341|@|fffd|R|fffd|{.csv"
  frmSelectExpCom.lblInputCSVPath.Caption = "|fffd|@" & SECTIONPERSON

'###### |fffd|^|fffd||fffd||fffd||fffd||403|\|fffd|t|fffd|g|fffd||582||30e||fffd||835e||fffd||743|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| #####
  CSVFILEPATH_SEINO = ThisWorkbook.Path & "\|fffd|J|fffd||fffd||fffd|K|fffd||fffd||fffd|[|fffd|}|fffd|W|fffd|b|fffd|NII_|fffd||fffd||fffd|Z.csv"
  CSVFILEPATH_SAGAWA = ThisWorkbook.Path & "\e|fffd||fffd|`II_|fffd||fffd||fffd||fffd|.csv"
  CSVFILEPATH_YAMATO = ThisWorkbook.Path & "\B2|fffd|N|fffd||fffd||fffd|E|fffd|h_|fffd|N|fffd||fffd||fffd|l|fffd|R|fffd||fffd||fffd|}|fffd|g.csv"
  CSVFILEPATH_JAPANPOST = ThisWorkbook.Path & "\|fffd||40a4||fffd||542||fffd|R_|fffd||fffd||fffd|{|fffd|X|fffd||fffd|.csv"
  CSVFILEPATH_FUKUYAMA_MOTO = ThisWorkbook.Path & "\IStar2_|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|.csv"
  CSVFILEPATH_FUKUYAMA_DAIB = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv"

  Call CSVFileCreates

  With Worksheets(1)
    .Unprotect
    .Rows("2:2000").Delete Shift:=xlUp    '  |fffd|O|fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|

    Call DataImport(SECTIONPERSON)

    .Columns("H:H").EntireColumn.Hidden = True
    .Columns("J:S").EntireColumn.Hidden = True
    .Columns("U:X").EntireColumn.Hidden = True
    .Columns("Z:AA").EntireColumn.Hidden = True
    .Columns("AD:AD").EntireColumn.Hidden = True
    .Columns("AF:AP").EntireColumn.Hidden = True
    .Protect

  End With

  frmSelectExpCom.Show                   ' |fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd||fffd||282||fffd|\|fffd||fffd|


End Sub



Attribute VB_Name = "frmSelectExpCom"
Attribute VB_Base = "0{39EF23D8-634A-4BA5-AE9B-2C67F4D25576}{44E80B1E-93F4-41A3-B24A-67870FC23256}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdAllDel_Click()

  If MsgBox("|fffd||fffd||fffd||5c2||102||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||10f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbExclamation + vbYesNoCancel, "|fffd||fffd||fffd||fffd||fffd|m|fffd|F") = vbYes Then
    Worksheets(1).Unprotect
    Rows("2:500").Delete Shift:=xlUp
    Call DeleteConnections
    Call DeleteNames
    Worksheets(1).Protect

    ThisWorkbook.Close SaveChanges:=True

  End If

  
End Sub


Private Sub cmdExpComEdit_Click()
'
'  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|F|fffd|z|fffd||fffd|CSV|fffd|o|fffd||34d||fffd|_order.csv(|fffd||fffd|CSV)
  Const ORDERCSVFILE As String = "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\|fffd|z|fffd||fffd|CSV|fffd|o|fffd||34d||fffd|_order.csv"

  Call WorkSheetAdd("o|fffd|x|fffd||fffd||fffd||fffd||fffd|@")
  Call DataImport_Order(ORDERCSVFILE) ' |fffd|^|fffd|e|fffd||fffd||fffd|||fffd||fffd|order.csv
  Call SQLSelectOut(ThisWorkbook.Path & "\|fffd|^|fffd|e|fffd||fffd||fffd||_|fffd||a287||fffd||48f|W|fffd|p.csv")
  Call WorkSheetAdd("|fffd||a287||fffd||48f|W")
  Worksheets("|fffd||a287||fffd||48f|W").Cells(1, 1).Value = "|fffd||fffd|ID"
  Worksheets("|fffd||a287||fffd||48f|W").Cells(1, 2).Value = "|fffd|z|fffd||fffd||fffd||fffd||fffd|@"
  Worksheets("|fffd||a287||fffd||48f|W").Cells(1, 3).Value = "|fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@"
  Call DataImport_Edit(ThisWorkbook.Path & "\|fffd|^|fffd|e|fffd||fffd||fffd||_|fffd||a287||fffd||48f|W|fffd|p.csv")

  Worksheets("|fffd||a287||fffd||48f|W").Activate

  Dim row_i As Long, ranTarget As Range
  For row_i = LastRow(Worksheets("|fffd||a287||fffd||48f|W").Index, "A", 1) To 2 Step -1
    Set ranTarget = Worksheets("o|fffd|x|fffd||fffd||fffd||fffd||fffd|@").Range("A:A").Find(Cells(row_i, 1).Value, LookAt:=xlWhole)
    If Not ranTarget Is Nothing Then
      Cells(row_i, 3).Value = ranTarget.Offset(0, 1).Value
    Else
      Rows(row_i).Delete
    End If
  Next


  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(ThisWorkbook.Path & "\UP_|fffd||a287||fffd||48f|W.csv", 2, True)

  Dim strExpEditList As String                                                              ' |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|p|fffd||308||a5d7|
  For row_i = 1 To LastRow(Worksheets("|fffd||a287||fffd||48f|W").Index, "A", 1)
    strExpEditList = strExpEditList & Chr(34) & Cells(row_i, 1).Value & Chr(34) & Chr(44)   ' |fffd|^|fffd|e|fffd||fffd||fffd||ID
    strExpEditList = strExpEditList & Chr(34) & Cells(row_i, 2).Value & Chr(34) & Chr(44)   ' |fffd|z|fffd||fffd||fffd||fffd||fffd|@
    strExpEditList = strExpEditList & Chr(34) & Cells(row_i, 3).Value & Chr(34) & vbCrLf    ' |fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@
  Next

  objWriteStream.Write strExpEditList
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing

  ThisWorkbook.Close SaveChanges:=False

End Sub

Private Sub cmdQuit_Click()
' |fffd|^|fffd|e|fffd||fffd||fffd|||fffd||303|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||693||fffd||fffd|p
'
  Dim CSVStatusMove As String
  CSVStatusMove = ThisWorkbook.Path & "\|fffd|^|fffd|e|fffd||fffd||fffd||_|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||693||fffd||fffd|p.txt"

  Dim strOrderIDs As String     ' |fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||693||fffd||fffd|p|fffd||30e||fffd|ID|fffd||a5d7|
  Dim strExpEditList As String  ' |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|p|fffd||308||a5d7|
  Dim row_i As Long

  For row_i = 2 To LastRow(Worksheets("|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Index, "D", 1)
    If Cells(row_i, 1).Value <> "" Then
      strOrderIDs = strOrderIDs & Cells(row_i, 43).Value & vbCrLf
      strExpEditList = strExpEditList & Chr(34) & Cells(row_i, 43).Value & Chr(34) & Chr(44)   ' |fffd|^|fffd|e|fffd||fffd||fffd||ID
      strExpEditList = strExpEditList & Chr(34) & Cells(row_i, 1).Value & Chr(34) & vbCrLf     ' |fffd|z|fffd||fffd||fffd||fffd||fffd|@
    End If
  Next

  Dim objFileSys As Object, objWriteStream As Object
  Set objFileSys = CreateObject("Scripting.FileSystemObject")
  Set objWriteStream = objFileSys.OpenTextFile(CSVStatusMove, 2, True)
  objWriteStream.Write strOrderIDs
  objWriteStream.Close

  Set objWriteStream = Nothing
  Set objFileSys = Nothing

  Me.cmdQuit.Caption = "|fffd|o|fffd||34a||fffd||fffd||fffd|"
  Me.cmdQuit.Enabled = False

'###########  |fffd||fffd|f|fffd|[|fffd|^|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc||fffd||fffd||fffd||fffd|  ############
  If FileLen(ThisWorkbook.Path & "\e|fffd||fffd|`II_|fffd||fffd||fffd||fffd|.csv") < 10 Then
    Kill ThisWorkbook.Path & "\e|fffd||fffd|`II_|fffd||fffd||fffd||fffd|.csv"
  End If

  If FileLen(ThisWorkbook.Path & "\|fffd||40a4||fffd||542||fffd|R_|fffd||fffd||fffd|{|fffd|X|fffd||fffd|.csv") < 2250 Then
    Kill ThisWorkbook.Path & "\|fffd||40a4||fffd||542||fffd|R_|fffd||fffd||fffd|{|fffd|X|fffd||fffd|.csv"
  End If

  If FileLen(ThisWorkbook.Path & "\|fffd|J|fffd||fffd||fffd|K|fffd||fffd||fffd|[|fffd|}|fffd|W|fffd|b|fffd|NII_|fffd||fffd||fffd|Z.csv") < 10 Then
    Kill ThisWorkbook.Path & "\|fffd|J|fffd||fffd||fffd|K|fffd||fffd||fffd|[|fffd|}|fffd|W|fffd|b|fffd|NII_|fffd||fffd||fffd|Z.csv"
  End If

  If FileLen(ThisWorkbook.Path & "\IStar2_|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|.csv") < 10 Then
    Kill ThisWorkbook.Path & "\IStar2_|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|.csv"
  End If

  If FileLen(ThisWorkbook.Path & "\B2|fffd|N|fffd||fffd||fffd|E|fffd|h_|fffd|N|fffd||fffd||fffd|l|fffd|R|fffd||fffd||fffd|}|fffd|g.csv") < 1340 Then
    Kill ThisWorkbook.Path & "\B2|fffd|N|fffd||fffd||fffd|E|fffd|h_|fffd|N|fffd||fffd||fffd|l|fffd|R|fffd||fffd||fffd|}|fffd|g.csv"
  End If

  If FileLen(ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv") < 10 Then
    Kill ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv"
  Else
    FileCopy ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv", "Y:\|fffd||fffd||fffd|^|fffd|e|fffd||fffd||fffd|||fffd|K|fffd|C|fffd|h|fffd|@|fffd|e|fffd|X|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|.csv"
    Application.Wait Now() + TimeValue("00:00:01")
    Call OpenFukutuPro
  End If

  ThisWorkbook.Close SaveChanges:=False

End Sub


Private Sub txtIssuNumber_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
' |fffd||fffd||fffd||4c1||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||341|u|fffd|`|fffd|v|fffd||fffd||fffd|ua|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
'
  Dim ranTarget As Range

  If KeyCode = vbKeyReturn Then
    Select Case Left(txtIssuNumber.Value, 1)
       Case "A"
         txtIssuNumber.Value = Replace(txtIssuNumber.Value, "A", "", , , vbTextCompare)

       Case "a"
         txtIssuNumber.Value = Replace(txtIssuNumber.Value, "a", "", , , vbTextCompare)

    End Select

    If Len(Me.txtIssuNumber.Value) <> 11 Then
      Me.txtIssuNumber.BackColor = RGB(255, 0, 0)
      MsgBox "|fffd||fffd||fffd||20a2||fffd||fffd||fffd||d0b9||fffd||50d||fffd||fffd||342|P|fffd|P|fffd||fffd||fffd||142||fffd||fffd|B", vbOKOnly + vbExclamation, "|fffd||50d||fffd||fffd||fffd||fffd||508||10a2|"

      Exit Sub

    Else
      Me.txtIssuNumber.BackColor = RGB(255, 255, 255)

    End If

    Worksheets(1).Unprotect
    Call FoundCell(txtOrderID.Value, Worksheets(1).Name, "AQ:AQ", ThisWorkbook.Name)
    Worksheets(1).Protect

    Label4.Caption = WorksheetFunction.CountBlank(Range("A1:A" & CStr(LastRow(1, "AQ", 1))))
    
    frmInputIssuInvoice.txtOrderID.Value = ""
    frmInputIssuInvoice.txtIssuNumber.Value = ""

  End If


End Sub

Private Sub Frame1_Click()

End Sub

Private Sub opExp1_Click()     ' |fffd||fffd||fffd||fffd|}|fffd||fffd|
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = False
  Me.txtIssuItem.BackColor = &HE0E0E0

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp2_Click()     ' |fffd||40a4||fffd|p|fffd|b|fffd|N
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = True
  Me.txtIssuItem.BackColor = &H80000005

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp3_Click()     ' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|i|fffd||fffd|}|fffd||581|j
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = False
  Me.txtIssuItem.BackColor = &HE0E0E0

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp4_Click()     ' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|i|fffd|l|fffd|R|fffd|||fffd|X|fffd|j
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = False
  Me.txtIssuItem.BackColor = &HE0E0E0

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp5_Click()     ' |fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = False
  Me.txtIssuItem.BackColor = &HE0E0E0

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp6_Click()     ' |fffd||fffd||fffd|R|fffd||289|^
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = True
  Me.txtIssuItem.BackColor = &H80000005

  Me.txtOrderID.SetFocus

End Sub


Private Sub opExp7_Click()    ' |fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A|fffd|R|fffd||fffd||fffd|p|fffd|N|fffd|g
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = False
  Me.txtIssuItem.BackColor = &HE0E0E0

  Me.txtOrderID.SetFocus

End Sub


Private Sub opExp8_Click()     ' |fffd||fffd||fffd|Z|fffd|^|fffd|A
  Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = True
  Me.txtIssuItem.BackColor = &H80000005

  Me.txtOrderID.SetFocus

End Sub

Private Sub opExp9_Click()    '|fffd||fffd||fffd|Z|fffd|^|fffd|A(|fffd|~|fffd|j|fffd||fffd|)
   Me.txtIssuItem.Value = "1"
  Me.txtIssuItem.Enabled = True
  Me.txtIssuItem.BackColor = &H80000005

  Me.txtOrderID.SetFocus

End Sub

Private Sub txtIssuItem_Change()

End Sub

Private Sub txtOrderID_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
'|fffd|@|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|g|fffd||fffd||fffd|K|fffd|[|fffd|B
'
  Dim OrderIDs As Variant              ' |fffd||d2342|h|fffd|c|fffd||fffd|z|fffd||fffd||153||fffd||fffd||fffd||fffd|B
  Dim lngInputCount As Long            ' |fffd||fffd||fffd||34c||90||fffd||fffd||fffd||fffd|i|fffd|[|fffd|B
  Dim row_i As Long, orders_j As Long  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd||3d0||fffd||fffd|B

  If KeyCode = vbKeyReturn Then
    OrderIDs = Split(txtOrderID.Text, vbCrLf)

    For orders_j = 0 To UBound(OrderIDs)
      If OrderIDs(orders_j) = "" Then
        Exit For
      End If
      If Len(OrderIDs(orders_j)) <> 6 Then
        Me.txtOrderID.BackColor = RGB(255, 0, 0)
        MsgBox "|fffd|^|fffd|e|fffd||fffd||fffd|||fffd||30e||d2342|h|fffd|c|fffd||342|U|fffd||fffd||fffd||142||fffd||fffd|B", vbOKOnly + vbExclamation, "|fffd|h|fffd|c|fffd||fffd||fffd||508||10a2|"
        Exit Sub
      Else
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
        If CInt(txtIssuItem.Value) > 1 Then
          If MsgBox("|fffd||fffd||fffd||fffd||c2a95||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo + vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F") = vbNo Then
            Exit Sub
          End If
        End If
        txtOrderID.BackColor = RGB(255, 255, 255)

' ######  |fffd|{|fffd||fffd|  #################################
        Worksheets(1).Unprotect
        Call FoundCell(Trim(OrderIDs(orders_j)), Worksheets(1).Name, "AQ:AQ", ThisWorkbook.Name)
        Worksheets(1).Protect

      End If
    Next

' ######  |fffd||fffd||fffd||34c||fffd||fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|  #################
    lngInputCount = 0
    For row_i = 2 To LastRow(1, "D", 2)
      If Worksheets(1).Cells(row_i, 1).Value <> "" Then
        lngInputCount = lngInputCount + 1
      End If
    Next

    txtOrderID.Text = ""
    Label4.Caption = lngInputCount & "  /  " & CStr(LastRow(1, "D", 2) - 1)
    If lngInputCount = CStr(LastRow(1, "D", 2) - 1) Then
      Exit Sub
    End If

  End If
    
End Sub

Private Sub UserForm_Initialize()
  Label5.Visible = False        ' |fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd|x|fffd||fffd|
  txtIssuItem.Enabled = False
  txtIssuItem.Visible = False
  txtOrderID.Height = 153
  txtOrderID.Font.Size = 14
  txtOrderID.MultiLine = True
  txtOrderID.ScrollBars = fmScrollBarsVertical

End Sub


Private Sub UserForm_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
' |fffd|P|fffd|i|fffd|A|fffd||a287||fffd||fffd||fffd||fffd||fffd||310||602||fffd||582||fffd||fffd|@|fffd|\|fffd|B
'
  If Shift = 1 And txtOrderID.MultiLine = False Then
    Label5.Visible = False        ' |fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd|x|fffd||fffd|
    txtIssuItem.Enabled = False
    txtIssuItem.Visible = False
    txtOrderID.Height = 153
    txtOrderID.Font.Size = 14
    txtOrderID.MultiLine = True
    txtOrderID.ScrollBars = fmScrollBarsVertical

  ElseIf Shift = 1 And txtOrderID.MultiLine = True Then
    Label5.Visible = True
    txtIssuItem.Enabled = False
    txtIssuItem.Visible = True
    txtOrderID.Height = 42
    txtOrderID.Font.Size = 24
    txtOrderID.MultiLine = False
    txtOrderID.ScrollBars = fmScrollBarsNone

  End If


End Sub




INQUEST-PP=macro
