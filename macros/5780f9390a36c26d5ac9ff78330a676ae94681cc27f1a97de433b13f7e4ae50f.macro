Attribute VB_Name = "AdvancedSubmit"
Public start As Integer
Public finish As Integer
Public isStart As Boolean
Public isFinish As Boolean
Public isSplitter As Boolean


Public Function genSequence(N As Integer) As String
Dim i As Integer
Dim tempSeq As String
For i = 1 To N
Randomize
tempSeq = tempSeq & Module1.Characterbank(Int((UBound(Module1.Characterbank) - LBound(Module1.Characterbank) + 1) * Rnd + LBound(Module1.Characterbank)))
Next
genSequence = tempSeq
End Function

Attribute VB_Name = "AdvancedWindow"
Attribute VB_Base = "0{F82BC966-5985-41EB-95AC-B366923FA10C}{2876AE8D-BB17-4027-AFA5-B4E788C57356}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub InTheBeginning_Change()
enabletextboxes
End Sub

Private Sub intheend_Change()
enabletextboxes
End Sub


Private Sub UserForm_Initialize()
If (isStart = True) Then
InTheBeginning.Value = True
numStart = start
End If

If (isFinish = True) Then
InTheEnd.Value = True
numFinish = finish
End If

If (isSplitter = True) Then
checkSplit.Value = True
End If
enabletextboxes
End Sub

Private Sub Submit_Click()
On Error GoTo Err:
If InTheBeginning.Value = True Then
    If CInt(Trim(numStart)) >= 0 Then
    start = numStart
    Else
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    Exit Sub
    End If
Else
start = 0
End If
If InTheEnd.Value = True Then
    If CInt(Trim(numFinish)) >= 0 Then
    finish = numFinish
    Else
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    Exit Sub
    End If
Else
finish = 0
End If
isStart = InTheBeginning.Value
isFinish = InTheEnd.Value
AdvancedSubmit.isSplitter = Me.checkSplit.Value
Unload Me
Exit Sub
Err:
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|"
End Sub

Private Sub enabletextboxes()
If InTheBeginning.Value = False Then
numStart.Visible = False
Else
numStart.Visible = True
End If

If InTheEnd.Value = False Then
numFinish.Visible = False
Else
numFinish.Visible = True
End If
End Sub


Attribute VB_Name = "InitSave"
Public Sub SaveState()
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A90:A400").ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B90:B400").ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C90:C400").ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D93:D400").ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("E94:E400").ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F94:F400").ClearContents
'lego saving
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A90").Value = elemAdd
For i = 0 To elemAdd - 1
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & CStr(91 + i)).Value = myArray(i)
Next
'genmany_saving
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F94").Value = isfiooutpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F95").Value = isaddressoutpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F96").Value = isindexoutpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F97").Value = isphoneoutpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F98").Value = ismailoutpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F99").Value = outOptionpub
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F100").Value = delimiterStrpub
'mail saving
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C90").Value = Module1.listno
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C91").Value = Module1.symnumber
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C92").Value = Module1.figures
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C93").Value = Module1.domen
'advanced saving
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B90").Value = start
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B91").Value = finish
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B92").Value = isStart
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B93").Value = isFinish
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B94").Value = isSplitter
End Sub
Public Sub CheckForInit()
If elemAdd = 0 Then
InitState
End If
End Sub
Public Sub InitState()
'Global randomizing
Randomize

'lego initialization
LegoMod.elemAdd = CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A90").Value)
ReDim Preserve LegoMod.myArray(CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A90").Value))
For i = 0 To elemAdd - 1
myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A" & CStr(91 + i)).Value
Next

'mail initialization
Module1.Characterbank = Array("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", _
"l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", _
"A", "B", "C", "D", "E", "F", "G", "H", _
  "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", _
  "W", "X", "Y", "Z")
  
'manygen initialization
isfiooutpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F94").Value
isaddressoutpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F95").Value
isindexoutpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F96").Value
isphoneoutpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F97").Value
ismailoutpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F98").Value
outOptionpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F99").Value
delimiterStrpub = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("F100").Value

Module1.listno = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C90").Value
Module1.symnumber = CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C91").Value)
Module1.figures = CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C92").Value)
Module1.domen = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C93").Value
'advanced initialization
If IsEmpty(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B90").Value) Then
start = 0
Else
start = CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B90").Value)
End If
If IsEmpty(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B91").Value) Then
finish = 0
Else
finish = CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B91").Value)
End If
isStart = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B92").Value
isFinish = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B93").Value
isSplitter = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B94").Value

'Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A90:A120").ClearContents
'Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B90:B94").ClearContents
'Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("C90:C93").ClearContents
End Sub

Public Sub removechangethestate()
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RemoveOne.Enabled = True
End Sub
Attribute VB_Name = "LegoForm"
Attribute VB_Base = "0{EF7239A6-E489-4CA2-8200-589C8D36EEC1}{48283E8D-BB3D-4B5C-AE9A-931E76660F07}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub SaveLego_Click()
elemAdd = LB2.ListCount
Dim i As Integer
For i = 0 To LB2.ListCount - 1
ReDim Preserve LegoMod.myArray(elemAdd)
LegoMod.myArray(i) = LB2.list(i)
Next

createthisAddr
Unload Me
End Sub

Private Sub UserForm_Initialize()
If AdvancedSubmit.isStart Then
LB1.AddItem ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #1")
End If
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("O3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("P3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Q3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("R3").Value())

LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Z3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AB3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AD3").Value())

LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AI3").Value())
LB1.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AG3").Value())
If AdvancedSubmit.isFinish Then
LB1.AddItem ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #2")
End If
If (elemAdd <= 0) Then
Defaults_Click
Else
Dim i As Integer
For i = 0 To elemAdd - 1
LB2.AddItem (myArray(i))
Next
End If
'LB.AddItem ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
'LB1.AddItem ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
'
'If UBound(myArray()) - LBound(myArray()) > 0 Then
'Dim i As Integer
'For i = LBound(myArray()) To UBound(myArray()) - LBound(myArray())
'LB2.AddItem (myArray(i))
'Next
'Else
'Defaults_Click
'End If
End Sub

Private Sub rightwards_Click()
If LB1.ListIndex <> -1 Then
Dim i As Integer
For i = 0 To LB2.ListCount - 1
If LB1.Value = LB2.list(i) Then
Exit Sub
End If
Next
LB2.AddItem (LB1.Value)
End If
End Sub

Private Sub leftwards_Click()
If LB2.ListIndex <> -1 Then
LB2.RemoveItem (LB2.ListIndex)
End If
End Sub

Private Sub upw_Click()
Dim temp As String
If LB2.ListIndex <> -1 And LB2.ListIndex - 1 >= 0 Then
temp = LB2.list(LB2.ListIndex - 1)
LB2.list(LB2.ListIndex - 1) = LB2.list(LB2.ListIndex())
LB2.list(LB2.ListIndex()) = temp
LB2.Selected(LB2.ListIndex() - 1) = True
End If
End Sub

Private Sub dwnw_Click()
Dim temp As String
If LB2.ListIndex <> -1 And LB2.ListIndex + 1 <> LB2.ListCount Then
temp = LB2.list(LB2.ListIndex + 1)
LB2.list(LB2.ListIndex + 1) = LB2.list(LB2.ListIndex())
LB2.list(LB2.ListIndex()) = temp
LB2.Selected(LB2.ListIndex() + 1) = True
End If
End Sub

Private Sub Defaults_Click()
Dim i As Integer
Clearb_Click
For i = 0 To LB1.ListCount - 1
LB2.AddItem (LB1.list(i))
Next
End Sub

Private Sub Clearb_Click()
Dim i As Integer
For i = 0 To LB2.ListCount - 1
LB2.RemoveItem (0)
Next
End Sub
Attribute VB_Name = "LegoMod"
Public elemAdd As Integer
Public myArray() As String
Public Address As String

Public Function createthisAddr() As String
Dim i As Integer
Dim adm As String
Dim RNG1 As Range, r As Range, c As Collection
    Dim N As Long
    
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Application.CutCopyMode = False
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Application.CutCopyMode = True
    Address = ""
For i = 0 To elemAdd - 1
    Set c = New Collection
    If myArray(i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #1" Then
    Address = Address & AdvancedSubmit.genSequence(AdvancedSubmit.start)
    GoTo NextIteration
    End If
    If myArray(i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #2" Then
    Address = Address & AdvancedSubmit.genSequence(AdvancedSubmit.finish)
    GoTo NextIteration
    End If
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("O3") Then
    Set RNG1 = Range("O4:O204")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("P3") Then
    Address = Address & " " & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("T4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Q3") Then
    Address = Address & " " & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("V4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("R3") Then
    Address = Address & " " & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("X4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Z3") Then
    Set RNG1 = Range("Z4:Z204")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AB3") Then
    Set RNG1 = Range("AB4:AB204")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AD3") Then
    Set RNG1 = Range("AD4:AD204")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AI3") Then
    Set RNG1 = Range("AI4:AI204")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AG3") Then
    Address = Address & " " & Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AJ4")
    GoTo NextIteration
    
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    For Each r In RNG1
        If r.Value <> "" Then
            c.Add r
        End If
    Next r


    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("Z3") Then
    adm = Range("AA4")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AB3") Then
    adm = Range("AC4")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AD3") Then
    adm = Range("AE4")
    Else
    If myArray(i) = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AI3") And AdvancedSubmit.isSplitter Then
    Address = Address & " / "
    End If
    End If
    End If
    End If
    N = Application.WorksheetFunction.RandBetween(1, c.Count)
    Address = Address & c.item(N) & adm
    
NextIteration:
    If ((i < elemAdd - 1 And myArray(i) <> Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("O3")) And myArray(i) <> Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("AI3") And Right(Address, 1) <> " ") Then
    Address = Address & " "
    End If
    adm = ""
Next
createthisAddr = Address
End Function

Public Function createthatAddr(name As String) As String
Dim i As Integer
Dim adm As String
Dim RNG1 As Range, r As Range, c As Collection
    Dim N As Long
    
    Worksheets(name).Application.CutCopyMode = False
    Worksheets(name).Application.CutCopyMode = True
    Address = ""
For i = 0 To elemAdd - 1
    Set c = New Collection
    If myArray(i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #1" Then
    Address = Address & AdvancedSubmit.genSequence(AdvancedSubmit.start)
    GoTo NextIteration
    End If
    If myArray(i) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| #2" Then
    Address = Address & AdvancedSubmit.genSequence(AdvancedSubmit.finish)
    GoTo NextIteration
    End If
    If myArray(i) = Worksheets(name).Range("L3") Then
    Set RNG1 = Worksheets(name).Range("L4:L204")
    Else
    If myArray(i) = Worksheets(name).Range("M3") Then
    Address = Address & " " & Worksheets(name).Range("Q4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets(name).Range("N3") Then
    Address = Address & " " & Worksheets(name).Range("S4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets(name).Range("O3") Then
    Address = Address & " " & Worksheets(name).Range("U4")
    GoTo NextIteration
    Else
    If myArray(i) = Worksheets(name).Range("W3") Then
    Set RNG1 = Worksheets(name).Range("W4:W204")
    Else
    If myArray(i) = Worksheets(name).Range("Y3") Then
    Set RNG1 = Worksheets(name).Range("Y4:Y204")
    Else
    If myArray(i) = Worksheets(name).Range("AA3") Then
    Set RNG1 = Worksheets(name).Range("AA4:AA204")
    Else
    If myArray(i) = Worksheets(name).Range("AF3") Then
    Set RNG1 = Worksheets(name).Range("AF4:AF204")
    Else
    If myArray(i) = Worksheets(name).Range("AD3") Then
    Address = Address & " " & Worksheets(name).Range("AG4")
    GoTo NextIteration
    
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    End If
    For Each r In RNG1
        If r.Value <> "" Then
            c.Add r
        End If
    Next r


    If myArray(i) = Worksheets(name).Range("W3") Then
    adm = Worksheets(name).Range("X4")
    Else
    If myArray(i) = Worksheets(name).Range("Y3") Then
    adm = Worksheets(name).Range("Z4")
    Else
    If myArray(i) = Worksheets(name).Range("AA3") Then
    adm = Worksheets(name).Range("AB4")
    Else
    If myArray(i) = Worksheets(name).Range("AF3") And AdvancedSubmit.isSplitter Then
    Address = Address & " / "
    End If
    End If
    End If
    End If
    N = Application.WorksheetFunction.RandBetween(1, c.Count)
    Address = Address & c.item(N) & adm
    
NextIteration:
    If ((i < elemAdd - 1 And myArray(i) <> Worksheets(name).Range("L3")) And myArray(i) <> Worksheets(name).Range("AF3") And Right(Address, 1) <> " ") Then
    Address = Address & " "
    End If
    adm = ""
Next
createthatAddr = Address
End Function
Attribute VB_Name = "Module1"
Public Const myHeight As Integer = 12
'manygen
Public isfiooutpub As Boolean
Public isaddressoutpub As Boolean
Public isindexoutpub As Boolean
Public isphoneoutpub As Boolean
Public ismailoutpub As Boolean
Public outOptionpub As String
Public delimiterStrpub As String

'UserForm1
Public domen As String
Public symnumber As Integer
Public figures As Integer
Public listno As String

Public prevdomen As String
Public prevsymnumber As Integer
Public prevfigures As Integer
Public prevlistno As String

Public mail As String
Public Characterbank As Variant



Attribute VB_Name = "Module2"
Public response As Integer
Attribute VB_Name = "Module3"
Public alertTime As Date
Public isBlack As Boolean
Public Sub myTimer()
Dim var As String
If (ActiveSheet.name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
    var = "B29"
Else
    var = "B25"
End If
If (isBlack = True) Then
ActiveSheet.Range(var).Font.Color = RGB(117, 5, 5)
isBlack = False
Else
ActiveSheet.Range(var).Font.Color = vbBlack
isBlack = True
End If
alertTime = Now + TimeValue("00:00:08")
Application.OnTime alertTime, "myTimer"
End Sub
Attribute VB_Name = "Module4"
Public myHeight As Integer
Public myWidth As Integer
Public myTop As Integer
Public myLeft1 As Integer
Public myLeft2 As Integer

Public Sub adaptsize()
ActiveSheet.creditcard_btn.width = 80
ActiveSheet.creditcard_btn.height = 46
End Sub

Public Sub OptimizeSizeOne()
myHeight = 67
myWidth = 115
myLeft1 = 787
myTop = 236

With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox1
   .IntegralHeight = False
   .height = myHeight
   .width = myWidth
   .IntegralHeight = True
   .height = myHeight
   .width = myWidth
   .Top = myTop
   .Left = myLeft1
   .MultiSelect = fmMultiSelectSingle
End With
End Sub
Public Sub OptimizeSizeTwo()
myHeight = 67
myWidth = 115
myLeft2 = 948
myTop = 236

With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox2
   .IntegralHeight = False
   .height = myHeight
   .width = myWidth
   .IntegralHeight = True
   .height = myHeight
   .width = myWidth
   .Top = myTop
   .Left = myLeft2
   .MultiSelect = fmMultiSelectSingle
End With
End Sub

Public Sub generateCardNumber()
Dim x1 As Integer, x2 As Integer, x3 As Integer, x4 As Integer
Dim array1(0 To 14) As String
Dim curr As Integer
Dim summ As Integer
Dim bin As String
Dim firstfifteen As String
Dim theanswer As String

bin = "510621" & CStr(Int(Rnd * 10))
For x1 = 0 To 7

firstfifteen = firstfifteen + CStr(Int(Rnd * 10))
Next

firstfifteen = bin + firstfifteen
For x2 = LBound(array1) To UBound(array1)
array1(x2) = Mid(firstfifteen, x2 + 1, 1)
Next
For x3 = 0 To 7
curr = x3 * 2

If (CInt(array1(curr)) * 2 > 9) Then

array1(curr) = CStr(CInt(Mid(CStr(CInt(array1(curr)) * 2), 1, 1)) + CInt(Mid(CStr(CInt(array1(curr)) * 2), 2, 1)))
Else

array1(curr) = CStr(CInt(array1(curr) * 2))
End If
Next

For x4 = LBound(array1) To UBound(array1)
summ = summ + CInt(array1(x4))
Next
If (summ Mod 10 <> 0) Then
theanswer = CStr(10 - (summ Mod 10))
Else
theanswer = "0"
End If

ActiveSheet.myText = ActiveSheet.myText & Chr(13) & firstfifteen & theanswer
ActiveSheet.TextBox1.text = ActiveSheet.myText
ActiveSheet.TextBox1.Activate
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{EF36CC6B-A74B-464D-897E-CC1A6D15B89F}{BEA5AAB7-2D83-4C78-80DD-3C90715EBDF6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CancelM_Click()
Module1.listno = Module1.prevlistno
Module1.symnumber = Module1.prevsymnumber
Module1.figures = Module1.prevfigures
Module1.domen = Module1.prevdomen
Unload UserForm1
End Sub

Private Sub Label6_Click()
Dim clipboard As MSForms.DataObject
Set clipboard = New MSForms.DataObject
clipboard.SetText (Label6.Caption)
clipboard.PutInClipboard
End Sub

Private Sub SaveM_Click()
Module1.listno = ListM.Value
Module1.symnumber = TextBoxMsym.Value
Module1.figures = TextBoxMfig.Value
Module1.domen = TextBoxMdom.Value
Unload UserForm1
End Sub

Private Sub UserForm_Initialize()
Module1.prevlistno = Module1.listno
Module1.prevsymnumber = Module1.symnumber
Module1.prevfigures = Module1.figures
Module1.prevdomen = Module1.domen

ListM.AddItem ("|fffd||fffd||fffd||fffd||fffd||fffd|")
ListM.AddItem ("|fffd||fffd||fffd||fffd||fffd|")
If (Module1.symnumber = 0 And Module1.figures = 0) And (Module1.domen = "" And Module1.listno = "") Then
ListM.Value = ListM.list(0)
TextBoxMsym.Value = 6
TextBoxMfig.Value = 2
TextBoxMdom.Value = "@mail.ru"
Else
ListM.Value = Module1.listno
TextBoxMsym.Value = Module1.symnumber
TextBoxMfig.Value = Module1.figures
TextBoxMdom.Value = Module1.domen
End If
End Sub



'UserForm
Private Sub ListM_Change()
previewUF
End Sub
Private Sub TextBoxMfig_Change()
previewUF
End Sub
Private Sub TextBoxMsym_Change()
previewUF
End Sub
Private Sub TextBoxMdom_Change()
previewUF
End Sub

Private Sub previewUF()
Module1.mail = ""
On Error GoTo Errors1
Dim x1 As Integer
Dim x2 As Integer

For x1 = 1 To CInt(TextBoxMsym)

Module1.mail = Module1.mail & Characterbank(Int((UBound(Characterbank) - LBound(Characterbank) + 1) * Rnd + LBound(Characterbank)))
Next

For x2 = 1 To CInt(TextBoxMfig)
If ListM = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then

Module1.mail = Module1.mail & Int(Rnd * 10)
Else

Module1.mail = Int(Rnd * 10) & Module1.mail
End If
Next
Module1.mail = Module1.mail & TextBoxMdom
Label6.Caption = Module1.mail
GoTo Ends:
Errors1:
Label6.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Ends:
End Sub
Attribute VB_Name = "UserForm_manygen"
Attribute VB_Base = "0{6369DE9A-E1FE-4646-A85E-118C871B1CB2}{01D05915-DA7F-4026-BD48-C09BA5DC4224}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub filename_tb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
If (Trim(filename_tb.Value) = "") Then
filename_tb.Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
End If
End Sub

Private Sub filename_tb_Enter()
If (Trim(filename_tb.Value) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|") Then
filename_tb.Value = ""
End If
End Sub






Private Sub printOptionLB_Change()
If (printOptionLB.Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|") Then
delimiterStr.Visible = True
Label4.Visible = True
Else
delimiterStr.Visible = False
Label4.Visible = False
delimiterStr.Value = vbCrLf
End If
End Sub

Private Sub UserForm_Initialize()
CheckForInit
UserForm_manygen.height = 177.75
genMany_btn.Top = 108
filename_tb.Visible = False
Label2.Visible = False
Label3.Visible = False
printOptionLB.AddItem ("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
printOptionLB.AddItem ("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
If (delimiterStrpub = vbCrLf) Then
    optionOutpub = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    printOptionLB.Value = optionOutpub
Else
    printOptionLB.Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If
If (printOptionLB.Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|") Then
delimiterStr.Visible = True
Label4.Visible = True
Else
delimiterStr.Visible = False
Label4.Visible = False
End If
If (delimiterStrpub <> "") Then
delimiterStr.Value = delimiterStrpub
Else
delimiterStr.Value = " "
End If
If (isfiooutpub Or isaddressoutpub Or isindexoutpub Or isphoneoutpub Or ismailoutpub) Then
isfioout.Value = isfiooutpub
isaddressout.Value = isaddressoutpub
isindexout.Value = isindexoutpub
isphoneout.Value = isphoneoutpub
ismailout.Value = ismailoutpub
Else
isfioout.Value = True
isaddressout.Value = True
isindexout.Value = True
isphoneout.Value = True
ismailout.Value = True
End If
End Sub

Private Sub ToggleButton1_Click()
If (ToggleButton1.Value = True) Then
'UserForm_manygen.height = 177.75
'genMany_btn.Top = 108
filename_tb.Visible = True
filename_tb.Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Label2.Visible = True
Else
'UserForm_manygen.height = 152.25
'genMany_btn.Top = 84
filename_tb.Visible = False
Label2.Visible = False
End If
End Sub
Private Sub genMany_btn_Click()
On Error GoTo myErr
InitSave.CheckForInit
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").genMany_func CInt(genNumber), ToggleButton1.Value, filename_tb.Value, CBool(isfioout), CBool(isaddressout), CBool(isindexout), CBool(isphoneout), CBool(ismailout), printOptionLB.Value, delimiterStr.Value
isfiooutpub = isfioout.Value
isaddressoutpub = isaddressout.Value
isindexoutpub = isindexout.Value
isphoneoutpub = isphoneout.Value
ismailoutpub = ismailout.Value

If (printOptionLB.Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|") Then
outOptionpub = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
delimiterStrpub = delimiterStr.Value
Else
outOptionpub = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
delimiterStrpub = vbCrLf
End If
InitSave.SaveState
Unload UserForm_manygen
myErr:
Label3.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
Label3.Visible = True
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label_exclude, 48, 1, MSForms, Label"
Attribute VB_Control = "Excludethis_btn, 46, 2, MSForms, ToggleButton"
Attribute VB_Control = "Generatealot, 45, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton6, 44, 4, MSForms, CommandButton"
Attribute VB_Control = "mailGen_btn, 43, 5, MSForms, CommandButton"
Attribute VB_Control = "RemoveOne, 41, 6, MSForms, CommandButton"
Attribute VB_Control = "ListBox2, 40, 7, MSForms, ListBox"
Attribute VB_Control = "toTheLeft, 39, 8, MSForms, CommandButton"
Attribute VB_Control = "toTheRight, 38, 9, MSForms, CommandButton"
Attribute VB_Control = "myAccount, 36, 10, MSForms, TextBox"
Attribute VB_Control = "AddOne, 35, 11, MSForms, CommandButton"
Attribute VB_Control = "ListBox1, 32, 12, MSForms, ListBox"
Attribute VB_Control = "CommandButton4, 16, 13, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 15, 14, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 14, 15, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 11, 16, MSForms, CommandButton"
Attribute VB_Control = "TextBox1, 23, 17, MSForms, TextBox"
Attribute VB_Control = "CommandButton5, 24, 18, MSForms, CommandButton"
Attribute VB_Control = "Label1, 50, 19, MSForms, Label"
Attribute VB_Control = "CommandButton7, 51, 20, MSForms, CommandButton"
Attribute VB_Control = "creditcard_btn, 53, 21, MSForms, Label"
Attribute VB_Control = "Advancedbtn, 54, 22, MSForms, CommandButton"
Attribute VB_Control = "Lego, 55, 23, MSForms, CommandButton"
Public myText As String
Public randomAccount As Integer

Private Sub Advancedbtn_Click()
ActiveSheet.EnableCalculation = False
AdvancedWindow.Show
End Sub

Private Sub CommandButton7_Click()
Application.CutCopyMode = True
ActiveSheet.Cells(6, 3).Copy
End Sub





Private Sub creditcard_btn_Click()
Module4.generateCardNumber
End Sub

Private Sub creditcard_btn_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ActiveSheet.Shapes("creditcard").width = 64
creditcard_btn.width = 1
creditcard_btn.height = 1
End Sub

Private Sub creditcard_btn_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Application.OnTime (Now + 0.000001), "adaptsize"
ActiveSheet.Shapes("creditcard").width = 80
Module4.generateCardNumber
End Sub

Private Sub Label1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ActiveSheet.Shapes("dosh2").Visible = True
ActiveSheet.Shapes("dosh1").Visible = False
Dim margin As Integer
margin = 15
Dim width As Double
Dim height As Double
w = Label1.width
h = Label1.height
If (X < margin Or X > (w - margin) Or Y < margin Or Y > (h - margin)) Then
ActiveSheet.Shapes("dosh2").Visible = False
ActiveSheet.Shapes("dosh1").Visible = True
End If
End Sub

Private Sub Label1_Click()
ActiveWorkbook.FollowHyperlink Address:=ActiveSheet.Range("B34"), NewWindow:=True
End Sub




Private Sub AddOne_Click()
If Len(Trim(myAccount.text)) > 0 Then
Dim ws As Worksheet
For Each ws In Worksheets
If ws.name = myAccount.text Then
MsgBox "|fffd||fffd||fffd| " & Chr(34) & myAccount.text & Chr(34) & " |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
Else
End If
Next
ListBox1.AddItem (myAccount.text)
Module4.OptimizeSizeOne
Worksheets("Template").Copy After:=Sheets(Sheets.Count)
ActiveSheet.name = myAccount.text
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
End If
myAccount.text = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Private Sub CommandButton1_Click()
Application.CutCopyMode = False
ActiveSheet.EnableCalculation = False
ActiveSheet.EnableCalculation = True

randomAccount = Int((ListBox2.ListCount + 1) * Rnd)
If ListBox2.ListCount = 0 Or (randomAccount = ListBox2.ListCount And Excludethis_btn.Value = False) Then

ActiveSheet.Cells(3, 3).Value = ActiveSheet.Cells(84, 3)
'ActiveSheet.Cells(4, 3).Value = ActiveSheet.Cells(85, 3)
ActiveSheet.Cells(4, 3).Value = LegoMod.createthisAddr
ActiveSheet.Cells(5, 3).Value = ActiveSheet.Cells(3, 6)
ActiveSheet.Cells(6, 3).Value = ActiveSheet.Cells(86, 3)
Else
If randomAccount = ListBox2.ListCount Then

randomAccount = Int(ListBox2.ListCount * Rnd)
End If
ActiveSheet.Cells(3, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(16, 2).Value
'ActiveSheet.Cells(4, 3).Value = Worksheets(ListBox2.List(randomAccount)).Cells(17, 2).Value
ActiveSheet.Cells(4, 3).Value = LegoMod.createthatAddr(ListBox2.list(randomAccount))
ActiveSheet.Cells(5, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(19, 2).Value
ActiveSheet.Cells(6, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(18, 2).Value
End If
    mailGen
    ActiveSheet.Cells(7, 3).Value = Module1.mail
    myText = myText & ActiveSheet.Cells(3, 3).Value
    myText = myText & Chr(13) & ActiveSheet.Cells(4, 3).Value
    myText = myText & Chr(13) & ActiveSheet.Cells(5, 3).Value & Chr(13) & ActiveSheet.Cells(6, 3).Value & Chr(13)
    myText = myText & ActiveSheet.Cells(7, 3).Value & Chr(13)
TextBox1.text = myText
TextBox1.Activate
End Sub


Private Sub CommandButton2_Click()
Application.CutCopyMode = True
ActiveSheet.Cells(3, 3).Copy
End Sub

Private Sub CommandButton3_Click()
Application.CutCopyMode = True
ActiveSheet.Cells(4, 3).Copy
End Sub

Private Sub CommandButton4_Click()
Application.CutCopyMode = True
ActiveSheet.Cells(5, 3).Copy
End Sub

Private Sub CommandButton5_Click()
TextBox1.text = ""
myText = ""
TextBox1.Activate
End Sub

Private Sub CommandButton6_Click()
Application.CutCopyMode = True
ActiveSheet.Cells(7, 3).Copy
End Sub





Private Sub Excludethis_btn_Click()
If response = 1 Then
response = 0
Exit Sub
End If

If ListBox2.ListCount = 0 And Excludethis_btn.Value = True Then
Label_exclude.Caption = "|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Label_exclude.Visible = True
response = 1
Excludethis_btn.Value = False
Exit Sub
Else
Label_exclude.Visible = False
End If
If Excludethis_btn.Value = True Then
Excludethis_btn.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Excludethis_btn.BackColor = RGB(235, 70, 79)
Else
Excludethis_btn.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Excludethis_btn.BackColor = RGB(198, 240, 194)
End If
End Sub

Private Sub Generatealot_Click()
ActiveSheet.EnableCalculation = False
UserForm_manygen.Show
End Sub
Public Sub genMany_func(num As Integer, bool As Boolean, fn As String, fioout_many As Boolean, addressout_many As Boolean, indexout_many As Boolean, phoneout_many As Boolean, mailout_many As Boolean, propt As String, delim As String)
Dim x1 As Integer
Dim filename As String
Dim anotherText As String
If bool = True Then
filename = ThisWorkbook.Path & "\" & fn & ".txt"
Open filename For Output As #1
End If
For x1 = 1 To num
Application.CutCopyMode = False
ActiveSheet.EnableCalculation = False
ActiveSheet.EnableCalculation = True

randomAccount = Int((ListBox2.ListCount + 1) * Rnd)
If ListBox2.ListCount = 0 Or (randomAccount = ListBox2.ListCount And Excludethis_btn.Value = False) Then
    If fioout_many Then
        ActiveSheet.Cells(3, 3).Value = ActiveSheet.Cells(84, 3)
        anotherString = anotherString & delim & ActiveSheet.Cells(3, 3).Value
    End If
    If addressout_many Then
        ActiveSheet.Cells(4, 3).Value = LegoMod.createthisAddr
        anotherString = anotherString & delim & ActiveSheet.Cells(4, 3).Value
    End If
    If indexout_many Then
        ActiveSheet.Cells(5, 3).Value = ActiveSheet.Cells(3, 6)
        anotherString = anotherString & delim & ActiveSheet.Cells(5, 3).Value
    End If
    If phoneout_many Then
        ActiveSheet.Cells(6, 3).Value = ActiveSheet.Cells(86, 3)
        anotherString = anotherString & delim & ActiveSheet.Cells(6, 3).Value
    End If
Else
If randomAccount = ListBox2.ListCount Then

randomAccount = Int(ListBox2.ListCount * Rnd)
End If
    If fioout_many Then
        ActiveSheet.Cells(3, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(16, 2).Value
        anotherString = anotherString & delim & ActiveSheet.Cells(3, 3).Value
    End If
    If addressout_many Then
        ActiveSheet.Cells(4, 3).Value = LegoMod.createthatAddr(ListBox2.list(randomAccount))
        anotherString = anotherString & delim & ActiveSheet.Cells(4, 3).Value
    End If
    If indexout_many Then
        ActiveSheet.Cells(5, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(19, 2).Value
        anotherString = anotherString & delim & ActiveSheet.Cells(5, 3).Value
    End If
    If phoneout_many Then
       ActiveSheet.Cells(6, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(18, 2).Value
       anotherString = anotherString & delim & ActiveSheet.Cells(6, 3).Value
    End If
End If
    If mailout_many Then
        mailGen
        ActiveSheet.Cells(7, 3).Value = Module1.mail
        anotherString = anotherString & delim & ActiveSheet.Cells(7, 3).Value
    End If
    'If (bool = True) Then
            'Print #1, ActiveSheet.Cells(3, 3).Value
            'Print #1, ActiveSheet.Cells(4, 3).Value
            'Print #1, ActiveSheet.Cells(5, 3).Value
            'Print #1, ActiveSheet.Cells(6, 3).Value
            'Print #1, ActiveSheet.Cells(7, 3).Value
    'End If
    'myText = myText & ActiveSheet.Cells(3, 3).Value
    'myText = myText & Chr(13) & ActiveSheet.Cells(4, 3).Value
    'myText = myText & Chr(13) & ActiveSheet.Cells(5, 3).Value & Chr(13) & ActiveSheet.Cells(6, 3).Value & Chr(13)
    'myText = myText & ActiveSheet.Cells(7, 3) & Chr(13)
'TextBox1.text = myText
Next
anotherString = Mid(anotherString, 2, Len(anotherString) - 1)
    If (bool = True) Then
            Print #1, anotherString
    End If
TextBox1.text = TextBox1.text & anotherString
myText = myText & anotherString
Close #1
TextBox1.Activate
End Sub
Public Sub genMalny_func(num As Integer, bool As Boolean, fn As String)
Dim x1 As Integer
Dim filename As String
If bool = True Then
filename = ThisWorkbook.Path & "\" & fn & ".txt"
Open filename For Output As #1
End If
For x1 = 1 To num
Application.CutCopyMode = False
ActiveSheet.EnableCalculation = False
ActiveSheet.EnableCalculation = True

randomAccount = Int((ListBox2.ListCount + 1) * Rnd)
If ListBox2.ListCount = 0 Or (randomAccount = ListBox2.ListCount And Excludethis_btn.Value = False) Then

ActiveSheet.Cells(3, 3).Value = ActiveSheet.Cells(84, 3)
'ActiveSheet.Cells(4, 3).Value = ActiveSheet.Cells(85, 3)
ActiveSheet.Cells(4, 3).Value = LegoMod.createthisAddr
ActiveSheet.Cells(5, 3).Value = ActiveSheet.Cells(3, 6)
ActiveSheet.Cells(6, 3).Value = ActiveSheet.Cells(86, 3)
Else
If randomAccount = ListBox2.ListCount Then

randomAccount = Int(ListBox2.ListCount * Rnd)
End If
ActiveSheet.Cells(3, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(16, 2).Value
'ActiveSheet.Cells(4, 3).Value = Worksheets(ListBox2.List(randomAccount)).Cells(17, 2).Value
ActiveSheet.Cells(4, 3).Value = LegoMod.createthatAddr(ListBox2.list(randomAccount))
ActiveSheet.Cells(5, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(19, 2).Value
ActiveSheet.Cells(6, 3).Value = Worksheets(ListBox2.list(randomAccount)).Cells(18, 2).Value
End If
    mailGen
    ActiveSheet.Cells(7, 3).Value = Module1.mail
    If (bool = True) Then
        Print #1, ActiveSheet.Cells(3, 3).Value
        Print #1, ActiveSheet.Cells(4, 3).Value
        Print #1, ActiveSheet.Cells(5, 3).Value
        Print #1, ActiveSheet.Cells(6, 3).Value
        Print #1, ActiveSheet.Cells(7, 3).Value
        End If
    myText = myText & ActiveSheet.Cells(3, 3).Value
    myText = myText & Chr(13) & ActiveSheet.Cells(4, 3).Value
    myText = myText & Chr(13) & ActiveSheet.Cells(5, 3).Value & Chr(13) & ActiveSheet.Cells(6, 3).Value & Chr(13)
    myText = myText & ActiveSheet.Cells(7, 3) & Chr(13)
TextBox1.text = myText
Next

Close #1
TextBox1.Activate
End Sub


Private Sub Lego_Click()
ActiveSheet.EnableCalculation = False
LegoForm.Show
End Sub

Private Sub mailGen_btn_Click()
ActiveSheet.EnableCalculation = False
UserForm1.Show
End Sub

Private Sub RemoveOne_Click()
InitSave.SaveState

If ActiveSheet.ListBox1.ListCount <> 0 Then
If ActiveSheet.ListBox1.ListIndex = -1 Then

Dim ws As Worksheet
For Each ws In Worksheets
If ws.name = ActiveSheet.ListBox1.list(0) Then

Worksheets(ActiveSheet.ListBox1.list(0)).Delete

Dim wsInner As Worksheet
For Each wsInner In Worksheets
If wsInner.name = ActiveSheet.ListBox1.list(0) Then
Exit Sub
End If
Next
'initialization
Application.OnTime (Now + TimeValue("00:00:01")), "InitSave.InitState"
RemoveOne.Enabled = False
Application.OnTime (Now + TimeValue("00:00:01")), "removechangethestate"
For i = 0 To (ActiveSheet.ListBox2.ListCount - 1)
If ActiveSheet.ListBox1.list(0) = ActiveSheet.ListBox2.list(i) Then
ActiveSheet.ListBox2.RemoveItem (i)
Exit For
End If
Next
ActiveSheet.ListBox1.RemoveItem (0)
Module4.OptimizeSizeOne
Exit Sub
End If
Next

Else

Dim ws1 As Worksheet
For Each ws1 In Worksheets
If ws1.name = ActiveSheet.ListBox1.Value Then
Worksheets(ActiveSheet.ListBox1.Value).Delete
Dim wsInner2 As Worksheet
For Each wsInner2 In Worksheets
If wsInner2.name = ActiveSheet.ListBox1.Value Then
Exit Sub
End If
Next
'initialization
Application.OnTime (Now + TimeValue("00:00:01")), "InitSave.InitState"
RemoveOne.Enabled = False
Application.OnTime (Now + TimeValue("00:00:01")), "removechangethestate"
For i = 0 To (ActiveSheet.ListBox2.ListCount - 1)
If ActiveSheet.ListBox1.Value = ActiveSheet.ListBox2.list(i) Then
ActiveSheet.ListBox2.RemoveItem (i)
Exit For
End If
Next
ListBox1.RemoveItem (ActiveSheet.ListBox1.ListIndex)
Module4.OptimizeSizeOne
Exit Sub
End If
Next

End If

End If

End Sub

Private Sub TextBox1_Change()
If Trim(TextBox1.Value & vbNullString) = vbNullString Then

myText = ""
End If
End Sub


Private Sub ToggleButton1_Click()

End Sub

Private Sub toTheLeft_Click()
If ListBox2.ListIndex <> -1 Then
ListBox2.RemoveItem (ListBox2.ListIndex)
Module4.OptimizeSizeTwo
End If
End Sub

Private Sub toTheRight_Click()
If ListBox1.ListIndex <> -1 Then
For i = 0 To (ListBox2.ListCount - 1)
If ListBox1.Value = ListBox2.list(i) Then
Exit Sub
End If
Next
ListBox2.AddItem (ListBox1.Value)
Module4.OptimizeSizeTwo
End If
End Sub

Private Sub mailGen()
Module1.mail = ""
If (Module1.symnumber = 0 And Module1.figures = 0) And (Module1.domen = "" And Module1.listno = "") Then
Module1.listno = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Module1.symnumber = 6
Module1.figures = 2
Module1.domen = "@mail.ru"
End If
On Error GoTo Errors1
Dim x1 As Integer
Dim x2 As Integer
For x1 = 1 To CInt(Module1.symnumber)


Module1.mail = Module1.mail & Characterbank(Int((UBound(Characterbank) - LBound(Characterbank) + 1) * Rnd + LBound(Characterbank)))
Next

For x2 = 1 To CInt(Module1.figures)
If Module1.listno = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then

Module1.mail = Module1.mail & Int(Rnd * 10)
Else

Module1.mail = Int(Rnd * 10) & Module1.mail
End If
Next
Module1.mail = Module1.mail & Module1.domen
GoTo Ends:
Errors1:
Ends:
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label1, 11, 3, MSForms, Label"

Private Sub Label1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ActiveSheet.Shapes("dosh2").Visible = True
ActiveSheet.Shapes("dosh1").Visible = False
Dim margin As Integer
margin = 15
Dim width As Double
Dim height As Double
w = Label1.width
h = Label1.height
If (X < margin Or X > (w - margin) Or Y < margin Or Y > (h - margin)) Then
ActiveSheet.Shapes("dosh2").Visible = False
ActiveSheet.Shapes("dosh1").Visible = True
End If
End Sub

Private Sub Label1_Click()
ActiveWorkbook.FollowHyperlink Address:=ActiveSheet.Range("B30"), NewWindow:=True
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
isBlack = True
alertTime = Now + TimeValue("00:00:03")
Application.OnTime alertTime, "myTimer"
Dim ws As Worksheet
For Each ws In Worksheets
If ws.name <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" And ws.name <> "Template" Then
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox1.AddItem (ws.name)
Module4.OptimizeSizeOne
End If
Next
For i = 0 To (CInt(Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(90, 7)) - 1)
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox2.AddItem (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(91 + i, 5).Value)
Module4.OptimizeSizeTwo
Next
Module4.OptimizeSizeOne
Module4.OptimizeSizeTwo

'Initialization
InitSave.InitState
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Dim rng As Range
Set rng = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("E91:E110")
rng.ClearContents
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(90, 7).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox2.ListCount
Dim item As String
For i = 0 To (Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox2.ListCount - 1)
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(91 + i, 5).Value = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").ListBox2.list(i)
Next
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").creditcard_btn.width = 80
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").creditcard_btn.height = 46

'saving
InitSave.SaveState
End Sub


INQUEST-PP=macro
