Attribute VB_Name = "Module1"
Global WB As Workbook, LR3 As Long, LR6 As Long, LR31 As Long, ROWSS As Long



Sub WB_NAME()

Dim NAME As String

LR3 = Sheets("Data").Range("G65536").End(xlUp).row

LR31 = Sheets("DATA").Range("G" & ROWS.COUNT).End(xlUp).row

LR6 = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

'***************

ROWSS = Sheets("Data").Range("C65536").End(xlUp).row




NAME = Sheets("LISTS").Range("AQ1").Value

    Set WB = Workbooks(NAME)
       


End Sub






Attribute VB_Name = "Module10"
Sub MOEDA()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

If Sheets("INICIO").Range("Q19").Value = "EUR" Then
Showall
Sheets("DATA").Activate
Columns("G:G").Select
With Selection
.NumberFormat = "#,##0.00 $"
.HorizontalAlignment = xlRight

Columns("H:H").Select
With Selection
.NumberFormat = "#,##0.00 $"
.HorizontalAlignment = xlCenter
End With
End With

Else
End If

If Sheets("INICIO").Range("Q19").Value = "GPB" Then
Showall
Sheets("DATA").Activate
Columns("G:G").Select
With Selection
.NumberFormat = "[$|fffd|-809]#,##0.00"
.HorizontalAlignment = xlRight

Columns("H:H").Select
With Selection
.NumberFormat = "[$|fffd|-809]#,##0.00"
.HorizontalAlignment = xlCenter
End With
End With

Else
End If

If Sheets("INICIO").Range("Q19").Value = "USD" Then
Showall
Sheets("DATA").Activate
Columns("G:G").Select
With Selection
.NumberFormat = "[$$-409]#,##0.00"
.HorizontalAlignment = xlRight

Columns("H:H").Select
With Selection
.NumberFormat = "[$$-409]#,##0.00"
.HorizontalAlignment = xlCenter
End With
End With

Else
End If

Sheets("INICIO").Select
Range("Q19").Select

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic

End Sub





Attribute VB_Name = "Module11"
Sub DropDown13_Change()

End Sub

Sub MACRO1()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C11", Scroll:=True

End Sub

Sub MACRO2()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C15", Scroll:=True

End Sub
Sub MACRO3()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C19", Scroll:=True

End Sub
Sub MACRO4()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C23", Scroll:=True

End Sub
Sub MACRO5()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C27", Scroll:=True

End Sub
Sub MACRO6()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C31", Scroll:=True

End Sub

Sub MACRO7()

Application.Goto Reference:="R2C8", Scroll:=True

End Sub

Sub MACRO8()
Dim R As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.Goto Reference:="R" & COL & "C8", Scroll:=True

End Sub

Sub MACRO10()

Application.Goto Reference:="R1C37", Scroll:=True

End Sub

Sub MACRO11()

Application.Goto Reference:="R240C1", Scroll:=True

End Sub

Sub MACRO12()

Application.Goto Reference:="R1C21", Scroll:=True

End Sub

Sub MACRO13()

Application.Goto Reference:="R1C50", Scroll:=True

End Sub

Sub MACRO14()

Application.Goto Reference:="R1C1", Scroll:=True

End Sub


Attribute VB_Name = "Module12"
Sub CLUB1()

Dim R As Range
Dim destRng As Range
Dim LR As Long

Application.ScreenUpdating = False
Showall

LR = Sheets("DATA").Range("G" & ROWS.COUNT).End(xlUp).row

Set R = Sheets("DATA").Range("M2:" & "M" & LR)

    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("B70000")
    Sheets("DATA").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    End With
CLUB2
End Sub

Sub CLUB2()

Dim R As Range
Dim destRng As Range
Dim LR As Long
Dim COL As Long

COL = Sheets("LISTS").Range("CO2").Value

Application.ScreenUpdating = False

LR = Sheets("DATA").Range("G" & ROWS.COUNT).End(xlUp).row

Set R = Sheets("DATA").Range("N2:" & "N" & LR)
    
    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("B" & .Cells(.ROWS.COUNT, "B").End(xlUp).row + 1)
    Sheets("DATA").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    End With
    REMOVE_DUPLIC3
    COPYH

    Columns("H:AN").Select
With Selection
.HorizontalAlignment = xlCenter
End With
    
Application.Goto Reference:="R" & COL & "C8", Scroll:=True

End Sub

Sub REMOVE_DUPLIC3()

Dim LASTROW As Long

LASTROW = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B80000").End(xlUp).row

Application.ScreenUpdating = False

Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B70000:B" & LASTROW).RemoveDuplicates Columns:=Array(1), _
    Header:=xlNo
    
With Sheets("Config. Equipas & Competi|fffd||fffd|es")

Range("B70000:B" & LASTROW).Select
    Selection.FIND(What:="", After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False, SearchFormat:=False).Select
    Selection.Delete Shift:=xlUp
End With

End Sub

Sub COPYH()
Dim LASTROW As Long
Dim DestR As Range

LASTROW = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B80000").End(xlUp).row

Application.ScreenUpdating = False

CLEAR_FILTER

Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B70000:B" & LASTROW).Select
Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B70000:B" & LASTROW).COPY

With Sheets("Config. Equipas & Competi|fffd||fffd|es")
Set DestR = .Range("H" & .Cells(.ROWS.COUNT, "H").End(xlUp).row + 1)
DestR.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
End With
End Sub

Sub ADD_EQUIPA1()

Dim R As Range
Dim COL As Long, LR As Long
Dim DestR As Range

Set R = Sheets("LISTS").Range("CH2")

LR = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row
COL = Sheets("LISTS").Range("CG9").Value

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

  .AutoFilterMode = False

Application.Goto Reference:="R" & LR & "C" & COL, Scroll:=True
    
Set DestR = .Range("H" & .Cells(.ROWS.COUNT, "H").End(xlUp).row + 1)
    
    Sheets("LISTS").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    DestR.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With
    
Application.CutCopyMode = False

End Sub

Sub ADD_EQUIPA2()

Dim R As Range
Dim COL As Long, LR As Long
Dim DestR As Range

LR = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

COL = Sheets("LISTS").Range("CG9").Value

Set R = Sheets("LISTS").Range("CI2")

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

  .AutoFilterMode = False

Application.Goto Reference:="R" & LR & "C" & COL, Scroll:=True
    
Set DestR = .Range("H" & .Cells(.ROWS.COUNT, "H").End(xlUp).row + 1)

    Sheets("LISTS").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    DestR.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With
    
Application.CutCopyMode = False
   
End Sub

Sub ADD_EQUIPAS()

Application.ScreenUpdating = False

If Sheets("LISTS").Range("CH1").Value = True Then

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

.AutoFilterMode = False

 End With

ADD_EQUIPA1

Application.CutCopyMode = False
Else

End If

If Sheets("LISTS").Range("CI1").Value = True Then

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

.AutoFilterMode = False

 End With

ADD_EQUIPA2

Application.CutCopyMode = False
Else
End If


End Sub



Sub ADD_PAIS()

Dim R As Range
Dim destRng As Range
Dim LR As Long

Application.ScreenUpdating = False

CLEAR_FILTER

Set R = Sheets("LISTS").Range("CP3:CP140")

    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("B5:B142")
    Sheets("LISTS").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    End With

Application.CutCopyMode = False

End Sub

Sub REMOVE_DUPLIC2()

Dim LASTROW As Long

LASTROW = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H3:AN" & LASTROW).RemoveDuplicates Columns:=Array(1, 2), _
    Header:=xlNo
    
Range("H666666").Select
Selection.End(xlUp).Select

End Sub



Attribute VB_Name = "Module13"
Public Sub Filter()
    Dim lngStart As Long, lngEnd As Long
    Dim filterColumn As Integer
    


    lngStart = Sheets("LISTS").Range("X2").Value
    lngEnd = Sheets("LISTS").Range("Y2").Value
    
    
    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
                
        
End Sub

Sub Showall()
'show all filtered data and remove filter
With Sheets("DATA")
If Sheets("DATA").AutoFilterMode Then
Sheets("DATA").Range("C1").AutoFilter
Application.Goto Reference:="R1C1", Scroll:=True
End If
End With
End Sub

Public Sub Filter2()
    Dim lngStart As Long, lngEnd As Long
    Dim filterColumn As Integer
    
    lngStart = Sheets("LISTS").Range("Z7").Value
    lngEnd = Sheets("LISTS").Range("Z7").Value
    
     Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
        
End Sub
Public Sub Filter123()

    Sheets("DATA").Range("F1").AutoFilter Field:=6, _
        Criteria1:="*" & Sheets("LISTS").Range("Y12").Value & "*"

End Sub
Public Sub Filter1()

    Sheets("DATA").Range("F1").AutoFilter Field:=6, _
        Criteria1:="*" & Sheets("LISTS").Range("Y11").Value & "*"

End Sub
Public Sub Filter3()

    Sheets("DATA").Range("F1").AutoFilter Field:=2, _
        Criteria1:="*" & Sheets("LISTS").Range("Z10").Value & "*"

End Sub

Public Sub Filter4()
    
    Sheets("DATA").Range("F1").AutoFilter Field:=1, _
        Criteria1:=Sheets("LISTS").Range("Y10").Value

End Sub

Public Sub Filter6()

 Dim lngStart As Long, lngEnd As Long

    lngStart = Sheets("LISTS").Range("Z30").Value
    lngEnd = Sheets("LISTS").Range("Z31").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
      Sheets("DATA").Range("F1").AutoFilter Field:=4, _
        Criteria1:="*" & Sheets("LISTS").Range("Z13").Value & "*"
        
End Sub

Public Sub Filter7()

Dim filterColumn As Integer
Dim lngStart As Long, lngEnd As Long

    filterColumn = Sheets("LISTS").Range("Z17").Value
    lngStart = Sheets("LISTS").Range("Z30").Value
    lngEnd = Sheets("LISTS").Range("Z31").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
    Sheets("DATA").Range("F1").AutoFilter Field:=filterColumn, _
        Criteria1:=Sheets("LISTS").Range("Z14").Value
        
End Sub

Public Sub Filter8()

    Dim lngStart As Long, lngEnd As Long

    lngStart = Sheets("LISTS").Range("Z22").Value
    lngEnd = Sheets("LISTS").Range("Z23").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
    
        
End Sub

Public Sub Filter9()

    Dim lngStart As Long, lngEnd As Long

    lngStart = Sheets("LISTS").Range("Z30").Value
    lngEnd = Sheets("LISTS").Range("Z31").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
    Sheets("DATA").Range("E1").AutoFilter Field:=5, _
        Criteria1:="*" & Sheets("LISTS").Range("Z27").Value & "*"
    Sheets("DATA").Range("F1").AutoFilter Field:=4, _
        Criteria1:="=football" _
        , Operator:=xlOr, Criteria2:="=soccer"
        
End Sub

Sub Filter10()

   Dim lngStart As Long, lngEnd As Long

    lngStart = Sheets("LISTS").Range("Z30").Value
    lngEnd = Sheets("LISTS").Range("Z31").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
    Sheets("DATA").Range("F1").AutoFilter Field:=4, _
        Criteria1:="=football" _
        , Operator:=xlOr, Criteria2:="=soccer"

End Sub

Sub Filter11()

Dim Rng As String
Dim TEAM1 As String, TEAM2 As String

Application.ScreenUpdating = False

On Error GoTo ERRO

Rng = "CLISTA"
TEAM1 = Sheets("LISTS").Range("CH2").Value
TEAM2 = Sheets("LISTS").Range("CI2").Value

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

  .AutoFilterMode = False
  
  .Range(Rng).AutoFilter

Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H2").AutoFilter Field:=1, _
        Criteria1:=TEAM1 _
        , Operator:=xlOr, Criteria2:=TEAM2
        
End With

ERRO:
Exit Sub
      
End Sub
Sub FILTER20()

Dim COL As Long

COL = Sheets("LISTS").Range("CG9").Value

Application.Goto Reference:="R2C" & COL, Scroll:=True

Filter11

End Sub


Sub CLEAR_FILTER()

With Sheets("Config. Equipas & Competi|fffd||fffd|es")

.AutoFilterMode = False

 End With

End Sub

Sub CHECK_FILTER()

If Sheets("Config. Equipas & Competi|fffd||fffd|es").AutoFilterMode = False Then

Sheets("LISTS").Range("BV5").Value = 1

Else

Sheets("LISTS").Range("BV5").ClearContents
End If

End Sub

Public Sub Filter88()

    Dim lngStart As Long, lngEnd As Long

    lngStart = Sheets("LISTS").Range("AA19").Value
    lngEnd = Sheets("LISTS").Range("AA20").Value
    

    Sheets("DATA").Range("C1").AutoFilter Field:=3, _
        Criteria1:=">=" & lngStart, _
        Operator:=xlAnd, _
        Criteria2:="<=" & lngEnd
        
   Sheets("data").Activate
   
Application.Goto Reference:="R1C1", Scroll:=True

End Sub







        


Attribute VB_Name = "Module14"
Sub autofill()
Dim Copyrange As String
Dim Startrow As Long
Dim endrow As Long

On Error GoTo ERRO

endrow = Sheets("Data").Range("C65536").End(xlUp).row + 1
Startrow = Sheets("Data").Range("A65536").End(xlUp).row

Let Copyrange = "A" & Startrow & ":" & "A" & Startrow
Range(Copyrange).Select
Selection.autofill Destination:=Range("A" & Startrow & ":" & "A" & endrow)

Let Copyrange = "B" & Startrow & ":" & "B" & Startrow
Range(Copyrange).Select
Selection.autofill Destination:=Range("B" & Startrow & ":" & "B" & endrow)

Range("A2").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Config. Equipas & Competi|fffd||fffd|es'!$B$3:$B$142"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
Range("B2").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Config. Equipas & Competi|fffd||fffd|es'!$B$143:$B$282"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
ERRO:
Exit Sub

End Sub

Sub FILL2()
Dim LR As Long

LR = Sheets("Data").Range("C65536").End(xlUp).row

    Range("B2:B" & LR).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Config. Equipas & Competi|fffd||fffd|es'!$B$143:$B$282"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    Range("A2:A" & LR).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Config. Equipas & Competi|fffd||fffd|es'!$B$3:$B$142"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
 
End Sub


Attribute VB_Name = "Module15"
Sub BACKUP()

 Dim R As Range
 Dim destRng As Range
 Dim LR As Long
 Dim NewBook As Workbook
 Dim sPath As String
 
 LR = Sheets("Data").Range("G65536").End(xlUp).row
 
 sPath = CreateObject("WScript.Shell").specialfolders("MyDocuments")
 
MSG1 = MsgBox("Confirmar BACKUP?", vbYesNo, "")

If MSG1 = vbYes Then

LR = Sheets("Data").Range("G65536").End(xlUp).row

Application.ScreenUpdating = False

Showall

Set NewBook = Workbooks.ADD
    With NewBook
        .Title = "BACKUP"
        .Subject = "BACKUP"
        .SaveAs Filename:=sPath & "\" & "BACKUP.xlsx"
    End With
    
    
If LR = 1 Then

Else

Application.Goto WB.Sheets(1).Range("A1")

Set R = Sheets("DATA").Range("A2:L" & LR)

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    With Sheets(1)
    Set destRng = .Range("A" & .Cells(.ROWS.COUNT, "A").End(xlUp).row)

    
Application.Goto WB.Sheets(1).Range("A1")

    Sheets("DATA").Activate
    R.Select
    Selection.COPY
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    Sheets(1).Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With


Application.CutCopyMode = False
Application.Goto WB.Sheets(1).Range("A1")
        

End If

BACKUP2


Else
End If
End Sub

Sub BACKUP2()


Dim LASTROW As Long
Dim destRng As Range

Application.ScreenUpdating = False

Application.Goto WB.Sheets(1).Range("A1")

Sheets("DATA2").Visible = True

Set R = Sheets("DATA2").Range("A1:F1000")

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    With Sheets(1)
    Set destRng = .Range("M" & .Cells(.ROWS.COUNT, "M").End(xlUp).row)

    
Application.Goto WB.Sheets(1).Range("A1")

    Sheets("DATA2").Activate
    R.Select
    Selection.COPY
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    Sheets(1).Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With


Application.CutCopyMode = False
Application.Goto WB.Sheets(1).Range("A1")

Sheets("DATA2").Visible = xlVeryHidden

BACKUP3

End Sub

Sub BACKUP3()

'FAZER NOVO BACKUP PARA EQUIPAS E COMPETI|fffd||fffd|ES

Dim LASTROW As Long, LR As Long
Dim destRng As Range

Application.ScreenUpdating = False

CLEAR_FILTER

LR = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

Set R = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H1:AH" & LR)

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

    With Sheets(1)
    Set destRng = .Range("V" & .Cells(.ROWS.COUNT, "V").End(xlUp).row)
    
Application.Goto WB.Sheets(1).Range("A1")

    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    R.Select
    Selection.COPY
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    Sheets(1).Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    End With
    
    ActiveWorkbook.Names("COMPNACIONAIS3").Delete
    ActiveWorkbook.Names("COMPNACIONAIS4").Delete
    ActiveWorkbook.Names("COMPNACIONAIS5").Delete
    ActiveWorkbook.Names("COMPNACIONAIS6").Delete
    ActiveWorkbook.Names("INTCLUBES3").Delete
    ActiveWorkbook.Names("INTCLUBES4").Delete
    ActiveWorkbook.Names("INTCLUBES5").Delete
    ActiveWorkbook.Names("INTCLUBES6").Delete
    
Application.CutCopyMode = False
Application.Goto WB.Sheets(1).Range("A1")

BACKUP4
End Sub

Sub BACKUP4()
Dim LASTROW As Long, LRR As Long
Dim destRng As Range

Application.ScreenUpdating = False

LRR = Sheets("Add Equipas").Range("C65536").End(xlUp).row

Set R = Sheets("ADD EQUIPAS").Range("A1:S" & LRR)

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
 With Sheets(1)
    Set destRng = .Range("BH" & .Cells(.ROWS.COUNT, "BH").End(xlUp).row)
    
Application.Goto WB.Sheets(1).Range("A1")

    Sheets("ADD EQUIPAS").Activate
    R.Select
    Selection.COPY
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    Sheets(1).Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    End With
    
Columns("A:BZ").EntireColumn.AutoFit
        Columns("A:BZ").Select
With Selection
.HorizontalAlignment = xlCenter
End With
    
Workbooks("BACKUP.xlsx").Application.DisplayAlerts = False
Workbooks("BACKUP.xlsx").Close SaveChanges:=True

Application.CutCopyMode = False
Sheets("INICIO").Select
Range("A1").Select

Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Module16"
Sub REFRESH()

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Unprotect

With Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES")

            .AutoFilterMode = False

            .Range("B3:D209").AutoFilter
            
End With
   
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B5:C54").Sort Header:=xlNo, Key1:=Sheet6.Range("C5"), _
        Order1:=xlDescending
    
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B70:C209").Sort Header:=xlNo, Key1:=Sheet6.Range("C70"), _
        Order1:=xlDescending
       
        
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B3:D209").Select

   Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("$B$3:$D$209").AutoFilter Field:=3, Criteria1:="<>0", Operator:=xlFilterValues
    

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowFiltering _
        :=True
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select

Range("A1").Select

'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
  
End Sub



Attribute VB_Name = "Module17"
Sub REMOVEEVEN()
 
    Dim myLastRow As Long
    Dim i As Long
    
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False

    Showall
    
    
'   Find last row
    myLastRow = Sheets("DATA").Cells(ROWS.COUNT, "G").End(xlUp).row
    

    For i = myLastRow To 1 Step -1
        If (Cells(i, "G").Value) = 0 Then
    Cells(i, "A").EntireRow.ClearContents
            
        End If
    Next i
    UP
        
        Columns("G:G").Select
    Selection.FormatConditions.Delete
    
    Range("G2").Select
Range(Selection, Selection.End(xlDown)).Select
With Selection

Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlGreater, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
End With

 Columns("I:I").Select
    Selection.FormatConditions.Delete

Range("I2").Select
Range(Selection, Selection.End(xlDown)).Select
With Selection

Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlBetween, _
        Formula1:="=0,000001", Formula2:="=99999999"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
End With

Sheets("Data").Range("G1").Select
        
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
    
End Sub

Sub CLEAR_DATA()
Dim ROWS As Long

MSG1 = MsgBox("Confirmar LIMPAR FOLHA?", vbYesNo, "")

If MSG1 = vbYes Then

Application.ScreenUpdating = False

Sheets("DATA2").Range("DEPOS").ClearContents
Sheets("DATA2").Range("LEV").ClearContents
Sheets("DATA2").Range("PC").ClearContents
Sheets("LISTS").Range("AJ2:AK3000").ClearContents
Sheets("LISTS").Range("AJ2").Value = 0
Sheets("LISTS").Range("AK2").Value = 0
Sheets("LISTS").Range("AN1:AO1").ClearContents
Sheets("LISTS").Range("AR7").ClearContents
Sheets("INICIO").Range("Q23").ClearContents


With Sheets("DATA")
Showall
End With
Sheets("DATA").Range("C2:AC65536").ClearContents
Sheets("DATA").Range("A3:B65536").ClearContents

Application.Calculation = xlCalculationManual
Application.DisplayStatusBar = False
Application.EnableEvents = False


ROWS = Sheets("Data").Range("C65536").End(xlUp).row + 1

Range(Cells(2, 1), Cells(ROWS, 1)).Formula = "=IFERROR(IF(INDEX(CCOMP,MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),1)=INDEX(CCOMP,MATCH(MID(F2,SEARCH("" V "",F2,1)+3,50),CLISTA,0),1),INDEX(CCOMP,MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),1),IF(INDEX(CCOMP,MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),2)=INDEX(CCOMP,MATCH(MID(F2,SEARCH("" V "",F2,1)+3,50),CLISTA,0),2),INDEX(CCOMP,MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),2),"""")),"""")"

Range(Cells(2, 2), Cells(ROWS, 2)).Formula = "=IFERROR(IF(INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),1)=INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(MID(F2,SEARCH("" V "",F2,1)+3,40),CLISTA,0),1),INDEX(IND" _
& "IRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),1),IF(INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),2)=INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(MID(F2,SEARCH("" V "",F2,1)+3,40),CLISTA,0),2),INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MAT" _
& "CH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),2),IF(INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),3)=INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(MID(F2,SEARCH("" V "",F2,1)+3,40),CLISTA,0),3),INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOM" _
& "PET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),3),IF(INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),4)=INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MAT" _
& "CH(MID(F2,SEARCH("" V "",F2,1)+3,40),CLISTA,0),4),INDEX(INDIRECT(IF(C2<=DATE(YEAR(C2),INDEX(CMONTH,MATCH(A2,CCOMPET,0)),INDEX(CDAY,MATCH(A2,CCOMPET,0))),""CLUBES""&YEAR(C2)-1&YEAR(C2),""CLUBES""&YEAR(C2)&YEAR(C2)+1)),MATCH(LEFT(F2,SEARCH("" V "",F2,1)-1),CLISTA,0),4),"""")))),"""")"


    Range("A3").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With
    
    Range("B3").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection.Validation
        .Delete
        .ADD Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .ShowInput = True
        .ShowError = True
    End With
    
NAMES_MANAGER

Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True


Sheets("INICIO").Select
Range("A1").Select

    
Else
End If
End Sub

Attribute VB_Name = "Module18"
Sub DEP()

LR = Sheets("Data2").Range("C65536").End(xlUp).row + 1

'Transfer data to sheet

Sheets("DATA2").Cells(LR, 4) = Sheets("DATA2").Range("H2")
Sheets("DATA2").Cells(LR, 3) = Sheets("DATA2").Range("G2")

Sheets("DATA2").Range("G2:H2").ClearContents


End Sub

Sub LEV()

LR = Sheets("Data2").Range("A65536").End(xlUp).row + 1

'Transfer data to sheet

Sheets("DATA2").Cells(LR, 2) = Sheets("DATA2").Range("H2")
Sheets("DATA2").Cells(LR, 1) = Sheets("DATA2").Range("G2")

Sheets("DATA2").Range("G2:H2").ClearContents


End Sub

Sub PC()

LR = Sheets("Data2").Range("E65536").End(xlUp).row + 1

'Transfer data to sheet

Sheets("DATA2").Cells(LR, 6) = Sheets("DATA2").Range("H2")
Sheets("DATA2").Cells(LR, 5) = Sheets("DATA2").Range("G2")

Sheets("DATA2").Range("G2:H2").ClearContents


End Sub




Attribute VB_Name = "Module19"
Sub RESTORE1()

Dim fNameAndPath As Variant
Dim LASTROW As Long, LR As Long
Dim destRng As Range
Dim R As Range
Dim DestR As Range

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False


MSG1 = MsgBox("Confirmar RESTORE?", vbYesNo, "")

If MSG1 = vbYes Then

Application.ScreenUpdating = False

fNameAndPath = Application.GetOpenFilename(FileFilter:="Excel Files (*.XLSX), *.XLS", Title:="Selecione o ficheiro BACKUP.xlsx")
If fNameAndPath = False Then Exit Sub
Workbooks.Open Filename:=fNameAndPath

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

LASTROW = Sheets(1).Range("C" & ROWS.COUNT).End(xlUp).row

Application.Goto WB.Sheets("DATA").Cells(7, 6)

LR = Sheets("DATA").Range("G" & ROWS.COUNT).End(xlUp).row

With Sheets("DATA")

Set R = .Range("A" & LR + 1 & ": B" & LR + 1)

Set destRng = .Range("A" & (LASTROW + LR) + 1)

R.Select
Selection.COPY
destRng.Select
    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _
        , SkipBlanks:=False, Transpose:=False
        
End With

Application.Goto WB.Sheets("DATA").Cells(7, 6)

With Sheets("DATA")
    Set DestR = .Range("A" & LR + 1)
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

LASTROW = Sheets(1).Range("C" & ROWS.COUNT).End(xlUp).row
    Sheets(1).Range("A1:L" & LASTROW).COPY Destination:=DestR
    
        .Columns("A:K").AutoFit

End With

Application.Goto WB.Sheets("DATA").Cells(7, 6)
FILL2
Sheets("Data").Range("G65536").End(xlUp).Offset(1, 0).Select
ActiveCell.FormulaR1C1 = ""

RESTORE2

Else
End If

End Sub

Sub RESTORE2()

Dim LASTROW As Long
Dim destRng As Range

Application.ScreenUpdating = False

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

Set R = Sheets(1).Range("M3:R1000")

Application.Goto WB.Sheets("DATA").Cells(7, 6)

Sheets("DATA2").Visible = True

Application.Goto WB.Sheets("DATA2").Cells(7, 6)
    With Sheets("DATA2")
    Set destRng = .Range("A" & .Cells(.ROWS.COUNT, "A").End(xlUp).row + 1)
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

    Sheets(1).Activate
    R.Select
    Selection.COPY
Application.Goto WB.Sheets("DATA2").Cells(7, 6)
    Sheets("DATA2").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With
Sheets("DATA2").Visible = xlVeryHidden
Application.CutCopyMode = False


RESTORE3

Sheets("INICIO").Select
Range("A1").Select


End Sub

Sub RESTORE3()

Application.EnableEvents = False

Dim LR As Long, LRR As Long
Dim destRng As Range
Dim Rng As Range
Dim RR As Range

MSG1 = MsgBox("Fazer restore das equipas e competi|fffd||fffd|es?", vbYesNo, "")

If MSG1 = vbYes Then

CLEAR_FILTER

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

LRR = Sheets(1).Range("V" & ROWS.COUNT).End(xlUp).row

Set R = Sheets(1).Range("V1:X" & LRR)

Application.Goto WB.Sheets("Config. Equipas & Competi|fffd||fffd|es").Cells(7, 6)
    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("H1")
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

    Sheets(1).Activate
    R.Select
    Selection.COPY
Application.Goto WB.Sheets("Config. Equipas & Competi|fffd||fffd|es").Cells(7, 6)
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    End With
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

Set RR = Sheets(1).Range("Y1:AV" & LRR)

Application.Goto WB.Sheets("Config. Equipas & Competi|fffd||fffd|es").Cells(7, 6)
    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("K1")
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

    Sheets(1).Activate
    RR.Select
    Selection.COPY
Application.Goto WB.Sheets("Config. Equipas & Competi|fffd||fffd|es").Cells(7, 6)
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    
    Columns("A:AH").Select
With Selection
.HorizontalAlignment = xlCenter
End With

End With
    
   
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

LR = Sheets(1).Range("BJ" & ROWS.COUNT).End(xlUp).row

Set Rng = Sheets(1).Range("BH1:BZ" & LR)

Application.Goto WB.Sheets("ADD EQUIPAS").Cells(7, 6)
    With Sheets("ADD EQUIPAS")
    Set destRng = .Range("A1")
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")
    Sheets(1).Activate
    Rng.Select
    Selection.COPY
Application.Goto WB.Sheets("ADD EQUIPAS").Cells(7, 6)
    Sheets("ADD EQUIPAS").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    End With
    
Workbooks("BACKUP.xlsx").Application.DisplayAlerts = False
Workbooks("BACKUP.xlsx").Close SaveChanges:=True

Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate

REMOVE_DUPLIC2


Else
Workbooks("BACKUP.xlsx").Application.DisplayAlerts = False
Workbooks("BACKUP.xlsx").Close SaveChanges:=True

End If

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True

RUN
End Sub

Sub HIDE_COMP()

If Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("B1").Value = "SIMPLES" Then

Sheets("DATA").Activate
Columns("B:B").EntireColumn.Hidden = True

Else
Sheets("DATA").Activate
Columns("B:B").EntireColumn.Hidden = False
End If

End Sub






Attribute VB_Name = "Module2"

Option Explicit

Const MAX_VAL = 12
Const MIN_VAL = 1
Const INCREMENT = 1

Sub SpinUp_Click()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

  Dim V
  V = Range("C1")
  If IsNumeric(V) Then
    If V < MAX_VAL Then
      Range("C1") = V + INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic
  
End Sub




Sub SpinDn_Click()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

Dim V
  V = Range("C1")
  If IsNumeric(V) Then
    If V > MIN_VAL Then
      Range("C1") = V - INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic
End Sub
Attribute VB_Name = "Module20"
Sub PAIS_UNI()

Dim Rng As Range
Dim InputRng As Range, OutRng As Range

Application.ScreenUpdating = False
Sheets("LISTS").Activate
Sheets("LISTS").Range("CP3:CP500").Select
Selection.ClearContents

Set dt = CreateObject("Scripting.Dictionary")

xTitleId = "KutoolsforExcel"

Set InputRng = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("CPAIS")
Set OutRng = Sheets("LISTS").Range("CP3")
For Each Rng In InputRng
    If Rng.Value <> "" Then
        dt(Rng.Value) = ""
    End If
Next
OutRng.Range("A1").Resize(dt.COUNT) = Application.WorksheetFunction.Transpose(dt.Keys)

UNIQUE_COMPET

End Sub
Sub UNIQUE_COMPET()
Dim Rng As Range
Dim InputRng As Range, OutRng As Range

Application.ScreenUpdating = False
Sheets("LISTS").Activate
Sheets("LISTS").Range("CQ3:CQ500").Select
Selection.ClearContents
    
Set dt = CreateObject("Scripting.Dictionary")

xTitleId = "KutoolsforExcel"

Set InputRng = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("FULLTAB")
Set OutRng = Sheets("LISTS").Range("CQ3")
For Each Rng In InputRng
    If Rng.Value <> "" Then
        dt(Rng.Value) = ""
    End If
Next
OutRng.Range("A1").Resize(dt.COUNT) = Application.WorksheetFunction.Transpose(dt.Keys)

SORT_COMP

ADD_PAIS

NAMES_MAN

End Sub

Sub SORT_COMP()
Dim LR As Long

LR = Sheets("LISTS").Range("CQ65536").End(xlUp).row

Sheets("LISTS").Activate

    Range("CQ3:CQ" & LR).Select
    ActiveWorkbook.Worksheets("LISTS").Sort.SortFields. _
        CLEAR
    ActiveWorkbook.Worksheets("LISTS").Sort.SortFields.ADD _
        Key:=Range("CQ3:CQ" & LR), SortOn:=xlSortOnValues, ORDER:=xlAscending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("LISTS").Sort
        .SetRange Range("CQ3:CQ" & LR)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

Sub ADD_PAIS()

Dim R As Range
Dim destRng As Range
Dim LR As Long

Application.ScreenUpdating = False

CLEAR_FILTER

Set R = Sheets("LISTS").Range("CP3:CP140")

    With Sheets("Config. Equipas & Competi|fffd||fffd|es")
    Set destRng = .Range("B5:B142")
    Sheets("LISTS").Activate
    R.Select
    Selection.COPY
    Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    
    End With

Application.CutCopyMode = False

REMOVE_DUPLIC33

End Sub

Sub REMOVE_DUPLIC33()

Dim LASTROW As Long

LASTROW = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H3:AN" & LASTROW).RemoveDuplicates Columns:=Array(1, 2), _
    Header:=xlNo

Application.Goto Reference:="R" & LASTROW - 1 & "C8", Scroll:=True

UPDATE_EQUIPAS_COMPET

End Sub

Sub UPDATE_EQUIPAS_COMPET()
Dim LR As Long
Dim rCell As Range

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False

LR = Cells(ROWS.COUNT, "H").End(xlUp).row

'*********** COMP. NACIONAL ******************

For Each rCell In Range("S3:S" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -11).Address(0, -11) & ",COMPNACIONAIS3,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("W3:W" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -15).Address(0, -15) & ",COMPNACIONAIS4,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("AA3:AA" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -19).Address(0, -19) & ",COMPNACIONAIS5,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("AE3:AE" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -23).Address(0, -23) & ",COMPNACIONAIS6,2,0),"""")"
    End If
Next rCell

'*********** TA|fffd|AS ******************

For Each rCell In Range("P3:P" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -4).Address(0, -4) & "="""",""""," & rCell.Offset(, -4).Address(0, -4) & ")"
    End If
Next rCell

For Each rCell In Range("T3:T" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -4).Address(0, -4) & "="""",""""," & rCell.Offset(, -4).Address(0, -4) & ")"
    End If
Next rCell

For Each rCell In Range("X3:X" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -4).Address(0, -4) & "="""",""""," & rCell.Offset(, -4).Address(0, -4) & ")"
    End If
Next rCell

For Each rCell In Range("AB3:AB" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -4).Address(0, -4) & "="""",""""," & rCell.Offset(, -4).Address(0, -4) & ")"
    End If
Next rCell

For Each rCell In Range("AF3:AF" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -4).Address(0, -4) & "="""",""""," & rCell.Offset(, -4).Address(0, -4) & ")"
    End If
Next rCell

'*********** INT CLUBES ******************

For Each rCell In Range("U3:U" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -13).Address(0, -13) & ",INTCLUBES3,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("Y3:Y" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -17).Address(0, -17) & ",INTCLUBES4,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("AC3:AC" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -21).Address(0, -21) & ",INTCLUBES5,2,0),"""")"
    End If
Next rCell

For Each rCell In Range("AG3:AG" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IFERROR(VLOOKUP(" & rCell.Offset(, -25).Address(0, -25) & ",INTCLUBES6,2,0),"""")"
    End If
Next rCell

'********************************************

For Each rCell In Range("CV3:CV" & LR)
    If IsEmpty(rCell.Value) Then
        rCell.Formula = "=IF(" & rCell.Offset(, -92).Address(0, -92) & "<>"""",SUMPRODUCT(--(DESPORTO=""SOCCER"")+(DESPORTO=""FOOTBALL""),--(EQEQ1=" & rCell.Offset(, -92).Address(0, -92) & ")+(EQEQ2=" & rCell.Offset(, -92).Address(0, -92) & "),PL),"""")"
    End If
Next rCell

'********************************************

Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True

    
End Sub

Attribute VB_Name = "Module21"
Option Explicit

Sub goto_webpage()


Dim WSh As Object

Set WSh = CreateObject("WScript.Shell")
WSh.RUN "https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=SU2G3T5A67XW8&lc=PT&item_name=Betfair%20Profits&currency_code=EUR&bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted"

End Sub

Sub goto_webpage2()

Dim WSh As Object

Set WSh = CreateObject("WScript.Shell")
WSh.RUN "https://goo.gl/RKBuaq"

End Sub

Sub goto_webpage3()

Dim WSh As Object

Set WSh = CreateObject("WScript.Shell")
WSh.RUN "https://www.youtube.com/channel/UCBQq7O48Qs3ukzL6qJwt7-g"

End Sub
Attribute VB_Name = "Module22"
Sub RUN()
Attribute RUN.VB_ProcData.VB_Invoke_Func = " \n14"

'***************** STOP ********************************
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
'***************** STOP ********************************

Sheets("DATA").Select
Columns("A:K").EntireColumn.AutoFit

Sheets("Data").Range("G65536").End(xlUp).Offset(1, 0).Select
ActiveCell.FormulaR1C1 = ""

Sheets("Data").Range("G65536").End(xlUp).Offset(1, 0).Select
ActiveCell.FormulaR1C1 = ""

Application.Goto Reference:="R1C1", Scroll:=True

Sheets("INICIO").Select
Range("A1").Select

'***************** START ********************************
Application.Calculation = xlCalculationAutomatic
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************


End Sub
Attribute VB_Name = "Module3"
Sub GREENS()
Attribute GREENS.VB_ProcData.VB_Invoke_Func = " \n14"

If Sheets("lists").Range("AD2").Value = 1 Then

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False

    Sheets("lists").Activate
    Columns("AH:AH").Select
    Selection.COPY
    Columns("AJ:AJ").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveSheet.Range("$AJ$1:$AJ$3000").RemoveDuplicates Columns:=1, Header:=xlNo
    Range("AJ1").Select
    Selection.ClearContents
    REDS
        
Application.Calculation = xlCalculationAutomatic
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.ScreenUpdating = True

    Else
    
    MsgBox "sem dados para apresentar"
    
    End If
    
End Sub

Sub REDS()

If Sheets("lists").Range("AD2").Value = 1 Then

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False

    Sheets("lists").Activate
    Columns("AI:AI").Select
    Selection.COPY
    Columns("AK:AK").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveSheet.Range("$AK$1:$AK$3000").RemoveDuplicates Columns:=1, Header:=xlNo
    Range("AK1").Select
    Selection.ClearContents
    
Application.Calculation = xlCalculationAutomatic
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.ScreenUpdating = True
    
    Else
    
    MsgBox "sem dados para apresentar"
    
    End If
    
    Sheets("RESUMO").Select
    Range("A1").Select
End Sub
Attribute VB_Name = "Module4"
Sub IMPOLD()


Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual


MSG1 = MsgBox("Deseja apagar este bot|fffd|o depois de fazer o restore?", vbYesNo, "")

If MSG1 = vbYes Then

IMPORT1

Sheets("INICIO").Select
    ActiveSheet.Unprotect
   
    ActiveSheet.Shapes.Range(Array("Rectangle 34")).Select
    Selection.Delete
    
    Sheets("INICIO").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True
    
Else
IMPORT1
End If

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic
RUN

End Sub

Sub IMPORT1()

Dim fNameAndPath As Variant
Dim LASTROW As Long
Dim destRng As Range

fNameAndPath = Application.GetOpenFilename(FileFilter:="Excel Files (*.XLSX), *.XLS", Title:="Selecione o ficheiro BACKUP.xlsx")
If fNameAndPath = False Then Exit Sub
Workbooks.Open Filename:=fNameAndPath

Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

Set R = Sheets(1).Range("K3:P1000")

Application.Goto WB.Sheets("DATA").Cells(7, 6)

Sheets("DATA2").Visible = True

Application.Goto WB.Sheets("DATA2").Cells(7, 6)
    With Sheets("DATA2")
    Set destRng = .Range("A" & .Cells(.ROWS.COUNT, "A").End(xlUp).row + 1)
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

    Sheets(1).Activate
    R.Select
    Selection.COPY
Application.Goto WB.Sheets("DATA2").Cells(7, 6)
    Sheets("DATA2").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End With
Sheets("DATA2").Visible = xlVeryHidden

IMPORT2


End Sub

Sub IMPORT2()

Dim LASTROW As Long
Dim destRng As Range
      
Application.Goto WB.Sheets("DATA").Cells(7, 6)

With Sheets("DATA")
    Set destRng = .Range("C" & .Cells(.ROWS.COUNT, "C").End(xlUp).row + 1)
    
Application.Goto Workbooks("BACKUP.xlsx").Sheets(1).Range("A1")

LASTROW = Sheets(1).Range("A" & ROWS.COUNT).End(xlUp).row
    Sheets(1).Range("A1:J" & LASTROW).COPY Destination:=destRng
    
End With

Application.Goto WB.Sheets("DATA").Cells(7, 6)

Sheets("Data").Range("G65536").End(xlUp).Offset(1, 0).Select
ActiveCell.FormulaR1C1 = ""

Workbooks("BACKUP.xlsx").Application.DisplayAlerts = False
Workbooks("BACKUP.xlsx").Close SaveChanges:=True



Sheets("INICIO").Select
Range("A1").Select



End Sub





Attribute VB_Name = "Module5"
Sub UP()

Application.ScreenUpdating = False

    Columns("A:L").Select
    ActiveWorkbook.Worksheets("Data").Sort.SortFields.CLEAR
    ActiveWorkbook.Worksheets("Data").Sort.SortFields.ADD Key:=Range("C2:C5000") _
        , SortOn:=xlSortOnValues, ORDER:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Data").Sort
        .SetRange Range("A1:L5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
Range("A1").Select



End Sub

Sub DOWN()

Application.ScreenUpdating = False

    Columns("A:L").Select
    ActiveWorkbook.Worksheets("Data").Sort.SortFields.CLEAR
    ActiveWorkbook.Worksheets("Data").Sort.SortFields.ADD Key:=Range("C2:C5000") _
        , SortOn:=xlSortOnValues, ORDER:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Data").Sort
        .SetRange Range("A1:L5000")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
Range("A1").Select

End Sub





Attribute VB_Name = "Module6"
Sub NAMES_MANAGER()
'FOLHA DATA
Dim LASTROW As Long, LR As Long

LR = Sheets("Data").Range("C65536").End(xlUp).row

Sheets("LISTS").Range("CU1").Value = LR

Application.ScreenUpdating = False

If Sheets("LISTS").Range("CW1").Value = "UPDATE" Then

LASTROW = Sheets("LISTS").Range("CX1").Value

Sheets("DATA").Select
        
    ActiveWorkbook.Names.ADD NAME:="DATA", RefersToR1C1:= _
        "=Data!R2C3:R" & LASTROW & "C3"
   
    ActiveWorkbook.Names.ADD NAME:="DESPORTO", RefersToR1C1:= _
        "=Data!R2C4:R" & LASTROW & "C4"

    ActiveWorkbook.Names.ADD NAME:="MERCADO", RefersToR1C1:= _
        "=Data!R2C5:R" & LASTROW & "C5"

       ActiveWorkbook.Names.ADD NAME:="PL", RefersToR1C1:= _
        "=Data!R2C7:R" & LASTROW & "C7"

    ActiveWorkbook.Names.ADD NAME:="COMPETI|fffd||fffd|O", RefersToR1C1:= _
        "=Data!R2C2:R" & LASTROW & "C2"
        
    ActiveWorkbook.Names.ADD NAME:="GOLOSF", RefersToR1C1:= _
        "=Data!R2C10:R" & LASTROW & "C10"
        
    ActiveWorkbook.Names.ADD NAME:="STAKE", RefersToR1C1:= _
        "=Data!R2C8:R" & LASTROW & "C8"
        
    ActiveWorkbook.Names.ADD NAME:="GOLOSC", RefersToR1C1:= _
        "=Data!R2C11:R" & LASTROW & "C11"
        
    ActiveWorkbook.Names.ADD NAME:="ANO", RefersToR1C1:= _
        "=Data!R2C28:R" & LASTROW & "C28"
        
    ActiveWorkbook.Names.ADD NAME:="MES", RefersToR1C1:= _
        "=Data!R2C29:R" & LASTROW & "C29"
        
     ActiveWorkbook.Names.ADD NAME:="EVENTO", RefersToR1C1:= _
        "=Data!R2C6:R" & LASTROW & "C6"
        
    ActiveWorkbook.Names.ADD NAME:="PA|fffd|S", RefersToR1C1:= _
        "=Data!R2C1:R" & LASTROW & "C1"
        
    ActiveWorkbook.Names.ADD NAME:="EQEQ1", RefersToR1C1:= _
        "=Data!R2C30:R" & LASTROW & "C30"
        
    ActiveWorkbook.Names.ADD NAME:="EQEQ2", RefersToR1C1:= _
        "=Data!R2C31:R" & LASTROW & "C31"
        
End If

End Sub

Sub NAMES_MAN()
'CONFIG EQUIPAS & COMPETI|fffd||fffd|ES
Dim LASTROW As Long, LR As Long



LR = Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("H65536").End(xlUp).row

Sheets("LISTS").Range("BQ2").Value = LR

Application.ScreenUpdating = False

If Sheets("LISTS").Range("BS2").Value = "UPDATE" Then

LASTROW = Sheets("LISTS").Range("BU2").Value

CLEAR_FILTER

 ActiveWorkbook.Names.ADD NAME:="CLUBESLIST", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C8:R" & LASTROW & "C10"
        
 ActiveWorkbook.Names.ADD NAME:="CLISTA", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C8:R" & LASTROW & "C8"
        
 ActiveWorkbook.Names.ADD NAME:="CLISTAA", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R3C8:R" & LASTROW & "C8"
        
 ActiveWorkbook.Names.ADD NAME:="CCOMP", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C9:R" & LASTROW & "C10"
        
 ActiveWorkbook.Names.ADD NAME:="FULLTAB", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R3C11:R" & LASTROW & "C34"

 ActiveWorkbook.Names.ADD NAME:="CPAIS", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R3C9:R" & LASTROW & "C9"
        
 ActiveWorkbook.Names.ADD NAME:="EQUIPAS", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R3C100:R" & LASTROW & "C100"
        
'####################################################################
 ActiveWorkbook.Names.ADD NAME:="CLUBES20142015", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C11:R" & LASTROW & "C14"
        
 ActiveWorkbook.Names.ADD NAME:="CLUBES20152016", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C15:R" & LASTROW & "C18"

 ActiveWorkbook.Names.ADD NAME:="CLUBES20162017", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C19:R" & LASTROW & "C22"
        
ActiveWorkbook.Names.ADD NAME:="CLUBES20172018", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C23:R" & LASTROW & "C26"
        
ActiveWorkbook.Names.ADD NAME:="CLUBES20182019", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C27:R" & LASTROW & "C30"

ActiveWorkbook.Names.ADD NAME:="CLUBES20192020", RefersToR1C1:= _
        "='Config. Equipas & Competi|fffd||fffd|es'!R2C31:R" & LASTROW & "C34"

        
End If


End Sub

Sub NAMES_MAN2()
'ADD EQUIPAS
Dim LASTROW As Long, LASTROW2 As Long, LR As Long, LR1 As Long, LRR As Long, LRR1 As Long, LRRR As Long, LRRR1 As Long

Application.ScreenUpdating = False

LASTROW = Sheets("ADD EQUIPAS").Range("D65536").End(xlUp).row
LASTROW2 = Sheets("ADD EQUIPAS").Range("B65536").End(xlUp).row

LR = Sheets("ADD EQUIPAS").Range("G65536").End(xlUp).row
LR1 = Sheets("ADD EQUIPAS").Range("I65536").End(xlUp).row

LRR = Sheets("ADD EQUIPAS").Range("L65536").End(xlUp).row
LRR1 = Sheets("ADD EQUIPAS").Range("N65536").End(xlUp).row

LRRR = Sheets("ADD EQUIPAS").Range("Q65536").End(xlUp).row
LRRR1 = Sheets("ADD EQUIPAS").Range("S65536").End(xlUp).row

ActiveWorkbook.Names.ADD NAME:="COMPNACIONAIS3", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C3:R" & LASTROW & "C4"
        
ActiveWorkbook.Names.ADD NAME:="INTCLUBES3", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C1:R" & LASTROW2 & "C2"
              
If LR <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="INTCLUBES4", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C6:R" & LR & "C7"
End If
If LR1 <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="COMPNACIONAIS4", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C8:R" & LR1 & "C9"
End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
If LRR <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="INTCLUBES5", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C11:R" & LRR & "C12"
End If
If LRR1 <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="COMPNACIONAIS5", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C13:R" & LRR1 & "C14"
End If
'>>>>>>>>>>>>>>>>>>>>>>>>>
If LRRR <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="INTCLUBES6", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C16:R" & LRRR & "C17"
End If
If LRRR1 <= 2 Then
Else
ActiveWorkbook.Names.ADD NAME:="COMPNACIONAIS6", RefersToR1C1:= _
        "='ADD EQUIPAS'!R3C18:R" & LRRR1 & "C19"
End If


End Sub

Attribute VB_Name = "Module7"

Option Explicit

Const MAX_VAL = 12
Const MIN_VAL = 1
Const INCREMENT = 1

Sub SpinUp_Click2()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

  Dim V
  V = Range("INICIO!$C$1")
  If IsNumeric(V) Then
    If V < MAX_VAL Then
      Range("INICIO!$C$1") = V + INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic
End Sub

Sub SpinDn_Click2()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

Dim V
  V = Range("INICIO!$C$1")
  If IsNumeric(V) Then
    If V > MIN_VAL Then
      Range("INICIO!$C$1") = V - INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic
End Sub

Sub SpinUp_Click3()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

  Dim V
  V = Range("INICIO!$C$1")
  If IsNumeric(V) Then
    If V < MAX_VAL Then
      Range("INICIO!$C$1") = V + INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic

REFRESH

End Sub

Sub SpinDn_Click3()

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
Application.Calculation = xlCalculationManual

Dim V
  V = Range("INICIO!$C$1")
  If IsNumeric(V) Then
    If V > MIN_VAL Then
      Range("INICIO!$C$1") = V - INCREMENT
    End If
  End If
  
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
Application.Calculation = xlCalculationAutomatic

REFRESH

End Sub

Attribute VB_Name = "Module8"
Sub ButLEV()

Dim dated As Date
Dim valor As String
On Error GoTo TryAgain

valor = Application.InputBox( _
        Prompt:="Insira o valor:", _
        Title:="Levantamento")
        
If valor = "" Or valor = "False" Then Exit Sub
    If valor = True Then
        Sheets("DATA2").Range("H2").Value = valor
        
TryAgain:


dated = Application.InputBox( _
        Prompt:="Insira a data no formato dia/m|fffd|s/ano:", _
        Title:="Data de levantamento", _
        Default:=Format(Date, "DD/MM/YY"), _
        Type:=2)


If dated = False Then Exit Sub
    If IsDate(dated) = True Then
        Sheets("DATA2").Range("G2").Value = dated
    Else
    
    MsgBox "Data inv|fffd|lida. Insira novamente no formato correcto."
        
    End If
        
    Else
    
    MsgBox "valor inv|fffd|lido."
    
    End If
    
LEV

End Sub

Sub ButDEP()

Dim dated As Date
Dim valor As String
On Error GoTo TryAgain

valor = Application.InputBox( _
        Prompt:="Insira o valor:", _
        Title:="Dep|fffd|sito")
        
If valor = "" Or valor = "False" Then Exit Sub
    If valor = True Then
        Sheets("DATA2").Range("H2").Value = valor
        
TryAgain:


dated = Application.InputBox( _
        Prompt:="Insira a data formato dia/m|fffd|s/ano:", _
        Title:="Data de dep|fffd|sito", _
        Default:=Format(Date, "DD/MM/YY"), _
        Type:=2)


If dated = False Then Exit Sub
    If IsDate(dated) = True Then
        Sheets("DATA2").Range("G2").Value = dated
    Else
    
    MsgBox "Data inv|fffd|lida. Insira novamente no formato correcto."
        
    End If
        
    Else
    
    MsgBox "valor inv|fffd|lido."
    
    End If
    
DEP

End Sub

Sub ButPC()

Dim dated As Date
Dim valor As String
On Error GoTo TryAgain

valor = Application.InputBox( _
        Prompt:="Insira o valor:", _
        Title:="Taxas Premium")
        
If valor = "" Or valor = "False" Then Exit Sub
    If valor = True Then
        Sheets("DATA2").Range("H2").Value = valor
        
TryAgain:


dated = Application.InputBox( _
        Prompt:="Insira a data no formato dia/m|fffd|s/ano:", _
        Title:="Data Taxas Premium", _
        Default:=Format(Date, "DD/MM/YY"), _
        Type:=2)


If dated = False Then Exit Sub
    If IsDate(dated) = True Then
        Sheets("DATA2").Range("G2").Value = dated
    Else
    
    MsgBox "Data inv|fffd|lida. Insira novamente no formato correcto."
        
    End If
        
    Else
    
    MsgBox "valor inv|fffd|lido."
    
    End If
    
PC

End Sub

Sub ButDEPI()

Dim dated As Date
Dim valor As String
On Error GoTo TryAgain

valor = Application.InputBox( _
        Prompt:="Insira o valor:", _
        Title:="Dep|fffd|sito Inicial")
        
If valor = "" Or valor = "False" Then Exit Sub
    If valor = True Then
        Sheets("DATA2").Range("D3").Value = valor
        
TryAgain:


dated = Application.InputBox( _
        Prompt:="Insira a data no formato dia/m|fffd|s/ano:", _
        Title:="Data de dep|fffd|sito inicial", _
        Default:=Format(Date, "DD/MM/YY"), _
        Type:=2)


If dated = False Then Exit Sub
    If IsDate(dated) = True Then
        Sheets("DATA2").Range("C3").Value = dated
    Else
    
    MsgBox "Data inv|fffd|lida. Insira novamente no formato correcto."
        
    End If
        
    Else
    
    MsgBox "valor inv|fffd|lido."
    
    End If
    

End Sub



Attribute VB_Name = "Module9"
Sub UPDATE_PL()

Dim LASTROW As Long
Dim destRng As Range
Dim NumberOfRows As Long
Dim R As Range
Dim ROWS As Long

LASTROW = Sheets("Data").Range("G65536").End(xlUp).row

Application.ScreenUpdating = False

MSG1 = MsgBox("Confirmar UPDATE L&P?", vbYesNo, "")

If MSG1 = vbYes Then

'***************** STOP ********************************
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

Showall

Application.Workbooks.Open ("C:\BettingPandL.xls")

Application.Goto Workbooks("BettingPandL.xls").Sheets("SHEET0").Cells(1, 6)

Selection.COPY
    Range("D3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _
        False, Transpose:=False
    
Application.Goto Workbooks("BettingPandL.xls").Sheets("SHEET0").Cells(3, 6)

NumberOfRows = Sheets("SHEET0").Range("A65536").End(xlUp).row

Range(Cells(3, 6), Cells(NumberOfRows, 6)).Formula = "=MID(C3,11,5)"
Range(Cells(3, 7), Cells(NumberOfRows, 7)).Formula = "=IF(F3<>"""",IF(F3<""07:00"",""ANTERIOR"",""OK""),"""")"
Range(Cells(3, 8), Cells(NumberOfRows, 8)).Formula = "=IF(G3=""ANTERIOR"",MID(C3,1,2),"""")"
Range(Cells(3, 9), Cells(NumberOfRows, 9)).Formula = "=IF(H3<>"""",H3-1,IFERROR(VALUE(MID(C3,1,2)),""""))"
Range(Cells(3, 14), Cells(NumberOfRows, 14)).Formula = "=IF(AND(OR(LEFT(A3,SEARCH("" /"",A3,1)-1)=""FOOTBALL"",LEFT(A3,SEARCH("" /"",A3,1)-1)=""SOCCER""),A3<>""""),""Football"",LEFT(A3,SEARCH("" / "",A3,1)-1))"
Range(Cells(3, 13), Cells(NumberOfRows, 13)).Formula = "=DATE(MID(C3,FIND("" "",C3)-2,2)+2000,LOOKUP(MID(C3,FIND(""-"",C3)+1,3),{""Apr"",""Aug"",""Dec"",""Feb"",""Jan"",""Jul"",""Jun"",""Mar"",""May"",""Nov"",""Oct"",""Sep""},{4,8,12,2,1,7,6,3,5,11,10,9}),I3)"
Range(Cells(3, 15), Cells(NumberOfRows, 15)).Formula = "=MID(A3,SEARCH("" :"",A3,1)+3,50)"
Range(Cells(3, 16), Cells(NumberOfRows, 16)).Formula = "=MID(A3,SEARCH("" /"",A3,1)+3,SEARCH("" :"",A3,1)-SEARCH("" /"",A3,1)-3)"
Range(Cells(3, 17), Cells(NumberOfRows, 17)).Formula = "=D3"

'********************************* MOEDA ****************************************


If WB.Sheets("INICIO").Range("Q19").Value = "EUR" Then
Range("Q3:Q" & NumberOfRows).Select
Selection.NumberFormat = "#,##0.00 $"
End If

If WB.Sheets("INICIO").Range("Q19").Value = "GPB" Then
Range("Q3:Q" & NumberOfRows).Select
Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
End If

If WB.Sheets("INICIO").Range("Q19").Value = "USD" Then
Range("Q3:Q" & NumberOfRows).Select
Selection.NumberFormat = "[$$-409]#,##0.00"
End If

'*********************************************************************

Columns("M:P").Select
With Selection
.HorizontalAlignment = xlCenter
End With

Set R = Sheets("SHEET0").Range("M3:Q" & NumberOfRows)

Application.Goto WB.Sheets("Data").Cells(7, 6)
    With Sheets("Data")
    Set destRng = .Range("C" & .Cells(.ROWS.COUNT, "C").End(xlUp).row + 1)
    
Application.Goto Workbooks("BettingPandL.xls").Sheets("Sheet0").Cells(3, 13)

    Sheets("SHEET0").Activate
    R.Select
    Selection.COPY
Application.Goto WB.Sheets("Data").Cells(7, 6)
    Sheets("Data").Activate
    destRng.Select
    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _
        xlNone, SkipBlanks:=False, Transpose:=False
End With

'FECHAR FOLHA
Application.CutCopyMode = False
Workbooks("BettingPandL.xls").Application.DisplayAlerts = False
Workbooks("BettingPandL.xls").Close SaveChanges:=False

REMOVEFIN

RUN

'***************** START ********************************
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************

Else
End If



End Sub

Sub REMOVEFIN()

Dim LASTROW As Long

'***************** STOP ********************************
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

LASTROW = Sheets("Data").Range("G65536").End(xlUp).row

Sheets("DATA").Range("A2:L" & LASTROW).RemoveDuplicates Columns:=Array(3, 5, 6, 7), Header:=xlNo

'***************** START ********************************
Application.Calculation = xlCalculationAutomatic
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
End Sub




Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox8, 11, 7, MSForms, CheckBox"
Attribute VB_Control = "ComboBox2, 44, 8, MSForms, ComboBox"
Private Sub CheckBox8_Click()
'CONFIGURA|fffd||fffd|O SIMPLES/AVAN|fffd|ADA
If Columns("K:AH").EntireColumn.Hidden = False Then
Columns("K:AH").EntireColumn.Hidden = True
Columns("C:D").EntireColumn.Hidden = True
Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("A1").Value = "SIMPLES"
Range("H1").Select
Else
Columns("K:AH").EntireColumn.Hidden = False
Columns("C:D").EntireColumn.Hidden = False
Sheets("Config. Equipas & Competi|fffd||fffd|es").Range("A1").Value = "AVAN|fffd|ADA"
Range("H1").Select
End If
End Sub

Private Sub ComboBox2_GotFocus()
ComboBox2.ListFillRange = "=DropDownList"
Me.ComboBox2.DropDown

End Sub
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Address = "$Q$19" Then
Call MOEDA
End If


End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

Dim lngStart As Long, lngEnd As Long, NumberOfRows As Long

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

If Target.Column = 1 Then
Exit Sub
End If

If Target.Column >= 9 Then
Exit Sub
End If

If Target.row < 6 Then
Exit Sub
End If

If Target.row >= 22 Then
Exit Sub
End If

If Target.row = 7 Or Target.row = 8 Or Target.row = 10 Or Target.row = 11 Or Target.row = 13 Or Target.row = 14 Or Target.row = 16 Or Target.row = 17 Or Target.row = 19 Or Target.row = 20 Then
Exit Sub
End If

'*******************************************************************************************
'COLUNA SELECIONAR DIA

If Target.Column = 2 Or 3 Then

Sheets("LISTS").Range("Z7") = Selection

Showall
Filter2
Sheets("data").Activate

Application.Goto Reference:="R1C1", Scroll:=True


End If

'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 10, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 13, 1, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 14, 2, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 15, 3, MSForms, CheckBox"
Private Sub CheckBox1_Click()

If Columns("N:P").EntireColumn.Hidden = False Then

Columns("N:P").EntireColumn.Hidden = True

Range("J3").Select
Else

Columns("N:P").EntireColumn.Hidden = False

Range("N3").Select

End If
End Sub

Private Sub CheckBox2_Click()

If Columns("K:K").EntireColumn.Hidden = False Then

Columns("K:K").EntireColumn.Hidden = True
Range("J3").Select
Else

Columns("K:K").EntireColumn.Hidden = False
Range("K3").Select
End If
End Sub

Private Sub CheckBox3_Click()

If Columns("L:L").EntireColumn.Hidden = False Then

Columns("L:L").EntireColumn.Hidden = True
Range("J3").Select
Else

Columns("L:L").EntireColumn.Hidden = False
Range("L3").Select
End If
End Sub

Private Sub CheckBox4_Click()
If Columns("M:M").EntireColumn.Hidden = False Then

Columns("M:M").EntireColumn.Hidden = True
Range("J3").Select
Else

Columns("M:M").EntireColumn.Hidden = False
Range("M3").Select
End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

Dim lngStart As Long, lngEnd As Long, NumberOfRows As Long

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

If Target.Column <> 2 Then
Exit Sub
End If

If Target.row < 6 Then
Exit Sub
End If

If Target.row >= 37 Then
Exit Sub
End If

If Target = "" Then
Exit Sub
End If

'*******************************************************************************************
'COLUNA SELECIONAR DIA

If Target.Column = 2 Then

Sheets("LISTS").Range("X1") = "=INICIO!B1"
Sheets("LISTS").Range("Y1") = "=INICIO!C1"
Sheets("LISTS").Range("Z1") = Selection

Showall
Filter
Sheets("data").Activate

Application.Goto Reference:="R1C1", Scroll:=True

End If

'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
End Sub

Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 3, 0, MSForms, CheckBox"
Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Address = "$C$68" Then
Call REFRESH
End If


End Sub
Private Sub CheckBox1_Click()

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************


If Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("AG1").Value = "" Then

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Unprotect

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("AG1").Value = "ALL"

Application.ScreenUpdating = False

With Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES")

            .AutoFilterMode = False

            .Range("B3:D209").AutoFilter
            
End With
   
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B5:C54").Sort Header:=xlNo, Key1:=Sheet6.Range("C5"), _
        Order1:=xlDescending
    
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B70:C209").Sort Header:=xlNo, Key1:=Sheet6.Range("C70"), _
        Order1:=xlDescending
       
        
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B3:D209").Select

   Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("$B$3:$D$209").AutoFilter Field:=3, Criteria1:="<>0", Operator:=xlFilterValues
    

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowFiltering _
        :=True
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select

Range("A1").Select

Else

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Unprotect

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("AG1").Value = ""

Application.ScreenUpdating = False

With Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES")

            .AutoFilterMode = False

            .Range("B3:D209").AutoFilter
            
End With
   
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B5:C54").Sort Header:=xlNo, Key1:=Sheet6.Range("C5"), _
        Order1:=xlDescending
    
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B70:C209").Sort Header:=xlNo, Key1:=Sheet6.Range("C70"), _
        Order1:=xlDescending
       
        
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("B3:D209").Select

   Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Range("$B$3:$D$209").AutoFilter Field:=3, Criteria1:="<>0", Operator:=xlFilterValues
    

Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowFiltering _
        :=True
    Sheets("MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES").Select

Range("A1").Select
End If
'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

Dim lngStart As Long, lngEnd As Long

'***************** STOP ********************************
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

If Target.Column = 3 Or Target.Column = 5 Or Target.Column = 7 Or Target.Column = 8 Or Target.Column = 9 Or Target.Column = 10 Or Target.Column = 11 Or Target.Column = 13 Or Target.Column = 15 Or Target.Column = 17 Then
Exit Sub
End If

If Target.Column = 1 Then
Exit Sub
End If

If Target.row <= 4 Then
Exit Sub
End If

If Target.row = 55 Or Target.row = 56 Or Target.row = 57 Or Target.row = 67 Or Target.row = 68 Or Target.row = 69 Then
Exit Sub
End If

If Target.row >= 210 And Target.row <= 246 Then
Exit Sub
End If

If Target.Column = 2 And Target.row >= 5 And Target.row <= 54 Then

Sheets("LISTS").Range("Z27") = Selection
Sheets("LISTS").Range("Z28") = "='MERCADOS_EQUIPAS_COMPETI|fffd||fffd|ES'!C2"

Showall
Filter9
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 2 And Target.row = 58 Then

Showall
Filter10
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 2 And Target.row >= 59 And Target.row <= 66 Then

Sheets("LISTS").Range("Z13") = Selection

Showall
Filter6
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If


If Target.Column = 2 And Target.row >= 70 And Target.row <= 209 Then

Sheets("LISTS").Range("Z14") = Selection

Showall
Filter7
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 4 Or Target.Column = 14 And Target.row >= 247 And Target.row <= 266 Then

Sheets("LISTS").Range("Z10") = Selection

Showall
Filter3
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 6 Or Target.Column = 16 And Target.row >= 247 And Target.row <= 266 Then

Sheets("LISTS").Range("Y10") = Selection

Showall
Filter4
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 12 And Target.row >= 247 And Target.row <= 266 Then

Sheets("LISTS").Range("Y11") = Selection

Showall
Filter1
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

If Target.Column = 2 And Target.row >= 247 And Target.row <= 266 Then

Sheets("LISTS").Range("Y12") = Selection

Showall
Filter123
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True
End If

'***************** START ********************************
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************

End Sub


Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

Dim lngStart As Long, lngEnd As Long, NumberOfRows As Long

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
'***************** STOP ********************************

If Target.Column <> 3 Then
Exit Sub
End If

If Target.row < 7 Then
Exit Sub
End If

If Target.row >= 19 Then
Exit Sub
End If

If Target = "" Then
Exit Sub
End If

'*******************************************************************************************
'COLUNA SELECIONAR DIA

If Target.Column = 3 Then

Sheets("LISTS").Range("Z19") = "=INICIO!B1"
Sheets("LISTS").Range("Z20") = Selection

Showall
Filter8
Sheets("data").Activate
Application.Goto Reference:="R1C1", Scroll:=True

End If

'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
End Sub
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)

Dim LR As Long
Dim LRR As Long
Dim ROWS As Long
Dim KeyCells As Range

Set KeyCells = Range("G2:G65536")

On Error GoTo errhndlr
   
ROWS = Sheets("Data").Range("C65536").End(xlUp).row
   
LR = Sheets("Data").Range("C65536").End(xlUp).row + 1

LRR = Sheets("Data").Range("G65536").End(xlUp).row + 1

'###################################################################
'###################################################################

If Not Application.Intersect(KeyCells, Range(Target.Address)) _
           Is Nothing Then
           
'***************** STOP ********************************
Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
ActiveSheet.DisplayPageBreaks = False
'***************** STOP ********************************

If LR And LRR <= 2 Then

Sheets("DATA").Activate
Columns("G:I").Select
    Selection.FormatConditions.Delete

Sheets("Data").Range("A65536").End(xlUp).Select

Exit Sub

Else
End If

'*****************************************************************************
If LR And LRR > 2 And LR = LRR Then
'****************************** MOEDA ****************************************
If Sheets("INICIO").Range("Q19").Value = "EUR" Then
Range("G2:H" & LR).Select
Selection.NumberFormat = "#,##0.00 $"
End If

If Sheets("INICIO").Range("Q19").Value = "GPB" Then
Range("G2:H" & LR).Select
Selection.NumberFormat = "[$|fffd|-809]#,##0.00"
End If

If Sheets("INICIO").Range("Q19").Value = "USD" Then
Range("G2:H" & LR).Select
Selection.NumberFormat = "[$$-409]#,##0.00"
End If

'*****************************************************************************

Range(Cells(2, 9), Cells(ROWS, 9)).Formula = "=IFERROR(IF(H2<>"""",G2/H2,""""),"""")"
Range(Cells(2, 13), Cells(ROWS, 13)).Formula = "=IFERROR(IF(AND(OR(D2=""FOOTBALL"",D2=""SOCCER""),A2="""",ISERROR(INDEX(CLISTA,MATCH(AD2,CLISTA,0))=TRUE)),AD2,""""),"""")"
Range(Cells(2, 14), Cells(ROWS, 14)).Formula = "=IFERROR(IF(AND(OR(D2=""FOOTBALL"",D2=""SOCCER""),A2="""",ISERROR(INDEX(CLISTA,MATCH(AE2,CLISTA,0))=TRUE)),AE2,""""),"""")"
Range(Cells(2, 28), Cells(ROWS, 28)).Formula = "=IF(C2<>"""",YEAR(C2),"""")"
Range(Cells(2, 29), Cells(ROWS, 29)).Formula = "=IF(C2<>"""",MONTH(C2),"""")"

Range(Cells(2, 30), Cells(ROWS, 30)).Formula = "=IFERROR(IF(OR(D2=""FOOTBALL"",D2=""SOCCER""),LEFT(F2,SEARCH("" V "",F2,1)-1),""""),"""")"
Range(Cells(2, 31), Cells(ROWS, 31)).Formula = "=IFERROR(IF(OR(D2=""FOOTBALL"",D2=""SOCCER""),MID(F2,SEARCH("" V "",F2,1)+3,50),""""),"""")"

Columns("A:K").EntireColumn.AutoFit

Columns("G:I").Select
    Selection.FormatConditions.Delete

Columns("C:C").Select
With Selection
.NumberFormat = "m/d/yyyy"
End With

Columns("A:N").Select
With Selection
.HorizontalAlignment = xlCenter
End With

Columns("L:L").Select
With Selection
.HorizontalAlignment = xlLeft
End With

Columns("G:G").Select
With Selection
.HorizontalAlignment = xlRight
End With

Range("G2").Select
Range(Selection, Selection.End(xlDown)).Select
With Selection

Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlGreater, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
End With

Range("I2").Select
    Range(Selection, Selection.End(xlDown)).Select
    With Selection
    .NumberFormat = "0.00%"
    .HorizontalAlignment = xlCenter
    
Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlBetween, _
        Formula1:="=0,000001", Formula2:="=99999999"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    
    Selection.FormatConditions.ADD Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.COUNT).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
End With

NAMES_MANAGER
autofill
UP
HIDE_COMP

Sheets("Data").Range("G65536").End(xlUp).Select

'***************** START ********************************
Application.Calculation = xlCalculationAutomatic
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************
Else
End If


End If

errhndlr:
Exit Sub


End Sub


Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

Dim Rng As Range

'***************** STOP ********************************

Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.EnableEvents = False
ActiveSheet.DisplayPageBreaks = False
'***************** STOP ********************************


On Error GoTo ERRO

Set Rng = Sheets("DATA").Range("C3:C1000")

If Target.Column <> 6 Then
Exit Sub
End If

If Target.row < 2 Then
Exit Sub
End If

If Target = "" Then
Exit Sub
End If

'*******************************************************************************************

If Target.Column = 6 Then

Sheets("LISTS").Range("CG2") = Selection
Sheets("Config. Equipas & Competi|fffd||fffd|es").Activate

ADD_EQUIPAS

FILTER20

End If

'***************** START ********************************

Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.EnableEvents = True
'***************** START ********************************

ERRO:
Exit Sub



End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()

WB_NAME

If Sheets("data2").Range("D3").Value = "" Then

MSG1 = MsgBox("Para usar a folha correctamente deve inserir o valor de dep|fffd|sito inicial, deseja faze-lo agora?", vbYesNo, "")

If MSG1 = vbYes Then

ButDEPI
Else

End If

End If

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

If Sheets("INICIO").Range("Q23").Value = "NOVO UPDATE" Then


Else

[counter] = [counter] + 1


If Sheets("LISTS").Range("AN1").Value = 10 Then

ActiveWorkbook.Connections("Connection1").REFRESH
    
Sheets("LISTS").Range("AR3").ClearContents
Sheets("LISTS").Range("AN1").ClearContents

Else
End If
End If

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
If Sheets("LISTS").Range("AO1").Value = 50 Then

Sheets("LISTS").Range("AO1").ClearContents

Else

If Sheets("LISTS").Range("AP2").Value = 1 Then

[CONTA] = [CONTA] + 1

Sheets("INICIO").Range("Q23").Value = "NOVO UPDATE"
Else
[CONTA] = 9
Sheets("INICIO").Range("Q23").ClearContents
End If

If Sheets("LISTS").Range("AO2").Value = 9 Then

MSG1 = MsgBox("NOVO UPDATE, FAZER DOWNLOAD AGORA?", vbYesNo, "")

If MSG1 = vbYes Then
Sheets("LISTS").Range("AR3").ClearContents
goto_webpage2

Sheets("LISTS").Range("AR7").ClearContents

Else

MSG1 = MsgBox("LEMBRAR MAIS TARDE?", vbYesNo, "")

If MSG1 = vbYes Then

Sheets("LISTS").Range("AO1").ClearContents

Else

End If

End If

End If

End If
End Sub



INQUEST-PP=macro
