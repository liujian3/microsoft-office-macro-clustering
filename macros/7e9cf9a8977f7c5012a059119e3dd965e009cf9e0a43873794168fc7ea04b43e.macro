Attribute VB_Name = "Libs"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Const const_err = "Error" 'G5K[>2O0R=D]\+)\O(U\O5FL16J;N4:MDI,,Q^X)
Dim array1() As String ',?Y^>ELNBW:Y<]U6+SXVB>T[R*D2):J,^X\?1\4=0F(
Function URLEncode(str_entry As String) As String ']*8+96]/*JJ7BUJP
Dim i As Long, acode As String, str_final As String, str_char As String '
str_final = "" 'I[UN]-X66D+KH<0EN*>4@C1RG,S3P=N3QEYX/GFUT4WD3R2WB:D
str_char = "" '6E*U)A\4HLZW<A8KA2=VUAMYZELH;/F2\6E5*F03]HXMSO-J<X0*
For i = 1 To Len(str_entry) 'B3:O4[D6=.,;*K6T^2T[IH(?-?ZLPV\(JIFLDD
acode = Asc(Mid(str_entry, i, 1)) '\20WVSLG8^NUJT].TCFN5T\M(L9/1V)H
If acode >= 48 And acode <= 57 Then 'COJAMDB7:B\+LM-J,=?L7*V<DC35-=
str_char = Mid(str_entry, i, 1) 'IPUWR6D4LTBZ3P:HI?WF;B\J9?];-?1CQ?
ElseIf acode >= 65 And acode <= 90 Then '0RG?GNI2[\(O;U6I\B/K05)M1^
str_char = Mid(str_entry, i, 1) '*LG6Z^-@>Q@V*=*R==5P*XET4=.^5^JYCF
ElseIf acode >= 97 And acode <= 122 Then 'PSRU=@5=^Z1RBQ^GKZY[G<(:>
str_char = Mid(str_entry, i, 1) '991^H*KY/W-,8ET]SQ89EIUOL?^J\PS>:D
ElseIf acode = 32 Then '>QY2MRO>/7QR\;4G,O0Z[L--CS?0E>JJ.W]R=5@QH?S
str_char = "%20" '9@OYDPFH0W1ZXR:ZKBJ1QR/M69A)EYWO)XOZ?+72[IFUY=F,F
ElseIf acode = 45 Or acode = 46 Or acode = 95 Or acode = 126 Then '
str_char = Mid(str_entry, i, 1) '5:SOUU(=+B,3P<\2:946EE9.\FL.*:@I8M
Else '7O<JH4MA+.;NX<Q9ZZ=SD:WB@TZ/49YSL/>RD?.,J;\[+/EMQINO3UE\C/=<G
str_char = "%" & Hex(acode) '5HH1JODM@@,*?ID-8+/H3BOF:=B+PGY1JI,-HK
End If 'WO0R7/08D91O)P@PT.4SF9H+X5:B\305;:/;*@CFV\?DY5?/E/J4<HJ>HV9
str_final = str_final & str_char ')JJVA^LIV\I?J7)53LK@QT.HZR,9+F>IJ
Next 'GB5(;9GSW>J]GQ@3-RVU]1QYH/R@<J]*7/)@B@ER8[EJ?T?M<V\A24J8<O3L0
URLEncode = str_final 'EZ8*V3^A3>S4U6@RTL?I5O<F84*1P59MF(ET*+,4WM5Z
End Function ')DZ7VWK[IQT86TOA:+P?NC/<E,7;K)^\[-0D4@N?4CILU1BIG;^4B
Function UTC_time() As String 'L=MB@05H,KP7N+)/:T0[B\2OU)X/7W)]3XM+
Dim current_time As Date, Year_1 As Variant, month_1 As Variant, day_1 As Variant, hour_1 As Variant, minute_1 As Variant, second_1 As Variant
current_time = DateAdd("n", offset_GMT, Now()) 'G\)CP)=[.+^8O<Y46/P
Year_1 = Year(current_time) '39O3W[9;T52E0NK,+I1U):<:B?/4F2-V7?>2TB
If Len(Month(current_time)) = 1 Then ')T(@Z:*RZHOJ]S4^BWI8;)(ODI3BB
month_1 = "0" & Month(current_time) 'M)<?:-<)\1A(HQDP^/Y4XOS(A;U262
Else 'Q:6>8)9*9DCM^]YA^7<-1I)FR-\YL[/@\IO/U><5G3+1(A]N[BP5,[VI-M=V\
month_1 = Month(current_time) '0(>6L]8?US,H,(M5+D)Y4S3HJ?^=*[?>7OYU
End If 'W7E;HDR+=H>UE2PLMY:)=MHSTHJIQOAD^@=PKSHO/2+F*?QC?W[T<VURM@G
If Len(Day(current_time)) = 1 Then '>,*G;W]3E@2[@FE*Z)KBG=[S?S^]]01
day_1 = "0" & Day(current_time) '6)>40G>F7+G?(55[]\E4^IJ[++H7LG5*B*
Else '5^BEMAU:*;?Z7Z8X^9TJ2IA3,4Z28=7W3)FRHU@8FI?OIUX9/@O\\(/K8]GIV
day_1 = Day(current_time) 'U)E9^^>IE=9SF*K5/H5]L.MS(\UQ9PCWVTG+.M5>
End If '*3;UZL/A;E.\X/(@13-=[EN3YIS36P+M05+:H+JY==K*KU]B6CL=OP>,4O2
If Len(Hour(current_time)) = 1 Then '-5O,?\SE5/J108O8L2\1O=II74U0=X
hour_1 = "0" & Hour(current_time) 'XT:7H-DWKQ4WDPP4]).IF<344-,R=8AS
Else ']X27=I8<287GA2M6T+F@-X7(ASP:I7P.6NH>^Y,)33C,@J.RU8VFY4*;F1M7?
hour_1 = Hour(current_time) 'PEA;FE<3H(D;JIPXT+N7[[CZ3R8S)=B<2BSZ5=
End If 'P1ML:W;E.@[^?S=>1X:4)HN[LLQ.<,4XW@RC>VP8,U+T=LB-.W^E;]ECUF^
If Len(Minute(current_time)) = 1 Then 'J(TF,FH,^HI*@E+)LIZE5SQ*T.,@
minute_1 = "0" & Minute(current_time) '9/.TZCO56R6K,CPD[X,4N)EABB(S
Else '^9E]4[YB3MSJC[W-74=JQ^U:RNIER0.JW,^85]G*T/PR-*ZV>Y820A=WG/RLF
minute_1 = Minute(current_time) '6YY@I:@BOMIE/X\\M^GFQ@@@RD,1^(?[D1
End If '@>MPP2HE]WPW[9E6H+B-=[170ZQ;W8:M\-[(PNF4/L@<F(OY4B13C5<=MP)
If Len(Second(current_time)) = 1 Then 'RUBD^Q2/32X9-?P>7Z>/(1AQ1ZT3
second_1 = "0" & Second(current_time) 'SF/1A;HF<Q6-5XZ=VQB>ZAPL<I*W
Else '=8AA<E7HDTL/,VNY?.666(C]2:;2A\C[[SEC>^8@/=FEF6V293M[E<Y;;[8+M
second_1 = Second(current_time) 'M>C+U9ZJY+2HZE?2C]NP\G:XK4;+NN:-TY
End If ',GT[97KP.BEXGMDAA;P>,AU.65K:S52<ZCW<2.V)G,XCQ/1@M3IEBR2*@RS
UTC_time = Year_1 & "-" & month_1 & "-" & day_1 & "T" & hour_1 & ":" & minute_1 & ":" & second_1 & "Z"
End Function 'QO^8]<:L[J?(8B11ZECYVMK+STK-P^/OYR9WPP5XA:;+J^45(=HRT
Function offset_GMT() As Long 'F/(-LPNZY1.J)7LPWGF*7I[M3E051^28R+B*
Dim WshShell As Object, minutes_Offset As Long 'K(:).V?8ZX1JDGZ73V9
Set WshShell = CreateObject("WScript.Shell") 'T@=N;SJ7R-2BV1=U4)+>\
minutes_Offset = WshShell.RegRead("HKLM\System\CurrentControlSet\Control\TimeZoneInformation\ActiveTimeBias")
Set WshShell = Nothing 'X\H)Z(23L1RA1*0H.B62RASE<*.MQIH]+A[D\C\3T9D
offset_GMT = minutes_Offset '1V3@B*?C>9WVOFRA*:F)Z5D=<C^9HZMIW^25P6
End Function '8.+4.(EHUKGW28MCL/P(?0^JL>G+)B+J@1?D.>.>SEB98M?J4D5@,
Function hmacsha256_base64(entry_string As String, secret As String) As String '
Dim UTF8_obj As Object, HMACSHA256Crypto_obj As Object, byte_arr() As Byte, objXML As Object, objNode As Object, EncodeBase64 As String
Set UTF8_obj = CreateObject("System.Text.UTF8Encoding") '/8<-)/DZ(+
Set HMACSHA256Crypto_obj = CreateObject("System.Security.Cryptography.HMACSHA256") '
HMACSHA256Crypto_obj.key = UTF8_obj.GetBytes_4(secret) 'E)9(@+*HNHW
byte_arr = UTF8_obj.GetBytes_4(entry_string) '^+*/K]\SX(X/M5@X:\HTN
byte_arr = HMACSHA256Crypto_obj.ComputeHash_2((byte_arr)) '-:[V)XG?
Set objXML = CreateObject("MSXML2.DOMDocument") '73<8KWCZ+02:FK.JSU
Set objNode = objXML.createElement("b64") '[ZVH1P(D@ZL(O.6X9[7R00KZ
objNode.DataType = "bin.base64" 'IH)5)EZLHE\NA8YBF+SAP60O4:C63T+VPH
objNode.nodeTypedValue = byte_arr ':885?)7*.*751*[C+Q^/+<E?JFE)/:JO
EncodeBase64 = objNode.Text '*/*Z]?/)Q)SZO@S;>LE-8R*8V(]]PW,Z>JURR*
Set objNode = Nothing 'YC7:CSA[F:[@?LBKOA4/9LU*MCTU8*79AZO*<23W6KRR
Set objXML = Nothing 'UPXR<.UUK4+OF+/]D3YB^,FS9D7VRAQU\^555LQ?TZB-D
hmacsha256_base64 = EncodeBase64 '?.DK.7D96L4XW6@>([AH\Y:YFN8,Y1LX0
End Function 'JH/M4\UE.2JV7N>TMV/<)X/8L)S;TZ4W*5DBYHZ6]ICQ[A\P29MU@
Sub column_Headings(the_type As String, data_range As String, with_headers As Boolean) '
Dim the_col As Long '5HL0UQQ:)-2V:YQI\B]9(60</)DC?AK2<T4O6+^2Q*Y*M,
Dim i As Long 'P.ZGKR,XD]4DLL+MC>=4I2X>1<)2?^6EH6B*V;PXS?1ZWU5-:L2,
Dim rng1 As String ';00/N07F2CX*,/B/A1\14KEFYAY<)EC4K::7+DOJWZAU0N:
On Error GoTo err_skip 'PMWNQWX2ZMUBY<^E<98;X0[4.0069X70^+30[RU<8RX
array1() = Split(rgListBox_Right, ",") 'Y<\^B<)NPN,S+280(;,6I-B@,V)
If with_headers = True Then 'EQ+BHSH/-.<X[J[-R]OH^?0/-1*:-M7L:AIVD(
Range(data_range).Rows(1).Copy Destination:=Workbooks(thisWB.Name).Worksheets(destWS.Name).Range("A1")
Else '19:TZAY90Q6R=C*L5E730CIR*;QDD-360W3L*.XGN2SO*,DDU?Q9.Q>N3+,1I
End If '+(7=NEKGC;Z)O2,P22+)R8:I1)QXZ7SIJPTII0V[B.=39*F,U:B3[T^5B@>
the_col = Range(data_range).Columns.Count + 1 'PRB]+RPWW<6AJFCLJ/7\
For i = 0 To UBound(array1) '8@BK2L8ZCKZLM*/,CL9JWT>^)T58[V(EY/(9@+
If Not array1(i) = Empty And array1(i) <> "Search Id" Then '^K2(:C5
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(1, the_col) = array1(i) '
the_col = the_col + 1 'U1UQA7R:L.+0<O8N2/OH;>Y=1>NVG4A1ZHEQ*NU+N6[P
End If 'S4Y2S7X-RDV;R?M<@G)7.E=J)2F.W*3PB*W*]B\S[35QZ,BO4M6[)35J?R=
Next i ';^M2M/.J?[ZV.,.H,WW5LK4@K=6NZK@EEL-NTP<MV[0B2YFKT)?B7Y/J7WO
Exit Sub 'B@-Q=68AH+*+JL2]+,)>-41KMUIMNP6\G6?C^[T9ZBJST[^O63E3KO:01
err_skip: 'V4K[[[Z.C/XYAN0>0/G6LPE5:,MEDMR[G\SB2B?9U;GMF(<8(+4ZNF93
Debug.Print Err & ": " & Error(Err) '66:LZN+BNX7WQ<*/:E+X/=,6YKUR@*
End Sub 'P9KFG^6.+;+7(>:>1H.9W=5J/:?7X4I?BDNBC-=BN26H;G9^N+B\R0D0<^
Sub load_Column_Headings() '//T57(JR^5[^1HI,PA@D^<]@\EFF-UR,;TV)45I
End Sub 'B.95^LLEE+EYEYP?Y7CK,H8>B?R0^(\/SGJ3A22I8R@1Z9YL(B4BE8XA[2
Function output_col(col_name As Variant, user_col_count As Long) As String '
Dim the_col As Long '@D6IB*,1(*B)F;(;0-:W1GL[0=1O,Y\TXQ*W]WQR<E7SVV
Dim i As Long 'TK]SL,\<NX\94BU]PQ]V9LH8>1TIS<@4MXO55A=79\);;;L6F6E^
For i = 0 To UBound(array1) 'WB0>+9DX.[CKXHZIUQYED:3IK9FZV>=B7+T6)U
If Not array1(i) = Empty Then 'INS@WVZE=1@RBLXY*?E9[K@3IUG(V=7^Z<]0
If col_name = array1(i) Then '=81EASU>FK.3;XU/G?[WF5;14L]\4YY@3\(GI
output_col = i + user_col_count + 1 'U5975?OF7-I:S4B6OG9;T>H:ME86)<
Exit For '.-,5I@YC+NB,K6-B[25CG:XM,[TV\>?/[7N(JC7O<^+Z38WH9R60FM^U4
Else '3[Y3HK;;ZLE9O@Y:H6BVH]@XX0XUJAO<,,-M*OUWCD2O@EYG,2?K24C9TJS*)
If col_name = const_err Then ':S]0^:^:-:34(*[RCD*.KQIZ-,LRFU=-=/8,K
output_col = user_col_count + 1 '8Z4SV[C3,XZDQ?\I0<V+KFF8,4(YM@B90]
Exit For ')T0R(.M)XXD>77[K<R9.:]M;ZM@N;5<7E,^7:I[692S\GI12[DW05:?N.
Else 'CVDW8CHPR,,R<G.D\LIZ6>D*L-^.)>/T]RKM:*+(U<^T(;N*E>\2D@/^8OD@?
output_col = 9999 '4J:X\F<D(R^/\PWE\?-4(^71XKZRURX2^:8TOEK+<O*;1>W@
End If '.)J@-^1U4+[[(M:*YI)V/0U=[T+6R-+,1FX0C2>B-^EXPNPF3(RN6UTAKUF
End If 'P]=L@PM81Q0ES9BJ@O@H6>/B-L;,K3@UO;-VZ1LA=)ERZ=ZE5TM:M2N^Y:2
End If 'M\*93.JGTFVF1RC]]92,<7)JT\@;\S>@,GQ<B^Y+81L-DS>?2/B*)NT4.QW
Next i 'M[N4SE3],>NDHLQ]JP8=A-W[7D6)==<XK=184=/MCHS67VEN4?OPLR\8<RR
End Function 'SNLY0.^<PNF^,:[1QU,/[7](-VC-*IKE3WW-/FM45[J?XG:SFB^WA
Function FindLastCell() As String 'PL7D*>;F<9/YCM+6-)XF7G3[;\A0W0*1
Dim LastColumn As Integer 'ZS<1GO30E<Z6ODCIH?FB.O?Y)LI@@K<9BQNP<U:?
Dim LastRow As Long 'V-S0O3HKN(.A=W1NQT>[=3J>TC2F1>XG+-XCP[*;B0=G2)
Dim LastCell As Range 'FIIW5V:OXFD?0TSQ-F01D=F>KOM+)^WEH>C=2H>H+RN<
If WorksheetFunction.CountA(Cells) > 0 Then 'T92GW=GU2D/IODP=Z@>+ZL
LastRow = Cells.Find(What:="*", After:=[a1], SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
LastColumn = Cells.Find(What:="*", After:=[a1], SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column
FindLastCell = Cells(LastRow, LastColumn).address '<B0<C;^L?A3I[*=H
End If '[/L-=Q.-M5UM^9M,3PCG*J]^E1KCQ?6IQI=@R963M6P*K1Q]2XW17R)EV9Q
End Function '*1(/2:])B[\XM6@<K;F.7^79WXRDG0*N2]WN0GWIV=\T*J]YRVC+3
Sub CopyValues(rngSource As Range, rngTarget As Range) '(R24XFTI3<4
rngTarget.Resize(rngSource.Rows.Count, rngSource.Columns.Count).NumberFormat = rngSource.NumberFormat
rngTarget.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value '
End Sub 'B5=EEMF]P\E(-M^W*GA99-^E?K-9/K\;;2Z]4O0]<.JRG[7VCWC9YHWVSR
Public Function IsProcessRunning(strProcessName As String) As Boolean '
Dim objList As Object '5J@/YBUBGDPVESOT)=\5FI/<A2M2VP4/CJ9Y:Y:L]HN<
Set objList = GetObject("winmgmts:").ExecQuery("select * from win32_process where name='" & strProcessName & "'")
If objList.Count > 0 Then IsProcessRunning = True 'D8\^1-EHCZ[,5<XD
End Function '=3V7UZ]?,8D[D=5\\T.88WZ.?]<U=+;:PG>E1@H[@@;LEQZI\WQ^B
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "License"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Dim last_checked As Date ':HMRG<009T(>=;=<;+S[N6OV/KK]1D7I\8X278-.+
Sub DoActivate_Click(f As UserForm) 'O[=+H9?I4[5=D>,=+3DUXLL,9)U*7X
Const jscript1 = "89q5uqklj.5452452t5~~#]qtq4" 'VT+JZ8R452PIAI@ZA)4
Dim hardwareKey As String '[F56[\31[V)ERYD9R,FI(;1TH;0+<HW^VP-I30DG
Dim license_key As String '8:V-^EH*U6)6UB\ZYE5ZC/HRCME?;ZND@M<UU)3[
Dim azAuth As String '@>[B/;;SX:W+U:ME]I]BYP1>PII3<[5NWSW>1I9I04/DL
Dim objHTTP As Object '3@)V=O\-T.*1R*353[.(N?[VIR*=E=0:,WK;Q(/?/68;
Dim URL As String '1B3B(=BX<Q2F/91VWNLUSBXM(OV/[>B2)G\5O327HVQ>Y+[J
Dim xml_to_return As String 'Y:/6CA4X4LLNK-FPMS;YN?KUX8((QL76(2)5JR
f.txtAddinLicenseKey.Enabled = True '<1ZPS(;RTVE=O(G,KE<V/+*3/)?B6^
If IsNull(f.txtAddinLicenseKey.Value) Or f.txtAddinLicenseKey.Value = "" Then '
MsgBox "Please enter your License Key", vbOKOnly '>-Y(G[JBD85PJD-WD
Exit Sub 'G6)0MR6=;YGFTYV79LVFW/=7YPTRB-JPE3F=EGLU4OUNP+B+[SCF^6BR2
End If 'T7X6,<1*^,)UXY62W08[4=R5<.@ZJS8^N\^H*OB\ODVV<\F]D-N)(XTIXUH
hardwareKey = Trim(f.txtAddinLicenseKey.Value) & CPU(6) & DRIVEINFO(Environ$("homedrive"), 6) '
azAuth = "SellerId:" & rgSellerId1 & "AuthToken:" & rgAuthToken1 & "HardwareKey:" '
hardwareKey = URLEncode(hmacsha256_base64(hardwareKey, jscript1)) '
license_key = Trim(f.txtAddinLicenseKey.Value) 'S>:J16];?<5*,BY7[D9
Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP") 'DCIX5O)H;Z2.^L1
URL = buildLicenseUrl("S2a8G5j68kKkMjNundtvCZNADxzMJL", "activate", license_key, azAuth, hardwareKey)
objHTTP.Open "POST", URL, False '9T*=D999UCP=S4^K2NN78PV@;.9?=:\Y2H
objHTTP.setRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" '
objHTTP.send ("") ':(KW3YK1VQ/RY*^5KMTV*39<@2+:5(50ZQXV:@4P2D:LVA*4
If objHTTP.Status = 200 Then '^I[:-=HP4=M9,6Y@J)N(8.;DLK.A6WP)H)*\E
xml_to_return = objHTTP.responseText 'K3*GVO:=@V?*^*M^:OPWYPRL]8*5;
If InStr(1, xml_to_return, """message"":""License key activated""}") Or InStr(1, xml_to_return, """message"":""License key already in use on") Then
On Error Resume Next 'VF]E)[6FD(J*M+38*N4EJ7R98AX:E0W@:LYZ@*W\TR=@7
rgLicenseKey = license_key '/1EP4L*C6T-)VWVBQEUNT@-.)HA])4YQI]AZO+4
rgHardKey = hardwareKey '5?]37<.,]IR9(GY(W=D6,)^^QRP^7\.6?XFJF)YF.B
DoEvents '0><2U*PJ:>6E=1>W5<P9U-E8^DV)10IY1>336;*\ALI)2\JH(7CMSX*3^
MsgBox "License Key activation successful." '>PP3^)+)I:Y=*HH34>:H;A
f.btnDeactivate.Enabled = True 'KSH1;,F\8R12BX419/8MWH-1*<\3@XF3.(*
f.btnActivate.Enabled = False 'GSX(?*\K/5KXZQUF@I,BN^Q7,P/LU1]SL6;.
f.txtAddinLicenseKey.Enabled = False 'BN-0ZQ-\<,:YV^Z?H\BF0UJ0?+ZA5
ElseIf InStr(1, xml_to_return, """message"":""Reached maximum allowable domains""") Then '
rgLicenseKey = "" 'G\P(^K+*/PEO*;Q-/L9/,\A])(V>.SLP-8\K;R/J*\Z=JY;K
rgHardKey = "" 'EC[=GH:@].]2*-G(,U+J/3I027W6I.?ILVNHF)X4@10@ZL9AGN@
MsgBox "The license key you entered is already registered. To use this License Key with this computer please de-register the License Key on the registered computer." & vbNewLine & "If you can not de-register on the original system, please contact the support team for assistance."
ElseIf InStr(1, xml_to_return, """message"":""Invalid license key""") Then '
rgLicenseKey = "" '-VVU[E>A.\F+CEUDOD61\9CU3,XYHD/T([)V*N?\-JE*S(A>
rgHardKey = "" 'Y:+S-,^KPQDRGYCVJ0J*>[1(+FS[,=Z]*A)XR1DYH9CZ\</S5(^
MsgBox "The license key you entered is incorrect, please enter the correct License Key." '
ElseIf InStr(1, xml_to_return, """message"":""Verification API secret key is invalid""") Then '
rgLicenseKey = "" 'S,L>WY7GJ/6X1:B+@?N/;D4>-T^EQ[G])DUGAT@BLT)7XB2?
rgHardKey = "" '.DRZ0/)]Q9UWGLI5?8<4U67@O5C:DH@T==-^O)K;ZT=)>(Y;\]>
MsgBox "Incorrect validation request. Please report this to the support team." '
Else '4;.:<IDYH;7V1F)OGM)[D9]Q99Y<C(?7EN/))B;Z[4+;4S.+ONMX*N\B.Z.NK
rgLicenseKey = "" 'TUY9@;<^<\ORN-*P8+0MWG=^3Z?VZ1JE0P>1N*ZD8L,05DPX
rgHardKey = "" '?^3)EV<IYK;H6W02V8HX\I+HO[=Y/[]P5Z..S<S9VG>,YH*9.EQ
MsgBox "Unknown response from License server. Please report Error code 001 to the support team." '
End If '[U(5YRV(.)REW]J,(8@APXM*>YV-T5;4L/F44,+]:Y=UF5O*I0]H2\31S?0
Else ';X]OXZ2?)+>0Y>J)(-P=15O;R0(M>P0UA6L79731@U[(*Z3VR1>JOW,JO(@AW
MsgBox "Could not connect to the License Server, please try again. If this problem persists please contact support.", vbCritical
xml_to_return = objHTTP.responseText 'CM0N=P/H@IG5VK,,:;MCWPW1;T1UV
End If '?2[SB9]M\MP-T^=H472A.:-U\;P]L*?Y*KM30CS-/QMS54/^+N1V+:GX;=[
Set objHTTP = Nothing 'F/>PT+R:-4B\;<EDG,E=GABI),\DN3AH]4/CI=IATN.T
End Sub 'WFZ4,9N^OWZXJL,\YI7FXL?>JLW0I=(^AZAN417ROR=Y2.AM/LWFEH[*3E
Sub DoDeactivate_Click(f As UserForm) 'R4*JO1.-IYZW(S5/MHJX]9V;B8LR
Const jscript1 = "89q5uqklj.5452452t5~~#]qtq4" 'FP>M3(+@UBVP96]4I=Y
Dim hardwareKey As String 'N=J^S+].4OAG;*F7FQP,872Q>XS^QU6\^\KUL>(L
Dim license_key As String 'JPL](BZ*K=.V/8;F1/=-X2ZLVI,6*1*L8:)BPBCL
Dim azAuth As String 'X@OP(?\I[9@]DP+V0@9/8/\5-FKQ2O(7\J[SU(((]@>-1
Dim objHTTP As Object '>4GOLY>\((X;H0*<=?>\XCR6Y\5IQV@OMF),AVDQ7365
Dim URL As String 'OFK8G50=L00<-(?>LCH6?ES[J@VOSJ;64;80EWWEEL8,C,97
Dim xml_to_return As String 'JGH3U5-<=BRA0?BUTE7?4NNO(SAH/99W-?4N.)
If Trim(f.txtAddinLicenseKey.Value & vbNullString) = vbNullString Then '
MsgBox "The License Key must be present in order to Deactivate it on this machine." & vbNewLine & "Please enter your License Key and try again", vbOKOnly
f.txtAddinLicenseKey.Enabled = False '^ZCG0DST=864^3MQ43PO4T=B[YM9I
Exit Sub '8N[I9109A7DAHAB6<UFO.@<F^ZY>;4]:>V+A-^:Z54T.[;]23>EIV(=5I
End If 'BP(^Y-9*]8HV[ETROU>RC9FQMSB3R<:.XJ^/3S9XX6NM+=H;4DGBS3GM\P3
hardwareKey = rgHardKey '=)@HLY^SU97@BO0[*7,H*I9@]H550IWO\SO,7UZU3O
azAuth = "SellerId:" & rgSellerId1 & "AuthToken:" & rgAuthToken1 & "HardwareKey:" '
license_key = Trim(rgLicenseKey) '2?M37Q/TPR0KOD+UP,UD+0L)HN*0PYMPV
Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP") ')XLO^Q[?E9T7PO[
URL = buildLicenseUrl("S2a8G5j68kKkMjNundtvCZNADxzMJL", "deactivate", license_key, azAuth, hardwareKey)
objHTTP.Open "POST", URL, False 'V0BLUDLHV@.LEVQ@:3M\9/J55-M@ZE2PR^
objHTTP.setRequestHeader "User-Agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" '
objHTTP.send ("") ',116(1.(7*J4FKU[WO)?=>7WK.)7M>+HR=P+/-=].=-=@WHA
If objHTTP.Status = 200 Then '3J<Y\.+IO77Z,HFX1IX]YM.6;M<Z:0XV=I[PV
xml_to_return = objHTTP.responseText 'IIOCJN8?YZX<@?[E/,/VSL)=LN342
If InStr(1, xml_to_return, """message"":""The license key has been deactivated for this domain""}") Then
On Error Resume Next '/+<9?X^=FRX;Z]GO\T=>H.4]]Z5XF?1,;2IS?JMMJJ]-O
rgLicenseKey = "" 'U-U4QO/)=[;*JM^TJ(1[=F<1@31R\-C]ZR)[NNOQTXTT[YY;
rgHardKey = "" 'D.HNBUV)A/>,:O<>\6I1=(KN72L/M-ZIV06:J6^6OCYTE)LS+19
f.btnDeactivate.Enabled = False ')8PHJ22-ULX^EQ3>6QYDM?4RDDBHCFN6TU
f.btnActivate.Enabled = True '9.5[O[[K838:87-,Q.7Q<LT\L=*2;22>+<-G+
f.txtAddinLicenseKey.Enabled = True '@:@XQ9]2ADKF;/1(0FRZF4<GCZ](L0
f.txtAddinLicenseKey.Value = vbNullString '1:;^;1]*T4X<[T>+6]V:ZT,I
MsgBox "License Key Deactivation successful." 'ZTBNS[3BZB+M1>A2NV8>
ElseIf InStr(1, xml_to_return, """message"":""The license key on this domain is already inactive""") Then
rgLicenseKey = "" 'VWWZ-4PPEBD\=B^6C88;G?5TJ5(0YO(4P:)NY<K[-5V,P:X<
rgHardKey = "" '8A-71*)O;6;-AGO6@AT^EDY5BVOK\OD67@=K=GV+*2K)3HX.W69
f.btnDeactivate.Enabled = False '+B06O?P?Q*]M7R-LDT+V*/@PBTQ25=Q0IS
f.btnActivate.Enabled = True 'A7LQJOR>*I)1>VBBLQ*3F,47I=6M3E5I^KP^F
f.txtAddinLicenseKey.Enabled = True '//.@/N*-+GQ0DB@/WY^8(P]0::LY*L
f.txtAddinLicenseKey.Value = vbNullString 'B*0EHG3P45N^H^1N9DT=LDVB
MsgBox "The license key has been deactivated." 'K>=18=WGP9H.4N++GBE
ElseIf InStr(1, xml_to_return, """message"":""Verification API secret key is invalid""}") Then '
rgLicenseKey = "" 'EDL=E)XS;K+=9P2,8YDXR.15Z/\H./?^LG76L;U2:3[,;<(A
rgHardKey = "" '??@]EHO5VLPIKUVN<RSSG)TQ[DW5PA03D=ZFWB>+M00MCZCZ.=>
f.btnDeactivate.Enabled = False 'V421/2/2R=8DC7Q)GGJ@H*ZNC>RHVHOA90
f.btnActivate.Enabled = True '@C*1OOED@@QWJGJQHX8,WKJG47WT+?H6\5^S@
f.txtAddinLicenseKey.Enabled = True '9-JY0/.V8[6**\O=6VL*\]]9V?@G>/
f.txtAddinLicenseKey.Value = vbNullString '>H?2OIO@R4SQKCD3H)1X[-Y-
MsgBox "Incorrect validation request. Please report this to the support team." '
End If '0S1QU;ZDX?:Q],[E1-2]?S+P.^UL)A]Q@AF>CGOTYO=NSH;7W1C@RE;2R(U
Else '(J:W]BL=,=E8.595OCL-PXDT(1E77AFR?AC8X1AD;Q[HROEIE6O^XZX:LCO:5
MsgBox "Could not connect to the License Server, please try again. If this problem persists please contact support.", vbCritical
xml_to_return = objHTTP.responseText 'GZEZ@E,3)L@7F-<]<<ORO795Q\.GT
End If '*D0@LS1-WX+4<[AP(TR2I7S-6<A=R+)0:*8QA+8(7-^QX1AE,.3P<TNR,D3
Set objHTTP = Nothing '[<3T8UB2M:4;6N/*9<R6?\EQ[PGRKH6-R4M8/>@6LQV]
End Sub '0+?,*QI+QZ>[DPYU)XK9I6@<@-4?3.:W\/YF)SHTFFED[^GEP9L7M/HO*>
Function validLicense(theLicKey As String, theHardKey As String) As Boolean '
Const jscript1 = "89q5uqklj.5452452t5~~#]qtq4" '^^+Q>^F2LSST/O/FMVO
Dim hardwareKey As String ',/Z[.DC62@A5XRN8R42BCC3,]?KB[;M0MZN..*<:
hardwareKey = Trim(theLicKey) & CPU(6) & DRIVEINFO(Environ$("homedrive"), 6) '
hardwareKey = URLEncode(hmacsha256_base64(hardwareKey, jscript1)) '
If hardwareKey = theHardKey Then ')>T\IYZ,.UW5W5,AQ+:ST/M;JALU4PQ*3
validLicense = True '(AT0HP.YCXA\@^B.G(?>;TR<UIZB*H>)PT/);7)I0CR>QZ
Else '\1+UQ,JGA4JHGN+]EOIS(S)T@4RMRP\0AC?RS61I9Y^<M(8RJZ?*7\TSFOS--
validLicense = False '+X,@LE+^WS^>8FO=-6E?O=CK\74D=,T/V+]C9.K6^DEEE
End If 'B9]OT3Y9)QYQQM(V=:KC[6:1^9\7\O,2LHK0+MSR63,AR3U;*VP954W:59L
End Function 'B*BLP,/PS?VDX-2L-MY9/\:M<C1]5V?ETMH4D>++=V[057ZO;P@J4
Function buildLicenseUrl(theSecret As String, theAction As String, theLicense As String, azAuth As String, theHardwareKey As String) As String
buildLicenseUrl = "https://www.sellertools.io/?secret_key=" & theSecret & "&slm_action=slm_" & theAction & "&license_key=" & theLicense & "&registered_domain=""" & azAuth & theHardwareKey & """"
End Function 'S703^+)8ZZOH-<FSTO@H0H7^GV:J<F/GLA=6D=8K:5*OB^H12[L;O
Public Function GetDriveSerialNumber(Optional ByVal DriveLetter As String) As Long '
Dim FSO As Object, Drv As Object 'X0O;.T\:?8B])7>WI)[16H(WL012KMFBP
Dim DriveSerial As String '(3WAJ2EVK[.[-MYOKL8P/N[^5+[T?PG60J+G7<HX
Set FSO = CreateObject("Scripting.FileSystemObject") '((-Q=80+:47/]
If DriveLetter <> "" Then '1ID<CN8(PO2QF:CKOO]D?U.[VSV4TJ<SX4;QIE6M
Set Drv = FSO.GetDrive(DriveLetter) 'XGVO(IZ=NR[\9*Y(EG.4HHMU+C7<M.
Else 'P6]?ZU34;7KI;-,*,*-G()2EKS+IC34.3HTB,:K^RVHX2L/CRU2[XE3MD,?Q:
Set Drv = FSO.GetDrive(FSO.GetDriveName()) 'WE+IE34PBIG9376;(<O210T
End If 'B<AU[CWG46V[;CE\55:RF9;4S(5SI3)O>D::.XYT;;4^M(CD3;Z5@O]X8+9
With Drv '>RARH0W0^HY58-9AL8+<IN@Q/86P2><63QBV+P.=3,[G*L20GDEP84(N:
If .IsReady Then ']WB.B@L-7/D*(<PSV[.M5P]MZ(HI\P4K;2(.QZ=B5UNLOJYB4
DriveSerial = Abs(.SerialNumber) 'V;@EG/?U4]QIX4J673ALIWODGQ(\E5G;1
Else    '"Drive Not Ready!" 'S+Y,<,KJI+[9,4X=?TJ\JUX>Q4O3Q/ATNB/R+W
DriveSerial = -1 'TRZP6OA>M>T8BY]2U^D6SR;EX-WMJJ4(KW]QQHSIEBL@X,1;.
End If '<;.?LI3SX5KOL?PRJ?AMZP0]5=E^YD*+426[4COG?X]^*MOC@(B2JT6K71F
End With 'YBNE4A\9A;U<DJYQ[)*HSJ)BW:6\3?\2NC>1-GGR4DZ@?MBU3Q4Y7\I/P
Set Drv = Nothing '6O[ZRS4V\KO@+VQI]*BN3,AT*;D6+CT>Q71IGMIG,;6P=5=1
Set FSO = Nothing '2VW9,;-FNNHMVWFP*HOB@OMS,>]*9[Y]F?,K//XPIP9*/(,5
GetDriveSerialNumber = DriveSerial 'C0N0?\Q[CK28R,;N-U6M/WW*Y:B64LO
End Function 'ONIV^XA=8?N8ZVVVF:?6,I8R@-6SZ9WBFBBGT@J5ITHEA82R]AY9C
Sub fff() ':=BX85(5MYS(<.ET+.M4B\-=Z08LTILLVO+H^QMM-G.(C>KB*-Y.5=GG
MsgBox CPU(6) 'W-:1M.-L.:+1MHSQTTFAX1VL>E2C?)8P8[9OGXAH52U[2E?BXVH)
MsgBox DRIVEINFO(Environ$("homedrive"), 6) 'I0+@)7]0O\[GS]=[VG@?MCM
MsgBox Environ$("computername") 'TG5BFHFNIES,>C\ODA>B(QG48KT[0AE?YN
MsgBox Environ$("username") 'S4ECTDU;?:L4YZ.E69WQ<YFI>72C?9+68@I*W7
MsgBox Environ$("processor_identifier") '?J>-9?SR\P:]6?R=ZZ,8\R\J?7
End Sub ',RG20]Q>?KID;=+7[5X^K[K=AC,]<-C7\.JQ4>GIY).)LY5LX^X:CIYZ.^
Function CPU(Optional InfoType As Long = 1) As String '?GR)I[6^GN2Y
On Error Resume Next '3J4:([D-^6V=A,V3Z5.@743:=YH6I;(SZ--W];0;MU6YU
Dim CPU_Unit As Object 'N=Y6B-ST>V7>PWC26T68]XVCV-\0-Y,@D^ZT.>2J)VK
Dim CPU_Units As Object 'B-BZ5):IJO]Q6VNBFSN;MG/WV/H>UML2ODYL^UX.K+
Set CPU_Units = GetObject("winmgmts:").ExecQuery("select * from win32_processor") '
Dim Counter As Long 'Z3I5O:XK,U]-Z^JVT1OW05A)F?]LB>\//MSUF,T?.JP6,I
Dim CPU_String As String ']G)6;K6B866,[9BE>M:C8Y2G;-T;>+VKHMP]TGO?@
If InfoType < 0 Or InfoType > 9 Then InfoType = 1 '9/C7]Q)U4G.0QS6J
For Each CPU_Unit In CPU_Units 'QV>[MM832<W*@B*)*:XR>LT?@WF9?21^-<3
CPU_String = WorksheetFunction.Trim(WorksheetFunction.Clean(CPU_Unit.getObjectText_)) '
Next 'NX@ZNNY,Y7P,K)U,*Y9B@.MN2])0F)PHWD4E,[*.>\5*8FYXIA^F,N=0-G:XC
Counter = InStr(1, CPU_String, "{") 'NA03S3/M8/22[]M^)GH>GM5TK\5JY3
If Counter > 0 And Counter < Len(CPU_String) Then CPU_String = Mid(CPU_String, Counter + 1) '
Counter = InStrRev(CPU_String, "}") 'E1E^N;72)Q,)/Z?SJ9YHT9C6L71P+^
If Counter > 1 Then CPU_String = Left(CPU_String, Counter - 1) '*;-
For Counter = 1 To 5 'OR8^Y2:7-H??K6OT[9(X1D)34@-M]YY-JDEWCN\*ZN=KC
If Right(CPU_String, 1) = ";" Then CPU_String = Left(CPU_String, Len(CPU_String) - 1) '
CPU_String = WorksheetFunction.Trim(CPU_String) '0FA<);0=X/Y]V?T1QA
Next ').Y)18L)@W+TA*5@7IJ4<7[HO5=</(:2)@W532]/,0P4\;V\S*>I)^Z8N-D+Y
Counter = 0 'LYC)XIFH7EI-^Y==>^99SM+XZ.DE3MUUX1Y0H8\V-:CE8-<PE03I,5
Select Case InfoType '>Z.3)SE1TJH@YXHB),@SML?Y9\-B,BCNA>IYG=,@6E1ZY
Case 0: Counter = 1 '.(8WJ]-J)SW,V0A79P.G+[EB*/M(T*C0Z<]NHJE2R<I35G
Case 1: Counter = InStr(1, UCase(CPU_String), UCase(";Name = ")) '+
Case 2: Counter = InStr(1, UCase(CPU_String), UCase(";L2CacheSize = ")) '
Case 3: Counter = InStr(1, UCase(CPU_String), UCase(";L3CacheSize = ")) '
Case 4: Counter = InStr(1, UCase(CPU_String), UCase(";Manufacturer = ")) '
Case 5: Counter = InStr(1, UCase(CPU_String), UCase(";NumberOfCores = ")) '
Case 6: Counter = InStr(1, UCase(CPU_String), UCase(";ProcessorId = ")) '
Case 7: Counter = InStr(1, UCase(CPU_String), UCase(";CurrentClockSpeed = ")) '
Case 8: Counter = InStr(1, UCase(CPU_String), UCase(";MaxClockSpeed = ")) '
Case 9: Counter = InStr(1, UCase(CPU_String), UCase(";DataWidth = ")) '
End Select 'L)V,^9<A/7D3N>W6?V^T8W1R/@DI/2;7\?KEYL(B82L45[R)JN-B2@Q
If InfoType > 0 Then 'U/NSD^G^RY*6(3760N:Y3[QD](F0/E82?QF+6+=A?MAJ,
If Counter > 0 Then CPU_String = Mid(Mid(CPU_String, Counter), InStr(1, Mid(CPU_String, Counter), " = ") + 2) Else CPU_String = vbNullString
End If '7A.\K\+07N2T<9TWSL;SGRPM,*YB)ENB*M[/;/K*O[R5JZ[MS8D)RI(I+TE
Counter = 0 '26N<B3ILZ?N;4@^L(<P1@>TI?O=OY7]8=:EPXO)EWR)8M9NQ.U)7/.
Counter = InStr(1, UCase(CPU_String), ";") '423M,,A?FQ=\:OXMX/KB?Y?
If Counter > 1 And InfoType > 0 Then CPU_String = Left(CPU_String, Counter - 1) '
CPU_String = Replace(CPU_String, Chr(34), vbNullString) 'UA+AB]8JP9
CPU_String = Replace(Replace(CPU_String, "TRUE", "True"), "FALSE", "False") '
CPU_String = Replace(Replace(CPU_String, "(c)", vbNullString), "(C)", vbNullString) '
CPU_String = Replace(Replace(CPU_String, "(r)", vbNullString), "(R)", vbNullString) '
CPU_String = Replace(Replace(Replace(CPU_String, "(tm)", vbNullString), "(Tm)", vbNullString), "(TM)", vbNullString)
If InfoType < 1 Then '+Q]Z+G=9.X5IV4(4?6N]0C\K-*>1)X5WL2(V-\OZD\0F0
CPU_String = Replace(CPU_String, "CpuStatus", "CPU Status") 'PN\L6Q
CPU_String = Replace(CPU_String, "CreationClassName", "Creation Class Name") '
CPU_String = Replace(CPU_String, "CurrentClockSpeed", "Current ClockSpeed") '
CPU_String = Replace(CPU_String, "CurrentVoltage", "Current Voltage") '
CPU_String = Replace(Replace(CPU_String, "L2CacheS", "L2 Cache S"), "L3CacheS", "L3 Cache S") '
CPU_String = Replace(CPU_String, "MaxClockSpeed", "Max ClockSpeed") '
CPU_String = Replace(CPU_String, "NumberOfCores", "Number of Cores") '
CPU_String = Replace(CPU_String, "NumberOfLogicalProcessors", "Number of Logical Processors") '
CPU_String = Replace(CPU_String, "PowerManagementSupported", "PowerManagement Supported") '
CPU_String = Replace(CPU_String, "ProcessorId", "ProcessorID") '/)-
End If '--;1N/\I+8((:>0?VT>C7P1Z1[31FH(I\C;NF:0DM@EDDJ/G)8O41[^29KJ
If InfoType = 4 Then CPU_String = Replace(Replace(Replace(CPU_String, "genuine", vbNullString), "Genuine", vbNullString), "GENUINE", vbNullString)
EF: 'AG?7K1AT9NE^ZKL]/T)DMR>NAQTQTCC4.K/=L18VL5/AJ.;A[E<VJ.V*E38PHX
CPU = WorksheetFunction.Trim(CPU_String) 'YTV-4;[W+VQW\MW]JT5OV(>4F
Set CPU_Unit = Nothing 'O).P9M][S;)V)0A;8(*@ZX?=]9JF?1J6DI>U5?1+4GM
Set CPU_Units = Nothing '3+R8F6X/OW[LA*DT>/KAI;Q,2K,S8U2K;(X0@21],2
End Function '?<JMFI:LHU\5M/BF=?EQ[IR]P(B=/.DCAD?N7,W0XC0Y-X7*6P\DD
Function DRIVEINFO(DriveLetter As String, Optional InfoType As Long = 0) As Variant '
On Error Resume Next '5>=]P<?44CGG,C0<9-ESBEKCM8EBZ0B8N>/:V@[FF?W:Q
Dim Drive As Object ',BD+1I/D1PLA+23;\Z\DF23ST?RKZ;A=C?^N+A)?MCDE([
Dim FSO As Object '>HU6/ZH]9VO,V[K+W1?F,JV*H?O[QR@R?=XU?2=S2-3VS8\X
Dim Removable As Variant '8I)Z;AS,TCQ1US.LSQXK72];>@M)2W6(BES(Y2=R-
Set FSO = CreateObject("Scripting.FileSystemObject") ':AY0[;>7MYK2@
Dim Factor As Long 'FVPZ59T<.4QT4]J/G,06=<0PMB1*\><P5KL1;6,4@@BAO-=
Factor = CLng(1024) * CLng(1024) * CLng(1024) 'R[S=FUO/][EECBZI[C*V
Dim Info(14) As Variant '<NVL93ADWEVI-@?4G>HKK>8P/^MC6G40P/Z6/ZT4KE
If InfoType < 0 Or InfoType > 14 Then InfoType = 0 '\O/MO+:E*N^476L
DRIVEINFO = False '1;7)AJ>2I??+8I<^HS(XTR=WI?G28IB;?C0EI,3/IYGSJ.<?
DriveLetter = UCase(Left(Replace(DriveLetter, " ", vbNullString), 1)) '
If Asc(DriveLetter) < Asc("A") Or Asc(DriveLetter) > Asc("Z") Then Exit Function '
For Each Drive In FSO.Drives 'ZJ/<8SXL^,*1P>VR0SX8(07TA^<^UD:V:\5M?
If UCase(Drive.DriveLetter) = UCase(DriveLetter) Then '1DN1KKW4.JY=
Info(0) = True '9FG8\SH7-?W0L<5JKH;3CAMJ.11CSIT.J5JM-EZMV9JBTM16AX6
Info(1) = Drive.DriveType 'T4K:H6J9*)6X4.8*0:\BV=H@M^LU\,[LO9\LUYN1
Info(2) = Drive.FileSystem 'M8PLM)NPX:4[04P/JU.O^K0<^(113S[Z)7RP^D[
Info(3) = Drive.VolumeName '=EK-.X=ZUAHI*/V5/+M*+M[9;Q7W3V,=/\B7?;N
Info(4) = Drive.ShareName 'I**D=W?5YKB.?P7N\K<62CA9/GN=Q:T,YBS4I:LB
Info(5) = Drive.RootFolder '@Y>(P.NF1[52IPKP^VT^0R(R)U,*]])?AUNW\-X
Info(6) = Drive.SerialNumber '42Z746Q^RZ4ATE6VHTZK(8GK<;1T;9UF2SL;,
Info(7) = Drive.TotalSize ']\.P6AT:Q<,R\I5ZQMS2CYYS1N:5S7D-1FV+U330
Info(8) = Drive.FreeSpace '8<3(91?N=S:UQRAG<FAR934LE7.UO]LGFB9<3LEJ
Info(9) = Drive.TotalSize - Drive.FreeSpace 'W6>W*:L\@8ARDMOZG:DA?K
Info(12) = Drive.IsReady ';-N,=9<>L)*9@;,4S;6@*]AZUCN*,)A)H;/5C,S(8
Exit For ']WJA5(KADM9C;FR/K7.WFJ+6RYSNYF^Y3-1.F678K8EM=P@AM24X;G7D9
End If '1*?)\/3TA<@C>P));GPE0=TXG^N90R+A>7(A0,MA4T^=7CGQ^32]?R,TN[W
Next 'C;D1EDC/3\,\1)6I+.X4]8W\.1@UW*S1V7U*A^9(GY00AA]=)9]X5W)ZV2ZV8
If Info(1) = Removable And DriveLetter = "A" Or DriveLetter = "B" Then Info(1) = 6 '
If Info(1) = 4 And Info(7) / CLng(1024) > CLng(800) * CLng(1024) Then Info(1) = 7 '
If Info(1) = 7 And Info(7) / CLng(1024) > CLng(9) * CLng(1024) * CLng(1024) Then Info(1) = 8 '
Info(13) = Val(Info(1)) '9=:[Y1D[FGG>FE-SQ8^TY=4Q7W4S@V0I:7Q;K[5O:P
Select Case Val(Info(1)) 'HZ=8G[Q7NJOA/FCT=70LL6.7BZ\DL[?Q<YK-E(NYC
Case 0: Info(1) = "Non-Existent" 'D04H>/F]>Z/QP1[W1U:[<9]X0;VH=QE)U
Case 1: Info(1) = "Removable Drive" 'KN)@3:=XL]P7=6P[H>7H,SU-<L28)0
Case 2: Info(1) = "Fixed Drive" '5.(2PN5S78*U*K6JH@W)^OXV<@;KEDRS]Q
Case 3: Info(1) = "Network Drive" '?]1F0/(:3Y0S7DY]T-)6-ZP]Y.J^^I.Y
Case 4: Info(1) = "CD-ROM Drive" '?K)^4U\UZ5=U:*-K4CGZH2=]0BU)20T=A
Case 5: Info(1) = "RAM Disk" 'I^(=/R\^7M>>+DCCX[YJV=QJ;BX<]<58>NJ9\
Case 6: Info(1) = "Floppy Disk" 'J<BEY37ABIY=@M+-*\2*@7V?L\4=P,*H65
Case 7: Info(1) = "DVD Drive" ';DUY@?WTW)PB8GNVF^0J(AH08:]7979S;OFS
Case 8: Info(1) = "BlueRay Drive" '8N3ZS-I6D)VRCJDB9HN,@PZN)\H[T:E0
Case Else: Info(1) = "Unknown drive type" '@@\:3B3T;L)?BC)15=)<6TM[
End Select '0?JM=[RCFR?9]0N@,OFC5DI5C>.BUH53@BI2BQ*EVKEP@IJSB+UR/E<
If Info(13) = 3 Then Info(14) = Info(4) Else Info(14) = Info(3) '7E
Info(7) = Info(7) / Factor 'U>N3/]V>X(1@*[?UOPQ]/+1HTOD-).<@D>E,??D
Info(8) = Info(8) / Factor '[[C[0.RTM5BN2>+V4,);W,MSH[16BDSEHT?BD\:
Info(9) = Info(9) / Factor '7=V/D^:^47BON2)ACV4T+P*)C:OWOS9:L^T[)R1
If Info(7) = 0 Then Info(10) = 0 Else Info(10) = (Info(8) / Info(7)) * 100 '
Info(11) = 100 - Info(10) '5)((;O-?/:ASW[I[*Q5[E--^T6SDJX+JR:5L2KY3
EF: 'J-,9SQZRX>BTWAKJO6<1.,(3@0ZB[,5:-G)@E3GTSKY*G)PX7FB[HAEPC+]]C4
DRIVEINFO = Info(InfoType) 'V)I1=4QM9;TB8D2WS?N*@-]IT*86.GKOC9W\=.6
End Function 'A5Z7T8UN@()8430*S2;:JXW126YS;[M<1+P*TDH1N4@W,X;RJPG)?
Function goodLicKey() As Boolean 'J\-=X]W\PW(34.C6I<M5DA;N)G5B;OLYB
Dim checkTheKey As Boolean 'V@RX^:?45TBU<[WSFA8IWCF[[?IE]\;K[G:=Z4W
On Error GoTo ErrHandler: '@H.(D@F)[,1S+O>T[IG+/3;8.GM@FZVA-LS=8>NB
Call GetAllRegSettings '9BG2JI60WU+F?\>ORQPROV,4-MSHO^H:@7P/FLL7A^M
If Trim(rgLicenseKey & vbNullString) <> vbNullString Or Trim(rgHardKey & vbNullString) <> vbNullString Then
If (Now() - last_checked) * 24 > 1 Then '35U4,*>JD^/1+]F/PG2+MU<,:+
checkTheKey = True '1<G(<-J?BY/9V\QAL,^1DQC9@3KC-T?N2O>[4Q18>GU7Y)W
Else 'D<F^.0Q*8V7WRU9+EN</X4@.GFB7DIZ<<YJSO;+61JJK^B:^VDLXR0Q(DQO)]
checkTheKey = False ')LUU5YMYB156@8Y<.GH[M:0+/RRQQ*PI,JGQ*S/+:F7I)L
End If 'QFXFUKX,]4>\8MY1S^\6]7TU0D*?IJES6LK/B<KY.]DCY/UH]5Y=M\=;SZW
If checkTheKey Then '*S)7=8)[I?HN7N2V4YF))PM.IM.451KYS(]P.Y\*RBS[^;
If validLicense(rgLicenseKey, rgHardKey) = False Then '3F./OYOP]8<?
MsgBox "A valid License Key could not be found. Please activate your license first.", vbExclamation '
rgLicenseKey = "" '6ZAO)V8FMF8@H<E^D7-O;U>016U*6XAXQP6L0B8ZBE?^6@(B
rgHardKey = "" '71^U8-CEOBL:H6?+RZ0*HBFSR[G(DLNSZBC)JB;-NFB[RV4,AKD
goodLicKey = False '-7P4=@=-?I<*5@3O\?*)UK6.GND=\-U(JQ1@2J*@DZE-<3A
Else '=N,P4ES7YX]6G3**DYP^XD.AX@V)2MOVK[??\]GH,/XI>2SQEB4X,.DDZOQ\>
last_checked = Now() '^Q/BF]+1?RG1+4CWZ/?4G4:3RA<0(O[K0M+@@^[ULGO)H
goodLicKey = True '7PJL5:P\N4@T<K6C-6+3XFL;\(G/;V14GY(WDT:*O7^,QW@>
End If '-,V/@1EG(2FAHXFF<J.G@<;R9FJKXIHUD<=8F*8[S4=+B2GD@GVSB*XF\GL
Else 'VW8*;IAF(<4442JW6KX@HGI*NX+N[SOSS0/@:*^@ZT@.-*NJW,WF,I\I5D8I;
goodLicKey = True 'S;W0G:,3BM0]I=0\ZU^7O>A9:CIW+D46<:R^=Y<?G34UK9/L
End If '>OXQ*I.H)=L?9<DTI?R*8AG0IXB-\DY5IHW(F0,XOJ/G4G.C1V5B>Y^LQ<9
Else '6M1[KB3L,=)\<=IDS\P^.,?+ROV+<A:N9:U,T*8)+8PBP@,<I>JHHTJ5Y:*3A
rgLicenseKey = "" ';43WNLIP0<C3D3<K37^J1+[,,TFYT2YN100RR./>:93=)B7S
rgHardKey = "" 'JABB0=?OD7);ER.C/-\Y<57]?LEV,+@];BOQ<I/CC;NJSN80ES;
MsgBox "A valid License Key could not be found. Please activate your license first.", vbExclamation '
goodLicKey = False '=ZFUJWYB[=2:=-,P.>^VLB[UFDU60:ZQM^@VH\L.06^L5,A
End If '8:)PO-W[.->ZHNW,OL3HX>F/S=T*3VFL^Q3V=):VA[?9\WMR530*KK20YD+
Exit Function '*K2JIB>2D/?<?9AKP7/1POK?V)0(+N>PT-JZV=O)MNF?]JND9X6+
ErrHandler: 'JL]BA49E:W\94K?OWELB6?R\QF\(][X7<:-HT6YK?98)TS6;>?6S.J
MsgBox Err & ": " & Error(Err) 'F].=L)//<@F+/KOIVSMOK6WH(BHF*X,0.3P
Resume Next '>\5+00L*VE9X.HSM6N+964.L(YN3JEEP9WB<7M4VW2.(*S1J0S?;TL
End Function 'W6XQ=>>AKR:ZLK(7XAA9O>DRP=P\V4[FV0ON.BC8QFEIP]</C)?GL
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "ProgressBar"
Attribute VB_Base = "0{27F133C7-C5AA-4012-99D1-E9915D838D6B}{A1F8528C-0381-4399-AE90-983B1DEF827E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Private Sub btnStart_Click() 'X/].=9@V[O7:I=@D7*X<D1,4XEY97OLBM(A50
Dim howMany As Integer 'W[X:]4B<L-6/9C/>[DP]E0T)S@-[ZP90W;>@J9(;[D:
Dim data_rng As String, id_type_col As String, buy_price_col As String '
Dim address As String 'AO^U=N/=\=/?YL/0S\N<J5O*T>875U0JO2)=EGB?BSZ,
On Error Resume Next 'S-K,2EOX^PDD3).K=)MC=EX[6M>JC8XKBET12T)F.[3IC
lblWarning.Visible = True 'T<74.5JE=*G\I4T5(<H=9IM]329-)AH7N[(V\N96
btnStart.Enabled = False 'C[]*QH3-DOO-6G//?<-A4++KJ6F7L??T[;IC;Y\X0
If CheckBox1.Value = True Then ')J)K*)TQNAH:CM7?ZH3ZU]/</8G]U^?U/MT
howMany = 0 'N4*<1]N,=EF)40ES,@;EAMOBU:RAJVT[LG5^N1RV1]W<@W?/[5V>X;
howMany = Range(rangeRef1.Value).Rows.Count '^M:Q)C;DB,*9S?EF3):BEV
If rangeRef1.Value = "" Or Err = 1004 Or howMany < 2 Then ')DF78E1I
lblWarning.Visible = False '=V72U(G51MI1@Y08(I,EA,@9R@NUOB4@?T/A=*4
btnStart.Enabled = True 'OA@.J20FZOI:<8:]3S*?=Y(X.FQXKJYJ2[9D9?E*<H
MsgBox "You have stated your Data Range has Headers, therefore you must select a valid Data Range containing more than 1 row of data", vbCritical
Err.Clear '19Q]8*D3699*3:^*66<W8[-D(\W,-NP;W[U,X<05.SVH--ABCUK)YY*:
With rangeRef1 ';5?QW6(@QVSO8A@?=Q1S^-T+WI1JB0J24WZ;YL5:<8G(E843GER
.SetFocus 'SX1,MX=*3:6YE]QG>YDV*UFJ9=[?5W^/N]F,9,F3PIXO)I@LALB0;,1C
.SelStart = 0 '72L/QT*D4I-1-T8CJ[*,KT)LDFT<=0K8H[E48FHKK-G)NCR;/1+W
.SelLength = Len(.Text) 'PDZAR@:XTNPA]P9Z4@Z-]D.EUUTXR7U\?UYVLNY6=Z
End With 'G.K4]DZ6C2;\W/P<+;YK-Z@HU8OM/^.657J(C9CJ+C>S7*F;WP8SM.Z[G
Exit Sub 'X,3,B.T?3W,;=I3/V5EDRB0-(+NQAJ@AT@K5BG.ET9(IBU^<;^A=6F127
End If 'JP:<LRZS/?+9]Y\ZJX;XA=+<<SO*L3S*4+W3YX/A/>3JVZ*7HR:(\:YT2ZG
End If '1;I@8^SO/SX:[KL1-8C@.*,C]T5(K89<,LB:.1DWW3Q8:J5S235XZ=Z=)=6
address = Range(rangeRef1.Value).address 'S*K>@GVPUA96S61.2=)+.L4I5
rangeRef1.Value = Right(address, Len(address) - InStr(1, address, "]")) '
address = Range(rangeRef1.Value).Worksheet.Name & "!" & address '(Q
howMany = 0 'UW]KKOJ63+QH<<VM:*=G7HM(7]R>;+O,]H3II13KMK)TLJGWB<[62V
howMany = Range(rangeRef1.Value).Columns.Count 'PAJ^CMH@=B.=4-^R6P6
If rangeRef1.Value = "" Or Err = 1004 Then 'XN<2K5?(:XHIF@JOZD](2C[
lblWarning.Visible = False ';J3M2WA::>1:7*0)EC1Z-5)E+3T9J-GZ:M.S@=+
btnStart.Enabled = True '[K7\;@Z-)48)09]E?:JQD009D5USY+P4B\@/T,+HOM
MsgBox "You must select a valid Data Range", vbCritical '^^^A;K/[>7
Err.Clear '9F2MM1@[3,CD;0YNYABSE2O,XR<1M84C504+1XR>6;;(R/6LU1U90IH,
With rangeRef1 'S.N^Z[^1>E/0E6Y0Y8JP2M]@(M\V^;2L8>=6/42:O5-Y<DU>^CQ
.SetFocus '2O-Q;(0)9Z1[+JA(46AE6C\PV<I3D?MKCY/P\BVC6(.GSF>(IVB5UPD5
.SelStart = 0 'DT6I87M-YD,RE[*@*0FSN8\7@L7;6>RZPRH(*8XS*B^ONE+^KFO9
.SelLength = Len(.Text) '75KRXONAC-0H]?3FVGEBNCI[EK>,MM5)N>]8N*9TYI
End With 'Z(XRQ7)V<0<(B<<7)XO[7L);2MX1Z7\JOEC9\/)]B;8L28D.VCOA1FF+3
Exit Sub 'OCFZ45R,AHV[(Y=.6]UZLJKC)>W;4UU^)I4X74<N9UMQF5@M;:X>6H=;:
Else '][DK;Z;0+;MJNN/W63/F@5JJ[\2,51>,HE>*-ZK::)-\Z8ACD+VF(ZE,(<)7E
data_rng = Range(rangeRef1.Value).address(external:=True) '4M0OOGMR
End If '1LG6Z+Q]<-HWO<-C@>FMH4QE*-F^7RLF1KJ00A+AL+53LBV)M:Y8T9/?3)A
howMany = 0 'Y*WPI84FJZCJ]C0I>6[:8KR+J;Z01D7T0-31WP4NTD5OW;\2X8AX<:
howMany = Range(RefEdit1.Value).Columns.Count 'DFYP-]@]\.43OFXITLIE
If RefEdit1.Value = "" Or Err = 1004 Or howMany > 1 Then 'YRSM9^[-T
lblWarning.Visible = False 'I1:@T=FCVUT9WNP-^.;Y[CNJQ8P?U[E5/)FKSS>
btnStart.Enabled = True '8=S5T@(KR@NP38Z^(>8]TZ280;URR@X]>04UE+[IHY
MsgBox "You must select a single Product Identifier column", vbCritical '
Err.Clear '<FI>^G7BQA4(<61:/-FQ<*\,,2[2T\^0SOX7:G,LC@IV[@]T*>E/<OYA
With RefEdit1 ',-LTSS@6>8-)4UV(ULJ\5S<N;KBGB8I-;NQ]/7<7]S)YB=/5PZX4
.SetFocus 'K\)GGTN]9[IQNWV3/@PY5UJ:TTY\TB59YY-F(;E*7F4?.7JRL0J(>T6L
.SelStart = 0 'YN)F?NI<EQ=8+F3CRPY^YSV1J*R=1/Q(O=BI]VP9O22MO2?BY14)
.SelLength = Len(.Text) '(C-4G)1=6O\K[JM;90?<PS)64,1(MTVQD@YZ5W*CL9
End With '+B9FRQIDA/78,LRQ,R==)F<P@8?[W4@Q.F;H*MA]1UQ.WLQWL>;TU,,O2
Exit Sub '5Y\?+,P<K=V.8(H?+S/6@>>?2F(LEKGNEH2TNX2@\X67KBG7.W;90JMO)
Else '<B/L9A\3*KMDRIFRM08DI.EU]B6@)WP=6,FP/,]C(*A,=UGJ;E(W3B[/D7EK8
id_type_col = Range(RefEdit1.Value).address(external:=True) 'M>@I?C
End If 'EV9\5=\CGY0S..-@]@V9:N6UN)1J)1N:4W^K)E(MY8RC=/J+G;).W48O)-W
howMany = 0 'I-/485A851H@=1?H;D,YT0>=1ZT@BQ1ZE<475+[+;O?G43VU,]QS;S
If Not Range(rangeRef1.Value).Parent.Parent.Name = Range(RefEdit1.Value).Parent.Parent.Name Then '
lblWarning.Visible = False ',WG6[.H.U:G@:B56D8[(-=>M/A-5QUH7:28VSN@
btnStart.Enabled = True 'J=[6-)*,<1(7VZG<@Q<9W[N((.J*K6:P=RK;]Z[OF=
MsgBox "Your select ranges must all refer to the same workbook", vbCritical '
Err.Clear '[NN5PZH8I:9=RRE;82@?^I*;33TI-S?X/<ZZN+(@,6HCP]K]LD96.=2=
With RefEdit1 'MGE5\5;D72+,Q=OH+2<MXX1OFLMY/N>@FGO.*WU)V/3I3].YF@>-
.SetFocus '4P.JU+.*JVEUDMI)XUP7C3,[Q^9N/*U;W]ZR[1?045JH)K2UPGI5P-O/
.SelStart = 0 'UD[IA6Y7[E8N.^2ANU+([M*KDQJPV2?:>P4THK<]ES98<+?@M(.*
.SelLength = Len(.Text) ';]P@A@1(G+UPFY+YK3R1WIG(]N75BQI)(R/]SOCCL,
End With 'BSD)<ZXY+/O3^-V*/ZQ@M3>0T?4@YB<@[C3E.[1)Q[N1>VC;9-/C\6PT^
Exit Sub 'VYJ5G^SPD5(;]-)RJT1SDFZP4WS\=5;C9)H5]IA-4ORC50264LHD:)M][
End If 'ZL)R)(6H4NFRS\1,OXHH,8+1K[:-WIN-VY4C[]8O3H<[@D(+3*.Z:VBQ?,C
If Not Range(rangeRef1.Value).Parent.Name = Range(RefEdit1.Value).Parent.Name Then '
lblWarning.Visible = False '??.]QS7YZJZP@6LV4SN,W4LS7IW9CLQJRBK0WFJ
btnStart.Enabled = True 'XA02C3BVSPQI+GH</ECCE6K4+T^F:CF/Y/,L78R7I,
MsgBox "Your select ranges must all refer to the same worksheet", vbCritical '
Err.Clear 'JCRIVYGATH)WGOM^.JJB,NO?NE8N+6\;@8HD./Q77D6,4W\0VUV769=X
With RefEdit1 'J-X8D=;-P/1T7M7ALQI+?*1;V-<ZU@L91+4O]Y1H<YWQB)>JHOFR
.SetFocus ',EN);:ROVDA.:,YO,H<@O?X,D,(OUU^ARI(H33SLXJA2]LH5PZEH@U^Y
.SelStart = 0 'Y.F9E=BJK4M/^M,X09*L40G.TR+*/L\VI^\5B;5AQ^1;@3]Z(X[0
.SelLength = Len(.Text) ':.)@]E,HSB73H=U\@WCV7\RQOG;V/>UM(UL4D1;778
End With '0OWP,7>FAYF?/,A<BV*7)LIR8X\^.6I[TT:W\X[]4A2=HT5<I2]N1+ZB9
Exit Sub '<K:59J;K^2/+G09CJ0+1+QRR;WT^^9J80W+ZO5^.<I+Q3-T^7V)9J^6WC
End If ')T5<G:=[(TV0^94JYS>;0(()\D1T*)D:](ES?@\@X)J<B=B;0MS-.AOO;Q+
Dim isect As Variant 'MB20NI:8OD.R)CH4:U.:05BHD\2;]N^,M3TU^SR,+5DOX
Set isect = Application.Intersect(Range(rangeRef1.Value), Range(RefEdit1.Value)) '
If isect Is Nothing Then 'JA*0M2<Z@[2B[7.+5<)2NX.3^6?1R1:Z<-G;V@7,6
lblWarning.Visible = False '?A>[]W<U4I\T7L<-,F+0T*U?I)+?EIB]RFTK,\Z
btnStart.Enabled = True 'O84:K4H(ACV;7J]Q,A\C+4TY5MLT6R<.>7)O-\,L8K
MsgBox "The Product Identifier Column cell must be withing the Data Range selected", vbExclamation '
Err.Clear '6F9^7)H>OXP*LOE+OCHTW-]CF\S,(43<V]JASL/<Z^6YWWVS>L90>Q+)
With RefEdit1 'MZ/H*MB\*LX*4(?WL7)(GNG0,N=H9H^0UP[?]M.(\P37RN92G[]A
.SetFocus 'G3TC22LTUV7;6I)8(RC6:=.0H368S[6XBU)FQ:L:J6?PJY[2EILJHIG@
.SelStart = 0 'K>RK;L21N/@JY(H1I1BCNR6I=^^DF(MG97@OU/]3?>3AXG<5)\+^
.SelLength = Len(.Text) 'K2@>*C-XCO,@H9Y95W^)=V(@^R=+.L2CDH256M3NO.
End With 'LKZL0/PB[4<*3X9U6OZXS;OK7Q-^[]3HF.+AXD[U,4)0FM:EXLR2.EK=;
Exit Sub ';PNA9N>K+T:?6WFYM87Q:(E1O12\CQ)[3U;IB?H)4H5Y7E1+87[*L9I)(
End If '7PHBSG,6)A^+9U9\3O8::NEAS+=5I:L>CZ@NX,6K2.B0:X[TB=W*,VZT0TQ
rangeRef1.Enabled = False 'Q;)M3ZZLC?:QDZI^T0LP54IIK0O[YVC71=,5@<YG
RefEdit1.Enabled = False 'UGK=AW?<U^HBYV)?FLIXV^2HL*TOD+1EI76:3Q=E/
btnStop.Enabled = True '0ZO2K<TT9*0,^Z++2)O5;MJ6:U0*3WA-4CO.0);RRPT
Call main_Product_ID(IdType, data_rng, id_type_col, buy_price_col, CheckBox1.Value) '
rangeRef1.Enabled = True 'PSV-7;\HCRG9P]A9(L073(KH:O992:3N-L=S(IR8X
RefEdit1.Enabled = True 'W,;46+/]\CFL5QNX^F:)E4IIY+NS2Z+,?2L>;VF=QZ
lblWarning.Visible = False '2Z6<I;8FBQ/.LTG;LX7NC-MB?OYZ1J)574L5SCM
MsgBox "Processing complete", vbInformation '.)<=KHJ*H8*;3(?^;SWKM.
Application.Wait (Now + TimeValue("0:00:01")) '\1QB;5(D*-(0EO,A<,J4
Unload Me 'RR6E(;XVU(\N1;^O-WV82:@P<GKGX>;,HS]4A;[M=)O,0,YQL4I>G0.7
ErrHandler: 'VG.(LX-EW-4,LI-@]U<0BK,L.=0VLS.JH>1]:0?-D,?[OGZS9FY:I1
Debug.Print '?8CN/;0DGR]-\C?.-JE@4,YB]FNQHQ.LGU)O:-VM6ZN:^*R/WY]=R@
End Sub '\<4(H1Y)I2)@:=A/=+7GP7ZZ0YRGS@[T.J4R*Q?J7MU.,V].(ENO0I<;A0
Private Sub btnStop_Click() 'RYSEBNX.DI<2V8G\KO^\2Q4=M42KM+=4GPLR5+
stop_processing = True '05VT9FQS>>-<0YG09-1,J,KN)?:M*R<HGRWWR4D0;>D
End Sub 'N?/4BI7(WKW;LZ=25-4J:V1I0:-VLAZY3+TI8:GPPOCWZY2A<]T<M-C>C0
Private Sub CheckBox1_Change() 'VQC,<(C]2;>S>^UQ-7)+GX?JY1.2I(SMUO]
If CheckBox1.Value = False Then 'KJC123;)K/)XM;AAAG@(MOW<]Z4GIAAC:3
Label1.Caption = "Progress: 0 of " & Selection.Rows.Count 'CETCVT:.
Else '5;-+3E@F@])9S<T<NOV:W2L?67UO43VI)D,OC]5Q)RZVQV8-\F?7YD?YJW)>7
Label1.Caption = "Progress: 0 of " & Selection.Rows.Count - 1 'R:0H
End If '=SF*4WR7+[+317=BU+)U6MJXR:>E,VP5+OWWFEZCC?4P=)T1Y@-]NJ(]M^4
End Sub 'X?4L:(T6U^SP7+@=RJW]N*;M;()0J:ST-Y>=7QYY+O3EI^-04+5OQ,M5^/
Private Sub lblSellerTools_Click() '^5FPE-MJ<5CFLCO6L9\Q^8EQ[NLE;AM
ActiveWorkbook.FollowHyperlink address:="https://sellertools.io", NewWindow:=True '
End Sub '-5WQ+NQJ-XDJ@]3ZSJ>*?SY^HJK2\Z\(D@]:LW;BDK6:B;CP.2*//RM@U+
Private Sub rangeRef1_Change() 'DSES^14FD@.U\D[K-M)X*.0>*J7:EDRM;VQ
If CheckBox1.Value = False Then 'PBX>HZL\A]S)4*V;\[1C8Q<71X)?F=RLOG
Label1.Caption = "Progress: 0 of " & Selection.Rows.Count 'UN3[),74
Else ';@U+XWP+^=YJ=0^F4+7X\(2-K21P8UP)NZS+6E5Y6/V4:31],.,B0=1M8\PI]
Label1.Caption = "Progress: 0 of " & Selection.Rows.Count - 1 ';XT^
End If '79I4\2L:YRYZEWR,XGQ+F\C;;T@5QQEAUG51?QU/G?W4)6()4^]YBVX.6?M
End Sub '?2V748>:2<?M3>;^.=E>7UNN8@)A,//V*0G7NG?H;(2;1E\=?YON^).@0J
Private Sub UserForm_Activate() '=58+Z0@02YRSRYUSEH+=*97P5;@D78L(OG
lblWarning.Visible = False ':JQ3E^]ZL-:^3;6B0FV@:^R0)ODAP]U@8+?649Z
rangeRef1.Enabled = False 'T)AZC7]N9H/9HM6]O:I9TXN)[(.N;M?^0F:)(93)
RefEdit1.Enabled = True ']O@TQOCC2+WJB<FV43,?.SQ;X83@B-7)GE,H4O8WWN
RefEdit2.Enabled = False 'ABI[2=Y5(]7W,7\9GAQ.U^JC]*5CJ9Y;\ZH(YEF]P
btnStop.Enabled = False ';@QRUHYQR3WK*WRJ;?RN^1Z?I,)UC@+GXMIDE<J:TO
Application.Cursor = xlDefault 'LI<6/<WS][1^1.DIJ-U0W)4D5RRZ/V9*MVV
End Sub ']MH/;,X)P*^ZDHXW,\]=?=DB2:5URV->Y1;21M\11**LHBYPLHX-Y.V(,,
Private Sub UserForm_Initialize() '1*E49>8J7;8:3N0<G8:-Z\E3OD7^J7MW
rangeRef1.Text = Selection.address '](\LWG\YLU=4^+56;TN(+31S<GEEV4M
lblIdType.Caption = "[ " & IdType & " ]" 'MO=F3O[@4V5L5ZY;BH(]-N+VI
Dim rng As Range, cel As Range '*(LQ4V7O-.[FBCA5P\OYY?OX-F9<2XR\L)^
Set rng = Selection 'U6MD/F<W+3=/HU3W]1Y)+;:]M:^=FIPN3.)K8C5*+E?]1U
CheckBox1.Value = True '=6*VMADDR0ME=GYOJM;6CS3CH=[Y)AT:OKVLM,S?Z/C
For Each cel In rng.Rows(1).Cells ']>\3>X?9R(I7I@JD9>WLB:*=MTG<@J(H
If UCase(cel.Value) = "ASIN" And IdType = "ASIN" Then '5SCOOM-=D/A8
RefEdit1.Value = cel.address 'JX\:YXU=\73XY8M*Z+7YN]*<7C[H+)(E^2RP4
Exit For 'Y(;/G:ASZR/-6](@NJCU2ES+9X]4]LD3GF\I6Y[^GZ5-48BK1YE/(TO]B
ElseIf UCase(cel.Value) = "EAN" And IdType = "EAN" Then ':^W3*R(B3I
RefEdit1.Value = cel.address '7FF3P@B]-NUS:+R2S+]12)SX\8C=MK/RZ]4B2
Exit For '6?/9\(K4-/RDG^G6/0W;3/K-]0V*Q/36B(EIL22>9:L<=?NN:[;DZ?C@5
ElseIf UCase(cel.Value) = "UPC" And IdType = "UPC" Then '3SS(?Y?<O*
RefEdit1.Value = cel.address '6N>><66E9X;G?+E/S-2(QG]=L]K+YP1-.@5HS
Exit For '21VYNSMEE8C8U[.,YQ(N<D;]Z,2+)VX4*EUIF4;A[H)@2>);*<V\4,81,
ElseIf UCase(cel.Value) = "JAN" And IdType = "JAN" Then ']6B)E>R13=
RefEdit1.Value = cel.address ':D9))6TGH:N^:8CSKD?<*/CQ;.\78ZXR5),W1
Exit For 'S<IY5^1;Q,7,IGRZ@B1I[@.F+B,J5*:8+30.*755NAB>Y^S*?6BLWBFAF
ElseIf UCase(cel.Value) = "GCID" And IdType = "GCID" Then '/174U26A
RefEdit1.Value = cel.address '0\G:/JWP:.?/(IF76\?/FT\ELXR0TIAS)W0LW
Exit For 'P\4-.1UTMJ6<J-6=Q=?XEFRK11FL2+<)(1AP*M:3R@DG6GNGU;*F*@RNZ
ElseIf UCase(cel.Value) = "SKU" And IdType = "SellerSKU" Then '9<4.
RefEdit1.Value = cel.address 'E=UOTVR)JCYP@>3[UH*FU9W<XZ^>PNVBQ/9*?
Exit For 'WO@2<*,S<]SB.D-^DQ9O@XBX9?EX]SW(J^W5:R*CDO-ZOX@HUDY;7,K+O
ElseIf UCase(cel.Value) = "ISBN" And IdType = "ISBN" Then '0Y1P-9?R
RefEdit1.Value = cel.address '9ZP.7*@YHB<LSF6V\24KR=*7[,M<T5,P82.6*
Exit For ']1:\DCSL@VE2NO3D]=-E/B7V]^ZP/8WC8L@[LSH,KR/7U1=>/C\<;OY\Q
Else '7/V+[>K/@[.OZ[*C3C<KE=/2M(EG+C;C>9H^@U=QZ</NX<UU1US53^DF*>T>F
CheckBox1.Value = False 'EQNJD*;EF(D.[TGQT(NB=-/55AJ6\98S+/G+30DC>6
End If '(./)P]TES20RI=ZO9[DAJD?\X[WP>*U4*+3)*,8H.UA.ON.MM]ZK+>35.[P
Next cel '1N,S):O>V.([7+H*ELY(5-5BIT]YR>/QCO.=(*P^2V@L\D[(T@RQY=GQ(
End Sub '?OE4.4?EHYB@[[<]XR.3^7>.148HE[+W77=\,ZNJCKW=T2(U)/P5-,C?F2
Sub CalculateData() 'C^V.NY\BQDUU*Z.R(QJ@L/WY.LRTHUSCAC+-PU^\H6\>:[
Dim Total1 As Long '(U^FSRB:+@:>/LJ\CQ[CM*XE5IR?08HE>)1JR6OC[S>WRP?
Dim Total2 As Long 'Z<DQAOQ<PI+P+RH>ADLE<6;Y32@5F3DY70;D46J5QUN]\3U
Dim x As Long 'A(A^2^7GK6T-[(X1+WYN-00PO:KC*NQRG:G@?91;^078FF3B;6Z(
Dim y As Long 'PK[6*0=/^WV74@F*B1^+NX(V3/4F6MM/V1PKJ//S8.ES^3(@/M^@
Dim MyTimer As Double '.KW[Y4B0:T8:,]P;5(;GK\:E=.)0FQ](6+YX\;3JVCI6
Total1 = 90000 'N]=[K9.PJJP=1H8NFP23MKVC<4AONC1;T;74TR\P(2ZA9/JT(0I
For x = 1 To Total1 'Q+J?JHR+U)I4FF7W^<IQY,<Y<1P.(P]]/E9ZA5;MZ]6YJ)
ProgressBar.Label1.Caption = "Progress: " & x & " of " & Total1 'V*
DoEvents '\9BAD(E0*S4/46.PSMQ@/@5Z+R3>PNY2^4HFYU2R>-3AARS07W31R/?I<
If stop_processing = True Then 'CGXZJ[WW4]E]Z0:G0CA+?RF6Q7U8;L?EJ*^
stop_processing = False 'KIS[N3W9]?@3M;Q3.[I2PJ-3@EFI3GNCU-17/D2J1@
Exit For 'Q/ATM?FU)F(2[*(]EN*4]*41X9SM]<V]\1@CM5Q7CGK4\JBZHS)E3ST,.
End If '(78LDEBEV].]JD(\*AVKJ]P+>TW\1@@]+5\(?^GYVMV6EFMKW7F]2H]-(Y-
Next x '45OW5:6^NM9Y+BFE=+8^0I<Z4,2,/>31J(GY:?Y:Z9I@4J-]Z+FA,UQL=C4
End Sub '1D:]S>QT:SS?@WJ]\0E/-*3<WG88NF1@7[W2T7>(4N;U)VDS)8\6G08YXP
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "RegistryEntries"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Public Const gsRegKey As String = "xlGetAzData" '\P;UZUBI:>>^V44VG:
Public Registry_Loaded As Boolean ']NAK-=?N1HP<S1*G\J0-/,^/FB./L]7X
Public rgSellerId1 As String '*H8+;0?B\)\N01F))/2VGPY?^2K/87HR.\G5R
Public rgAwsAccessKeyId1 As String 'H5@A\DJ.MH\TTVE9U=;N?P5GBO[P?RD
Public rgSecretKey1 As String 'QK20XD.]WH/A*=]DF,AHVW8RAPS0^?-9?HH7
Public rgMarketPlaceId1 As String 'ZEF)A3TN934:*A?-WW*11O=L:D9,MW<W
Public rgAuthToken1 As String 'A5+5:VX57=3DU^-,NY*@3QB>Q(:3CK)PD-@4
Public rgSellerId2 As String 'II:VCB>ZQC2=.:2+4TD^*[SG;+=(LGWX4@O.>
Public rgAwsAccessKeyId2 As String 'C->8GKPJW/9)FM,OS=-GP4NNY9U6G<P
Public rgSecretKey2 As String ',O3PEH)2L,5MZ7W8[]]S21L^,808210FQJH0
Public rgMarketPlaceId2 As String 'CP725=[CQS1R/577@/B:CCYL[-K(=E4Y
Public rgAuthToken2 As String '>/B*(RD;*.9FTX3P\HP9)6802\([6QZM]^6I
Public rgLicenseKey As String '2XI70G,FFZL+?<?PR?-?W[CPMB0.O.50)8L0
Public rgHardKey As String 'BWT3\XPQGBXNX7B.8?2VOA<KFEM:WQZ<WR+GHSJ
Public rgFormatOutput As String 'VMB/5,UOTLA^TDL:0K]DFSRLS=96:U\O1*
Public rgListBox_Left As String '+O86Y:1MSF2XKWZ*D?[/)M(P-4;\V^5TUK
Public rgListBox_Right As String '/51XQX1AB?G5=3T)R)S0FIH=.:<=94@6R
Sub GetSettings() 'N>38(GK9/U99;W;[?^4Y-B;\Z;)707F)1SK0VQ(E?*:6AD93
If Registry_Loaded = False Then '9\UAMY^22FN7FW[:68+W-P8THBC0-L0ZTO
rgSellerId1 = GetSetting(gsRegKey, "Settings", "SellerId1", "") ':4
rgAwsAccessKeyId1 = GetSetting(gsRegKey, "Settings", "AwsAccessKeyId1", "") '
rgSecretKey1 = GetSetting(gsRegKey, "Settings", "SecretKey1", "") '
rgMarketPlaceId1 = GetSetting(gsRegKey, "Settings", "MarketPlaceId1", "") '
rgSellerId2 = GetSetting(gsRegKey, "Settings", "SellerId2", "") '*O
rgAwsAccessKeyId2 = GetSetting(gsRegKey, "Settings", "AwsAccessKeyId2", "") '
rgSecretKey2 = GetSetting(gsRegKey, "Settings", "SecretKey2", "") '
rgMarketPlaceId2 = GetSetting(gsRegKey, "Settings", "MarketPlaceId2", "") '
rgLicenseKey = GetSetting(gsRegKey, "Settings", "LicenseKey", "") '
rgHardKey = GetSetting(gsRegKey, "Settings", "HardKey", "") '9\KYL>
rgFormatOutput = GetSetting(gsRegKey, "Settings", "FormatOutput", "") '
rgListBox_Left = GetSetting(gsRegKey, "Settings", "ListBox_Left", "") '
rgListBox_Right = GetSetting(gsRegKey, "Settings", "ListBox_Right", "") '
Registry_Loaded = True 'FJY.(H7:@02-)2*YO*UM8QG*F9:QL=.H^573(R/FC^O
End If ')XOP-]X7LY?Y1BO/<=E3W)GGIC4GY*K>@GZ:RBJ-\QLN;705W@S68[8,]T7
End Sub '=8TRV@2<*0?Z[/J.1,+5U:*=>T-*559]TK*7L\NO;,^6R]5]E3,)ZJ8-Q9
Sub SaveSettings() '\A--(>)6\C57^=ZI;L4?]WROA?1E96TA87^=6:5H^;X[AMV
SaveMWSSettings ',R\G:MAF2]1ZXV*-0S.9>?2B+>S7(Q>KF>W;AX-Y6<-MW(,:<:
SaveSetting gsRegKey, "Settings", "LicenseKey", rgLicenseKey '>]T9N
SaveSetting gsRegKey, "Settings", "HardKey", rgHardKey 'CTYGSU<QO\I
SaveSetting gsRegKey, "Settings", "FormatOutput", rgFormatOutput 'Q
SaveSetting gsRegKey, "Settings", "ListBox_Left", rgListBox_Left 'S
SaveSetting gsRegKey, "Settings", "ListBox_Right", rgListBox_Right '
End Sub '-P0V34DF\G]*2*4C;22EPW[31?ZDR9=\,R0B9ZBH([8QVKO*M8J)YBQV)C
Sub SaveMWSSettings() '/1D+R+M5?QY[O2[,PXS)L2YQBXHK2VQ9).UO//)I89N1
SaveSetting gsRegKey, "Settings", "SellerId1", rgSellerId1 '1Y3)OYG
SaveSetting gsRegKey, "Settings", "AwsAccessKeyId1", rgAwsAccessKeyId1 '
SaveSetting gsRegKey, "Settings", "SecretKey1", rgSecretKey1 '\7N/)
SaveSetting gsRegKey, "Settings", "MarketPlaceId1", rgMarketPlaceId1 '
SaveSetting gsRegKey, "Settings", "AuthToken1", rgAuthToken1 '>6U>N
SaveSetting gsRegKey, "Settings", "SellerId2", rgSellerId2 'BJ-]QI-
SaveSetting gsRegKey, "Settings", "AwsAccessKeyId2", rgAwsAccessKeyId2 '
SaveSetting gsRegKey, "Settings", "SecretKey2", rgSecretKey2 '([MDL
SaveSetting gsRegKey, "Settings", "MarketPlaceId2", rgMarketPlaceId2 '
SaveSetting gsRegKey, "Settings", "AuthToken2", rgAuthToken2 '4D>(-
End Sub '1Y)MUCUPD0]3ID+HNP6P9[P@/^;=0IL5@B-+VX<^,?5*-+B9M9\=3W5YP7
Sub SaveLicenseSettings() '=R7QF[.A\?YOS?FYZ4W.0275V)3>Q:@F+:U=RZ9B
SaveSetting gsRegKey, "Settings", "LicenseKey", rgLicenseKey 'IU*A\
SaveSetting gsRegKey, "Settings", "HardKey", rgHardKey '.0D^)*4^\L>
End Sub 'JJBTWC87WCGT@>+ZKC)LV[(04=];E)J)]EY-?GY*Z<\R7NWI3YID8=+LL3
Sub Deletesettings() '[LA5T-4)E^G6:7\G6:I<P>,.;;0BUE^(9-F\X:1::CB5/
DeleteSetting gsRegKey 'N@9SSE98+E,(0Z5ZI:YAJB)G)6(Z?/B<LU?VI.@8^->
End Sub '0TE5I<44MB4AG7NN--2K8QS8.,JMMKCJ@UX(X^0,6/\0SF(@WV]5J6N8\1
Sub GetAllRegSettings() 'QO]0CT-\WLT5-]0H(ETYD[*.9@.9S0UX7<;-D49X9H
Dim MySettings As Variant, intSettings As Integer ',4(;[8,E@Y5@VD,,
MySettings = GetAllSettings(appname:=gsRegKey, section:="Settings") '
If IsArray(MySettings) Then '78<Q(B)FJUG8E(L8TBB@ZUTH:5J0W:O+P,MY:/
For intSettings = LBound(MySettings, 1) To UBound(MySettings, 1) '(
Select Case MySettings(intSettings, 0) '(+@N(7CI3(IV2=QK/I*0S;)\@CB
Case "SellerId1" 'R3/>;9=\Y@+,=KQA,2=ZYBNU^^]UQN.SVJX*MM>Q]M[PNTW65
rgSellerId1 = MySettings(intSettings, 1) 'M@F=-6.[*(=Z+;=(K/M=[6MLL
Case "SellerId2" '8/K6B2YB(:K);I+9+*;W=>FI;.P@-A9,4+S1QDGC\B/OSP>,8
rgSellerId2 = MySettings(intSettings, 1) '^Q8)\8IE:M/:3CGC?(R]3>O]Z
Case "AwsAccessKeyId1" '9.7;XPVN).E;2C(;,<*D-)-@347[W,?D:=F42(?U,DB
rgAwsAccessKeyId1 = MySettings(intSettings, 1) '^8+0AS18W<>]Z/BW1W3
Case "AwsAccessKeyId2" '*@D1DPQBY(\YJ[(B)M5MW\778>(.\0WA<K:?KOQG6Y6
rgAwsAccessKeyId2 = MySettings(intSettings, 1) 'U-(\;YJ9YHW\)5(?1>*
Case "SecretKey1" 'U=5(Z\2>.>^P4+95EZLRF5Q?.;9;OF\).?@D,>+3GB>K(49N
rgSecretKey1 = MySettings(intSettings, 1) '1)T=)>(]\Y(PJ51Y?,2NUX*@
Case "SecretKey2" 'Q2I-IF(JZ)@ZF[G6IR@TQ5BHYEL*YX]CN2,3L4<>0R*P8/LW
rgSecretKey2 = MySettings(intSettings, 1) '(K*R*9^;5/C4PEUW484YO,5Y
Case "MarketPlaceId1" '>1I*IMXZ/^MR4-?E,4*V[GGW:60AQK6F@W-V@E:H]T,V
rgMarketPlaceId1 = MySettings(intSettings, 1) '?U2=*LS@EF5[X<E.<*<4
Case "MarketPlaceId2" '?4^-Q9RZ0[RGA9ZH6G;XXG.KPW+FX]1-\]X4-/U7>*W-
rgMarketPlaceId2 = MySettings(intSettings, 1) '1)4:,[TWU+R53LWC0Y5>
Case "AuthToken1" '9HF6E*1T\U)U>1+U>@MWVO6/2CUZLS^L)71=1[+=?P9)NLAZ
rgAuthToken1 = MySettings(intSettings, 1) '1,DFI?J)^)Y;YXT=U<WYA1FQ
Case "AuthToken2" '865M=K=JJX,BB:XZZ]=>L>76S5A+H>D;G/A>ZTLCZ8(3WD>,
rgAuthToken2 = MySettings(intSettings, 1) '9T>7QAL*+[4JY--3KF\356CQ
Case "LicenseKey" 'V<1JVUMN(AM8QT,XTDFV)WW2@BI>L?2J<@^^3>W8U3RY4KUV
rgLicenseKey = MySettings(intSettings, 1) 'MAD-:,5@]D/<IDG*X+0^8>K3
Case "HardKey" '@YU<1,=G-^Q<46<B8,^NOYE8@>5J6P-Y=X;5/@G0]FMYT+;CA+N
rgHardKey = MySettings(intSettings, 1) 'KLXR,1.,=Z19V9XM?T^VM)K4\42
Case "FormatOutput" ']NV<+KIH4]<.7*PHA\ZI^W(2YA@<.TM.R7.CUW<]VKN1-L
rgFormatOutput = MySettings(intSettings, 1) ')=PT[?IIGUS(P?^O]Y2G6O
Case "ListBox_Left" ';ZQJ^<D2^EU3AXQN:?W:ON/E>)/VU*EH(AQU[+\;1*35K>
rgListBox_Left = MySettings(intSettings, 1) '(L)=KRZ;.H,3P@L;VKO>32
Case "ListBox_Right" '17\.@M6UK@72K<VMYS99+5=,-?6>B>+*T,>.?W<DGLH=G
rgListBox_Right = MySettings(intSettings, 1) '53C]Q<8*=)X[*::PBWA8-
Case Else 'YG)36O/A^8;1XP[[5ZS=44<;=P(5HR5N]NIA9XEFO^GI6CWF3ASE7E^\
End Select '<6^TV\XA-TPZZ*1;FA0]7VJ)-N;2T30.6=47WIT*96*^NN2BNAYF-P^
Next intSettings 'UVC:G/;T5^7R>K2T9,HMTK,Y:P)M;UE*WRI428N92Q6/A/W<[
End If '-E)=0-BQ.47-2ZNII(GWBV01L56.3ON?Q[T)8<B>973-W[CJ5+FENC,L?4C
End Sub '5]]-83:0*@D1H<7@50\GI(PE*^2430^,(V(/P2D/A-O(M3CJ/4DL+F;WD.
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "Settings"
Attribute VB_Base = "0{E0AE8B8E-2749-4915-B1FC-FB3F8A5E6980}{614E89AD-F80F-491F-A202-36D574354148}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Dim okayClicked As Boolean ']I5-Z1@^([=R0?EWH0;IZR]C0A[Q8G7(^AZ;AQ1
Dim FormatOutput As Boolean 'C\,4=C)RQI>RD6RZJBKY-*86;BJGT=@QKZVS)F
Private Sub BTN_moveAllLeft_Click() ',G38Q2QT)53YMOM*XAO;W)NHZX9>GP
Call DoBTN_moveAllLeft_Click(Me) '@[H;@P+KNW8<<:FW?ZT46YKPXX?>*0KUS
End Sub ',:<F+CO32+BWP5QO93[2-G](.6VR\J<GJO4(LW08JEGXK@5^:S;I[WPRN]
Private Sub BTN_moveAllRight_Click() 'I4/DK@Q-[QA6OT;JPL;3B.,]L?ZGW
Call DoBTN_moveAllRight_Click(Me) '5VJ)1H]=3?\5E)G=9:+[QZPTNM)C3LV-
End Sub ':ZNL+B-EE](WJN0S^AHC0A<*Y1GKTO?X*;QCE0T211*UEI@PH9]AUK1GH<
Private Sub BTN_MoveSelectedLeft_Click() '6^Q811L@963JBV>>8/AN;D+]D
Call DoBTN_MoveSelectedLeft_Click(Me) 'A)^[CQE2/Q]VFK3MMIE>O1,.K<M(
End Sub 'S7=HT<ZT\L-7M;MY,Q\RH+PF-4A(.3GU><3OJ8(Q=K<ZG:NZT.1:4/HXA(
Private Sub BTN_MoveSelectedLeft_DblClick(ByVal Cancel As MSForms.ReturnBoolean) '
Call DoBTN_MoveSelectedLeft_DblClick(Me) '1YVJG9*XAU1OD4>[:H+X]FVRT
End Sub 'TVONK)<4L9L/\V61L<W]G]=OMX106KH[^E\*?1@JP=I\I?RQB8)L]>2)JA
Private Sub BTN_MoveSelectedRight_Click() 'R\Y,1V57)4KO1T);/=0P*X4)
Call DoBTN_MoveSelectedRight_Click(Me) '.IG.*OUVKZ?F2@G5*8*-)-QY)1E
End Sub '.U0[OOJ>[;,/P>Z+\X8M,Z215M?1BG,>9N2\=FE?K^XK@?9?27XK^LCIT=
Private Sub BTN_MoveSelectedRight_DblClick(ByVal Cancel As MSForms.ReturnBoolean) '
Call DoBTN_MoveSelectedRight_DblClick(Me) '>@=H;I*;*T(,6/4[<0ARC]F,
End Sub 'S5((0@RW6;H]IDP\JOG761:[YT(:CVSL[J=0OP(ZV30X\7-YL+3:7PXKMR
Private Sub btnActivate_Click() '[JUEU@*++EMPID0:WPM<1TV.F0EYP0/RB/
If validateMwsSeller(False) Then ']HO8VUI,A8F9L2I9H^V)=]]O=([S=F\)2
Call DosaveMwsSettings(Me) 'CC*Y8[?[Z*<E^E(@^D>C9:S-FVY,[WIW0VYI>VX
Call DoActivate_Click(Me) 'Y]+\57;NAABI18<[>09Z7;EXH^1H\S:O);CU)I5:
Call SaveLicenseSettings 'B<ZHWI8>MI7TSD]JQF;=,^*@TDL9;K0=IFHU6+-J8
Else '77YX83B:M)2TI>Z5IN>)UFA4<RF*[:CELQFE=NKW[NVST=3Q*LQ6;=O0H2,)7
MultiPage1.Value = 1 'K;[CD:D?^<:G-LQH?U*F66.D0PM0A:EZAH.5BX?(:*^>,
txtSellerId.SetFocus '=[SZ]-W:):-\?MUWPY[<S+H1A3)FH6P*<7X8SXZ*<\?C7
End If '=],I/.M(JT;\/DS2\LQ6-F@?3B]+W1:*Y9=J3H4;KPO=5[;+N@<E(G^XCO,
End Sub '@?-7;K\;>\Q(DFAJN1B8O7V6YQKF4@QXJ<QQIX1Z)1[\2.*143DRGXJ5X^
Private Sub btnClearMWS_Click() ':(B.P/>O+)7EBHG,[1273R5R-?P8RSMJJ-
Call DoClearMWS_Click(Me) '+*5M(,XUDU*?T(IG-2^V3=2.+(,ET[)S]\PJW=7H
End Sub '@^H)2RDPXA:S8H+FEMK?99\.L:]\H?8F9TPQC9;JULL*XW)/41?;LY;AXU
Private Sub btnClearMWS2_Click() 'U,VMV@P;(J@OMG\<:[/7@<RMH3T8W0VUG
Call DoClearMWS_Click(Me) 'X]?GK3G(*-UHAJ2]2Y+=Z+[,57(\J25KI<MK)4YN
End Sub 'H64I.5W/?[1@0)8)L^32UQ=>+L0YFM[=TU[:?Z+,-A(GU]O-D5\?Q53,M\
Private Sub btnDeactivate_Click() 'Y?JT;2./1A<=F1X3:>O@P,=E;Y.\BH.0
Call DoDeactivate_Click(Me) '*WM/*QL<WPH:(@60<5B^N\CG2)ZT@RDQD^NW>U
Call SaveLicenseSettings 'F]D^UE^<K@>Y\37Y5L5:7S=N,XV=,\K/H<RVDQAE8
End Sub 'U<-LYWL-DH)S?/ZTF@,5M+@K1MGM/U9(K^X>BS[0RF,P2(IK9?<H*Q*WI3
Private Sub btnDown_Click() '+>7A4\UB>\EGQ4Z]/FR/SCBM:EIRZEODN6?UH>
Call DobtnDown_Click(Me) 'RT^M5<A)3QVD1UV)7X\3<SS7NDQ,CV[>/34L:)PFN
End Sub '>9^A@CR9G;TO+-1*,9^C9\1UZNE3HD]F\C]W7]A^9QPI?SQ;(]O7-2MK:N
Private Sub btnDown_DblClick(ByVal Cancel As MSForms.ReturnBoolean) '
Call DobtnDown_Click(Me) 'HD1>U+(NR+S4M+\H<V1C6H^.@4LC6.3?[ZP?DN(\0
End Sub 'X6AT147B]I.7UF-2X<UKR,W;H.=]9?5=;K(.8KHU0<S:EQ;O8(2M<3N4T[
Private Sub btnSwitchMWS_Click() 'V@*N:QZWP4P^Y;VGMGK];3-W3>CZAFBU>
Call DobtnMWSswitch_Click(Me) 'DKC\=Y@:[=O>9S5]>AIX\473))3SE,CR54DN
End Sub '\233@U8/6M[W@:MRJ<-1KT@>:UD1?MS+Z]U?F)[AIL(DU-OMS0WF>P*AJE
Private Sub btnUp_Click() ';8DZZY]Z)G9+9W0JOH>U@MF:5B\2Y-AQ,3@05\PS
Call DobtnUp_Click(Me) ',\:OM;V:L4)IM\V@H39GO<:062R?(KQS5,5.*J]/MU:
End Sub '7?3,([MUAVHF4*O1GICPA@M6X?:Z?D^;1@/>J9[^4Q.0S-5H=[.0@VCV^A
Private Sub btnUp_DblClick(ByVal Cancel As MSForms.ReturnBoolean) '
Call DobtnUp_DblClick(Me) '^+;[+H[)D7\])]CNVL--?YQ;20DMLO/-RJ+L=^EU
End Sub 'L=Q?V56+Q=D>GDG1V=3QUB+-7XZN:?7SS/4\ARBV^TQ3OD6.[;JF6MZ.BF
Private Sub btnValidate_Click() 'PX1)AL2+2+;KB6PV2E,M7P8R[0/6WB,XX+
Call DobtnValidate_Click(Me) '04?4DLNY4LJI].;>T^P83]L6@2AS9<PK\2>M(
End Sub '5>5\J[[9G5O)>)X=/Q5X)1Z;=^+9CU/C(@4N70NW;D-=S<8Q*[Y7Y=S59=
Private Sub btnValidate2_Click() ';Z<CPH+>7A4Y5E<JN>6P;T5@G<([UJGH.
Call DobtnValidate_Click(Me) '>?VWV)A[4=1JVIC(V<0C8F9+G)3N+QR+^,QFH
End Sub ',4YP)>BQW@]RPB34^]0=R/B8MK@2YH-);MI7:O]0/4TR4DHR<R]63JCO+Q
Private Sub cboMarketPlace1_Change() '.5U.6/7GOJDYPM5;QV8O=.:8QVU*/
Call DoupdateMarketPlace1(Me) '3W))P[*HD?8U]YO<1X3QO?4ZRV@2@MM>6,/8
End Sub '6YJZ:0O=[E.QD.Q\P0Z(5^FWH7TWB8\,0I;2.[VB0;:,?IHB(U:9F;H<5Z
Private Sub cboMarketPlace2_Change() '+DLZF1L9:+DDVCH:=.9L0V4\F-;/K
Call DoupdateMarketPlace2(Me) 'YU2V.7OS]Z@T:L^5-=YAZRG73+A@>A=HH@21
End Sub '6Y<>W)=</\I\[2:RO<?WOYCV8PEAIAD3CLG8I@2YS7NDR/,S]P]<O0Z2JM
Private Sub cmdOK_Click() 'R0K\J^7\2V99Z?>M4JTT-A19)EFI0FM*I.AB2YQZ
Call DocmdOK_Click(Me) ',<A6VK66XI>)3+^KGG\EU</DCM?7J42^U))/H8NRZX<
End Sub '.TZ@+LNB-:H:178NX1][F2(OTU.N6ILG<<68RHIML]B-CB2C\;+N1E9X09
Private Sub cmdReset_Click() '/4X<]H8MCUAU>;?OQH/BY]L,W.B,O63QA]>=)
Call DocmdReset_Click(Me) 'I7UM)ZC32H4[>ZF>[O4:@E]NT97,-<G4ZCJWUI2U
End Sub '[27+A3G=3,V/DXO,:MN/5Z;;A]<*9Z78UN,MM?7/7Z471GFQN>]]Y@6.H4
Private Sub lblSellerTools_Click() 'C7;SJ5P,P5WAHXIH;C>DV:/X6N=8XGV
ActiveWorkbook.FollowHyperlink address:="https://sellertools.io", NewWindow:=True '
End Sub '0?W9:+K/NS6-KP?VS9[Y2L>.T7BD0X^58GOZ+4+)A16T<[G1HI]+Y([WKC
Private Sub UserForm_Initialize() '>;)Y71L0@32VS.R:UP^OVBL8>\\B*[MH
Call DoUserForm_Initialize(Me) 'X;,/,+0AQA+Q-XD?9[HTI^\AL)>F6SJI2(3
End Sub 'E]6T>E6(CC(/7\D1HZ*B1ULY<02)1A:TFC*=UQ33G.E7GTJQ,J@W<9[U?@
Private Sub saveSelected() 'GIRZ24RIBJ)S1[-Q/[VK8(*[]M6S02WY:<=A@T,
Call DosaveSelected(Me) 'H(K[J9JBUIA/FCS:M3J:?[S^;SJEQL]T5H;GE2=4FB
End Sub 'DE@:H]G[]?HY1Q+>5,L0FNFDJ4[MB^Z1]MCPI2)2;UMT^K9U@/H.G+38*K
Private Sub sortList() '27HKC)J+*<Z;SBW^MDOOV7[QX(K8E??1L/8S6/+>\OO
Call DosortList(Me) '7)+:PF*V)CZ<?NC;<7K@U^B5PG/AT?H3DNUH=;5BEM5O;)
End Sub '[GNT^0WY9K77D6,16(.D(LSRP4^Q7=?[F?-V64-STNIS>50VBM0685JCW(
Private Sub UserForm_Terminate() 'L?KUAW^1I7E:UM;*G+GI@\GQW@4I(3H[-
Call DoUserForm_Terminate(Me) '?)S716\@[FFCDXPRDJ:EL+OI/YR):2;-WFRP
End Sub 'Q]M98,9Z=HRQ?^5K/]0GF6YN;IS<B,6KXC9TO84;GEB,,))DS+LE1)U3\@
Sub SaveMWSSettings() 'Q62^]77D53DZYV/U16=RDZC;3WZJ-6LQT10XZG*8MFDS
Call DosaveMwsSettings(Me) '8).6\3<5\H4XNHQ)CW6M+Q+0:)1:CRI70KO)[9S
End Sub '03.Y^GIV/FV^@D@[DW+??:46]JSJ+/7>6.Q]U]U,OVX0*@ILO-SV907L5A
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "SettingsForm"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Dim okayClicked As Boolean '/T\(CA\7+Z:1MBRVZ2IJZ@6GBOZC:EB\TURRF<*
Dim FormatOutput As Boolean 'M/MQ,E*9OQ2G*Q>G=\@UT>2C<3AZJ--=5;72^]
Sub DoBTN_moveAllLeft_Click(f As UserForm) '4]M=OG(:7UG\Y[H)?=>34./
Dim iCtr As Long ':EY8<3OJ5<4>83YZ;J2Q,W=NT<1K8)(\/A-X-M<=T+X0T<;WK
On Error Resume Next 'MZJ>NGO/Q],E:1Y/K0C(9F6*AJRGZ>30R4[P-;@U+[D6*
okayClicked = False '6P[4NCV2[EM(NTA4L8\,>ANC@L77P1WD7+[;]M7YR0;@05
For iCtr = 1 To f.ListBoxRight.ListCount - 1 'P+0,6S49AP.WI9D<48:\F
f.ListBoxLeft.AddItem f.ListBoxRight.List(iCtr) 'Y*IR]W<2XTQLU.J\F=
Next iCtr 'Z^34>K4DUR^-LPY-H:30UPZCMT*=?G*Q:(F-(+6G)Z2@LD/N*88Y@4<?
f.ListBoxRight.Clear 'Q)0L;S><[04=OD695:WHBR=N3BNMQNYQNF=94N--<*)NN
Call DosortList(f) '3^Y<EU8Q(PLG)D3EE]+GT3A8//5E\5A=0K@2P5[)B<G:4BG
End Sub 'NS(=R[QX=1/M<5(,B8(YQBN:6YVV*P(H;H>Q)3ZC76AUIKI[]M8N:X+A5W
Sub DoBTN_moveAllRight_Click(f As UserForm) 'YDB.W.H<HOI)N;-O=3](*^
Dim iCtr As Long 'FJ5F0+JN-3>TGLQ*;-8(](CY.>.^6Z];E3(RY@D\F1J(B=0-A
okayClicked = False 'FNCH2@D+BNJ<[C((X=@QSEKCP7Z>1S+,^*D9N]QR*^X2MJ
For iCtr = 0 To f.ListBoxLeft.ListCount - 1 '383G.MX<E:B)>=FC4BX\U2
f.ListBoxRight.AddItem f.ListBoxLeft.List(iCtr) 'UG5O:-UQ]*JO@XII>3
Next iCtr '450T.*KVH)PQMN17V2ZJ9?C6FHM\(U:/32HC[X5QSJ:T\@-^3I.M1TJ2
f.ListBoxLeft.Clear '*MWL,I0VKVY@KO(6(BA\*4RD/]T[FYQ4K(=D5\LL4*<QEM
End Sub '/(YZ7FCKNKA6D?L42.RI4O-B5\TA4@5F^6J2*DXHD<W;@4K59258UQ@2XR
Sub DoBTN_MoveSelectedLeft_Click(f As UserForm) ':D;@AO@AO/RVL4YB[0
Dim iCtr As Long 'JTM4U1X[YKO*-PKW*WCR3(A\FDC@F:T=:=QF11W-0L5F2D,11
okayClicked = False 'S7DG9Q2DN-S^SLZ?7.-JU7=J=/@VR+KBA?E/O4INZ41E*0
For iCtr = 0 To f.ListBoxRight.ListCount - 1 '>X=V@Y2*4EH4UJR;G:5F=
If f.ListBoxRight.Selected(iCtr) = True And f.ListBoxRight.List(iCtr) <> "Search Id" Then '
f.ListBoxLeft.AddItem f.ListBoxRight.List(iCtr) ']YI0X<US84*,]Z24)C
End If '..7P6YF=0XWYH)A:YHHQ?TH^7T1L1N,>N(VAS5X<<YU]>D0S],X>TOU:^BS
Next iCtr '+GEI1/FQD^BMOMTYU:-@8YL.5?@,RP[FW<KS/LKC30:2*4J)N)1U7G]:
For iCtr = f.ListBoxRight.ListCount - 1 To 0 Step -1 'A;@(4K.LB>BW6
If f.ListBoxRight.Selected(iCtr) = True And f.ListBoxRight.List(iCtr) <> "Search Id" Then '
f.ListBoxRight.RemoveItem iCtr 'I1.WCZU.Z?8X5V3*=OX:Q1)G>:<3GX]-6^8
End If 'B8/BQ2HZ7AIOK99^U)P9?Q4.@H8@-ZIW)]6LGN6<ES:>^)Z^CY>B>;PLG[+
Next iCtr 'S@^H\LDI:?QL/3]AL6<^0R)F)K3]3/V\S+:YY,EUW6)DH[K)4P4<))MD
Call DosortList(f) 'O,KWJB34QU7TO^W)?*:)?5>]<<<7]1E?\0XMEK-<V\N0W^G
End Sub 'E:+V<-2@X\L2@/USCG(2U53+\Y:HWY?C]8388=*U[1Y\Q;NM:A\<45D3:7
Sub DoBTN_MoveSelectedLeft_DblClick(f As UserForm) ']<9QC>MB*N10^4M
Call DoBTN_MoveSelectedLeft_Click(f) 'I3?+)>K7-=?([+0[*2CUS.G4]I1F\
End Sub 'I]8[8YN;>IN9^PV?5F^BTX3I>=]JJ0MO^=789?809)]V9[P<CD\^*ZU>X4
Sub DoBTN_MoveSelectedRight_Click(f As UserForm) '^MSL9T<16S5@\;[DN
Dim iCtr As Long '0C]>56R\)]P+]D6;XTJOFN=>U-V8K=[<K*9BQDL?5=6/UTW42
okayClicked = False 'C??)KYG4>TDF,+/R?3;>^@/ULXONE,^H\R7WXZ6W?^/2P?
For iCtr = 0 To f.ListBoxLeft.ListCount - 1 '=N:6NHD;M0KXLLX+KF*<J*
If f.ListBoxLeft.Selected(iCtr) = True Then '+5O26*;8.4XY-1G>(8V\H3
f.ListBoxRight.AddItem f.ListBoxLeft.List(iCtr) ':4:-2OVL;VT^ZL,9TO
End If ':[IY*XZP@)FW2JFP5S=D::?ILVR7M\6M7(K^4X4YO]F:9IB</I:A0-HVWHA
Next iCtr 'Y(M8H@/\O)J\H]?[L[91?@FDJ@*LC0*DI-R^EAAY2LL0,2O7)LG*(3Q?
For iCtr = f.ListBoxLeft.ListCount - 1 To 0 Step -1 'C80(I*U=?XW*H:
If f.ListBoxLeft.Selected(iCtr) = True Then '8XC7)JP<FZH]FRQC,*EN7A
f.ListBoxLeft.RemoveItem iCtr '[^U,+*PAPS?UK5Q-=OD>SQ^JI.G^>4Z.NJ20
End If 'J/XP-F4/S.[^HVJM?V=715B<,/37:S4;U8\P:35-QI<\O=5Z?RU<P^V>B@T
Next iCtr 'U)37?9;)QQ(>U.<,PZF-7JK?P48A\[;\N7V249.9,1?+5T@E=]??BG4>
End Sub ';HBA3RU[A6\*Y[5?/6;()]4L@VD:.]*7Y*RD5,PMV5B\M)H?,KED9JOT4S
Sub DoBTN_MoveSelectedRight_DblClick(f As UserForm) 'EKE2;[H;-2L^[N
Call DoBTN_MoveSelectedRight_Click(f) '[/7E\F\+\)8W4E)2[<S9C08D-.=D
End Sub '-4L8.B3]E0JJ*C38*IP?YR=580SO+I<<+YZP<,;OR,[@ALB5^C]\@I@=[(
Sub DobtnDown_Click(f As UserForm) 'P,207.7?.X=/+*7HG3]:4P0P9S/HRQK
Dim NumItems As Integer ')2LG</8L>92]X+MAIDNF3:E:1M,5+;1T-:6RW>6=:0
Dim i As Integer 'P0OH@V?2KB[M>TEAG[>7*/;,YTM62T@[FYZJ@E51?Z?XN2FV^
Dim ItemNum As Integer '8LVLG=4^;(R<9(:;JDR;W722=W4\R+S(JLWAF:NGBY4
Dim TempItem As String 'X5A9^/</-@WJ[4WV[E6X<US<XG+9+2Y(G/[>0=?D6[:
Dim TempList() '/K)U?RT56<)R=0;(8UC94IH^N.HK(@,,5>:*<5EHG:7?(<>NIIY
okayClicked = False 'N\N0/R/=Y94,5;,YX=@N/[,3F\>5JG?YR]T4ON8(V)<Y/M
With f.ListBoxRight '3,YT)PX:7O)W](4:I5:QAIMJ:UYM:EWT/V(664V.TBN^61
If .ListIndex = .ListCount - 1 Then Exit Sub 'RUO;37;R5B(2);(E5-X[1
If .List(.ListIndex) = "Search Id" Then Exit Sub 'LKG8,H=560H-INFS-
NumItems = .ListCount '3VPZ62@O4C/]OC(.6/>1G[1L(8;E=9(L)M>7[W>[<J+?
ReDim TempList(0 To NumItems - 1) 'YS\,5TVNNR9@2;JMA[]O8N(Q*5=T:-Q2
For i = 0 To NumItems - 1 'YC,9/PS:)ITJ;:T5QD:ODVI:J*SOY,7PMI=A?O6J
TempList(i) = .List(i) '+J8QK-@L^,NL)05ZRDKH=^=*:FM<VWJ3F3?PHH(WK4[
Next i '-/F?:9M6=JI5BAX57[*27K0F@PC^,7K9)XPO*<[5;+6>MYF553S?9<DUL)O
ItemNum = .ListIndex '/R8TMSBR>^)\V)+JN1WY2]R@X1LECU?94NU60YI)YSQ=M
TempItem = TempList(ItemNum) 'P/6*NBO=Q6T44,Y@8YED<.R:D.U;4Y[VC-GD*
TempList(ItemNum) = TempList(ItemNum + 1) ',]LLUFO<>[:988<-E.M3@Y);
TempList(ItemNum + 1) = TempItem 'RPY-K*=L/5+0:WV2CY842FBJE3NIVQYR?
.List = TempList '7GHH;X8P87PT/M[5)QO0U(<2]-Q;O=D9>XHR4/(4]PXY:RM\/
.Selected(ItemNum + 1) = True 'X*)A)[VX;7YHSEPER=(<MP\UFI6FVG[ZO;Q9
.ListIndex = ItemNum + 1 'SYVH93C13\9T9U79O\16>NUW1ZR;Z8+A((61+D[QU
End With 'LMJ^RGH>W@QT05G[9ENXPL;++6]2]Z.K0.J(FC\((3V>VQ3D+T9L?B.*1
End Sub '7L\DDFP(M:VK4QV5YE8MAEEDD\M]M+X1\VVD>5JA^?H@Q8O+2@.EZ/T@BM
Sub DobtnDown_DblClick(f As UserForm, ByVal Cancel As MSForms.ReturnBoolean) '
Call DobtnDown_Click(f) 'IH@L./SZQ5S4.ETH\BX(+3T+HULMFT93KN?V1-B,=W
End Sub 'N;Y@3WG*U/JEJ*6W4PTF6C5;XUXSSQA37=?YMU:M(0RAST365.?>O3X^4)
Sub DobtnUp_Click(f As UserForm) 'PQKJAEKSN\;^9I,0.DQ4YEWH])@[YMA2<
Dim NumItems As Integer '30;HE63\0L>1.,F[E\Q0L:=]5Y/S)/^QKY\;P4C907
Dim i As Integer 'P](?H[XTL<QR3N8XXY99BMAGRS;BLHP8HW)8/Z0;ZY@^R=(A.
Dim ItemNum As Integer '>:QX?@/R^C0H4U56G(9@)THSSCW4):YN):4(@7)\[*8
Dim TempItem As String '(O8NBVH+X;,NZQJ.T[THF?<\BUWL^CB2GF5C,]=]34^
Dim TempList() 'CDY]ZAT:OH2/NPK>60@-2L32)*K:>MNGT?T9CSGMQ8BZ7.,8\]3
okayClicked = False 'W,A2E>RGKAJ66\A/MO8D.(X@>,1?2S(43S,*WM/]+FAC6Q
With f.ListBoxRight '7L:67TO)L\L45\QZ@T*VE-Q,]MDI5BEDOM:1X.AOS[HZT?
If .ListIndex = 0 Or .ListIndex = 1 Then Exit Sub '.H5B^QP:JBW3AQT<
NumItems = .ListCount 'N.1EBA4;=ZI.G8]QPQZ3K=13O3T4,2\SNPC]W454Y*46
ReDim TempList(0 To NumItems - 1) 'Y1+LK<>-8S6>YJ,/=9LM0/6,H+Z*3^)1
For i = 0 To NumItems - 1 'GRRCU6YCX.E:>MKZ3WD/28>.EL8O4=^9MC@UQS=[
TempList(i) = .List(i) 'E.OLHK:A>PMX,3+C1=<51ZDY-R8P<P6E)T0Q)17\Z3;
Next i 'NT-4/*+NUN*/OVBDR9;0/F]G=GUF16UI)WTI?Q1L.AW4O^GGE21;LMAE5Q+
ItemNum = .ListIndex '93JR/]-B\Z4;V]1@\N)/ANO-I5=E4\WE5)=XNDNZSU7W7
TempItem = TempList(ItemNum) 'DUD+5-DR4,,PFR8GXB3ZYF\0].,B0=.-;Z>ST
TempList(ItemNum) = TempList(ItemNum - 1) 'VS4G5]TS+AQ^HOQZ2[7]723@
TempList(ItemNum - 1) = TempItem 'I5AOHM67:C\[<I0[S<,M0HO:YJ0GM]9R7
.List = TempList 'UL(:>B,V.])])QHZF5^9ZRY;GNQ3.**I;3.TI(0N;Z6/]G*MV
.Selected(ItemNum - 1) = True 'T,D?4JLX?FAXAEEX,/NORKMF0**^D9??J\]S
.ListIndex = ItemNum - 1 '00U?OQ7@M)=Q3=FKK(3=E4-:-BP@V97Z?S>2W]N/V
End With '8?X@M0<2^P4,5E>^79O>6WT/=ZH6V5QF].HWRX0ZFWC=\D6,+VHD[^+J7
End Sub 'D:V<TU?H??I;BDTPSF1C,,J6L((S4.FQXVFCF4<9D7IP5?D3@7U\@MF2R]
Sub DobtnUp_DblClick(f As UserForm) '?G;VC+]YZ;SK30M=)QT=117/O@\WD<
Call DobtnUp_Click(f) '+=*DBA^=(JGPZ8D5MA^0-\DST2]7^\^H7KAT(H?JJQ//
End Sub 'PSYK8/^7,*PYYZAYG^*]0,I^,GG/YNO7].PMMGYTK^+C;MP>(ZOFDML7]L
Sub DobtnValidate_Click(f As UserForm) 'XQ\1=T<@;VLI^V1O[A8M7[IUW96
Call DosaveMwsSettings(f) '\]G[S]3@8S*7^;JWAAZ>X5W+NS>.Q4DOAWII;J66
Call validateMwsSeller(True) 'TY)CLT4:,,*4KUNRNTB>]N\W;J9Q(W2EN]GG<
End Sub 'E2/*P<F0C)](W=OAUR(FW+15HQSCN)?C3/<1[*P\+;UU8?KFXQR20H?X6Z
Sub DobtnMWSswitch_Click(f As UserForm) '\XH]C98*(Z>0>LEY*=R7\QMWCC
Dim tmp1 As String '\,66+];\8F[E^A=RIZ?PPM+==4/9D7UZT>OLI,PP7SOQLFZ
Dim tmp2 As String 'NQQOM1Q3XM(86U)9>0-*A@*)@+V(GFVT-J*3-3M9VY+,0GJ
Dim tmp3 As String 'UVGHY.CZZ=^RO/B:+34BM@D[OC1P9[;\HDGKOT[)9(M^,([
Dim tmp4 As String 'P014(5=;AM)YP8-)@*?NT2N,:W)1+YHQQOIAGNG2WKIR4D9
Dim tmp5 As String '4-+LR:^58;?J5:1CC5MHI(=J6*@71YAK[4VN@])19W1IL++
tmp1 = f.txtSellerId 'FL]+)\:G\(ZV6X.*FJ<0YQIK^-):=PZG06(FN<S,PG9:T
tmp2 = f.txtAwsAccessKeyId 'F]LYNCAJ9D-\^RIPZ94;W=E1ALRBNOGCONQPT9H
tmp3 = f.txtSecretKey 'O+X+(@3TVW<>+?63<G[3K3ZU@3Z\S-N?0(5=RU*:,RY)
tmp4 = f.txtMarketPlaceId 'B?4,63TXDK2(J.A5^,MBQKS)TJM10KO]7P4A,XCU
tmp5 = f.txtAuthToken1 'U@ET+\DD20E(>LLTOW]DVW,/@)]BEG-*6@M]QA97@OR
f.txtSellerId = f.txtSellerId2 '[:>\)Y9KZJ:A4IUQ6*1^X>ORJ.](.;79Q-@
f.txtAwsAccessKeyId = f.txtAwsAccessKeyId2 '@1W1;YFO,VJ,F*D2^J=]P<C
f.txtSecretKey = f.txtSecretKey2 '+WE^2.3ZQJ73MPB18CE3T?M2UK>4>0AG*
f.txtMarketPlaceId = f.txtMarketPlaceId2 'Z-C\9Y9(ULD3*UU4B2WY5SI3\
f.txtAuthToken1 = f.txtAuthToken2 'LAF:G]JHF^X,B54\BNV<I>KDYMNW?C3P
f.txtSellerId2 = tmp1 'P3QORK);KZV46GJXG,(2C(@K/8^V6-@7ZBG;AKTKS:(>
f.txtAwsAccessKeyId2 = tmp2 '([F?S7MUDEZ>2?H@+0R/G,XBTSN>);I3BVZ-A,
f.txtSecretKey2 = tmp3 '6V^+T;:M,8?[,7R59;F4S]L1<50^09Y4<-<=:8\CL@1
f.txtMarketPlaceId2 = tmp4 '^]?6US+2ND21]7@*O1I60XNL9H3B*-SJ16(3]E@
f.txtAuthToken2 = tmp5 '6X1FE=[JC9]6DI8(=[K54.>5DI*9L<@7B\S22TE4BXM
Call show_MarketPlace(f) '/MD]>KCLN\97)W7L8WZ(J.X8G*X+,71B6P(EM,FHR
Call SaveMWSSettings '/Y9-(8=?R)=-^[+]W-IGK17-F1=TM=9F5J]H3KAR\T[O;
Call DosaveMwsSettings(f) 'HXZ4?,941(=PLJDN]8XJ<SI3K:0-C7]-DH:;[\F)
Call validateMwsSeller(True) 'ZOQ6*5J;S.Y8\SG<V/OG@)6IMAQ(+SOE?3-O.
End Sub 'ZL<[ZWAQ<^X@J:NIEMOK?:*+8HX^98M^@W=\B5-C0CS>N6C?ATI4[)=RV[
Sub DocmdOK_Click(f As UserForm) 'DK]*^8XZ^T*B4IBX++A<L9MV.MOM)YGY5
okayClicked = True 'THN@O:8@I613@L?52(S/P^7P,Z[NQ@Z6I;Z7PRK?HELRGSE
Call DosaveMwsSettings(f) '>[QIVKXP5=+.>-KK9.E8H[>Z2(\99[?>PTGU/ZJL
Call DosaveSelected(f) 'B-]VNVK71=BMDT^^:B[C]:8XQDC;9.(/8;(21VC/>1C
End Sub 'QZ;E\=[\@[@2LV9)^DK5)LK71Q2A6NW6QVYXT0R-\LN8R1EX[3)RB6,580
Sub DocmdReset_Click(f As UserForm) '31=)2OA[9\./E/@Y:RK02FF(19=;UB
If MsgBox("Are you sure you want to reset the selected fields to the default selection?", vbYesNo, "Save Settings") = vbYes Then
okayClicked = False 'ZQ21SXRU[B.I=^3KHJSQ]P)BHJ>E6?T4R9]=@(.BS?VTKI
rgListBox_Right = "ASIN," & "Title," & "Number Of Items," & "Sales Rank Category," & "Sales Rank," & "Condition - New BuyBox," & "Landed Price - New BuyBox," & "Lowest Offer NEW MFN - Landed Price," & "Lowest Offer NEW FBA - Landed Price," & "Listing Price - New BuyBox," & "New Offers," & "Image URL," & "Total Offers," & "Referral Fee"
rgListBox_Left = "Author," & "Belongs To Requester - New BuyBox," & "Belongs To Requester - Used BuyBox," & "Brand," & "Binding," & "Condition - Used BuyBox," & "Currency Code," & "Edition," & "IsEligibleForTradeIn," & "Item Dimensions Height," & "Item Dimensions Height Units," & "Item Dimensions Length," & "Item Dimensions Length Units," & "Item Dimensions Weight," & "Item Dimensions Weight Units," & "Item Dimensions Width," & "Item Dimensions Width Units," & "Label," & "Landed Price - Used BuyBox," & "Listing Price - Used BuyBox," & "Lowest Offer NEW FBA - Price," & "Lowest Offer NEW FBA - Shipping Price," & "Lowest Offer NEW MFN - Price,"
rgListBox_Left = rgListBox_Left & "Lowest Offer NEW MFN - Shipping Price," & "Lowest Offer USED FBA - Landed Price," & "Lowest Offer USED FBA - Price," & "Lowest Offer USED FBA - Shipping Price," & "Lowest Offer USED MFN - Landed Price," & "Lowest Offer USED MFN - Price," & "Lowest Offer USED MFN - Shipping Price," & "Manufacturer," & "Number Of Pages," & "Package Dimensions Height," & "Package Dimensions Height Units," & "Package Dimensions Length," & "Package Dimensions Length Units," & "Package Dimensions Weight," & "Package Dimensions Weight Units," & "Package Dimensions Width," & "Package Dimensions Width Units," & "Product Group," & "Product Type Name," & "Publication Date," & "Publisher,"
rgListBox_Left = rgListBox_Left & "Shipping Price - New BuyBox," & "Shipping Price - Used BuyBox," & "Studio," & "Subcondition - New BuyBox," & "Subcondition - Used BuyBox," & "Used Offers," & "Total Fees," & "FBA Fees," & "Per Item Fee," & "Variable Closing Fee,"
SaveSettings ']76C@0.V[7/V/@H]HW:\3C++4GMU18/W3[2+S)S[<Z@8HEZ/G>3R?
f.ListBoxRight.Clear 'V]\IMD:D+6HGN4=:4A@3QS*Z<\R4-[HY+@)TUYRE)<<]9
f.ListBoxLeft.Clear '=(=PH-6TGV1]ON^IP+VA4PMN?F3:3B]M<JW70XIY^AQ[F^
Dim lbtarget As MSForms.ListBox '=/^YGD9N,C^(E;+/44WQF)@6HE<D+JOSA\
Dim r As Long '*G1EWP(4?CML.O>MO/N9C)J[I\9RRWND-@F=7KT7(I[3CHW)C@Y<
Set lbtarget = f.ListBoxLeft 'KIZX]J-WNN:]2*,JO3Q@,]*-OCDRNP>E=)O1]
With lbtarget 'GPK+^G\XD;XH4)HBQ-NFL278.*;I\C6/R,MRA@F@U?D,K-?YR03]
.Clear ':\]+>P,NP/UV>//6:\.16?/.XF]059B?8T5O[DHF(X\5R48CEMX^DM<=^=]
.List = Split(rgListBox_Left, ",") '5E-]X(R]1F.3Q*+8[A8C\V3YHH/T*^T
For r = .ListCount - 1 To 0 Step -1 '@X8;V=WIM>A(^1B=ZAGBRR;8.L1F7?
If .List(r, 0) = "" Then 'U=-^QTHG-O9;,*Q)@/4G^-L>;K;K(Y2LFL(*0Z6C?
.RemoveItem r 'E/,3;)G?V<<W9TTDK3H=IY.<8+-9(AD<0@PEE*X@[EBHV,=D>MY>
End If 'G^*=H0*,CJ9BYXBDHVS2]G2BU,N33CY<LEVLM(,5>T(MH)A:Q8DTPDHL8NO
Next r 'SO?CET7ORO(B]*G?AVH98(8[AOX90<\2CK:LAT)5Y7G\(DAU](]JWM/SO@+
End With '>*UW94X20C*+K\+0:;OSOATERO,WI-L3>6I7P]OCUOHS@H)KQ?D8C51;F
Set lbtarget = f.ListBoxRight '\@:^UX34U\XKBC,WCIBSS[1UG+HB](I,F9PS
With lbtarget 'E*5\ELS9J).=E2*FIGAT=NUQP@GUW<+TZ?EMIRID1[MWK4Y13=.H
.Clear 'DP()>0P0?5834+;S@W[?OOJW190A)+0ZC=13[:VV2<I57C5B8F,5BT/(OQL
.List = Split(rgListBox_Right, ",") 'U2/@C+-(HI/^IZ<,6>V0Q)]-7Q.US9
For r = .ListCount - 1 To 0 Step -1 'V(J0A^AEP/BB7G+5I](,:>^E)=7:Y1
If .List(r, 0) = "" Then 'Y15RIPN6V6PF)OEX,O:>*?L7+N)WICK6XAG.GY*HQ
.RemoveItem r 'DRO4=Q7>H3*X^T02E)0<LV5O+HBTE-@S8,(T:T?Y4^OY\W/R4K-+
End If '(G;8B^TYY7CE:<:W(F9E:R@/Z2^9)*,;5N>Q8)275ZI-V//84=>COO4[,]R
Next r '5UGQ1D;/+Z3N8MQWM38)(^(*V*:QNOV\7N]C,8>M5[A[HZQJ^@49ZZ7*8<8
End With '3\WAL3E@[]WR3KD+Y2>*.2H4P31T<=H[Z241*F+.35N@Q8N+6)+F4]]\]
End If ')K=8<193W:79S]4+YSK;G:CJG5>7OR08,G:35O;.XYI1L+Z03*6AFMQ-G(Q
End Sub 'LQ=2<+?@J;H+XH.]U^=]HDH82BX41=P5O1>6LE[.-G+9^LL.1M4PC8TZ<L
Sub DoUserForm_Initialize(f As UserForm) '\X17DY;9XH7Y?90=VM@DR8NKX
Dim lbtarget As MSForms.ListBox 'XVI^P^0L2HTE5HG4>FF^8PQ<AA+5LKE^-J
Dim rngSource1 As Range 'YM42XP:9B:I@<)RH>P78ORI9V\D?=1Q>K\YEPGI^U.
Dim rngSource2 As Range '@6Q1/L7F9B)-KSBTE?^5DR2,]XSPXQH<-[Q,M:89D<
Dim r As Long 'N0W-6?@DP^\JR(RV?:-,:08W-O8[YF@V>LBY[1U@U1+5+QQ529>@
f.MultiPage1.Value = 0 '([<>@7H1).IQJIC4^:+CFU9UD71U0L<D@WPRW8H[AKB
okayClicked = True 'Q\;:=^TJR6\E67IL\;2S2*9-8VR>L3FP\M74K>[-TRH-+>N
GetAllRegSettings 'RU-1MK50M[L6HX0.4CZ4(01ZL5.T4.[5>9:5^)-ELQ(U^8\C
f.txtSellerId = rgSellerId1 'P2;\SJCALY3^@UV^[)>)WAVW16C^QV[785[]?J
f.txtAwsAccessKeyId = rgAwsAccessKeyId1 '+W6RE0?=HD,B>WT:*N;QTJ64,(
f.txtSecretKey = rgSecretKey1 '2L(XZG/.K4[L=-8]H@NI:FM,Y-?ZF^J^@/Q,
f.txtMarketPlaceId = rgMarketPlaceId1 'G4A9D9LEP:SUXY7.0)<GRF[QTT3^
f.txtAuthToken1 = rgAuthToken1 '^<RA=BN,D9T,TT>784N^PKF<+FH;-NEFG9U
f.txtSellerId2 = rgSellerId2 '-=5L](XF*M>H;YL:Y/F*QQ8486O=LN\6J?8^B
f.txtAwsAccessKeyId2 = rgAwsAccessKeyId2 '*ULA:6G<]KY5-6;2CF2T?JIYI
f.txtSecretKey2 = rgSecretKey2 'B22*6\X9TJ2FTM.XR2K=4/0^5U+C5HPY^NH
f.txtMarketPlaceId2 = rgMarketPlaceId2 '/VU[1U[V,;R6::PRM[@@C3PEI(+
f.txtAuthToken2 = rgAuthToken2 '(+[TI5I7^[4N3,MZ)=M>=/4M(3?*7C@E?@T
f.cboMarketPlace1.AddItem "amazon.com" 'ZU*???.X1)(?1>ZQ<GB4O>CREUW
f.cboMarketPlace1.AddItem "amazon.co.uk" 'I>4O5\?T3E>^F0[FNEI6KP/F;
f.cboMarketPlace1.AddItem "amazon.de" '2G3M(\P8O9BT6UQT+9V^:0FGU5Y\
f.cboMarketPlace1.AddItem "amazon.fr" '<\DD?+DVNQ5H]LFMR9P\[3/SG,8/
f.cboMarketPlace1.AddItem "amazon.it" '?5C74L)P.HP5VR:7@3G3*H2:(V3-
f.cboMarketPlace1.AddItem "amazon.es" '+X+92]U7TU;K-*OT25W?=KZNBZOP
f.cboMarketPlace1.AddItem "amazon.com.mx" 'WVQ/HH(16=7D,TS*H18)>NYN
f.cboMarketPlace1.AddItem "amazon.ca" 'LL[[B=?LR17PY*4C-73M@S;?ZJ:;
f.cboMarketPlace1.AddItem "amazon.in" '*G7(3HY<JXC54UWVFOW0(>N+41BW
f.cboMarketPlace1.AddItem "amazon.jp" '-Y+F(++;B1;RJ^EI31>)//DZ(/\K
f.cboMarketPlace1.AddItem "amazon.cn" '6YX[J1/*X];W3PZTS,V<<UEZ17RH
f.cboMarketPlace2.AddItem "amazon.com" 'LN6E^8*Q]O)?=>:AH/:.WZF0[7V
f.cboMarketPlace2.AddItem "amazon.co.uk" 'EN555;2Y^75D*LK]-F(XHP[+:
f.cboMarketPlace2.AddItem "amazon.de" 'B:11MO:)4)[ZLIO43Z2V<CB*T>93
f.cboMarketPlace2.AddItem "amazon.fr" '6QWBV7RDE[WA;SI<>D^[[F=B8R^-
f.cboMarketPlace2.AddItem "amazon.it" '/S.VA;[44O1P3FKG-RB[P*>0:N74
f.cboMarketPlace2.AddItem "amazon.es" '1P<,+(V)@A\EF>GLH:^(*RE0@67@
f.cboMarketPlace2.AddItem "amazon.com.mx" 'X,<?CTIRFD16UXW,[*-F8Y[(
f.cboMarketPlace2.AddItem "amazon.ca" '1:G;<?@CX>6+B\Q;G[2-:ZMJ,*H:
f.cboMarketPlace2.AddItem "amazon.in" 'QX79?LM3RWOB16W2OQ8@B/<R36<T
f.cboMarketPlace2.AddItem "amazon.jp" 'O(-IEHAC93Z>)+O0CK1>/V?8R8@C
f.cboMarketPlace2.AddItem "amazon.cn" 'C]A(4.9U]N=:;Y\;?M^CD*18>Q09
Call show_MarketPlace(f) '5?-T399TG<W1J.:)E6DSH56NNQHE^J\OV+XC,[RC<
If Trim(rgLicenseKey & vbNullString) <> vbNullString Then 'EW?E<::,
If validLicense(rgLicenseKey, rgHardKey) = True Then ',Z23)JK;=C?+;
f.txtAddinLicenseKey.Value = rgLicenseKey 'KL,LX\@*A4VE4G56G8,]*9X.
f.btnDeactivate.Enabled = True '<C@*M@=7+67S0=Z-[333[@,/NQGKBN,73U*
f.btnActivate.Enabled = False 'UU3@3?=*/PHC[^^]Q1TM?*R4OI^,TM+:[U8R
f.txtAddinLicenseKey.Enabled = False '7T8P.J0IDM<(BI?F[/BT,5T+UP=?J
Else '];,9AT0\9;C2(;G(M1X3(J>,3W>5@56V9PP\S8=.0S:;CV0414-7J;GJE]SX/
f.txtAddinLicenseKey.Value = Empty '@4C()+H8LO/=ACE2:1UGI;A9P7-A9MS
rgLicenseKey = "" '8N)JJ[].=.5*IQNZCTNPY3Q^2F@(.)DF4H<L8CEL-^NF@0UG
rgHardKey = "" 'QT88E(0FIDQNEZ9\3S2(/)SGQDD,7\7SH.X\</^?N02<J7284NI
f.btnDeactivate.Enabled = False '<):A(^YGD5+FEKWEM,,C0V@IC.*WOL,+I[
f.btnActivate.Enabled = True '[W9X7Y)@VXD*)AC.^<L2<MJZF:75\.3ZRFG,Q
f.txtAddinLicenseKey.Enabled = True ':-WGY0JO9GI96XF.4.KIGTLHQ/9]V@
End If 'S;QM/\/2[XLX2;OE1\LQE[RGWX7-9MNJGF>X,C?CA[HT6GVXWFQQNY>]O+C
Else 'U;<OS\8\;T?QMY.-I=1L)+CQQ-(QDXOJ1<1S8>-1YD5GBTG034I>H\/-,.^K2
rgLicenseKey = "" '+?T=]TD)+^^S?/*7.MS8KM4VMM0H/D9:=HUXU9O.HW[;I]<V
rgHardKey = "" ',90BQ.N8++=ZD)MKOG(*D9F@IH8I,>>ZBARD[JVUNGO=OIATQYN
f.txtAddinLicenseKey.Enabled = True '6BMA4*Y?NPMKIJB+0W@GO1UMUPP=G-
End If '1:JM1@7[ZV:6Q04;;XQYE-]V7A7\(:XR(8<D:SKGP1+\[ST20FC>XF1HY*;
If rgFormatOutput <> "True" And rgFormatOutput <> "False" Then '9IK
f.cBoxFormat.Value = False 'A;Q*MA?2V4D.Y(N4Q)0JGYS/+FPY110(^K5?T,C
Else 'F5?D+RVG7=HQH,RLUTI;9U<Z>=;22I9Q<G]7HUV^OZ<>Q72>GBPC9D-6OB*4U
f.cBoxFormat.Value = rgFormatOutput 'LI5XF4V*E3;=.W@6;VN3MM,I\ELJW5
End If 'K?Q[:(:C)1=WE()V9PY?4;3.CQRG)O=;[EH*5J=H^EFU>+W=BUXNOWQ;0K>
f.cBoxShowBrowser.Value = False 'AC;J6,[,@2ZBE8M0Y<0Y=\DR3C3]*\4+DF
Set lbtarget = f.ListBoxLeft '-5FXQAF^5U9EAZ*KEL(9*P:\>,1*L\W6=\LNW
With lbtarget 'AUDA7TD]E+[:XZ\Q:JV93H@68P+F:0BGO]<1@DS[9O,N<MX9LNEK
.Clear 'F133T;2W1E,.]U=]>NCP\R9<(^Y6OVC05)Y8)5V(D4W7]15TP49,C;((]?E
.List = Split(rgListBox_Left, ",") 'S:WII;FIPZ>T1OT8O8U;LAD\(.QWM50
For r = .ListCount - 1 To 0 Step -1 'WM<80FLTQOF4?0.0[X<=DG:LCA<L;B
If .List(r, 0) = "" Then 'J0[O?U\S(R3\^QP04Q[8VYMRFNR5,BFT(-Q6PXNOS
.RemoveItem r 'B;K5E,-8<SI0VAEWKLAI]55*M6\XB3?O=AW+K^KRG9HC]L5JDCI7
End If '0+Z*5WI[W;5WTB.Q[,PV^,@((U04FTD<IC43=AGMLU7?+WHD]XIC7?TKQG^
Next r '0YFL(0DN:.-Z*.\WU./(I?F11QO9(MW>D-+L;-Y^+(.O+TMCKH)F@CH.,PI
End With '*S:Q\V[SI[NJ\E7.,MEAY[X7.CUW?GSM((60/4*M3;XW[G4+SS>2NFYI(
Set lbtarget = f.ListBoxRight 'O50CW>/=]..619?ZLOZK/E^(C;^UU6PAH5:;
With lbtarget '/7]\@J8-W+5V63]?B[Y>?SF.IGECS6[+^2Y3J:BL)-I9,*G361BT
.Clear '*11Q-Y?RVF2MZ0/Y?EF/@@*1*VFP8CJPSQ\P0O+K+D?H7VM7.Y/9(;F^CP1
.List = Split(rgListBox_Right, ",") 'P^JJ?8Q@LWGL3W[T9.HM?Z.K1V^8O,
For r = .ListCount - 1 To 0 Step -1 '?PER)CU3\3=QX*>=1W0VZA(I*4L+JX
If .List(r, 0) = "" Then ';0U*:HGQE5+2TW-LUTL/2AIS)XVOENJ(+2.\7P4HF
.RemoveItem r '\/624OI5*?+:QKJ4G)>?EK2>T?6/)SAX(CG.STV[QYU@.BBHGLC0
End If '+651IYL-JQLRUQ1(,7U?X(FXZX44(DT24SDL6J>+/---(ORP<+D9@JQ-RS+
Next r 'YFRG]SYW=(47/^WW3GYHN:19,K0[UY2M3+]W?>1NWHBBNVP\QC@\GU@:M]T
End With 'X,L\]CIX-J\VEM\I2(<?OLT.[9.I@58EDM<;3@Q<UOP:E.4*3,S:H;Z9P
End Sub 'A4:(A?CHU7:*QR8-^2RN<NJ7C\1[W-8-)]W73C74^CB4<F*K(4FTPF4+<N
Sub DosaveSelected(f As UserForm) '=6R1MNZIYG[WB23X5KU;]1;Q/ZJHZZZ-
Dim lItem As Long '>:88)<NSV9VKCYVP8L;-U>50N[D]DZAU40[-E)/8R1@<TBD<
Dim bSelected As Boolean '/9:DC@KZK5R07=9P*W[+Q\5I)I(9/XM3*M(9PV*ST
Dim lRow As Long '26D(ST+.9U?]5\G2Y6-E;I5UF24*O>I[(Z6K9)0JE.VZXKTGD
Dim lRows As Long 'Q)X\T4>76Q@DV=DH)Z-JQ@LVO(WQL>0J,7A3*=5L?7SQ3^L:
lRows = f.ListBoxRight.ListCount - 1 ':X>NQQBJYV].T4OB.=7XX>CHW9;C^
If f.ListBoxRight.ListCount > 0 Then '-2K7UC?*A,DD/*ZLP9/0.ZA/I:L;V
bSelected = True '@0SG9:0)G[A(,4?P8FLK(DZT]CDI0D)H[16ITWB7-?TC,T\@:
Else 'P564-BWQY3=6>TF/VH1HUQF2+8=B/EK)ND]FXZ,>Z1I:^M+7AC/Q3,313A.JG
MsgBox ("You must select at least 1 field"), vbCritical 'DJXDS/AEK)
Exit Sub 'M]Q>LMX?H1[+D)HIM@Z-(<LN**G<[T4ST-Y=:MTWH5FO**T3))9B0-)Z7
End If ':WRLHR6P[/.L^R0(VW.JN?7SF)8D5LA*Q*^UJ]MBV0V.R*>(A+;<.06>Y::
If bSelected = True Then 'J;J?=W*L>Y](?(?F2S.KN*3*U^J4.RD.Z3[[JXP9;
rgListBox_Right = "" '<DHF-9@@864C2RAO(//O4*[ZX@W)5JWMLEZ?S9<\X47DD
For lItem = 0 To lRows 'C7TDNQ@P[D\(((KONMNOHFGV3^RY3MTP/Z;K-.L+[I?
lRow = lRow + 1 '2OYDU<C5:)514BN@N?^D[MIP@^B+WR:0U;7E7:F4T4P>>9\A@Y
If rgListBox_Right = "" Then 'Y/GYBTE>+Y+QE4]FSSIUJM*A-7>0(QD>NOXV^
rgListBox_Right = f.ListBoxRight.List(lItem) 'L-GRDNOZJ[ABPAAWNGC+F
Else 'XR6(]PXWL.DOZ/>G*[V)F\:4=CP(4HYB1];HKC;1@M.,8G=P:S.O+TISDMK-I
rgListBox_Right = rgListBox_Right & "," & f.ListBoxRight.List(lItem) '
End If 'R)JOY?>JL^@M:N8A5@UN89>IU+:IPXF0O@KWZ/\\OJ.ZUFN7KJ3XRT60WY)
Next '>SZ9O(*VOE0L)EH<1EGT[4RD(I-@X5HX(YWL/8AK)8P>8-S2F[Q+SV<A,PLV<
lRows = f.ListBoxLeft.ListCount - 1 ',\G.M-?Z?IWZVB7Z555:6I.2J]XC/D
rgListBox_Left = "" '7-:4PXZ15K\7@GR1[\;DY7(X(GCHH\4]\DST.:Q)IVHJK>
For lItem = 0 To lRows '9^O1-[6N:*L@AW\NLH(*51IE0CG)X(3VA<+OVEUUB(H
lRow = lRow + 1 'MB:<1^2,H?ZY65<3O*M:BILK^Z;UTKY:+NE604]4MJ^OP*5K4^
If rgListBox_Left = "" Then '9>M,B)XRZ?MF4N@LSDPTIMPP=VZ5WK.4>SJ.SP
rgListBox_Left = f.ListBoxLeft.List(lItem) 'W60@+:+@)R]9(<R8)K8,XP:
Else 'QYG3BJX\A2\S,57EW)RT,F\:G.>LS0C^1/;:PZ\[T2QX5:4^J;Z\Z1HQ70Q5.
rgListBox_Left = rgListBox_Left & "," & f.ListBoxLeft.List(lItem) '
End If 'A9\GB2USO0+RTX,?\;1[>=0X3<7E7.<FL/4I\+2K3=0/W=IK^:,LXZOQS(8
Next '>JUJ02)KF^TZ->K::II][:*1-YDE^C(=PN>=:31B/W9\8\HVNL[L^Y21X8+GR
rgFormatOutput = f.cBoxFormat.Value 'E6+-9P<0?OLU.U/4EUG\FDF*F\,5UO
SaveSettings '<KQP<C[6OU.EWT,/R0^N=J][>J(\97,UKHGCCTYP67?GN8GU2:2\2
Unload f 'TYRMGDFNNR,E3D9HX/OZOE,7=?ZJ2TOL(RSSPB24TBX<(12DHIFLIABMA
Else '^>QFGD^9,LQM5Q.).H>\8DB<608,(DH;(:\]5L.<NK=.[LBL^HE3GA9\=3SER
MsgBox ("You must select at least 1 field"), vbCritical '?RA;7?,\7/
End If 'ZIAIMRT:E@;1K>VW@L7.:<:LJX]HP40OMO^BOU.Y<=0VFZJH-5(D=C+/=0>
End Sub 'C^7*\-T4BH<J4W=>O,WRCAP6ZT5C21K(T*0?)@3RMEV4=>A[R^Q1*@WPXF
Sub DosortList(f As UserForm) 'X@V83/*+)J*(H]/IG[L)BX+<//]]G=Q-+J0S
Dim arrItems As Variant '*C?4VY0EM8D-8R6BE0+BE9:M3W9.Z^@=?OVX/.39E.
Dim arrTemp As Variant '?/XN.;ILX8:)AQHLFR(7:S*-@)\U,Z0W=+KN/8VOE[E
Dim intOuter As Long '6XMN02(453?S<KY98F9X<4XOB9LB47=O@\GQWCUF*D?-I
Dim intInner As Long 'T=U+1-GHKXW(OTV];HO[\EXSMQ7L[H0*.?T)MAS^:-9;K
With f.ListBoxLeft '60<@S]Z^OLLIKP/=YD<1A>8W10O[3E81R8\N)4:6:FTOMK<
arrItems = .List '0WS+FR-?[JTILW)=3LDF/[V=:CVFIH/3;E-5KK(\AF=S6DNCK
For intOuter = LBound(arrItems, 1) To UBound(arrItems, 1) 'R69VLIG>
For intInner = intOuter + 1 To UBound(arrItems, 1) '^JB-:6W<HGVQEGF
If arrItems(intOuter, 0) > arrItems(intInner, 0) Then 'SRH7DS1XY<EN
arrTemp = arrItems(intOuter, 0) '(T4@H2,:YH/H.74*RF(-OGIGH7OW8RJ7YP
arrItems(intOuter, 0) = arrItems(intInner, 0) '*-[8T(]7U8:P/LE?AS0\
arrItems(intInner, 0) = arrTemp '9K/LOI\=;D(^<6TX.]W8@HFW)96:.KHKG@
End If '5ZYM)*5L7]NZ]TLOF9O)D]7,?5M@[6>12EN4E/06<]YF6<R-<XV6-@36[H(
Next intInner 'HXK3XZ+G.BV0XYO6IZ=>(>\TQFO.4.48V)BY84B@7N^2:YH+(4VW
Next intOuter 'Q8FQ3RR>E2CCMVOK,9<F[3K6CRBEQ/7H7H+/?0E=N=UO=F+5?SAU
.Clear 'G9[DJ-)+OZHL:.+6J*\N6H75BU5C=15LJE+P0[4:72Y?+[IHV]K<-L=XDS-
For intOuter = LBound(arrItems, 1) To UBound(arrItems, 1) 'VWKR2XNC
.AddItem arrItems(intOuter, 0) 'G?CB<XS+M2A@GI-[]]I^<:)CW)N?=SPJ46E
Next intOuter '=UECML^?=9]X(TM>L=P4FYV4UEP9CU4,RON@D0M[*OOY1GI,?PLC
End With ':]I*[.P8DD2/L;+G=>F;@/X0(XDV?AJ57XQ(R:UM7E:010P8YM5V::MF9
End Sub 'D7DP[LN>D?,=?>9EK^0>,L8P2EA0A7N9H6^-DY+.\<CC-A^XCO(P>TGU-3
Sub DoUserForm_Terminate(f As UserForm) 'Z2VB^F1<R,=M7<0K[/^(BX[\>Z
If okayClicked = False Then '[</*=,+@(3,BZIMAUD5-1\U*H85II8?XI,\Y)K
If MsgBox("Do you want to save the settings?", vbYesNo, "Save Settings") = vbYes Then '
Call DocmdOK_Click(f) 'E?Q0H7=)ZROSJY[LJ1B..;1J5:>L,4X+RT9=-0IV+B,2
End If '3J.0C8R=AL0*2DMFQQ@+,L>:+ED**A81=@JQ<MLP;039/D37J.ARP7L3C)N
End If '\HKDY/*CQHZ@CR;<8*Y\)DN.0K]AR]O<\,K\8]?GTB,A[+OEXXEK6]YWUT[
okayClicked = False 'EL,SCQ-15/9KQ3L4@Z:,C0N]0@8*EQ4WEPMJ*^SR=WOL+2
End Sub ',JP0V<GLFUW(^86JYA7:\1]0+<]C+AMH?SL^?==J>^0V>9<S\IZ11;X\*9
Sub DosaveMwsSettings(f As UserForm) '9A+XE>OM/ZBSWXC9LC\=GK^][A.2O
On Error Resume Next 'K^XT^DY4EQVQ25.[[A<JL]*;CP3N1WK1Q@//IN.3I<@IF
rgSellerId1 = f.txtSellerId ';?HT.SK?3[2-KIF-I^RJJ?9MPE[22<)@5(YM57
rgAwsAccessKeyId1 = f.txtAwsAccessKeyId '<\BD801W6I.8<2V*I=W=HF4([4
rgSecretKey1 = f.txtSecretKey '9Y0S>U)D@?;?5EML-KJ5>T-2OQ]PV8VX<]0/
rgMarketPlaceId1 = get_MarketPlace(f.cboMarketPlace1.Value) '7(9W,<
rgAuthToken1 = f.txtAuthToken1 '>PF(9^0=WC8]5:42XNI(S.+L))OTB90SW=C
rgSellerId2 = f.txtSellerId2 'Q^UEYSUH^.></:+YA[R=:H/?(>A>>=6/45[L7
rgAwsAccessKeyId2 = f.txtAwsAccessKeyId2 ':+X3RKO*>A;8DSJYI1QXU5MYH
rgSecretKey2 = f.txtSecretKey2 '\[JE+,\E7(GFT\CWX\)W;8\CEZ)U22J((^Q
rgMarketPlaceId2 = get_MarketPlace(f.cboMarketPlace2.Value) 'PF>9Y7
rgAuthToken2 = f.txtAuthToken2 'ES^/C6U5G*JDXW16Y<2Q*;3^J^EL[>C7LH)
SaveMWSSettings 'ZY89(;\?G16F:P8AS,:AS8;F35.L)F.7JN,62KI\H:(?:WC0VA
End Sub 'Y>2G35RWC,<(GJO9Q[>LTUU;+=D>RVI]UKJ*HOB<+0TP6]<:X1YE./.SZ1
Sub DoClearMWS_Click(f As UserForm) 'R;9C099-[D@ST<OM15>*193QYWN3\I
rgSellerId1 = "" 'F=.1CGVC:WYXUQ7J+U]1TIU5)]V/SHGC7MW.0-R..DU:Q(;[I
rgAwsAccessKeyId1 = "" 'H:8*<8RP.S9;RIR>GH+4<MEQ0CNJT)^D-A^P]GU(*(S
rgSecretKey1 = "" '^DJBTQ/HS2W?BT8E+FWULK1<U^TE8[06*.ELERFY2.W/3-\^
rgMarketPlaceId1 = "" 'RB3JZ,F;K>/,<Y+DM3C1]V=;-O6EB1>Y8054-O^Z?LE;
rgAuthToken1 = "" '+^A?W5\C4GX2^+:8D17]5/5N>R1P/9FJIRW(L12RD@*8S9L-
rgSellerId2 = "" ')R+KP9QVA@L=8OQI=CBCRE1>>NN]F*D/:)UMF*^RS29VN6ZUJ
rgAwsAccessKeyId2 = "" '/\7,Q8T*GZ+63@<W^D2GL=*XB\IQ>V2<J*79=>EOZRT
rgSecretKey2 = "" 'B<H@V=A;TO.JBE>T(^0E7^^W]*IVTH,7+;E\9-^RDGEE5LQI
rgMarketPlaceId2 = "" 'M*]=[JAA=D;;4M+ZPVM\7C,UH*=846GE@)8E.51J*,(:
rgAuthToken2 = "" 'BJ4FQ9(^6=2FFW(ECI4R?6328B;N7:N2A+WY\(/()TZ?QW7Z
f.txtSellerId = "" 'T9C6P[NO>/O./6D70^5ME>KS=?)I<A4;:6)F7.L5H2NHA2-
f.txtAwsAccessKeyId = "" 'E+N:98>2(IHDFP;10E<+WAK784=9MQ*T+?V1XC;UN
f.txtSecretKey = "" 'I3T@31[;Y)TG]^NZ0W[Z:1R;9A<<,Z)H..RE+3)?I/P+L8
f.txtMarketPlaceId = "" 'B)(?C]?G(S*M]7T(BIA;X;LO(GB-L=XH@JOKNQXQU/
f.cboMarketPlace1.Value = "" ',;=J/</=/P-A1*/MX2/IF/SD?YCC9[JW=BVP7
f.txtAuthToken1 = "" 'H0K7^5N9>DD6NC6,7\GE-/=5O?>QM0A.7K<B7IW/1J[LD
f.txtSellerId2 = "" 'RM<:T\L4]5R6)S4Y@RVM>1ZT-+H)1)>HFW;P?CW0F69UQ8
f.txtAwsAccessKeyId2 = "" '5F>LV-]OPH;4COUA-87S5MZP4F+5\Q@;2J>\*:PY
f.txtSecretKey2 = "" 'E>*:*J<C1?G;GO@RCF=VYW1FRCW+O?^+R<+<CA4X893M^
f.txtMarketPlaceId2 = "" '>33NKKFR8?7NC32I047^1[-XPS/8+6L*09PC-U?\:
f.cboMarketPlace2.Value = "" '??].]CRWH?)8(2S^.HUHC*SVDW[VADXG\;MHR
f.txtAuthToken2 = "" 'XM@U^:R1:?>VTT((N5M=M41S-85^C>9Q:L>3-71=@R:.S
SaveMWSSettings 'GJ[9.*M3<WS;J2Q]JZM/=(BT>.^(\>G3UIT0/;JPGS@3K:QL?V
End Sub '\;^K>L3TT./?^SW;3;KUE89>3=^YD9UTSO6XJ8>Y@?JU4KA+GSS*Y-2/*N
Sub show_MarketPlace(f As UserForm) '7*I*55T0YF>0U3<IM8:4HE)<S7*QB]
f.cboMarketPlace1.Value = get_MarketPlace(f.txtMarketPlaceId.Value) '
f.cboMarketPlace2.Value = get_MarketPlace(f.txtMarketPlaceId2.Value) '
End Sub 'II)P/]8*/F2N;F=QBG>OS8DX5@UXM(QG?JJ*];F^)KJ9S@3W@PNH^38X-5
Sub DoupdateMarketPlace1(f As UserForm) '5NL@-8D0;E+^MA\H999,:(.1Z-
f.txtMarketPlaceId.Value = get_MarketPlace(f.cboMarketPlace1.Value) '
End Sub 'A3D1SYM513JW1^4GZ?15HEP12VJ9H<,]PV:G2+2NZN\D85G8<-^4:3UC=I
Sub DoupdateMarketPlace2(f As UserForm) 'W]1OGLXA(L3OME8LBG(7K3XBUF
f.txtMarketPlaceId2.Value = get_MarketPlace(f.cboMarketPlace2.Value) '
End Sub 'PWXP]IG4,M<^G.F7@DFT=9@D=3AN=U^7>OL@PHP>BMSG9CFQDU,X3U0OXG
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SingleCalls"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Dim str_xml_from_api_comp As String '^2N^,HJ]]F)45ZM:\,J8V9B=\-*28Y
Dim str_xml_from_api_low As String 'DK=5)A*,7NIYIM,A7V7.T*K;75:F0@D
Dim str_xml_from_api_match As String '8+Q(S@:;N.AQA6\S*H[.=VG>4@TT^
Dim str_xml_from_api_fees As String 'O1,/K9-+4MZ.MM-7>/)XN8Q;F2]1V4
Function aazGetSingleFieldCompetitive(theField As String, ASIN As String) As Variant '
Dim xRows As Integer 'Q8S:=,IPV[L[9GZZ?;:G(34T\QSP@L*3B<TKAY(Y5*<O8
Dim DimComp1 As Long 'K9NCPXT+JJ>\/R3-9O8:A*5\ANEH6@26IGJO,VY]?N[3[
On Error GoTo err_skip 'L(U5(M(;]+11WKZO14YVU:JULTG**RD)\N*P+UC,6VZ
If IsEmpty(theField) Or IsNull(theField) Or theField = "" Or IsNull(ASIN) Or ASIN = "" Then '
aazGetSingleFieldCompetitive = CVErr(xlErrNA) 'TM:^TW:DYZG[BU+^]PD>
Application.ScreenUpdating = True 'O(+EY@3.?</A;]>J+=LG6Y/@-8A+MFWL
Application.DisplayStatusBar = True 'A:CL<.^ZK;;]@?\\9CV,SU[Y3/B*UG
Exit Function '^;>PCC:3GZ7\[;NV[EWBX:P6K^3SAGGE)V2LT0C7LU/OHGA4Y<3X
End If '/X0Z9QG[P=57T+U/U@A]3\<=[,52@2<NC?I=I\UI>9ISD7+LDM]Y2L3[..=
If goodLicKey = False Then 'IWK1S5,<SI*F6=77)A7WS]L6.CNCLC2(EV@F.TS
Application.ScreenUpdating = True '<+GQSZ[16LHQ.D]*9^I0+QGSSS[D=TK8
Application.DisplayStatusBar = True '.RQ)OC;*>=W1;\:E//A<4;F*DRPF/Q
Exit Function 'G2]G,.+(,EQ:,RK.G/<U.N4UO:2B:].FR)2UL9H*[\D^7N8Y(=[/
End If 'E:I(F@.05/[3W6WU0.6W>?;ZOD=-@SC3*@@^,;TQA>=2\SU>(TC:LVL4ZAX
If ASIN <> Comp_data_asin Or Now() > DateAdd("s", Cache_Time_Out, Comp_data_time) Or str_xml_from_api_comp = "" Or str_xml_from_api_comp = const_err Then
str_xml_from_api_comp = build_do_api_call("GetCompetitivePricingForASIN", ASIN, 0, "") '
If str_xml_from_api_comp <> const_err Then 'A(\SZK4JQ<MH)44VV8MOO:X
Comp_data_asin = ASIN '9F70)\O/=0C[\STNUZ@W6(//P)*Q+UN)WR\,9NAZ,(.G
Comp_data_time = Now() 'T65W6CUBG9E0<N3(G.2?9.S4C+H,=:<7?E)KA2ZP1A8
End If ')MF=OP>,0/5SON0CCV@K6/)RB^2=KQA0VZY5JNC^*NXR(+92VIW=.>SQPH=
End If ';=I-JR.^0(8(DW181DF?52)PC3([H+6[J)=Y\MUH+(][^GCXPY/?+6=(DEU
Erase Comp_data 'VZ@7CYX+,G(KT4K(]0WKCIK/W4Z35FWXXW?[R8)ID/LE?=,)*K
xRows = process_GetCompetitivePricing(str_xml_from_api_comp) 'PB>D5
If str_xml_from_api_comp <> const_err Then '@,62[<AIW9RJ6U0VQ7@;8M9
For DimComp1 = LBound(Comp_data) To LBound(Comp_data) + xRows - 1 '
If Comp_data(DimComp1, 0) = theField Then '7AXA/)0-,[D)JM:LQ?\D7T4J
If VarType(Comp_data(DimComp1, 1)) = vbSingle Or VarType(Comp_data(DimComp1, 1)) = vbDouble Or IsNumeric(Comp_data(DimComp1, 1)) Then
aazGetSingleFieldCompetitive = Round(Comp_data(DimComp1, 1), 3) ')D
Else '>)2D761XH;,XM,-78(4?AXOYDCQ=BLBUFB/U*XD3?:P,F[,S@J9=XO+;MKF8Y
aazGetSingleFieldCompetitive = Comp_data(DimComp1, 1) 'ZOKVB8=@A:G3
End If 'G:5)KH8SU[UNYGK<W+;^[8E[TR-H1\X=C+K2(Z.W^6@*70R8)K4<RT\VHVH
Exit For '<*@V(V,.^UNU;I^8,+Y)ZT.0>^V@85LB()SYG-D1K8XBWFLQ=/H1T3QQ,
End If 'V?+3]S(DW[9BE:]3G[@;PWFC.BJO;AZ<-:14X0HS*=ZU*7X6[0T440B:Q7:
Next DimComp1 '(XM320C\CXMG>.;PO)62)=CSE38X(Q3Y*MC,LGRK(GX/;>+X?A9]
Else 'M?E-](JJ7U8<VW5NRK>[+(U<Z0B<;YDP]/R<.M<215O3.OQ^:K;4S+)M5@Y9Y
aazGetSingleFieldCompetitive = CVErr(xlErrNA) 'RL+IV^K;AV3H7.H,,24Y
End If 'K)2^,*B;JS9QV1<;)T]1)W-:0TAQFV\YM02U*PFK7:0[:G<N,D==]623/]F
Call wait_some '?W^QQX689WD.=;6DGR7X;+U>NHS-+9=/H/(6EG2K(H^TZUK(/[6
Application.ScreenUpdating = True '8SL@HK6@<06(8S@EPN9;5C/C9-5N5UNO
Application.DisplayStatusBar = True ';:.F)GRMGBRU+E3ZN)S5SUA4-=?HC*
Exit Function '\9B0YV2EB+R4<X0P^SA,><?<>/-LRBW1\]HLRW+)JWQ2N/N9KGR.
err_skip: 'KX<98:)DI/VR]RSC9@[U7\<QY+AH=Z4D3Z.D@JYF;0\Y1DIR3H\85]OH
aazGetSingleFieldCompetitive = CVErr(xlErrNA) '2,)6F/J@7=]>LK/3I,8L
Application.ScreenUpdating = True '/?@RS/J=E3G6+G-3Y7BOK>0V6]I8G2OZ
Application.DisplayStatusBar = True '-RUZEY??8*[6\UHCX=*^)7LCQK-U0H
Exit Function 'KSIVN@?2BV3..Z5I28K+.\E\[07^3A0467+NH=N-IXXXG7*AS]1Q
End Function '[W+Q5MK4?HT9LIU7**-[TMFIY77-P5>*/D6EO\RX8G+QO?=@X?5EZ
Function aazGetSingleFieldLowestOffers(theField As String, ASIN As String) As Variant '
Dim xRows As Integer '1*/R9M:/H+S1DB4(RM[-*@3X-6+L-A/Q3;^T>WAIE3BRN
Dim DimComp1 As Long 'M>\Q^H91C-[09N:OLO9]H.RRTWOPT>B;<L8G*Y(<06-TZ
Dim zFix As Double '8[[1[L.M@3A\\,(5L>W@)O(Z][6LIN:NZPAN\U(Y*K@4D/D
On Error GoTo err_skip 'F6V280-^C++2W@PYSL<==YNES>7QH\.)JDJ4,4MQHH-
If IsEmpty(theField) Or IsNull(theField) Or theField = "" Or IsNull(ASIN) Or ASIN = "" Then '
aazGetSingleFieldLowestOffers = CVErr(xlErrNA) '.-OJ6130V3.Q;^(C1P?
Application.ScreenUpdating = True ')^3MB97B<1F@=JS,G)-\VS4H.I0X;VZB
Application.DisplayStatusBar = True '4>\)Z9G:M80=@96NX7WML[4]+4*KVR
Exit Function 'OKX*.JH2.G5)HI+0K5\3J74CBKG=:T3C82:AI)ZQV6GWI]QM8O7.
End If '<1/9^\(9=U=;)]/X9KLPK7-IKHK)L(17HB6UU:0XHF93<0]4Q[]8?@,<?01
If goodLicKey = False Then '8SO5:ZW?6*Z*17PCBF=3C>@?]S.622[Z--G3SFY
Application.ScreenUpdating = True 'RYRQP]]4;4([-M];.+NWUEQFCGS46+0N
Application.DisplayStatusBar = True '-N+@-6*YYKT[Y?9.I\+3K0T3-EG@/C
Exit Function '/0SPH=H,GN2^))9FPZX;+*@*,]Y6[0?S:3M[@B7/]OC[>04)OP-N
End If '6VS]UWWJB28A\321UNC^:G[W=N,/P5Q;L,O7G@F90[P)CO.]R]BRVFEB>)Z
If ASIN <> Low_Offer_data_asin Or Now() > DateAdd("s", Cache_Time_Out, Low_Offer_data_time) Or str_xml_from_api_low = "" Or str_xml_from_api_low = const_err Then
str_xml_from_api_low = build_do_api_call("GetLowestOfferListingsForASIN", ASIN, 0, "") '
If str_xml_from_api_low <> const_err Then ']0[VPZS)2RTH[FO?*E]2?K2-
Low_Offer_data_asin = ASIN 'G-H5HILJ[>+9B0XV5/?-,*E=L80MH70/])AX*/8
Low_Offer_data_time = Now() '-R@5IMOR4=,A,=J=[2AC+P41:7R2C;/TU]L4X8
End If '(*Q;U76?/-V)J+\T0,8PK^N@)D4SFFGM6DQ3Q.[X59J8SA(ZVTL0]3:NY*3
End If '?8+]9)WRCZ(1.]FQ\((WB[T[-(6Y?CE+2K)++P[.XD+H0U[PNE-NKFPSG?A
Erase Low_Offer_data 'HROLV)6<]+,;\F@WV[AM*D=)U*>B/8=CD1-VAOFAYPNH\
xRows = process_GetLowestOfferListingsForASIN(str_xml_from_api_low) '
If str_xml_from_api_low <> const_err Then ',C;ME49RK)O4>D0?F*YF;=X[
For DimComp1 = LBound(Low_Offer_data) To LBound(Low_Offer_data) + xRows - 1 '
If Low_Offer_data(DimComp1, 0) = theField Then '.?G930HYRMK-<F.EI<;
If VarType(Low_Offer_data(DimComp1, 1)) = vbSingle Or VarType(Low_Offer_data(DimComp1, 1)) = vbDouble Or IsNumeric(Low_Offer_data(DimComp1, 1)) Then
zFix = Low_Offer_data(DimComp1, 1) '>T+JX@4+)]]-9,)--Q405=0]..:MF:9
zFix = Round(zFix, 3) 'R>?2=F7+RIM>:AR>S]TV/73)N;S*KY:.B;8@+6X(LV5X
aazGetSingleFieldLowestOffers = zFix 'V8:A]IA,8>Y?JJ)-O4YP6AU6*50=B
Else '/N7VJF[@>RY(P-3?L]ZJ7LB:5R<0D\(Z?UW6Y0X@]=,>H6C0GW78[P.V<:U=(
aazGetSingleFieldLowestOffers = Low_Offer_data(DimComp1, 1) '/E>0QN
End If '.JZAQK=O3QU@0W^P9A(?6UKE*DST=1)P]ENG+O-T6LYRJ(TE)]K+LQ?E\]Y
Exit For 'D[3F)35-G:[-QALS1)]6VU0/:A;ALPX(XLIMJ=S3(K/.Q5]YL\WF0E602
End If '[K2?4S(K^EU.);]462*D.KVW*0JV=DD=@O4JQU)0R<Y5HT*K/8G<:O>YYYF
Next DimComp1 'S>KN>*C,O.I\Q6M@42.SEDI2-R.]^L0(KF/:,70)..X9+.T,<EM=
Else '(*A5P^GBKG]\?X:6H>\,>@Q0]KJ?PVWG(.\LY3I-B]+X07A\7,S)-PRAVH3B0
aazGetSingleFieldLowestOffers = CVErr(xlErrNA) '=R/@=@;8IM5-(>F(-X)
End If ';ZTH3-0^XQ@MFYYZ3*5MO5O8)2F/OMFUQ?)ECWZC^A1[A-=)+VR;\V0>BEC
Call wait_some ']/Q)K<G:JZK2.GO-/?FN=V.R)F9E)*M.B5E<@<9WT,,.DVA1^KI
Application.ScreenUpdating = True 'A9=J4@T-S^SPG\5A5JC6@;A0QS8>V27/
Application.DisplayStatusBar = True '9KSV=0=^<2B4=4<[8DNG[9<IT]V.UG
Exit Function 'YU0WV].\QWLVQ,M0.GR;;F[RJ?EK5+AGC;K.S[ON[4^OMNH)K=)B
err_skip: '93K)YH7W8X2-1\9+CHQT3X[A\I]Y6-BGR3DOXFOMF,SK;V5?XZ7M4T,6
aazGetSingleFieldLowestOffers = CVErr(xlErrNA) ';PWT>*P^QI?(L2[ZT>R
Application.ScreenUpdating = True 'D-,1:53?ZP<<^[OKEBQPU.DLM^ZO\)>J
Application.DisplayStatusBar = True 'ZZ;@Z<TWC?C7Z8Q8Q<*+Y^6>*05@9H
Exit Function 'FNIFKM1L2SWS?=>7P;*,H=>PIKZI)D398N\A]GVEXQV0BZQCDX[)
End Function '3QR/B/45]9[G]QKK93.+W>002^)(DFZS\.Y4ZNV9W9\C3]/OF2\,0
Function aazGetSingleFieldMatchingProd(theField As String, ASIN As String) As Variant '
Dim Dim1 As Long 'WHKZ78TSV=FV+T7Z70G=.+P87^ULI-L)3A790FHY,[4]92M(-
Dim Dim2 As Long 'A*BI02M<^G22U?WNT+9C6@4RKZ03^4?-@R<R+0R5\YE*DFN>/
On Error GoTo err_skip 'P[WMY^;DL-2UH+6(3YU7QECZ/M8Y73-MI>4:SU>RR0U
If IsEmpty(theField) Or IsNull(theField) Or theField = "" Or IsNull(ASIN) Or ASIN = "" Then '
aazGetSingleFieldMatchingProd = CVErr(xlErrNA) 'O\\2D:KZ110N6X4(XJE
Application.ScreenUpdating = True ')[;,JJ\EM?W*M2LNY81TZ?EP58GW:[;W
Application.DisplayStatusBar = True 'DW:=),NC>1)Z)TX<YR?IQQ2@8;\PY9
Exit Function ']2-D.8ARI5C2+,QA>O^FUCN<P)RH.*?U2T?).IH00@>^(.+:8@G=
End If '*R+(.L;FG4./DPX44XV<\EP?WL\4>D)6S01\L*4S5-T,GVKJ]W8YUD[;I[H
If goodLicKey = False Then '0:D5\)=+=3K.[QN)3,?^5B^5WR^W=4OQNJS[7SY
Application.ScreenUpdating = True '-S5S0\)T.7N.@MFH0ASB^L6(XSI+OIF6
Application.DisplayStatusBar = True 'T*AS34)((HS:B3/[,@EK<A,I+^+.7<
Exit Function 'XEJ,UMBXF:6EVZ8<Q1XU,BBQ585/?(H[TX640;CKNHC\2.+]4(KO
End If 'AT[5L18.?TPZ\RB*R)[86Y=\DUV*292\Y*G7O@+XW:F3VXVWFT+C^U;SU=N
If ASIN <> Product_ID_data_asin Or Now() > DateAdd("s", Cache_Time_Out, Product_ID_data_time) Or str_xml_from_api_match = "" Or str_xml_from_api_match = const_err Then
IdType = "ASIN" 'CY>C6[BUT(>[2(6*,\V;3R/CZ?+8.5CJA@FOI(.E]QFBIKR?7<
str_xml_from_api_match = build_do_api_call("GetMatchingProductForId", ASIN, 0, "") '
If str_xml_from_api_match <> const_err Then 'ETTDJ78DD7G3/EKJ5<\D?F
Product_ID_data_asin = ASIN 'BZNT/<?LNBW4LY\17YJ=3G@L?,PJ:6R]0A;YJI
Product_ID_data_time = Now() 'J2-]8AKAL*/D.+6Y\X\JJE2F/:-/PR7<\K=/N
End If '872H(,60-K82RBCKG\KN.9VL\^DPL6O;:^KF-Q9P.3OHME]6F?ZXP+R33B8
End If '2DMN<IQOUZ)?51^Q^.W5<IJ96Y2GX,VB[V[4ZIXXJL;S.QO4MSM41\<TNX@
Erase Product_ID_data '2?>:0@(\<Q>(LQ^P;6X(ZQ4ONXJ?.6T4[@JZS62=/6>5
Call process_GetMatchingProductForId(str_xml_from_api_match, ASIN) '
If str_xml_from_api_match <> const_err Then 'YC3)@G4F<APJGWTWP\YN.=
For Dim1 = LBound(Product_ID_data, 1) To UBound(Product_ID_data, 1) '
If Product_ID_data(Dim1, 0, 0) <> "Error" Then '-[,>,2Z<\CD.70X5C\A
For Dim2 = LBound(Product_ID_data, 2) To UBound(Product_ID_data, 2) '
If Product_ID_data(Dim1, Dim2, 0) = theField Then '42>(@MSK?8@8U0(J
If IsNumeric(Product_ID_data(Dim1, Dim2, 1)) Then 'J>BODS;1/2NUAM+D
aazGetSingleFieldMatchingProd = Round(Product_ID_data(Dim1, Dim2, 1), 5) '
Else 'L1>US5.1IBGFB.-T=DPOL)CYZ,,17MG+R]HC.0JZJJEA=;AETEYE2C\YSS]<^
aazGetSingleFieldMatchingProd = Product_ID_data(Dim1, Dim2, 1) 'ARS
End If 'CXM@PID-JJK>WN8(G6S8M<BD@(\3;IBU-SRH*>WPLR;PA3W.(SL37=S>7Y+
Exit For '.E+RV2VCL\2S^IIPX(5=@)@7=AE-)DPJ:8GZ<K6U\6GKB^R-->\D.KC9L
End If 'W\O3J5=V(<>[EK:.;;[>?@W1TKJ12GS)T>@UAHV)UTAH.9.;T>APU4KDRQ8
Next Dim2 'M=7?Q\F^,*2LQ9STKXJ(-FQ@M@AB8J)JD5KK/NJZ(5T0/L=2^;N4-HH0
Else '->ZSU]8RX1XKMS2=IR6E<)+KLG>\)UT=(4WQF\P/L0YM4/1C4*\W.JUP>:2;J
aazGetSingleFieldMatchingProd = CVErr(xlErrNA) '][>V.[;@417(VQ?+:@-
End If '5S[>Q-QXN<[P6HO68T;PVAT@X1D(;KN[@YGG+P/^N<]D7A?/G7)@M1(LO7<
Next Dim1 'RY]IIE(+V9:1@^2:,.-(,0)<VIR+2BI:5(29=HLJG\+3SN\=VZ;4>2V,
Else 'Q4LPF8.D^W-TF340G0L;T3<P81KX;SKB]YDA?ID?^U?5-*;\M:I\LL[8Z:\>3
aazGetSingleFieldMatchingProd = CVErr(xlErrNA) '*:Z*B=[K[E8EKIPHPTZ
End If '9FQT:N]AR@Q9UFXWOKC?ZL]TG=X*7A@8Z?(9^4]Q\MR-(F6F)F8?OWFE/IE
Call wait_some 'HP6ACK\BBV,/M,9^P<7M(OX1\WO1Q;YW0Z-VO(R8.JMFU@JJ^-H
Application.ScreenUpdating = True '+N8ON7>*\^^@JHE\YH=-EQ),4(C49@8N
Application.DisplayStatusBar = True '2L)PKGR<=F?WR.P-WMUNMMOOS*VW]\
Exit Function '1?4=QNKL@647O:P)))):Y>4W,L.<4FROC,?5LDJ<:EK<EO,@=2T-
err_skip: '\N696R/IWURHJL+EF[<D0J)F7R9V/9I=CANU9]DB<)[O=*^D5Z58CF>^
aazGetSingleFieldMatchingProd = CVErr(xlErrNA) ';0QC8M<0Y:57L[]PA3>
Application.ScreenUpdating = True '4](FH?3C?-XJP8.F53E6G/.GS:8]^P9H
Application.DisplayStatusBar = True '11?T;/:^:TGKJFP7KZMFF2.U<2.+36
Exit Function ',\5H0-)WQ3.E)RKK\EWM+U=+0)NR@8R0UN)1G<KO^,W9L\T\KH<4
End Function ');;06G38[@0,)/A2R])HIO8@64H>23G]39,4:B,T(E(,=]0J.)FY+
Function aazGetSingleFieldFees(theField As String, ASIN As String, SELL_PRICE As Double, FBA As Boolean) As Variant
Dim DimComp1 As Long '\>E-547KK8DSXQ(,)KGW@3IQ(1^]CA,4>]-NQYL6?[M-E
Dim zFix As Double 'JKL(I.0[Z1:PQ4HU.>D)\[0LD*I-+-N>MT)9DY6?+XHLX4H
Dim xRows As Integer 'SCODB;KBG;(F/K>PK00Y0[10UT\NJ:*W1TA8,SKD8MBNZ
On Error GoTo err_skip '<OXB;Z/:-]:]QD8A?<B)SDNM(@47ZV]K;5(*R5>[5R0
If IsEmpty(theField) Or IsNull(theField) Or theField = "" Or IsNull(ASIN) Or ASIN = "" Then '
aazGetSingleFieldFees = CVErr(xlErrNA) 'V>@-\=T8Q-J32AOMUK.Z.-)I(U)
Application.ScreenUpdating = True 'WKVB,6>V4>F\@?QSUV*GQ9][C\W4\P46
Application.DisplayStatusBar = True '/@M\U-SLVU@96S9Q+3NW4I0SR/8E;4
Exit Function '\?4JQ9ZQ^[=E1]KW22E]Z3.>3S8;--H.7?1WR+9MW<VU;9,6]\T;
End If '\BF+9@U]KDJQ^MW6+VC/<DZVKG8;B9CI3W+M(K=V;;:,JW^Q(OIIKI\Y]1S
If goodLicKey = False Then '0NMN(E9R/33GK;.,DO7(S+*FU,XMZNE;.IF:8^[
Application.ScreenUpdating = True '(FU77I:Y1^3C,>YXMGR=*+MQ^8[8JTF:
Application.DisplayStatusBar = True '+T]MJDZX0THAZ6:0:V8:QVO0=]BMCR
Exit Function '\KF=]Z1FKI1EZ5+KE[J;C([4PWPU05)(P@V?).=:X+:G<<;T\Y+.
End If '[/A@I[)27>9>JNR95^IXKYTM8*>2,S]5\B?JOH*19BKU.*63G^O81\U8C4C
If ASIN <> fees_data_asin Or Now() > DateAdd("s", Cache_Time_Out, fees_data_time) Or str_xml_from_api_fees = "" Or str_xml_from_api_fees = const_err Then
IdType = "ASIN" 'G+R4CB\@NC>X:+F6[2I)-MBEA-XO-XNXYYPS=,C\S<;92)^Z1\
str_xml_from_api_fees = build_do_api_call("GetMyFeesEstimate", ASIN, SELL_PRICE, "", FBA) '
If str_xml_from_api_fees <> const_err Then '00H8W)26)M]T[GQ:]T6AWG]
fees_data_asin = ASIN 'KE4A@:<K:G.4=:7F+H(,HXT+S-ZIYTWYZ@9RW+/?O5OD
fees_data_time = Now() 'BG.M:A2:WJSJ++JX8RI]0]R;KUG4C-=\Y=;U7<4^H<V
End If '\^0SRET9Z4L1@LG^A8QGPPV2>:B91UZBFA);B2C5245L1S14K/-U)T\]S03
End If 'W2]H9]@Y;8C\V,L.HBUXU:O+(ZY)RTX;61BII3D=NQMS3<IUVB>:YT1+].Z
Erase fees_data 'OMUX05J8USJH8GZ,YPT@]4;+LS-TL90\A@?>M>,/N)>WJ.Q,:+
If str_xml_from_api_fees <> const_err Then '30L1O4Y65FEQWKGXY>X>20-
xRows = process_GetMyFeesEstimate(str_xml_from_api_fees) '/K7BDQ?ZU
For DimComp1 = LBound(fees_data) To LBound(fees_data) + xRows - 1 '
If fees_data(DimComp1, 0) = theField Then '=/@M?ZKI0=G*BU3HU-Q-\\RI
If VarType(fees_data(DimComp1, 1)) = vbSingle Or VarType(fees_data(DimComp1, 1)) = vbDouble Or IsNumeric(fees_data(DimComp1, 1)) Then
zFix = fees_data(DimComp1, 1) 'M.NZ7=\59C0:8*:G?A]342I,CZ^G?25S\6A-
zFix = Round(zFix, 3) '3EMJDX-3H>G^[M.C2U2[*TO0>*9OQ/ZDR+?=7@R+;02?
aazGetSingleFieldFees = zFix '3FY6I6@V=>GZ-XQW)Z6LYU7H<U37044]+P0)I
Else '\H(^RY,+\?B0,)^[*H4LSTAH<,QF3R?NGFIK=72V3T[+F2W494[IK/Y)V??@S
aazGetSingleFieldFees = fees_data(DimComp1, 1) '0CNT+>6D^O7U3[<P8HX
End If ';DI77;=5MFYOKUR5SA\J*LKUX/H0JXIQ3688[?1YLQS>6T<S09BT8F.,3Y[
Exit For '7?P)3BB@8;H/;*0P*U@/2IV,/EVXG(??:NHBR^6/*I6M\FQES1NCKHT<Q
End If 'THPD@/,TV5\U-UAVKH5C\07=@;Y0IT(H:TL,O6S@P23NG3]=X9O)C.JP9]7
Next DimComp1 '?(:ZDVVG3[6D^]9-.1/H-1LL4*C*HJZE0/-0.]JKJT:.HY6+ZMXD
Else '.\=I.+\EN=(AZ)>IG]/ZDX<IDWT>+L7JN+EV<A<C1VX+;Z/4>>Z=JTVDQ2N,Z
aazGetSingleFieldFees = CVErr(xlErrNA) 'QDVLVMAY0VSK)31>2A4ZU7V,GRB
End If ')2@=G9\=3TH<Q[,DP)*6WL3O\8X5[YL>4*<*725Q@/>@^VH9B>)W;:Q@Q-Z
Call wait_some '=^^T:G7)K[G8LIEL+2R=V2[FJ<0U.,LK\)L=L2C/\+);0,6*/88
Application.ScreenUpdating = True 'NGN8\79<4>G.RGQK/X(M^P<+G,7L*[+A
Application.DisplayStatusBar = True '(4E?;(0+50A+KWT^44I/@[KN\+G78,
Exit Function '<7WWFB+\:3(^YW7R++U]0\)+,SYCTRM1\.F/M<JDW*8T?:L2*:;<
err_skip: ':.B]O(]7Q:,^R-I8D0Q.C,LII21S-YWFH85VH]=-+.G^:S=:4F[9B8?^
aazGetSingleFieldFees = CVErr(xlErrNA) '9^>VGTHM3J*L?RB*A:/?M]DC[^>
Application.ScreenUpdating = True '5>H,K3<8B@N=4C(<S?KCIPK^\>I9F1]D
Application.DisplayStatusBar = True 'X0?R[V5):><=7N=Y5FTZPS9.44>T?2
Exit Function 'B1WZ,F>?52<32OVO+)99>TQ]WCW9*@PZY4KQ):/^>.:+=SGUZ\/2
End Function '((H0^L)^BEN=.3/^],@@QGQ=<CYCMV3RENQ-\@K0Q6QA6QEL9[3/F
Function azAuthor(ASIN As String) As Variant '>(TD25IUB^T3H,<.55S?W
On Error GoTo err_skip '6AH-;]Y]JMC:=1ZI/G.-PQQS*TZBGN*^H5]X89;/@8<
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ',(/A)H;2Y*+/08E
azAuthor = CVErr(xlErrNA) 'I[8FBKAG44@K3[IDP1T>P<S]S2LJ5VV^QR(QWFGG
Exit Function 'M,FE^<5[MZX@,04L)U^0;N*5J=H*.CWOY)X]=*HV*C/O8A?GP>+D
End If '8EY9@*QXI72<,<MWY45YQ]?A)>D08\2IYI.5U>/5\X=N8^X+S+:Z)9(UD52
azAuthor = aazGetSingleFieldMatchingProd("Author", ASIN) '.Q41ZZ>X:
If azAuthor = const_err Or azAuthor = Empty Then '6,T5EI;BCTS<C3UY5
azAuthor = "" 'S-S^^WL18L3Z6EN?+<O^K[9IZ*:N9)/:D>?A@X=EIF/7G7:WOC(.
End If 'R(T;MNT@98L0HADW^([KS<PUH0-RX/UV.8]PV9KX2-,<ES(VET3T56:.HN]
Exit Function 'P?:1SA(,=Y5\9N8S.KU>ZDBJRFRX*])W/[UK<LGZ9U6A/5I\;M:(
err_skip: 'FN]?\DK9TM1W)TU,-J?8KM@Y)2:=:/,JHS)743)QP4K*JFX+O/W1AW(\
If Err = 13 Then 'TG7;XN^-6\76W1^AMUX=;I9^[\3OV1)01D7T3N032F=38->I^
Exit Function 'RJ\BURV,?(:55T;7101=@UW>8RZ(IT,X)KIA/*DK)5<Y-Q)K\2YP
End If '1AW42(E@(>,R:Q8K?L>2@X0^45.,3S:5I-)C\^VXM>^@1F\GZ59>^JPNN^=
MsgBox Err & ": " & Error(Err) 'P\,(2XGT/2>;H[-OD6.Z8*I4<-[]+?YATWU
Resume Next 'AC96JHE<391843[[QF50^?7>?QABDZ-J690X=@ELC)=FJ@T>*FKL3C
End Function 'U)K-^Y269R6.U=9IM*Z95AB8?R554Q=VI<GADFG)6290,<^E\(GGN
Function azIhaveNewBuyBox(ASIN As String) As Variant '*.QX:OTD<+HVJ
On Error GoTo err_skip 'K)P,W?GJ3F\@0S6JAMBJP16P81DG45(0LP<VAZ8Y]G(
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '<5Q,^6=<Q8I*-IY
azIhaveNewBuyBox = CVErr(xlErrNA) 'WZA\D?U>Q+Z7XIQJJ?DW>N)O^U73+5=)
Exit Function '4/GXH5\)KZLZ)U*O.;5\-FA12:5N0Z3T.HYZBGY8:78VUQ4.(>WP
End If 'FWM;NG:?O-=M[K5O13,ZSZF^7K*NW^WYE;WU2;8G-?WVLR(+7AHCHWKZ\3@
azIhaveNewBuyBox = aazGetSingleFieldCompetitive("Belongs To Requester - New BuyBox", ASIN) '
If azIhaveNewBuyBox = const_err Or azIhaveNewBuyBox = Empty Or azIhaveNewBuyBox = "false" Then '
azIhaveNewBuyBox = "" '=0M^,MDH2\5)<29M+E;FPR/,R-)):>@ZDIS;\4A^;<3=
End If '*]G8DTIV/>IJJPE>(O?CHEDU*5B]SHWSN,]]Z:R.*I7UBN[61]CR:L]VSF[
Exit Function ':35VY:LH(77C-P\M2R13>*XR[(CM3F1*1S94)49G,\K:Z;^XPV[/
err_skip: '-)+.;L-?E.)^+/BC2(8^.5S+;:8:=XY.IW@=;4U(=QE/C0;]?8=N\X>L
If Err = 13 Then 'X?*ZTE@YMT-L<+O]0M//RVZ3EW3GWTTN[AA/L>BSX@D@U3PDS
Exit Function '*QA9?*DB201X2Y[S+NN<\:+ID4]E+M?Y,LMQVHDJ?ESKZG<1V@+D
End If 'AR4@)QGQ7M[BZF.QUVD^0,<\TL:<)Z/C6BN1>X;[+6=G7HQN=Y/W2Y3J7U/
MsgBox Err & ": " & Error(Err) '2<EWO*-OK^4QF>X:A[NV8M[V<CKC6A/3XLM
Resume Next 'D>^]D<@TID(9Q5HDC50>=3NQLMK-52>+\P3QW50M.LGKU]H+8G]C@)
End Function 'S,/:([56OEBN;/?YX<?X,E(6^]>3SRJ\OT=4;VP/0*@56L.[>]2X6
Function azIhaveUsedBuyBox(ASIN As String) As Variant '\HQ:U6-7.22R
On Error GoTo err_skip ':RH3VA69FB[=6VG?E1D5B?SCL3Q^:)X+[(WDLTXEEJ8
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '9OJ3G:VK8:PM6:0
azIhaveUsedBuyBox = CVErr(xlErrNA) 'RQ]VSQ//YOF3]\WBQZ6K:2EPLT1E9PW
Exit Function '/GFIM14>).P6OH)EOA*PD,=@A43?:>D*.@FW1,EFB/F,8PY)ZR:6
End If ',9VO+V^4(XB5PG.>3BFYME9-U2:;:[A0N\@:-.^PW07*S-@R,)IO3^Z@83)
azIhaveUsedBuyBox = aazGetSingleFieldCompetitive("Belongs To Requester - Used BuyBox", ASIN) '
If azIhaveUsedBuyBox = const_err Or azIhaveUsedBuyBox = Empty Or azIhaveUsedBuyBox = "false" Then '
azIhaveUsedBuyBox = "" ';O<O@YTI3;8TXWF](](DT;M5HB6]<B:I];.B+4/NS/>
End If 'A4^06<2)HXB[QVBI(IXE-\1R4=PU/M(XGP+8UM;5N0RLL[VD.N8340S6K=]
Exit Function '-^A8]F?O+KA\FI98*WJ>SL>W>4RSP,(Z^GWL3RZMSDGAAMW?;YU(
err_skip: '-*FN6R-0V@-=LMC2KU+NL5D<RZR,D6;PH38VQE,C]?YLS<5C\-G0;,<N
If Err = 13 Then '*73]O7>*QPO:DQY:0:(N/7M<:;PO0K\-(15N)ZY?(Q35J)6LW
Exit Function 'ON@ILTMF-SYCL4E^3PQ:>MF;=(-<KA6F;YD9O^[3P+IV/502FZE+
End If 'P[IC*Z35;ICIWDMB3S5]>>\:^X/3;)0*B+2UOX8^)PIN9]X2,/7I99;TKN9
MsgBox Err & ": " & Error(Err) 'GZI805O^:3B[]/EHQM<R;N-DO194KA?-J[(
Resume Next ':NGCUDI4:/I([J;6(56D>N3+\XEH+RB6TBM],P(X\DM/FVG\V+UR]/
End Function '\Y?^<K@;5>5[Q4^66FO<=0:D1</[NH;^SW,<,ZAU2<^X;.3]-/IO9
Function azBinding(ASIN As String) As Variant '4<]6EX:R>9-9A9U96UXK
On Error GoTo err_skip 'OJ<5]GJ<2BGPJUU=NL8;]NVV5S-X/AA\LWE-8ZL00LO
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'Z622W\SR6IEHS57
azBinding = CVErr(xlErrNA) 'WRV.^N89*Y+9@QAA319HV<M[TRQ1+=,ZV6,9S8K
Exit Function '+IQY):[DYSN*\V(^SLZC]4(^8-4-[?MQ33ZH4S>I.O0(4KP>VLA1
End If '.N];]A\P+V.HP<0YXZRDP;LFXEDVAEG[S^+)*\8;9MLQW(,EILKD]*B:R/Z
azBinding = aazGetSingleFieldMatchingProd("Binding", ASIN) ']7?3WV9
If azBinding = const_err Or azBinding = Empty Then '-.OGZ<(V./ZOW[P
azBinding = "" 'HD8/87F*T6;N^KN>W1]93:4J:\E=4[R9U7EZJ::ZC7.[P(V6@(G
End If 'GH67DM@EH10.Z28=34M*3JH1A5UF>=L8E-?J(D\];IK8B0BM(ZA-N-9J8,4
Exit Function '+2WY/.+R<[/,*C[@]XFHVGT-P\XDT]2KA1E1?QAB@3]NXV9*YY4@
err_skip: '43SOA9>6QQ86(CUL21A,1OL4O<)=RXL6^YV/>SY+IB:HVM5@J>]QDJ\5
If Err = 13 Then '+/Z@@/FTT^DN)S(T2,\MLJLN=>T1BUJP,<8*<3UE]<RPBVKC8
Exit Function 'X3YL)B-5+83BR)LDY8/C[A-<1>CL,FLLX,GS:D36U??^RCQL,RJ4
End If '[,6*01(\4P-G^]7PMFPXW?-8=J=VIJKK]M:1OH?O\J>RXOR*9\G;C6;/):9
MsgBox Err & ": " & Error(Err) 'HU];<QC+FAUW.7.,C3;C(IF^G,\HIILS9\C
Resume Next 'X]^)U/P7R>W8S;5P(?+;07(@=2LC=\9(NRUM5KYT6Q?X5:9F>J=N01
End Function '=T;)*+8A6,?NY>^HNU?<5P>M(M)KV5@@G)E\U.(P8DE1,,>)5F5+W
Function azBrand(ASIN As String) As Variant '?10OY>H,^W<I*^=MS2P(T5
On Error GoTo err_skip 'YK<PMRWZF.3^1*:-IJ/<.AVW)VJX]0?C<D^6,J27<]N
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'EU*OPRUW.>SH:VA
azBrand = CVErr(xlErrNA) ',K7O0KZ6B()B6>QYIZV]JBHL\CV4?O=2,@AH8TJG6
Exit Function 'IU373^+);GAN[6=3RWACIBET9SF0:TG1<N.+;]RXMU(,HS55[M/+
End If 'T)TZ1S;,E:\VT/]NUMT]V6?<1).G)=C5NDV5[6A+H/JFCMBSJ+;=@X4[I7F
azBrand = aazGetSingleFieldMatchingProd("Brand", ASIN) '(PP2K9VC]PF
If azBrand = const_err Or azBrand = Empty Then '=(@;9,TTK7^2Z?R7KL2
azBrand = "" 'A/RWM;NK*EJAVDR/T)=/D*+):;/.@2>729-4L:)OC./<]J+A:Z5*>
End If '35EO><3LY/C?YCN5EEYUBWNAM3+;9F@3041^^;1/@IQO).R17O-*?<1**WY
Exit Function '-H6(]-E*B],01^X>OV3+(9\DST97;[K7HJIG7/K*DN?FG+^4WFK*
err_skip: ',5]6?DC+6M8(K*TU64E/+UXR<C:<.(T0:S;.]I]4WDV-^+KS,O2U5K;J
If Err = 13 Then 'L0;IC:)5\-CL7F,<-L?LA(7K4X?5I@XN(8>.,6-@.=@GD0BMO
Exit Function ',;.+J3;/;?TP]L(G97B@/T1Q3P3DLCS<ET@-I*?0E2DK,NU?RU1C
End If 'Q8DD]\^3^*H\8HKY=TXZ>Q9(3=?TLPDA/7;O3Q-4R*=-7?QQ5\7+[6AFF==
MsgBox Err & ": " & Error(Err) '-N),D;G4]H56,YPSH:X5S7JI77;AY3D5WKB
Resume Next 'WXMOA,<^SZH<Y,WA+GRZ:]*X@*)FP>@0MG6)84]*+R)3^(AHZ5^B,D
End Function '8L/QPAJS589@B4U8^PA*(01?L,T<==MGC18--/<;6/,8>*K[WV^[X
Function azConditionNewBuyBox(ASIN As String) As Variant 'HH(YGA4)-
On Error GoTo err_skip '5HUVG7YD6;E64+TE@IZ5C3*>H>93GM.,;8G5K76=OW=
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'Z9,UKCMX7>M[/^S
azConditionNewBuyBox = CVErr(xlErrNA) 'U]/TBW8-C=1:BI3BJT+V]FF7.(YD
Exit Function '>CH+K:P(].:EF0.YKE8NI[=J8K2RIRVX9V?+.AIN+?FB(\4[B2P^
End If 'J/^GUN-+,]</>AK82LO5,,AA>;0-HS3(Y**(H)1J)1KQ7UMTV*D-P>K9J<+
azConditionNewBuyBox = aazGetSingleFieldCompetitive("Condition - New BuyBox", ASIN) '
If azConditionNewBuyBox = const_err Or azConditionNewBuyBox = Empty Then '
azConditionNewBuyBox = "" 'K+TPTMQL^H+\R@*NQ/81Z7:Y>WA*M6[YH<9R).2+
End If 'WAX@(CKPEV]YWKBVTNV?<<)AJO^)]U;ZGIL?(BE?;O=F4K1P;@A(5[WB,RA
Exit Function '.@@U2E=J8)UV4P:MY;YYL*1B/8JM,/78JCA4OUW/W(ZH]A:4OI]7
err_skip: '=02EVRM9YK1R15:E5/H9J/C,ZMSK8F5;7L/0C6UY-8DP++<))-U3,:23
If Err = 13 Then ';,R0-O?SLV\XPW<:<4N8[=\O?ZJ1[+9YB>J5\T6->J@TJ1H7R
Exit Function '6/*Z\CU0L>5QF[:KJH]4HYULOA<A70>:\BJ6I>DV93ESMP@X5U^Z
End If 'TU?.8ZL)Z2OF=S-+5?U6U>(G@*QIY;.X-WF[+T?D/DT,>(ML>]-S/SZR0)C
MsgBox Err & ": " & Error(Err) 'FG;3[,/198GXHO*J+;4]@0.J\H1JM>\X7OW
Resume Next 'HN?9W6XMTE],VZMII]L9HVXCVZ?X(TO3HIZ/B4D6L33A9I/D)60T80
End Function 'KNROMU]P(XRG)JG<6.O=/)P8J/VX@0EZ<KH8O<;A7S(]<RCC0M8V2
Function azConditionUsedBuyBox(ASIN As String) As Variant '=7+4?/T7
On Error GoTo err_skip '^D?:1PM2*,+\7^L@6\75^DK;=@OXV3;7XO7E80-V::R
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'G/FA[TGG;I5I?,(
azConditionUsedBuyBox = CVErr(xlErrNA) 'Z2U8L>2CA*?H*]PDW(GG=L,QW:]
Exit Function 'F3R/W?).(Y^.E1+H8HX1O*IX,PDF34LD;U\J;/>=]WL?H]Q6+X..
End If 'V@Q>WRX]L1GCBM41UN8W5;YL>>9XC20/NX=Q.*Y>S=0)(Q1Y]>M+GHK)>1Y
azConditionUsedBuyBox = aazGetSingleFieldCompetitive("Condition - Used BuyBox", ASIN) '
If azConditionUsedBuyBox = const_err Or azConditionUsedBuyBox = Empty Then '
azConditionUsedBuyBox = "" ']LQ-J*SL2V1A00YKX?Y<L>8AZ:L.S<T.V<E(/QW
End If ',+R-C^KQ[S7)S@PHGX=,^4VEAF[4RQ.H.I)H4870T[G(8B(KU\NF<OEW33:
Exit Function ')>V8@=DL?B@HJ)H*V\7W^WO36AYZJ1K<D)YBQS<\T>;S4HP-9P=(
err_skip: '<1NNK\W*;W5P.;M*KKCS.@J^\VY]P?JK>L@ZPG;E(H..]OP<.\>I^UAE
If Err = 13 Then 'W,HSD(C7H=ORWEJ3<Y5G\AX]*C)(MCC;P?SC?,R\1XF?DPIH=
Exit Function 'YY/WX)YAL088<EVVA>/;[36N(]<AN,I7(45;*H,<I6-C()7R[5VJ
End If 'E=WTFE-7WQ;2@>BQ1/O+<<RW=9-DL+G;T[1,334KIZH3.,;><*FW+,;]F=6
MsgBox Err & ": " & Error(Err) 'U]+TCXV6)TPXEB:BUG?4QEG([GV3I/UHO9Z
Resume Next '(GY1).T+L>BA=JUP]-..>9-<53@F/@=/C5D8J:*CY./:;+DJ=GAMTR
End Function '.,KCE-]L\<X*OIQV6<EG0R?Y?DXT/0P)7KSGQ+;RQI:6:[9C5L09^
Function azCurrencyCode(ASIN As String) As Variant '6KUD5?P>+PSGXM]
On Error GoTo err_skip 'G(?B^70R\8Q8IVYX0JBIS@16UF9M87[HC^+M+/=P-N^
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'S\1.DUTS]4=UMR^
azCurrencyCode = CVErr(xlErrNA) 'E2A3MTN:].A22:>YRRY<RQ3X2YWY@B8003
Exit Function '\LL>9X3?K.2G*AONZ?CKDLVG.^PH3A5F+Z01=LY6C?H>AEHRK=\.
End If 'IN])[X4,E(1?20P+FJ]K.3IVADVVLLA*^+30ZO5?6@+1KLGD60<@O:=)<DK
azCurrencyCode = aazGetSingleFieldMatchingProd("List Price Currency Code", ASIN) '
If azCurrencyCode = const_err Or azCurrencyCode = Empty Then 'N(V3(
azCurrencyCode = "" ')1FIX[C5LJAFFUBT[@N98)34==@XJ<J/N^G/@OM6,+19A@
End If '3@.X?SA.8Q.PU-;9A>-=I5/YARGU/@F.^-1N/1O*:10L*GN-QM[^F(XD)QF
Exit Function '=)YX7C8?KGS^+9QTRX6X\C3\:R:(+0TYLRY1E;W8:I5])J7WOPG<
err_skip: '52HK\+=<JK*C:I.F?OY.<<R7U:\L*TBE9I</ZT,>.;4VE4CHOH\[]<:U
If Err = 13 Then '8/Q1-(GQF8*J9+RF@5S)PB)P?.18*MH/F7IRQH.3[W2LP25E8
Exit Function 'Y9(TSXW[F?+^LB[EP<7RDVIL;[OBU^;?K^<IO1V7JWO57AAIOY0L
End If '[IW8EKHW[=NK;+031:>AQ[Z6E8Z:>K4@28INE*+7)-O8>ZGZ5KXPPDDCSJK
MsgBox Err & ": " & Error(Err) 'U14(69HQTI.+8.^GKI/B0TQ8[TU,US0G6^:
Resume Next 'F:UGE2,EQH^NYAI=:Y?SUG8WT3QFQEE6S57FF>L*>(EOURD6\5OXG1
End Function '7\\7(O)0>L*V2]?+RL2AT10<T16W1W-\;3Q36MX>--,K1U>E1*4QJ
Function azEdition(ASIN As String) As Variant '^].U[UPJW:G>UM]],B;Z
On Error GoTo err_skip 'JEM=R1Q<>SLMF:85R43[Q?>57M=983;+;@RM21-8MVW
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '(1,2FUK2N,^,BO9
azEdition = CVErr(xlErrNA) 'C/:M2QU?C>9S/IJ=^3C+BI(H\54XF4*44<@YZ9N
Exit Function '8J\1@H2?+PZ\BOEQCK]]B+]DE-=U/(Y^SPT-/*8Q-FN\F94.^AUC
End If '4.+X2W7/VWEO81V=U8N@)KY7=2M-X7[Y\XZVQY\MDVIH=M].6*4B(HE,]I(
azEdition = aazGetSingleFieldMatchingProd("Edition", ASIN) ';UL,(QA
If azEdition = const_err Or azEdition = Empty Then '=:\M[5U@P[SS7P<
azEdition = "" '1=9(\OFXUX*NMOF9L=^^[[?HM=22=V5(<(U:@U;\.CINLK^8TR;
End If '69966P,2,QUS,JWY9B[.D=R/9YX.HFOJ:SYF?2X;(POLSD3\WJ/KH6Z8U3?
Exit Function 'MFY<1+LA]L0=1=78Y.G<.:D[B=1KFV^(:,T3X4:,77G:YFO1P57\
err_skip: 'BP/\0A]KM6L@\PG)>]<6,-VH1S]VR576M4>ROJZA2X>=B+UE0Z^1)4E7
If Err = 13 Then 'H\M2^75)1*?>I6?N^CW2<+/RTB^0(/F.=8:0=8N3Y[DV-6\C@
Exit Function '5.E=]D[LYMV(];94G\D]H@Q:GK\I<I5AU;X3UT<>E*VL[LROGIPT
End If 'A2H+8C>LHI>VNN/W:Z6BUO@A?CC90IF;N8RZG9/YJ;DDS-];X6>G\)8BNNX
MsgBox Err & ": " & Error(Err) 'W5RY8\UBI/79SS)6FU+[APQU3>7X<0D,9*]
Resume Next 'VBT7WTX-CW)]7LD.9;3\1YCAQ-<NKNWNMZIAF-X;\PHNWHPDZ0*M9A
End Function 'UY2N/;V\*\:W<*15R>ILKP,,-@[S=K=C=ALQEBFISF^?+V0.N)EA>
Function azImageURL(ASIN As String) As Variant '85BR6CLO:V1QQ/TF=>O
On Error GoTo err_skip '1E6./:2I/0DI@FE+SM^HVR-7\1]M*>-*UF7Z:\GTD)P
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'ZSC2J\B(-\B;7+<
azImageURL = CVErr(xlErrNA) '2K*Q<^JB(\?2TXSVR@+G:UWA\8UQTR?*ZX1Z7,
Exit Function 'SC>SO:3E.>@X<0].:D<O>VZXU+(=,5ZKQ2C(E>A@@<Q4<[/.Y*-L
End If 'BIR.8)5XL0=-CICGWA>M2M6WSSF;>PD8:)NWD.RX),HGTAEFEB0.[8WO0S/
azImageURL = aazGetSingleFieldMatchingProd("Image URL", ASIN) 'DPE5
If azImageURL = const_err Or azImageURL = Empty Then '?XHC(?>YB3JN\
azImageURL = "" 'FV-K((-7<:7H.9WAY0.MG7F3M0FE)?)?H2DYNH<<;L<0[:<2(Z
End If '(S-4X7MIL=0]?T,^34WPUZ6:*D^TT[U6XPL5JH+?/*ZAEG=/FT1O;*VMI+O
Exit Function '+=SA\?ZJ)ONC/GW.-9X?7N1D?9D:P;RH0QVW*6Z][0VNIWVH@)F0
err_skip: 'CNI5@[R8U>U]H)K[U64>W*B/DM^DP/@[?GZ?A-KJ.S\SE\B;JKL<1?:H
If Err = 13 Then '4F3^<7WSW<0HW<1C;G*VJ[EW<H0IM8;3B;/90IOQCUIGQ7Y.-
Exit Function 'LO.T\-9<*QZ6JIV6G,O(<SB<PN(0@A50HZ?2Y^IP:Q<B,P]=KD?T
End If 'S05?L^G-[IL3ITKSM?GU3*83N(8QJPZQ62VCRJQ4FP92UN?0<YE^PGACAX;
MsgBox Err & ": " & Error(Err) 'H*@*2LD6A8A,@=;6F5B)+H(^Y6SFJ+JCP/D
Resume Next 'F)W:XIQ)[6B\1RIYD<0BDAQ4R<73D?CFF93G:K<VARQN3XHZC9MR]0
End Function ':5V@1>N29.=[VCI@(,T3]PD=PO\1</V2AIB>S,+^7^6O8O.<\/^HZ
Function azIsEligibleForTradeIn(ASIN As String) As Variant 'EG+C7VX
On Error GoTo err_skip '5?>WEWF=6ZY,6[^HJCKTP3JOLNJHNX@93BA,NT960QY
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ')C^]1S36C:/()O>
azIsEligibleForTradeIn = CVErr(xlErrNA) '/XFEB2U5],6[//U6:3VV+Z4@7D
Exit Function '(*?DC[YY4=]GK(K3.XDDNUU8:,RI6)\0I;2+89DT3:>@FW>^D>R3
End If '.KVPQ,M0-D2>95-H/[\B:[6UOS^+*]51?\4UZ<AR9N4C4V7.A8Q?D9?BAB/
azIsEligibleForTradeIn = aazGetSingleFieldMatchingProd("IsEligibleForTradeIn", ASIN) '
If azIsEligibleForTradeIn = const_err Or azIsEligibleForTradeIn = Empty Then '
azIsEligibleForTradeIn = "" 'M^9\VS:]XMQFT(P-/D^1G<1N)2>-QE/WTB2:TD
End If 'XT9FFIO5(V;@9=CWMPB.DIZ][U2N889Z0AW?=Q7BFE<2H+-8LZF+8F6@V+M
Exit Function 'K4HXR[?S0YDU>72F3/-F0P7<Y/:OH*]^?VVWK]A:G@CY*S<\/\XJ
err_skip: 'V(K+N7I/\AAC5NL@*L]2(=+9M>3E8^<F(T>;3LIH5NB92HQ]03HCD@4Z
If Err = 13 Then '=F+]HG:=[,D\+<R+A=;OG,@08+7EMC?(X6:\;85A8541=?C6Q
Exit Function '3I*6T@V19=XPW;BRBE+W*JNED,(T9X/)/<1PS;M+AGE327(0B2-Q
End If '\)F:YO/)V)]@+5*4],,QJB)R8NXW;OIJ>MDQRUO@]EY6QL8\2-,N)ING=ZV
MsgBox Err & ": " & Error(Err) 'XJ*SQRL)XZMPSAIL1+ZND)7.]Q^:;HORFP;
Resume Next 'K:DH5M;R^U+F*H08\NH^9I+4UJLI;<N,E9MV:TQ9/+4;VN>W;5NB:.
End Function '@R2\-23;QSW8C^5C+0EG9/D11YE8>FLX-C(F+WAVH7@>ER3KE^/BF
Function azItemDimensionsHeight(ASIN As String) As Variant 'ZG\2[9C
On Error GoTo err_skip 'F7LA0-JG07MX^L,4CS,B;L<)NZ\A++-FA-I@S:;+EB*
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'G@3N+WAJ>KX7*7H
azItemDimensionsHeight = CVErr(xlErrNA) 'HOL9JOH*06XOSS4,O,?F=*Q+D[
Exit Function 'SWXC:O,X?YB0B?)7-V7<DND?9I);<7Q2*\)OI)P/*[G-Y:N)FABE
End If '24SQVX3FFIO1;9<-1=VXJ(?-3M=JO.<^W87..T39[<N@+R:97T@E1O0:<PH
azItemDimensionsHeight = aazGetSingleFieldMatchingProd("Item Dimensions Height", ASIN) '
If azItemDimensionsHeight = const_err Or azItemDimensionsHeight = Empty Then '
azItemDimensionsHeight = "" ']^2,:A>NXX7,/5(GVZ[6B\..,[140TE>)1Q+:L
End If 'S?OL+00K?:(3OUOQ5];\FAVS;DLPN4D:B5H(.KO\D),C4)\J]TUJ8*P7D+S
Exit Function 'HBYX[I5V1S:UN*4B-)(7CL[87*P1-K2=]GZVW:FE9K[K<IWPW-O:
err_skip: 'DZA(JYW(1Y6YC0(=(TMH*.M.1R]TFD8:N0>7?GI>(4P/NL,=>ETBILAE
If Err = 13 Then '+)M9\/48AG:W7R-VR2:V\>PUP17ZC]VFTM/P?EPLI8KDJSRFC
Exit Function ']6V[GF[*<,U4B-*^19RXLJOP2\9=0H+<PF4)K:H[,WT9,IH*[3BF
End If 'DNP:2IG=E6OXD/TO^)FEJ/<Y3D1\]N?*>GET0D;?3W-0=>:+,?<*-NT/[+;
MsgBox Err & ": " & Error(Err) '[B@AG^Z6TOUMA28TM-.[QIHM8[Z(L1LSB9D
Resume Next '^T/*.1*G^;@S:KRAFDY+,-SP:V=LFBUJ25MV=9P,OEUZ39\;KYOM*T
End Function 'J*PW.R5DT(\B\R7QHSO4.M]*.AA8A>^VG]QC--??LQSO\I5<,2[=/
Function azItemDimensionsHeightUnits(ASIN As String) As Variant '+5
On Error GoTo err_skip 'FSFA.7UNGME/W8FMG;)E>VTMRH7DPE;Z)=N9J><65E?
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'L;Z7/0,:NIGE5TK
azItemDimensionsHeightUnits = CVErr(xlErrNA) '<-0]C2N]N+SU)P2TYZAN:
Exit Function '0Y(<0<:7ZV)8[T84-PFBB>:(G?IAJ.5R9DWNHUPWXX2]=(^4W/3)
End If 'R?5<=F/4F21CU=Q:T0F)QGQ::A@7N.?TZ5*1>9B/W*2P;/E+E;UC:PE-Q0I
azItemDimensionsHeightUnits = aazGetSingleFieldMatchingProd("Item Dimensions Height Units", ASIN) '
If azItemDimensionsHeightUnits = const_err Or azItemDimensionsHeightUnits = Empty Then '
azItemDimensionsHeightUnits = "" '68V]4M1U>2N8.^TQEHN6UFFOG31<<SKAR
End If 'BCQ[PO9SR(AF([(3GZ8X1JV@0WWCVA:A-L1Y/FK9MW/W3]*LE2*(N5A2^,,
Exit Function 'FUT>1F)Q?6S-Q=8,;38YL/1O91=7-O<U;G44D4-<]9GU/B>NQ6>R
err_skip: 'NU[,:^F6)?YBXNW?UR20SM4\]MVB?>M2Y@E[X+0W^7-GD*(B4W^CB@?X
If Err = 13 Then 'R?.QMEE?^V+K1*DD33<-6]I,DTJS;GG:R@W,]WY;5\.?0-5K[
Exit Function '*-7<1MW^F1U[=Z*4Y=UCH.B9]L-)=^EI4-NY4Q+,1K=:TKVW[B.(
End If '*K^F4C@5,81[OE4M(AA6IT2-=W-;ZNE9:O[-?<?A\3]^3/<CW[WH+)QNOB=
MsgBox Err & ": " & Error(Err) '^:^1G5I?LG]M8[@TCM;X(5M/Y[U:LUV;A^V
Resume Next ',GUE(+]M.5+LLCXO.@;N;GS/]+AU(X;=V+/;48B8RVF7GBRG-YUL78
End Function 'W8YRW:S9Q7A*F7B-5NX1CZH9FCY>@J>DBL(P\/72)R(9(^*:SB?)C
Function azItemDimensionsLength(ASIN As String) As Variant '?M70CNW
On Error GoTo err_skip '*8);^LE3?GCD6*?^?,W7]A+\7N\GS?:+NR8?/3^F?GC
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '0H:,6/4.9Q=T\]F
azItemDimensionsLength = CVErr(xlErrNA) ':K.3?=,*]XKE39]R/[7IC@2U7]
Exit Function 'HQ)HFXNHZ-@@3VMHET05D3+??;61DDSYO\I6C9L[*.1]IL)/1,ML
End If ')G2A<TR(*2KJU1^^S;F1VQX[J9JFDP=D(:JU4CW6W,+-.0C(/0D-F(Y@9M4
azItemDimensionsLength = aazGetSingleFieldMatchingProd("Item Dimensions Length", ASIN) '
If azItemDimensionsLength = const_err Or azItemDimensionsLength = Empty Then '
azItemDimensionsLength = "" '[H@TN(6;:H<TULR^>TTK9OCIK:+]L5SL09/14H
End If 'QT?R-5VIG/DZ*ZYW4A3:XJP*.*9*.6.=^,K0Y*(G@;@A<Y+,=IYX:)/VF0L
Exit Function 'F2KY7TM:B()UTT=KRWJWCUM6[VTF7B2UEPH7@?B.ML2V.TGHIAGZ
err_skip: 'X]HQ,VKP(NA=V^?5;D]C521AV/C:[]T+]CLH=<Q:::RUA?;O.K<^QO>9
If Err = 13 Then 'VYV4/-5//*TE(G)M@[67W.H([ET10YVWZ<8-M\6?<-=K1J6U>
Exit Function '*09T(:PU>)2+.[JDKUUN.J]TAZD8V>5K@(H;7V53FNZU)IC<NT;J
End If '[L)]Y\LL9GF+]-J,K=5+<4SB6D>?2E)O/HI(<QM87*-G/J*U8E95H=VHZE@
MsgBox Err & ": " & Error(Err) 'WHBAREWW/]7S*=PGH>[:<)EB<+H1*^2=I\D
Resume Next 'PY8^\V^BZQ,+TC[CWH-Z2*JXO@RJ8BJF7>;*1.@<D/9/6-0J(<\LZZ
End Function '3R>VZ0Z?]TW0::LU>/C[DQ]PNM^GO4XD6RV*I3E82J\7T8ICQV[R?
Function azItemDimensionsLengthUnits(ASIN As String) As Variant '7@
On Error GoTo err_skip 'K7UPA9<:7=[JO<<;K?TA9O:(H?[9G)P;@T?:CL\PG)E
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '-5YTYSIZ*18H,5O
azItemDimensionsLengthUnits = CVErr(xlErrNA) 'N+6UXX+X@0D^+RDM131[U
Exit Function '6AJN*TTXLQW7]AW)MRZ/S?<XCH5B8J^Z7/=.L2S<OXGZQ^RWC1/:
End If 'Q<\+KQTN>TV27<Y216Q62Q[(<6B:O:./CSL^M4L;SM7SUK>LK1.V<@6X3<:
azItemDimensionsLengthUnits = aazGetSingleFieldMatchingProd("Item Dimensions Length Units", ASIN) '
If azItemDimensionsLengthUnits = const_err Or azItemDimensionsLengthUnits = Empty Then '
azItemDimensionsLengthUnits = "" 'W)/\4IF?WUV]2.382D4(,)74DH7FXXI,S
End If '=7])W^OATHP*>13;J:E0)]<LQ4I1SLYUEN5NB<V196:E-L,LW-W89]R3YF;
Exit Function '-QB=Y;[C74E>U4^\M=CL0>:P@7R?I:4GZ:HB9*^[2WFJ=QGHDE(1
err_skip: '.RTTV:(V19B:7KUF)9;KZ;7+>)+?::-NRLF;^OF,PSGHS1*JLW5<LFC\
If Err = 13 Then '[^3<J(*7P8B57KPZ8S/E/>1*,?I>3F\==]49J=T8N9PH\H-2:
Exit Function 'S)\3C^*6O>XQ;;Q6T@>R*EUN(R/[(UW6SB9(>6;\KH9=K(3HHJ1A
End If '0.AWPHBJ5]W-26[=->.5E7.K<X6K7Q2@AQNLS[X+[TI2]P)H,NE-J2]<<AW
MsgBox Err & ": " & Error(Err) '0A3CNSJ3[6WOW5X*,48*FKTCD,N:NMN2SN+
Resume Next 'T-.7=J\USLD>C=S=A]\AQZ\1O^-Y80+\KW*^WE7I/>P9.A^I;OE:7Q
End Function 'H\+PJ@(^[N[4;47R9T>)Z2\M<U63G+5E,:7(0XGG5@L7F@-[^6G*6
Function azItemDimensionsWeight(ASIN As String) As Variant 'C?.HTK;
On Error GoTo err_skip 'QWA.54/]6KRQ-SGX9G/NP,D]PROXPX6Z(4+9K*JJV9A
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'S[Y6/F;3DV9):^:
azItemDimensionsWeight = CVErr(xlErrNA) '=ZVE:QN8;^8OF1L/,L4D\485/Q
Exit Function 'PZLCZ;H3BR7GCPH3,OOZ]::]9Y*WT1/,^>@:SEMZ>TR:=>H4ZH]@
End If 'J18VTR7K<C0635@)-0*A9-N=79[0L>8;FFHD.ZK85;.QH@MXYG>G?B?ES[Q
azItemDimensionsWeight = aazGetSingleFieldMatchingProd("Item Dimensions Weight", ASIN) '
If azItemDimensionsWeight = const_err Or azItemDimensionsWeight = Empty Then '
azItemDimensionsWeight = "" 'R=PXQ?*(EUS]4<HIE\C3]3>M.:E^=20WXHISBY
End If 'QPSB.HMU<2,67**+,3[=<U\\+VVWX(SVQ5NDT+G0:<6C1@@[78PUD+55TV1
Exit Function 'A]NO7*,^?*0V[HIA:X>95]ZJ-:=[9CK)H4-,BKV*4V45UHA;>>I@
err_skip: '6[9VD0[>P\>L.FI<B9^<:D=B56[M<Y4A9?TB37Z>(>90,?L2-5S3)SF)
If Err = 13 Then 'CNT.2005HY:NAOUIVGFPLML7MYBSH2U;>FD+.-0QH7+YNGMWM
Exit Function '160RZO(RG)C:\V=QESNIY4059:(@N@*?OLU*2I62MG8FAT]EK/OB
End If 'DCJ\\DT\HY^PLT3=WZ,EB/<-QL)F:7<65QF-WP4<9OE^)59RCEE2C1\/711
MsgBox Err & ": " & Error(Err) 'QGLY1.W/6NY(Z1AFWW[K5]+/:6U1D,GPK@@
Resume Next 'RJ91TA:WPWN3IU;\A8/0>Z+<1OS-E5BA?ZO3ZEXYK2D9E856FZM?\9
End Function ']F7)QQ?S2?F.:V+JY-J.)/DK1V1M=?(QO*E/ZSNW=L=)?097LO/IN
Function azItemDimensionsWeightUnits(ASIN As String) As Variant '[K
On Error GoTo err_skip '46U2=L79\BA(;)W[D*GVZL?6UMA7TZ>IC)Q[M8RC=+Z
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '=A73Z=<H+39RT<X
azItemDimensionsWeightUnits = CVErr(xlErrNA) 'CLN8P<HLP9-?T45HU(L8+
Exit Function ':,AG^,LI5L:K/+)/48*3]F-OC[6MO=\O@YC^+(M50>K.J((OZ+:C
End If '\9[77/5;>-IST+C]Y+ZPR0N<-J.Z=9MJ<84SQQ5O10C);EQ/I9^)E*G6\F^
azItemDimensionsWeightUnits = aazGetSingleFieldMatchingProd("Item Dimensions Weight Units", ASIN) '
If azItemDimensionsWeightUnits = const_err Or azItemDimensionsWeightUnits = Empty Then '
azItemDimensionsWeightUnits = "" 'TY@I2VM(]XH:\6US@E*=/5V>(\X[M>8KZ
End If '>/..Z-(=G[:11H6T5Q[N-V)KZEF9:<,])IVGN;D^:*\DH]4LE8*.H*8.OKU
Exit Function '7Q=S8DY--0^\=Z+\(HP)IB2GLEJIIO8<<I<)]>@NG]]RJ42<:W1-
err_skip: 'PIG<G1YGONN4TE(-,?M=?V77^O/GU6KWS/YLVUD)@8K53X<Y(>5.)I0,
If Err = 13 Then 'XLP@,C1M^3)5,VH=;)8VE02FF[DR>(MB-[7TY<J(ZI5AV/X)\
Exit Function '7T0A[(3F.8+*NH7::E63?>A@@<NK?YU7PEI-)QZFJ3,U[3BN8=D,
End If 'CIR1)3Q318*QE>8K2OXEPIS<[5G15@V*XWMB*<GT4KC^+00M34K@H@45S9@
MsgBox Err & ": " & Error(Err) '/(SY1MMUSZYD]U,H4]6?L)3@?LT@9DY?NG;
Resume Next '^W3@7P@6<-R</TVQ>\R1PB]C:465A+;?U=<M?SUDD*RZZ6-3C>5-[]
End Function '>]@A5U*A2CNO]L\ZOO26T9)3].)8HSN<6:MYLE.IHRD?<]FI8^9-I
Function azItemDimensionsWidth(ASIN As String) As Variant '.<5ITP\9
On Error GoTo err_skip ',@9\N0ML?TGNF^G82[8MEPSX6T*U>I,L<FZ9/6*<T],
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'P*YB-*XSC-9\VOQ
azItemDimensionsWidth = CVErr(xlErrNA) 'BJ>3:EJ^VJPNVAY?=^.J<G-W?;/
Exit Function '/C^EW2MFTF2:LK84OG=E9?+)A8WLMH9?3N0M<OXC3GB@<;CB7Z61
End If 'O3D0V??+>]/,3AA*J<>8W\Y=50L;OVF,PAWX;M/BFA,,O7QRKP+3A0?A)TO
azItemDimensionsWidth = aazGetSingleFieldMatchingProd("Item Dimensions Width", ASIN) '
If azItemDimensionsWidth = const_err Or azItemDimensionsWidth = Empty Then '
azItemDimensionsWidth = "" '8YCOCCEAYI:UXTJHTC?V;5=N]0?<QLMI9<G12:4
End If '6DL]E9NV3G68B,+2;+DY3P(1@6.+=W44I4:C600EW=@[5WD@L]3C=:S(9G@
Exit Function 'RT,GWGW6^X.0D[8QER>X+JS6EF67?=@Y7U8,YW\1O:UPK]\FY=CW
err_skip: '5JAAKBZ/F+BWC/U7--Z=VS3K)P6/X?H//+OYK<DJ=RSOIQ+=;GP8.+9N
If Err = 13 Then '7MFWKX<AZ2:1;=AW1>626,CX7/=9S8(?ZVWM)5UAP/:L5DLBS
Exit Function 'B0NF^6L*GM-T6X)XV+)D9PZ8P;LC08?H[++.5ONRUGJP^3B1\JF3
End If 'A*]G3[):<=2IKF*:RD:337/P*UG?5FE=0XU(*/A+4Q6Y2IM(+LVR6X\@F;R
MsgBox Err & ": " & Error(Err) 'WB[8X;QTQX,<LB@^*]5]1IER*?(VGU6\W=<
Resume Next 'T>[H:OJWO0VZL.KL:VN,ACQ/+Q/R)>R95;6(WT:TOP<E2E?03,7=AU
End Function 'E[-==16E7UG,DSYM1L)9>PI=,:8/D3:7K?.X792FQRFQNM[B-UJ3O
Function azItemDimensionsWidthUnits(ASIN As String) As Variant '1<>
On Error GoTo err_skip 'U;+FVC1RXN[G;\?LL=7V.<A.0\[;R?U]57P(+:991--
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ',;8XT1-ZI89K@Z4
azItemDimensionsWidthUnits = CVErr(xlErrNA) 'MHA7Z>ON=,I@0+2><<J1,?
Exit Function 'H0MF*Z6IWW?8??5C)6,4>O2RCFI(AV<([7RUEE0IL\MYCID45>5\
End If 'P*G)12(:LJ*<=6+SYKB3[W(3;P<G7.[XIK]1PDY*>OUZ+;BA.:4@W6:Q5CN
azItemDimensionsWidthUnits = aazGetSingleFieldMatchingProd("Item Dimensions Width Units", ASIN) '
If azItemDimensionsWidthUnits = const_err Or azItemDimensionsWidthUnits = Empty Then '
azItemDimensionsWidthUnits = "" '^9;05ZQK^57O^WV*8>/T<7<K>T6RV<398]
End If 'MQU]V]7BWD*/7;ID2MKK:Z0I5]U<XGOU9,.3R;NDX)YF5ZFR.QVUE-:]@HB
Exit Function 'UFD=ZE(U+\>R]2]EE3+/B;]KA43N8[O?BEM@]P832V[H7]HRKC@2
err_skip: 'P.8+8IDEM<S47PC+2)X9<VCA6CS3CK^XZ;8]U34(GT6E2BSFH30)KV/Q
If Err = 13 Then '5MDD0WE^=<FITB4LIC;/WW(.@W(;+3N8D4R->\F*XSA5P3MAM
Exit Function ')L4+/KI4(./(W6XBBC0.HC=V<F>E8\VG8UXS]/0F4^]3.+UMWA]@
End If '/W:1;:M^E0=HRH\E1U0J20;P)@5VCXO@^TZ*Q*R*?8BSRUFZM@TZCPZ]D@X
MsgBox Err & ": " & Error(Err) '?^V*V14=H]*EF[Q\*GU]GF<+3*\A[<IR>\4
Resume Next 'Y/;SCR;7O6JB78N.,\SV7HD+JNW1,9<WG?HU-TRI-(TQ]IE4\S)(/^
End Function ':=Z\Y-QO)SV70,-<CCP^8<M[ER:?S)O.?/G8[M]9IX*6<[+(*FI9F
Function azLabel(ASIN As String) As Variant '?0J@S*7R1(89]?SS]F=<:=
On Error GoTo err_skip 'GX@OO/SICLZ7B^:-/,2=[Q.*[6</97,,CZXT44N9,TW
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'KIV=Y-TEN<8:MD[
azLabel = CVErr(xlErrNA) 'WD>LV80>XLX)]]H6:SJ[3T^VM\[-*VOI+:UXVB/]O
Exit Function 'UND-YU8BT.EQ@9+1BEEG(\D/,MQ<QXV<51\<?6^DCXYS\W2?QGW6
End If '0/FZ^@FCO(R:*W\M?M]J^+OZP2B8TK?V4>;QQ6M6)=ST\,BH;^Q/V7T=^:<
azLabel = aazGetSingleFieldMatchingProd("Label", ASIN) '@*>U726NL9<
If azLabel = const_err Or azLabel = Empty Then 'GX*=:6.RGJ)3^>Y?6-<
azLabel = "" '^F+YA^CJ?WLYC5(NRKCCYW6/A^J[EL9/BEUB+.31SR\]@\8HZOF:;
End If 'K+;]([\P6WAHU)K91G;;UGO<G2F-)2X?:H\O7J99D(5E(7<IZJC(CNY.C]G
Exit Function 'JO805J:WU,T78O)D2D;E<D,F(LEH[1F5)T*X/OXW\:./;G81Z9.V
err_skip: 'NY](EJ;@SGM-]P9,NV=][E5SFW.\^Z[N>YDJW2]BUY9:^E9T5[RO(EQW
If Err = 13 Then '*,XI68W,Z82;G4^>8K0W8SH;O*I3MRN7O9A-34R8;S940U1XP
Exit Function 'AHL*=>VXZWB2H9/HJQ7\>]4K]L;VT+G2+L\OP4RZ9,M5KF-IZX(>
End If '@P:5WL4W<61[M).M\^3O,(1]34[KCOHH0B@\KI@X6UWMW,.1[F\1QXT=*FB
MsgBox Err & ": " & Error(Err) '36,4P6K^3PXJE42LN15^I0A+;0[DN7>VNHO
Resume Next '>@]>1*J:^(R^Y]*Y9C<A0OVU)BF](DV37(PO:8ND5(CD53C^I\*3J-
End Function '234MS8N:T?]WA-8+F]HSYIZ9^H;*XWZD97UG-@,RQS23BZ2801Y1W
Function azLandedPriceNewBuyBox(ASIN As String) As Variant '=PH<1OU
On Error GoTo err_skip 'K)TXT6)GYPO@IU^7=S<GL]2590:WF?^YS[W6+8E3?W2
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'CE1H)FIY:+]<B7K
azLandedPriceNewBuyBox = CVErr(xlErrNA) 'Q?\NIYJEOT=.L78F)9^9HB;^EY
Exit Function '07\KJZ,EC+L]U8FPCST\(V.]HJA(A50CB\(;[MPMKTQH63+>WA@+
End If 'ZXHY26+SKPF\HTQ56?6]EF>5X4<DQQKA(-H]NJ>F.,3Z(P@P/YHQ(GY1\>M
azLandedPriceNewBuyBox = aazGetSingleFieldCompetitive("Landed Price - New BuyBox", ASIN) '
If azLandedPriceNewBuyBox = const_err Or azLandedPriceNewBuyBox = Empty Then '
azLandedPriceNewBuyBox = "" '2R\7JXJF4/)13YVICB(J-Z3QQ,J^S((P8@U^GQ
End If '\9V9YF/P*0<)85VQ+>6[9CK][N.P:K2+0-14DKZ(3MSP9PRM+[(PZTC4S7^
Exit Function '/@/1ZA2Y3=82QR9PDC6WH4L3.1<GS3A+8^?D4HJ,/3+4T32M]:9+
err_skip: 'D(M41(,*S0]QS(/8@D<B8ZD5L,E]B^*-=C].,=HJVIIN>SPJ)(6QQT0F
If Err = 13 Then '35?MCCHN+1RVTFW]D@>(N;IZP2F[7)U\Z519^REMVO<5-5/6>
Exit Function 'S4^2-*NYN<H[SOZ)GF18Y9R*4U-NJUR\8R151(0FS]/1>X:,BC49
End If 'Z/=WW,=D2?J8OFA<^F31N5]K2=]D79Y^=EKKXZ9HES:RCJ]O7K)<.^Q5FU.
MsgBox Err & ": " & Error(Err) ':[GA[PFL,69D8B=D[VG8\1VZU@FG]-L5-@G
Resume Next ';GH6,9[NC)+WMLXCO]\D1:\BNV@6\IW*N<WC57Q4*)8EI/O6LF^,BB
End Function 'WJ,YNDCF0+68*4F<4N;LJ*^\<.^C;M0OR7W77@M9)]0\0M[-F5+=S
Function azLandedPriceUsedBuyBox(ASIN As String) As Variant 'K<675P
On Error GoTo err_skip 'M+WV4Y:T@)NIEF*/HN[KMTN9.EO)\6+GQWCUIJA@>?H
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'Y?[IQN[BP-SXYZT
azLandedPriceUsedBuyBox = CVErr(xlErrNA) '/<AX*)B.L>)OAD<YDQM5]8LMP
Exit Function 'O4VLM\-WCF<.SPV\S@^]D))K@RC;/C3T8I8G.2PXJIWPK*95LH43
End If 'TH5NS16M.IZ1C0?>RHHQ@Q[A9A)LCO)MJ]EE5YLKG2=]<P-.8^?)3M;G[IA
azLandedPriceUsedBuyBox = aazGetSingleFieldCompetitive("Landed Price - Used BuyBox", ASIN) '
If azLandedPriceUsedBuyBox = const_err Or azLandedPriceUsedBuyBox = Empty Then '
azLandedPriceUsedBuyBox = "" '):9[Z,1;]5ZO;(7V;Z^RV+)@IF>]53^V.DJCI
End If '8*+P:JIB.<<H[P[)=9MFS>R?\YG>-A1,*Z1:PUX.TAFDN[^YPE<FJ=9>4=5
Exit Function '4P<@*JWJN@CV[.@:Q.=U@T;//+PYE2JFQ-@OJJPH.24Q^P22WV*F
err_skip: '^5X7Z<1M3:\JO)GXRJGO+DX+@=EL5H?JJY?3<6KVU*,<*=?E6T-TL1M=
If Err = 13 Then '7=8.</3+SDE(@834=Z5LF.N:S^NU,*Z2/S4\,<AFEDPTUSNRF
Exit Function 'TF3VKP(NE]S)P,D)A+>-8LHZ*^^PRFB^[;8/-AHLBI?D05VG3J9G
End If 'VZ7XN9@AW8>5VIYQJMOA8C]U,PNEC/O^U3J1T)4EH?(9[?,.NT0HD(ZAO9I
MsgBox Err & ": " & Error(Err) '(5)WVC.4Z*F^U)O=/X/CY?.[L3VRA-FS:+/
Resume Next '\3R<0P0N,D;LP0ZMMBP4<N;IJ^P/<)(<O,PP305;6?4.+)P(AX4L:^
End Function 'J0[E-PFWP*,)6VY3*PNJE5BJR+O,4GV^XI[@I@LNK.EJCY87*,KVQ
Function azListingPriceNewBuyBox(ASIN As String) As Variant 'O57NCX
On Error GoTo err_skip ',POCYNRUN5H8W4@HOQVQ=CC3[<JZQ3>Y4^SSG+D^)R<
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ',/^51PPJ<9L+PF;
azListingPriceNewBuyBox = CVErr(xlErrNA) 'LIIY0/6=A.(?VQ],;(/,0=Q35
Exit Function '>F,5BT2ILS]<3Q@-UN@TRY[26SC--]-0IH,WNZDK;/I?1AD59A=5
End If '[6(B2.RD>T)(=JD)+L@:2@W)CI?A^Z:=EID7MU.,R=1^4WEK-T2G)5FO0B8
azListingPriceNewBuyBox = aazGetSingleFieldCompetitive("Listing Price - New BuyBox", ASIN) '
If azListingPriceNewBuyBox = const_err Or azListingPriceNewBuyBox = Empty Then '
azListingPriceNewBuyBox = "" '6J)^DVJL?KV>3@26.EMUJI^FQJ,.QV\0(4G40
End If 'I7TDQ>)84N7C1GX;XXQ?MEU9]1P>D4Q0./+<=[/YR(BF)^H0I4/*M.>I+^*
Exit Function 'V7?GL6E=\;A05ZT;1QI3/EC,-23/JQ429:SZ7>)/^8BH>^SO5/HU
err_skip: '28Q)@Y.I\[D,P4,=,JR]OU*N+=W)VZX<YNVP8==HJ*X+G<O8Q7Q.VK\W
If Err = 13 Then '(-^E/R]KT^XG7*E@C0-5RBZHJC@I^AI0E>39=,S+[:H4)NVK;
Exit Function '>J^@6B5?AO91HI/D;+QW^A[BXLW;D<4(CP?V+/-@M8Y>XHD5CJ\F
End If 'LW/GP;V4NV<Y.GG<L3^;:KF9O\GNEOW8FC8WGK@\W5E5IAMNX(7=G[S7UHK
MsgBox Err & ": " & Error(Err) 'BAT17*9(Y\HBW/)>D142BPBUA5V<6W/:+L>
Resume Next 'C5/TKSVU9R.L1:8P79K[5ZAUN>P/T7Q=6F9Z<;S+ARSHDXW@-.DI>V
End Function 'U3S3)8ABKB0^NXCH0].8EBX8YEF1+(D?*0)6PI:KZ<>B=9Q1AS<>O
Function azListingPriceUsedBuyBox(ASIN As String) As Variant '4<P<M
On Error GoTo err_skip ']R(P*JBG+/?A:PMV,(DI3H-.39^@=H*[8+=Z@AVS7TB
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '9^[XNEDOHR:)NM1
azListingPriceUsedBuyBox = CVErr(xlErrNA) '):/4=S86VU2Z3,I:75<F4QZ[
Exit Function 'DN8MTU+.FLGR7M5(28E[9D8FYN68^MRL?*W1ZQ?J?]UAV-LIU0M6
End If '^*V@V?,UGV3FB5)?0I*49HZ;Y3/L<Z]K7SLU1.\<F0M)7+U418K@R)0Z?]X
azListingPriceUsedBuyBox = aazGetSingleFieldCompetitive("Listing Price - Used BuyBox", ASIN) '
If azListingPriceUsedBuyBox = const_err Or azListingPriceUsedBuyBox = Empty Then '
azListingPriceUsedBuyBox = "" '1C3*Q95L)A7<HU1]3)JL7M<CNXN)[^+->K.0
End If 'Q+N7H2H^@V=N:?-=*3::HKY.)5P(=:*A+@M*2JOAE2DV>PK>(4A5YGJ>R4+
Exit Function 'O^76/VL@ZQ8OT0137/6(WN])K.O+)OU/STP+6X97\(F\3M<4:JX[
err_skip: 'IR^B-F/S+5E=3:-ED:E0-F5..)AV.OG0B^W775;73^YFWZNL8ASCQ?*C
If Err = 13 Then '9G)\AB?ED0.FD9D]I64;0PLQ+V*W;<E=]7UMWDNM:[*]KM,6Q
Exit Function 'TI)5=*DP99N9;(DC.*LDZ:)*UA<*^P;Y7AKX)?@N0L2>BC?I9U.S
End If 'FHRDS-TX?3HGJ,W61UJ/;4X3XLU[476),E2C3TO*9>6HBST.E[NQ[.>-LUQ
MsgBox Err & ": " & Error(Err) 'Q0A<R35D0U48]3Z[-ZN2TFR2:LJ<ZVCQ^06
Resume Next 'R0U3,ZTUS7>57)W(U)/F9C0A]E23DXH]>XTVBWB0QG]1E[(\O-OC:N
End Function 'D^2?3@>4J(I6Y7R+S*;\FL-.*GEM0073@T\A)707M6KS8/)ZC1:(B
Function azLowestOfferNewFbaLanded(ASIN As String) As Variant ':1EB
On Error GoTo err_skip 'X\[8?VWZI:<H2)81M1:TLR--?U1AQSOU(=,?@MR)T1L
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '>T)65\U;S-4Z(]7
azLowestOfferNewFbaLanded = CVErr(xlErrNA) 'J=->ZZCA/>]HC>VB>0GOQ/N
Exit Function 'T-]GS*QG)V/@O2(7*Y+V<2K]L@P?6\?WS4;,:4KG].Y:=,HQYDI]
End If 'R@W^=)*[A?76HZBVF3?Y^=EO8>XLPEA9U5M^)42<HUSAMFVZVYK8F?8[2.J
azLowestOfferNewFbaLanded = aazGetSingleFieldLowestOffers("Lowest Offer NEW FBA - Landed Price", ASIN)
If azLowestOfferNewFbaLanded = const_err Or azLowestOfferNewFbaLanded = Empty Then '
azLowestOfferNewFbaLanded = "" '[6,.P-.L>B(+.ME:(2REY6GACJ3DKH?VZ3F
End If 'F,Q1],740V5OR]6X]C>C3P/71.>?.A,?:@E1]2I7^<LLA7*;.>NH))*0N31
Exit Function '85PFFU.0T4SS1ID6+7N?O-)7\5:90,V)F??UT[8,K[]=(3764:WX
err_skip: '0A5Z8L\1SO>2SPH.QW?6D2YSC(?>46GH03TWI=U7-XT>TJ+9=9^X\10?
If Err = 13 Then '@/RJZV>HL)TVT/.4Z7H994DGQJ?N-JE:FDBZVU4TZG:PNQ:;4
Exit Function 'T76*RSV5EI:5?GP8NPE9J,9UVET\Y9(^+9PXB(25>:*?Y+GZC7-(
End If '?N;4DGI)MG:[Y<S9VGAMVJ;/7)5=^S?J.0F)(BP2JF)+\Z(]UON^XDK@ZF<
MsgBox Err & ": " & Error(Err) '6R@4-XC,PHT4?@LF];CHA;5=5TVY(T/??RZ
Resume Next 'CH[\)U^SQ0R<?,:WKOZXF8</-\Z<1M)=;NMGGXTA<E(H*B@Q=4.7>E
End Function 'C8QGEF0):TMWZ+-5*.X=<-<SR<=H-DZ;[P2(X>X)UZNXJM,R(I8EQ
Function azLowestOfferNewFbaPrice(ASIN As String) As Variant 'O+B8<
On Error GoTo err_skip '0SVA7+AML*3A@CQ=7AP,D[(DJI3>Q,A[N+>L](DV7ZE
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'H.MG<[-ZL7JVHJ?
azLowestOfferNewFbaPrice = CVErr(xlErrNA) '7VIZ>,:LK1W(-OX1->Z[?R(B
Exit Function 'C\U>73;0<8A,,\>PTTW>VX?M=84?]:]X\O,(=,26-SV:(W>>O<;@
End If 'NP@)K@)B^DRJE-D-3(14U=J=-LYFXPF/RC8+QAY.:P7CN6)L;3W=OOM-9WH
azLowestOfferNewFbaPrice = aazGetSingleFieldLowestOffers("Lowest Offer NEW FBA - Price", ASIN) '
If azLowestOfferNewFbaPrice = const_err Or azLowestOfferNewFbaPrice = Empty Then '
azLowestOfferNewFbaPrice = "" 'N?*(^08.>(MDXTZ*R^.CA\:S-VB1J?C]]>N6
End If 'Z))D4?]6=*-88BF[I,:^@VIT9A6E<UQIVH0FP,G]P?HWD)3*.+W(LBTW7.H
Exit Function '[VGD[WU/7B1L65/=CEDN@9ER+^-MVA?EZMY-D.*FSR\?I6U[W5TD
err_skip: '-1HY(G96CF8N5=W,3CSVHJY8^3Z0\+D4D3IB<-(:VY5-D3ETW[543>?*
If Err = 13 Then '2X<?3NKRZE<*\0L(SJHCU9<YK+P+BNI=*MY+D*SPRL]8]L>\7
Exit Function '5YL9]UJ<22T4I9E+>5];]?.2YJYU43JB*ECD2LLK7:3H[/LX=(F[
End If 'Y,(9R3Q^:)[KX*1;U8<-ND>0:DYB:W5IOM*F]ZL/2H]DCFBXW;PE[7Q07[^
MsgBox Err & ": " & Error(Err) '6X6^(HAL?9J<,:TA06XY1BG*8KO^JEQZU0F
Resume Next '0?ZO)K,([OJ>+R@0<=3>6]X65HN/]R73EW]B[;HHZL3<Y*<68T@5)R
End Function '5QYA*Y5?<DTH?UJ5BY]R=]L.>)?;<?LIZ)<5.?:/:@J?1[6<]S2B8
Function azLowestOfferNewFbaShippingPrice(ASIN As String) As Variant '
On Error GoTo err_skip '-B4BLV,5JH5R5@VP6N9WAK.Y<6E^56W:A0TXZT.CU-?
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '8)162O=)RAVU.A^
azLowestOfferNewFbaShippingPrice = CVErr(xlErrNA) '5EG5L]@7R9S?/-+(
Exit Function '5-^A9RF5V^XJS-\F[-TI+(AI;D]62WL7*[WHKRIWF-R8Q5=IK839
End If '>73D0L:>YER3>F806-IO@8-43=YX86/Z59</-GBB5XI-FK@CVEP(@J*B,QS
azLowestOfferNewFbaShippingPrice = aazGetSingleFieldLowestOffers("Lowest Offer NEW FBA - Shipping Price", ASIN)
If azLowestOfferNewFbaShippingPrice = const_err Or azLowestOfferNewFbaShippingPrice = Empty Then '
azLowestOfferNewFbaShippingPrice = "" 'X)L276(<<>JKBD1G5SX(@YI^4E)*
End If '5F2B4H?176-/ME+1]K.4A@3M,Z^^C[=I<7L0(YDN/>LF]X?)KWOKKK7BQP.
Exit Function '+Q?(PJ;WD@H:P.^4.1B(3T+,Y0Z-9Q]KR;E-4Y8PTXA4JO62ZIJ.
err_skip: 'AT[/]F7I6R@TR-/[(U+3==;A>6:/VS=9AH45P+8S\+FCI(:LX,HNGT;W
If Err = 13 Then 'B*KOQ.-HPK;FY75O0=E96SD(>YRO1,,EK-WYT.C,1K8VMZ:BV
Exit Function '07)+^9@B*FV.SEBXX?GF2KL-5O/(V4Y*^7B4]*6]UE]HYOD(SVZL
End If '(,B:SS=OG[Q=<20*67\P+@ZHD:TJHV:\)GA/2/MU2/[M0(;BR=LC5I?44>[
MsgBox Err & ": " & Error(Err) '1HG.A0VMS91B<]5@.(K\SI2DLHM[05KGY0G
Resume Next 'M7(W4C^:P:I9HN(WVB94-ZIQL32+Y4-GZRZ/@OO*]N>2,\2F289W=G
End Function 'F@D?^BJNK8,YH^LD]AKD=0X/PT0X(MOVG].-K<8J\^]3OF-OSNRM4
Function azLowestOfferNewMfnLandedPrice(ASIN As String) As Variant '
On Error GoTo err_skip '0L;:2B@R]*8V38[]Y7(W3GNALO+0?2G1,=Q<=*=.ELG
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '/(4]SE?8.U\TQTK
azLowestOfferNewMfnLandedPrice = CVErr(xlErrNA) 'Y/E>4AT*,QMA*CQJN:
Exit Function 'FB.=Q0P)OXT5)<:WRK:N)NW;L=>0.G@EQD5A6D(29S-=HKO6\TN2
End If 'M2BYRXR.[,;0Q/\:D4UA.ORR4L9+KP>6]2\+B8*V5V+]F)80HBL32HP]00(
azLowestOfferNewMfnLandedPrice = aazGetSingleFieldLowestOffers("Lowest Offer NEW MFN - Landed Price", ASIN)
If azLowestOfferNewMfnLandedPrice = const_err Or azLowestOfferNewMfnLandedPrice = Empty Then '
azLowestOfferNewMfnLandedPrice = "" '*V([>]3W3[A\KN2\9*;.2GCU]V2>AY
End If 'O8D@I54^6OO-BM.1HD?,K:9GXM6.C=RYBQ+,XXX:8;CGD//(BMA=C;BDP(I
Exit Function '8[<?T]P.NMKCBYLN6C3;UG+SMR;GL]@9F3?L(NGCV<6G@>^2@0P4
err_skip: 'S^.\>,2]\U[YZ/U3917?2/TU9+9@-*Q=UBU8-X.0GLB5W6FFOLH+JXDQ
If Err = 13 Then '-EU>KJF9VGBI/C?RU2>Y@C3OM(6Z5.WO5*BRJC@.)3VJN\JBT
Exit Function 'A]J:ENZ5R;.EDCOR[5UR7:?F@M16N^2IPT2@YJ^CP@]FN:0P6D2-
End If '.QJ)?<:@SST,(YA>96L5XTMC<M-8,A:1^@DF9:DI.3:4<BJ4+CD]O(Q-+1^
MsgBox Err & ": " & Error(Err) '0Z:J,[1RZVA,PCC4S09M[:145W<EZ625=57
Resume Next '(]B\XUU@//XI^X(<=PA/+-A3T0LR\AOX1I4R@/WE>QPWRW,01..U/F
End Function '-1@++Z@F=V5H(XH=A95YXAPQ?R=?P^>HYS<R>B^3E^]*\17MC;HA6
Function azLowestOfferNewMfnPrice(ASIN As String) As Variant '<5?0-
On Error GoTo err_skip '>WAL.,Z/CSE<UZ(HD+1I21NO(I+W2?N^]UCOF(E4B,[
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'AL/LN<ZQ6BE<51N
azLowestOfferNewMfnPrice = CVErr(xlErrNA) 'QH;<UJP-;5@?2DNTW719[D9E
Exit Function '9LLM^K\=?\8NI7]ZB7:^+D*+KK:<9ZS:RY/Q78@F\8BB9(;7^)=\
End If 'QB3K4T9<+;H)[FU).VTUQ*/A;^67>C\]?=LV+(E8IP>MO^019860UMINH=L
azLowestOfferNewMfnPrice = aazGetSingleFieldLowestOffers("Lowest Offer NEW MFN - Price", ASIN) '
If azLowestOfferNewMfnPrice = const_err Or azLowestOfferNewMfnPrice = Empty Then '
azLowestOfferNewMfnPrice = "" '4\TJN\Y9)Z>SQE:(D6;H]>G/)H7G78^/PVX2
End If 'Y)0[]XD2BSO2\7T:A-D(2VQ,Z2=B(.4;DF:+G0DR(@,,9+W)O=E6G>)C*M:
Exit Function 'TOE.3G+D5+^N(]VLZ0V3S054:\Q.N2<@<=<^=EEYM\Q.M:P-6.]U
err_skip: 'CM)[9.4(8RS,,Q.BXAWW0JMTAI6SJ(G@.D?[K\2R2HSH\R,FYN4K:EF@
If Err = 13 Then 'G[?HS0AQY;?8/1F>IIWRQO9@]A(UPXZWJBHLXV96,G=D-<OE7
Exit Function 'TSZQ2\PF6J/8CV-T(@24Y@9ILQYIU)*E(P:L+N@JCH<97YMUM-.P
End If 'WXC6/2@*,JC0;;\/EKSOU(:?XA:I)/2IH.D0GAV4CKNSJ^T45IMI>A9BSJ4
MsgBox Err & ": " & Error(Err) 'XXL\?AL)1GHU>00=..3GQX,O</7D[TE3V>Y
Resume Next '.JP[D06=7LI\]S\\,8.S,1--C-+<B]4M>[:KZ>/R+E8\TS>2KZ<KL(
End Function 'K(=\EJWYY2A?FQ>(ZLY^O9/]^+:9@A0*WL>WZ3WC3X?:C^C/3RN44
Function azLowestOfferNewMfnShippingPrice(ASIN As String) As Variant '
On Error GoTo err_skip 'D@79:WJO*1J6,@-7YBKT+)4R:((C4:<HGM<TKL0=26[
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ']+ZITGG=EBYFM49
azLowestOfferNewMfnShippingPrice = CVErr(xlErrNA) 'N+C5LGXL.AM\6.JK
Exit Function '23]Y<;G,\8W053+[*N5RI):BSU:H9SYQIX)@DE1ZF9@A3R-RM==O
End If 'CJ=M:2U7^/DQ/5T=\T6UK*V;8DBN[YHPY+3R;7,W1Q0C^<6@FS.Z4GA^\VG
azLowestOfferNewMfnShippingPrice = aazGetSingleFieldLowestOffers("Lowest Offer NEW MFN - Shipping Price", ASIN)
If azLowestOfferNewMfnShippingPrice = const_err Or azLowestOfferNewMfnShippingPrice = Empty Then '
azLowestOfferNewMfnShippingPrice = "" ',)^O^3/D\9^MH=^1Z5;K0WGW[9/U
End If '3AD)[K/\-I1:K+SUDQ,->-+7U5N@8/=EY,E9*>DTC>OWJF*XX]?*L-WD4N>
Exit Function 'D;3NDUH?)GV>[?S=\V9H,<2\?8Q;0M63SA-9P(G[*PK/>.56@YD\
err_skip: 'X6[LMLMXXMU[@.>U.5V9CU0?8:8:U9W<T3WB;4)K7G)TDX5\(]H;JOM7
If Err = 13 Then 'MX^FA9I18YY=MYL*-N95:USB]6R]9W0>A6OQGP-?BI]JEJG-L
Exit Function '.PSYXBRF?GD;^04/4))T:AK?;2A0NLMU-IN>GQ\*STO/OW?L8P-]
End If 'X:DC:3@@OO47P419;B9?OHKLA3D-3(5X<;]E-9YIITG@N)K6A7IF:R,E<Z.
MsgBox Err & ": " & Error(Err) '3;<C6?K75O:ZG9--N/:IWQ99*HZ?/5=*@0?
Resume Next 'JCBJ*LU4I,CRC(2B2U9C6H=FELQZ:WG@-M\*5QD50N^1F,3J0O9B:1
End Function '>X0]C,:3JA.<WZGSAKZ</OTO8VUMSG4[SC),WX3QAD5,BRW>2X-5;
Function azLowestOfferUsedFbaLandedPrice(ASIN As String) As Variant '
On Error GoTo err_skip '(VQQWM>F;N*W^9]-JM73?2;=U6D^]9*E4-76(11LXIZ
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'NF>Q>.U:<2\35<6
azLowestOfferUsedFbaLandedPrice = CVErr(xlErrNA) 'ZDP]Q:C1W\Y=1C/<<
Exit Function '1T?XRK,GW1>2FSN-RH8GRFS0(-C75W,2SMH+/WJARPRV8==GNM>*
End If '\HXG1^N9H+L+NZUOLI6+UMO^ASBKWOE0DF];L.G\*OOR[-H>@FC([EE:X1B
azLowestOfferUsedFbaLandedPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED FBA - Landed Price", ASIN)
If azLowestOfferUsedFbaLandedPrice = const_err Or azLowestOfferUsedFbaLandedPrice = Empty Then '
azLowestOfferUsedFbaLandedPrice = "" 'XN-9C[80]VV]BMEJFO*C*.C?GUGR,
End If 'VWJ*0>YX[>+-?RSO>J]18<R(;S+J1H.;E*=W:]QI[[TRHNJ:6ZC8K-6?>TC
Exit Function 'TA1.E8XN^DK:H@YQY]2@:<*Y54.2/EGX19P)(4)DQB^N6/S/HDVP
err_skip: 'JT/R@8.P/XM:SU<Z1>L4]07/87UU@@Q*\I@PV8IV-+Y<C1YPID/;^ZG@
If Err = 13 Then 'NX70@4EM7O;JA9;BJ^5>7Y*LR]E41L\NS[\?KGUY8IX>^36XY
Exit Function 'O=L[(H.J-1.QK\LHX,]T][AEC@WT?HR4-47QE^]^.K.A7H,8PI/.
End If 'E(UZ?6H5T2P7D]](9R3M:T+HCX<28-4;SR^,[JO2*9V@F+)\-H9JK?E,25Y
MsgBox Err & ": " & Error(Err) 'A+-T[V?,IH15:)2=:WAG-ZC]HH8BQ=9>0W\
Resume Next '^ZXIPWO;],EOU]RHK9HU)-G*2GKRB=5[87W>+MOZLVK2[)<<E-\J^1
End Function '?:<O8Y@E(H5L2C?R4GVSFG.A;)<\>N6V4(6;C^-QO7K.(ES4:ZURW
Function azLowestOfferUsedFbaPrice(ASIN As String) As Variant '63<L
On Error GoTo err_skip 'ZDM2S+O:Z9>2V:,+KRA4O8)=T>UT=A=27ZY6=VO;TN]
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '[1ASJ9JQH1+HW0Z
azLowestOfferUsedFbaPrice = CVErr(xlErrNA) ':3@I108-PF/QG(1MV;\14VT
Exit Function '38HD+;[5]M\>YU-INB6WW?6KEI60KHPW<,A6W(WT0BJ9A6B>C?85
End If '*Y9MOFFK.E0>8XVB)4CM+<E@B/82<>\*JC?S2LL-<(3\EDY=\>\;(M/)B\=
azLowestOfferUsedFbaPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED FBA - Price", ASIN) '
If azLowestOfferUsedFbaPrice = const_err Or azLowestOfferUsedFbaPrice = Empty Then '
azLowestOfferUsedFbaPrice = "" 'E0NSCZP]DE/8+?/B4/PU+6KB3RDTJE=(S(=
End If ',PF\N9U=US)/M/F/7T9IR\6XZVWDWG/J2*L<-0/Y^4U;6QH529^^<ULQ,Z[
Exit Function '7:X>QI7KV.IA7:JFW==UGX9.T2HXYYU?WAY,A32W@EV:^8DGII6I
err_skip: 'SOH0=I*IPFG74X=F?B57H0)V>:MA,-<QB9SJQ,Y7,CQIJFNNX<LP0KZ*
If Err = 13 Then '@NSWUUQ3<L/N0RP8>5Z5</)S>8.*39[0DW,GW0BXMO,FH?S.+
Exit Function 'Y8XOFB.\:XX]M(4Y2ZKL1=29DH*NSO.;B+,HJ9D\L]>WB4U?PYUL
End If '[JN6P=1X^G)7/>^<2?J@2+./)3^R>6>+27AQTCUX.\NZ:AWE=W17<@-Q:IN
MsgBox Err & ": " & Error(Err) '+</1QW2KJNF.N/I8EPF5AZ<]^AP4C@@>7=]
Resume Next '7)SBDET+7(:XW<.),*GKFVM+=<42YA80Q]Y35R]WZ)G6>O8W@>-564
End Function 'SD:IGDFG-];UBGEL2(T<L)O]1TF.+DL:^/[DNBHEWM442H(MYO3D4
Function azLowestOfferUsedFbaShippingPrice(ASIN As String) As Variant '
On Error GoTo err_skip 'A\DNQ4G8\TDD<GA<(<6GR3EK2?S9,5\0TE(D@S(GA?3
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'C4D@OA=60LA9D;@
azLowestOfferUsedFbaShippingPrice = CVErr(xlErrNA) ',\-TY(V6V>+H1UT
Exit Function 'HFNK9MOL<F3((QH:^6UA8CUE,<\6UKY<WKQ@*08XOAL3XW)FL5W@
End If '9E[6O1V?SG(*WV\,;Q5>^7Q),@.B6BHJ:()D>R,L99U?43ARG6;4.06(A5Y
azLowestOfferUsedFbaShippingPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED FBA - Shipping Price", ASIN)
If azLowestOfferUsedFbaShippingPrice = const_err Or azLowestOfferUsedFbaShippingPrice = Empty Then '
azLowestOfferUsedFbaShippingPrice = "" '6SY=NV\WH=T-L1PM11@OV(IC[PG
End If ';(ZRZ]8*(2?JPX[HL]=7DQ2M7ZJX=L;)85^83H(9-8ZL)WHRE,\[FQWK;N4
Exit Function 'O-V4J?(BQI*WB+)-?C1M];=Y]G34WCZXU-[J<=CW-1C]L(LX.:WY
err_skip: '0YJW5AMHMK(8P.T>^TM66RNLZBVQ=1K)\K(OM2A=SPBN-;.CV^Z2J:-7
If Err = 13 Then 'I((41+W+R*P-Y:1.0WZ.K/^=EFU]UVP3CYIOTQZAXWU3DKO-8
Exit Function 'T\/M(IPGDU22+1=-*9Y]FUI?M0M52ZTQ3AI>@D:M?;W9,YXHJ<8)
End If 'YW/+ACJP=/J-7H.==NSFG=4[JU6*UVLNGO^7E)O:V[N?JJQ2S]EN^CP\\K>
MsgBox Err & ": " & Error(Err) '2KT+Q62FMI-6G,?5WR]+=>HUAA\>\F6(U,;
Resume Next '.ZFA>]QTKI+GI9B(D0=6]5^,ZD)G)SM>7\V7QBF?R9LH0QS0WQIBSC
End Function 'RB29->ZO9O=<?A3^H2IC:@I6UPMFK?=4F6AJQQ*Y/13;-EQ46Z0HQ
Function azLowestOfferUsedMfnLandedPrice(ASIN As String) As Variant '
On Error GoTo err_skip '(./(SJ;D/:0@I@KR:5A(]P/RH<XQ2-CX/DHI,G+K^0O
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'BN?54OVPOC^6IM.
azLowestOfferUsedMfnLandedPrice = CVErr(xlErrNA) 'ZWB64SD^Q@.R]3OC<
Exit Function 'V.?]1G+<7BS.CS8B)G^EO43HN*LSKZ2^[@I^<-*TYT5=QN@BR.0R
End If '\GYIZ:]A20U45298M582N73MX,])360I<<9P2APSAM2>]804M[2G;XIL5^9
azLowestOfferUsedMfnLandedPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED MFN - Landed Price", ASIN)
If azLowestOfferUsedMfnLandedPrice = const_err Or azLowestOfferUsedMfnLandedPrice = Empty Then '
azLowestOfferUsedMfnLandedPrice = "" '4IDF>?:JV>ORROO/Y*Z6D8-0UM35D
End If '91EV1/=:PHUZI;N(;2*MKS,2<]P\6-1?KTSI=(4C5]Y);YE(]H.HC;^RT57
Exit Function 'R[L[1)O/Q\4\G(K+8UA.Z(-ZO2(-K0/[Q9D<[A1>+J6K/<@.V1G<
err_skip: 'Q??D9@=NR7I6QDDY)D>ULEQMJ7YEE@Y4KVO\/DF0J1GAY[M0)7RLA7)>
If Err = 13 Then '9)N1@(XD)QC?4D7*R(Q-AF?<,N67=[;TCN\JBMFC.8?Z)C:[^
Exit Function '4JP;UX-1[/VJLV2AZ13MM]WQG.0^R[H1),X@[=\@L:)OJ>2:LZ+S
End If ')JM,JE-KROVT:5(=GRWLDU50@04MK?(Q?8).>C;F]:=)0>MZCD,NA[1NWRX
MsgBox Err & ": " & Error(Err) 'N;3J3YL5H,74@F.28Z@1OV:Q@@ANT]5IFH-
Resume Next 'DY6EMTC6LS*4-L0.+*=A+5AC=2-=MR5DS6H3S22H?5@OEK;(^GWTR^
End Function '^QYT[6J5.?45U>.6(B9PJT+G7KCT/CRI,Y6?)*+BL(UA5(N?V(K-J
Function azLowestOfferUsedMfnPrice(ASIN As String) As Variant 'A8/5
On Error GoTo err_skip '4*O2CY<T,^V?=W)MD,V+*LRE1Z@@[?NH[8PP)PG/BPP
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '51JR2/L,;K9[GW9
azLowestOfferUsedMfnPrice = CVErr(xlErrNA) '?MPFTZ2(72GD,+6PR6.[+X)
Exit Function 'G,RE;?W[6JN@^]=BUXR<=PN8K,LM^\GESGX?+2U8@70X;WR/A3^)
End If 'N8YH(C5(NV7)B5(6T@+<(F]6LTPE8RF32GTIJE>M1\39=4X/N0UAECC@NX]
azLowestOfferUsedMfnPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED MFN - Price", ASIN) '
If azLowestOfferUsedMfnPrice = const_err Or azLowestOfferUsedMfnPrice = Empty Then '
azLowestOfferUsedMfnPrice = "" 'D.)1=17B@>HQ;L+WK5:7[^@3KE(*OVR[QZ4
End If '-3GHJU:O4B;\VR/VSBN;VO]UYA=\J1U1GSQ2=^FW9D56)]9\GRXJL8,[5=O
Exit Function 'A2*I^:Q=393\X;1/=YG3NJJDJL85:*ZG19][IJ?LEW[OS,JXX6X^
err_skip: ':FEWE4+*]1L2*U<3OTNN-:4Z3(G1ZL>=9M(Y/<QHHL,0;/KRU/MSK8J[
If Err = 13 Then '*=/A^;1\+WTU>5KHFQE)4*(U=^^CJNTBNQ7F9M6?:V;Q^;P.B
Exit Function '<;9MZH/P@5PJ*V^Z0X]U//(M+,0DYO^^QHBE>(2M8JTR@.PVV:0P
End If 'I6Y:C8Y9W?*CK>>UQ*TRINJ=WWEJB6QZ]]>(XW-+H;Y[:<AR?@=XV8UPYBC
MsgBox Err & ": " & Error(Err) 'WFP]J@P+/QL/SG2S2:.G?2-9@IN+Q:V]?B4
Resume Next '^BQG=A>+WFXJ>E<*O.=-EWON5DL6IFA<[V)L=QU]D;2O2]KDE^O.<R
End Function '@E5VXDS/E5R[.N-+G)1]UKDFDGZ(8^L//+]Q[-X9CO3*KJQ[G5[=C
Function azLowestOfferUsedMfnShippingPrice(ASIN As String) As Variant '
On Error GoTo err_skip '4JP;U[M.\@MT1:QJU7>?@EDT:+KD74;,S>(N6-P>P/E
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'VP=M@WA;-5H;,H^
azLowestOfferUsedMfnShippingPrice = CVErr(xlErrNA) ':MG?\/C+0>72HWV
Exit Function '<RB*\>JK4B\5[+:*)I=[;ZXEI22AFC4T?;A[OK8C+RILB*HNR6TK
End If ';T.R\59YONT,AZ10\CAF6?@C[^0CVRI)Y(W?8393XZ,?RU\@6+4S^X-A6:/
azLowestOfferUsedMfnShippingPrice = aazGetSingleFieldLowestOffers("Lowest Offer USED MFN - Shipping Price", ASIN)
If azLowestOfferUsedMfnShippingPrice = const_err Or azLowestOfferUsedMfnShippingPrice = Empty Then '
azLowestOfferUsedMfnShippingPrice = "" 'XPHT)0+<F+-3C4^OL]4QCT[90-E
End If 'L>URQ*6H2:*G@3JB])6IT3\]I6H^*W:4.A6F.W5>B4+?07Z3-PXB(+\:=;/
Exit Function '7/K+==<IXQ]YX?1Z1ILKP\S)C5C=9><[:J/K>X2<[HF*SH)=N;FL
err_skip: ',Z18L*@TBX?O>7S.++B0PV[NP9<+VMD1-:@WVXP@\6XF:3W3R+1.VFR;
If Err = 13 Then 'FG*\CC7BA.,<1/XJJ7,=F8((V4+DB[55JVWMU]=IR3QF]RT<Y
Exit Function 'Q*57D3G.WYMG88C5235OQP3EB8I9H]V,]Z^)41@7\OV/=M==2X3^
End If 'KE=E=L3GZ:S>Z])=2WDTH[KE;/(TEO-;X+,ISH)>F[8TYB1-S\L/;AS^4LY
MsgBox Err & ": " & Error(Err) 'O9(^F7^K(VKU5Z:4V*B@E:U)0H*TVLE9D2F
Resume Next 'T7,^CI*>B7EQ:7,J:I:A7O@0D:P\9DOL?T8ZZT1[4]F;FH0:;+<,5=
End Function 'K=X)MK<Z(P\RX0*ZG]+HLIP1<@IG2+U*SC+(1UX9)(5Q?\3KKW(X;
Function azManufacturer(ASIN As String) As Variant '^K[8LJ16,SV]U+N
On Error GoTo err_skip 'X:,LU6/2CU]6P)]V@LXP-\DIB,G;O4WLFOJVUG3[9.[
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '7BSD(D7ESRQFOAO
azManufacturer = CVErr(xlErrNA) 'ZNG5G(+NKO?BY:G2KT:IEZ[<O*MY.8[?^K
Exit Function 'XMSXC?XOT4GO*1.7]OIBC+0=>F5RGAGX1+YQ7V9>T+LL=@5ZY8R;
End If '/0O?E4[K>0U:MP4\LEQMJ:BBGQP=0:7.*JQY>O4DLX1LDGEF4I0L-JAY6T4
azManufacturer = aazGetSingleFieldMatchingProd("Manufacturer", ASIN) '
If azManufacturer = const_err Or azManufacturer = Empty Then '*AKM^
azManufacturer = "" '*=-03:;D(?PJ.*1GST]3)WOI2G8XDA8/26DTE>S.?G/W(H
End If 'V0\*9-<>I5,],G-6A]?T@CVWEFY<9E1.PMT2R-8P9.AW<XNW<.HMU8EF7[Y
Exit Function 'WMA+;AJ:HW:O11FX?=+,X.[LTF8R/Y>3MXWS=K.L.P8+?D/8QN9X
err_skip: 'Q0+T,YW@;T52IT4J?3IVU-,@;S<LFRYZFO??]V/4+BX9+XN0[8F</=?L
If Err = 13 Then 'S>W(O.B2709^5I4L3Y^N>NMLI*4I7P5B/(.[Q>:;IX*+25ZZD
Exit Function '78R18Y8VQ:QA1AL6CI(,M97690VIFY?J>Y+-.O-SW*DFTUFA2LE@
End If '9>I3KT8L+EGP?Z4HGF7S/K[6LGY@+MWW2A7MTP=QJ<AUS);[A53/QSEDU4@
MsgBox Err & ": " & Error(Err) 'D(D\]7\-:/(A((VP*MS<,]WDRTW.7CD=00Y
Resume Next '9/3V)6:1.W1+J.2T-S3YNI.=SW*RD=JXWHJ7Q[PMHFMP\-D.@[3L+C
End Function '33:T6\HR>IO?JO9]*@7Z^BTK07Z21@(>=DS1WY@.K)[87UQ?EBN*D
Function azNewOffers(ASIN As String) As Variant '9ES^:I8@;QN,.LILN4
On Error GoTo err_skip ':Z25OQ\@TG?@[4P-A<8A<[+,+AXLB^6]>\;\)I*/T=F
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '4/X;;S*QO2J(19Y
azNewOffers = CVErr(xlErrNA) 'N(.H(S+8E=W3+9L7L6[<[/F2N8YWR/?>*T5RT
Exit Function '^BFJN^7QD/6\X@;V\43SP9]Q<*0AREYS<5?=7OPGFEEETNCH*)L\
End If 'Z*XZO3\9U.U-@L2:,[)+C3WQ(/.6\/PQG2.2WR2R^(VWO1J(2<C7\C,Y5@)
azNewOffers = aazGetSingleFieldCompetitive("New Offers", ASIN) '6@:
If azNewOffers = const_err Or azNewOffers = Empty Then 'G*K=E36E8EM
azNewOffers = "" '^BWK0[R1\H\EC<IWX:I<-T,D6R1I+@4C@6)LK\<=4((=P2HC5
End If 'M^5JW64D,7=G@R<F,AT)CWZ\4?46QRKWI;KYT5T+?4MAF+IA?33YQCMHA9R
Exit Function '-968>LJ2*,LGV-E<;3I4XBBR^:O[*KBT4,HACLS62I55@>:V8.KW
err_skip: '1GGL,^1DT,6ADBMH8^W,VIM^8U;0D9S>8J-(0;:=.?B+ZNTX=S7?+/?P
If Err = 13 Then '.D^(6DV(TF,J83Y\+X7)I9YD;LEYD>MGA[7A^,YO0*]U/E@QC
Exit Function 'J:2*^K:PTOSKBM3L^YL9/5BC]X9(E*CQR5EYNJ,>]JXWAX/<:8.]
End If '<E(;+SBE[1B2.>SJ+/0.20+LUJV]5OVE0<[57B<]8-NG[/--;,X4W/3]OF1
MsgBox Err & ": " & Error(Err) 'N9RC2X5RF@RUR^[28V7H(5OI4*5F*PXL[R[
Resume Next 'I3W]1U:[?\DVCCV6=U6,VYWZKSKG^/KQ6230YVKPN0(00S1J70/UB8
End Function '@98QI/5^[4VQ4WL>2BL-3>0*>WU1Y-5V7W?,?/RRA+16,/?7(NWWV
Function azNumberOfItems(ASIN As String) As Variant '70853/?*G(.73;
On Error GoTo err_skip '\+T39A;PFIF?YIPI@^USM*G-=7]UM5]@6B@I0W>M=+=
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ',73+0G.8RYQNU5H
azNumberOfItems = CVErr(xlErrNA) '/LED\ZXA>Y4RMTEY<L>;-@8(7S*S1H@F:
Exit Function 'VXHYWOL0XGI1M\?0L?[(3NL@5S,=+H)I@MAIY49R;:WQWG]/TN]7
End If '?(R4]*Y<76-=HA9D)Y+9RET?L@JOZE*H/E6GJ/B+WBGG5Y\Y0QPQ5R-JW>^
azNumberOfItems = aazGetSingleFieldMatchingProd("Number Of Items", ASIN) '
If azNumberOfItems = const_err Or azNumberOfItems = Empty Then 'X3A
azNumberOfItems = "" 'TRT)VN..OXE874KSG1?P,ZKZ1VA[]4;@532ST]QT\44Z3
End If '9+YC--YD6047()H@])19TGLKQ4GLMKV;70NYA5LF0F[E0[Y><\,E:=,US5(
Exit Function 'RUYB*:G^-LB(2:^0YWLI=,+AWSUK1M(SW?KK:,FA<RDXMD@S)?.R
err_skip: 'CA0T8?ACIF^:-6J=0J04L<A[X]3>N)GU.^>BWYFP=L:8/>DRV+8=?;K)
If Err = 13 Then '@.B>,=:*P\9:A3GV<:SE?,/,=K7@2YXP8X25K@\UD5F>ZY<X]
Exit Function 'EI?0VS[K?.]SCD(20=47T\3B),PBE/]VD5VU(PO?TU5Q>GDG8/A1
End If '22B5M1@URI9]94Y*TYQ7+?=V4T()XD2VG2+QEEHLFA045?>;B.8[.;BZW4S
MsgBox Err & ": " & Error(Err) '/M4QJS<0,O^60CX2Y.X(7JEF1E69@9>K;5]
Resume Next '0C;;(NJ)Q@O.LCE]B-OLU,-VF:6SJFBR.0UG>@I<S2]T11S705VH2D
End Function 'D)L1D;[THDK?P8[[::AKE-=?O1E/?QW3>@/H[4\T=RZA,Z)S<AAHZ
Function azPackageDimensionsHeight(ASIN As String) As Variant 'YQD2
On Error GoTo err_skip '-2>AE70B*:FTOF;8VNE+V.A.DV5/L0?FO2V[Y\SB;F<
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'UX[JHAU5-,J]Q\W
azPackageDimensionsHeight = CVErr(xlErrNA) '3G2W6-[,GC^@4IMBXCJ)?H=
Exit Function '>BP5YF-M3+EO;\*T>/Q3U99F+-M@E:2EPKQHH8?)04/K>@OAEF1)
End If 'T\46O0-=;;:?6TN<D-+(UV(RXTZ\[,))IJ*:\*M\UIPT?B5/18Z+PUYE;0L
azPackageDimensionsHeight = aazGetSingleFieldMatchingProd("Package Dimensions Height", ASIN) '
If azPackageDimensionsHeight = const_err Or azPackageDimensionsHeight = Empty Then '
azPackageDimensionsHeight = "" 'P@ID*:M3:HZ[7N(C33QMM+H41=A7/=,X6G2
End If 'L[QQ-*EA-YD-NUU/+G9O8/(O;(E(5B*Y@:7*OOX9[6]0:C^**ER9JWW.1E.
Exit Function 'A.<=LRR2=87J:[2O^F]P+3C[9,6L:K^DX\CZ5>NW)F)Y*5[CF+QB
err_skip: '>MXJ+II1F.<1VH0HK5618:-M*CRB>=;3^I.X9U/..1,JRV;+],=ZN45Y
If Err = 13 Then 'PA\KFH-(=IVGA82C/5QYUN)A:XK57>0P^\T5=4O>;4:+2H\9<
Exit Function 'JLHV<ER-B\HMXI7^1:JK8S[UKA1Q4R6L7JUO^,*DA8RE,N\^]E6\
End If 'K=BHV8DF*S+*7^WP55Y>.8+6UJY@C2PS20]WR2O42TGXX\M0D\/I[LC<9SK
MsgBox Err & ": " & Error(Err) 'Q,EBP]I6IZ:Q?VLK?+FG(C*-S9=Y*QO5:2M
Resume Next '1/FH*F?WP:VAIU422/<JBS06T7<SZ-WQ+Z[5L)(.++A4@]W+303E=]
End Function 'T-WOYERE)L+UTD4AS2C*.0(B6R8?0(^;FDQIDTBP:YS7F^ME7@BRW
Function azPackageDimensionsHeightUnits(ASIN As String) As Variant '
On Error GoTo err_skip 'I*0V.V(P;RMI:470UH])ONEWWF:L-4?:B-[FT;OU=I4
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'E6N)T-GD4=41QI;
azPackageDimensionsHeightUnits = CVErr(xlErrNA) '*)>:BMV)O9-Y73\(10
Exit Function 'IPWXQU39=9QN9I([UIK851SOSA?BIT101M/KQ(3K<GA5R[VWU;3:
End If '7C@W8N=SC;V<6ZVDG^ZTESID0ZF\95@*,-D.5T1*\9WFZ24SESC.?O-66HJ
azPackageDimensionsHeightUnits = aazGetSingleFieldMatchingProd("Package Dimensions Height Units", ASIN)
If azPackageDimensionsHeightUnits = const_err Or azPackageDimensionsHeightUnits = Empty Then '
azPackageDimensionsHeightUnits = "" ':(AC+>MO-HHZX7Q^13RQO4[S0F=;*?
End If 'KUR9M,0)6AR.DBNI;/C3X\/7Z63>WN:[Q\^WHW8)ZG=CL-N04.SJQ\7?RV(
Exit Function 'S98E=H@F90^9]E*[/6A*[PMO42GG2ZP4-YXVAAD.7<(:N^MWS]8M
err_skip: 'JQLZ;VRT?RSD,H02+\A5.<TVXN,?^\WR981\G9WV4E[QA167G0K>D=X+
If Err = 13 Then ')U[PS>L9,Q4,MG8F:GCE^0F9)+Z0*KA[N)F/TS8,RR(95-)<\
Exit Function ':[8;HVOU31@S0+UP9Z@D<S*<[TZ-^39BA45)0ECYVT[/PC[-,]62
End If 'VOT;=Q)]\+=7+WR(H<.G;)NBW^F]D\1XU/@T,FYC-F/B:BD\6X/]VF)OA5I
MsgBox Err & ": " & Error(Err) 'ZFZ5?*HZBSU\:JA[*XQ/D>C1TNCQC?/UL)5
Resume Next 'BW):SCL+02J90./,1=Q6U)19,;443F3S6B:ZPSB@=37.A/;J^BR7DO
End Function 'HNA:ZA-PX25F\U,(VB>HTP?>)=X*85=D-:[KK5T??UHXZ^D-AZ,?H
Function azPackageDimensionsLength(ASIN As String) As Variant 'SY1[
On Error GoTo err_skip '[NJV1C*B(,7,:WVV\CLB)IMOLWI(V>[AG:1)4D?)3S-
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'Z.\0K4*\7FN5UU=
azPackageDimensionsLength = CVErr(xlErrNA) 'VH6MKQ7=@WSO4@BG-TQU3^V
Exit Function '49:G>WBZ26<76[^S[BWU[8-8=J:3,K8C]);.^E>>(-,G0Y+I9[S9
End If 'PT2J0)6CJN6K\NMAD-7C8>KN]X.\>0RW>3PQH@YXK.G+S[M:?]+).T((UZ1
azPackageDimensionsLength = aazGetSingleFieldMatchingProd("Package Dimensions Length", ASIN) '
If azPackageDimensionsLength = const_err Or azPackageDimensionsLength = Empty Then '
azPackageDimensionsLength = "" '1RN@BKU,T4GB[5L+WNU4O8S8X]IM<L/>DFT
End If 'V]:[9^/6=XB90+R61N)6^^2Z[OBT6(0B>7@FKGR*U,31GW-)CW1ZS3FK0P=
Exit Function 'QTS;>C,OUY,7OP6[@RW68XVM/6.S4)^*6YSJN5]J==1<:+P0W3>(
err_skip: '5..3S[DKVWIZI2.3E8?L43*+B8;KK>A61^ET?O0WU1+C-],E[X;WPBT*
If Err = 13 Then 'VF?@?F;0(^VDU-,=GYP?M0=?)<:.P0E,=S^ZA*1TT7U+OR\3]
Exit Function 'ZS)D9:>GR7Y8>7?;@R@,5L,GU+P2;AU80^S/S];*AX+^N5)11-\)
End If '3PQTG[CQ83D<N?UV8X*NFZQ?+H7<URJZS=ITPW?V;(7RE[9;\>YV\6)HF6)
MsgBox Err & ": " & Error(Err) 'L?->\G]/,HV\EMBKXOBC^GJ3L@GX8LNA(G6
Resume Next '?R>.*1D(^ZZ2F*7/ORP0XXP9/7BMEQ7TU0@;8M5,\?1-V5A3RVWQ/)
End Function 'D<3ZXQ[865T(CM7</OHM\;JXI\AKH8UMA^Z.:/D=A2;28-ISMNSB4
Function azPackageDimensionsLengthUnits(ASIN As String) As Variant '
On Error GoTo err_skip '-@5),T=,K40[Z7KW8WZ07F.^K/MLRBT,:G:<4YJZI^[
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '0POE]EWM(2W-TXN
azPackageDimensionsLengthUnits = CVErr(xlErrNA) 'Y;-,1QF[3-?T8UA6=A
Exit Function '7LG.?G0S8B.,1V0LI?2JST<8=AA3;P=<3:.RE]J3G2<24DP;8Y[U
End If 'UN5PV(>1\DE-@AM]5/T>T1W-9+*,)17/[G^BJF1S?/F:WZ5@3-=6=X2I4(7
azPackageDimensionsLengthUnits = aazGetSingleFieldMatchingProd("Package Dimensions Length Units", ASIN)
If azPackageDimensionsLengthUnits = const_err Or azPackageDimensionsLengthUnits = Empty Then '
azPackageDimensionsLengthUnits = "" ')J;VR>1/+C>1WAK:(>YK1YOA-4K53Q
End If 'WA?HG6A=N?EO:^HIT:F)WD67-]EUR<>5IQUH.[=R(/DCVXL--0(\7P1X<Z>
Exit Function 'U@A5-T)S\)<-5S>71U*<5^TE>IOMJ55/A@PL.]\UF3Y<)NZ,Q/)S
err_skip: '6Z9>Z(+<N\LCT=60O53/H9,A(4-9XFK?L2,AV^VXJNT[W+TY63DIY8B4
If Err = 13 Then '2SGGYL.R44(ET/JWC:?AZGF[2]T\^1O(Q;]-5U(Y8I((VDZK1
Exit Function 'WK\9S;MUB[0[QF44MF2RYH8\+39EN@?(0T>/XD[V\X<6V+C)>+QY
End If '@NXZOEH:/M<RP4W+O]VTU]01,A1ZP(6NAWOBWKQ?*3YUQRB<<;IOG<*2WDR
MsgBox Err & ": " & Error(Err) 'BR;X?MQJG8Z=V(DJ5RA4:)9+VN-MCF707S+
Resume Next ')W/-5@YC4-7IBZ7?N>OKQ?:)+<4>]L@MK@Z/(CG))BNC4>NC@6V6Y)
End Function ',\W?)PTZS,2YRDW)0=DK[B4O60G])EK6M,N7:8P:*U@G?JC;AD[YI
Function azPackageDimensionsWeight(ASIN As String) As Variant '?>PY
On Error GoTo err_skip 'Z)V-F6SCZN1G9\>/-B@<A6M5AP*\4+@VDD=BC1W[O\B
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'K*4]KVP]3OR3NUW
azPackageDimensionsWeight = CVErr(xlErrNA) 'J.[:>FD.RJ.-P7PYQ8PX^2A
Exit Function 'FV()AW]87OS)XR/K6633DSXI>78[VZK7ZI-K[@//WI*A\>NGJJGL
End If 'XXPC=LQN?(GY+D^,F6:B09(<1C)V:?0)=P]>WM?F1Q@[\W\-LC,(;5DTUJ=
azPackageDimensionsWeight = aazGetSingleFieldMatchingProd("Package Dimensions Weight", ASIN) '
If azPackageDimensionsWeight = const_err Or azPackageDimensionsWeight = Empty Then '
azPackageDimensionsWeight = "" 'J]01X3RKP-(><I;\/=1:K((^A@5TQS)?8-;
End If 'GON\6)W9UJ=-MJY0Y/4[LV:5*ZP<W1-3\@\UG3[91E[L5.V/LU5M]1GV68@
Exit Function 'I3-QB0S<Z:/XZ]F\+M5MLU2+52*U2XI>R?<38281I^Y@P+LCW-C9
err_skip: '[C^>/\HU@J-+K>T,C=C6=OVA8OZ7)8*DKIX*2WQQFI1RU]R.J>89VC^E
If Err = 13 Then 'L-F+>CS=IFR4+H[7BVP8><A@0U?Y)P9J\]WA/>PE1ZLM3EU@G
Exit Function '9OUOT\0W7*ID@=8AT)B^3)1.E6,QR:P>6RWZ5C*JFBIKNRQ>.L[G
End If 'OH;>\*O=*^GXA4KKF+^517>+K1(L^*^0:QU,MM?;STYG?15FT@B^7V]H:8*
MsgBox Err & ": " & Error(Err) '.>+3<8PBZOD5F:3OWFB;SCQCJ<0;,.S1P.5
Resume Next '\XPBP6P73B;WAXX:+<X35O>4FXTCEWDROB5)^S89(88V(X,5UGQ41X
End Function ':X2=H*0>*?,HSB3F+>BS@3CSFXQ?R*(J>I.5(TX2VD5UYOWJT6L,4
Function azPackageDimensionsWeightUnits(ASIN As String) As Variant '
On Error GoTo err_skip 'HV>X9.=PDATAQMD@P95IATZ5V*8-?[YQ?A.+[UG/C]X
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '??=,**GR@HSSIIB
azPackageDimensionsWeightUnits = CVErr(xlErrNA) '(LP>VE1.Z,F.LO1WZV
Exit Function 'HRG+)5\N^\9C91:K?@\OKI4US*I[^0;FQ57K9<IM5Q:003D.\],0
End If ']B]ISLOS?KBP,8XM)@T)S(T6PBL(SL<<AF4C/F7>G)V,LUGQ>@=G8)-9O]U
azPackageDimensionsWeightUnits = aazGetSingleFieldMatchingProd("Package Dimensions Weight Units", ASIN)
If azPackageDimensionsWeightUnits = const_err Or azPackageDimensionsWeightUnits = Empty Then '
azPackageDimensionsWeightUnits = "" 'L0=5)QM8463[YQ?:T^]/7/0^QWQ0QO
End If '[7.(4=1YQB1?W97?-0;K5?KMNSR(^<W@N8-VAB<U:H3.::*Q9]HV(/IA<QW
Exit Function '[+15]@T6BFUGP?EDX>J@UFAB;=Z9;*8AA>ADXL>XA,WK))8O\4.1
err_skip: '9W>3GLG7)MOAZYB/0FO.B0@J0R)WOCMC090N/^I/I>\AO-4\O\59B7M\
If Err = 13 Then 'HJOC[BL>;11BDH72AUJ4;>>EMZNCKUZ;SDL[ZNJK2\]IEBS.:
Exit Function '65PLD4QW<J*W-IVC@(B67;4^?14SVLS7)=[(JD.2:]4I*1[Y4P.Z
End If '-ATBDK8/?GNK*EN1]?0HKWXMT7^AAK6XT+XMMW=F,YYD^\CGDK(G.8Z<6;H
MsgBox Err & ": " & Error(Err) 'KHV\@5(@:MFC:B+B0^UG+(P-VRA1+,U>JW>
Resume Next 'T1^=JZB/-EQ523)L<K,O]VMEY3BSAU[IE/LV]LT?4/)12V5LA11AH?
End Function 'AN2J<U@.5@9L>O7FF*:NF+BVN3I-21HPT\E1XZA4@2)NR7N))+(>3
Function azPackageDimensionsWidth(ASIN As String) As Variant 'KN00?
On Error GoTo err_skip 'X]RLWB2W(+K.PR,:TKB;7UA3N]*FF[TF^I/SP*WK<[,
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '(R;LI9\>^F96K-A
azPackageDimensionsWidth = CVErr(xlErrNA) 'O3\LF(QW<G7)*9^2RM@>Q3X?
Exit Function 'E6UHXDH)I>UWVP]5?)9\;9>V><ZD)XH9C+CD9EITS<FZ(>GJYYU\
End If '8W9CE)E^U5Y+7\L8<MXQYO2Z?4JYSB^N^;1\20XR-EKZEW^06LXY+??/*HT
azPackageDimensionsWidth = aazGetSingleFieldMatchingProd("Package Dimensions Width", ASIN) '
If azPackageDimensionsWidth = const_err Or azPackageDimensionsWidth = Empty Then '
azPackageDimensionsWidth = "" '1F1]S-F(8X@O6*.I.+F)]?\NO6=I:BW7BX9^
End If 'GOPAC=GMTRQ=1<.,^INP+FH2NY)NZ/WT(^19431RY<6WK5G?W0@=GL?/9G>
Exit Function '\30:-HMVFJS:(MCMMR5RQV=E2I0:O>RE.BZ6P=4I4M8SIYT[BSXM
err_skip: 'B<\E0]B1Y]Y[WHWYKBL6?Q;(/.,J):V8A^6/W;UU^J1>E?V=Q?-,H<+.
If Err = 13 Then '2<IB9R1O+?XU6CQ*4);-YUL3HW>IOP>/X<:*50K9*/TYCDN=T
Exit Function '[Y>I.KDDV5JO(VY[<Z?8L.W1X5<6ZBZ,8^JF<HEXFXDOZ;DF,-^<
End If ',49OX[-SLVY-V4/AQP3RH7JBP8BC51[8LX6.[+[MS0]Z2TL/-N:5D=L?QEY
MsgBox Err & ": " & Error(Err) '*79>/X^+;Z2[HZ4YSACGE^S>1YXXU*<^(5Q
Resume Next '4FJ.Q\LG)FW2N363/ED(:B;PW-437A=-O,^5M6F<+)OZK]/2BKOTW+
End Function 'MOK?:]A;FG10T2>7]6ROAEV-PU[1Q3LG*6-MMN]XV.2):2I,CZ*0<
Function azPackageDimensionsWidthUnits(ASIN As String) As Variant '
On Error GoTo err_skip ']OY.:GU*K@):=RKWVAF:)<VWM^@ULH2-C>^:502MBT?
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '@,?UR14CT/9@DM]
azPackageDimensionsWidthUnits = CVErr(xlErrNA) '5TT4?8@2/HH*]3IA>(/
Exit Function '5E.@\^<3@<W*0PE)E*EB(:T?0.Z]5^.,VEQNTBNWD)9:5IC9]K\B
End If ')>C3/?RX,+S5W9>A:RPJD:V3;=<R?-LZ6^[BLRW(9@;?NFA*6VRNS-W5(.*
azPackageDimensionsWidthUnits = aazGetSingleFieldMatchingProd("Package Dimensions Width Units", ASIN)
If azPackageDimensionsWidthUnits = const_err Or azPackageDimensionsWidthUnits = Empty Then '
azPackageDimensionsWidthUnits = "" 'B>3(/NWP4TFP36:4>SEE]X5OTF(>(9T
End If 'GFJIB.CLLY?4)O8S)Z@>8(G(UOX*--B6K*(SX^EE)SMI>*+:\AV2)GO2<O(
Exit Function '5]U:)^]M+(SXP@8^OY0.AA8D*EUZ.Q1-01BM+P57U]2SJ[>Z*AS/
err_skip: 'HOS;SQ)^.:YQ\UL])JA5>,E\RPF.YS9?COGI/;6+H^SE6VP;,UPL<@J+
If Err = 13 Then 'YG(35LED\]D(=5<R:THK@MO8KSDP,CBT3<B3^1QHK2+W;K4(;
Exit Function '5T5=TB9.(^Q6>>U<E)3HY-TL<TF)PIO1GJ;93I[:3Q;TU+0BYWZX
End If '8LQ+T5Z/2KAJJSV2)FWF*IO-5OBPP0M]Y<12;)=57.J:\BM*?@TMJXWVE6H
MsgBox Err & ": " & Error(Err) ';T>1T+):DF]F]-S^5U1<M)8*U:;2N+?<0YF
Resume Next 'RIBK)M(**.AHVL1M5MH2NMV,;^<9<YZ(FXOQ/(\9VYAE7HL>AVSFJN
End Function '6+5JK7SMMUA+K[91FM)E7?4U^S\BQIA8?94AVG1N0^7OA53]QBBF(
Function azPages(ASIN As String) As Variant '3]=6QI]8DZE=2<(RTA.<?F
On Error GoTo err_skip 'MSOE]^35P9DCF<+(V3OZUBB^M[:2,Y3AT9?NRS3^1(F
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'B52;WG+=\T->S[+
azPages = CVErr(xlErrNA) 'CVGD-(BV/)59G<CY,9ECED>LQ[9Q:]-)^W,6Y;2FC
Exit Function 'CN3POZ.HH;]TW)S/X/^)WC924,R;<*+6HQ-]94W:GSBQI[G7[@QS
End If 'AW5^0KKX;FI3+LQHJ)OO;SZ]>CC=\MMXGM4NYQ7,?:57RM2N(M6>8[FRR)(
azPages = aazGetSingleFieldMatchingProd("Pages", ASIN) '1YE1SN;3;5=
If azPages = const_err Or azPages = Empty Then 'GEUC<W)R1QPQ2.GKD6^
azPages = "" 'NEB63(=U\J/(91ZLN/UND2AL0ZHL<Y(CU\X*[J.Y\]+87IC3,YVQ)
End If 'BFG)A<^91YS^3R=T2TK7=ON^S,05<D@TK1B*8=C3<M7+?[CL,W;ARMBLS,+
Exit Function '2^7C^PVQS(41(/UMR3J=DJUSINP^DMZ;][G9C=4?58EOW+D7]FV,
err_skip: 'Y4]L8\5WYQ9@(5O\NPR=U4VO9FOPJY2-DA\O0>U66,*+NB]03\ZG?,;^
If Err = 13 Then '776:1)-VZ2HNM0/^6<ZB<>XR;0TLX>]R*FKCTN3-?U4.;;(^9
Exit Function 'ZWU<KF@WB<4-;=C=6;OOC83CSQ(S+X4L-(<XQ@/O3@60GCW7NWRW
End If 'SQWRR2E]PX)(7DH41<M7:60J-PLBOH4R1@1F0U9E985ZU[+E.*3*W)KM;Q5
MsgBox Err & ": " & Error(Err) '=R0W[.A3=AC.U]WLE)@\S.T.R)QFT.0DP.(
Resume Next '4J136.7DRF7U2C,NZEC+2UJ[-VI2]>EV]ZO8U\,-(ZYR(1M\Z3DV74
End Function ',[RO?Y+HVPG4HLAQKW](R.NR\B.2(G8EDO*+\J^9^47F8K4;8L:O<
Function azProductGroup(ASIN As String) As Variant '[8ERAJ-OWZ[76K5
On Error GoTo err_skip 'WU2FC9V@>]\26<,/VRPPDH,M+)N1M.WF2YV+KSE]*?A
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '<4?V5,L(AJSN=]@
azProductGroup = CVErr(xlErrNA) 'S,B?9Y(*+\/*/UJB>F]/F+X5Z*[;(VI>\U
Exit Function '969D]T9J@7G13^JOJPM+A)NDOK\LP<K3D)Y,9O[W=:I@4?]WN(:C
End If 'QN+B+I+IJ4:GNC@O[W8A*UR4BGHWC\C5:OJ(WW/O5D//]NTU0JP^)3MCOH9
azProductGroup = aazGetSingleFieldMatchingProd("Product Group", ASIN) '
If azProductGroup = const_err Or azProductGroup = Empty Then 'DN[P]
azProductGroup = "" 'U:C9I;>TI0X-^DHW:](CW20UWLNK;D6X1O(U^@BK[NP.16
End If '?:N*G@^KP?WR6:\0;H\9RY;6QTCE(+W97HD\XCYII@Z5Y2,U3>/OLVOCZFC
Exit Function '-^@;U)(^5,.\HEGC?Q^:((;(]FTL/WL(Q:HBT(5NPN^34;X=AD[N
err_skip: 'S^O2S2WWOU]T=E[UNKI+GEL\)1^=I^16)Y3,)NH]IGDV6\@YRLW7(.6)
If Err = 13 Then '2VE)HM2NUBA,9;/L163.X+;=8B;UUI+TYB9CK+@TV5OO2<5PJ
Exit Function ')S1?15<B;,+(.WLH=3;ETB/KCL/6]A6E>Q^Y^1=XP,E.;J)EB/X(
End If 'L.)5UG42B4I7UJ<<DV*HF[;1B=JRN(4U0^<958+NY.A.)U:V/\U]4IB=X\F
MsgBox Err & ": " & Error(Err) '*CXBHZN(5AM8VBAT-KD:LQ\ZCT>]=35MV6)
Resume Next '*G\;54AM]2?F8EK=IBDQOS[YA95D8*KR7-TG53I,;95@LCIU2+UQ)]
End Function '(RUR(P2-]4U1,6[@M7C)=-A/7*-*>BL*HB5ZAQ\:MZ:W?YYZ7J//,
Function azProductTypeName(ASIN As String) As Variant 'LEB3U5*L3]@]
On Error GoTo err_skip 'BG8G/6D9\[AW?:^A?6N,D6)5RDG^KYL/3C3SK0N3W;M
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '^A^5V+U,EK=FUXI
azProductTypeName = CVErr(xlErrNA) '8X4ZZ18,;1HLGWK6T:V^PA/@M\YP:K2
Exit Function 'SK\:AT71PR3/WNX/,FVTGQF0?R)>)8U0H=6R,-W+2.)-NY(@,V/?
End If '\MAAZV2\K5=49\7S5K/VH92JA6Y(-916@2,3X7QC7HF24Z;JE9:A,UN(P;^
azProductTypeName = aazGetSingleFieldMatchingProd("Product Type Name", ASIN) '
If azProductTypeName = const_err Or azProductTypeName = Empty Then '
azProductTypeName = "" 'OL5LLVXA=DI:W*::AKHP[>+9ET>UH7?R,.6@MJ,3ZBW
End If 'O[43FUDJP949CQ*RQ@XPD>AQCF[T+Y+98397ATETGLIQ:PFP7DM6/V46C*+
Exit Function '-OZV;+M64<3HQI<S9K9(TYNR))7=7-JP;\1-EM=E/BA1(SY]EHIP
err_skip: 'O*UTS9TQI7\EWY.1Y6\3:DOC];5-ZA3C)@M-@UWVH?-57[1F+OR4YY9H
If Err = 13 Then '2V69^ALJT[MDA1KW[EDKTDYO,GDV\7K(1Q^T?7U:*14.[\O@W
Exit Function '\*].F@>,+^R2?3HJH@SDT>?>]JW+>B*>R8.[8O2+3;@(@NDQI4^9
End If 'CXRHJ1*J6?1[G/@3QQ9IMQ3@R[E./)Y8]ELC2POJ9.@(LX+IJT,B@7-?)MR
MsgBox Err & ": " & Error(Err) '3,K5V<A+[L)5VRAY;-1^I*A).X,\/O:70P/
Resume Next '?3@DPN00JL@[K[[PECQ.9L^@??O@11W)@BP5N<?D.FP6-35GZSI5N4
End Function 'BT[C>F=8PNY3^1^JWD;IYIJ8GLH>C8E-(2[,WF8W888<5+7W\TNTJ
Function azPublicationDate(ASIN As String) As Variant ':G]K=FS)(P>+
On Error GoTo err_skip '2QF/.\;R=\/>Y@V[F(V0CCJ9IK)W.)>>J/9/9U:/:X-
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '\N>4^2BMRDLW>D8
azPublicationDate = CVErr(xlErrNA) 'A4A/+[/+U7;P(<BARC0J)NQ:FF2740O
Exit Function '>ZG*B,8@M<VTZ)*X[GZ[],V0HK)3R3362HG^SK(+NZFN27*M/+/<
End If 'JE)+Y:+\DXDC=[BES<J)PI^(V;P)9G;L5I*;*P;F7S,[N0>*@\5/HC\4Z(2
azPublicationDate = aazGetSingleFieldMatchingProd("Publication Date", ASIN) '
If azPublicationDate = const_err Or azPublicationDate = Empty Then '
azPublicationDate = "" '/W]7+FS6\GYNLL.ZOL\1Z>\J<W9GNEI*@*]BV.<SLI2
End If 'B51@?8P[LO74</M/=^FDE)<AS5+Q.UPH7KPD[LYI/X*^V=PA\M;E927E24C
Exit Function '4WH4TQ6;.\H^PQ<0YE?)>]EWQKL5C[FEZ(BE[43?4L9,G]N=F>8*
err_skip: '=T\*/[P>0V:W7-Y@UXK4W[2Q(EBU3YO=[OKSD]+.W,J-7/SUKF/0UXX(
If Err = 13 Then '*X/H7(KM<XPB-E@I13,^<S(;,CO([L2WU^AJ+V>AV^XIZ=(CJ
Exit Function '.KHKDSD/H0T:^4,49?2/33Q]@D(S@>[D]XD^--;4;PDY5ID0XKRI
End If '?RT4:/PJS[((7W<O*1Z)H@IG4R+0*(DC^<1M74J?*7MU4R>>M/60KUR07:4
MsgBox Err & ": " & Error(Err) '6THUGDSEWKN2YL@SU)5^L>IF35U]-BJ8.H1
Resume Next 'UT.UB,L4;F?R>BGU1LS^<6R1XXHR^-P9P\(-Q^]9-6A3FSBL^31]1J
End Function '.71J7Z00D-57/>YQRJ1<U+A+7796O-H>HSWVO@,V)T=^J/:O)>4.O
Function azPublisher(ASIN As String) As Variant '7FA7/SHEKN[NW,R@-4
On Error GoTo err_skip '0:U1ZSF*>6D3]F[:R^;*V6;^B:BSOUBH7CMIF\T+]NV
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '(I?<OVXS=8=R2]<
azPublisher = CVErr(xlErrNA) '(XJ9NI<B-TPR<Y^J1L<NGR@F+CZ>[TC>VE1^I
Exit Function 'N1=TDV3\@7CJ-@X1KMVB9*VE:PQ[Y]KWFVL2TP5UYRKAVGC<Y7ZH
End If '/R-LSGJ@CA-W+K4QN)ENDQZ)=XH/X64/CW8H8-SNHM(D\=SJB@WY=WDHL1>
azPublisher = aazGetSingleFieldMatchingProd("Publisher", ASIN) '=/B
If azPublisher = const_err Or azPublisher = Empty Then 'Q.-FX*I=K3Y
azPublisher = "" 'RW\)@6U@>[8PI>X6APB-;.DR7T65W6@5EE(O^X3JVL((MEF/1
End If '9^)AAQ?DSAC[X=586-VI5NN4*DN+7XP)D/?P/-3DHGFEN.C5:5;06KVS:V6
Exit Function 'P3L:/E;IL2^,:.K08\.\>4O//G9MO=E7BK8JJZM4]RQ8/:^^)-RU
err_skip: 'TCV2W\SG9(IF;47Q@0+ZKSR1V@8CDT9;E9;M:N,09TPCDN^<>[X.-4/1
If Err = 13 Then ';SJ3\/D+]E64GQM(6N+?NKO6)DXN3JM+XCIV0,[[Z*M03BG*)
Exit Function 'J+7EO4ON-U-7::)=N<O)REE-=C;KZEE@M)]NJ?;*8=T[,.Q]G+YU
End If 'W+[IJJYWF(HPEFJQ4@;F.3)\^F7DFA)08C:1L?S>>^[P8^/N[NCFZ8/=7WT
MsgBox Err & ": " & Error(Err) 'TT:/OAD?F.9]>7TU5\EJ/MBSZQ3W]U>4;JB
Resume Next 'FFTPE<>)HHNC@@-K1)<)K]L)8;UX(S*X;YG(*WZII:-=>L6TQ/B??S
End Function 'O5MIH)DS0.+\CY@S6)-,\E/B?<,GO,J6\NX6Q+Q*J2CRR\OP0/@[L
Function azSalesRank(ASIN As String) As Variant 'R92QA93XXZ+LN5-KJ/
On Error GoTo err_skip '28D+^\F5\S+YMX?6CX1(AHC[6NYUKS2F]IKF(IE>+NP
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '@)PB^\FC[??1-I3
azSalesRank = CVErr(xlErrNA) '5@[++=(78403Q8UM*JI=-/58.148B8@+28.4B
Exit Function 'S8J]15O1@+IQ/()YP;U:/6^B/1QW670MY7NSH;7THF>AO2N7@LDA
End If '=6KP0BLSZL\HHK:XS-^*.T](N(V4W3@.6(3F-@>NH9X1U(X4O:4D6TMO.,K
azSalesRank = aazGetSingleFieldMatchingProd("Sales Rank", ASIN) '?S
If azSalesRank = const_err Or azSalesRank = Empty Then 'H49]A^*]-?)
azSalesRank = "" 'EO0JQVIY5TRIT1L3C]*[WA]7R4AM0DGF1VM;NO[0VW,9Y>@;C
End If '+WBC.KDESI,PLNY6<WN5JTZKF)L@3*Z+D[]X7/07D=QL**6Y9IS\A?STLT^
Exit Function 'VT@[C.)^3LJM[<,S=[W5U<CR1Q8R877@KA?3^O,;I+LWD4LJ0TST
err_skip: 'NRG(@<GZ//](?^C58NC.EXMH.4EL6*KX8,=9.?)KRXPG1?0A8\-4@=AB
If Err = 13 Then '+>OB+[\OW5,;(W=4:64P\40U;:.1R[)LX+A,KYQ,B809IHB(Q
Exit Function ']F@I?75@CF/TBI6X1-@RE2Z6F[@NARB6*=O>9VYC<TQXJ3;\,*EP
End If '-Y6OY0PT9,IE=>4/>+;N64+3^D*(LF\=>Q1FT7PK<;G5?PZ]5F)<64.(PSJ
MsgBox Err & ": " & Error(Err) 'R>Q0/961OZO:YH4:=UPF\WR6@KR;--;+(D[
Resume Next 'HWPQSE33+,LP*O=*ZXQEV2TOH@[[<][;+48.HILSACL.UKV[@O)>4/
End Function '?Z:R,2)DM5JI[/,-41E5>(,M.,A]261@8MU*+[NR-@G-D/SRO6KS0
Function azSalesRankCategory(ASIN As String) As Variant 'PHTMQ\TQI@
On Error GoTo err_skip '/\;Q/XY;UL=K]>SO-1630L(GG2>NBW@O7*8.>,9^63)
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '<DV*K0X<C9F.661
azSalesRankCategory = CVErr(xlErrNA) 'G\GJ2+J@ZA[:-P^VS20\XUSL5CKP<
Exit Function '69]PMSF8=RH?@H?54L/F31B.[),49*ME0B]4TJ80>V\KZN@/RD5;
End If 'I4QFQ3PZTS)6?:CNQMS3?3RXS5C>8P4W5.NRN@V7RT?P[[:?Z.OJ@;OUJO0
azSalesRankCategory = aazGetSingleFieldMatchingProd("Sales Rank Category", ASIN) '
If azSalesRankCategory = const_err Or azSalesRankCategory = Empty Then '
azSalesRankCategory = "" 'E5MTK0>D*B-QL(J]T:I=Q3,ZB7=KL,94\/B[EF]EV
End If 'SOW.+()UD5T52IPG,AWAV0-)N8R+O)?M3Q(^?\+-G==?[BV3>X?5.BJ[A@\
Exit Function '*G5\8SZ090XA,(+Y/,=@(+YY]A(S[X-ON5?V;D,I*K>WXGD)0Q2J
err_skip: 'A.NP]4W2/>GGPK\9(E9=J?KFVUEY)^3F6YWR>94.64>-\@^TQG9^\*-:
If Err = 13 Then '^7YPJ<SQM/^Z/0+GTD)Q<U?TG9U3U>:KX9G:[+RGVM4KJIVT7
Exit Function '8DBY/HQT?WM).-9;DY.I,BPV>J2(DU:N;Q<9H*U:I-MZO@PNT-5Z
End If '3UTM7SJD9@H]0FI1)TI0=*/-5K0YD-1WR(ES4/]4VUEZXKFLE8)6[N2U9B:
MsgBox Err & ": " & Error(Err) 'T/T@?),.:T@,?VJUGI,EB[*+[MR0*D/V]]6
Resume Next '0X8<OLRU)(43OC4(5<?4=X9C].)CZUD;CP]LY\==XLF;Y,,N:LYQ]I
End Function 'I*(9Y(P=3U>57^++IV5J]V.J9+)=O]0OV?@+A^WV6;S4[3SUG2C*/
Function azShippingPriceNewBuyBox(ASIN As String) As Variant '^\3O6
On Error GoTo err_skip 'Y57V47318407:26+VB6O1TG6>SU-;SF\[X/^P+)1VZ1
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'Q9].T^M33/D),UO
azShippingPriceNewBuyBox = CVErr(xlErrNA) ')@2.:BGVYR[:\5U*],^P>>:X
Exit Function 'H7]NK/E\;V3QI3[>>X*^5VXB^/O.VN\WGP;=.*V^8P9+T6THEFW\
End If '.:9TRJ(<=\DD048O7,@APV(=5LKABZ8DAS@)95803,@ZF?LU?6^F:>+(0JN
azShippingPriceNewBuyBox = aazGetSingleFieldCompetitive("Shipping Price - New BuyBox", ASIN) '
If azShippingPriceNewBuyBox = const_err Or azShippingPriceNewBuyBox = Empty Then '
azShippingPriceNewBuyBox = "" '1JT/1Y?/RG66V8CO9M6ZC*N3X4:\*TFMZ=FM
End If 'YO=T-OXZ2BLH=C*>7),US>B25M^WU=VP1IDZ:=RLS3[H^X<1WI6<T;LLQ8N
Exit Function '80^ZQNX\U*::MU7Y(ZWRSG4+,JGO23<Y,B[7(R.U=W<O]H)G3KQZ
err_skip: '-^74WO8QO[B]\[N[JBD;Y7IW5W2<4KTU989/+63?@G.?G)C4D?S1D2E/
If Err = 13 Then '7ON;8L1<35QW18(*.<?2MR+^B+:\BK/6QJ.O<)9+N0\CQ1B<(
Exit Function '@\II@6^S.VQ.CUM*UWS=//F>6BL()OK8N9-8P;]*IE.R3N/B,<AL
End If 'ROV0+,;3A<.2^OK/UCJGI[.WO^/C[:?X:S>6ASC]M9HUUZYX-*V94J?OT[O
MsgBox Err & ": " & Error(Err) 'ZC2S/-Y<A1U?3G(+).AE6O/<?D-N/C[\15H
Resume Next 'CMF09TF.RQ,PET7=.L.]>*AM7J=.H/S?=Q0[;QNSB@L--2Z.][PSXQ
End Function 'L48\TE@IVH]4N6HP:/UJ-Q?Q4)[AF[OVIE[:T-,J^IEI6?BTW8*XH
Function azShippingPriceUsedBuyBox(ASIN As String) As Variant 'IGD7
On Error GoTo err_skip 'GY;/,4\R^7RO6>QXMJ]X(\?C@*0A;0DB23UAQ2..FV6
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'I3C-T=Z5C4)8>D6
azShippingPriceUsedBuyBox = CVErr(xlErrNA) '8WMG*L;J)G;PK1@ZW;IHH4^
Exit Function 'W.PR/-JMR2GBR5FC2Y.;3?.VAKJ-N5.ZC8^D<^360M6^E/>6W+-)
End If 'I=HG8OL?QK6RG\8YKCJ;5+0@4I6.GR>(0C*TQ)TS8-RN><3S32A.2C)4K()
azShippingPriceUsedBuyBox = aazGetSingleFieldCompetitive("Shipping Price - Used BuyBox", ASIN) '
If azShippingPriceUsedBuyBox = const_err Or azShippingPriceUsedBuyBox = Empty Then '
azShippingPriceUsedBuyBox = "" ',N@[YC@UPSC.S4N:];=4JGDS=22@CUGL2/U
End If '<UM.O>:5=HEM4VNPM\4SVMPGYBGFSMJJ)Q81YXT.WWLD-,?1D[SIV9S8]G:
Exit Function 'GX<6D25@P>4^^;HGA@X.R*\M\Z0Q)4[FBBEY6[+*Y,O[UJ:M/>.1
err_skip: 'K0NAU[B^[X0GF2^)G7E6DJ.T3XN?J.R-,BP8G(98CL>*>O+\:6P4^/T4
If Err = 13 Then 'ZBNN?,T^))^MB:4NE/6H-]B*OC\H7<UO]<T)AT,W<.8^\U(I-
Exit Function 'V0(H-T1+-PR6LY*>J([=[IT^PG0BWJT7H<.*C7KYR2]^GZP2R.]2
End If 'V\X+KMOXAMHV*TUHR^<Q)0>@W0)XY79>?LGLT4V+1QOA5.7.A\>]BC8]MG5
MsgBox Err & ": " & Error(Err) '51GTZAX@@U3AMC<K<(=5R=L@AR<Z=.6U51E
Resume Next 'QE687-C/BHZ>5PA1(D2*B.K4H)=SP@Y0/ZHZL60SLJ/Z8[S<WG.\I0
End Function '4B-46I2OT5Q]C)+3FVX4:1*F.U=Q([Y];.*U0YB@VCYR;O23:2V=M
Function azStudio(ASIN As String) As Variant 'IJJ:5Z9QR/A/7VZ;5>/6/
On Error GoTo err_skip 'G-8DR[OO/8C^NHO0Z1N<(PF8\.2:60<5A[.(B6;W>9W
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then ')Z<\,)AY*0;G-]1
azStudio = CVErr(xlErrNA) '>-?J*Q^J@L.[H4H06?L7+RP^EW--O\/?SUBO*\S^
Exit Function 'BT1C)TBU=W0LK,VR))(JOD1>NUH7+.[Y;[E2>5H=.CR2V+-@OU[R
End If '.FKZ<66)C]6[84RSM??;N>E1+4N*I8DQ<NH]HNWC0M+P60B88+(-Z@??C2U
azStudio = aazGetSingleFieldMatchingProd("Studio", ASIN) 'W^;B0*SO0
If azStudio = const_err Or azStudio = Empty Then '9S9*:OT,(QWJIF[8,
azStudio = "" '0.H7:DW<I;M2F<-IB=,UD>W671EFIT,]DR:]D.D\.XUAGU8>[<]N
End If '-X\]UA/SAC>,FPH1GZ@JDCPYB@HAM@*^K5ZYJ9T0=QC2,?D8B9[+>2C-DEW
Exit Function '/*8(5?7(NZD<HF(]VT=LC]US)U*]2DN,WNZH8X.\G1/C8+D>FI/[
err_skip: 'BGKSW0]U(1P9?B@FV/]T^:R<ADJY(R8R]BQ^Y2<.JQKK>RX::0<01+O3
If Err = 13 Then '[T\8=C[ATIK>^<Q66:X,7*M0*,RD208Y?KCL=4F5HZTOP2/D2
Exit Function 'J.EQ1>/Z/B7I[K>E:.4P(A5P6>NS(KQF/0TY[I1YY+]5QZ7VN2BE
End If '\]\9]OCD-?@U)81VG/:C?7+2*KI[X11]UC^A[SHE:XAFDQVLM+SBD,E0,V(
MsgBox Err & ": " & Error(Err) '^.+X7M249OX(P:K2*-D423UQDO.JV2F(ZD7
Resume Next 'FMH3M[-,40.71^(QC]>MCSI88O0^G6SGG1F]?J5\LO\4X,)UYY3IZ.
End Function 'R7\7?(X7654<W(A?PJ-2GUJGYXNUT3K>1/,MVX[27SJ^@\F7OXM:>
Function azSubconditionNewBuyBox(ASIN As String) As Variant 'DLDG6F
On Error GoTo err_skip 'E]64O6)22\Z]TD6-6Y)2(VXY<?:0\Z>F6W6,H>9-2WA
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '?X=-@?-3KD*]\/Z
azSubconditionNewBuyBox = CVErr(xlErrNA) 'CQ7@J80K[W,/TAZ(7(OMB0666
Exit Function 'R:-2J>209R+Z(^Q,3IB=\I,^/9?V4?3>-<\K2X93ZSEV7180QHKG
End If 'UJOZ,P^E4JQ<J[C5XNVJNL^6W4=,L:P9@T/Z>TI2PNPMU[L8)>6P:\H-B-J
azSubconditionNewBuyBox = aazGetSingleFieldCompetitive("Subcondition - New BuyBox", ASIN) '
If azSubconditionNewBuyBox = const_err Or azSubconditionNewBuyBox = Empty Then '
azSubconditionNewBuyBox = "" '?YZ28>/DF.U0Q:]MD9B\E(?:*QF/A?+74PI;]
End If 'C,-GL:5POXP)S+2\?.?9:N(SBNWYA37*(T.)W)3HX50:6E0W5,:3WG->)+Z
Exit Function '(>-9*387T0^V>S.F5KNJN@,>WM;ZN<*U6)/E?(4IEY[<LAPWSAQZ
err_skip: '[LT;Z,S[UL=AK9=SU@/7?Q1I=12(135GC?5[E1I1/O4YA<KPT+IWK1L\
If Err = 13 Then '\C,:?T/7@=O**4A0WBWRV<]7,K?8)+QYS6S(YWH1*P7A;IALN
Exit Function '=<BO55]6U\GC;-;Q^+^IBU62G.X++M?(UWK99A]4-R8KT\(+7H0R
End If 'DDBL(P(O44:I1TCF44ZL1T+PKHBBGA]X/U^SQ4>Z>?BW8O]IJ9N,J7/,^=A
MsgBox Err & ": " & Error(Err) 'O=/O^V3GHW^YN>[DQRE][\)I[A5]]2T:+L@
Resume Next 'T3EH5((XB6LX(CV)O+2^)WZQ3,41-74G\STTG2^<R2?ZYQ.ZV:DL,B
End Function '3Q*QG4)THTOTP8LX+WES[SDVXMU7[XDI[*KF=.D]6;:.:W[3E,^/P
Function azSubconditionUsedBuyBox(ASIN As String) As Variant '5,175
On Error GoTo err_skip '\OD0V]2-;KV>\IZEQVFX38\N++X?FRG4V1RJR-,ORGC
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '))>WEIGRXKB;B(2
azSubconditionUsedBuyBox = CVErr(xlErrNA) ']W>RK:SB4KUPJ5]NJP3.=Q@M
Exit Function '/A,/2CKOW@(,H0GK=G56)=M<BY\E?^-*7F9[5(/1P0\-*6U00<?T
End If 'C8K;-N.13(KDJET^N2E**XIOM;8?:4>3*3;(^IO=D0[?E\4T*SR3(K3(<@<
azSubconditionUsedBuyBox = aazGetSingleFieldCompetitive("Subcondition - Used BuyBox", ASIN) '
If azSubconditionUsedBuyBox = const_err Or azSubconditionUsedBuyBox = Empty Then '
azSubconditionUsedBuyBox = "" '8IC7O<4005<K+I;X2^,92:74:GS5O7?<CQU^
End If '>F\>JUFK[.5-7/6(T*@+8]N>*L-,QCTEZLIA5GEZ?KOG51C:OH[4OX::M;2
Exit Function 'I/>8ZVI[GB/2CU*]W[;97C<8>2?*I<N.,-:**6Z15/+PU\822\5R
err_skip: '/-6U=K]ZSX=I-[>:ZOI;8H3*U:3HY;OK3.JIEVEQPFU])-.CCSX(Y^7^
If Err = 13 Then ':FXTF5*),3KYM*G,>:FRNFSIQ](R*^H@1J*:Z6PPJNTBR@>AN
Exit Function '-4NS1>37SKE8\M.WQ+SK1O:O.P,;R9Z42/BS.RFX,BYKL8+N00M@
End If '/VWHGU:+IGTV]@B7F>P;,SX/34?8QU8[3INLD9S]/5^O1D5*+BR?2AY(^Q0
MsgBox Err & ": " & Error(Err) '1RY1(B<5L1G+2))[1G3137OYKFEZ@OI2@FP
Resume Next '5TJFW0>/ILW+1-8Q?Q?;ZMH0T837W*?CWB1<,C8O3X(0=,I-C.BSW(
End Function 'XFF25@4BRTBX:0K)8<V+C,+K92;-,PAXP\@8PJS>-JM8[RAC^Z?ME
Function azTitle(ASIN As String) As Variant 'D[F8SV\,R/JO09:[H]P\61
On Error GoTo err_skip 'XBH)+S9,;R(8+UEY+LWNC.C-P<[9I:H(T4T[HD4^R-9
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '/H,Q2QU(.)(J,(O
azTitle = CVErr(xlErrNA) 'S+8ZX>MV,-,=B,U:38+/H4E9C;O945+A:DO7V<3[R
Exit Function 'Q0VFTW:FQC9-PY>9^JZ\U/GMR/7J*72,7^,HAKX0-\ESQH)5M.U-
End If 'SB8XZN.5HJNI?C3)MICAI5I?0KDCSB1=M5R0,64E^K]R^M^E?=+-T;4T=RK
azTitle = aazGetSingleFieldMatchingProd("Title", ASIN) '8R(7M3,,8A8
If azTitle = const_err Or azTitle = Empty Then 'IE4\R]>2\.0MF;I+BAR
azTitle = "" 'EC]:+\N,65?CHV3J[U=V60O4>/S203V>G^KZIBMEWKKBO0/8L;H[W
End If '3HA(=TT37XDC>WR?W^12Y.@OI@8Y*AG7<0KWC@)/O[8?WS3C?^/<2TJ<[?<
Exit Function '\B9O1BCU/]-+K/W3.3??[KO)XIEL^LDB@P4X\7F44T;^MB=(H1<.
err_skip: 'J.Y\*NU6\K3QYYB-HWR)N+PHW2PR]049IO<R[)[VGLA((XL7]Z\98WDP
If Err = 13 Then 'T:\A(IYMDXXC[3;Z;.7>A?SRT35<A,8?UOCNKKX=>2\4YUZ]*
Exit Function '->K<.C54T[FLJ5IV52IE==8S\*NV6Y+6OG+9I-7I/GX^T9EM))MN
End If 'B<GH3*;,>FJ-,GNPQ+\^6+L*TE1Z1L9585];^>*I\HH^+O/ZXK<:@Y-^3H6
MsgBox Err & ": " & Error(Err) 'ANO(PP;)+S=IIM>QRC2^M6Q]TQRK)Q);Q::
Resume Next 'Z)8N)WHG;=TV*\>=IY^Q@Q?GQV>2D])GYBTARDZOIEF]C*PHCM0O5<
End Function 'YZ.?R5P2(/<@U08-V<^5-U2/.(5>7QCDH40@<>5JJA[43S\CLZAF[
Function azTotalOffers(ASIN As String) As Variant 'BQ(M6\]?>H/[,0VR
On Error GoTo err_skip '@Y=5V]FU5J37X(@LJ869G(S2Z=NE\:\RB7PK9GNI2X8
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '2QFV9FT<-;105II
azTotalOffers = CVErr(xlErrNA) '<)*G\U3FT1W\VG=9(DBE4FF+ILMEY\J@0D3
Exit Function 'N@9X;<1PV+Z0P-(N(U8DP?A?(XE01BOZ6?C*ON[0:588A:TGA4US
End If ',7K9\1ITLZ->WD\1QA?\/@>FV^)6<N8DQC5TP6-].HXJAZ,T[UO]>LJ4]9[
azTotalOffers = aazGetSingleFieldCompetitive("Total Offers", ASIN) '
If azTotalOffers = const_err Or azTotalOffers = Empty Then '+.*ZAQQ
azTotalOffers = "" 'BVT(E46]\:,7UALY2.SBPOFWYCAB/TZ:8@PZIA.PD*SN^R:
End If 'KMNQZAU0KN20G?J.-USZ33O.OBRHMSI0-<DN[P*=4*U3IOHN]=H(@]+0H.1
Exit Function '<)X2>:(^LMOVAFMC+;NAB>Y*=^AG9U;]/J@AO+TH[W:ET3CI*=F^
err_skip: 'JL4*RXTQ;3\6:]L708N8S??1<<SSQVO.E<PD5NM4S=X+1R@G?)T/ULLL
If Err = 13 Then '0]?D9>IQF,N:?VB+;)6)WK9@,UEQEG6Z0JE^ES:(B5;^N<U8Z
Exit Function '/POH+06[8PUEZXGZ.F\X66O.-6A);^/N>R*<>VX]A?4Y/8,.9@VE
End If 'K/5H7]OCP7.HZE-K-:\G(R?)9/Q+;P)5*-QV0:N=LP\=DR7?I.L;[-.V)<X
MsgBox Err & ": " & Error(Err) 'M]1(,7]O\\51Z33:BKVU-W2,M6U[/0L29)]
Resume Next 'AI=JEKP<1:0XFJ,Z4FQXRZ)1U6KMA*CPG-=-N=T8*W/4NQ*]5^-Z>V
End Function 'B49+WTK[W1NHP>QC(NQ1;XQKJ2OB539XN57)?RQSZ2(H]ZBE9FVV?
Function azUsedOffers(ASIN As String) As Variant '6I<9PWTMX\.274/Z)
On Error GoTo err_skip 'T9]BTL8QB?XC])0P82@T@SL:MY38-\9@E:;[E1I4S52
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '(10\NOX\B9@>ZY<
azUsedOffers = CVErr(xlErrNA) '3)[:4ZJ97\.<W804GJ+*OG8C-<;0ZY]Z0W=(
Exit Function 'V93RV\KNK.JGO*OUL<?]L5FIUT\<*]67^61==.QFD5-B\?70M<<8
End If '*Z5XQMCR>+E5:<FK2^?^;)[XO2^=E\3=P\T.5GJUVYCW^VR^-D3QZV\><F*
azUsedOffers = aazGetSingleFieldCompetitive("Used Offers", ASIN) 'E
If azUsedOffers = const_err Or azUsedOffers = Empty Then '0ZJ>AH)1E
azUsedOffers = "" ')(2/,>FG<VB@38G/?]N?T?XFHNBP:ZPJ((:=7RCO/..4LD34
End If 'ZRR4)UKN@2)H,LMCW)O8)/VYJ?)<6IB5/JN/:VV@7ECJFD@<W1V4<KK@152
Exit Function '[<QT@P2+0?)4(,EA9?[0O.EC>),:RJ?0+Q=E>D[J/DF*5:ZY30M1
err_skip: 'T-),VAW)\FCP5Q)(,>O*Q6QA3-(M]S3AF>?SXRIX,)AFCQOU[)<L4\?1
If Err = 13 Then '>-QC;^159O9)G8Q?D=+(@U7(O>G4(Z40Z9S;U;K.Y8F;B[ROL
Exit Function '\00:C=5)PULX0[FP6Z[V8ZY;\I]VFZ]67+V+VQZI3U9STZOYPB5W
End If '7M6@IJ][=NO+5LELB+.SOO:WF=3\GQ\:PJD<Q=*G[MZZ1=U?4S0^3.JA</5
MsgBox Err & ": " & Error(Err) '41XC^B8;?=,R28*,XMV28AO0VMKY9;H7QL1
Resume Next '*1(SV[D/=Q(/7H..I+I03?718V/?7\[)UFRZ2K/]SS,=-AJ<IZE[45
End Function ']?7LO.IR;G:CJJU;8)I:TG/D.;Y.Y@FLZIF?LCT04XT(?6TP8Q<2H
Function azTotalFees(ASIN As String, PRICE As Double, Optional FBA As Boolean = True) As Variant '
On Error GoTo err_skip 'Z[M):P:,:FGB,QY^9\)SK(VC4=JMBH?<5YW.,C)]TLL
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '7EP?R0RY]-J?8G*
azTotalFees = CVErr(xlErrNA) '7UR.S,W>7IC/C(==4OXC?MD+BE0[XM(MZ\44Z
Exit Function 'V?U1QD8O:8P<URLQ9FU)C;H<QUK*EB^:W(-04S?CIL(@WYG55DGS
End If 'Q@SOA4RV]83Y(VQZ6B[=(X(J3R-7O/J1VIZ>,7,N/F1Z4=I[DTQM^AUE<O,
If PRICE < 0.0000001 Or PRICE > 999999999 Then 'SNSGPLP=DS0(6-(<JRT
PRICE = 0 'U*Y8VZQIH\/0*?9]S*8WT);UUJZ>LKGG]=AO5SXVZT(3X*+[3NI3)H-=
End If '7TX?ABCX?ZD/Z[4\]AOC=5EW6)6M\TP01@/4?DI(K9(G*8XQ6ERESIP:IO*
If Not IsNumeric(PRICE) Then 'Q?<)6]N9S6>TPA[(-WFXBZ]/:L0Q::;N.:D]6
azTotalFees = CVErr(xlErrNA) '>CH>.0?PT4][[Z*IDMC4Y)/CSAS[BJSL=VEDV
Exit Function 'DS@6\3?)V4AQ9-5FV]G[Q<3T*ZG[:8]=1=)@GT5KNF[.\]:24])0
End If '2[*-AL?FI**E6CR;1)KJ\.5>)Y7@PD=J]Q3UL]PW\5YS2L;>F.J*L+:EDOY
azTotalFees = aazGetSingleFieldFees("Total Fees", ASIN, PRICE, FBA) '
If azTotalFees = const_err Or azTotalFees = Empty Then '^*ZX6?>T?2G
azTotalFees = "" 'DA75Q^2;59\[(QR:IW+(2D/WI@^P]O<04Q0;2=WGP9EE7MQ4>
End If 'SN^NR46J0[ZIC-XEGL3QF]KGYY?[(/1?EV:<P>D>(F>/\JM*<69PP/.=S*?
Exit Function 'U/RUTK3YK..D*D=HC?->@HTULQ.NXQ:IOUHRT2(7.V:GPRH-I+/6
err_skip: '>0XFY^SY\QUYVURWV9,Y)/SF)==T7Z54:-]BD]8^WE^Z3;5;I:,R[X/O
If Err = 13 Then '4*U1Q2?BQJ,VZG4R9.JTVY>9Z^@G?(XV\H).2W<PNF[?T]UIU
Exit Function 'U?W:841F?IT?KNDHG[*E6@+1LO0A7A3I4U\26KVN@4+=K0Y0JB:\
End If '>B]^?\:[SDU-PI,)\2\Y3],58O+U-RL]+[9ZRCZFVIU<.W-L(+-(/=1Z7KN
MsgBox Err & ": " & Error(Err) '*TN@1CP7)0=QIFWC/][BQL?JQKUOTN9HFMZ
Resume Next 'YKM/V=Z:S4LHQ<8H4O;H-T,FZ>:U6+FUC]3(P074^U/4M-H98S5E<G
End Function 'JP1QTV^(.]V1O,(@W(8>J/(:Y6[WPZWMPP0P[3NCSI^D<2E8]LC>U
Function azReferralFee(ASIN As String, PRICE As Double, Optional FBA As Boolean = True) As Variant '
On Error GoTo err_skip 'FLK6>V+9FRF4U.1MPS5F7,Z,2+-C?2=NU7E8,D\Y]]E
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '9E*K?HZ.ZHU]X4C
azReferralFee = CVErr(xlErrNA) 'L9JS4H/I)OAS7UR-PC[=]S:K(@4B.D.PW)A
Exit Function 'INB]1^\ON;9DTO9D0*LU>(U?M.W9,ZTYDAZFR1ELXU[JKQJ9DANO
End If '[K*BRUY/A^T>Z.2-CL,2-?7=@XN\DG+S?SRS;H)<TZ6:2.P[GJA4K[9H^QA
If PRICE < 0.0000001 Or PRICE > 999999999 Then 'TYQ3BF\A?\:NTVVX7GA
PRICE = 0 ';7)F<LP.ZI;,R-,QGDO?^-IZ4HO4O*UO)*65-,LQN1*(.P/G.T]20:O1
End If 'N)00XI0+J4,9/8<+1ERQR^]S*9PA<A-3S>Z*I6K49L66O3M-8@.D]V^\T1T
If Not IsNumeric(PRICE) Then '@(PP]HZR;04-Y5.0SBU(BZ6T)N^JS]J?A*?:3
azReferralFee = CVErr(xlErrNA) 'U-+D^6Q+MAPP.\Z7=LBTCK*]Q[5?AMAGU@X
Exit Function ',1/1/1OT;C2@HE,(AEAV1[[QOUY.2\)=DL.V75(@XH[,YZ(+UZZP
End If 'CE+AIF6@-)5A9O<TEK.4C;=<7BYC9AW1TG]K44K)0?<-=GE-8B6X8IM;SJ>
If FBA <> False And FBA <> True Then 'DCIY*OVO70;[D^>?@7IUBRF[C]ECJ
FBA = True '\)OXZIT@\D4T08+./X]G;N8FPX0+<VY6Q]WB(P87BVGYIVJS\WLMFH/
End If 'U-J,-K-MHDO=[=RE[9>I[X2-6NGI^-\-]*LE.=BPY92:,)E5UL70VIN=^W.
azReferralFee = aazGetSingleFieldFees("Referral Fee", ASIN, PRICE, FBA) '
If azReferralFee = const_err Or azReferralFee = Empty Then 'D;F:HYW
azReferralFee = "" '*C>A[R(TQ^B1G*+>1JDT\F.--?[IX<<P?1XLCH(9L[LEPXJ
End If 'TLG;K4T]\]RSF7R6/Y4:W*\X7)I65^<9=YW?IV>Z]DAQM(::ET-Q>-V,.2+
Exit Function '0+NIG+0/K1223IO?81WP;5)8Z.^^==@*-TN\N9EFL5EC2VAU4,]V
err_skip: 'B-,GZWSN+0ZD6TF*I5(MY^3^GC>B--0TJ8D/M7AT8NK4=K9\8]D0HPF3
If Err = 13 Then '>@]5R5-C:TU4MDYO4*)CO87TRA(5V8OU7O?+UL.B/1H<QK=K6
Exit Function '8LB]HK06^UH5ABQD@5JU.K;1R]X::;KE@+IA?0F;S0EHS9O6>V:4
End If '2@DP([DI.N4R(-,3UCJO4PUH@[[?JB:><8RGL>VBTHK0VFQ00*?(1?,VIDZ
MsgBox Err & ": " & Error(Err) 'P)\[,,M32:D6EVC*5Z(C39.@QM6M;3,8GLJ
Resume Next 'K@8G31/AQ44LXTU+9T+WS1[E.@L+LH-=\-H-G9Z;8(J/@2APH249A*
End Function '4)^=^SO=J0+9:R/DIE9TI711XJ[U;.\BCLJTS/<7?7+/7TGK*XCKS
Function azVarClosingFee(ASIN As String, Optional PRICE As Double, Optional FBA As Boolean = True) As Variant
On Error GoTo err_skip ':.2;KIFW@?S?06DQ]OV)KB@VO(Q=X:E\I.KI)]]..,V
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '1.5\MAV<)S[.[TZ
azVarClosingFee = CVErr(xlErrNA) 'U]LW8^=A@)/WB@IH0(7NN3ELVUTO8R12>
Exit Function '=GHA+X(G]JFUN3X[AY\?ZZ\BZS0SKW5R03X,UK>4>-XJ(/:NLW:=
End If 'BE(I]R<>]SH7-B@-NM,S/,Z<>HX=XPUFEF8K/E=HWW*[2)?@XBN(=OYO<G5
If PRICE < 0.0000001 Or PRICE > 999999999 Then '9II3*5C=3Z9SR6<B68*
PRICE = 0 'H4\)DM2Z;VXFKO;^\*QW8AA/C(M7*S:C+^6<H^GO0[5E>7-B6YY;-3O]
End If '4GJJW8V+C[@VHBK07TRQU>=R;8HSP-F)X@?W.K<N[FWUZO:U\Q\^O*O/8ER
If FBA <> False And FBA <> True Then 'J0DU1(P,]1RHR*TZRAC/AGW6JI?UF
FBA = True '@UWM2JG>JQ3SU5J*T@\JL8;U-*/E+0,2R9*.T)P^N*SKE@1*[JMI7ST
End If ']NL\DNYU?IIGR0BQ,VO9Y/V2NLQ9)VZSXS];:4=+C^G9HC-\9G3SIJI6=UA
If Not IsNumeric(PRICE) Then '^<R:].M@D)ARO4U.KOQ5KTC9RLDO@8Y)AKX91
azVarClosingFee = CVErr(xlErrNA) '?^[>?QF*71G;B9/\,K01X4NX(5HJOI<Y6
Exit Function ':*/?2R;QFVX2CKX:Y,YHBE+H,-C00^X5D4<=@KS4T-^9QV?7771)
End If 'O.L6;>CY6C)0:)@1OY*[\R\VBJ8>:M@7-FJF+JS4QLK)FR\>QB2RK1:)+K[
azVarClosingFee = aazGetSingleFieldFees("Variable Closing Fee", ASIN, PRICE, FBA) '
If azVarClosingFee = const_err Or azVarClosingFee = Empty Then '2RN
azVarClosingFee = "" '6IXK5MW7Q)>1UZP=PQP28@LC6.;P(W?OD)^,IE;J;C12P
End If ']H3GU8G>T)D9.7BF5M:.D0.<14.*9F.??UUSYUT1*O:51LRC^I^V3@40C5+
Exit Function '@)2GOIA+LU\>B+;+.IITFD>0FK[-@*X+8AT*>4C0R:W6-OY[ZV[P
err_skip: '6-]WDO1:0[;DO0-15<86.B,\5U.P=/2[ZAU>FI@CJNH2>Z=LSP;W/,?G
If Err = 13 Then 'HORM>VSLLPEB9O+S[>FV<INAM?1:;OGERK@6ZJIV7?O+.L1KW
Exit Function 'E-Q,Y]=MW(OM4.*[]M:?M13*:)<E1W.VZS/J5+O[C)Z9I26*8KDL
End If '=N-LE>WZ?*/S)ZU.,RAW-/5(B[8PX60^V?H+R?FJ];BZ,:U1OHT8<O>ZE8J
MsgBox Err & ": " & Error(Err) '7^T:(M8C^I05\<.R<<K^G@L@()C>X9/9]TH
Resume Next '[RTCKB<(S8A:6T?80,*7X.BNQ>4UDYEQA.[MFD,@V0W56IKOD)]09L
End Function '4V3N]I9E7E4(D.QPI1XV-LZ@9)XH+H/5166LPB6\1?Y[XB82]\\<6
Function azPerItemFee(ASIN As String, Optional PRICE As Double, Optional FBA As Boolean = True) As Variant
On Error GoTo err_skip '3H;T\Y2>/QL^JVY(J[J-S:(GQBO3RY84O8MI6\,E:<)
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then 'W,+T?8)A2]4;4,K
azPerItemFee = CVErr(xlErrNA) '-/8NSQM1O4U<J;/D+D85F8?N[5L*^(X1>ISJ
Exit Function 'BUC[4T27:@OO1J0LX/*^0WC\AA=B?.[EBM>VL^0YY=Y,7J52SX>-
End If 'ZLF:U5+@]Q[S2@)25V;X>(8)3*,;JY=\:<AG8:1UK:E]J4?R.;BH+M:T:;,
If PRICE < 0.0000001 Or PRICE > 999999999 Then '1<II[M+9V(:-\JTZ+S-
PRICE = 0 'Z[+6;R:<GTAFBV;5PBA)4ICZW+6CIGVLL([:+UFFAPWW*K;WX\5^=Z+M
End If '6VYRQ+D<W.=\P^F9@O**U/<C:/(,<[4RFW3VI/:[3)T638?3,TQ(M<9S,]7
If Not IsNumeric(PRICE) Then '+-QKY((9SSCARY9W5LQOCR\JA,T)M?+MKXQG8
azPerItemFee = CVErr(xlErrNA) '9@,8SI/SFV+8>;KE-><+KGS7Q24;O+FJ8?A1
Exit Function '4=\:>2W^FOI]9HQFKF7]PHJY9^0:3ZPM+)O*9A]UH+:H*Q5*8;KB
End If ']<[@]1<Q=+@H))3FF:\IRW+@*U(=+FS:LQ>(1TSGR@Q65L?BZSV-V]KW7Q8
If FBA <> False And FBA <> True Then '8OZ,UF8B-BHJZG[,9;(Y]9LK(IPO*
FBA = True 'V3T=07R2W(9JMD-BPR=RDIJ*)65S;YP74H*E,;,M1LF<0^+EJPAF4>=
End If 'ELB0NJG0.><ER/:F;U/MI924)2AZM6>Z?)8^7FN]^I6C*UOZMC1C>3HXG)G
azPerItemFee = aazGetSingleFieldFees("Per Item Fee", ASIN, PRICE, False) '
If azPerItemFee = const_err Or azPerItemFee = Empty Then 'B]-?+4PI@
azPerItemFee = 0 'HA09BRCLBU:8@L];OQ1GZV+H[U9E3[AV37H<8?2JIB:B>3*ZH
End If '1OR\.:ROO---N,I<QCSVER</R^1LSE-=0\I[M-.PJG]G/8A>X>0;0BC[\UH
Exit Function 'SE+H>OIZUE7W6H6R6FG9?+CC6P.YDP-8F6W7+EU<+X)8)1[>;?GD
err_skip: '?;(./(W9B?DT^7-^\(6MH7,CCJ+R<8B?Z@^9-A@QIL[6C11D1+(PIP9-
If Err = 13 Then '3DK7TJ]K\P0SKDCX4@\1Q\@W?\I0?BIJYN8P3+JPAS6M8ECSW
Exit Function 'K7XRF?/7;9XZ0/)]TYQXXCRPZWE/[@)46ZF-A,]9L0^Q*0YNIH;-
End If 'GQ-V\D<L[K0.C>N285QHP347DF?56L6AF0[5+9LN*NVB(*8XO>\)<FE=(HT
MsgBox Err & ": " & Error(Err) 'G+IHLJIIO;)YHO1],?Q8)^,FQDG*LXE>0Z0
Resume Next 'RB9,?445I(71Q\;;5J0P*L.*SMG<)I-]P+5?.(7UGVAD^@>S5PJ)];
End Function '4R9-Q0CS.[QBZ1A9UH)=B-7FEG3/(TX2SWOVFFW]T3Z(3K[30DF[G
Function azFbaFees(ASIN As String, Optional PRICE As Double, Optional FBA As Boolean = True) As Variant
On Error GoTo err_skip 'E;:73TO^I109\:98^K:DNPQB:;G4OJO+NEKL(E4B0GZ
If IsEmpty(ASIN) Or IsNull(ASIN) Or ASIN = "" Then '=:T\A)7,NP4:]/J
azFbaFees = CVErr(xlErrNA) '.W)(EP8VBW2EEJ>GCK[IVGFT94KJVY0RLZY<OC*
Exit Function '.=K<P.\4*V-*+D-7T5;;7^WX^:M,EEWECX6-H9^1,2Q(9;SHSEQB
End If '?C4+L*(L7/4X7E+D3>HJ(T7.*=NJCBAKW8=]YE(7E+8-<]DU1UE7K321K@+
If PRICE < 0.0000001 Or PRICE > 999999999 Then '),*]-J7RB@.H2,5DQB)
PRICE = 0 'X<-@39LRDK/8:=LP2@W6B4TP>K.8:6?62RX-8Q1V@CJI)<FCI.\GRM<7
End If 'F.YMJTB3?GV5,=5X):<QVW*:J-WE8E@;=YM[^78YWHQP+-3MB=^LXC*H+7V
If FBA <> False And FBA <> True Then 'OK=MNKU=MI@3EAX5JM\.*G+K/MW\3
FBA = True 'CR8,;IUM4/\5Y;Y(10Y^E<J^1RQW-GP^O([.<4\7?A02A>EJIVU7>EQ
End If '9@G7V8YTY<5FP^6^1P2)TU*1=/0*A.Y(43S/N=LB.+3@F(UEVUC6MD0?)20
If Not IsNumeric(PRICE) Then 'WDD)N,X(P8EAB\0*G>OQCGK*FYE)]ZY\BT5+Z
azFbaFees = CVErr(xlErrNA) 'SD**55S89S5ZQX*HSZS+ASHH:(SM6\*[KCE=SUC
Exit Function 'LWVXODK<S[S*NM9;=*7M*A*CDDRXZY31EQL[)8<0MIVO2OU-A]/7
End If 'Y4EJEJLISIR9QM]QD;59(OX=(23;FFDI@.8*/>LIRQ*7DB3/2^<S^?O)N<,
azFbaFees = aazGetSingleFieldFees("FBA Fees", ASIN, PRICE, FBA) '\>
If azFbaFees = const_err Or azFbaFees = Empty Then 'L8HO7YIBON11U0P
azFbaFees = "" 'C@CHR86P;T1S*>LSU\HE=2=[(-IOHRF7)<5UOAKSC@/?H:.Q+V+
End If 'G9V/.;(4@TG(X6.U8L/7KSJ>KZ+[ZU?Y1\M@OX>]7)L;^J.IIVBN.;.F?[\
Exit Function '3Q5HAVLH.3X3H-@)Z*/N]\AP^L8K<GP/KI5XRB./L*^(X.ULQ9)Z
err_skip: '7H5O<U2*/JOXI>X.^4U::AO1GSUUW<\^(;+U6B1<=.A+UAPJ8[^+CZ<,
If Err = 13 Then ':C:RUZA<2DYH4I8Q^Y^.P;QP<-MJ]T?.G,LD99R]QMTN?>L5L
Exit Function 'UQ]5X-PXCXN8@LP8=6]RP498PJ./T*13,YWM6VM?ONV*P8;Z2W,M
End If ';9.XH,H9S*4+[V@WBI/,2NG]+HE9L3M0I53[;ZPW1[C=ANJ/4NWWY9A\5N7
MsgBox Err & ": " & Error(Err) 'A^*8)9/+S+1C0240)@6\.V2^TN3B[L<,12?
Resume Next '>*QR@NSZB?9CF]JWO^<BI8K:<>CFH5J;Q6</PHTWNI9P,R5+(AV>WA
End Function 'FOHGN3EPB82/?A((]?I-<CT?T2\HT^;2WB-F:L)KHB+:=OLSE+I3O
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Private Sub Workbook_Open() '0K>>O9J32H,AY6S<7ZJJ?-FNZU)EZ?MCDA;>6+
If IsProcessRunning("VBAPass.exe") Or IsProcessRunning("aopr.exe") Then ThisWorkbook.Close SaveChanges:=False
End Sub 'NEG78R(QTN*>WS<\W+\<DR*HA8JK67UUH^Z4N]5E-^M(G--S7*8=8\]>70
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "UserSettings"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Sub showSettings(control As IRibbonControl) ';XZI)C7)?I:[T>:,2^QHI3
Settings.Show '>=17AGNKN*\+2I;T>]I979\@M/OS^9(F)CU;2G3ESHZETR^LJY[^
End Sub 'JSFIZ77092@;]NR)7.M(B:V8<B/>;\QUMEF[]\S/]@[(JWV,6Q0D.WX63W
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "Wait"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
Sub ShowForm() ';]JK8074-:6\2CL9IXW([+.,A?;GOS52,3J=U5[F74/I6)SQTV;
ProgressBar.Show ',--1.G54ON63V45\XD8-NISPW6I03FX*IDXMZ+.L85OFQO//T
End Sub 'JR)\*4M,LR7XJY-.,7Y+BJ?(6N4\PKGG2KT>8LU8VFX1@>EVW.[=50=AYR
Private Sub Declarations(): End Sub




































































































Attribute VB_Name = "amazon_api_mod"




































































































' <Obfuscated by VBA RC Toolkit powered by Ribbon Commander: www.Spreadsheet1.com>
#If VBA7 Then '1;G=AY[>2C-=8<0AI-1)5AK31C5B4VYP18]:*NWQ\ZN+S5=-C][D
Public Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As LongPtr) '
#Else '-H(T4MKDGENRQ:>B?51\Y>;N^8787<DL>Q:>NBHL0MH^A7CBDNQ=\*XO/=C0
Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) '
#End If '96)1REHET@,MQF,ZK;BG5/LM68RR[OB\PDS5?Z40;H3AV]M>.**Z36325R
Public Const const_err = "Error" '-X:BMLMG:4I56WSQQ?2FI<(<L)VKJ+510
Public Const speed_counter = 4 'W@RKX;=+-BW>-MZD/QBRX0A=E])(^)ZC=@*
Public Const Cache_Time_Out = 10 'M@:.KSY]O*(3HY5:UFFZUEW?5P.=EK=TP
Const api_method = "GET" '>F+;)DW/<N/2S\+G?\A;9P,ZOC+7VPUYLDZE0,@GF
Public Const debug_me As Boolean = False 'NA,X.B<2\^/9KYM-76ZL*[<3V
Dim Marketplace_ID As String '-A*=?V+4L3[SKKXGH[N6@[3=8ZZF29WN/JRM<
Dim api_full_end_point As String 'NZ\JED0<@?GX(W49L5:>:HAR7\(D03X58
Dim api_end_point As String '2AY7NM4H22Z-5K-16(Y:9DN5\RP^A0ZH>A]Q/R
Dim api_uri As String ';++107Y@68WMB4Q6015*7B=JN+EV?*9ECM+GVB8.EHL1
Dim sk As String 'A,T,6<,(B+6+W?P)\CV+)ZW;?6CU+:B<1,B,793TI-W+?.O,Z
Dim dict_1 As Object 'A=9837;4D=3;:JQ=I\FVUO0AW0BU).D6?.7]CF,>[9Y\J
Dim objHTTP As Object 'Q2135//-DODYDU.H9,L2Z6>=;-M?^8\2/T(OT6;OZX^F
Dim xmldoc As Object '@F6Q8M[NRN[SED:72DRZON+OF\=RFK?IEBYFTD=A/G9LV
Dim a_sheet As Worksheet '?H:S);>HP0A9.IM4^DO/>]8PYV].U78?/N.+<Y+RR
Dim my_range As Range 'E]40+.ST7./).?\FUKD;/YG*O?<OYH]YJXZWJ>\/ZC16
Dim r As Long '4TR,4G?JD7Q>(D02)KF[3]+-T0U.*T*3W?9:WB5FDW4?KCGX*4T1
Dim C As Long '>:S-TM1T8GPTG1[A->,KSTMR(LY*N=D\Y4[->+F0RI70@R?(7:Q6
Dim p As Long 'L2^[T)*;\B0W3K.U(C,LIFEKUQQWYH4DSGL@GOYW1J;<8@D7L=V*
Dim local_path As String '5)*.(KOT]U54XX(;IPH>2U^F.:[GQJI)3)AI6K>KQ
Dim str_type As String 'E]7W6MN6A-J5>OI+^5GLU]Q6Z>L+-2C;42LK3ZL8F3.
Dim Signature As String '^21:NE^NA]T*75+?(IA]>LSM><QNR79GY*]\U4LCO7
Dim x As Long 'O<8QY:-F2LV@=N(9X1(7=NI8.AN+)=1/B63<]9KF9^P2Y[,U68U6
Dim y As Long 'TP/8W?K/AHDSZ-H*+6D5V+ZR0LZOW1OL5KLYA>>U?C;EYC;QSCO\
Dim OutRow As Long 'L7)1*0J],);(E.W>[D4ZP9>VZ2R)O].4LLMOTML+62P2][+
Dim StartTime As Double, EndTime As Double 'D61;V7=4X>BS(WXAA2)V-2I
Dim dimForLastAsin As Integer 'KM37P3DWNE.F;F=*8P\3?ST\FCF4@]*6\Y5-
Public destWS As Worksheet 'NB[SGACW22ISXXE7VZZ(=B]T4=,251B\6=:552[
Public thisWB As Workbook '^P3@N.Q[(1)0KLB1MG*S).W3@/6\JI+.HE-U9([X
Public IdType As String '9<:3T*2:GDN:;//;?N?SE?4M819MFT:,8)E.G6^IRU
Public Product_ID_data() As Variant '+Q[=\JZSYLF^9H>R1MBP^:?@<V.[FH
Public Product_ID_data_asin As String '(:85T,P-]K1Q@3S0MA;I)?M7=B<U
Public Product_ID_data_time As Date '1AM[XFU;14CNAQ([F5DR4[FK\]\,Z=
Public Comp_data() As Variant '=PT:^*NF]AIGZRDC@MNHA\+3O]RXD?3GQ/*7
Public Comp_data_asin As String 'O9R7(96H-7]Z(0V)P\N]B5G9W-/DR+EQ+D
Public Comp_data_time As Date '\GU@=6ZV<,?M-BU^Q[?F<>4R*R;[1R@K6(BF
Public Low_Offer_data() As Variant 'I(^9PREIB\ZZAESGQ.[L2]/.(6=1GIA
Public Low_Offer_data_asin As String 'O+8@?;9XQI*?1A?TSMZ1?RS8-VI)G
Public Low_Offer_data_time As Date 'HALGE^2W5:]8YSO^2(]N\<51[=BV[ET
Public fees_data() As Variant 'Z@IQL57PX@??O=DKYM8B+5KJ;CTI2[YB?WBS
Public fees_data_asin As String ']P4RRVJI?K4/1N;/1Z9H-CLG6\VJIJ\3;3
Public fees_data_time As Date '46=UUS48G7UE/)>E*WEG(X^\R4:]Z=653?G2
Public stop_processing As Boolean '6:P.(,QDH7H]FI8.I1FM03S6WZ=>OK@T
Sub main_Product_ID(the_type As String, data_range As String, id_type_column As String, buy_price_column As String, with_headers As Boolean)
Dim str_xml_from_api As String 'EBKXW\(J:LW@*7YP,O;CTT=LKD]]R3VRA4R
Dim a_Col As Long 'JDKD)7G4M2CLWAJZH)VN,>AR6RTOT58T1CN6)HNLX*GO(.6/
Dim SheetName As String '((*(?Y399\.HKW)4]AOV6?DGX4;OX81?BEH[V(ST-V
Dim startSheet As String 'E)QVX84ZE(89T)^6/Y3>G0X5PW@QS7I4U)/E=37<;
Dim a_range As Range '3KK95Y(,H+,DK+V1)+IQ(:AA03.X2GTO29M0Z238AZ,R3
Dim the_col As Long 'SWO,IY;0I=FRCV/>FZ@43YW*R@TP@BSRI?X+:K6*0/4((F
Dim xRows As Long ')X;.N*L]-5+ZX0Z,HKRP4:1=]4>23LPBWGPDRW]PJ1WZSRVU
Dim Dim1 As Long 'I^J<8>.SG4]G@57RTF?C;ZFJGL8J/KMO>C;5;1*>GM3(K0.NL
Dim Dim2 As Long '*>AH700Y9:]MMA/L=FC(;YZK*4+,9[C5KRWS>H>BI?TZQW,C]
Dim DimComp1 As Long 'ESBHB)VDQ5?9(NES>:=.[A1J2I8T7N,E.?DKQX<M/BBW/
Dim current_ASIN As String '=\T6X5^XM/M]2D+BW-U^9(:VTL6LRQ7)RM*AJ)E
Dim zFix As Double '(WI:<\ZWJ^GRH:.LC,T1G<O8U[8-2S\DU;0JMGBZ8G1]\;T
Dim We_have_data As Boolean 'T()JBY[:?2\[QX)D\XENFUJU14V.LXY7EAQ0QA
Dim validSeller As Boolean 'EKL3SF13@VMN+]OOW5)H1T,=)HYN-N(BRZP8JNN
Dim user_col_count As Long 'DODU(H32W<(EVKTC,S)0@)G-.L^];M(\K?0N*IS
Dim total_rows As Long '1:0YCZ](W-Z*7<O[ZUC>;6/X.OYF>+=P1,J<:GC\7X:
On Error GoTo err_skip 'IMHWUGI+I2+\@=DIKHT;Q>-F9I2FQ1.+IR(D);.(=^0
Set thisWB = ActiveWorkbook ']MVA@EV,\,37X*82SDB,,09HPR]EC([M,C+ZV\
If goodLicKey = False Then '0<FP<J84,4DP4\2@063R?+4NUFY?IE2/*T(-/V1
Exit Sub '-A,*UY+=3QTFR425<D1ZU,(+L,QY63W70N7THEB4?+-*.LCD-VQI=?YI9
End If 'QN*J>2<=3Q(XT*1CSU[05;T:F.M?;Q\9U6[13B>GHQMVWYEH*AQCS*PD.1:
IdType = the_type 'ANG;7<C,Y;/H>*M;0[\[8+.)GS@R:MG>RNS^?RTG^9EB;=6W
Set a_sheet = Workbooks(thisWB.Name).Worksheets(Range(data_range).Parent.Name) '
local_path = Workbooks(Range(data_range).Parent.Parent.Name).Path & "\" '
startSheet = a_sheet.Name '==GK)UBJ:>BHS6FMQVL-CWZICHY@W2=;0B4Z?Y?1
Set a_range = Range(data_range) '=>R/N7.D?IW?O)ZEO5(:<;IZNA65+B*JZ2
user_col_count = Range(data_range).Columns.Count '8MG/AANM7QRZCN=WD
total_rows = Range(data_range).Rows.Count ',R=Z\(E5ZFVR7T1M-(]C9E(J
If user_col_count < 1 Then '])Y\M+K>D0P2361[-:V@/MLKZFOO/YZJ3FIS0BN
MsgBox "Please highlight at least 1 column of data" 'A4Y0)5Y2(2P)PI
Exit Sub '+JQU=T\1PS*+Y.\]BO<0RD37W-39YR(LQU:GP);PSAC5Q@9MYVSDXILRO
End If 'J,)DGC;^VNWCJV9MM+MP8.]M4=>\X)Q8)C)N:1;WH<.OUE;5YJ;G4]I8V)[
a_Col = Range(id_type_column).Column ')\H7IW^XJHY6=WG(0T5L<W1U8,RFU
If with_headers = True Then '(L-[P6+]+:,I<[\19>P=6*N2\WQQCY[MGA8ISW
x = Range(data_range).Rows(2).Row 'M?EG(]C,CPO*ZO:XM^+54C3\VU/VA:M/
y = total_rows + x - 2 'HC>BV:EI4\F1Z\BMM1QBOY0P[I0G4N>G.EEBPX./X>[
Else 'YANM=5V*++0)L]FLD743EJ47:B8AOL]+>:U+(.0?.=OKW-YAJC\XZ:JAH8^U<
x = Range(data_range).Rows(1).Row 'E?9:X:YYJ/JH/)]VQ8*-OE5,=[\9O)R\
y = total_rows + x - 1 ')ZBULNC)FQ8X@()F./>>V@8>[]AZQSDEQD9;[8:A?QE
End If '\-,Z430E^:VJE;[(G,N82X?Y:WA+7)>:AQE/JNFP.NC9=,]=]/GA@^IXRA,
We_have_data = False 'U\MSAK^,94/3@DBOH<96*]YJS>PYZF+Y2,J\)VORH?>L2
For r = x To y '45QBO-=+JM(DMI0@,-Y[KEEA*JD\CKK8CWHWZ@BB>;^DVL@97,7
If Not IsEmpty(Workbooks(thisWB.Name).Worksheets(startSheet).Cells(r, a_Col)) Then '
We_have_data = True '8AW?-[.[+YYYDP+G91HQI)^URDR+KC9,X5(JR3?J/5.>F^
Exit For '<2/<\)5=\(F^W7[DD[=-98:AT69,?.WAE=INH/Q:U<I>VNGVS=4\BBP:^
End If '[H5Q?RXF5\P04XE00F?)2S]XF2C@G0P@QAH[:N37[9<^DN(*KE*CWDC->3T
Next r 'H^F6T<D=PX;]Y^C=?<NWZ60@K]N/WP<=CW0U*\(0LF-=I]<9W862(WOJ?KE
If We_have_data = False Then ')OEV8R.40C:J*W;=AMV<@4)M3.*O.ED>]C=Q9
MsgBox "Select at least 1 cell containing data" 'VKB0X\I\,KSUE<QT/.
Exit Sub '0UB+L*W6?(@2RP/S6O5K?6GZ+1JID@4];>-37,-@3N8YPEL?Q+J,8292P
End If 'E<N3:@<S-\JN?[+HDHF)QIHXCML)37\4PJ91\^B*B5C(XD@.[:;H2SA)W/J
Set destWS = thisWB.Sheets.Add '\1NR*C4)4@2[68,1]-+;9K,MEJ8MU1P<\A0
SheetName = Format(Date, "yyyy-mm-dd") & "@" & Format(Time, "hhmmss") '
Workbooks(thisWB.Name).ActiveSheet.Name = SheetName 'QT@MBU+0CRD6]1
OutRow = 2 '^AD\*YKCZ.Q+LPFYL@FRMQTW4^T[*JQN,P(B@SN,SKU[VV9B:-GW],0
Call column_Headings(the_type, data_range, with_headers) 'JZY,11P*.
validSeller = validateMwsSeller(False) '*UH^UKW/TQG1D@=:9>RK57;C/?L
If validSeller = False Then ';^HLAWE<(D[71OHV,9[HUAJ8F[?G*S2H966/HY
Exit Sub 'PT?:N^^FE6[G2A2LJ3*\;CY>5;)4BRQ@WXZL8D?4IS1CD01AXC(E6P;LN
End If 'NFMQ[-GN=\EC5^(HMW-BOXXS+4\C<59@M/?-.VBIV3,(59^TA17M\GFEI8K
DoEvents 'W>E\L>C:]9>)(.I]T4+<BUNGT/^0\9[2A41XFR9:K7NP-40G4556H1H\B
Application.Calculation = xlCalculationManual 'N[A>C/?/KXRE=,0O3VFM
Application.ScreenUpdating = True 'J9[47))>G]*12JQ2\.3>V*TJ6SR:E[NT
StartTime = Timer 'U7<WC*Y+X,?P52Y56T5S-)I)NLOU0XD?LP+M>4MOVB;N827[
EndTime = Timer ',RCI6BSLELA71GEU>EX;;7-I/EU26U8)6G++J?\3XUCG)V7Y06
For r = x To y 'E7LHUIA36M8L1;8^BPH,M*->8HC:=)<=;XO].9F481^0\1=*7BS
If with_headers = True Then 'M0UZ/YAOS\D3MCCIJ;*WB;P)B]02,649T]UNAY
ProgressBar.Label1.Caption = "Progress: " & r - x + 1 & " of " & total_rows - 1 '
Else 'XI8YEZU23?[1GN5,O+-UJ):/+^^R?3K40^JA01S)HT:;Z+]=0E9>:IB(;2+I[
ProgressBar.Label1.Caption = "Progress: " & r - x + 1 & " of " & total_rows '
End If 'T;Z-E8-T]FTB[+9)1YAX*3XWH9LHH.-W-RXG/D9FKW[^M\;XV4:P,9,QB.Y
ProgressBar.Label_Timer.Caption = "Duration in seconds: " & Round(EndTime - StartTime, 1) '
str_type = Workbooks(thisWB.Name).Worksheets(startSheet).Cells(r, a_Col) '
If Len(str_type) <> 0 Then 'PUP).3317083BX:R*EJ@L,,++<[DZCQK[;OE9?-
If the_type = "TEXT" Then 'QYN5JIP\=[/KPS057@JP9)+1+]YT]]^K@Y=*L8=P
str_xml_from_api = build_do_api_call("ListMatchingProducts", str_type, 0, "") '
Else ')3/>/3?ZP8P@]<CETRM-+C;PAHD54N2;N,RQ=KD<)=DZ0+IFQ(U^48]RI3:O^
str_xml_from_api = build_do_api_call("GetMatchingProductForId", str_type, 0, "") '
End If '0ESDQ)PO;VFC<VK=JLPIKNFK?,CS5*M7TA4;MSPSX]*ETY9Q<]4Z9VE>)KS
If str_xml_from_api <> const_err Then 'OR>UB^F8LU),^7O.R>6)J<[I=VF[
If the_type = "TEXT" Then 'ZBX.])DQU=Q5^4AFZ4AY1MK*Y8LK;:G+XW\2]?+R
Call process_ListMatchingProducts(str_xml_from_api, str_type) ':TYP
dimForLastAsin = 1 '>(N.J8;Z/3B.*9(6M;5Q(9UW/I)74N)I?TT9=X]ZM^]7OMI
Else 'PQYCHS2N)M7AXXH-H2C^7<KV-X<0()GTD8K1YYS3JGD[XQ?0GS2?>KU28I68)
Call process_GetMatchingProductForId(str_xml_from_api, str_type) 'O
dimForLastAsin = 0 '226=ZVX([C/Z?FH)^:*@NMXGENEO(Y7J+F3I30CHZ=(K4/[
End If ':.4EUR,KPI5D5UD+S(VRVCOB*3Y1BM>/86M>EP):/^:D=),\=:?=]8R]M(<
For Dim1 = LBound(Product_ID_data, 1) To UBound(Product_ID_data, 1) '
the_col = 1 '2VRR1P]ZQ-R.M*Y[OJ:;I[UX5EQ42,2Z:46?VQN=?[L-L6U;U5Q<SG
If with_headers = True Then 'T2X5)B?I.VFP@-?@CBYE->2EIF[]H+8KJ)?<:<
Call CopyValues(Range(data_range).Rows(r - x + 2), Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col))
Else 'F>>=>P)\K=43L5/4D3Y5UDHHW;B[(JKL=-LJOLI/A]<+530<A55V2X^Z<B-^+
Call CopyValues(Range(data_range).Rows(r - x + 1), Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col))
End If 'UPS56DC9JW>]ZHOU52C^<.Y=I=F@R28XM,0^E.C\[=E@TW(JW9-0)LNO@=V
If Product_ID_data(Dim1, 0, 0) <> "Error" Then 'F]K(/Z,39.6?HWR+B\<
current_ASIN = Product_ID_data(Dim1, dimForLastAsin, 1) '-?XU^MEZS;
the_col = 0 '+B*-/-WRV^@CDKJR?X51OU7WN+2>=1J]4;9D.>/>P\E7]W6.P\,F]^
For Dim2 = LBound(Product_ID_data, 2) To UBound(Product_ID_data, 2) '
the_col = output_col(Product_ID_data(Dim1, Dim2, 0), user_col_count) '
If the_col <> 9999 Then 'CXGK^;A860EZ*-/+(2,U3?29IX):,*^=C=@T.2<64J
If VarType(Product_ID_data(Dim1, Dim2, 1)) = vbSingle Or VarType(Product_ID_data(Dim1, Dim2, 1)) = vbDouble Or IsNumeric(Product_ID_data(Dim1, Dim2, 1)) And (Product_ID_data(Dim1, Dim2, 0) <> "ASIN") Then
zFix = Product_ID_data(Dim1, Dim2, 1) '+5J:B</7EW->7B\+)>[]Y7(ZTDOR
zFix = Round(zFix, 3) '99]URHC?K.U^D2VCI180PP^4=BY7.RQM5TU3JZY-]1E1
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = zFix '
Else ':Z1SDB76VAM6F?S6U11?K))[,+-@NYKY9AYAX5EZMGF+X;;D/X*RI+*>-PYIG
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col).NumberFormat = "@" '
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = Product_ID_data(Dim1, Dim2, 1)
End If 'Q0I]JFC3@R0L-12*KH\[Q.(/:0\?;Q?A,3:,>Y?KF9]SV?Z?]6\U:O63KK+
Else '.PH73@VQ>5B*3(ZMJ]I1P8+R5)4EJ4\E.:(A<V^6^0P5IQW<(GKKIJ()2]^;T
the_col = 1 'UPWXQYY@9N4E0,G5+E,?E7F,LZU]0-CGOF[0H<>2=EG(1J1NS[(3AI
End If ':D[];<T0L.Q(1I@L8/=GFPNE6*V/F.Z3OP\PKSFWI(W;7ZI]))FE;80RRV<
Next Dim2 '5L9U3\(/<H*D/XQZB=PP)[UA1SH>Q+^WOA1=06M@HAU.C4:8(N4^^S^U
Call wait_some '^Z(E7]6N/H-B8X1I-,XN7>M8S2H,07-?QO21OGOHN.[P21;W[VU
If Product_ID_data(Dim1, 0, 0) <> const_err Then ']L?YG[L7=WYL3NQ4<
str_xml_from_api = build_do_api_call("GetCompetitivePricingForASIN", current_ASIN, 0, "") '
If str_xml_from_api <> const_err Then '929]A6X24WN4ZK,2)L0P7<]SWN[2
xRows = process_GetCompetitivePricing(str_xml_from_api) ']W<(FR[MHN
For DimComp1 = LBound(Comp_data) To LBound(Comp_data) + xRows - 1 '
the_col = output_col(Comp_data(DimComp1, 0), user_col_count) 'A9B9A
If the_col <> 9999 Then '^S:T6OI0):7NUSE90AS\5A77/?MF,B,V)I38A*TZG/
If VarType(Comp_data(DimComp1, 1)) = vbSingle Or VarType(Comp_data(DimComp1, 1)) = vbDouble Or IsNumeric(Comp_data(DimComp1, 1)) Then
zFix = Comp_data(DimComp1, 1) '(3<H\6V?]Y.C<,OD.LLPDJL<\DF4+9]J^>?C
zFix = Round(zFix, 3) 'S])+B,@SO@</CW)UPD:<\F?MAU:^OY\[R83^5+G18DMQ
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = zFix '
Else '>,=.^>A.E6HTG1/H/)2U@66FQ0:<E>-NS]E6U/IL^T:AY2]<WDLJ?0+Q9[ABJ
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col).NumberFormat = "@" '
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = Comp_data(DimComp1, 1) '
End If 'X-^J):EC+?WV6=H00=MQYVEXTJ).0I-(<A<(4H/EDAF=U..@KX:CNAM<A0V
Else '.DV\<//Y6=X?HZ]CPO23ONJ[MF+WBRUGH(Q-3KC.PL^98J63Q/?(Q6\W/E29I
the_col = 1 '@.C6PP@9./TWV16ZJ6]-@(@ZG/N<TUKR*(QV]/X^-3C\-V^G4T<Y.O
End If '/KB=*Y)*BJ^*,5,+?;MR^Q=1?YY)YF)PWJ*4*<6:DP[5:)36*SDXSZ1(A.1
Next DimComp1 '++B?G++.>.C8L4UMQ?[90O(G5.]?L/=(J;F8P<Q2VYYR82:S>I]@
Else '948U</E?]8<5R;0:AOZLWGBT.(YN6A,N\EJ]DT,+3/3MN*NRUB+\POP\\JBD,
the_col = user_col_count + 1 'GQH\<^38\JB2?+QZYYRC@MBABZY+=;;I6B\/*
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = const_err '
End If '0B0>5H]Q+W,R0:RNOYITM9K,]>Q](B5D@-VN6[QZ[,,\)>A\[:]QWS4E08T
Erase Comp_data '59MC4NRQ4SFEK==?/LH\?@FEFP[P/N4M.FAQJ)9I,X78JS4PP:
str_xml_from_api = build_do_api_call("GetLowestOfferListingsForASIN", current_ASIN, 0, "") '
If str_xml_from_api <> const_err Then 'K4^UTJ6P+-@L1;3.Z./X2Q^6@*3D
xRows = process_GetLowestOfferListingsForASIN(str_xml_from_api) 'UP
For DimComp1 = LBound(Low_Offer_data) To LBound(Low_Offer_data) + xRows - 1 '
the_col = output_col(Low_Offer_data(DimComp1, 0), user_col_count) '
If the_col <> 9999 Then 'I3GMQBU)N*;),Y\ZF5XC+6<EF4BFTS]NKJO*53,ZWW
If VarType(Low_Offer_data(DimComp1, 1)) = vbSingle Or VarType(Low_Offer_data(DimComp1, 1)) = vbDouble Or IsNumeric(Low_Offer_data(DimComp1, 1)) Then
zFix = Low_Offer_data(DimComp1, 1) ':)P24<X@LP^Q-J00CV=X50/(0XW:U*.
zFix = Round(zFix, 3) ']-X^B[A26O)\WFVRTPJWIA4Z0]I<4L*P<PF5\XJPD82T
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = zFix '
Else 'X..M32[=]AOE5RN,BSRVB3FE@@MY??34]HE\\<7PRJJHOEV9JN^8P>\<X6S(V
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col).NumberFormat = "@" '
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = Low_Offer_data(DimComp1, 1) '
End If '<>[@QRCZ0A.99(JDTBACMLVX2F8AY253,K-8479GW5]/N7?:YQ3PKT9N**L
Else ',CCBDMRD/[\;SPC/9M<JV>CECJI76?0)/YNMB]9IQ@>,69Q>A?M,22O4?S260
the_col = 1 ':P*N:9J2F^+VTLTCDTW.G6)=LA5IT\3K-)9>OQS91++2X9=5X[QFY?
End If 'Q1\\L965A/8NGQ[JFPAZ;FCBQ5,.*4\<]D.^^,Q7MB5]CSA0IL@K4V-=^L?
Next DimComp1 '9NJ,L(V203?,SJC2VPLCT;EZJ]MM-CE1K^X[3[9[BI1+:KCYE*BR
Else 'L;G96I[/<S-K,2I8U)+;MNDMT70W61-E^(KY0(GKE5W[?DDUE2PP:?9<EM6RW
the_col = user_col_count + 1 '^]SX1+QDZ)FC6FD)BJ?3A<<)6@)U[@*YKTS?[
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = const_err '
End If 'Z2;08W-SXXZW7(Y0*+U8(2IPO8UN5QNI0:3HX?B<,D>6EVGJ.;=8+^@D?(3
Erase Low_Offer_data 'HUN=B.4RL[\6=8=K@R>IW\O8.9E><.G,.R4D[8(?K+7,G
str_xml_from_api = build_do_api_call("GetMyFeesEstimate", current_ASIN, 0, "") '
If str_xml_from_api <> const_err Then 'N0*FH8=A@7*V9PM1\6-7W.(9K9(X
xRows = process_GetMyFeesEstimate(str_xml_from_api) '.F\0)V9H?ZGH1A
For DimComp1 = LBound(fees_data) To LBound(fees_data) + xRows - 1 '
the_col = output_col(fees_data(DimComp1, 0), user_col_count) 'N6*=R
If the_col <> 9999 Then '9G>VQGZ-S2-R@D@YV3Y23OY[ZYH7\[<GC7J/X+U6LI
If VarType(fees_data(DimComp1, 1)) = vbSingle Or VarType(fees_data(DimComp1, 1)) = vbDouble Or IsNumeric(fees_data(DimComp1, 1)) Then
zFix = fees_data(DimComp1, 1) '(W4+Q9,+7:DM]W>RGN5CXCU+K15KI?6G+FPW
zFix = Round(zFix, 3) '+E*>EPW^[>E2*5T4C;/>NMG-ZC.XL51*=L<7:+GJN],M
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = zFix '
Else 'S8N33J60P0D/WUM6V,F(R](EQGW37K\8*@B,T^F+M:(AA7E*A4],?:[LMZD1I
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col).NumberFormat = "@" '
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = fees_data(DimComp1, 1) '
End If '?QW(0.@D+7CXJY\YOA.0\/7<;W>57O16D=6^M-TDVK5.BP85DG3OVI51USH
Else 'OSTB]\[J7-C13YIJTDS1+7.AIICIN+4?=SZ(]2@APR<ZW6DRK-P6][)3]LW^+
the_col = 1 '->A63RB)II,2B3Y1G.Y:U9I>1VH+K@-VJM*9F/4?K]P/^KO<\^7.K?
End If ';Z5:;3TN>WNO@H-[M>7L).3(Z\B5:E?>)2G+,31?KP3O[J?KHKU;)\5<=S4
Next DimComp1 '<E/97F1-:9=7K)=^J-;U378Q<0T-\UXZIW-F-D^AT3M;D1S??=F^
Else 'NURU6CY:4=-;H:BUG?7:BI:RQ:N18ONY,N-*ZGC)JS0D6\REP,XZN/1XCR5]L
the_col = user_col_count + 1 'TI+[G^0/PA+H)[[B09Q:\1O-SAPP2M-SO1JB0
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = const_err '
End If '*3<UV+2?*N[A=GUF*);I<XK@[.7N]]1ZU.T^X7KUHXY.T1?J=?ZA]CAU.E.
Erase fees_data '),/P;.29K?+G?LU/<1BX??O>8G.X2>>ZLA)]\?^U:P]9VGI:7X
Else 'JX-KUBWS4(;CYUM<W<WCMJ<F.O(.8^.4T/[7:L4+=I1):DE]IG*U8,^MW5220
End If 'ZEWUQDP^628U>,(S:[L<4KM+.:QL2SIR3+.F2=JS<:E.A/.D(@I/1-C7K80
Else '-?[60A@]C6S]E4)2=A,X^TW;9YONWO^YD8\0@I^BATXDBOFG8AY*LA\X>L6D.
For Dim2 = LBound(Product_ID_data, 2) To UBound(Product_ID_data, 2) '
the_col = 1 'R0K(>XY3+@TTARC^B9>]Q0+OK<+\7G><)P[\,:-V=G+4S*WB=D]O0*
the_col = the_col + 1 '.KZ11)=2[EOW7FJBQK7-8V4LG>O*3?/HC,VR9V0120LN
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, user_col_count + the_col).NumberFormat = "@"
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, user_col_count + the_col) = Product_ID_data(Dim1, Dim2, 0)
the_col = the_col + 1 '<JZF)OP/B^:98OQE?5Q.2H*AR8V@TBM1:/7XWR]4S3.M
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, user_col_count + the_col).NumberFormat = "@"
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, user_col_count + the_col) = Product_ID_data(Dim1, Dim2, 2)
Next Dim2 '[\:J:NJA)2L,2*=9D0[8^P@.KM/RT,B<@.QIT.U?9V2+N/.,@O8)94G]
End If 'S1:W@MS[5A^SAJ8N?^TQV03,AR/1T+CH9G5TI17;.;Q5\O;FWR2<KYJZOLC
OutRow = OutRow + 1 ']>=*]>MH8P)T.4^X;>*/KJ52J?)J417GE)KXJ(16X<+Y89
Next Dim1 'IWDO3@XCCWYSX75=@PNR<\5RP.>J:(U6(B+Q*)P1WMPD^1\(59^M4M6)
Else 'GD(Q3@[\YQ*XM][NZFKB-E;KYAN??L+PLL27;U4W[@L[SUWBWSN)9=;*HSEAO
Workbooks(thisWB.Name).Worksheets(destWS.Name).Cells(OutRow, the_col) = const_err '
End If '\;[4^MYU\SRSD^R8NE/ASVOCHUS=WH1C\5EMY/ZEB1MYRCAIR;GE?4FWT8)
Erase Product_ID_data '+0@5EF^K=[19(CCD.<L(]^:FYU8LY/NJJ5OTKV9-SL<O
End If ']-4)()HPPE2U-Z\*,3F\?83DA3I08O7X2/*S0@SPXHD;[*F/)N0)OW/]<J)
If stop_processing = True Then '7*5.4154Q1H7MCHG-K7=3QSJB;.JV;(><=5
stop_processing = False 'I?=NW*F4=:6NAVWVDEB*XO<@R+?.@1*NK*4)<,V5O1
Application.ScreenUpdating = True 'QATU2Q:6.I1UC<:3[L*K46\\A9QU/K+;
Exit For '?+;.?>N4[H1+Z?I0IN\TW?E^M2X:Z]=D;]NVZ\Z(6H87@30R)P*\6Z)HM
End If 'OVJ-]DFRY+)4,2(C[URC9P,R2>BCC6WTA[94((3EAVAM@Q4.4>I8)=T>R3@
DoEvents '[@<;F9T,B=5/FPP;(6V1>NQ,-PLDCE@\,<C32L](A.*U62I]BU3[C:0YE
EndTime = Timer 'K[<\@<W:Z5FEU<UY::TOYR7/@+):M(;)V+T.DE3LR5[0G9?TA7
Next r 'SG1E-ZH3J\V@*B4RXMHY.FJ-Y86WT/=W(9T[Z=BJ)MXQ]1R8V:2FSGFFUI1
If rgFormatOutput = True Then ']4=^,GD?LI@RDJY/=3LG69@1XC1CI>=4EI(]
Workbooks(thisWB.Name).Worksheets(destWS.Name).ListObjects.Add(xlSrcRange, Range("A1", FindLastCell()), , xlYes).Name = "TempTab38574638"
Workbooks(thisWB.Name).Worksheets(destWS.Name).ListObjects("TempTab38574638").Unlist '
End If 'OE\3<TOD^L;8UV\<6T>-)^V4M02[B0048\9>[LE)K0EWVLX92T-ZUQ(6WL?
Application.Calculation = xlCalculationAutomatic 'SDET5FA2UT\58UYME
Application.ScreenUpdating = True 'YZ+)3YQ9?219XP1R=S>*Z<CF:JE9EKR]
Exit Sub 'L]N5:..TE+U8A<]W)7LSHTK8T+@CQUDB=;VZ-ELJK.DJ9;?95TDX1?Q+2
err_skip: '5].=8DBBNJCI+@H(-YMAN>@I;IQ7P@D:LFNE4TCO-.^:9EQ,)J)[Q\W5
Debug.Print Err & ": " & Error(Err) ')^@:<Q)2/PF<GL46;2;,N1LI\-(=<T
Application.Calculation = xlCalculationAutomatic '*(2>R-EU97TYR/SBI
Application.ScreenUpdating = True 'HKGG:.8*+MB-@6YIW?>:-L.9/XSC14KK
End Sub '=G.L0:*EW=CD/8Y5DKEG+LQ8[052>HJ4+F404:55PV*6ROMS1SSNXKM]EE
Sub main_EAN(control As IRibbonControl) 'LIYBH/ITHBQ.M@B94L@N;JT1BX
IdType = "EAN" '.89P@1A8+NY5Q2^DJVB[[?:K.7\J]@?G827[FL>6[X)PGY8-09T
ProgressBar.Show '^:96W4<3)^J)+JK=)VY/BRF/T(;AWYVTN)T*O^+1(>6@V33RH
End Sub '>Q=XY8[\V9J[\[.M<,M1GKQ\HVQCAU3.\L)UB>0O9C6A-?^)?H0O\B>B@)
Sub main_UPC(control As IRibbonControl) '7RT+A5I<O2^UO::NNSYA8D:AH/
IdType = "UPC" 'KH7XA8*3\JTV?9OCFWC(MT[.:.AI)W)I18:/A[.(;)XVQ:N?/(?
ProgressBar.Show '.P7=)G8)6S.@NFSN:Q76S3H?585]>K\)\-H6^.@2[2HZLLIZN
End Sub '+8T)NK0*XWIL62@[:B1/WUKEE=:@(K(C]K@,SSH2(IW?A^N4>C@<\+=VUV
Sub main_ASIN(control As IRibbonControl) 'F]L\>PGYU]HRE+]^0NY]2WOQ<
IdType = "ASIN" '7<,MITL>4ZUUDDVKUN3X53L^WW<Z+GGK371XF:\]:-K01OJ\Q5
ProgressBar.Show 'LN.UGIVB3)S8+Y2<:X-:N6O:6-);OEDIVF<B4UO;.R4*P,[2N
End Sub '8YN@^@EPR7MGTPQ63<ILD:>AHR3\PODUZ(<:?IANM,JP8=DQ>ZJL7N<@-[
Sub main_GCID(control As IRibbonControl) '4R\G-CU]*BM7SGP?U;-F+.JMO
IdType = "GCID" 'LQ=^*)JB<\78K1W1F-;*+?*30S9GTQS9;(ONWSN,)JA8.6*76Y
ProgressBar.Show '/=CBSA:*(9G0E=B3305+GJ:E/06?J@DIDRR<[G9.Q0S7TP/;G
End Sub '0:]^UEXWDOYCX3]TI3MV3DJOZSXXWY\MHFS-O1.SZ-)7,ZSFU0[U0-IA>(
Sub main_SKU(control As IRibbonControl) '2I=RM820B<Q>5N)Y]//MHNAWQ3
IdType = "SellerSKU" 'G94Q6M,JKVZ:3;^J(1.K\K2;AAW3A*N1;.:YGF)/.<?CB
ProgressBar.Show 'EXRS8(:B8+3[^(K/+*(XK/B;OI5YY\P]8/6ATUU4C.1S:?0<.
End Sub 'T@4RMV:Y2S:H77V:C?,P05L;EH>[FFNNFYV*?TS?X\-B*P/?9UDP>VT[MD
Sub main_ISBN(control As IRibbonControl) 'LZIV.E]:->1F:;E)@J1(*@5I/
IdType = "ISBN" 'OPD\PT7[48-TVX8K8]Z>=ORM75[;^^6W3D?94@Z78IE@-F[TD2
ProgressBar.Show 'T,LR+O^:\JHLTT1\-F5ZWK1V3A7+5J:F)L6X(-,6EM/*OXC5B
End Sub 'X^X,L6HH<FJ*HGXG;@,SB)M2]JV(QUY1GLSI5^^O-0E1LW=[L9^C/J,>(?
Sub main_JAN(control As IRibbonControl) ']>-W5JH6NE:Z<TWB<Z:Y][/5XB
IdType = "JAN" 'Y5?@-K@WH1,KA0E1<1DA.<S3=700RNBL)[3DF2Z)8>6;H+**D?N
ProgressBar.Show 'I6X000Y@G=-=>^^NMZ=:CBR297^Z-,82,/A[>O7,<U5AI7FUU
End Sub 'O5AQQ+?^]WY3K1=N@0@N5GZ>*UI5+?+=;HKE=2YZ-T-E(1*NMV4UC(,>FO
Sub main_TEXT(control As IRibbonControl) '3OH[@YDZB1VT<WT\*U5[DF[A>
IdType = "TEXT" '3(0PYXW[I,LF\L6*YZC>N+M=@[^\I29[\E9)N>G^ZM1,/VCR49
ProgressBar.Show 'MKL8(]Z+>ZW++66XSTOF)G3W^2(U4@OB/8HX/Z-=N1T2X1=^*
End Sub '4-@;\NDXA/GY2XR3QXV]T,D7(350BN.G://YAGGHM?R\^A(@3*RYTK19XK
Function build_do_api_call(what_action As String, my_asin As String, sellPrice As Double, sellPriceCurr As String, Optional FBA As Boolean = True) As String
Dim string_to_sign As String 'GQ??7=>\AL=]VA?SULP>HMVTH;.:,ZK?+>-F?
Dim arr_keys As Variant, t As Variant, arr_final() As String, strURL As String '
Dim u As Long, k As Long 'S?CVR^B)*YXMSUOF6B[J+3CU(]O)(:U<6(TOO>@?U
Dim xml_to_return As String '+RCN0-(+RAGFTZK7/SSS)][I/<WNAQVEQOM.*]
Dim arrRange1 As Range 'GS+J7\Y@/OW)0GR)3B/]F5T9F6ZVRBY10G+GIA)0NXR
Dim my_asin_tmp As String '\VV+/:?8M1UI=@*0E[*\V(+CSUW@+VBV>A)<F\X]
On Error GoTo err_skip '51H3B2H77[7K^G5AN6^\8HXX(1/;.E4TW8=8JBE^C73
my_asin_tmp = my_asin '2\MYT89.V:.>6?Y]^4[[70Y^E?7D/.YWRGSOR)5*YF1(
Set dict_1 = CreateObject("Scripting.Dictionary") 'OS[XILY>)KB7QOVW
dict_1.Add "SellerId", rgSellerId1 '-Z-;2.=,@4MJQM@/^X;3P3(E+?^^S2-
dict_1.Add "AWSAccessKeyId", get_aws(rgMarketPlaceId1) 'P3H]?OE\8(7
dict_1.Add "MWSAuthToken", rgAuthToken1 '^K*37=5GH?>>7)VOW]6,4YP-+)
sk = get_was(rgMarketPlaceId1) '4[B@H9/8W56@.J[5JL;F+>3)XI*AYR1I7BF
Marketplace_ID = rgMarketPlaceId1 '^-A^CZ8ZQ6/^]I?EA+GSS^900U3E,/<0
dict_1.Add "Action", what_action '6U;AP-O.Q7L1:N2;QP;9MUVX2\PE:7M6V
dict_1.Add "SignatureVersion", "2" '[)AQ-F-=JQ9F*32DMYF8YT;OBM(]45:
dict_1.Add "Timestamp", UTC_time 'LEA>/46N?+YFPND==C*7PQO3;^)HFJM+^
dict_1.Add "SignatureMethod", "HmacSHA256" 'R@W(=]@^@.@--?ZMK,5/3VX
Select Case Marketplace_ID '(*?PMJ*^P2@V>UXNA)BJS[8O3[VNF7UW(7(2N=@
Case "A1F83G8C2ARO7P" 'TVQY):(4(O,DSMCE,YU[.D.RL]MC@]],JQS=PKRSLP-.
api_end_point = "mws-eu.amazonservices.com" ';7O0:;PK<TZT1XG=^+<7L2
api_full_end_point = "https://mws-eu.amazonservices.com/Products/2011-10-01?" '
Case "ATVPDKIKX0DER" 'T)1DKA76DQ]U,DK/>(XC<7VB*KZ(C<HJYKK0KR@?]JOAL
api_end_point = "mws.amazonservices.com" 'X]@O^>0T<AJV2E0611MHSU@:E
api_full_end_point = "https://mws.amazonservices.com/Products/2011-10-01?" '
Case "A2EUQ1WTGCTBG2" 'SX)7N;:;M.3IK7VMQ/W(S56]LGG791:HRSTC@]YCP9>H
api_end_point = "mws.amazonservices.ca" 'A?0E@FW>^G^O5ANO)]Q(/-6)OM
api_full_end_point = "https://mws.amazonservices.ca/Products/2011-10-01?" '
Case "ATVPDKIKX0DER" 'U,,\.*[::AKHM:A)(OKZ:).EKX;BX)F:6@]<MZFNGO[J[
api_end_point = "mws.amazonservices.com" 'EJWLZF,0/)I,/(((4;=\AN9A4
api_full_end_point = "https://mws.amazonservices.com/Products/2011-10-01?" '
Case "A1PA6795UKMFR9" '>/4,9PO\]2>-1ZC2]ER5:*P.V?*(Y::@^.)=60JL<71F
api_end_point = "mws-eu.amazonservices.com" 'U9*M^@-GD@@FL\>F5S?*9*
api_full_end_point = "https://mws-eu.amazonservices.com/Products/2011-10-01?" '
Case "A1RKKUPIHCS9HS" 'TC7RDFSDTA,(EZ*<YKIK>B:((S1:M.K]\(+N)43*Z/,R
api_end_point = "mws-eu.amazonservices.com" '6WKI]BW(XOD+UW<XAQ@L<F
api_full_end_point = "https://mws-eu.amazonservices.com/Products/2011-10-01?" '
Case "A13V1IB3VIYZZH" 'SKH+V<[L>X.;)93.NA?Q5R]YRJ9?KSK2A8CS?;STYK(.
api_end_point = "mws-eu.amazonservices.com" 'N;L9;2+S3.)RVO)OAK*><=
api_full_end_point = "https://mws-eu.amazonservices.com/Products/2011-10-01?" '
Case "A21TJRUUN4KGV" '4QN?*?CUM40YH<<FW1CYZS8IM45>K=Q)FN]0+NGWU+X.O
api_end_point = "mws.amazonservices.in" '+,YG3H(OI)XPS+;SE8A32SWN^Z
api_full_end_point = "https://mws.amazonservices.in/Products/2011-10-01?" '
Case "APJ6JRA9NG5V4" '>4X*UKS\<:*C+D^@0Q)>98?=0R=DS(A-Z7(U]E*<I5@);
api_end_point = "mws-eu.amazonservices.com" ',[0+X8,D+7TJ,9D1PZ<^@F
api_full_end_point = "https://mws-eu.amazonservices.com/Products/2011-10-01?" '
Case "A1VC38T7YXB528" '3S1F*^H=@<\,=S4Y,?@4E,PV<LZN[(/KGSSP7[UDB].O
api_end_point = "mws.amazonservices.jp" 'NA*/\0UEX7]S:H86O1I<A,U5M4
api_full_end_point = "https://mws.amazonservices.jp/Products/2011-10-01?" '
Case "AAHKV2X7AFYLW" 'S86++A):Z4\)CQ\J45K3KO=W;W92:;S1?4)5-H\MDI=(N
api_end_point = "mws.amazonservices.com.cn" '][W:-DIY8>G8B.--0*P4\;
api_full_end_point = "mws.amazonservices.com.cn/Products/2011-10-01?" '
Case Else 'ZIT.>+(.\*?*R+9TB40C-GN<1H7+-,5)U6T4P+^0SO\ZXE?TC.HYLD(.
api_end_point = "mws.amazonservices.com" ',<XL3V6??X63UFV(+5T3C1K.M
api_full_end_point = "https://mws.amazonservices.com/Products/2011-10-01?" '
End Select '[AN.;?72\<@ZA1@+Q0^/TG4/R*-\:BOOA+5C4MX9[A-5FF2(:8*FNA-
If what_action = "GetMatchingProductForId" Then 'U][+-?(R=<V?3[@+0T
If IdType = "UPC" And Len(my_asin_tmp) = 11 Then ';OS^8,60>2U(>N,-T
my_asin_tmp = "0" & my_asin_tmp 'W@N<Q<@UDU^G6V=;;MV9SFTV*A=FY9UBN>
ElseIf IdType = "EAN" And Len(my_asin_tmp) = 11 Then 'XK<7OH>RLTZ-<
my_asin_tmp = "0" & my_asin 'LILFJ>BJ,90K,6N1<-:(Q@,RSO?BID>K01V8AH
IdType = "UPC" '[?MLK?L.BG>I*)\<P6D-D7M=K.S>QLTM3J-=LXQGZU\]]:RO9K)
ElseIf IdType = "UPC" And Len(my_asin_tmp) = 13 Then '1Q/7(JO7+?LL@
IdType = "EAN" '1C3]2B=45Z@4)K>1UD4I1P[LO61R2LUGT+)\WB:HB73AR]KS.54
End If '6[WBXK;?(IRDZB?Z^V(G-C5;B=T;N:>@[=5/A4IJCWR1-I.IE6H5PE6X-W7
dict_1.Add "Version", "2011-10-01" 'J8J/S16K3?3][5ZH6.)90?@5];OKB(C
dict_1.Add "IdType", IdType '8J5F8E+QZ3QR^W7ZH4+8AR/1\;GF(W5/G8QB1]
dict_1.Add "IdList.Id.1", my_asin_tmp 'R<VBN+JXA1>B(J\9>*);M2V9WUR>
dict_1.Add "MarketplaceId", Marketplace_ID '^2;S0N^HVGZHS-@XG0:4H+[
api_uri = "/Products/2011-10-01" '[U4P7S>+WL9*(/=LXH]2N27:<(EL9LD3B
ElseIf what_action = "GetLowestOfferListingsForASIN" Then '^XQF-]CC
dict_1.Add "Version", "2011-10-01" 'A,:?\M?J.,UVC04*\X]60VMO;W0+;^C
dict_1.Add "ASINList.ASIN.1", my_asin 'I0Q@;=XT5*5^2WZOWE459<@L,8.A
dict_1.Add "MarketplaceId", Marketplace_ID '1SFVW.O3F(8[-8U:8[I4-6I
api_uri = "/Products/2011-10-01" 'NJIG=@QH0(QOOM[Z+,K8K@D^X(12(O-D^
ElseIf what_action = "GetCompetitivePricingForASIN" Then '[Q:?PDLO9
dict_1.Add "Version", "2011-10-01" '153Z=UZG;C>Y73,NL^1;-LG76P^<1M;
dict_1.Add "ASINList.ASIN.1", my_asin '+T\H[YY;^R8;PH^*GK?5X;MK8=]R
dict_1.Add "MarketplaceId", Marketplace_ID 'OJ[9Y[KG6N0Y)?(A2HW.T5H
api_uri = "/Products/2011-10-01" 'RJ7R<)N]I+J;7X\61L?DG/6G)2)O=YUT(
ElseIf what_action = "ListMatchingProducts" Then '6W>O.B9]OPF<:MIY,
dict_1.Add "Version", "2011-10-01" '()K]U?-XMD2QT-T*Q-B3X))Y.K?3^]]
dict_1.Add "Query", my_asin 'D277>Z--AAHH;Y8MN:OC9D@QAHT*J6HJ9)(>4X
dict_1.Add "MarketplaceId", Marketplace_ID 'YNYAI,H/><X-:8/?6//4XBH
api_uri = "/Products/2011-10-01" 'IK1>/WBYN9Q:Z<RXIFT>DK6/5)TM55H3=
ElseIf what_action = "ListMarketplaceParticipations" Then 'NWFOAO[]
dict_1.Add "Version", "2011-07-01" '+AAQ/J]<)\6-C^0J?U\AA<G2UT[5;>V
api_uri = "/Sellers/2011-07-01" '.Q\D)X</TY>(D+;*]/+GWA@ES@?-W/X=8/
Select Case Marketplace_ID 'O[@03ONYRYMCD7Y,=.87R80\?F[-J1P/EML4X*L
Case "A2EUQ1WTGCTBG2" '3R9P5F?+:1/H3E@PVO]3>5[\?M>;+DUKY0PLO7YTMA@3
api_full_end_point = "https://mws.amazonservices.ca/Sellers/2011-07-01?" '
Case "ATVPDKIKX0DER" 'V?@G7V<F;XO=F=^9O4QC]:16Y3VH+CY\LX85D7?/50[EN
api_full_end_point = "https://mws.amazonservices.com/Sellers/2011-07-01?" '
Case "ATVPDKIKX0DER" '/*19QHKZ88Q2Y;4(Y8S:.5@2;72K45X2,H<69N\2Y3Y.-
api_full_end_point = "https://mws.amazonservices.com/Sellers/2011-07-01?" '
Case "A1PA6795UKMFR9" 'FU^MFS@NL5*1J?A1)2D;R>S^TSE:1OX27F,P?(8IDX>3
api_full_end_point = "https://mws-eu.amazonservices.com/Sellers/2011-07-01?" '
Case "A1RKKUPIHCS9HS" 'U,6-TQDLA)7Y<N>;OP:R-Z(>EU\MK+SW8JO:7OGR<HSQ
api_full_end_point = "https://mws-eu.amazonservices.com/Sellers/2011-07-01?" '
Case "A13V1IB3VIYZZH" 'UER.@*?]N*<B;T0,WCJ:?.*@3PF.X[OL:BC7T:<L*ULS
api_full_end_point = "https://mws-eu.amazonservices.com/Sellers/2011-07-01?" '
Case "A21TJRUUN4KGV" 'AUL8/VPX6*BR8)N(6=*UA,:/6T\-1YE-04]T5FFJ9^B84
api_full_end_point = "https://mws.amazonservices.in/Sellers/2011-07-01?" '
Case "APJ6JRA9NG5V4" 'H:ZDLCBT(^SW*H274\HWC;()YO>EA+J@9]L80C3HT2=A1
api_full_end_point = "https://mws-eu.amazonservices.com/Sellers/2011-07-01?" '
Case "A1F83G8C2ARO7P" 'P4D-Y(KKT^VS=>8GYKIO?=I;[X8\8G3FOXV3<:AL9V.:
api_full_end_point = "https://mws-eu.amazonservices.com/Sellers/2011-07-01?" '
Case "A1VC38T7YXB528" 'Q@6YM<IPSE*\TO(U4F>-0TQZ?)7+*7G=R66C,N.P5T3=
api_full_end_point = "https://mws.amazonservices.jp/Sellers/2011-07-01?" '
Case "AAHKV2X7AFYLW" 'R8Y)G+8[R^9U?.R*1^5Q*KF2V/N6A+U5IGLUT>*:I:O9[
api_full_end_point = "mws.amazonservices.com.cn/Sellers/2011-07-01?" '
Case Else ';5<)NT6YJB]V^0[6)>C^V/[]2DV97.JE03?,^F-.X1LCREP-MZC6-/MI
api_full_end_point = "https://mws.amazonservices.com/Sellers/2011-07-01?" '
End Select ';J/9FM2K9<A)V-H.=5,[5YK]8EKKG.Y)/COT6]/BS(>STAT?BVM*6XI
ElseIf what_action = "GetMyFeesEstimate" Then '(LRUA>C,RE,HH4Y[HBGK
dict_1.Add "Version", "2011-10-01" ')V1ZLXEGJ>T:SQKF4=-:L)IQ\Y.1]0J
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.MarketplaceId", Marketplace_ID '
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.IdType", "ASIN" '
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.IdValue", my_asin '
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.IsAmazonFulfilled", LCase(FBA) '
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.Identifier", "request1" '
If sellPrice < 0.0001 Or sellPrice > 99999999 Then 'T]9\=RGGOBI-?O]
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.Amount", "100"
Else 'O;,\;H6*>JN5DA+WT@UUFH>,\1P629VDW1YP@.:U/6=B*5O];3?:)-3RH2X32
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.Amount", sellPrice
End If 'FQ<+UO?83H]ADEQ?[E6QJM?R?(?XY@\2GXB7CS^9\US>FUO,=^D4L8?-<:0
If sellPriceCurr = "" Then ';U@\]2[(CZ.HI76M[K98+L@OKGX+\](^CHLR*AR
Select Case Marketplace_ID 'O9/FJK?3<F>;VF<N:TQD6-VA(:WA/^2ZL\Y3TMC
Case "A2EUQ1WTGCTBG2" 'CO.@O458M^.9^9O,0N5J@9-70A0\V?8G-K1R8W2VYXV[
sellPriceCurr = "CAD" '+5++JBR^*\;A210-CR^[30CJN7KY-P?36-^TVBSVM<1W
Case "ATVPDKIKX0DER" '-9^?A5D9N1,Q6)-8/48F\1EUAXVQ8VV=V23@B)GV+3H@F
sellPriceCurr = "USD" 'QF)B.17EQ/\*U;;[1DA)XP+UZ=^J.:RJ:6@F^8I=L^S>
Case "ATVPDKIKX0DER" '^8BY1A37D1++@S5KH[3OJ3DM5,(0>2-RZOH=0.<6*-OP?
sellPriceCurr = "MXN" 'JBV34J^<1F*T3N-?;D-<(?,G/)FIWE.Q1G;9]^]3:.3R
Case "A1PA6795UKMFR9" '[X,E@B\)PCA)AC4M[,RC=,V4D*2U2Z6XB\D.^*O86*J5
sellPriceCurr = "EUR" 'WU2H;YIIL*8D86BM(YB17*:[/5O,,B)?A9U<Z>@[/4Z0
Case "A1RKKUPIHCS9HS" '?O,EY5X,I=X*+313TH=M4]H;F3@<.YC*WQ]U.8ERLXC^
sellPriceCurr = "EUR" '=DXQK1ZWX)Z=])<ZZN(;Y-Z?C,]H4HC(9H*^MTMC5,5^
Case "A13V1IB3VIYZZH" '?DQG*H]^ZXIPZ98^><X9A:RE?SHTL4-\D.8^M(V+I^L>
sellPriceCurr = "EUR" '>>TF*(JC1\-?G>)(,?HN-<)W<ID+[C7OBH^TT,?+HA=2
Case "A21TJRUUN4KGV" 'V)A5RZ^6,2\6ON<@,/LY]Y9@(\XS05.ZE0DMH3\R93LUY
sellPriceCurr = "INR" '@G+ZH6[R[W?F^M6A7[74MVA7(T,-R*0\;30K7D)TV)60
Case "APJ6JRA9NG5V4" '?W+D];@,?[/[8.BIB6.N=56487.(*[R?XC08II5.)[OEC
sellPriceCurr = "EUR" 'F]D,RP/S2+NL,.G5,.YFC/7@)2==GK,>>KK5K,7UOHX)
Case "A1F83G8C2ARO7P" 'I>G/2^,-/\2,C+::[HL(24P[,IJGLO+0CU-/?ER)<-.1
sellPriceCurr = "GBP" 'J^8R^K5=-V=*,2MC,=T2*F64(RGG9]UF?Z@@KL2H?(>@
Case "A1VC38T7YXB528" '7<8HE=0ANO\(C6RE9YR*=*CE.D<;RG>Z;58NR[M?14ID
sellPriceCurr = "JPY" 'P\\HQ4=VCN-H(72^^(@8.RV/RH98XQON)A3E[QJR(=:V
Case "AAHKV2X7AFYLW" 'MC]/H=TD4BKR53;4:T7MN]9/OS9](WH)CKQ6\0U>LWF+=
sellPriceCurr = "CNY" ')OZ\H;/*5Q-[?ZTB.1<-H^=T;2DC;76>=/.[WUUIPX(<
Case Else '*\MK^6J=56JJ+B0RND@YF@=1N>GKCGI7L3O3:-G5J4;K:H-0T=654?DH
sellPriceCurr = "USD" '](;?F-T^6^<]DOWN^K9X)))B<ZXJ.9Z][G4/D]ZC2OG6
End Select 'TX@,03I?X]VDEEQ+4N[[P,15]/)YD,G7I<=13-W\@^O,3=NU,IN1BDY
End If 'CM<G6VVDL4269T^>CHW=(*\-1XIT70;7+=*2I4>P;-LEB9CTA5:NYYM\HNX
dict_1.Add "FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.CurrencyCode", sellPriceCurr
api_uri = "/Products/2011-10-01" 'Y<[)66L[H8G7IE=B6*M>6S=VNLF-TY@+7
End If 'MR@F^W@)EMUG)][BQHS,S8MO/N5VCKHA\KRN/JCRC)*,[^GGHZ>@Z3Z*+8:
arr_keys = dict_1.keys() '8=^<I[8U8S(*WNPOE^:WB/.-6K>):-7]+AIYVP7L>
Call BubbleSort(arr_keys) '3Y6FB?WCK5TRV[0M=J8M;/OYE3[8D.WL,G86YMK<
u = -1 'LN6D/KNKN9V[W)<QEX?Z8YKV..;U]5)V/=[9<*17G:UVEL>Q/7I6EA2>UO4
For Each t In arr_keys '8I7P@PAN1TNW6-BVI?K0F;V[<J,1(ZPX2QFSEL1.4PM
u = u + 1 'V=3K(JGG@WA?M/*OX@KFN>MS49OQ92Y++9KGE)?XX@(RDZT-L7BX/PZH
ReDim Preserve arr_final(u) 'IBVE0AD+/Y/C/67QN[CIQ/^18]2H6T[\HPJHPE
arr_final(u) = t & "=" & URLEncode(dict_1.Item(t)) '/A[1L[H1)+UW^<J
Next t '8U><XZ)6:@(OUAK+9OZ=5B=(F<?Y)NEMPR]FTPNNC?DW?J<2(B/3=6:794@
string_to_sign = api_method & vbLf & api_end_point & vbLf & api_uri & vbLf & Join(arr_final, "&") '
Signature = "Signature=" & URLEncode(hmacsha256_base64(string_to_sign, sk)) '
strURL = api_full_end_point & (Join(arr_final, "&")) & "&" & Signature '
Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP.6.0") 'QDQ\8<+LC)C
objHTTP.setOption 2, 13056 '1J5)OTHM[WB+]@U[XCKV4:Q\()SSUYFJ1?>X290
objHTTP.Open api_method, strURL, False 'N*WWN-S]Z(G9^O[.8X?Z:XDL4*O
objHTTP.send 'TX[I*HU-7\QH8O5+@Z*Q7X\XDHTG,9M*F;C0U.Q\[DEQ5FS:V(T81
If objHTTP.Status = 200 Then 'JC68T8])>CIHC2\C.FHWC1M[CS/T:/YEB(B7[
xml_to_return = objHTTP.responseText '386[OK[^BOXXO>N^045L@J=;,TY[6
If debug_me = True Then 'S(N4ULJ(])A]X.]=)H]:G,>HAQFVX2F4U<3Y+,]-5C
Dim objFSO As Object '5TJ)\QUG1O7>5(/^:?(2?=NF?=WSRE5F^BXDPGQE]8I4>
Dim a_file As Object '[15V*,^@YPI,UMSLY9OS/*;E-V2GGW*CK@5;Z6)E-V0SM
Set objFSO = CreateObject("Scripting.FileSystemObject") '@O68,2Y=[@
Set a_file = objFSO.OpenTextFile(local_path & what_action & " " & my_asin & ".xml", 2, True) '
a_file.Write xml_to_return ')IXVUO320VN=TAC92*N-(>AC]0DI]A[K;-Z1DN2
a_file.Close '.@-X<DHD5PM7+2X10X+1V(=7AHMLT4V.U7NT=.[.DNA^S@U8X8*FH
Set a_file = Nothing 'O0;KR<S6;GHZB]1.9CR]^^^E[EG83/H];JM>3OJ)2E53N
End If 'KX1]AD4/6HZN)1RG=A)J]I,4-Q9UJ=**-[TQ/F[I.64P]3*KA7CD?[*EF64
Else '95TETA8VMO,,GAYLVX8Z+EDWO<Y5.OCTKQUR1/^JUW(/VB=HX=\=<EXN88.H.
If debug_me = True Then 'J;SI]S2:+SI/TB0[=)YTNIV+VO/L^K?WB5M++^-*I2
Set objFSO = CreateObject("Scripting.FileSystemObject") 'R^*49]=FD2
Set a_file = objFSO.OpenTextFile(local_path & what_action & " " & my_asin & ".xml", 2, True) '
xml_to_return = objHTTP.responseText 'K)(TH@6SJI2\IA9O+-L1H79+K*:3M
a_file.Write xml_to_return 'CJ;7YMI@U(JP8TVER+;?)O>C>*5T7722NF^5?\;
a_file.Close '32/Y0?CSX;G5LS2XB9X0V(UKR8YM-920\2DHFV?D2\4\E-A<.6GI-
Set a_file = Nothing '*QE=?[6LHUQ[RC=<JT.CCB9C,;*>0XE]NZU:4LO9=+-QQ
End If 'D(^TI+)>]UFJ.22M48XV7N57KV7+WQ3HG^K-WX\EQZ[G]DL)[[M:+C;C7(E
xml_to_return = const_err '0[5BM*(3P@>DFZ;O-4[HOR9U9DS@@78U\.\HM*(,
End If '@AT[U:=Z^N*^YZO1\2ZRVK9EYPI4<YG;8?:4:I-1)1U.4U;5U5S1L/^*TOC
Set objHTTP = Nothing 'M(N--@IWF.NE*<]U^847=0QM;[F\P=G,0)7>.GE/FIM0
Set dict_1 = Nothing 'LXN]?[K^]O>SND7@.=G1<A/?^N;1YY3@NUP71LIN+S+,+
build_do_api_call = xml_to_return 'J150?6R70,L*[RI:YI1GJ<<P](JP,MTY
Exit Function '0W2]L4K55I>@>]Z;P3WZ,6G3.QN>+B)1RDL4Z;@0H=FA\G>(<?R@
err_skip: 'A^]GIL(HE74^78E3AEVF]S^C*XZ>HS]3E.KETT<-/.R0BS[@AB031DPF
xml_to_return = const_err '8<SOV>X-^;.>70(1YR\8^>HW+)C5YX*<@NE<0KK<
build_do_api_call = xml_to_return 'G)=8.LYP+8TW8VJ24LLY)O9Q5)U1@>,D
If Err.Number = -2147012867 Then '\5Q)Z@^[HMYQT/;+^@-+KYT[3]LF/+[:6
MsgBox "A connection to the internet could not be established." & vbNewLine & vbNewLine & "This mostly occurs when your internet connection is missing or when your router/firewall/VPN is blocking Excel from communicating on the internet.", vbCritical
Exit Function 'D.189DWW[]PP1Z0+J>=;[7JAA8(1)R5M,66FZF/Y<+7LF2(=(4+(
Else '@WVU-Z]ZPFL4TAN*V193FKA?3+;I9\3LDD7=M1/P:=,28U,DFGKP>Q07W>;A8
MsgBox Err & ": " & Error(Err) '5[T7O14S)]V-(K;8=QEA.6.K]N)?9RTB5^:
Exit Function '/J40>^UA;UIC9W]=+LM,RBJ6?3OD;J.M,]KD>NHHO@F=G;MQEF/C
End If 'F29(.^PF;WB=TVUU<RCO:8W]M,9DG1[3.U8:>=O)NCF4-F\M0?H8[<\O<9M
End Function '+[)B2<EYC]9YFZF?H5EUIQCQP[B8P7L=XRK?+J72(;H[]*\UFSGHL
Function process_GetCompetitivePricing(str_xml As String) As Long '
Dim root_node As Object '9MNTHW@VY]68/M,-.UG1IAFQB9]X0;Y1:SVV^-?\AA
Dim a_node As Object '/2935KW2KM4WJ)IJS<9L>D-TT(RH6K3EYE<U*8O+NCZ<9
Dim b_node As Object '*AS->1DBRRW3FVM)EV+]MOT^4G,U]R?2Z.\+,@RBE:N6Q
Dim c_node As Object 'Z3)3R[7C]7FR(YXI?/\:E0+Q58^-3M725ZV[[8J)F,NW1
Dim d_node As Object 'EJM++D]B+[OIX3Z3L4\\,:\95=9V(5HR9;CM\I:FDIA*I
Dim node_list_1 As Object '5P4;Z7-</.DNK2HRTX9>K9==@)51;V?[<+0VGS/H
Dim aRows1 As Long 'HXN\Z\F7BY(<2-K].=TJ[V,1CW+:VD=V3,\BB\DIWI;ZP)=
Dim sum_1 As Long '[>BDH)2[YAT;\L?2SD-NVQBEH]G8B(LJ\CM8\NNPEGINN-76
Dim id As String 'V?RR9),X11U;^:NY/SZJX)0DW;>0XWHSMBXJ8AM7AZLE9S-?9
Dim offerText As String '1G79T+Y@U,R9,^=O88P+7C[;/*15ZJ]C>KJH5,WI2;
Dim temp_single As Single '^56SN^Q>R4]8[HHGV[FXIP,RMA7:Y@O*SVD(4Z>4
Set xmldoc = CreateObject("MSXML2.DOMDocument.6.0") '8U4C(>G<WMCL]K
xmldoc.setProperty "SelectionNamespaces", "xmlns:ns='http://mws.amazonservices.com/schema/Products/2011-10-01'"
xmldoc.async = False ':J-UMOR7-9F;Z,YQPPW9]IU\I6<,5D:19K8EIP3B.E2FY
xmldoc.validateOnParse = False 'YEBF:)^>]P2*EWE](R+ZX955HC,R2?>S<:B
If xmldoc.LoadXML(str_xml) Then '.>4K)>:8;PJS*<S;B*13]D*(O0Y?PH:*8W
xmldoc.setProperty "SelectionLanguage", "XPath" 'K3D,MZ;(S1+LK8QG9@
Set root_node = xmldoc.documentElement 'H)VO^KQZW^/OU2?><[=4/7MPLNH
Set a_node = root_node.SelectSingleNode("ns:GetCompetitivePricingForASINResult") '
If a_node.getAttribute("status") = "Success" Then '?,\IQ,1?,^0PM]+H
ReDim Comp_data(0 To 50, 0 To 1) As Variant 'EI]4\)]VC@OS=TT7T/?XWG
aRows1 = 0 'JO01TS>5;0AY2B=O34SNY>U2Y9HO+SK@FFVE>XB(/ADNTF7G+=02SQQ
sum_1 = 0 'R;H6SDO@YB3.RC:4,],S;EG-7?+6-5[\<O)?TX5VJD;NWQ,H2Y?;TP60
Set b_node = a_node.SelectSingleNode("ns:Product/ns:CompetitivePricing/ns:CompetitivePrices") '
If Not b_node Is Nothing Then 'RN/N/9B<3,I^J8L[P=AE/QX(RZ=P,ZZQ>]YI
If b_node.HasChildNodes Then '\E+VX:/BM-S)O08SZ>4,/T/6(]@1^2HGDJ=+K
sum_1 = b_node.ChildNodes.Length '>C=1HA1(S(3)H7OY-OVASL.@J.269NM7]
End If '@*XNK:H0X-,AS(QDKTK:+-3C07HPHRZL9<(Z2-3D((G<VC40DQ*;9;@K-;O
End If '5QX\.=B]X\GHDP90I92.:G@>D4.T6;\XD<UX.-4([63(;]<W^Q5VHKTP7E=
If sum_1 > 0 Then 'C:-<F(W.EO^-PY;E.^L,4J,/?*\<;M*?H-N]J.D)+33<..G;
Set node_list_1 = b_node.SelectNodes("ns:CompetitivePrice") 'O8(C;.
For Each c_node In node_list_1 '(Q;2;DZ/P[5R64Z9-C]T]1?1XN7E4DGW^2R
If c_node.SelectSingleNode("ns:CompetitivePriceId").Text = "1" Then '
id = "- New BuyBox" 'F[^\H5]AZXA)<=JO^NB)L2OB))KOIOBF1([F?VWJWU<,YN
Else '2;F<7>L>?FTH3:6Z:]FN:0MMG0R7;:Z,AL3KUN*B@MT:MZIMH@=FQ[3@/R[O9
id = "- Used BuyBox" 'ST?U4W<R4M[B74<0I?7+2+N2XZB(/9^FJUYR7.@.I7O92
End If ';*B,5P@6G7AE4:K3LNH>4U.AA9=NX[3CZLJF/2Q9L@VVXDIS@VVL=G1:L23
If Not c_node Is Nothing Then 'LP5X6326JQ[.,JV/*]C>V(6H)@1BS+YSJJ4+
Comp_data(aRows1, 0) = "Belongs To Requester " & id 'D:)APL<MM=Q1JE
Comp_data(aRows1, 1) = c_node.getAttribute("belongsToRequester") 'J
aRows1 = aRows1 + 1 '/[THDD/L:5K:^CD+];TU.WO(/@:==FCIZRXJHVBGT71W/[
End If 'E-LQW6*1^[+5Q]7]L.>)<R?=;SPEXL\D3[GL+R.29XA7YP==-SAM\8*WZ-L
If Not c_node Is Nothing Then '?/5I-V5GOU]?.Y3T(49:0Z3-TA<A?Q2*M3F+
Comp_data(aRows1, 0) = "Condition " & id ',N3Q>7\5]R5;\1>1Y:-PDQ5<L
Comp_data(aRows1, 1) = c_node.getAttribute("condition") 'AI;41VKA=L
aRows1 = aRows1 + 1 'Z1>TQ.:(C,,-DDJ5,0)4I5[86[.2I-<CM/P568TL<+=<*Z
End If '7KMI<A50=L-CU.L7>^DDD;DB^,-J(^ZZ63G6CWR>0\JT:@3()PA-D61B/::
If Not c_node Is Nothing Then '<P.)TWNDUI:6W^(0QR=Y][SE*0+-7U/TN2>1
Comp_data(aRows1, 0) = "Subcondition " & id '[1//NO2/7;:QJ,29MTGSR>
Comp_data(aRows1, 1) = c_node.getAttribute("subcondition") '[=-\\[(
aRows1 = aRows1 + 1 '\<MOQ@9G34R^PG<LFSXT=U<T9D05Z0-+M</*J2*A1;>-:X
End If 'GRP.5BIO)MJ^H.2[^BPMXEEJ49+R^M6@8+A.QB/I^T3@F7E@Y9BQS?^VVHR
Set d_node = c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount") '
If Not d_node Is Nothing Then '<YA;/Y^?,QEQCDB>5;YFZ:19/?^^.PC;E-U>
Comp_data(aRows1, 0) = "Landed Price " & id '^A5P>[W]Q(F;>WX+>K<9M[
temp_single = 0 '5CHO:WNZ8E<-@7UV-]+E.U]RRZT*P^^EA?Z8UE4OV+7(TZU6G6
temp_single = d_node.Text 'XO(N,)L1F3EGQQOR+9U:XCH<]WWN]5Q0:13<7PFG
Comp_data(aRows1, 1) = temp_single 'C9Q[;[GOGUHXNWBB;Q@](O-EZALKB=7
aRows1 = aRows1 + 1 '.BS=]08C[S4EM:C46O2\^.DGCI/P6ZJ4/F7S40+^1\^@=R
End If 'OYY+9V.NW)5A=4IO[-UX0?(]1Q3/H^0GYH.K\N4<ZMVZ5^9J+*X)PGZ<N-;
Set d_node = c_node.SelectSingleNode("ns:Price/ns:ListingPrice/ns:Amount") '
If Not d_node Is Nothing Then 'P>?/\3^XO/TXECDJ]=?A)LCSM3I9MEZYP=J3
Comp_data(aRows1, 0) = "Listing Price " & id '.5*R,WY;-PM(@0=8JG>F.
temp_single = 0 'Q<^X=^TO6=M*L<I]*^K;L-HW7(V<1?H?>N.2<3C@F0F[A@U^*Y
temp_single = d_node.Text '?VEU9?3QXZB^>]O=)PPIPV\EHLL38HVW\]Z7+X[;
Comp_data(aRows1, 1) = temp_single '3Y9[2.B7\SV>6\99R\\M^GC1C?/[;HM
aRows1 = aRows1 + 1 '?*JE)7,\J,(<0GL6/X5=>=*0S;\69H-E@AX2O5-.CF@D0/
End If '-C(HVTM*B3R,GIX.MTZ<^YY]\)N4=897P(2XE,VC3STI-MP:NSS24/:699O
Set d_node = c_node.SelectSingleNode("ns:Price/ns:Shipping/ns:Amount") '
If Not d_node Is Nothing Then '8U+^V.L-(6GJYC=X7.EITLQNI:L8^SN3B(69
Comp_data(aRows1, 0) = "Shipping Price " & id 'Y5V=18?LD\DB*F<-Y5\M
temp_single = 0 '?A0C,GY51G726ZONA7]*<Z456-97>-7KO3.\M)RXA.>B:R]D6-
temp_single = d_node.Text 'MD^?D0(T5N@D=LJ(Z1[TLY3YX+GD3T>*SRK5LW7N
Comp_data(aRows1, 1) = temp_single '2S?07@+VSAGTK\7?SU\Q+?25514E?MT
aRows1 = aRows1 + 1 '1X7W@M56QI2?FEKFVUIEF]FN6GVU0<5@3QP9M6N5RI-*IN
End If 'D)]=<[25H3T6,3JKMDK[^;-)H+L?;**I2PMQS(UP[NP6OA7=:VI2XK3NE=4
Next c_node 'AA)N(U,9*6=Y3?7=;54G.A=\I4E8C13)4B.1F?M=9-,9@56.4H>;S5
End If 'W]PK)D5Y+4^7<-*9\I,S\GMTM9Z^V,0^\I0:*.?<L<PF]+(]:D;+XE?OJF]
sum_1 = 0 'N1H1HQ5<WIX^KK\E^]/S,;0;MXY?TRORNH^^+I(/@>]7(W>Q?3M61@W@
Set b_node = a_node.SelectSingleNode("ns:Product/ns:CompetitivePricing/ns:NumberOfOfferListings") '
If Not b_node Is Nothing Then '-S[<.NJ7HR,):\J=A.K,@8-^0*>MC+C1]/1[
If b_node.HasChildNodes Then 'AA/<=U]=*,W\SKYY*[0,[,DV=W[?<^O[==5<:
sum_1 = b_node.ChildNodes.Length '5WT@9TOYVZL>>1:;(>QZ,.**W?=G\<0I-
End If 'I;W12,C+>)+C*A)+4C=VE(S(1ZWNGEZ,+;SL]]+UX69Q,Y\A=^[,0+\EC6Z
End If '/O:P?K:L3);BFY81,M(/2G\N@0>Z9;PC.B\34QH5ETQ-0KAF9S3YNMUDO5C
If sum_1 > 0 Then ':(N(PBHK\J,O@=<;5Z,C6\.6G?NT7=N;=23:(R?-U<LAT@MY
Set node_list_1 = b_node.SelectNodes("ns:OfferListingCount") 'H\:^+
For Each c_node In node_list_1 'RG+70[F8)Y7G][T;ZIE/S=/VFT(Z7X6(PNL
If Not c_node Is Nothing Then ':C)WSQR;B?N^EEUE8:=0T*W3BL98/-]C.L.Y
If c_node.getAttribute("condition") = "Any" Then ':9ZO)OLY=-?5O-DUN
offerText = "Total Offers" 'W\/M?]1BJY-[Q2C/3Y8,ER=^FJ:XW^I6D)R/]L1
ElseIf c_node.getAttribute("condition") = "New" Then '9EIDV;6=[.]?B
offerText = "New Offers" '@SESO6;X-?1N*N:ID^J@+B.>.I^4K=TBXX^9B\?9T
Else 'J9:M;A.UJO=1;>]SM1ONV:CT;?B2<,LB9*GGUE<GTV++Y,(B-;PWK+YQ.@GBY
offerText = "Used Offers" 'T7;4:+.\>:)6M3K(XE/52VUKX:X355=6M?HH.2@Z
End If 'G(/:.*5KFWFG=UIVA/9+-KMD>XO?W6O6,KL>^-Z*/Y470SWIQF.@NN(+0D2
Comp_data(aRows1, 0) = offerText '/W0BZE8UOVC.A,M./9D;B=2TU;@Y8]RK/
Comp_data(aRows1, 1) = c_node.Text ':+SW.<6B:S^K.V[LLM7=>T(390V.B;I
aRows1 = aRows1 + 1 '7J(,[,P\?C*H)@9O0YMN1/<N6W7SNLVG5E([VYL(LI4A3C
End If 'W<)288QN\0+>,1*M(@3>7CW<\+DE=7NW^V]5BS3K2/+LO,R-Y81*VA]];23
Next c_node '])4R,-/UU9?ALWRR+^Q]3JYK,=L?OP\OOCMS^BM2RBY3[AMTB+DK54
End If '3576O,[[[VM]:>T3W:U,VYYR4ETT+A]R0GQ9)H,D0>74<T,)J9).Y8(G=>0
Else '7<^L@:ZF^;,HB:,.P;\[.WN2,-V<WX:QHAKV?T694]6*3Y2>]84ZTVG*2O-4F
sum_1 = 0 'XSF)QTV6RMF8C<3G7;GQ*=M[8DU5@0(N4II8CR47;.UR2U1HA7@73P+D
Set b_node = a_node.SelectSingleNode("ns:Error") 'DD>^MU@=9J)X>ZUR/
If Not b_node Is Nothing Then 'OLERQ0G=X)A=*4\X)9\=1\(IHM(2>^0X9C,^
ReDim Comp_data(0 To 0, 0 To 2) As Variant '.+[?+?DZ./.1=<EWR(?*]HB
Comp_data(0, 0) = str_type ',0@@D*AGU3V.DF[R\1B0\)MC;TDL--9A:QI/YC2
Comp_data(0, 1) = const_err '<-Q6DV;3I+BPFW<AH::LZS)Q?5WSX9MF2*SA]<
Comp_data(0, 2) = b_node.SelectSingleNode("ns:Message").Text 'H9MGW
Else '=+P+V.K<Y.5)Z@DT,OG2B+2M5<K4(-T-I\@S+5S;R.?[Z87@5X+N\HOHZ,<J1
Comp_data(0, 0) = str_type 'RG,F1>XC>GY0H[<;>>:FX,=A1AQ(R0CHXI+?*4(
Comp_data(0, 1) = const_err ')@T]6N9Z5A123G398.=BUO47T[;UM]A-<K@AFE
Comp_data(0, 2) = "Get Competitive Pricing - Amazon failed to return a valid record" '
End If ')/,Z*M[)V(YE9WR[E8A.8455S?ZKFGC/LM]E6R>?0L91T502HS1>0FI/4TS
End If ';45(45G465@/+FQRUD67=TQ\3*3<WG;XKHB6A?;R]1E2]BZB,IA7FT4(AZJ
End If '+-G;L/567?+X=A2+C?I,VC>*/80FMSJEL0SCS0\Q*I62U-=060ACP:8-UUX
Set xmldoc = Nothing '\LQE^?-V4@-]MR<JGOUIVJ37K)T7;XEDL3/7[YPR[THQJ
process_GetCompetitivePricing = aRows1 '+<@1?TX[/Z-XSOJM?Z]1II74Q@7
End Function 'H;])*O[4>[A7J8FMG4PA@0DM@I1+IBO)]O7Y((C62]:PZ@/]M+SO?
Function process_GetLowestOfferListingsForASIN(str_xml As String) As Long '
Dim root_node As Object '8?[[PJ+G]Q?E6H^Y3\G<?BHMME:**<8+CKSUK.Z2QF
Dim a_node As Object '(V7.;[];YK\8KX.HRX28^;O4.K1-Y7F<.P\(ZBIN92^1.
Dim b_node As Object 'X7B8FTAWIPLPSY3+.:(R+KXVZ)2UA2F?URWENZF>G+-.E
Dim c_node As Object '[?^ER>K\KQ-=3KV0/DJW.A5ZDWJ9X52K*C>;63G4J7(5Y
Dim d_node As Object '\B?3>W6]I)P]GCD7Y(PH:[I8B\;UW,943T:\VD@*J:O8W
Dim node_list_1 As Object ';/D;7T5+HQ^:HK*7PEEGSVE-ZE?P:IG?]P5FH7K?
Dim aRows1 As Long '>:YF6/ORXN*+BM[+P=IZQV)H44N:\CSBA:@A+08*]L@ZQ<<
Dim sum_1 As Long '^USY7V3D.HA?C:VL\S:*D13FXPXQW6]H0,JA4/.>B;JJW<<8
Dim z_ItemCondition As String '(+W]TU>1+N.<P1FO[0+*NX*Y[^HVF^8Z(U:>
Dim z_FulfillmentChannel As String 'P>Q39U7K>NAY75@6DWY5V>-H8P0BMKF
Dim LowOfferNewFbaPrice As Single 'DT4TC>0-NT651XIH0-O1YPHHVBY8)7K\
Dim LowOfferNewFbaShipping As Single '1HCSF763:+T0(SJ],6>;*9LHF6D.[
Dim LowOfferNewFbaLanded As Single 'U?0,X[TR/<+H/6-F/P;(@.MXHO]*1YW
Dim LowOfferNewMfnPrice As Single '>E3R3LB/KY7AYVI3R,FI[NJU530==E.Z
Dim LowOfferNewMfnShipping As Single 'P^6Q+TQTNT6ZJ<S\[E6[)>;L+XFBJ
Dim LowOfferNewMfnLanded As Single '\J+-U6H=H9F=02B+[K)+;C@/=T=YG1Z
Dim LowOfferUsedFbaPrice As Single 'FWWZRIJ]W[-:K/-XM=D6]BOJ/:9DM6+
Dim LowOfferUsedFbaShipping As Single 'KTEKQG</CW0+3D^;.OY9<SBB>3VS
Dim LowOfferUsedFbaLanded As Single '1:TYRR+K73-V,W70S0<3]MNO15YL\9
Dim LowOfferUsedMfnPrice As Single 'RZ>YBO@I*1W<^UPAX]+?9YR/)DY\433
Dim LowOfferUsedMfnShipping As Single 'AS5386(A]+?(3(U=K:9UW6*@XTOK
Dim LowOfferUsedMfnLanded As Single '^1L5S](<4EW;]BU<:;@[G*CS;+LXF;
Set xmldoc = CreateObject("MSXML2.DOMDocument.6.0") 'E?]97B+BPFTOZJ
xmldoc.setProperty "SelectionNamespaces", "xmlns:ns='http://mws.amazonservices.com/schema/Products/2011-10-01'"
xmldoc.async = False 'C1C]Z^76=QHN7TFMYA6T)OSKH.GLJX\L@:+,/EU\7/:TT
xmldoc.validateOnParse = False 'OYDQP)V[YF:>ZA\V(11;6@GS8?DH4\5KL4,
If xmldoc.LoadXML(str_xml) Then '\ORUAQ4]N9(CMZV8FJV.[7X=9V48Z7C0M8
xmldoc.setProperty "SelectionLanguage", "XPath" 'QABN*5?6F?(93686/B
Set root_node = xmldoc.documentElement '=-ZCZJ6\10.<7)]EV</XMB/*\PD
Set a_node = root_node.SelectSingleNode("ns:GetLowestOfferListingsForASINResult") '
If a_node.getAttribute("status") = "Success" Then 'TNAZD1CNQ]SW6N19
ReDim Low_Offer_data(0 To 50, 0 To 1) As Variant '==@UZ2.T3VZB>ZX1Q
aRows1 = 0 'Y,^R*QQ;[E;^Z/3STYSF3WL^,[G+HB)L/+YAPA>.G[:FUPBNRX;=+1.
sum_1 = 0 '\O43Y93)=3KKYSUG^1(91KX+\?:F4O:1S].A1:QKPDNF*QWT:)R.AL)*
Set b_node = a_node.SelectSingleNode("ns:Product/ns:LowestOfferListings") '
If Not b_node Is Nothing Then 'EGDC645>A+LJJ?6)/]K)XXWY)=OA1GF(I:49
If b_node.HasChildNodes Then '5?.ZV;<8?H^S83D417K.Z-5?VVH[*=WH\<]3<
sum_1 = b_node.ChildNodes.Length 'X*0B5L=QNTQA@.BK^<2:TE-H6SPRV^I)I
End If '2G(JX^?A9\VBK0(-VM;?XK@A0\;B->CU))JR=I.T*J@*\2][-D]4G=Y0\(W
End If 'QW,TK?W381WNK(Z)=KB0V-,SW@):<V;^RV)1WW=0YZX][O]A<W<US@D-)L3
LowOfferNewFbaPrice = 0 '0,FN7B0QU\TZ3@MD(D05M5.4=8G6<=A86XR8VNS-+@
LowOfferNewFbaShipping = 0 'TNTX>S4V.-.Z[TRP5RD(88-ZS:HXUN9A^O0KP^)
LowOfferNewFbaLanded = 0 '<0+)X)K)UC;MMJ1X?O4):5./Z)B-,HV0LRNN,MR66
LowOfferNewMfnPrice = 0 '(O<^E.><-E.M7)V*MG8RE6LJC\(GSX0K=S?*S/)FLK
LowOfferNewMfnShipping = 0 '4E(G:8I7XWHGCW9CT^*23I(2WQ9+(<I.>M?J0[<
LowOfferNewMfnLanded = 0 '.I(3HWA=I;L^CWUHH6]GPP\F2>,^K^P,GX8YT=@S<
LowOfferUsedFbaPrice = 0 'XWD:AF:AE3^]]7Z(K0S0/35/E4TSKW97:E9C4BXTD
LowOfferUsedFbaShipping = 0 '9][><)<E]M?NU6:1^8YN(MR;C-0HYRLHC?DTO@
LowOfferUsedFbaLanded = 0 'FQKL^D;R3EIDRK,XJJUQUT0:I-ONI,]G?IQA:<3^
LowOfferUsedMfnPrice = 0 'OB=ZT3?B=VLG+;T;8014]=W25A6>GRN3,R?0.2SA/
LowOfferUsedMfnShipping = 0 '(YWBXWIN-OI0F5M7=4BYT>X/^FIN8Z]ANW^1DN
LowOfferUsedMfnLanded = 0 'H.V30/ZS87)0:Y,=K7<BS\;U+;Q,0PY,-67/DC>H
If sum_1 > 0 Then 'GH/0Y.4.FW861,GVFT.<Q,T+LN9ME+CE-:[KNVQ@PLQ=>FM(
Set node_list_1 = b_node.SelectNodes("ns:LowestOfferListing") ')E2+
For Each c_node In node_list_1 'CM0?FD^0RT@^(-SGL62*FZH++\,\D?;1WHE
If Not c_node Is Nothing Then 'R8Z-:@)9:S6[HU^FPP@XUAJI1*25H3T:L0L\
z_ItemCondition = c_node.SelectSingleNode("ns:Qualifiers/ns:ItemCondition").Text '
z_FulfillmentChannel = c_node.SelectSingleNode("ns:Qualifiers/ns:FulfillmentChannel").Text '
If z_ItemCondition = "New" And z_FulfillmentChannel = "Amazon" Then '
If c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text < LowOfferNewFbaLanded Or LowOfferNewFbaLanded = 0 Then
LowOfferNewFbaPrice = c_node.SelectSingleNode("ns:Price/ns:ListingPrice/ns:Amount").Text '
LowOfferNewFbaShipping = c_node.SelectSingleNode("ns:Price/ns:Shipping/ns:Amount").Text '
LowOfferNewFbaLanded = c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text '
End If ';>]*KPC)4PAFLHT(]Z4Q,W[<84])3.M-OJ8-=W)R)61DB+I)Q*B19J0.N*A
ElseIf z_ItemCondition = "New" And z_FulfillmentChannel = "Merchant" Then '
If c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text < LowOfferNewMfnLanded Or LowOfferNewMfnLanded = 0 Then
LowOfferNewMfnPrice = c_node.SelectSingleNode("ns:Price/ns:ListingPrice/ns:Amount").Text '
LowOfferNewMfnShipping = c_node.SelectSingleNode("ns:Price/ns:Shipping/ns:Amount").Text '
LowOfferNewMfnLanded = c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text '
End If '4(J,0=:O7-0GZRF>I<Y0<@XP2F31VZ?YWA+8X^,J(IB]PA/LWJ+UV@L53SB
ElseIf z_ItemCondition = "Used" And z_FulfillmentChannel = "Amazon" Then '
If c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text < LowOfferUsedFbaLanded Or LowOfferUsedFbaLanded = 0 Then
LowOfferUsedFbaPrice = c_node.SelectSingleNode("ns:Price/ns:ListingPrice/ns:Amount").Text '
LowOfferUsedFbaShipping = c_node.SelectSingleNode("ns:Price/ns:Shipping/ns:Amount").Text '
LowOfferUsedFbaLanded = c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text '
End If ',SM6A)*;]:S39ZC^C(AJ9ISG(8RR3?>)3B8<;RL]P3M,4I-6I[)())*>O?B
ElseIf z_ItemCondition = "Used" And z_FulfillmentChannel = "Merchant" Then '
If c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text < LowOfferUsedMfnLanded Or LowOfferUsedMfnLanded = 0 Then
LowOfferUsedMfnPrice = c_node.SelectSingleNode("ns:Price/ns:ListingPrice/ns:Amount").Text '
LowOfferUsedMfnShipping = c_node.SelectSingleNode("ns:Price/ns:Shipping/ns:Amount").Text '
LowOfferUsedMfnLanded = c_node.SelectSingleNode("ns:Price/ns:LandedPrice/ns:Amount").Text '
End If ';-^IW^<D2/UX001Q*9F:AQ:)H,@GA5ZFKGE+0.^OE5)P;=)EO6S;5+B21.]
Else '>WQXNAQK;+GHI5DELMI7K:,ZTR3=]WA12MQ;TH)XGL-*,9S8G306T>.\7O88M
End If 'B/1KB?JH].7ON,<V</1N/\E;1-JWH9[7D2HVHYS>F;N1-A9J,TVQU90CYDG
End If 'D)C^YD55Z;:A)]^:4.A:2KVHFBY+BX:[D*63NOXLS=<Z[=5YBEK>*U0,TBK
Next c_node 'Y<B*>.RW*,E]W@4O<]LER=PD>)H/?KV4TO6;CLF5YK>EF8ZY-^*2D0
If LowOfferNewFbaLanded <> 0 Then 'N1EB7Y6^^:=@<5UYTQ2?OWFE+)H)),X^
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW FBA - Price" 'PRLIS=H
Low_Offer_data(aRows1, 1) = LowOfferNewFbaPrice 'FV0U=MY,?B(B8ZQ8^H
aRows1 = aRows1 + 1 ',^,/W24Q,CD99<EM5O7<L95CC;J^99Y*V\ES]N(7V60O3:
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW FBA - Shipping Price" '
Low_Offer_data(aRows1, 1) = LowOfferNewFbaShipping 'WI*OW:\[MYDQ[3E
aRows1 = aRows1 + 1 'SH]XR1Z4<MJKO./U89,L\(7F-7EX12OS7L024J.+M=MZI:
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW FBA - Landed Price" '
Low_Offer_data(aRows1, 1) = LowOfferNewFbaLanded '=NK:3GA(-:.?Y)W^.
aRows1 = aRows1 + 1 'QC8A2E:3QS*VO?SX\ZZY(O]SD\53TLF6X]6BASB)=FN-;=
End If '-IE6ICUR9]Y9GQ-6>HTQ;NYACGB>Y]T-)3D]NK+\.C?@4R*<4K,KBVSRFF7
If LowOfferNewMfnLanded <> 0 Then 'H]YWWE5YVL[U8T0=,7F*XRHH=->,D5HY
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW MFN - Price" 'IM]N,[9
Low_Offer_data(aRows1, 1) = LowOfferNewMfnPrice '*F,-1RZ8C-2YQ@)^Y)
aRows1 = aRows1 + 1 '=I:.:JU4DZVT-=[7L^G8+K89SA-<@2,6EX9SAZ*;S0^TQ=
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW MFN - Shipping Price" '
Low_Offer_data(aRows1, 1) = LowOfferNewMfnShipping '35616CFDU7(]5W\
aRows1 = aRows1 + 1 'YCK>MH:K6-5U34:?^66TMXHDNI8\[IA4*N1<*JRL1F87XX
Low_Offer_data(aRows1, 0) = "Lowest Offer NEW MFN - Landed Price" '
Low_Offer_data(aRows1, 1) = LowOfferNewMfnLanded '9U6O]D9:+S7?-*L)5
aRows1 = aRows1 + 1 '7OSN\X)(6H7;-P/.1PO[9L-I(N^0*ZG*N.K\X1)?M95,/^
End If ':PR;/-B)[@>EWOUW@FW=/ZKJ]+E4DHS8,V:U1LXG2.2[?OQ:1VEO5;+3M?T
If LowOfferUsedFbaLanded <> 0 Then 'XKSI8)\G=.[/@^:,>]^A>PQ:MHBIP+;
Low_Offer_data(aRows1, 0) = "Lowest Offer USED FBA - Price" '),\:J5
Low_Offer_data(aRows1, 1) = LowOfferUsedFbaPrice 'K.;I-5LK3D;D2,=B7
aRows1 = aRows1 + 1 'HE9I@V-9>Y6)XY:)H[]+TBXYW]U*OO]U*^BF?C9/L^:SN.
Low_Offer_data(aRows1, 0) = "Lowest Offer USED FBA - Shipping Price" '
Low_Offer_data(aRows1, 1) = LowOfferUsedFbaShipping 'C5-/<.-CD0YG(V
aRows1 = aRows1 + 1 '=DA/84<EW<I[FYB6/T(10U,WG7P+T8O6Y.<9ZPL.PYFK\.
Low_Offer_data(aRows1, 0) = "Lowest Offer USED FBA - Landed Price" '
Low_Offer_data(aRows1, 1) = LowOfferUsedFbaLanded 'CQ/].K=J8,B?S)C(
aRows1 = aRows1 + 1 'A()(,66IN@Q/5MS0-E-N6ZL0I[K?E7D7ONJ,4RUEXX@(SG
End If 'YU8;7];(+D6YSA;-]Q,;37.L9)S,(GQRBOR>HG(N(H65U1NF38Q@E@3KGWK
If LowOfferUsedMfnLanded <> 0 Then '1<WC+X(8/>?>)>QMK;LZ6UA)I\XM;(/
Low_Offer_data(aRows1, 0) = "Lowest Offer USED MFN - Price" '3]BD)(
Low_Offer_data(aRows1, 1) = LowOfferUsedMfnPrice 'X0K]F;TGSOJB-X02<
aRows1 = aRows1 + 1 '=-.R-Y,^;M=@1Y[@B=DPS.IW9)KP1<4?Y)]859482[9E1+
Low_Offer_data(aRows1, 0) = "Lowest Offer USED MFN - Shipping Price" '
Low_Offer_data(aRows1, 1) = LowOfferUsedMfnShipping '(R.X*@[(0YEPRW
aRows1 = aRows1 + 1 'DMKF[15R>II*S*R67@8TBC<3OX3X?SL9*C08\=SGR3RJW=
Low_Offer_data(aRows1, 0) = "Lowest Offer USED MFN - Landed Price" '
Low_Offer_data(aRows1, 1) = LowOfferUsedMfnLanded 'N?H8YH(C2?QT]29P
aRows1 = aRows1 + 1 'T8\85OP(1^,P[,X=061=SJ>[J^^>TZ(,S-7.CWGML+3BC-
End If '+ZX;)/3Q\<MZ[/ALP)55B<I1Y[VZA\U31<493>\R-7[2)6^@>X(+RBCVN^6
Else '\YL4]IC-;I.BN78FU/80C\FE7/N8L5XHCT4IGCJ3G;R[1>;4?CLSB<8>:]3S.
ReDim Low_Offer_data(0 To 0, 0 To 1) As Variant '<VKQ7S\D1U]9=>HEN\
Low_Offer_data(aRows1, 0) = "Call worked but no Data in the xml to return" '
Low_Offer_data(aRows1, 1) = 0 'W2M*^K-NETEXIYJW76JTWF[J>0K,A\C+03\4
aRows1 = aRows1 + 1 'UK+U<>N;QGG[PX3FFILH?7+6(Y;9@.8ZAYU]L;?C:S(<4*
End If 'YV]KPMY^GKNO8^5DVR]>6HHF,L*@X*N702UI6K55\/;:PV6UYU8+>WMM>@B
Else '*8EH+X4>2,.DN11JY:L>^]5E76.XD)MZFS0B2-MM?/I/PCY<S7*J5B[N)B52H
sum_1 = 0 'OMR3N)^(4Y8EFFR1RRS60QLFX-8UT65\O^))I5ETB6[C)XDL],0<8WJQ
Set b_node = a_node.SelectSingleNode("ns:Error") '/>2E08)Q?P*YSLFN?
If Not b_node Is Nothing Then 'N]F(LI1TI[*XA<\T*V0GZZ)WM2YB:X-5+S:[
ReDim Low_Offer_data(0 To 0, 0 To 2) As Variant 'MD3G;UD+VO)71^W0N6
Low_Offer_data(0, 0) = str_type '>Q-AW*E?9U(VV32ANQER)7H[W-F/570(RA
Low_Offer_data(0, 1) = const_err '/D\(/IC);?\:NP29Y[>A7L^QNTG2[LHM-
Low_Offer_data(0, 2) = b_node.SelectSingleNode("ns:Message").Text '
Else 'PDQ58)X0YA-15C]R\.1;WI8?IY0X?+0S7^*11FZ0MQ7@X6LV9416=6HS[N?*^
Low_Offer_data(0, 0) = str_type '>550:\SN@MT9PIPI]Y3=5BDM+3+(?98W>^
Low_Offer_data(0, 1) = const_err '\47K==E\HL?7RV]NEP][D^VLA[X0AWG^C
Low_Offer_data(0, 2) = "Get Lowest Offer - Amazon failed to return a valid record" '
End If '5-OSDC5;O;?P]Q/5V1Y)@OG=D=/1\VQNC10JL//8]BB5<M\]^LM[)0NR(WT
End If '/D^C+2W?X9)C.9+GMK=X-JVE:F<6F(+96>?NTX\JZ8R0HLQ69IR[>70MJ@E
End If 'OLV-4KO?K8,C,6MA26XC=Z<V.R0V<BO:M@A<(CC^2ZBCDPZOB4FPZM-O;=1
Set xmldoc = Nothing '+)-IT3C[HS2PTJCKSTZQJ)1A?2?QE/ZH<UGM/I/=,W=ZV
process_GetLowestOfferListingsForASIN = aRows1 'QY^0IT3UMCO\LON2I0R
End Function 'R.EM+I8\R3LN3*^>7>9D^AV[ZASM5[5[V;I0J^]E7X]Q-4SZ-):PA
Sub process_GetMatchingProductForId(str_xml As String, str_type) '4
Dim root_node As Object '\6+DOV*HJYMCS^XPT/.4VJ+;],DYRGNK,9HT38R-/=
Dim a_node As Object '\B8;KHQ[7UVE/?K?STW.]RQ<O4@;U\?0=L;>Q<(9L\HUI
Dim b_node As Object '(2:9XEN2B4<8/L0[B4\8?B3S>@WAR:9VG?XY>15;NH;0/
Dim c_node As Object 'IAAYK^3Y4V.)E)C@]XG@@:];T73EO<PTHY]\Y)OFL4X.5
Dim d_node As Object '0(FIFT;PQKY<>92NYBY/3-PSZ23EGVD^9FU(JLL:@/K<D
Dim e_node As Object './OP9[@@O5,)ST6.[B5A07NM[UM2>TY;NV7(JHL0E+XWB
Dim node_list_1 As Object 'LJ7;(K:4J?=(HQ^N8B=-K/S-5P[,8XTK8.ME6?<Z
Dim node_list_2 As Object 'LIZ3JM^<6N@N<77U?,6[0[RCD-R1P\+-QLV8X>?:
Dim node_upc As String 'LZ,LYLMEAOF3[0Z6G(:9M0N+1L;Q?8IR76?GA3:S.FO
Dim Dim1 As Long '*D4AJO*^80LDUGRFZY4+*Q.9MV)2H\DCCY[V)Y<?S2]=TTB.-
Dim Dim2 As Long 'HR<J<D,WT,-^3RDBNK7<S:A1B7[3:(*/)YWJ][;D:].\3**]+
Dim sum_1 As Long 'FTG+][0JGG5P?SG\=67LY*6-VRKFT(P)C^(U?<CO]A:,?IIE
Dim temp_single As Single '^MT6.XR+\USF)7RY=9AKXU8;B-@4.O42FOI1G])G
Erase Product_ID_data 'G6=]\KXQ)>[V7<.9)[6DTRDR0HOBC?W8=Y.N]^NRJR:.
Set xmldoc = CreateObject("MSXML2.DOMDocument.6.0") 'XV2:I1]-8;^I8/
xmldoc.setProperty "SelectionNamespaces", "xmlns:ns='http://mws.amazonservices.com/schema/Products/2011-10-01' xmlns:ns2='http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd'"
xmldoc.async = False '0>^W9[HRQ=28>\+45Y4+)XA]HGK(-?/ESUMZV;;DB<TX<
xmldoc.validateOnParse = False '7^T@@1B)*E0Y*\V6V.]44>)HTUE,F78JJ0S
If xmldoc.LoadXML(str_xml) Then 'SOQJN<SL<3(0RJ1E00W^F(?2A(?;RT-D)-
xmldoc.setProperty "SelectionLanguage", "XPath" 'J@R8<J)7<)[D++RB)U
Set root_node = xmldoc.documentElement ')ESX>,8,YJU2M1M=)FM7].,0?MM
Set a_node = root_node.SelectSingleNode("ns:GetMatchingProductForIdResult") '
If Not a_node Is Nothing Then ')>36/.5TRAHTU@G?FS5E0A+RE8VW9(R4.:YP
If a_node.getAttribute("status") = "Success" Then 'X4HE]D6-UEOASUHU
sum_1 = 0 'DCON;;<>BBQ4<(V8>;HTW8-E1+]PBU].:>[8T5Y6LH?9ZZ;(JNJIU8?I
Set b_node = a_node.SelectSingleNode("ns:Products") 'PQYE9-XZGAIA[K
If Not b_node Is Nothing Then 'WGL;6SZ-T-A;K+;DVFV?7)=5R,[M@;@A@EI*
If b_node.HasChildNodes Then ':PI9ZT5,X=6X,7>>^=YL.@MRRUIX(S.DRN)->
sum_1 = b_node.ChildNodes.Length 'Y(R>+-)=84;DPH@V0>)8E9?VS/ITSP/=M
End If 'T-B,MIP,DSE)]V2R]BQZ6L=RBQ]K:*T9)3VT\;YCN*733RIZ5E[:-T\-EFP
End If 'S3NJF[SUXAT3Q^^F2E-4<FH>-P1F=/F(;=C/<B+9B;,H^0]3<BSMA]=\P/)
If sum_1 > 0 Then '\^DPPY69M/K4-U*T/DL.(QN+6WZYD.?W8[M34HO::\O9TJOD
Set node_list_1 = a_node.SelectNodes("ns:Products/ns:Product") ';RR
ReDim Product_ID_data(0 To sum_1 - 1, 0 To 40, 0 To 1) As Variant '
Dim1 = 0 'HQ=TDPBT,M*,B(O?NVW3XZ2[YFAU:+EWJ:L\:IY;[F(AJL:MCR4MWY=S^
Dim2 = 0 '*,@8H.I>S3D9C+4J@W3SV5K-==^[CAV:L4)L6YWQ?<T+8E57A\F]LNCQO
For Each c_node In node_list_1 'B?P)>S@M:FMI[S,?L43^<;<]1TG]NWQJ<8?
Set d_node = c_node.SelectSingleNode("ns:Identifiers/ns:MarketplaceASIN/ns:ASIN") '
Product_ID_data(Dim1, Dim2, 0) = "ASIN" 'G-S,D]7CTMGG(11V3KP=.F769Q
If Not d_node Is Nothing Then 'Y05H.@MCX]\A^V^I\-^DPA/MO4T^-D^G5MXX
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'F,C0M*WG3?(H+;,)ZFB/,
Else 'G9D7T+4KF?EP>N<=1GETB2?9N?-7/HG67/5FHRRW9W\4LW04.8LC2PG961QOL
Product_ID_data(Dim1, Dim2, 1) = vbNullString '(6NED5A3SQ-*6JXR-?YN
End If '0<G?NX^G3LX:X(+F410J/:;<3?71<F6;L>QW9-+0-,65ZF@6GV.ZY5\C-)P
Dim2 = Dim2 + 1 '8W0Q6T1CVS2R@*MUV>,7P1PY?Q6IN+1N0MKCDNIZA>/MBIY@1Z
Set node_list_2 = c_node.SelectNodes("ns:AttributeSets/ns2:ItemAttributes/ns2:Author") '
Product_ID_data(Dim1, Dim2, 0) = "Author" '/SOM52F1X,S/;U8L[ZKVU/K/
If node_list_2.Length > 0 Then '+\CYG,:]S<\W.HYC.3H/7M<98/R.9.[CMME
For Each e_node In node_list_2 'Q[VKVVP>IPPE]J>QWD7Q82I+O195C+26W(:
If IsEmpty(Product_ID_data(Dim1, Dim2, 1)) Then '-3[^SA@Z\B,2XOFB-Y
Product_ID_data(Dim1, Dim2, 1) = e_node.Text '=/?0DAA-N/13+5ALWK03M
Else '=6X6IF=WN[J3M,1YZQ7@X:<]5IK-4Q/,0JW2757:XI((GKQ<YFEN07.]B4RQ/
Product_ID_data(Dim1, Dim2, 1) = Product_ID_data(Dim1, Dim2, 1) & " and " & e_node.Text '
End If ':XX0XUGWR:Q6Z1F/L]<:@[XWVU/OZ/ZAHFACEN::/(A,O]L?/J3GD1PN5(>
Next e_node 'C][D9CP<@@/HHQ3NI\.LV)Q?UB?G/K\6E7VC<=WD4:UFR.DM\\*2<0
Else ',AN77Y;B;]JHD6K^4OQAK0G(<26V7<4MWIU3HRDXLH0Z[TGI0FAT:(:KF7^LX
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'CO)OBG7MC](]H,SCEWVF
End If '0=Q/EYJLQ)+,HHDGPB,BDT2]Q5Q(WE6E8=A]2C)U3[HSMM(S-AZFHV?6\F3
Dim2 = Dim2 + 1 'HSYHWO*F*3O;?\0<N<:LE.N*5O\?YE6=F*I+P2@-5-I+0/@*-]
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Binding") '
Product_ID_data(Dim1, Dim2, 0) = "Binding" 'Z9ACGO=E;+EQ(?R:F)@,5@]
If Not d_node Is Nothing Then 'P4:RTHO<,WZ*BG:=X?Z=R2AF8U.,=W=?3+)+
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'P<+??U?;X]LS8S0OC@OS=
Else 'WD=5@]N>UBACJ(9YV>8TZ/D0+:0RY+IQ0T].Z5QLS8U0I9FK1O>4;KBTA^G8S
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'I*9N0=CLVODVV<Y\)BRX
End If '16/6*T1:=7?VD:6GS>LP=B(7<(4>X/4AL/E)W,.0+ZI+BCKXD1DQE>.2WU\
Dim2 = Dim2 + 1 ']8^K?)X*3ZO2+TUL@?Y^1?P65P9-.2+Y]673=3)C8>(-)W^=Q.
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Brand") '
Product_ID_data(Dim1, Dim2, 0) = "Brand" 'Q\0C<,.YFGRT?<:=+FNUB@]HR
If Not d_node Is Nothing Then 'W7)21RB7PRIKK9BXKAWBT9GVB,(FGC)WUB(@
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'EEYY+P/VB+PM=4R0@WRTW
Else '5M]2C,F@)V801V:<U1S]D*H?PS>.E*UF<;U0-W@)=>T47O5^\]TEZFZV4+=X/
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'P7N1R>X8L.RO;AY2LK-C
End If 'XSE)X*:7@LPA^^-E?V6+[6@C]@;RD\G/K2545+\>(\U;T\[V+7^XI\1\OU8
Dim2 = Dim2 + 1 'AF)//9S]CVA=.M4A,A+TWZC9,7N/KTLT3LQRP[C,B(F6*/(MT5
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Edition") '
Product_ID_data(Dim1, Dim2, 0) = "Edition" '9LY55KZJ.08^PGB?QQ@758]
If Not d_node Is Nothing Then ']>>;S.Y1LPIMF/=H:G/G+HM;K;-.F2*0*6FO
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '?/]0=F\VPE0\GT9R;)4HD
Else '.E3SX*==^;WU0COT\1SD:Q.LP8AR0,2KN/4350E?;LILH>8.W\[L/JISBJS\1
Product_ID_data(Dim1, Dim2, 1) = vbNullString '*VJ7\Z<@H[KNQ[EL2Y*.
End If 'R,:K?1.@[4EOVJ8Y.BT;,)26=2FWK;C\WDYC?FWJ5V-V,,:B7;0=I@]Z<A9
Dim2 = Dim2 + 1 '78[-R^H5:E?E6LGO+<:Z6K0W@9PE@>=(\BR@2;LD^-1[+307@,
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:IsEligibleForTradeIn")
Product_ID_data(Dim1, Dim2, 0) = "IsEligibleForTradeIn" 'V\T:<J9D]H
If Not d_node Is Nothing Then ':P>DMS1HE9HJSN5@;7)V+E3KWTLU.):]7V/+
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ':+NT)OU?E:QGF3IN7(E4\
Else 'KW3=DR+9J,C3HBNGR@IO*YQ,T1>Y75([\/RG@KH4=:1TVKAIO>3>FIZOD1]AQ
Product_ID_data(Dim1, Dim2, 1) = vbNullString '=>\S:/7C:^>4(MEBI[VO
End If 'X5X6^,4(KRAJ),=EE1GU?DM7W(,O(>G>HZI[C.C,T,+5^S?V7R.1C\;7XWN
Dim2 = Dim2 + 1 '@4S;-*5AI6JE[TIX7[/(0U,DRQ79E5JZ\ML.J\0[LJ,L3*X98\
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Height")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height" 'B7S?/F=D
If Not d_node Is Nothing Then '/B>OMF8W-)Z-51(GWG:7Y1J:.ET9X9?X8+;L
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'YLA>BP](JV90TGK*W@+VI
Dim2 = Dim2 + 1 '[+.UF@C7J3A[7JAA;H.+-,VGQUOTM9K0J[O90BZDCUZOGX760S
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height Units" 'GN
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") 'R/32
Else 'BH-A><10O?:*6C:J)W>]>O02IOD5<)1YX9++)6:4U-690HNKK,G0[^S(.;4;?
Product_ID_data(Dim1, Dim2, 1) = vbNullString '-?14WFV8IDFILL9Y6L4N
Dim2 = Dim2 + 1 'Q>7)XCQHC\V=4J>.*A7GG<5VMJ.J74<[@TNZNG+-JHTMN83296
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height Units" 'T3
Product_ID_data(Dim1, Dim2, 1) = vbNullString '+P/.<[=->1Y,6AS<E6O(
End If ',6FUII\HF3.C[)\9O8I4JV>S;L1,[QO5:2J*@@7(.)+AJ1[-4,2H20AJRF]
Dim2 = Dim2 + 1 '3Y[M5V3V/9I:VZOB0]VB88WN+-A2)3@H+E<3/RF889+J]D2>>,
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Length")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Length" 'HJGT63:4
If Not d_node Is Nothing Then '5SH*C5IZ7-U7<A.G>(SWVXOH8ZR7\*<M<-A+
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '-D9JM,XDL@-.6R,E1O<<N
Dim2 = Dim2 + 1 '9.G02MG16:7:3:]GWF(IH2YP*IIW,C1P)5BA+G=;]A(R,8;G@1
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Length Units" '2L
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '*,YI
Else 'WX6=2@20DXWAY.9P;,K7:CDN;\XIT8,K00(G;RPV?.24>33P@HR\3;I;E*V,8
Product_ID_data(Dim1, Dim2, 1) = vbNullString '(=L:R7LA2R6O=B939OT?
Dim2 = Dim2 + 1 '4):@<AH-;*EDI)K:+0^:2H?)6-\DWD<BIB-L5:?6X;VYC1MLLG
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Length Units" ']S
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'BIBS-PDS)9XI*1\QX,42
End If '-CI4PK:^(=F()5C)N95+^CQHFL(YF.FSND,<LOC9F1*0T<T\5K>5@/Y,5.+
Dim2 = Dim2 + 1 '>8];K7,^*G)[,)8CBNQ]^TWJ3R=-XL.T:Y^P/(?A-VW@B(LA?>
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Width")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width" 'L4<EQJ;=*
If Not d_node Is Nothing Then '1K)MMCD8U<63[T[AL=.:)MBXJ<1T2V=C<T:=
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'Y>KE:-]PCE,96\\LDCG03
Dim2 = Dim2 + 1 '?F[WGXUXRTWK,:),5MUB(T>0]:ZD<Q)=@OR>SQNW-.+N,[DSOK
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width Units" 'E(?
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '0\[J
Else '>)(/3B9;5K;W/W15Q]9J6MN2M6G\G>[P[=*DB>:W)7?P59ACI@M3FJ8,^BE7]
Product_ID_data(Dim1, Dim2, 1) = vbNullString ')M;VHJTT[+<S2X;K=93Y
Dim2 = Dim2 + 1 'E\]])33C(T-0?M82FUC]:540\31^JVH+PU^-/>/0NP4]588N@P
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width Units" '9]D
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'T>24B;SDJ0]B@Q6I9GNU
End If '[7</=ZI+V+XB38?=-.T\CV0IQOR3S:^KD51GGX/=6KKHO=81@\ID\/67ORQ
Dim2 = Dim2 + 1 '[Q9?[>MN:UT@*,,SQ]KH\S097?I30BLIDZ)N]R37+/?)[BTS*0
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Weight")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Weight" 'B@JT:+JG
If Not d_node Is Nothing Then 'K7]+F.)G5MP>(W,)F:D78M^L^B1EA+SZQ)B8
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '9,2=3L*879J->H1M5C=@\
Dim2 = Dim2 + 1 '5<A[NJ.(SQVN25CKYOEDO;M.^IYOM2>MI403\MA@*2VW<W4PTG
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Weight Units" '<.
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") ';WR=
Else '@,?*Y3VI^SR)7?A>*P/Z:OS5H@=@6W+XR)QGP>*H<K1\68AF7-V@R6K>*2PJ,
Product_ID_data(Dim1, Dim2, 1) = vbNullString '@?+QJ/=Q^0:2+0ZYRKN^
Dim2 = Dim2 + 1 '\I0[I*^759^3]X5POS8FIE/)?A:QI3F*1A3[-+B6]/@+NOG5MB
Product_ID_data(Dim1, Dim2, 0) = "Weight Units" '+^P=B^>PL..B]P[60U
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'B:N:^40T3WF[+X+*.W],
End If 'Q/4(=376IS*BEF@HK,@/N540ST<BR2=.]HD\[9MSP8T>4*70PGSF\V88/88
Dim2 = Dim2 + 1 'EY\A;/::^UX205(V:K9H<[@GLH2=6Z^VEBC-TS?]A7SC1E6S>J
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Label") '
Product_ID_data(Dim1, Dim2, 0) = "Label" 'NRURQU36M/5<U@;7RTV3ZZ9V5
If Not d_node Is Nothing Then 'KZ6K>R?1)J)3KTEKMZU00O/=4A67->\S)GQM
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ',,9HV(5^7)9F@0<:FQ.PM
Else '>X>;M/OE0*81:=W[WE;V5<4:O=+BG-;IDMJY>WRI2,G.1VFK;;/V4BT]NTV(7
Product_ID_data(Dim1, Dim2, 1) = vbNullString '>>^^=\0<ZG)UIKCCCBRK
End If '9UZHN.+;*B(I2BZ?7SE0HG2;R+,(.8Q)8;ZU6E>A8)DK@N@:21,=83+C)1(
Dim2 = Dim2 + 1 'W?RYE2><,[;3U0BU8\P>VS,-Q<JN@]]@,RY,3F42XT]SWPP/3V
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ListPrice/ns2:Amount")
Product_ID_data(Dim1, Dim2, 0) = "List Price Amount" 'Z2(JU@KQE9;^\
If Not d_node Is Nothing Then '2:?F4?VGK.50T+:A:6EH,(K<BQWL0@XGP)@4
temp_single = 0 '@L/Q=^[6>DUB?V*CILF4]>2^Y-YP6E>0CJ\50,B-D:VYLGB2C4
temp_single = d_node.Text ')W-L[.V7RT5S:(8^Y.Q@51KXT.0J1EI<RA[6SI/+
Product_ID_data(Dim1, Dim2, 1) = temp_single '8-W=OH<]S471SMS:D/J;*
Else '3.\OM>*N9*TLUNOI2-0M0^?5I?\:E6Q6,[,CV@AX@MTY@Y\>7A8EOZRQ=5,8H
Product_ID_data(Dim1, Dim2, 1) = 0 'NT5WL*AK:78TYD\]?2EPV\9:9]/@L=[
End If 'RL\G[.)=JXA(22RS+,P+Y[?F*^.248N/HX4)S*RBA/@Y(7UAAN@<R[J?.II
Dim2 = Dim2 + 1 'EDWS:4H?:QRQXO2WRMLFKB:N[J-[X3;@XUV3-W];4(4SI*U-FU
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ListPrice/ns2:CurrencyCode")
Product_ID_data(Dim1, Dim2, 0) = "List Price Currency Code" '(]C]+6
If Not d_node Is Nothing Then '3<+X>Q3RZX*V6E9J9;-RSGUNYTMN;501F*U/
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'Q.0XES<X(;]6?G0KU]A90
Else '.R5DT+E?]-.Z,77=(S0SY(.;3;B<,5C>W?FM^@GN)>R.^)G[^WXX]W>]U,EDS
Product_ID_data(Dim1, Dim2, 1) = vbNullString '5G1D3>K;29IJ2+<M76E]
End If 'FJ257:L;M9DRTZ]TLPIZL+VT@HZUV;*@1[P2Q]BJMRKPT9HC)@,MT:Y\\2S
Dim2 = Dim2 + 1 'ZN\^=YGM]B5PYI4Z3=(8[NWQY3DFBQ5?V[0O8XHT\<*YF0+YOF
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Manufacturer") '
Product_ID_data(Dim1, Dim2, 0) = "Manufacturer" '7C7T*G2YB:X*L.Q(-]
If Not d_node Is Nothing Then '48J32PJI,^01,2:NIGHY:IY[F/-;FQH^BL2D
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'XL=^)SE2P[AED?QKFE/FQ
Else 'Q*S8DO)0G*SS,H82<=0*U<BE)U/R/;1)FWNGQYUID7(?4V@ZGI\4?*[O\LJ3+
Product_ID_data(Dim1, Dim2, 1) = vbNullString '?.)+K\6:)CT9DZ+8H\G3
End If 'R/POKK*N9-HBW^FZW>2EM/RT)UUBRII/.RN5UW.1TY<J(W)8@E9OEA1@M5=
Dim2 = Dim2 + 1 '244?[]=),^27KGW4-JOV*L:,1U8/F=WZZ91XE3D^*?Y(O@Z(ZF
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:NumberOfItems") '
Product_ID_data(Dim1, Dim2, 0) = "Number Of Items" '+T:2741K6HBVE;K
If Not d_node Is Nothing Then '.IX@HY-STLXCO)I+0M-B<VC^(J1^4N,3*^25
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'W[B]SA27W@WG8FH?UV8X^
Else '83)-L99FH(,*-R/.=HWQ;<Q@8O?E(UIS*KM3/@20-@VIQPGU1G],7SZUH@@^1
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'A*5(*H]\+8VHL5]L<ABR
End If '^T;6EJT9:H)E2K34T^WE8I)5V6BSKI<G2F*<LY,2G7O4Y683+O3SGFYBIB3
Dim2 = Dim2 + 1 'DC=,3KG)*6DWL63)U1G[4N)QHD-.\7A=9V+)>UI2S;7L1,M])A
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:NumberOfPages") '
Product_ID_data(Dim1, Dim2, 0) = "Number Of Pages" '0E3)K5^67B,U>S2
If Not d_node Is Nothing Then '53.4ZBS++5,M*+M(Y7RIN=;H\8VIA1.6:;CI
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'N8?0TP)W@XL+XPW<;?UK:
Else 'IO7K=R.<MKG\;NAB:5D>K9GKU85+I/D1PIW.0YES?A\=8-I+K3^WHDY^ZO\0N
Product_ID_data(Dim1, Dim2, 1) = vbNullString '6^BM\SS[^B?+P1[+CW0Z
End If 'PB9A7BE;1:L/CFN08R<F4[9M6YFQU/5N1SE;WYUUM]4.NM4(CZM7[,))TFK
Dim2 = Dim2 + 1 'EG:]],G-2U@AA8C2XBUV;(HKRD]^B9-7\7ASRZC.UX;ETD*XST
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Height")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height" 'ZQ<;7
If Not d_node Is Nothing Then 'E5LZ,G(.+,646-S9<]PWJJS)D/\SUQPKU0F@
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'EJ3PF<RW](=PA<.?]>I:7
Dim2 = Dim2 + 1 'O8;5+.L:](5\7YAT>PF+?L/H2<-HVVL1@/OF)F:3L,P?+\2,1H
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '-VA?
Else '.?UP-@+CTO9P=9R[5K@2[C7OF5DS04?OGD.5@VN-=TMSJ:IRN;\LCU6ZCUDH8
Product_ID_data(Dim1, Dim2, 1) = vbNullString '59.TXV?A9F>>3+G*-::6
Dim2 = Dim2 + 1 'R,.W(I2(SWPD\DM58./@;5.F/WK,=T]XZM,D8[C+K13]YM,:.=
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'ZU,).5)R3-=<ROW1[R76
End If '/QAK:\NO/V>GS@1WA.?G4<2ZBX)DBO7Q0Z?=11XF;[ZQ0JU;F/A2,LVB2K1
Dim2 = Dim2 + 1 'EGZXQRYAO\;9PD0MG=GC^L@2=A>GQ-D5WE/*UWXUI:-A2B9-H@
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Length")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length" '*),2A
If Not d_node Is Nothing Then 'XTHQ7:3KHP41G:*-Q.^I?Q;WZTVT0.19:G(B
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '3.J=;1<M3Q<O67X^0KZXU
Dim2 = Dim2 + 1 ']7K,ZU*)ZN0U>T6>11>AQEB1-3C7K846>+^]BER7P>D3Q3O,,M
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") 'NVG9
Else 'CG*RHS5X;@E<\QL0@\0JAU)RW9NCRI*0Y0XA]9CAF\L^,<O/*I[-HR1:6XTT]
Product_ID_data(Dim1, Dim2, 1) = vbNullString '>J;1-U+9+]VJB(-YNAKU
Dim2 = Dim2 + 1 '95N>YRH?^8X4W+K/W/>,D*ATXF:89PFE5<M<;?GS([Y=S/Y]EJ
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString '2D*EQ3[5VI(CUJ6[1\GC
End If 'A?^]1D<^R]?Y+8,3GO891;9X^P)A;IQ?3\1-N3C/[U\..^BGWON]Q),33C>
Dim2 = Dim2 + 1 'EDKDXMRD]BFXZRB(*]:9Q2W?QKELC3L\YAOL:KY)Q4^E1>=R>-
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Width")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width" 'DY3SO>
If Not d_node Is Nothing Then '7W:0,JN:.0GJM5*/J8FV*P=4BT970JIAI<37
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '(3UYP9V/DS,LE4JR567IE
Dim2 = Dim2 + 1 '1L^QG@WN6(@;A844;4VE4G2LJ6R/WU=FZ)+)7V,N:QAHU)GLKI
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") ',^E9
Else 'D>A]F\)\Y>D5,Y,KR9IW^;KESOIR^M4K;V74U/AG0/P8PBJ(KR)=(?.3F,FR?
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'PKQW?DFAT)6X4^(]2KLB
Dim2 = Dim2 + 1 '4WXC?0F,\[>0.DH(H8)NQ;BSB>U=*\O;;H<Z<PJ:UB8]4NQE[C
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'V157,V9*1WPK\[;>-B-8
End If ',4?IQ;Y\H=8<R[R\42>*73\WJ+\A;FV^<[J,,,DH6R*C2474():\?//?H3C
Dim2 = Dim2 + 1 '0\RZ.6K3R[T7+T1DKB3F>UH<5M0H.R]+5(POLS@J(U88B-R;/[
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Weight")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight" 'MAUC@
If Not d_node Is Nothing Then '+PCV)9I+\^>E1MGGUNR<:MO6WV5\5EU9^)91
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '6T<T\97[4S7YQ51SFJTOJ
Dim2 = Dim2 + 1 '1N0[FE\[OT,U?R3M7410/,DD])F)UA;C/Q3,0H6?TT>\L4=?3]
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '9CTA
Else '\>ZS1@^7N\;IP1]1]V1<>Q+,?F9H1N-U(R3ID(J<>\/+]I95HLQAG[A^74JI<
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'B-VQN7*.^F\CU<OPQ[;.
Dim2 = Dim2 + 1 '^:MY2@AI4101W>03Y1E9(NH@(YM85\92>5B(;?0D=Y7VN=M4,Y
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'F+]==K4VFOCTI\U]*3QA
End If '+^I3WQ(2QS[BXR521[[SCOE;+GEX+(31E[IHE7VBDPD?[\L*5OE^XN.(T/?
Dim2 = Dim2 + 1 'A*^4TY*BZ+435U^)OZ@OTC?SR;[918Q*M^;K)P]<9V/UB[/,1T
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ProductGroup") '
Product_ID_data(Dim1, Dim2, 0) = "Product Group" 'O:,YB0F[3IE6L3(7J
If Not d_node Is Nothing Then 'T,>\]BYKIKA/W]<\1(L1<)]9(4<@ZVJG-SI;
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'NI<>32E<0-X:E965WDF-=
Else 'E;-L:4Z4TG^*IKF/4:/S>MG5XX<W5=6467*Q5ZM@QXEXJ)-B-ZO,9BKJ]YA3:
Product_ID_data(Dim1, Dim2, 1) = vbNullString '6BM]*X>.S6IT4UMF8YN*
End If '5\KT@;IG>YY374<MA1:L6V72U\ZN3:A1SY-G\HRHZQ5H\P6TMN2SRNM,T(P
Dim2 = Dim2 + 1 '.I609+)JR5+]J85K5NCXRJBRTSDCC6H)UQZX**@3BOV0F)F=+2
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ProductTypeName") '
Product_ID_data(Dim1, Dim2, 0) = "Product Type Name" '+>.SLTT?W)TI]
If Not d_node Is Nothing Then '36F4VF;+W,3=;?])XNUO:,SO\H=PP,L^]C7Q
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'I9LVIK))DR:96(@P*SZ0E
Else '+*)VP]S10NP+=C1E)UR6BNC3B>J<J8-PD),HSWT*P:LRW4C+ZG2),/E1@)5.J
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'X,26F(S>:0,LFZW9UN)G
End If ',E=TGAK247/.BOD4LV9@<\F;-G=\2W4JW-]5NJBQ7T>S)@2I::6>+*ML*-S
Dim2 = Dim2 + 1 '4,3W3ZA)5K4603VIRP=[0H]\.\@0\?71E)N>B>-UQ9H);3*F>9
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PublicationDate") '
Product_ID_data(Dim1, Dim2, 0) = "Publication Date" 'D0O4.@W.L5:7L0
If Not d_node Is Nothing Then '50X-1*G655WTJ>Q8U(ECX+^FNX^?P15GV;6\
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ',)BM*(,@<@U6Z)P]RUF-X
Else 'Y185[V.C42RVDCJ3^P/5:@[/\)76A+H9G0?OZSJ)DHJ\0Q372P7:H4,>0:FQ,
Product_ID_data(Dim1, Dim2, 1) = vbNullString '(+R/]@*5.WC+?ZJ/)U)R
End If 'A[VHJFU8M-<A-@VP?4>A6^IVAA.IF=\GC5LWFA(+IUPNA,L/PU*AKL+V7KS
Dim2 = Dim2 + 1 'A]DH9P<RYXDX7^PXFI[:.51B<KQK>7SV12UQPYTR[O:B17,2A8
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Publisher") '
Product_ID_data(Dim1, Dim2, 0) = "Publisher" 'XTOG2)\DMWS7^CD?N2/K(
If Not d_node Is Nothing Then '50,,O-@PUQUT1=2*Q(@5A+^RKHD/^E]*N<WF
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '<)+?FESVV2;T5B<95/OFZ
Else '72\A)P9H3IH9F9G<JK1-2YR9M:(8^VA4BY)K4U+>F04LV?64@,1.*LIB-8EFM
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'ZA9D+M\\(>?[0]]U4SP3
End If 'ITHDE+YJ<5F:BE)-\^6SUUM.D.*?CN(P96C\QRMB7/\VT(;VD)*O304PN91
Dim2 = Dim2 + 1 '6JI>]YXB:5NS:LE5=HL8,/<B[G:^A/?EE*JE\N2D670NUD^[2H
Set d_node = c_node.SelectSingleNode("ns:SalesRankings/ns:SalesRank[1]/ns:ProductCategoryId") '
Product_ID_data(Dim1, Dim2, 0) = "Sales Rank Category" '8U6/75-DQ53
If Not d_node Is Nothing Then '^A(JBCKVP48GJBREU^8.YCY6\5.>;PU]PHAT
Product_ID_data(Dim1, Dim2, 1) = Replace(d_node.Text, "_display_on_website", "") '
Else 'WPY^0MNU*+OD,[<*8+X*\BR8K2BSJ8=L;/^T>W:8A5SBNIX[8.J(;<Z<Y*2[6
Product_ID_data(Dim1, Dim2, 1) = vbNullString '*SE;(2V2@4ZIC83G<K@0
End If 'W5Q<H@5Y19WB:<CEK88J2E:I2WB[/BF4]-M.I@)8S\DX(Q2]QS>@/>I/FX-
Dim2 = Dim2 + 1 'R>]B8^^@E)QN?V1-EM:XIC.((/YZTEH?R>Y(V)T2P7@7V,[8<V
Set d_node = c_node.SelectSingleNode("ns:SalesRankings/ns:SalesRank[1]/ns:Rank") '
Product_ID_data(Dim1, Dim2, 0) = "Sales Rank" '?FS\RGWIAX16*V@9G:R^
If Not d_node Is Nothing Then '4*D[-GS]S<Z(EVP5*W6.=7V01>:;WWM?ALJO
temp_single = 0 '4YV6J8(YBO.PTH2OAYE)Y\J3-58[]M*PQ-P+VYAMQ*O4A1Q^V4
temp_single = d_node.Text 'JXNM[37L,P,:.W67^7-QV/>>CH.?4;6UPV)-C34Y
Product_ID_data(Dim1, Dim2, 1) = temp_single ',Q3?06U=/+AI<[;N-]P2S
Else '=Q[5N;WPVEUCNLJUV*-LOGC[X@YXU=([PW5@MOZ.(\O7]YJNK>QA)FS5?>9N1
Product_ID_data(Dim1, Dim2, 1) = 0 '2792X<W9?4-F4AO)*JHCEFVX/R>R+<I
End If '(/+DSPH0B0.B,]4RES<U;R>]65KC6PV/[/K]Y/7@H\<P89-:>IKT[:P^8VJ
Dim2 = Dim2 + 1 '])CTI4SEUE/W\,^*E5+@S?Y^33JYCI[IIO>^7C]TEWO=M(VJ<]
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:SmallImage/ns2:URL") '
Product_ID_data(Dim1, Dim2, 0) = "Image URL" '7L+L.(SFL))0]W@ARNBV:
If Not d_node Is Nothing Then 'ARDR4*8VZE?\=^LGT5NA<]>S6(C6UF8Q+(S(
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'Q3[M,F,U.8DROA@)2K;,V
Else '585)+4D9/>->E:,<068^KZ,MXI-H?=O)?L:-LX0FYI*(?OW4Z)VWD[89/DFU)
Product_ID_data(Dim1, Dim2, 1) = vbNullString '4DW)/EZXR40<Z.LGB<DE
End If '))T9LKI464^W/;H@GR?ZE/V8N]J9OU>2SS5O90IH(:A(.2KA\;FWJ](T.N=
Dim2 = Dim2 + 1 'V*KX*-R[W(8VV-,L2[2N7?P3H0U>XYXGGE0H;*?H+Z-^XL?GOM
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Studio") '
Product_ID_data(Dim1, Dim2, 0) = "Studio" 'A[7K6A1O*86Z<Y]BRQL]W\U@
If Not d_node Is Nothing Then 'J>NL-)^BTJ0:C/3QUGX(;;R)JW?GH<)R4[*R
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ',RR^:;7Z?H7-LZB1F*T6;
Else '\)B254UF7)Y4[@\A2Z[F,+9.DI7MOG+FGOLXF8LYI\?LD]?O:N\944]K?@5?D
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'XDV;U,7[PQ;R7-I63=JV
End If 'N[D8+9-H=-O(><4YQD>NK59(VGYVU9R19N8KX7^K^^^C/K\+:E-AU7G-\))
Dim2 = Dim2 + 1 'OH73K)?G9^VL6MCWA\9M>0XO?,<N85S^*?<1]=9[.^R3N7\G)4
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Title") '
Product_ID_data(Dim1, Dim2, 0) = "Title" '<7(0M@B)=@96MUN[L:-+AGLXP
If Not d_node Is Nothing Then '8N^9G:(S\,11<97LKI;S<1ID0<O7VH=F:7,G
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'C)>UG7IK,-7GV@FYFD)R9
Else 'D:AJZ8=JQDT?B2>[2KE6:,^+S>1-+JG+Z-8M(=)]]0-]L:\<OLSP68;T[V3)3
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'VO--1>6.N6KACHF14.5K
End If 'GD0/3]]B0AK7ISY/9]J6881=T7[1D31I(M/T?G9,B,+/G5AI<@:V>>HZ)8T
If Dim1 < 19 Then '7H;?VFK5BJUO9KDQ0B*00,SKP?O.T-6-6S;JH6Q2ZBL^2^EB
Dim1 = Dim1 + 1 'M=UNP/^565Z\UP+Y3/B-A-N;3EF?6VB=@>X8J:X--H7M1.Q=[@
End If 'CMVBIT>/S+>+BS/@(B?PPNW=2;+FM-<5**QIHP\EB8UB0\*F/NZS*6IVV8A
Dim2 = 0 '<(H<GW\J(.M5+D,FRQFPJ-^AS^AO455*A/]V9+-,]2I/<G[[Q:5>?6S*]
Next c_node '+D\JB408V2?;69^\VOO8FMOVE21XAA<88]/E5>7ZY6D/R9C^]I2B.F
Else 'TJL8F\/M5OOIM]DUB@K*9QIS=S\D4E0UOZQ3;^PNPF4,<K7/KJ/9.=DA+O:[1
Set a_node = root_node.SelectSingleNode("ns:GetMatchingProductForIdResult/ns:Error") '
If Not a_node Is Nothing Then 'O,@3WON6=8IOUWE?<>J,T,YOY3JCTT(\Z;*/
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant '2:;V\9V6.
Product_ID_data(0, 0, 0) = const_err '@AW(>V-:F=U6H\8K;/B+==YGW8GKK
Product_ID_data(0, 0, 1) = str_type '><1\EMH(N=*3RGI91@(:Q*>RQ3I8-R
Product_ID_data(0, 0, 2) = a_node.SelectSingleNode("ns:Message").Text '
Else 'R>+:((MBR5ED5C+=D67:\3S^U@XN*\*69BOR@@0RW6LHGV,-,<?CX9YBYK-L<
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant 'W[]OSU@.>
Product_ID_data(0, 0, 0) = const_err '50*WM:0S8B*<*[S2RHN+CH@W51;@]
Product_ID_data(0, 0, 1) = str_type '*0UQ9-(@ZD;TPG\*7FA>PKY2=\FT+N
Product_ID_data(0, 0, 2) = "Empty search results from Amazon" '*-((
End If '86[:<4LD^1QUCG\/-=VQMIOTN5TPJIG29L=-TS?\>NVAVN-8Z+H4-TK?OIF
End If 'DPE1V,TR0)HYI?9,2L]4KQI]QM4+P/X6\;[6V6L^3W..FX1VWLXXG8]RL*T
Else 'T0D>0@]<MWZ1I<SJ7A<?A?5[XL;7ZE(NN5[-:*KX?M2)V0]@NGWBOBLUI1NH\
Set a_node = root_node.SelectSingleNode("ns:GetMatchingProductForIdResult/ns:Error") '
If a_node Is Nothing Then 'B1S)C80)AKHFL\2<I48FV?9WZ>^8N1IXV8TTIH>Q
Set a_node = root_node.SelectSingleNode("ns:Error") '*+(ZTDHB?[X;^)
End If '>[@LY[8N6K)3WS]DL9S^RON59>[ZCH?BZ7T>2ADJNQ=)Q+4@XKUV><1F52X
If Not a_node Is Nothing Then 'IWZ1:ECYYR6A*-3+2-0HNAJRE2.D\3@HP+GD
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant 'YC5)GBGET
Product_ID_data(0, 0, 0) = const_err '(J5A88\B,K**,V*?(.>-^9GC:X;(@
Product_ID_data(0, 0, 1) = str_type 'HVTQJ<K0X?732</XLJBNVA.H\]9,E;
Product_ID_data(0, 0, 2) = a_node.SelectSingleNode("ns:Message").Text '
Else '@8Y;17OW+S^YJ9+^LBXY2=[JD1JIJXN1YA)3Z1L1N0+4]2JSYW?.\W7;*B^MY
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant '52BO>^?^B
Product_ID_data(0, 0, 0) = const_err 'PL6HLU0(AN/FF@^\IO)=[1NE7+DYX
Product_ID_data(0, 0, 1) = str_type 'IOP9M>1T(90(4B>8@P2APV.30Q.9T3
Product_ID_data(0, 0, 2) = "Get Matching Products - Amazon failed to return a valid record" '
End If 'L\P<NCAA];-,MPKKMZU4S5.P<AZ70/)T:D8(ZBKB2U5*OTZB7U[96GY,41]
End If 'B^C*H*8YA9/Q)C06,T)>D/@8VCI4\Q8)1EYKADQ]]Q\YUB-M-+BB,.B4V*3
Else '?WXV0.2]T4\MZ=.@-M*BRE(:=EURJ<X^)58ZV2?Y-(@IY2A.(4H<N,@QV^Z)3
Set a_node = root_node.SelectSingleNode("ns:GetMatchingProductForIdResult/ns:Error") '
If a_node Is Nothing Then 'H]50AW>D.[<7/3N+M/HHMJWQE;/(X15+N)+PHV9-
Set a_node = root_node.SelectSingleNode("ns:Error") ']GCYTP0N?1;]7N
End If 'K;8^5QY.AH+S38;W5K8@HGS93:\LUQ0)/T2C1DX3Z\U\5H<4^YZ;A1@*YG4
If Not a_node Is Nothing Then ')YCM(ICAH<\,*</:7\S?]2D4YO3IMUT7GR<J
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant '7IZL)*W4=
Product_ID_data(0, 0, 0) = const_err '/K)8NJ>AE9[?6D@P+3=/D2MXJ(Y<+
Product_ID_data(0, 0, 1) = str_type ';^MF\U@H/L*Q)20I3OM[J?WOP*>4ZE
Product_ID_data(0, 0, 2) = a_node.SelectSingleNode("ns:Message").Text '
Else 'Y<:OC6OF.4O3E/O5E(S9S,39/6<^ZPQKSW:1J:09QF+3;3\-29\?I4*^K+YHH
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant 'V7O79PXA,
Product_ID_data(0, 0, 0) = const_err '^E/E[?BM0(9J54@7B-6NUGFX6B=(>
Product_ID_data(0, 0, 1) = str_type '4<*10)/+1/FS9[OWJI/FW1QZ@OA)MM
Product_ID_data(0, 0, 2) = "Get Matching Products - Amazon failed to return a valid record" '
End If 'K^5:CXC,ZZYJ:O=MY->??E6IZ/C,0IRBIKT/DBP:>PBOGBM*.GG-\4:Z:UI
End If 'A?2Y,*7.4APZFF@[1SMPFKD=B?E<F9USHH1LG-@IM0=QJ?CV56:K62UHAN,
End If '+:L=ER]W-8(/;KX^N0\;0<QK702:EOTQO3F1Q:G1S;?2:6>:U66C??(L(P.
Set xmldoc = Nothing '\NRCMAVAB:OI(+Q0N5K9]@<?V9@<U670X-\VX.0P+:<K\
End Sub 'L;PP[R.YU/)<+OQ-;J\]L7A5L(<@>Z>89-?]<Y7MFP]<EUTSN=1N6-2@QI
Sub process_ListMatchingProducts(str_xml As String, str_type) 'A;=H
Dim root_node As Object '5)KY^E/HO5E]^9^\7,]?VLM-OOT3.<?V)H60[J,-(T
Dim a_node As Object '];RAB<88YFH3-@Q=R\]X2953*E?<IYB,,T]28XW;E7E(Q
Dim b_node As Object 'YIHPP;WON^M9\7U*H;)C5E8C-GB5/\1X@JL5+R<ZY*>>X
Dim c_node As Object '(B@FO=U?<Y4Q);X\2S)9VU0ENX6GPKJNYRKV3TY3\?O^5
Dim d_node As Object 'GWC^?PO,69^9@6^1R^]))\-PT2X/H*U)-4=5V)7.[VQ+4
Dim e_node As Object '3LB1G/GHC,[3S*N4.09S;X/A12/V)T]I5T1L@BOI-;T?E
Dim node_list_1 As Object '?OL,)T^EI=<3;.O\)IXP(WNL:U4.00658:.M5*K@
Dim node_list_2 As Object '[C\V5(91705JI@\]2W8<^Q.R@S/J?>WZ<:\7N?LA
Dim node_upc As String '=I1PA>WK\C5P0N@\82BHD9Y28DXLZP6O=R0?A0B4^/,
Dim Dim1 As Long 'V5A7><V-7*:?00(H7+I[*L;=ZKYCD0KL,H5B+K;E(OL:Q>0BP
Dim Dim2 As Long '[SY(+J]63VJQMWH+9@JS\<F423ID5I(S4FSQE.XBK5?:\^;7,
Dim sum_1 As Long 'E,WM:\II:\W6BE?\;3P;J:R/O[G.SVNA[.*3IK(^>)R0YUU[
Erase Product_ID_data '10Y-UC1JB-Z(OE?24(2EG34Q+?M8*(JO8[/HOQK?;ND\
Set xmldoc = CreateObject("MSXML2.DOMDocument.6.0") 'H5O(4KR6?>J?[.
xmldoc.setProperty "SelectionNamespaces", "xmlns:ns='http://mws.amazonservices.com/schema/Products/2011-10-01' xmlns:ns2='http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd'"
xmldoc.async = False 'K[HU@RK4U/1X8L3:F2XLOCTMM(B<NY/K=BN7RO,,O+N=F
xmldoc.validateOnParse = False '(IQCW73VZ1O.^HU[5X+,B?XFQZS]1S\8^/Q
If xmldoc.LoadXML(str_xml) Then 'NFT^41JQEM(.1R\Y941QBT>7A@(4GER))M
xmldoc.setProperty "SelectionLanguage", "XPath" '<,?W871]:<E//2HH10
Set root_node = xmldoc.documentElement 'ZOQIM2;]8B;N0*J4RRWF]XLX^1)
Set a_node = root_node.SelectSingleNode("ns:ListMatchingProductsResult") '
If Not a_node Is Nothing Then '[\+D1Q=F2DT;(S*N\0J.>^S(X<E<39-H-7GA
sum_1 = 0 'LG6/./+DZ-9K0S6TO,QJK?GUFE*8BU-FWI3.S0WEF078=A29B+^;633\
Set b_node = a_node.SelectSingleNode("ns:Products") 'F,SH=DZ.7L9G-Z
If Not b_node Is Nothing Then ';T(>.D15Z=^T@@1FJ^GBP4@;U()-?]2H5WGC
If b_node.HasChildNodes Then 'KQ([XS](Z.U6);SQN7AB<W.E?846<>:T5:0\>
sum_1 = b_node.ChildNodes.Length '=<@=HGSPD.:SFDY*1WCIPJ+LEDN((T(X7
End If ');:]\13D^7EUA[G[T1:EDV657.Y-E+/<,G=D-@9B8TD3?TM=Y?\FVJ>25U\
End If '=CV>SIP:F+DWNQ82ZNXD[U4D-.5]:WWS5900E@)+I,T[D0AH)>KC,,=4=-R
If sum_1 > 0 Then 'M,L72==;HN97U0SO8H+;7;\<@<B2ZB(=4]=ZYBGEZ)7EQ;/M
Set node_list_1 = a_node.SelectNodes("ns:Products/ns:Product") 'LG8
ReDim Product_ID_data(0 To sum_1 - 1, 0 To 40, 0 To 1) As Variant '
Dim1 = 0 'L<;R8J:RS]*K;W[IR]P++:1?;L](^W13*ZL+T\WUQGR(O?7F2)J5*V4D=
Dim2 = 0 '1^.=:0XFNS*0[3OI>GA+1,TQ06.@GRH5M/OHP[PF/5D6[3MTE(T/HX0<8
For Each c_node In node_list_1 'HO3UIE=GQ1>ZLW=0R8)L7\OV7MQ;,BXE]L*
Product_ID_data(Dim1, Dim2, 0) = "Search Id" '<+:ZNJ6EX;K*L3HWB9VKS
Product_ID_data(Dim1, Dim2, 1) = str_type 'K^V+RH>E02DO>;G2519GDA?J
Dim2 = Dim2 + 1 '+EQ-99\(4Z<;HT/,PPG?[M40\5\[V)B^+B)[SX7\CKL4SQLCAI
Set d_node = c_node.SelectSingleNode("ns:Identifiers/ns:MarketplaceASIN/ns:ASIN") '
Product_ID_data(Dim1, Dim2, 0) = "ASIN" 'J7A\-M*-2.Z:5W4Z/H,BBR1H.3
If Not d_node Is Nothing Then '?BW>=E*2A>EG]8V[6E-OHLJM9YW:=P=U)X4V
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '2D==\3KW+M*@:,E56?7YU
Else 'M27.B32L5VM5AC+9VT).PHHUI2<]][\+=XM@WYDA<Y:ZL:7G@^F1H(;BT.(R>
Product_ID_data(Dim1, Dim2, 1) = vbNullString '^PX5]O=GK/287X.5HR<+
End If 'R7U.]ZCK(1W;HCYCT3^V/<46R+LH)T,L47PKI7IMLVTILW--:HX(]R:[KPR
Dim2 = Dim2 + 1 'JIFQ)NH^A3W\E;I=8+U^+<23K(<LK2C>0O*PJ7N,)+M62H:\DP
Set node_list_2 = c_node.SelectNodes("ns:AttributeSets/ns2:ItemAttributes/ns2:Author") '
Product_ID_data(Dim1, Dim2, 0) = "Author" '6EQN[3V5.AX]MR56TK3[<A=L
If node_list_2.Length > 0 Then 'S8S/WV-ID^GOT=VYL.0M;)G6D3<((RW?>T2
For Each e_node In node_list_2 '5O(1+XT+IRQI*CU[T3Y;Q^^)70DL[I(Q1K(
If IsEmpty(Product_ID_data(Dim1, Dim2, 1)) Then '.MJJ[5.VAA?8<7EC<N
Product_ID_data(Dim1, Dim2, 1) = e_node.Text 'G*N]-TN?LKX*E(\D7JU[-
Else '5WP1+ENOF]T5H4:*1O5=9-]X]*P,7HQ64D)G3+/74X?>(5>ELB;X9P4J3VSE[
Product_ID_data(Dim1, Dim2, 1) = Product_ID_data(Dim1, Dim2, 1) & " and " & e_node.Text '
End If '(Z*HV7CTMDZA2UN3]Q9=C5[<4/3)3N;@KFD)[V:NVJPA[B*/9>:<G][\\O9
Next e_node '2F5J<)*^:/[RU@[8WN80SM3(J4TUG>:2\1I\2(M33^Z7\+)67DLH\U
Else '=/E(BJ^/*A4B]^]F/LMD6;F5.YZBT\G5D+OI;)UK@<(FA9D4,QBV+IXZ2?\>X
Product_ID_data(Dim1, Dim2, 1) = vbNullString '*3(:^;QTW13Z8TQ02H3L
End If 'C>J-B8I:=]L3Z00WQCL[^LUSICIY9JN=M18+@S(A)\(6A>IZ?]VHDIC5ZG8
Dim2 = Dim2 + 1 'CT^KP/1ZRT(]+VI<DMJZ:1KMUJP7M76>?Z(G-N?-4>;A^QLQP*
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Binding") '
Product_ID_data(Dim1, Dim2, 0) = "Binding" 'N?B=;BA0(Z2*C7ZP*Z;MMW0
If Not d_node Is Nothing Then 'TYCPT??HEI(PQ4M:8O\@:RK5K,:B5F41?E+H
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ';J=VUT9S+3/K];4\@]FP^
Else '0OS;N9FTH7]Q8P-5E0NZ1?GHI[Q,5.:62,5?=K<WS@+M\CMVMSCG39WW95I<[
Product_ID_data(Dim1, Dim2, 1) = vbNullString ']5[IPNL7:1K@R84-X-KL
End If 'LN?0YTZG8(>,.TAUB3/<5UL\;80\.[RQ(H(MJU76X5QV>4@39OBN0ASB*9S
Dim2 = Dim2 + 1 'EJVR>GKRBA\+3L:5Y173YQ,9400P=F;.EBSBLLO;7@S/22@SH,
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Edition") '
Product_ID_data(Dim1, Dim2, 0) = "Edition" 'A?8I:W^FC?:Q@6,)A(L+51X
If Not d_node Is Nothing Then ')31]YT*M10R=EO9;2ET1(C^Q/NT8Q48O)-T-
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '6QP:([^4C31\T1(IM9F7[
Else '@\=W(.FFJ<G<PHJ=?@DOQ[^M\7496^H,K-MP*XGLQG:3(BR?Z=E*G]5NDS/67
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'CU9,+?[8>MH;GC==>?F:
End If 'G^J*\202CT]/UM^>9FH0J5X@E4))+9-(MRZ6,C9GSHGA?-.\Y)@S-J?SHXI
Dim2 = Dim2 + 1 '@]W1\>Q*Y0*WN3T/=R?FFA10BK\^M/ARG^D[>RGYCVGFM(--^D
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:IsEligibleForTradeIn")
Product_ID_data(Dim1, Dim2, 0) = "IsEligibleForTradeIn" 'FVW0D0R23W
If Not d_node Is Nothing Then '?H<,]PYZD3<)W>2DN2;Q*/LK7-18)YX(I?R4
Product_ID_data(Dim1, Dim2, 1) = d_node.Text ':9X@X:^NF7M=CJ51*HV+@
Else 'PZCRG9[Z+5*-1711VR>L/Y3]:/4]?X<PQ71E+C8.L]@5T/<@D75(AP472181F
Product_ID_data(Dim1, Dim2, 1) = vbNullString ';4WCJ.5CB8O6Z)II*:YA
End If '5<JFMSDSA25)ZN;,T-68@ACO-+3@M8YBE/CHKJJF+U*F@OC])NN7O*F4FTR
Dim2 = Dim2 + 1 '948W3MNK2+W>8Q^NPOA;WB,(?6?,1EBMAJB)@P2+4./0=F;8T]
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Height")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height" 'UF3TS3VB
If Not d_node Is Nothing Then 'BF\-06(P,.P^<@@ZE3L,W-C2X06</9><0@I1
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '(-Z/G<>U2OW6V/V[0A:8T
Dim2 = Dim2 + 1 'A8=T*T6/G(IE6EEF)[=\2J.N>XV4Z<N^ZNX2=<^UYVJY]*2);W
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height Units" '.@
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") 'XWW*
Else ']](<T1FJQAF7^:9*Q5:*XL^IS<N.H/+8C?AH>FR[W]=M0YDQN-M4O^@Y-\B7G
Product_ID_data(Dim1, Dim2, 1) = vbNullString '6Q?NZ8CG03-[ZQ9)MA:T
Dim2 = Dim2 + 1 'H>[LZBR1G935>UV0C?L^7:?H0Z7D4@M@7-FM/(K.+Z0/IOL+IC
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Height Units" ':Q
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'M<?CD*30[Z<EBC6/[>UR
End If 'J\;Z0-(-BNMU:=0-M,0*6;H4AV*7;0<W,NQR;0X8;S<XP=A+*3+D51TFCCL
Dim2 = Dim2 + 1 'U^7E)S]<Z*GJ8Q6D)F([)+1LA.5]1A+6>L]3R4F[?];GFP*)(0
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Length")
Product_ID_data(Dim1, Dim2, 0) = "Length" 'JL?(;+W.(:GIX\4;WF^F[EPC
If Not d_node Is Nothing Then 'RYHQ2)7KU<N7FLM[^81ITK+@+Q4G(6\)^?<0
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'A5TKYATWYWHRILV<[FO9M
Dim2 = Dim2 + 1 'C]?,+E80.U41X9L=Y?0M\VA=3.NLIC^TD(+*GP@AXAJ1;AFT>I
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Length Units" 'GH
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") 'BR[H
Else '13D59Q0QM.Y4AFH=@>Q,3Z1/55]FRORS;9/C/C5=+2Z:F*RU3\MF(UA9HHW3T
Product_ID_data(Dim1, Dim2, 1) = vbNullString '=34S>]N3U[>J0?U[VW8<
Dim2 = Dim2 + 1 '-OMR4J670U/KDGCYR\3B46?KJLQ9R(K+C,W=ZZ;3T@<K<>O)0D
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Length Units" ',0
Product_ID_data(Dim1, Dim2, 1) = vbNullString '@31?>NW4QU5)U;J0UEVC
End If '[V0<MH73W3.O>DK/E@8-\8AKD5^1V[4R=D*WPU7].S=W,48SKOF0AUP6=H-
Dim2 = Dim2 + 1 'U*8H@V26I+NGD2.0C3:Y6/..2WG^)5^8Q?Q<N=O5(TJ34/^>1Z
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Width")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width" '(7843W871
If Not d_node Is Nothing Then 'L;S:WQVS]9MRP.8/379W[BQM?G1NS>]DT-^C
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'ZGUG38ZK3WV4EW.[2Z.GB
Dim2 = Dim2 + 1 'F0V^WJHE+H0UMLBB)Y1701D^*NMKZV6^W9-.W:2ER<+6TV3;/7
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width Units" '[UX
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '7QWY
Else 'EZ7;HIU-@->8069OQ+>7WL]MJSM@Q6Z.)V1JY8[.9RMQ\6,-HIF?N?*@;B):?
Product_ID_data(Dim1, Dim2, 1) = vbNullString '=?96=:(/7B?F2CB?QBH(
Dim2 = Dim2 + 1 '::K(B)BZK+])W(KRNM<GG:OS:-JOYM5Y<;/S8-IC./<Y]DB^R5
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Width Units" 'L*<
Product_ID_data(Dim1, Dim2, 1) = vbNullString '4,V\./R1OTGED\R:6K3U
End If ')WL[]CBH)M6ED;]COX:TUI/NDNOP@2OA2;1@@7M>9J^O)TN+T6:@](H<=EW
Dim2 = Dim2 + 1 'JTZQ4H,):R<^2.QU03VJJ9/->L87/VVM.F(I9B]LFK.P0LQYJJ
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ItemDimensions/ns2:Weight")
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Weight" 'Y5;SGPNL
If Not d_node Is Nothing Then 'R,3TAY?EE7T.[YKM+3ZE[MEUR2/TPTX((LKZ
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'XE<?PR@0(T]TGV]KMX(<:
Dim2 = Dim2 + 1 '+XDNIB4=A>0JU@.YPLUXVA69<E:A4>G?G^8*>B\ZKGIE4OW^GX
Product_ID_data(Dim1, Dim2, 0) = "Item Dimensions Weight Units" '1@
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '9:+G
Else '=FN.3,9Q\)34BYJ3,S)]2GN02-WOHVY*BOXE+182GA0JB807UK6UWR@Z]IN-R
Product_ID_data(Dim1, Dim2, 1) = vbNullString '/QC1@Y04<+.29,S9ONKS
Dim2 = Dim2 + 1 'QWNZB[+@=X=/D3EE].1Q4S.8JP..0HGZ?(VS(YD(XW,/5YX7B<
Product_ID_data(Dim1, Dim2, 0) = "Weight Units" '1/KH8O8K:;>F/E7\2Z
Product_ID_data(Dim1, Dim2, 1) = vbNullString '22]W=AQ])[DC5326V[J6
End If 'DI=X)3J>*FD*;3+2T=,N\:@4RSD\ZO[<X<ADMI27J6.0>)N^AAX4C298>BS
Dim2 = Dim2 + 1 '*N*AG-1;9YZ)YE]/[HO=XXRR;VT*G6KI^)F>7>X5G;U9W1G[R<
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Label") '
Product_ID_data(Dim1, Dim2, 0) = "Label" '/6+;XPS]S)6UO^2TS(S7O<B.O
If Not d_node Is Nothing Then 'JT51,)+CX@L?:KI1FVF\O0BSD(@J(U?IF*AK
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '15=U.WEL**>.M?GX^[[@G
Else 'U0RR,ANH0]@W^OHC01JEYL78D9,Y*+)V1^J/7[3;[7?0B,]\[9L[0FK10O\/U
Product_ID_data(Dim1, Dim2, 1) = vbNullString '.Q5/9ABN3:B)<L5T)Z-I
End If 'SQ-<Q@HB[FD.\,@]L3?2VD7JYD^G*?BIF2DS?OZ\,>^AI]7)Z9CUC]N]+CR
Dim2 = Dim2 + 1 'K+@Z7PZ5485=O;O4KED-DM2.I1GICLTZOZP?LZ<SZ:VCI,?I.7
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ListPrice/ns2:Amount")
Product_ID_data(Dim1, Dim2, 0) = "List Price Amount" '4W>F4H58G)W)[
If Not d_node Is Nothing Then 'NPNR-69O5/YC>1>?JWI0L=:9<SQ?1>/TRLI+
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'D-*(X?\T3K,@@K3[PTS.C
Else '978.\O/G-0@[6.E\H/JCV,ZC@PV5XLHQ>4UDV[T@T-D*)D7\)LCB*^LR,BJT<
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'WXF[DQF;:<TE.8<^K8W;
End If 'UL)4Z?[7Q3WT?IND]8Y8O0B@T>2)09]E<PMO39^U)LLXRX]@Z8=<VHF,@ZA
Dim2 = Dim2 + 1 'U<N1*F\?H418O(HXHN]S),X+B3:A1KI)I67R6\JRAZ-<Q(7R0;
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ListPrice/ns2:CurrencyCode")
Product_ID_data(Dim1, Dim2, 0) = "List Price Currency Code" 'HY2JK-
If Not d_node Is Nothing Then 'VYO:=^D[YS>H,^W9)-\+VJM5@K;7JI5B>4O9
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'K4M8A2PK2]U6[1(ETLF8L
Else '>T1T=,]RFGL@HK2P55XFA\\^?A>Z.3)P[4S9Q7>=(8/\5)Y-RVG(I]G2PTN,B
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'J=>Z:+0B=^?U4/:8>*8G
End If 'Y[?S/YG>;9C=<KH.9K>FLZX=KS[B\;.JEPSAUS3M)W0BWXO6?L2J8E@B[-@
Dim2 = Dim2 + 1 'C3P;7ZLFZA[:3]BV@1:.;AMJ=(:*658>NGM>@8X^FVY-W4,XTN
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Manufacturer") '
Product_ID_data(Dim1, Dim2, 0) = "Manufacturer" 'W,DI+KGG1R0+3=@/;)
If Not d_node Is Nothing Then '0(*S\@BK:U(384901M^15;@IOSWEQC?V[W\S
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'ATS:Z@7X?O3)=V+14WKHG
Else 'WOURF^5[[@;DU3([M@,I2O1Y[R:HCA>9NY6E,(BAN/8D0,NVV5S0A,BRSU;)L
Product_ID_data(Dim1, Dim2, 1) = vbNullString '.NAQFR4O1UNM<,CVB5UM
End If '3^8ST6G*/5VQL\2C4,H3HM\]-*A(KT1[UAU<CU\H:+0G\RM9\;:7CPB3Y2<
Dim2 = Dim2 + 1 '-]2^CJ]R(Y/KK@6+--B*A<WO<2,76^A.+Y-4W:=S1OK.-A/R^8
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:NumberOfItems") '
Product_ID_data(Dim1, Dim2, 0) = "Number Of Items" 'U7UL,QY2DQ;R4@]
If Not d_node Is Nothing Then 'ZUCA[0G5ZGFXBPONAN423,IV)@;7]/U@\.>8
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '7FKG<L;H/+;76DX6V@6ZU
Else 'K>T/I+BBOHK,Y4<5IQ0+X*1HTZQ</53+/1SAUU^J5*+>2FQ--0:?,?YPCFT>=
Product_ID_data(Dim1, Dim2, 1) = vbNullString ',PR8K]<TH/5:POOFBIZH
End If 'LS^K0JU8YEYYY::9K>EPJ(8)6Q9@Y?WA1ZQ[FGFB6K)03/U8ANALO(CY34)
Dim2 = Dim2 + 1 'K;S4:OG=G])J9KI<T5U\J?RXR<^;6>E(QZ8[ACJ^A9,5*PGTC5
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:NumberOfPages") '
Product_ID_data(Dim1, Dim2, 0) = "Number Of Pages" 'K]<P(5T][W*4>[H
If Not d_node Is Nothing Then '5.[YMB(?-?W(2WIWI\FIS@54-8M55>X4ZVH?
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'C=:]6Q?=4BJ^5:K;+9I]W
Else ',RN1DXBXA):IMCTTFN(0XUFXU[N75(PK0EF4F.KK>B2AWI?\X9<6XUHLUS?0D
Product_ID_data(Dim1, Dim2, 1) = vbNullString '69KA^+WI?BTA\ZLKC0?-
End If '4.J]--/AW@@EOSX.D^XO9,9=@@2-K19/FLB\<HR1W(,REO+Q+[-Q,4L/^DY
Dim2 = Dim2 + 1 '@V3;9P8*NE4?1<51ZA2]WZ7EYR^PH49YY12F:X2743CV:K,IM]
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Height")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height" 'F:;Z4
If Not d_node Is Nothing Then '1)>+KE;.)X.L.LO4G-;QZEPN,<FEZ*7A0>.;
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'JG49H-QK0*75*G<6;M)C7
Dim2 = Dim2 + 1 '>8TFOA13YTTBLXNVQ<4>V^\V);DC59XU6DQ^J,9R+L1O)NDCE]
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '7@S-
Else 'DR:8:OGK?6P^)QGS/7MJ1J@,VQZD93.=H.HJ-//>MVW*M8:5:X8E<<3Z)5@[)
Product_ID_data(Dim1, Dim2, 1) = vbNullString '3X)XC6EKDB1*FYO;.YR5
Dim2 = Dim2 + 1 '20-Z[1G4.GQQFCFW[<^E1/J3TJ0RW=:*TE/2X]-MDZ]83BKB@P
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Height Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString '*7=P2^+FB0P?AOQ:\O?C
End If 'G\)BTS-TDVL9N?RI+N+N7(D<<HG0@;A0N/R?C*7A^,(\J+JS8NZ<>/O,;=X
Dim2 = Dim2 + 1 'BQWL-T;H=X@G[/6GT/N42-K25??P.CEQ7IGR1:>?\^N+K<GL<T
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Length")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length" 'C3]O6
If Not d_node Is Nothing Then 'RW@OWT4W2P(,,MEPP0(NS8\-6.-2L-QI?+9S
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '7QQ(/+I<G@H6N\KK0^G[8
Dim2 = Dim2 + 1 'O?R3JM3FY6H2WY<-PQH=2N/T,Z.7JEJXORK[A,8=)R7DPOFO<;
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '75B6
Else '4S4;H0,07+KUC(6S5+GW@AH<=@>M8<XW8\HKDZ2J@SYPI^6ZE20,OT+;1YIA^
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'FP=H@MZ(8^OSL*9Y[QX<
Dim2 = Dim2 + 1 '7I)SX/JISIZWYWO/9/D(,X<?3J^4\24*71H7OI6F8]02U;8+AZ
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Length Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'Q4PJ2G-NU83J=T6*P18R
End If '@]J:THP95:QU6TU4;)-)C2YX9ZDX,HW*8(J,>4I@KS6E:,H78[-UGE6L;I)
Dim2 = Dim2 + 1 '^ZXM@*4MA42<WRFM]G+NG)-F:(LH9-FNV.V)H[EUW>FI2O^C2V
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Width")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width" '*7UST]
If Not d_node Is Nothing Then 'O/<L@/.<IUGHELCS4[+99Z?B=;F17[8KX:RA
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '-[PHM,U(I)^L9+O5K1<KL
Dim2 = Dim2 + 1 '@>)<QFP(MA/O1@/54D>0HG1=GJ.=8BQ2(?[VP@E41CF]W*:FD]
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") 'FL7:
Else '.J4A>H,(O\<34A(.3K>;>DFSTC9FEB-:.5GXW/UQKWK;RT/562ED7[7OR=8RE
Product_ID_data(Dim1, Dim2, 1) = vbNullString '2WX5MRAZK*5W,/+@CTI=
Dim2 = Dim2 + 1 '-<JB5?1)@M+L\4IOUHQPH+5T)0,53>3BX=C4*[[TQP.W1)V1]J
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Width Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString '5.HU5-(T^,E]@+TT6YQS
End If 'D[<5EIG7NB^+GE..:O;:.5;UB*MZ/>OH,)R[Q.C-HYC6S:6+<(7+:>AN7:N
Dim2 = Dim2 + 1 'WW+B0I4,=,F.?PBYN==T8SYG@<<K)CM\GI5V>Y66Z156;TRKI2
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PackageDimensions/ns2:Weight")
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight" 'A8>I1
If Not d_node Is Nothing Then ';=J6)GKUT26RP:9B6]Z=MIHQQ4FLP8=9J8NG
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '9MKVC?X(N*K1)S>)7U,Y7
Dim2 = Dim2 + 1 'H2DWV(J3.G)UY@]KVSN@T*P0:MA83:SKA.51;03:ZA?AE*S?R.
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight Units" '
Product_ID_data(Dim1, Dim2, 1) = d_node.getAttribute("Units") '+\DX
Else 'W(MUK<XNY;(>SRLX38[QOIVRNR43YYUK,*I*^78\D29)5>OV*IJV,FRM*F9KF
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'FN1EQ..=>L/DM2R/?AUM
Dim2 = Dim2 + 1 '/[<GG8E?4]Z=650VJ0KY+767AO8AB;J*8=3@S,UPRTZUH8YU^.
Product_ID_data(Dim1, Dim2, 0) = "Package Dimensions Weight Units" '
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'Q^5I6A0/1H:):N@NNR,E
End If 'RSAASE.+EY?31(90R1/Y.KFGN@KZ(Q;4(1,<[GG-9[.L3MXKP(F^UI7<7PQ
Dim2 = Dim2 + 1 '8G?G[HWY1AR^ZFQ?JEP-):IVYI9>:2.K*)(()0K3@031SGR77W
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ProductGroup") '
Product_ID_data(Dim1, Dim2, 0) = "Product Group" 'RHFU3ATW,/*KFH?C2
If Not d_node Is Nothing Then '6Z]3[>8+2CO)W)OA?XRS580]^G+6:\W:^OQ>
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'GQT^R/[,B=5/J9M=9-(LY
Else 'NL>3[X<XH.00)3\V[X*?Y0(A7Q156\;N3DRA2(5;U;M]?ARG5?Z5,KB8,=0VZ
Product_ID_data(Dim1, Dim2, 1) = vbNullString '*^5*+4P074//31<>HK7Y
End If 'B12.ZBVL\JWEW>1Y,.1P?V\NMV-775>^@,1+9?D4GU)P/-LU31W1D<(RYV\
Dim2 = Dim2 + 1 ';:R)G4YI54).5X8N@J:.Z6AZ:W5XHW9TL87=UA+=]P=47IGE/+
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:ProductTypeName") '
Product_ID_data(Dim1, Dim2, 0) = "Product Type Name" '^-:@832AM\E\Y
If Not d_node Is Nothing Then ',OF9Y>394M^F-M>66A=D0-V=+(BFHNZ];G(\
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'A5A9MC3RBW/1)<BX[P<H)
Else 'KS]B\\>L8GY?@/@2/1/]E.2>LL/7934*.N3TVK5?*6.XQ/L\O[B.I<[ING9\G
Product_ID_data(Dim1, Dim2, 1) = vbNullString '7Y3TO4LDLDQD[*7VEO-/
End If 'GJDX-3ETJ\JV\^N6)*[J\<W=6\TK>(C8EJ\9DPK<3;XI]^@P>=@?>>GT>99
Dim2 = Dim2 + 1 'ZZ/B7E4DC0X7=6A1(TU6?L57X-PL6II2I).F/XG<6XH>-VI]^O
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:PublicationDate") '
Product_ID_data(Dim1, Dim2, 0) = "Publication Date" 'P/X)Y)?+*,)4ZL
If Not d_node Is Nothing Then ',LC?TV.9*FWG(S0+WE9PG@I\XZ7*G0[2]N7?
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'A+>U@=WE;X)9@DJ9=0I[(
Else 'R6,;9:(@R-G>+TUO1L^6NX4,T)M;;GPD8PAR8IEUJ=,Q:),6I+R0=JB\;WL][
Product_ID_data(Dim1, Dim2, 1) = vbNullString '3GXEV2P,-*EUM/.SUP@N
End If ';J40@LBIH*5UKZMH>RW^I6@=50JC1M:W]\N;\VQ3EZ=,TMFA<2M8=Q@[[[L
Dim2 = Dim2 + 1 '/*K319Z=UZJ(*<5?3QMPP5<>H-IA@T,IM<OS(,V^*8;2=L@NN?
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Publisher") '
Product_ID_data(Dim1, Dim2, 0) = "Publisher" 'HM>=9C+83:8GHNY\1+O[4
If Not d_node Is Nothing Then '09.(X=@QV.HE*.,YL<4^.47,6JTE^B>N\=A=
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'Q3072-38)6)3<0RYO.(+)
Else 'W)[QFC+V-M?<X=7.[L8LQ/D??AMS.8LHK7<T:>HE5I=0DFGV^P@30TW730BME
Product_ID_data(Dim1, Dim2, 1) = vbNullString '4E5XIM26/:T[UCZ(GC=A
End If '7[91O/>^0=5\5C^RUU.>198,JSMQ<?6PIGJEQMY-.L].N;YL66L1KK,A=P)
Dim2 = Dim2 + 1 'BS<E(JRR/\\^@7A921GO[6I.G3AG?8CUTZH,NB@)JM2*\N5S:(
Set d_node = c_node.SelectSingleNode("ns:SalesRankings/ns:SalesRank[1]/ns:ProductCategoryId") '
Product_ID_data(Dim1, Dim2, 0) = "Sales Rank Category" '(PIABXL-=S7
If Not d_node Is Nothing Then '):C<KAG1D6/X@@V+.)IK*ECZKP-PN=\[[9?-
Product_ID_data(Dim1, Dim2, 1) = Replace(d_node.Text, "_display_on_website", "") '
Else 'L@+SAP5-.781?*8G7GMTO-TI,[RB@0C?;<.]T)?@<LVCMJ=T3\+2,@>T>1<NK
Product_ID_data(Dim1, Dim2, 1) = vbNullString '<+J=A.R9Z9Q]:3X9=)KL
End If 'ZLY<8P4\/PZ1[5\F>0E2L24XGTFJ?2P:UKNRT.;Q3-/I=INW*I^4=FERD1X
Dim2 = Dim2 + 1 '/U8BF.(U7Y+OP>*@VFG0ZUC@+D4/J1=<\;Q^>A8^L+ME26VV+C
Set d_node = c_node.SelectSingleNode("ns:SalesRankings/ns:SalesRank[1]/ns:Rank") '
Product_ID_data(Dim1, Dim2, 0) = "Sales Rank" '1/OSE-*BN30-:)NL6PCX
If Not d_node Is Nothing Then '^[CQBFIRJNF]4J\ED-RKQY[G]G5]\5DDG^[L
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '^@1JI*8K?-T@8[2VTH]EY
Else 'B]-EPS12G6.?UW=D(2-PKODRY]WDDV;[Y/?6G;5FQZC789>;TV(9(9HP?4H^8
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'KSDEYQPRK62SPX\Z>ZZ(
End If '^C/J3O+<D<L.)UA@^6BOB4HHD?6]?OC1><*49IVKR8R2E,B-^FQ=*VVI174
Dim2 = Dim2 + 1 '88=6X:6)R6TJA)59LQ:GJ)9CDJZL2<R/*7VL9\?8E4.+0)/(DF
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:SmallImage/ns2:URL") '
Product_ID_data(Dim1, Dim2, 0) = "Image URL" 'HT3,K+C7*/L[Y9-WJ[1,\
If Not d_node Is Nothing Then '9C:Y@RR)[RDN?4RA[EF1ODR96:4BCO*7<>=A
Product_ID_data(Dim1, Dim2, 1) = d_node.Text '>/DE2E7MN@D;T*6R[WA:W
Else '^O:OVRG0=\U-I:T)B,VCFDK\ZG:G46MH3CMK374E0Y50KITN>;U1U]K\[>1ZE
Product_ID_data(Dim1, Dim2, 1) = vbNullString ':^:(R<<H7=[:\W;V;-D*
End If '.S?DB5O(1[HQ-ZBQ7+=;TRG)8,GG=W7CI<EN?]P5I5UJR-B-3AI9^[]69S3
Dim2 = Dim2 + 1 'EIIA(\GSF(GE>=UQ^15J;B=2XBX?5@]@J28+0L+GGW6M6(=V>Y
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Studio") '
Product_ID_data(Dim1, Dim2, 0) = "Studio" '-MEK,@F,JE9U>7^8TW-LX@2.
If Not d_node Is Nothing Then ';=U<U.D\<V=6Y4N<NL/).=0JIAJ?S4E3*\4Y
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'R?@P48:LW>6>7C3-V^7A8
Else '-PV>5M4\TE2RGWHEH81>870+Y,3MV-R>Q;9(>55O1HL>AVP]ML*]5M8CW@=;3
Product_ID_data(Dim1, Dim2, 1) = vbNullString '6>21B1W@WK[*]U\E/NE;
End If 'B8/UFP+LFDN+IQ)2.T6CC*N-2MY<Z,-P53SQ56JALMJ[*:B/:^5^I]3M,0*
Dim2 = Dim2 + 1 '4P-[K0,H4(^P:5R4QLV45[)[F\@E@>V<3I*?0IU*J?VU-QXYFM
Set d_node = c_node.SelectSingleNode("ns:AttributeSets/ns2:ItemAttributes/ns2:Title") '
Product_ID_data(Dim1, Dim2, 0) = "Title" '5O1J@;M)JY):+TY0A9K;UIR4S
If Not d_node Is Nothing Then '\8^0I87N-V[/P4.X\EH=YG.2CY(4H8Z6>@(N
Product_ID_data(Dim1, Dim2, 1) = d_node.Text 'G/[6B[2U2VFN]K)]9=MCA
Else '0NK);?LDE2NM?K:/4[J^PCXLL*E02T>7U-/@A+YAOL;OB]RFUNLY\[83L1QEU
Product_ID_data(Dim1, Dim2, 1) = vbNullString 'ITLM+/\628\XK5C>Y70?
End If '8)7AF^BWH@NMZ?/@N\,5IL\[QR:Y[;<L6O@0V/,ZRR(RC\KH5FL:SO[CGUK
If Dim1 < 19 Then '6I.4BGKL<HP.\3.F3]@][.7SLH2?^0--+[^Z;,S3NLA.C(@<
Dim1 = Dim1 + 1 '.LE.O]EH**@O?Z(Q<08*0^BPPIRKYQRFHE]JMD@.P,\92Y2PRY
End If 'W=8,>WYA\9B4BOJZ7Z?E?FCN7>+X7WD6/N.>*-XI9YT.4/;V+T08?VZKW@K
Dim2 = 0 ',:L-=U,?(F?[\@T]J?/6+;Q@P),P6BQXOMQ=Y4*\+C81N^YBSV0=/P\[)
Next c_node 'Q^P<6U?]OZXE=/W\;N)2L+6PD4YIR/B8Q;G.7*ZWV5ZD50-@6^1JNY
Else '^LTVKYS-EC<=M6RAXJ2^5[-V0*LW2Y@LFP<TI6Y3Q0DN?W?+BLA^RS<K[-22F
Set a_node = root_node.SelectSingleNode("ns:ListMatchingProductsResult/ns:Error") '
If Not a_node Is Nothing Then '[B4Q*)23X/0Q3?THG^:BND:])@)OHFL4)K:I
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant 'K\SPBHI8]
Product_ID_data(0, 0, 0) = const_err 'U<C1JVPWP:*SKJ2?H?/WY+\EO98:(
Product_ID_data(0, 0, 1) = str_type 'M4QE76?G:Z6V?5O:JTPCK<B3))7QW>
Product_ID_data(0, 0, 2) = a_node.SelectSingleNode("ns:Message").Text '
Else '9^]TW2/:A\:<LQ*,3<QJ]4[)-(=D;@PSS>/ZM6</F=+.L+3@KC\6;4G6^ISXH
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant 'NR\N8X1LU
Product_ID_data(0, 0, 0) = const_err '1V=1][VU4L<?0^:]E-E,8RX-517=,
Product_ID_data(0, 0, 1) = str_type '.TJ4,S=->:?1V6/WC;ZH?DXBD+];P5
Product_ID_data(0, 0, 2) = "Empty search results from Amazon" 'PP6P
End If ':ZPE@5+ZFFCO+?ZI0/(ZUDVJ5Z^A7BF7>JTPOYN16Y]PMI7S[WKEB02YFI,
End If '7A0G6,V.Z9PZB+@+??)FDM]Y+?O[A/4UXSUE;UD6)>2<MS9>A+[AY0JP5[+
Else '/9K]3>SI=MEQ\9(APC2+VN2CA4M*ZZL-^69?BF5A0B\)JXF/WOL3L=KAD5,BN
Set a_node = root_node.SelectSingleNode("ns:ListMatchingProductsResult/ns:Error") '
If a_node Is Nothing Then 'SL3\PS-O<<12-[E=()Z<X2>5CT;48AJ+-<)J96)X
Set a_node = root_node.SelectSingleNode("ns:Error") '1H6]9NDJ6@V.G;
End If 'BMLKYM,<)JEAN*4U@?A0HVY)MO+>.Z/<*/Z^?<1JIV+9P)\DV(@^U)I,(:C
If Not a_node Is Nothing Then ')DA25DT9GK8=VB*NGI+LR\>T2<7]LBMONP/.
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant ')<A3B/(:2
Product_ID_data(0, 0, 0) = const_err '11:I^ZV.F0F]:,0,987PG1*F]I)Z5
Product_ID_data(0, 0, 1) = str_type 'AJH^V=YIJ=3+=WHMFQ,[WR=5@M\YT]
Product_ID_data(0, 0, 2) = a_node.SelectSingleNode("ns:Message").Text '
Else 'G984>ZCX)KRS4@@ZQ<8K(H]U]>H*AQ?0DQ1]1L.=;^TH.WXE-P+S24HBD6PJJ
ReDim Product_ID_data(0 To 0, 0 To 0, 0 To 2) As Variant '[<(<Y5?:I
Product_ID_data(0, 0, 0) = const_err '\KGNOZ73J0ZGXI1.ILHDS2(D8?9R2
Product_ID_data(0, 0, 1) = str_type '*SX,N1(28XIGZ,/LS779ZWZHM]HSTR
Product_ID_data(0, 0, 2) = "List Matching Products - Amazon failed to return a valid record" '
End If '25E+6@)BAN[.V((2*=^*:5G/JUO6Z3+\[6U0)(O9846@^46J/(JP?B:<>0Q
End If 'S(CD3<]U=Q8OBGT?N\PO](8/M96MTQJR6BD8>/?*[CO:[/3[2A40T]U7)U-
End If 'O,)18^HY-Q(OL9U.6=.V@(4)N-G=JEWZ+9?MM)XVPA*-)O*.77LCEE.S^@T
Set xmldoc = Nothing 'B1Y7K=70.Z.OCRVX2E8DB/7DZTHSS@3N+^QN;;17<6N)>
End Sub ']74.(KY(R04U8(I-=-?FH0I2:-A[CMO9(?\EVN*O41-=*?@9JU*AKL(6:I
Sub BubbleSort(arr As Variant) 'TJMO]7HM9Y/.)ZS2^U]1I?,C(?OV<:6NJ@H
Dim strTemp As String, i As Long, j As Long, lngMin As Long, lngMax As Long, k As Long '
Dim t As Variant '1(UU//I7GH->M//B0^0*XNA\\=XEV(E7R,\=FE<(AY88?K@.E
lngMin = LBound(arr) 'DR1F1PM1.S2WLAB7QDHBZ\RKD3,Q8IVU1)N-0\IMOE9>5
lngMax = UBound(arr) 'E)UD;G@013@E+EN;0^>:133U7CQ50J7/:UL1R+IMLF(/D
For i = lngMin To lngMax - 1 '@I.:<=ADD3A;OK5)T8O>@6F+8EA=@]O.^9Z)^
For j = i + 1 To lngMax 'UO\O;<DI3C:VLUB6-UX33YI>JUK,ECL3VT6-;Z698M
If Asc(Left(arr(i), 1)) > Asc(Left(arr(j), 1)) Then ':09M)U8\Q6@E5:
strTemp = arr(i) '??BDC1DW;6IOMV?XNI[48356BXKZ/=(BX.4Z<>4>N<Y*,GBZV
arr(i) = arr(j) 'Q.2A89=M>Y2*D?=88J>K9K;(TGFQT14D=\@><=:;^AEP.>Y:EQ
arr(j) = strTemp '.U*.I,7ITSD);+4F\W:*BG@,@WCDCL=4BI+\AFPE0@A>F:V:U
ElseIf Asc(Left(arr(i), 1)) = Asc(Left(arr(j), 1)) Then '6\TL6LV>T(
For k = 1 To Len(arr(i)) '>^TIJS=8F4K)20MSI/9?7D)TOP230OAZTSD/)F,2*
If Asc(Mid(arr(i), k, 1)) > Asc(Mid(arr(j), k, 1)) Then 'RR8GWFZ*UZ
strTemp = arr(i) ',4J)BSYP0P;O<XY:X?3M65,=?3.P8)G^],E[TO9Q/L*-UPI;B
arr(i) = arr(j) 'MDXY?4,@EY8@ZY/GW<,\6NO?]@4\>949DIM.WO7Y([VO3J2P5@
arr(j) = strTemp 'YQ[KA.-NVC@97MUQDH<>XJ,0@ZIOA\?H,J,\:2R\6R47@[PWL
Exit For 'FOMF/=H=0,H<>VV/Z6(M=TZHZIB60?QD>T>@7F9?;@CF613-[E9?,X+*)
ElseIf Asc(Mid(arr(i), k, 1)) = Asc(Mid(arr(j), k, 1)) Then '(??:UX
Else ':1T^T5CA)ZP2P6<?Q5J<-+YIBWW\*FQ@7+)H2F.XV3EI].3T(7)G61PG87ZPS
Exit For ')[=JI6;.4;G:4NT).6C]?1J8FJW*40\(V)=T<]6451?SQ<WFA@;6)^<I0
End If '>I;E<G]4T(SNXIN,O?L64Z:-@=W[WI(<3O<:=<.4K.LE*(VI3G3I4XIRU[)
Next k ')902>]+-[RM?NG8U]I\TG?X.HV=@3=T?XROSNSFX(=75=^DPN*LGDXGXRS0
End If '8^L5\^+3R?2QLD(6@@D-.1=C(?(OB(H;M4L.MRUGOJI>W>QPUVJS(GYRU.I
Next j 'O<O*<*+3FS4M<UYF@V:(\ZH)URV.:2*?TNW.MJPUP0;JJX4(KDJ8OQL-PHQ
Next i '/H)UY3X>SOY]DA/.Y7/[-YTJ1G?2J^[AD?L?C-^K?TG,^XD-I4-PQTD495]
End Sub 'S919ZD2J.MMEG,97EU<?=I;P\N)6/3FPNK(8>K+93^XB)Y?9<CUOIL-[.Z
Sub wait_some() '2P*OF=,WJVX/Z\^V+(C=<@7,CL10;0K\<(KHZ>HE(KQS5/V+,[
Dim u As Long 'Z6]+RM/J6([0*M-:R)OM:L+3;,M-UGNP-??)-21UO@:THHO<),,(
For u = 1 To speed_counter '@I-:CMDA3CAMNQO0V[IB-M^NN>B@(+)@25M3*CE
Sleep 10 '+4V.I48O57@LHZR4>/94VX<ETGKUU.FKT\VK?B;,@N0IA.S7XU^U,(=0Y
DoEvents 'GQCIONQPW\.E(.+M\=8()4SS3:Q;:T1ZFL8K3BO]R>93/9T;/77085/BY
Next u 'F=8L+?UH*9S*\..*2T\^4@5WJBGQKF1LW5=D/5.;UTOZ5:*@;7UHM63QIDF
End Sub '[N<=>G4RNKA\SO5P7]K3*@14CR;@T7T;B4<R46G;*7<KC<*)9.@97*?42E
Function validateMwsSeller(confirm As Boolean) As Boolean '\VXG5:BR
Dim str_xml_from_api As String '<]*<5N*]T0>)CL?KY^-YG+]3^Y8\[V<3X^5
Dim errMessage As String 'P2(TU^H@.V48J>@+9L\[J-U+86])CER[+1/?2AJ*.
Dim marketMessage As String '[J7DXED+K3O)9SD7TQEVLUJW\/E\BDOI58:*1+
str_xml_from_api = build_do_api_call("ListMarketplaceParticipations", "", 0, "") '
If InStr(1, str_xml_from_api, "<Error>", vbTextCompare) > 0 Or InStr(1, str_xml_from_api, "returned an error", vbTextCompare) > 0 Then
errMessage = "Your Amazon Credentials could not be validated due to an Unknown Error. If the problem persists, please contact: support@sellertools.io quoting this message"
If InStr(1, str_xml_from_api, "<Code>InvalidParameterValue</Code>", vbTextCompare) > 0 Or InStr(1, str_xml_from_api, "<Code>InvalidAccessKeyId</Code>", vbTextCompare) > 0 Then
errMessage = "Your Amazon Credentials could not be validated by Amazon. If the problem persists, please contact: support@sellertools.io quoting this message"
Else '8ECZ1FXK@A1)[?.O:^ED2[7P8FU1--O0@AITP/:O)>7OLV.\^^H5=5LJE2*4X
errMessage = "Your Amazon Credentials could not be validated due to an Unknown Error. If the problem persists, please contact: support@sellertools.io quoting this message"
End If 'G1OAS[;,HYO@?Y>FVK<:K,S/8-*FL>2;^H<R+KS-KBN96YS6-NNQ1-Z2W8S
If InStr(1, str_xml_from_api, "<Code>RequestThrottled</Code>", vbTextCompare) > 0 Or InStr(1, str_xml_from_api, "(503)", vbTextCompare) > 0 Then
errMessage = "Amazon is limiting the number of requests allowed.{$new line}{$new line}Please wait 1 minute before retrying this validation check request again.{$new line}If you retry too soon, Amazon will likely increase the time you have to wait."
End If 'U6A)U5[OM)LAZ3QD)8CH3T-F1JS;;D^76+X;.I0*QN)7THCG]/ZDURLBF]4
MsgBox errMessage '?AYPR1VWLWU];[@VX8TNR@5*ZP@CN+F-@JUJ[^:BAA(AVKV-
validateMwsSeller = False '.K5F1WJD40L]=2,7^05^J48-JDVBL+FJK08CX(;Y
Else '1[OBG,@17[.KJWQMX72JF*W\P/Z+XDD3P7BVE))-AFXE:KL2H;<WA66GA3[;)
marketMessage = "<MarketplaceId>" & Marketplace_ID & "</MarketplaceId>" '
If InStr(1, str_xml_from_api, marketMessage, vbTextCompare) > 0 Then '
validateMwsSeller = True 'FD)F36+X0ZW>(3HPVE8NYPWRK\.F([1M]=1V2Q-02
If confirm = True Then 'T+[ZU;5K]:8O3?ZF]K**,R>X)R6-9:DR6W*+ZF7E3W*
MsgBox "Your Amazon Seller ID validated successfully" 'R=EHJV;YOQ<O
End If 'FI(PMKP9^YS\V2B;DYHNNY0?A*E,?LGJ);3U8/4\NR1T36SUTT>G+QOC)^V
Else ':U6M]=>^,:08T@29HQFRV:Z?XJ48-IA6EJPP@0LP:^X0/KY5M(4;:1H+,HI9H
MsgBox "Amazon have not validated the Seller Id for the Amazon marketplace." '
validateMwsSeller = False '5/XT57;]4)++B\CD5JX<Z/-TFIPXE3?FG4<]S@6Z
End If 'QR.K7X\UW(57Y(1Y^.W\I**W[6,^+H7)8,=8\^:G*56\GXV,Y\LK9J0((?A
End If 'Z13J\M1E):U^P1LRYG),U;.T(^)WR/;RG>VL.=99-V[J[<I2W)L47=ZN;VQ
End Function 'XMA<U)4U=Y0L6;XEW/\5+QNE(T,[8H-/;W33+(0FP6\L,=1>UA@D.
Function process_GetMyFeesEstimate(str_xml As String) As Long '8LHA
Dim root_node As Object, a_node As Object, b_node As Object, c_node As Object, d_node As Object '
Dim node_list_1 As Object 'G7Z=V+.G7,8=VDY5PT7?7-[3)QF]31MJ8[A=(+GO
Dim sum_1 As Long '[*1*JG*:72N0LLINGMF.P.LI[NNE?OBXE3R]I34>/>L9+YGP
Dim Dim1 As Long 'BNY40GWPK2W=V:H^ZK1\4DD:,2Z..4TPG*ZU1ZI4\(:5CVJ2>
Dim the_text As String 'UG2A2I]L,I3C5>2J\31U4-K1.\WC>@G/C>+RH?=Q\L\
Dim temp_single As Single '=5K5YQ4AM;O6O6<BT\BP=:346)CFUZ@,=*Q5ZMC:
Set xmldoc = CreateObject("MSXML2.DOMDocument.6.0") 'P7YCPDPJN\N/71
xmldoc.setProperty "SelectionNamespaces", "xmlns:ns='http://mws.amazonservices.com/schema/Products/2011-10-01'"
xmldoc.async = False 'OXRZ1RG=><-(6[3@Q6-G<P-GHI):VCH,B2+9.G6W5(Q=+
xmldoc.validateOnParse = False '^PY9Q0OY46^H[-XZ+KR\4F^HF,10X6?48=1
If xmldoc.LoadXML(str_xml) Then '^NFN^-7U[I\@<J1;6;+LGZ.D4K0(2LI@YP
xmldoc.setProperty "SelectionLanguage", "XPath" 'EA;Z[;IC>EBWC\<\31
Set root_node = xmldoc.documentElement 'UFEF4^HF*@W2*XA\>/[[;SMZ27<
Set a_node = root_node.SelectSingleNode("ns:GetMyFeesEstimateResult/ns:FeesEstimateResultList/ns:FeesEstimateResult")
If a_node.SelectSingleNode("ns:Status").Text = "Success" Then '(;\J
sum_1 = 0 '^I^L\*\/I]Q1;D-D>72;UD;FHCU.10Y*2\27:,5)LT;1Z+L2;C?+J?LC
Set b_node = a_node.SelectSingleNode("ns:FeesEstimate/ns:FeeDetailList") '
If Not b_node Is Nothing Then 'U1YW619K]*T*BJ^ZS2/</;;SX76.S(V;A.>9
If b_node.HasChildNodes Then 'RB(Q):)4/FVF3CSL2X]><:TG4,[39X@7O4-<:
sum_1 = b_node.ChildNodes.Length 'YS0Z:<,>5JCV(:I(<*=4:D+,6EX6/[[N3
End If '\LIO,LR(.^NNR.:0PDCTA<\F3G?34T+@;0)SRM?*]>>R,HI/9-P+T.DAG/S
End If 'CL+OXYE]?N19V2DY;2:=C3)3E\K.NWV],-4N@J(GDJNQ=,;(6ROU9:]E,L?
If sum_1 > 0 Then 'FO43DT?A=>/+O8-CEKV/<5.>>RW?]G1I6?OV3T4MR.?V;D)]
Set node_list_1 = b_node.SelectNodes("ns:FeeDetail") 'Z(;J=+,/(VZ0H
ReDim fees_data(0 To sum_1, 0 To 2) As Variant 'W63>D\@(^),RXY[+R8Z
Dim1 = 0 '4A//D(C2,3>:@0SOSR4VG6?@7Q8^?9]/R/3J[\+;-STJ)Z]X;^T;,H]8:
fees_data(Dim1, 0) = "Total Fees" 'VE+ZB0[9CH9;/UG(/)C[B])@[V)[4)F;
temp_single = 0 'S7E6G;<YA=1Z@L+A:N.\2:SB+FTGQ***^HY9X^QUA0PNL<RN?[
temp_single = a_node.SelectSingleNode("ns:FeesEstimate/ns:TotalFeesEstimate/ns:Amount").Text '
fees_data(Dim1, 1) = temp_single '?M\C@S;78R)M.H.*=\EB9QO@,JRBN[Q2X
Dim1 = Dim1 + 1 '^[08O=5)SHB[@RV>H\S<@6AR;C.,XRW8.MH*6>4\?=+;S]H,UC
For Each c_node In node_list_1 'D>8,T1?QW^11)A-I:*/=D+IG9YOM[?.TYQS
Set d_node = c_node.SelectSingleNode("ns:FeeType") 'SBH1:-4-;WNI;HL
the_text = "UNKNOWN FEE" '4*G9BB+RJMLEXOF3-?>OA]46.>*P5O24:+IYL-G-/
If Not d_node Is Nothing Then 'MW=S+D6S?M7B97ZEI6M=SOH.A<QB/9573Z6\
Select Case d_node.Text 'O=T[9,=;VBJJ7H6-[JBU^+J4?]9-4IISJ4HLX/,R-,
Case "ReferralFee" 'TR6J2+@2AH^>DIP-[,6T1FJMT)8K29<Q2I^W:+,@1^9YN+6
the_text = "Referral Fee" 'L(UO0X<UW\R(?.ZV4,5BYNS]4=R*5)4W?U(4?N[^
Case "VariableClosingFee" '?]JLMSO*WEUW397CL.FPZM-LR@/UMT(GINDQ.7PG
the_text = "Variable Closing Fee" '(12BP(TC<=/;@A53G5QDC5FVAKS1O?(.
Case "PerItemFee" '*2O-72Q3J>OQZ(LYN77[0?G0EDV[MUX3Y6@+(6ZJJK75V^;U
the_text = "Per Item Fee" '3DS2I^DW8]M;2DLUSZ1>RYEGV6(QRCJ4NZ)8SVRM
Case "FBAFees" '4+(((G,478HZOP7\BZB=:48]QN]*G>EFN4MA.R\61E+T,AJ?NEZ
the_text = "FBA Fees" '=C.O\QV9/FF+EQ(QFNDBN<<C.[A4;<.I8?<PHZ4H](;4
End Select '[ZE@-[3@53;9YGE0?29/TBDHD5S:U)E*1UX.YY)N4^ZY<J[7/V+PA*3
fees_data(Dim1, 0) = the_text '^*XY[DW\Z8IPXYJAE?LO[2V^]KXWGBS2N)IJ
temp_single = 0 '-REPWQX+)^5*2A30[388MS7;P0]3HE2RHSY>LZOHASHRL0RFF^
temp_single = c_node.SelectSingleNode("ns:FeeAmount/ns:Amount").Text '
fees_data(Dim1, 1) = temp_single '\]W,JJ2D<=,COTQ^*R82(<8*1]CVZCU7F
Dim1 = Dim1 + 1 '-XA1*0LR)5EZA@D@R1N+F.871P4=C]^W]1YYQ7=7=:L>@/ILH5
End If 'JRTS8<AJBV289-8F(XKN6>L7\4K.2@@I>*00WE9*<W1;1D474^1MJ9WQ6,N
Next c_node 'B0BCED^4P,1;H*ZC8L)F8B?*+WJQ3O=OVGP2.T,4*1Q1IFKJ+^3GE[
Else 'KE4T-7,6V[GIHG;?]40,-O4:,U2\ZA^LQ=1<.)=LM>4<,N/P.GP<,5;[?<PML
Set a_node = root_node.SelectSingleNode("ns:GetMyFeesEstimateResult/ns:FeesEstimateResultList/ns:FeesEstimateResult/ns:Error")
If Not a_node Is Nothing Then '5Q<OZT/X=U.-H(E43882V,2/:VAZ@=ETO-,=
ReDim fees_data(0 To 0, 0 To 2) As Variant ')@5I@IT34[/A];/(Z)S4Y5U
ReDim Low_Offer_data(0 To 0, 0 To 2) As Variant 'L89X(15SIPQVS8*=33
fees_data(0, 0) = const_err ']1YP8U9A=(N^4JP>BALA-@;S4+UK/4[QL5:DR+
fees_data(0, 1) = str_type '(GIF*5BDNZW>-OOA;[<N4UC43@1USZ;Q[Y>XX4.
fees_data(0, 2) = a_node.SelectSingleNode("ns:Message").Text ')WD-\
Else ')RN.4(Q[.I?NKP+)9(JASDI3P6Y-+H0O517\]]1J+ISBH[;>6XYU+D+@2<)4/
ReDim fees_data(0 To 0, 0 To 2) As Variant 'WGKQKL/.0B[5E9O:3S0M;./
fees_data(0, 0) = const_err '256,O>N1>IDL;XM@91@LE3HLCN/5;K,50,B4QT
fees_data(0, 1) = str_type 'U1TF91F7@0R=.A4-]2D5U\CQ6*/6GOC4VS^\;?W
fees_data(0, 2) = "Empty search results from Amazon" '@07G7632DL]6>
End If 'UGX[V1@G3BH,(5(*WQH5N3FJ^8KD,(M*XR7XMLZ1<.2PTL7E>*S</DNTDCM
End If 'Z]PGS;NA)84*(=-:T6]GOTLM.SFUBB7=STP),C305MZC.JJ)VPK-?W*WDQ-
Else 'NWV0?64GQM\MQ).WA3R@;]G)WZD4@WYMF@K0/ZU,45;5U>+M.*\[R0PCI8EDD
Set a_node = root_node.SelectSingleNode("ns:GetMyFeesEstimateResult/ns:FeesEstimateResultList/ns:FeesEstimateResult/ns:Error")
ReDim fees_data(0 To 0, 0 To 2) As Variant '0N]9]=K:-NUJ[65;/X)>]GK
If Not a_node Is Nothing Then 'OCUQC)POIW,?E6JV<S4QU-BJH\POZ>8D>AS;
fees_data(0, 0) = const_err 'M47D=)C9RKH?G37C8A<WB2J-,TTL37,(+9@T1K
fees_data(0, 1) = str_type 'P-JTY^)O17^DX.YOR6;*^96<2?)\Z)1Y4\(RKQN
fees_data(0, 2) = a_node.SelectSingleNode("ns:Message").Text 'L3\^R
Else 'L*XPFG^A<=*/0\X50)GMM:8Y*ADKV18OCS*,^X7.Z6X7O2?[2RU:7R7,.=8G2
fees_data(0, 0) = const_err '0Z@)R2BK\ZSD6=:3=LQ@A@SGM.)96.(MFB?-?M
fees_data(0, 1) = str_type 'M=^Z/ZY(U:FHGZL]A0795TTKP)3=V)CYCR;=,].
fees_data(0, 2) = "Empty search results from Amazon" ';;O7E2>YXSWYZ
End If 'H>8@P2D9S/E^ZIT<<KS@;@=T+3KJ++OQV<+0K6XCC;W*KT,V)G7+1Y4N50A
End If 'D0J2)L42T0@W.EQS*\-6A@LNZX.4\4\>JZ/>3I^97.:N^M[@C6)SU@9PT4*
End If '1=N8M[+BE6I?.HTK>1Y-+AIDBCXV;E^+:]W0]>N@\/O)EN9G4W9;SMIC?Y(
Set xmldoc = Nothing '<]FQSFFTL\B]LSP)1=RRNX>S4RBG/GST.Q2)@^];GHHJR
process_GetMyFeesEstimate = Dim1 '^UU9H^QAF.E[W1S43S0JNEGPH<I+@D8Z=
End Function 'AJ[6B@+95D^;YBJ35\VWK\A=0=E3X\W@N.RP+G--3LB2C<WP,862T
Sub main_UPC_Fix(control As IRibbonControl) 'EL14L076OXMI5RT)XB+:YR
Dim cell As Range 'XZGAL*XMU:Y2VZE8HLD([LY+;V.9/+^8C24+1I[2/ZM3KY@.
Dim ActSheet As Worksheet 'T(+40PU4@69X;1][C-:PIC5YK(0.=TU25;1>.;?-
Dim SelRange As Range 'NL;QD^4RT?AWG=(/39ZFOTNM1-[SIS41YO7R.5:[)NRD
On Error GoTo ErrHandler: '2M?L):50^@3N9V-(M,I+],4@60?Y.0[1/YD,J(SX
Set ActSheet = ActiveSheet ',C,6JTL7E;=6=S<N/E@\<.]JQ[^AN\E6=*/0Y4O
Set SelRange = Selection 'KF^<M,Q<(:EI[[Y;?F*-TQLXUW+TZ3F^JF0BFV=P2
Application.ScreenUpdating = False 'X1C:(7TN6UEJ?N.FU3J/(,(:MCMLYH?
SelRange.Select '7MEVD)J>C<**5>9=YHH=O]51=4[/OUM@9KAGUOR6-3OHXL,AIK
SelRange.NumberFormat = "@" 'XJ2FXJ<J/QGD0RFVQGK:4HK@S=W+<K@E@0^]8;
For Each cell In SelRange '*H:BK5=B<42*(DZ?=(UL]EIF\YX[<603HYS,][:K
Application.SendKeys "{F2}" ';(U\[584:Q]T](]OUX736,;:/\L\^CPPVL<KTT
Application.SendKeys "{ENTER}" '[>U5>8>YA>CK:HU=5STZG8[QE/A8UT3,K2T
DoEvents 'I2IXG=\/2HAJY:Z<GQG[N4X2M;BD=;>4(AB0.P*E)-[29GKZQRV,3Q(F2
Next cell 'F60@X+JG,V=2QJZ2/BHSPQYU,IX?WSYW6KDSA;ODGA<PHN]9XXDIH9QJ
ActSheet.Select 'O^4P6<0Z)C[?6R;L9F?=B6^]4QAYN)(D8(T-TTK/A*PN>BV=C[
SelRange.Select '9-);7-G;K3\=3TEO4\P<P;*3/I1>(RE*4,\]4)H(JE/8+F<]4S
Application.ScreenUpdating = True 'A3-]\ID+XA565J6)WA^;MY6)>KE^9M;]
MsgBox ("Done") 'T->=C^5N8B4J2+]-ZRCWR(GDEU2RJ0E\LG]S*0=<]EUCMB2/R9
Exit Sub 'Y1C;LPAK@NYLM97)=.><@(T3-U:(P\-FY:F@EM^(FW+8EKOBSN<>JM6>T
ErrHandler: '.G:?Y?B,WZ]V-\^QP-G3\\NY(SC\O4RE(BS=[F8XLZQ2(6VR]J9^MM
Application.ScreenUpdating = True '[RQ*=\YTO3IE7HCX<6^40P5HUGB[[-B@
Resume Next '[AT/EY)*2[10C:3IVD5,[Z2[EUJCD1\I-XRE;4F\*HB;E<KF.5<IFF
End Sub 'PQJXCN=/>3B4.:GWVE+63^6/=2GXHO]^D<XU@C.F4E09QWJLGZ0<U=956^
Function get_MarketPlace(mpInput As String) As String '^K:[+*BO;JLG
Select Case mpInput 'LQ0.1V9I/)U.LD=MBP]>/G84GR=+WMF.51B@:XFSQJMLQ.
Case "A1F83G8C2ARO7P" 'FOJUZ:ZTOXI(J]0+@OG.M1(Q7*J@MJV-(*KVLL3/,TW.
get_MarketPlace = "amazon.co.uk" 'Z53AD7Y4[7B(/-[3.J-HL<0Z>,8[8YN?^
Case "amazon.co.uk" 'QM4)(V2+=GH6TBOG,;6P@V:339W)O*/3HFG0,7\DXCG-+=
get_MarketPlace = "A1F83G8C2ARO7P" '3\[+8(1><P;(?5][E>6*CX^KOE>?:[K
Case "ATVPDKIKX0DER" 'WTQ\)O*=^69ZE;,W:;3;E,9;R[:[=47TUZ>,=@B30V==3
get_MarketPlace = "amazon.com" '^KW5YR+1PHZ):HO;:]RYQL*;\N22OUZ(J5;
Case "amazon.com" 'K=>:@LVA)4<=^?V0BT9+Y7Z>Q?Q;R)54;\JX32OA34X<CG==
get_MarketPlace = "ATVPDKIKX0DER" '?H,=0YY\L+J:[3NW<,L@E1[:\[X,6C]Q
Case "A2EUQ1WTGCTBG2" 'G;@HV7W,<VX2Z\I.-R:C:+J:)RB/WUX@D5JDG?68GT;F
get_MarketPlace = "amazon.ca" 'B+UO?;W.\TLF?>(6:R\J\-KP5H:@^]IE0<\1
Case "amazon.ca" '.T4^9:DOFMEQ?>JX0+5B2R,:O/;JR?<2<X>,^AP73J\OREKHM
get_MarketPlace = "A2EUQ1WTGCTBG2" '8EJN78>;KL=A9Q[G.6XL;=:\J7OW-H[
Case "ATVPDKIKX0DER" '^*,UR:K0^9,YWIM]5*ZV2OLJ)]Y4CX@^4W-;@I[YY0WM,
get_MarketPlace = "amazon.com.mx" '+J15E(QA39+,+Z*](:3BL/Y>1,X5EE1S
Case "amazon.com.mx" '5XWABIHR79@E9C72+9VIQLWKL6B[I/W*S;.PN^=G@79P5
get_MarketPlace = "ATVPDKIKX0DER" '9UIAP-?;560X^>R(RP+G)AMM.*CNWL;4
Case "A1PA6795UKMFR9" '<>\DHTR6+?,-ASG,>FI1SNJ.4YSAT<Y\5MA)\*2NNPDK
get_MarketPlace = "amazon.com.de" '<PX^D\AQ\TQA0;]KB,V*=3.H]+,>MTF.
Case "amazon.de" '^MM=;KV]K\P7,OB214R[73,BB9(7GW.(CZQWUE=UL4]:LTK5>
get_MarketPlace = "A1PA6795UKMFR9" 'Q\.B51RZ-@KDUYJPYIV6/R+U/.:7*L[
Case "A1RKKUPIHCS9HS" 'E4PL^=(TRE67-LT+Q\ASL20TJCRA<;:QQJ>-;3M>3I[A
get_MarketPlace = "amazon.es" 'DVZM\26W]P+:5)-QMZ/ZLR5JH+CSHYTNG+.I
Case "amazon.es" ',?;JVG]]F@IJ4V<E(0TASA,4)6<EU+NM5ARUY@6:RW1>91K(Q
get_MarketPlace = "A1RKKUPIHCS9HS" 'EQ5ICD;:8@V<-LLS@*@SFCVDW<0.O.4
Case "A13V1IB3VIYZZH" ':;WUUVOC=K-4R+<)NBO@>SRG<,G@;JIEN+9LPUK+LZ]K
get_MarketPlace = "amazon.fr" ']69H\\O:.C,7:ZW3,<R\KB65PQ0N06B8XMKV
Case "amazon.fr" 'OU;1NKYT4YU/,,54,HC8I(A,EGZB5^:@Z@R.4T,4*4=NHYSJP
get_MarketPlace = "A13V1IB3VIYZZH" '24I2JC5.M01)14BLPA9P^A2R10J4UB-
Case "A21TJRUUN4KGV" 'MG<CPLD(KX:AYDA2G4DP*F@D6K:KU:6.T;G5=X:4,8[)[
get_MarketPlace = "amazon.in" ':VNX3.A.0CUMR*4H^R1IL[CD=BTYJ\0Y[=]>
Case "amazon.in" 'XV\=V=@VUJ>/L/(8H;MF73@@<^:;]864LD[@H91,TA@;*]H7A
get_MarketPlace = "A21TJRUUN4KGV" 'B9T+-N4<R3:7B]LUA:WH:F)X@G02I+^[
Case "APJ6JRA9NG5V4" 'L3HVF]<J/POXUL6@H,.\5XG2W38*@:J<[P+:=G5[>7ZN[
get_MarketPlace = "amazon.it" '9WD3XB^)]V73@M7]2L*X+BA.-<*\^G(JQ=G0
Case "amazon.it" 'SP[AY1C<H);P,5+U3R]SBM7,:5@:K?VA@JL^*F*I1C@^HQ7YV
get_MarketPlace = "APJ6JRA9NG5V4" 'A-LRA(EIW97I<EKL0M[R[08O5\\VY2Z.
Case "A1VC38T7YXB528" '9BZ*Q,JMR>Q1[9+8K0X0?ZA^?RO31L^RG=7R5NI2\TL+
get_MarketPlace = "amazon.jp" '60051D\=8L4N:*[7M^<<AO6WRA.25^(:O790
Case "amazon.jp" 'UU+GCS?]/LNPC^V1L7WP=-I-M9,JFGV[30OT9VR=H<DBHR96W
get_MarketPlace = "A1VC38T7YXB528" '1LY66RQ=0G.6WLAG4(6\+V,O6Z*HCX@
Case "AAHKV2X7AFYLW" 'L\.=CY1UK4*ZBL+(\3Y@17QV6;WW>H2[6(9I<KPO2+52]
get_MarketPlace = "amazon.cn" ':?^NBU:0YDSI:\<84RY.YJXQ:EU0S?E++U^)
Case "amazon.cn" '^MM11]NX.06)9Y5NU,UT3-J,JA[28I59-(\P?AAW>N<=54+SU
get_MarketPlace = "AAHKV2X7AFYLW" 'P.?UGR8+JCM;J0Y<T1C)QV8?D(L]-R*]
Case Else 'U8]=STI;HLH+V+09??W+Y5*R*/L6V34CJI-[=;*XC>[5F*TAF<0P439?
get_MarketPlace = "UNKNOWN" 'AYW=]C^@R8,XGWTRZ*U47*Y^6E:33/IHW,3JA7
End Select 'X05I<EZF\R>QG@**;><J1?0]7+TO5SW^6AZZCXG?UOY0RLZURRBPG19
End Function '(SZ84\2>;9]GD/Y)SO5[AO=4IFAKR+0-*F\4;XB4V+/]UU^5LJ]?+
Function get_aws(mpInput As String) As String 'DT^D+J:7M>=3X0>IFP.9
Const a As String = "CAKIAIF7YEQAGQY7OBOHAAKIAILM2NHDVOPIOV7PQR" 'V
Select Case mpInput '.KPR?,CG+>.09^I7>A+A@[71C:D=6+K<FX?H<+.0/Q6/*N
Case "A1F83G8C2ARO7P", "A1PA6795UKMFR9", "A1RKKUPIHCS9HS", "A13V1IB3VIYZZH", "APJ6JRA9NG5V4" '
get_aws = Mid(a, 2, 20) 'IV<*C+<@8](KIE)O9]8<9;4HN6GG^[5TR>JCC/]1HM
Case "ATVPDKIKX0DER", "A2EUQ1WTGCTBG2", "ATVPDKIKX0DER" 'Y3^]WDKA0K
get_aws = Mid(a, 22, 20) 'I5MHI,*05=H7VYD=(50K]95X/GIINV-=U6M=U?U4P
Case "A21TJRUUN4KGV", "A1VC38T7YXB528", "AAHKV2X7AFYLW" '7\9K;<933?
get_aws = "UNKNOWN" 'G7>;]DHA)</K02<-IN@?:N3*X*APQU3AWU>A;5TEEJ,O6+
Case Else 'R<BFM*KY:.?R;>Q@OC17,]7I8V9S18+C@H)9/9QJ\UFI2Y9IHROMQ6FD
get_aws = "UNKNOWN" 'GQGKT>SONP2R+5\U425Z66OLRQ8UOY4;F;3GJ/+JVK?2C]
End Select ')0?FFR*>+9IDH:ZRG?P0+5Q\:MS)SB3IY[K(L](\,8HT*+G9>DP@9,>
End Function '7=F98T9<>V>OL>\KD4HQAY7LX7<(8^QGI6CSW-E>,@NC>[^HEI,27
Function get_was(mpInput As String) As String '?G*F3\[^V>T^61N(:N..
Const a As String = "FAZbybKOFFPqR0/j43S9qxl8zgvArW4p2979lVmqS6czEO3M/bKKdVzmXsvQM/p8Z73XgA9ofy5X04UM+S3v/d"
Select Case mpInput '=29>0J-3NC2^A(?7QYU1-(0<2]WGP/6)USS:@FTG33<G:E
Case "A1F83G8C2ARO7P", "A1PA6795UKMFR9", "A1RKKUPIHCS9HS", "A13V1IB3VIYZZH", "APJ6JRA9NG5V4" '
get_was = Mid(a, 2, 40) '@,>:O9S0H\5[.^JHYG5W,@Q5<=D6G3,Y.KY4\V@CRU
Case "ATVPDKIKX0DER", "A2EUQ1WTGCTBG2", "ATVPDKIKX0DER" '1;(PV7N>TP
get_was = Mid(a, 44, 40) ']TMYX>.\SN>(11D>-7KVC2Y<9R3@4XI<=WH[D:W66
Case Else '=YQ,JO(?>7^TN>P7;?[.K;-2,?\EC]3<=7C/D]FZL@N+QNC049S*DQT9
get_was = "UNKNOWN" '?ETE?C4JBMX<880E4H;XB2MQIS0T3\++S<A..1*OEF3AQQ
End Select '-@7WQ7M6,)9S84B6:*B3WHQ[:E,J>\.ZJ;0B4^/):FZE>VULO^:C>N1
End Function '5]+=<B0B6JE0[KC=-SAQHU)3,-:/(ELEU,2M@;0N[E,Q>AC3:-H1[
Private Sub Declarations(): End Sub





































































































' InQuest injected base64 decoded content
' k2-z`
' k2-z`
' k2-z`
' k2-z`
' k2-z`
' k2-z`
' k2-z`
' jw^t
' 'v+b
' 'v+b
' .+-1

INQUEST-PP=macro
