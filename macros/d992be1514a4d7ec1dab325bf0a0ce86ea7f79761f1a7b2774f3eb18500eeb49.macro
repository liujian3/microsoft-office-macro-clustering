Attribute VB_Name = "A_Union_Program_Module"
Option Explicit

Sub Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    
    Dim Pathway As String, File_Name As String, Spreadsheet_Name As String
    
    Pathway = ActiveWorkbook.Path
    File_Name = "\" & Union_Name & " " & Payroll_Month & " Dues Spreadsheet.xlsm"
    
    Application.DisplayAlerts = False
    ActiveWorkbook.SaveAs Filename:=Pathway & File_Name, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False
    Application.DisplayAlerts = True
    
    Call Format_Union_Reports(Union_Name, Payroll_Month, Spreadsheet_Name, Pathway, Number_Employees)
    Call Format_Branch(Union_Name, Payroll_Month, Number_Employees)
    Call Add_Subtotals(Number_Employees, Payroll_Month, Union_Name)
    Call Add_Raw_Data(Union_Name, Payroll_Month, Pathway)

End Sub
        
Sub Format_Union_Reports(Union_Name, Payroll_Month, Spreadsheet_Name, Pathway, Number_Employees)

    Dim Report_Name As String, Last_Row As Double

    Spreadsheet_Name = ActiveWorkbook.Name
    Pathway = ActiveWorkbook.Path

    Workbooks.Open Filename:=Pathway & "\" & Union_Name & " " & Payroll_Month & ".xlsx"
    Report_Name = ActiveWorkbook.Name
    Range("AS2").Select
    ActiveCell.FormulaR1C1 = "=TRIM(RC[-42])"
    Selection.Copy
    Last_Row = Range("A1").End(xlDown).Row
    Range("AS2:AS" & Last_Row).Select
    ActiveSheet.Paste
    Selection.Copy
    Range("C2").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Columns("AS:AS").ClearContents
    
    Range("AS2").FormulaR1C1 = "=IF(RC[-42]=R[-1]C[-42], ""Keep"", ""Insert 2 Rows"")"
    Last_Row = Range("A1").End(xlDown).Row
    Range("AS2").Select
    Selection.Copy
    Range("AS2:AS" & Last_Row).Select
    ActiveSheet.Paste
    
    Columns("A:A").Delete Shift:=xlToLeft
    Range("A1").FormulaR1C1 = "Employee #"
    Range("B1").FormulaR1C1 = "Employee Name"
    Range("C1").FormulaR1C1 = "ACCT#/CHECK#"
    Range("D1").FormulaR1C1 = "Pay Period End Date"
    Range("E1").FormulaR1C1 = "Check Date"
    Range("F1").FormulaR1C1 = "Rate"
    Columns("G:G").Delete Shift:=xlToLeft
    Columns("H:H").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("G1").FormulaR1C1 = "Regular Hours"
    Range("H1").FormulaR1C1 = "Regular Earnings"
    Columns("I:I").Delete Shift:=xlToLeft
    Columns("J:J").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("I1").FormulaR1C1 = "Overtime Hours"
    Range("J1").FormulaR1C1 = "Overtime Earnings"
    Columns("K:K").Delete Shift:=xlToLeft
    Columns("L:L").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("K1").FormulaR1C1 = "Double Hours"
    Range("L1").FormulaR1C1 = "Double Earnings"
    Columns("M:M").Delete Shift:=xlToLeft
    Range("M1").FormulaR1C1 = "HOL Hours"
    Columns("N:N").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("N1").FormulaR1C1 = "HOL Earnings"
    Columns("O:O").Delete Shift:=xlToLeft
    Columns("P:P").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("O1").FormulaR1C1 = "Vacation Hours"
    Range("P1").FormulaR1C1 = "Vaction Earnings"
    Columns("Q:Q").Delete Shift:=xlToLeft
    Range("Q1").FormulaR1C1 = "On Call Hours"
    Columns("R:R").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("R1").FormulaR1C1 = "On Call Earnings"
    Columns("S:S").Delete Shift:=xlToLeft
    Columns("T:T").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("S1").FormulaR1C1 = "Sick Hours"
    Range("T1").FormulaR1C1 = "Sick Earnings"
    Columns("U:U").Delete Shift:=xlToLeft
    Columns("V:V").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("U1").FormulaR1C1 = "Personal Hours"
    Range("V1").FormulaR1C1 = "Personal Earnings"
    Columns("W:W").Delete Shift:=xlToLeft
    Columns("X:X").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("W1").FormulaR1C1 = "PAL Hours"
    Range("X1").FormulaR1C1 = "PAL Earnings"
    Columns("Y:Y").Delete Shift:=xlToLeft
    Range("Y1").FormulaR1C1 = "BRV Hours"
    Range("Z1").FormulaR1C1 = "BRV Earnings"
    Columns("AA:AK").Delete Shift:=xlToLeft
    Columns("AA:AE").Delete Shift:=xlToLeft
    Columns("AA:AA").Cut Destination:=Columns("AP:AP")
    Columns("AA:AA").Delete Shift:=xlToLeft
    Range("A2:AO" & Last_Row).Copy

    Windows(Spreadsheet_Name).Activate
    Sheets("Template").Select
    Range("A7").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("D7:E2000").Select
    Selection.NumberFormat = "m/d/yyyy"
    Columns("B:B").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("B7").FormulaR1C1 = "=TRIM(RC[-1])"
    Last_Row = Range("A6").End(xlDown).Row
    Range("B7").Select
    Selection.Copy
    Range("B7:B" & Last_Row).Select
    ActiveSheet.Paste
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("E7:E" & Last_Row).TextToColumns Destination:=Range("E7:E" & Last_Row), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 3), TrailingMinusNumbers:=True
    Range("F7:F" & Last_Row).TextToColumns Destination:=Range("F7:F" & Last_Row), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 3), TrailingMinusNumbers:=True
    Range("G7:BF" & Last_Row).Style = "Comma"
    Range("A7:A" & Last_Row).Select
    Range("A4:A" & Last_Row).Delete Shift:=xlToLeft
    Range("A5").Value = "Employee"
    Range("A6").Value = "Name"

    Range("H7").Select
    ActiveCell.FormulaR1C1 = "=RC[-2]*RC[-1]"
    Selection.Copy
    Range("H7:H" & Last_Row).Select
    ActiveSheet.Paste
    Range("J7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*1.5*RC[-4]"
    Selection.Copy
    Range("J7:J" & Last_Row).Select
    ActiveSheet.Paste
    Range("L7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*2*RC[-6]"
    Selection.Copy
    Range("L7:L" & Last_Row).Select
    ActiveSheet.Paste
    Range("N7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*RC[-8]"
    Selection.Copy
    Range("N7:N" & Last_Row).Select
    ActiveSheet.Paste
    Range("P7").Select
    ActiveCell.FormulaR1C1 = "=RC[-10]*RC[-1]"
    Selection.Copy
    Range("P7:P" & Last_Row).Select
    ActiveSheet.Paste
    Range("R7").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=0, 0, RC[-1]*RC[-12]+R4C18)"
    Selection.Copy
    Range("R7:R" & Last_Row).Select
    ActiveSheet.Paste
    Range("T7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*RC[-14]"
    Selection.Copy
    Range("T7:T" & Last_Row).Select
    ActiveSheet.Paste
    Range("V7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*RC[-16]"
    Selection.Copy
    Range("V7:V" & Last_Row).Select
    ActiveSheet.Paste
    Range("X7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*RC[-18]"
    Selection.Copy
    Range("X7:X" & Last_Row).Select
    ActiveSheet.Paste
    Range("Z7").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]*RC[-20]"
    Selection.Copy
    Range("Z7:Z" & Last_Row).Select
    ActiveSheet.Paste

    Range("AA7").FormulaR1C1 = "=SUM(RC[-20],RC[-18], RC[-16],RC[-14],RC[-12],RC[-10],RC[-8],RC[-6],RC[-4],RC[-2])"
    Range("AB7").FormulaR1C1 = "=IF(RC[-1]>40, 40, RC[-1])"
    Range("AC7").FormulaR1C1 = "=SUM(RC[-21],RC[-19], RC[-17],RC[-15],RC[-13],RC[-11],RC[-9],RC[-7],RC[-5],RC[-3])"
    Range("AA7:AC7").Select
    Selection.Copy
    Range("AA7:AC" & Last_Row).Select
    ActiveSheet.Paste
    
    Range("A7:A2000").TextToColumns Destination:=Range("A7"), DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True
    
    If Union_Name = "BRX" Then
        Range("AD7").FormulaR1C1 = "=R4C*RC7+RC9*1.5*R4C+RC13*R4C"
        Range("AD7").Copy
        Range("AD7:AL7").Select
        ActiveSheet.Paste
        Range("AD7:AL7").Copy
        Range("AD7:AL" & Last_Row).Select
        ActiveSheet.Paste
    ElseIf Union_Name = "PHI" Then
        Range("AD7").FormulaR1C1 = "=R4C*RC27"
        Range("AE7").FormulaR1C1 = "0"
        Range("AF7").FormulaR1C1 = "=R4C*RC29"
        Range("AG7").FormulaR1C1 = "0"
        Range("AD7:AG7").Copy
        Range("AD7:AG" & Last_Row).Select
        ActiveSheet.Paste
    ElseIf Union_Name = "CHI" Then
        Range("AD7").FormulaR1C1 = "=R4C*RC7+RC9*1.5*R4C+RC13*R4C"
        Range("AD7").Copy
        Range("AD7:AL7").Select
        ActiveSheet.Paste
        Range("AF7").Value = 0
        Range("AK7").FormulaR1C1 = "=IF(VLOOKUP(RC[-36], 'CHI - Employees'!C1:C4, 4, FALSE) = 0, 0, IF(RC[-33]> VLOOKUP(RC[-36], 'CHI - Employees'!C1:C4, 4, FALSE), R4C*RC7+RC9*1.5*R4C+RC13*R4C, 0))"
        Range("AD7:AL7").Copy
        Range("AD7:AL" & Last_Row).Select
        ActiveSheet.Paste
    ElseIf Union_Name = "BOS" Then
        Range("AD7").FormulaR1C1 = "=IFERROR(IF(VLOOKUP(RC1, 'BOS - Employees'!C1:C4, 4, FALSE)= 0, 0, IF(VLOOKUP(RC1, 'BOS - Employees'!C1:C4, 4, FALSE)< RC4, RC27*R4C30, 0)), 0)"
        Range("AD7").Copy
        Range("AD7:AL7").Select
        ActiveSheet.Paste
        Range("AE7").FormulaR1C1 = "=IFERROR(IF(VLOOKUP(RC[-30], 'BOS - Employees'!C1:C4, 4, FALSE)= 0, 0, IF(VLOOKUP(RC[-30], 'BOS - Employees'!C1:C4, 4, FALSE)< RC[-27], Template!RC27*Template!R4C31, 0)), 0)"
        Range("AF7").Select
        ActiveCell.FormulaR1C1 = "=R4C*RC7+RC9*1.5*R4C+RC13*R4C"
        Selection.Copy
        Range("AF7:AL7").Select
        ActiveSheet.Paste
        Range("AD7:AL7").Copy
        Range("AD7:AL" & Last_Row).Select
        ActiveSheet.Paste
    ElseIf Union_Name = "TRE" Then
        Range("AA7").FormulaR1C1 = "=SUM(RC[-20],RC[-18]*1.5, RC[-16]*2,RC[-14],RC[-12],RC[-8],RC[-6],RC[-4],RC[-2])"
        Range("AC7").FormulaR1C1 = "=SUM(RC[-21],RC[-19], RC[-17],RC[-15],RC[-13],RC[-9],RC[-7],RC[-5],RC[-3])"
        Range("AD7").Select
        Range("AD7").FormulaR1C1 = "=R4C*RC28"
        Selection.Copy
        Range("AD7:AG7").Select
        ActiveSheet.Paste
        Range("AD7").FormulaR1C1 = "=RC7*R4C+RC13*R4C+RC15*R4C+RC19*R4C+RC21*R4C+RC23*R4C+RC25*R4C"
        Range("AE7").FormulaR1C1 = "=RC9*R4C+RC11*R4C31"
        Range("AF7").FormulaR1C1 = "=IF(VLOOKUP(RC1, 'TRE - Employees'!C19:C21, 3, FALSE) = ""X"", 0, R4C*RC29*0.01)"
        Range("AG7").FormulaR1C1 = "=IF(VLOOKUP(RC[-32], 'TRE - Employees'!C19:C21, 2, FALSE) = ""X"", 0, R4C*RC27)"
        Range("AA7:AG7").Copy
        Range("AA7:AG" & Last_Row).Select
        ActiveSheet.Paste
    End If
    
    Range("AP7").FormulaR1C1 = "=IF(RC[-40]=R[-1]C[-40], 0, 1)"
    Range("AP7").Copy
    Range("AP8:AP" & Last_Row).Select
    ActiveSheet.Paste
    Range("AQ6").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=SUM(C[-1])"
    Number_Employees = ActiveCell.Value
    Columns("AP:AQ").ClearContents

End Sub

Sub Format_Branch(Union_Name, Payroll_Month, Number_Employees)

    If Union_Name = "BRX" Then
        Call BRX_Tables_Data(Payroll_Month, Union_Name, Number_Employees)
    ElseIf Union_Name = "PHI" Then
        Call PHI_Tables_Data(Payroll_Month, Union_Name, Number_Employees)
    ElseIf Union_Name = "CHI" Then
        Call CHI_Tables_Data(Payroll_Month, Union_Name, Number_Employees)
    ElseIf Union_Name = "BOS" Then
        Call BOS_Tables_Data(Payroll_Month, Union_Name, Number_Employees)
    ElseIf Union_Name = "TRE" Then
        Call TRE_Tables_Data(Payroll_Month, Union_Name, Number_Employees)
    End If
    
End Sub

Sub Add_Subtotals(Number_Employees, Payroll_Month, Union_Name)

    Dim Current_Row As Double, x As Integer, Action_Taken As String, Current_Column As Integer, First_Row As Double
    
    Application.CutCopyMode = False
    Sheets("Template").Copy Before:=Sheets(2)
    Sheets("Template (2)").Select
    Sheets("Template (2)").Name = Payroll_Month
    Sheets(Payroll_Month).Activate
    
    Current_Row = 8

    Do Until x = Number_Employees - 1
    
        If Current_Row = 8 Then
            First_Row = 7
        End If
        
        Action_Taken = Range("AO" & Current_Row).Value
        If Action_Taken = "Keep" Then
            Current_Row = Current_Row + 1
        ElseIf Action_Taken = "Insert 2 Rows" Then
            Rows(Current_Row).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
            Rows(Current_Row).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
            Range("F" & Current_Row).Value = "Totals"
            Range("G" & Current_Row).FormulaR1C1 = "=ROUND(SUM(R" & First_Row & "C:R[-1]C), 2)"
            Range("G" & Current_Row).Copy Range("G" & Current_Row & ":AO" & Current_Row)
                        
            If Union_Name = "PHI" Then
                Range("AG" & Current_Row).FormulaR1C1 = "=R4C33"
            ElseIf Union_Name = "CHI" Then
                Range("AF" & Current_Row).FormulaR1C1 = "=R4C32*175"
            End If
            
            Range("F" & Current_Row & ":AO" & Current_Row).Font.Bold = True

            Range("G" & Current_Row & ":AO" & Current_Row).Borders(xlEdgeBottom).LineStyle = xlContinuous
            Range("G" & Current_Row & ":AO" & Current_Row).Borders(xlEdgeTop).LineStyle = xlContinuous
            Range("G" & Current_Row & ":AO" & Current_Row).Style = "Comma"
            
            Current_Row = Current_Row + 3
            First_Row = Current_Row - 1
            x = x + 1

        End If
    Loop
          
    Range("AP7").FormulaR1C1 = "=IF(SUM(RC[-32]:R2000C10)=0, ""Last Row"", """")"
    Range("AP7").Copy Range("AP8:AP2000")
    
    Columns("AP:AP").Select
    Selection.Find(What:="Last Row", After:=ActiveCell, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Current_Row = ActiveCell.Row
    
    Range("F" & Current_Row).Value = "Totals"
    Range("G" & Current_Row).FormulaR1C1 = "=ROUND(SUM(R" & First_Row & "C:R[-1]C), 2)"
    Range("G" & Current_Row).Copy Range("G" & Current_Row & ":AO" & Current_Row)
    
    If Union_Name = "PHI" Then
        Range("AG" & Current_Row).FormulaR1C1 = "=R4C33"
    ElseIf Union_Name = "CHI" Then
        Range("AF" & Current_Row).FormulaR1C1 = "=R4C32*175"
    End If

    Range("F" & Current_Row & ":AO" & Current_Row).Font.Bold = True
    Range("G" & Current_Row & ":AO" & Current_Row).Borders(xlEdgeBottom).LineStyle = xlContinuous
    Range("G" & Current_Row & ":AO" & Current_Row).Borders(xlEdgeTop).LineStyle = xlContinuous
    Current_Row = Current_Row + 2
    Range("G" & Current_Row & ":AO" & Current_Row).Style = "Comma"

    Range("F" & Current_Row).Value = "Grand Total"
    Range("G" & Current_Row).FormulaR1C1 = "=SUMIF(R7C6:R[-2]C6, ""Totals"", R7C:R[-2]C)"
    Range("G" & Current_Row).Copy Range("G" & Current_Row & ":AO" & Current_Row)
    Selection.Style = "Comma"
    Range("F" & Current_Row & ":AL" & Current_Row).Font.Bold = True
    Range("G" & Current_Row & ":AL" & Current_Row).Borders(xlEdgeBottom).LineStyle = xlContinuous
    Range("G" & Current_Row & ":AL" & Current_Row).Borders(xlEdgeTop).LineStyle = xlContinuous
    
    Columns("AH:AP").EntireColumn.Delete
    
    Current_Column = 7
    
    Do Until Current_Column > 38
    
        Columns(Current_Column).Select
        
        If Cells(Current_Row, Current_Column).Value = 0 Then
            Selection.EntireColumn.Hidden = True
            Current_Column = Current_Column + 1
        Else
            Current_Column = Current_Column + 1
        End If
        
    Loop

End Sub

Sub Add_Raw_Data(Union_Name, Payroll_Month, Pathway)

    Dim Sheet_Name As String

    Application.DisplayAlerts = False
    Workbooks.Open Filename:=Pathway & "\" & Union_Name & " " & Payroll_Month & ".xlsx"
    Application.DisplayAlerts = True
    Sheet_Name = ActiveSheet.Name
    Sheets(Sheet_Name).Name = "Raw Data"
    Sheets("Raw Data").Move Before:=Workbooks(Union_Name & " " & Payroll_Month & " Dues Spreadsheet.xlsm").Sheets(2)
    Sheets("Raw Data").Move After:=Sheets(8)
    Sheets(Payroll_Month).Activate
    
End Sub
Attribute VB_Name = "BOS_Initialize_Form"
Attribute VB_Base = "0{6E6828C3-4D62-4B3E-B2F2-2AA7153638D6}{DCECD825-0FAB-44D6-A930-34639FB583E0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub Initialize_Submit_btn_Click()

    Dim Union_Name As String, Payroll_Month As String, Number_Employees As Integer
    Dim i As Integer, j As Integer

    Sheets("Template").Visible = True
    Sheets("Tables").Visible = True
    Sheets("Template").Activate
    Range("A7:ZZ2000").ClearContents
    
    Union_Name = "BOS"
    Payroll_Month = Payroll_Month_txt.Text
    
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = Payroll_Month Then
            Sheets(Payroll_Month).Visible = True
            Sheets(Payroll_Month).Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_1
        End If
    Next i

End_Delete_1:

    For j = 1 To Worksheets.Count
        If Worksheets(j).Name = "Raw Data" Then
            Sheets("Raw Data").Visible = True
            Sheets("Raw Data").Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_2
        End If
    Next j

End_Delete_2:
    
    Unload Me
    
    Call Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    Call BOS_Formatting(Payroll_Month, Number_Employees)
    Call BOS_Prepare_Reports(Payroll_Month, Union_Name, Number_Employees)

    Sheets("Template").Visible = False
    Sheets("Tables").Visible = False
    Sheets("Initialize").Visible = True
    
    Sheets("CHI - Employees").Visible = False
    Sheets("PHI - Employees").Visible = False
    Sheets("BOS - Employees").Visible = False
    
    Sheets("Dues - PHI").Visible = False
    Sheets("PHI Form").Visible = False
    Sheets("BOS Form").Visible = True
    Sheets("TRE Form").Visible = False
    
    Sheets("BOS Form").Move Before:=Sheets(2)
    
    MsgBox "Program Completed"
    
End Sub


Private Sub UserForm_Initialize()

    Dim Date_Current As Date, Next_Update As Date
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
    
    On_Call_txt.Value = Range("B33").Value
    Dues_txt.Value = Range("B34").Value
    PAC_txt.Value = Range("B35").Value
    Welfare_txt.Value = Range("B36").Value
    App_Training_txt.Value = Range("B37").Value
    Pension_txt.Value = Range("B38").Value
    Annuity_txt.Value = Range("B39").Value
    Next_Update_txt.Value = Range("B40").Value
    
    On_Call_txt = Format(On_Call_txt, "##0.00")
    Dues_txt = Format(Dues_txt, "##0.00")
    PAC_txt = Format(PAC_txt, "##0.00")
    Welfare_txt = Format(Welfare_txt, "##0.00")
    App_Training_txt = Format(App_Training_txt, "##0.00")
    Pension_txt = Format(Pension_txt, "##0.00")
    Annuity_txt = Format(Annuity_txt, "##0.00")
    
    Date_Current = Date
    Next_Update = Next_Update_txt.Value
    
    If Next_Update > Date_Current + 30 Then
        Next_Update_txt.BackColor = vbGreen
    ElseIf Next_Update > Date_Current Then
        Next_Update_txt.BackColor = vbYellow
    Else
        Next_Update_txt.BackColor = vbRed
    End If

End Sub
Attribute VB_Name = "BRX_Initialize_Form"
Attribute VB_Base = "0{7B66FAD3-33E4-4091-A0B5-504140F74E8A}{E3F0D555-8DFB-4044-9896-D2C8C46F8214}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub Initialize_Submit_btn_Click()

    Dim Union_Name As String, Payroll_Month As String, Number_Employees As Integer
    Dim i As Integer, j As Integer

    Sheets("Template").Visible = True
    Sheets("Tables").Visible = True
    Sheets("Template").Activate
    Range("A7:ZZ2000").ClearContents
    
    Union_Name = "BRX"
    Payroll_Month = Payroll_Month_txt.Text
    
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = Payroll_Month Then
            Sheets(Payroll_Month).Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_1
        End If
    Next i
    
End_Delete_1:

    For j = 1 To Worksheets.Count
        If Worksheets(j).Name = "Raw Data" Then
            Sheets("Raw Data").Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_2
        End If
    Next j

End_Delete_2:
    
    Unload Me
    
    Call Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    Call BRX_Formatting

    Sheets("Template").Visible = False
    Sheets("Tables").Visible = False
    Sheets("Initialize").Visible = True
    
    Sheets("CHI - Employees").Visible = False
    Sheets("PHI - Employees").Visible = False
    Sheets("BOS - Employees").Visible = False
    
    Sheets("BOS Form").Visible = False
    Sheets("Dues - PHI").Visible = False
    Sheets("PHI Form").Visible = False
    Sheets("TRE Form").Visible = False
    
    MsgBox "Program Completed"
    
End Sub

Private Sub UserForm_Initialize()

    Dim Date_Current As Date, Next_Update As Date
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
    
    Annuity_Fund_txt.Value = Range("B4").Value
    Welfare_Fund_txt.Value = Range("B8").Value
    Medical_txt.Value = Range("B11").Value
    Pension_Fund_txt.Value = Range("B7").Value
    National_Training_txt.Value = Range("B12").Value
    App_Training_txt.Value = Range("B10").Value
    Vacation_Fund_txt.Value = Range("B5").Value
    Supp_Dues_txt.Value = Range("B9").Value
    PAC_txt.Value = Range("B6").Value
    Next_Update_txt.Value = Range("B13").Value
    
    Annuity_Fund_txt = Format(Annuity_Fund_txt, "##0.00")
    Welfare_Fund_txt = Format(Welfare_Fund_txt, "##0.00")
    Medical_txt = Format(Medical_txt, "##0.00")
    Pension_Fund_txt = Format(Pension_Fund_txt, "##0.00")
    National_Training_txt = Format(National_Training_txt, "##0.00")
    App_Training_txt = Format(App_Training_txt, "##0.00")
    Vacation_Fund_txt = Format(Vacation_Fund_txt, "##0.00")
    Supp_Dues_txt = Format(Supp_Dues_txt, "##0.00")
    PAC_txt = Format(PAC_txt, "##0.00")
    
    Date_Current = Date
    Next_Update = Next_Update_txt.Value
    
    If Next_Update > Date_Current + 30 Then
        Next_Update_txt.BackColor = vbGreen
    ElseIf Next_Update > Date_Current Then
        Next_Update_txt.BackColor = vbYellow
    Else
        Next_Update_txt.BackColor = vbRed
    End If

End Sub
Attribute VB_Name = "B_BRX_Code"
Option Explicit

Sub BRX_Tables_Data(Payroll_Month, Union_Name, Number_Employees)

    Dim BRX_Annuity As Double, BRX_Vacation As Double, BRX_PAC As Double, BRX_Pension As Double, BRX_Welfare As Double
    Dim BRX_Supp_Dues As Double, BRX_App As Double, BRX_Medical As Double, BRX_National As Double
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
        
    BRX_Annuity = Range("B4").Value
    BRX_Vacation = Range("B5").Value
    BRX_PAC = Range("B6").Value
    BRX_Pension = Range("B7").Value
    BRX_Welfare = Range("B8").Value
    BRX_Supp_Dues = Range("B9").Value
    BRX_App = Range("B10").Value
    BRX_Medical = Range("B11").Value
    BRX_National = Range("B12").Value
    
    Sheets("Template").Visible = True
    Sheets("Template").Activate
    
    Range("AD5").FormulaR1C1 = "Annuity"
    Range("AD6").FormulaR1C1 = "Fund"
    Range("AD4").Value = BRX_Annuity
    
    Range("AE5").FormulaR1C1 = "Pension"
    Range("AE6").FormulaR1C1 = "Fund"
    Range("AE4").Value = BRX_Pension
    
    Range("AF5").FormulaR1C1 = "Welfare"
    Range("AF6").FormulaR1C1 = "Fund"
    Range("AF4").Value = BRX_Welfare
    
    Range("AG5").FormulaR1C1 = "Medical"
    Range("AG6").FormulaR1C1 = "Reinburse"
    Range("AG4").Value = BRX_Medical
    
    Range("AH5").FormulaR1C1 = "App."
    Range("AH6").FormulaR1C1 = "Training"
    Range("AH4").Value = BRX_App
    
    Range("AI5").FormulaR1C1 = "National"
    Range("AI6").FormulaR1C1 = "Training"
    Range("AI4").Value = BRX_National
    
    Range("AJ5").FormulaR1C1 = "Vaction"
    Range("AJ6").FormulaR1C1 = "Fund"
    Range("AJ4").Value = BRX_Vacation
    
    Range("AK5").FormulaR1C1 = ""
    Range("AK6").FormulaR1C1 = "PAC"
    Range("AK4").Value = BRX_PAC
    
    Range("AL5").FormulaR1C1 = "Supp."
    Range("AL6").FormulaR1C1 = "Dues"
    Range("AL4").Value = BRX_Supp_Dues
    
    Range("AA5").FormulaR1C1 = ""
    Range("AA6").FormulaR1C1 = "Total Hours"
    Range("AB5").FormulaR1C1 = "Hours"
    Range("AB6").FormulaR1C1 = "Worked"
    Range("AC5").FormulaR1C1 = "Total"
    Range("AC6").FormulaR1C1 = "Earnings"
    
    Range("A5:AL6").Select
    Selection.HorizontalAlignment = xlCenter
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.349986266670736
    End With

End Sub

Sub BRX_Formatting()

    Range("A1:AG1").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "International Union of Operating Engineers"
    Range("A2:AG2").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "For the period of: (Insert Date Range)"
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With

End Sub
Attribute VB_Name = "CHI_Initialize_Form"
Attribute VB_Base = "0{AF0ED066-4C8E-40B3-A6AB-65548AB8AD81}{BBE42125-3423-4EE4-8B61-A97364956475}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub Initialize_Submit_btn_Click()

    Dim Union_Name As String, Payroll_Month As String, Number_Employees As Integer
    Dim i As Integer, j As Integer

    Sheets("Template").Visible = True
    Sheets("Tables").Visible = True
    Sheets("Template").Activate
    Range("A7:ZZ2000").ClearContents
    
    Union_Name = "CHI"
    Payroll_Month = Payroll_Month_txt.Text
    
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = Payroll_Month Then
            Sheets(Payroll_Month).Visible = True
            Sheets(Payroll_Month).Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_1
        End If
    Next i
    
End_Delete_1:

    For j = 1 To Worksheets.Count
        If Worksheets(j).Name = "Raw Data" Then
            Sheets("Raw Data").Visible = True
            Sheets("Raw Data").Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_2
        End If
    Next j

End_Delete_2:
    
    Unload Me
    
    Call Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    Call CHI_Formatting
    
    MsgBox "Program Completed"
    
    Sheets("Template").Visible = False
    Sheets("Tables").Visible = False
    Sheets("Initialize").Visible = True
    
    Sheets("CHI - Employees").Visible = False
    Sheets("PHI - Employees").Visible = False
    Sheets("BOS - Employees").Visible = False
    
    Sheets("BOS Form").Visible = False
    Sheets("Dues - PHI").Visible = False
    Sheets("PHI Form").Visible = False
    Sheets("TRE Form").Visible = False
    
End Sub


Private Sub UserForm_Initialize()

    Dim Date_Current As Date, Next_Update As Date
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
    
    Medical_Savings_txt.Value = Range("B23").Value
    Retirement_Fund_txt.Value = Range("B24").Value
    PAC_txt.Value = Range("B29").Value
    Pension_Fund_txt.Value = Range("B26").Value
    Welfare_Fund_txt.Value = Range("B25").Value
    Supp_Dues_txt.Value = Range("B28").Value
    App_Training_txt.Value = Range("B27").Value
    Next_Update_txt.Value = Range("B30").Value
    
    Medical_Savings_txt = Format(Medical_Savings_txt, "##0.00")
    Retirement_Fund_txt = Format(Retirement_Fund_txt, "##0.00")
    Welfare_Fund_txt = Format(Welfare_Fund_txt, "##0.00")
    Pension_Fund_txt = Format(Pension_Fund_txt, "##0.00")
    App_Training_txt = Format(App_Training_txt, "##0.00")
    Supp_Dues_txt = Format(Supp_Dues_txt, "##0.00")
    PAC_txt = Format(PAC_txt, "##0.00")
    
    Date_Current = Date
    Next_Update = Next_Update_txt.Value
    
    If Next_Update > Date_Current + 30 Then
        Next_Update_txt.BackColor = vbGreen
    ElseIf Next_Update > Date_Current Then
        Next_Update_txt.BackColor = vbYellow
    Else
        Next_Update_txt.BackColor = vbRed
    End If

End Sub
Attribute VB_Name = "C_PHI_Code"
Option Explicit

Sub PHI_Tables_Data(Payroll_Month, Union_Name, Number_Employees)

    Dim PHI_Annuity As Double, PHI_Check_Off As Double, PHI_Check_Off_Percent As Double, PHI_Welfare As Double
    Dim PHI_Supp_Dues As Double, PHI_App As Double, PHI_Medical As Double, PHI_National As Double, Last_Row As Double
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
        
    PHI_Annuity = Range("B16").Value
    PHI_Check_Off = Range("B17").Value
    PHI_Check_Off_Percent = Range("B18").Value
    PHI_Welfare = Range("B19").Value
    
    Sheets("Template").Visible = True
    Sheets("Template").Activate
    
    Range("AD5").FormulaR1C1 = "Annuity"
    Range("AD6").FormulaR1C1 = "Fund"
    Range("AD4").Value = PHI_Annuity
    
    Range("AE5").FormulaR1C1 = "Check"
    Range("AE6").FormulaR1C1 = "Off"
    Range("AE4").Value = PHI_Check_Off
    
    Range("AF5").FormulaR1C1 = "Check"
    Range("AF6").FormulaR1C1 = "Off %"
    Range("AF4").Value = PHI_Check_Off_Percent
    
    Range("AG5").FormulaR1C1 = """"
    Range("AG6").FormulaR1C1 = "Welfare"
    Range("AG4").Value = PHI_Welfare
    
    Range("AA5").FormulaR1C1 = ""
    Range("AA6").FormulaR1C1 = "Total Hours"
    Range("AB5").FormulaR1C1 = "Hours"
    Range("AB6").FormulaR1C1 = "Worked"
    Range("AC5").FormulaR1C1 = "Total"
    Range("AC6").FormulaR1C1 = "Earnings"
    
    Range("A5:AL6").Select
    Selection.HorizontalAlignment = xlCenter
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.349986266670736
    End With
    
End Sub

Sub PHI_Formatting()

    Range("A1:AL1").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "Midwest Operating Engineers"
    Range("A2:AL2").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "For the period of: (Insert Date Range)"
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With

End Sub

Sub PHI_Prepare_Reports(Payroll_Month, Union_Name)

    Dim Last_Row As Double, Current_Row As Double
    
    Sheets("PHI Form").Visible = True
    Sheets("PHI Form").Activate
    
    Range("F4").FormulaR1C1 = "=SUMIF(" & Payroll_Month & "!R3C1:R2000C1, 'PHI Form'!RC3, " & Payroll_Month & "!R3C29:R2000C29)"
    Range("Q4").FormulaR1C1 = "=SUMIF(" & Payroll_Month & "!R3C2:R2000C2, '" & Union_Name & " Form'!RC1, " & Payroll_Month & "!R3C28:R2000C28)"
    Range("S4").FormulaR1C1 = "=RC[-2]*" & Payroll_Month & "!R4C30"
    Range("F4:S4").Select
    Selection.Copy
    Range("F4:S20").Select
    ActiveSheet.Paste
    Range("Q3").FormulaR1C1 = "=""Hrs. @ $"" & TEXT(" & Payroll_Month & "!R[1]C[13], ""#.00"")"
    Range("J29").FormulaR1C1 = "=COUNTIF(R[-25]C[-4]:R[-9]C[-4], "">0"")"
    Range("M29").FormulaR1C1 = "=" & Payroll_Month & "!R4C33"
    Range("O29").FormulaR1C1 = "=RC[-5]*RC[-2]"
    Range("O31").FormulaR1C1 = "=R[-10]C[4]"
    Range("O33").FormulaR1C1 = "=SUM(R[-4]C:R[-1]C)"
    Range("K34").FormulaR1C1 = "=" & Payroll_Month & "!R[-30]C[21]"
    Range("M34").FormulaR1C1 = "=R[-13]C[-7]"
    Range("O34").FormulaR1C1 = "=RC[-4]*RC[-2]"
    Sheets(Payroll_Month).Name = Payroll_Month
    Last_Row = Range("A3").End(xlDown).Row
    Range("B4:B" & Last_Row).Copy
    
    Sheets("Dues - PHI").Visible = True
    Sheets("Dues - PHI").Activate
    Range("A12").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Sheets("PHI Form").Activate
    Range("A4:A" & Last_Row).Copy
    Sheets("Dues - PHI").Activate
    Range("B12").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Range("C12").FormulaR1C1 = "=IFERROR(IF(VLOOKUP(RC[-1],'PHI - Employees'!C2:C4,3,FALSE)=0,0,IF(VLOOKUP('Dues - PHI'!RC[-1],'PHI - Employees'!R2C2:R13C4,3,FALSE)<MIN(" & Payroll_Month & "!R[-5]C[1]:R[1988]C[1])," & Payroll_Month & "!R4C31,0)), 0)"
    Range("C12").Select
    Selection.Copy
    Last_Row = Range("A11").End(xlDown).Row
    Range("C12:C" & Last_Row).Select
    ActiveSheet.Paste

    Range("A11").End(xlDown).Offset(1, 2).Select
    ActiveCell.FormulaR1C1 = "=SUM(R12C3:R" & Last_Row & "C3)"
    Selection.Borders(xlEdgeTop).LineStyle = xlContinuous
    Selection.Borders(xlEdgeBottom).LineStyle = xlDouble
    ActiveCell.Offset(0, -1).Select
    Selection.Value = "Total"
    Selection.Font.Bold = True
    Selection.HorizontalAlignment = xlRight
    
    Current_Row = 12
    
    Do Until Current_Row > Last_Row
        Rows(Current_Row).Select
        If Range("C" & Current_Row).Value = 0 Then
            Selection.EntireRow.Delete
            Last_Row = Last_Row - 1
        Else
            Current_Row = Current_Row + 1
        End If
    Loop
    
End Sub
Attribute VB_Name = "D_CHI_Code"
Option Explicit

Sub CHI_Tables_Data(Payroll_Month, Union_Name, Number_Employees)

    Dim CHI_Medical_Savings As Double, CHI_Retirement_Fund As Double, CHI_PAC As Double, CHI_Pension As Double, CHI_Welfare As Double
    Dim CHI_Supp_Dues As Double, CHI_App As Double, CHI_Medical As Double, CHI_National As Double
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
        
    CHI_Medical_Savings = Range("B23").Value
    CHI_Retirement_Fund = Range("B24").Value
    CHI_PAC = Range("B29").Value
    CHI_Pension = Range("B26").Value
    CHI_Welfare = Range("B25").Value
    CHI_Supp_Dues = Range("B28").Value
    CHI_App = Range("B27").Value
    
    Sheets("Template").Visible = True
    Sheets("Template").Activate
    
    Range("AD5").FormulaR1C1 = "Medical"
    Range("AD6").FormulaR1C1 = "Savings"
    Range("AD4").Value = CHI_Medical_Savings
    
    Range("AE5").FormulaR1C1 = "Pension"
    Range("AE6").FormulaR1C1 = "Fund"
    Range("AE4").Value = CHI_Pension
    
    Range("AF5").FormulaR1C1 = "Welfare"
    Range("AF6").FormulaR1C1 = "Fund"
    Range("AF4").Value = CHI_Welfare
    
    Range("AG5").FormulaR1C1 = "Retirement"
    Range("AG6").FormulaR1C1 = "Fund"
    Range("AG4").Value = CHI_Retirement_Fund
    
    Range("AH5").FormulaR1C1 = "App."
    Range("AH6").FormulaR1C1 = "Training"
    Range("AH4").Value = CHI_App
    
    Range("AK5").FormulaR1C1 = ""
    Range("AK6").FormulaR1C1 = "PAC"
    Range("AK4").Value = CHI_PAC
    
    Range("AL5").FormulaR1C1 = """"
    Range("AL6").FormulaR1C1 = "Dues"
    Range("AL4").Value = CHI_Supp_Dues
    
    Range("AA5").FormulaR1C1 = ""
    Range("AA6").FormulaR1C1 = "Total Hours"
    Range("AB5").FormulaR1C1 = "Hours"
    Range("AB6").FormulaR1C1 = "Worked"
    Range("AC5").FormulaR1C1 = "Total"
    Range("AC6").FormulaR1C1 = "Earnings"
    
    Range("A5:AL6").Select
    Selection.HorizontalAlignment = xlCenter
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.349986266670736
    End With

End Sub

Sub CHI_Formatting()

    Range("A1:AG1").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "International Union of Operating Engineers"
    Range("A2:AG2").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "For the period of: (Insert Date Range)"
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With

End Sub



Attribute VB_Name = "E_BOS_Code"
Option Explicit

Sub BOS_Tables_Data(Payroll_Month, Union_Name, Number_Employees)

    Dim BOS_Medical_Savings As Double, BOS_Retirement_Fund As Double, BOS_PAC As Double, BOS_Pension As Double, BOS_Welfare As Double
    Dim BOS_Dues As Double, BOS_App As Double, BOS_Medical As Double, BOS_National As Double, BOS_On_Call As Double, BOS_Annuity As Double
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
        
    BOS_On_Call = Range("B33").Value
    BOS_Dues = Range("B34").Value
    BOS_PAC = Range("B35").Value
    BOS_Welfare = Range("B36").Value
    BOS_App = Range("B37").Value
    BOS_Pension = Range("B38").Value
    BOS_Annuity = Range("B39").Value
    
    Sheets("Template").Visible = True
    Sheets("Template").Activate
    
    Range("R4").Value = BOS_On_Call
    
    Range("AD5").FormulaR1C1 = ""
    Range("AD6").FormulaR1C1 = "Dues"
    Range("AD4").Value = BOS_Dues
    
    Range("AE5").FormulaR1C1 = ""
    Range("AE6").FormulaR1C1 = "PAC"
    Range("AE4").Value = BOS_PAC
    
    Range("AF5").FormulaR1C1 = "Welfare"
    Range("AF6").FormulaR1C1 = "Fund"
    Range("AF4").Value = BOS_Welfare
    
    Range("AG5").FormulaR1C1 = "Apprentice"
    Range("AG6").FormulaR1C1 = "Training"
    Range("AG4").Value = BOS_App
    
    Range("AH5").FormulaR1C1 = "Pension"
    Range("AH6").FormulaR1C1 = "Fund"
    Range("AH4").Value = BOS_Pension
    
    Range("AI5").FormulaR1C1 = ""
    Range("AI6").FormulaR1C1 = "Annuity"
    Range("AI4").Value = BOS_Annuity
    
    Range("AA5").FormulaR1C1 = ""
    Range("AA6").FormulaR1C1 = "Total Hours"
    Range("AB5").FormulaR1C1 = "Hours"
    Range("AB6").FormulaR1C1 = "Worked"
    Range("AC5").FormulaR1C1 = "Total"
    Range("AC6").FormulaR1C1 = "Earnings"
    
    Range("A5:AL6").Select
    Selection.HorizontalAlignment = xlCenter
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.349986266670736
    End With

End Sub

Sub BOS_Formatting(Payroll_Month, Number_Employees)

    Dim Last_Row As Double, Payroll_Year As Integer
    
    Range("A1:AC1").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "(Insert Union Name Here)"
    Range("A2:AC2").Select
    Selection.HorizontalAlignment = xlCenter
    Selection.Merge
    ActiveCell.FormulaR1C1 = "For the period of: (Insert Date Range)"
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With

End Sub
    
Sub BOS_Prepare_Reports(Payroll_Month, Union_Name, Number_Employees)

    Dim Last_Row As Double, Payroll_Year As Integer
    
    Sheets("BOS Form").Visible = True
    Sheets("BOS Form").Select
    Sheets("Tables").Visible = True
    Sheets("BOS Form").Select
    Range("D21").FormulaR1C1 = "=Tables!R[15]C[-2]"
    Range("D22").FormulaR1C1 = "=Tables!R[16]C[-2]"
    Range("D23").FormulaR1C1 = "=Tables!R[14]C[-2]"
    Range("D24").FormulaR1C1 = "=Tables!R[15]C[-2]"
    Range("E21").FormulaR1C1 = "=R1C13*RC[-1]"
    Range("E22").FormulaR1C1 = "=R1C13*RC[-1]"
    Range("E23").FormulaR1C1 = "=R1C13*RC[-1]"
    Range("E24").FormulaR1C1 = "=R[-11]C[3]*RC[-1]"
    Range("E30").FormulaR1C1 = "=R[-4]C+R[-2]C+R[-1]C"
    Range("E32").FormulaR1C1 = "=SUMIF(" & Payroll_Month & "!R[-25]C[1]:R[1968]C[1], ""Grand Total"", " & Payroll_Month & "!R[-25]C[25]:R[1968]C[25])"
    Range("E33").FormulaR1C1 = "=SUMIF(" & Payroll_Month & "!R[-25]C[1]:R[1968]C[1], ""Grand Total"", " & Payroll_Month & "!R[-25]C31:R[1967]C31)"

    Range("E36").FormulaR1C1 = "=SUM(R[-6]C:R[-1]C)"
    Columns("K:P").EntireColumn.AutoFit
    Sheets(Payroll_Month).Select
    Columns("F:F").Select
    Selection.Find(What:="Grand Total", After:=ActiveCell, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
    Last_Row = ActiveCell.Row
    
    Sheets("BOS Form").Select
    Range("M1").FormulaR1C1 = "=" & Payroll_Month & "!R" & Last_Row & "C28"
    Range("H13").FormulaR1C1 = "=" & Payroll_Month & "!R" & Last_Row & "C27"
    Range("J13").FormulaR1C1 = "=" & Payroll_Month & "!R" & Last_Row & "C9"
    Range("H15").FormulaR1C1 = "=" & Payroll_Month & "!R" & Last_Row & "C29"
    Range("J15").FormulaR1C1 = Number_Employees
    
    Sheets(Payroll_Month).Activate
    Range("AO7").Activate
    Range("AN7").FormulaR1C1 = "=MAX(RC[-35]:R[1993]C[-35])"
    Range("AO7").FormulaR1C1 = "=YEAR(RC[-1])"
    'Range("A07").Value = Format(Number, "###")
    Payroll_Year = Range("AO7").Value
    Range("AN7:AO7").ClearContents
    Sheets("BOS Form").Activate
    Range("I11").Value = Payroll_Month & ", " & Payroll_Year
    Sheets(Payroll_Month).Activate
    Columns("AK:AL").EntireColumn.Delete
    
End Sub





Attribute VB_Name = "F_TRE_Code"
Option Explicit

Sub TRE_Tables_Data(Payroll_Month, Union_Name, Number_Employees)

    Dim TRE_Annuity_OT As Double, TRE_Working_Asses As Double, TRE_PAC As Double, TRE_Pension As Double, TRE_Welfare As Double
    Dim TRE_Dues As Double, TRE_App As Double, TRE_Medical As Double, TRE_National As Double, TRE_On_Call As Double, TRE_Annuity As Double
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
        
    TRE_Annuity = Sheets("Tables").Range("B43").Value
    TRE_Annuity_OT = Sheets("Tables").Range("B44").Value
    TRE_Working_Asses = Sheets("Tables").Range("B45").Value
    TRE_PAC = Sheets("Tables").Range("B46").Value
    TRE_Welfare = Sheets("Tables").Range("B47").Value
    
    Sheets("Template").Visible = True
    Sheets("Template").Activate
    
    Sheets("Template").Range("R4").Value = TRE_On_Call
    
    Sheets("Template").Range("AD5").FormulaR1C1 = ""
    Sheets("Template").Range("AD6").FormulaR1C1 = "Annuity"
    Sheets("Template").Range("AD4").Value = TRE_Annuity
    
    Sheets("Template").Range("AE5").FormulaR1C1 = "Annuity"
    Sheets("Template").Range("AE6").FormulaR1C1 = "Overtime"
    Sheets("Template").Range("AE4").Value = TRE_Annuity_OT
    
    Sheets("Template").Range("AF5").FormulaR1C1 = "Working"
    Sheets("Template").Range("AF6").FormulaR1C1 = "Assess."
    Sheets("Template").Range("AF4").Value = TRE_Working_Asses
    
    Sheets("Template").Range("AG5").FormulaR1C1 = ""
    Sheets("Template").Range("AG6").FormulaR1C1 = "PAC"
    Sheets("Template").Range("AG4").Value = TRE_PAC
       
    Sheets("Template").Range("AA5").FormulaR1C1 = ""
    Sheets("Template").Range("AA6").FormulaR1C1 = "Total Hours"
    Sheets("Template").Range("AB5").FormulaR1C1 = "Hours"
    Sheets("Template").Range("AB6").FormulaR1C1 = "Paid"
    Sheets("Template").Range("AC5").FormulaR1C1 = "Total"
    Sheets("Template").Range("AC6").FormulaR1C1 = "Earnings"
    
    Sheets("Template").Range("A5:AL6").HorizontalAlignment = xlCenter
    Sheets("Template").Range("A5:AL6").Interior.PatternColorIndex = xlAutomatic
    Sheets("Template").Range("A5:AL6").Interior.ThemeColor = xlThemeColorDark1
    Sheets("Template").Range("A5:AL6").Interior.TintAndShade = -0.349986266670736

End Sub

Sub TRE_Formatting(Payroll_Month, Number_Employees)

    Dim Last_Row As Double, Payroll_Year As Integer
    
    Range("A1:AG1").HorizontalAlignment = xlCenter
    Range("A1:AG1").Merge
    Range("A1:AG1").FormulaR1C1 = "Operating Engineers Local 825 Employee Benefit Fund"
    Range("A2:AG2").HorizontalAlignment = xlCenter
    Range("A2:AG2").Merge
    Range("A2:AG2").FormulaR1C1 = "For the period of: (Insert Date Range)"
    Range("A2:AG2").Interior.Pattern = xlSolid
    Range("A2:AG2").Interior.PatternColorIndex = xlAutomatic
    Range("A2:AG2").Interior.Color = 65535

    
End Sub
    
Sub TRE_Prepare_Reports(Payroll_Month, Union_Name, Number_Employees)
    
    Dim Last_Row As Double, Payroll_Year As Integer

    Sheets("TRE Form").Visible = True
    Sheets("TRE - Employees").Visible = True
    Sheets("Tables").Visible = True
    
    Sheets(Payroll_Month).Activate
    Range("AK4").FormulaR1C1 = "=MIN(R[3]C[-33]:R[1996]C[-33])"
    Range("AL4").FormulaR1C1 = "=MONTH(RC[-1])"
    Range("AM4").FormulaR1C1 = "=DAY(RC[-2])"
    Range("AN4").FormulaR1C1 = "=YEAR(RC[-3])"
    Range("AK5").FormulaR1C1 = "=MAX(R[2]C[-33]:R[1995]C[-33])"
    Range("AL5").FormulaR1C1 = "=MONTH(RC[-1])"
    Range("AM5").FormulaR1C1 = "=DAY(RC[-2])"
    Range("AN5").FormulaR1C1 = "=YEAR(RC[-3])"

    Sheets("TRE Form").Select
    
    Range("R29:Y29").Select
    Range("R29:Y29").FormulaR1C1 = "=Tables!R[18]C[-16]"
    Range("R29:Y29").Value = Range("R29:Y29").Value
    Range("AH29:AK29").FormulaR1C1 = Number_Employees
    Range("AM29:AR29").FormulaR1C1 = "=RC[-21]*RC[-5]"

    Range("O20:R20").FormulaR1C1 = "=" & Payroll_Month & "!R[-16]C[23]"
    Range("S20:V20").FormulaR1C1 = "=" & Payroll_Month & "!R[-16]C[20]"
    Range("W20:Z20").FormulaR1C1 = "=" & Payroll_Month & "!R[-16]C[17]"
    Range("AB20:AE20").FormulaR1C1 = "=" & Payroll_Month & "!R[-15]C[10]"
    Range("AF20:AI20").FormulaR1C1 = "=" & Payroll_Month & "!R[-15]C[7]"
    Range("AJ20:AM20").FormulaR1C1 = "=" & Payroll_Month & "!R[-15]C[4]"
    Range("O20:AM20").Value = Range("O20:AM20").Value
    
    Range("O104:R104").FormulaR1C1 = "=" & Payroll_Month & "!R[-100]C[23]"
    Range("S104:V104").FormulaR1C1 = "=" & Payroll_Month & "!R[-100]C[20]"
    Range("W104:Z104").FormulaR1C1 = "=" & Payroll_Month & "!R[-100]C[17]"
    Range("AB104:AE104").FormulaR1C1 = "=" & Payroll_Month & "!R[-99]C[10]"
    Range("AF104:AI104").FormulaR1C1 = "=" & Payroll_Month & "!R[-99]C[7]"
    Range("AJ104:AM104").FormulaR1C1 = "=" & Payroll_Month & "!R[-99]C[4]"
    Range("O104:AM104").Value = Range("O104:AM104").Value
    
    Range("R33:U33").FormulaR1C1 = "=" & Payroll_Month & "!R[-29]C[12]"
    Range("V33:Y33").FormulaR1C1 = "=""/"" &" & Payroll_Month & "!R[-29]C[9]"
    Range("U35:Y35").FormulaR1C1 = "=" & Payroll_Month & "!R[-31]C[12]"
    Range("U37:Y37").FormulaR1C1 = "=" & Payroll_Month & "!R[-33]C[11]"
    Range("AH35:AK35").FormulaR1C1 = "=SUMIFS(" & Payroll_Month & "!R7C27:R2000C27, " & Payroll_Month & "!R7C6:R2000C6, ""Totals"", " & Payroll_Month & "!R7C33:R2000C33, "">0"")"
    Range("AF37:AK37").FormulaR1C1 = "=SUMIFS(" & Payroll_Month & "!R7C29:R2000C29, " & Payroll_Month & "!R7C6:R2000C6, ""Totals"", " & Payroll_Month & "!R7C32:R2000C32, "">0"")"
    Range("AM33:AR33").FormulaR1C1 = "=SUMIF(" & Payroll_Month & "!R[-26]C[-33]:R[1967]C[-33], ""Grand Total"", " & Payroll_Month & "!R[-26]C[-9]:R[1967]C[-9])+ SUMIF(" & Payroll_Month & "!R[-26]C[-33]:R[1967]C[-33], ""Grand Total"", " & Payroll_Month & "!R[-26]C[-8]:R[1967]C[-8])"
    Range("AM34:AR34").FormulaR1C1 = "=SUM(R[-6]C:R[-1]C[5])"
    Range("AM35:AR35").FormulaR1C1 = "=RC[-18]*RC[-5]"
    Range("AM37:AR37").FormulaR1C1 = "=RC[-18]*RC[-7]*0.01"
    Range("AM39:AR39").FormulaR1C1 = "=R[-4]C+R[-2]C"
    Range("AM40:AR40").FormulaR1C1 = "=SUM(R[-6]C, R[-1]C)"

    Application.DisplayAlerts = False
    Sheets("TRE - Employees").Range("B2:R19").Copy Sheets("TRE Form").Range("A64:H81")
    Sheets("TRE - Employees").Range("B20:R31").Copy Sheets("TRE Form").Range("A147:H164")
    Application.DisplayAlerts = True
    
    Sheets(Payroll_Month).Range("AK4:AN5").ClearContents
    
End Sub






Attribute VB_Name = "Module1"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Range("F4").FormulaR1C1 = "=SUMIF(October!R3C1:R2000C1, 'PHI Form'!RC3, October!R3C29:R2000C29)"
    Range("F5").Select
End Sub
Attribute VB_Name = "PHI_Initialize_Form"
Attribute VB_Base = "0{A442EA44-707F-4457-BEC7-1AE96DA5066D}{2D896202-7EEE-4AEC-885C-1B238C1396C3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Sub Initialize_Submit_btn_Click()

    Dim Union_Name As String, Payroll_Month As String, Number_Employees As Integer
    Dim i As Integer, j As Integer

    Sheets("Template").Visible = True
    Sheets("Tables").Visible = True
    Sheets("Template").Activate
    Range("A7:ZZ2000").ClearContents
    
    Union_Name = "PHI"
    Payroll_Month = Payroll_Month_txt.Text
    
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = Payroll_Month Then
            Sheets(Payroll_Month).Visible = True
            Sheets(Payroll_Month).Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_1
        End If
    Next i

End_Delete_1:

    For j = 1 To Worksheets.Count
        If Worksheets(j).Name = "Raw Data" Then
            Sheets("Raw Data").Visible = True
            Sheets("Raw Data").Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_2
        End If
    Next j

End_Delete_2:
    
    Unload Me
    
    Call Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    Call PHI_Formatting
    Call PHI_Prepare_Reports(Payroll_Month, Union_Name)

    Sheets("Template").Visible = False
    Sheets("Tables").Visible = False
    Sheets("Initialize").Visible = False
    
    Sheets("CHI - Employees").Visible = False
    Sheets("BOS - Employees").Visible = False
    
    Sheets("BOS Form").Visible = False
    Sheets("TRE Form").Visible = False
    
    MsgBox "Program Completed"
    
End Sub

Sub UserForm_Initialize()

    Dim Date_Current As Date, Next_Update As Date
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
    
    Annuity_Fund_txt.Value = Range("B16").Value
    Check_Off_txt.Value = Range("B17").Value
    Check_Percent_txt.Value = Range("B18").Value
    Welfare_Fee_txt.Value = Range("B19").Value
    Next_Update_txt.Value = Range("B20").Value
    
    Annuity_Fund_txt = Format(Annuity_Fund_txt, "##0.00")
    Check_Percent_txt = Format(Check_Percent_txt, "##0.00")
    Welfare_Fee_txt = Format(Welfare_Fee_txt, "##0")
    Check_Percent_txt = Format(Range("B18").Value, "0.00%")

    Date_Current = Date
    Next_Update = Next_Update_txt.Value
    
    If Next_Update > Date_Current + 30 Then
        Next_Update_txt.BackColor = vbGreen
    ElseIf Next_Update > Date_Current Then
        Next_Update_txt.BackColor = vbYellow
    Else
        Next_Update_txt.BackColor = vbRed
    End If

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "TRE_Initialize_Form"
Attribute VB_Base = "0{B5B0FC8D-1679-479E-BA41-529DE2B459A3}{FE3DCD89-12B3-4AFF-96CF-13AB54C1C238}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton1_Click()

    Sheets("Tables").Range("B43").Value = Annuity_txt.Value
    Sheets("Tables").Range("B44").Value = Annuity_OT_txt.Value
    Sheets("Tables").Range("B45").Value = Working_Assess_txt.Value
    Sheets("Tables").Range("B46").Value = PAC_txt.Value
    Sheets("Tables").Range("B47").Value = Welfare_txt.Value
    Sheets("Tables").Range("B48").Value = Next_Update_txt.Value

End Sub

Sub Initialize_Submit_btn_Click()

    Dim Union_Name As String, Payroll_Month As String, Number_Employees As Integer
    Dim i As Integer, j As Integer

    Sheets("Template").Visible = True
    Sheets("Tables").Visible = True
    Sheets("Template").Activate
    Range("A7:ZZ2000").ClearContents

    Union_Name = "TRE"
    Payroll_Month = Payroll_Month_txt.Text
    
    For i = 1 To Worksheets.Count
        If Worksheets(i).Name = Payroll_Month Then
            Sheets(Payroll_Month).Visible = True
            Sheets(Payroll_Month).Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_1
        End If
    Next i

End_Delete_1:

    For j = 1 To Worksheets.Count
        If Worksheets(j).Name = "Raw Data" Then
            Sheets("Raw Data").Visible = True
            Sheets("Raw Data").Select
            Application.DisplayAlerts = False
            ActiveWindow.SelectedSheets.Delete
            Application.DisplayAlerts = True
            GoTo End_Delete_2
        End If
    Next j

End_Delete_2:
    
    Unload Me
    
    Call Payroll_Union_Program(Union_Name, Payroll_Month, Number_Employees)
    Call TRE_Formatting(Payroll_Month, Number_Employees)
    Call TRE_Prepare_Reports(Payroll_Month, Union_Name, Number_Employees)
    
    Sheets("Template").Visible = False
    Sheets("Tables").Visible = False
    Sheets("Initialize").Visible = True
    
    Sheets("CHI - Employees").Visible = False
    Sheets("PHI - Employees").Visible = False
    Sheets("BOS - Employees").Visible = False
    Sheets("TRE - Employees").Visible = True
    
    Sheets("BOS Form").Visible = False
    Sheets("Dues - PHI").Visible = False
    Sheets("PHI Form").Visible = False
    Sheets("TRE Form").Visible = True
    
    MsgBox "Program Completed"

End Sub

Sub UserForm_Initialize()

    Dim Date_Current As Date, Next_Update As Date
    
    Sheets("Tables").Visible = True
    Sheets("Tables").Activate
    
    Annuity_txt.Value = Range("B43").Value
    Annuity_OT_txt.Value = Range("B44").Value
    Working_Assess_txt.Value = Range("B45").Value
    PAC_txt.Value = Range("B46").Value
    Welfare_txt.Value = Range("B47").Value
    Next_Update_txt.Value = Range("B48").Value
    
    Annuity_txt = Format(Annuity_txt, "##0.00")
    Annuity_OT_txt = Format(Annuity_OT_txt, "##0.00")
    Working_Assess_txt = Format(Working_Assess_txt, "##0.00")
    PAC_txt = Format(PAC_txt, "##0.00")
    Welfare_txt = Format(Welfare_txt, "##0")

    Date_Current = Date
    Next_Update = Next_Update_txt.Value
    
    If Next_Update > Date_Current + 30 Then
        Next_Update_txt.BackColor = vbGreen
    ElseIf Next_Update > Date_Current Then
        Next_Update_txt.BackColor = vbYellow
    Else
        Next_Update_txt.BackColor = vbRed
    End If

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Utility"
Sub Open_BRX_Initialize_Form()

    BRX_Initialize_Form.Show
    
End Sub

Sub Open_PHI_Initialize_Form()

    PHI_Initialize_Form.Show
    
End Sub

Sub Open_CHI_Initialize_Form()

    CHI_Initialize_Form.Show
    
End Sub

Sub Open_BOS_Initialize_Form()

    BOS_Initialize_Form.Show
    
End Sub

Sub Open_TRE_Initialize_Form()

    TRE_Initialize_Form.Show
    
End Sub


INQUEST-PP=macro
