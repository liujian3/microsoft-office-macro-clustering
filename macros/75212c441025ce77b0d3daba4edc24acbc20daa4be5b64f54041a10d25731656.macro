Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Workbook_AddinInstall()
    Dim C As CommandBar
    If Application.Version <= 11 Then
        For Each C In Application.CommandBars
            If C.Name = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then C.Delete
        Next C
        GG = 1
        Call koutei2.Macro2(True)
    End If
End Sub

Private Sub Workbook_AddinUninstall()
    Dim C As CommandBar, D As CommandBarControl
    If Application.Version <= 11 Then
        For Each C In Application.CommandBars
            If C.Name = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then C.Delete
        Next C
        For Each D In Application.CommandBars("Worksheet Menu Bar").Controls
            If D.Caption = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then D.Delete
        Next D
        For Each C In Application.CommandBars
            If C.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
On Error Resume Next
                If C.Controls(1).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then C.Delete
On Error GoTo 0
            End If
        Next C
    End If
End Sub
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    If InStr(Application.UserName, "|fffd|X|fffd|{") = 0 _
        Or InStr(Application.UserName, "|fffd|T|fffd|j") = 0 Then Cancel = True Else MsgBox "|fffd||6d1||fffd||fffd||fffd||fffd||702||fffd|"
End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{5A41CC44-9D32-4033-B6C5-E8D4069F760B}{8F859464-DA28-4BB2-8483-63D4D5DBD4A8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Option Explicit

Private Sub CheckBox7_Click()
    QJ = CheckBox7.Value
End Sub


Private Sub ComboBox22_Change()
Dim B As Variant
B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
TextBox1.BackColor = B(ComboBox22.ListIndex)
CFT = ComboBox22.ListIndex + 1
End Sub

Private Sub TButton1_Click()
    Dim W As Worksheet, I As Long, J As Long
    If TText1.Value = "" Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
    If TCombo1.Value = "" Then MsgBox "|fffd||fffd||282||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
'    If TCombo3.ListIndex + 1 <= 0 Then MsgBox "|fffd|}|fffd|X|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
    Set W = Workbooks("KouteiMasta.xls").Sheets(1)
    J = TCombo1.ListIndex + 1
    W.Cells(65536, J).End(xlUp).Offset(1, 0).Value = WorksheetFunction.Substitute(TText1.Value, vbCr, "")
    TListBox1.AddItem TText1.Value
On Error Resume Next
    If Workbooks("KouteiMasta.xls").Saved = False Then Workbooks("KouteiMasta.xls").Save
On Error GoTo 0
End Sub

Private Sub TButton2_Click()
    Dim W As Worksheet, I As Long, J As Long, K As Long, F As Boolean
    For I = 0 To TListBox1.ListCount
        If TListBox1.Selected(I) = True Then F = True
    Next I
    If F = False Then MsgBox "|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
    If TCombo1.Value = "" Then MsgBox "|fffd||fffd||282||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
  '  If TCombo3.ListIndex + 1 <= 0 Then MsgBox "|fffd|}|fffd|X|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|": Exit Sub
    Set W = Workbooks("KouteiMasta.xls").Sheets(1)
    J = TCombo1.ListIndex + 1
    K = TListBox1.ListIndex + 2
    W.Cells(K, J).Delete Shift:=xlUp
    TListBox1.Clear
    For I = 2 To W.Cells(65536, J).End(xlUp).Row
        TListBox1.AddItem W.Cells(I, J).Value
    Next I
On Error Resume Next
    If Workbooks("KouteiMasta.xls").Saved = False Then Workbooks("KouteiMasta.xls").Save
On Error GoTo 0
End Sub

Private Sub CheckBox14_Click()
    Dim HS() As Integer, J As Integer, CE As Integer, B As Variant, HI As Integer
    Dim A As Variant, R As Range, I As Integer, K As Integer
    If RefEdit1.Value = "" Then Set R = Range("F8:DU32") Else Set R = Range(RefEdit1.Value)
    ComboBox16.Clear
    If CheckBox14.Value = True Then
        If OptionButton11.Value = True Then
            ReDim HS(0) As Integer
            B = Array(1, 2, 3, 5)
            For I = 1 To R.Columns.Count * 5 \ 30
                For J = 0 To 3
                    HI = B(J)
                    CE = (R.Columns.Count \ I) * HI \ 30
                    If CE >= 1 Then
                        If MatchR(HS, (R.Columns.Count \ CE) * HI \ 30) = False Then
                            ReDim Preserve HS(K) As Integer
                            HS(K) = (R.Columns.Count \ CE) * HI \ 30
                            K = K + 1
                        End If
                    End If
                Next J
            Next I
            For I = 0 To UBound(HS)
                ComboBox16.AddItem WorksheetFunction.Small(HS, I + 1)
            Next I
        Else
            ReDim HS(0) As Integer
            For I = R.Columns.Count To 1 Step -1
                If MatchR(HS, R.Columns.Count \ I) = False _
                    And R.Columns.Count \ I >= 7 Then
                    J = J + 1
                    ReDim Preserve HS(J) As Integer
                    HS(J) = R.Columns.Count \ I
                    ComboBox16.AddItem HS(J)
                End If
            Next I
        End If
    Else
        If OptionButton11.Value = True Then
            Call OptionButton11_Click
        Else
            Call OptionButton12_Click
        End If
    End If
    ComboBox16.ListIndex = 0
End Sub
Function MatchR(A As Variant, B As Integer) As Boolean
    Dim I As Integer
    Dim C As Integer
On Error Resume Next
    C = 0
    C = WorksheetFunction.Match(B, A, 0)
    If C > 0 Then MatchR = True
End Function

Private Sub CheckBox22_Click()
    MKU = CheckBox22.Value
End Sub

Private Sub ComboBox1_Change()
    QJ = (ComboBox1.ListIndex + 2) Mod 4
End Sub

Private Sub ComboBox14_Change()
    Call ComboBox13_Change
End Sub

Private Sub ComboBox13_Change()
    Dim D As Date, I As Integer
    If ComboBox13.Value <> "" And ComboBox14.Value <> "" Then
        ComboBox15.Clear
        D = DateSerial(ComboBox13.Value, ComboBox14.Value, 1)
        For I = 1 To Day(DateAdd("m", 1, D) - Day(DateAdd("m", 1, D)))
            ComboBox15.AddItem I
        Next I
        ComboBox15.Value = 1
    End If
End Sub

Private Sub ComboBox16_AfterUpdate()
    Call ComboBox16_DropButtonClick
End Sub

Private Sub ComboBox16_DropButtonClick()
    Dim R As Range, B As Variant, I As Integer, HI As Byte, CE As Double, J As Integer, CF As Integer
    Dim TE1 As String, TE2 As String, TE3 As String, AD As Integer, AE As Integer, CE1 As Integer, HI1 As Integer
    If Val(ComboBox16.Value) = 0 Then Exit Sub
    If RefEdit1.Value = "" Then Set R = Range("F8:DU32") Else Set R = Range(RefEdit1.Value)
    If OptionButton11.Value = True Then  '|fffd||fffd||fffd||fffd|
        B = Array(1, 2, 3, 5)
        AE = ComboBox16.Value
        For I = 1 To R.Columns.Count * 5 \ 30
            For J = 0 To 3
                HI = B(J)
                CE = (R.Columns.Count \ I) * HI \ 30
                If CE >= 1 Then
                    AD = Abs(ComboBox16.Value - (R.Columns.Count \ CE) * HI \ 30)
                    AE = WorksheetFunction.Min(AE, AD)
                    If AE = AD And (R.Columns.Count \ CE) * HI \ 30 > ComboBox16.Value Then
                        CE1 = CE
                        HI1 = HI
                    End If
                    If AD = 0 Then
                        GoTo START1
                    End If
                End If
            Next J
        Next I
        If CE1 > 0 And HI1 > 0 Then
            CE = CE1: HI = HI1
        End If
        If CE < 1 Then CE = 1
START1:
        TE1 = " |fffd||fffd||fffd||fffd||fffd||6c2||30c||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ CE) * HI \ 30, vbWide) & "|fffd||fffd||fffd||fffd|"
        TE2 = " |fffd||fffd||fffd|P|fffd||682||303|Z|fffd||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ ComboBox16.Value) * HI \ 30, vbWide) & "|fffd|Z|fffd||fffd|"
        TE3 = " |fffd||fffd||fffd|P|fffd||682||313||fffd||fffd||fffd||fffd|F" & StrConv(HI, vbWide) & "|fffd||fffd|"
        ComboBox16.ControlTipText = TE1 & TE2 & TE3
    Else  '|fffd||fffd||fffd||fffd|
        If Val(ComboBox16.Value) < 7 Then ComboBox16.Value = 7
        If Val(ComboBox16.Value) > R.Columns.Count Then ComboBox16.Value = R.Columns.Count
        HI = 1
        CE = R.Columns.Count \ ComboBox16.Value
        If CE < 1 Then CE = 1
        TE1 = " |fffd||fffd||fffd||fffd||fffd||6c2||313||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ CE) * HI, vbWide) & "|fffd||fffd|"
        TE2 = " |fffd||fffd||fffd|P|fffd||682||303|Z|fffd||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ ComboBox16.Value) * HI, vbWide) & "|fffd|Z|fffd||fffd|"
        TE3 = " |fffd||fffd||fffd|P|fffd||682||313||fffd||fffd||fffd||fffd|F" & StrConv(HI, vbWide) & "|fffd||fffd|"
        ComboBox16.ControlTipText = TE1 & TE2 & TE3
    End If
End Sub

Private Sub ComboBox17_AfterUpdate()
    If ComboBox17.Value > 30 Then ComboBox17.Value = 30
    If ComboBox17.Value <= 0 Then ComboBox17.Value = 0.75
    HTS = ComboBox17.Value
End Sub

Private Sub ComboBox20_AfterUpdate()
    HNB = ComboBox20.ListIndex
End Sub

Private Sub ComboBox21_AfterUpdate()
    HNC = ComboBox21.ListIndex
End Sub

Private Sub CommandButton1_Click()
    TText1.Value = TCombo1.Value
End Sub

Private Sub CommandButton12_Click()
    Dim A As Integer, R As Range, HI As Byte, CE As Integer, DA As Date, J As Integer
    Dim B As Variant, I As Byte, AD As Integer, AE As Integer, CE1 As Integer, HI1 As Integer
On Error GoTo ERR1
    If RefEdit1.Value = "" Then Set R = Range("F8:DU32") Else Set R = Range(RefEdit1.Value)
    If OptionButton11.Value = True Then  '|fffd||fffd||fffd||fffd||fffd||fffd|
        B = Array(1, 2, 3, 5)
        AE = ComboBox16.Value
        For I = 1 To R.Columns.Count * 5 \ 30
            For J = 0 To 3
                HI = B(J)
                CE = (R.Columns.Count \ I) * HI \ 30
                If CE >= 1 Then
                    AD = Abs(ComboBox16.Value - (R.Columns.Count \ CE) * HI \ 30)
                    AE = WorksheetFunction.Min(AE, AD)
                    If AE = AD And (R.Columns.Count \ CE) * HI \ 30 > ComboBox16.Value Then
                        CE1 = CE
                        HI1 = HI
                    End If
                    If AD = 0 Then
                        GoTo START1
                    End If
                End If
            Next J
        Next I
        If CE1 > 0 And HI1 > 0 Then
            CE = CE1: HI = HI1
        End If
START1:
        If CE < 1 Then CE = 1
        If HI = 0 Then A = 1 Else A = HI
        '|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|u|fffd|b|fffd|N|fffd||fffd||142||202||fffd||fffd||a347||fffd||302||fffd|
        If ActiveWorkbook.CodeName = "Koteihyo1" _
            Or Left(ActiveSheet.CodeName, 4) = "KT1G" Then Range("BC4").Value = HI
            DA = DateSerial(ComboBox13.Value, ComboBox14.Value, 1)
            Call koutei3.Macro2(CE - 1, R)
            Call koutei3.Macro4(A, CE, Month(DA), R)
        Else '|fffd||fffd||fffd||fffd||fffd||fffd|
            HI = 1
            CE = R.Columns.Count \ ComboBox16.Value
            If CE < 1 Then CE = 1
            If ActiveWorkbook.CodeName = "Koteihyo1" _
                Or Left(ActiveSheet.CodeName, 4) = "KT1G" Then Range("BC4").Value = HI
                DA = DateSerial(ComboBox13.Value, ComboBox14.Value, ComboBox15.Value)
                Call koutei3.Macro2(CE - 1, R)
                Call koutei3.macro3(1, CE, DA, R)
            End If
            If Left(ActiveSheet.CodeName, 4) = "KT2G" Then
                Range("A5").Value = Format(DateSerial(ComboBox13.Value, ComboBox14.Value, 1), "ggge|fffd|Nmm|fffd||fffd|")
            End If
ERR1:
End Sub

Private Sub CommandButton14_Click()
On Error Resume Next
    Application.CommandBars("|fffd|x|fffd||fffd||fffd|C|fffd||4d0||752||fffd|").Delete
On Error GoTo 0
    With Application.CommandBars.Add("|fffd|x|fffd||fffd||fffd|C|fffd||4d0||752||fffd|", Temporary:=True)
        With .Controls.Add
            .Caption = "|fffd|x|fffd||fffd||fffd||752||fffd|"
            .Style = msoButtonIconAndCaption
            .OnAction = "koutei.kyu_se"
            .FaceId = 5
        End With
        With .Controls.Add
            .Caption = "|fffd|x|fffd||fffd||fffd||fffd||fffd||fffd|"
            .Style = msoButtonIconAndCaption
            .OnAction = "koutei.kyu_ka"
            .FaceId = 6
        End With
        .Visible = True
    End With
End Sub

Private Sub ImageCombo1_Click()
'    CFT = UserForm1.ImageCombo1.SelectedItem.Index
End Sub

Private Sub OptionButton11_Click()
    Dim I As Integer, R As Range, BB As Variant
    Dim HI As Byte, CE As Integer, TE1 As String, TE2 As String, TE3 As String
    Set R = Range(RefEdit1.Value)
    ComboBox16.Style = fmStyleDropDownList
    ComboBox16.MatchRequired = True
    ComboBox15.Visible = False
    Label16.Visible = False
    Label17.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|}"
    CheckBox14.Value = False
    ComboBox16.Clear
    For I = 1 To R.Columns.Count * 5 \ 30
        ComboBox16.AddItem I
    Next I
    ComboBox16.ListIndex = 0
    BB = Array(1, 2, 3, 5)
    For I = 0 To 3
        HI = BB(I)
        CE = (R.Columns.Count \ 1) * HI \ 30
        If CE > 1 Then Exit For
    Next I
    TE1 = " |fffd||fffd||fffd||fffd||fffd||6c2||30c||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ CE) * HI \ 30, vbWide) & "|fffd||fffd||fffd||fffd|"
    TE2 = " |fffd||fffd||fffd|P|fffd||682||303|Z|fffd||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ 1) * HI \ 30, vbWide) & "|fffd|Z|fffd||fffd|"
    TE3 = " |fffd||fffd||fffd|P|fffd||682||313||fffd||fffd||fffd||fffd|F" & StrConv(HI, vbWide) & "|fffd||fffd|"
    ComboBox16.ControlTipText = TE1 & TE2 & TE3
End Sub

Private Sub OptionButton12_Click()
    Dim I As Integer, R As Range, AH As Variant
    Dim HI As Byte, CE As Integer, TE1 As String, TE2 As String, TE3 As String
    Set R = Range(RefEdit1.Value)
    ComboBox16.Style = fmStyleDropDownCombo
    ComboBox16.MatchRequired = False
    ComboBox15.Visible = True
    Label16.Visible = True
    Label17.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|}"
    CheckBox14.Value = False
    AH = Array(7, 14, 21, 31, 45, 62, 92, 123)
    ComboBox16.Clear
    For I = 0 To UBound(AH)
        If R.Columns.Count >= AH(I) Then ComboBox16.AddItem AH(I)
    Next I
    ComboBox16.ListIndex = 0
    HI = 1
    CE = R.Columns.Count \ ComboBox16.Value
    If CE < 1 Then CE = 1
    TE1 = " |fffd||fffd||fffd||fffd||fffd||6c2||313||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ CE) * HI, vbWide) & "|fffd||fffd|"
    TE2 = " |fffd||fffd||fffd|P|fffd||682||303|Z|fffd||fffd||fffd||fffd||fffd|F" & StrConv((R.Columns.Count \ ComboBox16.Value) * HI, vbWide) & "|fffd|Z|fffd||fffd|"
    TE3 = " |fffd||fffd||fffd|P|fffd||682||313||fffd||fffd||fffd||fffd|F" & StrConv(HI, vbWide) & "|fffd||fffd|"
    ComboBox16.ControlTipText = TE1 & TE2 & TE3
End Sub

Private Sub OptionButton36_Click()
    ComboBox17.Enabled = False
    HTS = 0
End Sub

Private Sub OptionButton37_Click()
    ComboBox17.Enabled = True
    If HTS = 0 Then HTS = 0.75
    ComboBox17.Value = HTS
End Sub
Private Sub OptionButton41_Click()
    CFT = 0
ComboBox22.Enabled = False
End Sub
Private Sub OptionButton42_Click()
Dim B As Variant
ComboBox22.Enabled = True
If CFT > 0 Then
B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
TextBox1.BackColor = B(CFT - 1)
ComboBox22.ListIndex = CFT - 1
Else
ComboBox22.ListIndex = 0
End If
End Sub
Private Sub TButton3_Click()
    Dim W As Worksheet, I As Long, J As Long
On Error Resume Next
    With Windows("KouteiMasta.xls")
        .Visible = Not .Visible
        If .Visible = True Then
            .Activate
        Else
            Workbooks("KouteiMasta.xls").Save
            TCombo1.Clear
            Set W = Workbooks("KouteiMasta.xls").Sheets(1)
            For I = 1 To W.Range("IV1").End(xlToLeft).Column
                TCombo1.AddItem W.Cells(1, I).Value
            Next I
            Set W = Nothing
            TCombo1.ListIndex = 0
        End If
    End With
End Sub

Private Sub TButton4_Click()
On Error Resume Next
    If Workbooks("KouteiMasta.xls").Saved = False Then Workbooks("KouteiMasta.xls").Save
On Error GoTo 0
    UserForm1.Hide
    Call koutei.Mtext
End Sub

Private Sub TCombo1_Change()
    Dim W As Worksheet, I As Long, J As Long
    Set W = Workbooks("KouteiMasta.xls").Sheets(1)
    If WorksheetFunction.CountIf(W.Range("A1:IV1"), TCombo1.Value) > 0 And TCombo1.Value <> "" Then
        TListBox1.Clear
        J = TCombo1.ListIndex + 1
        For I = 2 To W.Cells(65536, J).End(xlUp).Row
            TListBox1.AddItem W.Cells(I, J).Value
        Next I
    End If
End Sub

Private Sub TCombo2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
    TC = TCombo2.ListIndex
End Sub

Private Sub TListBox1_Click()
    TText1.Value = TListBox1.Value
End Sub

Private Sub TListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Call TButton4_Click
End Sub

Private Sub TOption1_Click()
    TCombo2.Clear
    TCombo2.List = Array("|fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd|E")
    TCombo2.ListIndex = 1
End Sub

Private Sub TOption2_Click()
    TCombo2.Clear
    TCombo2.List = Array("|fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||fffd|")
    TCombo2.ListIndex = 0
End Sub
Private Sub UserForm_Initialize()
    Dim A As Variant, B As Variant, I As Integer
    ComboBox22.List = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd||fffd||90a2||fffd||fffd|", "|fffd|s|fffd||fffd||fffd|N", "|fffd||fffd||fffd|F", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd||97||fffd|", "25|fffd||fffd||fffd|D|fffd|F", "50|fffd||fffd||fffd|D|fffd|F", "|fffd|X|fffd|J|fffd|C|fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd|y|fffd|[|fffd||fffd||fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd|[|fffd|Y", "|fffd||fffd||fffd|x|fffd||fffd||fffd|_|fffd|[", "|fffd|x|fffd|[|fffd|W|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|A|fffd|N|fffd|A", "|fffd||fffd||fffd|C|fffd||fffd|", "|fffd|S|fffd|[|fffd||fffd||fffd|h", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|u|fffd||fffd||fffd|[|fffd|O|fffd||fffd||fffd|[", "40|fffd||fffd||fffd|D|fffd|F", "|fffd|Z|fffd||fffd||fffd||97||fffd|", "|fffd|V|fffd|[|fffd|O|fffd||fffd||fffd|[|fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|I|fffd||fffd||fffd|[|fffd|u", "|fffd|v|fffd||fffd||fffd||fffd|", "|fffd|C|fffd||fffd||fffd|f|fffd|B|fffd|S", "80|fffd||fffd||fffd|D|fffd|F")
    ComboBox22.ListIndex = CFT - 1
'    ImageCombo1.ImageList = ImageList1
'    A = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd||fffd||90a2||fffd||fffd|", "|fffd|s|fffd||fffd||fffd|N", "|fffd||fffd||fffd|F", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd||97||fffd|", "25|fffd||fffd||fffd|D|fffd|F", "50|fffd||fffd||fffd|D|fffd|F", "|fffd|X|fffd|J|fffd|C|fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd|y|fffd|[|fffd||fffd||fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd|[|fffd|Y", "|fffd||fffd||fffd|x|fffd||fffd||fffd|_|fffd|[", "|fffd|x|fffd|[|fffd|W|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|A|fffd|N|fffd|A", "|fffd||fffd||fffd|C|fffd||fffd|", "|fffd|S|fffd|[|fffd||fffd||fffd|h", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|u|fffd||fffd||fffd|[|fffd|O|fffd||fffd||fffd|[", "40|fffd||fffd||fffd|D|fffd|F", "|fffd|Z|fffd||fffd||fffd||97||fffd|", "|fffd|V|fffd|[|fffd|O|fffd||fffd||fffd|[|fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|I|fffd||fffd||fffd|[|fffd|u", "|fffd|v|fffd||fffd||fffd||fffd|", "|fffd|C|fffd||fffd||fffd|f|fffd|B|fffd|S", "80|fffd||fffd||fffd|D|fffd|F")
'    B = Array(3, 1, 27, 14, 17, 6, 33, 40, 19, 4, 24, 2, 26, 12, 22, 39, 37, 29, 25, 20, 15, 30, 5, 35, 10, 28, 23, 13, 9, 8, 7, 32, 38, 21, 18, 16, 11, 34, 31, 36)
'    For I = 1 To 40
'        ImageCombo1.ComboItems.Add , , A(I - 1), "a" & B(I - 1)
'    Next I
'    If CFT > 0 Then
'        ImageCombo1.ComboItems(CFT).Selected = True
'    Else
'        ImageCombo1.ComboItems(2).Selected = True
'    End If
End Sub
Private Sub MultiPage1_Change()
'    If MultiPage1.Value = 2 Then
'        If CFT > 0 Then ImageCombo1.Enabled = True
'        ImageCombo1.Top = 120
'    Else
'        ImageCombo1.Enabled = False
'        ImageCombo1.Top = 180
'    End If
End Sub

Attribute VB_Name = "koutei"
Option Explicit
Option Private Module
Public N As Byte, CC As Byte, GG As Byte, TC As Byte, MKU As Byte, CFT As Long
Public MA As Integer, HOZ As Byte, QJ As Byte, HTS As Single, HNB As Byte, HNC As Byte, SPA As String
#If VBA7 Then
    Private Declare PtrSafe Function HtmlHelp Lib "HHCtrl.ocx" Alias "HtmlHelpA" _
        (ByVal hwndCaller As Long, ByVal pszFile As String, ByVal uCommand As Long, dwData As Any) As Long
#Else
    Private Declare Function HtmlHelp Lib "HHCtrl.ocx" Alias "HtmlHelpA" _
        (ByVal hwndCaller As Long, ByVal pszFile As String, ByVal uCommand As Long, dwData As Any) As Long
#End If

Sub macro1()
    Dim SH As Shape, X As Integer, Y As Single, S As Integer, Z As Variant, IRR As Variant
    If HOZ = 0 Then Call Yomi
    IRR = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896 _
     , 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843 _
      , 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    S = Selection.Columns(Selection.Columns.Count).Left _
        + Selection.Columns(Selection.Columns.Count).Width
    X = Selection.Left
    Y = ActiveCell.Top + ActiveCell.Height / 2
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If ActiveWindow.Zoom <> 100 And Application.Version = 12 Then
        Z = ActiveWindow.Zoom
        Application.ScreenUpdating = False
        ActiveWindow.Zoom = 100
    End If
    Set SH = ActiveSheet.Shapes.AddLine(X, Y, S, Y)
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If Z <> 0 And Application.Version = 12 Then
        ActiveWindow.Zoom = Z
        Application.ScreenUpdating = True
    End If
    If HTS > 0 Then SH.Line.Weight = HTS
    If CC = 0 Then
        SH.Line.BeginArrowheadStyle = msoArrowheadOval
        SH.Line.EndArrowheadStyle = msoArrowheadOval
    Else
        SH.Line.BeginArrowheadStyle = msoArrowheadNone
        SH.Line.EndArrowheadStyle = msoArrowheadNone
    End If
    If N = 1 Then
        SH.Line.DashStyle = msoLineDash
    ElseIf N = 0 Then
        SH.Line.DashStyle = msoLineSingle
    End If
    If CFT > 0 Then
        SH.Line.ForeColor.RGB = IRR(CFT - 1) '+ 7
    Else
        If Application.Version >= 12 Then
            SH.Line.ForeColor.SchemeColor = 8
        End If
    End If
    '    If Application.Version >= 12 Then
    '        SH.Line.ForeColor.SchemeColor = 0
    '    End If
    If MKU <> 0 Then
        SH.Select
        Call koutei.macro3
    End If
    Set SH = Nothing
End Sub
Sub macro3()
    Dim I As Integer, A As Workbook, WA As Workbook
    Dim M As Integer, FRG As Byte
    If HOZ = 0 Then Call Yomi
    Set A = ActiveWorkbook
    If Dir(SPA & "\KouteiMasta.xls", vbNormal) = "" Then
        Call koutei.masta(M)
        If M = vbNo Then Unload UserForm1: GoTo START2
    Else
        For Each WA In Workbooks
            If WA.Name = "KouteiMasta.xls" Then GoTo START1
        Next WA
        Workbooks.Open Filename:=SPA & "\KouteiMasta.xls"
        A.Activate
    End If
START1:
    Unload UserForm1
    For I = 1 To Workbooks("KouteiMasta.xls").Sheets(1).Range("IV1").End(xlToLeft).Column
        UserForm1.TCombo1.AddItem Workbooks("KouteiMasta.xls").Sheets(1).Cells(1, I).Value
    Next I
    UserForm1.TCombo1.ListIndex = 0
START2:
    With UserForm1
        .TOption1 = True
        .Width = 297.75
        .Height = 156.75
        .MultiPage1.Width = 297.75
        .MultiPage1.Height = 156.75
        .TCombo2.ListIndex = TC
        With .MultiPage1
            .Page2.Visible = False
            .Page4.Visible = False
        End With
        .Caption = "|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd|"
        If Application.Version > 8 Then
            .Show vbModeless
            .MultiPage1.Value = 2
            .MultiPage1.Page1.Visible = False
        Else
            .MultiPage1.Page1.Visible = False
            .Show
        End If
    End With
End Sub
Sub Mtext()
    Dim T As String, T2 As Integer, B As Shape, X As Double
    Dim Y As Double, TY As Byte, I As Integer, A As Variant, Z As Variant
    T = WorksheetFunction.Substitute(UserForm1.TText1.Value, vbCr, "")
    'If UserForm1.TOption2 = True Then _
    TY = msoTextOrientationVerticalFarEast Else TY = msoTextOrientationHorizontal
    If UserForm1.TOption2 = True Then
        TY = msoTextOrientationVerticalFarEast
        If UserForm1.TCombo2.ListIndex = 1 Then
            I = xlVAlignCenter
        ElseIf UserForm1.TCombo2.ListIndex = 0 Then
            I = xlVAlignTop
        Else
            I = xlVAlignBottom
        End If
    Else
        TY = msoTextOrientationHorizontal
        If UserForm1.TCombo2.ListIndex = 1 Then
            I = xlHAlignCenter
        ElseIf UserForm1.TCombo2.ListIndex = 0 Then
            I = xlHAlignLeft
        Else
            I = xlHAlignRight
        End If
    End If
    Unload UserForm1
    If T = "" Then Exit Sub
    A = Split(T, vbLf)
    For I = 0 To UBound(A)
        T2 = WorksheetFunction.Max(T2, LenB(A(I)))
    Next I
    X = Selection.Left
    Y = Selection.Top + Selection.Height / 2 - 15
    If TY = msoTextOrientationVerticalFarEast Then Y = ActiveCell.Top
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If ActiveWindow.Zoom <> 100 And Application.Version = 12 Then
        Z = ActiveWindow.Zoom
        Application.ScreenUpdating = False
        ActiveWindow.Zoom = 100
    End If
    If TY = msoTextOrientationVerticalFarEast Then
        Set B = ActiveSheet.Shapes.AddTextbox(TY, X, Y, 15, 7 * T2)
    Else
        Set B = ActiveSheet.Shapes.AddTextbox(TY, X, Y, 7 * T2, 15)
    End If
    B.Visible = False
    'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
    If Application.Version >= 12 Then
        With B.TextFrame2.TextRange.Font
            .NameFarEast = ActiveCell.Font.Name
        End With
    End If
    If Application.Version <= 11 Then
        B.TextFrame.Characters.Font.Name = ActiveCell.Font.Name
    End If
    B.TextFrame.Characters.Font.Size = ActiveCell.Font.Size
    B.TextFrame.Characters.Text = T
    If Application.Version >= 14 And TY = msoTextOrientationVerticalFarEast Then
         B.TextFrame.VerticalOverflow = 0
    End If
    
    If Application.Version >= 12 Then
        If TY = msoTextOrientationVerticalFarEast Then
            B.TextFrame.MarginTop = 0
            B.TextFrame.MarginBottom = 0
            B.TextFrame.MarginLeft = Application.CentimetersToPoints(0.13)
            B.TextFrame.MarginRight = Application.CentimetersToPoints(0.13)
        Else
            B.TextFrame.MarginLeft = 0
            B.TextFrame.MarginRight = 0
        End If
    End If
    B.TextFrame.AutoSize = True
    '|fffd|}|fffd|I|fffd||fffd||fffd||fffd|
    If TypeName(Selection) = "GroupObject" _
        Or TypeName(Selection) = "Line" Or TypeName(Selection) = "TextBox" Then
        With ActiveSheet.Shapes(Selection.Name)
            B.Left = .Left + .Width / 2 - B.Width / 2
            B.Top = B.Top - B.Height / 2 + ActiveCell.Font.Size / 2
        End With
    Else '|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|
        If TY = msoTextOrientationHorizontal Then
            B.Top = B.Top + (16.5 - B.Height) - HTS / 2
        Else
            B.Top = B.Top - B.Height / 2 + ActiveCell.Font.Size / 2
        End If
    End If
    B.Fill.Visible = msoFalse
    B.Line.Visible = msoFalse
    If TY = msoTextOrientationVerticalFarEast Then
        B.TextFrame.VerticalAlignment = I
    Else
        B.TextFrame.HorizontalAlignment = I
    End If
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If Z <> 0 And Application.Version = 12 Then
        ActiveWindow.Zoom = Z
        Application.ScreenUpdating = True
    End If
    B.Visible = True
    Set B = Nothing
End Sub

Sub macro5()
    Dim FileNo As Integer
    Unload UserForm1
    If Left(ActiveSheet.CodeName, 4) <> "KT1G" And _
        Left(ActiveSheet.CodeName, 4) <> "KT2G" And ActiveWorkbook.CodeName <> "Koteihyo1" Then
        UserForm1.MultiPage1.Page1.Visible = False
        UserForm1.MultiPage1.Page2.Visible = False
    End If
    If Application.Version >= 12 Then
        UserForm1.CommandButton14.Visible = False
    End If
    If HOZ = 0 Then Call Yomi
    Call koutei.OptiY
    UserForm1.MultiPage1.Page3.Visible = False
    UserForm1.Show
On Error GoTo Error
    FileNo = FreeFile
    If Dir(SPA, vbDirectory) = "" Then MkDir SPA
    Open SPA & "\Kotnt.ini" For Output As FileNo
    Print #FileNo, N, CC, QJ, HTS, HNB, HNC, MKU, CFT
    Close #FileNo
Error:
    Close #FileNo
End Sub
Sub OptiY()
    Dim I As Integer, D As Shape
    Dim R As Range
On Error Resume Next
    With UserForm1
        If HTS = 0 Then .OptionButton36.Value = True Else .OptionButton37.Value = True
        .ComboBox17.List = Array("0.25", "0.5", "0.75", "1", "1.5", "2", "3", "5", "10")
        If HTS > 0 Then .ComboBox17.Value = HTS
        .CheckBox22.Value = MKU
            If CFT = 0 Then
                .OptionButton41 = True
            Else
                .OptionButton42 = True
            End If
        If Left(ActiveSheet.CodeName, 4) <> "KT1G" And _
            Left(ActiveSheet.CodeName, 4) <> "KT2G" And ActiveWorkbook.CodeName <> "Koteihyo1" Then Exit Sub
            .RefEdit1.Enabled = False
            'For Each D In ActiveSheet.Shapes
            '  If D.Name = "Kotei1" Then RefEdit1.Value = D.TextFrame.Characters.Text
            'Next D
            'If RefEdit1.Value = "" Then Set R = Range("F8:DU32"): RefEdit1.Value = R.Address Else Set R = Range(RefEdit1.Value)
            If Left(ActiveSheet.CodeName, 4) = "KT1G" Then
                Set R = Range("F8:DU32")
                .RefEdit1.Value = R.Address
            ElseIf Left(ActiveSheet.CodeName, 4) = "KT2G" Then
                Set R = Range("B7:AT30")
                .RefEdit1.Value = R.Address
            ElseIf ActiveWorkbook.CodeName = "Koteihyo1" Then
                Set R = Range("F8:DU32")
                .RefEdit1.Value = R.Address
            Else
                Exit Sub
            End If
            For I = Year(Date) - 4 To Year(Date) + 5
                .ComboBox13.AddItem I
            Next I
            .ComboBox13.Value = Year(Date)
            For I = 1 To 12
                .ComboBox14.AddItem I
            Next I
            .ComboBox14.Value = Month(Date)
            .ComboBox15.Value = Day(Date)
            If Left(ActiveSheet.CodeName, 4) = "KT2G" Then
                .OptionButton12.Value = True
            Else
                .OptionButton11.Value = True
            End If
            .ComboBox1.List = Array("|fffd|\|fffd||fffd||fffd||202||fffd|", "|fffd||fffd||fffd|j|fffd||fffd||fffd||302||fffd|", "|fffd|j|fffd||fffd|+|fffd||fffd||fffd|j|fffd||fffd|", "|fffd|j|fffd||fffd|+|fffd|y|fffd|j|fffd||fffd|+|fffd||fffd||fffd|j|fffd||fffd|")
            .ComboBox20.List = Array(Format(Date, "d"), Format(Date, "dd"), Format(Date, "d|fffd||fffd|"), Format(Date, "m|fffd||fffd|d|fffd||fffd|") _
                , Format(Date, "mm|fffd||fffd|dd|fffd||fffd|"), Format(Date, "m/d"), Format(Date, "mm/dd"), "|fffd||fffd||fffd||fffd||fffd|F" & Format(Date, "m|fffd||fffd|d|fffd||fffd|"), "|fffd||fffd||fffd||fffd||fffd|F" & Format(Date, "m/d"))
            If HNC > 8 Then HNC = 0
            .ComboBox20.ListIndex = HNB
            .ComboBox21.List = Array("|fffd|y|fffd|j:|fffd||81|E|fffd||fffd||fffd|j:|fffd||fffd|", "|fffd|y|fffd|j|fffd|E|fffd||fffd||fffd|j:|fffd||fffd|", "|fffd|F|fffd|\|fffd||fffd||fffd||202||fffd|")
            If HNC > 2 Then HNC = 0
            .ComboBox21.ListIndex = HNC
            If QJ > 3 Then QJ = 1
            .ComboBox1.ListIndex = (QJ + 2) Mod 4
        End With
End Sub

Sub macro6()
    If HOZ = 0 Then Call Yomi
    If N = 0 Then N = 1 Else N = 0
    If Application.Version <= 11 Then
        With Application.CommandBars("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\")
            If N = 1 Then
                .Controls("|fffd||fffd||fffd||fffd|").Visible = False
                .Controls("|fffd|_|fffd||fffd|").Visible = True
            ElseIf N = 0 Then
                .Controls("|fffd|_|fffd||fffd|").Visible = False
                .Controls("|fffd||fffd||fffd||fffd|").Visible = True
            End If
        End With
    Else
        Call koutei3.Labela1
    End If
End Sub
Sub macro7()
    If HOZ = 0 Then Call Yomi
    If CC = 0 Then CC = 1 Else CC = 0
    If Application.Version <= 11 Then
        With Application.CommandBars("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\")
            If CC = 1 Then
                .Controls("|fffd||fffd||fffd|[|fffd||fffd|").Visible = False
                .Controls("|fffd|[|fffd||fffd||fffd||202||fffd|").Visible = True
            ElseIf CC = 0 Then
                .Controls("|fffd|[|fffd||fffd||fffd||202||fffd|").Visible = False
                .Controls("|fffd||fffd||fffd|[|fffd||fffd|").Visible = True
            End If
        End With
    Else
        Call koutei3.Labela2
    End If
End Sub
Sub macro8()
    Dim P As String
    Const HH_HELP_CONTEXT = &HF
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        P = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelHelp"
    Else 'WindowsXP|fffd||702||fffd|
        P = Application.Path & "\ExcelHelp"
    End If
    Call HtmlHelp(0, P & "\|fffd|H|fffd||fffd||fffd|\|fffd|i|fffd|t|fffd||fffd||fffd|[|fffd||141|j.chm", 0, ByVal 0)
End Sub
Sub Yomi()
On Error GoTo Error
    Dim FileNo As Integer
    FileNo = FreeFile
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        SPA = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelData"
    Else 'WindowsXP|fffd||702||fffd|
        SPA = Application.Path
    End If
    If Dir(SPA & "\Kotnt.ini") = "" Then
    Else
        Open SPA & "\Kotnt.ini" For Input As FileNo
        Input #FileNo, N, CC, QJ, HTS, HNB, HNC, MKU, CFT
        Close #FileNo
    End If
    HOZ = 1
    If AddIns("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\").Installed = False Then
        N = 0: CC = 0
    End If
    Exit Sub
Error:
    Close #FileNo
    HOZ = 1
End Sub
Sub masta(M As Integer)
    Dim AW As Workbook
    Dim A As Variant, I As Integer
    M = MsgBox("|fffd|}|fffd|X|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|" _
        & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo)
    If M = vbYes Then
        Set AW = Workbooks.Add(xlWBATWorksheet)
        With Cells
            .RowHeight = 23.5
            .Font.Name = "|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|"
            .Font.Size = 10
            .VerticalAlignment = xlBottom
        End With
        Columns.ColumnWidth = 13
        A = Array("|fffd||fffd||fffd||289||fffd||fffd||74d|H|fffd||fffd|", "|fffd||fffd||fffd||689||fffd||fffd||74d|H|fffd||fffd|", "|fffd|y|fffd|H|fffd||fffd|", "|fffd|Y|fffd|n|fffd||18d|H|fffd||fffd|", "|fffd|R|fffd||fffd||fffd|N|fffd||fffd||fffd|[|fffd|g|fffd|H|fffd||fffd|", "|fffd|^|fffd|g|fffd|H|fffd||fffd|" _
            , "|fffd|S|fffd||60d|H|fffd||fffd|", "|fffd|S|fffd||fffd||fffd|H|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||778||630||10d|H|fffd||fffd|", "|fffd|h|fffd||fffd||fffd|H|fffd||fffd|", "|fffd||38d|H|fffd||fffd|", "|fffd|^|fffd|C|fffd||fffd||fffd|H|fffd||fffd|", "|fffd||60d|H|fffd||fffd|" _
            , "|fffd||fffd||fffd||fffd||fffd|H|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd|H|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|H|fffd||fffd|", "|fffd||610||fffd||fffd||fffd||fffd||fffd|H|fffd||fffd|", "|fffd||24e|q|fffd|H|fffd||fffd|", "|fffd|h|fffd||fffd||fffd|H|fffd||fffd|", "|fffd||fffd||fffd|O|fffd||fffd||fffd|H|fffd||fffd|" _
            , "|fffd||fffd||fffd|j|fffd|b|fffd|g|fffd|H|fffd||fffd|", "|fffd|G|fffd|H|fffd||fffd|", "|fffd|O|fffd|\|fffd|H|fffd||fffd|", "|fffd||fffd||fffd|~|fffd||754||fffd||fffd|H|fffd||fffd|", "|fffd||fffd||313|P|fffd||fffd||fffd|H|fffd||fffd|")
        For I = 0 To UBound(A)
            With Cells(1, I + 1)
                .Value = A(I)
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
            End With
        Next I
        Application.CutCopyMode = False
        ActiveWindow.Visible = False
        AW.SaveAs Filename:=SPA & "\KouteiMasta.xls", FileFormat:=xlNormal
    End If
    Set AW = Nothing
End Sub
Sub ShoHid()
    Dim C As CommandBarControl, D As CommandBar
On Error Resume Next
    With Application.CommandBars("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\")
        .Visible = Not .Visible
        Set D = Application.CommandBars("Worksheet Menu Bar")
        For Each C In D.Controls
            If C.Caption = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then
                C.Visible = Not .Visible
                If C.Visible = True Then C.Move
            End If
        Next C
    End With
    Set C = Nothing: Set D = Nothing
End Sub
Sub nombo()
    Dim O As Object
    Set O = CreateObject("Wscript.Shell")
    O.Run "http://www.officelabo.net/" ', 3
    Set O = Nothing
End Sub
Sub nombo2()
    Dim P As String
    Const HH_HELP_CONTEXT = &HF
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        P = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelHelp"
    Else 'WindowsXP|fffd||702||fffd|
        P = Application.Path & "\ExcelHelp"
    End If
    Call HtmlHelp(0, P & "\|fffd|H|fffd||fffd||fffd|\|fffd|i|fffd|t|fffd||fffd||fffd|[|fffd||141|j.chm", HH_HELP_CONTEXT, ByVal 10&)
End Sub
Sub nombo3()
    Dim O As Object
    Set O = CreateObject("Wscript.Shell")
    O.Run "http://soft.officelabo.net/" ', 3
    Set O = Nothing
End Sub

Sub kyu_se()
    Dim D As Shape, R As Range
    If Left(ActiveSheet.CodeName, 4) <> "KT1G" And _
        Left(ActiveSheet.CodeName, 4) <> "KT2G" And ActiveWorkbook.CodeName <> "Koteihyo1" Then Exit Sub
        For Each D In ActiveSheet.Shapes
            If D.Name = "Kotei1" Then
                Set R = Range(D.TextFrame.Characters.Text)
                Set R = R.Offset(-2).Resize(R.Rows.Count + 2)
            End If
        Next D
        If R Is Nothing Then
            Set R = Range("F6:DU32")
        End If
        Set R = Intersect(Selection.EntireColumn, R)
        If Not R Is Nothing Then
            With R.Interior
                .Pattern = xlGray16
                .PatternColorIndex = 3
            End With
        End If
End Sub
Sub kyu_ka()
    Dim D As Shape, R As Range
    If Left(ActiveSheet.CodeName, 4) <> "KT1G" And _
        Left(ActiveSheet.CodeName, 4) <> "KT2G" And ActiveWorkbook.CodeName <> "Koteihyo1" Then Exit Sub
        For Each D In ActiveSheet.Shapes
            If D.Name = "Kotei1" Then
                Set R = Range(D.TextFrame.Characters.Text)
                Set R = R.Offset(-2).Resize(R.Rows.Count + 2)
            End If
        Next D
        If R Is Nothing Then
            Set R = Range("F6:DU32")
        End If
        Set R = Intersect(Selection.EntireColumn, R)
        If Not R Is Nothing Then
            With R.Interior
                .ColorIndex = xlNone
            End With
        End If
End Sub
Function op_version() As Double
    Dim S As String
    S = Application.OperatingSystem
    If InStr(1, S, "NT") >= 1 Then
        op_version = Val(Right(S, Len(S) - InStr(1, S, "NT") - 1))
        If op_version < 4 Then
          op_version = op_version2
        End If
    End If
End Function
Private Function op_version2()
    Dim L As Object, S As Object, O As Object, W As Variant, M As String
    Set L = CreateObject("WbemScripting.SWbemLocator")
    Set S = L.ConnectServer
    Set O = S.ExecQuery("Select * From Win32_OperatingSystem")
    For Each W In O
        M = W.Version
    Next W
    op_version2 = Val(Split(M, ".")(0))
End Function

Sub macro9()
    MsgBox "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\|fffd|i|fffd|t|fffd||fffd||fffd|[|fffd|E|fffd|F|fffd|A|fffd||141|j.ver1.87", vbInformation, "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Attribute VB_Name = "koutei2"
Option Explicit
Sub macro()
    Dim C As CommandBar, D As CommandBarControl
    For Each C In Application.CommandBars
        If C.Name = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then C.Delete
    Next C
    Call Macro2
End Sub
Sub Macro2(Optional ByRef G As Boolean)
    Dim SH As Shape, MyBar As CommandBar, myControl As CommandBarControl
    Dim myControl2 As CommandBarControl
    Dim A As String, X As Byte, WS As Worksheet
    Dim AC As String, CA As String, FID As Integer
    If GG = 0 Then koutei2.macro3
    If AddIns("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\").Installed = True Or G = True Then G = False Else G = True
    For Each myControl In Application.CommandBars("Worksheet Menu Bar").Controls
        If myControl.Caption = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then myControl.Delete
    Next myControl
    With Application.CommandBars( _
        "Worksheet Menu Bar").Controls.Add(Type:=msoControlButton, Temporary:=G)
        .Visible = False
        .Caption = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\"
        .OnAction = "koutei.ShoHid"
        .FaceId = 657
    End With
    For Each MyBar In Application.CommandBars
        If MyBar.Name = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then Exit Sub
    Next MyBar
    A = ActiveCell.Address
    If Application.Version < 10 Then X = 1 Else X = 2
    Application.ScreenUpdating = False
    Set WS = ThisWorkbook.Sheets(1)
    Set MyBar = Application.CommandBars.Add( _
        Name:="|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\", Position:=msoBarTop, Temporary:=G)
    AC = "Koutei.Macro1": CA = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": FID = 243: GoSub SAKUSEI1
    AC = "Koutei.Macro6": CA = "|fffd||fffd||fffd||fffd|": GoSub SAKUSEI2
    AC = "Koutei.Macro6": CA = "|fffd|_|fffd||fffd|": GoSub SAKUSEI2
    AC = "Koutei.Macro7": CA = "|fffd||fffd||fffd|[|fffd||fffd|": GoSub SAKUSEI2
    AC = "Koutei.Macro7": CA = "|fffd|[|fffd||fffd||fffd||202||fffd|": GoSub SAKUSEI2
    AC = "Koutei.Macro3": CA = "|fffd|e|fffd|L|fffd|X|fffd|g": FID = 265: GoSub SAKUSEI1
On Error Resume Next
    With MyBar.Controls.Add(Type:=msoControlButton, _
        ID:=Application.CommandBars("Drawing").Controls("|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||311|I|fffd||fffd|(&S)").ID)
        .Caption = "|fffd|I|fffd||fffd|"
        .Style = msoButtonIconAndCaption
    End With
On Error GoTo 0
    AC = "Koutei.Macro5": CA = "|fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd|": FID = 65: GoSub SAKUSEI1
    AC = "koutei.Macro8": CA = "|fffd|w|fffd||fffd||fffd|v": FID = 983: GoSub SAKUSEI1
    Set myControl2 = MyBar.Controls.Add(Type:=msoControlPopup)
    With myControl2
        .Caption = "|fffd|w|fffd||fffd||fffd|v|fffd|E|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|"
    End With
    AC = "koutei.Macro8": CA = "|fffd|w|fffd||fffd||fffd|v": FID = 983: GoSub SAKUSEI3
    AC = "koutei.nombo": CA = "|fffd||fffd||483|z|fffd|[|fffd||fffd||fffd|y|fffd|[|fffd|W": FID = 1016: GoSub SAKUSEI3
    myControl.BeginGroup = True
    AC = "koutei.nombo3": CA = "|fffd||150|V|fffd||143|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h": FID = 2109: GoSub SAKUSEI3
    AC = "koutei.nombo2": CA = "|fffd||fffd||fffd|x|fffd||20b|@|fffd|\|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": FID = 277: GoSub SAKUSEI3
    AC = "koutei.Macro9": CA = "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|": FID = 65: GoSub SAKUSEI3
    myControl.BeginGroup = True
    AC = "koutei.ShoHid": CA = "|fffd|B|fffd||fffd|": FID = 657: GoSub SAKUSEI1
    With Application.CommandBars("|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\")
        .Controls("|fffd|_|fffd||fffd|").Visible = False
        .Controls("|fffd|[|fffd||fffd||fffd||202||fffd|").Visible = False
    End With
    MyBar.Visible = True
    WS.Range("A1").Copy
    WS.Paste
    Application.CutCopyMode = False
    Range(A).Select
    Application.ScreenUpdating = True
    Exit Sub
SAKUSEI1:
    Set myControl = MyBar.Controls.Add(Type:=msoControlButton)
    With myControl
        .OnAction = AC
        .Caption = CA
        .FaceId = FID
        If FID <> 657 And FID <> 983 Then .Style = msoButtonIconAndCaption
    End With
    Return
SAKUSEI3:
    Set myControl = myControl2.Controls.Add(Type:=msoControlButton)
    With myControl
        .OnAction = AC
        .Caption = CA
        .FaceId = FID
    End With
    Return
SAKUSEI2:
    Set SH = WS.Shapes.AddLine(0, 0, 8.25 * X, 8.25 * X)
    SH.Line.ForeColor.SchemeColor = 64
    SH.Line.Visible = msoTrue
    If CA = "|fffd|_|fffd||fffd|" Then
        SH.Line.DashStyle = msoLineDash
    Else
        SH.Line.DashStyle = msoLineSingle
    End If
    SH.Line.Weight = 0.75
    If CA = "|fffd||fffd||fffd|[|fffd||fffd|" Then
        SH.Line.EndArrowheadStyle = msoArrowheadOval
        SH.Line.BeginArrowheadStyle = msoArrowheadOval
    ElseIf CA = "|fffd||fffd||fffd||fffd|" Or CA = "|fffd|_|fffd||fffd|" Or CA = "|fffd|[|fffd||fffd||fffd||202||fffd|" Then
        SH.Line.EndArrowheadStyle = msoArrowheadNone
        SH.Line.BeginArrowheadStyle = msoArrowheadNone
    End If
    SH.Copy
    Set myControl = MyBar.Controls.Add(Type:=msoControlButton)
    With myControl
        .OnAction = AC
        .Caption = CA
        .PasteFace
        .Style = msoButtonIconAndCaption
    End With
    SH.Delete: Set SH = Nothing
    Return
End Sub
Sub macro3()
    Dim C As CommandBar, myControl As CommandBarControl
    Dim YO As Byte
    '|fffd|V|fffd|F|fffd|A|fffd|E|fffd|F|fffd|A|fffd||142||182||30c||74a||fffd||fffd||fffd|
START1:
    Application.ScreenUpdating = False
    For Each C In Application.CommandBars
        If C.Name = "|fffd||212|P|fffd|IExcel|fffd|H|fffd||fffd||fffd|\" Then
            For Each myControl In C.Controls
                If myControl.Caption = "|fffd|k|fffd||fffd||fffd|^" Then YO = 1
            Next myControl
            '|fffd|V|fffd|F|fffd|A|fffd|E|fffd|F|fffd|A|fffd||143|c|fffd|[|fffd||fffd||fffd|o|fffd|[|fffd||202||fffd||d3dc|
            If YO = 1 Then
                C.Delete
            Else
                C.Visible = True
                Application.ScreenUpdating = True
                Exit Sub
            End If
        End If
    Next C
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "koutei3"
Option Explicit
Sub Auto_Close()
    Dim FileNo As Integer
    If HOZ = 1 Then
On Error GoTo Error
        FileNo = FreeFile
        If Dir(SPA, vbDirectory) = "" Then MkDir SPA
        Open SPA & "\Kotnt.ini" For Output As FileNo
        Print #FileNo, N, CC, QJ, HTS, HNB, HNC, MKU, CFT
        Close #FileNo
Error:
        Close #FileNo
    End If
End Sub
Sub Labela1()
    Call koutei4.Labelb1
End Sub
Sub Labela2()
    Call koutei4.Labelb2
End Sub
Sub Macro2(I As Byte, R As Range)
    Dim A As String, R1 As Range
    Application.ScreenUpdating = False
    A = ActiveCell.Address
    R.Interior.Pattern = xlSolid
    R.Interior.PatternColorIndex = xlAutomatic
    R.MergeCells = False
    Set R1 = R.Resize(1, 1)
    With R
        .Borders.Weight = xlHairline
        .Borders(xlEdgeLeft).Weight = xlHairline
        .Borders(xlEdgeTop).Weight = xlThin
        .Borders(xlEdgeBottom).Weight = xlThin
    End With
    With R1.Resize(R.Rows.Count, I + 1)
        .Borders.Weight = xlHairline
        .Borders(xlEdgeBottom).Weight = xlThin
        .Borders(xlInsideVertical).LineStyle = xlNone
    End With
    R1.Resize(R.Rows.Count, I + 1).Copy
    R.PasteSpecial Paste:=xlFormats
    R.Borders(xlEdgeLeft).Weight = xlThin
    R.Borders(xlEdgeRight).Weight = xlThin
    Range(A).Select
    Application.ScreenUpdating = True
End Sub

Sub macro3(B As Integer, I As Integer, K As Date, R As Range)
    Dim J As Byte, H As Integer, B1 As Integer, R1 As Range
    Dim R2 As Range, FG As Integer, A As Variant, D As Variant
    B = I
    Application.ScreenUpdating = False
    Set R1 = R.Resize(1, 1).Offset(-2, 0)
    FG = R1.Font.Size
    With R1.Resize(2, R.Columns.Count)
        .MergeCells = False
        .ClearContents
        .Borders(xlInsideVertical).LineStyle = xlNone
        .Font.ColorIndex = 0
        .Interior.Pattern = xlSolid
        .Interior.PatternColorIndex = xlAutomatic
    End With
    '|fffd||fffd||fffd||242||fffd||fffd||315|\|fffd||fffd||fffd|X|fffd|^|fffd|C|fffd||fffd|
    A = Array("d", "dd", "d|fffd||fffd|", "m|fffd||fffd|d|fffd||fffd|", "mm|fffd||fffd|dd|fffd||fffd|", "m/d", "mm/dd")
    For H = 0 To R.Columns.Count \ B - 1
        Set R2 = Range(Cells(R1.Row, H * B + R1.Column), Cells(R1.Row, (H + 1) * B + R1.Column - 1))
        R2.MergeCells = True
        Range(Cells(R1.Row + 1, H * B + R1.Column) _
            , Cells(R1.Row + 1, (H + 1) * B + R1.Column - 1)).MergeCells = True
        With Cells(R1.Row, H * B + R1.Column)
            .ShrinkToFit = True
            .Font.Size = FG
            .HorizontalAlignment = xlCenter
            If HNB = 7 Then
                If H = 0 Or Day(K) = 1 Then
                    .NumberFormatLocal = A(3)
                    .Value = K
                Else
                    .NumberFormatLocal = A(2)
                    .Value = K
                End If
            ElseIf HNB = 8 Then
                If H = 0 Or Day(K) = 1 Then
                    .NumberFormatLocal = A(5)
                    .Value = K
                Else
                    .NumberFormatLocal = A(0)
                    .Value = K
                End If
            Else
                .NumberFormatLocal = A(HNB)
                .Value = K
            End If
        End With
        With Cells(R1.Row + 1, H * B + R1.Column)
            .ShrinkToFit = True
            .Font.Size = FG
            .HorizontalAlignment = xlCenter
            .Value = Format(K, "aaa")
            If Format(K, "aaa") = "|fffd||fffd|" Then D = Array(3, 3, 0): .Offset(-1).Resize(2).Font.ColorIndex = D(HNC)
            If Format(K, "aaa") = "|fffd|y" Then D = Array(5, 3, 0): .Offset(-1).Resize(2).Font.ColorIndex = D(HNC)
        End With
        If ((QJ = 0 Or QJ = 1) And Holiday1(K) = True) Or (QJ = 3 And Weekday(K) = 1) Or (QJ = 1 And Weekday(K) = 7) Then
            With R2.Resize(R.Rows.Count + 2)
                .Interior.Pattern = xlGray16
                .Interior.PatternColorIndex = 3
            End With
        End If
        K = K + 1
    Next H
    Set R = R1.Resize(2, R.Columns.Count)
    R.Borders.Weight = xlThin
    R.Borders(xlInsideVertical).Weight = xlHairline
    Application.ScreenUpdating = True
End Sub

Sub Macro4(B As Integer, I As Integer, K As Byte, R As Range)
    Dim J As Byte, H As Integer, B1 As Integer, R1 As Range, FG As Integer
    B = (30 / B) * I
    'I = 1: B = 12  '|fffd||fffd||fffd|2.5|fffd||fffd|
    'I = 1: B = 6 '|fffd||fffd||fffd|5|fffd||fffd|
    'I = 1: B = 30 '|fffd||fffd||fffd|1|fffd||fffd|
    'I = 1: B = 15 '|fffd||fffd||fffd|2|fffd||fffd|
    'I = 1: B = 10 '|fffd||fffd||fffd|3|fffd||fffd|
    Application.ScreenUpdating = False
    Set R1 = R.Resize(1, 1).Offset(-2, 0)
    FG = R1.Font.Size
    With R1.Resize(2, R.Columns.Count)
        .MergeCells = False
        .ClearContents
        .Borders(xlInsideVertical).LineStyle = xlNone
        .Font.ColorIndex = 0
        .Interior.Pattern = xlSolid
        .Interior.PatternColorIndex = xlAutomatic
    End With
    For H = 0 To R.Columns.Count \ B - 1
        For J = 1 To 3
            If J = 3 Then
                B1 = B + H * B
                R1.Resize(2, B1).Borders(xlEdgeRight).Weight = xlHairline
                Range(Cells(R1.Row, H * B + R1.Column), Cells(R1.Row, (H + 1) * B + R1.Column - 1)).MergeCells = True
                With Cells(R1.Row, H * B + R1.Column)
                    .ShrinkToFit = True
                    .Font.Size = FG
                    .HorizontalAlignment = xlCenter
                    .Value = K & "|fffd||fffd|"
                End With
                K = K + 1
                If K > 12 Then K = 1
                Exit For
            End If
            B1 = J * B / 3 + H * B
            Range(Cells(R1.Row + 1, B1 + R1.Column - 1), Cells(R1.Row + 1, B1 + R1.Column)).MergeCells = True
            With Cells(R1.Row + 1, B1 + R1.Column - 1)
                .ShrinkToFit = True
                .Font.Size = FG
                .HorizontalAlignment = xlCenter
                .Value = 10 * J
            End With
        Next J
    Next H
    Set R = R1.Resize(2, R.Columns.Count)
    R.Borders(xlEdgeTop).Weight = xlThin
    R.Borders(xlEdgeLeft).Weight = xlThin
    R.Borders(xlEdgeBottom).Weight = xlThin
    R.Borders(xlEdgeRight).Weight = xlThin
    R.Borders(xlInsideHorizontal).Weight = xlThin
    Application.ScreenUpdating = True
End Sub

'|fffd||fffd||fffd||fffd|31|fffd|N1|fffd||fffd|1|fffd||fffd||fffd||fffd||fffd|{|fffd|j|fffd||fffd|
Private Function Holiday1(D As Date) As Boolean
    Dim I As Byte, J1 As Byte, J2 As Byte
    If Weekday(D) = 1 Then Holiday1 = True: Exit Function
    ReDim A(15) As Date
    '|fffd||fffd||fffd|U
    A(0) = DateSerial(Year(D), 1, 1)
    '|fffd||fffd||fffd||fffd||fffd|L|fffd|O|fffd||fffd|
    A(1) = DateSerial(Year(D), 2, 11)
    '|fffd||fffd||fffd|a|fffd||313||fffd|
    A(2) = DateSerial(Year(D), 4, 29)
    '|fffd||fffd||fffd|@|fffd|L|fffd|O|fffd||fffd|
    A(3) = DateSerial(Year(D), 5, 3)
    '|fffd||742||1c2||fffd||313||fffd|
    A(4) = DateSerial(Year(D), 5, 4)
    '|fffd||fffd||fffd||1c2||fffd||fffd||313||fffd|
    A(5) = DateSerial(Year(D), 5, 5)
    '|fffd|C|fffd||313||fffd||fffd|@21|fffd||fffd|7*3|fffd|i|fffd||fffd|3|fffd||fffd||fffd|j|fffd|j
    A(6) = DateSerial(Year(D), 7, 21 - Weekday(DateSerial(Year(D), 7, 0), 2) + 1)
    '|fffd|R|fffd||313||fffd|
    A(7) = DateSerial(Year(D), 8, 11)
    '|fffd|h|fffd|V|fffd||313||fffd|
    A(8) = DateSerial(Year(D), 9, 21 - Weekday(DateSerial(Year(D), 9, 0), 2) + 1)
    '|fffd||fffd||fffd||fffd||fffd||313||fffd|
    A(9) = DateSerial(Year(D), 11, 3)
    '|fffd||398|J|fffd||fffd||fffd||4c2||313||fffd|
    A(10) = DateSerial(Year(D), 11, 23)
    '|fffd|V|fffd|c|fffd|a|fffd||fffd||fffd||fffd|
    If D > "2020/1/1" Then
        A(11) = DateSerial(Year(D), 2, 23)
    ElseIf D < "2019/1/1" Then
        A(11) = DateSerial(Year(D), 12, 23)
    Else
        A(11) = DateSerial(Year(D), 5, 1)
    End If
    '|fffd||fffd||fffd|l|fffd||313||fffd|
    A(12) = DateSerial(Year(D), 1, 14 - Weekday(DateSerial(Year(D), 1, 0), 2) + 1)
    '|fffd||308||fffd||313||fffd|
    A(13) = DateSerial(Year(D), 10, 14 - Weekday(DateSerial(Year(D), 10, 0), 2) + 1)
    '|fffd|t|fffd||fffd||fffd||313||fffd|
    A(14) = DateSerial(Year(D), 3, Int(20.8431 + 0.242194 * (Year(D) - 1980) - Int((Year(D) - 1980) / 4)))
    '|fffd|H|fffd||fffd||fffd||313||fffd|
    A(15) = DateSerial(Year(D), 9, Int(23.2488 + 0.242194 * (Year(D) - 1980) - Int((Year(D) - 1980) / 4)))
    J1 = UBound(A)
    '|fffd||fffd||fffd||fffd||fffd||30b|x|fffd||fffd| |fffd|H|fffd||fffd||fffd||313||fffd||fffd||18c|h|fffd|V|fffd||313||fffd||fffd||30a||fffd|
    If A(7) + 2 = A(14) Then
        ReDim Preserve A(J1 + 1) As Date
        A(J1 + 1) = A(7) + 1
    End If
    J1 = UBound(A): J2 = J1
    '|fffd|U|fffd||fffd||582||fffd||fffd|x|fffd||fffd|
    For I = 0 To J1
        If Weekday(A(I)) = 1 Then
            ReDim Preserve A(J2 + 1) As Date
            J2 = J2 + 1
            A(J2) = A(I) + 1
        End If
    Next I
    'H19/1/1|fffd||fffd||fffd||313||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||102||fffd||fffd||313||fffd||fffd||24d||142||fffd||fffd||7c2||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||30f|j|fffd||fffd||fffd|v|fffd||142||202||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||182||fffd||fffd||fffd|
    '|fffd||fffd||fffd|@|fffd|L|fffd|O|fffd||fffd||fffd|E|fffd||742||1c2||fffd||313||fffd||fffd||1c2||fffd||fffd||70a9||fffd||fffd||fffd||fffd||fffd|j|fffd||30f||a347||fffd|A5/6|fffd||fffd||fffd|j|fffd||fffd||fffd||182||fffd||fffd||fffd|
    J1 = J2
    If Weekday(A(3)) = 1 Or Weekday(A(4)) = 1 Then
        ReDim Preserve A(J1 + 1) As Date
        A(J1 + 1) = DateSerial(Year(D), 5, 6)
    End If
    '|fffd|H|fffd||fffd||fffd||313||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||14e||fffd||fffd||313||fffd||fffd||fffd||fffd|h|fffd|V|fffd||313||fffd||fffd||30f||a347||fffd|A|fffd||397|j|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||182||fffd||fffd||fffd|
    If A(7) = A(14) + 1 And Weekday(A(14)) = 1 Then
        ReDim Preserve A(J1 + 1) As Date
        A(J1 + 1) = A(7) + 1
    End If
    If D < "2020/1/1" And D > "2019/1/1" Then
        ReDim Preserve A(J1 + 3) As Date
        A(J1 + 1) = DateSerial(Year(D), 4, 30)
        A(J1 + 2) = DateSerial(Year(D), 5, 2)
        A(J1 + 3) = DateSerial(Year(D), 10, 22)
    End If
    For I = 0 To UBound(A)
        If A(I) = D Then Holiday1 = True: Exit For
    Next I
End Function



INQUEST-PP=macro
