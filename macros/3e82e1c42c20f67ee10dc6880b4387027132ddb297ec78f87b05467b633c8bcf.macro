Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CTRLE_NARR, 29, 1, MSForms, CheckBox"
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'                                    \\/
'__________________ ( O-O)/*  ____________________________________
'Synth|fffd|se :
'En utilisant l'image de fond d'|fffd|cran uniquement, d|fffd|j|fffd| index|fffd| comme fond d'|fffd|cran, importer dans Excel
'l'image pour la modifier, en y ins|fffd|rant des image de m|fffd|mo, cr|fffd||fffd|s auparavent par un user
'l'image interne est mise |fffd| jour et exporter sous le m|fffd|me nom et le m|fffd|me chemin sur l'image de fond d'|fffd|cran windows
'et voil|fffd| des m|fffd|mos en fond d'|fffd|cran
'
'M|fffd|mo algo. :
'1 D|fffd|finir l'adresse de l'image du fond d'|fffd|cran actuel
'2 L'importer en interne
'3 Volet de cr|fffd|ation/gestion de m|fffd|mo contenu dans le classeur (ce qui est en externe ne peuvent plus |fffd|tre modifi|fffd|s |fffd|tant des images)
'4 Regrouper les m|fffd|mo sur l'image de fond d'|fffd|cran |fffd| un emplacement l'un |fffd| cot|fffd| de l'autre
'5 Cr|fffd|er une nouvelle image de fond d'|fffd|cran comprenant les m|fffd|mos |fffd| l'aide de plage o|fffd| se trouve le fond d'|fffd|cran |fffd| la bonne taille de r|fffd|solution
'6 Exporter la nouvelle image, pour faire afficher en fond d'|fffd|cran les m|fffd|mos
'
'
'Pour supprimer la protection VBA des cellules supprimer ces 2 macros (s|fffd|lectionner le code et le delete):
'Sub Worksheet_BeforeDoubleClick
'Sub Worksheet_Change
'                                    \\/
'__________________ ( O-O)/*  ____________________________________


'---------------------------------------------------------------------------------------------------------
'EVENEMENTS / FONCTIONS FEUILLE GESTIONNAIRE
'Feuille onglet GESTIONNAIRE gestion des fonctions de l'application pour mise en oeuvre des m|fffd|mos
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'D|fffd|claration r|fffd|f|fffd|rence fonction pour gestion d'image fond d'|fffd|cran en module (d|fffd|claration incompatible en module feuille)
'CTRLE_NARR_Click() 'Gestion clic dans controleur narrateur d'activation du narrateur windows
'Sub Worksheet_Activate() 'Faire tourner le smiley
'Sub REINITIALISATION_MEMO() 'R|fffd|initialisation m|fffd|mo
'Sub RETIRER_LIG_MEMO() 'Retrait de lignes au m|fffd|mo
'Sub AJOUTER_LIG_MEMO() 'ajout de lignes au m|fffd|mo
'Sub IMPORTER_FONDECRAN() 'Importation de l'image et de son chemin
'Sub EMPLACEMENT_MEMOS() 'Pour modifier l'emplacement des m|fffd|mos sur l'|fffd|cran
'Sub AJOUT_MEMO() 'Pour ajouter un brouillard de M|fffd|mo
'Sub VALIDER_MEMO() 'Validation du m|fffd|mo en cours et archivage pour placement |fffd| par m|fffd|j fond d'|fffd|cran
'Sub AFFICHER_MEMO() 'Afficher m|fffd|mo choisi par liste d|fffd|roulante
'Sub SUPPRIMER_MEMO() 'suppression du m|fffd|mo en cours choisi par liste d|fffd|roulante
'Sub SUPPRIMER_TOUS() 'suppression de tous les m|fffd|mos cr|fffd||fffd|s + brouillards
'Sub MAJ_MEMO_FONDECRAN() 'M|fffd|J du fond d'|fffd|cran des m|fffd|mos
'Sub Worksheet_BeforeDoubleClick
'Sub Worksheet_Change
'Sub SUPP_IMAGE_TROMBONNE() 'Macro routine de suppression g|fffd|n|fffd|rale d'image trombonne
'Sub SUPP_IMAGE_TROMBONNE_FEUIL2() 'Macro routine de suppression g|fffd|n|fffd|rale d'image trombonne
'---------------------------------------------------------------------------------------------------------


'---------------------------------------------------------------------------------------------------------
'Concerne la macro d'importation de fond d'|fffd|cran en feuille 1 - D|fffd|claration en Module Propri|fffd|t|fffd|s divers, car sinon bug : "interdiction de d|fffd|claration de variable en module feuille"
'Declare PtrSafe Function GetSystemMetrics32 Lib "User32" Alias "GetSystemMetrics" (ByVal nIndex As Long) As Long   'D|fffd|claration publique r|fffd|f|fffd|rence pour g|fffd|rer la r|fffd|solution d'|fffd|cran
'---------------------------------------------------------------------------------------------------------




Private Sub CTRLE_NARR_Click() 'Gestion clic dans controleur narrateur
If CTRLE_NARR.Value = False Then 'case cliqu|fffd|e
   MsgBox "Option narrateur du classeur d|fffd|sactiv|fffd|e", vbInformation, "OPTION"
Else
   Application.Speech.Speak ">activation!", True
   MsgBox "Option narrateur du classeur activ|fffd|e", vbInformation, "OPTION"
End If
End Sub


Private Sub Worksheet_Activate() 'Faire tourner le smiley
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Faire tourner
ActiveSheet.Range("K20").Select
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">gestionnaire!", True
Dim DEGREE_ROTATION As Double 'D|fffd|claration variable DEGREE_ROTATION comme valeur double.
DEGREE_ROTATION = 0 'D|fffd|finition du degr|fffd| de rotation de d|fffd|part du smiley dans la boite |fffd| 0 degr|fffd|s
Do While IsEmpty(ThisWorkbook.Worksheets(1).Range("XFC1")) 'Boucle sans fin DO WHILE ... > LOOP, Rotation infinie du smiley, Tant que cellule XFC1 vide (mais |fffd|a c'est un secret)
   DoEvents 'Raffraichissement application pour voir tourner le smiley
   If DEGREE_ROTATION >= 350 Then   'Process de sortie de boucle de rotation quand tour complet r|fffd|alis|fffd|
      ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = 0 'retour degr|fffd|s de rotation |fffd| 0
      Exit Do 'Sortie de boucle Do while
   End If
   ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = DEGREE_ROTATION   'Rotation du smiley |fffd| la valeur DEGREE_ROTATION
   DEGREE_ROTATION = DEGREE_ROTATION + 4   'Ajout +10 degr|fffd|s |fffd| DEGREE_ROTATION pour la prochaine rotation
Loop
End Sub


Sub REINITIALISATION_MEMO() 'R|fffd|initialisation m|fffd|mo
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir r|fffd|initialiser ce M|fffd|mo et effacer les valeurs de la plage cellules M|fffd|mo ?", vbOKCancel + vbQuestion + vbDefaultButton1, "DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
Application.ScreenUpdating = False 'd|fffd|sactivation affichage pour enlever le micro freezing
Application.EnableEvents = False
Worksheets(1).Unprotect
ActiveSheet.Range("MEMO").ClearContents 'supp valeur m|fffd|mo
ActiveSheet.Range("MEMO_TITRE").Value = "M|fffd|mo t|fffd|che(s)" 'recr|fffd|a titre d'origine
Application.EnableEvents = True
Worksheets(1).Protect
Application.ScreenUpdating = True 'activation affichage
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo r|fffd|initialis|fffd|!", True
MsgBox "M|fffd|mo r|fffd|initialis|fffd| pour enregistrer les modifications dans l'onglet M|fffd|mos, pensez |fffd| valider le m|fffd|mo.", vbInformation, "CONFIRMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.ScreenUpdating = True 'activation affichage
      Application.EnableEvents = True
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Vous avez modifiez les noms cellules, sans en faire la modification dans le code VBA." & Chr(10) & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
      Worksheets(1).Protect
   End If
End Sub


Sub RETIRER_LIG_MEMO() 'Retrait de lignes au m|fffd|mo
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
Dim ligne, SOMME As Double, ADRESSE As String
ADRESSE = ActiveCell.Address 'm|fffd|mo adresse cellule active
ligne = (ActiveSheet.Range("MEMO_TITRE").Row + ActiveSheet.Range("MEMO").Rows.Count - 2) 'calcul de la derni|fffd|re ligne jaune du m|fffd|mo
Application.ScreenUpdating = False 'd|fffd|sactivation affichage pour enlever le micro freezing
Application.EnableEvents = False
Worksheets(1).Unprotect
If Not ActiveSheet.Range("MEMO").Rows.Count <= 11 Then 'si nb ligne du m|fffd|mo non inf|fffd|rieur |fffd| 11 ok
   '---------------------------------------------------------------------------------------------------------
   '1. suppression ligne
   Rows(ligne).Select 's|fffd|lect derni|fffd|re ligne calcul|fffd|e, perte cellule active
   Selection.Delete Shift:=xlUp 'suppression
   ActiveSheet.Range(ADRESSE).Select 'select derni|fffd|re cellule active
   '--------------------------------------++++++++++------------------------------------------------
   '2.a calcul somme des hauteurs de lignes pour recalcul plus tard dans les variables de s|fffd|cu
   SOMME = 0 'd|fffd|finition variable
   For i = 1 To ActiveSheet.Range("MEMO").Rows.Count 'boucle de recalcul somme hauteur ligne par ligne
   SOMME = SOMME + ActiveSheet.Rows(ActiveSheet.Range("MEMO_TITRE").Row + i - 1).RowHeight
   Next
   SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
   ActiveSheet.Range("MEMO_HAUT").Value = SOMME 'indexer somme pixel
   '--------------------------------------++++++++++------------------------------------------------
   '2.b calcul somme des largeurs de colonne pour recalcul plus tard dans les variables de s|fffd|cu
   SOMME = 0 'd|fffd|finition variable
   For i = 1 To ActiveSheet.Range("MEMO").Columns.Count 'boucle de recalcul somme largeur col par col
   SOMME = SOMME + ActiveSheet.Columns(ActiveSheet.Range("MEMO_TITRE").Column + i - 1).Width
   Next
   SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
   ActiveSheet.Range("MEMO_LARG").Value = SOMME 'indexer somme pixel
   '---------------------------------------------------------------------------------------------------------
Else
   Application.ScreenUpdating = True 'activation affichage
   Application.EnableEvents = True
   If CTRLE_NARR.Value = True Then Application.Speech.Speak ">annulation!", True
   MsgBox "(?) Vous ne pouvez pas r|fffd|duire le nombre de lignes du m|fffd|mo |fffd| moins de 11 lignes.", vbInformation, "INFORMATION"
   Worksheets(1).Protect
   End 'fin
End If
'---------------------------------------------------------------------------------------------------------
'3. fin normale
Application.EnableEvents = True
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">ligne retir|fffd|e!", True
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.ScreenUpdating = True 'activation affichage
      Application.EnableEvents = True
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Vous avez modifiez les noms cellules, sans en faire la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub AJOUTER_LIG_MEMO() 'ajout de lignes au m|fffd|mo
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
Dim ligne, SOMME As Double, ADRESSE As String
ADRESSE = ActiveCell.Address 'm|fffd|mo adresse cellule active
ligne = (ActiveSheet.Range("MEMO_TITRE").Row + ActiveSheet.Range("MEMO").Rows.Count - 2) 'calcul de la derni|fffd|re ligne jaune du m|fffd|mo
SOMME = ((ActiveSheet.Rows(ligne).RowHeight * (1 + 2 / 3)) + ActiveSheet.Range("MEMO_HAUT").Value)
Application.ScreenUpdating = False 'd|fffd|sactivation affichage pour enlever le micro freezing
Application.EnableEvents = False
Worksheets(1).Unprotect
If Not SOMME >= ActiveSheet.Range("H_ECRAN_RESO").Value Then 'si nb ligne du m|fffd|mo non sup|fffd|rieur |fffd| la hauteur de la r|fffd|solution de l'|fffd|cran
   '---------------------------------------------------------------------------------------------------------
   '1. ajout ligne
   Rows(ligne).Select 's|fffd|lect derni|fffd|re ligne calcul|fffd|e, perte cellule active
   Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
   ActiveSheet.Range("E" & ligne, "K" & ligne).Interior.ColorIndex = 2 'reformat couleurs ligne |fffd| blanc
   ActiveSheet.Range(ADRESSE).Select 'select derni|fffd|re cellule active
   '--------------------------------------++++++++++------------------------------------------------
   '2.a calcul somme des hauteurs de lignes pour recalcul plus tard dans les variables de s|fffd|cu
   SOMME = 0 'd|fffd|finition variable
   For i = 1 To ActiveSheet.Range("MEMO").Rows.Count 'boucle de recalcul somme hauteur ligne par ligne
   SOMME = SOMME + ActiveSheet.Rows(ActiveSheet.Range("MEMO_TITRE").Row + i - 1).RowHeight
   Next
   SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
   ActiveSheet.Range("MEMO_HAUT").Value = SOMME 'indexer somme pixel
   '--------------------------------------++++++++++------------------------------------------------
   '2.b calcul somme des largeurs de colonne pour recalcul plus tard dans les variables de s|fffd|cu
   SOMME = 0 'd|fffd|finition variable
   For i = 1 To ActiveSheet.Range("MEMO").Columns.Count 'boucle de recalcul somme largeur col par col
   SOMME = SOMME + ActiveSheet.Columns(ActiveSheet.Range("MEMO_TITRE").Column + i - 1).Width
   Next
   SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
   ActiveSheet.Range("MEMO_LARG").Value = SOMME 'indexer somme pixel
   '---------------------------------------------------------------------------------------------------------
Else
   Application.ScreenUpdating = True 'activation affichage
   Application.EnableEvents = True
   If CTRLE_NARR.Value = True Then Application.Speech.Speak ">annulation!", True
   MsgBox "(?) Vous ne pouvez pas augmenter le nombre de lignes du m|fffd|mo au-del|fffd| de la r|fffd|solution de votre |fffd|cran.", vbInformation, "INFORMATION"
   Worksheets(1).Protect
   End 'fin
End If
'---------------------------------------------------------------------------------------------------------
'3. fin normale
Application.ScreenUpdating = True 'activation affichage
Application.EnableEvents = True
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">ligne ajout|fffd|e!", True
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.ScreenUpdating = True 'activation affichage
      Application.EnableEvents = True
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Vous avez modifiez les noms cellules, sans en faire la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub IMPORTER_FONDECRAN() 'Importation de l'image et de son chemin
Dim CHEMIN As String, IMAGE As Shape
Dim NOM_FONDECRAN, CHEMIN_COPIE_IMAGE As String
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Fenetre import chemin
Application.ScreenUpdating = False 'd|fffd|sactivation raffraichissement affichage
Application.EnableEvents = False 'd|fffd|sactiver event feuille
Worksheets(1).Unprotect
CHEMIN = Application.GetOpenFilename("Fichiers images (*.*), *.*", , "Fen|fffd|tre de reprise du fond d'|fffd|cran", , False) 'definition chemin
If CTRLE_NARR.Value = True And CHEMIN = "Faux" Then Application.Speech.Speak ">annulation importation!", True
If CHEMIN = "Faux" Then End 'si rien entrainant une erreur dans la s|fffd|lection de choix fichier arr|fffd|ter tout
ActiveSheet.Range("CHEMIN_FONDECRAN").Value = CHEMIN 'indexer chemin dans cellule
'1.1 faire une copie du fond d'|fffd|cran
NOM_FONDECRAN = Dir(ActiveSheet.Range("CHEMIN_FONDECRAN").Value)    ' d|fffd|finition nom fichier avec extension
ActiveSheet.Range("NOM_IMAGE_ORIGIN").Value = NOM_FONDECRAN 'indexation nom
CHEMIN_COPIE_IMAGE = ActiveSheet.Range("CHEMIN_COPIE_FD").Value 'd|fffd|finition chemin fichier copie image
'-------------------++++++++++++++++++++++++++-----------------------------------------
   'Routine de cr|fffd|ation de sauvegarde fichier fond d'|fffd|cran
   If Len(Dir(CHEMIN_COPIE_IMAGE & "copie " & NOM_FONDECRAN)) > 0 Then 'si existant, veut dire que r|fffd|import fichier d|fffd|j|fffd| existant comportant des m|fffd|mos
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "L'importation indique que le fichier import|fffd| a exactement le m|fffd|me nom que la pr|fffd|c|fffd|dente importation." & Chr(10) & "En continuant vous |fffd|craseriez la copie de l'original sans m|fffd|mos, l'importation va donc |fffd|tre >> Annul|fffd|e <<" & Chr(10) & Chr(10) & "* Quand vous importez un fichier original (sans m|fffd|mos), une nouvelle copie de ce fichier est cr|fffd||fffd|e, il ne faut pas toucher |fffd| cette copie, ni |fffd| l'original directement.", vbExclamation, "INFORMATION ABANDON IMPORTATION"  'fichier existant abondon de l'importation pour que l'user corrige son choix
      Application.ScreenUpdating = True 'activation raffraichissement affichage
      Application.EnableEvents = True 'activer event feuille
      Worksheets(1).Protect
      Exit Sub
   Else 'si non existant copier fichier
      FileCopy CHEMIN, CHEMIN_COPIE_IMAGE & "copie " & NOM_FONDECRAN    'Copie fichier suivant chemin d'origine dans un nouveau chemin avec  modif pour cr|fffd|ation fichier
   End If
'---------------------------------------------------------------------------------------------------------
'2. Importer image dans excel
Worksheets(3).Select 'aller sur la feuille 3
ActiveSheet.Range("A6").Select 'se placer en A6 pour coller le wallpaper
For Each IMAGE In Worksheets(3).Shapes 'boucle de suppression d'image
    If Not IMAGE.Name Like "*GEROMEMO*" And Not IMAGE.Name Like "*signet*" Then IMAGE.Delete 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
ActiveSheet.Pictures.Insert(CHEMIN).Select 'ins|fffd|rer l'image
Selection.ShapeRange.Height = ThisWorkbook.Worksheets(1).Range("H_ECRAN_RESO").Value / (1 + 2 / 3) 'modifier la hauteur de l'image |fffd| la r|fffd|solution |fffd|cran
Selection.ShapeRange.Width = ThisWorkbook.Worksheets(1).Range("L_ECRAN_RESO").Value / (1 + 2 / 3) 'modifier la hauteur de l'image |fffd| la r|fffd|solution |fffd|cran
Selection.ShapeRange.Name = "FD" 'Renommer image au nom de FD
Worksheets(1).Select 'aller sur la feuille 1
'---------------------------------------------------------------------------------------------------------
'3. Importation r|fffd|solution |fffd|cran
ActiveSheet.Range("L_ECRAN_RESO").Value = GetSystemMetrics32(0) 'indexer largeur r|fffd|solution
ActiveSheet.Range("H_ECRAN_RESO").Value = GetSystemMetrics32(1) 'indexer hauteur r|fffd|solution
'---------------------------------------------------------------------------------------------------------
'4. Fin de process
Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activer affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">importation termin|fffd|e!", True
MsgBox "Importation du fond d'|fffd|cran dans Excel termin|fffd|." & Chr(10) & "(?) Une copie de sauvegarde du fichier en a |fffd|t|fffd| faite au m|fffd|me emplacement que l'image d'origine.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub EMPLACEMENT_MEMOS() 'Pour modifier l'emplacement des m|fffd|mos sur l'|fffd|cran
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">Module ouvert!", True
PLAC_MEMO.Show 'affchage de l'userform de choix
End Sub


Sub AJOUT_MEMO() 'Pour ajouter un brouillard de M|fffd|mo
Dim MEMO_MAX_TRONQ As Double 'variable pour tronquer valeur r|fffd|solution ecran
Dim COL_TAB_MEM_ID, COL_TAB_MEM_TITRE, COL_TAB_MEM_ADEB, COL_TAB_MEM_ADFIN, COL_TAB_MEM_VALID, COL_TAB_MEM_SUPP As Integer 'd|fffd|claration variable pour g|fffd|rer les num|fffd|ros de colonnes
Dim BOUCLE_MEMO As Double
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Ajout de brouillard de m|fffd|mo |fffd| la base
Application.ScreenUpdating = False 'd|fffd|sactivation raffraichissement affichage
Application.EnableEvents = False 'd|fffd|sactivation |fffd|v|fffd|nements feuille
Worksheets(1).Unprotect
MEMO_MAX_TRONQ = Left(ActiveSheet.Range("MEMO_DISPO").Value, Len(Int(ActiveSheet.Range("MEMO_DISPO").Value))) 'Tronquer valeur maxi m|fffd|mo possible pour calcul IF correcte sans arrondis
If ActiveSheet.Range("MEMO_CREA").Value < MEMO_MAX_TRONQ Then 'A. si inf|fffd|rieur ok
   '---------------------------------------------------------------------------------------------------------
   '2. Modif dans feuille gestionnaire
   ActiveSheet.Range("MEMO").ClearContents 'supp valeur m|fffd|mo
   ActiveSheet.Range("MEMO_TITRE").Value = "M|fffd|mo t|fffd|che(s)" 'recr|fffd|a titre d'origine
   ActiveSheet.Range("MEMO_CREA").Value = ActiveSheet.Range("MEMO_CREA").Value + 1 'Ajout d'un brouillard
   '---------------------------------------------------------------------------------------------------------
   '3. Imputation du m|fffd|mo dans la feuille gestionnaire
   '------------------+++++++------------------------------------------------------------------------------
   '3.1 D|fffd|finition des variables pour calculs dynamiques |fffd|volutifs de la maquette
   COL_TAB_MEM_ID = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ID
   COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUM
   COL_TAB_MEM_TITRE = ThisWorkbook.Worksheets(2).Range("TAB_MEM_TITRE").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_TITRE
   COL_TAB_MEM_ADEB = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
   COL_TAB_MEM_ADFIN = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
   COL_TAB_MEM_VALID = ThisWorkbook.Worksheets(2).Range("TAB_MEM_VALID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_VALID
   COL_TAB_MEM_SUPP = ThisWorkbook.Worksheets(2).Range("TAB_MEM_SUPP").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_SUPP
   DERLIGNE = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ID").Row + Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEMO").Rows) / 2 + 1 'calcul derni|fffd|re ligne du tableur = LIGNE ENTETE + NB CELLULES NON VIDES PLAGE TABLEUR / 2 (car 2 colonnes) +1 (pour aller en bas)
   '------------------+++++++------------------------------------------------------------------------------
   '3.2 Tri tableau de gestion des m|fffd|mo par ordre num|fffd|rique du + petit au + grand
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Clear 'suppression du tri existant, pour raz
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Add Key:=ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal 'tri par ordre descendant en prenant en compte les valeur de la colonne TAB_MEM_NUM_COL
   With ActiveWorkbook.Worksheets("MEMOS").Sort 'ordre de tri avec ordre suivant
           .SetRange ThisWorkbook.Worksheets(2).Range("TAB_MEMO_LARGE") 'trier l'ensemble du tableu
           .Header = xlNo 'pas d'ent|fffd|te
           .MatchCase = False
           .Orientation = xlTopToBottom
           .SortMethod = xlPinYin
           .Apply
   End With
   '------------------+++++++------------------------------------------------------------------------------
   '3.3 Indexation info dans tableau
   '3.3.1 Indexation formule r|fffd|cap info m|fffd|mo pour liste d|fffd|roulante
   ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_ID).Address).Formula = "=" & ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_NUM).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False) & "& "" "" &" & ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_TITRE).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False) 'concat|fffd|nation colonnes num|fffd|ro m|fffd|mo plus titre m|fffd|mo
   '++++++++++++++++++++++++++++++++++++
   '3.3.2 Indexation num|fffd|ro m|fffd|mo + M|fffd|J index num|fffd|ro m|fffd|mo
   ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2
   BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) + 1 'calcul nb ligne dans tableau
   If BOUCLE_MEMO = 0 Then BOUCLE_MEMO = 1
   For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
      ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = INDEX_MEM 'prend nouvel index
   Next
   '++++++++++++++++++++++++++++++++++++
   '3.3.3 Indexation titre m|fffd|mo
   ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_TITRE).Address).Value = ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Value
   '++++++++++++++++++++++++++++++++++++
   '3.3.4 Indexation adresse d|fffd|but m|fffd|mo
   'Une fois valid|fffd| m|fffd|mo
   '++++++++++++++++++++++++++++++++++++
   '3.3.5 Indexation adresse fin m|fffd|mo
   'Une fois valid|fffd| m|fffd|mo
   '++++++++++++++++++++++++++++++++++++
   '3.3.6 Indexation info m|fffd|mo valid|fffd| |fffd| placer dans fond d'|fffd|cran
   ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_VALID).Address).Value = "NON"
   '++++++++++++++++++++++++++++++++++++
   '3.3.7 Indexation info m|fffd|mo |fffd| supprimer
   ThisWorkbook.Worksheets(2).Range(Cells(DERLIGNE, COL_TAB_MEM_SUPP).Address).Value = "NON"
   '++++++++++++++++++++++++++++++++++++
   '3.3.8 Indexation adresse hyperlien
   'Une fois valid|fffd| m|fffd|mo
   '++++++++++++++++++++++++++++++++++++
   '3.3.8 R|fffd|initialisation zone m|fffd|mo
   ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
   ActiveSheet.Range("MEMO_LIST").Value = BOUCLE_MEMO
   '---------------------------------------------------------------------------------------------------------
   '4. Process de fin
   Application.EnableEvents = True 'd|fffd|sactivation |fffd|v|fffd|nements feuille
   Application.ScreenUpdating = True 'd|fffd|sactivation raffraichissement affichage
   Worksheets(1).Protect
   If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo cr|fffd||fffd|!", True
   MsgBox "(?) Un brouillard de M|fffd|mo a |fffd|t|fffd| cr|fffd||fffd|." & Chr(10) & "<!> Pour qu'il soit valide et pr|fffd|parer son insertion dans l'|fffd|cran, vous devrez le valider par le bouton : 'VALIDER MEMO'." & Chr(10) & "<!> Pour le supprimer, appuyer sur le bouton 'SUPPRIMER CE MEMO'", vbInformation, "INFORMATION"
'****----------------------------------------------------------------------------------------------------
Else 'B. Si nombre de brouillard de m|fffd|mo au-del|fffd|s du maxi autoris|fffd|
   Application.EnableEvents = True 'd|fffd|sactivation |fffd|v|fffd|nements feuille
   Application.ScreenUpdating = True 'd|fffd|sactivation raffraichissement affichage
   Worksheets(1).Protect
   If CTRLE_NARR.Value = True Then Application.Speech.Speak ">ajout annul|fffd|!", True
   MsgBox "<!> La r|fffd|solution de votre |fffd|cran ne vous permet pas d'ajouter un autre m|fffd|mo.", vbExclamation, "INFORMATION"
'****----------------------------------------------------------------------------------------------------
End If
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub VALIDER_MEMO() 'Validation du m|fffd|mo en cours et archivage pour placement |fffd| par m|fffd|j fond d'|fffd|cran
Dim ID_MEMO, COL_TAB_MEM_NUM, LIGN_TAB_MEM_NUM, HAUT_MEMO As Integer
Dim TITRE_MEMO, ADRESS_DEBUT, ADRESS_FIN As String
Dim TAB_HAUT_LIG(), COMPTEUR As Double
Dim IMAGE As Shape
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir valider ce m|fffd|mo ? Si oui lors de la mise |fffd| jour du fond d'|fffd|cran, celui-ci sera ajout|fffd|.", vbOKCancel + vbQuestion + vbDefaultButton1, "DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
'1. Copie du m|fffd|mo en feuille 1 gestionnaire
Application.EnableEvents = False 'desactiver event feuille
Application.ScreenUpdating = False 'desactivation affichage
Worksheets(1).Unprotect
ID_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO_LIST").Value 'r|fffd|cup|fffd|ration valeur index m|fffd|mo
TITRE_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Value 'r|fffd|cup|fffd|ration valeur titre m|fffd|mo
HAUT_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO").Rows.Count 'calcul de la hauteur du m|fffd|mo
ReDim TAB_HAUT_LIG(HAUT_MEMO) 'dimensionnement du tableau des hauteurs de lignes
'++++++++++++++++++++++++++++++++++++
   For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
      TAB_HAUT_LIG(lig) = ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + lig - 1, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column).Address).RowHeight 'index hauteur ligne dans tableau
   Next
'---------------------------------------------------------------------------------------------------------
'2. Archivage en feuille 2 m|fffd|mo
ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2

'2.1 Recherche ligne index du m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUMBOUCLE_MEMO
LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row  'r|fffd|cup|fffd|re num ligne TAB_MEM_NUMBOUCLE_MEMO
BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
   For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
      If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = ID_MEMO Then 'prend nouvel index
         LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Row 'r|fffd|cup|fffd|re ligne index
      End If
   Next
'++++++++++++++++++++++++++++++++++++
'2.2 M|fffd|J du titre du m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_TITRE").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_TITRE
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = TITRE_MEMO 'Maj du titre du m|fffd|mo
'++++++++++++++++++++++++++++++++++++
'2.3 recherche pour emplacement copie m|fffd|mo dans feuille
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
ADRESS_DEBUT = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
HAUT_MEMO = HAUT_MEMO + ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row - 1 'calcul hauteur en ligne du m|fffd|mo pour calcul adresse fin m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column + 1 'r|fffd|cup|fffd|re num colonne ADRESS_DEBUT
ADRESS_FIN = ThisWorkbook.Worksheets(2).Range(Cells(HAUT_MEMO, COL_TAB_MEM_NUM).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False) 'reprise valeur adresse fin plage m|fffd|mo archiv|fffd|
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ADRESS_FIN 'Maj adresse fin emplacement m|fffd|mo
ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Select 'aller sur cellule m|fffd|mo pour collage
ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_FIN).Row + 99, ThisWorkbook.Worksheets(2).Range(ADRESS_FIN).Column).Address).Clear 'supprimer format/valeur m|fffd|mo pr|fffd|c|fffd|dent
   '++++++++++++++++++++++++++++++++++++
   'Copie m|fffd|mo
   ThisWorkbook.Worksheets(1).Select 'retour feuille 1 (la suppression de la plage m|fffd|mo pr|fffd|c|fffd|dente fait perdre la m|fffd|moire de la copie)
   ThisWorkbook.Worksheets(1).Range("MEMO").Copy 'copier la plage pour r|fffd|cup|fffd|rer toute la zone, image incluse
   ThisWorkbook.Worksheets(2).Select 'retour feuille 2
   '++++++++++++++++++++++++++++++++++++
ActiveSheet.Paste 'colle l'ensemble du m|fffd|mo, image incluse
   'suppression image trombonne en trop
   COMPTEUR = 0
   For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image trombonne se cr|fffd|ant en plus |fffd| chaque copier coller
       If IMAGE.TopLeftCell.Address = Worksheets(2).Range(ADRESS_DEBUT).Address Then
         COMPTEUR = COMPTEUR + 1 'ajout 1 au compteur
         If COMPTEUR > 1 Then IMAGE.Delete
       End If
   Next
'++++++++++++++++++++++++++++++++++++
HAUT_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO").Rows.Count 'calcul de la hauteur du m|fffd|mo
   For lign = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
      ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row + lign - 1, ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column).Address).RowHeight = TAB_HAUT_LIG(lign)
   Next
'++++++++++++++++++++++++++++++++++++
'---------------------------------------------------------------------------------------------------------
'3. Process de fin
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_VALID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_VALID
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "OUI" 'Maj de l'|fffd|tat du m|fffd|mo
ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo valid|fffd|!", True
MsgBox "M|fffd|mo valid|fffd|" & Chr(10) & "Pour le placer de suite en fond d'|fffd|cran, appuyer sur le bonton 'M|fffd|J Fond d'|fffd|cran'.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub AFFICHER_MEMO() 'Afficher m|fffd|mo choisi par liste d|fffd|roulante
Dim ID_MEMO, COL_TAB_MEM_NUM, LIGN_TAB_MEM_NUM, HAUT_MEMO As Integer
Dim TITRE_MEMO, ADRESS_DEBUT, ADRESS_FIN, AD_REFERTO_DEB, AD_REFERTO_FIN, ADRESSE_MEMO As String
Dim TAB_HAUT_LIG(), SOMME As Double
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir afficher ce m|fffd|mo ?" & Chr(10) & "(?) L'affichage modifiera la plage M|fffd|mo de l'onglet Gestionnaire.", vbOKCancel + vbQuestion + vbDefaultButton1, "DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
'1. R|fffd|cup|fffd|ration valeur index feuille 1
Application.EnableEvents = False 'desactiver event feuille
Application.ScreenUpdating = False 'desactivation affichage
Worksheets(1).Unprotect
ID_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO_LIST").Value 'r|fffd|cup|fffd|ration valeur index m|fffd|mo
HAUT_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO").Rows.Count + ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row  'calcul de la hauteur du m|fffd|mo pour suppression ancien memo
ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + 10, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column).Address, Cells(HAUT_MEMO, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column + 1).Address).Clear 'suppression lignes en dehors m|fffd|mo par d|fffd|faut pour raz ajustement
'---------------------------------------------------------------------------------------------------------
'2. R|fffd|cup|fffd|ration en feuille 2 du m|fffd|mo
ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2

'2.1 Recherche ligne index du m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUMBOUCLE_MEMO
LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row  'r|fffd|cup|fffd|re num ligne TAB_MEM_NUMBOUCLE_MEMO
BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
   For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
      If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = ID_MEMO Then 'prend nouvel index
         LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Row 'r|fffd|cup|fffd|re ligne index
      End If
   Next
'++++++++++++++++++++++++++++++++++++
'2.2 Copie archive m|fffd|mo
   'Adresse de d|fffd|but
   COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
   ADRESS_DEBUT = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
   'Adresse de d|fffd|but
   COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
   ADRESS_FIN = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
               '++++++++++++++++++++++++++++++++++++
               '2.2.a process de sortie particulier si m|fffd|mo = brouillon
               If ADRESS_FIN = "" Then
                  ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2
                  ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Copy 'coller m|fffd|mo standard
                  ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
                  ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Select 'se placer sur position de d|fffd|part m|fffd|mo
                  Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False 'coller format achive m|fffd|mo initiale
                  ThisWorkbook.Worksheets(1).Range("MEMO").ClearContents
                  ActiveSheet.Range("MEMO_TITRE").Value = "M|fffd|mo t|fffd|che(s)" 'recr|fffd|a titre d'origine
                  SUPP_IMAGE_TROMBONNE 'supprimer image trombonne
                        '++++++++++++++++++++++++++++++++++++
                        'Routine d'ajustement hauteur ligne
                        HAUT_MEMO = ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Rows.Count 'calcul de la hauteur du m|fffd|mo
                        ReDim TAB_HAUT_LIG(HAUT_MEMO) 'dimensionnement du tableau des hauteurs de lignes
                        '++++++++++++++++++++++++++++++++++++
                        For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                           TAB_HAUT_LIG(lig) = ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row + lig - 1, ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column).Address).RowHeight 'index hauteur ligne dans tableau
                        Next
                        '++++++++++++++++++++++++++++++++++++
                        'Routine de m|fffd|j taille hauteur ligne en feuille 1
                        lig = 1
                        For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                           ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + lig - 1, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column).Address).RowHeight = TAB_HAUT_LIG(lig) 'index hauteur ligne dans tableau
                        Next
                        '++++++++++++++++++++++++++++++++++++
                  AD_REFERTO_DEB = ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Address 'Calcul adresse plage m|fffd|mo gestionnaire
                  AD_REFERTO_FIN = ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + HAUT_MEMO - 1, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column + 1).Address).Address 'Calcul adresse plage m|fffd|mo gestionnaire
                  ActiveWorkbook.Names("MEMO").Delete 'suppression plage nomm|fffd| pour cr|fffd|ation nouvelle plage
                  ThisWorkbook.Worksheets(1).Range(AD_REFERTO_DEB, AD_REFERTO_FIN).Select 's|fffd|lection de la nouvelle plage
                  ActiveWorkbook.Names.Add Name:="MEMO", RefersTo:=Selection 'ajout nouvelle plage nomm|fffd| MEMO
                        '--------------------------------------++++++++++------------------------------------------------
                        'Routine de recalcul somme des hauteurs de lignes pour recalcul plus tard dans les variables de s|fffd|cu
                        SOMME = 0 'd|fffd|finition variable
                        For i = 1 To ActiveSheet.Range("MEMO").Rows.Count 'boucle de recalcul somme hauteur ligne par ligne
                        SOMME = SOMME + ActiveSheet.Rows(ActiveSheet.Range("MEMO_TITRE").Row + i - 1).RowHeight
                        Next
                        SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
                        ActiveSheet.Range("MEMO_HAUT").Value = SOMME 'indexer somme pixel
                        '--------------------------------------++++++++++------------------------------------------------                  Application.EnableEvents = True 'activer event feuille
                  Application.ScreenUpdating = True 'activation affichage
                  Worksheets(1).Protect
                  If CTRLE_NARR.Value = True Then Application.Speech.Speak ">brouillon m|fffd|mo affich|fffd|!", True
                  MsgBox "M|fffd|mo brouillon '" & ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value & "' affich|fffd|.", vbInformation, "INFORMATION"
                  Exit Sub 'fin macro
               End If
'++++++++++++++++++++++++++++++++++++
HAUT_MEMO = ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, ADRESS_FIN).Rows.Count 'calcul de la hauteur du m|fffd|mo
ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, ADRESS_FIN).Copy 'copier plage
ReDim TAB_HAUT_LIG(HAUT_MEMO) 'dimensionnement du tableau des hauteurs de lignes
'++++++++++++++++++++++++++++++++++++
   For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
      TAB_HAUT_LIG(lig) = ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row + lig - 1, ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column).Address).RowHeight 'index hauteur ligne dans tableau
   Next
'---------------------------------------------------------------------------------------------------------
'3. Retour feuille 1 indexation m|fffd|mo demand|fffd|
ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Select 'se placer sur cellule titre pour coller le m|fffd|mo
ActiveSheet.Paste 'colle l'ensemble du m|fffd|mo, image incluse
AD_REFERTO_DEB = ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Address 'Calcul adresse plage m|fffd|mo gestionnaire
AD_REFERTO_FIN = ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + HAUT_MEMO - 1, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column + 1).Address).Address 'Calcul adresse plage m|fffd|mo gestionnaire
ActiveWorkbook.Names("MEMO").Delete 'suppression plage nomm|fffd| pour cr|fffd|ation nouvelle plage
ThisWorkbook.Worksheets(1).Range(AD_REFERTO_DEB, AD_REFERTO_FIN).Select 's|fffd|lection de la nouvelle plage
ActiveWorkbook.Names.Add Name:="MEMO", RefersTo:=Selection 'ajout nouvelle plage nomm|fffd| MEMO
'++++++++++++++++++++++++++++++++++++
   'Routine de m|fffd|j taille hauteur ligne en feuille 1
   For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
      ThisWorkbook.Worksheets(1).Range(Cells(ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Row + lig - 1, ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Column).Address).RowHeight = TAB_HAUT_LIG(lig) 'index hauteur ligne dans tableau
   Next
'---------------------------------------------------------------------------------------------------------
'4. Process de fin
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
ThisWorkbook.Worksheets(1).Range("MEMO_TITRE").Select 'se placer sur cellule titre pour coller le m|fffd|mo
SUPP_IMAGE_TROMBONNE 'supprimer image trombonne
   '--------------------------------------++++++++++------------------------------------------------
   'Routine de recalcul somme des hauteurs de lignes pour recalcul plus tard dans les variables de s|fffd|cu
   SOMME = 0 'd|fffd|finition variable
   For i = 1 To ActiveSheet.Range("MEMO").Rows.Count 'boucle de recalcul somme hauteur ligne par ligne
   SOMME = SOMME + ActiveSheet.Rows(ActiveSheet.Range("MEMO_TITRE").Row + i - 1).RowHeight
   Next
   SOMME = SOMME * (1 + 2 / 3)  'convertion point en pixel
   ActiveSheet.Range("MEMO_HAUT").Value = SOMME 'indexer somme pixel
   '--------------------------------------++++++++++------------------------------------------------Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo affich|fffd|!", True
MsgBox "M|fffd|mo '" & ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value & "' affich|fffd|.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      SUPP_IMAGE_TROMBONNE 'supprimer image trombonne
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub SUPPRIMER_MEMO() 'suppression du m|fffd|mo en cours choisi par liste d|fffd|roulante
Dim ID_MEMO, COL_TAB_MEM_NUM, LIGN_TAB_MEM_NUM, BOUCLE_MEMO, HAUT_MEMO, TAB_HAUT_LIG(), COMPTEUR As Double
Dim ADRESS_DEBUT, ADRESS_FIN As String
Dim IMAGE As Shape
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir supprimer ce m|fffd|mo ? Cette action n'entrainera de suppression imm|fffd|diate dans le fond d'|fffd|cran tant que la mise |fffd| jour n'a pas |fffd|t|fffd| lanc|fffd|e.", vbOKCancel + vbQuestion + vbDefaultButton1, "ATTENTION DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
'1. R|fffd|cup|fffd|ration valeur index feuille 1
Application.EnableEvents = False 'desactiver event feuille
Application.ScreenUpdating = False 'desactivation affichage
Worksheets(1).Unprotect
ID_MEMO = ThisWorkbook.Worksheets(1).Range("MEMO_LIST").Value 'r|fffd|cup|fffd|ration valeur index m|fffd|mo
'---------------------------------------------------------------------------------------------------------
'2. Recherche ligne index du m|fffd|mo
ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUMBOUCLE_MEMO
LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row  'r|fffd|cup|fffd|re num ligne TAB_MEM_NUMBOUCLE_MEMO
BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
   For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
      If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = ID_MEMO Then 'prend nouvel index
         LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Row 'r|fffd|cup|fffd|re ligne index
      End If
   Next
'---------------------------------------------------------------------------------------------------------
'3. D|fffd|finition adresse m|fffd|mo
'Adresse de d|fffd|but
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
ADRESS_DEBUT = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
'Adresse de d|fffd|but
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
ADRESS_FIN = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
'---------------------------------------------------------------------------------------------------------
'4. Suppression m|fffd|mo feuille 2
If ADRESS_FIN <> "" Then 'si n'est pas qu'un brouillon vide
      ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, ADRESS_FIN).Clear 'suppression ancien memo
      ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Copy 'copie mod|fffd|le par d|fffd|faut
      ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Select 'aller sur la plage du m|fffd|mo
      ActiveSheet.Paste 'coller le modele par d|fffd|faut
            '---------------------------------------------------------------------------------------------------------
            'Routine de suppression image en trop
            COMPTEUR = 0
            For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image trombonne se cr|fffd|ant en plus |fffd| chaque copier coller
                If IMAGE.TopLeftCell.Address = ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Address Then
                  COMPTEUR = COMPTEUR + 1 'ajout 1 au compteur
                  If COMPTEUR > 1 Then IMAGE.Delete 'suppression de toute image en plus sur cellule adress debut
                End If
            Next
            '---------------------------------------------------------------------------------------------------------
            'Routine de remise en forme taille ligne m|fffd|mo par d|fffd|faut
            HAUT_MEMO = ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Rows.Count 'calcul de la hauteur du m|fffd|mo
            ReDim TAB_HAUT_LIG(HAUT_MEMO) 'dimensionnement du tableau des hauteurs de lignes
            '++++++++++++++++++++++++++++++++++++
               For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                  TAB_HAUT_LIG(lig) = ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL_TITR").Row + lig - 1, ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL_TITR").Column).Address).RowHeight 'index hauteur ligne dans tableau
               Next
            '++++++++++++++++++++++++++++++++++++
               For lign = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                  ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row + lign - 1, ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column).Address).RowHeight = TAB_HAUT_LIG(lign)
               Next
            '---------------------------------------------------------------------------------------------------------
End If
'5. M|fffd|j donn|fffd|es tableau
'5.a maj indic de suppression
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_SUPP").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_SUPP
If ADRESS_FIN <> "" Then 'si n'est pas qu'un brouillon vide
   ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "OUI"    'indicateur de suppression du m|fffd|mo dans le fond d'|fffd|cran
End If
'5.b maj indic d'|fffd|tat du m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_VALID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_VALID
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "NON"    'Annulation |fffd|tat valid|fffd|
'5.c maj adresse de fin du m|fffd|mo
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
'5.d maj titre du m|fffd|mo par d|fffd|faut |fffd| rien
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_TITRE").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_TITRE
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
'5.e maj index du m|fffd|mo par d|fffd|faut |fffd| rien
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUM
ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
'---------------------------------------------------------------------------------------------------------
'6. Suppression m|fffd|mo feuille 1
ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
ActiveSheet.Range("MEMO").ClearContents 'supp valeur m|fffd|mo
ActiveSheet.Range("MEMO_TITRE").Value = "M|fffd|mo t|fffd|che(s)" 'recr|fffd|a titre d'origine
ActiveSheet.Range("MEMO_CREA").Value = ActiveSheet.Range("MEMO_CREA").Value - 1 'r|fffd|duction de -1 suite |fffd| suppression  m|fffd|mo
ActiveSheet.Range("MEMO_LIST").Value = 1
   '------------------+++++++------------------------------------------------------------------------------
   '7.1 Tri tableau de gestion des m|fffd|mo par ordre num|fffd|rique du + petit au + grand
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Clear 'suppression du tri existant, pour raz
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Add Key:=ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal 'tri par ordre descendant en prenant en compte les valeur de la colonne TAB_MEM_NUM_COL
   With ActiveWorkbook.Worksheets("MEMOS").Sort 'ordre de tri avec ordre suivant
           .SetRange ThisWorkbook.Worksheets(2).Range("TAB_MEMO_LARGE") 'trier l'ensemble du tableu
           .Header = xlNo 'pas d'ent|fffd|te
           .MatchCase = False
           .Orientation = xlTopToBottom
           .SortMethod = xlPinYin
           .Apply
   End With
   '++++++++++++++++++++++++++++++++++++
   '7.2 Indexation num|fffd|ro m|fffd|mo + M|fffd|J index num|fffd|ro m|fffd|mo
   ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2
   BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
   If BOUCLE_MEMO = 0 Then BOUCLE_MEMO = 1
   For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
      ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = INDEX_MEM 'prend nouvel index
   Next
   '------------------+++++++------------------------------------------------------------------------------
'8. Process de fin
ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo supprim|fffd|!", True
MsgBox "Le m|fffd|mo a |fffd|t|fffd| supprim|fffd| de l'onglet M|fffd|mos et le sera aussi du fond d'|fffd|cran |fffd| la prochaine mise |fffd| jour.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub SUPPRIMER_TOUS() 'suppression de tous les m|fffd|mos cr|fffd||fffd|s + brouillards
Dim ID_MEMO, COL_TAB_MEM_NUM, LIGN_TAB_MEM_NUM, BOUCLE_MEMO, HAUT_MEMO, TAB_HAUT_LIG() As Double
Dim ADRESS_DEBUT, ADRESS_FIN As String
Dim STOP_BOUCLE As Boolean
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir supprimer l'ensemble des m|fffd|mos ? Cette action n'entrainera de suppression imm|fffd|diate dans le fond d'|fffd|cran tant que la mise |fffd| jour n'a pas |fffd|t|fffd| lanc|fffd|e.", vbOKCancel + vbQuestion + vbDefaultButton1, "ATTENTION DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
'1. R|fffd|cup|fffd|ration valeur index feuille 1
Application.EnableEvents = False 'desactiver event feuille
Application.ScreenUpdating = False 'desactivation affichage
Worksheets(1).Unprotect
ID_MEMO = 1 'r|fffd|cup|fffd|ration valeur index m|fffd|mo
STOP_BOUCLE = False
'---------------------------------------------------------------------------------------------------------
'2. Recherche ligne index du m|fffd|mo
ThisWorkbook.Worksheets(2).Select 'aller sur feuille 2
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUMBOUCLE_MEMO
LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row  'r|fffd|cup|fffd|re num ligne TAB_MEM_NUMBOUCLE_MEMO
   '++++++++___________________________________________________________________
   Do While STOP_BOUCLE = False
   '---------------------------------------------------------------------------------------------------------
   On Error GoTo 0
   On Error GoTo error_boucle: 'gestion process d'erreur
   '---------------------------------------------------------------------------------------------------------
   '++++++++___________________________________________________________________
   '------------------+++++++------------------------------------------------------------------------------
   '7.1 Tri tableau de gestion des m|fffd|mo par ordre num|fffd|rique du + petit au + grand
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Clear 'suppression du tri existant, pour raz
   ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Add Key:=ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal 'tri par ordre descendant en prenant en compte les valeur de la colonne TAB_MEM_NUM_COL
   With ActiveWorkbook.Worksheets("MEMOS").Sort 'ordre de tri avec ordre suivant
           .SetRange ThisWorkbook.Worksheets(2).Range("TAB_MEMO_LARGE") 'trier l'ensemble du tableu
           .Header = xlNo 'pas d'ent|fffd|te
           .MatchCase = False
           .Orientation = xlTopToBottom
           .SortMethod = xlPinYin
           .Apply
   End With
   '------------------+++++++------------------------------------------------------------------------------
         BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
            For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
               If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = ID_MEMO Then 'prend nouvel index
                  LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Row 'r|fffd|cup|fffd|re ligne index
               End If
            Next
         '---------------------------------------------------------------------------------------------------------
         '3. D|fffd|finition adresse m|fffd|mo
         'Adresse de d|fffd|but
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
         ADRESS_DEBUT = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
         'Adresse de fin
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
         ADRESS_FIN = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
         '---------------------------------------------------------------------------------------------------------
         '4. Suppression m|fffd|mo feuille 2
         If ADRESS_FIN <> "" Then 'si n'est pas qu'un brouillon vide
               ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, ADRESS_FIN).Clear 'suppression ancien memo
               ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Copy 'copie mod|fffd|le par d|fffd|faut
               ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Select 'aller sur la plage du m|fffd|mo
               ActiveSheet.Paste 'coller le modele par d|fffd|faut
                     '---------------------------------------------------------------------------------------------------------
                     'Routine de suppression image en trop
                     COMPTEUR = 0
                     For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image trombonne se cr|fffd|ant en plus |fffd| chaque copier coller
                         If IMAGE.TopLeftCell.Address = ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Address Then
                           COMPTEUR = COMPTEUR + 1 'ajout 1 au compteur
                           If COMPTEUR > 1 Then IMAGE.Delete 'suppression de toute image en plus sur cellule adress debut
                         End If
                     Next
                     '---------------------------------------------------------------------------------------------------------
                     'Routine de remise en forme taille ligne m|fffd|mo par d|fffd|faut
                     HAUT_MEMO = ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL").Rows.Count 'calcul de la hauteur du m|fffd|mo
                     ReDim TAB_HAUT_LIG(HAUT_MEMO) 'dimensionnement du tableau des hauteurs de lignes
                     '++++++++++++++++++++++++++++++++++++
                        For lig = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                           TAB_HAUT_LIG(lig) = ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL_TITR").Row + lig - 1, ThisWorkbook.Worksheets(2).Range("ARCHIV_MEMO_INITIAL_TITR").Column).Address).RowHeight 'index hauteur ligne dans tableau
                        Next
                     '++++++++++++++++++++++++++++++++++++
                        For lign = 1 To HAUT_MEMO 'boucle index hauteur ligne dans tableau
                           ThisWorkbook.Worksheets(2).Range(Cells(ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Row + lign - 1, ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT).Column).Address).RowHeight = TAB_HAUT_LIG(lign)
                        Next
                     '---------------------------------------------------------------------------------------------------------
         End If
         '5. M|fffd|j donn|fffd|es tableau
         '5.a maj indic de suppression
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_SUPP").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_SUPP
         If ADRESS_FIN <> "" Then 'si n'est pas qu'un brouillon vide
            ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "OUI"    'indicateur de suppression du m|fffd|mo dans le fond d'|fffd|cran
         End If
         '5.b maj indic d'|fffd|tat du m|fffd|mo
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_VALID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_VALID
         ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "NON"    'Annulation |fffd|tat valid|fffd|
         '5.c maj adresse de fin du m|fffd|mo
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
         ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
         '5.d maj titre du m|fffd|mo par d|fffd|faut |fffd| rien
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_TITRE").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_TITRE
         ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
         '5.e maj index du m|fffd|mo par d|fffd|faut |fffd| rien
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUM
         ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = ""    'suppression adresse
         '------------------+++++++------------------------------------------------------------------------------
         '7.1 Tri tableau de gestion des m|fffd|mo par ordre num|fffd|rique du + petit au + grand
         ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Clear 'suppression du tri existant, pour raz
         ActiveWorkbook.Worksheets("MEMOS").Sort.SortFields.Add Key:=ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal 'tri par ordre descendant en prenant en compte les valeur de la colonne TAB_MEM_NUM_COL
         With ActiveWorkbook.Worksheets("MEMOS").Sort 'ordre de tri avec ordre suivant
                 .SetRange ThisWorkbook.Worksheets(2).Range("TAB_MEMO_LARGE") 'trier l'ensemble du tableu
                 .Header = xlNo 'pas d'ent|fffd|te
                 .MatchCase = False
                 .Orientation = xlTopToBottom
                 .SortMethod = xlPinYin
                 .Apply
         End With
         '------------------+++++++------------------------------------------------------------------------------
error_boucle:

   ID_MEMO = ID_MEMO + 1 'mouvement marcheur index m|fffd|mo
   If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "" Then STOP_BOUCLE = True  'suppression adresse
   '++++++++___________________________________________________________________
   Loop
   '++++++++___________________________________________________________________
'---------------------------------------------------------------------------------------------------------
On Error GoTo 0: 'gestion process d'erreur
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'6. Suppression m|fffd|mo feuille 1
ThisWorkbook.Worksheets(1).Select 'aller sur feuille 1
ActiveSheet.Range("MEMO").ClearContents 'supp valeur m|fffd|mo
ActiveSheet.Range("MEMO_TITRE").Value = "M|fffd|mo t|fffd|che(s)" 'recr|fffd|a titre d'origine
ActiveSheet.Range("MEMO_CREA").Value = 0 'r|fffd|duction de -1 suite |fffd| suppression  m|fffd|mo
ActiveSheet.Range("MEMO_LIST").Value = ""
'---------------------------------------------------------------------------------------------------------
'7. Process de fin
Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">m|fffd|mo supprim|fffd|!", True
MsgBox "Les m|fffd|mo ont |fffd|t|fffd| supprim|fffd|s dans l'onglet M|fffd|mos et le seront dans le fond d'|fffd|cran |fffd| la prochaine mise |fffd| jour.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      Worksheets(1).Protect
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Sub MAJ_MEMO_FONDECRAN() 'M|fffd|J du fond d'|fffd|cran des m|fffd|mos
Dim IMAGE As Shape
Dim NOM_FONDECRAN, CHEMIN_FD, ADRESS_DEBUT, ADRESS_FIN As String
Dim PLACEMENT, LARGEUR_ECRAN, ID_MEMO, COL_TAB_MEM_NUM, LIGN_TAB_MEM_NUM, BOUCLE_MEMO, NOMBRE, LARGEUR_MEMO, ROGNER_LARGEUR, ROGNER_HAUTEUR As Double
Dim STOP_BOUCLE As Boolean
Dim PICTURA As Picture
'---------------------------------------------------------------------------------------------------------
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'0. Message de confirmation, pour annulation op|fffd|ration
Select Case MsgBox("|fffd|tes-vous s|fffd|rs de vouloir lancer le processus de mise |fffd| jour du fond d'|fffd|cran, afin d'y ins|fffd|rer vos m|fffd|mos ?", vbOKCancel + vbQuestion + vbDefaultButton1, "ATTENTION DEMANDE CONFIRMATION")
'Focus modal sur bouton 1 OK par d|fffd|faut afin de pouvoir faire une confirmation par user rapide en appuyant sur la touche entr|fffd|e
'Focus modal sur bouton 2 ANNULER par d|fffd|faut afin de pouvoir faire une annulation par user rapide en appuyant sur la touche echapp
   'I.b. Proc|fffd|dure si click Annulation, alors FIN et retour Excel
    Case vbCancel
    End 'Fin SUB / Retour Excel
    '+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    'I.a. Proc|fffd|dure si click Ok -> Lancement de la recherche de combinaison suite |fffd| confirmation User
    Case vbOK
    'Passe msgbox pour continuer le code
End Select
'---------------------------------------------------------------------------------------------------------
'0. D|fffd|sactivation fonction application
Application.EnableEvents = False 'activer event feuille
Application.ScreenUpdating = False 'activation affichage
Worksheets(1).Unprotect
'---------------------------------------------------------------------------------------------------------
'1. D|fffd|finition variables feuilles 1 Gestionnaire
PLACEMENT = ActiveSheet.Range("PLACEMENT_MEMO").Value 'd|fffd|finition index emplacement m|fffd|mo dans |fffd|cran
LARGEUR_ECRAN = ActiveSheet.Range("L_ECRAN_RESO").Value 'd|fffd|finition largeur r|fffd|solution |fffd|cran
CHEMIN_FD = ActiveSheet.Range("CHEMIN_FONDECRAN").Value 'd|fffd|finition du chemin complet avec nom fichier
NOM_FONDECRAN = Dir(ActiveSheet.Range("CHEMIN_FONDECRAN").Value)    ' d|fffd|finition nom fichier avec extension
ID_MEMO = 1 'r|fffd|cup|fffd|ration valeur index m|fffd|mo
LARGEUR_MEMO = 0 'fixe valeur de d|fffd|part d|fffd|placement m|fffd|mo dans fond d'|fffd|cran
ThisWorkbook.Worksheets(1).Range("MEMO_PLAC").Value = 0 'raz indicateur nb m|fffd|mo plac|fffd|
CHEMIN = ActiveSheet.Range("CHEMIN_FONDECRAN").Value 'd|fffd|finition chemin sans nom fichier
CHEMIN_COPIE_IMAGE = ActiveSheet.Range("CHEMIN_COPIE_FD").Value 'd|fffd|finition chemin fichier copie image
'-------------------++++++++++++++++++++++++++-----------------------------------------
   'Routine de remplacement par la sauvegarde du fichier fond d'|fffd|cran afin de r|fffd|initialiser convenablement le fond d'|fffd|cran
   If Not Len(Dir(CHEMIN_COPIE_IMAGE & "copie " & NOM_FONDECRAN)) > 0 Then 'si pas existant, veut dire que fichier copie inexistant
      'MsgBox "La copie de sauvegarde du fond d'|fffd|cran n'existe plus ou n'a plus son nom de sauvegarde.", vbExclamation, "INFORMATION"   'fichier existant abondon de l'importation pour que l'user corrige son choix
      'Application.ScreenUpdating = True 'activation raffraichissement affichage
      'Application.EnableEvents = True 'activer event feuille
      'Worksheets(1).Protect
      'Exit Sub
   Else 'si non existant remettre fichier original
      FileCopy CHEMIN_COPIE_IMAGE & "copie " & NOM_FONDECRAN, CHEMIN     'Copie fichier suivant chemin save dans chemin d'origine
   End If
'---------------------------------------------------------------------------------------------------------'---------------------------------------------------------------------------------------------------------
'2. Action suppression ancienne images m|fffd|mo si existantes en onglet wallpaper
ThisWorkbook.Worksheets(3).Select 'aller en feuille wallpaper
For Each IMAGE In Worksheets(3).Shapes 'boucle de suppression d'image
    If Not IMAGE.Name Like "*GEROMEMO*" And Not IMAGE.Name Like "*signet*" And Not IMAGE.Name Like "*FD*" Then IMAGE.Delete  'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
'---------------------------------------------------------------------------------------------------------
'3. Action copie image m|fffd|mo de feuille 2 m|fffd|mos |fffd| feuille 3 wallpaper
ThisWorkbook.Worksheets(2).Select 'aller en feuille m|fffd|mos
COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_NUMBOUCLE_MEMO
LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Row  'r|fffd|cup|fffd|re num ligne TAB_MEM_NUMBOUCLE_MEMO
   '++++++++___________________________________________________________________
   Do While STOP_BOUCLE = False 'Boucle export m|fffd|mo
         '---------------------------------------------------------------------------------------------------------
         On Error GoTo 0
         On Error GoTo error_boucle: 'gestion process d'erreur
         '---------------------------------------------------------------------------------------------------------
         '3.1 Recherche ligne memo dans tableau
         BOUCLE_MEMO = Application.WorksheetFunction.CountA(ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM_COL").Rows) 'calcul nb ligne dans tableau
            For INDEX_MEM = 1 To BOUCLE_MEMO 'boucle de recalcul num|fffd|ro m|fffd|mo (conserve leur ordre d'index suite au tri)
               If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Value = ID_MEMO Then 'prend nouvel index
                  LIGN_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + INDEX_MEM, COL_TAB_MEM_NUM).Address).Row 'r|fffd|cup|fffd|re ligne index
               End If
            Next
         '---------------------------------------------------------------------------------------------------------
      COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_VALID").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_VALID
      If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value = "OUI" Then 'calcul si m|fffd|mo bien valid|fffd| pour export
         '3.2 D|fffd|finition adresse m|fffd|mo
         'Adresse de d|fffd|but
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADEB").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
         ADRESS_DEBUT = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
         'Adresse de fin
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_ADFIN").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADFIN
         ADRESS_FIN = ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM, COL_TAB_MEM_NUM).Address).Value    'reprise valeur adresse plage m|fffd|mo archiv|fffd|
         '---------------------------------------------------------------------------------------------------------
         '3.3 Traitement m|fffd|mo vers wallpaper
         ThisWorkbook.Worksheets(2).Range(ADRESS_DEBUT, ADRESS_FIN).Copy 'copier plage m|fffd|mo
         ThisWorkbook.Worksheets(3).Select 'aller en feuille wallpaper
         ThisWorkbook.Worksheets(3).Range("A6").Select 'se placer en haut |fffd| gauche du fond d'|fffd|cran
         ActiveSheet.Pictures.Paste.Select 'coller image
         Selection.Left = (LARGEUR_ECRAN / (1 + 2 / 3) / PLACEMENT) + LARGEUR_MEMO  'placement du m|fffd|mo selon calculs
         LARGEUR_MEMO = LARGEUR_MEMO + (ThisWorkbook.Worksheets(1).Range("MEMO_LARG").Value + 5) / (1 + 2 / 3) 'Mouvement emplacement m|fffd|mo suivant
         Selection.Top = Selection.Top + 10 'calculs ajustement emplacement en hauteur
         ThisWorkbook.Worksheets(2).Select 'aller en feuille memos
         ThisWorkbook.Worksheets(1).Range("MEMO_PLAC").Value = ThisWorkbook.Worksheets(1).Range("MEMO_PLAC").Value + 1 'm|fffd|j |fffd|tat placement
      End If
         '------------------+++++++------------------------------------------------------------------------------
error_boucle:

         ID_MEMO = ID_MEMO + 1 'mouvement marcheur index m|fffd|mo
         '---------------------------------------------------------------------------------------------------------
         '3.1 Recherche ligne memo dans tableau
         COL_TAB_MEM_NUM = ThisWorkbook.Worksheets(2).Range("TAB_MEM_NUM").Column 'r|fffd|cup|fffd|re num colonne TAB_MEM_ADEB
         If ThisWorkbook.Worksheets(2).Range(Cells(LIGN_TAB_MEM_NUM + 1, COL_TAB_MEM_NUM).Address).Value = "" Then STOP_BOUCLE = True 'test arret boucle
         '++++++++___________________________________________________________________
   Loop
   '++++++++___________________________________________________________________
'---------------------------------------------------------------------------------------------------------
On Error GoTo 0
On Error GoTo error: 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'4. Export image interne excel vers disque dur
ThisWorkbook.Worksheets(3).Select 'aller en feuille wallpaper
ActiveSheet.Shapes("FD").PLACEMENT = xlMove 'd|fffd|finir propri|fffd|t|fffd| ne pas agrandir image si modif taille cellule
ThisWorkbook.Worksheets(3).Range(ActiveSheet.Shapes("FD").TopLeftCell.Address, ActiveSheet.Shapes("FD").BottomRightCell.Address).Select  's|fffd|lection plage cellule fond d'|fffd|cran
Selection.Copy 'copier plage
ThisWorkbook.Worksheets(3).Range("A6").Select 'reselectionner cellule d'emplacement fond d'|fffd|cran
ActiveSheet.Pictures.Paste.Select 'coller image
Selection.ShapeRange.Name = "EXPORT" 'd|fffd|finition nom nouvelle image plage fond d'|fffd|cran
Selection.Cut 'couper image pour ne pas |fffd| avoir |fffd| coder une ligne pour la supprimer
   '++++++++___________________________________________________________________
   'Fonction export image en fond '|fffd|cran
   ThisWorkbook.Worksheets(5).Select 'Aller dans feuille export pour simplifier le calcul d'envoi de l'image
   ThisWorkbook.Worksheets(5).Range("A1").Select
   ActiveSheet.Paste 'coller image export
   '---------------------------------------------------------------------------------------------------------
   ROGNER_LARGEUR = ThisWorkbook.Worksheets(1).Range("L_ECRAN_RESO").Value / (Selection.ShapeRange.PictureFormat.Crop.PictureWidth * (2 / 3 + 1)) 'calcul coef de rognage nouvelle image du surplus gauche
   ROGNER_HAUTEUR = ThisWorkbook.Worksheets(1).Range("H_ECRAN_RESO").Value / (Selection.ShapeRange.PictureFormat.Crop.PictureHeight * (2 / 3 + 1)) 'calcul coef de rognage nouvelle image du surplus bas
   Selection.ShapeRange.PictureFormat.CropRight = Selection.ShapeRange.PictureFormat.Crop.PictureWidth * (1 - ROGNER_LARGEUR) * (2 / 3 + 1) 'rogner nombre de point x pour reprendre ancien format r|fffd|solution
   Selection.ShapeRange.PictureFormat.CropBottom = Selection.ShapeRange.PictureFormat.Crop.PictureHeight * (1 - ROGNER_HAUTEUR) * (2 / 3 + 1) 'rogner nombre de point y pour reprendre ancien format r|fffd|solution |fffd|cran
   '---------------------------------------------------------------------------------------------------------
   Dim ChartObj As ChartObject
   For Each PICTURA In ActiveSheet.Pictures 'boucle export image interne en fond d'|fffd|cran
       PICTURA.CopyPicture 'copie l'image
       Set ChartObj = ActiveSheet.ChartObjects.Add(0, 0, PICTURA.Width, PICTURA.Height)
            ChartObj.Activate  'activer le graph chart pour |fffd|viter bug export image vers disque dur depuis bug 11/2017
            ChartObj.Chart.Paste 'colle l'image dans un graphique temporaire
            ChartObj.Chart.Export CHEMIN_FD 'Sauvegarde au format image, dans le m|fffd|me r|fffd|pertoire que ce classeur.
        'Supprime le graphique
        NOMBRE = ActiveSheet.ChartObjects.Count
        ActiveSheet.ChartObjects(NOMBRE).Delete
   Next PICTURA
   '++++++++___________________________________________________________________
   For Each IMAGE In Worksheets(5).Shapes 'boucle de suppression d'image
       IMAGE.Delete  'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
   Next
'---------------------------------------------------------------------------------------------------------
'5. Process de fin
ThisWorkbook.Worksheets(1).Select
Application.EnableEvents = True 'activer event feuille
Application.ScreenUpdating = True 'activation affichage
Worksheets(1).Protect
If CTRLE_NARR.Value = True Then Application.Speech.Speak ">Fond d'|fffd|cran! mis |fffd| jour", True
MsgBox "Le fond d'|fffd|cran a |fffd|t|fffd| mis |fffd| jour des m|fffd|mos valid|fffd|s.", vbInformation, "INFORMATION"
'---------------------------------------------------------------------------------------------------------
error: 'gestion process d'erreur
   If Err Then 'si erreur
      Worksheets(1).Protect
      Application.EnableEvents = True 'activer event feuille
      Application.ScreenUpdating = True 'activation affichage
      If CTRLE_NARR.Value = True Then Application.Speech.Speak ">erreur!", True
      MsgBox "Une erreur est intervenue, le code g|fffd|re des cellules nomm|fffd|es, veuillez v|fffd|rifier que vous n'avez pas modifi|fffd| ces cellules, sans en avoir fait la modification dans le code VBA." & "Description syst|fffd|me de l'erreur: " & Err.Description, vbCritical, "ERREUR"
   End If
End Sub


Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
'<<!>> L'ordre des proc|fffd|dures est importante, risque de m|fffd|li m|fffd|lo et bug
'---------------------------------------------------------------------------------------------------------
On Error Resume Next
'---------------------------------------------------------------------------------------------------------
'>> I. D|fffd|sactivation entr|fffd|e par double click dans TABLEUR PROTECTION
If Not Intersect(Target, ActiveSheet.Range("PROTECTION")) Is Nothing Then 'Emp|fffd|cher entr|fffd|e apr|fffd|s double clic
   Cancel = True
End If
End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
'<<!>> L'ordre des proc|fffd|dures est importante, risque de m|fffd|li m|fffd|lo et bug
On Error Resume Next
'I. Interdiction de suppression Ent|fffd|te Tableur PROTECTION
'>> I.  Interdiction de saisie par annulation de modification
    If Not Intersect(Target, ActiveSheet.Range("PROTECTION")) Is Nothing Then
      Application.EnableEvents = False      'D|fffd|sactivation de la fonction de gestion d'|fffd|v|fffd|nement |fffd|viter micro freezing
      Application.Undo
      Application.EnableEvents = True      'R|fffd|activation de la fonction de gestion d'|fffd|v|fffd|nement
    End If
End Sub

Sub SUPP_IMAGE_TROMBONNE() 'Macro routine de suppression g|fffd|n|fffd|rale d'image trombonne
Dim IMAGE As Shape, COMPTEUR As Double
For Each IMAGE In Worksheets(1).Shapes 'boucle de suppression d'image trombonne se cr|fffd|ant en plus |fffd| chaque copier coller
    If IMAGE.Name Like "*trombonne*" Then
      COMPTEUR = COMPTEUR + 1 'ajout 1 au compteur
      If COMPTEUR > 1 Then IMAGE.Delete 'supprimer image si plus d'une dans la feuille
    End If
Next
End Sub


Sub SUPP_IMAGE_TROMBONNE_FEUIL2() 'Macro routine de suppression g|fffd|n|fffd|rale d'image trombonne
Dim IMAGE As Shape, COMPTEUR As Double
For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image trombonne se cr|fffd|ant en plus |fffd| chaque copier coller
    If IMAGE.TopLeftCell.Address = Worksheets(2).Range("MEMO8").Address Then
      COMPTEUR = COMPTEUR + 1 'ajout 1 au compteur
      If COMPTEUR > 1 Then MsgBox "oui " & COMPTEUR
    End If
Next
End Sub

Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'---------------------------------------------------------------------------------------------------------
'EVENEMENTS / FONCTIONS FEUILLE MEMOS
'Feuille onglet MEMOS d'archivage donn|fffd|es relatives aux m|fffd|mo |fffd| placer en fond d'|fffd|cran
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Sub Worksheet_Activate() 'Faire tourner le smiley
'Sub FORMAT_FEUILMEMO() 'formatage auto feuille pour m|fffd|mos
'---------------------------------------------------------------------------------------------------------




Private Sub Worksheet_Activate() 'Faire tourner le smiley
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Faire tourner
ActiveSheet.Range("A2").Select
If ThisWorkbook.Worksheets(1).CTRLE_NARR.Value = True Then Application.Speech.Speak ">base m|fffd|mos!", True
Dim DEGREE_ROTATION As Double 'D|fffd|claration variable DEGREE_ROTATION comme valeur double.
DEGREE_ROTATION = 0 'D|fffd|finition du degr|fffd| de rotation de d|fffd|part du smiley dans la boite |fffd| 0 degr|fffd|s
Do While IsEmpty(ThisWorkbook.Worksheets(1).Range("XFC1")) 'Boucle sans fin DO WHILE ... > LOOP, Rotation infinie du smiley, Tant que cellule XFC1 vide (mais |fffd|a c'est un secret)
   DoEvents 'Raffraichissement application pour voir tourner le smiley
   If DEGREE_ROTATION >= 350 Then   'Process de sortie de boucle de rotation quand tour complet r|fffd|alis|fffd|
      ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = 0 'retour degr|fffd|s de rotation |fffd| 0
      Exit Do 'Sortie de boucle Do while
   End If
   ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = DEGREE_ROTATION   'Rotation du smiley |fffd| la valeur DEGREE_ROTATION
   DEGREE_ROTATION = DEGREE_ROTATION + 4   'Ajout +10 degr|fffd|s |fffd| DEGREE_ROTATION pour la prochaine rotation
Loop
End Sub


Sub FORMAT_FEUILMEMO() 'formatage auto feuille pour m|fffd|mos
Dim col1, col2, colonne, ligne, lig1, couleur As Double
Dim texto As String
'---------------------------------------------------------------------------------------------------------
col1 = 26.44 '245p
col2 = 0.31 '5p
lig1 = 28.2 '47p
colonne = ThisWorkbook.Worksheets(2).Range("DEB_COPIE_MEMO").Column - 1
ligne = ThisWorkbook.Worksheets(2).Range("DEB_COPIE_MEMO").Row
couleur = ThisWorkbook.Worksheets(2).Range("DEB_COPIE_MEMO").Interior.Color
texto = "MEMO"
'---------------------------------------------------------------------------------------------------------
For col = 1 To 16
   Columns(colonne + col).ColumnWidth = 26.44
   Columns(colonne + col + 1).ColumnWidth = 0.31
   Rows(ligne).RowHeight = 28.2
   ActiveSheet.Range(Cells(ligne, colonne + col).Address).Interior.Color = couleur
   ThisWorkbook.Worksheets(2).Range(Cells(Range("TAB_MEM_ADEB").Row + col, Range("TAB_MEM_ADEB").Column).Address).Value = ActiveSheet.Range(Cells(ligne, colonne + col).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
   ActiveWorkbook.Names.Add Name:=texto & col, RefersToR1C1:="=MEMOS!R" & ligne & "C" & (colonne + col)
   '---------------------------------------------------------------------------------------------------------
   colonne = colonne + 1
   ligne = ligne + 100
Next
'---------------------------------------------------------------------------------------------------------
End Sub
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'---------------------------------------------------------------------------------------------------------
'EVENEMENTS / FONCTIONS FEUILLE WALLPAPER
'Feuille onglet WALLPAPER d'archivage fond d'|fffd|cran et de gestion des images m|fffd|mo pour cr|fffd|ation
'd'une nouvelle image |fffd| partir la plage comme fond d'|fffd|cran
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Sub Worksheet_Activate() 'Faire tourner le smiley
'---------------------------------------------------------------------------------------------------------




Private Sub Worksheet_Activate() 'Faire tourner le smiley
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Faire tourner
ActiveSheet.Range("A2").Select
If ThisWorkbook.Worksheets(1).CTRLE_NARR.Value = True Then Application.Speech.Speak ">Fond d'|fffd|cran!", True
Dim DEGREE_ROTATION As Double 'D|fffd|claration variable DEGREE_ROTATION comme valeur double.
DEGREE_ROTATION = 0 'D|fffd|finition du degr|fffd| de rotation de d|fffd|part du smiley dans la boite |fffd| 0 degr|fffd|s
Do While IsEmpty(ThisWorkbook.Worksheets(1).Range("XFC1")) 'Boucle sans fin DO WHILE ... > LOOP, Rotation infinie du smiley, Tant que cellule XFC1 vide (mais |fffd|a c'est un secret)
   DoEvents 'Raffraichissement application pour voir tourner le smiley
   If DEGREE_ROTATION >= 350 Then   'Process de sortie de boucle de rotation quand tour complet r|fffd|alis|fffd|
      ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = 0 'retour degr|fffd|s de rotation |fffd| 0
      Exit Do 'Sortie de boucle Do while
   End If
   ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = DEGREE_ROTATION   'Rotation du smiley |fffd| la valeur DEGREE_ROTATION
   DEGREE_ROTATION = DEGREE_ROTATION + 4   'Ajout +10 degr|fffd|s |fffd| DEGREE_ROTATION pour la prochaine rotation
Loop
End Sub
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'---------------------------------------------------------------------------------------------------------
'EVENEMENTS / FONCTIONS FEUILLE AIDE
'Feuille onglet d'aide, d'explication fonctionnement classeur + outil de dev.
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Sub Worksheet_Activate() 'Faire tourner le smiley
'OUTILS_DEV() 'Afficher l'userform d'outillage de dev
'---------------------------------------------------------------------------------------------------------




Private Sub Worksheet_Activate() 'Faire tourner le smiley
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'gestion process d'erreur
'---------------------------------------------------------------------------------------------------------
'1. Faire tourner
ActiveSheet.Range("A2").Select
If ThisWorkbook.Worksheets(1).CTRLE_NARR.Value = True Then Application.Speech.Speak ">Aide!", True
Dim DEGREE_ROTATION As Double 'D|fffd|claration variable DEGREE_ROTATION comme valeur double.
DEGREE_ROTATION = 0 'D|fffd|finition du degr|fffd| de rotation de d|fffd|part du smiley dans la boite |fffd| 0 degr|fffd|s
Do While IsEmpty(ThisWorkbook.Worksheets(1).Range("XFC1")) 'Boucle sans fin DO WHILE ... > LOOP, Rotation infinie du smiley, Tant que cellule XFC1 vide (mais |fffd|a c'est un secret)
   DoEvents 'Raffraichissement application pour voir tourner le smiley
   If DEGREE_ROTATION >= 350 Then   'Process de sortie de boucle de rotation quand tour complet r|fffd|alis|fffd|
      ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = 0 'retour degr|fffd|s de rotation |fffd| 0
      Exit Do 'Sortie de boucle Do while
   End If
   ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = DEGREE_ROTATION   'Rotation du smiley |fffd| la valeur DEGREE_ROTATION
   DEGREE_ROTATION = DEGREE_ROTATION + 4   'Ajout +10 degr|fffd|s |fffd| DEGREE_ROTATION pour la prochaine rotation
Loop
End Sub


Sub OUTILS_DEV() 'Afficher l'userform d'outillage de dev
OUTIL_DEV.Show 'afficher
End Sub
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'---------------------------------------------------------------------------------------------------------
'Feuille technique cach|fffd|e pour calcul simplifi|fffd| export image
'---------------------------------------------------------------------------------------------------------

Attribute VB_Name = "OUTIL_DEV"
Attribute VB_Base = "0{AF2A1A9C-1C32-4B4E-9DDA-4188EF647290}{5C128966-BF1C-451E-B72F-610C24CFFEB3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Userform d'outils de dev
'1. Gestion d'image
'2. Gestion events
'---------------------------------------------------------------------------------------------------------




'---------------------------------------------------------------------------------------------------------
'Gestion d'image
Private Sub CommandButton1_Click() 'calcul nb d'image x dans feuille y
Dim IMAGE As Shape, COMPTEUR, ONGLET As Double, Nom_image As String
On Error GoTo error:
COMPTEUR = 0
ONGLET = TextBox2.Value
Nom_image = TextBox1.Value
For Each IMAGE In Worksheets(ONGLET).Shapes 'boucle de suppression d'image
    If IMAGE.Name Like Nom_image Then COMPTEUR = COMPTEUR + 1 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
MsgBox "Nb d'image cherch|fffd| : " & COMPTEUR, vbExclamation, "Outil dev."
error:
   If Err Then
      MsgBox Err.Description, vbExclamation, "Outil dev."
      MsgBox "arr|fffd|t macro", vbExclamation, "Outil dev."
   End If
End Sub


Private Sub CommandButton2_Click() 'suppression image x dans feuille y
Dim IMAGE As Shape, COMPTEUR, ONGLET As Double, Nom_image As String
On Error GoTo error:
COMPTEUR = 0
ONGLET = TextBox2.Value
Nom_image = TextBox1.Value
For Each IMAGE In Worksheets(ONGLET).Shapes 'boucle de suppression d'image
    If IMAGE.Name Like Nom_image Then IMAGE.Delete 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
MsgBox "suppression termin|fffd|e de " & Nom_image & " dans feuille " & ONGLET, vbExclamation, "Outil dev."
error:
   If Err Then
      MsgBox Err.Description, vbExclamation, "Outil dev."
      MsgBox "arr|fffd|t macro", vbExclamation, "Outil dev."
   End If
End Sub
'---------------------------------------------------------------------------------------------------------






'---------------------------------------------------------------------------------------------------------
'Gestion events
Private Sub CommandButton4_Click()
Application.EnableEvents = True 'activation
End Sub


Private Sub CommandButton3_Click()
Application.EnableEvents = False 'd|fffd|sactivation
End Sub
'---------------------------------------------------------------------------------------------------------


Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Initialize()
Me.Height = 287.25
Me.Width = 201

End Sub
Attribute VB_Name = "PLAC_MEMO"
Attribute VB_Base = "0{ABBEFA1D-0E5F-4F21-9FB6-BE630D3BECD7}{182ADC94-E245-4625-B64F-B9BAC0A0C678}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Userform de placement d'image m|fffd|mo en fond d'|fffd|cran
'CommandButton1_Click() 'Bouton fermer
'OP2_Click() 'controleur de choix d'emplacement des m|fffd|mos
'OP3_Click() 'controleur de choix d'emplacement des m|fffd|mos
'OP4_Click() 'controleur de choix d'emplacement des m|fffd|mos
'OP5_Click() 'controleur de choix d'emplacement des m|fffd|mos
'UserForm_Initialize() '|fffd|vent |fffd| l'initialisation de l'userform
'---------------------------------------------------------------------------------------------------------




Private Sub CommandButton1_Click() 'Bouton fermer
Me.Hide 'cache l'userform
End Sub


Private Sub OP2_Click() 'controleur de choix d'emplacement des m|fffd|mos
ActiveSheet.Range("PLACEMENT_MEMO").Value = Me.OP2.Caption 'indexer dans tableur choix
End Sub


Private Sub OP3_Click() 'controleur de choix d'emplacement des m|fffd|mos
ActiveSheet.Range("PLACEMENT_MEMO").Value = Me.OP3.Caption 'indexer dans tableur choix
End Sub


Private Sub OP4_Click() 'controleur de choix d'emplacement des m|fffd|mos
ActiveSheet.Range("PLACEMENT_MEMO").Value = Me.OP4.Caption 'indexer dans tableur choix
End Sub


Private Sub OP5_Click() 'controleur de choix d'emplacement des m|fffd|mos
ActiveSheet.Range("PLACEMENT_MEMO").Value = Me.OP5.Caption 'indexer dans tableur choix
End Sub


Private Sub UserForm_Initialize() '|fffd|vent |fffd| l'initialisation de l'userform
ActiveSheet.Range("PLACEMENT_MEMO").Value = Me.OP5.Caption 'indexer dans tableur choix
Me.OP5.Value = True
Me.Height = 486
Me.Width = 696.75

End Sub
Attribute VB_Name = "PROPRIETES_DIVERS"
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

'---------------------------------------------------------------------------------------------------------
'MODULE PROPRIETES / DIVERS
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'D|fffd|claration gestion ref 32bits d'impatation d'image
'Sub Test_Bug_images
'Sub COLOR_CTRLE_SUIVANT_CEL() 'archive code gestion couleur
'Sub SUPP_IMAGE()
'Sub ExtractionImagesFeuille()
'Sub rogner_image()
'---------------------------------------------------------------------------------------------------------


'---------------------------------------------------------------------------------------------------------
'Concerne la macro d'importation de fond d'|fffd|cran en feuille 1
Declare PtrSafe Function GetSystemMetrics32 Lib "User32" Alias "GetSystemMetrics" (ByVal nIndex As Long) As Long   'D|fffd|claration publique r|fffd|f|fffd|rence pour g|fffd|rer la r|fffd|solution d'|fffd|cran
'---------------------------------------------------------------------------------------------------------




Sub Test_Bug_images()
Dim IMAGE As Shape, COMPTEUR As Double
COMPTEUR = 0
For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image
    'If IMAGE.Name Like "*trombonne*" Then IMAGE.Delete 'compteur = compteur + 1 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
    If IMAGE.Name Like "*trombonne*" Then COMPTEUR = COMPTEUR + 1 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
MsgBox COMPTEUR
End Sub


Private Sub COLOR_CTRLE_SUIVANT_CEL() 'archive code gestion couleur
Me.CTRLE_NARR.BackColor = Range("K3").Interior.Color 'm|fffd|mo code transfert couleur cellule dans controleur
End Sub


Sub SUPP_IMAGE()
Dim IMAGE As Shape
For Each IMAGE In Worksheets(2).Shapes 'boucle de suppression d'image
    If Not IMAGE.Name Like "*Image*" Then IMAGE.Delete 'supprimer tous les objets sauf ceux pr|fffd|nomm|fffd|s
Next
End Sub


Sub ExtractionImagesFeuille()
    Dim Pict As Picture
    Dim Nb As Byte
    Application.ScreenUpdating = False
    For Each Pict In ActiveSheet.Pictures
        Pict.CopyPicture 'copie l'image
        With ActiveSheet.ChartObjects.Add(0, 0, Pict.Width, Pict.Height).Chart
            .Paste 'colle l'image dans un graphique temporaire
            'Sauvegarde au format image, dans le m|fffd|me r|fffd|pertoire que ce classeur.
            .Export "C:\Users\" & "\" & Pict.Name & ".gif", "GIF"
        End With
        'Supprime le graphique
        Nb = ActiveSheet.ChartObjects.Count
        ActiveSheet.ChartObjects(Nb).Delete
    Next Pict
    Application.ScreenUpdating = True
End Sub


Sub rogner_image()
'Cet exemple montre comment rogner 20 points du c|fffd|t|fffd| gauche de la forme 3 dans myDocument. Pour que l'exemple fonctionne, la forme 3 doit |fffd|tre soit une image soit un objet OLE.
Set myDocument = Worksheets(1)
myDocument.Shapes(3).PictureFormat.CropLeft = 20
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'/////////////////////////////////////////////////////////////////////////////////////////////////////////
'GEROMEMO - Gestionnaire de m|fffd|mos sur fond d'|fffd|cran
'Cod|fffd| par COHENNY Tristan 'Waard' pour Excel-Pratique.com
'Application libre de droits
'\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


'                                    \\/
'__________________ ( O-O)/*  ____________________________________
'Appli. en codage ouvert pour permettre d'|fffd|tre adapt|fffd|e ailleurs, cr|fffd||fffd|e en m'inspirant du point du sondage-excel-idees :
' "Un syst|fffd|me de planification comme des post-it qui pourrait |fffd|tre le fond d'ecran du PC et modifiable en fonction de l'avanc|fffd|e des t|fffd|ches"
'http://www.excel-pratique.com/fr/sondage-excel-idees.php
'
'Pour m|fffd|mo ;o), il y'a des appli. planning et de pr|fffd|visionnel assez proche du th|fffd|me de la plannification dans ces liens :
'http://www.excel-pratique.com/fr/telechargements/plannings-c14.php
'http://www.excel-pratique.com/fr/telechargements/gestion-du-personnel-c9.php
'http://www.excel-pratique.com/fr/telechargements/outils-de-gestion/excellab-suivi-des-taches-no182.php
'                                    \\/
'__________________ ( O-O)/*  ____________________________________



'---------------------------------------------------------------------------------------------------------
'EVENEMENTS CLASSEUR
'---------------------------------------------------------------------------------------------------------
'SOMMAIRE
'Sub Workbook_Open() 'Ev|fffd|nement |fffd| l'ouverture du classeur
'---------------------------------------------------------------------------------------------------------




Private Sub Workbook_Open() 'Ev|fffd|nement |fffd| l'ouverture du classeur
'---------------------------------------------------------------------------------------------------------
On Error Resume Next 'process gestion erreur
'---------------------------------------------------------------------------------------------------------
If ThisWorkbook.Worksheets(1).CTRLE_NARR.Value = True Then Application.Speech.Speak "GEROMEMO", True
ThisWorkbook.Worksheets(2).Range("NOM_FICHIER").Value = ThisWorkbook.Name
ThisWorkbook.Worksheets(1).Range("K20").Select
Dim DEGREE_ROTATION As Double 'D|fffd|claration variable DEGREE_ROTATION comme valeur double.
DEGREE_ROTATION = 0 'D|fffd|finition du degr|fffd| de rotation de d|fffd|part du smiley dans la boite |fffd| 0 degr|fffd|s
Do While IsEmpty(ThisWorkbook.Worksheets(1).Range("XFC1")) 'Boucle sans fin DO WHILE ... > LOOP, Rotation infinie du smiley, Tant que cellule XFC1 vide (mais |fffd|a c'est un secret)
   DoEvents 'Raffraichissement application pour voir tourner le smiley
   If DEGREE_ROTATION >= 350 Then   'Process de sortie de boucle de rotation quand tour complet r|fffd|alis|fffd|
      ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = 0 'retour degr|fffd|s de rotation |fffd| 0
      Exit Do 'Sortie de boucle Do while
   End If
   ActiveSheet.Shapes.Range(Array("GEROMEMO")).ThreeD.RotationX = DEGREE_ROTATION   'Rotation du smiley |fffd| la valeur DEGREE_ROTATION
   DEGREE_ROTATION = DEGREE_ROTATION + 5   'Ajout +10 degr|fffd|s |fffd| DEGREE_ROTATION pour la prochaine rotation
Loop
End Sub



INQUEST-PP=macro
