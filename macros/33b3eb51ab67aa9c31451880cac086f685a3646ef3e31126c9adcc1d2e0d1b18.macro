Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

  Private Sub Worksheet_Change(ByVal Target As Range)

'    'Maj|fffd| spole|fffd|nou dom|fffd|cnost, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
'    'If Target.Address = "$C$33" And Thisworkbook.Sheets("A_Predbezna_nabidka").Range("D96").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost" Then
'    If Target.Address = "$C$33" Then
'     Call adresy_na_listB_spoluzadatel
'    End If

    'propsat datum narozen|fffd| na list A - |fffd|adatel
    If Target.Address = "$C$13" Then
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C49").Value = Range("C16").Value
    End If
    'propsat datum narozen|fffd| na list A - spolu|fffd|adatel
    If Target.Address = "$D$13" Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D49").Value = Range("D16").Value
    End If

    'propsat ob|fffd|anstv|fffd| na list A - |fffd|adatel
    If Target.Address = "$C$12" And ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C67").Value <> Range("C12").Value Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C67").Value = Range("C12").Value
    End If
    'propsat ob|fffd|anstv|fffd| na list A - spolu|fffd|adatel
    If Target.Address = "$D$12" And ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D67").Value <> Range("D12").Value Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D67").Value = Range("D12").Value
    End If
    
    If Target.Address = "$C$36" Or Target.Address = "$D$36" Or Target.Address = "$C$41" Or Target.Address = "$D$41" Or Target.Address = "$C$66" Or Target.Address = "$D$66" Then
        Call PSC_format_CR
    End If
  End Sub
  
Sub PSC_format_CR()
Dim abc
  abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
  ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
        
        If ActiveCell.Value <> "|fffd|esk|fffd| republika" And ActiveCell.Value <> "" And Mid(ActiveCell, 1, 1) <> "=" Then
            ' form|fffd|t PS|fffd|, kdy|fffd| nen|fffd| zvolena |fffd|esk|fffd| republika, chov|fffd| se jako text, jinak nap|fffd| 110 00 (s mezerou)
            'ActiveCell.Offset(-1, 0).Value = ""
            'PSC = ActiveCell.Offset(-1, 0).Value
            ActiveCell.Offset(-1, 0).NumberFormat = "000 00"
            'ActiveCell.Offset(-1, 0).Value = PSC
            'ActiveCell.Offset(-1, 0).Select
        Else
            'Kdy|fffd| zvolena |fffd|esk|fffd| republika... nastaven form|fffd|t |fffd|esk|fffd|ho PS|fffd| a vymaz|fffd|na p|fffd||fffd|padn|fffd| nesmysln|fffd| hodnota
            'ActiveCell.Offset(-1, 0).Value = ""
            ActiveCell.Offset(-1, 0).NumberFormat = "000 00"
            'ActiveCell.Offset(-1, 0).Select
        End If
        
   ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
End Sub

Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub doplnit_dnesni_datum()
    Range("C9").Value = Date
End Sub
    
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim abc
    Dim puv_datum_splatky
    Dim screenUpdatePred
    
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    'on change (C19:C25, C29)
    If Target.Address = "$C$9" Or Target.Address = "$C$19" Or Target.Address = "$C$20" Or Target.Address = "$C$21" Or Target.Address = "$C$22" Or Target.Address = "$C$23" Or Target.Address = "$C$24" Or Target.Address = "$C$25" Or Target.Address = "$C$29" Or Target.Address = "$C$32" Then
    Call vypocti_splatku_automaticky
    End If
    
    'ID externisty dot|fffd|hne ostatn|fffd| |fffd|daje (jm|fffd|no, tel, n|fffd|zev spole|fffd|nosti), pouze pokud verze ESC a d|fffd|lka ID = 8
    If Target.Address = "$C$11" And Len(ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C11").Value) = 8 And ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC" Then
    'Range("C12").Value = ""
    '''MsgBox "ID =" & ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C11").Value
    End If
    
    'vyma|fffd|e detail produktu, pokud je hl|fffd|ka o tom, |fffd|e k tomuto 'typu produktu' nelze poskytnout tento 'detail produktu'
    If Target.Address = "$C$19" Or Target.Address = "$C$22" And Range("F23").Value <> "" Then
    Range("C23").Value = ""
    End If
    
    If Target.Address = "$C$19" And ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C19").Value <> "" Then
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
        screenUpdatePred = Application.ScreenUpdating
        Application.ScreenUpdating = False
        If ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C19").Value = "KREDITN|fffd| KARTA" Then
          Call pojisteniCestovni
          Call pojisteniKartyOsobnichVeci
        Else
          Call datumPosledniSplatky
          Call pojisteniSchopnostiSplacet
        End If
        ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C19").Select
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
        Application.ScreenUpdating = screenUpdatePred
    End If
    
    If Target.Address = "$C$20" Then
    Range("C22").Value = Range("C20").Value
        abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
        If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "BRANCH" And Range("C20").Value = ThisWorkbook.Sheets("Ciselniky").Range("B115").Value Then
            Range("C21").Value = ""
            Rows("21").EntireRow.Hidden = True
        Else
            'vyma|fffd|e anga|fffd|ovanost
            'Range("C21").Value = ""
            Rows("21").EntireRow.Hidden = False
        End If
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    End If


    
    'V|fffd|B|fffd|R PRODUKTU - pokud nen|fffd| 'tisk souhlasu' = schovej_sekci_souhlas, schovej |fffd||fffd|dek 'Poji|fffd|t|fffd|n|fffd| schopnosti spl|fffd|cet - |fffd|adatel' a zobraz list B, list C ... (pokud se zm|fffd|n|fffd| bu|fffd|ka Druh nab|fffd|dky na listu A_Predbezna_nabidka, je t|fffd|eba schovat / zm|fffd|nit (work-around |fffd|e|fffd|en|fffd| pro zobrazen|fffd| hl|fffd|ek po zm|fffd|n|fffd| na pouze Tisk souhlasu pro dotaz do registru))
    If Target.Address = "$C$21" And Not IsNumeric(Range("C21").Value) Then
     Call schovat_sekci_souhlas
     Call zobrazit_listB_listC
    End If
    
           
    'kdy|fffd| se zvol|fffd| 'tisk souhlasu' = zobraz_sekci_souhlas a schovej list B, list C
    If Target.Address = "$C$21" And Range("A21").Value = "tisk_souhlasu" Then
     Call zobrazit_sekci_souhlas: Call schovat_listB_listC: Call dotahni_PSC_z_tisku
    End If
    
    If Target.Address = "$C$21" And Range("A21").Value = "tisk_souhlasu" Then
     Call Pouceni_o_zpracovani_osob_udaju_schovat
    End If
    
    If Target.Address = "$C$23" And Range("$C$23").Value <> "" Then
     Call konsolidace_schovat_radky
     Call zobrazitIndividualniSazbaCheckbox
     'Call uverSBeznymUctem
        'pokud minim|fffd|ln|fffd| splatnost = maxim|fffd|ln|fffd| splatnost, p|fffd|edvyplnit
       If ThisWorkbook.Sheets("Ciselniky").Range("B12").Value = ThisWorkbook.Sheets("Ciselniky").Range("B13").Value Then
         ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C25").Value = ThisWorkbook.Sheets("Ciselniky").Range("B13").Value
       End If
       
       'min splatnost 60, max. 96 - musi byt delitelne 12 = 60,72,84,96 u bonusu, bez bonusu libovolny pocet mesicu v rozmezi
        Call minMaxSplatnostBonus
        
       
       If Sheets("A_predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
         Call Pouceni_o_zpracovani_osob_udaju_schovat
       End If
     Range("C23").Select
    End If
    
    'Pokud zm|fffd|n|fffd|m Typ produktu, vyma|fffd|e se 'detail produktu' a do pole 'datum prvn|fffd| spl|fffd|tky' se dopln|fffd| n|fffd|pov|fffd|da
    puv_datum_splatky = Range("C29").Value
    If Target.Address = "$C$21" And Range("F29").Value <> "" Then
        Range("C29").Value = "(doporu|fffd|en|fffd| volba data spl|fffd|tky PO v|fffd|plat|fffd| p|fffd||fffd|jmu klienta)"
    End If
    
''    If Target.Address = "$C$31" Then
''        Call schovat_mesicni_splatku
''    End If

    If Target.Address = "$D$35" Then
        ThisWorkbook.Sheets("Ciselniky").Range("D9").Value = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("urokovaSazba").Value
        If ThisWorkbook.Sheets("Ciselniky").Range("D12").Value = True Then
            Call vypocti_splatku_automaticky
        End If
    End If

    
    ' p|fffd|i 'tisk_souhlasu' a 'maj|fffd| spole|fffd|nou dom|fffd|cnost' --> propsat adresy |fffd|adatele do spolu|fffd|adatele
    If Target.Address = "$D$44" Then
     Call propsat_spolecnou_domacnost_listA: Range("$D$44").Select
    End If
    
    'propsat datum na list B - |fffd|adatel
    If Target.Address = "$C$49" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C14").Value = Format(Range("C49").Value, "d.m.yyyy")
    End If
    'propsat datum na list B - spolu|fffd|adatel
    If Target.Address = "$D$49" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D14").Value = Format(Range("D49").Value, "d.m.yyyy")
    End If
    
    'propsat ob|fffd|anstv|fffd| na list B - |fffd|adatel
    If Target.Address = "$C$67" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C12").Value = Range("C67").Value
    End If
    'propsat ob|fffd|anstv|fffd| na list B - spolu|fffd|adatel
    If Target.Address = "$D$67" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D12").Value = Range("D67").Value
    End If
    
    'propsat rodn|fffd| |fffd||fffd|slo na list B
    If Target.Address = "$C$68" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C13").Value = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C68").Value
    End If
    
    'propsat rodn|fffd| |fffd||fffd|slo na list B - spolu|fffd|adatel
    If Target.Address = "$D$68" Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D13").Value = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D68").Value
    End If
    
    If Target.Address = "$D$52" Then
     Call propsat_spolecnou_domacnost_listA
    End If
    
    'Maj|fffd| spole|fffd|nou dom|fffd|cnost, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
    If Target.Address = "$D$52" Or Target.Address = "$D$104" Then
     Call adresy_na_listB_spoluzadatel
      If Range("D104").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost" Then
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect Password:=abc
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D105:D109").Value = ""
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect Password:=abc
        ElseIf Target.Address = "$D$99" And Range("D104").Value = "Nemaj|fffd| spole|fffd|nou dom|fffd|cnost" Then
         abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
         ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect Password:=abc
         ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D105:D109").Value = ""
         Call PSC_na_listB_spoluzadatel
         Range("D105").Select
         ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect Password:=abc
      End If
    End If

    'PS|fffd|, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
    If Target.Address = "$C$106" Then
     Call PSC_na_listB_zadatel
    End If
    If Target.Address = "$D$106" Then
     Call PSC_na_listB_spoluzadatel
    End If
    
    
    
End Sub
Sub schovat_mesicni_splatku()
Dim test
Dim abc
Dim stavScreenUpdatinguPred2

'na listu D_NAB|fffd|DKA schov|fffd|n|fffd| 'm|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky', pokud tam nen|fffd| 'm|fffd|s|fffd||fffd|n|fffd| spl|fffd|tka v|fffd|etn|fffd| poji|fffd|t|fffd|n|fffd|'
    test = (Range("$C$31").Value = "Nen|fffd| sjedn|fffd|no" Or Range("$C$31").Value = "")
    'je poji|fffd|t|fffd|no = chci zobrazit
         abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
         stavScreenUpdatinguPred2 = Application.ScreenUpdating
         Application.ScreenUpdating = False
         ThisWorkbook.Sheets("D_NAB|fffd|DKA").Unprotect (abc)
         ThisWorkbook.Sheets("D_NAB|fffd|DKA").Rows("18:18").EntireRow.Hidden = test
         ThisWorkbook.Sheets("D_NAB|fffd|DKA").Protect (abc)
         Application.ScreenUpdating = stavScreenUpdatinguPred2
End Sub
Public Sub schovat_sekci_souhlas()
Dim stavScreenUpdatinguPred
Dim abc
' schovat_souhlas Makro
' schov|fffd| sekci pro vypln|fffd|n|fffd| Dopl|fffd|uj|fffd|c|fffd|ch informac|fffd|, pokud nen|fffd| pot|fffd|eba
      stavScreenUpdatinguPred = Application.ScreenUpdating
      Application.ScreenUpdating = False
      abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
      ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
      ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
      
      'Poji|fffd|t|fffd|n|fffd| schopnosti spl|fffd|cet - |fffd|adatel
      If ThisWorkbook.Sheets("Ciselniky").Range("B2") = "ESC" Then
      Rows("20").EntireRow.Hidden = True
      Rows("22").EntireRow.Hidden = False
      'Rows("31").EntireRow.Hidden = False
      End If
        'datum narozen|fffd|
        Rows("49").EntireRow.Hidden = False
      Rows("52:73").EntireRow.Hidden = True
      Rows("76").EntireRow.Hidden = True
' zobraz|fffd| v|fffd|e od sekce 3. p|fffd||fffd|jmy d|fffd|l... nen|fffd| pot|fffd|eba pro vytisknut|fffd| souhlasu
    Rows("77:79").EntireRow.Hidden = False
    Rows("81").EntireRow.Hidden = False
    Rows("83").EntireRow.Hidden = False
    Rows("85").EntireRow.Hidden = False
    Rows("87:94").EntireRow.Hidden = False
    Rows("97:99").EntireRow.Hidden = False
    Rows("101:109").EntireRow.Hidden = False
    Rows("128:139").EntireRow.Hidden = False
    Rows("141:143").EntireRow.Hidden = False
    Rows("148").EntireRow.Hidden = False
    Rows("163").EntireRow.Hidden = False
    Rows("167:175").EntireRow.Hidden = False

 ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
'schovat za|fffd|krt|fffd|v|fffd|tko shodn|fffd| trval|fffd| adresa - |fffd|adatel
 ActiveSheet.Shapes("Check Box 2306").Visible = False
 
 'schovat za|fffd|krt|fffd|v|fffd|tko shodn|fffd| trval|fffd| adresa - spolu|fffd|adatel
  ActiveSheet.Shapes("Check Box 2308").Visible = False
    
    Range("C21").Select
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Sub zobrazit_sekci_souhlas()
Dim stavScreenUpdatinguPred
Dim abc
' zobrazit_sekci_souhlas Makro
' zobraz|fffd| sekci pro vypln|fffd|n|fffd| Dopl|fffd|uj|fffd|c|fffd|ch informac|fffd|, pokud je pot|fffd|eba
      stavScreenUpdatinguPred = Application.ScreenUpdating
      Application.ScreenUpdating = False
      abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
      ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
      
    'dolo|fffd|en|fffd| p|fffd||fffd|jm|fffd| dle vyhodnocen|fffd| inforegistru
    Rows("20").EntireRow.Hidden = True
    Rows("22").EntireRow.Hidden = True
    ''Poji|fffd|t|fffd|n|fffd| schopnosti spl|fffd|cet - |fffd|adatel
    'Rows("31").EntireRow.Hidden = True
    'datum narozen|fffd| u|fffd| je v ESC tisku souhlasu n|fffd|e
    Rows("49").EntireRow.Hidden = True
    Rows("52:73").EntireRow.Hidden = False
    Rows("76").EntireRow.Hidden = False
' schov|fffd| v|fffd|e od sekce 3. p|fffd||fffd|jmy d|fffd|l... nebylo pot|fffd|eba pro vytisknut|fffd| souhlasu
    Rows("77:79").EntireRow.Hidden = True
    Rows("81").EntireRow.Hidden = True
    Rows("83").EntireRow.Hidden = True
    Rows("85").EntireRow.Hidden = True
    Rows("87:94").EntireRow.Hidden = True
    Rows("97:99").EntireRow.Hidden = True
    Rows("101:109").EntireRow.Hidden = True
    Rows("128:140").EntireRow.Hidden = True
    Rows("141:143").EntireRow.Hidden = True
    Rows("148").EntireRow.Hidden = True
    Rows("163").EntireRow.Hidden = True
    Rows("167:175").EntireRow.Hidden = True
    
    'zobrazit za|fffd|krt|fffd|v|fffd|tko shodn|fffd| trval|fffd| adresa - |fffd|adatel
    Sheets("A_Predbezna_nabidka").Shapes("Check Box 2306").Visible = True
    Sheets("A_Predbezna_nabidka").Shapes("Check Box 2306").Select
    With Selection
        .Visible = True
        .Value = xlOff
        .LinkedCell = "'A_Predbezna_nabidka'!$M$117"
        .Display3DShading = False

    End With
    'Selection.Characters.Text = ""
    
    'zobrazit za|fffd|krt|fffd|v|fffd|tko shodn|fffd| trval|fffd| adresa - spolu|fffd|adatel
    Sheets("A_Predbezna_nabidka").Shapes("Check Box 2308").Visible = True
    Sheets("A_Predbezna_nabidka").Shapes("Check Box 2308").Select
    With Selection
        .Visible = True
        .Value = xlOff
        .LinkedCell = "'A_Predbezna_nabidka'!$N$117"
        .Display3DShading = False
    End With
    
        ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
         'dot|fffd|hnut|fffd| spr|fffd|vn|fffd| adresy ze souhlasu na list B (oprava pr|fffd|zdn|fffd| adresy v PDF/tisku)
        ThisWorkbook.Sheets("B_Osobni_udaje").Range("C33:D36").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
        ThisWorkbook.Sheets("B_Osobni_udaje").Range("C38:D41").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
        ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
    
    Range("C16").Select
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub shodna_adresa_zadatel()
 Dim stavScreenUpdatinguPred
 Dim abc
 'trval|fffd| adresa |fffd|adatele - shodn|fffd| s koresponden|fffd|n|fffd|
 'vypln|fffd|, pokud jsou shodn|fffd|
 stavScreenUpdatinguPred = Application.ScreenUpdating
 Application.ScreenUpdating = False
 abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
 'p|fffd|ep|fffd|e hodnotu zda jsou adresy shodn|fffd| i pro volbu na listu B
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M118").Value = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M117").Value
Call shodna_adresa_zadatel_listB
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M117").Value = False Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("C59:C62").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C59:C62").Value = ""
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C59").Select
 End If
 'proma|fffd|e, pokud nejsou shodn|fffd|
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M117").Value = True Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("C59:C62").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C59:C62").FormulaR1C1 = "=R[-5]C"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C64").Select
 End If
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub shodna_adresa_spoluzadatel()
Dim stavScreenUpdatinguPred
Dim abc
 'trval|fffd| adresa spolu|fffd|adatele - shodn|fffd| s koresponden|fffd|n|fffd|
 'vypln|fffd|, pokud jsou shodn|fffd|
 stavScreenUpdatinguPred = Application.ScreenUpdating
 Application.ScreenUpdating = False
 abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
 'p|fffd|ep|fffd|e hodnotu zda jsou adresy shodn|fffd| i pro volbu na listu B
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N118").Value = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N117").Value
 Call shodna_adresa_spoluzadatel_listB
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N117").Value = True Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("D59:D62").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D59:D62").FormulaR1C1 = "=R[-5]C"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D64").Select
 End If
 'proma|fffd|e, pokud nejsou shodn|fffd|
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N117").Value = False Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("D59:D62").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D59:D62").Value = ""
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D59").Select
 End If

 ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub propsat_spolecnou_domacnost_listA()
' propsat_spolecnou_domacnost Makro
' tisk_souhlasu - maj|fffd| spole|fffd|nou dom|fffd|cnost --> propsat adresy |fffd|adatele do spolu|fffd|adatele
 If Range("D52").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost" Then
    Range("D54:D57").FormulaR1C1 = "=IF(RC[-1]<>"""",RC[-1],"""")"
'    Range("D52").FormulaR1C1 = "=RC[-1]"
'    Range("D53").Select
'    ActiveCell.FormulaR1C1 = "=RC[-1]"
'    Range("D54").Select
'    ActiveCell.FormulaR1C1 = "=RC[-1]"
    Range("D52").Select
 End If
 'pokud 'Nemaj|fffd| spole|fffd|nou dom|fffd|cnost' --> vymazat hodnoty, pouze st|fffd|t ponechat
  If Range("D52").Value = "Nemaj|fffd| spole|fffd|nou dom|fffd|cnost" Then
     Range("D54:D56").Value = ""
'    Range("D47").FormulaR1C1 = "=RC[-1]"
'    Range("D48").Select
'    ActiveCell.FormulaR1C1 = "=RC[-1]"
'    Range("D49").Select
'    ActiveCell.FormulaR1C1 = "=RC[-1]"
    Range("D52").Select
 End If
End Sub
Attribute VB_Name = "List20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

            Sub DoplneniZadostiWordToPDF()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("DoplneniZadosti").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("DoplneniZadosti").Visible = True
            ThisWorkbook.Sheets("DoplneniZadosti").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("DoplneniZadosti").Range("C9").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("DoplneniZadosti").Select
                    ThisWorkbook.Sheets("DoplneniZadosti").Range("D9").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("DoplneniZadosti").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                      If ThisWorkbook.Sheets("DoplneniZadosti").Range("D3").Value = "TOP UP" Then
                            ActiveSheet.Shapes.Range(Array("DoplneniZadosti-TOPUP")).Select
                      Else
                            ActiveSheet.Shapes.Range(Array("DoplneniZadosti-Word")).Select
                      End If
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                        wd.Visible = True
                        'wd.Visible = False
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("DoplneniZadosti").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 'novy_dokument.Visible = False
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Saved = True
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.documents(1).Saved = True
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Sheets("DoplneniZadosti").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select

                 Resume EndTry1

                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub

Attribute VB_Name = "List27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "List30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Sub odemknoutListy()
Dim stavScreenUpdatinguPred
Dim abc
Dim bcd

'odemkne listy A, B, C, Uvodni_obrazovka
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
'(funguje a|fffd| po odem|fffd|en|fffd| |fffd||fffd|seln|fffd|k|fffd|)
    ThisWorkbook.Sheets("Ciselniky").Range("B1").Value = "odem|fffd|eno"
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    ThisWorkbook.Sheets("Uvodni_obrazovka").Unprotect (abc)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect (abc)
    ThisWorkbook.Sheets("D_NAB|fffd|DKA").Unprotect (abc)
'    Thisworkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_zadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_spoluzadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Potvrzeni_o_prijmu_zadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Potvrzeni_o_prijmu_spoluzadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Doplneni_zadosti").Unprotect (abc)
'    Thisworkbook.Sheets("Standardni_informace_zadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Standardni_info_spoluzadatel").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_1").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_2").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_3").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_4").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_5").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_6").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_7").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_8").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_9").Unprotect (abc)
'    Thisworkbook.Sheets("Zadost_konsolidace_10").Unprotect (abc)
'    Thisworkbook.Sheets("PEP_zadatel").Unprotect (abc)
'    Thisworkbook.Sheets("PEP_spoluzadatel").Unprotect (abc)
    
    
    MsgBox ("Hotovo! Se|fffd|it a listy 'A_Predbezna_nabidka', 'B_Osobni_udaje' a 'C_Dodate|fffd|n|fffd| informace' byly odem|fffd|eny.")
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub zamknoutListy()
Dim abc
Dim bcd
'zamkne listy A, B, C, Uvodni_obrazovka
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
            
    ThisWorkbook.Sheets("Uvodni_obrazovka").Protect (abc)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect (abc)
    'ThisWorkbook.Sheets("D_NAB|fffd|DKA").Protect (abc)
    ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Protect (abc)
    ThisWorkbook.Sheets("Zadost_zadatel").Protect (abc)
    ThisWorkbook.Sheets("Zadost_spoluzadatel").Protect (abc)
    ThisWorkbook.Sheets("Potvrzeni_o_prijmu_zadatel").Protect (abc)
    ThisWorkbook.Sheets("Potvrzeni_o_prijmu_spoluzadatel").Protect (abc)
    'Thisworkbook.Sheets("Doplneni_zadosti").Protect (abc)
    ThisWorkbook.Sheets("Standardni_informace_zadatel").Protect (abc)
    ThisWorkbook.Sheets("Standardni_info_spoluzadatel").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_1").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_2").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_3").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_4").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_5").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_6").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_7").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_8").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_9").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_10").Protect (abc)
    ThisWorkbook.Sheets("PEP_zadatel").Protect (abc)
    ThisWorkbook.Sheets("PEP_spoluzadatel").Protect (abc)
    
    MsgBox ("Hotovo! Listy 'A_Predbezna_nabidka', 'B_Osobni_udaje' a 'C_Dodate|fffd|n|fffd| informace' byly uzam|fffd|eny.")
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Protect (bcd)
End Sub

Private Sub udelej_ESC()
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC"
End Sub
Private Sub udelej_BRANCH()
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "BRANCH"
End Sub

Attribute VB_Name = "List36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

            Sub StandardniInformaceWordToPDF()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("StandardniInformace").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("StandardniInformace").Visible = True
            ThisWorkbook.Sheets("StandardniInformace").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("StandardniInformace").Range("C10").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("StandardniInformace").Select
                    ThisWorkbook.Sheets("StandardniInformace").Range("D10").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("StandardniInformace").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("StandardniInformace-Word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("StandardniInformace").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Saved = True
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Sheets("StandardniInformace").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select

                 Resume EndTry1

                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub

            Sub StandardniInformaceSpoluzadatelWordToPDF()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("StandardniInformace").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("StandardniInformace").Visible = True
            ThisWorkbook.Sheets("StandardniInformace").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("StandardniInformace").Range("C10").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("StandardniInformace").Select
                    ThisWorkbook.Sheets("StandardniInformace").Range("E10").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("StandardniInformace").Range("E5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("StandardniInformace-Word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("StandardniInformace").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Saved = True
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Sheets("StandardniInformace").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes

 ''               myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            
            ''    Case vbNo
            ''    End Select
    
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select

                 Resume EndTry1

                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub




Attribute VB_Name = "List43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "List45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

            Sub ZadostWordToPDF()
            Dim pocet_radku
            Dim radek
            Dim nazevSablony
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("Zadost").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("Zadost").Visible = True
            ThisWorkbook.Sheets("Zadost").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("Zadost").Range("C10").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("Zadost").Select
                    ThisWorkbook.Sheets("Zadost").Range("D10").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("Zadost").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                        'pou|fffd||fffd|t |fffd|ablonu
                        nazevSablony = ThisWorkbook.Sheets("Zadost").Range("D3").Value
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array(nazevSablony)).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                         'wd.Visible = False
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                            
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Unprotect ("mival")
                ThisWorkbook.Sheets("Zadost").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
                ThisWorkbook.Protect ("mival")
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub
Attribute VB_Name = "List47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

            Sub predavaciProtokolWordToPDF()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("predavaciProtokol").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("predavaciProtokol").Visible = True
            ThisWorkbook.Sheets("predavaciProtokol").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("predavaciProtokol").Range("C10").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("predavaciProtokol").Select
                    ThisWorkbook.Sheets("predavaciProtokol").Range("D10").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("predavaciProtokol").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("predavaciProtokol-Word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                        'wd.Visible = True
                         'wd.Visible = False
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("predavaciProtokol").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '.documents(1).Close
                            '.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 'novy_dokument.Visible = True
                                 novy_dokument.Visible = False
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Unprotect ("mival")
                ThisWorkbook.Sheets("predavaciProtokol").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
                ThisWorkbook.Protect ("mival")
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub
Attribute VB_Name = "List48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Sub NabidkaPdf()
''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
'    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
'    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku

''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
'If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
'    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
'End If

'nab|fffd|dka CZ
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
ThisWorkbook.Unprotect (abc)
         
         'pokud je individu|fffd|ln|fffd| sazba dostupn|fffd| (dle produktu a verze), ale je |fffd|patn|fffd| zad|fffd|no (nen|fffd| jako |fffd||fffd|slo nebo mimo min, max)
         If ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = True And ThisWorkbook.Sheets("Ciselniky").Range("D13").Value = True And ThisWorkbook.Sheets("Ciselniky").Range("D12").Value = False Then
          MsgBox "Nab|fffd|dku nelze vygenerovat. Individu|fffd|ln|fffd| sazba je mimo povolen|fffd| rozmez|fffd|.", vbCritical, "Nab|fffd|dka - Individu|fffd|ln|fffd| sazba"
          GoTo konecNabidky
         End If

    Call ThisWorkbook.Sheets("SU_nabidka").NabidkaCZ


konecNabidky:

If ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C10").Value <> "Servis" Then
    ThisWorkbook.Sheets("SU_nabidka").Visible = False
    ThisWorkbook.Protect (abc)
End If
'rusk|fffd| nab|fffd|dka
'If ThisWorkbook.Sheets("SU_nabidka").Range("E6").Value = "generuji" Then
'   Call ThisWorkbook.Sheets("SU_nabidka").NabidkaRU
'End If

End Sub
            
Sub NabidkaCZ()
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("SU_nabidka").Range("D1").Value
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("SU_nabidka").Visible = True
            ThisWorkbook.Sheets("SU_nabidka").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("SU_nabidka").Range("C8").Select
                ThisWorkbook.Sheets("SU_nabidka").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("SU_nabidka").Select
                        ''If ThisWorkbook.Sheets("SU_nabidka").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("SU_nabidka").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("SU_nabidka").Range("D8").Select
                            ThisWorkbook.Sheets("SU_nabidka").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("SU_nabidka").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("SU_nabidka").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("SU_nabidka").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("Nabidka")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku - 1 'm|fffd|nus 1, proto|fffd|e pole od nuly
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            'ThisWorkbook.Sheets("SU_nabidka").Visible = False
            ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou nab|fffd|dku PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub


Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "List53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Sub CestneProhlaseniKonsolidacePdf()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Visible = True
            ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("C9").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Select
                    ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
'                      If ThisWorkbook.Sheets("DoplneniZadosti").Range("D3").Value = "TOP UP" Then
'                            ActiveSheet.Shapes.Range(Array("DoplneniZadosti-TOPUP")).Select
'                      Else
                            ActiveSheet.Shapes.Range(Array("CestneProhlaseniKonsolidace-Word")).Select
'                      End If
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                        wd.Visible = True
                        'wd.Visible = False
                    
                    Dim podslozka As String
                    
                    podslozka = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 'novy_dokument.Visible = False
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
'                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
'                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
'                                    .Selection.Rows.Delete
'                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
'                                End If
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Saved = True
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.documents(1).Saved = True
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Visible = False
                ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select

                 Resume EndTry1

                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub

Attribute VB_Name = "List58"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPRCZ()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
            ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas").Range("D1").Value
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            
            ThisWorkbook.Sheets("GDPR-souhlas").Visible = False
            ThisWorkbook.Sheets("A_predbezna_nabidka").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
            ''    myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List59"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPRSpoluzadatel()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
            ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D1").Value
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs Filename:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs Filename:=SaveAsName
            
                        SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Visible = False
            ThisWorkbook.Sheets("A_predbezna_nabidka").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
            ''    myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim datumAktualizaceExternistu

Private Sub Worksheet_Change(ByVal Target As Range)
Dim stavScreenUpdatinguPred

stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    'Zm|fffd|na verze v |fffd||fffd|seln|fffd|ku - pokud se zm|fffd|n|fffd| bu|fffd|ka verze kalkul|fffd|toru ve v|fffd|ech listech je t|fffd|eba schovat |fffd||fffd|dky, kter|fffd| tam nepat|fffd||fffd|
    If Target.Address = "$B$2" And Range("B2").Value <> "ESC" Then
     Call zobrazit_listB_listC
     Call schovat_ESC_radky
     'vynulovat, aby se nastavilo spr|fffd|vn|fffd| pro rozd|fffd|ln|fffd| verze
     Call resetListA
    End If
        
    'zobraz_sekci_souhlas
    If Target.Address = "$B$2" And Range("B2").Value = "ESC" Then
'''        'pokud ji|fffd| dnes aktualizov|fffd|no
'''        If datumAktualizaceExternistu >= Date Then
'''          'neaktualizovat
'''        Else
'''          Call AktualizovatSeznamExternistu
'''          Call AktualizovatSeznamExternichSpolecnosti
'''        End If
     Call zobrazit_listB_listC
     Call zobrazit_ESC_radky
     'vynulovat, aby se nastavilo spr|fffd|vn|fffd| pro rozd|fffd|ln|fffd| verze
     Call resetListA
    End If
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Private Sub predelatNaVerziESC()
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value

Call welcome_screen_schovat
ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A16").Value = ThisWorkbook.Sheets("Ciselniky").Range("A2399").Value
ThisWorkbook.Sheets("Ciselniky").Unprotect (abc)
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC"
ThisWorkbook.Sheets("Ciselniky").Protect (abc)

End Sub

Private Sub predelatNaVerziBRANCH()
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value

Call welcome_screen_schovat
ThisWorkbook.Sheets("Ciselniky").Unprotect (abc)
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "BRANCH"
ThisWorkbook.Sheets("Ciselniky").Protect (abc)
End Sub

Private Sub predelatNaVerziZAM()
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value

Call welcome_screen_schovat
ThisWorkbook.Sheets("Ciselniky").Unprotect (abc)
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ZAM"
ThisWorkbook.Sheets("Ciselniky").Protect (abc)
Call welcome_screen_zobrazit
Call welcome_screen_schovat
End Sub

Private Sub predelatNaVerziWINBACK()
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value

Call welcome_screen_schovat
ThisWorkbook.Sheets("Ciselniky").Unprotect (abc)
ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "BRANCH"
     
    'winback pol|fffd||fffd|ko - typ procesu
    ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C12:D12").Select
    ThisWorkbook.Sheets("A_predbezna_nabidka").Unprotect (abc)
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="Pobo|fffd|ka,eShop,Winback"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    ThisWorkbook.Sheets("A_predbezna_nabidka").Protect (abc)
    Sheets("A_predbezna_nabidka").Range("C10").Value = "Brno"
    Sheets("A_predbezna_nabidka").Range("C12").Value = "Winback"
    Sheets("A_predbezna_nabidka").Range("C19").Value = "SPOT|fffd|EBITELSK|fffd| |fffd|V|fffd|R"
    Sheets("A_predbezna_nabidka").Range("C20").Value = "P|fffd|edb|fffd|n|fffd| kalkulace p|fffd|ed vyhodnocen|fffd|m v InfoRegistru"
    Sheets("A_predbezna_nabidka").Range("C23").Value = "F|fffd|r konsolidace (Win back) 6,65 %"
    
ThisWorkbook.Sheets("Ciselniky").Protect (abc)
End Sub
Attribute VB_Name = "Module1"


Dim FolderName As String
Sub uloz_PDF_zadosti()

Dim stavScreenUpdatinguPred
Dim abc
Dim bcd
Dim stavPred
Dim tisk_souhlasu
Dim varovna_hlaskaA
Dim varovna_hlaskaB
Dim varovna_hlaskaC
Dim tisk_souhlas

' vygeneruje PDF dokumentaci (souhlas k poskytnut|fffd| osobn|fffd|ch |fffd|daj|fffd|, |fffd||fffd|dost |fffd|adatel, |fffd||fffd|dost spolu|fffd|adatel) a |fffd||fffd|dosti ke konsolidaci
' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)

On Error GoTo ErrHandler:
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False

' nap|fffd|e do bu|fffd|ky A2 = "zobrazovat hl|fffd|ky" ... na kterou jsou v|fffd|z|fffd|ny v|fffd|echny hl|fffd|ky --> z|fffd|ervenaj|fffd| nevypl|fffd|en|fffd| pole
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    'Thisworkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Visible = True
    'Thisworkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect (abc)
    
    'oprava zvolen|fffd| tisku bez zapnut|fffd|ch maker
    stavPred = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C21")
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C21") = ""
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C21") = stavPred
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A3").Value = "zobrazovat hl|fffd|ky"
    
    
If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "BRANCH" And (ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A23").Value <> "konsolidace") Then
'Thisworkbook.Sheets("A_Predbezna_nabidka").Range("C9").Select
MsgBox ("Pro tento produkt nen|fffd| PDF k dispozici! (Dokumentace se generuje v TransactSM)" & vbNewLine & ThisWorkbook.Sheets("Ciselniky").Range("B2").Value & vbNewLine & ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A5").Value)
GoTo konec
End If
    
    
' kontrola, nesv|fffd|t|fffd| |fffd|erven|fffd| hl|fffd|ka na listu A, upozor|fffd|uj|fffd|c|fffd|, |fffd|e se n|fffd|co m|fffd| vyplnit (= v|fffd|e vypln|fffd|no), pokud ok--> ale n|fffd|co nen|fffd| v po|fffd||fffd|dku na listu B p|fffd|esun na list B
ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
tisk_souhlasu = Range("A21").Value
varovna_hlaskaA = Range("F8").Value
If varovna_hlaskaA <> "" Then
ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C9").Select
MsgBox "|fffd||fffd|dosti nelze vygenerovat! " & vbNewLine & "Mus|fffd|te spr|fffd|vn|fffd| vyplnit v|fffd|echna po|fffd|adovan|fffd| pole!", vbCritical, "CHYBA VYPLN|fffd|N|fffd|"
End If

' kdy|fffd| |fffd||fffd|dn|fffd| hl|fffd|ka nesv|fffd|t|fffd|, (= v|fffd|e vypln|fffd|no), m|fffd||fffd|e se vygenerovat
varovna_hlaskaC = ""
If ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = True Then
varovna_hlaskaC = ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Range("E6").Value
End If
varovna_hlaskaB = ThisWorkbook.Sheets("B_Osobni_udaje").Range("F3").Value
varovna_hlaskaA = ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("F8").Value


If tisk_souhlasu = "" And varovna_hlaskaA = "" And varovna_hlaskaB <> "" Then
MsgBox ("V|fffd|born|fffd|! Vyplnili jste list 'A_Predbezna_nabidka', ale |fffd||fffd|dosti je|fffd|t|fffd| nelze vygenerovat. Mus|fffd|te vyplnit v|fffd|echna po|fffd|adovan|fffd| pole i na listu 'B_Osobni_udaje'!")
ThisWorkbook.Sheets("B_Osobni_udaje").Select
End If

If tisk_souhlasu = "" And varovna_hlaskaA = "" And varovna_hlaskaB = "" And varovna_hlaskaC <> "" Then
MsgBox ("V|fffd|born|fffd|! Vyplnili jste spr|fffd|vn|fffd| list 'A_Predbezna_nabidka' i 'B_Osobni_udaje', ale |fffd||fffd|dosti je|fffd|t|fffd| nelze vygenerovat. Mus|fffd|te vyplnit v|fffd|echna po|fffd|adovan|fffd| pole i na listu 'C_Osobni_udaje'!")
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = True
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select
End If

' kdy|fffd| |fffd||fffd|dn|fffd| hl|fffd|ka nesv|fffd|t|fffd|, (= v|fffd|e vypln|fffd|no), m|fffd||fffd|e se vygenerovat
If varovna_hlaskaA = "" And varovna_hlaskaB = "" And varovna_hlaskaC = "" Then

' Create and save .pdf
Dim pdfName As String, FullName As String
ThisWorkbook.Sheets("A_Predbezna_nabidka").Select

' zkontroluje jestli je na disku C: slo|fffd|ka Sberbank CZ, pokud ne, vytvo|fffd||fffd| ji
If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"

' vytvo|fffd||fffd| slo|fffd|ku podle data a |fffd|asu RRRR-MM-DD-HH-MM-SS
FolderName = "Sberbank CZ\" & ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A2").Text
If Not DirExists("C:\" & FolderName) Then MkDir "C:\" & FolderName

' ulo|fffd||fffd| jako PDF pod n|fffd|zvem dokumentu (pro hl|fffd|ku univerz|fffd|ln|fffd|)
pdfName = "Nazev_dokumentu"
FullName = "C:\" & FolderName & "\" & pdfName
If MsgBox("|fffd||fffd|dosti budou ulo|fffd|eny ve form|fffd|tu PDF do " & FullName & ", p|fffd|ejete si prov|fffd|st?", vbYesNo + vbQuestion) = vbNo Then Exit Sub
' ulo|fffd||fffd| |fffd||fffd|dosti o konsolidaci jako PDF pod n|fffd|zvem
pdfName = "Zadost_o_konsolidaci_SBCZ"
FullName = "C:\" & FolderName & "\" & pdfName

'''      ' tisk |fffd||fffd|dost Zadost_uver_zadatel -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
'''        Thisworkbook.Sheets("Zadost_zadatel").Visible = True
'''        Thisworkbook.Sheets("Zadost_zadatel").Select
'''        Range("D1").Select
'''        tisk_zadostSU = ActiveCell.Value
'''        If tisk_zadostSU <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
'''        Range("A1:J415").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Zadost_o_spotrebitelsky_uver-zadatel" _
''', Quality:=xlQualityMedium, IncludeDocProperties:=False, _
'''IgnorePrintAreas:=False, OpenAfterPublish:=False
'''        Thisworkbook.Sheets("Zadost_zadatel").Select:
'''        End If
'''        ActiveWindow.SelectedSheets.Visible = False
'''
'''      ' tisk |fffd||fffd|dost Zadost_uver_spoluzadatel -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
'''        Thisworkbook.Sheets("Zadost_spoluzadatel").Visible = True
'''        Thisworkbook.Sheets("Zadost_spoluzadatel").Select
'''        Range("D1").Select
'''        tisk_zadostSU_spoluz = ActiveCell.Value
'''        If tisk_zadostSU_spoluz <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
'''        Range("A1:J350").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Zadost_o_spotrebitelsky_uver-spoluzadatel" _
''', Quality:=xlQualityMedium, IncludeDocProperties:=False, _
'''IgnorePrintAreas:=False, OpenAfterPublish:=False
'''        Thisworkbook.Sheets("Zadost_spoluzadatel").Select:
'''        End If
'''        ActiveWindow.SelectedSheets.Visible = False

'|fffd||fffd|dost (|fffd|adatel a spolu|fffd|adatel)
ThisWorkbook.Unprotect (bcd)
If ThisWorkbook.Sheets("Zadost").Range("D8").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
Call List45.ZadostWordToPDF
    'souhlas GDPR
    Call List58.GDPRCZ
    If ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D2").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
     Call List59.GDPRSpoluzadatel
    End If
End If
'p|fffd|ed|fffd|vac|fffd| protokol ESC
If ThisWorkbook.Sheets("predavaciProtokol").Range("D8").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
    Call List47.predavaciProtokolWordToPDF
End If
        
        ' tisk |fffd||fffd|dost Souhlas k nakl|fffd|d|fffd|n|fffd| s osobn|fffd|mi pdaji -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Unprotect (bcd)
        ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = True
        ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Select
        Range("D2").Select
        tisk_souhlas = ActiveCell.Value
        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
        Range("A1:J172").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Souhlas_k_nakladani_s_osobnimi_udaji" _
, Quality:=xlQualityMedium, IncludeDocProperties:=False, _
IgnorePrintAreas:=False, OpenAfterPublish:=False
        ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Select:
        
            'souhlas GDPR
            Call List58.GDPRCZ
            If ThisWorkbook.Sheets("GDPR-souhlas-spoluzadatel").Range("D2").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
             ThisWorkbook.Unprotect (bcd)
             Call List59.GDPRSpoluzadatel
            End If
        End If
        ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = False
        
         ' tisk Potvrzeni_o_prijmu_ZADATEL -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_zadatel").Visible = True
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_zadatel").Select
        Range("D2").Select
        tisk_souhlas = ActiveCell.Value
        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
        Range("A1:AF50").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Potvrzeni_o_prijmu-zadatel" _
, Quality:=xlQualityMedium, IncludeDocProperties:=False, _
IgnorePrintAreas:=False, OpenAfterPublish:=False
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_zadatel").Select:
        End If
        ActiveWindow.SelectedSheets.Visible = False
        
        ' tisk Potvrzeni_o_prijmu_SPOLUZADATEL -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_spoluzadatel").Visible = True
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_spoluzadatel").Select
        Range("D2").Select
        tisk_souhlas = ActiveCell.Value
        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
        Range("A1:AF50").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Potvrzeni_o_prijmu-spoluzadatel" _
, Quality:=xlQualityMedium, IncludeDocProperties:=False, _
IgnorePrintAreas:=False, OpenAfterPublish:=False
        ThisWorkbook.Sheets("Potvrzeni_o_prijmu_spoluzadatel").Select:
        End If
        ActiveWindow.SelectedSheets.Visible = False
        
        
          ' tisk |fffd||fffd|dost Standardni_informace_ZADATEL -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
          'PRECONDITIONs 3x (dle produktu)
          'Consumer loan - Pre-conditions.docx --- podruh|fffd|, kdy|fffd| je spolu|fffd|adatel v|fffd|e stejn|fffd| akor|fffd|t dole jm|fffd|no..
          
ThisWorkbook.Unprotect (bcd)
If ThisWorkbook.Sheets("StandardniInformace").Range("D8").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
Call List41.StandardniInformaceWordToPDF
End If
If ThisWorkbook.Sheets("StandardniInformace").Range("E8").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
    Call List41.StandardniInformaceSpoluzadatelWordToPDF
End If

'        Thisworkbook.Sheets("Standardni_informace_zadatel").Visible = True
'        Thisworkbook.Sheets("Standardni_informace_zadatel").Select
'        Range("C2").Select
'        tisk_souhlas = ActiveCell.Value
'        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
'        Range("A1:E101").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Standardni_informace-zadatel" _
', Quality:=xlQualityMedium, IncludeDocProperties:=False, _
'IgnorePrintAreas:=False, OpenAfterPublish:=False
'        Thisworkbook.Sheets("Standardni_informace_zadatel").Select:
'        End If
'        ActiveWindow.SelectedSheets.Visible = False
'
'          ' tisk |fffd||fffd|dost Standardni_informace_SPOLUZADATEL -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
'        Thisworkbook.Sheets("Standardni_info_spoluzadatel").Visible = True
'        Thisworkbook.Sheets("Standardni_info_spoluzadatel").Select
'        Range("C2").Select
'        tisk_souhlas = ActiveCell.Value
'        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
'        Range("A1:E101").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Standardni_informace-spoluzadatel" _
', Quality:=xlQualityMedium, IncludeDocProperties:=False, _
'        IgnorePrintAreas:=False, OpenAfterPublish:=False
'        Thisworkbook.Sheets("Standardni_info_spoluzadatel").Select:
'        End If
'        ActiveWindow.SelectedSheets.Visible = False
        
        
        ' tisk Konsolidace - P|fffd|ehled - dopln|fffd|n|fffd| |fffd||fffd|dosti -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
If ThisWorkbook.Sheets("DoplneniZadosti").Range("D2").Value <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
    ThisWorkbook.Unprotect (bcd)
    Call List26.DoplneniZadostiWordToPDF
End If

''        Thisworkbook.Sheets("Doplneni_zadosti").Visible = True
''        Thisworkbook.Sheets("Doplneni_zadosti").Select
''        Range("E1").Select
''        tisk_souhlas = ActiveCell.Value
''        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
''        Range("A1:M163").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\Konsolidace_-_Prehled_-_doplneni_zadosti" _
'', Quality:=xlQualityMedium, IncludeDocProperties:=False, _
''IgnorePrintAreas:=False, OpenAfterPublish:=False
''        Thisworkbook.Sheets("Doplneni_zadosti").Select:
''        End If
''        ActiveWindow.SelectedSheets.Visible = False
        
        ' tisk PEP_zadatel -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("PEP_zadatel").Visible = True
        ThisWorkbook.Sheets("PEP_zadatel").Select
        Range("A4").Select
        tisk_souhlas = ActiveCell.Value
        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
        Range("A1:A33").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\PEP_-_zadatel" _
, Quality:=xlQualityMedium, IncludeDocProperties:=False, _
IgnorePrintAreas:=False, OpenAfterPublish:=False
        ThisWorkbook.Sheets("PEP_zadatel").Select:
        End If
        ActiveWindow.SelectedSheets.Visible = False
        
        ' tisk PEP_spoluzadatel -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("PEP_spoluzadatel").Visible = True
        ThisWorkbook.Sheets("PEP_spoluzadatel").Select
        Range("A4").Select
        tisk_souhlas = ActiveCell.Value
        If tisk_souhlas <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
        Range("A1:A33").ExportAsFixedFormat Type:=xlTypePDF, Filename:="C:\" & FolderName & "\PEP_-_spoluzadatel" _
, Quality:=xlQualityMedium, IncludeDocProperties:=False, _
IgnorePrintAreas:=False, OpenAfterPublish:=False
        ThisWorkbook.Sheets("PEP_spoluzadatel").Select:
        End If
        ActiveWindow.SelectedSheets.Visible = False
        
        '---------------------
        ' tisk |fffd||fffd|dost Konsolidace1 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 1
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 1"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_1").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_1").Select
                Range("A16").Select
                tisk_zadost_1 = ActiveCell.Value
                If tisk_zadost_1 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_01" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_1").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '---------------------
        ' tisk |fffd||fffd|dost Konsolidace2 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 2
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 2"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_2").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_2").Select
                Range("A16").Select
                tisk_zadost_2 = ActiveCell.Value
                If tisk_zadost_2 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_02" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_2").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
        '---------------------
        ' tisk |fffd||fffd|dost Konsolidace3 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 3
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 3"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_3").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_3").Select
                Range("A16").Select
                tisk_zadost_3 = ActiveCell.Value
                If tisk_zadost_3 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_03" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_3").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace4 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 4
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 4"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_4").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_4").Select
                Range("A16").Select
                tisk_zadost_4 = ActiveCell.Value
                If tisk_zadost_4 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_04" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_4").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace5 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 5
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 5"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_5").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_5").Select
                Range("A16").Select
                tisk_zadost_5 = ActiveCell.Value
                If tisk_zadost_5 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_05" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_5").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace6 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 6
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 6"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_6").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_6").Select
                Range("A16").Select
                tisk_zadost_6 = ActiveCell.Value
                If tisk_zadost_6 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_06" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_6").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace7 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 7
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 7"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_7").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_7").Select
                Range("A16").Select
                tisk_zadost_7 = ActiveCell.Value
                If tisk_zadost_7 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_07" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_7").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace8 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 8
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 8"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_8").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_8").Select
                Range("A16").Select
                tisk_zadost_8 = ActiveCell.Value
                If tisk_zadost_8 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_08" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_8").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace9 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 9
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 9"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_9").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_9").Select
                Range("A16").Select
                tisk_zadost_9 = ActiveCell.Value
                If tisk_zadost_9 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_09" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_9").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If
         '---------------------
         ' tisk |fffd||fffd|dost Konsolidace10 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 10
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 10"
        Else
                ThisWorkbook.Sheets("Zadost_konsolidace_10").Visible = True
                ThisWorkbook.Sheets("Zadost_konsolidace_10").Select
                Range("A16").Select
                tisk_zadost_10 = ActiveCell.Value
                If tisk_zadost_10 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
                Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, Filename:=FullName & "_10" _
        , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
        IgnorePrintAreas:=False, OpenAfterPublish:=False
                ThisWorkbook.Sheets("Zadost_konsolidace_10").Select:
                End If
                ActiveWindow.SelectedSheets.Visible = False
        End If



        
    YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t slo|fffd|ku s ulo|fffd|en|fffd|mi PDF |fffd||fffd|dostmi?" _
, vbYesNo + vbQuestion, "Otev|fffd||fffd|t slo|fffd|ku?")
    Select Case YesNo
    Case vbYes
    myval = Shell("explorer C:\" & FolderName, 1)
    Case vbNo
    End Select
    
' vr|fffd|t|fffd| se na list A
konec:
'vymazat v|fffd|echny docx soubory ve slo|fffd|ce
If FolderName <> "" Then
    Call vymazatZeSlozkyDocx
End If
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect (abc)
ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
Range("C9").Select
' zapne aktualizaci obrazovky (na za|fffd||fffd|tku vypnuto, aby nep|fffd|eskakoval obraz p|fffd|i tisku)
Application.ScreenUpdating = stavScreenUpdatinguPred

End If
If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
    If ThisWorkbook.Sheets("B_Osobni_udaje").Visible = True Then
        ThisWorkbook.Sheets("B_Osobni_udaje").Visible = False
    End If
End If
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect (abc)
ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
ThisWorkbook.Protect (bcd)

ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 53
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case -2147018887
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument.", vbCritical, "Nelze generovat PDF - zav|fffd|ete p|fffd|vodn|fffd| dokument"
                        ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = False
                        ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub

Function DirExists(sSDirectory As String) As Boolean
If Dir(sSDirectory, vbDirectory) <> "" Then DirExists = True
End Function

Private Sub vymazatZeSlozkyDocx()
    Dim myvar As Variant
    Dim myFolder As String
    Dim i As Long
    
    myFolder = "C:\" & FolderName
    myvar = FileList(myFolder, "*.docx")
        For i = LBound(myvar) To UBound(myvar)
            On Error Resume Next
            Kill myFolder & myvar(i)
        Next
End Sub

Function FileList(fldr As String, Optional fltr As String = "*.*") As Variant
    Dim sTemp As String, sHldr As String
    If Right$(fldr, 1) <> "\" Then fldr = fldr & "\"
    sTemp = Dir(fldr & fltr)
    If sTemp = "" Then
        FileList = Split("No files found", "|")  'ensures an  array is returned
        Exit Function
    End If
    Do
        sHldr = Dir
        If sHldr = "" Then Exit Do
        sTemp = sTemp & "|" & sHldr
     Loop
    FileList = Split(sTemp, "|")
End Function

Attribute VB_Name = "Module10"
Option Explicit

Private Sub SplatkovyKalendarPdf()
Dim bcd
Dim stavScreenUpdatinguPred
Dim posledni_radek_tisku
Dim skryt_oblast_prazdnych_radku
Dim myval

'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    
''''    Call Thisworkbook.Sheets("1_Kalkulace").vynulovatSplatku
''''    Call Thisworkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
    
    
' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    
'Spl|fffd|tkov|fffd| kalend|fffd||fffd|
    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = True
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Select
        
         'pokud je individu|fffd|ln|fffd| sazba dostupn|fffd| (dle produktu a verze), ale je |fffd|patn|fffd| zad|fffd|no (nen|fffd| jako |fffd||fffd|slo nebo mimo min, max)
         If ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = True And ThisWorkbook.Sheets("Ciselniky").Range("D13").Value = True And ThisWorkbook.Sheets("Ciselniky").Range("D12").Value = False Then
          MsgBox "Spl|fffd|tkov|fffd| kalend|fffd||fffd| nelze vygenerovat, individu|fffd|ln|fffd| sazba je mimo povolen|fffd| rozmez|fffd|.", vbCritical, "Spl|fffd|tkov|fffd| kalend|fffd||fffd| - Individu|fffd|ln|fffd| sazba"
          GoTo konecSplatkovyKalendar
         End If
         
        posledni_radek_tisku = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H9").Value
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("1:414").Hidden = False
        skryt_oblast_prazdnych_radku = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H7").Value
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("" & skryt_oblast_prazdnych_radku & "").Hidden = True
        ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-kalkul|fffd|tor, pokud ne, vytvo|fffd||fffd| ji
        If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ\"
        
        Dim nazev_souboru As String
        nazev_souboru = "splatkovy-kalendar-" & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".pdf"
        'ulo|fffd||fffd| jako spl|fffd|tkov|fffd| kalend|fffd||fffd| RRRR-MM-DD_HH-MM-SS
        '''Thisworkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("A1", Cells(posledni_radek_tisku, 13)).ExportAsFixedFormat Type:=xlTypePDF,
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("A1", Cells(416, 13)).ExportAsFixedFormat Type:=xlTypePDF, _
            Filename:="C:\Sberbank CZ\" & nazev_souboru, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
            'p|fffd||fffd|padn|fffd| tisk
            'Application.Dialogs(xlDialogPrint).Show Arg4:=1, Arg12:=True
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("A1").Select
        'otev|fffd||fffd|t slou|fffd|ku s vygenerovan|fffd|mi dopisy
''        YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovan|fffd| spl|fffd|tkov|fffd| kalend|fffd||fffd|?", vbYesNo + vbQuestion, "Otev|fffd||fffd|t slo|fffd|ku?")
''            Select Case YesNo
''            Case vbYes
                myval = Shell("explorer " & "C:\Sberbank CZ\" & nazev_souboru, 1)
''            Case vbNo
''            End Select
konecSplatkovyKalendar:
    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = False
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    ThisWorkbook.Protect (bcd)
    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Attribute VB_Name = "Module11"
Option Explicit

Private Sub zadostiKonsolidace_zobrazit()
Dim i
For i = 1 To 10
Sheets("Zadost_konsolidace_" & i).Visible = True
Next i

End Sub
Private Sub zadostiKonsolidace_schovat()
Dim i
For i = 1 To 10
Sheets("Zadost_konsolidace_" & i).Visible = False
Next i

End Sub
Attribute VB_Name = "Module12"
        Option Explicit
        Dim nazevListu As String
        Global datumAktualizaceExternistu
        Global pocetExternichSpol As Integer
        
        Sub AktualizovatSeznamExternistu()
            nazevListu = "SeznamIDExternistu"
            
            If worksheetexists(nazevListu) Then
                Application.DisplayAlerts = False
                Worksheets(nazevListu).Delete
                Application.DisplayAlerts = True
                Call GetDataExternistu
                'aby se neaktualizovalo v|fffd|ckr|fffd|t za den
                datumAktualizaceExternistu = Date
            Else
                Call GetDataExternistu
            End If
            
        End Sub
        Private Sub GetDataExternistu()
        Dim ExcelKalkulator As Workbook
        Dim DataZWebuWorkbook As Workbook
        Dim DataZWebu As Worksheet
        Dim abc
        
        abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
        Set ExcelKalkulator = ActiveWorkbook
        
        ' Open The Web Workbook
        Workbooks.Open ("http://vbcz/externiziskatele/person_xls.php?akt=1")
        
        ' Set the Web Workbook and Worksheet Variables
        Set DataZWebuWorkbook = ActiveWorkbook
        Set DataZWebu = ActiveSheet
        
        
        ' Copy The Web Worksheet To My Workbook and Rename
        ExcelKalkulator.Unprotect (abc)
        DataZWebu.Copy After:=ExcelKalkulator.Sheets(Sheets.Count)
        
        ''nutno odemknout se|fffd|it
        ExcelKalkulator.Unprotect (abc)
        ExcelKalkulator.Sheets("person_xls").Name = nazevListu
        
        ' Close the Web Workbook
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
        DataZWebuWorkbook.Close SaveChanges:=False
        End Sub
        
        Public Function worksheetexists(sheetname As String, Optional wrkbk As Workbook) As Boolean
            Dim wrksht As Worksheet
        
            If wrkbk Is Nothing Then
                Set wrkbk = ActiveWorkbook
            End If
        
            On Error Resume Next
        
            Set wrksht = wrkbk.Worksheets(nazevListu)
            worksheetexists = (Err.Number = 0)
            Set wrksht = Nothing
        
            On Error GoTo 0
        End Function
        
        Sub AktualizovatSeznamExternichSpolecnosti()
            nazevListu = "SeznamExternichSpolecnosti"

            If worksheetexists(nazevListu) Then
                Application.DisplayAlerts = False
                Worksheets(nazevListu).Delete
                Application.DisplayAlerts = True
                Call GetDataExternichSpolecnosti
            Else
                Call GetDataExternichSpolecnosti
            End If
            MsgBox "hotovo"
        End Sub
        Private Sub GetDataExternichSpolecnosti()
        Dim ExcelKalkulator As Workbook
        Dim DataZWebuWorkbook As Workbook
        Dim DataZWebu As Worksheet
        Dim abc
        
        abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
        Set ExcelKalkulator = ActiveWorkbook

        ' Open The Web Workbook
        Workbooks.Open ("http://vbcz/externiziskatele/comp_xls.php?name=&akt=1")

        ' Set the Web Workbook and Worksheet Variables
        Set DataZWebuWorkbook = ActiveWorkbook
        Set DataZWebu = ActiveSheet


        ' Copy The Web Worksheet To My Workbook and Rename
        
            ExcelKalkulator.Unprotect (abc)
        DataZWebu.Copy After:=ExcelKalkulator.Sheets(Sheets.Count)
            ExcelKalkulator.Unprotect (abc)
        ExcelKalkulator.Sheets("comp_xls").Name = nazevListu

        ' Close the Web Workbook
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Activate
        DataZWebuWorkbook.Close SaveChanges:=False
        
        'dot|fffd|hnout adresy a se|fffd|adit podle abecedy
        Call adresyExternichSpolecnosti
        End Sub
        
        Sub adresyExternichSpolecnosti()
        Dim idSpolecnosti As String
        Dim ie As Object
        Dim my_url As String
        Dim Results As Object
        Dim itm As Variant
        
        'vymazat, pokud ji|fffd| nebylo vymaz|fffd|no
            If ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Range("C1").Value <> "Smlouva" Then
              Union(ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Columns("C:Q"), ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Columns("T:V")).Delete
            End If
        
        pocetExternichSpol = 0
        Do While Not IsEmpty(ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 1).Value)
        
        
         idSpolecnosti = ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 1).Value
                    ' open IE, navigate to the website of interest
                    Set ie = CreateObject("InternetExplorer.Application")
                    my_url = "http://vbcz/externiziskatele/comp_contacts.php?id=" & CStr(idSpolecnosti) & "&akt=1&name="
        
                    With ie
                        .Visible = False
                        .navigate my_url
                        .Top = 50
                        .Left = 530
                        .Height = 400
                        .Width = 400
        
                    Do Until Not ie.Busy And ie.readyState = 4
                        DoEvents
                    Loop
        
                    End With
        
                ' na|fffd||fffd|st adresu
                    Set Results = ie.document.getElementsByTagName("input")
                    For Each itm In Results
                        If InStr(1, itm.outerhtml, "f_adr", vbTextCompare) > 0 Then
                                If itm.Value = "" Then
                                  ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 5).EntireRow.Delete
                                  '(kv|fffd|li vymaz|fffd|n|fffd| |fffd||fffd|dku)
                                  pocetExternichSpol = pocetExternichSpol - 1
                                Else
                                  ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 5).Value = itm.Value
                                End If
        
                            Exit For
                        End If
                    Next
                    ie.Quit
                    Set ie = Nothing
        
        'naj|fffd|t dal|fffd||fffd| spole|fffd|nost
        pocetExternichSpol = pocetExternichSpol + 1
        Loop
        
        
        
        'p|fffd|idat fiktivn|fffd| spole|fffd|nost CCC, a.s. (pou|fffd||fffd|v|fffd| Call Centrum pro obejit|fffd| kontrol)
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 2).Value = "CCC, a.s."
        
        'srovnat spole|fffd|nosti podle abecedy
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Sort.SortFields.Clear
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Sort.SortFields.Add Key:=Range("B3:B" & 3 + pocetExternichSpol), _
                SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
                
            With ActiveWorkbook.Sheets("SeznamExternichSpolecnosti").Sort
                .SetRange Range("A3:E" & 3 + pocetExternichSpol)
                .Header = xlGuess
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
        
        'opravit vzorce pro dota|fffd|en|fffd| extern|fffd| spole|fffd|nosti dle ID
        ThisWorkbook.Sheets("Data ze vstupu").Range("G52").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:J,10,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G53").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:D,3,0)&"" ""& VLOOKUP(G54,SeznamIDExternistu!A:D,4,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G55").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:F,6,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G56").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:G,7,0)"
        
        'seznam extern|fffd|ch spole|fffd|nost|fffd| - pokud se n|fffd|jak|fffd| p|fffd|idaly/ubraly, tak aby se objevili p|fffd|esn|fffd|
        'ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A16").Value = "SeznamExternichSpolecnosti!B3:B" & 3 + pocetExternichSpol
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A16").Value = ThisWorkbook.Sheets("Ciselniky").Range("A2399").Value
        
        Set Results = Nothing
        '''MsgBox "Seznam extern|fffd|ch spole|fffd|nost|fffd| aktualizov|fffd|n z intranetu"
        End Sub


Attribute VB_Name = "Module13"
Private Sub schovat_SU_nabidka()
Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
ThisWorkbook.Unprotect (abc)
    ThisWorkbook.Sheets("A_predbezna_nabidka").Select
ThisWorkbook.Sheets("SU_nabidka").Visible = False
ThisWorkbook.Protect (abc)
End Sub
Attribute VB_Name = "Module14"
Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro

    
    With Sheets("A_predbezna_nabidka").Range("C12:D12").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="Pobo|fffd|ka;eShop;Winback"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Sheets("A_predbezna_nabidka").Range("C12").Value = "Winback"
End Sub
Attribute VB_Name = "Module15"
'Sub uverSBeznymUctem()
' Dim stavScreenUpdatinguPred
'    stavScreenUpdatinguPred = Application.ScreenUpdating
'    Application.ScreenUpdating = False
' Dim abc
'  abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
'  ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
'
'    ' upravit v|fffd||fffd|ku |fffd||fffd|dku 32, napsat do n|fffd|j '|fffd|v|fffd|r s b|fffd|n|fffd|m |fffd||fffd|tem'
'    If ThisWorkbook.Sheets("A_predbezna_nabidka").Range("A32").Value = "zobrazit |fffd||fffd|dek" Then
'        Rows(32).RowHeight = 15
'        ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C32:D32").Locked = False
'        ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C32").Value = ""
'    Else
'        'semsem
'        ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C32:D32").Locked = True
'        Rows(32).RowHeight = 6
'    End If
'
'    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
'    Application.ScreenUpdating = stavScreenUpdatinguPred
'End Sub
Attribute VB_Name = "Module16"
Sub datumPosledniSplatky()
' datum posledn|fffd| spl|fffd|tky
    ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30:D30").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
With ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30")
    .FormulaR1C1 = "=IF(OR(R[-1]C="""",ISNUMBER(FIND(""("",R[-1]C))),""""," & Chr(10) & "IF(R[-1]C=""-"",""-""," & Chr(10) & "DATE(YEAR(R[-1]C),MONTH(R[-1]C)+R[-5]C-1,DAY(R[-1]C))))"
    .NumberFormat = "m/d/yyyy"
    .Select
    Selection.Locked = True
    Selection.FormulaHidden = True
    .Interior.Color = RGB(216, 216, 216)
End With
End Sub
Sub pojisteniCestovni()
' cestovn|fffd| poji|fffd|t|fffd|n|fffd|
    ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30").Select
        Selection.Locked = False
        Selection.FormulaHidden = True
        Selection.Interior.Color = RGB(188, 230, 34)
    With Selection.Validation
    'With ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=INDIRECT(""Ciselniky!A1290:A1292"")"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Selection.ClearContents
End Sub


Sub pojisteniKartyOsobnichVeci()
'poji|fffd|t|fffd|n|fffd| karty a osobn|fffd|ch v|fffd|c|fffd|
    ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C31").Select
    With Selection.Validation
    'With ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=indirect(""Ciselniky!A1284:A1285"")"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Selection.ClearContents
End Sub
Sub pojisteniSchopnostiSplacet()
'poji|fffd|t|fffd|n|fffd| karty a osobn|fffd|ch v|fffd|c|fffd|
    ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C31").Select
    With Selection.Validation
    'With ThisWorkbook.Sheets("A_predbezna_nabidka").Range("C30").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=indirect(""Ciselniky!A107:A109"")"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    Selection.ClearContents
End Sub
Sub minMaxSplatnostBonus()
Dim stavScreenUpdatinguPred
Dim abc

'splatnost u produktu s Bonusem je 60,72,84,96, ostatni 12-96 po jednotlivych mesicich
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)

        If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("$C$23").Value = "F|fffd|R p|fffd|j|fffd|ka BONUS 20%" Or _
           ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("$C$23").Value = "F|fffd|R konsolidace BONUS 20%" Then
            With Range("C25:D25").Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="60,72,84,96"
            End With
        Else
            With ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C25:D25").Validation
                .Delete
                .Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertStop, _
                Operator:=xlBetween, Formula1:="=INDIRECT(""Ciselniky!B12"")", Formula2:="=INDIRECT(""Ciselniky!B13"")"
                .IgnoreBlank = False
                .InCellDropdown = False
            End With
       End If
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Attribute VB_Name = "Module2"
Sub makro()
'servisn|fffd| makro cvi|fffd|en|fffd| for loopu - hromadn|fffd| p|fffd|i|fffd|azen|fffd| - ov|fffd||fffd|en|fffd| dat na listu C
'obalen|fffd| funkc|fffd| nep|fffd||fffd|m|fffd|.odkaz (INDIRECT), aby bylo mo|fffd|n|fffd| odkazovat se na jin|fffd| listy (ulo|fffd|en|fffd| v Office 2013 rozbije vyb|fffd|rac|fffd| seznamy pro star|fffd||fffd| verze)
    For i = 18 To 153 Step 15
    Cells(i, 3).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=INDIRECT(""Ciselniky!$A$98:$A$99"")"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "Klient |fffd||fffd|daj|fffd|c|fffd| o konsolidaci"
        .ErrorTitle = "Nepovolen|fffd| hodnota"
        .InputMessage = "Zvolte hodnotu ze seznamu"
        .ErrorMessage = "Zvolte hodnotu ze seznamu!"
        .ShowInput = True
        .ShowError = True
    End With
    Next i
    
End Sub

Sub vymazatKonsolidaci2()
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Range("C33", "C42:C46").Value = ""
End Sub
Attribute VB_Name = "Module3"
Option Explicit

Sub dotahni_PSC_z_tisku()
Dim stavScreenUpdatinguPred
' dot|fffd|hne PS|fffd| |fffd|adatele a spolu|fffd|adatele, pokud je vypln|fffd|no..
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    Range("C106").FormulaR1C1 = "=IF(R[-50]C<>"""",R[-50]C,"""")"
    Range("D106").FormulaR1C1 = "=IF(R[-50]C<>"""",R[-50]C,"""")"
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub konsolidace_schovat_radky()
Dim abc
Dim bcd
Dim stavScreenUpdatinguPred

'schovat sekci konsolidace, pokud nen|fffd| jako produkt zvolena konsolidace
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    
If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A128").Value = "zobrazit sekci" Then
Rows("128:139").Select: Selection.EntireRow.Hidden = False
    If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A140").Value = "zobrazit |fffd||fffd|dek" Then
    Rows("140").Select: Selection.EntireRow.Hidden = False
    End If
Rows("141:142").Select: Selection.EntireRow.Hidden = False

Else
'schovat sekci konsolidace, pokud nen|fffd| jako produkt zvolena konsolidace
Rows("128:140").Select: Selection.EntireRow.Hidden = True
Rows("141:142").Select: Selection.EntireRow.Hidden = True
End If

'TOP UP skryt|fffd| |fffd||fffd|dk|fffd| krom produktu 1
If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C23").Value = "F|fffd|R p|fffd|j|fffd|ka (TOP UP)" Or ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C23").Value = "F|fffd|R p|fffd|j|fffd|ka (TOP UP B@W)" Then
   
   'promazat p|fffd|vodn|fffd| vypln|fffd|n|fffd| konsolidovan|fffd| produkty na listu A
   ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("B130:H139").Value = ""
   'promazat p|fffd|vodn|fffd| vypln|fffd|n|fffd| konsolidovan|fffd| produkty na listu C
   Call list_C_reset_vzorcu_a_vymazat
   
   'p|fffd|edvyplnit produkt Sberbank
   ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("B130").Value = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
   ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C130").Value = "Sberbank CZ, a.s."
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Rows("131:139").Select: Selection.EntireRow.Hidden = True
   ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Range("C10").Value = "Nav|fffd||fffd|en|fffd| sou|fffd|asn|fffd|ho |fffd|v|fffd|ru"
End If

    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select: Range("C23").Select
    ThisWorkbook.Protect (bcd)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub


Sub schovat_ESC_radky()
Dim abc
Dim bcd

' =kdy|fffd| je to BRANCH verze
' schovat_ESC_radky Makro -- skryje |fffd||fffd|dky, pokud to nen|fffd| ESC verze
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect Password:=abc
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    
    'zobraz|fffd| |fffd||fffd|dek 1 '|fffd|v|fffd|rov|fffd| anga|fffd|ovanost'
    Rows("1").EntireRow.Hidden = False
    
    'odkryje |fffd||fffd|dek 'sou|fffd|et produkt|fffd| viditeln|fffd|ch v InfoRegistru' - u produktu konsolidace
    Rows("140").EntireRow.Hidden = False
    
    ' nastavit |fffd||fffd|seln|fffd|k
    Range("C12:D12").Select
    Selection.ClearContents
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="Pobo|fffd|ka,eShop"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    'skryje |fffd||fffd|dky extern|fffd|ho zprost|fffd|edkovatele "ID", "jm|fffd|no", "adresa", atd.
    Rows("11:17").Select: Selection.EntireRow.Hidden = True
    Rows("12").Select: Selection.EntireRow.Hidden = False

    'proma|fffd|e 'Typ produkt', 'druh nab|fffd|dky' a 'detail produktu'
    Range("C19").Value = ""
        'pokud je to verze ESC p|fffd|edvypln|fffd| se 'spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r', pokud ne z|fffd|stane pr|fffd|zdn|fffd|
        If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC" Then
         Range("C19").Value = "SPOT|fffd|EBITELSK|fffd| |fffd|V|fffd|R"
        Else
         Range("C19").Value = ""
        End If
    
    'BRANCH - pole "Voln|fffd| nezaji|fffd|t|fffd|n|fffd| |fffd|v|fffd|rov|fffd| anga|fffd|ovanost u SB CZ"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect Password:=abc
    Range("C21:D21").Select
    Selection.Value = ""
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween, Formula1:="0", Formula2:="1500000"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = "Nepovolen|fffd| hodnota"
        .InputMessage = ""
        .ErrorMessage = "Voln|fffd| nezaji|fffd|t|fffd|n|fffd| |fffd|v|fffd|rov|fffd| anga|fffd|ovanost mus|fffd| b|fffd|t kladn|fffd| |fffd||fffd|slo (max 1 500 000 K|fffd|)!"
        .ShowInput = True
        .ShowError = True
    End With
    Selection.NumberFormat = "#,##0"
        
    Range("C22").Value = ""
    Range("C23").Value = ""
    'zobrazit dolo|fffd|en|fffd| p|fffd||fffd|jmu pro BRANCH (=zobrazen|fffd|)
    Rows("20").EntireRow.Hidden = False
    'zobrazit dolo|fffd|en|fffd| p|fffd||fffd|jmu pro ESC (=schovan|fffd|)
    Rows("22").EntireRow.Hidden = True
'''    'skryje poji|fffd|t|fffd|n|fffd| --- pro|fffd|?
'''    Rows("31").Select: Selection.EntireRow.Hidden = True
    
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect Password:=abc
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Rows("49:67").EntireRow.Hidden = True
    Range("C12").Activate
    
    
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect Password:=abc
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select
    Rows("12:13").Select
    Selection.EntireRow.Hidden = True
    Range("C10").Activate
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect Password:=abc
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect Password:=abc
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect Password:=abc
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select: Range("C9").Select
    ThisWorkbook.Protect (bcd)
End Sub

Sub zobrazit_ESC_radky()
Dim abc
Dim bcd

' =verze ESC
' zobrazit_ESC_radky Makro -- zobraz|fffd| |fffd||fffd|dky, pokud je to ESC verze
    'skryje/zobraz|fffd| pole na list A
    
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    
    'schov|fffd| |fffd||fffd|dek 1 '|fffd|v|fffd|rov|fffd| anga|fffd|ovanost'
    Rows("1").EntireRow.Hidden = True
    'zobrazit dolo|fffd|en|fffd| p|fffd||fffd|jmu (=zobrazen|fffd|)
    Rows("22").EntireRow.Hidden = False
    'zobrazit dolo|fffd|en|fffd| p|fffd||fffd|jmu pro BRANCH (=schovan|fffd|)
    Rows("20").EntireRow.Hidden = True
    
    
    'schov|fffd| |fffd||fffd|dek 'sou|fffd|et produkt|fffd| viditeln|fffd|ch v InfoRegistru' - u produktu konsolidace
    Rows("140").EntireRow.Hidden = True
    
    ' vymazat Typ procesu pro Jm|fffd|no ESC
    Range("C12:D12").Select
    Selection.ClearContents
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    'zobraz|fffd| |fffd||fffd|dky extern|fffd|ho zprost|fffd|edkovatele "ID", "jm|fffd|no", "adresa", atd.
    Rows("11:15").Select: Selection.EntireRow.Hidden = False

    'Rows("31").EntireRow.Hidden = False
    'proma|fffd|e 'Typ produkt', 'druh nab|fffd|dky' a 'detail produktu'
    Range("C19").Value = ""
        'pokud je to verze ESC p|fffd|edvypln|fffd| se 'spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r', pokud ne z|fffd|stane pr|fffd|zdn|fffd|
        If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC" Then
         Range("C19").Value = "SPOT|fffd|EBITELSK|fffd| |fffd|V|fffd|R"
        Else
         Range("C19").Value = ""
        End If
    
    'Druh nab|fffd|dky
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    Range("C21:D21").Select
    Selection.Value = ""
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AF$112:$AF$113"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    Range("C22").Value = ""
    Range("C23").Value = ""
    
    'skryje/zobraz|fffd| pole na list B
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Rows("49:67").EntireRow.Hidden = False
    Range("C12").Activate
    
    'skryje/zobraz|fffd| pole na list C
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect (abc)
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select
    Rows("12:13").Select
    Selection.EntireRow.Hidden = False
    Range("C10").Activate
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect Password:=abc
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect Password:=abc
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect Password:=abc
    'vr|fffd|t|fffd| se na list A
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select: Range("C9").Select
    ThisWorkbook.Protect (bcd)
End Sub


'' Nakop|fffd|ruje zda maj|fffd| spole|fffd|nou dom|fffd|cnost do sekce n|fffd|klady na dom|fffd|cnost
'Sub obnovitMajiDomacnostZeSouhlasu()
''

'' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'Application.ScreenUpdating = False
'    Range("D96").Select.FormulaR1C1 = "=A_Predbezna_nabidka!R[-52]C"
'    Range("D44").Select
'Application.ScreenUpdating = True
'End Sub

'schov|fffd|
Sub schovat_listB_listC()
Dim stavScreenUpdatinguPred
Dim bcd

stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
 bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
 ThisWorkbook.Unprotect (bcd)
 ThisWorkbook.Sheets("B_Osobni_udaje").Visible = False
 ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = False
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
 ThisWorkbook.Protect (bcd)
 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Public Sub zobrazit_listB_listC()
Dim stavScreenUpdatinguPred
Dim abc
Dim bcd

stavScreenUpdatinguPred = Application.ScreenUpdating
 Application.ScreenUpdating = False
 abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
 bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
 ThisWorkbook.Unprotect (bcd)

 ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
 ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect (abc)

 ThisWorkbook.Sheets("B_Osobni_udaje").Visible = True
 ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = True

 ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
 ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect (abc)

 ThisWorkbook.Protect (bcd)
 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Sub nastavVzorceListB()
Dim abc

' nastavVzorceListB makro
'nakop|fffd|ruje vzorce, aby se vypln|fffd|n|fffd| |fffd|daje automaticky dot|fffd|hli na list B z listu A
 abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
 ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    'rodn|fffd| |fffd||fffd|slo, datum a pohlav|fffd|
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C12:D15").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[55]C<>"""",A_Predbezna_nabidka!R[55]C,"""")"
        
    'hlavn|fffd| dokument a |fffd||fffd|slo
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C22:D23").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[50]C<>"""",A_Predbezna_nabidka!R[50]C,"""")"
        
    'adresa koresponden|fffd|n|fffd|, pokud ESC, dot|fffd|hnou se z listu A, jinak pouze PS|fffd| z listu
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C33:D34").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
        'PS|fffd|
        ThisWorkbook.Sheets("B_Osobni_udaje").Range("C35:D35").NumberFormat = "000 00"
        ThisWorkbook.Sheets("B_Osobni_udaje").Range("C40:D40").NumberFormat = "000 00"
        
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C35:D35").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
        
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C36").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D36").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    'adresa trval|fffd| pobyt
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C38:D40").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C41").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D41").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    
'    'pokud PS|fffd| dot|fffd|hnout
'    Thisworkbook.Sheets("B_Osobni_udaje").Range("C35").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[58]C<>"""",A_Predbezna_nabidka!R[58]C,"""")"
'    Thisworkbook.Sheets("B_Osobni_udaje").Range("D35").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[58]C<>"""",A_Predbezna_nabidka!R[58]C,"""")"
'    Thisworkbook.Sheets("B_Osobni_udaje").Range("D38:D41").FormulaR1C1 = "=IF(RC[-5]<>"""",RC[-5],"""")"
    
    
    'mobil, email
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C45:D45").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[19]C<>"""",A_Predbezna_nabidka!R[19]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C47:D47").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[18]C<>"""",A_Predbezna_nabidka!R[18]C,"""")"
        
    'zam|fffd|stn|fffd|n|fffd|
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C51:D51").FormulaR1C1 = "Zam|fffd|stnanec"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C52:D61").FormulaR1C1 = ""
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C63:D67").FormulaR1C1 = ""
    
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Range("C12").Select
    
 ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
End Sub

Sub adresy_na_listB_spoluzadatel()
Dim stavScreenUpdatinguPred
Dim abc

'pokud maj|fffd| spole|fffd|nou dom|fffd|cnost, mus|fffd| adresy spolu|fffd|adatele se p|fffd|edvypln|fffd| ... mus|fffd| se shodovat
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    'adresa koresp-ulice',
    If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("E104").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost" Then
     
     ThisWorkbook.Sheets("B_Osobni_udaje").Range("D33:D34").Locked = False
     ThisWorkbook.Sheets("B_Osobni_udaje").Range("D33:D36").FormulaR1C1 = "=IF(B_Osobni_udaje!RC[-1]<>"""",B_Osobni_udaje!RC[-1],"""")"
     ThisWorkbook.Sheets("B_Osobni_udaje").Range("D33:D36").Locked = True
    Else
        ''promazat, kdy|fffd| nemaj|fffd| spole|fffd|nou dom|fffd|cnost, v|fffd|e krom |fffd|esk|fffd| republika
        'Thisworkbook.Sheets("B_Osobni_udaje").Range("D33:D34").FormulaR1C1 = ""
      ThisWorkbook.Sheets("B_Osobni_udaje").Range("D33:D34").Locked = False
      ThisWorkbook.Sheets("B_Osobni_udaje").Range("D33:D36").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
      'adresa trval|fffd| pobyt
      ThisWorkbook.Sheets("B_Osobni_udaje").Range("D38:D41").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[21]C<>"""",A_Predbezna_nabidka!R[21]C,"""")"
    End If
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub


Sub vzorVyplnitListA_proTiskSouhlasu()

' vzorVyplnitListA Makro
' vzorov|fffd| vypln|fffd| list A pro tisk

End Sub

Attribute VB_Name = "Module4"
Option Explicit

Sub PSC_na_listB_zadatel()
Attribute PSC_na_listB_zadatel.VB_Description = "'PS|fffd|, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B"
Attribute PSC_na_listB_zadatel.VB_ProcData.VB_Invoke_Func = " \n14"
Dim stavScreenUpdatinguPred
Dim abc

'PS|fffd|, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C35").FormulaR1C1 = "=A_Predbezna_nabidka!R[71]C"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C107").Select
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Sub PSC_na_listB_spoluzadatel()
Dim stavScreenUpdatinguPred
Dim abc

'PS|fffd|, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D35").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R[69]C[1]=""Maj|fffd| spole|fffd|nou dom|fffd|cnost"",A_Predbezna_nabidka!R[71]C[-1],A_Predbezna_nabidka!R[71]C)"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("D107").Select
    ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
''Sub obcanstvi_na_listB_zadatel()
'''
'''obcanstvi, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
''    Application.ScreenUpdating = False
''    abc = Thisworkbook.Sheets("heslo").Range("B1").Value
''    Thisworkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
''    Thisworkbook.Sheets("B_Osobni_udaje").Range("C12").FormulaR1C1 = "=A_Predbezna_nabidka!R67C"
''    Thisworkbook.Sheets("A_Predbezna_nabidka").Range("C68").Select
''    Thisworkbook.Sheets("B_Osobni_udaje").Protect (abc)
''    Application.ScreenUpdating = True
''End Sub
''
''Sub obcanstvi_na_listB_spoluzadatel()
'''obcanstvi, kdy|fffd| se vypln|fffd| na listu A -- aby se propsalo na list B
''    Application.ScreenUpdating = False
''    abc = Thisworkbook.Sheets("heslo").Range("B1").Value
''    Thisworkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
''    Thisworkbook.Sheets("B_Osobni_udaje").Range("D12").FormulaR1C1 = "=A_Predbezna_nabidka!R67C"
''    Thisworkbook.Sheets("A_Predbezna_nabidka").Range("D68").Select
''    Thisworkbook.Sheets("B_Osobni_udaje").Protect (abc)
''    Application.ScreenUpdating = True
''End Sub
'funkce, kter|fffd| odstran|fffd| diakritiku, pou|fffd||fffd|v|fffd| se pro n|fffd|zvy soubor|fffd| apod.

    Function OdstarnDiakr(source As Variant) As String
    If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then

        Const cz As String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||61a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||75e||fffd|.,:;?!|fffd||fffd|%()=+<>/\*||fffd|"
        Const en As String = "aAcCdDeEeEeEiInNoOoOrRsStTuUuUuUyYzZ"

        Dim TmpS As String
        Dim OutS As String
        Dim i As Integer

        OutS = ""

           If IsNull(source) Or source = "" Then
            OdstarnDiakr = ""
           Else

           For i = 1 To Len(source)
                TmpS = Mid(source, i, 1)
           If InStr(1, cz, TmpS, vbBinaryCompare) > 0 Then TmpS = Mid(en, InStr(1, cz, TmpS, vbBinaryCompare), 1)
                OutS = OutS & TmpS
           Next i
            OdstarnDiakr = OutS
           End If
    End If
    End Function

Attribute VB_Name = "Module5"
Option Explicit

Sub resetListA()
Dim stavScreenUpdatinguPred
Dim abc

' resetListA Makro
' obnov|fffd| vzorce na listu A, listu B a listu C a vyma|fffd|e v|fffd|choz|fffd| hodnoty

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    Call resetListB: Call list_C_reset_vzorcu_a_vymazat
    
    Application.Run ThisWorkbook.Sheets("A_Predbezna_nabidka").schovat_sekci_souhlas
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    

    
    ' obnov|fffd| vzorce na listu B a listu C a vyma|fffd|e v|fffd|choz|fffd| hodnoty
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("C9").FormulaR1C1 = "=TODAY()"
    Range("C9").NumberFormat = "m/d/yyyy"
    Range("C10").Value = ""
    Range("C11").Value = ""
    Range("C12").Value = ""
    Range("C13").Value = ""
    Range("C14").Value = "+420"
    ''d|fffd|lalo n|fffd|jak|fffd| pot|fffd|e
    ''Range("C14").NumberFormat = "+###,###,###,###,###"
    Range("C15").Value = ""
       
    Range("C19").Value = ""
        'pokud je to verze ESC p|fffd|edvypln|fffd| se 'spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r', pokud ne z|fffd|stane pr|fffd|zdn|fffd|
        If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC" Then
         Range("C19").Value = "SPOT|fffd|EBITELSK|fffd| |fffd|V|fffd|R"
        Else
         Range("C19").Value = ""
        End If
    Range("C20").Value = ""
    Range("C21").Value = ""
    Range("C22").Value = ""
    Range("C23").Value = ""
    Range("C24").Value = ""
    Range("C25").Value = ""
    Range("C29").Value = ""
    Range("C31").Value = ""
    
    'IndividualniSazbaCheckbox
    Call zobrazitIndividualniSazbaCheckbox
    Call individualniSazbaSchovat
    Call zamknoutUrokovouSazbu
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    Range("D44").FormulaR1C1 = "Bez spolu|fffd|adatele"
    Range("C45:D51").Value = ""
    Range("D52").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost"
    
    Range("C54:D56").Value = ""
    Range("C57:D57").Value = "|fffd|esk|fffd| republika"
    
    Range("C59:D61").Value = ""
    Range("C62:D62").Value = "|fffd|esk|fffd| republika"

    Range("C64:D65").Value = ""
    ''d|fffd|lalo n|fffd|jak|fffd| pot|fffd|e
    ''Range("C64:D64").NumberFormat = "+###,###,###,###,###"
    
    Range("C67:D67").Value = "|fffd|esk|fffd| republika"
    Range("C68:D70").Value = ""
    Range("C72:D73").Value = ""
    
    'p|fffd||fffd|jmy
    Range("C79:D79").Value = ""
    Range("C83:D88").Value = ""
    'dal|fffd||fffd| p|fffd||fffd|jem
    Range("C91:D94").Value = ""
    
    'M|fffd| |fffd|adatel sjedn|fffd|n hypote|fffd|n|fffd| |fffd|v|fffd|r?
    Range("C99").Value = ""
    
    'v|fffd|daje
    Range("C100:D103").Value = ""
    
    'Opravit 'Maj|fffd| spole|fffd|nou dom|fffd|cnost'
    Range("D104").Value = "Maj|fffd| spole|fffd|nou dom|fffd|cnost"
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Range("D104").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=INDIRECT(""Ciselniky!C98:C99"")"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    'N|fffd|klady na dom|fffd|cnost
    Range("C105:D109").Value = ""
    
    'skr|fffd|t v|fffd|po|fffd|ty
    Rows("110:126").Hidden = True
    
    'sekce konsolidace
    Range("B130:H139").Value = ""
    
    'trval|fffd| adresa |fffd|adatele a spolu|fffd|adatele, nen|fffd| shodn|fffd|
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M117").Value = False
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N117").Value = False
    
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPred
    MsgBox ("Hotovo! Hodnoty z listu 'A_Predbezna_nabidka', 'B_Osobni_udaje', 'C_Dodate|fffd|n|fffd| informace' byly resetov|fffd|ny.")
    Range("C9").Select
End Sub
Sub resetListB()
Dim abc

' resetListB Makro
' obnov|fffd| vzorce na listu B (dotahovan|fffd| hodnoty z listu A ze sekce souhlas, aby nemusel poradce vypl|fffd|ovat dvakr|fffd|t)
'|fffd|patn|fffd|... :-/
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)

    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C12:D12").FormulaR1C1 = "|fffd|esk|fffd| republika"
    
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C18:D20").FormulaR1C1 = ""
    
    'hlavn|fffd| dokument
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C22:D27").FormulaR1C1 = ""
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C26:D26").FormulaR1C1 = "|fffd|esk|fffd| republika"
        
    'druh|fffd| dokument
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C29:D29").FormulaR1C1 = ""
    
    'trval|fffd| adresa |fffd|adatele a spolu|fffd|adatele, nen|fffd| shodn|fffd|
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M118").Value = False
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N118").Value = False
    
    Call nastavVzorceListB
    
ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
End Sub

Sub list_C_reset_vzorcu_a_vymazat()
Dim abc
Dim bcd

    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Unprotect (abc)

ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = True
ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select
    Range("C10").FormulaR1C1 = "=IF(A_Predbezna_nabidka!R23C3=Ciselniky!R93C1,""Splacen|fffd| jin|fffd|ho |fffd|v|fffd|ru"","""")"
    Range("C11").FormulaR1C1 = "=IF(Ciselniky!R[-9]C[-1]=""ESC"",""Od extern|fffd|ho zprost|fffd|edkovatele"","""")"
    Range("C12").FormulaR1C1 = "Prost|fffd|ednictv|fffd|m extern|fffd|ho zprost|fffd|edkovatele"
    Range("C13").FormulaR1C1 = "=A_Predbezna_nabidka!R12C"
    Range("C14").FormulaR1C1 = ""
    Range("C15").FormulaR1C1 = ""
    
    'kons 1
    Range("C18").Value = ""
    Range("C24").Value = "=IF(A_Predbezna_nabidka!G130<>"""",A_Predbezna_nabidka!G130,"""")"
    Range("C27:C31").Value = ""
    Range("C29").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1577<>"""",Ciselniky!S1577,"""")"
    Range("C30").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1577<>"""",Ciselniky!T1577,"""")"
    
    'kons 2
    Range("C33").Value = ""
    Range("C39").Value = "=IF(A_Predbezna_nabidka!G131<>"""",A_Predbezna_nabidka!G131,"""")"
    Range("C42:C46").Value = ""
    
    Range("C44").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1578<>"""",Ciselniky!S1578,"""")"
    Range("C45").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1578<>"""",Ciselniky!T1578,"""")"
    
    'kons 3
    Range("C48").Value = ""
    Range("C54").Value = "=IF(A_Predbezna_nabidka!G132<>"""",A_Predbezna_nabidka!G132,"""")"
    Range("C57:C61").Value = ""
    Range("C59").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1579<>"""",Ciselniky!S1579,"""")"
    Range("C60").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1579<>"""",Ciselniky!T1579,"""")"
    
    'kons 4
    Range("C63").Value = ""
    Range("C69").Value = "=IF(A_Predbezna_nabidka!G133<>"""",A_Predbezna_nabidka!G133,"""")"
    Range("C72:C76").Value = ""
    Range("C74").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1580<>"""",Ciselniky!S1580,"""")"
    Range("C75").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1580<>"""",Ciselniky!T1580,"""")"
    
    'kons 5
    Range("C78").Value = ""
    Range("C84").Value = "=IF(A_Predbezna_nabidka!G134<>"""",A_Predbezna_nabidka!G134,"""")"
    Range("C87:C91").Value = ""
    Range("C89").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1581<>"""",Ciselniky!S1581,"""")"
    Range("C90").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1581<>"""",Ciselniky!T1581,"""")"
    
    'kons 6
    Range("C93").Value = ""
    Range("C99").Value = "=IF(A_Predbezna_nabidka!G135<>"""",A_Predbezna_nabidka!G135,"""")"
    Range("C102:C106").Value = ""
    Range("C104").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1582<>"""",Ciselniky!S1582,"""")"
    Range("C105").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1582<>"""",Ciselniky!T1582,"""")"
    
    'kons 7
    Range("C108").Value = ""
    Range("C114").Value = "=IF(A_Predbezna_nabidka!G136<>"""",A_Predbezna_nabidka!G136,"""")"
    Range("C117:C121").Value = ""
    Range("C119").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1583<>"""",Ciselniky!S1583,"""")"
    Range("C120").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1583<>"""",Ciselniky!T1583,"""")"
    
    'kons 8
    Range("C123").Value = ""
    Range("C129").Value = "=IF(A_Predbezna_nabidka!G137<>"""",A_Predbezna_nabidka!G137,"""")"
    Range("C132:C136").Value = ""
    Range("C134").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1584<>"""",Ciselniky!S1584,"""")"
    Range("C135").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1584<>"""",Ciselniky!T1584,"""")"
    
    'kons 9
    Range("C138").Value = ""
    Range("C144").Value = "=IF(A_Predbezna_nabidka!G138<>"""",A_Predbezna_nabidka!G138,"""")"
    Range("C147:C151").Value = ""
    Range("C149").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1585<>"""",Ciselniky!S1585,"""")"
    Range("C150").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1585<>"""",Ciselniky!T1585,"""")"
    
    'kons 10
    Range("C153").Value = ""
    Range("C159").Value = "=IF(A_Predbezna_nabidka!G139<>"""",A_Predbezna_nabidka!G139,"""")"
    Range("C162:C166").Value = ""
    Range("C164").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!S1586<>"""",Ciselniky!S1586,"""")"
    Range("C165").Select
    ActiveCell.NumberFormat = "general"
    ActiveCell.Formula = "=IF(Ciselniky!T1586<>"""",Ciselniky!T1586,"""")"
    
    'pokud je to verze ESC odkryj|fffd| se |fffd||fffd|dky, pokud ne skryj|fffd| se
    If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value = "ESC" Then
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select:   Rows("12:13").Select
    Selection.EntireRow.Hidden = False
    End If
    
    'pokud to nen|fffd| verze ESC skryj|fffd| se |fffd||fffd|dky
    If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value <> "ESC" Then
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Select:   Rows("12:13").Select
    Selection.EntireRow.Hidden = True
    End If
    
    ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Protect (abc)
    Range("C10").Select
End Sub
Sub zobrazitIndividualniSazbaCheckbox()
If ThisWorkbook.Sheets("Ciselniky").Range("D13").Value = False Then
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Visible = False
    ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = False
    Call zamknoutUrokovouSazbu
Else
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Visible = True
    ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = False
End If
End Sub
Sub A_predbezna_nabidka_individualniCheckbox_Klepnuti()
Call individualniSazbaSchovat
Call vypocti_splatku_automaticky
End Sub

Sub individualniSazbaSchovat()
    'pokud nen|fffd| dostupn|fffd|, schovat
    If ThisWorkbook.Sheets("Ciselniky").Range("D13").Value = False Then
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Visible = False
        Call zamknoutUrokovouSazbu
    Else
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Visible = True
        Call individualniSazba
    End If
End Sub


Private Sub individualniSazba()
 Dim stavScreenUpdatinguPred
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
 Dim abc
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value

'pokud za|fffd|krtne, bude pole urokovaSazba editovateln|fffd|, a rovnou se vybere pro zad|fffd|v|fffd|n|fffd|
  
'opa|fffd|n|fffd| se pole urokovaSazba zamkne jako needitovateln|fffd|
  ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
'    ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Select
'    Selection.Characters.Text = "individu|fffd|ln|fffd| sazba"
 
    'ThisWorkbook.Sheets("A_Predbezna_nabidka").Shapes("individualniCheckbox").Visible = True
    If ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = True And ThisWorkbook.Sheets("Ciselniky").Range("D13").Value = True Then
        Call odemknoutUrokovouSazbu
        'Range("D35").Select
        'ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = True
    Else
        Call zamknoutUrokovouSazbu
        Range("D44").Select
        'ThisWorkbook.Sheets("Ciselniky").Range("D8").Value = False
    End If
 
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
 
 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Private Sub odemknoutUrokovouSazbu()
 Dim stavScreenUpdatinguPredTimhle
    stavScreenUpdatinguPredTimhle = Application.ScreenUpdating
    Application.ScreenUpdating = False
  Dim abc
  abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
  ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
  
    Range("D35").Locked = False
    Range("C45").Copy
    Range("D35").Select
    
    With Selection
        .PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
        .Font.Name = "Calibri"
        .Font.Size = 14
        .Font.Bold = True
        .NumberFormat = "#,##0.00"
        .HorizontalAlignment = xlLeft
    End With
    
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
 Application.ScreenUpdating = stavScreenUpdatinguPredTimhle
End Sub

Private Sub zamknoutUrokovouSazbu()
 Dim stavScreenUpdatinguPredTimhle
    stavScreenUpdatinguPredTimhle = Application.ScreenUpdating
    Application.ScreenUpdating = False
  Dim abc
  abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
  ThisWorkbook.Sheets("A_Predbezna_nabidka").Unprotect (abc)
  
'zamknout |fffd|rokovou sazbu
    'Range("D35").Select
    With Range("D35")
        .NumberFormat = "#,##0.00"
        .Formula = "=Ciselniky!D7"
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
        .Locked = True
    End With
    
    Range("C35").Copy
    Range("D35").PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Protect (abc)
    Application.ScreenUpdating = stavScreenUpdatinguPredTimhle
End Sub

Sub shodna_adresa_zadatel_listB()
 Dim stavScreenUpdatinguPred
 
 'na listu B trval|fffd| adresa |fffd|adatele - shodn|fffd| s koresponden|fffd|n|fffd|
 'vypln|fffd|, pokud jsou shodn|fffd|
 stavScreenUpdatinguPred = Application.ScreenUpdating
 Application.ScreenUpdating = False
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
 Call zobrazit_listB_listC
 Application.ScreenUpdating = False
 End If
 
 Dim abc
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
  ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)

 
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M118").Value = False Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Range("C38:C41").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C38:C40").Value = ""
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C40").NumberFormat = "000 00"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C41").Value = "|fffd|esk|fffd| republika"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C38").Select
 End If
 'proma|fffd|e, pokud nejsou shodn|fffd|
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("M118").Value = True Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Range("C38:C41").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C38:C40").FormulaR1C1 = "=if(R[-5]C<>"""",R[-5]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C40").NumberFormat = "000 00"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C41").FormulaR1C1 = "=if(R[-5]C<>"""",R[-5]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("C45").Select
    
 End If
 
 ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)
 
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
 Call schovat_listB_listC
 End If
 

 Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub shodna_adresa_spoluzadatel_listB()
 Dim stavScreenUpdatinguPred
 Dim abc
 
 'na listu B trval|fffd| adresa spolu|fffd|adatele - shodn|fffd| s koresponden|fffd|n|fffd|
 'vypln|fffd|, pokud jsou shodn|fffd|
 stavScreenUpdatinguPred = Application.ScreenUpdating
 Application.ScreenUpdating = False
If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
 Call zobrazit_listB_listC
 End If
  abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
  ThisWorkbook.Sheets("B_Osobni_udaje").Unprotect (abc)
  
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N118").Value = True Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Range("D38:D41").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D38:D40").FormulaR1C1 = "=if(R[-5]C<>"""",R[-5]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D40").NumberFormat = "000 00"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D41").FormulaR1C1 = "=if(R[-5]C<>"""",R[-5]C,"""")"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D45").Select
 End If
 'proma|fffd|e, pokud nejsou shodn|fffd|
 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("N118").Value = False Then
    ThisWorkbook.Sheets("B_Osobni_udaje").Select
    Range("D38:D41").Select
    Selection.NumberFormat = "General"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D38:D40").Value = ""
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D40").NumberFormat = "000 00"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D41").Value = "|fffd|esk|fffd| republika"
    ThisWorkbook.Sheets("B_Osobni_udaje").Range("D38").Select
 End If
 
 ThisWorkbook.Sheets("B_Osobni_udaje").Protect (abc)

 If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("A21").Value = "tisk_souhlasu" Then
 Call schovat_listB_listC
 End If
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Attribute VB_Name = "Module6"
Option Explicit
Dim splatkaCelkem
'Dim pocetMesicu
    
'    Dim urokovaSazba
    Dim jistinaPred
    Dim splatkaJistiny
    Dim month
Dim posledniSplatka As Double

'    Dim vypujcenaCastka
Public a As Integer
Public Row As Integer
Public Col As Integer
Public SplatkaFinal As Long
Public suma As Double
Sub PrepnoutR1C1()
'p|fffd|epne mezi stylem vzorc|fffd|
Application.ReferenceStyle = xlR1C1
End Sub

Sub PrepnoutA1()
'p|fffd|epne mezi stylem vzorc|fffd|
Application.ReferenceStyle = xlA1
End Sub
'Sub testRPSN()
'Call HledamSpravneRPSN(8.99, 300000, 4414, 34.634535039374, 96)
'
'End Sub

Sub RPSN()
Dim sazba As Double
Dim vyseUveru As Long
Dim vypoctenaSplatka As Long
Dim pocetMesicu As Integer


sazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
vyseUveru = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
vypoctenaSplatka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value
pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
posledniSplatka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("j2").Value
Call HledamSpravneRPSN(sazba, vyseUveru, vypoctenaSplatka, posledniSplatka, pocetMesicu)
End Sub

Sub HledamSpravneRPSN(sazba As Double, vyseUveru As Long, vypoctenaSplatka As Long, posledniSplatka As Double, pocetMesicu As Integer)
'Public suma As Double
'Dim vyseUveru As Long
Dim sazbaRPSN1 As Double 'levy okraj v prohledavanem intervalu
Dim sazbaRPSN2 As Double 'pravy okraj v prohledavanem intervalu
'Dim sazba
Dim minulaSuma As Double
Dim sazbaRPSN As Double
Dim j As Integer
' jen pro testovani pak tyto promee zrusit
'sazba = 6.65
'vyseUveru = 500000
'pocetMesicu = 71
'vypoctenaSplatka = 8561
'posledniSplatka = 56



minulaSuma = 0
suma = 0
sazbaRPSN1 = sazba
sazbaRPSN2 = sazba * 3
sazbaRPSN = sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2
' testuji vysi RPSN
For j = 1 To 1000
    If Not Round(suma * 1000, 14) = vyseUveru And Not Round(suma * 1000, 14) = Round(minulaSuma * 1000, 14) Or j = 1 Then
'    If Not Round(suma, 0) = vyseUveru Or j = 1 Then
        
        minulaSuma = suma
        
        ' Volim novou vysi sazbaRPSN a testujuji
        Call VypocetRPSN(vypoctenaSplatka, posledniSplatka, pocetMesicu, sazbaRPSN, vyseUveru, sazba)
'        GoTo vyskoc
        If suma < vyseUveru Then
            sazbaRPSN2 = sazbaRPSN ' posunuji levy okraj intervalu

        ElseIf suma > vyseUveru Then
            sazbaRPSN1 = sazbaRPSN  ' posunuji pravy okraj intervalu

        ElseIf Round(suma, 0) = vyseUveru Or Not Round(suma, 2) = Round(minulaSuma, 2) Then
            GoTo vyskoc
        End If
        
        'vypocitam novou sazbu RPSN uz s posunutymi kraji intervalu
        'sazbaRPSN = Round(sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2, 8)
        sazbaRPSN = sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2
        
        
    Else:
'        Debug.Print "RPSN je " & sazbaRPSN & " soucetRPSN je " & suma & " a dosla jsem na konec"
        GoTo vyskoc
    
    End If
Next
vyskoc:
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7").Value = Round(sazbaRPSN, 2)
'ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H7").Value = sazbaRPSN
'Debug.Print "RPSN je " & Round(sazbaRPSN, 14) & " soucetRPSN je " & suma & " minula suma byla" & minulaSuma & " uver byl " & vyseUveru & " j = " & j & " leva hranice je " & sazbaRPSN1 & " prava hranice je " & sazbaRPSN2
End Sub

Sub VypocetRPSN(Splatka As Long, posledniSplatka As Double, pocetMesicu As Integer, sazbaRPSN As Double, vyseUveru As Long, sazba As Double)
'    Dim suma As Double
'    sazbaRPSN = 9.5132
    Dim pocetDni As Integer
    Dim jednorazovyPoplatekpocetDni1 As Integer
    Dim jednorazovyPoplatekpocetDni2 As Integer
    Dim jednorazovyPoplatekpocetDni3 As Integer
    Dim jednorazovyPoplatekpocetDni4 As Integer
    Dim jednorazovyPoplatekpocetDni5 As Integer
    Dim i As Integer
    Dim datumCerpani As Date
    Dim datumSplatky As Date
    Dim jednorazovyPoplatekdatumSplatky1 As Date
    Dim jednorazovyPoplatekdatumSplatky2 As Date
    Dim jednorazovyPoplatekdatumSplatky3 As Date
    Dim jednorazovyPoplatekdatumSplatky4 As Date
    Dim jednorazovyPoplatekdatumSplatky5 As Date
    Dim prestupnyRok As Boolean
    Dim jednorazovyPoplatek1 As Double
    Dim jednorazovyPoplatek2 As Double
    Dim jednorazovyPoplatek3 As Double
    Dim jednorazovyPoplatek4 As Double
    Dim jednorazovyPoplatek5 As Double
    
    Dim pravidelnyPoplatek1 As Double
    Dim pravidelnyPoplatek2 As Double
    Dim urokOdlozeni As Double
    Dim k As Integer
    Dim ZbyleUroky As Double
    
    jednorazovyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C11").Value
    jednorazovyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C12").Value
    jednorazovyPoplatek3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C13").Value
    jednorazovyPoplatek4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C14").Value
    jednorazovyPoplatek5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C15").Value
    
    datumCerpani = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V22").Value
    
    jednorazovyPoplatekdatumSplatky1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B11").Value
    jednorazovyPoplatekdatumSplatky2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B12").Value
    jednorazovyPoplatekdatumSplatky3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B13").Value
    jednorazovyPoplatekdatumSplatky4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B14").Value
    jednorazovyPoplatekdatumSplatky5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B15").Value
    
    jednorazovyPoplatekpocetDni1 = jednorazovyPoplatekdatumSplatky1 - datumCerpani
    jednorazovyPoplatekpocetDni2 = jednorazovyPoplatekdatumSplatky2 - datumCerpani
    jednorazovyPoplatekpocetDni3 = jednorazovyPoplatekdatumSplatky3 - datumCerpani
    jednorazovyPoplatekpocetDni4 = jednorazovyPoplatekdatumSplatky4 - datumCerpani
    jednorazovyPoplatekpocetDni5 = jednorazovyPoplatekdatumSplatky5 - datumCerpani
    
    ' Do vypoctu RPSN musim zapocitat i odurocene jednorazove poplatky
    suma = jednorazovyPoplatek1 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni1 / 365) + jednorazovyPoplatek2 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni2 / 365) + jednorazovyPoplatek3 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni3 / 365) + jednorazovyPoplatek4 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni4 / 365) + jednorazovyPoplatek5 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni5 / 365)
    pravidelnyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C18").Value
    pravidelnyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C19").Value
    
    ' Ke splatce prictu vsechny pravidelne poplatky, splatnost maji ve stejny den jako splatka
    Splatka = Splatka + pravidelnyPoplatek1 + pravidelnyPoplatek2
    
'V KONSOLID|fffd|N|fffd|M KALKUL|fffd|TORU NELZE SPL|fffd|TKU ODLO|fffd|IT A PROTO NEN|fffd| T|fffd|EBA |fffd|E|fffd|IT
    
'   zapocitavam do RPSN i dobu kdy jsou spl|fffd|ty odlo|fffd|en|fffd|, |fffd|rok zapo|fffd||fffd|t|fffd|v|fffd|m ka|fffd|d|fffd| |fffd|tvrtlet|fffd|, poji|fffd|t|fffd|n|fffd| ka|fffd|d|fffd| m|fffd|s|fffd|c
'    ZbyleUroky = 0
'    For k = 24 To 71
'        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("A" & k).Value = True Then
'            If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "poji|fffd|t|fffd|n|fffd|" Then
'                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
'                pocetDni = datumSplatky - datumCerpani
'                suma = suma + (pravidelnyPoplatek1 + pravidelnyPoplatek2) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'            ElseIf ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "kvart|fffd|l" Then
'                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
'                pocetDni = datumSplatky - datumCerpani
'                urokOdlozeni = vyseUveru * sazba
'                If urokOdlozeni > splatka Then
'                    ZbyleUroky = ZbyleUroky + urokOdlozeni - splatka
'                    urokOdlozeni = splatka
'                End If
'                suma = suma + (urokOdlozeni) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'            End If
'        End If
'    Next
    
    For i = 1 To pocetMesicu
        datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & 71 + i).Value
        prestupnyRok = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("M" & 71 + i).Value
        pocetDni = datumSplatky - datumCerpani
    ' vypocet RPSN v jednom mesici plu rovnou pricteni k sume
    ' treba ocetrit pocet dnu v prestupnem roce to se bude delit 366 misto 365
        If prestupnyRok = False Then
            If i < pocetMesicu Then
                suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni
            Else
                suma = suma + (posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni & " " & datumSplatky
            End If
        ElseIf prestupnyRok = True Then
            If i < pocetMesicu Then
                suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
'                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je " & pocetDni / 366 & " " & pocetDni
            Else
                suma = suma + (posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
'                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je "; pocetDni / 366 & " " & pocetDni
            End If
        End If
            If suma > vyseUveru + ZbyleUroky Then
                GoTo skonci
            End If
    Next
skonci:

'    Debug.Print suma & " " & i
End Sub
            Sub RPSN_s_bonusem()
            Dim sazba As Double
            Dim vyseUveru As Long
            Dim vypoctenaSplatka As Long
            Dim pocetMesicu As Integer
            
            
            sazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
            vyseUveru = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
            vypoctenaSplatka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value
            pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
            posledniSplatka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("j2").Value
            Call HledamSpravneRPSN_s_bonusem(sazba, vyseUveru, vypoctenaSplatka, posledniSplatka, pocetMesicu)
            End Sub
            
            Sub HledamSpravneRPSN_s_bonusem(sazba As Double, vyseUveru As Long, vypoctenaSplatka As Long, posledniSplatka As Double, pocetMesicu As Integer)
            'Public suma As Double
            'Dim vyseUveru As Long
            Dim sazbaRPSN1 As Double 'levy okraj v prohledavanem intervalu
            Dim sazbaRPSN2 As Double 'pravy okraj v prohledavanem intervalu
            'Dim sazba
            Dim minulaSuma As Double
            Dim sazbaRPSN As Double
            Dim j As Integer
            ' jen pro testovani pak tyto promee zrusit
            'sazba = 6.65
            'vyseUveru = 500000
            'pocetMesicu = 71
            'vypoctenaSplatka = 8561
            'posledniSplatka = 56
            
            
            
            minulaSuma = 0
            suma = 0
            sazbaRPSN1 = sazba / 2
            sazbaRPSN2 = sazba * 3
            sazbaRPSN = sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2
            ' testuji vysi RPSN
            For j = 1 To 1000
                If Not Round(suma * 1000, 14) = vyseUveru And Not Round(suma * 1000, 14) = Round(minulaSuma * 1000, 14) Or j = 1 Then
            '    If Not Round(suma, 0) = vyseUveru Or j = 1 Then
                    
                    minulaSuma = suma
                    
                    ' Volim novou vysi sazbaRPSN a testujuji
                    Call VypocetRPSN_s_bonusem(vypoctenaSplatka, posledniSplatka, pocetMesicu, sazbaRPSN, vyseUveru, sazba)
            '        GoTo vyskoc
                    If suma < vyseUveru Then
                        sazbaRPSN2 = sazbaRPSN ' posunuji levy okraj intervalu
            
                    ElseIf suma > vyseUveru Then
                        sazbaRPSN1 = sazbaRPSN  ' posunuji pravy okraj intervalu
            
                    ElseIf Round(suma, 0) = vyseUveru Or Not Round(suma, 2) = Round(minulaSuma, 2) Then
                        GoTo vyskoc
                    End If
                    
                    'vypocitam novou sazbu RPSN uz s posunutymi kraji intervalu
                    'sazbaRPSN = Round(sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2, 8)
                    sazbaRPSN = sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2
                    
                    
                Else:
            '        Debug.Print "RPSN je " & sazbaRPSN & " soucetRPSN je " & suma & " a dosla jsem na konec"
                    GoTo vyskoc
                
                End If
            Next
vyskoc:
            ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("G7").Value = Round(sazbaRPSN, 2)
            'ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H7").Value = sazbaRPSN
            'Debug.Print "RPSN je " & Round(sazbaRPSN, 14) & " soucetRPSN je " & suma & " minula suma byla" & minulaSuma & " uver byl " & vyseUveru & " j = " & j & " leva hranice je " & sazbaRPSN1 & " prava hranice je " & sazbaRPSN2
            End Sub
            
            Sub VypocetRPSN_s_bonusem(Splatka As Long, posledniSplatka As Double, pocetMesicu As Integer, sazbaRPSN As Double, vyseUveru As Long, sazba As Double)
            '    Dim suma As Double
            '    sazbaRPSN = 9.5132
                Dim pocetDni As Integer
                Dim jednorazovyPoplatekpocetDni1 As Integer
                Dim jednorazovyPoplatekpocetDni2 As Integer
                Dim jednorazovyPoplatekpocetDni3 As Integer
                Dim jednorazovyPoplatekpocetDni4 As Integer
                Dim jednorazovyPoplatekpocetDni5 As Integer
                Dim i As Integer
                Dim datumCerpani As Date
                Dim datumSplatky As Date
                Dim jednorazovyPoplatekdatumSplatky1 As Date
                Dim jednorazovyPoplatekdatumSplatky2 As Date
                Dim jednorazovyPoplatekdatumSplatky3 As Date
                Dim jednorazovyPoplatekdatumSplatky4 As Date
                Dim jednorazovyPoplatekdatumSplatky5 As Date
                Dim prestupnyRok As Boolean
                Dim jednorazovyPoplatek1 As Double
                Dim jednorazovyPoplatek2 As Double
                Dim jednorazovyPoplatek3 As Double
                Dim jednorazovyPoplatek4 As Double
                Dim jednorazovyPoplatek5 As Double
                
                Dim pravidelnyPoplatek1 As Double
                Dim pravidelnyPoplatek2 As Double
                Dim urokOdlozeni As Double
                Dim k As Integer
                Dim ZbyleUroky As Double
                
                jednorazovyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C11").Value
                jednorazovyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C12").Value
                jednorazovyPoplatek3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C13").Value
                jednorazovyPoplatek4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C14").Value
                jednorazovyPoplatek5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C15").Value
                
                datumCerpani = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("V22").Value
                
                jednorazovyPoplatekdatumSplatky1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("B11").Value
                jednorazovyPoplatekdatumSplatky2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("B12").Value
                jednorazovyPoplatekdatumSplatky3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("B13").Value
                jednorazovyPoplatekdatumSplatky4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("B14").Value
                jednorazovyPoplatekdatumSplatky5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("B15").Value
                
                jednorazovyPoplatekpocetDni1 = jednorazovyPoplatekdatumSplatky1 - datumCerpani
                jednorazovyPoplatekpocetDni2 = jednorazovyPoplatekdatumSplatky2 - datumCerpani
                jednorazovyPoplatekpocetDni3 = jednorazovyPoplatekdatumSplatky3 - datumCerpani
                jednorazovyPoplatekpocetDni4 = jednorazovyPoplatekdatumSplatky4 - datumCerpani
                jednorazovyPoplatekpocetDni5 = jednorazovyPoplatekdatumSplatky5 - datumCerpani
                
                ' Do vypoctu RPSN musim zapocitat i odurocene jednorazove poplatky
                suma = jednorazovyPoplatek1 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni1 / 365) + jednorazovyPoplatek2 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni2 / 365) + jednorazovyPoplatek3 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni3 / 365) + jednorazovyPoplatek4 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni4 / 365) + jednorazovyPoplatek5 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni5 / 365)
                pravidelnyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C18").Value
                pravidelnyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C19").Value
                
                ' Ke splatce prictu vsechny pravidelne poplatky, splatnost maji ve stejny den jako splatka
                Splatka = Splatka + pravidelnyPoplatek1 + pravidelnyPoplatek2
                
            'V KONSOLID|fffd|N|fffd|M KALKUL|fffd|TORU NELZE SPL|fffd|TKU ODLO|fffd|IT A PROTO NEN|fffd| T|fffd|EBA |fffd|E|fffd|IT
                
            '   zapocitavam do RPSN i dobu kdy jsou spl|fffd|ty odlo|fffd|en|fffd|, |fffd|rok zapo|fffd||fffd|t|fffd|v|fffd|m ka|fffd|d|fffd| |fffd|tvrtlet|fffd|, poji|fffd|t|fffd|n|fffd| ka|fffd|d|fffd| m|fffd|s|fffd|c
            '    ZbyleUroky = 0
            '    For k = 24 To 71
            '        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("A" & k).Value = True Then
            '            If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "poji|fffd|t|fffd|n|fffd|" Then
            '                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
            '                pocetDni = datumSplatky - datumCerpani
            '                suma = suma + (pravidelnyPoplatek1 + pravidelnyPoplatek2) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            '            ElseIf ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "kvart|fffd|l" Then
            '                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
            '                pocetDni = datumSplatky - datumCerpani
            '                urokOdlozeni = vyseUveru * sazba
            '                If urokOdlozeni > splatka Then
            '                    ZbyleUroky = ZbyleUroky + urokOdlozeni - splatka
            '                    urokOdlozeni = splatka
            '                End If
            '                suma = suma + (urokOdlozeni) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            '            End If
            '        End If
            '    Next
                
                For i = 1 To pocetMesicu
                    datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("V" & 71 + i).Value
                    prestupnyRok = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("M" & 71 + i).Value
                    pocetDni = datumSplatky - datumCerpani
                ' vypocet RPSN v jednom mesici plu rovnou pricteni k sume
                ' treba ocetrit pocet dnu v prestupnem roce to se bude delit 366 misto 365
                    If prestupnyRok = False Then
                        If i < pocetMesicu Then
                            suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            '                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni
                        Else
                            suma = suma + (posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            '                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni & " " & datumSplatky
                        End If
                    ElseIf prestupnyRok = True Then
                        If i < pocetMesicu Then
                            suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
            '                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je " & pocetDni / 366 & " " & pocetDni
                        Else
                            suma = suma + (posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
            '                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je "; pocetDni / 366 & " " & pocetDni
                        End If
                    End If
                        If suma > vyseUveru + ZbyleUroky Then
                            GoTo skonci
                        End If
                Next
skonci:
            
            '    Debug.Print suma & " " & i
            End Sub
'Sub mericCasu()
'Dim StartTime
'StartTime = Timer
' Call najdiSplatku
'
'Debug.Print Timer - StartTime
'End Sub


Sub Splatka()
Dim mesicniSplatka As Long
Dim UrokovaSazba As Double
Dim vypujcenaCastka As Long
Dim pocetMesicu As Integer
 
UrokovaSazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
vypujcenaCastka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
mesicniSplatka = -Pmt(UrokovaSazba / 12 / 100, pocetMesicu, vypujcenaCastka)

Call najdiSplatku(mesicniSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu, "normal")
End Sub

Sub najdiSplatku(mesicniSplatka As Long, UrokovaSazba As Double, vypujcenaCastka As Long, pocetMesicu As Integer, typ As String)
 
    Dim i As Integer
    Dim newSplatka As Long
    Dim x1
    Dim x2
    Dim x1jistina
    Dim x2jistina
    Dim pocitadlo As Integer
    Dim posledniSplatkaPredchozi

'    urokovaSazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
'    pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
'    vypujcenaCastka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value

    'startovaciSplatka - Excel vzorcem Platba (vzorec bere 12 stejn|fffd|ch m|fffd|s|fffd|c|fffd| = sazba / 12)
'    newSplatka = -WorksheetFunction.Pmt(urokovaSazba / 12 / 100, pocetMesicu, vypujcenaCastka, 0)
    newSplatka = mesicniSplatka
    x1 = newSplatka * 0.9
    x2 = newSplatka * 1.1
    
    splatkaCelkem = newSplatka
    
    month = 0
    pocitadlo = 0
    posledniSplatkaPredchozi = 0
    
    Do While pocitadlo < 300 And Not (Round(jistinaPred, 0) = 0 And pocetMesicu = month)
    ''''And jistinaPred >= 0 And jistinaPred < splatkaCelkem And pocetMesicu - 1 = month)
        pocitadlo = pocitadlo + 1
        
            
            Call splatkovyKalendar(newSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu)
            
            If Round(posledniSplatka, 0) = Round(posledniSplatkaPredchozi, 0) Then
                ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = Application.WorksheetFunction.RoundUp(newSplatka, 0)
                    'posledn|fffd| spl|fffd|tka, pokud mi hled|fffd|n|fffd| spl|fffd|tky na|fffd|lo optimum p|fffd|i {po|fffd|et m|fffd|s|fffd|c|fffd| - 1}, vyjde spr|fffd|vn|fffd| spl|fffd|tka rovnou, pokud se bere {po|fffd|et m|fffd|s|fffd|c|fffd|}, potom ode|fffd|tu od {newSplatka} posledn|fffd| jistinu
                    If posledniSplatka < 0 Then
                        ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value - Abs(posledniSplatka)
                    Else
                        ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J2").Value = posledniSplatka
                    End If
                GoTo konec
            Else
                posledniSplatkaPredchozi = posledniSplatka
            End If
        
            'jistinaPoSplatce < splatkaCelkem a pocetMesicu = month
            If jistinaPred >= 0 And jistinaPred < splatkaCelkem And pocetMesicu = month Then
                x1 = newSplatka
                    'posledn|fffd| spl|fffd|tka je ni|fffd||fffd||fffd| ne|fffd| pravideln|fffd|, ale v|fffd|t|fffd||fffd| ne|fffd| 0 = vyrovn|fffd|v|fffd|m rozd|fffd|l, kv|fffd|li zaokrouhlen|fffd| spl|fffd|tek
                    'o|fffd|et|fffd|it jistinaPoSplatce > 0
                    'moc vysok|fffd| spl|fffd|tka
                    
                'optim|fffd|ln|fffd| spl|fffd|tka
                
            
            'jistinaPoSplatce > splatkaCelkem and pocetMesicu = month
            ElseIf jistinaPred > splatkaCelkem And pocetMesicu = month Then
                'moc n|fffd|zk|fffd| spl|fffd|tka -- lev|fffd| hranice hledan|fffd| spl|fffd|tky (x1)
                ''x1jistina = jistinaPred
                x1 = newSplatka
                
            
            'jistinaPoSplatce <= splatkaCelkem and pocetMesicu > month
            ElseIf jistinaPred <= splatkaCelkem And pocetMesicu > month Then
                'moc vysok|fffd| spl|fffd|tka -- prav|fffd| hranice hledan|fffd| spl|fffd|tky (x1)
                ''x2jistina = jistinaPred
                x2 = newSplatka
            End If
            
                newSplatka = x1 + Abs((x2 - x1) / 2)
        
        
    Loop

konec:

''MsgBox "pocitadlo=" & pocitadlo & "hur|fffd| zaokrouhlit spl|fffd|tku + zbytek jistiny = posledn|fffd| spl|fffd|tka"
''    - 12 stejn|fffd|ch spl|fffd|tek
''
'zaokrouhlit spl|fffd|tku
newSplatka = WorksheetFunction.Ceiling(newSplatka, 1)
'znovu dosadit do kalend|fffd||fffd|e
Call splatkovyKalendar(newSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu)

'Debug.Print "newSplatka=" & newSplatka
'Debug.Print "posledniSplatka=" & posledniSplatka
SplatkaFinal = newSplatka

    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = SplatkaFinal

'    - zbytek jistiny = posledn|fffd| spl|fffd|tka

    
     
     'jistinaPoSplatce
     'splatkaCelkem
    
    'vr|fffd|t|fffd| se na za|fffd||fffd|tek (a rozp|fffd|l|fffd| hledan|fffd| interval)
    
    
    'ThisWorkbook.Sheets("List1").Range("A2").GoalSeek Goal:=0, ChangingCell:=ThisWorkbook.Sheets("List1").Range("B1")
    

    
 End Sub
 Sub splatkovyKalendar(splatkaCelkem, UrokovaSazba As Double, vypujcenaCastka As Long, pocetMesicu As Integer)
     Dim i
     Dim splatkaUrok
     Dim pocetDni
     Dim pocetDniPosledni
     Dim splatkaUrokPosledni
     'spl|fffd|tkov|fffd| kalend|fffd||fffd| se zvolenou spl|fffd|tkou
    'i = po|fffd|et m|fffd|s|fffd|c|fffd|
    
'''        splatkaCelkem = 9100
'''        jistinaPred = 100000
'''        pocetMesicu = 12
'''        urokovaSazba = 1.79
    
'    Debug.Print splatkaCelkem
    
    jistinaPred = vypujcenaCastka
    
    
    For i = 1 To pocetMesicu
        '|fffd|rok za obdob|fffd| 5 000
        'vzorec jistinaPoSplatce*(sazba / 12 / 100) * pocetDni / 360
        'pocetDni = 30
'
        pocetDni = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("K" & 71 + i).Value
'        splatkaUrok = jistinaPred * urokovaSazba / 100 * pocetDni / 360
'        splatkaUrok = Round(splatkaUrok, 2)

        splatkaUrok = jistinaPred * UrokovaSazba / 100 * pocetDni / 360
        ''vypnuto splatkaUrok = Round(splatkaUrok, 2)
        
'        Debug.Print "i=" & i & "-dni=" & pocetDni & "-splatkaUrok=" & splatkaUrok
        
    
        'spl|fffd|tka celkem 15 000 = |fffd|rok 5 000 + spl|fffd|tka jistiny 10 000
        'spl|fffd|tka jistiny 10 000 = spl|fffd|tka celkem 15 000 - |fffd|rok 5 000
        splatkaJistiny = splatkaCelkem - splatkaUrok
            
        'jistina po spl|fffd|tce = jistinaPred pro dal|fffd||fffd| m|fffd|s|fffd|c = 990 000
''        If i = pocetMesicu And jistinaPred < 2 * splatkaCelkem Then
''            'jistinaPred = jistinaPred - splatkaJistiny
''            MsgBox "bla"
''        Else
            jistinaPred = jistinaPred - splatkaJistiny
''        End If
        
        month = i
'        i = i + 1
'        Debug.Print i & " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & "splatka uroku " & splatkaUrok
        
         pocetDniPosledni = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("K" & 71 + pocetMesicu).Value
         splatkaUrokPosledni = jistinaPred * UrokovaSazba / 100 * pocetDniPosledni / 360

        'divn|fffd| podm|fffd|nka, divn|fffd| m|fffd|sto -- pro|fffd| + 2 * i???
        'divn|fffd| podm|fffd|nka, divn|fffd| m|fffd|sto -- p|fffd||fffd|p + 1 * i???
        If jistinaPred + splatkaUrokPosledni + i <= splatkaCelkem Then
        'If jistinaPred < 0 Then
'            Debug.Print i & " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & "splatka uroku " & splatkaUrok
            GoTo konec
'            Debug.Print " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & pocetMesicu
        End If
    Next
    
konec:
'posledn|fffd| spl|fffd|tka
        
        posledniSplatka = jistinaPred + splatkaUrokPosledni
        
        If Round(jistinaPred, 0) = 0 Then
            GoTo konec2
        End If
konec2:
 End Sub

'Sub testRPSN()
'Call HledamSpravneRPSN(6.65, 500000, 8561, 56, 71)
'
'' jen pro testovani pak tyto promee zrusit
''sazba = 6.65
''vyseUveru = 500000
''pocetMesicu = 71
''vypoctenaSplatka = 8561
''posledniSplatka = 56
'
'End Sub

Attribute VB_Name = "Module7"
Option Explicit

Sub welcome_screen_schovat()
Dim stavScreenUpdatinguPred
Dim bcd

'p|fffd|i otev|fffd|en|fffd| automaticky zkontroluje, zda jsou povolen|fffd| makra a v p|fffd||fffd|pad|fffd|, |fffd|e ano
'schov|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem jak zapnout makra' a zobraz|fffd| list A, B, C a D
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
Application.Calculation = xlCalculationAutomatic
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    
    If ThisWorkbook.Sheets("Ciselniky").Range("B2").Value <> "ZAM" Then
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Visible = True
        ThisWorkbook.Sheets("B_Osobni_udaje").Visible = True
        ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = True
        'ThisWorkbook.Sheets("D_NAB|fffd|DKA").Visible = True
        ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = False
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
    Else
            'verze ZAM
            ThisWorkbook.Sheets("A_Predbezna_nabidka_ZAM").Visible = True
            ThisWorkbook.Sheets("B_Osobni_udaje_ZAM").Visible = True
            ThisWorkbook.Sheets("C_Detaily_konsolidace_ZAM").Visible = True
            'ThisWorkbook.Sheets("Doplneni_zadosti_ZAM").Visible = True
            ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = False
            ThisWorkbook.Sheets("A_Predbezna_nabidka_ZAM").Select
    End If
            
    ActiveWindow.SmallScroll Down:=-300
    Range("C9").Select
    
ThisWorkbook.Protect (bcd)
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Sub welcome_screen_zobrazit()
Dim stavScreenUpdatinguPred
Dim bcd

'(p|fffd|i zav|fffd|en|fffd| automaticky) zobraz|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem, jak zapnout makra' a schov|fffd| v|fffd|echny listy
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    
    'schovat v|fffd|echny listy
   ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = True
        'verze BRANCH, ESC
        ThisWorkbook.Sheets("A_Predbezna_nabidka").Visible = False
        ThisWorkbook.Sheets("B_Osobni_udaje").Visible = False
        ThisWorkbook.Sheets("C_Dodate|fffd|n|fffd| informace").Visible = False
        'ThisWorkbook.Sheets("D_NAB|fffd|DKA").Visible = False
        ThisWorkbook.Sheets("Uvodni_obrazovka").Select
        'verze ZAM
            ThisWorkbook.Sheets("A_Predbezna_nabidka_ZAM").Visible = False
            ThisWorkbook.Sheets("B_Osobni_udaje_ZAM").Visible = False
            ThisWorkbook.Sheets("C_Detaily_konsolidace_ZAM").Visible = False
            'ThisWorkbook.Sheets("Doplneni_zadosti_ZAM").Visible = False
            'ThisWorkbook.Sheets("D_NAB|fffd|DKA").Visible = False
            ThisWorkbook.Sheets("Uvodni_obrazovka").Select
    Range("A4").Select

''schovat v|fffd|echny listy loopem... nefungovalo mi, proto|fffd|e se mus|fffd| domyslet, jak nechat zobrazen|fffd| alespo|fffd| jeden list
'     a = Sheets.Count - 1
'         For i = 2 To a
'         Thisworkbook.Sheets(i).Visible = False
'     Next i
    
    ThisWorkbook.Protect (bcd)
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Sub Pouceni_o_zpracovani_osob_udaju_schovat()
Dim abc
Dim bcd
Dim stavScreenUpdatinguPred

' Pouceni_o_zpracovani_osob_udaju_schovat Makro
' zobraz|fffd| list 'Pouceni_o_zpracovani_osob_udaju', skryje za|fffd|krt|fffd|vac|fffd| sekci dle produktu a zase list 'Pouceni_o_zpracovani_osob_udaju' schov|fffd|
'
abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
ThisWorkbook.Unprotect (bcd)
ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Unprotect (abc)
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    'pokud je F|fffd|r konsolidace zobraz|fffd| |fffd||fffd|dky 140-141, a skryje 142-148
    If ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Range("A140").Value = "zobrazit" Then
     ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = True
     ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Select
     Rows("140:141").EntireRow.Hidden = False
     ActiveSheet.Shapes("Check Box 30").Visible = True
    
    'skryje v p|fffd||fffd|pad|fffd| F|fffd|r p|fffd|j|fffd|ka (STANDARD)
     Rows("142:148").EntireRow.Hidden = True
     ActiveSheet.Shapes("Check Box 23").Visible = False
     ActiveSheet.Shapes("Check Box 24").Visible = False
    
     ActiveSheet.Shapes("Check Box 25").Visible = False
     ActiveSheet.Shapes("Check Box 26").Visible = False
     ActiveSheet.Shapes("Check Box 27").Visible = False
     ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = False
    Else
     ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = True
     ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Select

     Rows("140:141").EntireRow.Hidden = True
     ActiveSheet.Shapes("Check Box 30").Visible = False
    
    'zobraz|fffd| v p|fffd||fffd|pad|fffd| F|fffd|r p|fffd|j|fffd|ka (STANDARD)
     Rows("142:148").EntireRow.Hidden = False
     ActiveSheet.Shapes("Check Box 23").Visible = True
     ActiveSheet.Shapes("Check Box 24").Visible = True
    
     ActiveSheet.Shapes("Check Box 25").Visible = True
     ActiveSheet.Shapes("Check Box 26").Visible = True
     ActiveSheet.Shapes("Check Box 27").Visible = True
    ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Visible = False
    End If
ThisWorkbook.Sheets("A_Predbezna_nabidka").Select: Range("C21").Select
ThisWorkbook.Sheets("Pouceni_o_zpracovani_osob_udaju").Protect (abc)
ThisWorkbook.Protect (bcd)
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Attribute VB_Name = "Module8"
Option Explicit

Sub schovat_zadosti()
Dim stavScreenUpdatinguPred
Dim abc
Dim bcd

'(p|fffd|i zav|fffd|en|fffd| automaticky) zobraz|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem, jak zapnout makra' a schov|fffd| v|fffd|echny listy
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    
    'schovat v|fffd|echny listy
    
    ThisWorkbook.Sheets("Zadost_konsolidace_1").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_2").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_3").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_4").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_5").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_6").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_7").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_8").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_9").Visible = False
    ThisWorkbook.Sheets("Zadost_konsolidace_10").Visible = False
    
    ThisWorkbook.Sheets("Zadost_konsolidace_1").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_2").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_3").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_4").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_5").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_6").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_7").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_8").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_9").Protect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_10").Protect (abc)
    

    
    ThisWorkbook.Protect (bcd)
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub
Sub zobrazit_zadosti()
Dim stavScreenUpdatinguPred
Dim abc
Dim bcd

'(p|fffd|i zav|fffd|en|fffd| automaticky) zobraz|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem, jak zapnout makra' a schov|fffd| v|fffd|echny listy
stavScreenUpdatinguPred = Application.ScreenUpdating
Application.ScreenUpdating = False
    abc = ThisWorkbook.Sheets("heslo").Range("B1").Value
    bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
    ThisWorkbook.Unprotect (bcd)
    
    'schovat v|fffd|echny listy
    
    ThisWorkbook.Sheets("Zadost_konsolidace_1").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_2").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_3").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_4").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_5").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_6").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_7").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_8").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_9").Visible = True
    ThisWorkbook.Sheets("Zadost_konsolidace_10").Visible = True

    ThisWorkbook.Sheets("Zadost_konsolidace_1").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_2").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_3").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_4").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_5").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_6").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_7").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_8").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_9").Unprotect (abc)
    ThisWorkbook.Sheets("Zadost_konsolidace_10").Unprotect (abc)
    
    ThisWorkbook.Protect (bcd)
Application.ScreenUpdating = stavScreenUpdatinguPred
End Sub

Attribute VB_Name = "Module9"
Option Explicit

Sub vypocti_splatku_automaticky()

'pokud jsou vypln|fffd|ny v|fffd|echny pot|fffd|ebn|fffd| |fffd|daje a zm|fffd|n|fffd| se n|fffd|kter|fffd| z bun|fffd|k, vypo|fffd|te se automaticky, jako by se kliklo na tla|fffd||fffd|tko 'Vypo|fffd||fffd|tat spl|fffd|tku', jinak se nestane nic
 ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
 
 If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("K1").Value = "vstupy v po|fffd||fffd|dku mo|fffd|no spustit v|fffd|po|fffd|et" Then
 Call vypocti_splatku
'    Call Splatka
'    Call RPSN
'    Debug.Print "pocitam"
    'v|fffd|po|fffd|et spl|fffd|tky, RPSN s bonusem pokud bonus nenulov|fffd|
    If Val(ThisWorkbook.Sheets("Ciselniky").Range("B8").Value) = 0 Then
        'nic
    Else
        'Call RPSN_s_bonusem
        Call vypocti_splatku_s_bonusem
    End If
 Else: Exit Sub
 End If
End Sub


Sub vypocti_splatku()
Dim bcd
Dim test

' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'ud|fffd|lat hl|fffd|ku, pokud nejsou v|fffd|echny vstupy ... Range ("E22")
On Error GoTo konec:
Dim stavScreenUpdatinguPred As Boolean
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
With Application
        .MaxIterations = 100
        .MaxChange = 0.0001
    End With

bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
ThisWorkbook.Unprotect (bcd)
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = True
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Select

''o|fffd|et|fffd|en|fffd| vstup|fffd| z listu 3_Produkty
'kdy|fffd| se zm|fffd|n|fffd| bu|fffd|ka 'dopl|fffd|kov|fffd| |fffd||fffd|st |fffd|v|fffd|ru' a p|fffd|ekro|fffd||fffd| povolen|fffd| maximum, nebo je ve |fffd|patn|fffd|m form|fffd|tu
'    If IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B14").Value) = False Or _
'    Thisworkbook.Sheets("3_Produkty").Range("B14").Value > Thisworkbook.Sheets("3_Produkty").Range("B12").Value Then
'    Thisworkbook.Sheets("3_Produkty").Select
'    Range("B14").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| dopl|fffd|kovou |fffd||fffd|st |fffd|v|fffd|ru!": GoTo konec: End If

'dal|fffd||fffd| testov|fffd|n|fffd| na pot|fffd|ebn|fffd| vstupn|fffd| data
test = IsNumeric(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J7").Value)
'hlaska1 = Thisworkbook.Sheets("3_Produkty").Range("A10")
'test1 = IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B10").Value)
'hlaska2 = Thisworkbook.Sheets("3_Produkty").Range("A18")
'test2 = IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B18").Value)



If test = False Then
MsgBox "Check input data": GoTo konec: End If



'hlaska pokud nen|fffd| vypln|fffd|n |fffd|rok nebo je 0
'If IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B40").Value) = False Or Thisworkbook.Sheets("3_Produkty").Range("B40").Value <= 0 Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B40").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|rokovou sazbu nebo obnovte tla|fffd||fffd|tkem 'resetovat sazbu'!": GoTo konec: End If

'hlaska pokud nen|fffd| vypln|fffd|n 'datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru' nebo je |fffd|patn|fffd| form|fffd|t
'If IsDate(Thisworkbook.Sheets("3_Produkty").Range("B42").Value) = False Or Thisworkbook.Sheets("3_Produkty").Range("B42").Value <= 0 Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B42").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!": GoTo konec: End If

'hlaska pokud nen|fffd| vypln|fffd|n 'datum prvn|fffd| spl|fffd|tky' nebo je |fffd|patn|fffd| form|fffd|t
If IsDate(Range("C4").Value) = False Or Range("C4").Value <= 0 Then
MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum prvn|fffd| spl|fffd|tky nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!": GoTo konec: End If

'hlaska pokud datum prvn|fffd| spl|fffd|tky je men|fffd||fffd| (= d|fffd||fffd|v) ne|fffd| datum |fffd|erp|fffd|n|fffd|
If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C72").Value < ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C22").Value Then
MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t po na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!": GoTo konec: End If

'hl|fffd|ka pokud datum prvn|fffd| spl|fffd|tky je v|fffd|ce ne|fffd| 3 roky od |fffd|erp|fffd|n|fffd| spust|fffd| hl|fffd|ku a ukon|fffd||fffd| makro... (z|fffd|rove|fffd| se mus|fffd| zm|fffd|nit vzorec v bu|fffd|ce vedle --> nav|fffd|zan|fffd| na podm|fffd|n|fffd|n|fffd| form|fffd|t=|fffd|erven|fffd| + zobrazen|fffd| (vypl|fffd|te spr|fffd|vn|fffd| datum) v poli v|fffd||fffd|e spl|fffd|tky)
'If Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C22").Value + 3 * 365 < Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C72").Value Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B48").Select: MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t m|fffd|n|fffd| ne|fffd| 3 roky od na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!": GoTo konec: End If

'''kontrola pro nastaven|fffd| postupu pro p|fffd|edhypot|fffd||fffd|n|fffd| |fffd|v|fffd|r, a p|fffd|eskakuje iteraci rovnou k RPSN
''If Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C6").Value = "overdraft" Then Range("G2").Value = Range("H2").Value: GoTo lbl2

' V|fffd|po|fffd|et DTI spl|fffd|tky - pokra|fffd|uje kdy|fffd| nen|fffd| p|fffd|edhypote|fffd|n|fffd| |fffd|v|fffd|r
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Select
'Range("C8").Value = Range("G9").Value
'Range("H10").Value = Null
'Range("G2").Value = Null
Range("G2").Value = Range("J7").Value 'nastartov|fffd|n|fffd| prvn|fffd| spl|fffd|tky vypo|fffd|ten|fffd| vzorcem v se|fffd|it|fffd|
'Range("G469").GoalSeek Goal:=Range("E22"), ChangingCell:=Range("G2")
'Range("H10").Value = Range("G2").Value
'z listu |fffd|rokov|fffd| sazby
'Range("C8").Value = Range("D8").Value


' V|fffd|po|fffd|et spr|fffd|vn|fffd| spl|fffd|tky
Range("G469").GoalSeek Goal:=Range("E22"), ChangingCell:=Range("G2")
Range("G2").Select

' RPSN Makro pro list 'v|fffd|po|fffd|et_spl|fffd|tky'
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi hodnota v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))
'  prvn|fffd| provede zaokrouhlov|fffd|n|fffd| hodnot poji|fffd|t|fffd|n|fffd| a spl|fffd|tky pro v|fffd|po|fffd|et RPSN

lbl2:

'pou|fffd|ije zaokrouhlen|fffd| spl|fffd|tky na cel|fffd| koruny vzorcem v bu|fffd|ce
Range("H11").Value = Range("G2").Value
Range("G2").Value = Range("G11").Value

'zaokrouhlov|fffd|n|fffd| poji|fffd|t|fffd|n|fffd|
Range("C18").Value = Range("D18").Value

Range("G7").Value = Range("C8").Value
Range("N469").GoalSeek Goal:=Range("C3"), ChangingCell:=Range("G7")
Range("G7").Select


' zobrazVypocetList3_Produkty Makro
' vynuluje pole, kter|fffd| se m|fffd|n|fffd| na nezobrazit pokud se zm|fffd|n|fffd| zadan|fffd| hodnoty.. (je t|fffd|eba nejd|fffd||fffd|ve spustit v|fffd|po|fffd|et spl|fffd|tky a RPSN)
    
konec:
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
'    Range("B1").Value = "zobrazVypocet"
'    Range("C1").Value = "zobrazVypocetRPSN"

    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)

    If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = True Then
            ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = False
        End If
    End If
    Application.ScreenUpdating = stavScreenUpdatinguPred
    ThisWorkbook.Protect (bcd)
End Sub


Sub vypocti_splatku_s_bonusem()
Dim bcd
Dim test

' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'ud|fffd|lat hl|fffd|ku, pokud nejsou v|fffd|echny vstupy ... Range ("E22")
On Error GoTo konec:
Dim stavScreenUpdatinguPred As Boolean
    stavScreenUpdatinguPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
With Application
        .MaxIterations = 100
        .MaxChange = 0.0001
    End With

bcd = ThisWorkbook.Sheets("heslo").Range("B2").Value
ThisWorkbook.Unprotect (bcd)
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Visible = True
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Select

''o|fffd|et|fffd|en|fffd| vstup|fffd| z listu 3_Produkty
'kdy|fffd| se zm|fffd|n|fffd| bu|fffd|ka 'dopl|fffd|kov|fffd| |fffd||fffd|st |fffd|v|fffd|ru' a p|fffd|ekro|fffd||fffd| povolen|fffd| maximum, nebo je ve |fffd|patn|fffd|m form|fffd|tu
'    If IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B14").Value) = False Or _
'    Thisworkbook.Sheets("3_Produkty").Range("B14").Value > Thisworkbook.Sheets("3_Produkty").Range("B12").Value Then
'    Thisworkbook.Sheets("3_Produkty").Select
'    Range("B14").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| dopl|fffd|kovou |fffd||fffd|st |fffd|v|fffd|ru!": GoTo konec: End If

'dal|fffd||fffd| testov|fffd|n|fffd| na pot|fffd|ebn|fffd| vstupn|fffd| data
test = IsNumeric(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("J7").Value)
'hlaska1 = Thisworkbook.Sheets("3_Produkty").Range("A10")
'test1 = IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B10").Value)
'hlaska2 = Thisworkbook.Sheets("3_Produkty").Range("A18")
'test2 = IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B18").Value)



If test = False Then
MsgBox "Check input data": GoTo konec: End If



'hlaska pokud nen|fffd| vypln|fffd|n |fffd|rok nebo je 0
'If IsNumeric(Thisworkbook.Sheets("3_Produkty").Range("B40").Value) = False Or Thisworkbook.Sheets("3_Produkty").Range("B40").Value <= 0 Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B40").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|rokovou sazbu nebo obnovte tla|fffd||fffd|tkem 'resetovat sazbu'!": GoTo konec: End If

'hlaska pokud nen|fffd| vypln|fffd|n 'datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru' nebo je |fffd|patn|fffd| form|fffd|t
'If IsDate(Thisworkbook.Sheets("3_Produkty").Range("B42").Value) = False Or Thisworkbook.Sheets("3_Produkty").Range("B42").Value <= 0 Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B42").Select: MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!": GoTo konec: End If

'hlaska pokud nen|fffd| vypln|fffd|n 'datum prvn|fffd| spl|fffd|tky' nebo je |fffd|patn|fffd| form|fffd|t
If IsDate(Range("C4").Value) = False Or Range("C4").Value <= 0 Then
MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum prvn|fffd| spl|fffd|tky nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!": GoTo konec: End If

'hlaska pokud datum prvn|fffd| spl|fffd|tky je men|fffd||fffd| (= d|fffd||fffd|v) ne|fffd| datum |fffd|erp|fffd|n|fffd|
If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C72").Value < ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C22").Value Then
MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t po na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!": GoTo konec: End If

'hl|fffd|ka pokud datum prvn|fffd| spl|fffd|tky je v|fffd|ce ne|fffd| 3 roky od |fffd|erp|fffd|n|fffd| spust|fffd| hl|fffd|ku a ukon|fffd||fffd| makro... (z|fffd|rove|fffd| se mus|fffd| zm|fffd|nit vzorec v bu|fffd|ce vedle --> nav|fffd|zan|fffd| na podm|fffd|n|fffd|n|fffd| form|fffd|t=|fffd|erven|fffd| + zobrazen|fffd| (vypl|fffd|te spr|fffd|vn|fffd| datum) v poli v|fffd||fffd|e spl|fffd|tky)
'If Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C22").Value + 3 * 365 < Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C72").Value Then
'Thisworkbook.Sheets("3_Produkty").Select
'Range("B48").Select: MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t m|fffd|n|fffd| ne|fffd| 3 roky od na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!": GoTo konec: End If

'''kontrola pro nastaven|fffd| postupu pro p|fffd|edhypot|fffd||fffd|n|fffd| |fffd|v|fffd|r, a p|fffd|eskakuje iteraci rovnou k RPSN
''If Thisworkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Range("C6").Value = "overdraft" Then Range("G2").Value = Range("H2").Value: GoTo lbl2

' V|fffd|po|fffd|et DTI spl|fffd|tky - pokra|fffd|uje kdy|fffd| nen|fffd| p|fffd|edhypote|fffd|n|fffd| |fffd|v|fffd|r
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Select
'Range("C8").Value = Range("G9").Value
'Range("H10").Value = Null
'Range("G2").Value = Null
'''pokud bonus, tak nepo|fffd||fffd|t|fffd|m spl|fffd|tku - p|fffd|eb|fffd|r|fffd|m...
'''Range("G2").Value = Range("J7").Value 'nastartov|fffd|n|fffd| prvn|fffd| spl|fffd|tky vypo|fffd|ten|fffd| vzorcem v se|fffd|it|fffd|
'Range("G469").GoalSeek Goal:=Range("E22"), ChangingCell:=Range("G2")
'Range("H10").Value = Range("G2").Value
'z listu |fffd|rokov|fffd| sazby
'Range("C8").Value = Range("D8").Value


' V|fffd|po|fffd|et spr|fffd|vn|fffd| spl|fffd|tky
'''pokud je bonus, tak se bere spl|fffd|tka bez bonusu
'''Range("G469").GoalSeek Goal:=Range("E22"), ChangingCell:=Range("G2")
Range("G2").Select

' RPSN Makro pro list 'v|fffd|po|fffd|et_spl|fffd|tky'
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi hodnota v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))
'  prvn|fffd| provede zaokrouhlov|fffd|n|fffd| hodnot poji|fffd|t|fffd|n|fffd| a spl|fffd|tky pro v|fffd|po|fffd|et RPSN

lbl2:

'pou|fffd|ije zaokrouhlen|fffd| spl|fffd|tky na cel|fffd| koruny vzorcem v bu|fffd|ce
'''Range("H11").Value = Range("G2").Value
'''N = Range("G11").Value
'''Range("G2").Value = N

'zaokrouhlov|fffd|n|fffd| poji|fffd|t|fffd|n|fffd|
Range("C18").Value = Range("D18").Value

Range("G7").Value = 5
Range("N469").GoalSeek Goal:=Range("C3"), ChangingCell:=Range("G7")
Range("G7").Select


' zobrazVypocetList3_Produkty Makro
' vynuluje pole, kter|fffd| se m|fffd|n|fffd| na nezobrazit pokud se zm|fffd|n|fffd| zadan|fffd| hodnoty.. (je t|fffd|eba nejd|fffd||fffd|ve spustit v|fffd|po|fffd|et spl|fffd|tky a RPSN)
    
konec:
    ThisWorkbook.Sheets("A_Predbezna_nabidka").Select
'    Range("B1").Value = "zobrazVypocet"
'    Range("C1").Value = "zobrazVypocetRPSN"

    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Visible = True Then
            ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_s_bonusem").Visible = False
        End If
    End If
    Application.ScreenUpdating = stavScreenUpdatinguPred
    ThisWorkbook.Protect (bcd)
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Activate()

'zapnout automatick|fffd| p|fffd|epo|fffd|et listu/se|fffd|itu p|fffd|i spu|fffd|t|fffd|n|fffd| kalkul|fffd|toru
Application.Calculation = xlCalculationAutomatic
'oprava dopl|fffd|ov|fffd|n|fffd| nesmysl|fffd|, kdy|fffd| se napsalo S do jm|fffd|na
Application.EnableAutoComplete = False
Call welcome_screen_schovat
End Sub

Private Sub Workbook_Open()

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
Call welcome_screen_zobrazit
End Sub

'Private Sub Workbook_BeforeClose(Cancel As Boolean)
'Call welcome_screen_zobrazit
'End Sub

' InQuest injected base64 decoded content
' zu)u
' zu)u
' zu)u
' j+u:
' KnjX
' KnjX
' ^rz,
' q*ej
' ^rz,
' ^rz,
' +Lj8
' 'njY

INQUEST-PP=macro
