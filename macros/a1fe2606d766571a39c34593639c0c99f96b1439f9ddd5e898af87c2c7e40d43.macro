Attribute VB_Name = "GQ_Implementation"
' VBA version of the SQL IN keyword. Allows for easier translation of the algorithm from its original
' SQL syntax into VBA syntax.
' returns TRUE if value matches any of the test values passed in
Private Function fIN(value As Integer, Optional test1 As Integer = -1, Optional test2 As Integer = -1, Optional test3 As Integer = -1, Optional test4 As Integer = -1, Optional test5 As Integer = -1, Optional test6 As Integer = -1, Optional test7 As Integer = -1, Optional test8 As Integer = -1) As Boolean
    fIN = (value = test1) Or (value = test2) Or (value = test3) Or (value = test4) Or (value = test5) Or (value = test6) Or (value = test7) Or (value = test8)
End Function


Private Function IsSeg1(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Boolean
   
    IsSeg1 = (fIN(S5, 1) And (fIN(S3, 1, 2) And (fIN(S8, 1, 2, 3) And (fIN(S4, 3, 4) And (fIN(S6, 1, 2) And (fIN(S2, 1, 4) And fIN(S1, 3, 4, 5) Or fIN(S2, 2, 3, 5) And fIN(S7, 1, 2, 3) And fIN(S1, 2, 3, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S4, 3)) Or fIN(S6, 3, 4, 5) And fIN(S8, 1, 3, 4, 5) And fIN(S4, 3) And fIN(S6, 1, 2, 3, 5) And (fIN(S1, 3) Or fIN(S1, 1, 2, 4, 5) And fIN(S7, 1, 4, 5))) Or fIN(S4, 1, 2, 5) And fIN(S8, 1, 2) And (fIN(S7, 1, 2, 4) And fIN(S1, 4) And fIN(S3, 1) Or fIN(S7, 3, 5) And fIN(S3, 1))) Or fIN(S8, 4, 5) And (fIN(S1, 1, 2, 3, 4) And (fIN(S6, 1, 2) And (fIN(S2, 1) And fIN(S4, 1, 3) And (fIN(S7, 1) And fIN(S1, 3) Or fIN(S7, 2, 3, 4, 5) And (fIN(S1, 2, 3) And fIN(S7, 1, 2, 4, 5) Or fIN(S1, 1, 4, 5))) Or fIN(S2, 2, 3, 4, 5) And (fIN(S8, 4) And (fIN(S4, 3) And fIN(S2, 1, 2, 4, 5) And fIN(S6, 1) Or fIN(S4, 1, 2, 4, 5) And fIN(S2, 1, 2, 5) And fIN(S7, 1)) Or fIN(S8, 1, 2, 3, 5) And fIN(S4, 4) And fIN(S1, 1, 2, 4, 5))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2) And fIN(S2, 2) And _
fIN(S1, 3, 4, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S7, 4) Or fIN(S4, 1, 3, 4, 5) And fIN(S6, 1, 2, 4, 5) And fIN(S2, 1, 2, 3) And fIN(S2, 2) And fIN(S6, 1, 2, 3, 5))) Or fIN(S1, 5) And (fIN(S4, 2, 4) And fIN(S2, 1, 2, 4, 5) And (fIN(S6, 1) Or fIN(S6, 2, 3, 4, 5) And fIN(S8, 4) And fIN(S3, 2, 3, 4, 5)) Or fIN(S4, 1, 3, 5) And fIN(S2, 1, 2, 3) And (fIN(S2, 2) And (fIN(S4, 1) And fIN(S3, 2, 3, 4, 5) Or fIN(S4, 2, 3, 4, 5)) Or fIN(S2, 1, 3, 4, 5))))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2, 3) And (fIN(S7, 1, 2) And (fIN(S8, 1, 2, 3, 4) And (fIN(S4, 1, 2, 3) And (fIN(S6, 1) And fIN(S3, 1, 2, 5) And fIN(S2, 2, 4, 5) Or fIN(S6, 2, 3, 4, 5) And fIN(S3, 3) And fIN(S7, 2, 3, 4, 5)) Or fIN(S4, 4, 5) And fIN(S2, 1, 2) And (fIN(S1, 1) Or fIN(S1, 2, 3, 4, 5) And fIN(S3, 1, 2, 4, 5))) Or fIN(S8, 5) And (fIN(S2, 1, 4) And (fIN(S7, 1) And (fIN(S4, 1) Or fIN(S4, 2, 3, 4, 5)) Or fIN(S7, 2, 3, 4, 5)) Or fIN(S2, 2, 3, 5) And (fIN(S1, 2) And (fIN(S3, 3, 4) And (fIN(S4, 1) Or _
fIN(S4, 2, 3, 4, 5)) Or fIN(S3, 1, 2, 5) And fIN(S2, 2)) Or fIN(S1, 1, 3, 4, 5) And fIN(S4, 3, 4, 5) And fIN(S2, 2)))) Or fIN(S7, 3, 4, 5) And (fIN(S3, 3) And (fIN(S2, 3, 4) And (fIN(S7, 3) And fIN(S1, 2, 3, 4, 5) And (fIN(S6, 1) Or fIN(S6, 2, 3, 4, 5)) Or fIN(S7, 1, 2, 4, 5) And fIN(S8, 3)) Or fIN(S2, 1, 2, 5) And (fIN(S4, 1) And fIN(S8, 1, 2, 3, 5) Or fIN(S4, 2, 3, 4, 5) And fIN(S8, 4) And fIN(S1, 2))) Or fIN(S3, 1, 2, 4, 5) And (fIN(S7, 4) And (fIN(S1, 1) And fIN(S2, 1, 4) Or fIN(S1, 2, 3, 4, 5) And (fIN(S8, 4) And (fIN(S1, 2) Or fIN(S1, 1, 3, 4, 5)) Or fIN(S8, 1, 2, 3, 5))) Or fIN(S7, 1, 2, 3, 5) And (fIN(S4, 2) And (fIN(S2, 1, 2) And fIN(S8, 3) Or fIN(S2, 3, 4, 5) And (fIN(S1, 2) Or fIN(S1, 1, 3, 4, 5))) Or fIN(S4, 1, 3, 4, 5) And fIN(S2, 1, 2, 3, 4) And (fIN(S8, 3, 4) Or fIN(S8, 1, 2, 5)))))) Or fIN(S1, 4, 5) And (fIN(S1, 4) And (fIN(S7, 2, 3, 4) And (fIN(S4, 1, 3) And (fIN(S2, 3) Or fIN(S2, 1, 2, 4, 5) And (fIN(S6, 1) And fIN(S8, 3) Or fIN(S6, 2, 3, 4, 5) And _
fIN(S8, 1, 2, 4, 5))) Or fIN(S4, 2, 4, 5) And (fIN(S8, 2) And fIN(S7, 2) Or fIN(S8, 1, 3, 4, 5) And (fIN(S2, 1, 3) And fIN(S6, 1) Or fIN(S2, 2, 4, 5)))) Or fIN(S7, 1, 5) And (fIN(S8, 2, 4) And fIN(S4, 2, 3) And fIN(S7, 1) And fIN(S8, 1, 3, 4, 5) Or fIN(S8, 1, 3, 5) And fIN(S4, 1, 2, 4, 5) And fIN(S8, 2, 3, 4, 5) And (fIN(S2, 1, 3) Or fIN(S2, 2, 4, 5)))) Or fIN(S1, 1, 2, 3, 5) And (fIN(S7, 1) And (fIN(S3, 4) And (fIN(S8, 3, 4) Or fIN(S8, 1, 2, 5) And fIN(S2, 1) And fIN(S4, 2, 3, 4, 5)) Or fIN(S3, 1, 2, 3, 5) And (fIN(S8, 4) And fIN(S6, 1) Or fIN(S8, 1, 2, 3, 5))) Or fIN(S7, 2, 3, 4, 5) And (fIN(S8, 3, 4) And (fIN(S2, 1, 2, 3) And (fIN(S3, 3) And (fIN(S7, 2, 4) Or fIN(S7, 1, 3, 5)) Or fIN(S3, 1, 2, 4, 5)) Or fIN(S2, 4, 5) And fIN(S3, 3)) Or fIN(S8, 1, 2, 5) And (fIN(S4, 4) And (fIN(S7, 2) And (fIN(S2, 2) Or fIN(S2, 1, 3, 4, 5)) Or fIN(S7, 1, 3, 4, 5)) Or fIN(S4, 1, 2, 3, 5)))))) Or fIN(S6, 3, 4, 5) And (fIN(S6, 3) And fIN(S1, 2, 3, 4, 5) And (fIN(S1, 3, 4) And (fIN(S2, 1, 2, 3) And _
fIN(S8, 1, 3, 4, 5) And (fIN(S4, 2, 3) And fIN(S7, 1, 3, 4, 5) Or fIN(S4, 1, 4, 5) And fIN(S7, 1, 2)) Or fIN(S2, 4, 5) And fIN(S4, 2) And fIN(S1, 3)) Or fIN(S1, 1, 2, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S4, 1, 2, 3) And (fIN(S3, 4) And fIN(S1, 1, 3, 4, 5) Or fIN(S3, 1, 2, 3, 5) And (fIN(S2, 2) Or fIN(S2, 1, 3, 4, 5)))) Or fIN(S6, 1, 2, 4, 5) And (fIN(S7, 1, 4) And fIN(S1, 1, 5) And fIN(S8, 3, 5) Or fIN(S7, 2, 3, 5) And fIN(S4, 2, 4, 5) And (fIN(S1, 2, 3, 4) And (fIN(S3, 4) Or fIN(S3, 1, 2, 3, 5) And fIN(S1, 1, 3, 4, 5) And fIN(S8, 1, 5)) Or fIN(S1, 1, 5)))))) Or fIN(S5, 2, 3, 4, 5) And (fIN(S8, 1, 2, 3) And (fIN(S5, 2) And (fIN(S4, 2, 3, 4) And (fIN(S3, 1, 2, 3) And (fIN(S1, 1, 2, 3) And fIN(S8, 3, 4, 5) And fIN(S6, 1) And fIN(S1, 2) And fIN(S4, 1, 3, 4, 5) Or fIN(S1, 4, 5) And (fIN(S2, 2, 3) And (fIN(S3, 1) And fIN(S1, 1, 2, 3, 5) Or fIN(S3, 2, 3, 4, 5) And fIN(S7, 2, 5) And fIN(S6, 2, 3, 4, 5)) Or fIN(S2, 1, 4, 5) And fIN(S7, 3, 4, 5) And fIN(S3, 1, 3, 4, 5) And fIN(S2, 1, 4))) Or _
fIN(S3, 4, 5) And (fIN(S7, 1, 2) And fIN(S6, 1, 2, 3) And (fIN(S6, 1) Or fIN(S6, 2, 3, 4, 5) And fIN(S7, 2, 3, 4, 5) And fIN(S6, 2)) Or fIN(S7, 3, 4, 5) And fIN(S1, 1, 5))) Or fIN(S4, 1, 5) And fIN(S8, 3, 4, 5) And fIN(S2, 3, 5) And (fIN(S3, 3) And fIN(S1, 2, 4, 5) Or fIN(S3, 1, 2, 4, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S1, 1, 5) And fIN(S7, 2, 3, 4, 5))) Or fIN(S5, 1, 3, 4, 5) And (fIN(S3, 1, 2, 3) And fIN(S2, 1, 2) And fIN(S8, 3, 4, 5) And fIN(S4, 2, 3, 4, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S1, 3) And fIN(S7, 1) Or fIN(S3, 4, 5) And fIN(S7, 1, 2, 5) And fIN(S2, 2, 4, 5) And fIN(S4, 2, 4, 5) And fIN(S1, 3, 4, 5))) Or fIN(S8, 4, 5) And (fIN(S3, 1, 2) And fIN(S5, 2, 3) And (fIN(S4, 2, 3, 4) And (fIN(S6, 1, 2) And fIN(S7, 1, 3) And fIN(S1, 5) Or fIN(S6, 3, 4, 5) And fIN(S4, 1, 4, 5) And fIN(S7, 2, 3, 4) And fIN(S1, 1, 2, 5) And fIN(S2, 1)) Or fIN(S4, 1, 5) And (fIN(S8, 4) And fIN(S7, 3, 4, 5) And fIN(S6, 1, 3, 5) And fIN(S3, 1) Or fIN(S8, 1, 2, 3, 5) And fIN(S4, 1) And fIN(S1, 3) And _
fIN(S2, 2) And fIN(S3, 2, 3, 4, 5))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2) And (fIN(S8, 4) And fIN(S2, 4) And fIN(S3, 1, 2, 4, 5) Or fIN(S8, 1, 2, 3, 5) And fIN(S7, 1, 2, 3, 4) And fIN(S1, 1) And fIN(S7, 1) And fIN(S3, 3)) Or fIN(S1, 3, 4, 5) And fIN(S2, 1, 2, 3) And (fIN(S6, 1) And (fIN(S7, 2, 3) And (fIN(S3, 3) And fIN(S2, 2, 3, 4, 5) Or fIN(S3, 1, 2, 4, 5)) Or fIN(S7, 1, 4, 5) And (fIN(S3, 4) And fIN(S1, 4) Or fIN(S3, 1, 2, 3, 5) And fIN(S8, 4))) Or fIN(S6, 2, 3, 4, 5) And (fIN(S3, 3, 4) And fIN(S4, 1, 2) And fIN(S7, 3) Or fIN(S3, 1, 2, 5) And (fIN(S4, 1, 3) And fIN(S1, 4) Or fIN(S4, 2, 4, 5) And (fIN(S7, 1) Or fIN(S7, 2, 3, 4, 5)))))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 1, 2) And (fIN(S2, 1, 2, 3) And (fIN(S1, 1, 2, 3) And fIN(S3, 1, 2, 3, 5) And fIN(S5, 2, 3) And fIN(S1, 3, 4, 5) Or fIN(S1, 4, 5) And (fIN(S7, 1, 4) And fIN(S3, 1, 2, 5) Or fIN(S7, 2, 3, 5) And fIN(S5, 1, 2, 4, 5) And fIN(S1, 1, 2, 3, 5))) Or fIN(S2, 4, 5) And fIN(S6, 1, 2, 5)) Or _
fIN(S4, 3, 4, 5) And (fIN(S1, 2) And fIN(S6, 3) And fIN(S3, 1, 2, 4, 5) And fIN(S7, 2) Or fIN(S1, 1, 3, 4, 5) And fIN(S2, 2, 3, 4, 5) And fIN(S3, 4) And fIN(S7, 3) And fIN(S4, 3)))))))

End Function

Private Function IsSeg2(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Boolean
 
    IsSeg2 = (fIN(S5, 1) And (fIN(S3, 1, 2) And (fIN(S8, 1, 2, 3) And (fIN(S4, 3, 4) And (fIN(S6, 1, 2) And fIN(S2, 2, 3, 5) And fIN(S7, 1, 2, 3) And fIN(S1, 2, 3, 5) And fIN(S3, 1) And fIN(S7, 3, 4, 5) Or fIN(S6, 3, 4, 5) And fIN(S8, 1, 3, 4, 5) And (fIN(S4, 3) And fIN(S6, 1, 2, 3, 5) And fIN(S1, 1, 2, 4, 5) And fIN(S7, 2, 3) Or fIN(S4, 1, 2, 4, 5))) Or fIN(S4, 1, 2, 5) And (fIN(S8, 1, 2) And fIN(S7, 1, 2, 4) And fIN(S1, 1, 2, 3, 5) And fIN(S2, 4, 5) And fIN(S1, 2) Or fIN(S8, 3, 4, 5) And fIN(S6, 3, 4, 5) And (fIN(S4, 1) And fIN(S1, 1, 3, 4, 5) Or fIN(S4, 2, 3, 4, 5) And fIN(S1, 3) And fIN(S2, 2, 3, 4, 5) And fIN(S3, 1)))) Or fIN(S8, 4, 5) And (fIN(S1, 1, 2, 3, 4) And (fIN(S6, 1, 2) And fIN(S2, 2, 3, 4, 5) And (fIN(S8, 4) And fIN(S4, 3) And fIN(S2, 1, 2, 4, 5) And fIN(S6, 2, 3, 4, 5) Or fIN(S8, 1, 2, 3, 5) And fIN(S4, 4) And fIN(S1, 3)) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2) And (fIN(S2, 2) And (fIN(S1, 1, 2) And fIN(S3, 1) Or fIN(S1, 3, 4, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S7, 1, 2, 3, 5)) Or _
fIN(S2, 1, 3, 4, 5)) Or fIN(S4, 1, 3, 4, 5) And (fIN(S6, 3) And fIN(S2, 3, 4, 5) And fIN(S4, 2, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) Or fIN(S6, 1, 2, 4, 5) And fIN(S2, 1, 2, 3) And (fIN(S2, 2) And fIN(S6, 4) Or fIN(S2, 1, 3, 4, 5))))) Or fIN(S1, 5) And (fIN(S4, 2, 4) And fIN(S2, 1, 2, 4, 5) And fIN(S6, 2, 3, 4, 5) And fIN(S8, 4) And fIN(S3, 1) Or fIN(S4, 1, 3, 5) And fIN(S2, 4, 5)))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2, 3) And (fIN(S7, 1, 2) And (fIN(S8, 1, 2, 3, 4) And fIN(S4, 4, 5) And fIN(S2, 3, 4, 5) Or fIN(S8, 5) And fIN(S2, 2, 3, 5) And fIN(S1, 1, 3, 4, 5) And fIN(S4, 3, 4, 5) And fIN(S2, 1, 3, 4, 5)) Or fIN(S7, 3, 4, 5) And fIN(S3, 3) And fIN(S2, 3, 4) And fIN(S7, 1, 2, 4, 5) And fIN(S8, 1, 2, 4, 5)) Or fIN(S1, 4, 5) And (fIN(S1, 4) And fIN(S7, 1, 5) And fIN(S8, 2, 4) And fIN(S4, 1, 4, 5) And fIN(S3, 1, 2, 4, 5) Or fIN(S1, 1, 2, 3, 5) And fIN(S7, 2, 3, 4, 5) And fIN(S8, 3, 4) And fIN(S2, 4, 5) And fIN(S3, 1, 2, 4, 5))) Or fIN(S6, 3, 4, 5) And (fIN(S6, 3) And _
fIN(S1, 2, 3, 4, 5) And (fIN(S1, 3, 4) And (fIN(S2, 1, 2, 3) And fIN(S8, 2) And fIN(S2, 1, 3, 4, 5) Or fIN(S2, 4, 5) And (fIN(S4, 2) And fIN(S1, 1, 2, 4, 5) And fIN(S2, 4) Or fIN(S4, 1, 3, 4, 5))) Or fIN(S1, 1, 2, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S4, 4, 5)) Or fIN(S6, 1, 2, 4, 5) And (fIN(S7, 1, 4) And (fIN(S1, 2, 3, 4) Or fIN(S1, 1, 5) And fIN(S8, 1, 2, 4)) Or fIN(S7, 2, 3, 5) And (fIN(S4, 1, 3) And fIN(S2, 2, 3, 4, 5) And (fIN(S2, 3) And fIN(S1, 2) Or fIN(S2, 1, 2, 4, 5)) Or fIN(S4, 2, 4, 5) And fIN(S1, 2, 3, 4) And fIN(S3, 1, 2, 3, 5) And fIN(S1, 1, 3, 4, 5) And fIN(S8, 2, 3, 4)))))) Or fIN(S5, 2, 3, 4, 5) And (fIN(S8, 1, 2, 3) And (fIN(S5, 2) And (fIN(S4, 2, 3, 4) And (fIN(S3, 1, 2, 3) And (fIN(S1, 1, 2, 3) And fIN(S8, 1, 2) And (fIN(S2, 1, 2) And fIN(S4, 2) And fIN(S6, 4, 5) Or fIN(S2, 3, 4, 5) And fIN(S3, 3, 4, 5) And fIN(S4, 1, 3, 4, 5)) Or fIN(S1, 4, 5) And (fIN(S2, 2, 3) And fIN(S3, 2, 3, 4, 5) And fIN(S7, 1, 3, 4) And fIN(S6, 3, 4, 5) Or fIN(S2, 1, 4, 5) And _
(fIN(S7, 1, 2) And fIN(S1, 1, 2, 3, 5) And fIN(S2, 2, 3, 4, 5) Or fIN(S7, 3, 4, 5) And (fIN(S3, 2) Or fIN(S3, 1, 3, 4, 5) And fIN(S2, 2, 3, 5))))) Or fIN(S3, 4, 5) And (fIN(S7, 1, 2) And (fIN(S6, 1, 2, 3) And fIN(S6, 2, 3, 4, 5) And fIN(S7, 1) And fIN(S1, 1) Or fIN(S6, 4, 5)) Or fIN(S7, 3, 4, 5) And fIN(S1, 2, 3, 4) And (fIN(S6, 2) And fIN(S2, 2, 4, 5) Or fIN(S6, 1, 3, 4, 5)))) Or fIN(S4, 1, 5) And (fIN(S8, 1, 2) And (fIN(S6, 1, 2, 4) And fIN(S1, 5) Or fIN(S6, 3, 5) And fIN(S2, 1, 2) And fIN(S6, 1, 2, 4, 5) And fIN(S1, 1, 3, 4, 5)) Or fIN(S8, 3, 4, 5) And (fIN(S2, 1, 2, 4) And fIN(S1, 1, 4, 5) And fIN(S7, 5) Or fIN(S2, 3, 5) And fIN(S3, 3) And fIN(S1, 1, 3)))) Or fIN(S5, 1, 3, 4, 5) And (fIN(S3, 1, 2, 3) And (fIN(S2, 1, 2) And fIN(S8, 3, 4, 5) And fIN(S4, 1) And fIN(S6, 1, 3, 4, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) Or fIN(S2, 3, 4, 5) And (fIN(S1, 3) And (fIN(S4, 1, 2, 3) And fIN(S7, 1, 4, 5) Or fIN(S4, 4, 5)) Or fIN(S1, 1, 2, 4, 5) And fIN(S6, 3) And fIN(S3, 2) And _
fIN(S1, 2, 3, 4, 5))) Or fIN(S3, 4, 5) And (fIN(S7, 3, 4) And fIN(S6, 1, 2, 4, 5) And fIN(S2, 1, 3, 4, 5) Or fIN(S7, 1, 2, 5) And fIN(S2, 2, 4, 5) And fIN(S4, 1, 3) And fIN(S1, 1, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) And fIN(S3, 1, 2, 3, 5)))) Or fIN(S8, 4, 5) And (fIN(S3, 1, 2) And (fIN(S5, 2, 3) And (fIN(S4, 2, 3, 4) And (fIN(S6, 1, 2) And fIN(S7, 2, 4, 5) And (fIN(S1, 1, 2, 3) And fIN(S7, 1, 3, 5) And fIN(S2, 1, 3, 4, 5) Or fIN(S1, 4, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S2, 1, 2, 3)) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2, 3) And fIN(S1, 4, 5) And (fIN(S4, 2) And fIN(S6, 1, 2, 4, 5) Or fIN(S4, 1, 3, 4, 5)) Or fIN(S4, 1, 4, 5) And fIN(S7, 2, 3, 4) And (fIN(S1, 3, 4) And fIN(S2, 1, 2) Or fIN(S1, 1, 2, 5) And fIN(S2, 2, 3, 4, 5)))) Or fIN(S4, 1, 5) And fIN(S8, 4) And (fIN(S7, 1, 2) And fIN(S6, 4, 5) And fIN(S1, 3) Or fIN(S7, 3, 4, 5) And (fIN(S6, 2, 4) And fIN(S2, 1, 4, 5) Or fIN(S6, 1, 3, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S2, 1, 3, 4, 5)))) Or fIN(S5, 1, 4, 5) And (fIN(S8, 4) And _
fIN(S6, 3, 5) And (fIN(S7, 1, 2, 4) And fIN(S4, 3) And fIN(S1, 3, 4, 5) Or fIN(S7, 3, 5)) Or fIN(S8, 1, 2, 3, 5) And fIN(S2, 1, 3, 4, 5) And fIN(S1, 1) And fIN(S2, 4))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2) And (fIN(S8, 4) And fIN(S2, 1, 2, 3, 5) And fIN(S1, 2, 3, 4, 5) And (fIN(S7, 2, 3) And fIN(S3, 3, 4) Or fIN(S7, 1, 4, 5) And fIN(S2, 2, 3, 4, 5)) Or fIN(S8, 1, 2, 3, 5) And (fIN(S7, 1, 2, 3, 4) And fIN(S1, 2, 3, 4, 5) And fIN(S2, 1) And fIN(S5, 2) Or fIN(S7, 5))) Or fIN(S1, 3, 4, 5) And (fIN(S2, 1, 2, 3) And (fIN(S6, 1) And fIN(S7, 1, 4, 5) And fIN(S3, 4) And fIN(S1, 1, 2, 3, 5) Or fIN(S6, 2, 3, 4, 5) And (fIN(S3, 3, 4) And fIN(S4, 3, 4, 5) And fIN(S2, 2, 3, 4, 5) Or fIN(S3, 1, 2, 5) And fIN(S4, 1, 3) And fIN(S1, 1, 2, 3, 5))) Or fIN(S2, 4, 5) And (fIN(S5, 2) And fIN(S4, 1, 3, 4, 5) Or fIN(S5, 1, 3, 4, 5)))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 1, 2) And (fIN(S2, 1, 2, 3) And (fIN(S1, 1, 2, 3) And (fIN(S3, 4) And fIN(S2, 1, 2) And fIN(S7, 1, 4, 5) Or _
fIN(S3, 1, 2, 3, 5) And fIN(S5, 1, 4, 5) And fIN(S1, 2, 3, 4, 5)) Or fIN(S1, 4, 5) And (fIN(S7, 1, 4) And fIN(S3, 3, 4) And fIN(S1, 1, 2, 3, 5) Or fIN(S7, 2, 3, 5) And fIN(S5, 1, 2, 4, 5) And fIN(S1, 4))) Or fIN(S2, 4, 5) And fIN(S6, 3, 4)) Or fIN(S4, 3, 4, 5) And (fIN(S1, 2) And (fIN(S6, 3) And fIN(S3, 3) And fIN(S2, 1) Or fIN(S6, 1, 2, 4, 5) And (fIN(S2, 3) And fIN(S3, 1, 2, 4, 5) Or fIN(S2, 1, 2, 4, 5))) Or fIN(S1, 1, 3, 4, 5) And (fIN(S2, 1) And fIN(S1, 1, 2, 4, 5) Or fIN(S2, 2, 3, 4, 5) And (fIN(S3, 4) And (fIN(S7, 3) And fIN(S4, 1, 2, 4, 5) Or fIN(S7, 1, 2, 4, 5)) Or fIN(S3, 1, 2, 3, 5)))))))))
    
End Function

Private Function IsSeg3(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Boolean
  
    IsSeg3 = (fIN(S5, 1) And (fIN(S3, 1, 2) And (fIN(S8, 1, 2, 3) And (fIN(S4, 3, 4) And fIN(S6, 1, 2) And (fIN(S2, 1, 4) And fIN(S1, 1, 2) And fIN(S8, 3, 4, 5) And fIN(S2, 1) Or fIN(S2, 2, 3, 5) And fIN(S7, 4, 5) And fIN(S1, 1, 2)) Or fIN(S4, 1, 2, 5) And (fIN(S8, 1, 2) And fIN(S7, 1, 2, 4) And fIN(S1, 4) And fIN(S3, 2, 3, 4, 5) And fIN(S2, 2, 3, 4, 5) Or fIN(S8, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S7, 4) Or fIN(S7, 1, 2, 3, 5) And fIN(S2, 1, 2, 4, 5) And (fIN(S1, 1, 3, 4) And fIN(S7, 1, 3, 4, 5) Or fIN(S1, 2, 5) And fIN(S3, 1))) Or fIN(S6, 3, 4, 5) And fIN(S4, 2, 3, 4, 5) And fIN(S1, 3) And fIN(S2, 2, 3, 4, 5) And fIN(S3, 2, 3, 4, 5)))) Or fIN(S8, 4, 5) And (fIN(S1, 1, 2, 3, 4) And (fIN(S6, 1, 2) And (fIN(S2, 1) And (fIN(S4, 1, 3) And fIN(S7, 1) And fIN(S1, 1, 2, 4, 5) And fIN(S1, 2) Or fIN(S4, 2, 4, 5) And (fIN(S1, 2) And fIN(S3, 1) And fIN(S7, 2, 3, 4, 5) Or fIN(S1, 1, 3, 4, 5))) Or fIN(S2, 2, 3, 4, 5) And (fIN(S8, 4) And fIN(S4, 1, 2, 4, 5) And (fIN(S2, 3, 4) And fIN(S1, 1, 2, 4, 5) Or _
fIN(S2, 1, 2, 5) And fIN(S7, 2, 3, 4, 5)) Or fIN(S8, 1, 2, 3, 5) And fIN(S4, 1, 2, 3, 5) And (fIN(S7, 2) And fIN(S1, 2, 3, 4, 5) Or fIN(S7, 1, 3, 4, 5) And (fIN(S6, 1) Or fIN(S6, 2, 3, 4, 5))))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2) And fIN(S2, 2) And (fIN(S1, 1, 2) And fIN(S3, 2, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) Or fIN(S1, 3, 4, 5) And fIN(S3, 1)) Or fIN(S4, 1, 3, 4, 5) And (fIN(S6, 3) And (fIN(S2, 1, 2) And fIN(S1, 2, 3, 4, 5) And (fIN(S7, 1, 2) Or fIN(S7, 3, 4, 5)) Or fIN(S2, 3, 4, 5) And fIN(S4, 2, 3, 4, 5) And fIN(S1, 1)) Or fIN(S6, 1, 2, 4, 5) And fIN(S2, 4, 5)))) Or fIN(S1, 5) And fIN(S4, 2, 4) And (fIN(S2, 3) Or fIN(S2, 1, 2, 4, 5) And fIN(S6, 2, 3, 4, 5) And fIN(S8, 1, 2, 3, 5)))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2, 3) And (fIN(S7, 1, 2) And (fIN(S8, 1, 2, 3, 4) And fIN(S4, 1, 2, 3) And fIN(S6, 2, 3, 4, 5) And fIN(S3, 1, 2, 4, 5) And fIN(S2, 3, 4, 5) Or fIN(S8, 5) And fIN(S2, 2, 3, 5) And fIN(S1, 1, 3, 4, 5) And fIN(S4, 1, 2)) Or fIN(S7, 3, 4, 5) And _
(fIN(S3, 3) And fIN(S2, 1, 2, 5) And (fIN(S4, 1) And fIN(S8, 4) And fIN(S7, 1, 2, 4, 5) Or fIN(S4, 2, 3, 4, 5) And (fIN(S8, 4) And fIN(S1, 1, 3, 4, 5) Or fIN(S8, 1, 2, 3, 5))) Or fIN(S3, 1, 2, 4, 5) And (fIN(S7, 4) And fIN(S1, 1) And fIN(S2, 2, 3, 5) Or fIN(S7, 1, 2, 3, 5) And (fIN(S4, 2) And fIN(S2, 1, 2) And fIN(S8, 1, 2, 4, 5) Or fIN(S4, 1, 3, 4, 5) And fIN(S2, 5))))) Or fIN(S1, 4, 5) And fIN(S1, 4) And (fIN(S7, 2, 3, 4) And fIN(S4, 2, 4, 5) And fIN(S8, 1, 3, 4, 5) And fIN(S2, 1, 3) And fIN(S6, 2, 3, 4, 5) Or fIN(S7, 1, 5) And fIN(S8, 2, 4) And (fIN(S4, 2, 3) And fIN(S7, 1) And fIN(S8, 2) Or fIN(S4, 1, 4, 5) And fIN(S3, 3)))) Or fIN(S6, 3, 4, 5) And (fIN(S6, 3) And (fIN(S1, 1) And fIN(S4, 2, 3, 4, 5) Or fIN(S1, 2, 3, 4, 5) And (fIN(S1, 3, 4) And fIN(S2, 1, 2, 3) And fIN(S8, 1, 3, 4, 5) And (fIN(S4, 2, 3) And fIN(S7, 2) Or fIN(S4, 1, 4, 5) And fIN(S7, 3, 4, 5)) Or fIN(S1, 1, 2, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S4, 1, 2, 3) And fIN(S3, 4) And fIN(S1, 2))) Or _
fIN(S6, 1, 2, 4, 5) And fIN(S7, 2, 3, 5) And (fIN(S4, 1, 3) And fIN(S2, 1) And fIN(S8, 1, 3, 4, 5) Or fIN(S4, 2, 4, 5) And fIN(S1, 2, 3, 4) And fIN(S3, 1, 2, 3, 5) And fIN(S1, 2))))) Or fIN(S5, 2, 3, 4, 5) And (fIN(S8, 1, 2, 3) And (fIN(S5, 2) And (fIN(S4, 2, 3, 4) And fIN(S3, 1, 2, 3) And fIN(S1, 1, 2, 3) And (fIN(S8, 1, 2) And fIN(S2, 3, 4, 5) And fIN(S3, 1, 2) And fIN(S4, 1, 4, 5) Or fIN(S8, 3, 4, 5) And fIN(S6, 1) And fIN(S1, 1, 3, 4, 5) And (fIN(S2, 2) Or fIN(S2, 1, 3, 4, 5))) Or fIN(S4, 1, 5) And (fIN(S8, 1, 2) And fIN(S6, 3, 5) And fIN(S2, 3, 4, 5) And fIN(S2, 1, 2, 3, 5) And fIN(S7, 1, 2, 4, 5) Or fIN(S8, 3, 4, 5) And (fIN(S2, 1, 2, 4) And (fIN(S1, 2, 3) And fIN(S2, 2, 3, 4, 5) And (fIN(S7, 1) And fIN(S3, 3) Or fIN(S7, 2, 3, 4, 5) And fIN(S3, 1, 2, 4, 5)) Or fIN(S1, 1, 4, 5) And fIN(S7, 1, 2, 3, 4) And (fIN(S1, 1) And (fIN(S4, 1) Or fIN(S4, 2, 3, 4, 5)) Or fIN(S1, 2, 3, 4, 5))) Or fIN(S2, 3, 5) And fIN(S3, 1, 2, 4, 5) And fIN(S7, 2)))) Or fIN(S5, 1, 3, 4, 5) And _
(fIN(S3, 1, 2, 3) And (fIN(S2, 1, 2) And fIN(S8, 3, 4, 5) And (fIN(S4, 1) And fIN(S6, 2) Or fIN(S4, 2, 3, 4, 5) And fIN(S3, 1) And fIN(S1, 2, 3, 4, 5) And fIN(S6, 2, 3, 4, 5)) Or fIN(S2, 3, 4, 5) And fIN(S1, 3) And fIN(S4, 1, 2, 3) And fIN(S7, 2, 3) And (fIN(S8, 2) And fIN(S6, 2, 3) Or fIN(S8, 1, 3, 4, 5) And fIN(S6, 1))) Or fIN(S3, 4, 5) And fIN(S7, 1, 2, 5) And (fIN(S2, 1, 3) And fIN(S4, 1, 3, 4, 5) Or fIN(S2, 2, 4, 5) And fIN(S4, 1, 3) And fIN(S1, 2)))) Or fIN(S8, 4, 5) And (fIN(S3, 1, 2) And (fIN(S5, 2, 3) And (fIN(S4, 2, 3, 4) And (fIN(S6, 1, 2) And (fIN(S7, 1, 3) And fIN(S1, 1, 2, 3, 4) And (fIN(S4, 2) And fIN(S1, 1, 3, 4, 5) Or fIN(S4, 1, 3, 4, 5) And fIN(S1, 2)) Or fIN(S7, 2, 4, 5) And (fIN(S1, 1, 2, 3) And fIN(S7, 2, 4) And (fIN(S4, 2, 3) Or fIN(S4, 1, 4, 5)) Or fIN(S1, 4, 5) And (fIN(S3, 1) And fIN(S2, 3, 4, 5) Or fIN(S3, 2, 3, 4, 5) And fIN(S2, 4, 5)))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2, 3) And (fIN(S1, 1, 2, 3) And (fIN(S3, 1) And fIN(S7, 5) Or fIN(S3, 2, 3, 4, 5) And _
fIN(S5, 2)) Or fIN(S1, 4, 5) And fIN(S4, 2) And fIN(S6, 3)) Or fIN(S4, 1, 4, 5) And (fIN(S7, 2, 3, 4) And fIN(S1, 3, 4) And fIN(S2, 3, 4, 5) Or fIN(S7, 1, 5) And fIN(S1, 3)))) Or fIN(S4, 1, 5) And (fIN(S8, 4) And (fIN(S7, 1, 2) And fIN(S6, 1, 2, 3) And (fIN(S1, 2) And fIN(S2, 1, 2, 3, 5) Or fIN(S1, 1, 3, 4, 5) And (fIN(S2, 2, 3) Or fIN(S2, 1, 4, 5))) Or fIN(S7, 3, 4, 5) And fIN(S6, 1, 3, 5) And fIN(S3, 2, 3, 4, 5) And fIN(S2, 2)) Or fIN(S8, 1, 2, 3, 5) And (fIN(S4, 1) And (fIN(S1, 3) And fIN(S2, 1, 3, 4, 5) And (fIN(S6, 1, 2) Or fIN(S6, 3, 4, 5)) Or fIN(S1, 1, 2, 4, 5) And (fIN(S2, 1) And fIN(S6, 2, 3, 4, 5) Or fIN(S2, 2, 3, 4, 5) And (fIN(S7, 4) Or fIN(S7, 1, 2, 3, 5)))) Or fIN(S4, 2, 3, 4, 5) And fIN(S1, 2, 3, 4, 5)))) Or fIN(S5, 1, 4, 5) And fIN(S8, 1, 2, 3, 5) And fIN(S2, 1, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) And fIN(S6, 1, 2, 4, 5)) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2) And (fIN(S8, 4) And fIN(S2, 1, 2, 3, 5) And (fIN(S1, 1) And fIN(S7, 1, 4, 5) Or _
fIN(S1, 2, 3, 4, 5) And fIN(S7, 2, 3) And fIN(S3, 1, 2, 5)) Or fIN(S8, 1, 2, 3, 5) And fIN(S7, 1, 2, 3, 4) And (fIN(S1, 1) And fIN(S7, 2, 3, 4, 5) Or fIN(S1, 2, 3, 4, 5) And (fIN(S2, 1) And fIN(S5, 1, 3, 4, 5) Or fIN(S2, 2, 3, 4, 5)))) Or fIN(S1, 3, 4, 5) And (fIN(S2, 1, 2, 3) And (fIN(S6, 1) And (fIN(S7, 2, 3) And fIN(S3, 3) And fIN(S2, 1) Or fIN(S7, 1, 4, 5) And fIN(S3, 1, 2, 3, 5) And fIN(S8, 1, 2, 3, 5)) Or fIN(S6, 2, 3, 4, 5) And fIN(S3, 3, 4) And (fIN(S4, 1, 2) And fIN(S7, 1, 2, 4, 5) Or fIN(S4, 3, 4, 5) And fIN(S2, 1))) Or fIN(S2, 4, 5) And fIN(S5, 2) And fIN(S4, 2))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 1, 2) And fIN(S2, 1, 2, 3) And (fIN(S1, 1, 2, 3) And fIN(S3, 1, 2, 3, 5) And fIN(S5, 2, 3) And fIN(S1, 1, 2) Or fIN(S1, 4, 5) And (fIN(S7, 1, 4) And fIN(S3, 3, 4) And fIN(S1, 4) Or fIN(S7, 2, 3, 5) And fIN(S5, 3))) Or fIN(S4, 3, 4, 5) And fIN(S1, 2) And fIN(S6, 3) And fIN(S3, 1, 2, 4, 5) And fIN(S7, 1, 3, 4, 5))))))

End Function

Private Function IsSeg4(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Boolean
          
    IsSeg4 = (fIN(S5, 1) And (fIN(S3, 1, 2) And (fIN(S8, 1, 2, 3) And (fIN(S4, 3, 4) And (fIN(S6, 1, 2) And fIN(S2, 2, 3, 5) And (fIN(S7, 1, 2, 3) And (fIN(S1, 1, 4) Or fIN(S1, 2, 3, 5) And (fIN(S3, 1) And fIN(S7, 1, 2) Or fIN(S3, 2, 3, 4, 5) And fIN(S4, 1, 2, 4, 5))) Or fIN(S7, 4, 5) And fIN(S1, 3, 4, 5)) Or fIN(S6, 3, 4, 5) And (fIN(S8, 2) Or fIN(S8, 1, 3, 4, 5) And fIN(S4, 3) And fIN(S6, 4))) Or fIN(S4, 1, 2, 5) And (fIN(S8, 1, 2) And (fIN(S7, 1, 2, 4) And fIN(S1, 1, 2, 3, 5) And fIN(S2, 1, 2, 3) And fIN(S6, 3) And fIN(S1, 2, 3, 4, 5) Or fIN(S7, 3, 5) And fIN(S3, 2, 3, 4, 5)) Or fIN(S8, 3, 4, 5) And (fIN(S6, 1, 2) And fIN(S7, 1, 2, 3, 5) And (fIN(S2, 3) And fIN(S6, 2, 3, 4, 5) Or fIN(S2, 1, 2, 4, 5) And fIN(S1, 1, 3, 4) And fIN(S7, 2)) Or fIN(S6, 3, 4, 5) And fIN(S4, 2, 3, 4, 5) And (fIN(S1, 3) And fIN(S2, 1) Or fIN(S1, 1, 2, 4, 5))))) Or fIN(S8, 4, 5) And fIN(S1, 1, 2, 3, 4) And (fIN(S6, 1, 2) And fIN(S2, 2, 3, 4, 5) And (fIN(S8, 4) And fIN(S4, 3) And fIN(S2, 3) Or fIN(S8, 1, 2, 3, 5) And _
fIN(S4, 1, 2, 3, 5) And fIN(S7, 2) And fIN(S1, 1)) Or fIN(S6, 3, 4, 5) And fIN(S4, 1, 3, 4, 5) And fIN(S6, 3) And fIN(S2, 3, 4, 5) And fIN(S4, 1))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2, 3) And fIN(S7, 1, 2) And fIN(S8, 1, 2, 3, 4) And (fIN(S4, 1, 2, 3) And fIN(S6, 2, 3, 4, 5) And fIN(S3, 3) And fIN(S7, 1) Or fIN(S4, 4, 5) And fIN(S2, 1, 2) And fIN(S1, 2, 3, 4, 5) And fIN(S3, 3)) Or fIN(S1, 4, 5) And fIN(S1, 4) And fIN(S7, 2, 3, 4) And fIN(S4, 2, 4, 5) And fIN(S8, 2) And fIN(S7, 1, 3, 4, 5)) Or fIN(S6, 3, 4, 5) And (fIN(S6, 3) And (fIN(S1, 1) And fIN(S4, 1) Or fIN(S1, 2, 3, 4, 5) And fIN(S1, 3, 4) And (fIN(S2, 1, 2, 3) And fIN(S8, 2) And fIN(S2, 2) Or fIN(S2, 4, 5) And fIN(S4, 2) And fIN(S1, 1, 2, 4, 5) And fIN(S2, 1, 2, 3, 5))) Or fIN(S6, 1, 2, 4, 5) And fIN(S7, 2, 3, 5) And fIN(S4, 1, 3) And (fIN(S2, 1) And fIN(S8, 2) Or fIN(S2, 2, 3, 4, 5) And fIN(S2, 3) And fIN(S1, 1, 3, 4, 5))))) Or fIN(S5, 2, 3, 4, 5) And (fIN(S8, 1, 2, 3) And (fIN(S5, 2) And _
(fIN(S4, 2, 3, 4) And (fIN(S3, 1, 2, 3) And (fIN(S1, 1, 2, 3) And (fIN(S8, 1, 2) And (fIN(S2, 1, 2) And fIN(S4, 1, 3, 4, 5) And fIN(S6, 2, 3, 4, 5) Or fIN(S2, 3, 4, 5) And fIN(S3, 1, 2) And fIN(S4, 2, 3)) Or fIN(S8, 3, 4, 5) And (fIN(S6, 1) And fIN(S1, 2) And fIN(S4, 2) Or fIN(S6, 2, 3, 4, 5) And (fIN(S3, 1, 2) And (fIN(S2, 3) Or fIN(S2, 1, 2, 4, 5)) Or fIN(S3, 3, 4, 5) And fIN(S6, 1, 3, 4, 5)))) Or fIN(S1, 4, 5) And (fIN(S2, 2, 3) And fIN(S3, 1) And fIN(S1, 4) Or fIN(S2, 1, 4, 5) And fIN(S7, 1, 2) And (fIN(S1, 4) Or fIN(S1, 1, 2, 3, 5) And fIN(S2, 1)))) Or fIN(S3, 4, 5) And (fIN(S7, 1, 2) And fIN(S6, 1, 2, 3) And fIN(S6, 2, 3, 4, 5) And (fIN(S7, 1) And fIN(S1, 2, 3, 4, 5) Or fIN(S7, 2, 3, 4, 5) And fIN(S6, 1, 3, 4, 5)) Or fIN(S7, 3, 4, 5) And fIN(S1, 2, 3, 4) And fIN(S6, 2) And fIN(S2, 1, 3))) Or fIN(S4, 1, 5) And (fIN(S8, 1, 2) And fIN(S6, 3, 5) And (fIN(S2, 1, 2) And fIN(S6, 1, 2, 4, 5) And fIN(S1, 2) Or fIN(S2, 3, 4, 5) And (fIN(S2, 4) Or fIN(S2, 1, 2, 3, 5) And fIN(S7, 3))) Or _
fIN(S8, 3, 4, 5) And fIN(S2, 1, 2, 4) And fIN(S1, 2, 3) And fIN(S2, 2, 3, 4, 5) And fIN(S7, 2, 3, 4, 5) And fIN(S3, 3))) Or fIN(S5, 1, 3, 4, 5) And (fIN(S3, 1, 2, 3) And (fIN(S2, 1, 2) And (fIN(S8, 1, 2) And (fIN(S7, 1, 2) And (fIN(S1, 1, 3) And (fIN(S1, 1) And fIN(S2, 2, 3, 4, 5) Or fIN(S1, 2, 3, 4, 5)) Or fIN(S1, 2, 4, 5) And fIN(S6, 1, 3, 4, 5) And fIN(S4, 3, 4, 5)) Or fIN(S7, 3, 4, 5)) Or fIN(S8, 3, 4, 5) And (fIN(S4, 1) And fIN(S6, 1, 3, 4, 5) And fIN(S7, 2) Or fIN(S4, 2, 3, 4, 5) And (fIN(S3, 1) And fIN(S1, 1) Or fIN(S3, 2, 3, 4, 5) And (fIN(S1, 3) And fIN(S7, 2, 3, 4, 5) Or fIN(S1, 1, 2, 4, 5))))) Or fIN(S2, 3, 4, 5) And (fIN(S1, 3) And fIN(S4, 1, 2, 3) And fIN(S7, 2, 3) And (fIN(S8, 2) And fIN(S6, 1, 4, 5) Or fIN(S8, 1, 3, 4, 5) And fIN(S6, 2, 3, 4, 5)) Or fIN(S1, 1, 2, 4, 5) And (fIN(S6, 3) And (fIN(S3, 2) And fIN(S1, 1) Or fIN(S3, 1, 3, 4, 5)) Or fIN(S6, 1, 2, 4, 5)))) Or fIN(S3, 4, 5) And (fIN(S7, 3, 4) And (fIN(S6, 3) Or fIN(S6, 1, 2, 4, 5) And fIN(S2, 2)) Or _
fIN(S7, 1, 2, 5) And fIN(S2, 2, 4, 5) And (fIN(S4, 1, 3) And fIN(S1, 1, 3, 4, 5) And fIN(S1, 2, 3, 4, 5) And fIN(S3, 4) Or fIN(S4, 2, 4, 5) And fIN(S1, 1, 2))))) Or fIN(S8, 4, 5) And (fIN(S3, 1, 2) And (fIN(S5, 2, 3) And (fIN(S4, 2, 3, 4) And (fIN(S6, 1, 2) And (fIN(S7, 1, 3) And fIN(S1, 1, 2, 3, 4) And (fIN(S4, 2) And fIN(S1, 2) Or fIN(S4, 1, 3, 4, 5) And fIN(S1, 1, 3, 4, 5)) Or fIN(S7, 2, 4, 5) And (fIN(S1, 1, 2, 3) And fIN(S7, 1, 3, 5) And fIN(S2, 2) Or fIN(S1, 4, 5) And fIN(S3, 1) And fIN(S2, 1, 2))) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2, 3) And fIN(S1, 1, 2, 3) And (fIN(S3, 1) And fIN(S7, 1, 2, 3, 4) Or fIN(S3, 2, 3, 4, 5) And fIN(S5, 1, 3, 4, 5)) Or fIN(S4, 1, 4, 5) And fIN(S7, 1, 5) And fIN(S1, 1, 2, 4, 5))) Or fIN(S4, 1, 5) And (fIN(S8, 4) And fIN(S7, 3, 4, 5) And fIN(S6, 2, 4) And fIN(S2, 2, 3) Or fIN(S8, 1, 2, 3, 5) And fIN(S4, 1) And fIN(S1, 1, 2, 4, 5) And fIN(S2, 1) And fIN(S6, 1))) Or fIN(S5, 1, 4, 5) And (fIN(S8, 4) And (fIN(S6, 1, 2, 4) Or fIN(S6, 3, 5) And _
fIN(S7, 1, 2, 4) And (fIN(S4, 3) And fIN(S1, 1, 2) And fIN(S7, 1, 3, 4, 5) Or fIN(S4, 1, 2, 4, 5))) Or fIN(S8, 1, 2, 3, 5) And (fIN(S2, 2) Or fIN(S2, 1, 3, 4, 5) And (fIN(S1, 1) And fIN(S2, 1, 2, 3, 5) Or fIN(S1, 2, 3, 4, 5) And fIN(S6, 3))))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And fIN(S1, 1, 2) And fIN(S8, 4) And (fIN(S2, 4) And fIN(S3, 3) Or fIN(S2, 1, 2, 3, 5) And fIN(S1, 1) And fIN(S7, 2, 3) And fIN(S2, 1, 3, 4, 5)) Or fIN(S6, 3, 4, 5) And (fIN(S4, 1, 2) And fIN(S2, 1, 2, 3) And fIN(S1, 1, 2, 3) And fIN(S3, 4) And (fIN(S2, 1, 2) And fIN(S7, 2, 3) Or fIN(S2, 3, 4, 5) And fIN(S7, 1, 4, 5)) Or fIN(S4, 3, 4, 5) And (fIN(S1, 2) And (fIN(S6, 3) And fIN(S3, 3) And fIN(S2, 2, 3, 4, 5) Or fIN(S6, 1, 2, 4, 5) And fIN(S2, 3) And fIN(S3, 3)) Or fIN(S1, 1, 3, 4, 5) And fIN(S2, 1) And fIN(S1, 3)))))))

End Function

Private Function IsSeg5(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Boolean
  
    IsSeg5 = (fIN(S5, 1) And (fIN(S3, 1, 2) And (fIN(S8, 1, 2, 3) And (fIN(S4, 3, 4) And fIN(S6, 1, 2) And fIN(S2, 1, 4) And fIN(S1, 1, 2) And (fIN(S8, 1, 2) Or fIN(S8, 3, 4, 5) And fIN(S2, 2, 3, 4, 5)) Or fIN(S4, 1, 2, 5) And (fIN(S8, 1, 2) And fIN(S7, 1, 2, 4) And (fIN(S1, 4) And fIN(S3, 2, 3, 4, 5) And fIN(S2, 1) Or fIN(S1, 1, 2, 3, 5) And (fIN(S2, 1, 2, 3) And (fIN(S6, 3) And fIN(S1, 1) Or fIN(S6, 1, 2, 4, 5) And (fIN(S7, 1, 2) Or fIN(S7, 3, 4, 5))) Or fIN(S2, 4, 5) And fIN(S1, 1, 3, 4, 5))) Or fIN(S8, 3, 4, 5) And (fIN(S6, 1, 2) And fIN(S7, 1, 2, 3, 5) And (fIN(S2, 3) And fIN(S6, 1) Or fIN(S2, 1, 2, 4, 5) And fIN(S1, 2, 5) And fIN(S3, 2, 3, 4, 5)) Or fIN(S6, 3, 4, 5) And fIN(S4, 1) And fIN(S1, 2)))) Or fIN(S8, 4, 5) And (fIN(S1, 1, 2, 3, 4) And (fIN(S6, 1, 2) And (fIN(S2, 1) And (fIN(S4, 1, 3) And (fIN(S7, 1) And fIN(S1, 1, 2, 4, 5) And fIN(S1, 1, 3, 4, 5) Or fIN(S7, 2, 3, 4, 5) And fIN(S1, 2, 3) And fIN(S7, 3)) Or fIN(S4, 2, 4, 5) And fIN(S1, 2) And (fIN(S3, 1) And fIN(S7, 1) Or _
fIN(S3, 2, 3, 4, 5))) Or fIN(S2, 2, 3, 4, 5) And fIN(S8, 4) And fIN(S4, 1, 2, 4, 5) And fIN(S2, 3, 4) And fIN(S1, 3)) Or fIN(S6, 3, 4, 5) And (fIN(S4, 2) And fIN(S2, 2) And fIN(S1, 1, 2) And fIN(S3, 2, 3, 4, 5) And fIN(S1, 1) Or fIN(S4, 1, 3, 4, 5) And fIN(S6, 3) And fIN(S2, 1, 2) And fIN(S1, 1))) Or fIN(S1, 5) And fIN(S4, 1, 3, 5) And fIN(S2, 1, 2, 3) And fIN(S2, 2) And fIN(S4, 1) And fIN(S3, 1))) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And (fIN(S1, 1, 2, 3) And (fIN(S7, 1, 2) And (fIN(S8, 1, 2, 3, 4) And fIN(S4, 1, 2, 3) And (fIN(S6, 1) And (fIN(S3, 3, 4) And (fIN(S2, 1, 3) Or fIN(S2, 2, 4, 5)) Or fIN(S3, 1, 2, 5) And fIN(S2, 1, 3)) Or fIN(S6, 2, 3, 4, 5) And fIN(S3, 1, 2, 4, 5) And fIN(S2, 1, 2)) Or fIN(S8, 5) And fIN(S2, 2, 3, 5) And fIN(S1, 2) And fIN(S3, 1, 2, 5) And fIN(S2, 1, 3, 4, 5)) Or fIN(S7, 3, 4, 5) And fIN(S3, 3) And (fIN(S2, 3, 4) And fIN(S7, 3) And fIN(S1, 1) Or fIN(S2, 1, 2, 5) And fIN(S4, 1) And fIN(S8, 4) And fIN(S7, 3))) Or fIN(S1, 4, 5) And (fIN(S1, 4) And _
(fIN(S7, 2, 3, 4) And fIN(S4, 1, 3) And fIN(S2, 1, 2, 4, 5) And (fIN(S6, 1) And fIN(S8, 1, 2, 4, 5) Or fIN(S6, 2, 3, 4, 5) And fIN(S8, 3)) Or fIN(S7, 1, 5) And (fIN(S8, 2, 4) And fIN(S4, 2, 3) And fIN(S7, 2, 3, 4, 5) Or fIN(S8, 1, 3, 5) And (fIN(S4, 3) Or fIN(S4, 1, 2, 4, 5) And fIN(S8, 1)))) Or fIN(S1, 1, 2, 3, 5) And fIN(S7, 1) And (fIN(S3, 4) And fIN(S8, 1, 2, 5) And (fIN(S2, 1) And fIN(S4, 1) Or fIN(S2, 2, 3, 4, 5)) Or fIN(S3, 1, 2, 3, 5) And fIN(S8, 4) And fIN(S6, 2, 3, 4, 5)))) Or fIN(S6, 3, 4, 5) And fIN(S6, 3) And fIN(S1, 2, 3, 4, 5) And fIN(S1, 1, 2, 5) And fIN(S7, 2))) Or fIN(S5, 2, 3, 4, 5) And (fIN(S8, 1, 2, 3) And (fIN(S5, 2) And (fIN(S4, 2, 3, 4) And fIN(S3, 1, 2, 3) And (fIN(S1, 1, 2, 3) And (fIN(S8, 1, 2) And (fIN(S2, 1, 2) And (fIN(S4, 2) And fIN(S6, 1, 2, 3) Or fIN(S4, 1, 3, 4, 5) And fIN(S6, 1)) Or fIN(S2, 3, 4, 5) And fIN(S3, 3, 4, 5) And fIN(S4, 2)) Or fIN(S8, 3, 4, 5) And fIN(S6, 2, 3, 4, 5) And fIN(S3, 3, 4, 5) And fIN(S6, 2)) Or fIN(S1, 4, 5) And _
fIN(S2, 2, 3) And fIN(S3, 2, 3, 4, 5) And (fIN(S7, 1, 3, 4) And fIN(S6, 1, 2) Or fIN(S7, 2, 5) And fIN(S6, 1))) Or fIN(S4, 1, 5) And (fIN(S8, 1, 2) And (fIN(S6, 1, 2, 4) And fIN(S1, 1, 2, 3, 4) Or fIN(S6, 3, 5) And fIN(S2, 1, 2) And fIN(S6, 3)) Or fIN(S8, 3, 4, 5) And (fIN(S2, 1, 2, 4) And fIN(S1, 2, 3) And (fIN(S2, 1) Or fIN(S2, 2, 3, 4, 5) And fIN(S7, 1) And fIN(S3, 1, 2, 4, 5)) Or fIN(S2, 3, 5) And fIN(S3, 1, 2, 4, 5) And fIN(S7, 1, 3, 4, 5) And (fIN(S1, 2, 3, 4) Or fIN(S1, 1, 5) And fIN(S7, 1))))) Or fIN(S5, 1, 3, 4, 5) And (fIN(S3, 1, 2, 3) And fIN(S2, 1, 2) And (fIN(S8, 1, 2) And fIN(S7, 1, 2) And (fIN(S1, 1, 3) And fIN(S1, 1) And fIN(S2, 1) Or fIN(S1, 2, 4, 5) And (fIN(S6, 2) Or fIN(S6, 1, 3, 4, 5) And fIN(S4, 1, 2))) Or fIN(S8, 3, 4, 5) And (fIN(S4, 1) And fIN(S6, 1, 3, 4, 5) And fIN(S7, 1, 3, 4, 5) And fIN(S1, 1) Or fIN(S4, 2, 3, 4, 5) And fIN(S3, 1) And fIN(S1, 2, 3, 4, 5) And fIN(S6, 1))) Or fIN(S3, 4, 5) And fIN(S7, 1, 2, 5) And (fIN(S2, 1, 3) And fIN(S4, 2) Or _
fIN(S2, 2, 4, 5) And fIN(S4, 1, 3) And fIN(S1, 1, 3, 4, 5) And fIN(S1, 1)))) Or fIN(S8, 4, 5) And (fIN(S3, 1, 2) And (fIN(S5, 2, 3) And fIN(S4, 1, 5) And (fIN(S8, 4) And fIN(S7, 1, 2) And (fIN(S6, 1, 2, 3) And fIN(S1, 2) And fIN(S2, 4) Or fIN(S6, 4, 5) And fIN(S1, 1, 2, 4, 5)) Or fIN(S8, 1, 2, 3, 5) And (fIN(S4, 1) And fIN(S1, 3) And fIN(S2, 2) And fIN(S3, 1) Or fIN(S4, 2, 3, 4, 5) And fIN(S1, 1))) Or fIN(S5, 1, 4, 5) And fIN(S8, 4) And fIN(S6, 3, 5) And fIN(S7, 1, 2, 4) And fIN(S4, 3) And fIN(S1, 1, 2) And fIN(S7, 2)) Or fIN(S3, 3, 4, 5) And (fIN(S6, 1, 2) And fIN(S1, 1, 2) And (fIN(S8, 4) And fIN(S2, 1, 2, 3, 5) And (fIN(S1, 1) And fIN(S7, 2, 3) And fIN(S2, 2) Or fIN(S1, 2, 3, 4, 5) And fIN(S7, 1, 4, 5) And fIN(S2, 1)) Or fIN(S8, 1, 2, 3, 5) And fIN(S7, 1, 2, 3, 4) And fIN(S1, 1) And fIN(S7, 1) And fIN(S3, 1, 2, 4, 5)) Or fIN(S6, 3, 4, 5) And fIN(S4, 1, 2) And fIN(S2, 1, 2, 3) And fIN(S1, 1, 2, 3) And (fIN(S3, 4) And fIN(S2, 3, 4, 5) And fIN(S7, 2, 3) Or fIN(S3, 1, 2, 3, 5) And _
fIN(S5, 1, 4, 5) And fIN(S1, 1))))))

End Function

Private Function GQAlgorithm(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As String
    
    Dim result As String
    
    If IsSeg1(S1, S2, S3, S4, S5, S6, S7, S8) Then result = result & "1"
    If IsSeg2(S1, S2, S3, S4, S5, S6, S7, S8) Then result = result & "2"
    If IsSeg3(S1, S2, S3, S4, S5, S6, S7, S8) Then result = result & "3"
    If IsSeg4(S1, S2, S3, S4, S5, S6, S7, S8) Then result = result & "4"
    If IsSeg5(S1, S2, S3, S4, S5, S6, S7, S8) Then result = result & "5"
    
    GQAlgorithm = result

End Function


' The public function which returns segment name as a string using the base algorithm
' and a catch-all expression for new (unknown) cases
Function GetSegment(S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer) As Variant

    ' check input parameters are valid
    If Not fIN(S1, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S1 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S2, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S2 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S3, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S3 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S4, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S4 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S5, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S5 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S6, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S6 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S7, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S7 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    ElseIf Not fIN(S8, 1, 2, 3, 4, 5) Then
        MsgBox ("GetSegment() Error: Parameter S8 must be an integer between 1 and 5")
        GetCSegment = CVErr(xlErrValue)
        Exit Function
    End If
        

    Dim algoOut As String
    
    ' run the core algorithm
    algoOut = GQAlgorithm(S1, S2, S3, S4, S5, S6, S7, S8)
    
    ' determine the segment based on the algorithm output
    If algoOut = "1" Then
        GetSegment = "Vocation Chasers"
    ElseIf algoOut = "2" Then
        GetSegment = "Inspired Intellectuals"
    ElseIf algoOut = "3" Then
        GetSegment = "Experience Seekers"
    ElseIf algoOut = "4" Then
        GetSegment = "Uncertain Students"
    ElseIf algoOut = "5" Then
        GetSegment = "Prospect Boosters"
    Else
        GetSegment = ""
    End If

End Function



' Routine for testing all possible input combinations to ensure total coverage during the algorithm
' testing phase. This testing will have been completed prior to release so this function is hidden as
' Private but left here for reference
Private Sub TestGQAlgorithm()

    Dim countCases As Long ' counter for total number of cases
    Dim seg1 As Long, seg2 As Long, seg3 As Long, seg4 As Long, seg5 As Long, missingCases As Long ' counters for number of cases falling into each segment
    Dim algoOut As String, errorDescrip As String
    Dim S1 As Integer, S2 As Integer, S3 As Integer, S4 As Integer, S5 As Integer, S6 As Integer, S7 As Integer, S8 As Integer ' simulated input variables (statement responses)
    
    For S1 = 1 To 5
        For S2 = 1 To 5
            For S3 = 1 To 5
                For S4 = 1 To 5
                    For S5 = 1 To 5
                        For S6 = 1 To 5
                            For S7 = 1 To 5
                                For S8 = 1 To 5
                                        countCases = countCases + 1
                                        algoOut = GQAlgorithm(S1, S2, S3, S4, S5, S6, S7, S8)
                                        If algoOut = "1" Then
                                            seg1 = seg1 + 1
                                        ElseIf algoOut = "2" Then
                                            seg2 = seg2 + 1
                                        ElseIf algoOut = "3" Then
                                            seg3 = seg3 + 1
                                        ElseIf algoOut = "4" Then
                                            seg4 = seg4 + 1
                                        ElseIf algoOut = "5" Then
                                            seg5 = seg5 + 1
                                        ElseIf algoOut = "" Then
                                            missingCases = missingCases + 1
                                        Else
                                            MsgBox ("Multi-match Error found: input was " & S1 & ", " & S2 & ", " & S3 & ", " & S4 & ", " & S5 & ", " & S6 & ", " & S7 & ", " & S8 & " output was " & algoOut)
                                    Exit Sub
                                    End If
                                Next S8
                            Next S7
                        Next S6
                    Next S5
                Next S4
            Next S3
        Next S2
    Next S1
    
    MsgBox ("Completed " & countCases & " tests" & vbNewLine & "Seg 1: " & seg1 & vbNewLine & "Seg 2: " & seg2 & vbNewLine & "Seg 3: " & seg3 & vbNewLine & "Seg 4: " & seg4 & vbNewLine & "Seg 5: " & seg5 & vbNewLine & "Missing cases: " & missingCases & vbNewLine & "No multi-match errors found.")

End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
