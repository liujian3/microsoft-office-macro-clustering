Attribute VB_Name = "Module1"
'=========================================================================
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|VBA(Ver 3.5)|fffd|@|fffd|@|fffd||c42c||fffd||481|Ftoowaki|fffd|@|fffd|@|fffd|X|fffd|V|fffd||fffd||fffd|F2016/2/10
'=========================================================================
Option Explicit  '|fffd||3d0||fffd||fffd||310||933e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||8414|
Public Const ControlSheet = "|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s"         ' |fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|V|fffd|[|fffd|g|fffd||fffd|
Public Const SearchWordSheet = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"          ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|V|fffd|[|fffd|g|fffd||fffd|
Public Const ResultSheet = "|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|"                ' |fffd||fffd||fffd|s|fffd||fffd||fffd||283|V|fffd|[|fffd|g|fffd||fffd|
Public Const ResultSheetTPL = "|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|_|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g" ' |fffd||fffd||fffd|s|fffd||fffd||fffd||283|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd||fffd|
Public Const TempSheetName = "|fffd||a39e||fffd||fffd||fffd|Sheet"         ' |fffd||a39e||fffd||fffd||fffd|Sheet
Public Const errorLogSheet = "|fffd||1ce||63b8||fffd|s|fffd||fffd||fffd|X|fffd|g"         ' |fffd||1ce||63b8||fffd|s|fffd||fffd||fffd|X|fffd|g|fffd|V|fffd|[|fffd|g|fffd||fffd|
Const textLimtForLink = 500 'Word|fffd||303||fffd||fffd||fffd||fffd|N|fffd||24e|g|fffd|p|fffd||fffd||fffd||fffd||931f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||80b7||fffd||fffd|
    
'|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd|
Dim wcnt As Long ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|^
Dim xcnt As Long ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|^
Dim pptcnt As Long ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|^

Type fileListType '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|p|fffd|^|fffd|C|fffd|v
    dirPath As String 'Path
    FileName As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
End Type
Dim wordFileList() As fileListType    'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g
Dim excelFileList() As fileListType   'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g
Dim pptFileList() As fileListType   'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g

Type outlineListType '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|p|fffd|^|fffd|C|fffd|v
    outlineLevel As Long '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|
    page As Long '|fffd|y|fffd|[|fffd|W
    line As Long '|fffd|s
    indexContent As String '|fffd||fffd||fffd|o|fffd||fffd||fffd||30f||354||50d||fffd|
    indexContentSignle As String '|fffd||fffd||fffd|o|fffd||fffd||fffd||30f||353||fffd||fffd|e
End Type
Dim outlineList() As outlineListType 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g

Type errorLogType '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd|p|fffd||fffd||fffd|X|fffd|g
    filePath As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    errorNum As String '|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|
    errorContent As String '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e
End Type
Dim errorLog() As errorLogType 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g

Dim outlineCnt As Long '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||310||fffd|
Dim resultLine As Long '|fffd||fffd||fffd|s|fffd||fffd||fffd||282||24b|L|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|w|fffd||80b7||fffd||fffd|
Dim progressCnt As Long '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|J|fffd|E|fffd||fffd||fffd|^
Dim progressMax As Long '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||303|}|fffd|b|fffd|N|fffd|X|fffd|l
Const proggressInitWidth = 225 '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||30f||fffd||292|u
Const proggressInitLeft = 5 '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||30d||fffd||fffd||292|u

Dim errorLogCnt As Long '|fffd|G|fffd||fffd||fffd|[|fffd||303||fffd||fffd|O|fffd||fffd|

Dim startTime As Single '|fffd||fffd||fffd||50c|v|fffd||fffd||fffd|p(|fffd|J|fffd|n)
Dim finishTime As Single '|fffd||fffd||fffd||50c|v|fffd||fffd||fffd|p(|fffd|I|fffd||fffd|)
Dim myVbaWorkBookName As String '|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd|VBA|fffd||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd|
Dim wdObj As Object 'Word|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd|
Dim pptObj As Object 'PowerPoint|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd|
Dim chkeckBox1Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X1
Dim chkeckBox2Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X2
Dim chkeckBox3Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X3
Dim chkeckBox4Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X4
Dim chkeckBox5Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X5
Dim chkeckBox6Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X6
Dim chkeckBox7Val As Boolean '|fffd|u|fffd||752||80a8||fffd||fffd||44e||fffd||fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X7
Dim progressApi As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|s|fffd|[|fffd||fffd||fffd|p
Dim excelIsInstalled As Boolean ' MS Excel|fffd||30c||fffd||fffd||fffd|ON|fffd|X|fffd|C|fffd|b|fffd|`|fffd|B|fffd||fffd||fffd|s|fffd||30f||a347||fffd||fffd|True
Dim wordIsInstalled As Boolean ' MS Word|fffd||30c||fffd||fffd||fffd|ON|fffd|X|fffd|C|fffd|b|fffd|`|fffd|B|fffd||fffd||fffd|s|fffd||30f||a347||fffd||fffd|True
Dim pptIsInstalled As Boolean ' Power Point|fffd||30c||fffd||fffd||fffd|ON|fffd|X|fffd|C|fffd|b|fffd|`|fffd|B|fffd||fffd||fffd|s|fffd||30f||a347||fffd||fffd|True
Dim pptFileIsOpened As Boolean 'PowePoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24b|N|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||343|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||202||fffd||fffd||60a4||fffd||242||fffd||fffd||fffd|B

Dim addFileExtension() As String   '|fffd||1c9||fffd||fffd||30a|g|fffd||fffd||fffd|q
Dim lessExcel2016 As Boolean 'Excel2016|fffd||fffd||827a||fffd||30f||a347|True

'---------------------------------------------------------------------
' |fffd||fffd||fffd|C|fffd||fffd|
'---------------------------------------------------------------------
Sub SearchMain()
    Dim i As Long ' For|fffd|p|fffd||303|J|fffd|E|fffd||fffd||fffd|^
    startTime = Timer ' |fffd|J|fffd|n|fffd||fffd||fffd||502||fffd||fffd|L|fffd|^
    finishTime = 0
    Err.Clear '|fffd||211|O|fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd||d3dc|
    myVbaWorkBookName = ThisWorkbook.Name
    progressApi = "" '|fffd|i|fffd||fffd||fffd|A|fffd|s|fffd|[|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).Range("SearchFolder") = "") Then
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||38f||6c3|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        End
    End If
    
    'Excel|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||30a|m|fffd|F
    If (Application.Version < 16) Then '2016|fffd||fffd||fffd||fffd||fffd||10a2|
        lessExcel2016 = True
    End If
    
    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||fffd||fffd||64fe|
    chkeckBox1Val = False
    chkeckBox2Val = False
    chkeckBox3Val = False
    chkeckBox4Val = False
    chkeckBox5Val = False
    chkeckBox6Val = False
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt1").Value = 1) Then chkeckBox1Val = True
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt2").Value = 1) Then chkeckBox2Val = True
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt3").Value = 1) Then chkeckBox3Val = True
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt4").Value = 1) Then chkeckBox4Val = True
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt5").Value = 1) Then chkeckBox5Val = True
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).CheckBoxes("checkbox_text_opt6").Value = 1) Then chkeckBox6Val = True
    
    '-----------------------------------------------
    '|fffd|O|fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    Dim newWorkSheet As Worksheet
    Dim Ws As Worksheet, flag As Boolean
    errorLogCnt = 0
    flag = False
    '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||348||fffd|U|fffd||fffd||fffd||fffd|
    For Each Ws In Worksheets
        DoEvents
        If Ws.Name = errorLogSheet Then flag = True
    Next Ws
    If flag = True Then
        Application.DisplayAlerts = False
        Workbooks(myVbaWorkBookName).Sheets(errorLogSheet).Delete
        Application.DisplayAlerts = True
    End If
    
    '-----------------------------------------------
    '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||310||752||fffd|
    '-----------------------------------------------
    progressCnt = 1
    progressMax = 100 '|fffd||402||182||702||fffd|100|fffd||14a|J|fffd|n
    
    UserForm1.Show vbModeless                   '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[Form|fffd||fffd|\|fffd||fffd|
    
    Call setProgress(1, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||64fe||fffd||fffd|", "", "")
    'DoEvents|fffd||313|x|fffd||243|}|fffd|E|fffd|X|fffd|J|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||5c3|A|fffd|C|fffd|R|fffd||fffd||fffd||fffd||48b|@|fffd||fffd||fffd||24c||152||fffd|
    Application.Cursor = xlWait
            
    '-----------------------------------------------
    'TempSheet|fffd|V|fffd|[|fffd|g|fffd||312||1c9||fffd|
    '-----------------------------------------------
    '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||348||fffd|U|fffd||fffd||fffd||fffd|
    flag = False
    For Each Ws In Worksheets
        DoEvents
        If Ws.Name = TempSheetName Then flag = True
    Next Ws
    If flag = True Then
        Application.DisplayAlerts = False
        Workbooks(myVbaWorkBookName).Sheets(TempSheetName).Delete
        Application.DisplayAlerts = True
    End If
    
    '|fffd|V|fffd|[|fffd|g|fffd||fffd||1c9||fffd|
    Set newWorkSheet = Worksheets.Add()
    newWorkSheet.Name = TempSheetName

    '-----------------------------------------------
    '|fffd||fffd||fffd|s|fffd||fffd||fffd||283|V|fffd|[|fffd|g|fffd||312||1c9||fffd|
    '-----------------------------------------------
    '|fffd||211|O|fffd||30e||fffd||fffd|s|fffd||fffd||fffd||283|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34d||d3dc||fffd||fffd||fffd||fffd|
    flag = False
    For Each Ws In Worksheets
        DoEvents
        If Ws.Name = ResultSheet Then flag = True
    Next Ws
    If flag = True Then
        Application.DisplayAlerts = False
        Workbooks(myVbaWorkBookName).Sheets(ResultSheet).Delete
        Application.DisplayAlerts = True
    End If
    
    Workbooks(myVbaWorkBookName).Sheets(ResultSheetTPL).Visible = xlSheetVisible    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    Workbooks(myVbaWorkBookName).Sheets(ResultSheetTPL).Copy After:=Workbooks(myVbaWorkBookName).Sheets(Sheets.Count) '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|R|fffd|s|fffd|[
    ActiveSheet.Name = ResultSheet '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||3cd|X
    Workbooks(myVbaWorkBookName).Sheets(ResultSheetTPL).Visible = xlVeryHidden      '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    
    '|fffd|\|fffd||fffd||fffd||fffd|90%|fffd||255||3c2||fffd||fffd||fffd|
    ActiveWindow.Zoom = 80
    
    ' |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|g|fffd||fffd||fffd||152||fffd|
    Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C2").Select
    ActiveWindow.FreezePanes = True
        
    resultLine = 2 '|fffd||fffd||fffd||295|\|fffd||fffd|2|fffd|s|fffd||682||fffd||fffd||fffd|J|fffd|n
    
    '|fffd||fffd||fffd||fffd||fffd||fffd|
    Erase wordFileList
    Erase excelFileList
    Erase pptFileList
    wcnt = 0
    xcnt = 0
    pptcnt = 0
    Application.EnableEvents = False
    
    '-----------------------------------------------
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||30d||c42c|
    '-----------------------------------------------
    '"SearchFolder"|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|Z|fffd||fffd||fffd||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd|w|fffd||80b7||fffd||fffd|
    Dim searchFolderAbs As String ' |fffd||fffd||383|A|fffd|h|fffd||fffd||fffd|X|fffd||303|p|fffd|X
    Dim searchFolderRel As String ' |fffd||fffd||fffd||383|A|fffd|h|fffd||fffd||fffd|X|fffd||303|p|fffd|X
    searchFolderAbs = Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).Range("SearchFolder")
    searchFolderAbs = Replace(searchFolderAbs, "/", "\")
    
    If (chkeckBox6Val = False) Then '|fffd||fffd||383|p|fffd|X|fffd||11291||383|p|fffd|X|fffd||242||fffd||fffd||fffd|
        searchFolderRel = absToRelativePath(searchFolderAbs)
    Else
        searchFolderRel = searchFolderAbs
    End If
    '|fffd||fffd||fffd||fffd||fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
        
    CheckListInstalledApplication
    If (wordIsInstalled = True) Then
        Call makeFileList(searchFolderAbs, "doc", "doc") 'Word
    End If
    If (excelIsInstalled = True) Then
        Call makeFileList(searchFolderAbs, "xls", "xls") 'Excel
        Call makeFileList(searchFolderAbs, "xls", "csv") 'Excel
    End If
    If (pptIsInstalled = True) Then
        Call makeFileList(searchFolderAbs, "ppt", "ppt") 'PowerPoint
    End If

    '|fffd||1c9||fffd||fffd|g|fffd||fffd||fffd|q|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
    If (Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).Range("FileNameExtension") <> "") Then
        Dim myExtension As String '|fffd|g|fffd||fffd||fffd|q|fffd||315||fffd||fffd||fffd||fffd||fffd|
        Dim fileNameExtension() As String '|fffd||1c9||fffd||fffd|g|fffd||fffd||fffd|q|fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|
        myExtension = Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).Range("FileNameExtension")
        myExtension = Replace(myExtension, " ", ",") '|fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd|","|fffd||255||3c2||fffd||fffd||fffd|
        myExtension = Replace(myExtension, "/", ",") '/|fffd||fffd|","|fffd||255||3c2||fffd||fffd||fffd|
        myExtension = Replace(myExtension, ";", ",") ';|fffd||fffd|","|fffd||255||3c2||fffd||fffd||fffd|
        fileNameExtension = Split(myExtension, ",")
        For i = LBound(fileNameExtension) To UBound(fileNameExtension)
            If (fileNameExtension(i) <> "") And _
            (InStr(fileNameExtension(i), "doc") = 0) And _
            (InStr(fileNameExtension(i), "xls") = 0) And _
            (InStr(fileNameExtension(i), "csv") = 0) And _
            (InStr(fileNameExtension(i), "ppt") = 0) _
            Then
                Call makeFileList(searchFolderAbs, "xls", fileNameExtension(i)) 'makeFileList(Path, application, fileExtension)
            End If
        Next
    End If

    progressMax = wcnt + xcnt + pptcnt + 1 '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||30d||151||fffd|l|fffd||250||752||fffd|
    
    Dim myWindowState As Long 'WindowState
    '-----------------------------------------------
    '[Word|fffd|t|fffd|@|fffd|C|fffd||fffd|]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||182||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    For i = 0 To wcnt - 1
        DoEvents
        myWindowState = Application.WindowState
        If (myWindowState = xlMinimized) Then
            Application.WindowState = xlNormal
        End If
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Activate
        '[BUG FIX:2015/05/01 |fffd||202||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||182||fffd|Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||202||fffd||fffd||18c||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||10aa||fffd||fffd||fffd||fffd|.|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||182||fffd|Word|fffd||179c2||fffd||fffd||30b0||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||182||242||fffd||fffd||fffd|]
        On Error GoTo notFindWord  'Word|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347|
        Set wdObj = CreateObject("Word.Application") 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|J|fffd||fffd|.
        wdObj.WindowState = 2 'wdWindowStateMinimize(=2). |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||14f||fffd||fffd||fffd|
        Call setProgress(progressCnt, wordFileList(i).FileName & "|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|", "", "")
        Call SearchFromWordFile(wordFileList(i).dirPath, wordFileList(i).FileName, searchFolderAbs, searchFolderRel)
        wdObj.Quit 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
        progressCnt = progressCnt + 1
    Next
notFindWord:

    '-----------------------------------------------
    '[Excel|fffd|t|fffd|@|fffd|C|fffd||fffd|]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||182||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    For i = 0 To xcnt - 1
        DoEvents
        myWindowState = Application.WindowState
        If (myWindowState = xlMinimized) Then
            Application.WindowState = xlNormal
        End If
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Activate
        Call setProgress(progressCnt, excelFileList(i).FileName & "|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|", "", "")
        Call SearchFromExcelFile(excelFileList(i).dirPath, excelFileList(i).FileName, searchFolderAbs, searchFolderRel)
        progressCnt = progressCnt + 1
    Next
    
    '-----------------------------------------------
    '[PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd|]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||182||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    If (pptIsInstalled = True) Then
        On Error GoTo notFindPowerPoint  'PowerPoinnt|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347|
        Set pptObj = CreateObject("Powerpoint.Application") 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|J|fffd||fffd|
        pptObj.WindowState = 2 'wdWindowStateMinimize(=2). |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||14f||fffd||fffd||fffd|
        
        For i = 0 To pptcnt - 1
            DoEvents
            myWindowState = Application.WindowState
            If (myWindowState = xlMinimized) Then
                Application.WindowState = xlNormal
            End If
            Call setProgress(progressCnt, pptFileList(i).FileName & "|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|", "", "")
            Call SearchFromPptFile(pptFileList(i).dirPath, pptFileList(i).FileName, searchFolderAbs, searchFolderRel)
            progressCnt = progressCnt + 1
        Next
       If (pptObj.Presentations.Count = 0) Then
            pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
        End If
    End If
    
notFindPowerPoint:
    
    '-----------------------------------------------
    ' No|fffd||143|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    '|fffd||fffd||fffd||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||60a4||fffd||251||fffd||fffd||7c2||243|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
    DoEvents
    Call setProgress(progressCnt, "|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||143|\|fffd|[|fffd|g|fffd||fffd||fffd||102||fffd||fffd||702||fffd|", "", "")
    With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
        '|fffd|Z|fffd||fffd||fffd||348||fffd|"A2:G|fffd||fffd||317|L|fffd||fffd||fffd||20d||14f|I|fffd|s|fffd||702||fffd|"|fffd||fffd|A1|fffd||fffd||fffd|L|fffd|[|fffd||242||fffd||fffd||10f||fffd||fffd||fffd||fffd||243|\|fffd|[|fffd|g
        .Range(.Range("A2"), .Range("H" & (resultLine - 1))).Sort _
        Key1:=.Range("A1"), order1:=xlAscending, _
        Key2:=.Range("B1"), order1:=xlAscending
    End With
    
    '-----------------------------------------------
    ' |fffd||693||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd|O|fffd||fffd||fffd|R|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||95|t|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '-----------------------------------------------
    For i = 1 To resultLine + 1
        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
            If (.Cells(i, 8).PrefixCharacter = "'") Then
                .Cells(i, 8).Value = "''" & .Cells(i, 8).Value
            End If
        End With
    Next
    
    '-----------------------------------------------
    ' |fffd||33c8||fffd||fffd|
    '-----------------------------------------------
    With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
        .Range(Cells(1, 1), Cells(1, 50)).Borders(xlEdgeBottom).LineStyle = xlDouble
        For i = 2 To resultLine - 1
            If (.Range("A" & i).Value <> .Range("A" & i + 1).Value) Then
                .Range(Cells(i, 1), Cells(i, 50)).Borders(xlEdgeBottom).LineStyle = xlContinuous
            End If
            If (i Mod 100 = 0) Then
                DoEvents
                Call setProgress(progressCnt, "|fffd|\|fffd||249||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||682||fffd||fffd||102||fffd||fffd||702||fffd|", "", "")
            End If
        Next
    End With
        
    With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
        If (resultLine < 32700) Then '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||a347||fffd||357||fffd||fffd|autofit|fffd||fffd||fffd||fffd||fffd||202||fffd|
            '|fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd|E|fffd||249||fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
            
            .Columns("A:G").AutoFit
            '|fffd||fffd||315||fffd||fffd||fffd|50|fffd||702||142||250||fffd||fffd||fffd|
            For i = 1 To 7 ' A|fffd||42a42||fffd|G|fffd||fffd|
                DoEvents
                If (.Columns(i).ColumnWidth > 50) Then
                    .Columns(i).ColumnWidth = 50
                End If
            Next
        Else
            .Columns("A").ColumnWidth = 8
            .Columns("B").ColumnWidth = 20
            .Columns("C").ColumnWidth = 50
            .Columns("D").ColumnWidth = 50
            .Columns("E").ColumnWidth = 22
            .Columns("F").ColumnWidth = 8
            .Columns("G").ColumnWidth = 15
        End If
         '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14f|I|fffd|s|fffd||24c||fffd||fffd||282||fffd||fffd|o|fffd||fffd|
        .Range("A" & resultLine) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||14e|w|fffd||80b5||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd||fffd|B "
        .Range("A" & resultLine).Font.Bold = True
        .Range("A" & resultLine).Font.Color = RGB(0, 160, 60)
        '|fffd|J|fffd|[|fffd|\|fffd||fffd||fffd||fffd|A1|fffd||256||7c2||fffd|
        .Range("C2").Activate
        '|fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Not .AutoFilterMode Then .Range("A1").AutoFilter
        '|fffd|s|fffd||fffd|AutoFit|fffd||fffd||fffd||fffd|
        .Rows(1 & ":" & resultLine).AutoFit
    End With
    
    '|fffd||a39e||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||d3dc|
    Application.DisplayAlerts = False
    Workbooks(myVbaWorkBookName).Sheets(TempSheetName).Delete
    Application.DisplayAlerts = True
    
    Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Activate
    '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[Form|fffd||fffd||82||fffd||fffd||fffd|
    Unload UserForm1
    '|fffd|}|fffd|E|fffd|X|fffd|J|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||256||7c2||fffd|
    Application.Cursor = xlDefault
    Application.EnableEvents = True
    Application.FindFormat.Clear '|fffd||fffd||fffd||fffd||fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
    Application.Cursor = xlDefault  '|fffd||fffd||fffd||fffd||fffd|v|fffd|\|fffd||fffd||fffd||fffd||7c2||fffd|
    finishTime = Timer '|fffd|I|fffd||fffd||fffd||fffd||fffd||502||30e||64fe|
    Call logRec '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||58b|L|fffd|^
End Sub

'---------------------------------------------------------------------
' [Word,Excel,PowerPoint|fffd|p]|fffd|z|fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|
'---------------------------------------------------------------------
Private Sub makeFileList(path As String, filetype As String, fileExtension As String)
    Dim buf As String, f As Object
    Dim DirectoryExist As String '|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd|ATrue
        
    DirectoryExist = Dir(path, vbDirectory)
    DoEvents
    Call setProgress(1, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||64fe||fffd||fffd|:" & path, "", "")
    '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd|s|fffd||82||303|t|fffd|@|fffd|C|fffd||fffd||fffd||302||fffd||fffd||7c2||243|t|fffd|@|fffd|C|fffd||fffd||fffd||311||fffd||fffd||742||fffd||fffd|m|fffd|F|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||383||fffd||fffd|X|fffd|g|fffd||252||1c9||fffd|
    If DirectoryExist <> "" Then
        On Error GoTo dirError  '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd||242||202||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||382||fffd|(dirError|fffd||fffd|)
        buf = Dir(path & "\*." & fileExtension & "?") '|fffd|w|fffd||80b5||fffd||fffd||fffd|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd||fffd||30a|e|fffd|g|fffd||fffd||fffd|q|fffd|p|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|buf|fffd||253||fffd||fffd||fffd||fffd|
        Do While buf <> "" 'buf|fffd||fffd||fffd||fffd||242||202||fffd||702||14e||fffd||fffd|s
            DoEvents
            If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
            End If
            Call setProgress(1, "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||64fe||fffd||fffd|:" & buf, "", "")
            If myVbaWorkBookName <> buf Then '|fffd||fffd||fffd||fffd|VBA|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                If ((filetype = "doc")) Then
                    ReDim Preserve wordFileList(wcnt + 1) '|fffd|z|fffd||fffd||fffd||fffd||112||fffd|`(1|fffd||fffd||fffd|Z)
                    wordFileList(wcnt).dirPath = path  ' |fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    wordFileList(wcnt).FileName = buf  ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    wcnt = wcnt + 1
                ElseIf ((filetype = "xls") Or (filetype = "xls")) Then
                    ReDim Preserve excelFileList(xcnt + 1)
                    excelFileList(xcnt).dirPath = path '|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    excelFileList(xcnt).FileName = buf  '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    xcnt = xcnt + 1
                ElseIf (filetype = "ppt") Then
                    ReDim Preserve pptFileList(pptcnt + 1)
                    pptFileList(pptcnt).dirPath = path '|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    pptFileList(pptcnt).FileName = buf  '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    pptcnt = pptcnt + 1
                End If
            End If
            buf = Dir()
        Loop
        With CreateObject("Scripting.FileSystemObject") '|fffd||10b|N|fffd||102||44f|o|fffd||fffd||fffd||242||fffd||fffd||149||fffd||fffd||283|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd||fffd||702||14e||fffd||fffd|s
            For Each f In .GetFolder(path).SubFolders
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                Call makeFileList(f.path, filetype, fileExtension)
            Next f
        End With
    End If
    Exit Sub
    '-----------------------------
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    '-----------------------------
dirError:
End Sub

'---------------------------------------------------------------------
' [Word|fffd|p]|fffd|w|fffd||80b3||fffd||a0bd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
'---------------------------------------------------------------------
Private Sub SearchFromWordFile(inPathName As String, inFileName As String, AbsPath As String, RelPath As String)
    Dim wordFile As String 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim i As Long, k As Long, m As Long, maxRow As Long '|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p
    Dim page As Long, line As Long ' |fffd|y|fffd|[|fffd|W|fffd|A|fffd|s
    Dim linkLine As String   '|fffd||fffd||fffd||fffd||fffd|N|fffd||303|y|fffd|[|fffd|W|fffd|\|fffd||fffd|
    Dim linkPage As Long
    Dim wordPageNum As Long '|fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim tmpStr As String '|fffd||a39e||fffd|I|fffd|I|fffd||215||fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd|p
    Dim searchWord As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim notJustNumber As Boolean '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
    Dim skipFlag As Boolean 'Ture|fffd||30e||fffd||fffd||243|X|fffd|L|fffd|b|fffd|v
    Dim outlineWord As String 'getOutlineWord|fffd||590||fffd||fffd||242||fffd||fffd||fffd||10f|o|fffd||342||fffd||fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|
    Dim findTextFlag As Boolean '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||90a9||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim oldAddress As String '2|fffd||53bc2||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
    
    Dim wildcardOn As Boolean '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|,True
    Dim wildcardWords() As String '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14b||fffd||602||fffd||a0bd||fffd||fffd||fffd|[|fffd|h
    Dim wcWordMatch As Boolean '|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||fffd||fffd||fffd||fffd||243|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd|,True
    Dim wcWordTop2End As String '|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
       
    wordFile = inPathName & "\" & inFileName    'Open|fffd||fffd||fffd||fffd|Word|fffd||fffd||fffd||fffd||327||fffd||656||fffd||fffd||fffd||fffd||7fd||fffd||fffd||fffd|t|fffd||fffd||fffd||153||fffd||fffd||fffd||fffd|

    '|fffd|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd|Path|fffd||fffd||fffd||744a||fffd||383|p|fffd|X|fffd||255||3c2||fffd||fffd||fffd|
    Dim inPathNameRel As String
    inPathNameRel = Replace(inPathName, AbsPath, RelPath, compare:=1) 'vbTextCompare=1(|fffd||5576||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||202||fffd|)
    
    '|fffd||14f|I|fffd|s|fffd||fffd||fffd|m|fffd|F
    maxRow = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & Rows.Count).End(xlUp).Row
    
    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    Dim logok As Boolean
    'logok = GetOutlineList_MoveDownType(wordFile)
    logok = GetOutlineList_FindType(wordFile, inFileName)
    '|fffd||fffd||fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||64fe||fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||1c2||74e||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||348||20d|~|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd|
    If (logok <> True) Then
        Exit Sub
    End If
    
    'Word|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Application.ScreenUpdating = False '|fffd|`|fffd||fffd|OFF
    Application.DisplayAlerts = False '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd||a39e||fffd|I|fffd||252||fffd|~
    'wdObj.Visible = False '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
    wdObj.Visible = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd|
    On Error GoTo fopenError  '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd||242||202||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||382||fffd|(fopenError|fffd||fffd|)
    wdObj.Documents.Open (wordFile), ReadOnly:=True 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74f|o|fffd||fffd||fffd||fffd|p|fffd||14a|J|fffd||fffd|
    wdObj.ActiveWindow.View.Type = 3 'wdPrintView(=3). office2010|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|p|fffd||24b|L|fffd||fffd|
    wdObj.WindowState = 2 'wdWindowStateMinimize(=2).|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||14f||fffd||fffd||fffd|
    
    'Excel2013|fffd||30f||a347||fffd||355|`|fffd||fffd||fffd|ON|fffd||fffd||fffd||202||fffd||fffd||18b||252|[|fffd||252|x|fffd||fffd||fffd||202||90bd||fffd||fffd|ON|fffd||fffd||fffd||fffd||fffd||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True '|fffd|`|fffd||fffd|ON
    
    'Page|fffd||fffd||fffd||fffd||fffd||64fe|
    wordPageNum = wdObj.ActiveDocument.Range.Information(3) ' wdActiveEndPageNumber(=3)
    wdObj.Selection.HomeKey Unit:=6 'wdStory(=6).|fffd||fffd||fffd||fffd||fffd||310||64ea||fffd||248||693||fffd|
    wdObj.Selection.HomeKey '|fffd|s|fffd||310||64ea||fffd||588||693||fffd|

    With wdObj
        For i = 1 To maxRow '|fffd||fffd||fffd||fffd||fffd||a30b||fffd||283|V|fffd|[|fffd|g|fffd||fffd|1|fffd|s|fffd||682||fffd||fffd||fffd||14f|I|fffd|s|fffd||312|P|fffd||fffd||fffd||fffd||fffd||fffd||24c||fffd||fffd||fffd|
            DoEvents
            If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                wdObj.Documents.Close savechanges:=False
                wdObj.Quit
                Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
            End If
            
            '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
            Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Word", "")
                        
            .Selection.Find.ClearFormatting '|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A
            .Selection.HomeKey Unit:=6 'wdStory(=6).|fffd||fffd||fffd||fffd||fffd||310||64ea||fffd||248||693||fffd|
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|
            searchWord = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & i)
            '|fffd||fffd||fffd||fffd|searchWord|fffd||fffd||fffd||fffd||30f||a347||fffd||34e||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            If (searchWord = "") Then
                GoTo NextSearchOfWord
            End If
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||702||fffd||142||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
            Erase wildcardWords
            wildcardOn = False
            If (InStr(searchWord, "*") > 0) Then
                wildcardOn = True
                wildcardWords = Split(searchWord, "*")
                For m = 0 To UBound(wildcardWords)
                    If (wildcardWords(m) <> "") Then
                        searchWord = wildcardWords(m)
                        Exit For
                    End If
                Next
            End If
            
            .Selection.Find.Text = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|
            .Selection.Find.Forward = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||24e|w|fffd||fffd|
            .Selection.Find.MatchCase = chkeckBox1Val 'True|fffd||30f||a347||fffd|A|fffd||5576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd|
            
            Dim oneLine     As String  '|fffd||fffd||fffd||fffd||fffd||243|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|P|fffd|s|fffd||315||fffd||fffd||fffd||fffd||fffd|
            Dim oneLineOldList() As String    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|P|fffd|s|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||6ce||fffd|
            Dim oneLineOldList_cnt As Long
            Dim oldCellPosition As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||153||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|2|fffd||fffd||20f||331f||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||4cf||fffd||fffd||356||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||302||fffd||fffd||7c2||30b|L|fffd|^|fffd|p|fffd|B
            
            oneLineOldList_cnt = 0 '|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A
            Erase oneLineOldList '|fffd|z|fffd||fffd||303|N|fffd||fffd||fffd|A
            page = 0 '|fffd|y|fffd|[|fffd|W|fffd||fffd|0|fffd||243|N|fffd||fffd||fffd|A
            oldAddress = ""
            oldCellPosition = "" '|fffd|N|fffd||fffd||fffd|A
            
            '-----------------------------
            ' |fffd||28f||fffd||315||fffd||fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd|
            '-----------------------------
            Do While .Selection.Find.Execute '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||702||14e||fffd||fffd|s
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    'Word|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                    wdObj.Documents.Close savechanges:=False
                    wdObj.Quit
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                
                '|fffd|i|fffd||fffd||fffd|A|fffd|s|fffd|[|fffd||fffd|
                Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Word", "")
                
                Dim thisIsTable As Boolean
                thisIsTable = False
                With .Selection
                    '|fffd|y|fffd|[|fffd|W|fffd|A|fffd|s|fffd|A|fffd||fffd||fffd||fffd||fffd|N|fffd|p|fffd||303|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||64fe||fffd|i|fffd|s|fffd|A|fffd|\|fffd||fffd||fffd||308||292|u|fffd|j
                    If .Information(12) = True Then 'wdWithInTable(=12).|fffd|\|fffd||30f||a347|
                        page = .Tables(1).Cell(1, 1).Range.Information(1) 'wdActiveEndAdjustedPageNumber(=1)
                        line = .Tables(1).Range.Information(10) ' wdFirstCharacterLineNumber(=10).|fffd|\|fffd||356||68e||fffd||fffd||314||fffd||fffd||80a9||fffd||fffd||34f||fffd||fffd|O
                        linkLine = .Tables(1).Range.Information(10) & "(|fffd|\[" & .Information(13) & "," & .Information(16) & "])"
                        thisIsTable = True
                    Else '|fffd|\|fffd||142||202||fffd||fffd||a347|
                        page = .Range.Information(3) 'wdActiveEndPageNumber(=3)
                        line = .Range.Information(10) 'wdFirstCharacterLineNumber(=10)
                        linkLine = line
                        '|fffd||fffd||50d||14c||fffd||30d|s|fffd||143||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||311||38d||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||352|E|fffd|o|fffd||fffd||fffd||fffd|
                        If (oldAddress = (page & "-" & line)) Then
                            GoTo ContinueFindWord '|fffd||fffd||fffd|A|fffd||fffd||fffd||153||fffd||fffd||fffd||fffd||a3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
                        End If
                    End If
                    
                    oldAddress = page & "-" & line
                    
                    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||30b|L|fffd||682||fffd||fffd||64fe|
                    outlineWord = getOutlineWord(page, line)
                                          
                    If wdObj.Selection.Information(12) = True Then 'wdWithInTable(=12).|fffd|\|fffd||30f||a347|
                        '|fffd|s|fffd|A|fffd||fffd||fffd||fffd||64fe|.|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||312|l|fffd||fffd||fffd||64fe|
                        Dim arrayRow As Long
                        Dim arrayClm As Long
                        arrayRow = wdObj.Selection.Information(13) 'wdStartOfRangeRowNumber(=13)
                        arrayClm = wdObj.Selection.Information(16) 'wdStartOfRangeColumnNumber(=16)
                        oneLine = wdObj.Selection.Tables(1).Cell(arrayRow, arrayClm).Range.Text
                        '|fffd||14c||fffd||309||fffd||fffd|s|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||d3dc|
                        oneLine = Replace(oneLine, Chr(13) & Chr(7), "")
                    Else '|fffd|\|fffd||142||202||fffd||fffd||a347|
                        '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||313||fffd||fffd|e|fffd||fffd||fffd||64fe|
                        wdObj.Selection.EndKey Unit:=5, Extend:=0 'wdLine(5), wdMove(=0).|fffd|I|fffd||fffd||fffd|s|fffd||30d||14f|I|fffd||fffd|
                        wdObj.Selection.HomeKey Unit:=5, Extend:=1  'wdLine(5),wdExtend(=1).|fffd|I|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||310||64ea||fffd||fffd|
                        oneLine = wdObj.Selection
                        
                        '|fffd||68e||fffd||fffd||302|P|fffd|s|fffd||682||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|s|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||196||68e||fffd||fffd|S|fffd||302||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||7c1|A
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd|s|fffd||310||64ea||fffd||256||7c2||fffd|B|fffd|i|fffd||fffd||fffd||30d|s|fffd||582||308||693||fffd||fffd||355||293|r|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||248||693||fffd||fffd|v|fffd||242||10d|s|fffd||fffd||fffd|j
                        '|fffd||702||fffd||fffd|A|fffd||fffd||fffd||30d||6c2||fffd|oneLine|fffd||242||342|P|fffd|s|fffd||682||315||fffd||fffd||fffd||fffd||fffd||302||753||fffd||fffd||fffd||fffd|
                        Dim firstLineCharNum As Long
                        firstLineCharNum = InStr(oneLine, Chr(13))
                        If (firstLineCharNum > 0) Then
                            wdObj.Selection.HomeKey Unit:=5, Extend:=0  '|fffd||fffd|U|fffd||64ea||fffd|s|fffd||256||7c2||fffd|
                            oneLine = Left(oneLine, firstLineCharNum)
                        End If
                        
                    End If
                                                            
                    '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                    wcWordMatch = False
                    If (wildcardOn = True) Then
                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    Else
                        notJustNumber = justNumCheck(oneLine, .Find.Text) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    End If
                                                                                
                    skipFlag = False
                    If ((wildcardOn = True) And (wcWordMatch = False)) Then
                        skipFlag = True
                    ElseIf (wdObj.Selection.Information(12) = True) And (oldCellPosition = linkLine) Then
                        '|fffd|uwdWithInTable(=12).|fffd|\|fffd||30f||a347||fffd|v|fffd||fffd||fffd||81|u|fffd|O|fffd||fffd||193||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||30f||a347||fffd|A|fffd|X|fffd|L|fffd|b|fffd|v
                        skipFlag = True
                    ElseIf (chkeckBox2Val = True) Then
                        'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                        skipFlag = notJustNumber
                    End If
                    
                    If (wdObj.Selection.Information(12) = True) Then '|fffd|O|fffd||fffd||315|\|fffd||303|Z|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd||64fe|
                        oldCellPosition = linkLine
                    End If
                    
                    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||311|O|fffd||fffd||302||1c2||fffd||fffd||70a9||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||730b||fffd||282||fffd||fffd||73dc||fffd|O|fffd|v
                    If (skipFlag = False) Then
                        If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
                            Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Else
                            Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("B" & resultLine) = .Find.Text '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        End If
                        
                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                            '.Range("B" & resultLine) = .Find.Text'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                            .Range("D" & resultLine).Interior.Color = RGB(184, 204, 228) 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            .Range("E" & resultLine) = outlineWord '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                            .Range("F" & resultLine) = page 'Page
                            
                            'F|fffd||fffd||243||fffd||fffd||fffd||fffd|N|fffd|t|fffd||fffd||fffd||30d|s/|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|.
                            ' |fffd|@|fffd||fffd||fffd||fffd||fffd||243|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302|P|fffd|s|fffd||313||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4cf||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||14f||fffd||fffd||30d|s|fffd||302||74a|Y|fffd||fffd||fffd||4cf||fffd||fffd||583||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
                            ' |fffd|@|fffd||fffd||fffd||fffd||20a|O|fffd||355||fffd||fffd||fffd||fffd||310||64ea||fffd||583||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd|B
                            Dim fileLink As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|e
                            Dim detailLinkOn As Boolean '|fffd||68d||5c3||fffd||fffd||fffd||fffd|NON
                            detailLinkOn = True
                            
                            ReDim Preserve oneLineOldList(oneLineOldList_cnt + 1) '|fffd|z|fffd||fffd|T|fffd|C|fffd|Y|fffd||112||fffd|`(1|fffd||fffd||fffd|Z)
    
                            '|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34f||68d||5c3||fffd||fffd||fffd||fffd|NOFF
                            For m = 0 To oneLineOldList_cnt
                                DoEvents
                                If (InStr(1, oneLineOldList(m), oneLine, vbTextCompare) > 0) Then
                                    detailLinkOn = False
                                    Exit For
                                End If
                            Next
                                
                            If detailLinkOn = True Then '|fffd|Y|fffd||fffd||fffd||4cf||fffd||fffd||583||fffd||fffd||fffd||fffd|N
                                '|fffd||fffd||fffd||fffd||fffd|N|fffd||24e|g|fffd|p|fffd||fffd||fffd||fffd||931f||fffd||fffd||fffd||fffd||fffd||fffd|textLimtForLink|fffd||14e|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24c||fffd||fffd||80b7||fffd||fffd|
                                tmpStr = Left(oneLine, textLimtForLink)
                                fileLink = inPathNameRel & "\" & inFileName & "#" & tmpStr
                                .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, _
                                     TextToDisplay:="" & linkLine
                            Else '|fffd|y|fffd|[|fffd|W|fffd||64ea||fffd||583||fffd||fffd||fffd||fffd|N
                                fileLink = inPathNameRel & "\" & inFileName
                                .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, _
                                    TextToDisplay:="" & linkLine
                                .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                            End If
                            
                            If (thisIsTable = True) Then '|fffd|\|fffd||30f||a347||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g
                                .Range("G" & resultLine).AddComment "|fffd|y|fffd|[|fffd|W(|fffd|\[|fffd|s,|fffd||fffd|])"
                                .Range("G" & resultLine).Comment.Shape.Height = 12
                            End If
                            
                            .Range("H" & resultLine) = oneLine '1|fffd|s|fffd||313||fffd||fffd|e
                        
                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                            If (notJustNumber) Then
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 25
                            End If
                        End With
                        resultLine = resultLine + 1
                    End If 'If (skipFlag = False)
                    
                    ReDim Preserve oneLineOldList(oneLineOldList_cnt + 1)
                    oneLineOldList(oneLineOldList_cnt) = oneLine
                    oneLineOldList_cnt = oneLineOldList_cnt + 1
                                        
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||248||693||fffd|
                    If wdObj.Selection.Information(12) = True Then 'wdWithInTable(=12).|fffd|\|fffd||30f||a347|
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                        'wdObj.Selection.EndKey , Extend:=0 'wdMove(=0)
                    Else '|fffd|\|fffd||142||202||fffd||fffd||a347|
                        wdObj.Selection.EndKey , Extend:=0 'wdMove(=0)
                        wdObj.Selection.MoveDown , Extend:=0 'wdMove(=0)
                        wdObj.Selection.HomeKey , Extend:=0 'wdMove(=0)
                        '|fffd||fffd||50d||14c||fffd||30d|s|fffd||143||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||311||38d||fffd||355||293|r|fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd|
                    End If
                End With
            Loop 'Do While .Selection.Find.Execute
ContinueFindWord:
            '-----------------------------
            ' |fffd|}|fffd|`|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd|
            '-----------------------------
            Dim shapeCount As Long
            Dim sh As Object
            For Each sh In wdObj.ActiveDocument.Shapes
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    wdObj.Documents.Close savechanges:=False '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                    wdObj.Quit 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                
                '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
                Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Word", "")
                
                If (sh.Type = 6) Then 'msoGroup(=6)
                    For k = 1 To sh.GroupItems.Count
                        DoEvents
                        If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                            wdObj.Documents.Close savechanges:=False '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                            wdObj.Quit 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                            Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                        End If
                                                        
                        On Error Resume Next '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|V|fffd|F|fffd|C|fffd|v|fffd||30f||a347||fffd||311||38d||fffd|
                        If Not (Len(sh.GroupItems(k).TextFrame.TextRange.Text) > 0) Then
                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                        Else
                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||42a91||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F
                            oneLine = sh.GroupItems(k).TextFrame.TextRange.Text
                            findTextFlag = justTextCheck(oneLine, searchWord)
                            If (findTextFlag) Then
                                
                                '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                                wcWordMatch = False
                                If (wildcardOn = True) Then
                                    'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                    Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                                    notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                Else
                                    notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                End If
                                
                                'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                                skipFlag = False
                                If (wildcardOn = True) And (wcWordMatch = False) Then
                                    skipFlag = True
                                ElseIf (chkeckBox2Val = True) Then
                                    skipFlag = notJustNumber
                                End If
                                        
                                If (skipFlag = False) Then
                                    With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                        page = sh.Anchor.Information(3) 'wdActiveEndPageNumber(=3)
                                        line = sh.Anchor.Information(10) 'wdFirstCharacterLineNumber(=10)
                                        outlineWord = getOutlineWord(page, line)
                            
                                        .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                        
                                        If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
                                           .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                        Else
                                           .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                        End If
                                        
                                       .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                        .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                        .Range("D" & resultLine).Interior.Color = RGB(184, 204, 228) 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                        .Range("E" & resultLine) = outlineWord '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                                        .Range("F" & resultLine) = page 'Page
                                        .Range("H" & resultLine) = sh.GroupItems(k).TextFrame.TextRange.Text
                                        
                                        fileLink = inPathNameRel & "\" & inFileName
                                        .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, _
                                            TextToDisplay:="" & line & "(|fffd|}|fffd|`)"
                                        .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                                        
                                        '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                        If (notJustNumber) Then
                                            .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                            .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                            .Range("H" & resultLine).Comment.Shape.Height = 25
                                        End If
                                        
                                        resultLine = resultLine + 1
                                    End With
                                End If
                            End If
                        End If
                    Next
                Else
                    On Error Resume Next '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|V|fffd|F|fffd|C|fffd|v|fffd||30f||a347||fffd||311||38d||fffd|
                    If Not (Len(sh.TextFrame.TextRange.Text) > 0) Then
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                    Else
                        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||42a91||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F
                        oneLine = sh.TextFrame.TextRange.Text
                        findTextFlag = justTextCheck(oneLine, searchWord)
                        If (findTextFlag) Then
                            
                            '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                            wcWordMatch = False
                            If (wildcardOn = True) Then
                                'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                                notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            Else
                                notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            End If
                            
                            'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                            skipFlag = False
                            If (wildcardOn = True) And (wcWordMatch = False) Then
                                skipFlag = True
                            ElseIf (chkeckBox2Val = True) Then
                                skipFlag = notJustNumber
                            End If
                            
                            If (skipFlag = False) Then
                                With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                    page = sh.Anchor.Information(3) 'wdActiveEndPageNumber(=3)
                                    line = sh.Anchor.Information(10) 'wdFirstCharacterLineNumber(=10)
                                    outlineWord = getOutlineWord(page, line)
                                                                
                                    .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                    
                                    If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
                                       .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    Else
                                       .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    End If
                                    
                                    .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                    .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                    .Range("D" & resultLine).Interior.Color = RGB(184, 204, 228) 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                    .Range("E" & resultLine) = outlineWord '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                                    .Range("F" & resultLine) = page 'Page
                                    .Range("H" & resultLine) = sh.TextFrame.TextRange.Text
                                    
                                    fileLink = inPathNameRel & "\" & inFileName
                                    .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, _
                                        TextToDisplay:="" & line & "(|fffd|}|fffd|`)"
                                    .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                                    
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                    If (notJustNumber) Then
                                        .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                        .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                        .Range("H" & resultLine).Comment.Shape.Height = 25
                                    End If
                                    
                                    resultLine = resultLine + 1
                                End With
                            End If
                        End If
                    End If
                End If
            Next

            '-----------------------------
            ' |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd|
            '-----------------------------
            Debug.Print "A"
            Dim mycomment As Object
            For Each mycomment In wdObj.ActiveDocument.Comments
                '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                oneLine = mycomment.Range.Text
                findTextFlag = justTextCheck(oneLine, searchWord)
                If (findTextFlag) Then
                    wcWordMatch = False
                    page = mycomment.Scope.Information(3)  'wdActiveEndPageNumber(=3)
                    line = mycomment.Scope.Information(10) 'wdFirstCharacterLineNumber(=10).|fffd||fffd||fffd||742||30d|s|fffd||fffd||fffd||fffd||fffd||64fe|
                    outlineWord = getOutlineWord(page, line)
                    
                    If (wildcardOn = True) Then
                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    Else
                        notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    End If
    
                    skipFlag = False
                    If ((wildcardOn = True) And (wcWordMatch = False)) Then
                        skipFlag = True
                    ElseIf (chkeckBox2Val = True) Then
                        'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                        skipFlag = notJustNumber
                    End If
                    
                    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||311|O|fffd||fffd||302||1c2||fffd||fffd||70a9||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||730b||fffd||282||fffd||fffd||73dc||fffd|O|fffd|v
                    If (skipFlag = False) Then
                        If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
                            Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Else
                            Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        End If
                        
                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                            .Range("D" & resultLine).Interior.Color = RGB(184, 204, 228) 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            .Range("E" & resultLine) = outlineWord '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                            .Range("F" & resultLine) = page
                            
                            detailLinkOn = False
                            fileLink = inPathNameRel & "\" & inFileName
                           .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, _
                                TextToDisplay:="" & line & "(|fffd|R|fffd||fffd||fffd||fffd||fffd|g)"
                            .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                            .Range("H" & resultLine) = oneLine & " [|fffd||38f||6d5||fffd|:" & mycomment.Scope.Text & "]" '1|fffd|s|fffd||313||fffd||fffd|e
                        
                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                            If (notJustNumber) Then
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 25
                            End If
                        End With
                        resultLine = resultLine + 1
                    End If 'If (skipFlag = False)
                End If 'If (findTextFlag)
            Next 'For Each mycomment
    
NextSearchOfWord:
        Next 'For i = 1 To maxRow
    End With
    
    ' Word|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|i|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||355||82||fffd||fffd||202||fffd||fffd|j
    wdObj.Documents.Close savechanges:=False '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    Application.ScreenUpdating = True '|fffd||fffd||282||315|`|fffd||fffd|X|fffd|V|fffd||10a|J
    Application.DisplayAlerts = True '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||292|m|fffd||fffd||fffd||94|\|fffd||fffd|
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||308||fffd||50d||150|V|fffd||30d|s|fffd||248||693||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||313|r|fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|)
    If (Selection.Address <> "C" & resultLine) Then
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C" & resultLine).Activate
    End If
    
    Exit Sub
    '-----------------------------
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    '-----------------------------
fopenError:
    Application.ScreenUpdating = True '|fffd||fffd||282||315|`|fffd||fffd|X|fffd|V|fffd||10a|J
    Application.DisplayAlerts = True '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||292|m|fffd||fffd||fffd||94|\|fffd||fffd|
    ReDim Preserve errorLog(errorLogCnt + 1) '|fffd|z|fffd||fffd||fffd|`|fffd||fffd||fffd||112||fffd|`(1|fffd||fffd||fffd|Z)
    errorLog(errorLogCnt).filePath = wordFile '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|)
    errorLog(errorLogCnt).errorNum = Err.Number '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|)
    errorLog(errorLogCnt).errorContent = Err.Description '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e)
    errorLogCnt = errorLogCnt + 1
    Err.Clear '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A
End Sub

'---------------------------------------------------------------------
' [Word|fffd|p]|fffd|w|fffd||80b3||fffd||a0bd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||316||68e||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|z|fffd||fffd||24f|o|fffd||342||fffd||fffd||fffd|(Find|fffd||fffd|)
'---------------------------------------------------------------------
Function GetOutlineList_FindType(wordFile As String, inFile As String) As Boolean
    Dim styleName As String '|fffd|X|fffd|^|fffd|C|fffd||fffd||fffd||fffd|
    Dim i As Long '|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p
    Dim Worddoc As Object 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim wordPageNum As Long '|fffd||fffd||fffd||fffd||fffd||311||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim oldAddress As String '2|fffd||53bc2||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
    
    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Erase outlineList
    
    Application.ScreenUpdating = False '|fffd|`|fffd||fffd|OFF
    Application.DisplayAlerts = False '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd||a39e||fffd|I|fffd||252||fffd|~
    'wdObj.Visible = False '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
    wdObj.Visible = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd|
    'Word|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    On Error GoTo fopenError  '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd||242||202||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||382||fffd|(fopenError|fffd||fffd|)
    wdObj.Documents.Open (wordFile), ReadOnly:=True 'Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1cf|o|fffd||fffd||fffd||302||742||14a|J|fffd||fffd|
    wdObj.ActiveWindow.View.Type = 3 'wdPrintView(=3). office2010|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|p|fffd||24b|L|fffd||fffd|
    wdObj.WindowState = 2 'wdWindowStateMinimize(=2).|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||14f||fffd||fffd||fffd|
    'Excel2013|fffd||30f||a347||fffd||355|`|fffd||fffd||fffd|ON|fffd||fffd||fffd||202||fffd||fffd||18b||252|[|fffd||252|x|fffd||fffd||fffd||202||90bd||fffd||fffd|ON|fffd||fffd||fffd||fffd||fffd||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True '|fffd|`|fffd||fffd|ON
    
    'Page|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd|J|fffd||fffd||fffd||602||fffd||fffd||fffd||fffd||7329||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|B
    wordPageNum = wdObj.ActiveDocument.Range.Information(3) 'wdActiveEndPageNumber(=3)
    wdObj.Selection.HomeKey Unit:=6 'wdStory(=6).|fffd||fffd||fffd||fffd||fffd||310||64ea||fffd||588||693||fffd|
    wdObj.Selection.HomeKey '|fffd||64ea||fffd|s|fffd||588||693||fffd|

    outlineCnt = 0

    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||c42c|("|fffd||fffd||fffd|o|fffd||fffd| 1"|fffd|`"|fffd||fffd||fffd|o|fffd||fffd| 9"
    Dim StyleList(9) As String
    Dim ocnt As Long
    For ocnt = 1 To 9
        DoEvents
        StyleList(ocnt) = "|fffd||fffd||fffd|o|fffd||fffd| " & ocnt
    Next

    With wdObj
        Dim outlineLevel As Long '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|
        For outlineLevel = 1 To 9
            DoEvents
            .Selection.Find.ClearFormatting '|fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A
            .Selection.HomeKey Unit:=6 'wdStory(=6).|fffd||fffd||fffd||fffd||fffd||310||64ea||fffd||588||693||fffd|
            
            '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
            Call setProgress(progressCnt, inFile & "|fffd||fffd||fffd||30c||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd|(" & outlineLevel & "/9" & ")", "Word", "")
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|
            On Error GoTo closeWord_OutlineSearch
            .Selection.Find.Style = StyleList(outlineLevel) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|

            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
            .Selection.Find.Forward = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||24e|w|fffd||fffd|
            
            Dim page As Long, line As Long '|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd|A|fffd|s|fffd||fffd|
            page = 0 '|fffd||fffd||fffd||fffd||fffd||fffd|
            line = 0 '|fffd||fffd||fffd||fffd||fffd||fffd|
            oldAddress = "" '|fffd||fffd||fffd||fffd||fffd||fffd|

            Do While .Selection.Find.Execute '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||702||14e||fffd||fffd|s
                Dim indexContent As String
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    wdObj.Documents.Close savechanges:=False '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                    wdObj.Quit 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                    GetOutlineList_FindType = True '|fffd||28f||fffd|I|fffd||fffd|(True)|fffd||fffd||502||fffd|
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                                
                '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
                Call setProgress(progressCnt, inFile & "|fffd||fffd||fffd||30c||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd|(" & outlineLevel & "/9" & ")", "Word", "")
                                
                'wdActiveEndPageNumber(=3)
                page = .Selection.Range.Information(3) 'wdActiveEndPageNumber(=3).|fffd||fffd||fffd||742||303|y|fffd|[|fffd|W|fffd||fffd||fffd||64fe|
                line = .Selection.Range.Information(10) 'wdFirstCharacterLineNumber(=10).|fffd||fffd||fffd||742||30d|s|fffd||fffd||fffd||fffd||fffd||64fe|
                '|fffd||fffd||50d||14c||fffd||30d|s|fffd||143||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||311||38d||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||352|E|fffd|o|fffd||fffd||fffd||fffd|
                If (oldAddress = (page & "-" & line)) Then
                    GoTo ContinueFindWord2 '|fffd||fffd||fffd|A|fffd||fffd||fffd||153||fffd||fffd||fffd||fffd||a3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
                End If
                oldAddress = page & "-" & line
                
                With .Selection.Paragraphs(1).Range '|fffd||fffd||fffd|o|fffd||fffd||fffd||30d||14f||fffd||282||fffd||fffd||fffd||149||fffd||fffd||282||702||142||fffd||fffd||702||182||7c2||fffd|
                    indexContent = .ListFormat.ListString & " " & .Text
                End With
                ReDim Preserve outlineList(outlineCnt + 1) '|fffd|z|fffd||fffd||fffd|`|fffd||fffd||fffd||112||fffd|`(1|fffd||fffd||fffd|Z)
                outlineList(outlineCnt).outlineLevel = outlineLevel '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|
                outlineList(outlineCnt).page = page '|fffd|y|fffd|[|fffd|W
                outlineList(outlineCnt).line = line '|fffd|s
                outlineList(outlineCnt).indexContent = indexContent '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                outlineList(outlineCnt).indexContentSignle = .Selection.Paragraphs(1).Range.Text '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd|(|fffd||14f|I|fffd||342||302||fffd|)
                outlineCnt = outlineCnt + 1
                
                .Selection.EndKey , Extend:=0  'wdMove(=0). |fffd|I|fffd||fffd||fffd|s|fffd||30d||14c||fffd||588||693||fffd|
                .Selection.MoveDown , Extend:=0 'wdMove(=0).|fffd|P|fffd||89||fffd||fffd||588||693||fffd|
                .Selection.HomeKey , Extend:=0 'wdMove(=0).|fffd||64ea||fffd|s|fffd||588||693||fffd|

            Loop
ContinueFindWord2:
        Next
    End With
    
closeWord_OutlineSearch:
    '---------------------------------------------------
    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||602||202||fffd||fffd||a347||fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd|AGetOutlineList|fffd||590||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
    '---------------------------------------------------
    If outlineCnt = 0 Then
        ' Word|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|i|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||355||82||fffd||fffd||202||fffd||fffd|j
        wdObj.Documents.Close savechanges:=False '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
        Application.ScreenUpdating = True '|fffd||fffd||282||315|`|fffd||fffd|X|fffd|V|fffd||10a|J
        Application.DisplayAlerts = True '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||292|m|fffd||fffd||fffd||94|\|fffd||fffd|
        GetOutlineList_FindType = True '|fffd||28f||fffd|I|fffd||fffd|(True)|fffd||fffd||502||fffd|
        Exit Function
    End If

    '---------------------------------------------------
    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||90bd||fffd||7c2||248||fffd|U|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
    '---------------------------------------------------
    Dim lineCnt As Long '|fffd|s|fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g|fffd|p

    '|fffd||a39e||fffd||fffd||183|V|fffd|[|fffd|g|fffd||24f||fffd||fffd||fffd||fffd||fffd|
    With Workbooks(myVbaWorkBookName).Worksheets(TempSheetName)
        .Cells.Clear
        For lineCnt = 0 To outlineCnt - 1
            DoEvents
            .Range("A" & lineCnt + 1) = outlineList(lineCnt).outlineLevel
            .Range("B" & lineCnt + 1) = outlineList(lineCnt).page
            .Range("C" & lineCnt + 1) = outlineList(lineCnt).line
            .Range("D" & lineCnt + 1) = outlineList(lineCnt).indexContent
            .Range("E" & lineCnt + 1) = outlineList(lineCnt).indexContentSignle
        Next

        '|fffd|Z|fffd||fffd||fffd||348||fffd|"A2:G|fffd||fffd||317|L|fffd||fffd||fffd||20d||14f|I|fffd|s|fffd||702||fffd|"|fffd||fffd|A1|fffd||fffd||fffd|L|fffd|[|fffd||242||fffd||fffd||10f||fffd||fffd||fffd||fffd||243|\|fffd|[|fffd|g
        .Range(.Range("A1"), .Range("H" & (outlineCnt))).Sort Key1:=.Range("B1"), Key2:=.Range("C1"), order1:=xlAscending

        'D|fffd||fffd||24f||342||30a|K|fffd|w|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
        '"maxOutlineDisp"|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|Z|fffd||fffd||fffd||fffd||fffd||fffd||151||fffd|\|fffd||fffd||fffd|K|fffd|w|fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
        Dim maxOutlineDisp As Long
        maxOutlineDisp = Workbooks(myVbaWorkBookName).Worksheets(ControlSheet).Range("maxOutlineDisp")

        For line = 1 To outlineCnt
            DoEvents
            outlineLevel = Val(.Range("A" & line)) ' A|fffd||fffd||fffd|OutlineLevel
            indexContent = .Range("D" & line) ' D|fffd||fffd||fffd|OutlineLevel(|fffd||fffd||fffd|o|fffd||fffd|)|fffd||313||fffd||fffd|e
            If outlineLevel <> 1 Then '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd| |fffd||fffd|1|fffd||30f||a347||fffd||355||48f|W|fffd||202||fffd|
                Dim pline As Long '|fffd||fffd||282||30a|K|fffd|w|fffd||12c82||5c2||90bd||fffd||7c2||303|||fffd|C|fffd||fffd||fffd|^
                pline = line

                If outlineLevel <= maxOutlineDisp Then
                    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||fffd||83ec||fffd||fffd||fffd||fffd||fffd||a347|
                    Do While pline >= 1
                        DoEvents
                        '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||50ab||fffd||fffd||fffd||a347||fffd||fffd|1|fffd||8f||fffd||282||303|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If Val(.Range("A" & pline)) < outlineLevel Then
                            .Range("D" & line) = .Range("D" & pline) & "/" & .Range("D" & line)
                            Exit Do
                        End If
                        pline = pline - 1
                    Loop
                Else
                    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||fffd||fffd||50ab||fffd||fffd||fffd||a347|
                    Do While pline >= 1
                        DoEvents
                        '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||50ab||fffd||fffd||fffd||a347||fffd||fffd|1|fffd||8f||fffd||282||303|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        If Val(.Range("A" & pline)) < maxOutlineDisp Then
                            .Range("D" & line) = .Range("D" & pline) & "..." & .Range("D" & line)
                            Exit Do
                        End If
                        pline = pline - 1
                    Loop
                End If
            End If
        Next

        '|fffd|z|fffd||fffd||256||7c2||fffd|
        For lineCnt = 0 To outlineCnt - 1
            DoEvents
            ReDim Preserve outlineList(outlineCnt + 1)
            outlineList(lineCnt).outlineLevel = .Range("A" & lineCnt + 1)
            outlineList(lineCnt).page = .Range("B" & lineCnt + 1)
            outlineList(lineCnt).line = .Range("C" & lineCnt + 1)
            outlineList(lineCnt).indexContent = .Range("D" & lineCnt + 1)
            outlineList(lineCnt).indexContentSignle = .Range("E" & lineCnt + 1)
        Next
    End With

    ' Word|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|i|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||355||82||fffd||fffd||202||fffd||fffd|j
    wdObj.Documents.Close savechanges:=False
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    GetOutlineList_FindType = True
    
    Exit Function
    '-----------------------------
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    '-----------------------------
fopenError:
    ' Word|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|i|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||355||82||fffd||fffd||202||fffd||fffd|j
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    GetOutlineList_FindType = False
    
    ReDim Preserve errorLog(errorLogCnt + 1)
    errorLog(errorLogCnt).filePath = wordFile
    errorLog(errorLogCnt).errorNum = Err.Number
    errorLog(errorLogCnt).errorContent = Err.Description
    errorLogCnt = errorLogCnt + 1
    Err.Clear
End Function


'---------------------------------------------------------------------
' [Excel|fffd|p]|fffd|w|fffd||80b3||fffd||a0bd|Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
'---------------------------------------------------------------------
Private Sub SearchFromExcelFile(inPathName As String, inFileName As String, AbsPath As String, RelPath As String)
    Dim searchWord As String '|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim thisSheetName As String '|fffd|V|fffd|[|fffd|g|fffd||fffd|
    Dim fileLink As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||303||fffd||fffd||fffd||fffd|N
    Dim firstAddress As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||303|Z|fffd||fffd||fffd||292|u
    Dim firstValue As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||312|l
    Dim i As Long, maxRow As Long '|fffd||fffd||fffd|[|fffd|v|fffd|p|fffd||3d0||fffd||fffd|A|fffd|V|fffd|[|fffd|g|fffd||30d||14f|I|fffd|s
    Dim k As Long, m As Long, n As Long '|fffd||fffd||fffd|[|fffd|v|fffd|p|fffd||3d0||fffd|
    Dim excelFile As String 'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|(Path|fffd||702||fffd|)
    Dim oldAddress As String '2|fffd||53bc2||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
    Dim tmpStr As String '|fffd||a39e||fffd|I|fffd||215||fffd||fffd||fffd||fffd||fffd|
    Dim notJustNumber As Boolean '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
    Dim skipFlag As Boolean '|fffd||fffd||fffd||282||582||315|\|fffd||fffd||fffd||fffd||fffd|X|fffd|L|fffd|b|fffd|v(True)
    Dim findTextFlag As Boolean '|fffd||5576||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||282||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||150||602||fffd||582||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||42a91||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||fffd|True
    Dim oneLine As String '|fffd||fffd||fffd||fffd||fffd||143|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||313||fffd||fffd|e
    
    Dim wildcardOn As Boolean '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|,True
    Dim wildcardWords() As String '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14b||fffd||602||fffd||a0bd||fffd||fffd||fffd|[|fffd|h
    Dim wcWordMatch As Boolean '|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||fffd||fffd||fffd||fffd||243|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd|,True
    Dim wcWordTop2End As String '|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim searchWord4Pic As String '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||310|}|fffd|`|fffd|p|fffd||30c||fffd||fffd||fffd||fffd||fffd|
    Dim includeStrFlag As Boolean 'Excel|fffd||31e|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    
    excelFile = inPathName & "\" & inFileName
    
    '|fffd|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd|Path|fffd||fffd||fffd||744a||fffd||383|p|fffd|X|fffd||255||3c2||fffd||fffd||fffd|
    Dim inPathNameRel As String '|fffd||fffd||fffd||383|p|fffd|X
    inPathNameRel = Replace(inPathName, AbsPath, RelPath, compare:=1) 'vbTextCompare=1(|fffd||5576||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||202||fffd|)
    
    '|fffd||14f|I|fffd|s|fffd||fffd||fffd|m|fffd|F
    maxRow = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & Rows.Count).End(xlUp).Row
    
    Application.DisplayAlerts = False
    Application.FindFormat.Clear
    
    Application.ScreenUpdating = False '|fffd|`|fffd||fffd|OFF
    If (BookExists(inFileName)) Then
        Err.Number = 0
        Err.Description = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||10d||113|x|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        GoTo fopenError
    End If
    
    On Error GoTo fopenError  '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd||242||202||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||382||fffd|(fopenError|fffd||fffd|)
    If (InStr(excelFile, ".xls") > 0) Then
        Workbooks.Open FileName:=excelFile, ReadOnly:=True, UpdateLinks:=0 '|fffd||1cf|o|fffd||fffd||fffd||fffd|p|fffd||143|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    ElseIf (InStr(excelFile, ".csv") > 0) Then
        Workbooks.Open FileName:=excelFile, ReadOnly:=True, UpdateLinks:=0, Format:=2 '|fffd||1cf|o|fffd||fffd||fffd||fffd|p|fffd||fffd|"csv"|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Else
        Workbooks.Open FileName:=excelFile, ReadOnly:=True, UpdateLinks:=0, Format:=5 '|fffd||1cf|o|fffd||fffd||fffd||fffd|p|fffd||fffd|"|fffd|e|fffd|L|fffd|X|fffd|g"|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    End If
    On Error Resume Next
    Application.Windows(inFileName).Visible = False '|fffd|J|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
    On Error GoTo fopenDoneError  '|fffd|J|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||30f||fffd||fffd||fffd|(fopenDoneError|fffd||fffd|)
    
    Dim selSheet '|fffd|I|fffd||12182||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    
    '|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||30d||6c2||24a|J|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|v|fffd||fffd||fffd|r|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
    If ((InStr(excelFile, ".xls") > 0) And lessExcel2016) Then
        For Each selSheet In Workbooks(inFileName).Worksheets
            selSheet.Activate
            ActiveWindow.View = xlNormalView
        Next
    End If
    
    Workbooks(myVbaWorkBookName).Activate '|fffd||fffd||fffd||283|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||fffd|
    Application.ScreenUpdating = False '|fffd|`|fffd||fffd|OFF(Excel|fffd||142||34f||fffd||255|`|fffd||fffd||fffd|OFF)
    
    For i = 1 To maxRow '|fffd|P|fffd|s|fffd||682||fffd||fffd||fffd||14f|I|fffd|s|fffd||702||fffd|
        DoEvents
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|
        searchWord = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & i)
        '|fffd||fffd||fffd||fffd|searchWord|fffd||fffd||fffd||fffd||30f||a347||fffd||34e||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
        If (searchWord = "") Then
            GoTo NextSearchOfExcel
        End If
                
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||702||fffd||142||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
        Erase wildcardWords
        wildcardOn = False
        If (InStr(searchWord, "*") > 0) Then
            wildcardOn = True
            wildcardWords = Split(searchWord, "*")
            'Excel|fffd||343|Z|fffd||fffd||fffd||251||382||fffd||fffd||102||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||102||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7cc||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||302||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
            '|fffd|}|fffd|`|fffd||342||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7d0|}|fffd|`|fffd|p|fffd||257|p|fffd||4c2||fffd||fffd||fffd|
            For m = 0 To UBound(wildcardWords)
                If (wildcardWords(m) <> "") Then
                    searchWord4Pic = wildcardWords(m)
                    Exit For
                End If
            Next
        End If
        
        '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
        Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Excel", inFileName)
        
        'Dim selSheet '|fffd|I|fffd||12182||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
        Dim frstCntOfSheet As Long
        Dim lastCntOfSheet As Long
        For Each selSheet In Workbooks(inFileName).Worksheets
            DoEvents
            frstCntOfSheet = resultLine
            If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                Workbooks(inFileName).Close savechanges:=False
                Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
            End If
                        
            '-------------------------
            ' |fffd||fffd|\|fffd||fffd||fffd||30d|s|fffd||fffd||fffd||fffd|m|fffd|F
            '-------------------------
            '|fffd||fffd|\|fffd||fffd||fffd|Z|fffd||fffd||fffd||30d|s|fffd||50502||315||6d1||fffd||fffd||302||fffd||fffd||7c2||310||933e|
            Dim hiddenNum As Long '|fffd||fffd||fffd|[|fffd|v|fffd|p|fffd||315||3d0||fffd|
            Dim hiddenRows() As Long, hiddenClms() As Long   '|fffd||fffd|\|fffd||fffd||fffd||30d|s|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|
            Dim hiddenRowsCnt As Long, hiddenClmsCnt As Long    '|fffd||fffd|\|fffd||fffd||fffd||30d|s|fffd||fffd||310||fffd|
            Dim hogoSheetFlag As Boolean '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||354||fffd|\|fffd||fffd||fffd|Z|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||202||fffd||fffd||60a4||fffd||242||fffd||fffd||fffd|B
            Dim protectSheetFlag As Boolean
            hiddenRowsCnt = 0
            hiddenClmsCnt = 0
            ReDim hiddenRows(hiddenRowsCnt)
            ReDim hiddenClms(hiddenClmsCnt)
            
            protectSheetFlag = selSheet.ProtectContents '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
            If protectSheetFlag = False Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||142||202||fffd||fffd||fffd||381|A|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||443|t|fffd|B|fffd||fffd||fffd|^|fffd||309||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|B
                '|fffd|t|fffd|B|fffd||fffd||fffd|^|fffd||fffd||fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
                If selSheet.FilterMode Then selSheet.ShowAllData
                
                '|fffd|S|fffd||302||148||fffd||509|E|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||303|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||64fe|
                '|fffd||fffd|\|fffd||fffd||fffd||30d|s|fffd||30a|m|fffd|F
                Dim maxRowOfSelSheet As Long
                Dim maxClmOfSelSheet As Long
                maxRowOfSelSheet = 0
                maxClmOfSelSheet = 0

                With selSheet.UsedRange
                    On Error Resume Next
                    maxRowOfSelSheet = .Find("*", , xlFormulas, , xlByRows, xlPrevious).Row
                    If (maxRowOfSelSheet = 0) Then
                        maxRowOfSelSheet = selSheet.Range("A1").SpecialCells(xlLastCell).Row
                    End If
                    
                    On Error Resume Next
                    maxClmOfSelSheet = .Find("*", , xlFormulas, , xlByColumns, xlPrevious).Column
                    If (maxClmOfSelSheet = 0) Then
                        maxClmOfSelSheet = selSheet.Range("A1").SpecialCells(xlLastCell).Column
                    End If
                End With
                
                '|fffd|s|fffd||fffd||fffd||20f||fffd||251||50ab||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||34c||fffd||fffd||fffd||fffd||fffd||fffd||73dc||fffd|O|fffd||fffd||fffd||fffd|
                If (maxRowOfSelSheet >= 1000000) Then
                    Err.Number = 0
                    Err.Description = "|fffd|s|fffd||fffd||fffd||fffd||fffd||64f||fffd||251||50ab||fffd||fffd|(1000000|fffd|s|fffd||20f||fffd|)|fffd||fffd||fffd||7cc||fffd||fffd||fffd||fffd||fffd||fffd||73dc||fffd|O|fffd||fffd||fffd||702||fffd||fffd||fffd|"
                    GoTo fopenDoneError
                End If
                
                For hiddenNum = 1 To maxRowOfSelSheet
                    DoEvents
                    If (selSheet.Rows(hiddenNum).Hidden = True) Then
                        ReDim Preserve hiddenRows(hiddenRowsCnt + 1)
                        hiddenRows(hiddenRowsCnt) = hiddenNum
                        hiddenRowsCnt = hiddenRowsCnt + 1
                    End If
                Next
                
                '|fffd||fffd|\|fffd||fffd||fffd||317||fffd||30a|m|fffd|F
                For hiddenNum = 1 To maxClmOfSelSheet
                    DoEvents
                    If (selSheet.Columns(hiddenNum).Hidden = True) Then
                        ReDim Preserve hiddenClms(hiddenClmsCnt + 1)
                        hiddenClms(hiddenClmsCnt) = hiddenNum
                        hiddenClmsCnt = hiddenClmsCnt + 1
                    End If
                Next
                
                '|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|iReadOnly|fffd||142||fffd||fffd||90bd||fffd||7d6||fffd||fffd||202||fffd||fffd|j
                selSheet.Rows.Hidden = False
                selSheet.Columns.Hidden = False
            End If
            
            '-------------------------
            ' |fffd|Z|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            '-------------------------
            Dim result '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Dim valueFindType As Long
            valueFindType = 0
            oldAddress = "" '|fffd|V|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||257||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd|oldAddress|fffd||34f||fffd||fffd||fffd||fffd||fffd|
            '|fffd|l|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            Set result = selSheet.Cells.Find(searchWord, After:=ActiveCell, LookIn:=xlValues, MatchCase:=chkeckBox1Val, MatchByte:=chkeckBox1Val, SearchOrder:=xlByRows)
                        
            If Not result Is Nothing Then
                firstAddress = result.Address '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||303|Z|fffd||fffd||fffd||292|u
                firstValue = result.Value '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||312|l

                Do
                    DoEvents
                    If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                        Workbooks(inFileName).Close savechanges:=False
                        Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                    End If

                    '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
                    Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Excel", inFileName)
                    
                    '|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||242||182||42f8f||a347||fffd||fffd|NG|fffd||182||fffd||fffd||fffd|
                    If (result.Address = oldAddress) Then
                        Err.Description = "|fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||151||fffd||fffd||fffd||fffd||113||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||1c2||742||fffd||fffd||fffd||fffd||7c3|G|fffd||fffd||fffd|["
                        Err.Number = 0
                        GoTo fopenDoneError
                    End If
                    oldAddress = result.Address
                    
                    '|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd||fffd|
                    includeStrFlag = True
                    If (chkeckBox1Val = True) Then
                        If InStr(result, searchWord) = 0 Then
                            includeStrFlag = False
                        End If
                    End If

                    '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                    wcWordMatch = False
                    oneLine = selSheet.Range(result.Address)
                    If (wildcardOn = True) Then
                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    Else
                        notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    End If
                    
                    'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                    skipFlag = False
                    If (wildcardOn = True) And (wcWordMatch = False) Then
                        skipFlag = True
                    ElseIf (chkeckBox2Val = True) Then
                        skipFlag = notJustNumber
                    End If
                    

                    If ((skipFlag = False) And (includeStrFlag = True)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||312||fffd||fffd||30aa||fffd||fffd||fffd||fffd||fffd||142||202||fffd||fffd|A|fffd||fffd||fffd||81|A|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd|True|fffd||202||fffd||38c||fffd||fffd||282||182||fffd||fffd||10b|L|fffd||fffd|
                        fileLink = inPathNameRel & "\" & inFileName & "#" & "'" & thisSheetName & "'" & "!" & result.Address '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||303||fffd||fffd||fffd||fffd|N
                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                            
                            If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|
                               .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Else
                               .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            End If
                            
                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                            
                            If (InStr(inFileName, ".xls") > 0) Then '|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||a347|
                                .Range("D" & resultLine).Interior.Color = RGB(204, 228, 184) 'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            ElseIf (InStr(inFileName, ".csv") > 0) Then 'csv|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||a347|
                                .Range("D" & resultLine).Interior.Color = RGB(177, 160, 199) 'csv|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            End If
                                
                            .Range("E" & resultLine) = selSheet.Name '|fffd|V|fffd|[|fffd|g|fffd||fffd|
                            If protectSheetFlag = True Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||30f||a347||fffd||343|V|fffd|[|fffd|g|fffd||fffd||fffd||250|F|fffd||fffd|t|fffd||fffd||fffd||fffd|
                                .Range("E" & resultLine).Interior.Color = RGB(255, 255, 153) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F)
                                .Range("E" & resultLine).AddComment "|fffd||6cc||c0b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||142||fffd|"
                                .Range("E" & resultLine).Comment.Shape.Height = 12
                            End If

                           .Range("F" & resultLine) = "-" 'Page|fffd||fffd|

                            'F|fffd||fffd||243||fffd||fffd||fffd||fffd|N|fffd|t|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||303|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd|
                            tmpStr = Replace(result.Address, "$", "")
                            If ((InStr(inFileName, ".xls") = 0) And (InStr(inFileName, ".csv") = 0)) Then '|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||a347|
                                tmpStr = Right(tmpStr, Len(tmpStr) - 1)
                            End If
                            .Range("J" & resultLine) = .Range(tmpStr).Row '|fffd|\|fffd|[|fffd|g|fffd|p|fffd|i|fffd|s|fffd|j
                            .Range("K" & resultLine) = .Range(tmpStr).Column '|fffd|\|fffd|[|fffd|g|fffd|p|fffd|i|fffd||fffd|j
                            
                            .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, TextToDisplay:=tmpStr
                            .Range("H" & resultLine) = selSheet.Range(result.Address) '|fffd|Z|fffd||fffd||fffd||313||fffd||fffd|e

                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                            If (notJustNumber) And (selSheet.Range(result.Address).HasFormula) Then
                                '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||81|A|fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||90||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 35
                            ElseIf (notJustNumber) Then
                                '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 25
                            ElseIf (selSheet.Range(result.Address).HasFormula) Then
                                '|fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Range("H" & resultLine).Interior.Color = RGB(197, 242, 251) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 12
                            End If

                            '|fffd||fffd|\|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
                            Dim hiddenSelFlag As Boolean
                            hiddenSelFlag = False
                            For hiddenNum = 0 To hiddenRowsCnt
                                DoEvents
                                If (hiddenRows(hiddenNum) = selSheet.Range(result.Address).Row) Then
                                    hiddenSelFlag = True
                                End If
                            Next
                            If (hiddenSelFlag = False) Then '|fffd|s|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||14a||fffd||fffd||254||fffd|\|fffd||fffd||fffd||194||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||a347||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||202||fffd|
                                For hiddenNum = 0 To hiddenClmsCnt
                                    DoEvents
                                    If (hiddenClms(hiddenNum) = selSheet.Range(result.Address).Column) Then
                                        hiddenSelFlag = True
                                    End If
                                Next
                            End If
                            '|fffd||fffd|\|fffd||fffd||fffd|Z|fffd||fffd||fffd||30f||a347||fffd|F|fffd|t|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
                            If (hiddenSelFlag = True) Then
                                .Range("G" & resultLine).Interior.Color = RGB(191, 191, 191) '|fffd|w|fffd|i|fffd|F|fffd|i|fffd|J|fffd||fffd||fffd|[|fffd|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd|F19|fffd||193||fffd||fffd||fffd||fffd|F|fffd|j
                                .Range("G" & resultLine).AddComment "|fffd||38f||6c3|Z|fffd||fffd||fffd||354||fffd|\|fffd||fffd||fffd||142||fffd|"
                                .Range("G" & resultLine).Comment.Shape.Height = 12
                            End If
                            
                            resultLine = resultLine + 1
                        End With
                    End If 'If (skipFlag = False)
                    Set result = selSheet.Cells.FindNext(result)
                    If result Is Nothing Then 'Nothing|fffd||30e||fffd||fffd||fffd|result.Address|fffd||fffd||fffd|s|fffd||fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7d0||fffd||fffd|Nothing|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|B
                        Exit Do
                    End If
                Loop While result.Address <> firstAddress '|fffd||fffd||fffd||303|Z|fffd||fffd||fffd||256||7c2||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd|[|fffd|v|fffd|I|fffd||fffd|
            End If 'If Not result Is Nothing
            
            '------------------
            '|fffd||fffd|\|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||256||7c2||fffd|
            '------------------
            If protectSheetFlag = False Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||142||202||fffd||fffd||a347|
                For hiddenNum = 0 To hiddenRowsCnt - 1
                    DoEvents
                    selSheet.Rows(hiddenRows(hiddenNum)).Hidden = True
                Next
                For hiddenNum = 0 To hiddenClmsCnt - 1
                    DoEvents
                    selSheet.Columns(hiddenClms(hiddenNum)).Hidden = True
                Next
            End If
            '------------------
            ' |fffd|}|fffd|`|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            '------------------
            '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Shapes|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
            Dim shapeCnt As Long
            shapeCnt = selSheet.Shapes.Count
            '|fffd|z|fffd||fffd|strObjName|fffd||243|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|
            For m = 1 To shapeCnt
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    Workbooks(inFileName).Close savechanges:=False
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                
                '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
                Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Excel", inFileName)
                
                With selSheet.Shapes(m)
                        If (.Type = 4) Then 'msoComment(=4)
                            '|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||30e||fffd||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                        ElseIf (.Type = 6) Then 'msoGroup(=6).|fffd|O|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|}|fffd|`|fffd||30f||a347|
                            For k = 1 To .GroupItems.Count
                                DoEvents
                                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                                    Workbooks(inFileName).Close savechanges:=False
                                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                                End If
                                                                
                                On Error Resume Next '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|V|fffd|F|fffd|C|fffd|v|fffd||30f||a347||fffd||311||38d||fffd|
                                If Not (Len(selSheet.Shapes(m).GroupItems(k).DrawingObject.Characters.Text) > 0) Then '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||242||202||fffd||fffd||a347|
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                                Else
                                    oneLine = selSheet.Shapes(m).GroupItems(k).DrawingObject.Characters.Text
                                    
                                    If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd|
                                        findTextFlag = justTextCheck(oneLine, searchWord4Pic)
                                    Else
                                        findTextFlag = justTextCheck(oneLine, searchWord)
                                    End If

                                    If (findTextFlag) Then
                                        
                                        '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                                        wcWordMatch = False
                                        If (wildcardOn = True) Then
                                            'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                            Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                                            notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                        Else
                                            notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                        End If
                                        
                                        'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                                        skipFlag = False
                                        If ((wildcardOn = True) And (wcWordMatch = False)) Then
                                            skipFlag = True
                                        ElseIf (chkeckBox2Val = True) Then
                                            skipFlag = notJustNumber
                                        End If
                                        
                                        If (skipFlag = False) Then
                                            With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                                .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                                
                                                If (wildcardOn = True) Then
                                                    .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                Else
                                                    .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                End If
                                                
                                                .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                                .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                                .Range("D" & resultLine).Interior.Color = RGB(204, 228, 184) 'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                                .Range("E" & resultLine) = selSheet.Name '|fffd|V|fffd|[|fffd|g|fffd||fffd|
                                                If protectSheetFlag = True Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||30f||a347||fffd||343|V|fffd|[|fffd|g|fffd||fffd||fffd||250|F|fffd||fffd|t|fffd||fffd||fffd||fffd|
                                                    .Range("E" & resultLine).Interior.Color = RGB(255, 255, 153) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F)
                                                    .Range("E" & resultLine).AddComment "|fffd||6cc||c0b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||142||fffd|"
                                                    .Range("E" & resultLine).Comment.Shape.Height = 12
                                                End If
                                                .Range("F" & resultLine) = "-" 'Page|fffd||fffd|
                                                .Range("H" & resultLine) = selSheet.Shapes(m).GroupItems(k).DrawingObject.Characters.Text  '
                                                'G|fffd||fffd|
                                                tmpStr = Cells(selSheet.Shapes(m).GroupItems(k).TopLeftCell.Row, selSheet.Shapes(m).GroupItems(k).TopLeftCell.Column).Address
                                                tmpStr = Replace(tmpStr, "$", "")
                                                .Range("J" & resultLine) = .Range(tmpStr).Row '|fffd|\|fffd|[|fffd|g|fffd|p|fffd|i|fffd|s|fffd|j
                                                .Range("K" & resultLine) = .Range(tmpStr).Column '|fffd|\|fffd|[|fffd|g|fffd|p|fffd|i|fffd||fffd|j
                                                fileLink = inPathNameRel & "\" & inFileName & "#" & "'" & thisSheetName & "'" & "!" & tmpStr '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||303||fffd||fffd||fffd||fffd|N
                                                .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, TextToDisplay:=tmpStr & "(|fffd|}|fffd|`)"
                                                
                                                '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                                If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                                    .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                                    .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                                    .Range("H" & resultLine).Comment.Shape.Height = 25
                                                End If
                                                                                            
                                                resultLine = resultLine + 1
                                            
                                            End With
                                        End If 'If (skipFlag = False)
                                    End If
                                End If
                            Next
                        Else
                            DoEvents
                            On Error Resume Next '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|V|fffd|F|fffd|C|fffd|v|fffd||30f||a347||fffd||311||38d||fffd|
                            If Not (Len(selSheet.Shapes(m).DrawingObject.Characters.Text) > 0) Then '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||242||202||fffd||fffd||a347|
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
                            Else
                                oneLine = selSheet.Shapes(m).DrawingObject.Characters.Text
                                
                                If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd|
                                    findTextFlag = justTextCheck(oneLine, searchWord4Pic)
                                Else
                                    findTextFlag = justTextCheck(oneLine, searchWord)
                                End If
                                
                                If (findTextFlag) Then
                                    
                                    '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                                    wcWordMatch = False
                                    If (wildcardOn = True) Then
                                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                    Else
                                        notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                                    End If
                                    
                                    'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                                    skipFlag = False
                                    If ((wildcardOn = True) And (wcWordMatch = False)) Then
                                        skipFlag = True
                                    ElseIf (chkeckBox2Val = True) Then
                                        skipFlag = notJustNumber
                                    End If
                                    
                                    If (skipFlag = False) Then
                                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                            
                                            If (wildcardOn = True) Then
                                                .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            Else
                                                .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                            End If
                                            
                                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                            .Range("D" & resultLine).Interior.Color = RGB(204, 228, 184) 'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                            .Range("E" & resultLine) = selSheet.Name '|fffd|Z|fffd||fffd||fffd||303|A|fffd|h|fffd||fffd||fffd|X
                                            If protectSheetFlag = True Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||30f||a347||fffd||343|V|fffd|[|fffd|g|fffd||fffd||fffd||250|F|fffd||fffd|t|fffd||fffd||fffd||fffd|
                                                .Range("E" & resultLine).Interior.Color = RGB(255, 255, 153) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F)
                                                .Range("E" & resultLine).AddComment "|fffd||6cc||c0b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||142||fffd|"
                                                .Range("E" & resultLine).Comment.Shape.Height = 12
                                            End If
                                            .Range("F" & resultLine) = "-" 'Page|fffd||fffd|
                                            .Range("H" & resultLine) = selSheet.Shapes(m).DrawingObject.Characters.Text
                                            'G|fffd||fffd|
                                            tmpStr = Cells(selSheet.Shapes(m).TopLeftCell.Row, selSheet.Shapes(m).TopLeftCell.Column).Address
                                            tmpStr = Replace(tmpStr, "$", "")
                                            .Range("J" & resultLine) = .Range(tmpStr).Row '|fffd|\|fffd|[|fffd|g|fffd|p
                                            .Range("K" & resultLine) = .Range(tmpStr).Column '|fffd|\|fffd|[|fffd|g|fffd|p
                                            fileLink = inPathNameRel & "\" & inFileName & "#" & "'" & thisSheetName & "'" & "!" & tmpStr '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||303||fffd||fffd||fffd||fffd|N
                                           .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, TextToDisplay:=tmpStr & "(|fffd|}|fffd|`)"
                                            
                                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                            If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                                .Range("H" & resultLine).Comment.Shape.Height = 25
                                            End If
                                        
                                            resultLine = resultLine + 1
                                                                                
                                        End With
                                    End If
                                End If
                            End If
                        End If
                End With
            Next m
            '------------------
            ' |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            '------------------
            Dim tempCom As Comment
            For Each tempCom In selSheet.Comments
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    Workbooks(inFileName).Close savechanges:=False
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                                
                '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
                Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "Excel", inFileName)
                                    
                If (wildcardOn = True) Then '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30e||fffd|
                    findTextFlag = justTextCheck(tempCom.Text, searchWord4Pic)
                Else
                    findTextFlag = justTextCheck(tempCom.Text, searchWord)
                End If
                                    
                If (findTextFlag) Then '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||a347|
                    oneLine = tempCom.Text
                    
                    '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                    wcWordMatch = False
                    If (wildcardOn = True) Then
                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    Else
                        notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    End If
                    
                    'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                    skipFlag = False
                    If ((wildcardOn = True) And (wcWordMatch = False)) Then
                        skipFlag = True
                    ElseIf (chkeckBox2Val = True) Then
                        skipFlag = notJustNumber
                    End If
                    
                    If (skipFlag = False) Then
                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                            
                            If (wildcardOn = True) Then
                                .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Else
                                .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            End If
                            
                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                            .Range("D" & resultLine).Interior.Color = RGB(204, 228, 184) 'Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            .Range("E" & resultLine) = selSheet.Name '|fffd|Z|fffd||fffd||fffd||303|A|fffd|h|fffd||fffd||fffd|X
                            If protectSheetFlag = True Then '|fffd||6cc||fffd|V|fffd|[|fffd|g|fffd||30f||a347||fffd||343|V|fffd|[|fffd|g|fffd||fffd||fffd||250|F|fffd||fffd|t|fffd||fffd||fffd||fffd|
                                .Range("E" & resultLine).Interior.Color = RGB(255, 255, 153) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F)
                                .Range("E" & resultLine).AddComment "|fffd||6cc||c0b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||142||fffd|"
                                .Range("E" & resultLine).Comment.Shape.Height = 12
                            End If
                            .Range("F" & resultLine) = "-" 'Page|fffd||fffd|
                            tmpStr = tempCom.Parent.Address(0, 0)
                            .Range("H" & resultLine) = tempCom.Text & " [|fffd||38f||6d5||fffd|:" & selSheet.Range(tmpStr) & "]"
                            .Range("J" & resultLine) = .Range(tmpStr).Row '|fffd|\|fffd|[|fffd|g|fffd|p(|fffd|s)
                            .Range("K" & resultLine) = .Range(tmpStr).Column '|fffd|\|fffd|[|fffd|g|fffd|p(|fffd||fffd|)
                            fileLink = inPathNameRel & "\" & inFileName & "#" & "'" & thisSheetName & "'" & "!" & tmpStr '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||303||fffd||fffd||fffd||fffd|N
                            .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=fileLink, TextToDisplay:=tmpStr & "(|fffd|R|fffd||fffd||fffd||fffd||fffd|g)"
                            
                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                            If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 25
                            End If
                            
                            resultLine = resultLine + 1
                        End With
                    End If
                End If
            Next tempCom
            '|fffd||fffd||fffd||502||10b93||681|B|fffd||fffd||50f||fffd||30d|s|fffd||fffd||fffd||727a||fffd||30d|s|fffd||30c||fffd||fffd||282||fffd||fffd||fffd||fffd||502||60a4||fffd||243|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
            lastCntOfSheet = resultLine
            With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                .Range("A" & frstCntOfSheet & ":K" & lastCntOfSheet - 1). _
                Sort Key1:=.Range("J" & frstCntOfSheet), Key2:=.Range("K" & frstCntOfSheet), order2:=xlAscending
                .Range("J" & frstCntOfSheet & ":K" & lastCntOfSheet - 1) = "" '|fffd||20c||fffd||34e|g|fffd|p|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7cf||fffd||fffd||fffd|
            End With
            
        Next
NextSearchOfExcel:
    Next
    
    Workbooks(inFileName).Close savechanges:=False
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||308||fffd||50d||150|V|fffd||30d|s|fffd||248||693||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||313|r|fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|)
    If (Selection.Address <> "C" & resultLine) Then
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C" & resultLine).Activate
    End If
    Exit Sub
    '-----------------------------
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    '-----------------------------
fopenError:
    ReDim Preserve errorLog(errorLogCnt + 1)
    errorLog(errorLogCnt).filePath = excelFile
    errorLog(errorLogCnt).errorNum = Err.Number
    errorLog(errorLogCnt).errorContent = Err.Description
    errorLogCnt = errorLogCnt + 1
    Err.Clear
    Exit Sub
fopenDoneError:
    ReDim Preserve errorLog(errorLogCnt + 1)
    errorLog(errorLogCnt).filePath = excelFile
    errorLog(errorLogCnt).errorNum = Err.Number
    errorLog(errorLogCnt).errorContent = Err.Description
    errorLogCnt = errorLogCnt + 1
    Err.Clear
    Workbooks(inFileName).Close savechanges:=False
End Sub

'---------------------------------------------------------------------
' [PowerPoint|fffd|p]|fffd|w|fffd||80b3||fffd||a0bd|PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
'---------------------------------------------------------------------
Private Sub SearchFromPptFile(inPathName As String, inFileName As String, AbsPath As String, RelPath As String)
    Dim pptFile As String 'ppt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim i As Long, k As Long, m As Long, maxRow As Long '|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p
    Dim page As Long, line As Long ' |fffd|y|fffd|[|fffd|W|fffd|A|fffd|s
    
    Dim pptPageNum As Long '|fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim tmpStr As String '|fffd||a39e||fffd|I|fffd|I|fffd||215||fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd|p
    Dim searchWord As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim notJustNumber As Boolean '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
    Dim skipFlag As Boolean 'Ture|fffd||30e||fffd||fffd||243|X|fffd|L|fffd|b|fffd|v
    Dim findTextFlag As Boolean '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||90a9||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim oneLine As String '|fffd||fffd||fffd||fffd||fffd||143|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||313||fffd||fffd|e

    Dim wildcardOn As Boolean '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|,True
    Dim wildcardWords() As String '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||14b||fffd||602||fffd||a0bd||fffd||fffd||fffd|[|fffd|h
    Dim wcWordMatch As Boolean '|fffd||fffd||fffd|[|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||fffd||fffd||fffd||fffd||243|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd|,True
    Dim wcWordTop2End As String '|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|

    pptFile = inPathName & "\" & inFileName    'Open|fffd||fffd||fffd||fffd|ppt|fffd||fffd||fffd||fffd||327||fffd||656||fffd||fffd||fffd||fffd||7fd||fffd||fffd||fffd|t|fffd||fffd||fffd||153||fffd||fffd||fffd||fffd|

    '|fffd|A|fffd|h|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd|Path|fffd||fffd||fffd||744a||fffd||383|p|fffd|X|fffd||255||3c2||fffd||fffd||fffd|
    Dim inPathNameRel As String
    inPathNameRel = Replace(inPathName, AbsPath, RelPath, compare:=1) 'vbTextCompare=1(|fffd||5576||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||202||fffd|)
    
    '|fffd||14f|I|fffd|s|fffd||fffd||fffd|m|fffd|F
    maxRow = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & Rows.Count).End(xlUp).Row

    'ppt|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Application.ScreenUpdating = False '|fffd|`|fffd||fffd|OFF
    Application.DisplayAlerts = False '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd||a39e||fffd|I|fffd||252||fffd|~
    'pptObj.Visible = False '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ppt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
    pptObj.Visible = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ppt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd|
    
    '|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||594||fffd||382||fffd|
    Dim prs As Object
    For Each prs In pptObj.Presentations
        DoEvents
        If (prs.Name = inFileName) Then
            Err.Number = 0
            Err.Description = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||10d||113|x|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            pptFileIsOpened = True
            GoTo fopenError
        End If
    Next prs
  
    On Error GoTo fopenError  '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd||242||202||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||382||fffd|(fopenError|fffd||fffd|)
    
    Dim pptHdl As Object
    Set pptHdl = pptObj.Presentations.Open(pptFile, ReadOnly:=-1)  'msoTrue(=1).ppt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74f|o|fffd||fffd||fffd||fffd|p|fffd||14a|J|fffd||fffd|
    pptObj.WindowState = 2 'wdWindowStateMinimize(=2). |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||14f||fffd||fffd||fffd|
    
    'Excel2013|fffd||30f||a347||fffd||355|`|fffd||fffd||fffd|ON|fffd||fffd||fffd||202||fffd||fffd||18b||252|[|fffd||252|x|fffd||fffd||fffd||202||90bd||fffd||7d1|I|fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||242||fffd||fffd||fffd|
    Application.ScreenUpdating = True '|fffd|`|fffd||fffd|ON
    pptObj.Visible = True '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ppt|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|\|fffd||fffd|
    
    Dim sld As Object 'PowerPoint.Slide
    Dim shp As Object 'PowerPoint.Shape
    Dim rng As Object 'PowerPoint.TextRange
    Dim find_rng As Object 'PowerPoint.TextRange
    
    For i = 1 To maxRow '|fffd||fffd||fffd||fffd||fffd||a30b||fffd||283|V|fffd|[|fffd|g|fffd||fffd|1|fffd|s|fffd||682||fffd||fffd||fffd||14f|I|fffd|s|fffd||312|P|fffd||fffd||fffd||fffd||fffd||fffd||24c||fffd||fffd||fffd|
        DoEvents
        If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
            pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
            If (pptObj.Presentations.Count = 0) Then
                 pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
            End If
            Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
        End If
        
        '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd||fffd||fffd|X|fffd|V
        Call setProgress(progressCnt, inFileName & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(" & i & "/" & maxRow & ")", "ppt", "")
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|
        searchWord = Workbooks(myVbaWorkBookName).Worksheets(SearchWordSheet).Range("A" & i)
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||702||fffd||142||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
        Erase wildcardWords
        wildcardOn = False
        If (InStr(searchWord, "*") > 0) Then
            wildcardOn = True
            wildcardWords = Split(searchWord, "*")
            For m = 0 To UBound(wildcardWords)
                If (wildcardWords(m) <> "") Then
                    searchWord = wildcardWords(m)
                    Exit For
                End If
            Next
        End If
            
        '|fffd||fffd||fffd||fffd|searchWord|fffd||fffd||fffd||fffd||30f||a347||fffd||34e||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
        If (searchWord = "") Then
            GoTo NextSearchOfppt
        End If
        
        For Each sld In pptObj.ActivePresentation.Slides
            DoEvents
            pptPageNum = sld.SlideIndex
            For Each shp In sld.Shapes
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                    If (pptObj.Presentations.Count = 0) Then
                         pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                    End If
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                
                '-----------------------------
                ' |fffd|}|fffd|`|fffd||fffd||28f||d576||fffd||30f||a347|
                '-----------------------------
                If shp.HasTextFrame Then '
                    Set rng = shp.TextFrame.TextRange
                    Set find_rng = rng.Find(FindWhat:=searchWord, MatchCase:=chkeckBox1Val)
                    If Not (find_rng Is Nothing) Then
                        Dim shapeText() As String '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|
                        
                        '|fffd||fffd||fffd||fffd||fffd|^|fffd|u|fffd||fffd||fffd||fffd||fffd|s|fffd|R|fffd|[|fffd|h|fffd||255||3c2||fffd||fffd||102||fffd||fffd||fffd|ASplit|fffd||fffd||fffd||fffd|
                        Dim myRngText As String
                        myRngText = rng.Text
                        myRngText = Replace(myRngText, Chr(11), Chr(13))
                        shapeText = Split(myRngText, Chr(13))
                        
                        '|fffd||fffd||fffd||fffd||fffd||fffd||a0bd|1|fffd|s|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||251||382||fffd||fffd||103|`|fffd|F|fffd|b|fffd|N
                        For line = LBound(shapeText) To UBound(shapeText)
                            DoEvents
                            If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                                pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                                If (pptObj.Presentations.Count = 0) Then
                                     pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                                End If
                                Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                            End If
                            
                            tmpStr = shapeText(line)
                            findTextFlag = justTextCheck(tmpStr, searchWord)
                            oneLine = tmpStr
                            
                            '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                            wcWordMatch = False
                            If (wildcardOn = True) Then
                                'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                                notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            Else
                                notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            End If
                            
                            'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                            skipFlag = False
                            If ((wildcardOn = True) And (wcWordMatch = False)) Then
                                skipFlag = True
                            ElseIf (chkeckBox2Val = True) Then
                                skipFlag = notJustNumber
                            End If

                            If ((Not skipFlag) And (findTextFlag = True)) Then
                                With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                
                                    .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                    
                                    If (wildcardOn = True) Then
                                        .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    Else
                                        .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    End If
                                    
                                    .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                    .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                    .Range("D" & resultLine).Interior.Color = RGB(253, 215, 211) 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                    .Range("E" & resultLine) = shp.Name & "(ID:" & shp.ID & ")"  '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|
                                    .Range("F" & resultLine) = pptPageNum 'Page|fffd||fffd|
                                    .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=inPathNameRel & "\" & inFileName & "#" & pptPageNum, TextToDisplay:="" & line + 1
                                    .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                                    .Range("H" & resultLine) = shapeText(line)
                                    
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                    If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                        .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                        .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                        .Range("H" & resultLine).Comment.Shape.Height = 25
                                    End If
                                    
                                    resultLine = resultLine + 1
                                End With
                            End If
                        Next line
                    End If
                '-----------------------------
                ' |fffd|\|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd|
                '-----------------------------
                ElseIf (shp.HasTable) Then
                    Dim iClm As Long '|fffd||fffd|I|fffd||fffd|
                    Dim iRow As Long '|fffd|s|fffd|I|fffd||fffd|
                    Dim cellText As String '|fffd|\|fffd||303|Z|fffd||fffd||fffd||312|l
                    For iClm = 1 To shp.Table.Columns.Count
                        For iRow = 1 To shp.Table.Rows.Count
                            DoEvents
                            If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                                pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                                If (pptObj.Presentations.Count = 0) Then
                                     pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                                End If
                                Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                            End If
                            
                            cellText = shp.Table.Cell(iRow, iClm).Shape.TextFrame.TextRange.Text
                            findTextFlag = justTextCheck(cellText, searchWord)
                            
                            '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                            wcWordMatch = False
                            If (wildcardOn = True) Then
                                'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                                Call chkWildCardMatch(cellText, wildcardWords, wcWordMatch, wcWordTop2End)
                                notJustNumber = justNumCheck(cellText, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            Else
                                notJustNumber = justNumCheck(cellText, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                            End If
                            
                            'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                            skipFlag = False
                            If ((wildcardOn = True) And (wcWordMatch = False)) Then
                                skipFlag = True
                            ElseIf (chkeckBox2Val = True) Then
                                skipFlag = notJustNumber
                            End If

                            If ((Not skipFlag) And (findTextFlag = True)) Then
                                With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                                    .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                                    
                                    If (wildcardOn = True) Then
                                        .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    Else
                                        .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                    End If
                                    
                                    .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                                    .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                                    .Range("D" & resultLine).Interior.Color = RGB(253, 215, 211) 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                                    .Range("E" & resultLine) = shp.Name & "(ID:" & shp.ID & ")"  '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|
                                    .Range("F" & resultLine) = pptPageNum 'Page|fffd||fffd|
                                    .Range("H" & resultLine) = cellText
                                    .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=inPathNameRel & "\" & inFileName & "#" & pptPageNum, TextToDisplay:="" & iRow & "," & iClm
                                    .Range("G" & resultLine).AddComment "|fffd|s,|fffd||fffd|"
                                    .Range("G" & resultLine).Comment.Shape.Height = 12
                                    .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                                    
                                    '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                                    If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                        .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                        .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                        .Range("H" & resultLine).Comment.Shape.Height = 25
                                    End If
                                    
                                    resultLine = resultLine + 1
                                End With
                            End If
                        Next iRow
                    Next iClm
                End If 'ElseIf (shp.HasTable) Then
            Next 'For Each shp In sld.Shapes
            
            '-----------------------------
            ' |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||251||382||fffd||fffd||10c||fffd||fffd||fffd|
            '-----------------------------
'            Dim tmpPpt As PowerPoint.Application
'            tmpPpt.Presentations(1).Slides(1).Comments(1).Text
            
            Dim tempCom As Object
            For Each tempCom In sld.Comments
                DoEvents
                If UserForm1.IsCancel = True Then '|fffd||fffd||fffd||fffd||fffd|~(Cancel)
                    pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
                    If (pptObj.Presentations.Count = 0) Then
                         pptObj.Quit 'PowerPoint|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||82||fffd||fffd||fffd|
                    End If
                    Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
                End If
                                                                    
                findTextFlag = justTextCheck(tempCom.Text, searchWord)
                
                '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                wcWordMatch = False
                If (wildcardOn = True) Then
                    'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                    Call chkWildCardMatch(cellText, wildcardWords, wcWordMatch, wcWordTop2End)
                    notJustNumber = justNumCheck(cellText, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                Else
                    notJustNumber = justNumCheck(cellText, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                End If
                                    
                If (findTextFlag) Then '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||a347|
                    oneLine = tempCom.Text
                    
                    '|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||a347||fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
                    wcWordMatch = False
                    If (wildcardOn = True) Then
                        'chkWildCardMatch(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|e,|fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd|,|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
                        Call chkWildCardMatch(oneLine, wildcardWords, wcWordMatch, wcWordTop2End)
                        notJustNumber = justNumCheck(oneLine, wcWordTop2End) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    Else
                        notJustNumber = justNumCheck(oneLine, searchWord) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
                    End If
                    
                    'checkbox_text_opt2|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd|O|fffd|A|fffd||202||fffd||fffd||a347||fffd||350|F|fffd|t|fffd||fffd|
                    skipFlag = False
                    If ((wildcardOn = True) And (wcWordMatch = False)) Then
                        skipFlag = True
                    ElseIf (chkeckBox2Val = True) Then
                        skipFlag = notJustNumber
                    End If
                    
                    If ((Not skipFlag) And (findTextFlag = True)) Then
                        With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
                            .Range("A" & resultLine) = i '|fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|
                            
                            If (wildcardOn = True) Then
                                .Range("B" & resultLine) = wcWordTop2End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Else
                                .Range("B" & resultLine) = searchWord '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            End If
                            
                            .Hyperlinks.Add Anchor:=.Range("C" & resultLine), Address:=inPathNameRel, TextToDisplay:=inPathNameRel 'Path|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd|N|fffd|}|fffd||fffd|)
                            .Range("D" & resultLine) = inFileName '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
                            .Range("D" & resultLine).Interior.Color = RGB(253, 215, 211) 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310|F
                            .Range("E" & resultLine) = "Comment(ID:0)" '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|
                            .Range("F" & resultLine) = pptPageNum 'Page|fffd||fffd|
                            .Range("H" & resultLine) = tempCom.Text
                            .Hyperlinks.Add Anchor:=.Range("G" & resultLine), Address:=inPathNameRel & "\" & inFileName & "#" & pptPageNum, TextToDisplay:="" & iRow & "," & iClm
                            .Range("G" & resultLine).Font.Color = RGB(255, 0, 0) '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|J|fffd||fffd||fffd|[|fffd||350||fffd|
                            
                            '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|F|fffd||c2||fffd|
                            If (notJustNumber) Then '|fffd||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd|
                                .Range("H" & resultLine).Interior.Color = RGB(255, 255, 204) '|fffd|w|fffd|i|fffd|F(|fffd||fffd||fffd||fffd||fffd||fffd|)
                                .Range("H" & resultLine).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd|"
                                .Range("H" & resultLine).Comment.Shape.Height = 25
                            End If
                            
                            resultLine = resultLine + 1
                        End With
                    End If
                End If
            Next tempCom
        Next 'For Each sld In pptObj.ActivePresentation.Slides
NextSearchOfppt:
    
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||308||fffd||50d||150|V|fffd||30d|s|fffd||248||693||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||313|r|fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|)
        If (Selection.Address <> "C" & resultLine) Then
            Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C" & resultLine).Activate
        End If
    
    Next
    pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
  
    Exit Sub
    '-----------------------------
    ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    '-----------------------------
fopenError:
    'pptHdl.Close 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    
    Application.ScreenUpdating = True '|fffd||fffd||282||315|`|fffd||fffd|X|fffd|V|fffd||10a|J
    Application.DisplayAlerts = True '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||292|m|fffd||fffd||fffd||94|\|fffd||fffd|
    ReDim Preserve errorLog(errorLogCnt + 1) '|fffd|z|fffd||fffd||fffd|`|fffd||fffd||fffd||112||fffd|`(1|fffd||fffd||fffd|Z)
    errorLog(errorLogCnt).filePath = pptFile '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|)
    errorLog(errorLogCnt).errorNum = Err.Number '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|)
    errorLog(errorLogCnt).errorContent = Err.Description '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|L|fffd|^(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e)
    errorLogCnt = errorLogCnt + 1
    Err.Clear '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A

End Sub


'---------------------------------------------------------------------
' |fffd||fffd||383|p|fffd|X|fffd||11291||383|p|fffd|X|fffd||255||3ca||fffd|
'---------------------------------------------------------------------
Function absToRelativePath(filePath As String) As String
    Dim i As Long '|fffd||fffd||fffd|[|fffd|v|fffd|p
    Dim arrayF() As String '|fffd||fffd||383|p|fffd|X|fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||182||24a|i|fffd|[|fffd||fffd||fffd||90bd||fffd||7c2||314|z|fffd||fffd|
    Dim arrayC() As String '|fffd|J|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd|X|fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||182||24a|i|fffd|[|fffd||fffd||fffd||90bd||fffd||7c2||314|z|fffd||fffd|
    Dim currentPath As String '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath(|fffd||fffd||fffd||fffd|VBA|fffd||303|p|fffd|X)
    currentPath = ActiveWorkbook.path '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath|fffd||fffd||fffd||64fe|
        
    filePath = Replace(filePath, "/", "\")
    currentPath = Replace(currentPath, "/", "\")
        
    ' |fffd|K|fffd|w|fffd||fffd||fffd||182||254|z|fffd||fffd||24a|i|fffd|[
    arrayF = Split(filePath, "\")
    arrayC = Split(currentPath, "\")
    
    '|fffd|h|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||642||202||fffd||a347||fffd||350||fffd||383|p|fffd|X|fffd||fffd||502||fffd|
   If (UCase(arrayF(1)) <> UCase(arrayC(1))) Then
        absToRelativePath = filePath
        Exit Function
    End If

    '|fffd||14f||fffd||282||30a|K|fffd|w|fffd||fffd||fffd||74ef||fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc|
    Dim sameArrayNum As Long
    If (UBound(arrayF) - UBound(arrayC)) > 0 Then
        sameArrayNum = UBound(arrayC)
    Else
        sameArrayNum = UBound(arrayF)
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|K|fffd|w|fffd||fffd||fffd||355|s|fffd|v|fffd||302||fffd||fffd||7cf||fffd||fffd||fffd|
    For i = 0 To sameArrayNum
        DoEvents
        If (UCase(arrayF(i)) = UCase(arrayC(i))) Then
            arrayF(i) = ""
            arrayC(i) = ""
        Else
            Exit For
        End If
    Next
    
    '|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|t|fffd|H|fffd||fffd||fffd|_|fffd||303|p|fffd|X|fffd||fffd||48f|W
    For i = 0 To UBound(arrayF) - 1
        DoEvents
        If arrayF(i) <> "" Then
            arrayF(i) = arrayF(i) & "\"
        End If
    Next
    
    'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd||303|t|fffd|H|fffd||fffd||fffd|_|fffd||303|p|fffd|X|fffd||fffd||48f|W
    For i = 0 To UBound(arrayC)
        DoEvents
        If arrayC(i) <> "" Then
            arrayC(i) = "..\"
        End If
    Next
    absToRelativePath = Join(arrayC, "") & Join(arrayF, "") '|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If (absToRelativePath = "") Then
        absToRelativePath = "." '|fffd||fffd||fffd|sVBA|fffd||193||fffd||fffd||fffd||fffd||a347||fffd||fffd|.|fffd||255||3ca||fffd|
    End If
End Function

'---------------------------------------------------------------------
' |fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[|fffd||fffd||fffd|X|fffd|V
'---------------------------------------------------------------------
Private Sub setProgress(i As Long, msg As String, AppType As String, inFileName As String)
    Dim percent As Double
    Dim percentInt As Long
    Dim progressVal As Double
    Dim thisTime As Single '|fffd||fffd||fffd||74e||fffd||fffd||50c|v|fffd||fffd||fffd|p
    thisTime = Time
    If ((thisTime - finishTime) > 0.000001) Then
        progressApi = progressApiGen(progressApi)
        percent = i / progressMax
        percentInt = Int(percent * 100)
        progressVal = proggressInitWidth * percentInt * 0.01

        UserForm1.Label1.Caption = percentInt & "%|fffd||fffd||fffd||fffd|" & "  " & msg & progressApi
        UserForm1.Progress_FG.Width = 0.1 + proggressInitWidth - progressVal
        UserForm1.Progress_FG.Left = proggressInitLeft + progressVal
        
        '|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
        If UserForm1.IsCancel = True Then
            '|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|o|fffd|[Form|fffd||fffd||82||fffd||fffd||fffd|
            If (AppType = "Word") Then
                wdObj.Documents.Close savechanges:=False
                wdObj.Quit
            ElseIf (AppType = "Excel") Then
                Workbooks(inFileName).Close savechanges:=False
            End If
            Call vbaSuspend 'VBA|fffd||fffd||fffd|s|fffd||fffd||fffd|f
        End If
        finishTime = Time
    End If
    
End Sub

'---------------------------------------------------------------------
' |fffd||fffd||fffd|f|fffd||fffd||fffd||fffd|
'---------------------------------------------------------------------
Sub vbaSuspend()
    Application.ScreenUpdating = True  '|fffd||fffd||282||315|`|fffd||fffd|X|fffd|V|fffd||10a|J
    Application.DisplayAlerts = True '|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||292|m|fffd||fffd||fffd||94|\|fffd||fffd|

    '|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd|o|fffd|[|fffd||fffd||82||fffd||fffd||fffd|
    Unload UserForm1
    '|fffd||a39e||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||d3dc|
    Application.DisplayAlerts = False
    Workbooks(myVbaWorkBookName).Sheets(TempSheetName).Delete
    Application.DisplayAlerts = True
    
    With Workbooks(myVbaWorkBookName).Worksheets(ResultSheet)
         '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14f|I|fffd|s|fffd||24c||fffd||fffd||282||fffd||fffd|o|fffd||fffd|
        .Range("A" & resultLine) = "|fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf||fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||355|s|fffd||fffd||fffd|S|fffd||142||fffd||fffd|B"
        .Range("A" & resultLine).Font.Bold = True '|fffd||fffd||fffd||fffd|
        .Range("A" & resultLine).Font.Color = RGB(0, 160, 60) '|fffd||390|F
    End With

    MsgBox "|fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    Application.Cursor = xlDefault  '|fffd||fffd||fffd||fffd||fffd|v|fffd|\|fffd||fffd||fffd||fffd||7c2||fffd|
    End '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|~
End Sub

'---------------------------------------------------------------------
'  |fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|{|fffd|b|fffd|N|fffd|X|fffd|\|fffd||fffd|
'|fffd|@|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||313||1ce||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|O|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||58f|o|fffd||fffd|
'---------------------------------------------------------------------
Sub logRec()
    Dim newWorkSheet As Worksheet '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g
    Dim Ws As Worksheet, flag As Boolean
    Dim i As Long '|fffd||fffd||fffd|[|fffd|v|fffd|p
    Dim relAd As String '|fffd||fffd||fffd||383|A|fffd|h|fffd||fffd||fffd|X
    Dim timeVal As Double
    timeVal = Int((finishTime - startTime) * 100) / 100
    
    If (errorLogCnt > 0) Then
        Set newWorkSheet = Worksheets.Add()
        newWorkSheet.Name = errorLogSheet
        Workbooks(myVbaWorkBookName).Sheets(errorLogSheet).Move After:=Workbooks(myVbaWorkBookName).Sheets(Sheets.Count)
        
        With Workbooks(myVbaWorkBookName).Worksheets(errorLogSheet)
            .Range("A1") = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|"
            .Range("B1") = "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|"
            .Range("C1") = "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e"
            For i = 0 To errorLogCnt - 1
                    DoEvents
                    .Range("A" & i + 2) = errorLog(i).filePath
                    .Range("B" & i + 2) = errorLog(i).errorNum
                    .Range("C" & i + 2) = errorLog(i).errorContent
            Next
        End With
        Range("A1", "C" & errorLogCnt + 1).WrapText = False
        Workbooks(myVbaWorkBookName).Worksheets(errorLogSheet).Columns("A").AutoFit
'        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C" & resultLine).Activate
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||1ce||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd||1ce||63b8||fffd|s|fffd||fffd||fffd|X|fffd|g|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & _
        vbCrLf & " |fffd|i|fffd||fffd||fffd|s|fffd||fffd||fffd||501|F" & timeVal & "|fffd|b  |fffd||fffd||fffd|s|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & wcnt + xcnt + pptcnt & "|fffd|j")
        ActiveWindow.WindowState = xlMaximized '|fffd|J|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||151||527b|
        '|fffd|V|fffd|[|fffd|g|fffd||fffd|S|fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||502||242||fffd||fffd||90bd||fffd||fffd|1|fffd||fffd||fffd||682||196||693|I|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
        Workbooks(myVbaWorkBookName).Worksheets(1).Activate
        Workbooks(myVbaWorkBookName).Worksheets(errorLogSheet).Activate
    Else
        Application.ScreenUpdating = True '|fffd|`|fffd||fffd|ON
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Range("C2").Activate
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|" & vbCrLf & " |fffd|i|fffd||fffd||fffd|s|fffd||fffd||fffd||501|F" & timeVal & "|fffd|b  |fffd||fffd||fffd|s|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & wcnt + xcnt + pptcnt & "|fffd|j")
        ActiveWindow.WindowState = xlMaximized '|fffd|J|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||151||527b|
        '|fffd|V|fffd|[|fffd|g|fffd||fffd|S|fffd||10c||fffd||fffd||fffd||fffd||fffd||fffd||502||242||fffd||fffd||90bd||fffd||fffd|1|fffd||fffd||fffd||682||196||693|I|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
        Workbooks(myVbaWorkBookName).Worksheets(1).Activate
        Workbooks(myVbaWorkBookName).Worksheets(ResultSheet).Activate
    End If
End Sub

'---------------------------------------------------------------------
' |fffd||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd|
'---------------------------------------------------------------------
Sub CommandButton1_Click()
    Call SearchMain
End Sub

'---------------------------------------------------------------------
' |fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||30e|w|fffd||fffd|
'---------------------------------------------------------------------
Sub CommandButton2_Click()
    With Application.FileDialog(4) 'msoFileDialogFolderPicker(=4)
        If .Show = True Then
            ThisWorkbook.Worksheets(ControlSheet).Range("SearchFolder") = .SelectedItems(1)
        End If
    End With
End Sub

'-------------------------------------------------------------
' |fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||257||5d0||682||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd|True|fffd||fffd||502||fffd|
'  |fffd||fffd||fffd||fffd||fffd||fffd|:|fffd||fffd||fffd||fffd||fffd||38f||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|:|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||7c2||fffd|l|fffd|F|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||202||fffd||fffd||fffd||fffd|True|fffd|A|fffd||fffd||fffd||fffd||fffd|False
'-------------------------------------------------------------
Function justNumCheck(chkStr As String, findStr As String) As Boolean
    Dim i As Long
    Dim leftChar As Variant
    Dim rightChar As Variant
    
    Dim myChkStr As String
    Dim lFindStrIsNum As Boolean
    Dim rFindStrIsNum As Boolean
    Dim lenFindStr As Long
    Dim lenChkStr As Long
    Dim leftIsNN As Boolean '|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd|
    Dim rightIsNN As Boolean '|fffd|E|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd|
    
    myChkStr = chkStr
    
    lFindStrIsNum = IsNumeric(Left(findStr, 1))
    rFindStrIsNum = IsNumeric(Right(findStr, 1))
    lenFindStr = Len(findStr)
    lenChkStr = Len(myChkStr)
        
    If (lenFindStr <> lenChkStr) And (lenChkStr > 1) And (lFindStrIsNum Or rFindStrIsNum) Then
        '|fffd|P|fffd||fffd||fffd||fffd||fffd||682||fffd||fffd||fffd||fffd||fffd||fffd||34d||14f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347|
        Dim strPosition As Long
        Dim scopeChar As String
        justNumCheck = True '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||202||fffd||fffd||fffd||fffd|True|fffd|A|fffd||fffd||fffd||fffd||fffd|False
        strPosition = InStr(1, myChkStr, findStr, vbTextCompare)
        Do While (strPosition > 0)
            'N<Nxxxx>x:|fffd||fffd||fffd|O
            'x<xxxxN>N:|fffd||fffd||fffd|O
            'N<NxxxN>N:|fffd||fffd||fffd|O
            If (strPosition = 1) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c2||308||a576||fffd||fffd||fffd||682||24c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347|
                scopeChar = Left(myChkStr, lenFindStr + 1)
                rightChar = Right(scopeChar, 1)
                leftChar = ""
            ElseIf (strPosition = Len(myChkStr) - lenFindStr + 1) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c2||30d||14f|I|fffd||24c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347|
                scopeChar = Right(myChkStr, lenFindStr + 1)
                rightChar = ""
                leftChar = Left(scopeChar, 1)
            Else '|fffd||fffd||fffd||311||fffd|
                scopeChar = Left(myChkStr, strPosition + lenFindStr)
                scopeChar = Right(scopeChar, lenFindStr + 2)
                rightChar = Right(scopeChar, 1)
                leftChar = Left(scopeChar, 1)
            End If
            '|fffd||fffd||fffd||fffd||fffd||fffd||30d||14f||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd|A|fffd||fffd||fffd||82||fffd||fffd||30d||fffd||fffd||5c2||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
            leftIsNN = lFindStrIsNum And IsNumeric(leftChar)
            '|fffd||fffd||fffd||fffd||fffd||fffd||30d||14c||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd|A|fffd||fffd||fffd||82||fffd||fffd||309|E|fffd||5c2||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
            rightIsNN = lFindStrIsNum And IsNumeric(rightChar)
    
            If (leftIsNN Or rightIsNN) Then
                myChkStr = Right(myChkStr, Len(myChkStr) - strPosition) '|fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||182||fffd||fffd||317||5c2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34c||fffd||fffd||fffd||fffd||38f||6c2||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||5c2||fffd|
                strPosition = InStr(1, myChkStr, findStr, vbTextCompare)
            Else
                justNumCheck = False '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||381|A|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd|o|fffd||fffd|
                Exit Do
            End If
        Loop
    Else
        '|fffd|P|fffd||fffd||fffd||fffd||fffd||682||18d||14f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||202||fffd||fffd||a347|
        justNumCheck = False '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd|
    End If 'If (lFindStrIsNum Or rFindStrIsNum) Then
End Function

'---------------------------------------------------------------------
' chkStr|fffd||312||fffd||fffd||24c||fffd||fffd||fffd||fffd||fffd|(findStr)|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True|fffd||fffd||502||fffd||fffd|i|fffd||5576||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||282||311|I|fffd||fffd||fffd||153||fffd||fffd||fffd||fffd||3c2||fffd||fffd||fffd|j
'---------------------------------------------------------------------
Function justTextCheck(chkStr As String, findStr As String) As Boolean
    Dim myChkStr As String
    myChkStr = chkStr
        
    justTextCheck = False '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||202||fffd||fffd||fffd||fffd|
    If (chkeckBox1Val = True) Then
        '|fffd||5576||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||a347|
        If InStr(1, myChkStr, findStr, vbBinaryCompare) > 0 Then
            justTextCheck = True '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd|
        End If
    Else
        '|fffd||5576||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|S|fffd|p|fffd||fffd||fffd|p)|fffd||fffd||fffd||fffd||282||fffd||fffd||202||fffd||fffd||a347|
        If InStr(1, myChkStr, findStr, vbTextCompare) > 0 Then
            justTextCheck = True '|fffd||fffd||fffd||fffd||fffd||a0aa||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||fffd|
        End If
    End If
End Function

'---------------------------------------------------------------------
' |fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
'---------------------------------------------------------------------
Function getOutlineWord(page As Long, line As Long) As String
    '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd||fffd||80b7||fffd||fffd|
'   Dim getOutlineWord As String   '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim outlineWordSignle As String '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|(|fffd||14f|I|fffd||342||302||fffd|)
    Dim k As Long    '|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|p
    Dim OutlineNumber As String '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||314||50d||fffd|
    getOutlineWord = ""    '|fffd|N|fffd||fffd||fffd|A
    outlineWordSignle = ""  '|fffd|N|fffd||fffd||fffd|A
    For k = 1 To outlineCnt
        DoEvents
        Dim s As Long
        s = outlineCnt - k
        If outlineList(s).page = page Then '|fffd||fffd||fffd||742||303|y|fffd|[|fffd|W|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd|y|fffd|[|fffd|W|fffd||188||fffd|v|fffd||fffd||fffd||fffd||fffd||a347|
            If outlineList(s).line <= line Then '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd|s|fffd||fffd||833b||fffd||742||30d|s|fffd||fffd||fffd||fffd||fffd||7c2||113||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||351||50ab||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||a347|
                getOutlineWord = outlineList(s).indexContent '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
                outlineWordSignle = outlineList(s).indexContentSignle '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd|(|fffd||14f|I|fffd||342||302||fffd|)
                OutlineNumber = outlineList(s).outlineLevel '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||314||50d||fffd|
                Exit For
            End If
        ElseIf outlineList(s).page < page Then '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd|y|fffd|[|fffd|W|fffd||fffd||833b||fffd||742||303|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||7c2||111||50ab||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||a347|
            getOutlineWord = outlineList(s).indexContent '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||313||fffd||fffd|e
            outlineWordSignle = outlineList(s).indexContentSignle '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd|(|fffd||14f|I|fffd||342||302||fffd|)
            OutlineNumber = outlineList(s).outlineLevel '|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd|C|fffd||fffd||fffd||50d||fffd|
            Exit For
        End If
    Next
End Function

'---------------------------------------------------------------------
' |fffd|i|fffd||fffd||fffd|A|fffd|s|fffd|[|fffd||fffd||fffd|p
'---------------------------------------------------------------------
Function progressApiGen(progressApi As String) As String
    If (progressApi = "") Then
        progressApiGen = "."
    ElseIf (progressApi = ".") Then
        progressApiGen = ".."
    ElseIf (progressApi = "..") Then
        progressApiGen = "..."
    Else
        progressApiGen = ""
    End If
End Function


'---------------------------------------------------------------------
' |fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F
'   |fffd|y|fffd||fffd||fffd||fffd||fffd|z
'       BookName: |fffd||fffd||fffd||5c2||90cf||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd|
'   |fffd|y|fffd||7c2||fffd|l|fffd|z
'       True |fffd|c|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd|
'       False|fffd|c|fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd|
'---------------------------------------------------------------------
Public Function BookExists(ByVal BookName As String, Optional Match As Boolean = True) As Boolean
    Dim i         As Long
    Dim sBookName As String
    Dim sTarget   As String

    BookExists = False

    If Trim(BookName) = vbNullString Then
       Exit Function
    End If

    For i = 1 To Workbooks.Count
        DoEvents
        '|fffd||5576||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||282||fffd||fffd||fffd|
        sBookName = Trim(Workbooks(i).Name)
        sTarget = Trim(BookName)

        If sBookName = sTarget Then
           BookExists = True
           Exit For
        End If
    Next
End Function


'---------------------------------------------------------------------
' Word,PowerPoit|fffd||fffd||fffd|C|fffd||fffd||fffd|X|fffd|g|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F
'---------------------------------------------------------------------
Public Sub CheckListInstalledApplication()
    Dim reg As Object
    Dim keys As Variant
    Dim key As Variant
    Dim ret As Long
    Dim display_name As String
    Dim comment4doc As String
    Dim comment4ppt As String
    
    excelIsInstalled = True
    pptIsInstalled = True
    wordIsInstalled = True
    
'    wordIsInstalled = False
'    pptIsInstalled = False
'    Call setProgress(1, "Word,PowerPoint|fffd||fffd||fffd|C|fffd||fffd||fffd|X|fffd|g|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd|", "", "")
'
'    Const HKEY_LOCAL_MACHINE = &H80000002
'    Const SubKeyName = "Software\Microsoft\Windows\CurrentVersion\Uninstall\"
'
'    Set reg = CreateObject("WbemScripting.SWbemLocator").ConnectServer(, "root\default").Get("StdRegProv")
'    reg.EnumKey HKEY_LOCAL_MACHINE, SubKeyName, keys
'    On Error Resume Next
'    For Each key In keys
'        DoEvents
'        display_name = ""
'        ret = reg.GetStringValue(HKEY_LOCAL_MACHINE, SubKeyName & key, "DisplayName", display_name)
'        If ret <> 0 Then ret = reg.GetStringValue(HKEY_LOCAL_MACHINE, SubKeyName & key, "QuietDisplayName", display_name)
'        If (ret = 0) And (Len(Trim(display_name)) > 0) Then
'            If (InStr(display_name, "Microsoft Word")) Then
'                'Debug.Print display_name
'                wordIsInstalled = True
'            ElseIf (InStr(display_name, "PowerPoint")) Then
'                'Debug.Print display_name
'                pptIsInstalled = True
'            ElseIf (InStr(display_name, "Microsoft Office")) Then
'                'Debug.Print display_name
'                wordIsInstalled = True
'            End If
'        End If
'    Next
    
    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||24f|]|fffd||fffd|Word, PowerPoint|fffd||fffd|OFF
    If (chkeckBox3Val = True) Then
        wordIsInstalled = False
    End If
    If (chkeckBox4Val = True) Then
        pptIsInstalled = False
    End If
    If (chkeckBox5Val = True) Then
        excelIsInstalled = False
    End If
    
    On Error GoTo 0
End Sub

'---------------------------------------------------------------------
' |fffd||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||241|AwcWordMatch|fffd||243|}|fffd|b|fffd|`|fffd||fffd||fffd||281|AwcWordTop2End|fffd||243|}|fffd|b|fffd|`|fffd||fffd||fffd||fffd||fffd||6c2||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'---------------------------------------------------------------------
Sub chkWildCardMatch(ByVal oneLine As String, wildcardWords() As String, ByRef wcWordMatch As Boolean, ByRef wcWordTop2End As String)
    Dim wcWord As String
    Dim wcPointer As Long
    Dim m As Long, k As Long
    Dim rmCnt As Long
    wcWord = oneLine
    wcWordTop2End = ""
    wcWordMatch = False
    rmCnt = 0
    
    '|fffd||fffd||314|z|fffd||fffd||fffd||fffd||d3dc|
    For m = 0 To UBound(wildcardWords)
        If (wildcardWords(m) = "") Then
            For k = m To UBound(wildcardWords)
                If (k = UBound(wildcardWords)) Then
                    wildcardWords(k) = ""
                Else
                    wildcardWords(k) = wildcardWords(k + 1)
                End If
            Next
            rmCnt = rmCnt + 1
        End If
    Next
    If (rmCnt > 0) Then
        ReDim Preserve wildcardWords(UBound(wildcardWords) - rmCnt + 1) '|fffd|z|fffd||fffd||fffd||fffd||112||fffd|`
    End If
    
    '|fffd||14f|I|fffd|z|fffd||42a8b||c2f82||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|z|fffd||fffd||1100d||fffd|
    
    For m = 0 To UBound(wildcardWords)
        wcPointer = InStr(wcWord, wildcardWords(m))
        If (wcPointer > 0) Then
            If (m > 0) Then
                wcWordTop2End = wcWordTop2End & Left(wcWord, wcPointer)
            End If
            Dim cutPointer As Long '|fffd||602||fffd||fffd||fffd||292|u
            If (m = 0) Then
                cutPointer = Len(wcWord) - wcPointer + 1
            Else
                cutPointer = Len(wcWord) - wcPointer
            End If
            If (cutPointer > 0) Then
                wcWord = Right(wcWord, cutPointer)
            Else
                wcWord = ""
            End If
            '|fffd||14c||fffd||702||143||fffd||fffd|C|fffd||fffd||fffd|h|fffd|J|fffd|[|fffd|h|fffd||30f||fffd||fffd||fffd||fffd||24d||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|True
            If (m = UBound(wildcardWords)) Then wcWordMatch = True
        End If
    Next
End Sub





Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'---------------------------------------------------------------------
' |fffd|V|fffd|[|fffd|g|fffd||314|C|fffd||4c2||30d|s|fffd||fffd||fffd|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||191|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|A|fffd|w|fffd||fffd||30f||a3ca||fffd||583|J|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||d0b9||fffd||fffd|
'---------------------------------------------------------------------
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim docName As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim docPath As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X|fffd||fffd|(|fffd|t|fffd||fffd||fffd|p|fffd|X)
    Dim sheetRow As Long '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s
    Dim i '|fffd||fffd||fffd|[|fffd|v|fffd|p
    Dim fullPathName As String '|fffd|t|fffd||fffd||fffd|p|fffd|X
    Dim fileExsist As Boolean '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd|True
    
    Dim objFileSys As Object '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||314||fffd||fffd||282||24e|g|fffd|p
    Set objFileSys = CreateObject("Scripting.FileSystemObject")
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    sheetRow = ActiveCell.Row
    docName = ActiveSheet.Range("D" & sheetRow)
    docPath = ActiveSheet.Range("C" & sheetRow) & "\" & ActiveSheet.Range("D" & sheetRow)
    docPath = relativeToAbsPath(docPath) '|fffd||fffd||fffd||383|A|fffd|h|fffd||fffd||fffd|X|fffd||255||3ca||fffd|
    Application.StatusBar = docPath & "|fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||702||fffd|"
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||314||fffd||fffd||80b5||fffd|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Dim tmpStr As String
    On Error GoTo fopenError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
    tmpStr = objFileSys.GetFile(docPath).Type
    
    Dim pageNo As Long '|fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim lineNo As Long '|fffd|s|fffd||fffd|
    Dim tmpArray As Variant '|fffd||fffd||450||fffd||303|A|fffd|h|fffd||fffd||fffd|X(Excel:|fffd|Z|fffd||fffd||fffd|AWord:|fffd|y|fffd|[|fffd|W)
    
    Application.ScreenUpdating = True '|fffd||fffd||282||30d|X|fffd|VON
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|OFF
    
    If (InStr(tmpStr, "Word") > 0) Then
        '----------------------------------
        ' Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim wdObj As Object 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
        Dim myAppOpen As Boolean
        
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|y|fffd|[|fffd|W/|fffd|s|fffd||fffd||fffd||fffd||fffd||64fe|
        pageNo = ActiveSheet.Range("F" & sheetRow)
        
        tmpArray = Split(ActiveSheet.Range("G" & sheetRow), "(")
        lineNo = tmpArray(0) - 1
        If (lineNo < 0) Then
            lineNo = 0
        End If
        
        
        On Error GoTo ErrRtn
        Set wdObj = GetObject(, "Word.Application") '
        ' Word|fffd||303|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|X|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||202||fffd|A|fffd||283|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F
        For i = 1 To wdObj.Documents.Count
            If ((Not (wdObj.Documents(i).path & "\" & wdObj.Documents(i).Name = docPath)) And _
                 (wdObj.Documents(i).Name = docName)) Then
                Set wdObj = Nothing
                GoTo sameFileError '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||34a|J|fffd||fffd||fffd||202||fffd|
            End If
        Next
        myAppOpen = True
        
MacroContinue:
        ' Word|fffd||303|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|X|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
        If myAppOpen = False Then
            Set wdObj = CreateObject("Word.Application")
        End If
        
        wdObj.Visible = True 'Word|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
        On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
        wdObj.Documents.Open (docPath)
        wdObj.Selection.GoTo What:=1, Which:=1, Count:=pageNo 'wdGoToPage(=1),wdGoToAbsolute(=1)
        wdObj.Selection.GoTo What:=3, Which:=2, Count:=lineNo 'wdGoToLine(=3),wdGoToNext(=2)
        wdObj.Activate
                        
        Set wdObj = Nothing
        Application.StatusBar = False
        Exit Sub
ErrRtn:
        If Err.Number = 429 Then '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|G|fffd||fffd||fffd|[
            myAppOpen = False
            Resume MacroContinue
        End If
        Application.StatusBar = False
        Exit Sub
        
    ElseIf (InStr(tmpStr, "Excel") > 0) Then
        '----------------------------------
        ' Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim selSheet As String
        selSheet = ActiveSheet.Range("E" & sheetRow)
        
        Dim Ws As Worksheet, flag As Boolean
        Dim wsIndex As Long '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||50d||fffd|
        wsIndex = 1
                
        '|fffd|J|fffd||fffd||fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
        tmpArray = Split(ActiveSheet.Range("G" & sheetRow), "(")
        selPosition = tmpArray(0)
        
        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F
        fileExsist = False
        On Error GoTo excelExistTag
        Workbooks(docPath).Activate
        fileExsist = True
excelExistTag:
        Resume clearErrTrap '|fffd|G|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Resume
clearErrTrap:
        If (fileExsist = False) Then
            Application.DisplayAlerts = False '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|ON
            On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            If (InStr(docPath, ".csv") > 0) Then
                Workbooks.Open FileName:=docPath, Format:=2 '|fffd|J|fffd||fffd||fffd|}|fffd||fffd||602||fffd||14a|J|fffd||fffd|
            Else
                Workbooks.Open FileName:=docPath
            End If
            Application.DisplayAlerts = True  '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|OFF
        End If
            
        '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||50d||fffd||fffd||fffd||fffd||64fe|
        For Each Ws In Workbooks(docName).Worksheets
            DoEvents
            If Ws.Name = selSheet Then wsIndex = Ws.Index
        Next Ws

        Workbooks(docName).Worksheets(wsIndex).Activate '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||102||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|I|fffd||fffd|
        Workbooks(docName).Worksheets(wsIndex).Range(selPosition).Activate
    
    
    ElseIf (InStr(tmpStr, "PowerPoint") > 0) Then
        '----------------------------------
        ' PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim pptObj As Object 'PowerPoint|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd|
        Dim pdocObj As Object 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd|
        Dim pptExistTag As Boolean '|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd|True
        Dim shapeName As String '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|
        Dim shapeID As String '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|ID
        Dim shapeIDNum As Long  '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|ID(Long|fffd|^)
        
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|y|fffd|[|fffd|W/|fffd|s|fffd||fffd||fffd||fffd||fffd||64fe|
        pageNo = ActiveSheet.Range("F" & sheetRow)
        tmpArray = Split(ActiveSheet.Range("E" & sheetRow), "(ID:")
        shapeName = tmpArray(0)
        shapeID = tmpArray(1)
        shapeID = Replace(shapeID, ")", "")
        shapeIDNum = Val(shapeID)
        
        '------------------
        '|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
        '------------------
        Set pptObj = CreateObject("PowerPoint.Application")
        pptObj.Visible = True 'PowerPoint|fffd|A|fffd|v|fffd||fffd||fffd||fffd|\|fffd||fffd|
        fileExsist = False '|fffd||fffd||fffd||fffd||fffd||fffd|
                
        For i = 1 To pptObj.Presentations.Count
            fullPathName = pptObj.Presentations(i).path & "\" & pptObj.Presentations(i).Name '|fffd||fffd||fffd||74a|J|fffd||fffd||fffd||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd||c42c|
            If (pptObj.Presentations(i).Name = docName) Then '|fffd||fffd||fffd||a0a9||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd|p|fffd|X|fffd||194||fffd|r
                If (fullPathName = docPath) Then '|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
                    fileExsist = True
                    Exit For
                Else '|fffd||642||202||fffd|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
                    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1c2||74e||fffd||fffd|G|fffd||fffd||fffd|[" & vbCrLf _
                    & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
                    fileExsist = True
                    Application.StatusBar = False
                    Exit Sub
                End If
            End If
        Next i
        
        If (fileExsist = False) Then
            '|fffd|V|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
            On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            pptObj.Presentations.Open (docPath) '|fffd|V|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
            pptObj.Presentations(docPath).Windows(1).Activate '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
            pptObj.ActiveWindow.View.GotoSlide Index:=Int(pageNo) '|fffd||fffd|U|fffd|y|fffd|[|fffd|W|fffd||302||748||693||fffd|
            pptObj.Presentations(docPath).Slides(pageNo).Select '|fffd|y|fffd|[|fffd|W|fffd||fffd|I|fffd||fffd|
            '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|I|fffd||fffd|
            With pptObj.Presentations(docPath).Slides(pageNo)
                For i = 1 To .Shapes.Count
                    If (shapeName = .Shapes(i).Name) And (.Shapes(i).ID = shapeIDNum) Then
                        .Shapes(i).Select
                    End If
                Next
            End With
        Else
            '|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347|
            On Error GoTo pptFileOpenError '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74f|o|fffd||fffd||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            Set pdocObj = GetObject(docPath) '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe|
            pdocObj.Application.Presentations(docPath).Windows(1).Activate '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
            pdocObj.Application.Presentations(docPath).Slides(pageNo).Select '|fffd|y|fffd|[|fffd|W|fffd||fffd|I|fffd||fffd|
            '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|I|fffd||fffd|
            With pdocObj.Application.Presentations(docPath).Slides(pageNo)
                For i = 1 To .Shapes.Count
                    If (shapeName = .Shapes(i).Name) And (.Shapes(i).ID = shapeIDNum) Then
                        .Shapes(i).Select
                    End If
                Next
            End With
        End If
    End If
    
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    
    Exit Sub

fopenError: '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|G|fffd||fffd||fffd|[
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

sameFileError: '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1c2||74e||fffd||fffd|G|fffd||fffd||fffd|[
    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1ce||fffd|G|fffd||fffd||fffd|[" & vbCrLf & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

pptFileOpenError: '|fffd||10a4||fffd||a3ca||fffd||313||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||a347|
    pptObj.Quit
    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1ce||fffd|G|fffd||fffd||fffd|[" & vbCrLf & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

End Sub

'---------------------------------------------------------------------
' |fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||383|p|fffd|X|fffd||255||3ca||fffd|
'---------------------------------------------------------------------
Function relativeToAbsPath(filePath As String) As String
    Dim i As Long
    Dim arrayF() As String
    Dim arrayC() As String
    Dim currentPath As String '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath(|fffd||fffd||fffd||fffd|VBA|fffd||303|p|fffd|X)
    currentPath = ActiveWorkbook.path '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath|fffd||fffd||fffd||64fe|
        
    filePath = Replace(filePath, "/", "\")
    currentPath = Replace(currentPath, "/", "\")
    
    arrayF = Split(filePath, "\")
    arrayC = Split(currentPath, "\")
    
    '|fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||14ed2||fffd|
    Dim sameArrayNum As Long
    Dim driveName As String
    If ((InStr(arrayF(0), ":") > 0) Or (InStr(Left(filePath, 2), "\\") > 0)) Then '|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|h|fffd||fffd||fffd|C|fffd|u|fffd||30f||a347|
        driveName = Left(arrayF(0), InStr(arrayF(0), ":"))
        If (arrayF(0) <> driveName & ":") Then
            relativeToAbsPath = filePath
            Exit Function
        End If
    Else
        '|fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||383|p|fffd|X|fffd||255||3ca||fffd|.
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4cf||fffd||fffd||fffd|<DEL>|fffd||255||3ca||fffd||fffd||fffd||fffd|A|fffd||30a9||fffd||fffd||d3dc|.<DEL>|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||182||fffd||fffd||10e|g|fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||fffd|
        ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||24a||fffd||fffd||84d6||fffd||102||fffd||fffd||90b1||fffd||182||202||fffd||fffd||fffd||fffd|S|fffd||255||3ca||fffd||fffd||142||fffd||fffd||fffd|
        For i = 0 To UBound(arrayF)
            If (arrayF(i) = "..") Then
                arrayC(UBound(arrayC) - i) = "<DEL>"
                arrayF(i) = "<DEL>"
            End If
        Next
        Dim tmpStr As String
        tmpStr = Join(arrayC, "\") & "\" & Join(arrayF, "\")
        relativeToAbsPath = Replace(tmpStr, "<DEL>\", "")
    End If
End Function


Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'---------------------------------------------------------------------
' |fffd|V|fffd|[|fffd|g|fffd||314|C|fffd||4c2||30d|s|fffd||fffd||fffd|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||191|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||24b|L|fffd||682||fffd||fffd||a0bd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|A|fffd|w|fffd||fffd||30f||a3ca||fffd||583|J|fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||d0b9||fffd||fffd|
'---------------------------------------------------------------------
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim docName As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim docPath As String '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X|fffd||fffd|(|fffd|t|fffd||fffd||fffd|p|fffd|X)
    Dim sheetRow As Long '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s
    Dim i '|fffd||fffd||fffd|[|fffd|v|fffd|p
    Dim fullPathName As String '|fffd|t|fffd||fffd||fffd|p|fffd|X
    Dim fileExsist As Boolean '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd|True
    
    Dim objFileSys As Object '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||314||fffd||fffd||282||24e|g|fffd|p
    Set objFileSys = CreateObject("Scripting.FileSystemObject")
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    sheetRow = ActiveCell.Row
    docName = ActiveSheet.Range("D" & sheetRow)
    docPath = ActiveSheet.Range("C" & sheetRow) & "\" & ActiveSheet.Range("D" & sheetRow)
    docPath = relativeToAbsPath(docPath) '|fffd||fffd||fffd||383|A|fffd|h|fffd||fffd||fffd|X|fffd||255||3ca||fffd|
    Application.StatusBar = docPath & "|fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||702||fffd|"
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||314||fffd||fffd||80b5||fffd|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Dim tmpStr As String
    On Error GoTo fopenError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
    tmpStr = objFileSys.GetFile(docPath).Type
    
    Dim pageNo As Long '|fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim lineNo As Long '|fffd|s|fffd||fffd|
    Dim tmpArray As Variant '|fffd||fffd||450||fffd||303|A|fffd|h|fffd||fffd||fffd|X(Excel:|fffd|Z|fffd||fffd||fffd|AWord:|fffd|y|fffd|[|fffd|W)
    
    Application.ScreenUpdating = True '|fffd||fffd||282||30d|X|fffd|VON
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|OFF
    
    If (InStr(tmpStr, "Word") > 0) Then
        '----------------------------------
        ' Word|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim wdObj As Object 'Word|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
        Dim myAppOpen As Boolean
        
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|y|fffd|[|fffd|W/|fffd|s|fffd||fffd||fffd||fffd||fffd||64fe|
        pageNo = ActiveSheet.Range("F" & sheetRow)
        
        tmpArray = Split(ActiveSheet.Range("G" & sheetRow), "(")
        lineNo = tmpArray(0) - 1
        If (lineNo < 0) Then
            lineNo = 0
        End If
        
        
        On Error GoTo ErrRtn
        Set wdObj = GetObject(, "Word.Application") '
        ' Word|fffd||303|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|X|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||202||fffd|A|fffd||283|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F
        For i = 1 To wdObj.Documents.Count
            If ((Not (wdObj.Documents(i).path & "\" & wdObj.Documents(i).Name = docPath)) And _
                 (wdObj.Documents(i).Name = docName)) Then
                Set wdObj = Nothing
                GoTo sameFileError '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||34a|J|fffd||fffd||fffd||202||fffd|
            End If
        Next
        myAppOpen = True
        
MacroContinue:
        ' Word|fffd||303|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|X|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
        If myAppOpen = False Then
            Set wdObj = CreateObject("Word.Application")
        End If
        
        wdObj.Visible = True 'Word|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd|
        On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
        wdObj.Documents.Open (docPath)
        wdObj.Selection.GoTo What:=1, Which:=1, Count:=pageNo 'wdGoToPage(=1),wdGoToAbsolute(=1)
        wdObj.Selection.GoTo What:=3, Which:=2, Count:=lineNo 'wdGoToLine(=3),wdGoToNext(=2)
        wdObj.Activate
                        
        Set wdObj = Nothing
        Application.StatusBar = False
        Exit Sub
ErrRtn:
        If Err.Number = 429 Then '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|G|fffd||fffd||fffd|[
            myAppOpen = False
            Resume MacroContinue
        End If
        Application.StatusBar = False
        Exit Sub
        
    ElseIf (InStr(tmpStr, "Excel") > 0) Then
        '----------------------------------
        ' Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim selSheet As String
        selSheet = ActiveSheet.Range("E" & sheetRow)
        
        Dim Ws As Worksheet, flag As Boolean
        Dim wsIndex As Long '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||50d||fffd|
        wsIndex = 1
                
        '|fffd|J|fffd||fffd||fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
        tmpArray = Split(ActiveSheet.Range("G" & sheetRow), "(")
        selPosition = tmpArray(0)
        
        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F
        fileExsist = False
        On Error GoTo excelExistTag
        Workbooks(docPath).Activate
        fileExsist = True
excelExistTag:
        Resume clearErrTrap '|fffd|G|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Resume
clearErrTrap:
        If (fileExsist = False) Then
            Application.DisplayAlerts = False '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|ON
            On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            If (InStr(docPath, ".csv") > 0) Then
                Workbooks.Open FileName:=docPath, Format:=2 '|fffd|J|fffd||fffd||fffd|}|fffd||fffd||602||fffd||14a|J|fffd||fffd|
            Else
                Workbooks.Open FileName:=docPath
            End If
            Application.DisplayAlerts = True  '|fffd|x|fffd||fffd||fffd||315|\|fffd||fffd|OFF
        End If
            
        '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||50d||fffd||fffd||fffd||fffd||64fe|
        For Each Ws In Workbooks(docName).Worksheets
            DoEvents
            If Ws.Name = selSheet Then wsIndex = Ws.Index
        Next Ws

        Workbooks(docName).Worksheets(wsIndex).Activate '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||102||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|I|fffd||fffd|
        Workbooks(docName).Worksheets(wsIndex).Range(selPosition).Activate
    
    
    ElseIf (InStr(tmpStr, "PowerPoint") > 0) Then
        '----------------------------------
        ' PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|L|fffd|q
        '----------------------------------
        Dim pptObj As Object 'PowerPoint|fffd|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd|
        Dim pdocObj As Object 'PowerPoint|fffd|t|fffd|@|fffd|C|fffd||fffd|
        Dim pptExistTag As Boolean '|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd|True
        Dim shapeName As String '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|
        Dim shapeID As String '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|ID
        Dim shapeIDNum As Long  '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|ID(Long|fffd|^)
        
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||303|y|fffd|[|fffd|W/|fffd|s|fffd||fffd||fffd||fffd||fffd||64fe|
        pageNo = ActiveSheet.Range("F" & sheetRow)
        tmpArray = Split(ActiveSheet.Range("E" & sheetRow), "(ID:")
        shapeName = tmpArray(0)
        shapeID = tmpArray(1)
        shapeID = Replace(shapeID, ")", "")
        shapeIDNum = Val(shapeID)
        
        '------------------
        '|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
        '------------------
        Set pptObj = CreateObject("PowerPoint.Application")
        pptObj.Visible = True 'PowerPoint|fffd|A|fffd|v|fffd||fffd||fffd||fffd|\|fffd||fffd|
        fileExsist = False '|fffd||fffd||fffd||fffd||fffd||fffd|
                
        For i = 1 To pptObj.Presentations.Count
            fullPathName = pptObj.Presentations(i).path & "\" & pptObj.Presentations(i).Name '|fffd||fffd||fffd||74a|J|fffd||fffd||fffd||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd||c42c|
            If (pptObj.Presentations(i).Name = docName) Then '|fffd||fffd||fffd||a0a9||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd|p|fffd|X|fffd||194||fffd|r
                If (fullPathName = docPath) Then '|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
                    fileExsist = True
                    Exit For
                Else '|fffd||642||202||fffd|p|fffd|X|fffd||313||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
                    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1c2||74e||fffd||fffd|G|fffd||fffd||fffd|[" & vbCrLf _
                    & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
                    fileExsist = True
                    Application.StatusBar = False
                    Exit Sub
                End If
            End If
        Next i
        
        If (fileExsist = False) Then
            '|fffd|V|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||a347|
            On Error GoTo sameFileError '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            pptObj.Presentations.Open (docPath) '|fffd|V|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
            pptObj.Presentations(docPath).Windows(1).Activate '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
            pptObj.ActiveWindow.View.GotoSlide Index:=Int(pageNo) '|fffd||fffd|U|fffd|y|fffd|[|fffd|W|fffd||302||748||693||fffd|
            pptObj.Presentations(docPath).Slides(pageNo).Select '|fffd|y|fffd|[|fffd|W|fffd||fffd|I|fffd||fffd|
            '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|I|fffd||fffd|
            With pptObj.Presentations(docPath).Slides(pageNo)
                For i = 1 To .Shapes.Count
                    If (shapeName = .Shapes(i).Name) And (.Shapes(i).ID = shapeIDNum) Then
                        .Shapes(i).Select
                    End If
                Next
            End With
        Else
            '|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347|
            On Error GoTo pptFileOpenError '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74f|o|fffd||fffd||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
            Set pdocObj = GetObject(docPath) '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe|
            pdocObj.Application.Presentations(docPath).Windows(1).Activate '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
            pdocObj.Application.Presentations(docPath).Slides(pageNo).Select '|fffd|y|fffd|[|fffd|W|fffd||fffd|I|fffd||fffd|
            '|fffd|V|fffd|F|fffd|C|fffd|v|fffd||fffd|I|fffd||fffd|
            With pdocObj.Application.Presentations(docPath).Slides(pageNo)
                For i = 1 To .Shapes.Count
                    If (shapeName = .Shapes(i).Name) And (.Shapes(i).ID = shapeIDNum) Then
                        .Shapes(i).Select
                    End If
                Next
            End With
        End If
    End If
    
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    
    Exit Sub

fopenError: '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|G|fffd||fffd||fffd|[
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

sameFileError: '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1c2||74e||fffd||fffd|G|fffd||fffd||fffd|[
    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1ce||fffd|G|fffd||fffd||fffd|[" & vbCrLf & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

pptFileOpenError: '|fffd||10a4||fffd||a3ca||fffd||313||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||a347|
    pptObj.Quit
    MsgBox ("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1ce||fffd|G|fffd||fffd||fffd|[" & vbCrLf & "|fffd|i|fffd|\|fffd||fffd||fffd||c2c82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||13bce||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||fffd||182||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j")
    Application.DisplayAlerts = True '|fffd|x|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    Application.StatusBar = False
    Exit Sub

End Sub

'---------------------------------------------------------------------
' |fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||383|p|fffd|X|fffd||255||3ca||fffd|
'---------------------------------------------------------------------
Function relativeToAbsPath(filePath As String) As String
    Dim i As Long
    Dim arrayF() As String
    Dim arrayC() As String
    Dim currentPath As String '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath(|fffd||fffd||fffd||fffd|VBA|fffd||303|p|fffd|X)
    currentPath = ActiveWorkbook.path '|fffd|J|fffd||fffd||fffd||fffd||fffd|gPath|fffd||fffd||fffd||64fe|
        
    filePath = Replace(filePath, "/", "\")
    currentPath = Replace(currentPath, "/", "\")
    
    arrayF = Split(filePath, "\")
    arrayC = Split(currentPath, "\")
    
    '|fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||14ed2||fffd|
    Dim sameArrayNum As Long
    Dim driveName As String
    If ((InStr(arrayF(0), ":") > 0) Or (InStr(Left(filePath, 2), "\\") > 0)) Then '|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|h|fffd||fffd||fffd|C|fffd|u|fffd||30f||a347|
        driveName = Left(arrayF(0), InStr(arrayF(0), ":"))
        If (arrayF(0) <> driveName & ":") Then
            relativeToAbsPath = filePath
            Exit Function
        End If
    Else
        '|fffd||fffd||fffd||383|p|fffd|X|fffd||fffd||fffd||383|p|fffd|X|fffd||255||3ca||fffd|.
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4cf||fffd||fffd||fffd|<DEL>|fffd||255||3ca||fffd||fffd||fffd||fffd|A|fffd||30a9||fffd||fffd||d3dc|.<DEL>|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||182||fffd||fffd||10e|g|fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||fffd|
        ' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||24a||fffd||fffd||84d6||fffd||102||fffd||fffd||90b1||fffd||182||202||fffd||fffd||fffd||fffd|S|fffd||255||3ca||fffd||fffd||142||fffd||fffd||fffd|
        For i = 0 To UBound(arrayF)
            If (arrayF(i) = "..") Then
                arrayC(UBound(arrayC) - i) = "<DEL>"
                arrayF(i) = "<DEL>"
            End If
        Next
        Dim tmpStr As String
        tmpStr = Join(arrayC, "\") & "\" & Join(arrayF, "\")
        relativeToAbsPath = Replace(tmpStr, "<DEL>\", "")
    End If
End Function


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{185DC176-B4B5-4F5C-A12B-3CD82D5D12E6}{9639DF51-DE6E-4E32-ADF1-8E7F1F1429A6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd|t|fffd||fffd||fffd|O
Public IsCancel As Boolean

Private Sub UserForm_Initialize()
    IsCancel = False
End Sub

'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|C|fffd|x|fffd||fffd||fffd|g
Private Sub ButtonCancel_Click()
    '|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||fffd|True|fffd||fffd||752||fffd|
    IsCancel = True
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = vbFormControlMenu Then
        Cancel = True
        IsCancel = True
    End If
End Sub


INQUEST-PP=macro
