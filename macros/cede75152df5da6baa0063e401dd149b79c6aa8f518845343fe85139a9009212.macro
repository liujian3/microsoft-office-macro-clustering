Attribute VB_Name = "Modul1"
Global Feldbezeichnung$(1 To 1000)
Sub AutoOpen()
Feldbezeichnung$(1) = "Deckblatt: <Zwischen:...>"
Feldbezeichnung$(3) = "Deckblatt: <wird f|fffd|r...>"
Feldbezeichnung$(4) = "Deckblatt: <Standort(e) der Anlage(n)>"
Feldbezeichnung$(5) = "Deckblatt: <Betreiber der Anlagen(n)>"
Feldbezeichnung$(6) = "Deckblatt: Datum Grundvertrag"
Feldbezeichnung$(2) = "Ziff. 2.2 St|fffd|rungsbeseitigungsfrist"
Feldbezeichnung$(7) = "Ziff. 2.3 Ausf|fffd|hrungszeit/Periode St|fffd|rungsbeseitigung: ganzj|fffd|hrig/Heizperiode"
Feldbezeichnung$(8) = "Ziff. 2.3 Arbeitszeit St|fffd|rungsbeseitigung"
Feldbezeichnung$(9) = "Ziff. 2.3 Konkretisierung St|fffd|rungsbeseitigung au|fffd|erhalb der betriebs|fffd|blichen Arbeitszeit"
Feldbezeichnung$(21) = "Ziff. 2.4 (9) Kontrollk|fffd|stchen markiert aber Textfeld"
Feldbezeichnung$(22) = "Ziff. 2.4 (10) Kontrollk|fffd|stchen markiert aber Textfeld"
Feldbezeichnung$(23) = "Ziff. 2.4 (11) Kontrollk|fffd|stchen markiert aber Textfeld"
Feldbezeichnung$(24) = "Ziff. 2.4 (12) Kontrollk|fffd|stchen markiert aber Textfeld"
Feldbezeichnung$(10) = "Ziff. 2.6 Datum Arbeitsbericht"
Feldbezeichnung$(11) = "Ziff. 3.1 Eingabe Umsatzsteuer"
Feldbezeichnung$(12) = "Ziff. 3.1 Eingabe pauschale Arbeitszeit"
Feldbezeichnung$(13) = "Ziff. 3.1 Eingabe Materialkostenpauschale"
Feldbezeichnung$(14) = "Ziff. 4 Auswahl Vertragsbeginn"
Feldbezeichnung$(15) = "Ziff. 4 Datum Vertragsbeginn"
Feldbezeichnung$(16) = "Ziff. 4 Laufzeit"
Feldbezeichnung$(17) = "Ziff. 4 Laufzeitverl|fffd|ngerung"
Feldbezeichnung$(18) = "Deckblatt: <...und der Firma...>"
Feldbezeichnung$(19) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 1"
Feldbezeichnung$(29) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 2"
Feldbezeichnung$(30) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 3"
Feldbezeichnung$(31) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 4"
Feldbezeichnung$(32) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 5"
Feldbezeichnung$(33) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 6"
Feldbezeichnung$(34) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 7"
Feldbezeichnung$(35) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 8"
Feldbezeichnung$(36) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 9"
Feldbezeichnung$(37) = "Ziff. 3: Verg|fffd|tung <F|fffd|r...>, Zeile 10"
Feldbezeichnung$(20) = "Ziff. 3: Verg|fffd|tungsh|fffd|he, <...von...>"
Feldbezeichnung$(25) = "Unterzeichnungsort Auftraggeber"
Feldbezeichnung$(26) = "Unterzeichnungsdarum Auftraggeber"
Feldbezeichnung$(27) = "Unterzeichnungsort Auftragnehmer"
Feldbezeichnung$(28) = "Unterzeichnungsdarum Auftragnehmer"
MsgBox "Hinweis 1:" & Chr(13) & Chr(13) & "Bitte speichern Sie dieses Dokument vor dem Bearbeiten " & Chr(13) & "unter einem neuen Dateinamen, um das Original als " & Chr(13) & "Sicherheitskopie zu erhalten.", 48, "Eletronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
MsgBox "Hinweis 2:" & Chr(13) & Chr(13) & "Bitte |fffd|ndern Sie die Zoomstufe der Anzeige beim Ausf|fffd|llen, falls Feldinhalte schlecht lesbar sein sollten.", 48, "Eletronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
End Sub


Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "TB99, 86, 2, MSForms, TextBox"
Attribute VB_Control = "AN_pruefen, 85, 3, MSForms, CommandButton"
Attribute VB_Control = "AG_pruefen, 84, 4, MSForms, CommandButton"
Attribute VB_Control = "TB39, 83, 5, MSForms, TextBox"
Attribute VB_Control = "TB38, 82, 6, MSForms, TextBox"
Attribute VB_Control = "TB37, 81, 7, MSForms, TextBox"
Attribute VB_Control = "TB36, 80, 8, MSForms, TextBox"
Attribute VB_Control = "OB74, 79, 9, MSForms, OptionButton"
Attribute VB_Control = "OB73, 78, 10, MSForms, OptionButton"
Attribute VB_Control = "TB35, 77, 11, MSForms, TextBox"
Attribute VB_Control = "TB34, 76, 12, MSForms, TextBox"
Attribute VB_Control = "OB72, 75, 13, MSForms, OptionButton"
Attribute VB_Control = "OB71, 74, 14, MSForms, OptionButton"
Attribute VB_Control = "TB33, 73, 15, MSForms, TextBox"
Attribute VB_Control = "TB32, 72, 16, MSForms, TextBox"
Attribute VB_Control = "OB62, 71, 17, MSForms, OptionButton"
Attribute VB_Control = "OB61, 70, 18, MSForms, OptionButton"
Attribute VB_Control = "TB30, 69, 19, MSForms, TextBox"
Attribute VB_Control = "TB29, 68, 20, MSForms, TextBox"
Attribute VB_Control = "TB31, 67, 21, MSForms, TextBox"
Attribute VB_Control = "TB28, 66, 22, MSForms, TextBox"
Attribute VB_Control = "TB276, 65, 23, MSForms, TextBox"
Attribute VB_Control = "TB266, 64, 24, MSForms, TextBox"
Attribute VB_Control = "CB310, 63, 25, MSForms, CheckBox"
Attribute VB_Control = "TB275, 62, 26, MSForms, TextBox"
Attribute VB_Control = "TB265, 61, 27, MSForms, TextBox"
Attribute VB_Control = "CB39, 60, 28, MSForms, CheckBox"
Attribute VB_Control = "TB274, 59, 29, MSForms, TextBox"
Attribute VB_Control = "TB264, 58, 30, MSForms, TextBox"
Attribute VB_Control = "CB38, 57, 31, MSForms, CheckBox"
Attribute VB_Control = "TB273, 56, 32, MSForms, TextBox"
Attribute VB_Control = "TB263, 55, 33, MSForms, TextBox"
Attribute VB_Control = "CB37, 54, 34, MSForms, CheckBox"
Attribute VB_Control = "TB272, 53, 35, MSForms, TextBox"
Attribute VB_Control = "TB262, 52, 36, MSForms, TextBox"
Attribute VB_Control = "CB36, 51, 37, MSForms, CheckBox"
Attribute VB_Control = "TB271, 50, 38, MSForms, TextBox"
Attribute VB_Control = "TB261, 49, 39, MSForms, TextBox"
Attribute VB_Control = "CB35, 48, 40, MSForms, CheckBox"
Attribute VB_Control = "TB27, 47, 41, MSForms, TextBox"
Attribute VB_Control = "TB26, 46, 42, MSForms, TextBox"
Attribute VB_Control = "CB34, 45, 43, MSForms, CheckBox"
Attribute VB_Control = "TB25, 44, 44, MSForms, TextBox"
Attribute VB_Control = "TB24, 43, 45, MSForms, TextBox"
Attribute VB_Control = "CB33, 42, 46, MSForms, CheckBox"
Attribute VB_Control = "TB23, 41, 47, MSForms, TextBox"
Attribute VB_Control = "TB22, 40, 48, MSForms, TextBox"
Attribute VB_Control = "CB32, 39, 49, MSForms, CheckBox"
Attribute VB_Control = "TB21, 38, 50, MSForms, TextBox"
Attribute VB_Control = "TB20, 37, 51, MSForms, TextBox"
Attribute VB_Control = "CB16, 36, 52, MSForms, CheckBox"
Attribute VB_Control = "CB15, 35, 53, MSForms, CheckBox"
Attribute VB_Control = "CB14, 34, 54, MSForms, CheckBox"
Attribute VB_Control = "CB13, 33, 55, MSForms, CheckBox"
Attribute VB_Control = "TB19, 32, 56, MSForms, TextBox"
Attribute VB_Control = "TB18, 31, 57, MSForms, TextBox"
Attribute VB_Control = "CB12, 30, 58, MSForms, CheckBox"
Attribute VB_Control = "TB17, 29, 59, MSForms, TextBox"
Attribute VB_Control = "CB11, 28, 60, MSForms, CheckBox"
Attribute VB_Control = "TB16, 27, 61, MSForms, TextBox"
Attribute VB_Control = "CB10, 26, 62, MSForms, CheckBox"
Attribute VB_Control = "TB15, 25, 63, MSForms, TextBox"
Attribute VB_Control = "CB9, 24, 64, MSForms, CheckBox"
Attribute VB_Control = "CB8, 23, 65, MSForms, CheckBox"
Attribute VB_Control = "CB7, 22, 66, MSForms, CheckBox"
Attribute VB_Control = "CB6, 21, 67, MSForms, CheckBox"
Attribute VB_Control = "CB5, 20, 68, MSForms, CheckBox"
Attribute VB_Control = "CB4, 19, 69, MSForms, CheckBox"
Attribute VB_Control = "CB3, 18, 70, MSForms, CheckBox"
Attribute VB_Control = "CB2, 17, 71, MSForms, CheckBox"
Attribute VB_Control = "CB1, 16, 72, MSForms, CheckBox"
Attribute VB_Control = "TB13, 15, 73, MSForms, TextBox"
Attribute VB_Control = "OB23, 14, 74, MSForms, OptionButton"
Attribute VB_Control = "OB22, 13, 75, MSForms, OptionButton"
Attribute VB_Control = "OB21, 12, 76, MSForms, OptionButton"
Attribute VB_Control = "OB12, 11, 77, MSForms, OptionButton"
Attribute VB_Control = "OB11, 10, 78, MSForms, OptionButton"
Attribute VB_Control = "TB12, 9, 79, MSForms, TextBox"
Attribute VB_Control = "TB3, 8, 80, MSForms, TextBox"
Attribute VB_Control = "TB11, 7, 81, MSForms, TextBox"
Attribute VB_Control = "TB10, 6, 82, MSForms, TextBox"
Attribute VB_Control = "TB9, 5, 83, MSForms, TextBox"
Attribute VB_Control = "TB8, 4, 84, MSForms, TextBox"
Attribute VB_Control = "TB7, 3, 85, MSForms, TextBox"
Attribute VB_Control = "TB4, 2, 86, MSForms, TextBox"
Attribute VB_Control = "TB2, 1, 87, MSForms, TextBox"
Attribute VB_Control = "TB1, 0, 88, MSForms, TextBox"
Dim leer$
Dim Fehlertext$
Dim i As Integer
Dim fehler As Boolean
Dim ok As Boolean
Dim Start As Integer
Dim Vorschlag As Variant
Sub FelderAktualisieren()
   ActiveWindow.View.Type = wdNormalView
   ActiveWindow.View.Type = wdReadingView
   ActiveWindow.View.Type = wdPrintView
End Sub
Private Sub AG_Pruefen_Click()
Start = 1
Dim Fragewert
Dim Merkauswahl
    Fragewert = MsgBox("Bitte pr|fffd|fen Sie, ob Sie das Dokument jetzt sperren wollen!" & Chr$(13) & Chr$(13) & _
    "Sie k|fffd|nnen dann keine weiteren Eingaben t|fffd|tigen und es erfolgt" & Chr(13) & "eine Pr|fffd|fung auf grobe Fehler. " & Chr(13) & Chr(13) & _
    "Wollen Sie das Dokument jetzt sperren?", 292, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018")
    If Fragewert <> 6 Then
        Exit Sub
    End If
    ok = True
    Fehlertext$ = ""

    leer$ = TB1.Text: i = 1: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB1.BackColor = &HFF& Else TB1.BackColor = &HE0E0E0
    leer$ = TB7.Text: i = 3: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB7.BackColor = &HFF& Else TB7.BackColor = &HE0E0E0
    leer$ = TB8.Text: i = 4: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB8.BackColor = &HFF& Else TB8.BackColor = &HE0E0E0
    leer$ = TB9.Text: i = 5: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB9.BackColor = &HFF& Else TB9.BackColor = &HE0E0E0
    leer$ = TB3.Text: i = 6: Datum_Test leer$, i, fehler: If fehler = True Then TB3.BackColor = &HFF& Else TB3.BackColor = &HE0E0E0
    leer$ = TB12.Text: i = 2: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB12.BackColor = &HFF& Else TB12.BackColor = &HE0E0E0
   
    TB2.BackColor = &HE0E0E0: TB10.BackColor = &HE0E0E0: TB11.BackColor = &HE0E0E0
    TB15.BackColor = &HE0E0E0: TB16.BackColor = &HE0E0E0: TB17.BackColor = &HE0E0E0
    TB18.BackColor = &HE0E0E0
    
    CB1.BackColor = &HE0E0E0: CB2.BackColor = &HE0E0E0: CB3.BackColor = &HE0E0E0: CB4.BackColor = &HE0E0E0
    CB5.BackColor = &HE0E0E0: CB6.BackColor = &HE0E0E0: CB7.BackColor = &HE0E0E0: CB8.BackColor = &HE0E0E0
    CB9.BackColor = &HE0E0E0: CB10.BackColor = &HE0E0E0: CB11.BackColor = &HE0E0E0: CB12.BackColor = &HE0E0E0
    CB13.BackColor = &HE0E0E0: CB14.BackColor = &HE0E0E0: CB15.BackColor = &HE0E0E0: CB16.BackColor = &HE0E0E0
        
    If Not IsNumeric(TB12.Value) Then
        MsgBox "Ziff. 2.2: St|fffd|rungsbeseitigungsfrist: Es sind nur Zahleneingaben erlaubt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        ok = False
      Fehlertext$ = Fehlertext$ + "Textfeld: Ziff. 2.2: St|fffd|rungsbeseitigungsfrit: Keine Zahleneingabe" & vbCrLf
      TB12.BackColor = &HFF&:
    Else
      TB12.BackColor = &HE0E0E0
    End If
    
    If OB23.Value = True And TB13.Text = "" Then
     MsgBox "Ziff. 2.3: Keine Durchf|fffd|hrungszeit St|fffd|rungsbeseitigung au|fffd|erhalb der betriebs|fffd|blichen Arbeitszeit" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
     Fehlertext$ = Fehlertext$ + "Ziff. 2.3: Durchf|fffd|hrungsZeit St|fffd|rungsbeseitigung au|fffd|erhalb der betriebs|fffd|blichen Arbeitszeit pr|fffd|fen!" & vbCrLf
     OB23.BackColor = &HFF&: TB13.BackColor = &HFF&
     Else: OB23.BackColor = &HE0E0E0: TB13.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If
    
    If CB9.Value = True Then
      leer$ = TB15.Text: i = 21: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then CB9.BackColor = &HFF&: TB15.BackColor = &HFF& Else CB9.BackColor = &HE0E0E0: TB15.BackColor = &HE0E0E0
    End If
   If CB10.Value = True Then
      leer$ = TB16.Text: i = 22: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then CB10.BackColor = &HFF&: TB16.BackColor = &HFF& Else CB10.BackColor = &HE0E0E0: TB16.BackColor = &HE0E0E0
    End If
    If CB11.Value = True Then
      leer$ = TB17.Text: i = 23: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then CB11.BackColor = &HFF&: TB17.BackColor = &HFF& Else CB11.BackColor = &HE0E0E0: TB17.BackColor = &HE0E0E0
    End If
   If CB12.Value = True Then
      leer$ = TB18.Text: i = 24: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then CB12.BackColor = &HFF&: TB18.BackColor = &HFF& Else CB12.BackColor = &HE0E0E0: TB18.BackColor = &HE0E0E0
    End If
    
    leer$ = TB19.Text: i = 10: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB19.BackColor = &HFF& Else TB19.BackColor = &HE0E0E0
    
 'USt.Feld
    leer$ = TB31.Text: i = 11: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB31.BackColor = &HFF& Else TB31.BackColor = &HE0E0E0
    If Not IsNumeric(TB31.Value) Then
      MsgBox "Ziff. 3.1: USt.-Satz: Es sind nur Zahleneingaben erlaubt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
      ok = False 'Doch Fehler
      Fehlertext$ = Fehlertext$ + "Ziff. 3.1: USt.-Satz: Keine Zahleneingabe" & vbCrLf
      TB31.BackColor = &HFF&:
    Else 'ok
      USt = CVar(TB31.Text)
      If USt <> 19 Then
      Fragewert = MsgBox("Wollen Sie wirklich einen USt.-Satz von " & USt & " % verwenden?", 292, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018")
        'vbYes 6 Ja   'vbNo 7 Nein
          If Fragewert <> 6 Then
            ok = False: TB31.BackColor = &HFF&
             Fehlertext$ = Fehlertext$ + "Ziff. 3.1: Mehrwertsteuersatz pr|fffd|fen" & vbCrLf
            Else: TB31.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
          End If
      End If
    End If
    Merkauswahl = 0
    If OB11.Value = True Then Merkauswahl = 1
    If OB12.Value = True Then Merkauswahl = 1
    If Merkauswahl = 0 Then
      MsgBox "Ziff. 2.3: Keine Jahresperiode f|fffd|r die St|fffd|rungsbeseitigung ausgew|fffd|hlt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
      ok = False 'Doch Fehler
      Fehlertext$ = Fehlertext$ + "Ziff. 2.3: Ausf|fffd|hrungszeit/Periode St|fffd|rungsbeseitigung: Ganzj|fffd|hrig bzw. Heizperiode" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
      OB11.BackColor = &HFF&: OB12.BackColor = &HFF& 'Rot da Fehler
    Else 'ok
      OB11.BackColor = &HE0E0E0: OB12.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If
' Pr|fffd|fe, ob Einsatzzeit f|fffd|r St|fffd|rungsbeseitigung in Ziff. 2.3 ausgew|fffd|hlt
    Merkauswahl = 0
    If OB21.Value = True Then Merkauswahl = 1
    If OB22.Value = True Then Merkauswahl = 1
    If OB23.Value = True Then Merkauswahl = 1
    If Merkauswahl = 0 Then
      MsgBox "Ziff. 2.3: Keine Einsatzzeit f|fffd|r die St|fffd|rungsbeseitigung ausgew|fffd|hlt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
      ok = False 'Doch Fehler
      Fehlertext$ = Fehlertext$ + "Ziff. 2.3: Einsatzzeit St|fffd|rungsbeseitigung" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
      OB21.BackColor = &HFF&: OB22.BackColor = &HFF&: OB23.BackColor = &HFF& 'Rot da Fehler
    Else 'ok
      OB21.BackColor = &HE0E0E0: OB22.BackColor = &HE0E0E0: OB22.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If
 
' Pr|fffd|fe des Umfangss der Kleinen Instandsetzungen, der mit der Verg|fffd|tung abgegolten ist,Ziff. 3
    Merkauswahl = 0
    If OB61.Value = True Then Merkauswahl = 1
    If OB62.Value = True Then Merkauswahl = 1
      If Merkauswahl = 0 Then
       MsgBox "Ziff. 3.1: Keine Angabe zum Umfang der Kleinne Instandsetzungen, der mit der Verg|fffd|tung abgegolten ist!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
       ok = False 'Doch Fehler
       Fehlertext$ = Fehlertext$ + "Ziff. 3.1: Umfang der mit Verg|fffd|tung angegoltenen Kleinen Instandsetzungen" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
       OB61.BackColor = &HFF&: OB62.BackColor = &HFF&: TB32.BackColor = &HFF&: TB33.BackColor = &HFF& 'Rot da Fehler
      Else 'ok
       OB61.BackColor = &HE0E0E0: OB62.BackColor = &HE0E0E0: TB32.BackColor = &HE0E0E0: TB33.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If
        
   ' Pr|fffd|fe Stunden und max. Materialkosten (Pauschalierungen) f|fffd|r Kleine Instandsetzungen
    If OB62.Value = True Then
         If Not IsNumeric(TB32.Value) Then
            TB32.BackColor = &HFF&
            MsgBox "Ziff. 3.1: Pauschalstunden Kleine Instandsetzungsarbeiten" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
            ok = False: Fehlertext$ = Fehlertext$ + "Ziff. 3.1: Zahleneingabe Pauschalstunden fehlt!" & vbCrLf
          Else
           TB32.BackColor = &HE0E0E0
         End If
     TB32.Locked = False: TB33.Locked = False
    End If
    
    If OB62.Value = True Then
         If Not IsNumeric(TB33.Value) Then
            TB33.BackColor = &HFF&
            MsgBox "Ziff. 3.1: Materialpauschale Kleine Instandsetzungsarbeiten" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
            ok = False: Fehlertext$ = Fehlertext$ + "Ziff. 3.1: Zahleneingabe Materialpauschale fehlt!" & vbCrLf
          Else
           TB33.BackColor = &HE0E0E0
         End If
     TB32.Locked = False: TB33.Locked = False
    End If
    
    ' Pr|fffd|fe Vertragslaufzeit/K|fffd|ndigung, Ziff. 4
    Merkauswahl = 0
    If OB71.Value = True Then Merkauswahl = 1
    If OB72.Value = True Then Merkauswahl = 1
     If Merkauswahl = 0 Then
       MsgBox "Ziff. 4: Keine Angabe zur Vertragslaufzeit!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
       ok = False 'Doch Fehler
       Fehlertext$ = Fehlertext$ + "Ziff. 4: Angabe zur Vertragslaufzeit" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
       OB71.BackColor = &HFF&: OB72.BackColor = &HFF& 'Rot da Fehler
     Else 'ok
       OB71.BackColor = &HE0E0E0: OB72.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If
    
    ' Pr|fffd|fe Angaben zur Laufzeit, abweichend vom Grundvertrag
    If OB72.Value = True Then
     leer$ = TB34.Text: i = 15: Datum_Test leer$, i, fehler: If fehler = True Then TB34.BackColor = &HFF& Else TB34.BackColor = &HE0E0E0
     If Not IsNumeric(TB35.Value) Then
        MsgBox "Ziff. 4: Laufzeit: Es sind nur Zahleneingaben erlaubt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        ok = False 'Doch Fehler
        Fehlertext$ = Fehlertext$ + "Textfeld: Ziff. 4: Laufzeit: Keine Zahleneingabe" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
        TB35.BackColor = &HFF&:
       Else 'ok
        TB35.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
      End If
         
   ' L|fffd|nge der Laufzeit pr|fffd|fen
       Laufzeit = CVar(TB35.Text)
       If Laufzeit < 4 Then
        Fragewert = MsgBox("Wollen Sie wirklich eine geringere Laufzeit" & Chr$(13) & _
        "als 4 Jahre?" _
        , 292, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018")
        'vbYes 6 Ja   'vbNo 7 Nein
          If Fragewert <> 6 Then
            ok = False: TB35.BackColor = &HFF&
            Else: TB35.BackColor = &HE0E0E0
          End If
        End If
     End If
   ' Pr|fffd|fe Angaben zur Laufzeitverl|fffd|ngerung
    Merkauswahl = 0
    If OB71.Value = True Then Merkauswahl = 1
    If OB73.Value = True Then Merkauswahl = 1
    If OB74.Value = True Then Merkauswahl = 1
    If Merkauswahl = 0 Then
      MsgBox "Ziff. 4: Keine Angaben zur Laufzeitverl|fffd|ngerng ausgew|fffd|hlt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
      ok = False 'Doch Fehler
      Fehlertext$ = Fehlertext$ + "Ziff. 4.: Laufzeitverl|fffd|ngerung" & vbCrLf 'Nur wenn Fehleraufz|fffd|hlung
      OB73.BackColor = &HFF&: OB74.BackColor = &HFF& 'Rot da Fehler
    Else 'ok
      OB73.BackColor = &HE0E0E0: OB74.BackColor = &HE0E0E0 'Wei|fffd| da in Ordnung
    End If

  leer$ = TB36.Text: i = 25: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB36.BackColor = &HFF& Else TB36.BackColor = &HE0E0E0
  leer$ = TB37.Text: i = 26: Datum_Test leer$, i, fehler: If fehler = True Then TB37.BackColor = &HFF& Else TB37.BackColor = &HE0E0E0

'Alles In Ordnung?
If ok = False Then
  MsgBox "Felder enthielten Fehler, diese Felder wurden rot markiert" & Chr(13) & Chr(13) & _
  "Dokument kann nicht gesperrt werden!" & Chr(13) & Chr(13) & "Die Fehler sind in der folgenden Fehlerdatei <Fehlermeldung.txt.>  aufgelistet.", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
 
' Ausgabe Fehlerliste
  Dim Start1 As Variant
  Dim Datei As String
  Dim Dat_Pfad As String
  Dim fso As Object
  Dim ts As Object
  Dat_Pfad = ActiveDocument.Path
  Datei = Dat_Pfad & "\Fehlermeldung.txt"
  Set fso = CreateObject("Scripting.FileSystemObject")
  Set ts = fso.OpenTextFile(Datei, 2)
    ts.write Fehlertext$
    ts.Close
  Start1 = Shell("Notepad.exe  " & Datei, 3)
  Exit Sub ' Fehler bricht das Makro ab
End If

  AG_pruefen.BackColor = &HE0E0E0
  AG_pruefen.ForeColor = &HFFFFFF
  AG_pruefen.Locked = True
  AG_pruefen.Caption = "Auftraggeber-Felder gesperrt"
  AG_pruefen.Enabled = False
  AN_pruefen.Enabled = True
  AN_pruefen.Locked = False
  AN_pruefen.BackColor = &H80FF&
  Schliesse_AG
  Oeffne_AN
  Start = 0
End Sub
Function Schliesse_AG()
Start = 1
    TB1.Locked = True: TB1.BackColor = &HE0E0E0
    TB2.Locked = True: TB2.BackColor = &HE0E0E0
    TB7.Locked = True: TB7.BackColor = &HE0E0E0
    TB8.Locked = True: TB8.BackColor = &HE0E0E0
    TB9.Locked = True: TB9.BackColor = &HE0E0E0
    TB10.Locked = True: TB10.BackColor = &HE0E0E0
    TB11.Locked = True: TB11.BackColor = &HE0E0E0
    TB3.Locked = True: TB3.BackColor = &HE0E0E0
    TB11.Locked = True: TB11.BackColor = &HE0E0E0
    TB12.Locked = True: TB12.BackColor = &HE0E0E0
    TB13.Locked = True: TB13.BackColor = &HE0E0E0

    TB15.Locked = True: TB15.BackColor = &HE0E0E0
    TB16.Locked = True: TB16.BackColor = &HE0E0E0
    TB17.Locked = True: TB17.BackColor = &HE0E0E0
    TB18.Locked = True: TB18.BackColor = &HE0E0E0
    TB19.Locked = True: TB19.BackColor = &HE0E0E0
    TB31.Locked = True: TB31.BackColor = &HE0E0E0
    TB32.Locked = True: TB32.BackColor = &HE0E0E0
    TB33.Locked = True: TB33.BackColor = &HE0E0E0
    TB34.Locked = True: TB34.BackColor = &HE0E0E0
    TB35.Locked = True: TB35.BackColor = &HE0E0E0
    TB36.Locked = True: TB36.BackColor = &HE0E0E0
    TB37.Locked = True: TB37.BackColor = &HE0E0E0

'Optionsfelder abschlie|fffd|en
    OB11.Locked = True: OB11.BackColor = &HE0E0E0
    OB12.Locked = True: OB12.BackColor = &HE0E0E0
    OB21.Locked = True: OB21.BackColor = &HE0E0E0
    OB22.Locked = True: OB22.BackColor = &HE0E0E0
    OB23.Locked = True: OB23.BackColor = &HE0E0E0
    OB61.Locked = True: OB61.BackColor = &HE0E0E0
    OB62.Locked = True: OB62.BackColor = &HE0E0E0
    OB71.Locked = True: OB71.BackColor = &HE0E0E0
    OB72.Locked = True: OB72.BackColor = &HE0E0E0
    OB73.Locked = True: OB73.BackColor = &HE0E0E0
    OB74.Locked = True: OB74.BackColor = &HE0E0E0
    
'Kontrollk|fffd|stchen abschlie|fffd|en
    CB1.Locked = True: CB2.Locked = True: CB3.Locked = True
    CB4.Locked = True: CB5.Locked = True: CB6.Locked = True
    CB7.Locked = True: CB8.Locked = True: CB9.Locked = True
    CB10.Locked = True: CB11.Locked = True: CB12.Locked = True
    CB13.Locked = True: CB14.Locked = True: CB15.Locked = True
    CB16.Locked = True
 Start = 0
 End Function

Function Oeffne_AN()
    TB99.Locked = True: TB99.Enabled = False: TB99.Text = "Bieter-/Auftragnehmer-Eingabe": TB99.BackColor = &HFFFFFF: TB99.ForeColor = &H0
    TB4.Locked = False: TB4.Enabled = True: TB4.BackColor = &HFF00&
    TB20.Locked = False: TB20.Enabled = True: TB20.BackColor = &HFF00&
    TB21.Locked = False: TB21.Enabled = True: TB21.Text = "0,00": TB21.BackColor = &HFF00&
    TB22.Locked = False: TB22.Enabled = False: TB22.Text = "": TB22.BackColor = &HE0E0E0
    TB23.Locked = False: TB23.Enabled = False: TB23.Text = "0,00": TB23.BackColor = &HE0E0E0
    TB24.Locked = False: TB24.Enabled = False: TB24.Text = "": TB24.BackColor = &HE0E0E0
    TB25.Locked = False: TB25.Enabled = False: TB25.Text = "0,00": TB25.BackColor = &HE0E0E0
    TB26.Locked = False: TB26.Enabled = False: TB26.Text = "": TB26.BackColor = &HE0E0E0
    TB27.Locked = False: TB27.Enabled = False: TB27.Text = "0,00": TB27.BackColor = &HE0E0E0
    TB28.Enabled = True: TB29.Enabled = True: TB30.Enabled = True
    TB261.Locked = False: TB261.Enabled = False: TB261.Text = "": TB261.BackColor = &HE0E0E0
    TB271.Locked = False: TB271.Enabled = False: TB271.Text = "0,00": TB271.BackColor = &HE0E0E0
    TB262.Locked = False: TB262.Enabled = False: TB262.Text = "": TB262.BackColor = &HE0E0E0
    TB272.Locked = False: TB272.Enabled = False: TB272.Text = "0,00": TB272.BackColor = &HE0E0E0
    TB263.Locked = False: TB263.Enabled = False: TB263.Text = "": TB263.BackColor = &HE0E0E0
    TB273.Locked = False: TB273.Enabled = False: TB273.Text = "0,00": TB273.BackColor = &HE0E0E0
    TB264.Locked = False: TB264.Enabled = False: TB264.Text = "": TB264.BackColor = &HE0E0E0
    TB274.Locked = False: TB274.Enabled = False: TB274.Text = "0,00": TB274.BackColor = &HE0E0E0
    TB265.Locked = False: TB265.Enabled = False: TB265.Text = "": TB265.BackColor = &HE0E0E0
    TB275.Locked = False: TB275.Enabled = False: TB275.Text = "0,00": TB275.BackColor = &HE0E0E0
    TB266.Locked = False: TB266.Enabled = False: TB266.Text = "": TB266.BackColor = &HE0E0E0
    TB276.Locked = False: TB276.Enabled = False: TB276.Text = "0,00": TB276.BackColor = &HE0E0E0
    TB38.Locked = False: TB38.Enabled = True: TB38.Text = "": TB38.BackColor = &HFF00&
    TB39.Locked = False: TB39.Enabled = True: TB39.Value = Date: TB39.BackColor = &HFF00&

    CB32.Value = False: CB32.Locked = False: CB32.BackColor = &HFFFF&
    CB33.Value = False: CB33.Locked = True: CB33.BackColor = &HE0E0E0
    CB34.Value = False: CB34.Locked = True: CB34.BackColor = &HE0E0E0
    CB35.Value = False: CB35.Locked = True: CB35.BackColor = &HE0E0E0
    CB36.Value = False: CB36.Locked = True: CB36.BackColor = &HE0E0E0
    CB37.Value = False: CB37.Locked = True: CB37.BackColor = &HE0E0E0
    CB38.Value = False: CB38.Locked = True: CB38.BackColor = &HE0E0E0
    CB39.Value = False: CB39.Locked = True: CB39.BackColor = &HE0E0E0
    CB310.Value = False: CB310.Locked = True: CB310.BackColor = &HE0E0E0
End Function
Private Sub AN_Pruefen_Click()
Dim Fragewert
Fragewert = MsgBox("Bitte pr|fffd|fen Sie, ob Sie das Dokument jetzt sperren wollen!" & Chr$(13) & Chr$(13) & _
"Sie k|fffd|nnen dann keine weiteren Eingaben t|fffd|tigen und es erfolgt" & Chr(13) & "eine Pr|fffd|fung auf grobe Fehler. " & Chr(13) & Chr(13) & _
"Wollen Sie das Dokument jetzt sperren?", 292, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018")
  'vbYes 6 Ja   'vbNo 7 Nein
If Fragewert <> 6 Then
'  Exit Sub
End If
ok = True 'Annahme keine Fehler
Fehlertext$ = ""
leer$ = TB4.Text: i = 18: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB4.BackColor = &HFF& Else TB4.BackColor = &HE0E0E0 'Wei|fffd|
leer$ = TB20.Text: i = 19: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB20.BackColor = &HFF&: TB21.BackColor = &HFF& Else TB20.BackColor = &HE0E0E0: TB21.BackColor = &HE0E0E0
If CB32.Value = True Then
    leer$ = TB22.Text: i = 29: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB22.BackColor = &HFF&: TB23.BackColor = &HFF&: CB32.BackColor = &HFF& Else TB22.BackColor = &HE0E0E0: TB23.BackColor = &HE0E0E0: CB32.BackColor = &HE0E0E0
Else: TB22.Text = ""
End If

If CB33.Value = True Then
    leer$ = TB24.Text: i = 30: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB24.BackColor = &HFF&: TB25.BackColor = &HFF&: CB33.BackColor = &HFF& Else: TB24.BackColor = &HE0E0E0:  TB25.BackColor = &HE0E0E0: CB33.BackColor = &HE0E0E0
Else: TB24.Text = ""
End If

If CB34.Value = True Then
    leer$ = TB26.Text: i = 31: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB26.BackColor = &HFF&: TB27.BackColor = &HFF&: CB34.BackColor = &HFF& Else: TB26.BackColor = &HE0E0E0:  TB27.BackColor = &HE0E0E0: CB34.BackColor = &HE0E0E0
Else: TB26.Text = ""
End If

If CB35.Value = True Then
    leer$ = TB261.Text: i = 32: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB261.BackColor = &HFF&: TB271.BackColor = &HFF&: CB35.BackColor = &HFF& Else: TB261.BackColor = &HE0E0E0:  TB271.BackColor = &HE0E0E0: CB35.BackColor = &HE0E0E0
Else: TB261.Text = ""
End If

If CB36.Value = True Then
    leer$ = TB262.Text: i = 33: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB262.BackColor = &HFF&: TB272.BackColor = &HFF&: CB36.BackColor = &HFF& Else: TB262.BackColor = &HE0E0E0:  TB272.BackColor = &HE0E0E0: CB36.BackColor = &HE0E0E0
Else: TB262.Text = ""
End If

If CB37.Value = True Then
    leer$ = TB263.Text: i = 34: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB263.BackColor = &HFF&: TB273.BackColor = &HFF&: CB37.BackColor = &HFF& Else: TB263.BackColor = &HE0E0E0:  TB273.BackColor = &HE0E0E0: CB37.BackColor = &HE0E0E0
Else: TB263.Text = ""
End If

If CB38.Value = True Then
    leer$ = TB264.Text: i = 35: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB264.BackColor = &HFF&: TB274.BackColor = &HFF&: CB38.BackColor = &HFF& Else: TB264.BackColor = &HE0E0E0: TB274.BackColor = &HE0E0E0: CB38.BackColor = &HE0E0E0
Else: TB264.Text = ""
End If

If CB39.Value = True Then
    leer$ = TB265.Text: i = 36: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB265.BackColor = &HFF&: TB275.BackColor = &HFF&: CB39.BackColor = &HFF& Else: TB265.BackColor = &HE0E0E0: TB275.BackColor = &HE0E0E0: CB39.BackColor = &HE0E0E0
Else: TB265.Text = ""

End If
If CB310.Value = True Then
    leer$ = TB266.Text: i = 37: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB266.BackColor = &HFF&: TB276.BackColor = &HFF&: CB310.BackColor = &HFF& Else: TB266.BackColor = &HE0E0E0: TB276.BackColor = &HE0E0E0: CB310.BackColor = &HE0E0E0
Else: TB266.Text = ""
End If

leer$ = TB38.Text: i = 27: Leerpr|fffd|fung leer$, i, fehler: If fehler = True Then TB38.BackColor = &HFF& Else TB38.BackColor = &HE0E0E0
leer$ = TB39.Text: i = 28: Datum_Test leer$, i, fehler: If fehler = True Then TB39.BackColor = &HFF& Else TB39.BackColor = &HE0E0E0

'Alles In Ordnung?
If ok = False Then
  MsgBox "Felder enthielten Fehler" & Chr(13) & "diese Felder wurden rot markiert" & Chr(13) & _
  "Dokument kann nicht gesperrt werden!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"

' Ausgabe Fehlerliste
  Dim Start1 As Variant
  Dim Datei As String
  Dim Dat_Pfad As String
  Dim fso As Object
  Dim ts As Object
  Dat_Pfad = ActiveDocument.Path
  Datei = Dat_Pfad & "\Fehlermeldung.txt"
  Set fso = CreateObject("Scripting.FileSystemObject")
  Set ts = fso.OpenTextFile(Datei, 2)
    ts.write Fehlertext$
    ts.Close
  Start1 = Shell("Notepad.exe  " & Datei, 3)
  Exit Sub ' Fehler bricht das Makro ab
End If

'Alles in Ordnung - Button werden ge|fffd|ndert
  AN_pruefen.BackColor = &HE0E0E0
  AN_pruefen.ForeColor = &HFFFFFF
  AN_pruefen.Locked = True
  AN_pruefen.Caption = "Auftragnehmer-Felder gesperrt"
  AN_pruefen.Enabled = False
  Schliesse_AN 'Sperrt AN Felder
'Start = 0
End Sub

Function Schliesse_AN()
'Textfelder abschlie|fffd|en
TB4.Locked = True: TB4.BackColor = &HE0E0E0
TB20.Locked = True: TB20.BackColor = &HE0E0E0
TB21.Locked = True: TB21.BackColor = &HE0E0E0
TB22.Locked = True: TB22.BackColor = &HE0E0E0
TB23.Locked = True: TB23.BackColor = &HE0E0E0
TB24.Locked = True: TB24.BackColor = &HE0E0E0
TB25.Locked = True: TB25.BackColor = &HE0E0E0
TB26.Locked = True: TB26.BackColor = &HE0E0E0
TB261.Locked = True: TB261.BackColor = &HE0E0E0
TB262.Locked = True: TB262.BackColor = &HE0E0E0
TB263.Locked = True: TB263.BackColor = &HE0E0E0
TB264.Locked = True: TB264.BackColor = &HE0E0E0
TB265.Locked = True: TB265.BackColor = &HE0E0E0
TB266.Locked = True: TB266.BackColor = &HE0E0E0
TB27.Locked = True: TB27.BackColor = &HE0E0E0
TB271.Locked = True: TB271.BackColor = &HE0E0E0
TB272.Locked = True: TB272.BackColor = &HE0E0E0
TB273.Locked = True: TB273.BackColor = &HE0E0E0
TB274.Locked = True: TB274.BackColor = &HE0E0E0
TB275.Locked = True: TB275.BackColor = &HE0E0E0
TB276.Locked = True: TB276.BackColor = &HE0E0E0
TB38.Locked = True: TB38.BackColor = &HE0E0E0
TB39.Locked = True: TB39.BackColor = &HE0E0E0
CB32.Locked = True: CB32.BackColor = &HE0E0E0
CB33.Locked = True: CB33.BackColor = &HE0E0E0
CB34.Locked = True: CB34.BackColor = &HE0E0E0
CB35.Locked = True: CB35.BackColor = &HE0E0E0
CB36.Locked = True: CB36.BackColor = &HE0E0E0
CB37.Locked = True: CB37.BackColor = &HE0E0E0
CB38.Locked = True: CB38.BackColor = &HE0E0E0
CB39.Locked = True: CB39.BackColor = &HE0E0E0
CB310.Locked = True: CB310.BackColor = &HE0E0E0
TB99.Text = "Formulareingabe abgeschlossen"
FelderAktualisieren
End Function

Sub Datum_Test(leer$, i, fehler) 'Datum
  fehler = False
  If InStr(leer$, " ") Then
    leer$ = Replace(leer$, " ", "")
  End If
  If leer$ = "" Then
    MsgBox "Textfeld " & Chr(34) & Feldbezeichnung$(i) & Chr(34) & " nicht ausgef|fffd|llt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden" & _
    msg3 & Chr(13), 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018" '& i '& i - nur zum Testen kann sp|fffd|ter weg
    fehler = True
    ok = False
    Fehlertext$ = Fehlertext$ + "Textfeld: " & Feldbezeichnung$(i) & " nicht ausgef|fffd|llt!" & vbCrLf
    Exit Sub
  End If
  If Not IsDate(leer$) Then
    MsgBox "Textfeld " & Chr(34) & Feldbezeichnung$(i) & Chr(34) & " enth|fffd|lt kein g|fffd|ltiges Datum!" & _
    msg3 & Chr(13), 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018" '& i '& i - nur zum Testen kann sp|fffd|ter weg
    fehler = True
    ok = False
    Fehlertext$ = Fehlertext$ + "Textfeld: " & Feldbezeichnung$(i) & " enth|fffd|lt kein g|fffd|ltiges Datum!" & vbCrLf
    Exit Sub
  End If
End Sub

Private Sub Leerpr|fffd|fung(leer$, i, fehler) 'Einfacher Text
    fehler = False
    If InStr(leer$, " ") Then
      leer$ = Replace(leer$, " ", "")
    End If
    If leer$ = "" Then
      MsgBox "Textfeld " & Chr(34) & Feldbezeichnung$(i) & Chr(34) _
    & " nicht ausgef|fffd|llt!" & Chr(13) & Chr(13) & "Dokument kann nicht gesperrt werden!" & Chr(13), 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018" '& i  '& i - nur zum Testen kann sp|fffd|ter weg
      fehler = True '
      ok = False
      Fehlertext$ = Fehlertext$ + "Textfeld: " & Feldbezeichnung$(i) & " nicht ausgef|fffd|llt!" & vbCrLf
    End If
End Sub
'St|fffd|rungsbeseitigung unterj|fffd|hrig, Gruppe OG1
Private Sub OB11_Click()
OB11.Locked = False: OB11.Value = True: OB11.BackColor = &HFF00&
OB12.Locked = False: OB12.Value = False: OB12.BackColor = &HFFFF&
End Sub
Private Sub OB12_Click()
OB11.Locked = False: OB11.Value = False: OB11.BackColor = &HFFFF&
OB12.Locked = False: OB12.Value = True: OB12.BackColor = &HFF00&
End Sub
'Arbeitszeit St|fffd|rungsbeseitigung festlegen, Gruppe OG2: Optionsfelder steuert Textfeld
Private Sub OB21_Click()
'Textfelder Grau schalten
  TB13.Locked = True: TB13.Text = "": TB13.BackColor = &HE0E0E0
  OB21.Locked = False: OB21.Value = True: OB21.BackColor = &HFF00&
  OB22.Locked = False: OB22.Value = False: OB22.BackColor = &HFFFF&
  OB23.Locked = False: OB23.Value = False: OB23.BackColor = &HFFFF&
End Sub
Private Sub OB22_Click()
'Textfelder Grau schalten
  TB13.Locked = True: TB13.Text = "": TB13.BackColor = &HE0E0E0
  OB21.Locked = False: OB21.Value = False: OB21.BackColor = &HFFFF&
  OB22.Locked = False: OB22.Value = True: OB22.BackColor = &HFF00&
  OB23.Locked = False: OB23.Value = False: OB23.BackColor = &HFFFF&
End Sub
Private Sub OB23_Click()
'Textfelder Gr|fffd|n schalten
  TB13.Locked = False: TB13.Text = "": TB13.BackColor = &HFF00&
  OB21.Locked = False: OB21.Value = False: OB21.BackColor = &HFFFF&
  OB22.Locked = False: OB22.Value = False: OB22.BackColor = &HFFFF&
  OB23.Locked = False: OB23.Value = True: OB23.BackColor = &HFF00&
End Sub
'Kontrollk|fffd|stechen CB1 bis CB8
Private Sub CB1_Click()
  If CB1.Value = True Then
    CB1.BackColor = &HFF00&
  End If
  If CB1.Value = False Then
    CB1.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB2_Click()
  If CB2.Value = True Then
    CB2.BackColor = &HFF00&
  End If
  If CB2.Value = False Then
    CB2.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB3_Click()
  If CB3.Value = True Then
    CB3.BackColor = &HFF00&
  End If
  If CB3.Value = False Then
    CB3.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB4_Click()
  If CB4.Value = True Then
    CB4.BackColor = &HFF00&
  End If
  If CB4.Value = False Then
    CB4.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB5_Click()
  If CB5.Value = True Then
    CB5.BackColor = &HFF00&
  End If
  If CB5.Value = False Then
    CB5.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB6_Click()
  If CB6.Value = True Then
    CB6.BackColor = &HFF00&
  End If
  If CB6.Value = False Then
    CB6.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB7_Click()
  If CB7.Value = True Then
    CB7.BackColor = &HFF00&
  End If
  If CB7.Value = False Then
    CB7.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB8_Click()
  If CB8.Value = True Then
    CB8.BackColor = &HFF00&
  End If
  If CB8.Value = False Then
    CB8.BackColor = &HFFFF&
  End If
End Sub
'Kontrollk|fffd|stchen CB9 steuert Textfeld TB15
Private Sub CB9_Click()
  If CB9.Value = True Then
    CB9.BackColor = &HFF00&: CB10.Locked = False: CB10.BackColor = &HFFFF&: TB15.Locked = False: TB15.Text = "": TB15.BackColor = &HFF00&
  End If
  If CB9.Value = False Then
    CB9.BackColor = &HFFFF&: CB10.Locked = True: CB10.Value = False: CB10.BackColor = &HE0E0E0: TB15.Locked = True: TB15.Text = "": TB15.BackColor = &HE0E0E0: TB16.BackColor = &HE0E0E0
  End If
End Sub

'Kontrollk|fffd|stchen CB10 steuert Textfeld TB16
Private Sub CB10_Click()
  If CB10.Value = True Then
    CB10.BackColor = &HFF00&: CB11.Locked = False: CB11.BackColor = &HFFFF&: TB16.Locked = False: TB16.Text = "": TB16.BackColor = &HFF00&
  End If
  If CB10.Value = False Then
    CB10.BackColor = &HFFFF&: CB11.Locked = True: CB11.Value = False: CB11.BackColor = &HE0E0E0: TB16.Locked = True: TB16.Text = "": TB16.BackColor = &HE0E0E0
  End If
End Sub
'Kontrollk|fffd|stchen CB11 steuert Textfeld TB17
Private Sub CB11_Click()
  If CB11.Value = True Then
    CB11.BackColor = &HFF00&: CB12.Locked = False: CB12.BackColor = &HFFFF&: TB17.Locked = False: TB17.Text = "": TB17.BackColor = &HFF00&
  End If
  If CB11.Value = False Then
    CB11.BackColor = &HFFFF&: CB12.Locked = True: CB12.Value = False: CB12.BackColor = &HE0E0E0: TB17.Locked = True: TB17.Text = "": TB17.BackColor = &HE0E0E0
  End If
End Sub
'Kontrollk|fffd|stchen CB12 steuert Textfeld TB18
Private Sub CB12_Click()
  If CB12.Value = True Then
    CB12.BackColor = &HFF00&: TB18.Locked = False: TB18.Text = "": TB18.BackColor = &HFF00&
  End If
  If CB12.Value = False Then
    CB12.BackColor = &HFFFF&: TB18.Locked = True: TB18.Text = "": TB18.BackColor = &HE0E0E0
  End If
End Sub
'Kontrollk|fffd|stechen CB13 bis CB16
Private Sub CB13_Click()
  If CB13.Value = True Then
    CB13.BackColor = &HFFFF&
  End If
  If CB13.Value = False Then
    CB13.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB14_Click()
  If CB14.Value = True Then
    CB14.BackColor = &HFFFF&
  End If
  If CB14.Value = False Then
    CB14.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB15_Click()
  If CB15.Value = True Then
    CB15.BackColor = &HFFFF&
  End If
  If CB15.Value = False Then
    CB15.BackColor = &HFFFF&
  End If
End Sub
Private Sub CB16_Click()
  If CB16.Value = True Then
    CB16.BackColor = &HFFFF&
  End If
  If CB16.Value = False Then
    CB16.BackColor = &HFFFF&
  End If
End Sub

'Verg|fffd|tung kleine Instandsetzungsarbeiten, Gruppe OG6
Private Sub OB61_Click()
'Textfelder Grau schalten
  TB32.Locked = True: TB32.Enabled = False: TB32.Text = "": TB32.BackColor = &HE0E0E0
  TB33.Locked = True: TB33.Enabled = False: TB33.Text = "": TB33.BackColor = &HE0E0E0
  OB61.Locked = False: OB61.Value = True: OB61.BackColor = &HFF00&
  OB62.Locked = False: OB62.Value = False: OB62.BackColor = &HFFFF&
End Sub
Private Sub OB62_Click()
'Textfelder Gr|fffd|n schalten
  TB32.Locked = False: TB32.Enabled = True: TB32.Text = "1": TB32.BackColor = &HFFFF&
  TB33.Locked = False: TB33.Enabled = True: TB33.Text = "500": TB33.BackColor = &HFFFF&
  OB61.Locked = False: OB61.Value = False: OB61.BackColor = &HFFFF&
  OB62.Locked = False: OB62.Value = True: OB62.BackColor = &HFF00&
End Sub

'Vertragslaufzeit, Gruppe OG7
Private Sub OB71_Click()
  TB34.Locked = True: TB34.Enabled = False: TB34.Text = "": TB34.BackColor = &HE0E0E0
  TB35.Locked = True: TB35.Enabled = False: TB35.Text = "": TB35.BackColor = &HE0E0E0
  OB71.Locked = False: OB71.Value = True: OB71.BackColor = &HFF00&
  OB72.Locked = False: OB72.Value = False: OB72.BackColor = &HFFFF&
  OB73.Locked = False: OB73.Value = False: OB73.BackColor = &HFFFF&
  OB74.Locked = False: OB74.Value = False: OB74.BackColor = &HFFFF&
End Sub

Private Sub OB72_Click()
  TB34.Locked = False: TB34.Enabled = True: TB34.Text = "": TB34.BackColor = &HFF00&
  TB35.Locked = False: TB35.Enabled = True: TB35.Text = "4": TB35.BackColor = &HFF00&
  OB71.Locked = False: OB71.Value = False: OB71.BackColor = &HFFFF&
  OB72.Locked = False: OB72.Value = True: OB72.BackColor = &HFF00&
  OB73.Locked = False: OB73.Value = True: OB73.BackColor = &HFF00&
  OB74.Locked = False: OB74.Value = False: OB74.BackColor = &HFFFF&
End Sub

Private Sub TB13_LostFocus()
If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
'If AG_fertig = True Then Exit Sub
    If OB23.Value = False Then Exit Sub
    If TB13.Text = "" Then
        MsgBox "Bitte Zeit f|fffd|r St|fffd|rungsbeseitigung im Freitextfeld eingben oder anderes Optionsfeld w|fffd|hlen!", 292, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB13.BackColor = &HFF&: OB23.BackColor = &HFF&
        Else: TB13.BackColor = &HFF00&: OB23.BackColor = &HFF00&
    End If
End Sub

Private Sub TB12091_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If CB1209.Value = False Then Exit Sub
    If TB12091.Text = "" Then
    Zwoelf
    TB12091.BackColor = &HFF: CB1209.BackColor = &HFF
    Else: TB12091.BackColor = &HFF00&: CB1209.BackColor = &HFF00&
    End If
End Sub

Private Sub TB15_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If CB9.Value = False Then Exit Sub
    If TB15.Text = "" Then
    MsgBox "Bitte weitere St|fffd|rung f|fffd|r DF|fffd| in das Textfeld eingeben oder Auswahlfeld links (H|fffd|kchen) deaktivieren!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB15.BackColor = &HFF: CB9.BackColor = &HFF
    Else: TB15.BackColor = &HFF00&: CB9.BackColor = &HFF00&
    End If
End Sub
Private Sub TB16_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If CB10.Value = False Then Exit Sub
    If TB16.Text = "" Then
    MsgBox "Bitte weitere St|fffd|rung f|fffd|r DF|fffd| in das Textfeld eingeben oder Auswahlfeld links (H|fffd|kchen) deaktivieren!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB16.BackColor = &HFF: CB10.BackColor = &HFF
    Else: TB16.BackColor = &HFF00&: CB10.BackColor = &HFF00&
    End If
End Sub
Private Sub TB17_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If CB11.Value = False Then Exit Sub
    If TB17.Text = "" Then
    MsgBox "Bitte weitere St|fffd|rung f|fffd|r DF|fffd| in das Textfeld eingeben oder Auswahlfeld links (H|fffd|kchen) deaktivieren!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB17.BackColor = &HFF: CB11.BackColor = &HFF
    Else: TB17.BackColor = &HFF00&: CB11.BackColor = &HFF00&
    End If
End Sub
Private Sub TB18_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If CB12.Value = False Then Exit Sub
    If TB18.Text = "" Then
    MsgBox "Bitte weitere St|fffd|rung f|fffd|r DF|fffd| in das Textfeld eingeben oder Auswahlfeld links (H|fffd|kchen) deaktivieren!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB18.BackColor = &HFF: CB12.BackColor = &HFF
    Else: TB18.BackColor = &HFF00&: CB12.BackColor = &HFF00&
    End If
End Sub



Private Sub TB19_LostFocus()
   If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
   If TB19.Text = "" Then
    MsgBox "Datum-Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Bitte geben Sie ein Datum im Format <TT.MM.> ein." & Chr(13) & Chr(13) & "Ihre Eingabe wird auf auf <01.06.> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB19.Value = "01.06."
    End If
    If Not IsNumeric(TB19.Value) Then
    MsgBox "Datum-Feld mit Texteingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Bitte geben Sie ein Datum im Format <TT.MM.> ein." & Chr(13) & "Ihre Eingabe wird auf auf <01.06.> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB19.Value = "01.06."
    End If
End Sub
Private Sub TB34_LostFocus()
     If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
     If DatumGetestet(TB34.Text) Then
      TB34.Text = Format(DatumGetestet(TB34.Text), "Short Date")
      TB34.BackColor = &HFF00&
     Else
      MsgBox "Bitte Datum eingeben!"
      TB34.Text = ""
      TB34.BackColor = &HFF
     End If
End Sub
Private Sub TB35_LostFocus()
    TB35.Value = Format(TB35.Text, "##0")
    If TB35.Text = "" Then
    MsgBox "Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Eingabe wird auf <4> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB35.Text = "4"
    End If
    If Not IsNumeric(TB35.Value) Then
    MsgBox "Bitte nur Zahlen eingeben!" & Chr(13) & Chr(13) & "Eingabe wird auf <4> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB35.Text = "4"
    End If
End Sub

Private Sub OB73_Click()
  TB34.Locked = False: TB34.Text = "": TB34.BackColor = &HFF00&
  TB35.Locked = False: TB35.Text = "4": TB35.BackColor = &HFF00&
  OB71.Locked = False: OB71.Value = False: OB71.BackColor = &HFFFF&
  OB72.Locked = False: OB72.Value = True: OB72.BackColor = &HFF00&
  OB73.Locked = False: OB73.Value = True: OB73.BackColor = &HFF00&
  OB74.Locked = False: OB74.Value = False: OB74.BackColor = &HFFFF&
End Sub
Private Sub OB74_Click()
  TB34.Locked = False: TB34.Text = "": TB34.BackColor = &HFF00&
  TB35.Locked = False: TB35.Text = "4": TB35.BackColor = &HFF00&
  OB71.Locked = False: OB71.Value = False: OB71.BackColor = &HFFFF&
  OB72.Locked = False: OB72.Value = True: OB72.BackColor = &HFF00&
  OB73.Locked = False: OB73.Value = False: OB73.BackColor = &HFFFF&
  OB74.Locked = False: OB74.Value = True: OB74.BackColor = &HFF00&
End Sub
Private Sub TB12_LostFocus()
    TB12.Value = Format(TB12.Text, "##0")
    If TB12.Text = "" Then
    MsgBox "Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf auf <48> zur|fffd|ckgessett!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB12.Text = "48"
    End If
    If Not IsNumeric(TB12.Value) Then
    MsgBox "Bitte geben Sie die Stunden als Zahl ein!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf auf 48 zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB12.Text = "48"
    End If
End Sub
Private Sub TB21_Change()
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00")
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00")
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00")
  Exit Sub
errorhandler:
  If Not TB21.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronisches Vertragsmuster Wartung 2018": TB21.Value = ""
End Sub
Private Sub TB21_LostFocus()
    TB21.Value = Format(TB21.Text, "##,##0.00")
    If TB21.Text = "" Then TB21.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB23_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB23.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB23.Value = ""
End Sub
Private Sub TB23_LostFocus()
    TB23.Value = Format(TB23.Text, "##,##0.00")
    If TB23.Text = "" Then TB23.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB25_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB25.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB25.Value = ""
End Sub
Private Sub TB25_LostFocus()
    TB25.Value = Format(TB25.Text, "##,##0.00")
    If TB25.Text = "" Then TB25.Text = "0,00" Else Exit Sub
End Sub
Private Sub TB27_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB27.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB27.Value = ""
End Sub
Private Sub TB27_LostFocus()
    TB27.Value = Format(TB27.Text, "##,##0.00")
    If TB27.Text = "" Then TB27.Text = "0,00" Else Exit Sub
End Sub
Private Sub TB271_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB271.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB271.Value = ""
End Sub
Private Sub TB271_LostFocus()
    TB271.Value = Format(TB271.Text, "##,##0.00")
    If TB271.Text = "" Then TB271.Text = "0,00" Else Exit Sub
End Sub
Private Sub TB272_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB272.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB272.Value = ""
End Sub

Private Sub TB272_LostFocus()
    TB272.Value = Format(TB272.Text, "##,##0.00")
    If TB272.Text = "" Then TB272.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB273_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB273.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB273.Value = ""
End Sub
Private Sub TB273_LostFocus()
    TB273.Value = Format(TB273.Text, "##,##0.00")
    If TB273.Text = "" Then TB273.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB274_Change() ' Preisfeld 1

On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB274.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB274.Value = ""
End Sub
Private Sub TB274_LostFocus()
    TB274.Value = Format(TB274.Text, "##,##0.00")
    If TB274.Text = "" Then TB274.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB275_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB275.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB275.Value = ""
End Sub
Private Sub TB275_LostFocus()
    TB275.Value = Format(TB275.Text, "##,##0.00")
    If TB275.Text = "" Then TB275.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB276_Change() ' Preisfeld 1
On Error GoTo errorhandler
  If Start = 1 Then Exit Sub
  Preis1 = CDbl(TB21.Value)
  Preis2 = CDbl(TB23.Value)
  Preis3 = CDbl(TB25.Value)
  Preis4 = CDbl(TB27.Value)
  Preis5 = CDbl(TB271.Value)
  Preis6 = CDbl(TB272.Value)
  Preis7 = CDbl(TB273.Value)
  Preis8 = CDbl(TB274.Value)
  Preis9 = CDbl(TB275.Value)
  Preis10 = CDbl(TB276.Value)
  TB28.Value = Format(Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10, "##,##0.00") 'netto
  MWST = CDbl(TB31.Value)
  TB29.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (MWST / 100), "##,##0.00") 'MWSt. erg|fffd|nzen
  TB30.Value = Format((Preis1 + Preis2 + Preis3 + Preis4 + Preis5 + Preis6 + Preis7 + Preis8 + Preis9 + Preis10) * (1 + (MWST / 100)), "##,##0.00") 'brutto
 Exit Sub
errorhandler:
  If Not TB276.Value = "" Then MsgBox "Es ist nur die Eingabe von Zahlen erlaubt", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018": TB276.Value = ""
End Sub
Private Sub TB276_LostFocus()
    TB276.Value = Format(TB276.Text, "##,##0.00")
    If TB276.Text = "" Then TB276.Text = "0,00" Else Exit Sub
End Sub

Private Sub TB3_LostFocus()
     If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
     If DatumGetestet(TB3.Text) Then
      TB3.Text = Format(DatumGetestet(TB3.Text), "Short Date")
      TB3.BackColor = &HFF00&
     Else
      MsgBox "Bitte Datum eingeben!"
      TB3.Text = ""
      TB3.BackColor = &HFF&
     End If
End Sub
Private Sub TB32_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    TB32.Value = Format(TB32.Text, "#0")
     If TB32.Text = "" Then
    MsgBox "Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf <1> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB32.Text = "1"
    End If
    If Not IsNumeric(TB32.Value) Then
    MsgBox "Es ist nur die Eingabe von Zahlen erlaubt!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf <1> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB32.Text = "1"
    End If
End Sub

Private Sub TB33_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    TB33.Value = Format(TB33.Text, "##,##0")
     If TB33.Text = "" Then
    MsgBox "Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf <500> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB33.Text = "500"
    End If
    If Not IsNumeric(TB33.Value) Then
    MsgBox "Es ist nur die Eingabe von Zahlen erlaubt!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf <500> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB33.Text = "500"
    End If
End Sub

Private Sub TB36_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If TB36.Text = "" Then
         MsgBox "Bitte Ort eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
         TB36.BackColor = &HFF&
         Else: TB36.BackColor = &HFF00&
        End If
End Sub

Private Sub TB37_LostFocus()
     If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
     If DatumGetestet(TB37.Text) Then
      TB37.Text = Format(DatumGetestet(TB37.Text), "Short Date")
     Else
      MsgBox "Bitte Datum eingeben! Eingabe wird auf das heutige Datum zur|fffd|ckgesetzt!"
      TB37.Text = Date
     End If
End Sub
Private Sub TB38_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If TB38.Text = "" Then
         MsgBox "Bitte Ort eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
         TB38.BackColor = &HFF&
         Else: TB38.BackColor = &HFF00&
        End If
End Sub

Private Sub TB39_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
     If DatumGetestet(TB39.Text) Then
      TB39.Text = Format(DatumGetestet(TB39.Text), "Short Date")
     Else
      MsgBox "Bitte Datum eingeben! Eingabe wird auf das heutige Datum zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
      TB39.Text = Date
     End If
' Start = 0
End Sub

Private Sub TB5221_LostFocus()
    TB5221.Value = Format(TB5221.Text, "##,##0")
    TB5222.Text = TB5221.Text
End Sub
Private Sub TB31_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    TB31.Value = Format(TB31.Text, "##0")
    If TB31.Text = "" Then
    MsgBox "USt.-Feld ohne Eingabe!" & Chr(13) & Chr(13) & "Das ist nicht zul|fffd|ssig!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf auf <19> zur|fffd|ckgessett!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB31.Text = "19"
    Else: TB31.BackColor = &HFF00&
    End If
    If Not IsNumeric(TB31.Value) Then
    MsgBox "Bitte geben Sie die USt. als Zahl ein!" & Chr(13) & Chr(13) & "Ihre Eingabe wird auf auf <19> zur|fffd|ckgesetzt!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB31.Text = "19"
    End If
End Sub
Private Sub TB20_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If TB20.Text = "" Then
    MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB20.BackColor = &HFF&
    Else: TB20.BackColor = &HFF00&: TB21.BackColor = &HFF00&:
    End If
End Sub
Private Sub CB32_Click()
    If CB32.Value = True Then
        CB32.BackColor = &HFF00&:
        CB33.Locked = False: CB33.BackColor = &HFFFF&
        TB22.Enabled = True: TB22.Locked = False: TB22.BackColor = &HFF00&: TB22.ForeColor = &H0
        TB23.Enabled = True: TB23.Locked = False: TB23.BackColor = &HFF00&
      Else
        CB32.BackColor = &HFFFF&
        CB33.Value = False: CB33.Locked = True: CB33.BackColor = &HE0E0E0
        TB22.Enabled = True: TB22.Locked = True: TB22.BackColor = &HE0E0E0: TB22.ForeColor = &HE0E0E0
        TB23.Enabled = False: TB23.Locked = True: TB23.Text = "0,00": TB23.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB22_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If TB22.Text = "" Then
    MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB22.BackColor = &HFF&: CB32.BackColor = &HFF&
    Else: TB22.BackColor = &HFF00&: TB23.BackColor = &HFF00&: CB32.BackColor = &HFF00&
    End If
End Sub
Private Sub CB33_Click()
    If CB33.Value = True Then
        CB33.BackColor = &HFF00&:
        CB34.Locked = False: CB34.BackColor = &HFFFF&
        TB24.Enabled = True: TB24.Locked = False: TB24.BackColor = &HFF00&: TB24.ForeColor = &H0
        TB25.Enabled = True: TB25.Locked = False: TB25.BackColor = &HFF00&
      Else
        CB33.BackColor = &HFFFF&
        CB34.Value = False: CB34.Locked = True: CB34.BackColor = &HE0E0E0
        TB24.Enabled = True: TB24.Locked = True: TB24.BackColor = &HE0E0E0: TB24.ForeColor = &HE0E0E0
        TB25.Enabled = False: TB25.Locked = True: TB25.Text = "0,00": TB25.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB24_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB33.Value = True Then
    If TB24.Text = "" Then
    MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
    TB24.BackColor = &HFF&: CB33.BackColor = &HFF&
    Else: TB24.BackColor = &HFF00&: TB25.BackColor = &HFF00&: CB33.BackColor = &HFF00&
    End If
End If
End Sub
Private Sub CB34_Click()
    If CB34.Value = True Then
        CB34.BackColor = &HFF00&:
        CB35.Locked = False: CB35.BackColor = &HFFFF&
        TB26.Enabled = True: TB26.Locked = False: TB26.BackColor = &HFF00&: TB26.ForeColor = &H0
        TB27.Enabled = True: TB27.Locked = False: TB27.BackColor = &HFF00&
      Else
        CB34.BackColor = &HFFFF&
        CB35.Value = False: CB35.Locked = True: CB35.BackColor = &HE0E0E0
        TB26.Enabled = True: TB26.Locked = True: TB26.BackColor = &HE0E0E0: TB26.ForeColor = &HE0E0E0
        TB27.Enabled = False: TB27.Locked = True: TB27.Text = "0,00": TB27.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB26_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB34.Value = True Then
        If TB26.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB26.BackColor = &HFF&: CB34.BackColor = &HFF&
        Else: TB26.BackColor = &HFF00&: TB27.BackColor = &HFF00&: CB34.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB35_Click()
    If CB35.Value = True Then
        CB35.BackColor = &HFF00&:
        CB36.Locked = False: CB36.BackColor = &HFFFF&
        TB261.Enabled = True: TB261.Locked = False: TB261.BackColor = &HFF00&: TB261.ForeColor = &H0
        TB271.Enabled = True: TB271.Locked = False: TB271.BackColor = &HFF00&
      Else
        CB35.BackColor = &HFFFF&
        CB36.Value = False: CB36.Locked = True: CB36.BackColor = &HE0E0E0
        TB261.Enabled = True: TB261.Locked = True: TB261.BackColor = &HE0E0E0: TB261.ForeColor = &HE0E0E0
        TB271.Enabled = False: TB271.Locked = True: TB271.Text = "0,00": TB271.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB261_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB35.Value = True Then
        If TB261.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB261.BackColor = &HFF&: CB35.BackColor = &HFF&
        Else: TB261.BackColor = &HFF00&: TB271.BackColor = &HFF00&: CB35.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB36_Click()
        If CB36.Value = True Then
        CB36.BackColor = &HFF00&:
        CB37.Locked = False: CB37.BackColor = &HFFFF&
        TB262.Enabled = True: TB262.Locked = False: TB262.BackColor = &HFF00&: TB262.ForeColor = &H0
        TB272.Enabled = True: TB272.Locked = False: TB272.BackColor = &HFF00&
      Else
        CB36.BackColor = &HFFFF&
        CB37.Value = False: CB37.Locked = True: CB37.BackColor = &HE0E0E0
        TB262.Enabled = True: TB262.Locked = True: TB262.BackColor = &HE0E0E0: TB262.ForeColor = &HE0E0E0
        TB272.Enabled = False: TB272.Locked = True: TB272.Text = "0,00": TB272.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB262_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB36.Value = True Then
        If TB262.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
         TB262.BackColor = &HFF&: CB36.BackColor = &HFF&
        Else: TB262.BackColor = &HFF00&: TB272.BackColor = &HFF00&: CB36.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB37_Click()
    If CB37.Value = True Then
        CB37.BackColor = &HFF00&:
        CB38.Locked = False: CB38.BackColor = &HFFFF&
        TB263.Enabled = True: TB263.Locked = False: TB263.BackColor = &HFF00&: TB263.ForeColor = &H0
        TB273.Enabled = True: TB273.Locked = False: TB273.BackColor = &HFF00&
      Else
        CB37.BackColor = &HFFFF&
        CB38.Value = False: CB38.Locked = True: CB38.BackColor = &HE0E0E0
        TB263.Enabled = True: TB263.Locked = True: TB263.BackColor = &HE0E0E0: TB263.ForeColor = &HE0E0E0
        TB273.Enabled = False: TB273.Locked = True: TB273.Text = "0,00": TB273.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB263_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB37.Value = True Then
        If TB263.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB263.BackColor = &HFF&: CB37.BackColor = &HFF&
        Else: TB263.BackColor = &HFF00&: TB273.BackColor = &HFF00&: CB37.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB38_Click()
    If CB38.Value = True Then
        CB38.BackColor = &HFF00&:
        CB39.Locked = False: CB39.BackColor = &HFFFF&
        TB264.Enabled = True: TB264.Locked = False: TB264.BackColor = &HFF00&: TB264.ForeColor = &H0
        TB274.Enabled = True: TB274.Locked = False: TB274.BackColor = &HFF00&
      Else
        CB38.BackColor = &HFFFF&
        CB39.Value = False: CB39.Locked = True: CB39.BackColor = &HE0E0E0
        TB264.Enabled = True: TB264.Locked = True: TB264.BackColor = &HE0E0E0: TB264.ForeColor = &HE0E0E0
        TB274.Enabled = False: TB274.Locked = True: TB274.Text = "0,00": TB274.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB264_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB38.Value = True Then
        If TB264.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB264.BackColor = &HFF&: CB38.BackColor = &HFF&
        Else: TB264.BackColor = &HFF00&: TB274.BackColor = &HFF00&: CB38.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB39_Click()
    If CB39.Value = True Then
        CB39.BackColor = &HFF00&:
        CB310.Locked = False: CB310.BackColor = &HFFFF&
        TB265.Enabled = True: TB265.Locked = False: TB265.BackColor = &HFF00&: TB265.ForeColor = &H0
        TB275.Enabled = True: TB275.Locked = False: TB275.BackColor = &HFF00&
      Else
        CB39.BackColor = &HFFFF&
        CB310.Value = False: CB310.Locked = True: CB310.BackColor = &HE0E0E0
        TB265.Enabled = True: TB265.Locked = True: TB265.BackColor = &HE0E0E0: TB265.ForeColor = &HE0E0E0
        TB275.Enabled = False: TB275.Locked = True: TB275.Text = "0,00": TB275.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB265_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB39.Value = True Then
        If TB265.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB265.BackColor = &HFF&: CB39.BackColor = &HFF&
        Else: TB265.BackColor = &HFF00&: TB275.BackColor = &HFF00&: CB39.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub CB310_Click()
    If CB310.Value = True Then
        CB310.BackColor = &HFF00&:
        TB266.Enabled = True: TB266.Locked = False: TB266.BackColor = &HFF00&: TB266.ForeColor = &H0
        TB276.Enabled = True: TB276.Locked = False: TB276.BackColor = &HFF00&
      Else
        CB310.BackColor = &HFFFF&
        TB266.Enabled = True: TB266.Locked = True: TB266.BackColor = &HE0E0E0: TB266.ForeColor = &HE0E0E0
        TB276.Enabled = False: TB276.Locked = True: TB276.Text = "0,00": TB276.BackColor = &HE0E0E0
    End If
End Sub
Private Sub TB266_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If CB310.Value = True Then
        If TB266.Text = "" Then
         MsgBox "Bitte Anlage eingeben!", 48, "Elektronischer Erg|fffd|nzungsvertrag St|fffd|rungsbeseitigung Wartung 2018"
        TB266.BackColor = &HFF&: CB310.BackColor = &HFF&
        Else: TB266.BackColor = &HFF00&: TB276.BackColor = &HFF00&: CB310.BackColor = &HFF00&
        End If
    End If
End Sub
Private Sub TB1_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If TB1.Text = "" Then
    MsgBox "Bitte Auftraggeber eingeben!", 48, "Elektronisches Vertragsmuster Wartung 2018 "
    TB1.BackColor = &HFF
    Else: TB1.BackColor = &HFF00&
    End If
End Sub
Private Sub TB4_LostFocus()
    If Not TB99.Text = "Bieter-/Auftragnehmer-Eingabe" Then Exit Sub
    If TB4.Text = "" Then
    MsgBox "Bitte Firmennamen eingeben!", 48, "Elektronisches Vertragsmuster Wartung 2018 "
    TB4.BackColor = &HFF
    Else: TB4.BackColor = &HFF00&
    End If
End Sub
Private Sub TB7_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If TB7.Text = "" Then
    MsgBox "Bitte Art der Anlage eingeben!", 48, "Elektronisches Vertragsmuster Wartung 2018 "
    TB7.BackColor = &HFF
    Else: TB7.BackColor = &HFF00&
    End If
End Sub
Private Sub TB8_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If TB8.Text = "" Then
    MsgBox "Bitte Standort(e) eingeben!", 48, "Elektronisches Vertragsmuster Wartung 2018 "
    TB8.BackColor = &HFF
    Else: TB8.BackColor = &HFF00&
    End If
End Sub
Private Sub TB9_LostFocus()
    If Not TB99.Text = "Auftraggeber-Eingabe" Then Exit Sub
    If TB9.Text = "" Then
    MsgBox "Bitte Betreiber eingeben!", 48, "Elektronisches Vertragsmuster Wartung 2018 "
    TB9.BackColor = &HFF
    Else: TB9.BackColor = &HFF00&
    End If
End Sub

Function DatumGetestet(strDatum As String) As Variant
DatumGetestet = False
If IsDate(strDatum$) Then
 If Month(CDate("1/2/2000")) = 2 Then
  Select Case strDatum$
   Case Format(CDate(strDatum$), "d/m/yy"), _
        Format(CDate(strDatum$), "d/m/yyyy"), _
        Format(CDate(strDatum$), "d/mm/yy"), _
        Format(CDate(strDatum$), "d/mm/yyyy"), _
        Format(CDate(strDatum$), "dd/m/yy"), _
        Format(CDate(strDatum$), "dd/m/yyyy"), _
        Format(CDate(strDatum$), "dd/mm/yy"), _
        Format(CDate(strDatum$), "dd/mm/yyyy")
     DatumGetestet = CDate(strDatum)
    Case Format(CDate(strDatum$), "d/m"), _
        Format(CDate(strDatum$), "d/mm"), _
        Format(CDate(strDatum$), "dd/m"), _
        Format(CDate(strDatum$), "dd/mm")
     DatumGetestet = CDate(strDatum)
  End Select
 Else
  Select Case strDatum$
   Case Format(CDate(strDatum$), "m/d/yy"), _
        Format(CDate(strDatum$), "m/d/yyyy"), _
        Format(CDate(strDatum$), "m/dd/yy"), _
        Format(CDate(strDatum$), "m/dd/yyyy"), _
        Format(CDate(strDatum$), "mm/d/yy"), _
        Format(CDate(strDatum$), "mm/d/yyyy"), _
        Format(CDate(strDatum$), "mm/dd/yy"), _
        Format(CDate(strDatum$), "mm/dd/yyyy")
     DatumGetestet = CDate(strDatum)
   Case Format(CDate(strDatum$), "m/d"), _
        Format(CDate(strDatum$), "m/dd"), _
        Format(CDate(strDatum$), "mm/d"), _
        Format(CDate(strDatum$), "mm/dd")
   DatumGetestet = CDate(strDatum)
  End Select
 End If
End If
End Function
Private Sub CommandButton1_Click()
  If ActiveDocument.InlineShapes(1).OLEFormat.ClassType _
   = "Forms.CommandButton.1" Then
   ActiveDocument.InlineShapes(1).Delete
  End If
End Sub

' InQuest injected base64 decoded content
' -zzZ
' "{-jwlz

INQUEST-PP=macro
