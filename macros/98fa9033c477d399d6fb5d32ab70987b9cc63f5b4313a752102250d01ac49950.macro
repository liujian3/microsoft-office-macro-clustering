Attribute VB_Name = "ACTIVACION"
Attribute VB_Base = "0{BFE095A1-0B42-45AE-A027-957C3223267B}{8C2E5BE7-7BF3-4391-A176-B77ACCC5260C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Initialize()
On Error Resume Next
Application.EnableEvents = False
If Dir(ThisWorkbook.FullName) <> "" Then
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
For i = 1 To 104
laN.AddItem Pass.Cells(20, i).Value
Next i
laN.ListIndex = Pass.[A1]
Application.EnableEvents = True
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Exit Sub
End Sub
Private Sub laN_Change()
On Error Resume Next
SOGLASH.Locked = True
Pass.[A1] = laN.ListIndex
inD = laN.ListIndex
If Pass.[D14] = "" Then
If Pass.[C14] Like "*[@]*[.]*" = True Then
Pass.[D14] = ""
SOGLASIE.Value = True
EMAIL = Pass.[C14]
SOGLASIE.Enabled = False
EMAIL.Enabled = False
SHIFR.Enabled = True
POLKOD.Caption = Pass.Cells(33, Pass.[A1] + 1).Value
ACTIVIROVATI.Caption = Pass.Cells(30, Pass.[A1] + 1).Value
If Pass.[A1] + 1 = 10 Then
INFOR.Caption = Pass.Cells(41, Pass.[A1] + 1).Value
INFOR.Enabled = False
Else
INFOR.Caption = Pass.Cells(42, Pass.[A1] + 1).Value
INFOR.Enabled = False
End If
Else
Pass.[B14] = 0
Pass.[C14] = ""
Pass.[D14] = ""
Pass.[E14] = ""
SOGLASIE.Value = False
EMAIL.Enabled = False
SHIFR.Enabled = False
POLKOD.Caption = Pass.Cells(28, Pass.[A1] + 1).Value
ACTIVIROVATI.Caption = Pass.Cells(30, Pass.[A1] + 1).Value
If Pass.[A1] + 1 = 10 Then
INFOR.Caption = Pass.Cells(41, Pass.[A1] + 1).Value
INFOR.Enabled = False
SOGLASIE.Enabled = True
Else
INFOR.Caption = Pass.Cells(31, Pass.[A1] + 1).Value
INFOR.Enabled = True
SOGLASIE.Value = False
SOGLASIE.Enabled = True
End If
End If
SOGLASH.Value = "        " & Pass.Cells(52, 10).Value & vbCrLf & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(53, 10).Value _
& " " & Pass.Cells(54, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & "VbaStore" & """, " & _
Pass.Cells(56, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(57, 10).Value _
& ", " & Pass.Cells(58, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(59, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(61, 10).Value & " " & Pass.Cells(62, 10).Value & " " & _
Pass.Cells(63, 10).Value & vbCrLf & "   " & Pass.Cells(64, 10).Value & " " & Pass.Cells(65, 10).Value & " " & _
Pass.Cells(66, 10).Value & "." & vbCrLf & "   " & Pass.Cells(67, 10).Value & ", " & Pass.Cells(68, 10).Value & " (" & _
Pass.Cells(69, 10).Value & ")." & vbCrLf & "   " & Pass.Cells(70, 10).Value & " " & Pass.Cells(71, 10).Value & "." & vbCrLf & _
vbCrLf & Pass.Cells(72, 10).Value & " " & Application.UserName & vbCrLf & vbCrLf & vbCrLf & "        " & Pass.Cells(74, 10).Value & "   " & akt & vbCrLf & vbCrLf & _
"   " & Pass.Cells(74, 10) & " " & Pass.Cells(75, 10).Value & " " & Pass.Cells(76, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & _
"VbaStore" & """, " & Pass.Cells(56, 10).Value & "." & vbCrLf & Pass.Cells(74, 10).Value & " " & Pass.Cells(148, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(77, 10).Value & " " & Pass.Cells(78, 10).Value _
& " " & Pass.Cells(79, 10).Value & " " & Pass.Cells(80, 10).Value & " " & Pass.Cells(81, 10).Value & "." & vbCrLf & Pass.Cells(82, 10).Value _
& vbCrLf & Pass.Cells(83, 10).Value & vbCrLf & Pass.Cells(84, 10).Value & ", " & Pass.Cells(85, 10).Value & " " & Pass.Cells(86, 10).Value _
& vbCrLf & Pass.Cells(87, 10).Value & vbCrLf & Pass.Cells(88, 10).Value & ", " & Pass.Cells(89, 10).Value & "." & vbCrLf & "   " & _
Pass.Cells(90, 10).Value & vbCrLf & Pass.Cells(91, 10).Value & ", " & Pass.Cells(92, 10).Value & " " & Pass.Cells(93, 10).Value _
& ". " & Pass.Cells(94, 10).Value & ", " & Pass.Cells(95, 10).Value & " " & Pass.Cells(96, 10).Value & vbCrLf & Pass.Cells(97, 10).Value _
& vbCrLf & Pass.Cells(98, 10).Value & ", " & Pass.Cells(99, 10).Value & ", " & Pass.Cells(100, 10).Value & vbCrLf & Pass.Cells(101, 10).Value _
& ", " & Pass.Cells(102, 10).Value & vbCrLf & Pass.Cells(103, 10).Value & vbCrLf & vbCrLf & Pass.Cells(72, 10).Value & " " & LCase(EMAIL.Text) & vbCrLf & Pass.Cells(73, 10).Value
Else
SOGLASIE.Value = True
SOGLASIE.Enabled = False
EMAIL = Pass.[C14]
EMAIL.Enabled = False
SHIFR = Pass.[D14]
SHIFR.Enabled = False
POLKOD.Caption = Pass.Cells(33, Pass.[A1] + 1).Value
PROKODA.Enabled = False
POLKOD.Enabled = False
If Pass.[B15] = "" Then
ACTIVIROVATI.Caption = Pass.Cells(51, Pass.[A1] + 1).Value
Else
ACTIVIROVATI.Caption = Pass.Cells(51, Pass.[A1] + 1).Value & "     " & Pass.Cells(138, Pass.[A1] + 1).Value _
& "  " & Pass.[B15] & "%" & "  " & Pass.Cells(139, Pass.[A1] + 1).Value & "  " & Pass.[C15]
End If
If Pass.[A1] + 1 = 10 Then
INFOR.Caption = Pass.Cells(41, Pass.[A1] + 1).Value
INFOR.Enabled = False
Else
INFOR.Caption = Pass.Cells(42, Pass.[A1] + 1).Value
INFOR.Enabled = False
End If
SOGLASH.Value = "        " & Pass.Cells(52, 10).Value & vbCrLf & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(53, 10).Value _
& " " & Pass.Cells(54, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & "VbaStore" & """, " & _
Pass.Cells(56, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(57, 10).Value _
& ", " & Pass.Cells(58, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(59, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(61, 10).Value & " " & Pass.Cells(62, 10).Value & " " & _
Pass.Cells(63, 10).Value & vbCrLf & "   " & Pass.Cells(64, 10).Value & " " & Pass.Cells(65, 10).Value & " " & _
Pass.Cells(66, 10).Value & "." & vbCrLf & "   " & Pass.Cells(67, 10).Value & ", " & Pass.Cells(68, 10).Value & " (" & _
Pass.Cells(69, 10).Value & ")." & vbCrLf & "   " & Pass.Cells(70, 10).Value & " " & Pass.Cells(71, 10).Value & "." & vbCrLf & _
vbCrLf & Pass.Cells(72, 10).Value & " " & Application.UserName & vbCrLf & vbCrLf & vbCrLf & "        " & Pass.Cells(74, 10).Value & "   " & akt & vbCrLf & vbCrLf & _
"   " & Pass.Cells(74, 10) & " " & Pass.Cells(75, 10).Value & " " & Pass.Cells(76, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & _
"VbaStore" & """, " & Pass.Cells(56, 10).Value & "." & vbCrLf & Pass.Cells(74, 10).Value & " " & Pass.Cells(148, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(77, 10).Value & " " & Pass.Cells(78, 10).Value _
& " " & Pass.Cells(79, 10).Value & " " & Pass.Cells(80, 10).Value & " " & Pass.Cells(81, 10).Value & "." & vbCrLf & Pass.Cells(82, 10).Value _
& vbCrLf & Pass.Cells(83, 10).Value & vbCrLf & Pass.Cells(84, 10).Value & ", " & Pass.Cells(85, 10).Value & " " & Pass.Cells(86, 10).Value _
& vbCrLf & Pass.Cells(87, 10).Value & vbCrLf & Pass.Cells(88, 10).Value & ", " & Pass.Cells(89, 10).Value & "." & vbCrLf & "   " & _
Pass.Cells(90, 10).Value & vbCrLf & Pass.Cells(91, 10).Value & ", " & Pass.Cells(92, 10).Value & " " & Pass.Cells(93, 10).Value _
& ". " & Pass.Cells(94, 10).Value & ", " & Pass.Cells(95, 10).Value & " " & Pass.Cells(96, 10).Value & vbCrLf & Pass.Cells(97, 10).Value _
& vbCrLf & Pass.Cells(98, 10).Value & ", " & Pass.Cells(99, 10).Value & ", " & Pass.Cells(100, 10).Value & vbCrLf & Pass.Cells(101, 10).Value _
& ", " & Pass.Cells(102, 10).Value & vbCrLf & Pass.Cells(103, 10).Value & vbCrLf & vbCrLf & Pass.Cells(72, 10).Value & " " & LCase(EMAIL.Text) & vbCrLf & Pass.Cells(73, 10).Value & " " & otdeldogovorov
End If
ACTIVACION.Caption = Pass.Cells(21, Pass.[A1] + 1).Value
Frm1.Caption = Pass.Cells(22, Pass.[A1] + 1).Value
Frm2.Caption = Pass.Cells(23, Pass.[A1] + 1).Value
Frm3.Caption = Pass.Cells(24, Pass.[A1] + 1).Value
Lbl1.Caption = Pass.Cells(25, Pass.[A1] + 1).Value
Lbl2.Caption = Pass.Cells(26, Pass.[A1] + 1).Value
SOGLASIE.Caption = Pass.Cells(27, Pass.[A1] + 1).Value
PROKODA.Caption = Pass.Cells(29, Pass.[A1] + 1).Value
VIBOR.Caption = Pass.Cells(33, Pass.[A1] + 1).Value
Exit Sub
End Sub
Private Sub INFOR_Click()
On Error Resume Next
If Mid(SOGLASH.Value, 9, 27) = Pass.Cells(52, 10) Then
SOGLASH.Value = "        " & Pass.Cells(52, Pass.[A1] + 1).Value & vbCrLf & vbCrLf & "   " & Pass.Cells(52, Pass.[A1] + 1).Value & " " & Pass.Cells(53, Pass.[A1] + 1).Value _
& " " & Pass.Cells(54, Pass.[A1] + 1).Value & " " & Pass.Cells(55, Pass.[A1] + 1).Value & " """ & "VbaStore" & """, " & _
Pass.Cells(56, Pass.[A1] + 1).Value & "." & vbCrLf & "   " & Pass.Cells(52, Pass.[A1] + 1).Value & " " & Pass.Cells(57, Pass.[A1] + 1).Value _
& ", " & Pass.Cells(58, Pass.[A1] + 1).Value & "." & vbCrLf & "   " & Pass.Cells(52, Pass.[A1] + 1).Value & " " & Pass.Cells(59, Pass.[A1] + 1).Value & ". " & _
Pass.Cells(60, Pass.[A1] + 1).Value & vbCrLf & "   " & Pass.Cells(61, Pass.[A1] + 1).Value & " " & Pass.Cells(62, Pass.[A1] + 1).Value & " " & _
Pass.Cells(63, Pass.[A1] + 1).Value & vbCrLf & "   " & Pass.Cells(64, Pass.[A1] + 1).Value & " " & Pass.Cells(65, Pass.[A1] + 1).Value & " " & _
Pass.Cells(66, Pass.[A1] + 1).Value & "." & vbCrLf & "   " & Pass.Cells(67, Pass.[A1] + 1).Value & ", " & Pass.Cells(68, Pass.[A1] + 1).Value & " (" & _
Pass.Cells(69, Pass.[A1] + 1).Value & ")." & vbCrLf & "   " & Pass.Cells(70, Pass.[A1] + 1).Value & " " & Pass.Cells(71, Pass.[A1] + 1).Value & "." & vbCrLf & _
vbCrLf & Pass.Cells(72, Pass.[A1] + 1).Value & " " & Application.UserName & vbCrLf & vbCrLf & vbCrLf & "        " & Pass.Cells(74, Pass.[A1] + 1).Value & "   " & akt & vbCrLf & vbCrLf & _
"   " & Pass.Cells(74, Pass.[A1] + 1) & " " & Pass.Cells(75, Pass.[A1] + 1).Value & " " & Pass.Cells(76, Pass.[A1] + 1).Value & " " & Pass.Cells(55, Pass.[A1] + 1).Value & " """ & _
"VbaStore" & """, " & Pass.Cells(56, Pass.[A1] + 1).Value & "." & vbCrLf & Pass.Cells(74, Pass.[A1] + 1).Value & " " & Pass.Cells(148, Pass.[A1] + 1).Value & ". " & _
Pass.Cells(60, Pass.[A1] + 1).Value & vbCrLf & "   " & Pass.Cells(77, Pass.[A1] + 1).Value & " " & Pass.Cells(78, Pass.[A1] + 1).Value _
& " " & Pass.Cells(79, Pass.[A1] + 1).Value & " " & Pass.Cells(80, Pass.[A1] + 1).Value & " " & Pass.Cells(81, Pass.[A1] + 1).Value & "." & vbCrLf & Pass.Cells(82, Pass.[A1] + 1).Value _
& vbCrLf & Pass.Cells(83, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(84, Pass.[A1] + 1).Value & ", " & Pass.Cells(85, Pass.[A1] + 1).Value & " " & Pass.Cells(86, Pass.[A1] + 1).Value _
& vbCrLf & Pass.Cells(87, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(88, Pass.[A1] + 1).Value & ", " & Pass.Cells(89, Pass.[A1] + 1).Value & "." & vbCrLf & "   " & _
Pass.Cells(90, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(91, Pass.[A1] + 1).Value & ", " & Pass.Cells(92, Pass.[A1] + 1).Value & " " & Pass.Cells(93, Pass.[A1] + 1).Value _
& ". " & Pass.Cells(94, Pass.[A1] + 1).Value & ", " & Pass.Cells(95, Pass.[A1] + 1).Value & " " & Pass.Cells(96, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(97, Pass.[A1] + 1).Value _
& vbCrLf & Pass.Cells(98, Pass.[A1] + 1).Value & ", " & Pass.Cells(99, Pass.[A1] + 1).Value & ", " & Pass.Cells(100, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(101, Pass.[A1] + 1).Value _
& ", " & Pass.Cells(102, Pass.[A1] + 1).Value & vbCrLf & Pass.Cells(103, Pass.[A1] + 1).Value & vbCrLf & vbCrLf & Pass.Cells(72, Pass.[A1] + 1).Value & " " & LCase(EMAIL.Text) & vbCrLf & Pass.Cells(73, Pass.[A1] + 1).Value
INFOR.Caption = Pass.Cells(32, Pass.[A1] + 1).Value
SOGLASIE.Enabled = False
Else
SOGLASH.Value = "        " & Pass.Cells(52, 10).Value & vbCrLf & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(53, 10).Value _
& " " & Pass.Cells(54, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & "VbaStore" & """, " & _
Pass.Cells(56, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(57, 10).Value _
& ", " & Pass.Cells(58, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(59, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(61, 10).Value & " " & Pass.Cells(62, 10).Value & " " & _
Pass.Cells(63, 10).Value & vbCrLf & "   " & Pass.Cells(64, 10).Value & " " & Pass.Cells(65, 10).Value & " " & _
Pass.Cells(66, 10).Value & "." & vbCrLf & "   " & Pass.Cells(67, 10).Value & ", " & Pass.Cells(68, 10).Value & " (" & _
Pass.Cells(69, 10).Value & ")." & vbCrLf & "   " & Pass.Cells(70, 10).Value & " " & Pass.Cells(71, 10).Value & "." & vbCrLf & _
vbCrLf & Pass.Cells(72, 10).Value & " " & Application.UserName & vbCrLf & vbCrLf & vbCrLf & "        " & Pass.Cells(74, 10).Value & "   " & akt & vbCrLf & vbCrLf & _
"   " & Pass.Cells(74, 10) & " " & Pass.Cells(75, 10).Value & " " & Pass.Cells(76, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & _
"VbaStore" & """, " & Pass.Cells(56, 10).Value & "." & vbCrLf & Pass.Cells(74, 10).Value & " " & Pass.Cells(148, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(77, 10).Value & " " & Pass.Cells(78, 10).Value _
& " " & Pass.Cells(79, 10).Value & " " & Pass.Cells(80, 10).Value & " " & Pass.Cells(81, 10).Value & "." & vbCrLf & Pass.Cells(82, 10).Value _
& vbCrLf & Pass.Cells(83, 10).Value & vbCrLf & Pass.Cells(84, 10).Value & ", " & Pass.Cells(85, 10).Value & " " & Pass.Cells(86, 10).Value _
& vbCrLf & Pass.Cells(87, 10).Value & vbCrLf & Pass.Cells(88, 10).Value & ", " & Pass.Cells(89, 10).Value & "." & vbCrLf & "   " & _
Pass.Cells(90, 10).Value & vbCrLf & Pass.Cells(91, 10).Value & ", " & Pass.Cells(92, 10).Value & " " & Pass.Cells(93, 10).Value _
& ". " & Pass.Cells(94, 10).Value & ", " & Pass.Cells(95, 10).Value & " " & Pass.Cells(96, 10).Value & vbCrLf & Pass.Cells(97, 10).Value _
& vbCrLf & Pass.Cells(98, 10).Value & ", " & Pass.Cells(99, 10).Value & ", " & Pass.Cells(100, 10).Value & vbCrLf & Pass.Cells(101, 10).Value _
& ", " & Pass.Cells(102, 10).Value & vbCrLf & Pass.Cells(103, 10).Value & vbCrLf & vbCrLf & Pass.Cells(72, 10).Value & " " & LCase(EMAIL.Text) & vbCrLf & Pass.Cells(73, 10).Value
INFOR.Caption = Pass.Cells(31, Pass.[A1] + 1).Value
SOGLASIE.Enabled = True
End If
Exit Sub
End Sub
Private Sub SOGLASIE_Click()
On Error Resume Next
If SOGLASIE.Value = False Then
Pass.[B14] = 0
If Pass.[A1] + 1 = 10 Then
EMAIL.Enabled = False
SHIFR.Enabled = False
INFOR.Caption = Pass.Cells(41, Pass.[A1] + 1).Value
INFOR.Enabled = False
Else
EMAIL.Enabled = False
SHIFR.Enabled = False
INFOR.Enabled = True
INFOR.Caption = Pass.Cells(31, Pass.[A1] + 1).Value
End If
Else
Pass.[B14] = 1
If Pass.[A1] + 1 = 10 Then
EMAIL.Enabled = True
SHIFR.Enabled = False
INFOR.Caption = Pass.Cells(41, Pass.[A1] + 1).Value
INFOR.Enabled = False
Else
EMAIL.Enabled = True
SHIFR.Enabled = False
INFOR.Caption = Pass.Cells(42, Pass.[A1] + 1).Value
INFOR.Enabled = False
End If
End If
Exit Sub
End Sub
Private Sub POLKOD_Click()
On Error Resume Next
Set CO = CreateObject("Scripting.FileSystemObject")
Folder = Left(CreateObject("Scripting.FileSystemObject").GetSpecialFolder(0), 2) & "\WinSec\"
If Pass.[B14] = 0 Then
MsgBox Pass.Cells(37, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If EMAIL.Text Like "*[@]*[.]*" = fasle Then
MsgBox Pass.Cells(38, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If POLKOD.Caption = Pass.Cells(33, Pass.[A1] + 1).Value Then
Pass.[B14] = 0
Pass.[C14] = ""
Pass.[D14] = ""
Pass.[E14] = ""
EMAIL = ""
SOGLASIE.Enabled = True
SOGLASIE.Value = False
EMAIL.Enabled = False
SHIFR.Enabled = False
POLKOD.Caption = Pass.Cells(28, Pass.[A1] + 1).Value
ACTIVIROVATI.Caption = Pass.Cells(30, Pass.[A1] + 1).Value
INFOR.Enabled = True
PROKODA.Enabled = True
SHIFR = ""
DelDir = Folder
Shell "cmd /c rd /S/Q """ & DelDir & """"
Exit Sub
End If
cHI = Timer() * 87654321 / Rnd
For j = 1 To Len(cHI) Step 1
sIA = Mid(cHI, j, 1)
If IsNumeric(sIA) <> True Then
sIA = ""
End If
If sIA = "0" Then
sIA = ""
End If
sER = sER & sIA
If Len(sER) = 7 Then
Exit For
End If
Next j
MkDir (Folder)
CO.GetFolder(Folder).Attributes = 2
MkDir (Folder & WinSec)
CO.GetFolder(Folder & WinSec).Attributes = 1
CO.GetFolder(Folder & WinSec).Attributes = 4
MkDir (Folder & EmailSec)
CO.GetFolder(Folder & EmailSec).Attributes = 1
CO.GetFolder(Folder & EmailSec).Attributes = 4
MkDir (Folder & WinSec & "\" & Hex$(sER))
Fld = Folder & EmailSec
For i = 1 To Len(EMAIL)
Fln = Asc(Mid(EMAIL, i, 1)) + 777
Fld = Fld & "\" & Fln
MkDir (Fld)
Next i
eMel = List1.Range("A1")
If eMel <> "" Then
otdeldogovorov = eMel
porolOG = porolD
Else
otdeldogovorov = otdeldogovorov2
porolOG = porolOG2
End If
Const CDO_Cnf = "http://schemas.microsoft.com/cdo/configuration/"
Dim oCDOCnf As Object, oCDOMsg As Object
Dim SMTPserver As String, sUsername As String, sPass As String, sMsg As String
Dim sTo As String, sFrom As String, sSubject As String, sBody As String, sAttachment As String
SMTPserver = "smtp.gmail.com"
sUsername = otdeldogovorov
sPass = porolOG
If Len(SMTPserver) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
If Len(sUsername) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
If Len(sPass) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
Pass.[C14] = LCase(EMAIL.Text)
sTo = LCase(EMAIL.Text)
sFrom = otdeldogovorov
sSubject = Pass.Cells(35, Pass.[A1] + 1).Value
sBody = sER & " - " & Pass.Cells(44, Pass.[A1] + 1).Value & ". " & Pass.Cells(45, Pass.[A1] + 1).Value
If Dir(sAttachment, vbDirectory) = "" Then sAttachment = ""
Set oCDOCnf = CreateObject("CDO.Configuration")
With oCDOCnf.Fields
.Item(CDO_Cnf & "sendusing") = 2
.Item(CDO_Cnf & "smtpauthenticate") = 1
.Item(CDO_Cnf & "smtpserver") = SMTPserver
.Item(CDO_Cnf & "smtpserverport") = 465
.Item(CDO_Cnf & "smtpusessl") = True
.Item(CDO_Cnf & "sendusername") = sUsername
.Item(CDO_Cnf & "sendpassword") = sPass
.Update
End With
Set oCDOMsg = CreateObject("CDO.Message")
With oCDOMsg
Set .Configuration = oCDOCnf
.BodyPart.Charset = "koi8-r"
.From = sFrom
.To = sTo
.Subject = sSubject
.TextBody = sBody
If Len(sAttachment) > 0 Then .AddAttachment sAttachment
.send
End With
Select Case Err.Number
Case -2147220973: sMsg = Pass.Cells(46, Pass.[A1] + 1).Value
Case -2147220975: sMsg = Pass.Cells(48, Pass.[A1] + 1).Value
Case 0: sMsg = Pass.Cells(43, Pass.[A1] + 1).Value
Case Else: sMsg = Pass.Cells(47, Pass.[A1] + 1).Value
End Select
If sMsg = Pass.Cells(43, Pass.[A1] + 1).Value Then
SOGLASIE.Enabled = False
EMAIL.Enabled = False
SHIFR.Enabled = True
POLKOD.Caption = Pass.Cells(33, Pass.[A1] + 1).Value
MsgBox sMsg, vbInformation, "VbaStore"
Else
If List1.Range("A1") <> "" Then
List1.Range("A1").ClearContents
Exit Sub
End If
MsgBox sMsg, vbInformation, "VbaStore"
End If
Exit Sub
End Sub
Private Sub PROKODA_Click()
On Error Resume Next
If Pass.[B14] = 0 Then
MsgBox Pass.Cells(37, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If POLKOD.Caption <> Pass.Cells(33, Pass.[A1] + 1).Value Then
MsgBox Pass.Cells(34, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If SHIFR.Enabled = False Then
MsgBox Pass.Cells(35, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
SHIFR.Paste
Exit Sub
End Sub
Private Sub ACTIVIROVATI_Click()
On Error Resume Next
If Left(ACTIVIROVATI.Caption, Len(Pass.Cells(51, Pass.[A1] + 1).Value)) = Pass.Cells(51, Pass.[A1] + 1).Value Then
ACTIVACION.Hide
OPLATA.Show
Exit Sub
End If
If Pass.[B14] = 0 Then
MsgBox Pass.Cells(37, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If POLKOD.Caption <> Pass.Cells(33, Pass.[A1] + 1).Value Then
MsgBox Pass.Cells(34, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If SHIFR = "" Then
MsgBox Pass.Cells(35, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If SHIFR.Enabled = False Then
MsgBox Pass.Cells(36, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
eMel = List1.Range("A1")
If eMel <> "" Then
otdeldogovorov = eMel
porolOG = porolD
Else
otdeldogovorov = otdeldogovorov2
porolOG = porolOG2
End If
Const CDO_Cnf = "http://schemas.microsoft.com/cdo/configuration/"
Dim oCDOCnf As Object, oCDOMsg As Object
Dim SMTPserver As String, sUsername As String, sPass As String, sMsg As String
Dim sTo As String, sFrom As String, sSubject As String, sBody As String, sAttachment As String
SMTPserver = "smtp.gmail.com"
sUsername = otdeldogovorov
sPass = porolOG
If Len(SMTPserver) = 0 Then
MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If Len(sUsername) = 0 Then
MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
If Len(sPass) = 0 Then
MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
Exit Sub
End If
Set CO = CreateObject("Scripting.FileSystemObject")
Folder = Left(CreateObject("Scripting.FileSystemObject").GetSpecialFolder(0), 2) & "\WinSec\"
For Each SubFolder In CO.GetFolder(Folder & WinSec & "\").SubFolders
sFlds = SubFolder.Name
Next
If sFlds = Hex$(SHIFR) Then
sTo = LCase(EMAIL.Text)
sFrom = otdeldogovorov
sSubject = Pass.Cells(35, Pass.[A1] + 1).Value
sBody = "        " & Pass.Cells(52, 10).Value & vbCrLf & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(53, 10).Value _
& " " & Pass.Cells(54, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & "VbaStore" & """, " & _
Pass.Cells(56, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(57, 10).Value _
& ", " & Pass.Cells(58, 10).Value & "." & vbCrLf & "   " & Pass.Cells(52, 10).Value & " " & Pass.Cells(59, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(61, 10).Value & " " & Pass.Cells(62, 10).Value & " " & _
Pass.Cells(63, 10).Value & vbCrLf & "   " & Pass.Cells(64, 10).Value & " " & Pass.Cells(65, 10).Value & " " & _
Pass.Cells(66, 10).Value & "." & vbCrLf & "   " & Pass.Cells(67, 10).Value & ", " & Pass.Cells(68, 10).Value & " (" & _
Pass.Cells(69, 10).Value & ")." & vbCrLf & "   " & Pass.Cells(70, 10).Value & " " & Pass.Cells(71, 10).Value & "." & vbCrLf & _
vbCrLf & Pass.Cells(72, 10).Value & " " & Application.UserName & vbCrLf & vbCrLf & vbCrLf & "        " & Pass.Cells(74, 10).Value & "   " & SHIFR & vbCrLf & vbCrLf & _
"   " & Pass.Cells(74, 10) & " " & Pass.Cells(75, 10).Value & " " & Pass.Cells(76, 10).Value & " " & Pass.Cells(55, 10).Value & " """ & _
"VbaStore" & """, " & Pass.Cells(56, 10).Value & "." & vbCrLf & Pass.Cells(74, 10).Value & " " & Pass.Cells(148, 10).Value & ". " & _
Pass.Cells(60, 10).Value & vbCrLf & "   " & Pass.Cells(77, 10).Value & " " & Pass.Cells(78, 10).Value _
& " " & Pass.Cells(79, 10).Value & " " & Pass.Cells(80, 10).Value & " " & Pass.Cells(81, 10).Value & "." & vbCrLf & Pass.Cells(82, 10).Value _
& vbCrLf & Pass.Cells(83, 10).Value & vbCrLf & Pass.Cells(84, 10).Value & ", " & Pass.Cells(85, 10).Value & " " & Pass.Cells(86, 10).Value _
& vbCrLf & Pass.Cells(87, 10).Value & vbCrLf & Pass.Cells(88, 10).Value & ", " & Pass.Cells(89, 10).Value & "." & vbCrLf & "   " & _
Pass.Cells(90, 10).Value & vbCrLf & Pass.Cells(91, 10).Value & ", " & Pass.Cells(92, 10).Value & " " & Pass.Cells(93, 10).Value _
& ". " & Pass.Cells(94, 10).Value & ", " & Pass.Cells(95, 10).Value & " " & Pass.Cells(96, 10).Value & vbCrLf & Pass.Cells(97, 10).Value _
& vbCrLf & Pass.Cells(98, 10).Value & ", " & Pass.Cells(99, 10).Value & ", " & Pass.Cells(100, 10).Value & vbCrLf & Pass.Cells(101, 10).Value _
& ", " & Pass.Cells(102, 10).Value & vbCrLf & Pass.Cells(103, 10).Value & vbCrLf & vbCrLf & Pass.Cells(72, 10).Value & " " & LCase(EMAIL.Text) & vbCrLf & Pass.Cells(73, 10).Value _
& " " & "VbaStore.com@gmail.com" & vbCrLf & vbCrLf & Pass.Cells(49, Pass.[A1] + 1).Value & " " & "VbaStore"
sAttachment = ""
Set oCDOCnf = CreateObject("CDO.Configuration")
With oCDOCnf.Fields
.Item(CDO_Cnf & "sendusing") = 2
.Item(CDO_Cnf & "smtpauthenticate") = 1
.Item(CDO_Cnf & "smtpserver") = SMTPserver
.Item(CDO_Cnf & "smtpserverport") = 465
.Item(CDO_Cnf & "smtpusessl") = True
.Item(CDO_Cnf & "sendusername") = sUsername
.Item(CDO_Cnf & "sendpassword") = sPass
.Update
End With
Set oCDOMsg = CreateObject("CDO.Message")
With oCDOMsg
Set .Configuration = oCDOCnf
.BodyPart.Charset = "koi8-r"
.From = sFrom
.To = sTo
.Subject = sSubject
.TextBody = sBody
.send
End With
Select Case Err.Number
Case -2147220973: sMsg = Pass.Cells(46, Pass.[A1] + 1).Value
Case -2147220975: sMsg = Pass.Cells(48, Pass.[A1] + 1).Value
Case 0: sMsg = Pass.Cells(49, Pass.[A1] + 1).Value
Case Else: sMsg = Pass.Cells(47, Pass.[A1] + 1).Value
End Select
If sMsg = Pass.Cells(49, Pass.[A1] + 1).Value Then
sTo = otdelprodaj
sFrom = otdeldogovorov
dHI = CO.GetFolder(Folder & WinSec & "\" & sFlds).DateCreated
For j = 1 To Len(dHI) Step 1
dIA = Mid(dHI, j, 1)
If IsNumeric(dIA) <> True Then
dIA = ""
End If
If dIA = "0" Then
dIA = ""
End If
dER = dIA & dER
Next j
For q = 1 To 7 Step 1
If Mid(Right(CDec("&H" & sFlds), 7), q, 1) > 5 Then
pER = (Mid(Right(CDec("&H" & sFlds), 7), q, 1) - 4) & pER
Else
pER = (Mid(Right(CDec("&H" & sFlds), 7), q, 1) + 4) & pER
End If
Next q
If pER > 5500000 Then
pER = CLng(pER) - CLng(Left(dER, 6))
Else
pER = CLng(pER) + CLng(Left(dER, 6))
End If
sSubject = LCase(EMAIL.Text) & "/" & UCase(SHIFR) & "/" & Pass.Cells(19, Pass.[A1] + 1).Value & "/" & pER
sBody = LCase(EMAIL.Text) & "/" & UCase(SHIFR) & "/" & Pass.Cells(19, Pass.[A1] + 1).Value & "/" & pER
sAttachment = ""
Set oCDOCnf = CreateObject("CDO.Configuration")
With oCDOCnf.Fields
.Item(CDO_Cnf & "sendusing") = 2
.Item(CDO_Cnf & "smtpauthenticate") = 1
.Item(CDO_Cnf & "smtpserver") = SMTPserver
.Item(CDO_Cnf & "smtpserverport") = 465
.Item(CDO_Cnf & "smtpusessl") = True
.Item(CDO_Cnf & "sendusername") = sUsername
.Item(CDO_Cnf & "sendpassword") = sPass
.Update
End With
Set oCDOMsg = CreateObject("CDO.Message")
With oCDOMsg
Set .Configuration = oCDOCnf
.BodyPart.Charset = "koi8-r"
.From = sFrom
.To = sTo
.Subject = sSubject
.TextBody = sBody
.send
End With
Select Case Err.Number
Case -2147220973: sMsg = Pass.Cells(46, Pass.[A1] + 1).Value
Case -2147220975: sMsg = Pass.Cells(48, Pass.[A1] + 1).Value
Case 0: sMsg = Pass.Cells(49, Pass.[A1] + 1).Value
Case Else: sMsg = Pass.Cells(47, Pass.[A1] + 1).Value
End Select
If sMsg = Pass.Cells(49, Pass.[A1] + 1).Value Then
Pass.[D14] = SHIFR
SHIFR.Enabled = False
ACTIVIROVATI.Caption = Pass.Cells(51, Pass.[A1] + 1).Value
PROKODA.Enabled = False
POLKOD.Enabled = False
MkDir (Folder & 1)
MsgBox sMsg & " VbaStore", vbInformation, "VbaStore"
ACTIVACION.Hide
OPLATA.Show
Else
MsgBox sMsg, vbInformation, "VbaStore"
If List1.Range("A1") <> "" Then
List1.Range("A1").ClearContents
Exit Sub
End If
End If
Else
MsgBox sMsg, vbInformation, "VbaStore"
If List1.Range("A1") <> "" Then
List1.Range("A1").ClearContents
Exit Sub
End If
End If
Else
On Error Resume Next
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
Exit Sub
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End Sub

Attribute VB_Name = "K0D30"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Function DownLoadFile(FromPathName As String, ToPathName As String) As Boolean
DownLoadFile = URLDownloadToFile(0, FromPathName, ToPathName, 0, 0) = 0
End Function
Private Sub Workbook_Open()
On Error Resume Next
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.DisplayAlerts = False
Application.Calculation = xlCalculationManual
Application.EnableEvents = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
For q = 1 To Application.Workbooks.Count
If Not ThisWorkbook.FullName = Workbooks(q).FullName Then
For j = 1 To Workbooks(q).Sheets.Count
x = x + 1
If Workbooks(q).Sheets(j).Name = "Pass" Then
If IsNumeric(Workbooks(q).Sheets(j).Range("A1")) = True Then
If Workbooks(q).Sheets(j).Range("A1") >= 0 Then
Pass.[A1] = Workbooks(q).Sheets(j).Range("A1")
End If
End If
End If
Next j
End If
Next q
DownLoadFile SSILKA, CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\1.xlsx"
If Dir(CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\1.xlsx", vbDirectory) <> "" Then
Pass.Range("A16:L16").Formula = "='" & CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\[1.xlsx]1'!A9:L9"
Pass.Range("A15:E15").Formula = "='" & CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\[1.xlsx]1'!A" & shV & ":E" & shV
Application.Calculation = xlAutomatic
Pass.Range("A15:L16") = Pass.Range("A15:L16").Value
Application.Calculation = xlManual
Kill CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\1.xlsx"
Else
On Error Resume Next
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
Set CO = CreateObject("Scripting.FileSystemObject")
Folder = Left(CreateObject("Scripting.FileSystemObject").GetSpecialFolder(0), 2) & "\WinSec\"
If CreateObject("Scripting.FileSystemObject").FolderExists(Folder) = False Then
Application.EnableEvents = True
ACTIVACION.Show
Exit Sub
Else
KFSF = Folder & EmailSec
For j = 1 To 256
If CO.GetFolder(KFSF).SubFolders.Count = 1 Then
For Each KodFolder In CO.GetFolder(KFSF).SubFolders
KFSN = KodFolder.Name
Next
EMAIL = EMAIL & Chr(KFSN - 777)
KFSF = KFSF & "\" & KFSN
Else
Exit For
End If
Next j
For Each SubFolder In CO.GetFolder(Folder & WinSec & "\").SubFolders
sFlds = SubFolder.Name
Next
Pass.[C14] = EMAIL
If CO.FolderExists(Folder & 1) = True Then
Pass.[B14] = 1
Pass.[D14] = CDec("&H" & sFlds)
If CO.GetFolder(Folder & WinSec & "\" & sFlds).SubFolders.Count > 0 Then
On Error Resume Next
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
Application.EnableEvents = True
OPLATA.Show
Exit Sub
End If
Pass.[B14] = 1
Application.EnableEvents = True
ACTIVACION.Show
Exit Sub
End If
End Sub





Attribute VB_Name = "K0D31"
Declare Function URLDownloadToFile Lib "urlmon" Alias "URLDownloadToFileA" (ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
Public Const SSILKA = "https://drive.google.com/uc?export=download&id=13MiIyIaGdGUmyDB9v2YC_-nJ6wOPP1FI"
Public Const SSILKB = "https://drive.google.com/uc?export=download&id=1oDlVqcrcp8quRifhNOntvzlOms5BGNjJ"
Public Const WinSec = "V_1.0"
Public Const EmailSec = "EV_1.0"
Public Const shV = 11
Public Const otdeldogovorov2 = "vbastore.automail@gmail.com"
Public Const porolOG2 = "PRO_216_Pz_projH.357_Pqe"
Public Const otdelprodaj = "vbastore.com@gmail.com"
Public Const porolD = "Pz_projH.357_Pqe_PRO_216"
Private Sub Auto_Open()
On Error Resume Next
Application.ScreenUpdating = False
Application.DisplayStatusBar = False
Application.DisplayAlerts = False
Application.Calculation = xlCalculationManual
Application.EnableEvents = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.EnableEvents = True
End Sub
Private Sub Auto_Close()
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End Sub





Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "OPLATA"
Attribute VB_Base = "0{81BC9D11-2C8A-4B15-8819-66DCCE08E58F}{38F1A2B5-888D-4E68-8168-7F2F49D23D41}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Initialize()
On Error Resume Next
Application.EnableEvents = False
If Dir(ThisWorkbook.FullName) <> "" Then
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
If Pass.[A16] = "" Then
SP1.Enabled = False
QIWI.Enabled = False
End If
If Pass.[C16] = "" Then
SP2.Enabled = False
Paypal.Enabled = False
End If
If Pass.[E16] = "" Then
SP3.Enabled = False
WU.Enabled = False
End If
If Pass.[G16] = "" Then
SP4.Enabled = False
KAPTA.Enabled = False
End If
If Pass.[I16] = "" Then
SP5.Enabled = False
C4ET.Enabled = False
End If
If Pass.[B15] = "" Then
OPLATA.Caption = Pass.Cells(137, Pass.[A1] + 1).Value
Else
OPLATA.Caption = Pass.Cells(137, Pass.[A1] + 1).Value & "     " & Pass.Cells(138, Pass.[A1] + 1).Value _
& "  " & Pass.[B15] & "%" & "  " & Pass.Cells(139, Pass.[A1] + 1).Value & "  " & Pass.[C15]
End If
KAPTA.Value = Pass.Cells(106, Pass.[A1] + 1).Value
C4ET.Value = Pass.Cells(107, Pass.[A1] + 1).Value
KOMENT.Caption = Pass.Cells(108, Pass.[A1] + 1).Value
CAMKOMENT.Caption = Pass.Cells(109, Pass.[A1] + 1).Value
PYBL.Caption = Pass.Cells(110, Pass.[A1] + 1).Value
USDOL.Caption = Pass.Cells(111, Pass.[A1] + 1).Value
OTKOGO.Caption = Pass.Cells(112, Pass.[A1] + 1).Value
COOB.Caption = Pass.Cells(113, Pass.[A1] + 1).Value
FAIL.Caption = Pass.Cells(114, Pass.[A1] + 1).Value
COPYEMAIL.Caption = Pass.Cells(115, Pass.[A1] + 1).Value
COPKOMEN.Caption = Pass.Cells(115, Pass.[A1] + 1).Value
KOPSILK.Caption = Pass.Cells(115, Pass.[A1] + 1).Value
EMAILSHIFR = Pass.[C14] & "/" & Pass.[D14]
OPLOTPR.Caption = Pass.Cells(141, Pass.[A1] + 1).Value
VIDAKTIV.Caption = Pass.Cells(142, Pass.[A1] + 1).Value
DEISACTIV.Caption = Pass.Cells(143, Pass.[A1] + 1).Value
VSTDESH.Caption = Pass.Cells(144, Pass.[A1] + 1).Value
POLACTIV.Caption = Pass.Cells(145, Pass.[A1] + 1).Value
VASHEMAIL.Caption = Pass.Cells(146, Pass.[A1] + 1).Value
EMAIL.Value = Pass.[C14]
IZMEMAIL.Caption = Pass.Cells(146, Pass.[A1] + 1).Value
If Pass.[I15] = 0 Then
SPOPL2.Value = True
INFOR.Caption = Pass.[A15] * Pass.[E15] / Pass.[D15] & Pass.Cells(104, Pass.[A1] + 1).Value
Else
SPOPL1.Value = True
INFOR.Caption = Pass.[A15] & Pass.Cells(105, Pass.[A1] + 1).Value
End If
If Pass.[J15] = 1 Then
If Pass.[I15] = 1 Then
SP1.Value = True
IVARIANT.Caption = Pass.Cells(116, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " QIWI WALLET " & Pass.Cells(123, Pass.[A1] + 1).Value & _
Pass.[A16] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(125, Pass.[A1] + 1).Value & Pass.[B16] _
& " " & Pass.Cells(126, Pass.[A1] + 1).Value
Else
SP1.Value = True
IVARIANT.Caption = Pass.Cells(117, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(127, Pass.[A1] + 1).Value & " " & Pass.[B16] & " " & Pass.Cells(122, Pass.[A1] + 1).Value _
& " QIWI WALLET " & Pass.Cells(140, Pass.[A1] + 1).Value & " https://qiwi.com/"
End If
End If
If Pass.[J15] = 2 Then
If Pass.[I15] = 1 Then
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[C16] & Pass.[A15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[K16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
Else
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[D16] & Pass.[A15] * Pass.[E15] / Pass.[D15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[L16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 3 Then
If Pass.[I15] = 1 Then
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[E16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
Else
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[F16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 4 Then
If Pass.[I15] = 1 Then
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[G16]
Else
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[H16]
End If
End If
If Pass.[J15] = 5 Then
If Pass.[I15] = 1 Then
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[I16]
Else
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[J16]
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SPOPL1_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[I15] = 1
KOMENT.Caption = Pass.Cells(108, Pass.[A1] + 1).Value
INFOR.Caption = Pass.[A15] & Pass.Cells(105, Pass.[A1] + 1).Value
If Pass.[J15] = 1 Then
If Pass.[I15] = 1 Then
SP1.Value = True
IVARIANT.Caption = Pass.Cells(116, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " QIWI WALLET " & Pass.Cells(123, Pass.[A1] + 1).Value & _
Pass.[A16] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(125, Pass.[A1] + 1).Value & Pass.[B16] _
& " " & Pass.Cells(126, Pass.[A1] + 1).Value
Else
SP1.Value = True
IVARIANT.Caption = Pass.Cells(117, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(127, Pass.[A1] + 1).Value & " " & Pass.[B16] & " " & Pass.Cells(122, Pass.[A1] + 1).Value _
& " QIWI WALLET " & Pass.Cells(140, Pass.[A1] + 1).Value & " https://qiwi.com/"
End If
End If
If Pass.[J15] = 2 Then
If Pass.[I15] = 1 Then
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[C16] & Pass.[A15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[K16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
Else
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[D16] & Pass.[G15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[L16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 3 Then
If Pass.[I15] = 1 Then
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[E16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
Else
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[F16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 4 Then
If Pass.[I15] = 1 Then
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[G16]
Else
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[H16]
End If
End If
If Pass.[J15] = 5 Then
If Pass.[I15] = 1 Then
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[I16]
Else
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[J16]
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SPOPL2_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[I15] = 0
KOMENT.Caption = Pass.Cells(108, Pass.[A1] + 1).Value
INFOR.Caption = Pass.[A15] * Pass.[E15] / Pass.[D15] & Pass.Cells(104, Pass.[A1] + 1).Value
If Pass.[J15] = 1 Then
If Pass.[I15] = 1 Then
SP1.Value = True
IVARIANT.Caption = Pass.Cells(116, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " QIWI WALLET " & Pass.Cells(123, Pass.[A1] + 1).Value & _
Pass.[A16] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(125, Pass.[A1] + 1).Value & Pass.[B16] _
& " " & Pass.Cells(126, Pass.[A1] + 1).Value
Else
SP1.Value = True
IVARIANT.Caption = Pass.Cells(117, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(127, Pass.[A1] + 1).Value & " " & Pass.[B16] & " " & Pass.Cells(122, Pass.[A1] + 1).Value _
& " QIWI WALLET " & Pass.Cells(140, Pass.[A1] + 1).Value & " https://qiwi.com/"
End If
End If
If Pass.[J15] = 2 Then
If Pass.[I15] = 1 Then
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[C16] & Pass.[A15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[K16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
Else
SP2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[D16] & Pass.[A15] * Pass.[E15] / Pass.[D15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[L16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 3 Then
If Pass.[I15] = 1 Then
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[E16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
Else
SP3.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[F16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
End If
End If
If Pass.[J15] = 4 Then
If Pass.[I15] = 1 Then
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[G16]
Else
SP4.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[H16]
End If
End If
If Pass.[J15] = 5 Then
If Pass.[I15] = 1 Then
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[I16]
Else
SP5.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[J16]
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub QIWI_Click()
On Error Resume Next
If Pass.[J15] = 1 Then
If Pass.[I15] = 1 Then
With CreateObject("WScript.Shell")
.Run Pass.[A16]
End With
Else
With CreateObject("WScript.Shell")
.Run "https://qiwi.com/"
End With
End If
End If
Exit Sub
End Sub
Private Sub Paypal_Click()
On Error Resume Next
If Pass.[J15] = 2 Then
If Pass.[I15] = 1 Then
With CreateObject("WScript.Shell")
.Run Pass.[C16] & Pass.[A15]
End With
Else
With CreateObject("WScript.Shell")
.Run Pass.[D16] & Pass.[G15]
End With
End If
End If
Exit Sub
End Sub
Private Sub WU_Click()
On Error Resume Next
If Pass.[J15] = 3 Then
With CreateObject("WScript.Shell")
.Run "www.westernunion.com"
End With
End If
Exit Sub
End Sub
Private Sub SP1_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[J15] = 1
If Pass.[I15] = 1 Then
SPOPL1.Value = True
IVARIANT.Caption = Pass.Cells(116, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " QIWI WALLET " & Pass.Cells(123, Pass.[A1] + 1).Value & _
Pass.[A16] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(125, Pass.[A1] + 1).Value & Pass.[B16] _
& " " & Pass.Cells(126, Pass.[A1] + 1).Value
Else
SPOPL2.Value = True
IVARIANT.Caption = Pass.Cells(117, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(127, Pass.[A1] + 1).Value & " " & Pass.[B16] & " " & Pass.Cells(122, Pass.[A1] + 1).Value _
& " QIWI WALLET " & Pass.Cells(140, Pass.[A1] + 1).Value & " https://qiwi.com/"
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SP2_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[J15] = 2
If Pass.[J15] = 2 Then
If Pass.[I15] = 1 Then
SPOPL1.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[C16] & Pass.[A15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[K16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
Else
SPOPL2.Value = True
IVARIANT.Caption = Pass.Cells(118, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " PayPal " & Pass.Cells(123, Pass.[A1] + 1).Value & " " & _
Pass.[D16] & Pass.[A15] * Pass.[E15] / Pass.[D15] & " " & Pass.Cells(124, Pass.[A1] + 1).Value & " " & Pass.Cells(128, Pass.[A1] + 1).Value & " " & _
Pass.[L16] & " " & Pass.Cells(129, Pass.[A1] + 1).Value
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SP3_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[J15] = 3
If Pass.[J15] = 3 Then
If Pass.[I15] = 1 Then
SPOPL1.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[E16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
Else
SPOPL2.Value = True
IVARIANT.Caption = Pass.Cells(119, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(122, Pass.[A1] + 1).Value & " Western Union " & Pass.Cells(123, Pass.[A1] + 1).Value & _
" www.westernunion.com. " & Pass.Cells(130, Pass.[A1] + 1).Value & " " & Pass.[F16] & " " & Pass.Cells(132, Pass.[A1] + 1).Value & " " & _
Pass.Cells(131, Pass.[A1] + 1).Value
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SP4_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[J15] = 4
If Pass.[J15] = 4 Then
If Pass.[I15] = 1 Then
SPOPL1.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[G16]
Else
SPOPL2.Value = True
IVARIANT.Caption = Pass.Cells(120, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(133, Pass.[A1] + 1).Value & " " & Pass.[H16]
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub SP5_Click()
On Error Resume Next
Application.EnableEvents = False
Pass.[J15] = 5
If Pass.[J15] = 5 Then
If Pass.[I15] = 1 Then
SPOPL1.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[I16]
Else
SPOPL2.Value = True
IVARIANT.Caption = Pass.Cells(121, Pass.[A1] + 1).Value
OPISOPL.Value = Pass.Cells(136, Pass.[A1] + 1).Value & " " & Pass.[J16]
End If
End If
Application.EnableEvents = True
Exit Sub
End Sub
Private Sub COPKOMEN_Click()
On Error Resume Next
Dim MyDataObj As New DataObject
    MyDataObj.SetText EMAILSHIFR.Text: MyDataObj.PutInClipboard
Exit Sub
End Sub
Private Sub KOPSILK_Click()
On Error Resume Next
Dim MyDataObj As New DataObject
    MyDataObj.SetText OPISOPL.Text: MyDataObj.PutInClipboard
Exit Sub
End Sub
Private Sub FAIL_Click()
On Error Resume Next
Dim avFiles
avFiles = Application.GetOpenFilename _
("All files(*.*),*.*", 1, "??????? ????? ??? ????????", , fasle)
If VarType(avFiles) = vbBoolean Then
PFAIL = ""
Exit Sub
End If
PFAIL = avFiles
Exit Sub
End Sub
Private Sub OPLOTPR_Click()
On Error Resume Next
eMel = List1.Range("A1")
If eMel <> "" Then
otdeldogovorov = eMel
porolOG = porolD
Else
otdeldogovorov = otdeldogovorov2
porolOG = porolOG2
End If
Const CDO_Cnf = "http://schemas.microsoft.com/cdo/configuration/"
Dim oCDOCnf As Object, oCDOMsg As Object
Dim SMTPserver As String, sUsername As String, sPass As String, sMsg As String
Dim sTo As String, sFrom As String, sSubject As String, sBody As String, sAttachment As String
SMTPserver = "smtp.gmail.com"
sUsername = otdeldogovorov
sPass = porolOG
If Len(SMTPserver) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
If Len(sUsername) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
If Len(sPass) = 0 Then MsgBox Pass.Cells(39, Pass.[A1] + 1).Value, vbInformation, "VbaStore": Exit Sub
sTo = otdelprodaj
sFrom = otdeldogovorov
sSubject = Pass.[C14] & "/" & Pass.[D14]
sBody = SMS
sAttachment = PFAIL
If Dir(sAttachment, vbDirectory) = "" Then sAttachment = ""
If Dir(sAttachment, vbDirectory) = "" Then sAttachment = ""
Set oCDOCnf = CreateObject("CDO.Configuration")
With oCDOCnf.Fields
.Item(CDO_Cnf & "sendusing") = 2
.Item(CDO_Cnf & "smtpauthenticate") = 1
.Item(CDO_Cnf & "smtpserver") = SMTPserver
.Item(CDO_Cnf & "smtpserverport") = 465
.Item(CDO_Cnf & "smtpusessl") = True
.Item(CDO_Cnf & "sendusername") = sUsername
.Item(CDO_Cnf & "sendpassword") = sPass
.Update
End With
Set oCDOMsg = CreateObject("CDO.Message")
With oCDOMsg
Set .Configuration = oCDOCnf
.BodyPart.Charset = "koi8-r"
.From = sFrom
.To = sTo
.Subject = sSubject
.TextBody = sBody
If Len(sAttachment) > 0 Then .AddAttachment sAttachment
.send
End With
Select Case Err.Number
Case -2147220973: sMsg = Pass.Cells(46, Pass.[A1] + 1).Value
Case -2147220975: sMsg = Pass.Cells(48, Pass.[A1] + 1).Value
Case 0: sMsg = Pass.Cells(149, Pass.[A1] + 1).Value
Case Else: sMsg = Pass.Cells(47, Pass.[A1] + 1).Value
End Select
If sMsg = Pass.Cells(149, Pass.[A1] + 1).Value Then
SMS = ""
PFAIL = ""
MsgBox sMsg, vbInformation, "VbaStore"
Else
If List1.Range("A1") <> "" Then
List1.Range("A1").ClearContents
Exit Sub
End If
End If
Exit Sub
End Sub
Private Sub VSTDESH_Click()
On Error Resume Next
DESHFR.Paste
Exit Sub
End Sub
Private Sub POLACTIV_Click()
On Error Resume Next
Set CO = CreateObject("Scripting.FileSystemObject")
Folder = Left(CreateObject("Scripting.FileSystemObject").GetSpecialFolder(0), 2) & "\WinSec\"
For Each SubFolder In CO.GetFolder(Folder & WinSec & "\").SubFolders
sFlds = SubFolder.Name
Next
dHI = CO.GetFolder(Folder & WinSec & "\" & sFlds).DateCreated
For j = 1 To Len(dHI) Step 1
dIA = Mid(dHI, j, 1)
If IsNumeric(dIA) <> True Then
dIA = ""
End If
If dIA = "0" Then
dIA = ""
End If
dER = dIA & dER
Next j
For q = 1 To 7 Step 1
If Mid(Right(CDec("&H" & sFlds), 7), q, 1) > 5 Then
pER = (Mid(Right(CDec("&H" & sFlds), 7), q, 1) - 4) & pER
Else
pER = (Mid(Right(CDec("&H" & sFlds), 7), q, 1) + 4) & pER
End If
Next q
If pER > 5500000 Then
pER = CLng(pER) - CLng(Left(dER, 6))
Else
pER = CLng(pER) + CLng(Left(dER, 6))
End If
If CLng(pER) = CLng(DESHFR) Then
MsgBox Pass.Cells(134, Pass.[A1] + 1).Value, vbInformation, "VbaStore"
MkDir (Folder & WinSec & "\" & sFlds & "\" & Hex$(pER))
On Error Resume Next
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
Else
On Error Resume Next
MsgBox "ERROR", vbInformation, "VbaStore"
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End If
Exit Sub
End Sub
Private Sub COPYEMAIL_Click()
Dim MyDataObj As New DataObject
MyDataObj.SetText EMAIL.Text: MyDataObj.PutInClipboard
Exit Sub
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
Application.DisplayAlerts = False
ThisWorkbook.ChangeFileAccess xlReadOnly
Kill ThisWorkbook.FullName
Application.ScreenUpdating = True
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
Application.Calculation = xlAutomatic
Application.EnableEvents = True
ThisWorkbook.Close 0
End Sub
Attribute VB_Name = "Pass"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True




INQUEST-PP=macro
