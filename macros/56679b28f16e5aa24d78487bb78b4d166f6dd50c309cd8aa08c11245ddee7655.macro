Attribute VB_Name = "Module1"
Sub RefreshAndSort()
Attribute RefreshAndSort.VB_Description = "Macro recorded 1/27/2005 by rnast"
Attribute RefreshAndSort.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RefreshAndSort Macro
' Macro recorded 1/27/2005 by rnast
'

'
    Range("A4").Select
    Selection.QueryTable.Refresh BackgroundQuery:=False
    Selection.Sort Key1:=Range("E5"), Order1:=xlAscending, Key2:=Range("N5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
        ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
End Sub
Sub DeleteColumn()
Attribute DeleteColumn.VB_Description = "Macro recorded 1/27/2005 by rnast"
Attribute DeleteColumn.VB_ProcData.VB_Invoke_Func = " \n14"
'
' DeleteColumn Macro
' Macro recorded 1/27/2005 by rnast
'

'
    ActiveWindow.SmallScroll ToRight:=1
    Columns("O:O").Select
    Selection.ClearContents
    Range("N10").Select
End Sub
Attribute VB_Name = "Module10"
Sub RightFormat()
Attribute RightFormat.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RightFormat Macro
'

'
    Range("E168").Select
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("E169").Select
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
End Sub
Attribute VB_Name = "Module11"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents

'This part determines the total number of rows and deletes the old info.
Range("H1").Formula = "=counta(H5:H5000)"
rowcount = Range("H1").Value + 5
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
    Range("Table_Query_from_EpicorProd6[EmployeeNum]").Select
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("D5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom

'This part will convert all job numbers to upper case
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("S" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-15])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("S:S").Select
Selection.ClearContents
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"


'This part determines the total number of rows
Range("H1").Formula = "=counta(H5:H5000)"
rowcount = Range("H1").Value + 5

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("I" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop
'This part inserts efficiency calculations
currentrow = 5
cell = ("R" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-7]/Rc[-8]"
  currentrow = currentrow + 1
  cell = ("R" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("A5").Select
'This part inserts man to machine calculations
currentrow = 5
cell = ("S" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-9]/Rc[-10]"
  currentrow = currentrow + 1
  cell = ("S" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("S4").Select
ActiveCell.FormulaR1C1 = "M/M Ratio"
Range("A5").Select


End Sub
Attribute VB_Name = "Module12"
Sub RefreshPart()
Attribute RefreshPart.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RefreshPart Macro
'
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

    Range("A5").Select
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False

'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
 'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop
'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
Range("P4").Select
ActiveCell.Value = "Efficiency"
Range("A5").Select


   
    
    
    
    
End Sub
Attribute VB_Name = "Module13"
Attribute VB_Name = "Module14"
Sub RefreshTable()
Attribute RefreshTable.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RefreshTable Macro
'

'
    Range("Table_Query_from_EpicorProd6[EmployeeNum]").Select
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
End Sub
Attribute VB_Name = "Module15"
Sub SubtotalTest()
Attribute SubtotalTest.VB_ProcData.VB_Invoke_Func = " \n14"
'
' SubtotalTest Macro
'

'
    Range("A5").Select
End Sub
Attribute VB_Name = "Module16"
Attribute VB_Name = "Module17"
Sub Macro3()
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
'

'
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
End Sub
Attribute VB_Name = "Module2"
Sub SortByEmployee()
Attribute SortByEmployee.VB_Description = "Macro recorded 1/31/2005 by rnast"
Attribute SortByEmployee.VB_ProcData.VB_Invoke_Func = " \n14"
'
' SortByEmployee Macro
' Macro recorded 1/31/2005 by rnast
'

'
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
End Sub
Attribute VB_Name = "Module3"
Sub PartNumber()
Attribute PartNumber.VB_Description = "Macro recorded 2/10/2005 by rnast"
Attribute PartNumber.VB_ProcData.VB_Invoke_Func = " \n14"
'
' PartNumber Macro
' Macro recorded 2/10/2005 by rnast
'

'
    Range("A4").Select
    Selection.QueryTable.Refresh BackgroundQuery:=False
    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True
End Sub
Attribute VB_Name = "Module4"
Sub PasteSpecial()
Attribute PasteSpecial.VB_Description = "Macro recorded 4/29/2005 by rnast"
Attribute PasteSpecial.VB_ProcData.VB_Invoke_Func = " \n14"
'
' PasteSpecial Macro
' Macro recorded 4/29/2005 by rnast
'

'
    Range("P24").Select
    Selection.Copy
    Range("D24").Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Range("P24").Select
    Application.CutCopyMode = False
    Selection.ClearContents
End Sub
Sub CopyColumn()
Attribute CopyColumn.VB_Description = "Macro recorded 4/29/2005 by rnast"
Attribute CopyColumn.VB_ProcData.VB_Invoke_Func = " \n14"
'
' CopyColumn Macro
' Macro recorded 4/29/2005 by rnast
'

'
    Columns("D:D").Select
    Selection.Copy
    Columns("P:P").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
End Sub
Attribute VB_Name = "Module5"
Attribute VB_Name = "Module6"
Sub DeleteBlankRows()
Attribute DeleteBlankRows.VB_Description = "Macro recorded 10/23/2008 by Richard Nast"
Attribute DeleteBlankRows.VB_ProcData.VB_Invoke_Func = " \n14"
'
' DeleteBlankRows Macro
' Macro recorded 10/23/2008 by Richard Nast
'
'
Dim mrowcounter As Integer
Dim mblankcounter As Integer
Dim mrow As Integer
Dim mCell As String

mrow = 5
Do Until mblankcounter = 50
  mCell = "A" & mrow
  Range(mCell).Select
  If ActiveCell.Text = "" Then
    Rows(mrow).Delete
    mblankcounter = mblankcounter + 1
    mrow = mrow + 1
  Else
    mblankcounter = 0
    mrow = mrow + 1
  End If
Loop
'
Range("A5").Select
'
End Sub
Attribute VB_Name = "Module7"
Sub RefreshQueryParybyOperation()
Attribute RefreshQueryParybyOperation.VB_ProcData.VB_Invoke_Func = " \n14"
'
' RefreshQueryParybyOperation Macro
'

'
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
End Sub
Attribute VB_Name = "Module8"
Sub RemoveLoop()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String

'This part determines the total number of rows.
rowcount = 6
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part will delete the rows of Loop
currentrow = 6
cell = ("B" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  If ActiveCell.Text = "LOOP" Then
    Rows(currentrow).Select
    Selection.Delete
  Else
    currentrow = currentrow + 1
  End If
  cell = ("B" & currentrow)
Loop
Range("A6").Select
End Sub
Sub temporary()
Attribute temporary.VB_ProcData.VB_Invoke_Func = " \n14"
'
' temporary Macro
'

'
    Columns("O:O").Select
    Selection.Style = "Percent"
    Columns("M:M").Select
    Selection.NumberFormat = "m/d/yy;@"
End Sub
Attribute VB_Name = "Module9"
Sub Subtotal()
'This Macro subtotals at each change in Labor Type for each individual job number.

Dim JobNum As String
Dim LaborType As String
Dim LaborHrs As Single
Dim BurdenHrs As Single
Dim Quantity As Single
Dim EarnedHrs As Single
Dim SetGrandLaborHrs As Single
Dim SetGrandBurdenHrs As Single
Dim SetGrandQuantity As Single
Dim SetGrandEarnedHrs As Single
Dim RunGrandLaborHrs As Single
Dim RunGrandBurdenHrs As Single
Dim RunGrandQuantity As Single
Dim RunGrandEarnedHrs As Single
Dim TotalRows As Integer
Dim CurRow As Integer
Dim CurCell As String
Dim LDate As Date
Dim UDate As Date
Dim PartNo As String

SetGrandLaborHrs = 0
SetGrandBurdenHrs = 0
SetGrandQuantity = 0
SetGrandEarnedHrs = 0
RunGrandLaborHrs = 0
RunGrandBurdenHrs = 0
RunGrandQuantity = 0
RunGrandEarnedHrs = 0


Range("N1").Select
ActiveCell.Formula = "=counta(a6:a7000)"
TotalRows = ActiveCell.Value + 6

Range("D6").Select
JobNum = ActiveCell.Value
Range("I6").Select
LaborType = ActiveCell.Value
Range("J6").Select
LaborHrs = ActiveCell.Value
Range("K6").Select
BurdenHrs = ActiveCell.Value
Range("L6").Select
Quantity = ActiveCell.Value
Range("N6").Select
EarnedHrs = ActiveCell.Value

CurRow = 7
Do Until CurRow > TotalRows
  CurCell = "D" & CurRow
  Range(CurCell).Select
  If ActiveCell.Value = JobNum Then
    CurCell = "I" & CurRow
    Range(CurCell).Select
    If ActiveCell.Value = LaborType Then
      CurCell = "J" & CurRow
      Range(CurCell).Select
      LaborHrs = LaborHrs + ActiveCell.Value
      CurCell = "K" & CurRow
      Range(CurCell).Select
      BurdenHrs = BurdenHrs + ActiveCell.Value
      CurCell = "L" & CurRow
      Range(CurCell).Select
      Quantity = Quantity + ActiveCell.Value
      CurCell = "N" & CurRow
      Range(CurCell).Select
      EarnedHrs = EarnedHrs + ActiveCell.Value
      CurRow = CurRow + 1
    Else
      If LaborType = "S" Then
        SetGrandLaborHrs = SetGrandLaborHrs + LaborHrs
        SetGrandBurdenHrs = SetGrandBurdenHrs + BurdenHrs
        SetGrandQuantity = SetGrandQuantity + Quantity
        SetGrandEarnedHrs = SetGrandEarnedHrs + EarnedHrs
      Else
        RunGrandLaborHrs = RunGrandLaborHrs + LaborHrs
        RunGrandBurdenHrs = RunGrandBurdenHrs + BurdenHrs
        RunGrandQuantity = RunGrandQuantity + Quantity
        RunGrandEarnedHrs = RunGrandEarnedHrs + EarnedHrs
      End If
      CurCell = CurRow & ":" & CurRow
      Rows(CurCell).Select
      Selection.Insert
      CurCell = "E" & CurRow
      TotalRows = TotalRows + 1
      Range(CurCell).Select
      If LaborType = "S" Then
        ActiveCell.Value = "Set Up Totals for " & JobNum
      Else
        ActiveCell.Value = "Production Totals for " & JobNum
      End If
      CurCell = "J" & CurRow
      Range(CurCell).Select
      ActiveCell.Value = LaborHrs
      CurCell = "K" & CurRow
      Range(CurCell).Select
      ActiveCell.Value = BurdenHrs
      CurCell = "L" & CurRow
      Range(CurCell).Select
      ActiveCell.Value = Quantity
      CurCell = "N" & CurRow
      Range(CurCell).Select
      ActiveCell.Value = EarnedHrs
      LaborHrs = 0
      BurdenHrs = 0
      Quantity = 0
      EarnedHrs = 0
      CurRow = CurRow + 1
      CurCell = "I" & CurRow
      Range(CurCell).Select
      LaborType = ActiveCell.Value
      CurCell = "J" & CurRow
      Range(CurCell).Select
      LaborHrs = ActiveCell.Value
      CurCell = "K" & CurRow
      Range(CurCell).Select
      BurdenHrs = ActiveCell.Value
      CurCell = "L" & CurRow
      Range(CurCell).Select
      Quantity = ActiveCell.Value
      CurCell = "N" & CurRow
      Range(CurCell).Select
      EarnedHrs = ActiveCell.Value
      CurRow = CurRow + 1
    End If
    Else
      If LaborType = "S" Then
        SetGrandLaborHrs = SetGrandLaborHrs + LaborHrs
        SetGrandBurdenHrs = SetGrandBurdenHrs + BurdenHrs
        SetGrandQuantity = SetGrandQuantity + Quantity
        SetGrandEarnedHrs = SetGrandEarnedHrs + EarnedHrs
      Else
        RunGrandLaborHrs = RunGrandLaborHrs + LaborHrs
        RunGrandBurdenHrs = RunGrandBurdenHrs + BurdenHrs
        RunGrandQuantity = RunGrandQuantity + Quantity
        RunGrandEarnedHrs = RunGrandEarnedHrs + EarnedHrs
      End If
    CurCell = CurRow & ":" & CurRow
    Rows(CurCell).Select
    Selection.Insert
    CurCell = "E" & CurRow
    TotalRows = TotalRows + 1
    Range(CurCell).Select
    If LaborType = "S" Then
      ActiveCell.Value = "Set Up Totals for " & JobNum
    Else
      ActiveCell.Value = "Production Totals for " & JobNum
    End If
    CurCell = "J" & CurRow
    Range(CurCell).Select
    ActiveCell.Value = LaborHrs
    CurCell = "K" & CurRow
    Range(CurCell).Select
    ActiveCell.Value = BurdenHrs
    CurCell = "L" & CurRow
    Range(CurCell).Select
    ActiveCell.Value = Quantity
    CurCell = "N" & CurRow
    Range(CurCell).Select
    ActiveCell.Value = EarnedHrs
    LaborHrs = 0
    BurdenHrs = 0
    Quantity = 0
    EarnedHrs = 0
    CurRow = CurRow + 1
    CurCell = "D" & CurRow
    Range(CurCell).Select
    JobNum = ActiveCell.Value
    CurCell = "I" & CurRow
    Range(CurCell).Select
    LaborType = ActiveCell.Value
    CurCell = "J" & CurRow
    Range(CurCell).Select
    LaborHrs = ActiveCell.Value
    CurCell = "K" & CurRow
    Range(CurCell).Select
    BurdenHrs = ActiveCell.Value
    CurCell = "L" & CurRow
    Range(CurCell).Select
    Quantity = ActiveCell.Value
    CurCell = "N" & CurRow
    Range(CurCell).Select
    EarnedHrs = ActiveCell.Value
    CurRow = CurRow + 1
    
    
  End If
Loop
Range("B1").Select
LDate = ActiveCell.Value
Range("C1").Select
UDate = ActiveCell.Value
Range("E6").Select
PartNo = ActiveCell.Value
CurCell = "H" & CurRow + 1
Range(CurCell).Select
ActiveCell.Value = "Grand Totals for " & PartNo & " for Date Range " & LDate & " Through " & UDate
CurCell = "H" & CurRow + 2
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

Range(CurCell).Select
ActiveCell.Value = "Total Set Up Hours"
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    CurCell = "J" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.Value = SetGrandLaborHrs
    CurCell = "K" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.Value = SetGrandBurdenHrs
    CurCell = "L" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.Value = SetGrandQuantity
    CurCell = "N" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.Value = SetGrandEarnedHrs
    CurCell = "O" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.FormulaR1C1 = "=RC[-1]/RC[-4]"
    CurCell = "P" & CurRow + 2
    Range(CurCell).Select
    ActiveCell.FormulaR1C1 = "=RC[-4]/RC[-5]"

CurCell = "H" & CurRow + 3
Range(CurCell).Select
ActiveCell.Value = "Total Production Hours"
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    CurCell = "J" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.Value = RunGrandLaborHrs
    CurCell = "K" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.Value = RunGrandBurdenHrs
    CurCell = "L" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.Value = RunGrandQuantity
    CurCell = "N" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.Value = RunGrandEarnedHrs
    CurCell = "O" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.FormulaR1C1 = "=RC[-1]/RC[-4]"
    CurCell = "P" & CurRow + 3
    Range(CurCell).Select
    ActiveCell.FormulaR1C1 = "=RC[-4]/RC[-5]"


Range("A6").Select
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 1, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("D5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("T" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-16])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("T:T").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("I" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("S" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-8]/Rc[-9]"
  currentrow = currentrow + 1
  cell = ("S" & currentrow)
Loop
Range("S4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select

'This part inserts man to machine calculations
currentrow = 5
cell = ("T" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-10]/Rc[-11]"
  currentrow = currentrow + 1
  cell = ("T" & currentrow)
Loop
Range("S4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("T4").Select
ActiveCell.FormulaR1C1 = "M/M Ratio"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select

End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select
End Sub

Private Sub CommandButton2_Click()
'
'This part will remove the blank rows.
Dim mrowcounter As Integer
Dim mblankcounter As Integer
Dim mrow As Integer
Dim mCell As String

mrow = 3
Do Until mblankcounter = 50
  mCell = "A" & mrow
  Range(mCell).Select
  If ActiveCell.Text = "" Then
    Rows(mrow).Delete
    mblankcounter = mblankcounter + 1
    mrow = mrow + 1
  Else
    mblankcounter = 0
    mrow = mrow + 1
  End If
Loop
'
'This part resorts and subtotals by employee.
Range("A4").Select
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select
End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select
End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O5").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("P5").Select
ActiveCell.FormulaR1C1 = "PPH"

'This part determines the total number of rows and deletes the old info.
rowcount = 6
cell = ("N" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("N" & rowcount)
Loop
cell = "6:" & rowcount + 6
Rows(cell).Select
Selection.Clear

Range("A5").Select

Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False

Selection.Sort Key1:=Range("D6"), Order1:=xlAscending, Key2:=Range("I6") _
    , Order2:=xlDescending, Key3:=Range("M6"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom


    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
'This code was brought over from the "Part" sheet and isn't needed in this sheet.
'currentrow = 5
'Range("G5").Select
'jobnum = ActiveCell.Text
'Range("F5").Select
'seqnum = ActiveCell.Text
'Do Until ActiveCell.Text = ""
'  cell = ("G" & currentrow)
'  Range(cell).Select
'  If ActiveCell.Text = jobnum Then
'    joblogic = "T"
'  Else
'    joblogic = "F"
'  End If
'  cell = ("F" & currentrow)
'  Range(cell).Select
'  If ActiveCell.Text = seqnum Then
'    seqlogic = "T"
'  Else
'    seqlogic = "F"
'  End If
'  If joblogic = "T" And seqlogic = "T" Then
'    currentrow = currentrow + 1
'  Else
'    SplitRow = currentrow & ":" & currentrow
'    Rows(SplitRow).Select
'    Selection.Insert Shift:=x1Down
'    cell = ("H" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("I" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "Totals"
'    currentrow = currentrow + 1
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    jobnum = ActiveCell.Text
'    cell = ("F" & currentrow)
'    Range(cell).Select
'    seqnum = ActiveCell.Text
'  End If
'  cell = ("G" & currentrow)
'  Range(cell).Select
'Loop
    
    


'This part determines the total number of rows
rowcount = 6
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
'currentrow = 6
'sumcount = 1
'cell = ("K" & currentrow)
'Range(cell).Select
'Do Until currentrow = rowcount
'  Do Until ActiveCell.Text = "" Or currentrow = rowcount
'    cell = ("K" & currentrow)
'    Range(cell).Select
'    currentrow = currentrow + 1
'    sumcount = sumcount + 1
'  Loop
'  cell = ("K" & currentrow - 1)
'  Range(cell).Select
'  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
'  cell = ("N" & currentrow - 1)
'  Range(cell).Select
'  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
'  cell = ("L" & currentrow - 1)
'  Range(cell).Select
'  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
'  sumcount = -1
'Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 6
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-1]/RC[-4]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

'This part inserts Parts Per Hour calculations
currentrow = 6
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
    Columns("O:O").Select
    Selection.Style = "Percent"
    Columns("M:M").Select
    Selection.NumberFormat = "m/d/yy;@" '

'Range("A5").Select
Application.Run "'Activity by date.xlsm'!RemoveLoop"
Application.Run "'Activity by date.xlsm'!Subtotal"


End Sub
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("S" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-15])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("S:S").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("Q" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-6]/Rc[-7]"
  currentrow = currentrow + 1
  cell = ("Q" & currentrow)
Loop
Range("Q4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select

'This part inserts pieces per hour calculations
currentrow = 5
cell = ("R" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-6]/Rc[-8]"
  currentrow = currentrow + 1
  cell = ("R" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Pcs / Hr"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select


End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'    Range("A4").Select
'    Selection.QueryTable.Refresh BackgroundQuery:=False
'    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True


Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop

Range("A5").Select


End Sub
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'    Range("A4").Select
'    Selection.QueryTable.Refresh BackgroundQuery:=False
'    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True


Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop

Range("A5").Select


End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O3").Select
ActiveCell.FormulaR1C1 = "Machine"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"


'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("I" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts machine efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

'This part inserts employee efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-5]/Rc[-7]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
Range("P3").Select
ActiveCell.FormulaR1C1 = "Employee"
Range("P4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

Range("A4").Select
End Sub

Private Sub CommandButton2_Click()
 Application.Run "'Activity by date.xls'!DeleteBlankRows"
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 1, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("S" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-15])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("S:S").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop




''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts burden $ calculations
currentrow = 5
cell = ("S" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]*Rc[-9]"
  currentrow = currentrow + 1
  cell = ("S" & currentrow)
Loop
Range("S4").Select
ActiveCell.FormulaR1C1 = "Burden $"
'Range("O4").Select
'ActiveCell.FormulaR1C1 = "Machine #"
'Range("A5").Select

'This part inserts labor $ calculations
currentrow = 5
cell = ("T" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]*Rc[-11]"
  currentrow = currentrow + 1
  cell = ("T" & currentrow)
Loop
'Range("R4").Select
'ActiveCell.FormulaR1C1 = "Pcs / Hr"
'Range("O4").Select
'ActiveCell.FormulaR1C1 = "Machine #"
'Range("A5").Select

'This part inserts the calculations to sum hours, quantities and dollars
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("R" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("S" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("T" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1

Loop


End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
If Range("A5").Value = "" Then
  Range("A5").Select
  Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
Else
  rowcount = 5
  cell = ("G" & rowcount)
  Range(cell).Select
  Do Until ActiveCell.Text = ""
    Range(cell).Select
    rowcount = rowcount + 1
    cell = ("G" & rowcount)
  Loop
  cell = "5:" & rowcount
  Rows(cell).Select
  Selection.Delete
  Range("A5").Select
  Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
End If

'Range("A4").Select
'Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("N5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("M" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  currentrow = currentrow + 1
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  cell = ("P" & currentrow)
Loop

Range("A4").Select

End Sub
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
Range("H1").Formula = "=counta(E5:E15000)"
rowcount = Range("H1").Value + 5
cell = "5:" & rowcount
Rows(cell).Select
Selection.Clear


    Range("Table_Query_from_EpicorProd[EmployeeNum]").Select
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("F5"), Order1:=xlAscending, Key2:=Range("M5") _
    , Order2:=xlAscending, Key3:=Range("C5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence number.
currentrow = 5
'Range("D5").Select
'JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
'  cell = ("D" & currentrow)
'  Range(cell).Select
'  If ActiveCell.Text = JobNum Then
'    joblogic = "T"
'  Else
'    joblogic = "F"
'  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("F" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("H" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("D" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals for Operation Seq"
    currentrow = currentrow + 1
'    cell = ("D" & currentrow)
'   Range(cell).Select
'    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
'  cell = ("D" & currentrow)
'  Range(cell).Select
Loop
'    cell = ("H" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("I" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "Totals"
    
    

'This part determines the total number of rows
Range("H1").Formula = "=counta(D5:D5000)"
rowcount = Range("H1") + 4

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow >= rowcount
  If currentrow < rowcount Then
    Do Until ActiveCell.Text = "" Or currentrow = rowcount + 1
      cell = ("K" & currentrow)
      Range(cell).Select
      currentrow = currentrow + 1
      sumcount = sumcount + 1
    Loop
  End If
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop

Range("A5").Select


End Sub
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 140, 1, MSForms, CommandButton"
Private Sub CommandButton2_Click()
Dim currentrow As Integer
Dim EmpNo As String
Dim cell As String
Dim EmpLogic As String
Dim rowcount As Integer


Application.Run "'Activity by date Epicor.xlsm'!DeleteBlankRows"
    
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom

'This part will insert rows at a change in Employee Number
currentrow = 5
Range("A5").Select
EmpNo = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("A" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = EmpNo Then
    EmpLogic = "T"
  Else
    EmpLogic = "F"
  End If
  If EmpLogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("A" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("B" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("C" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("A" & currentrow)
    Range(cell).Select
    EmpNo = ActiveCell.Text
  End If
  cell = ("A" & currentrow)
  Range(cell).Select
Loop
    cell = ("A" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"

'This part inserts the calculations to sum hours and quantities
rowcount = Range("H1").Value + 4
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow >= rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount + 4
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("I" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop
'This part inserts efficiency calculations
currentrow = 5
cell = ("R" & currentrow)
Do Until currentrow >= rowcount + 1
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-7]/Rc[-8]"
  currentrow = currentrow + 1
  cell = ("R" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("A5").Select
'This part inserts man to machine calculations
currentrow = 5
cell = ("S" & currentrow)
Do Until currentrow >= rowcount + 1
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-9]/Rc[-10]"
  currentrow = currentrow + 1
  cell = ("S" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("S4").Select
ActiveCell.FormulaR1C1 = "M/M Ratio"
Range("A5").Select


End Sub
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String

'This part determines the total number of rows and deletes the old info.
Range("A1").Formula = "=counta(G5:G5000)"
rowcount = Range("A1").Value + 4
cell = ("5:" & rowcount)
Rows(cell).Select
Selection.Clear

'Refresh the query
Range("A4").Select
    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False

   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
JobNum = Range("D5").Value
seqnum = Range("E5").Value
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  If ActiveCell.Value = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Value = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Value
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Value
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
Range("A1").Formula = "=counta(G5:G5000)"
rowcount = Range("A1").Value + 4
cell = ("G" & rowcount)

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("I" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-5]/Rc[-6]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
Range("P4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
'Range("O4").Select
'ActiveCell.FormulaR1C1 = "Machine #"
'Range("A5").Select

'This part inserts pieces per hour calculations
currentrow = 5
cell = ("Q" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-5]/Rc[-7]"
  currentrow = currentrow + 1
  cell = ("Q" & currentrow)
Loop
Range("Q4").Select
ActiveCell.FormulaR1C1 = "Pcs / Hr"
'Range("O4").Select
'ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select



End Sub
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O5").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("P5").Select
ActiveCell.FormulaR1C1 = "PPH"


'This part determines the total number of rows and deletes the old info.
Range("N1").Formula = "=counta(J6:J5000)"
rowcount = Range("N1").Value + 6
cell = "6:" & rowcount + 6
Rows(cell).Select
Selection.Clear

Range("A5").Select
Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False

'This part inserts efficiency calculations
currentrow = 6
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).FormulaR1C1 = "=RC[-1]/RC[-4]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

'This part inserts Parts Per Hour calculations
currentrow = 6
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).FormulaR1C1 = "=RC[-4]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
    Columns("O:O").Select
    Selection.Style = "Percent"
    Columns("M:M").Select
    Selection.NumberFormat = "m/d/yy;@" '

'Range("A5").Select
Application.Run "'Activity by date Epicor.xlsm'!RemoveLoop"
Application.Run "'Activity by date Epicor.xlsm'!Subtotal"



End Sub
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O5").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("P5").Select
ActiveCell.FormulaR1C1 = "PPH"


'This part determines the total number of rows and deletes the old info.
Range("N1").Formula = "=counta(J6:J5000)"
rowcount = Range("N1").Value + 6
cell = "6:" & rowcount + 6
Rows(cell).Select
Selection.Clear

Range("A5").Select
Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False

'This part inserts efficiency calculations
currentrow = 6
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).FormulaR1C1 = "=RC[-1]/RC[-4]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

'This part inserts Parts Per Hour calculations
currentrow = 6
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).FormulaR1C1 = "=RC[-4]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop
    Columns("O:O").Select
    Selection.Style = "Percent"
    Columns("M:M").Select
    Selection.NumberFormat = "m/d/yy;@" '

'Range("A5").Select
Application.Run "'Activity by date Epicor.xlsm'!RemoveLoop"
Application.Run "'Activity by date Epicor.xlsm'!Subtotal"



End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'    Range("A4").Select
'    Selection.QueryTable.Refresh BackgroundQuery:=False
'    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True


Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-1]/RC[-4]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select


End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'    Range("A4").Select
'    Selection.QueryTable.Refresh BackgroundQuery:=False
'    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True


Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("G5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("P" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-2]/RC[-5]"
  currentrow = currentrow + 1
  cell = ("P" & currentrow)
Loop

Range("A5").Select


End Sub
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select
End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("B" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("B" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
'Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
'    , Order2:=xlAscending, Key3:=Range("A5"), Order3:=xlAscending, Header:= _
'    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("P" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-12])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("P:P").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("B5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("C5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("B" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("C" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("B" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("C" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("D" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("B" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("C" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("B" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("B" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("B" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-4]/Rc[-5]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A5").Select
End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
'    Range("A4").Select
'    Selection.QueryTable.Refresh BackgroundQuery:=False
'    Selection.Subtotal GroupBy:=7, Function:=xlSum, TotalList:=Array(12), _
        Replace:=True, PageBreaks:=False, SummaryBelowData:=True


Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents
Range("O4").Select
ActiveCell.FormulaR1C1 = "Efficiency"

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("E5"), Order1:=xlAscending, Key2:=Range("F5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("G5").Select
JobNum = ActiveCell.Text
Range("F5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("G" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("F" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("I" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("G" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("F" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("G" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("H" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("H" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("K" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("K" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("N" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("O" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-1]/RC[-4]"
  currentrow = currentrow + 1
  cell = ("O" & currentrow)
Loop

Range("A4").Select


End Sub
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 2, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim rowcount As Integer
Dim sumcount As Integer
Dim currentrow As Integer
Dim cell As String
Columns("O:O").Select
Selection.ClearContents

'This part determines the total number of rows and deletes the old info.
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop
cell = "5:" & rowcount
Rows(cell).Select
Selection.Delete

Range("A4").Select
Selection.QueryTable.Refresh BackgroundQuery:=False
Selection.Sort Key1:=Range("D5"), Order1:=xlAscending, Key2:=Range("E5") _
    , Order2:=xlAscending, Key3:=Range("M5"), Order3:=xlAscending, Header:= _
    xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
'Selection.Subtotal GroupBy:=4, Function:=xlSum, TotalList:=Array(10, 11, 12 _
'    ), Replace:=True, PageBreaks:=False, SummaryBelowData:=True
    
    
'This part will convert all job numbers to upper case
'Columns("D:D").Select
'Selection.Copy
'Columns("P:P").Select
'ActiveSheet.Paste
'Application.CutCopyMode = False
currentrow = 5
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
  Range(cell).Select
  currentrow = currentrow + 1
Loop
rowcount = currentrow
currentrow = 5
Do Until currentrow = rowcount
  cell = ("S" & currentrow)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=upper(RC[-15])"
  Selection.Copy
  cell = ("D" & currentrow)
  Range(cell).Select
  Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
  currentrow = currentrow + 1
Loop
Columns("S:S").Select
Selection.ClearContents
    
   
'This part will insert rows at a change in sequence within a job number
'or at a change in job number.
currentrow = 5
Range("D5").Select
'upper ("D5")
JobNum = ActiveCell.Text
Range("E5").Select
seqnum = ActiveCell.Text
Do Until ActiveCell.Text = ""
  cell = ("D" & currentrow)
'  upper (cell)
  Range(cell).Select
  If ActiveCell.Text = JobNum Then
    joblogic = "T"
  Else
    joblogic = "F"
  End If
  cell = ("E" & currentrow)
  Range(cell).Select
  If ActiveCell.Text = seqnum Then
    seqlogic = "T"
  Else
    seqlogic = "F"
  End If
  If joblogic = "T" And seqlogic = "T" Then
    currentrow = currentrow + 1
  Else
    SplitRow = currentrow & ":" & currentrow
    Rows(SplitRow).Select
    Selection.Insert Shift:=x1Down
    cell = ("G" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "=R[-1]C"
    cell = ("H" & currentrow)
    Range(cell).Select
    ActiveCell.FormulaR1C1 = "Totals"
    currentrow = currentrow + 1
    cell = ("D" & currentrow)
    Range(cell).Select
    JobNum = ActiveCell.Text
    cell = ("E" & currentrow)
    Range(cell).Select
    seqnum = ActiveCell.Text
  End If
  cell = ("D" & currentrow)
  Range(cell).Select
Loop
    
    


'This part determines the total number of rows
rowcount = 5
cell = ("G" & rowcount)
Range(cell).Select
Do Until ActiveCell.Text = ""
  Range(cell).Select
  rowcount = rowcount + 1
  cell = ("G" & rowcount)
Loop

'This part inserts the calculations to sum hours and quantities
currentrow = 5
sumcount = 1
cell = ("J" & currentrow)
Range(cell).Select
Do Until currentrow = rowcount
  Do Until ActiveCell.Text = "" Or currentrow = rowcount
    cell = ("J" & currentrow)
    Range(cell).Select
    currentrow = currentrow + 1
    sumcount = sumcount + 1
  Loop
  cell = ("J" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("K" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  cell = ("L" & currentrow - 1)
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=sum(R[-" & sumcount & "]c:R[-1]C)"
  sumcount = -1
Loop



''This part inserts sequence numbers, wc codes and part numbers
''on the totals lines.
'currentrow = 4
'cell = ("E" & currentrow)
'Do Until currentrow = rowcount
'  Range(cell).Select
'  If ActiveCell.Text = "" Then
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("G" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'    cell = ("N" & currentrow)
'    Range(cell).Select
'    ActiveCell.FormulaR1C1 = "=R[-1]C"
'  End If
'  currentrow = currentrow + 1
'  cell = ("E" & currentrow)
'Loop

'This part inserts efficiency calculations
currentrow = 5
cell = ("Q" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-6]/Rc[-7]"
  currentrow = currentrow + 1
  cell = ("Q" & currentrow)
Loop
Range("Q4").Select
ActiveCell.FormulaR1C1 = "Efficiency"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select

'This part inserts pieces per hour calculations
currentrow = 5
cell = ("R" & currentrow)
Do Until currentrow = rowcount
  Range(cell).Select
  ActiveCell.FormulaR1C1 = "=RC[-6]/Rc[-8]"
  currentrow = currentrow + 1
  cell = ("R" & currentrow)
Loop
Range("R4").Select
ActiveCell.FormulaR1C1 = "Pcs / Hr"
Range("O4").Select
ActiveCell.FormulaR1C1 = "Machine #"
Range("A5").Select


End Sub

Private Sub CommandButton2_Click()
    Selection.RemoveSubtotal
    Selection.Sort Key1:=Range("A5"), Order1:=xlAscending, Key2:=Range("M5") _
        , Order2:=xlAscending, Key3:=Range("D5"), Order3:=xlAscending, Header:= _
        xlGuess, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom
    Selection.Subtotal GroupBy:=1, Function:=xlSum, TotalList:=Array(9, 10, 11, _
        12), Replace:=True, PageBreaks:=False, SummaryBelowData:=True

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
