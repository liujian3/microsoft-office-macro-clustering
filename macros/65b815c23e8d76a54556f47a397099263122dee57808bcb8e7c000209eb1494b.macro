Attribute VB_Name = "M|fffd|d11Prop"
Public PropDisc As Range
Public NumDisc As String
Public HouveDisc As Boolean
Public FoneEmprPa|fffd|s, FoneEmprCid As String

Public Sub PropDiscVBA()
    NomeArqHist = "PropDisc.hst"
    Set PropDisc = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("PropDisc")
    Application.ScreenUpdating = False
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value)    'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, True) Then
        ActiveWindow.Close False
    End If
    Application.ScreenUpdating = True
    'Ajuda
    i = InStr(1, PropDisc(2).Value, "!")
    'Com o proj. proteg. essa instru|fffd||fffd|o falha. A solu|fffd||fffd|o foi colocar ..\cpap.hlp nas propriedades e fazer o diret|fffd|rio do cpap ativo.
    'Application.VBE.VBProjects("VBAProjectCxIdent").HelpFile = Left(PropDisc(2).value, I - 1)
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDrive ThisWorkbook.Path
    If Mid(ThisWorkbook.Path, 2, 1) = ":" Then ChDir ThisWorkbook.Path Else Application.Run "CPAP_EX8.MAC!DirectoryVBA", ThisWorkbook.Path, False
    UserForm1Prop.HelpContextID = Right(PropDisc(2).Value, Len(PropDisc(2).Value) - i)

    vEnableEvents = False
    UserForm1Prop.Cliente_Cb.Value = PropDisc(3).Value
    UserForm1Prop.FoneResPa|fffd|s_Cb.Value = PropDisc(4).Value
    UserForm1Prop.FoneResCid_Cb.Value = PropDisc(5).Value
    UserForm1Prop.FoneResLoc_Cb.Value = PropDisc(6).Value
    UserForm1Prop.FoneResRam_Cb.Value = PropDisc(7).Value
    UserForm1Prop.FoneTrabPa|fffd|s_Cb.Value = PropDisc(8).Value
    UserForm1Prop.FoneTrabCid_Cb.Value = PropDisc(9).Value
    UserForm1Prop.FoneTrabLoc_Cb.Value = PropDisc(10).Value
    UserForm1Prop.FoneTrabRam_Cb.Value = PropDisc(11).Value
    UserForm1Prop.FoneAltPa|fffd|s_Cb.Value = PropDisc(12).Value
    UserForm1Prop.FoneAltCid_Cb.Value = PropDisc(13).Value
    UserForm1Prop.FoneAltLoc_Cb.Value = PropDisc(14).Value
    UserForm1Prop.FoneAltRam_Cb.Value = PropDisc(15).Value
    UserForm1Prop.FoneCelPa|fffd|s_Cb.Value = PropDisc(16).Value
    UserForm1Prop.FoneCelCid_Cb.Value = PropDisc(17).Value
    UserForm1Prop.FoneCelLoc_Cb.Value = PropDisc(18).Value
    UserForm1Prop.FoneCelRam_Cb.Value = PropDisc(19).Value
    FoneEmprPa|fffd|s = PropDisc(20).Value & ""
    FoneEmprCid = PropDisc(21).Value & ""
    UserForm1Prop.Pulso_Chb.Value = Mid(PropDisc(22).Value, 1, 1) = "P"
    UserForm1Prop.Operadora_Chb.Value = Mid(PropDisc(22).Value, 2, 1) = "1"
    UserForm1Prop.Operadora_Cb.Value = Mid(PropDisc(22).Value, 3, 2)
    UserForm1Prop.DiretoModem_Chb.Value = Mid(PropDisc(22).Value, 5, 1) = "1"
    UserForm1Prop.PortaSerial_Cb.Value = "Com" & Mid(PropDisc(22).Value, 6, 2) * 1
    UserForm1Prop.Prefixo_Chb.Value = Mid(PropDisc(22).Value, 8, 1) = "1"
    UserForm1Prop.Prefixo_Cb.Value = Mid(PropDisc(22).Value, 9, 100)

    UserForm1Prop.Observ_Cb.Value = ""
    UserForm1Prop.Observ_Tb.Value = Format(Now, "dd/mm/yy hh:mm") & Chr(160) & "-" & Chr(160)
    UserForm1Prop.Data_Cb.Value = Format(Now, "dd/mm/yy")
    UserForm1Prop.Respons|fffd|vel_Cb.Value = Workbooks("Cpap_pri.mac").Sheets(1).Range("NomeUsua").Value


    OcultarExibControles

    vEnableEvents = True
    Application.ScreenUpdating = True
    UserForm1Prop.Observ_Tb.SetFocus
    Application.StatusBar = False
    HouveDisc = False
    UserForm1Prop.Show
    PropDisc(1) = IIf(HouveDisc And BotAcionado <> False, 2, BotAcionado)
    If FecharArq Then PropDisc(2) = "Fechar"
    If HouveDisc Then
        Application.ScreenUpdating = False
        'Atualizar hist|fffd|rico
        Application.ScreenUpdating = False
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            SalvarHist = False
            'Atualiza|fffd||fffd|o do hist|fffd|rico aqui |fffd| incondicional, total e sincronizado
            '         AtuHist "FoneResPa|fffd|s", UserForm1Prop.FoneResPa|fffd|s_Cb.Value, Format(PropDisc(12, 2), "#,##0.00")
            vCampo = "Cliente"
            ValorCb = UserForm1Prop.Cliente_Cb.Value
            Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
            If campo.Rows.Count > 10000 Then Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist")
            campo.Rows(2).EntireRow.Insert Shift:=xlDown
            campo.Rows(2).Value = "'" & ValorCb   'O ap|fffd|strofo arquivo tudo como texto, previnindo erro em caso de f|fffd|rmula e altera no formato de n|fffd|meros pela planilha
            NumM|fffd|x = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").Offset(-1, 0).Value
            If campo.Rows.Count > NumM|fffd|x Then campo(NumM|fffd|x + 2).EntireRow.ClearContents

            With ThisWorkbook.Sheets(NomeArqHist)
                '            .Range("Cliente" & "Hist").Rows(2).Value = "'" & UserForm1Prop.Cliente_Cb.Value
                .Range("FoneResPa|fffd|s" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneResPa|fffd|s_Cb.Value
                .Range("FoneResCid" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneResCid_Cb.Value
                .Range("FoneResLoc" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneResLoc_Cb.Value
                .Range("FoneResRam" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneResRam_Cb.Value
                .Range("FoneTrabPa|fffd|s" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneTrabPa|fffd|s_Cb.Value
                .Range("FoneTrabCid" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneTrabCid_Cb.Value
                .Range("FoneTrabLoc" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneTrabLoc_Cb.Value
                .Range("FoneTrabRam" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneTrabRam_Cb.Value
                .Range("FoneAltPa|fffd|s" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneAltPa|fffd|s_Cb.Value
                .Range("FoneAltCid" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneAltCid_Cb.Value
                .Range("FoneAltLoc" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneAltLoc_Cb.Value
                .Range("FoneAltRam" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneAltRam_Cb.Value
                .Range("FoneCelPa|fffd|s" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneCelPa|fffd|s_Cb.Value
                .Range("FoneCelCid" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneCelCid_Cb.Value
                .Range("FoneCelLoc" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneCelLoc_Cb.Value
                .Range("FoneCelRam" & "Hist").Rows(2).Value = "'" & UserForm1Prop.FoneCelRam_Cb.Value
                .Range("Observ" & "Hist").Rows(2).Value = "'" & UserForm1Prop.Observ_Cb.Value
                .Range("Data" & "Hist").Rows(2).Value = "'" & UserForm1Prop.Data_Cb.Value
                .Range("Respons|fffd|vel" & "Hist").Rows(2).Value = "'" & UserForm1Prop.Respons|fffd|vel_Cb.Value
            End With

            SalvarHist = True
            If SalvarHist Then SalvandoHist Else Workbooks(NomeArqHist).Close False
        End If
        'Transferindo dados
        PropDisc(22).Value = IIf(UserForm1Prop.Pulso_Chb.Value, "P", "T") & _
                UserForm1Prop.Operadora_Chb.Value * -1 & _
                Format(Left(UserForm1Prop.Operadora_Cb.Value, 2), "00") & _
                UserForm1Prop.DiretoModem_Chb.Value * -1 & _
                Format(Mid(UserForm1Prop.PortaSerial_Cb.Value, 4, 2), "00") & _
                UserForm1Prop.Prefixo_Chb.Value * -1 & _
                UserForm1Prop.Prefixo_Cb.Value

        Application.ScreenUpdating = False
    End If
    Unload UserForm1Prop
    ThisWorkbook.Saved = True
End Sub


Sub OcultarExibControles()
    With UserForm1Prop
        If .Operadora_Chb.Value Then
            .FoneResPa|fffd|s_Cb.BackColor = IIf(.FoneResPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H8000000F, &H80000005)
            .FoneResPa|fffd|s_Cb.ForeColor = IIf(.FoneResPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H80000016, &H80000008)
            .FoneResCid_Cb.BackColor = IIf(.FoneResCid_Cb.Value = FoneEmprCid, &H8000000F, &H80000005)
            .FoneResCid_Cb.ForeColor = IIf(.FoneResCid_Cb.Value = FoneEmprCid, &H80000016, &H80000008)

            .FoneTrabPa|fffd|s_Cb.BackColor = IIf(.FoneTrabPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H8000000F, &H80000005)
            .FoneTrabPa|fffd|s_Cb.ForeColor = IIf(.FoneTrabPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H80000016, &H80000008)
            .FoneTrabCid_Cb.BackColor = IIf(.FoneTrabCid_Cb.Value = FoneEmprCid, &H8000000F, &H80000005)
            .FoneTrabCid_Cb.ForeColor = IIf(.FoneTrabCid_Cb.Value = FoneEmprCid, &H80000016, &H80000008)

            .FoneAltPa|fffd|s_Cb.BackColor = IIf(.FoneAltPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H8000000F, &H80000005)
            .FoneAltPa|fffd|s_Cb.ForeColor = IIf(.FoneAltPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H80000016, &H80000008)
            .FoneAltCid_Cb.BackColor = IIf(.FoneAltCid_Cb.Value = FoneEmprCid, &H8000000F, &H80000005)
            .FoneAltCid_Cb.ForeColor = IIf(.FoneAltCid_Cb.Value = FoneEmprCid, &H80000016, &H80000008)

            .FoneCelPa|fffd|s_Cb.BackColor = IIf(.FoneCelPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H8000000F, &H80000005)
            .FoneCelPa|fffd|s_Cb.ForeColor = IIf(.FoneCelPa|fffd|s_Cb.Value = FoneEmprPa|fffd|s, &H80000016, &H80000008)
            .FoneCelCid_Cb.BackColor = IIf(.FoneCelCid_Cb.Value = FoneEmprCid, &H8000000F, &H80000005)
            .FoneCelCid_Cb.ForeColor = IIf(.FoneCelCid_Cb.Value = FoneEmprCid, &H80000016, &H80000008)

            .Operadora_Cb.Visible = True
            .Operadora_Chb.Caption = "Interurbano, operadora"
        Else
            .FoneResPa|fffd|s_Cb.BackColor = &H8000000F
            .FoneResPa|fffd|s_Cb.ForeColor = &H80000016
            .FoneResCid_Cb.BackColor = &H8000000F
            .FoneResCid_Cb.ForeColor = &H80000016

            .FoneTrabPa|fffd|s_Cb.BackColor = &H8000000F
            .FoneTrabPa|fffd|s_Cb.ForeColor = &H80000016
            .FoneTrabCid_Cb.BackColor = &H8000000F
            .FoneTrabCid_Cb.ForeColor = &H80000016

            .FoneAltPa|fffd|s_Cb.BackColor = &H8000000F
            .FoneAltPa|fffd|s_Cb.ForeColor = &H80000016
            .FoneAltCid_Cb.BackColor = &H8000000F
            .FoneAltCid_Cb.ForeColor = &H80000016

            .FoneCelPa|fffd|s_Cb.BackColor = &H8000000F
            .FoneCelPa|fffd|s_Cb.ForeColor = &H80000016
            .FoneCelCid_Cb.BackColor = &H8000000F
            .FoneCelCid_Cb.ForeColor = &H80000016

            .Operadora_Cb.Visible = False
            .Operadora_Chb.Caption = "Interurbano"
        End If

        If .DiretoModem_Chb.Value Then
            .PortaSerial_Cb.Visible = True
            .Pulso_Chb.Visible = True
        Else
            .PortaSerial_Cb.Visible = False
            .Pulso_Chb.Visible = False
        End If
        .Prefixo_Cb.Visible = .Prefixo_Chb.Value
    End With
End Sub

Attribute VB_Name = "M|fffd|d2Comum"
Public Const MarcHist = "|fffd|Hist|fffd|rico|fffd|"
Public NomeArqHist As String
Public vEnableEvents As Boolean
Public BotAcionado As Variant
Public SalvarHist As Boolean
Public FormatoHist As String
Public HistEditCampo As String
Public vCloseMode As Integer
Public FecharArq As Boolean
Public NmesIndMax As Long: Public bHtmlHelp As Boolean

Sub AtuHist(vCampo As String, ValorCb As String, ValorOrig As String)
    If ValorCb = "" Or ValorCb = ValorOrig Then Exit Sub
    'Verificando exist|fffd|ncia - Sug. Fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo)
    j = 0
    For Each C In campo
        j = j + 1
        If j > 1 And IIf(IsError(C.Value), "", C.Value) = ValorCb Then Exit Sub
    Next

    'Verificando exist|fffd|ncia - Sug. Hist|fffd|ricas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
    If campo.Rows.Count > 10000 Then Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist")
    j = 0
    For Each C In campo
        j = j + 1
        If j > 1 And IIf(IsError(C.Value), "", C.Value) = ValorCb Then Exit Sub
    Next
    'Adicionando |fffd| lista de hist|fffd|rico
    campo.Rows(2).Insert Shift:=xlDown
    campo.Rows(2).Value = "'" & ValorCb   'O ap|fffd|strofo arquivo tudo como texto, previnindo erro em caso de f|fffd|rmula e altera no formato de n|fffd|meros pela planilha
    NumM|fffd|x = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").Offset(-1, 0).Value
    If campo.Rows.Count > NumM|fffd|x Then campo(NumM|fffd|x + 2).ClearContents
    SalvarHist = True
End Sub

Function MyOpenFile(vFileName As String, vReadOnly As Boolean)
    On Error Resume Next
Retry:
    Application.DisplayAlerts = False
    '                                                         bEnableEvents = Application.EnableEvents
    Application.Run "cpap_ex8.mac!EnableEventsVBA", False    'Application.EnableEvents = False
    Set i = Workbooks.Open(Filename:=vFileName, ReadOnly:=vReadOnly, Notify:=False)
    Application.Run "cpap_ex8.mac!EnableEventsVBA", True    'Application.EnableEvents = bEnableEvents

    'Testar integridade. Ver se abre como texto, se n|fffd|o existe o nome DadosHist, se A1&His<>Ahist
    t1 = i.FileFormat = xlCurrentPlatformText
    t2 = i.Sheets(1).Range("DadosHist").Value
    t2 = t2 = Empty
    If t2 = False Then t3 = i.Sheets(1).Range("DadosHist").Offset(1).Value <> i.Sheets(1).Range("A1").Value & "Hist" Else t3 = False
    If t1 Or t2 Or t3 Then i.Close False

    Application.DisplayAlerts = True
    If i.Name = "" Then
        Select Case MsgBox("O arquivo " & vFileName & " contendo o hist|fffd|rico das caixas de inclus|fffd|o n|fffd|o foi encontrado ou est|fffd| corrompido." & Chr(10) & Chr(10) & "Se acionar Ignorar, o arquivo ser|fffd| ignorado e um novo ser|fffd| gerado para iniciar outro hist|fffd|rico.", vbQuestion + vbAbortRetryIgnore + vbDefaultButton2, "CPAP|fffd| - Tentando Abrir Arquivo de Hist|fffd|rico")
        Case Is = vbRetry
            GoTo Retry
        Case Is = vbAbort
            MyOpenFile = False
            Exit Function
        Case Is = vbIgnore
            Application.Workbooks.Add xlWBATWorksheet
            ActiveWorkbook.Names.Add Name:="DadosHist", RefersToR1C1:=Cells(100, 1)
            If Dir(vFileName) <> "" Then Kill vFileName
            ActiveWorkbook.SaveAs vFileName, IIf(Val(Application.Version) >= 12, 56, xlWorkbookNormal)    'xlExcel8 56
            SalvandoHist
            GoTo Retry
        End Select
    End If
    On Error GoTo 0
    If vReadOnly = False And i.ReadOnly Then
        i.Close False
        j = j + 1
        If j < 4 Then
            Application.Wait Now + TimeValue("00:00:01")
            GoTo Retry
        Else
            If MsgBox("O arquivo " & vFileName & " contendo o hist|fffd|rico das caixas de inclus|fffd|o pode estar em uso por outra esta|fffd||fffd|o. Acione OK para continuar tentando ou Cancelar para desistir?", vbQuestion + vbOKCancel, "CPAP|fffd|") = vbOK Then
                GoTo Retry
            Else
                MyOpenFile = False
                Exit Function
            End If
        End If
    End If
    ActiveWorkbook.ActiveSheet.Unprotect "MP542"
    ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").CurrentRegion.ClearContents
    Set CopyRng = Range("A1").CurrentRegion
    Set PasteRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").CurrentRegion.ClearContents
    Set CopyRng = Range("DadosHist").CurrentRegion
    Set PasteRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2
    MyOpenFile = True
End Function

Sub SalvandoHist()
    Workbooks(NomeArqHist).Sheets(1).Range("A1").CurrentRegion.ClearContents
    Set CopyRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").CurrentRegion
    Set PasteRng = Workbooks(NomeArqHist).Sheets(1).Range("A1")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    Workbooks(NomeArqHist).Sheets(1).Range("DadosHist").CurrentRegion.ClearContents
    i = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").Row
    Workbooks(NomeArqHist).Names.Add Name:="DadosHist", RefersToR1C1:=Workbooks(NomeArqHist).Sheets(1).Cells(i, 1)
    Set CopyRng = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").CurrentRegion
    Set PasteRng = Workbooks(NomeArqHist).Sheets(1).Range("DadosHist")
    PasteRng.Resize(CopyRng.Rows.Count, CopyRng.Columns.Count).Value2 = CopyRng.Value2

    Workbooks(NomeArqHist).Activate
    ActiveWorkbook.ActiveSheet.Protect "MP542"
    If Run("cpap_ex8.mac!SaveVBA") Then ActiveWorkbook.Close False
End Sub

Sub ConfHist(vComboBox As Object, vOriginal As String, Optional SemEditSring As Boolean = False, Optional Formato As String)
    i = InStr(1, vComboBox.Name, "_")
    HistEditCampo = Left(vComboBox.Name, i - 1)
    i = MsgBox("OK  -  Configurar sugest|fffd|es fixas e hist|fffd|ricas;" & Chr(10) & Chr(10) & "Cancelar - Restaurar inicial.", vbQuestion + vbOKCancel, "Hist|fffd|rico de Inclus|fffd|es no Campo " & HistEditCampo) = vbOK
    If i Then
        FormatoHist = Formato
        UserFormEditHist.Nova_Bt.Enabled = Not SemEditSring
        UserFormEditHist.SugFixas_Ct.Enabled = Not SemEditSring
        UserFormEditHist.SugHist_Ct.Enabled = Not SemEditSring
        UserFormEditHist.Show
        Unload UserFormEditHist
    End If
    vComboBox.Value = vOriginal
    If i Then ListandoComboBox vComboBox, Formato
    SendKeys "{RIGHT}"
End Sub

Sub ListandoComboBox(vComboBox As Object, Optional Formato As String)
    i = InStr(1, vComboBox.Name, "_")
    vCampo = Left(vComboBox.Name, i - 1)
    'Limpando comboboxes
    While vComboBox.ListCount >= 1
        vComboBox.RemoveItem (0)
    Wend
    'Listando comboboxes - Lista de sug. fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo, ThisWorkbook.Sheets(NomeArqHist).Range(vCampo).End(xlDown))
    If campo.Rows.Count < 100 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), Formato)
            j = j + 1
            If j > 1 Then
                vRep = False
                For i = 1 To vComboBox.ListCount
                    If vComboBox.List(i - 1) = cf Then vRep = True
                Next
                If vRep = False And cf <> "" Then vComboBox.AddItem (cf)
            End If
        Next
    End If
    'Listando comboboxes - Lista de sug. hist|fffd|ricas
    vComboBox.AddItem (MarcHist)
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
    If campo.Rows.Count > 10000 Then Exit Sub
    j = 0
    For Each C In campo
        cf = Format(IIf(IsError(C.Value), "", C.Value), Formato)
        j = j + 1
        If j > 1 Then
            vRep = False
            For i = 1 To vComboBox.ListCount
                If vComboBox.List(i - 1) = cf Then vRep = True
            Next
            If vRep = False And cf <> "" Then vComboBox.AddItem (cf)
        End If
        Application.StatusBar = "Sugest|fffd|es Hist|fffd|ricas em " & vCampo & " " & j & "/" & campo.Rows.Count
    Next
    Application.StatusBar = False
End Sub


'EVENTOS DE CAIXA DE TEXTO PARA VALOR FINANCEIRO

Sub EvValor_Cb_MouseMove(Valor_Cb As Control, ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Valor_Cb.Locked = False
    sd = Application.International(xlDecimalSeparator)
    If Valor_Cb.Text = "0" Or Valor_Cb.Text = "0" & sd & "00" Then
        Valor_Cb.SelStart = 0
        Valor_Cb.SelLength = Len(Valor_Cb.Text)
    End If
End Sub

Sub EvValor_Cb_KeyDown(Valor_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    sd = Application.International(xlDecimalSeparator)
    vKeyCode = IIf(sd = ",", 188, 190)
    Valor_Cb.Locked = False
    If KeyCode = 37 Or (Shift = 2 And KeyCode = 86) Or (Shift = 1 And KeyCode = 45) Or (Shift = 2 And KeyCode = 88) Then Exit Sub   'Seta Esquerda e teclas do clipboard
    If KeyCode = 110 Or KeyCode = 190 Then KeyCode = vKeyCode
    If KeyCode = 188 Then If InStr(1, Valor_Cb.Value, sd) > 0 Then Valor_Cb.Locked = True
    If (KeyCode >= 96 And KeyCode <= 105) _
            Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) _
            Or KeyCode = 188 Or KeyCode = 8 Or KeyCode = 46 _
            Or KeyCode = 107 Or (KeyCode = 187 And Shift = 1) _
            Or KeyCode = 109 Or (KeyCode = 189 And Shift = 0) Then Else Valor_Cb.Locked = True
End Sub

Sub EvValor_Cb_Change(Valor_Cb As Control, Optional vAbs As Boolean = False)
    i = Valor_Cb.Value
    j = Valor_Cb.SelStart
    SinNeg = vAbs = False And InStr(1, i, "-") > 0 And InStr(1, i, "+") = 0
    i = Application.WorksheetFunction.Substitute(i, "-", "")
    i = Application.WorksheetFunction.Substitute(i, "+", "")
    PartInt = i
    sd = Application.International(xlDecimalSeparator)
    sm = Application.International(xlThousandsSeparator)
    k = InStr(1, i, sd)
    If k > 0 Then
        PartFrac = Mid(i, k + 1, 100)
        PartFrac = Application.WorksheetFunction.Substitute(PartFrac, sm, "")
        PartInt = Mid(i, 1, k - 1)
        If PartInt = "" Then PartInt = "0"
    End If
    TamPartInt = Len(PartInt)
    PartInt = Application.WorksheetFunction.Substitute(PartInt, sm, "")
    PartInt = Format(PartInt, "#,##0")
    RepCurs = Len(PartInt) - TamPartInt
    vEnableEvents = False
    Valor_Cb.Value = IIf(SinNeg, "-", "") & PartInt & IIf(PartInt = "" Or k = 0, "", sd) & PartFrac
    vEnableEvents = True
    j = -(j + RepCurs) * (j + RepCurs >= 0)
    If Left(Valor_Cb.Value, 2) = "0" & sd And j < 3 Then j = 2
    Valor_Cb.SelStart = j

    'Evita colar texto
    Static ValorOld
    If Valor_Cb.Value <> "" And Valor_Cb.Value <> "-" And Not (IsNumeric(Valor_Cb.Value)) Then
        MsgBox Valor_Cb.Value, vbCritical, "Valor Inv|fffd|lido!"
        Valor_Cb.Value = ValorOld
    Else
        ValorOld = Valor_Cb.Value
    End If
End Sub

Sub EvValor_Cb_Exit(Valor_Cb As Control, Cancel As MSForms.ReturnBoolean, Formato As String)
    If Valor_Cb.Value = "" Then Valor_Cb.Value = 0
    If IsNumeric(Valor_Cb.Value) Then
        If Valor_Cb.Value <> Format(Valor_Cb.Value, Formato) Then Valor_Cb.Value = Format(Valor_Cb.Value, Formato)
    Else
        MsgBox "Data inv|fffd|lida!", vbCritical, "CPAP|fffd|"
        Cancel = True
    End If
End Sub


Sub CalculadoraBtClick(vForm As Object, Valor_Cb As Control, Calculadora_Bt As Control, NumDecim As Integer)
    Calculadora_Bt.SpecialEffect = fmSpecialEffectSunken
    If IsNumeric(Valor_Cb.Value) Then CalculadoraValorIni = IIf(Valor_Cb.Value * 1 = 0, 0, Valor_Cb.Value) Else CalculadoraValorIni = 0
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalcVal").Value = CalculadoraValorIni
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalcDec").Value = NumDecim

    Application.ExecuteExcel4Macro ("cpap_pri.mac!CalcVBA()")

    Valor_Cb.Value = Workbooks("cpap_pri.mac").Sheets(1).Range("CalcVal").Value
    Valor_Cb.SetFocus
    Calculadora_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub



'EVENTOS DE CAIXA DE TEXTO DO CALEND|fffd|RIO

Sub EvCalend_Cb_MouseMove(Data_Cb As Control, ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    Data_Cb.Locked = False
End Sub

Sub EvCalend_Cb_KeyDown(Data_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    j = Data_Cb.SelStart
    If KeyCode = 220 Or KeyCode = 191 Then KeyCode = 111   'Trocando \ por /
    If KeyCode = 8 Then KeyCode = 37    'Trocando Backspace por ser a esquerda

    'Setas, teclas do clipboard e /
    If KeyCode = 16 Or KeyCode = 17 _
            Or KeyCode = 37 Or KeyCode = 39 _
            Or (Shift = 2 And KeyCode = 67) _
            Or (Shift = 2 And KeyCode = 86) _
            Or (Shift = 1 And KeyCode = 45) _
            Or (Shift = 2 And KeyCode = 88) _
            Or (KeyCode = 111 And j > 0 And j < 8) Then
        Data_Cb.Locked = False
        Exit Sub
    End If
    If Data_Cb.SelLength > 1 Then Data_Cb.SelStart = j
    If j = 2 Or j = 5 Then Data_Cb.SelStart = j + 1
    Data_Cb.Locked = False
    If (KeyCode >= 96 And KeyCode <= 105) Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) Then Else Data_Cb.Locked = True
    If j >= 8 Then Data_Cb.Locked = True
End Sub

Sub EvCalend_Cb_Change(Data_Cb As Control)
    If vEnableEvents = False Then Exit Sub
    i = Data_Cb.Value
    j = Data_Cb.SelStart
    'Eliminando barra dupla
    iSbd = Application.WorksheetFunction.Substitute(i, "//", "/")
    If i <> iSbd Then
        vEnableEvents = False
        Data_Cb.Value = iSbd
        vEnableEvents = True
        j = InStr(1, i, "//")
        Data_Cb.SelStart = j
        Exit Sub
    End If
    'Prevendo e para manter o formato dd/mm/yy, substituir
    If Len(i) > 8 And j > 0 Then
        vEnableEvents = False
        Data_Cb.Value = Left(i, j) & Mid(i, j + 2, 200)
        vEnableEvents = True
        If j = 2 Or j = 5 Then
            Data_Cb.SelStart = j + 1
        Else
            Data_Cb.SelStart = j
        End If
    End If
    'Tentando limitar a parte do dia
    i = Data_Cb.Value
    If Mid(i, 3, 1) = "/" And IsNumeric(Left(i, 2)) Then
        If Left(i, 2) > 31 And Left(i, 2) < 40 Then
            vEnableEvents = False
            Data_Cb.Value = "30" & Mid(i, 3, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 1
        End If
        If Left(i, 2) > 39 Then
            vEnableEvents = False
            Data_Cb.Value = "0" & Left(i, 1) & Mid(i, 3, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 3
        End If
    End If
    'Tentando limitar a parte do m|fffd|s
    If Mid(i, 3, 1) = "/" And Mid(i, 6, 1) = "/" And IsNumeric(Mid(i, 4, 2)) Then
        If Mid(i, 4, 2) > 12 And Mid(i, 4, 2) < 20 Then
            vEnableEvents = False
            Data_Cb.Value = Left(i, 3) & "12" & Mid(i, 6, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 4
        End If
        If Mid(i, 4, 2) > 19 Then
            vEnableEvents = False
            Data_Cb.Value = Left(i, 3) & "0" & Mid(i, 4, 1) & Mid(i, 6, 200)
            vEnableEvents = True
            Data_Cb.SelStart = 6
        End If
    End If
End Sub

Sub EvCalend_Cb_Exit(Data_Cb As Control, ByVal Cancel As MSForms.ReturnBoolean, Optional DataIni As Date)
    If DataIni = 0 Then DataIni = Now
    i = Data_Cb.Value
    If IsDate(i) Then
        If NmesIndMax = 0 Then NmesIndMax = Workbooks("cpap_pri.mac").Excel4MacroSheets(1).Range("NmesIndMax").Value
        If DateValue(i) < DateSerial(1970, 5, 15) Or DateValue(Data_Cb.Value) > DateSerial(1970, 5 + NmesIndMax, 1) Then
            MsgBox "Data inv|fffd|lida. Digite uma data entre " & Format(DateSerial(1970, 5, 15), "dd/mm/yyyy") & " e " & Format(DateSerial(1970, 5 + NmesIndMax, 1), "dd/mm/yyyy") & ".", vbCritical, "CPAP|fffd|"
            Cancel = True
        End If
        If i <> Format(DateValue(i), "dd/mm/yy") Then Data_Cb.Value = Format(DateValue(i), "dd/mm/yy")
    Else
        'Tentando resolver final de m|fffd|s
        z = InStr(1, i, "/")
        If z > 1 Then
            I1 = Left(i, z - 1)
            i2 = Mid(i, z, 250)
            If IsNumeric(I1) Then
                If IsDate(I1 - 1 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 1 & i2), "dd/mm/yy")
                    Exit Sub
                End If
                If IsDate(I1 - 2 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 2 & i2), "dd/mm/yy")
                    Exit Sub
                End If
                If IsDate(I1 - 3 & i2) Then
                    Data_Cb.Value = Format(DateValue(I1 - 3 & i2), "dd/mm/yy")
                    Exit Sub
                End If
            End If
        End If
        If MsgBox("OK  -  Restaurar inicial, " & Format(DataIni, "dd/mm/yy") & ";" & Chr(10) & Chr(10) & "Cancelar - Voltar para alterar.", vbQuestion + vbOKCancel, "Data Inv|fffd|lida!  Campo: " & Left(Data_Cb.Name, InStr(1, Data_Cb.Name, "_") - 1)) = vbOK Then
            Data_Cb.Value = Format(DataIni, "dd/mm/yy")
        Else
            Cancel = True
        End If
    End If
End Sub


Sub CalendBtClick(vForm As Object, Data_Cb As Control, Calend_Bt As Control)
    Calend_Bt.SpecialEffect = fmSpecialEffectSunken
    CalendDataIni = IIf(IsDate(Data_Cb.Value), Data_Cb.Value, Date)
    Workbooks("cpap_pri.mac").Sheets(1).Range("CalendVal").Value = CalendDataIni

    Application.ExecuteExcel4Macro ("cpap_pri.mac!CalendVBA()")

    Data_Cb.Value = Format(Workbooks("cpap_pri.mac").Sheets(1).Range("CalendVal").Value, "dd/mm/yy")
    Data_Cb.SetFocus
    Calend_Bt.SpecialEffect = fmSpecialEffectEtched
End Sub



'EVENTOS DE CAIXA DE TEXTO PARA N|fffd|MERO DE TELEFONE

Sub EvFone_Cb_Change(Fone_Cb As Control)
    i = Fone_Cb.Value
    j = Fone_Cb.SelStart
    k = Len(i)
    i = Application.WorksheetFunction.Substitute(i, ".", "")
    i = Application.WorksheetFunction.Substitute(i, "-", "")
    vEnableEvents = False
    Fone_Cb.Value = IIf(Len(i) > 3, Left(i, 3) & "-" & Mid(i, 4, 20), i)
    If Len(i) > 7 Then Fone_Cb.Value = Left(i, Len(i) + 4 * (Len(i) > 4)) & "-" & Right(i, 4)
    vEnableEvents = True
    If j < k Then Fone_Cb.SelStart = j
End Sub

Sub EvFone_Cb_KeyDown(Fone_Cb As Control, ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Fone_Cb.Locked = False
    If KeyCode = 37 Or (Shift = 2 And KeyCode = 86) Or (Shift = 1 And KeyCode = 45) Or (Shift = 2 And KeyCode = 88) Then Exit Sub   'Seta Esquerda e teclas do clipboard
    If KeyCode = 188 Then If InStr(1, Fone_Cb.Value, sd) > 0 Then Fone_Cb.Locked = True
    If (KeyCode >= 96 And KeyCode <= 105) Or (KeyCode >= 48 And KeyCode <= 57 And Shift = 0) Or KeyCode = 188 Or KeyCode = 8 Or KeyCode = 46 Then Else Fone_Cb.Locked = True
End Sub

Sub DesvanecerMesmoPa|fffd|s(Fone_Cb As Control)
    Pa|fffd|sEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("Pa|fffd|sEmpr").Value & ""
    Fone_Cb.BackColor = IIf(Fone_Cb.Value = Pa|fffd|sEmpr, &H8000000F, &H80000005)
    Fone_Cb.ForeColor = IIf(Fone_Cb.Value = Pa|fffd|sEmpr, &H80000016, &H80000008)
End Sub

Sub DesvanecerMesmaCid(Fone_Cb As Control)
    CidEmpr = Workbooks("Cpap_pri.mac").Excel4MacroSheets(1).Range("CidEmpr").Value & ""
    Fone_Cb.BackColor = IIf(Fone_Cb.Value = CidEmpr, &H8000000F, &H80000005)
    Fone_Cb.ForeColor = IIf(Fone_Cb.Value = CidEmpr, &H80000016, &H80000008)
End Sub


Attribute VB_Name = "M|fffd|d3DialCom"
Option Explicit
Declare Function WriteFile& Lib "kernel32" _
        (ByVal hFile As Long, lpBuffer As Any, _
        ByVal nNumberOfBytesToWrite&, _
        lpNumberOfBytesWritten&, ByVal lpOverlapped&)
Declare Function CreateFile& Lib "kernel32" Alias "CreateFileA" _
        (ByVal lpFileName$, ByVal dwDesiredAccess&, _
        ByVal dwShareMode&, ByVal lpSecurityAttributes&, _
        ByVal dwCreationDisposition&, ByVal dwFlagsAndAttributes&, _
        ByVal hTemplateFile&)
Declare Function CloseHandle& Lib "kernel32" (ByVal hObject&)
Declare Function FlushFileBuffers& Lib "kernel32" (ByVal hFile&)

' The number of seconds to wait for the modem to dial before
' .. resetting the modem. If the phone hangs up prematurely
' .. try increasing this value by small increments.
Public Const WAITSECONDS = 4

Public Const ID_CANCEL = 2
Public Const MB_OKCANCEL = 1
Public Const MB_ICONSTOP = 16, MB_ICONINFORMATION = 64


' PURPOSE: To dial a telephone number using the computer's modem
' ARGUMENTS:
'    PhoneNumber: The telephone number to dial
'    CommPort: The communications port the modem is connected
'              to. Typically, modems are found on COM2, however,
'              they can be configured for any COM port.
'
' EXAMPLE:
'    Type the following in the Immediate window using a modem
'    connected to the COM2 port:
'
'       ? DialNumberCom("555-1212", "COM2")
'
' ***********************************************************
Function DialNumberCom(PhoneNumber, CommPort As String, Pulso As Boolean, ComAlert As Boolean, vName As String, FoneTipo As String)
    Dim Msg As String, MsgBoxType As Integer, MsgBoxTitle As String
    Dim bModemCommand(256) As Byte, ModemCommand As String
    Dim OpenPort As Long
    Dim RetVal As Long, RetBytes As Long, i As Integer
    Dim StartTime

    DialNumberCom = False
    ' Ask the user to pick up the phone.
    '   Msg = vName & Chr(10) & PhoneNumber & Chr(10) & "Levante o fone e acione OK."
    '   MsgBoxType = MB_ICONINFORMATION + MB_OKCANCEL
    '   MsgBoxTitle = "CPAP - Discando " & FoneTipo
    If ComAlert Then
        'If MsgBox(Msg, MsgBoxType, MsgBoxTitle) = ID_CANCEL Then Exit Function
        With UserForm2LevFone
            .Caption = "CPAP - Discando " & FoneTipo
            .Nome_Lb.Caption = vName
            .Fone_Tb.Value = PhoneNumber
            .BackNum_Lb.Caption = PhoneNumber
            .Acobrar_Chb.Value = False
            .Cancelou_Chb.Value = False
            .Cancelou_Chb.Visible = False
            .BackNum_Lb.Visible = False
        End With
        UserForm2LevFone.Show
        If UserForm2LevFone.Cancelou_Chb Then Exit Function
        PhoneNumber = UserForm2LevFone.Fone_Tb.Value
    End If

    ' Open the communications port for read/write (&HC0000000).
    ' Must specify existing file (3).
    OpenPort = CreateFile(CommPort, &HC0000000, 0, 0, 3, 0, 0)
    If OpenPort = -1 Then
        Msg = "Unable to open communication port " & CommPort
        GoTo Err_DialNumber
    End If

    ' Send the telephone number to the modem.
    ModemCommand = "ATD" & IIf(Pulso, "P", "T") & PhoneNumber & vbCrLf
    ' Pack the string in a Byte array.
    For i = 0 To Len(ModemCommand) - 1
        bModemCommand(i) = Asc(Mid(ModemCommand, i + 1, 1))
    Next

    ' Write the string to the Com port.
    RetVal = WriteFile(OpenPort, bModemCommand(0), _
            Len(ModemCommand), RetBytes, 0)
    If RetVal = 0 Then
        Msg = "Unable to dial number " & PhoneNumber
        GoTo Err_DialNumber
    End If

    ' Flush the buffer to make sure it actually wrote
    RetVal = FlushFileBuffers(OpenPort)

    ' Wait WAITSECONDS seconds for the phone to dial.
    StartTime = Timer
    While Timer < StartTime + WAITSECONDS + IIf(Pulso, 4, 2)
        DoEvents
    Wend

    ' Reset the modem and take it off line.
    ModemCommand = "ATH0" & vbCrLf
    ' Pack the byte array again.
    For i = 0 To Len(ModemCommand) - 1
        bModemCommand(i) = Asc(Mid(ModemCommand, i + 1, 1))
    Next
    RetVal = WriteFile(OpenPort, bModemCommand(0), _
            Len(ModemCommand), RetBytes, 0)

    'Flush the buffer again.
    RetVal = FlushFileBuffers(OpenPort)

    ' Close the communications port.
    RetVal = CloseHandle(OpenPort)
    DialNumberCom = True
    Exit Function

Err_DialNumber:                            'This is not an On Error routine.
    Msg = Msg & vbCr & vbCr & _
            "Make sure no other devices are using Com port " & CommPort
    MsgBoxType = MB_ICONSTOP
    MsgBoxTitle = "Dial Number Error"
    MsgBox Msg, MsgBoxType, MsgBoxTitle
End Function




Attribute VB_Name = "M|fffd|d3DialWin"
Declare Function tapiRequestMakeCall Lib "tapi32.dll" _
        (ByVal stNumber As String, ByVal stDummy1 As String, _
        ByVal stDummy2 As String, ByVal stDummy3 As String) As Long
Public Const ID_CANCEL = 2
Public Const MB_OKCANCEL = 1
Public Const MB_ICONSTOP = 16, MB_ICONINFORMATION = 64

Sub Bot|fffd|o2_Clique()
    ColName = 1
    ColPhone = 2
    vRow = Selection.Row - 1
    If vRow = 0 Then Exit Sub
    DialNumberWin Range("A1").Offset(vRow, ColPhone - 1).Value, Range("A1").Offset(vRow, ColName - 1).Value, "", ""
End Sub


' ***********************************************************
' FUNCTION: DialNumberWin()
'
' PURPOSE: To dial a telephone number using the computer's modem
'
' ARGUMENTS:
' PhoneNumber: The telephone number to dial
'
' EXAMPLE:
' Type the following in the Debug window to dial a phone number:
'
' ? DialNumberWin("555-1212")
'
' About this code see Microsoft knowledgebase article Q141625
' ***********************************************************
Function DialNumberWin(PhoneNumber, ComAlert As Boolean, vName As String, FoneTipo As String)
    Dim Msg As String, MsgBoxType As Integer, MsgBoxTitle As String
    Dim RetVal As Long

    DialNumberWin = False
    ' Ask the user to pick up the phone.
    '   Msg = vName & Chr(10) & PhoneNumber & Chr(10) & "Levante o fone e acione OK."
    '   MsgBoxType = MB_ICONINFORMATION + MB_OKCANCEL
    '   MsgBoxTitle = "CPAP - Discando " & FoneTipo
    If ComAlert Then
        'If MsgBox(Msg, MsgBoxType, MsgBoxTitle) = ID_CANCEL Then Exit Function

        With UserForm2LevFone
            .Caption = "CPAP - Discando " & FoneTipo
            .Nome_Lb.Caption = vName
            .Fone_Tb.Value = PhoneNumber
            .BackNum_Lb.Caption = PhoneNumber
            .Acobrar_Chb.Value = False
            .Cancelou_Chb.Value = False
        End With
        UserForm2LevFone.Show
        If UserForm2LevFone.Cancelou_Chb Then Exit Function
        PhoneNumber = UserForm2LevFone.Fone_Tb.Value
    End If

    ' Send the telephone number to the modem.
    RetVal = tapiRequestMakeCall(PhoneNumber, "", vName, "")
    If RetVal < 0 Then
        Msg = "Unable to dial number " & PhoneNumber
        GoTo Err_DialNumber
    End If
    DialNumberWin = True
    Exit Function
Err_DialNumber:                            'This is not an On Error routine.
    Msg = Msg & Chr(13) & Chr(13) & _
            "Make sure no other devices are using the Com port"
    MsgBoxType = MB_ICONSTOP
    MsgBoxTitle = "Dial Number Error"
    MsgBox Msg, MsgBoxType, MsgBoxTitle
End Function

Attribute VB_Name = "M|fffd|d4Editada"
Sub Editada()
    Dim WbEditada As Workbook
    Set WbEditada = ThisWorkbook
    Windows(WbEditada.Windows(1).Caption).Visible = True
    WbEditada.Activate

    For Each Sh In WbEditada.Sheets
        'Este loop |fffd| usado s|fffd| onde houver planilha de hist|fffd|rico
        If Right(Sh.Name, 4) = ".hst" Then
            Sh.Activate
            NumCampos = Range("A1").CurrentRegion.Columns.Count
            NumSugPadr = Range("A1").CurrentRegion.Rows.Count
            Set Campos = Range(Cells(1, 1), Cells(1, NumCampos))

            'Limpando
            Range("DadosFixos").CurrentRegion.Clear
            Range("DadosHist").CurrentRegion.Clear
            For Each Nome In ActiveWorkbook.ActiveSheet.Names
                Nome.Delete
            Next
            With ActiveWindow
                .SplitColumn = 0
                .SplitRow = 12
            End With

            'Redefinindo
            LFix = 4 + 100   'N|fffd|m de linhas reservadas para sug. fixas. Pode ser alterado o c|fffd|digo |fffd| flex|fffd|vel
            With ActiveWorkbook.ActiveSheet.Names
                Ref = "=" & ActiveWorkbook.ActiveSheet.Name & "!" & Cells(NumSugPadr + 4, 1).Address(ReferenceStyle:=xlR1C1)
                .Add Name:="DadosFixos", RefersToR1C1:=Ref
                Ref = "=" & ActiveWorkbook.ActiveSheet.Name & "!" & Cells(NumSugPadr + 4 + LFix + 1, 1).Address(ReferenceStyle:=xlR1C1)
                .Add Name:="DadosHist", RefersToR1C1:=Ref


                For Each C In Campos
                    .Add Name:=C.Value, RefersToR1C1:=Cells(NumSugPadr + 4, C.Column)
                    .Add Name:=C.Value & "Hist", RefersToR1C1:=Cells(NumSugPadr + 4 + LFix + 2, C.Column)
                    C.Offset(NumSugPadr + 4 + LFix, 0).Value = 15
                    C.Offset(NumSugPadr + 4 + LFix + 1, 0).Value = C.Value & "Hist"
                Next
            End With
            Range("A1").CurrentRegion.Copy
            Range("DadosFixos").PasteSpecial xlPasteValues
            Application.CutCopyMode = False

            ActiveWindow.Panes(1).Activate
            Application.GoTo Reference:="DadosFixos", Scroll:=True
            ActiveWindow.Panes(3).Activate
            Application.GoTo Reference:="DadosHist", Scroll:=True
        End If
    Next

    If WbEditada.ReadOnly Then WbEditada.ChangeFileAccess xlReadWrite
    If Val(Application.Version) < 9 Then If MsgBox(WbEditada.Name & ".  Indenter? (Distanciar margens)", vbOKCancel) = vbOK Then Run "Indenter97.xla!IndentProject"
    WbEditada.Sheets(1).Select
    If MsgBox(WbEditada.Name & ".  Limpar C|fffd|digo?", vbOKCancel) = vbOK Then
        Application.OnTime Now, "VBACodeCleaner.xla!CodeCleanerMain"
    Else
        WbEditada.Save
    End If
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Attribute VB_Name = "UserForm1Prop"
Attribute VB_Base = "0{C5D3B09A-94A8-41BE-9751-C217BF694764}{79AE0655-BC73-41ED-9E05-AA6F263252DC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Necess|fffd|rio, devido bug Setfocus em textbox do Excel2k. Isto foi resolvido com SendKeys tamb|fffd|m
Public ControleAtivo As Control

Private Sub FoneResDiscar_Bt_Click()
    FoneXxxDiscar_Bt_Click "Fone Resid|fffd|ncia", FoneResDiscar_Bt, FoneResPa|fffd|s_Cb, FoneResCid_Cb, FoneResLoc_Cb, FoneResRam_Cb
End Sub
Private Sub FoneTrabDiscar_Bt_Click()
    FoneXxxDiscar_Bt_Click "Fone Trabalho", FoneTrabDiscar_Bt, FoneTrabPa|fffd|s_Cb, FoneTrabCid_Cb, FoneTrabLoc_Cb, FoneTrabRam_Cb
End Sub
Private Sub FoneAltDiscar_Bt_Click()
    FoneXxxDiscar_Bt_Click "Fone Alternativo", FoneAltDiscar_Bt, FoneAltPa|fffd|s_Cb, FoneAltCid_Cb, FoneAltLoc_Cb, FoneAltRam_Cb
End Sub
Private Sub FoneCelDiscar_Bt_Click()
    FoneXxxDiscar_Bt_Click "Fone Celular", FoneCelDiscar_Bt, FoneCelPa|fffd|s_Cb, FoneCelCid_Cb, FoneCelLoc_Cb, FoneCelRam_Cb
End Sub

Private Sub FoneResDiscar_Bt_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneResDiscar_Bt.SpecialEffect = fmSpecialEffectSunken: End Sub
Private Sub FoneResDiscar_Bt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneResDiscar_Bt.SpecialEffect = fmSpecialEffectEtched: End Sub
Private Sub FoneTrabDiscar_Bt_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneTrabDiscar_Bt.SpecialEffect = fmSpecialEffectSunken: End Sub
Private Sub FoneTrabDiscar_Bt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneTrabDiscar_Bt.SpecialEffect = fmSpecialEffectEtched: End Sub
Private Sub FoneAltDiscar_Bt_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneAltDiscar_Bt.SpecialEffect = fmSpecialEffectSunken: End Sub
Private Sub FoneAltDiscar_Bt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneAltDiscar_Bt.SpecialEffect = fmSpecialEffectEtched: End Sub
Private Sub FoneCelDiscar_Bt_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneCelDiscar_Bt.SpecialEffect = fmSpecialEffectSunken: End Sub
Private Sub FoneCelDiscar_Bt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single): FoneCelDiscar_Bt.SpecialEffect = fmSpecialEffectEtched: End Sub


Private Sub FoneXxxDiscar_Bt_Click(FoneTipo As String, FoneXxxDiscar_Bt As Control, FoneXxxPa|fffd|s_Cb As Control, FoneXxxCid_Cb As Control, FoneXxxLoc_Cb As Control, FoneXxxRam_Cb As Control)
    If FoneXxxLoc_Cb.Value = "" Then Exit Sub
    FoneXxxDiscar_Bt.SpecialEffect = fmSpecialEffectSunken
    Pref = IIf(Prefixo_Chb And Prefixo_Cb.Value <> "", Prefixo_Cb.Value & ",", "")
    AcDDI = IIf(Operadora_Chb.Value And FoneXxxPa|fffd|s_Cb.Value <> FoneEmprPa|fffd|s, "0", "")
    AcDDD = IIf(AcDDI <> "" Or (Operadora_Chb.Value And FoneXxxCid_Cb.Value <> FoneEmprCid), "0", "")
    Oper = IIf(AcDDD <> "", " " & Left(Operadora_Cb.Value, 2), "")
    Pa|fffd|s = IIf(AcDDI <> "", " " & FoneXxxPa|fffd|s_Cb.Value, "")
    Cid = IIf(AcDDD <> "", " " & FoneXxxCid_Cb.Value, "")
    LimI = IIf(AcDDD <> "", "(", "")
    LimF = IIf(AcDDD <> "", ")", "")

    NumDisc = Pref & LimI & AcDDI & AcDDD & Oper & Pa|fffd|s & Cid & LimF & FoneXxxLoc_Cb.Value
    '    NumDisc = "9,(0" & "0" & Left(Operadora_Cb.Value, 2) & FoneXxxPa|fffd|s_Cb.Value & FoneXxxCid_Cb & FoneXxxLoc_Cb

    If DiretoModem_Chb Then
        Ret = DialNumberCom(NumDisc, PortaSerial_Cb.Value, Pulso_Chb.Value, True, Cliente_Cb.Value, FoneTipo)
    Else
        Ret = DialNumberWin(NumDisc, True, Cliente_Cb.Value, FoneTipo)
    End If
    FoneXxxDiscar_Bt.SpecialEffect = fmSpecialEffectEtched
    If Ret = False Then Exit Sub

    With UserForm3Falar
        .Caption = "CPAP - Discando " & FoneTipo
        .Nome_Lb.Caption = Cliente_Cb.Value
        .Fone_Lb.Caption = NumDisc
        .Ramal_Lb.Caption = FoneXxxRam_Cb.Value
        .Frame3.Enabled = FoneXxxRam_Cb.Value <> ""
        .Cancelou_Chb.Value = False
        .Show
        If .Cancelou_Chb.Value Then Exit Sub
    End With
    i = Cliente_Cb.ListIndex
    If i = 0 Then
        HouveDisc = True   'Indica para salvar hist|fffd|rico ao sair
    Else
        vCampo = "Cliente"
        ValorCb = UserForm1Prop.Cliente_Cb.Value
        Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
        I1 = campo.Rows(i).Value
        Col = ThisWorkbook.Sheets(NomeArqHist).Range("Data").Column   'Data_Cb
        i2 = campo.Rows(i).Offset(0, Col - 1).Value
        Application.ScreenUpdating = False
        DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value)    'DirP = ThisWorkbook.Path
        If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
            If campo.Rows(i).Value = I1 And campo.Rows(i).Offset(0, 19).Value = i2 Then
                Data_Cb.Value = Format(Now, "dd/mm/yy")
                Respons|fffd|vel_Cb.Value = Workbooks("Cpap_pri.mac").Sheets(1).Range("NomeUsua").Value
                i = i - 1
                With ThisWorkbook.Sheets(NomeArqHist)
                    .Range("Cliente" & "Hist").Offset(i, 0).Value = Cliente_Cb.Value
                    .Range("FoneResPa|fffd|s" & "Hist").Offset(i, 0).Value = FoneResPa|fffd|s_Cb.Value
                    .Range("FoneResCid" & "Hist").Offset(i, 0).Value = FoneResCid_Cb.Value
                    .Range("FoneResLoc" & "Hist").Offset(i, 0).Value = FoneResLoc_Cb.Value
                    .Range("FoneResRam" & "Hist").Offset(i, 0).Value = FoneResRam_Cb.Value
                    .Range("FoneTrabPa|fffd|s" & "Hist").Offset(i, 0).Value = FoneTrabPa|fffd|s_Cb.Value
                    .Range("FoneTrabCid" & "Hist").Offset(i, 0).Value = FoneTrabCid_Cb.Value
                    .Range("FoneTrabLoc" & "Hist").Offset(i, 0).Value = FoneTrabLoc_Cb.Value
                    .Range("FoneTrabRam" & "Hist").Offset(i, 0).Value = FoneTrabRam_Cb.Value
                    .Range("FoneAltPa|fffd|s" & "Hist").Offset(i, 0).Value = FoneAltPa|fffd|s_Cb.Value
                    .Range("FoneAltCid" & "Hist").Offset(i, 0).Value = FoneAltCid_Cb.Value
                    .Range("FoneAltLoc" & "Hist").Offset(i, 0).Value = FoneAltLoc_Cb.Value
                    .Range("FoneAltRam" & "Hist").Offset(i, 0).Value = FoneAltRam_Cb.Value
                    .Range("FoneCelPa|fffd|s" & "Hist").Offset(i, 0).Value = FoneCelPa|fffd|s_Cb.Value
                    .Range("FoneCelCid" & "Hist").Offset(i, 0).Value = FoneCelCid_Cb.Value
                    .Range("FoneCelLoc" & "Hist").Offset(i, 0).Value = FoneCelLoc_Cb.Value
                    .Range("FoneCelRam" & "Hist").Offset(i, 0).Value = FoneCelRam_Cb.Value
                    .Range("Observ" & "Hist").Offset(i, 0).Value = Observ_Cb.Value
                    .Range("Data" & "Hist").Offset(i, 0).Value = Data_Cb.Value
                    .Range("Respons|fffd|vel" & "Hist").Offset(i, 0).Value = Respons|fffd|vel_Cb.Value
                End With
                SalvandoHist
                i = i + 1
                Cliente_Cb.List(i) = Cliente_Cb.Value
                FoneResPa|fffd|s_Cb.List(i) = FoneResPa|fffd|s_Cb.Value
                FoneResCid_Cb.List(i) = FoneResCid_Cb.Value
                FoneResLoc_Cb.List(i) = FoneResLoc_Cb.Value
                FoneResRam_Cb.List(i) = FoneResRam_Cb.Value
                FoneTrabPa|fffd|s_Cb.List(i) = FoneTrabPa|fffd|s_Cb.Value
                FoneTrabCid_Cb.List(i) = FoneTrabCid_Cb.Value
                FoneTrabLoc_Cb.List(i) = FoneTrabLoc_Cb.Value
                FoneTrabRam_Cb.List(i) = FoneTrabRam_Cb.Value
                FoneAltPa|fffd|s_Cb.List(i) = FoneAltPa|fffd|s_Cb.Value
                FoneAltCid_Cb.List(i) = FoneAltCid_Cb.Value
                FoneAltLoc_Cb.List(i) = FoneAltLoc_Cb.Value
                FoneAltRam_Cb.List(i) = FoneAltRam_Cb.Value
                FoneCelPa|fffd|s_Cb.List(i) = FoneCelPa|fffd|s_Cb.Value
                FoneCelCid_Cb.List(i) = FoneCelCid_Cb.Value
                FoneCelLoc_Cb.List(i) = FoneCelLoc_Cb.Value
                FoneCelRam_Cb.List(i) = FoneCelRam_Cb.Value
                Observ_Cb.List(i) = Observ_Cb.Value
                Data_Cb.List(i) = Data_Cb.Value
                Respons|fffd|vel_Cb.List(i) = Respons|fffd|vel_Cb.Value
            End If
        End If
        Application.ScreenUpdating = True
    End If
End Sub


Private Sub UserForm_Activate()
    Fechar_Bt.SetFocus
    ControleAtivo.SetFocus
    '   Application.SendKeys "{HOME}"
End Sub
Private Sub UserForm_Deactivate()
    Set ControleAtivo = ActiveControl
End Sub


Private Sub UserForm_Initialize()
    ' Encontrando o tamanho do hist|fffd|rico
    Dim j As Long
    vCampo = "Cliente"
    Set vComboBox = Cliente_Cb
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").End(xlDown))
    If campo.Rows.Count > 10000 Then j = 1 Else j = campo.Rows.Count

    'Listando sincronizado
    vEnableEvents = False
    ListandoComboBoxS Cliente_Cb, j, 3
    ListandoComboBoxS FoneResPa|fffd|s_Cb, j, 4
    ListandoComboBoxS FoneResCid_Cb, j, 5
    ListandoComboBoxS FoneResLoc_Cb, j, 6
    ListandoComboBoxS FoneResRam_Cb, j, 7
    ListandoComboBoxS FoneTrabPa|fffd|s_Cb, j, 8
    ListandoComboBoxS FoneTrabCid_Cb, j, 9
    ListandoComboBoxS FoneTrabLoc_Cb, j, 10
    ListandoComboBoxS FoneTrabRam_Cb, j, 11
    ListandoComboBoxS FoneAltPa|fffd|s_Cb, j, 12
    ListandoComboBoxS FoneAltCid_Cb, j, 13
    ListandoComboBoxS FoneAltLoc_Cb, j, 14
    ListandoComboBoxS FoneAltRam_Cb, j, 15
    ListandoComboBoxS FoneCelPa|fffd|s_Cb, j, 16
    ListandoComboBoxS FoneCelCid_Cb, j, 17
    ListandoComboBoxS FoneCelLoc_Cb, j, 18
    ListandoComboBoxS FoneCelRam_Cb, j, 19
    ListandoComboBoxS Observ_Cb, j, 21
    ListandoComboBoxS Data_Cb, j, 22
    ListandoComboBoxS Respons|fffd|vel_Cb, j, 23
    vEnableEvents = True
    Operadora_Cb.AddItem ("21 Embratel")
    Operadora_Cb.AddItem ("23 Interlig")
    Operadora_Cb.AddItem ("31 Telemar")
    PortaSerial_Cb.AddItem ("Com1")
    PortaSerial_Cb.AddItem ("Com2")
    PortaSerial_Cb.AddItem ("Com3")
    PortaSerial_Cb.AddItem ("Com4")
    Prefixo_Cb.AddItem ("0")
    Prefixo_Cb.AddItem ("8")
    Prefixo_Cb.AddItem ("9")
    Set ControleAtivo = Observ_Tb
End Sub

Sub ListandoComboBoxS(vComboBox As Object, vCount As Long, vOrig As Single)
    i = InStr(1, vComboBox.Name, "_")
    vCampo = Left(vComboBox.Name, i - 1)
    'Limpando comboboxes
    While vComboBox.ListCount >= 1
        vComboBox.RemoveItem (0)
    Wend
    'Listando comboboxes - Lista de sug. hist|fffd|ricas
    If vOrig < 20 Then vComboBox.AddItem (PropDisc(vOrig).Value)
    If vOrig = 20 Then vComboBox.AddItem (Mid(PropDisc(22).Value, 3, 2))
    If vOrig = 21 Then vComboBox.AddItem ("")
    If vOrig = 22 Then vComboBox.AddItem (Format(Now, "dd/mm/yy"))
    If vOrig = 23 Then vComboBox.AddItem (Workbooks("Cpap_pri.mac").Sheets(1).Range("NomeUsua").Value)

    vComboBox.AddItem (MarcHist)
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(vCampo & "Hist").Offset(vCount - 1, 0))
    j = 0
    For Each C In campo
        j = j + 1
        If j > 1 Then
            vComboBox.AddItem (IIf(vOrig <> 22, C.Value, Format(C.Value, "dd/mm/yy")))
        End If
    Next
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    BotAcionado = False
End Sub

Private Sub Fechar_Bt_Click()
    Hide
    BotAcionado = 1
End Sub

Private Sub Ajuda_Bt_Click()
    Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub

Private Sub Cliente_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Cliente_Cb.Locked = True
End Sub

Private Sub Cliente_Cb_KeyUP(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Cliente_Cb.Locked = False
End Sub
Private Sub Cliente_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Cliente_Cb.Value = MarcHist Then ConfHistS Cliente_Cb, PropDisc(10)
    '   EvFone_Cb_Change FoneResPa|fffd|s_Cb
End Sub
Private Sub Cliente_Cb_DropButtonClick()
    i = Cliente_Cb.ListIndex
    If i >= 0 And i <> 1 Then SincronizarCb (i)
End Sub


Private Sub FoneResPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneResPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResPa|fffd|s_Cb.Value = MarcHist Then ConfHistS FoneResPa|fffd|s_Cb, PropDisc(10)
    EvFone_Cb_Change FoneResPa|fffd|s_Cb
    OcultarExibControles
End Sub
Private Sub FoneResPa|fffd|s_Cb_DropButtonClick()
    i = FoneResPa|fffd|s_Cb.ListIndex
    If i >= 0 And i <> 1 Then SincronizarCb (i)
End Sub

Private Sub FoneResCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneResCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResCid_Cb.Value = MarcHist Then ConfHistS FoneResCid_Cb, PropDisc(10)
    EvFone_Cb_Change FoneResCid_Cb
    OcultarExibControles
End Sub
Private Sub FoneResCid_Cb_DropButtonClick()
    i = FoneResCid_Cb.ListIndex
    If i >= 0 And i <> 1 Then SincronizarCb (i)
End Sub


Private Sub FoneResLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneResLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResLoc_Cb.Value = MarcHist Then ConfHistS FoneResLoc_Cb, PropDisc(10)
    EvFone_Cb_Change FoneResLoc_Cb
End Sub

Private Sub FoneResRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneResRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneResRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneResRam_Cb.Value = MarcHist Then ConfHistS FoneResRam_Cb, PropDisc(10)
    EvFone_Cb_Change FoneResRam_Cb
End Sub




Private Sub FoneTrabPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabPa|fffd|s_Cb.Value = MarcHist Then ConfHistS FoneTrabPa|fffd|s_Cb, PropDisc(10)
    EvFone_Cb_Change FoneTrabPa|fffd|s_Cb
    OcultarExibControles
End Sub

Private Sub FoneTrabCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabCid_Cb.Value = MarcHist Then ConfHistS FoneTrabCid_Cb, PropDisc(10)
    EvFone_Cb_Change FoneTrabCid_Cb
    OcultarExibControles
End Sub

Private Sub FoneTrabLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabLoc_Cb.Value = MarcHist Then ConfHistS FoneTrabLoc_Cb, PropDisc(10)
    EvFone_Cb_Change FoneTrabLoc_Cb
End Sub

Private Sub FoneTrabRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneTrabRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneTrabRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneTrabRam_Cb.Value = MarcHist Then ConfHistS FoneTrabRam_Cb, PropDisc(10)
    EvFone_Cb_Change FoneTrabRam_Cb
End Sub




Private Sub FoneAltPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltPa|fffd|s_Cb.Value = MarcHist Then ConfHistS FoneAltPa|fffd|s_Cb, PropDisc(10)
    EvFone_Cb_Change FoneAltPa|fffd|s_Cb
    OcultarExibControles
End Sub

Private Sub FoneAltCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltCid_Cb.Value = MarcHist Then ConfHistS FoneAltCid_Cb, PropDisc(10)
    EvFone_Cb_Change FoneAltCid_Cb
    OcultarExibControles
End Sub

Private Sub FoneAltLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltLoc_Cb.Value = MarcHist Then ConfHistS FoneAltLoc_Cb, PropDisc(10)
    EvFone_Cb_Change FoneAltLoc_Cb
End Sub

Private Sub FoneAltRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneAltRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneAltRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneAltRam_Cb.Value = MarcHist Then ConfHistS FoneAltRam_Cb, PropDisc(10)
    EvFone_Cb_Change FoneAltRam_Cb
End Sub





Private Sub FoneCelPa|fffd|s_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelPa|fffd|s_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelPa|fffd|s_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelPa|fffd|s_Cb.Value = MarcHist Then ConfHistS FoneCelPa|fffd|s_Cb, PropDisc(10)
    EvFone_Cb_Change FoneCelPa|fffd|s_Cb
    OcultarExibControles
End Sub

Private Sub FoneCelCid_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelCid_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelCid_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelCid_Cb.Value = MarcHist Then ConfHistS FoneCelCid_Cb, PropDisc(10)
    EvFone_Cb_Change FoneCelCid_Cb
    OcultarExibControles
End Sub

Private Sub FoneCelLoc_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelLoc_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelLoc_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelLoc_Cb.Value = MarcHist Then ConfHistS FoneCelLoc_Cb, PropDisc(10)
    EvFone_Cb_Change FoneCelLoc_Cb
End Sub

Private Sub FoneCelRam_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown FoneCelRam_Cb, KeyCode, Shift
End Sub
Private Sub FoneCelRam_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If FoneCelRam_Cb.Value = MarcHist Then ConfHistS FoneCelRam_Cb, PropDisc(10)
    EvFone_Cb_Change FoneCelRam_Cb
End Sub


Private Sub Observ_Tb_Change()
    If vEnableEvents = False Then Exit Sub
    If Observ_Tb.Value = MarcHist Then ConfHistS Observ_Cb, PropDisc(10)
    i = Observ_Tb.Value
    j = Observ_Tb.SelStart
    k = Len(i)
    Observ_Tb.Value = LTrim(UCase(Left(Observ_Tb.Value, 1)) & Mid(Observ_Tb.Value, 2, 254))
    If j < k Then Observ_Tb.SelStart = j
End Sub
Private Sub Observ_Cb_Change()
    Observ_Tb.Value = Observ_Cb.Value
    If vEnableEvents Then Observ_Tb.SetFocus
End Sub
Private Sub Observ_Tb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Observ_Cb.Value = Observ_Tb.Value
End Sub

Private Sub Data_Cb_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
    EvCalend_Cb_MouseMove Data_Cb, Button, Shift, x, y
End Sub
Private Sub Data_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvCalend_Cb_KeyDown Data_Cb, KeyCode, Shift
    If KeyCode = 40 Or KeyCode = 38 Then Calend_Bt_Click
End Sub
Private Sub Data_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Data_Cb.Value = MarcHist Then ConfHistS Data_Cb, Format(DateValue(PropDisc(10)), "dd/mm/yy")
    EvCalend_Cb_Change Data_Cb
End Sub
Private Sub Data_Cb_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    EvCalend_Cb_Exit Data_Cb, Cancel
End Sub
Private Sub Calend_Bt_Click()
    CalendBtClick UserForm1Prop, Data_Cb, Calend_Bt
End Sub


Private Sub Respons|fffd|vel_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Respons|fffd|vel_Cb.Locked = True
End Sub
Private Sub Respons|fffd|vel_Cb_KeyUP(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    Respons|fffd|vel_Cb.Locked = False
End Sub
Private Sub Respons|fffd|vel_Cb_Change()
    If vEnableEvents = False Then Exit Sub
    If Respons|fffd|vel_Cb.Value = MarcHist Then ConfHistS Respons|fffd|vel_Cb, PropDisc(10)
End Sub



Private Sub Prefixo_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown Prefixo_Cb, KeyCode, Shift
End Sub

Private Sub Operadora_Cb_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    EvFone_Cb_KeyDown Operadora_Cb, KeyCode, Shift
End Sub



Private Sub DiretoModem_Chb_Change()
    If DiretoModem_Chb.Value = False Then If MsgBox("Voc|fffd| est|fffd| optando em n|fffd|o discar direto para o modem, assim a discagem ficar|fffd| sendo feita atrav|fffd|s de chamada TAPI no Windows (Discagem Autom|fffd|tica do Windows). Tem certeza?", vbOKCancel + vbQuestion, "Discar Direto Modem ou TAPI") = vbCancel Then DiretoModem_Chb.Value = True
    OcultarExibControles
End Sub

Private Sub Operadora_Chb_Change()
    OcultarExibControles
End Sub

Private Sub Prefixo_Chb_Change()
    OcultarExibControles
End Sub

Sub SincronizarCb(i As Long)
    vEnableEvents = False
    Cliente_Cb.ListIndex = i
    FoneResPa|fffd|s_Cb.ListIndex = i
    FoneResCid_Cb.ListIndex = i
    FoneResLoc_Cb.ListIndex = i
    FoneResRam_Cb.ListIndex = i
    FoneTrabPa|fffd|s_Cb.ListIndex = i
    FoneTrabCid_Cb.ListIndex = i
    FoneTrabLoc_Cb.ListIndex = i
    FoneTrabRam_Cb.ListIndex = i
    FoneAltPa|fffd|s_Cb.ListIndex = i
    FoneAltCid_Cb.ListIndex = i
    FoneAltLoc_Cb.ListIndex = i
    FoneAltRam_Cb.ListIndex = i
    FoneCelPa|fffd|s_Cb.ListIndex = i
    FoneCelCid_Cb.ListIndex = i
    FoneCelLoc_Cb.ListIndex = i
    FoneCelRam_Cb.ListIndex = i
    Observ_Cb.ListIndex = i
    Data_Cb.ListIndex = i
    Respons|fffd|vel_Cb.ListIndex = i
    Observ_Tb.Text = Format(Now, "dd/mm/yy hh:mm - ") & IIf(Observ_Cb.Value = "", "", Chr(10) & Observ_Cb.Value)
    vEnableEvents = True
End Sub

Sub ConfHistS(vComboBox As Object, vOriginal As String)
    '   i = InStr(1, vComboBox.Name, "_")
    '   HistEditCampo = Left(vComboBox.Name, i - 1)
    HistEditCampo = "Cliente"
    '   i = MsgBox("Configurar hist|fffd|rico pelo campo " & HistEditCampo & "?", vbQuestion + vbOKCancel) = vbOK
    i = True
    If i Then
        UserFormEditHist.Show
        Unload UserFormEditHist
    End If
    SincronizarCb 0
    '   vComboBox.Value = vOriginal
    '   If i Then ListandoComboBox vComboBox
    '   SendKeys "{END}"
End Sub

Attribute VB_Name = "UserForm2LevFone"
Attribute VB_Base = "0{B0445A68-1211-43FD-9937-4AD927B0B3A7}{585603CB-6E79-4DF5-A294-9A269D2F7150}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Acobrar_Chb_Click()
    If Acobrar_Chb.Value Then
        i = BackNum_Lb.Caption
        j = InStr(1, i, ",")   ' Posi|fffd||fffd|o da v|fffd|rgula p|fffd|s prefixo PABX
        Fone_Tb.Value = IIf(j = 0, "", Left(i, j)) & IIf(InStr(1, i, ")") > 0, "9 ", "9090 ") & IIf(j = 0, i, Mid(i, j + 1, 100))
    Else
        Fone_Tb.Value = BackNum_Lb.Caption
    End If
End Sub

Private Sub Cancelar_Bt_Click()
    Hide
    Cancelou_Chb.Value = True
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Cancelou_Chb.Value = True
End Sub

Private Sub Falar_Bt_Click()
    Hide
    Cancelou_Chb.Value = False
End Sub
Attribute VB_Name = "UserForm3Falar"
Attribute VB_Base = "0{CFF963F6-D13A-4C8A-ABB4-073153983E21}{39960B18-5213-4B06-AE80-5F6D0C6AFE36}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Cancelar_Bt_Click()
    Hide
    Cancelou_Chb.Value = True
End Sub

Private Sub DiscarRamal_Bt_Click()
    With UserForm1Prop
        If .DiretoModem_Chb Then
            Ret = DialNumberCom(Ramal_Lb.Caption, .PortaSerial_Cb.Value, .Pulso_Chb.Value, False, "", "")
        Else
            Ret = DialNumberWin(Ramal_Lb.Caption, False, "", "")
        End If
    End With
End Sub

Private Sub Rediscar_Bt_Click()
    With UserForm1Prop
        If .DiretoModem_Chb Then
            Ret = DialNumberCom(NumDisc, .PortaSerial_Cb.Value, .Pulso_Chb.Value, False, "", "")
        Else
            Ret = DialNumberWin(NumDisc, False, "", "")
        End If
    End With
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Cancelou_Chb.Value = True
End Sub

Private Sub Falar_Bt_Click()
    Hide
    Cancelou_Chb.Value = False
End Sub
Attribute VB_Name = "UserFormEditHist"
Attribute VB_Base = "0{F1131792-FCAC-4DEF-A811-66B43C4FAA12}{B36B3956-971F-47F5-B4D5-1949D7922CAE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private vListBox As Control
Private vTextBox As Control
Private SemAltera|fffd||fffd|es As Boolean


Private Sub Ajuda_Bt_Click()
    Application.Help ThisWorkbook.Path & "\cpap.hlp", HelpContextID
End Sub

Private Sub UserForm_Initialize()
    vEnableEvents = True
    Caption = "Editando Sugest|fffd|es do Campo " & HistEditCampo
    'Listando listboxes - Lista de sug fixas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo, ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).End(xlDown))
    If campo.Rows.Count < 100 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), FormatoHist)
            j = j + 1
            If j > 1 Then
                vRep = False
                For i = 1 To SugFixas_Lb.ListCount
                    If SugFixas_Lb.List(i - 1) = cf Then vRep = True
                Next
                If vRep = False Then SugFixas_Lb.AddItem (cf)
            End If
        Next
    End If

    'Listando ListBox - Sugest Hist|fffd|ricas
    Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").End(xlDown))
    If campo.Rows.Count < 10000 Then
        j = 0
        For Each C In campo
            cf = Format(IIf(IsError(C.Value), "", C.Value), FormatoHist)
            j = j + 1
            If j > 1 Then
                vRep = False
                For i = 1 To SugHist_Lb.ListCount
                    If SugHist_Lb.List(i - 1) = cf Then vRep = True
                Next
                If vRep = False And cf <> "" Then SugHist_Lb.AddItem (cf)
            End If
        Next
    End If
    NumMax_Ct.Value = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(-1, 0)
    MultiPage1.Value = 0
    MultiPage1_Change
    SemAltera|fffd||fffd|es = True
    OcultarExibControlesHist
End Sub

Private Sub NumMax_Ct_Change()
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub NumMax_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    If IsNumeric(NumMax_Ct.Value) Then
        If NumMax_Ct.Value < 0 Then NumMax_Ct.Value = 0
        If NumMax_Ct.Value > 100 Then NumMax_Ct.Value = 100
    Else
        NumMax_Ct.Value = 15
    End If
End Sub

Private Sub Fechar_Bt_Click()
    Hide
    If SemAltera|fffd||fffd|es = True Then Exit Sub
    If MsgBox("Salvar altera|fffd||fffd|es nas sugest|fffd|es para o campo " & HistEditCampo & "?", vbQuestion + vbOKCancel, "CPAP|fffd|") = vbCancel Then Exit Sub
    DirBD = Application.Evaluate(Workbooks("cpap_pri.mac").Names("DirBD").Value)    'DirP = ThisWorkbook.Path
    Application.ScreenUpdating = False
    If MyOpenFile(DirBD & "\banco\" & NomeArqHist, False) Then
        'Limpando c|fffd|lulas
        Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo, ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).End(xlDown))
        If campo.Rows.Count < 100 Then
            i = campo(1)
            campo.ClearContents
            campo(1) = i
        End If
        Set campo = ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist", ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").End(xlDown))
        If campo.Rows.Count > 10000 Then
        Else
            i = campo(1)
            campo.ClearContents
            campo(1) = i
        End If

        'Descaregando comboboxes - Sug. Fixas
        k = 0
        NumM|fffd|x = ThisWorkbook.Sheets(NomeArqHist).Range("DadosHist").Row - ThisWorkbook.Sheets(NomeArqHist).Range("DadosFixos").Row - 3
        For j = 1 To SugFixas_Lb.ListCount
            If j > NumM|fffd|x Then Exit For
            vRep = False
            If j > 1 Then
                For i = 1 To j
                    If ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).Offset(i, 0) = SugFixas_Lb.List(j - 1) Then vRep = True
                Next
            End If
            If vRep = False Then
                k = k + 1
                ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo).Offset(k, 0) = SugFixas_Lb.List(j - 1)
            End If
        Next

        'Descarregando comboboxes - Sug. Hist|fffd|ricas
        k = 0
        For j = 1 To SugHist_Lb.ListCount
            If j > NumMax_Ct.Value * 1 Then Exit For
            vRep = False
            If j > 1 Then
                For i = 1 To j
                    If ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(i, 0) = SugHist_Lb.List(j - 1) Then vRep = True
                Next
            End If
            If vRep = False Then
                k = k + 1
                ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(k, 0) = SugHist_Lb.List(j - 1)
            End If
        Next
    End If
    ThisWorkbook.Sheets(NomeArqHist).Range(HistEditCampo & "Hist").Offset(-1, 0) = NumMax_Ct.Value
    SalvandoHist
    Application.ScreenUpdating = True
End Sub

Private Sub Mover_Sb_SpinUp()
    i = vListBox.ListIndex
    If i < 1 Then Exit Sub
    vListBox.AddItem vListBox.List(i), i - 1
    vListBox.RemoveItem i + 1
    vListBox.Selected(i - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Mover_Sb_SpinDown()
    i = vListBox.ListIndex
    If i < 0 Or i + 1 >= vListBox.ListCount Then Exit Sub
    vListBox.AddItem vListBox.List(i), i + 2
    vListBox.RemoveItem i
    vListBox.Selected(i + 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Transf_Bt_Click()
    i = vListBox.ListIndex
    If i < 0 Then Exit Sub
    If vListBox.Selected(i) Then
        I1 = vListBox.Value
        vListBox.RemoveItem i
        vEnableEvents = False
        If vListBox.ListIndex = -1 Then vTextBox.Value = ""
        vEnableEvents = True
    End If
    If MultiPage1.Value = 0 Then MultiPage1.Value = 1 Else MultiPage1.Value = 0
    vListBox.AddItem I1
    vListBox.Selected(vListBox.ListCount - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Excluir_Bt_Click()
    i = vListBox.ListIndex
    If i < 0 Then Exit Sub
    If vListBox.Selected(i) Then vListBox.RemoveItem i
    vEnableEvents = False
    If vListBox.ListIndex = -1 Then vTextBox.Value = ""
    vEnableEvents = True
    OcultarExibControlesHist
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub Nova_Bt_Click()
    vListBox.AddItem "Nova Sugest|fffd|o" & vListBox.ListCount + 1
    vListBox.Selected(vListBox.ListCount - 1) = True
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub MultiPage1_Change()
    If MultiPage1.Value = 0 Then
        Set vListBox = SugHist_Lb
        Set vTextBox = SugHist_Ct
    Else
        Set vListBox = SugFixas_Lb
        Set vTextBox = SugFixas_Ct
    End If
    OcultarExibControlesHist
End Sub

Private Sub SugFixas_Ct_Change()
    If vEnableEvents = False Then Exit Sub
    i = SugFixas_Lb.ListIndex
    I1 = SugFixas_Ct.SelStart
    If i < 0 Then
        j = SugFixas_Ct.Value
        Nova_Bt_Click
        SugFixas_Ct.Value = j
        i = SugFixas_Lb.ListCount - 1
    End If
    SugFixas_Lb.AddItem SugFixas_Ct.Value, i
    SugFixas_Lb.RemoveItem i + 1
    SugFixas_Lb.Selected(i) = True
    SugFixas_Ct.SelStart = I1
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub SugFixas_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    i = SugFixas_Lb.ListIndex
    If SugFixas_Ct.Value <> "" Or i < 0 Then Exit Sub
    SugFixas_Lb.RemoveItem i
End Sub

Private Sub SugFixas_LB_Click()
    vEnableEvents = False
    SugFixas_Ct.Value = SugFixas_Lb.Value
    If SugFixas_Ct.Enabled Then SugFixas_Ct.SetFocus
    vEnableEvents = True
    OcultarExibControlesHist
End Sub

Private Sub SugHist_Ct_Change()
    If vEnableEvents = False Then Exit Sub
    i = SugHist_Lb.ListIndex
    I1 = SugHist_Ct.SelStart
    If i < 0 Then
        j = SugHist_Ct.Value
        Nova_Bt_Click
        SugHist_Ct.Value = j
        i = SugHist_Lb.ListCount - 1
    End If
    SugHist_Lb.AddItem SugHist_Ct.Value, i
    SugHist_Lb.RemoveItem i + 1
    SugHist_Lb.Selected(i) = True
    SugHist_Ct.SelStart = I1
    SemAltera|fffd||fffd|es = False
End Sub

Private Sub SugHist_Ct_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    i = SugHist_Lb.ListIndex
    If SugHist_Ct.Value <> "" Or i < 0 Then Exit Sub
    SugHist_Lb.RemoveItem i
End Sub

Private Sub SugHist_Lb_Click()
    vEnableEvents = False
    SugHist_Ct.Value = SugHist_Lb.Value
    If SugHist_Ct.Enabled Then SugHist_Ct.SetFocus
    vEnableEvents = True
    OcultarExibControlesHist
End Sub

Sub OcultarExibControlesHist()
    i = vListBox.ListIndex > -1
    Excluir_Bt.Enabled = i
    Mover_Sb.Enabled = i
    Mover_Lb.Enabled = i
    Transf_Bt.Enabled = i
    Transf_Bt.ControlTipText = "Transfere para " & IIf(MultiPage1.Value = 0, "Fixas", "Hist|fffd|ricas")
End Sub


INQUEST-PP=macro
