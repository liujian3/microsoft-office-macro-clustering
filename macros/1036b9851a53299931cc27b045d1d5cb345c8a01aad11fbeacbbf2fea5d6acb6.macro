Attribute VB_Name = "DR"
Attribute VB_Base = "0{D8C07DC8-F8C0-4849-9D39-353F9F8A3F53}{73B2C16C-9B92-4C89-A3FE-6009A8C280B6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cGS_Click()
 Dim S As String
 
 S = S + "|3f5||373||5bb||fffd||fffd||5b8||fffd||fffd||fffd||135||fffd||fffd||135||fffd||4bb||fffd||179||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||2bd||4aa||fffd||fffd||fffd||fffd||fffd||a3||fffd|" + vbCrLf + vbCrLf
 S = S + "|fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a1||fffd|" + vbCrLf
 If OptionButton1.Value = True Then
    S = S + "   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||161||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||161||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||6b6||fffd||fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||fffd||423||fffd|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||63c||fffd||fffd||5a3||fffd||fffd||fffd||fffd||fffd||2a1||fffd||523||fffd||fffd||fffd||fffd||161||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||fffd||fffd||161||fffd||fffd||2ba||17f||272||fffd||fffd||fffd||fffd||b863|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bf||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||563||fffd||363||5b9||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f5||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||421||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||631||fffd||fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||772||fffd||fffd||fa||fffd||fffd||43a||3fc||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd|" + vbCrLf
    MsgBox S, vbInformation, "|fffd||fffd||fffd||4f7||fffd||2bd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||23b||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 End If
 If OptionButton2.Value = True Then
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||63c||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||36c||fffd||436||fffd||fffd||1f7||fffd||fffd||b8e9||fffd||fffd||fffd||fffd||2f5||fffd||4bb||fffd||fffd||fffd||5b6||3b1||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b8||fffd||fffd||fffd||fffd||fffd||fffd||5b6||3a3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e3||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||429||fffd||5b6||3b1||fffd||fffd||fffd||fffd||1f5||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||2b5||fffd||2b4||fffd||fffd||fffd||fffd||fffd||1b5||123||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||429||fffd||5b6||3b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b9||fffd||bc||fffd||fffd||fffd||fffd||5b6||3a1||fffd|" + vbCrLf + vbCrLf
    S = S + "   |fffd||fffd||fffd||fffd||4e6||fffd||fffd||421||fffd||1a1||fffd||fffd||fffd||2f0||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||5e8||fffd||f5||130||fffd||165||fffd||fffd||fffd||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||133||fffd||435||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b6||3a1||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||6b6||fffd||fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||fffd||423||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||63c||fffd||fffd||5a3||fffd||fffd||fffd||fffd||fffd||2a1||fffd||523||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||77f||fffd||fffd||fffd||2a1||fffd||521||fffd|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bf||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||563||fffd||363||5b9||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||631||fffd||fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||772||fffd||fffd||fa||fffd||fffd||43a||3fc||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd|"
    MsgBox S, vbInformation, "|1a5||fffd||4dfd||2bd||fffd||fffd||fffd||be64||fffd||161||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2|"
 End If
 
  If OptionButton3.Value = True Then
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||63c||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||36c||fffd||436||fffd||fffd||1f7||fffd||fffd||b8e9||fffd||fffd||fffd||fffd||2f5||fffd||4bb||fffd||fffd||fffd||5b6||3b1||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf
    S = S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||fffd||fffd||2f38||fffd||fffd||fffd||5b6||3b5||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||133||fffd||435||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b6||3a1||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||6b6||fffd||fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||fffd||423||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||63c||fffd||fffd||5a3||fffd||fffd||fffd||fffd||fffd||2a1||fffd||523||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||77f||fffd||fffd||fffd||2a1||fffd||521||fffd|" + vbCrLf
    S = S + "   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bf||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||563||fffd||363||5b9||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + vbCrLf
    S = S + "|fffd||631||fffd||fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||772||fffd||fffd||fa||fffd||fffd||43a||3fc||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd|"
    MsgBox S, vbInformation, "|1a5||fffd||4dfd||2bd||fffd||fffd||fffd||be64||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd|"
 End If

End Sub

Private Sub CommandButton2_Click()
 On Error GoTo AA:
 
 '|221||fffd||fffd||fffd||fffd||fffd||fffd||5b8||fffd||fffd||fffd||b7||775||135||6b6||fffd||fffd||3a3||fffd||fffd||fffd|N|fffd||3a3||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||7c63||fffd||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||edfd||fffd||3863|
 'If OptionButton1.Value Then
    'If InStr(ActiveSheet.Name, "|fffd||b7||fffd| (") > 0 Or Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
       'MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f1||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||139||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||6a1||fffd|" & Left(ActiveSheet.Name, InStr(ActiveSheet.Name, "|fffd||b7||fffd|") - 1) + "|fffd||b7||fffd|" & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|": Exit Sub
    'End If
 'End If
 
 
 Dim W As Workbook, W1 As Workbook
 Dim SH As Worksheet, SH1 As Worksheet
 Dim I As Long, J As Long, MaxH As Long, MaxL As Long, gzHJH As Long
 Dim S As String, GSL As Long
 Dim ZDMok As Boolean
 
 Set W = ActiveWorkbook
 Set SH = ActiveSheet
 With Application.FileDialog(msoFileDialogOpen)
    .Show
     If .SelectedItems.Count = 0 Then Exit Sub
     Set W1 = Workbooks.Open(.SelectedItems.Item(1), , True)
 End With
 Set SH1 = W1.Sheets(1)
 W.Activate
 
 '|fffd||fffd||2bd||fffd||fffd||fffd|
  With SH1
    JD.Caption = "|fffd||fffd||fffd||6bc||fffd||fffd||fffd||2bd|...": DoEvents
    MaxH = .UsedRange.Rows.Count
    If OptionButton1.Value = True Then
       For I = 1 To MaxH
         If .Cells(I, 2) = "" Then MaxH = I: Exit For
       Next I
    Else
       For I = 1 To MaxH
         If .Cells(I, 1) = "" Then MaxH = I: Exit For
       Next I
    End If
    MaxL = .UsedRange.Columns.Count
    For I = 1 To MaxL
       If .Cells(1, I) = "" Then MaxL = I: Exit For
    Next I
    
    
    If OptionButton1.Value = True Then
       If Replace(.Cells(1, 1), " ", "") <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd|A1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||161||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       If Replace(.Cells(1, 2), " ", "") <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd|B1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       If Replace(.Cells(1, 3), " ", "") <> "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd|C1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       If Replace(.Cells(1, 4), " ", "") <> "|fffd||2ba||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd|D1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||3aa||fffd||2ba||161||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       If Replace(.Cells(1, 5), " ", "") <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd|E1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||161||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
   End If
   
   If OptionButton2.Value = True Then
       If Replace(.Cells(1, 1), " ", "") <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||435||135||fffd||4bb||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       GSL = KXL("|fffd||fffd||2f0|", SH)
       For I = 2 To MaxL
         ZDMok = False
         S = CStr(Trim(.Cells(1, I)))
         If S = "|4e6||fffd||fffd||421||fffd||fffd|" Then
            ZDMok = False
         Else
            For J = 6 To GSL - 1  '|fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||53f||fffd||461||fffd||fffd||fffd||4bb||fffd||434||fffd|5|fffd||fffd||3aa|6
              If S = SH.Cells(5, J) Then ZDMok = True: Exit For
            Next J
         End If
         If ZDMok = False Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd|" + S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f9||6da8||fffd||fffd|" + vbCrLf + vbCrLf + "  1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b9||fffd||bc||fffd||fffd||fffd||fffd||5b6||3a3||fffd|" + vbCrLf + vbCrLf + "  2|fffd||fffd||4e6||fffd||fffd||421||fffd||1a1||fffd||fffd||fffd||2f0||fffd||232||fffd||fffd||fffd||fffd||fffd||fffd||5b9||fffd||bc||fffd||fffd||fffd||fffd||5b6||3a3||fffd||fffd||fffd||fffd||735||fffd||fffd||b863|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       Next I
    End If
  
     If OptionButton3.Value = True Then
       If Replace(.Cells(1, 1), " ", "") <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||fffd||4bb||fffd||435||135||fffd||4bb||fffd||fffd||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       For I = 2 To MaxL
         ZDMok = False
         S = CStr(Trim(.Cells(1, I)))
         If S = "|fffd||fffd||fffd||fffd|" Or S = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|" Or S = "|fffd||2ba||fffd|" Or S = "|fffd||fffd||fffd||fffd|" Then ZDMok = True
         If ZDMok = False Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd|" + S + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f9||6da8||fffd||fffd|" + vbCrLf + vbCrLf + "  1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||161||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||fffd||fffd||2f38||fffd||fffd||fffd||5b6||3a1||fffd|", vbCritical, "|fffd||fffd||2be|": W1.Close False: JD.Caption = "": Exit Sub
       Next I
    End If
  End With

  
 
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  gzHJH = HJH(SH)
  If gzHJH < 8 Then
    MsgBox "|fffd||fffd||fffd||6b5||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||123||fffd||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|" + vbCrLf + " |fffd||fffd||fffd||fffd||fffd||fffd|Excel|fffd||fffd|SUM|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|"
    JD.Caption = ""
    W1.Close False:    Exit Sub
  End If
  
  Dim FileOpened As Boolean, CanDR As Boolean, JGfile As String
  Application.ScreenUpdating = False
  If Right(W.Path, 1) = "\" Then JGfile = Left(W.Path, Len(W.Path) - 1) Else JGfile = W.Path
  JGfile = JGfile + "\" + "temp.txt"
  Open JGfile For Output As #1: FileOpened = True
  
  Dim strXH As String, strXM As String, strSFZH As String, strZH As String, strBM As String, MaxXH As String
  Dim B As DocumentProperty, szBM() As String, HasBM As Boolean
  Dim R As Range
  Dim H As Long, L As Long, V As Currency, V1 As Currency
  Dim SFZts As String
  
  If OptionButton1.Value = True Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     If SH.ProtectContents = True Then SH.Unprotect "gzglxt"
     For I = 2 To MaxH
         CanDR = True
         gzHJH = HJH(SH)
         strXH = SH1.Cells(I, 1)
         strXM = Replace(SH1.Cells(I, 2), " ", "")
         strSFZH = Trim(SH1.Cells(I, 3))
         strZH = Trim(SH1.Cells(I, 4))
         strBM = Trim(SH1.Cells(I, 5))
         
         If strXM = "|fffd||3fc||fffd|" Or strXM = "|421||fffd||fffd|" Then CanDR = False: Print #1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||3fc||1bb||fffd||421||fffd||1a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|"
         
         If Len(strXM) = 2 Or (Len(strXM) = 3 And Mid(strXM, 2, 1) = " ") Then strXM = Left(strXM, 1) + "  " + Right(strXM, 1)
         JD.Caption = "|fffd||fffd||fffd||6b4||fffd||fffd||fffd|" + strXM + "...": DoEvents
         
         If strSFZH <> "" Then
            SFZts = SFZJY(strSFZH)
            If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then CanDR = False:  Print #1, "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|" & strSFZH & "|fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|"
         End If
         
         For J = 6 To gzHJH - 1
             If SH.Cells(J, 2) = strXM Then CanDR = False:  Print #1, "|fffd||fffd||fffd||fffd|" + strXM + "|fffd||474||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|": Exit For
         Next J
         If strXH <> "" And CanDR = True Then
            For J = 6 To gzHJH - 1
                If SH.Cells(J, 1) = strXH Then CanDR = False: Print #1, "|fffd||fffd||fffd||fffd|" + strXH + "|fffd||474||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|": Exit For
            Next J
         End If
         If strSFZH <> "" And CanDR = True Then
            For J = 6 To gzHJH - 1
                If SH.Cells(J, 3) = strSFZH Then CanDR = False: Print #1, "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|" + strSFZH + "|fffd||474||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|": Exit For
            Next J
         End If
         If strZH <> "" And CanDR = True Then
            For J = 6 To gzHJH - 1
                If SH.Cells(J, 4) = strZH Then CanDR = False: Print #1, "|fffd||2ba||fffd|" + strZH + "|fffd||474||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|": Exit For
            Next J
         End If
         If CanDR = True Then
            With SH
             '|fffd||fffd||fffd||fffd||fffd||579||fffd||fffd||fffd|
              If strXH = "" Then
                 MaxXH = ""
                 For J = 6 To gzHJH - 1
                     If MaxXH < CStr(.Cells(J, 1)) Then MaxXH = CStr(.Cells(J, 1))
                 Next J
              
                 If IsNumeric(MaxXH) Then
                    strXH = CStr(Val(MaxXH) + 1)
                    If Len(MaxXH) - Len(strXH) > 0 Then strXH = String(Len(MaxXH) - Len(strXH), "0") & strXH
                 Else
                    If InStr("012345678", Right(MaxXH, 1)) > 0 Then
                       strXH = Left(MaxXH, Len(MaxXH) - 1) + CStr(Val(Right(MaxXH, 1)) + 1)
                    Else
                       strXH = MaxXH + "1"
                    End If
                 End If
              End If
             .Rows(gzHJH - 1).Insert
             .Cells(gzHJH - 1, 1) = "'" & strXH
             .Cells(gzHJH - 1, 2) = strXM
             .Cells(gzHJH - 1, 3) = "'" & strSFZH
             .Cells(gzHJH - 1, 4) = "'" & strZH
             .Cells(gzHJH - 1, 5) = strBM
             
              Set R = .Cells(gzHJH - 1, YFXJL(SH))
              R.Offset(-1, 0).AutoFill Destination:=.Range(R.Offset(-1, 0), R), Type:=xlFillDefault
              
              '|fffd||fffd||2f0||fffd||47e||fffd||fb||fffd||439||fffd||2bd||fffd||fffd|
              'Set R = .Cells(gzHJH - 1, KXL("|fffd||fffd||2f0|", SH))
              'R.Offset(-1, 0).AutoFill Destination:=.Range(R.Offset(-1, 0), R), Type:=xlFillDefault
              
              Set R = .Cells(gzHJH - 1, KKXJL(SH))
              R.Offset(-1, 0).AutoFill Destination:=.Range(R.Offset(-1, 0), R), Type:=xlFillDefault
              Set R = .Cells(gzHJH - 1, SFGZL(SH))
              R.Offset(-1, 0).AutoFill Destination:=.Range(R.Offset(-1, 0), R), Type:=xlFillDefault
             .Rows(gzHJH - 1 + 1).Cut
             .Rows(gzHJH - 1).Insert
              Print #1, "|fffd||475||fffd||fffd||fffd|" + strXM + "|fffd||13b||fffd||fffd||fffd||fffd||fffd||3e2|"
              
              '|36c||fffd||fffd||fffd||fffd||fffd||4f2||fffd||fffd||fffd|
              Erase szBM
              ReDim szBM(0)
              
              '|4aa||fffd||173||fffd| |5e8||fffd||fffd|_  |fffd||fffd||377||fffd||137||1f2||fffd||fffd||fffd||fffd||fffd||fffd||1b5||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd|
              For Each B In W.CustomDocumentProperties
                  ReDim Preserve szBM(UBound(szBM) + 1)
                  If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then szBM(UBound(szBM)) = B.Name
              Next B
              
              If strBM <> "" Then
                 HasBM = False
                 For J = 1 To UBound(szBM)
                     If szBM(J) = strBM Then HasBM = True: Exit For
                 Next J
                 If HasBM = False Then
                    W.CustomDocumentProperties.Add Name:=strBM, LinkToContent:=False, Type:=msoPropertyTypeString, Value:=""
                    Print #1, "|fffd||6b5||fffd||1f0||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f2||fffd||fffd||163||fffd|" + strBM
                 End If
              End If
            End With
         End If
     Next I
  End If
  
  If OptionButton2.Value = True Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     For I = 2 To MaxH
         CanDR = False
         strXM = Replace(SH1.Cells(I, 1), " ", "")
         If Len(strXM) = 2 Or (Len(strXM) = 3 And Mid(strXM, 2, 1) = " ") Then strXM = Left(strXM, 1) + "  " + Right(strXM, 1)
         JD.Caption = "|fffd||fffd||fffd||6b4||fffd||fffd||fffd|" + strXM + "...": DoEvents
         For J = 6 To gzHJH - 1
             If SH.Cells(J, 2) = strXM Then H = J: CanDR = True: Exit For
         Next J
         If CanDR = False Then
            Print #1, "|fffd||fffd||fffd||fffd|" + strXM + "|fffd||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|"
         Else
            For J = 2 To MaxL
                L = KXL(SH1.Cells(1, J).Value, SH)
                V1 = Val(SH1.Cells(I, J).Value)
                V = Val(SH.Cells(H, L).Value)
                If V <> 0 Then
                   If CheckBox1.Value = True Then
                      SH.Cells(H, L).Value = V1
                      If V <> V1 Then Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(5, L) + "|fffd||fffd||5b5||3aa|" + CStr(V) + "|fffd||fffd||fffd||fffd||fffd||6efb||3aa|" + CStr(V1) Else Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(5, L) + "|fffd||fffd||5b5||3aa|" + CStr(V) + "|fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||fffd||36c|"
                   Else
                      If V1 <> V Then Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(5, L) + "|fffd||474||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(V) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(V1) + "|fffd||6efb|" Else Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(5, L) + "|fffd||474||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(V) + "|fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||fffd||36c|"
                   End If
                Else
                   SH.Cells(H, L).Value = V1
                End If
            Next J
            Print #1, "|fffd||475||fffd||fffd||fffd|" + strXM + "|fffd||13e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
         End If
     Next I
  End If
  
  If OptionButton3.Value = True Then '|1a5||fffd||4dfd||2bd||fffd||fffd||fffd||be64||fffd||161||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2|
     Dim S1 As String, K As Long
     If SH.ProtectContents = True Then SH.Unprotect "gzglxt"

     For I = 2 To MaxH
         CanDR = False
         strXM = Replace(SH1.Cells(I, 1), " ", "")
         If Len(strXM) = 2 Or (Len(strXM) = 3 And Mid(strXM, 2, 1) = " ") Then strXM = Left(strXM, 1) + "  " + Right(strXM, 1)
         JD.Caption = "|fffd||fffd||fffd||6b4||fffd||fffd||fffd|" + strXM + "...": DoEvents
         For J = 6 To gzHJH - 1
             If SH.Cells(J, 2) = strXM Then H = J: CanDR = True: Exit For
         Next J
         If CanDR = False Then
            Print #1, "|fffd||fffd||fffd||fffd|" + strXM + "|fffd||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||fffd|"
         Else
            For J = 2 To MaxL
            
                Select Case Trim(SH1.Cells(1, J).Value)
                       Case "|fffd||fffd||fffd||fffd|": L = 1
                       Case "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|": L = 3
                       Case "|fffd||2ba||fffd|": L = 4
                       Case "|fffd||fffd||fffd||fffd|": L = 5
                End Select
            
                S1 = Trim(SH1.Cells(I, J).Value)
                
                If L <> 5 And S1 <> "" Then
                   For K = 6 To gzHJH - 1
                       If K <> H Then
                          If SH.Cells(K, L) = S1 Then CanDR = False: Print #1, strXM & "|fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||2d7c||fffd||fffd||fffd|"; Trim(SH1.Cells(1, J).Value) & S1 & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||474||fffd||fffd||6a3||fffd||3b4||fffd||fffd||fffd||fffd||fffd||fffd|"
                       End If
                   Next K
                End If
                
                If L = 3 And S1 <> "" Then
                  SFZts = SFZJY(S1)
                  If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then CanDR = False:  Print #1, strXM & "|fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||2d7c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|" & S1 & "|fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||fffd||fffd|"
                End If
              
                S = Trim(SH.Cells(H, L).Value)
                If CanDR Then
                   If S <> "" Then
                      If CheckBox3.Value = True Then
                         SH.Cells(H, L).Value = IIf(L = 5, "", "'") & S1
                         If S <> S1 Then Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(4, L) + "|fffd||fffd||5b5||3aa|" + CStr(S) + "|fffd||fffd||fffd||fffd||fffd||6efb||3aa|" + CStr(S1) Else Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(4, L) + "|fffd||fffd||5b5||3aa|" + CStr(S) + "|fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||fffd||36c|"
                      Else
                         If S1 <> S Then Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(4, L) + "|fffd||474||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(S) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(S1) + "|fffd||6efb|" Else Print #1, strXM + "|fffd||139||fffd||fffd||fffd||fffd||fffd||13f|" + SH.Cells(4, L) + "|fffd||474||fffd||fffd||fffd||fffd||fffd||5b5|" + CStr(S) + "|fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||fffd||36c|"
                      End If
                   Else
                      SH.Cells(H, L).Value = IIf(L = 5, "", "'") & S1
                   End If
                End If
            Next J
            Print #1, "|fffd||475||fffd||fffd||fffd|" + strXM + "|fffd||13e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
         End If
     Next I
  End If

  
    
  JD.Caption = ""
  Close #1
  SheetProtect SH
  W1.Close False
  Application.ScreenUpdating = True

  Unload Me
  
  MsgBox "|fffd||fffd||fffd||775||fffd||fffd||fffd||fffd||fffd||263||fffd|", vbInformation, "|fffd||fffd||2be|"
  Shell "notepad.exe " + JGfile, vbNormalFocus
  
    
  Set W = Nothing: Set W1 = Nothing
  Set SH = Nothing: Set SH1 = Nothing
AA: ErrSub: JD.Caption = "": If FileOpened = True Then Close #1
End Sub

Private Sub CommandButton3_Click()
 Unload Me
End Sub

Private Sub CommandButton4_Click()
 On Error GoTo AA
 Dim WB As Workbook
 Dim Path As String
 Path = ThisWorkbook.Path
 Set WB = Application.Workbooks.Add
 
 ActiveWindow.DisplayGridlines = False
 With ActiveSheet
 
  If OptionButton1.Value Then
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C1").Value = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|"
     .Range("D1").Value = "|fffd||2ba||fffd|"
     .Range("E1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("A2").Value = "'" & "004"
     .Range("B2").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C2").Value = "11030519550615044X"
     .Range("D2").Value = "'" & "98810011234192"
     .Range("E2").Value = "|fffd||fffd||fffd||2b2||fffd|"
     .Range("A3").Value = "'" & "001"
     .Range("B3").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C3").Value = "'" & "320101195506150444"
     .Range("B4").Value = "|fffd||fffd||fffd||fffd|"
     .Range("D4").Value = "'" & "98810011234191"
     .Range("B5").Value = "|fffd||fffd||fffd||fffd|"
     .Range("E5").Value = "|fffd||fffd||fffd||fffd|"
     .Columns(3).ColumnWidth = 19
     .Columns(4).ColumnWidth = 19
     .Range("A1:E5").Borders.LineStyle = xlContinuous
      WB.SaveAs Path & "\|fffd||fffd||fffd||4f7||fffd||2bd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||23b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|.xls", xlExcel8
      Unload Me
      WB.Activate
      Exit Sub
   End If
   
     If OptionButton2.Value Then
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||3f1||fffd||fffd||fffd|"
     .Range("C1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("D1").Value = "|4bd||fffd||1b1||fffd||fffd||fffd|"
     .Range("E1").Value = "|2a7||4b5||fffd||fffd||fffd||fffd|"
     .Range("F1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd|"
     .Range("A2").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B2").Value = 1000
     .Range("C2").Value = 1500
     .Range("D2").Value = 150
     .Range("E2").Value = 35
     .Range("F2").Value = 40
     .Range("A3").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B3").Value = 2000
     .Range("F3").Value = 25
     .Range("A4").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C4").Value = 800
     .Range("E4").Value = 450
     .Range("A5").Value = "|fffd||fffd||fffd||fffd|"
     .Range("D5").Value = 355
     .Range("F5").Value = 100
     .Range("A1:F5").Borders.LineStyle = xlContinuous
     .Range("B2:F5").NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
      WB.SaveAs Path & "\|1a5||fffd||4dfd||2bd||fffd||fffd||fffd||be64||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|.xls", xlExcel8
      Unload Me
      WB.Activate
      Exit Sub
   End If


  If OptionButton3.Value Then
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C1").Value = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|"
     .Range("D1").Value = "|fffd||2ba||fffd|"
     .Range("E1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("A2").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B2").Value = "004"
     .Range("C2").Value = "11030519550615044X"
     .Range("D2").Value = "'" & "98810011234192"
     .Range("E2").Value = "|fffd||fffd||fffd||2b2||fffd|"
     .Range("A3").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B3").Value = "001"
     .Range("C3").Value = "'" & "320101195506150444"
     .Range("A4").Value = "|fffd||fffd||fffd||fffd|"
     .Range("D4").Value = "'" & "98810011234191"
     .Range("A5").Value = "|fffd||fffd||fffd||fffd|"
     .Range("E5").Value = "|fffd||fffd||fffd||fffd|"
     .Columns(3).ColumnWidth = 19
     .Columns(4).ColumnWidth = 19
     .Range("A1:E5").Borders.LineStyle = xlContinuous
      WB.SaveAs Path & "\|1a5||fffd||4dfd||2bd||fffd||fffd||fffd||be64||fffd||161||fffd||fffd||fffd||fffd||fffd||5a4||fffd||161||fffd||fffd||2ba||161||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||2be||fffd||fffd|.xls", xlExcel8
      Unload Me
      WB.Activate
      Exit Sub
   End If

   
 End With
 
 
AA: ErrSub
End Sub

Private Sub OptionButton1_Click()
 OptionButton1.ForeColor = &HFF0000
 OptionButton2.ForeColor = &H80000012
 OptionButton3.ForeColor = &H80000012
 CheckBox1.Visible = False
 CheckBox3.Visible = False
End Sub

Private Sub OptionButton2_Click()
 OptionButton1.ForeColor = &H80000012
 OptionButton2.ForeColor = &HFF0000
 OptionButton3.ForeColor = &H80000012
 CheckBox1.Visible = True
 CheckBox3.Visible = False
End Sub
Private Sub OptionButton3_Click()
 OptionButton1.ForeColor = &H80000012
 OptionButton2.ForeColor = &H80000012
 OptionButton3.ForeColor = &HFF0000
 CheckBox1.Visible = False
 CheckBox3.Visible = True
End Sub



Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "GSHD"
Attribute VB_Base = "0{0BBCBB09-4D43-4FD6-872B-CDB2968B6E8A}{128F7CA3-5806-4AF0-AE00-46D5C1ACA1E1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton1_Click()
  Unload Me
End Sub




Private Sub UserForm_Initialize()
  On Error GoTo AA
  With ComboBox1
      .Style = fmStyleDropDownList
      .AddItem "1|fffd||fffd|"
      .AddItem "2|fffd||fffd|"
      .AddItem "3|fffd||fffd|"
      .AddItem "4|fffd||fffd|"
      .AddItem "5|fffd||fffd|"
      .AddItem "6|fffd||fffd|"
      .AddItem "7|fffd||fffd|"
      .AddItem "8|fffd||fffd|"
      .AddItem "9|fffd||fffd|"
      .AddItem "10|fffd||fffd|"
      .AddItem "11|fffd||fffd|"
      .AddItem "12|fffd||fffd|"
      .ListIndex = Month(Now) - 1
  End With
AA:    ErrSub
End Sub

Private Sub CommandButton2_Click()
  On Error GoTo AA
  Dim W As Workbook, W1 As Workbook, W2 As Workbook
  Dim SH As Worksheet, SH1 As Worksheet
  Set W = ActiveWorkbook
  Dim S As String, SFZts As String
  Dim I As Long, H As Long, gzHJH As Long

 Dim ThisYF As Long
 ThisYF = ComboBox1.ListIndex + 1 '|fffd||fffd||1f0||461||fffd||fffd||fffd||fffd||fffd||b7||fffd|

   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd|
   For I = 1 To W.Sheets.Count
       Set SH = W.Sheets(I)
       If IsGZB(SH) And Right(SH.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then  '|fffd||fffd||fffd||fffd||fffd||7b3||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd|
          gzHJH = HJH(SH)
          For H = 6 To gzHJH - 1
              S = Trim(SH.Cells(H, 3))
              If S = "" Then MsgBox "|fffd||fffd|" & SH.Name & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd|" & CStr(H) & "|fffd||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
              SFZts = SFZJY(S)
              If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|fffd||fffd|" & SH.Name & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd|" & CStr(H) & "|fffd||435||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3aa|" & S & "|fffd||fffd|" & vbCrLf & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|":    Exit Sub
          Next H
       End If
   Next I
   Set SH = Nothing
  
  '|fffd||fffd||221||ff||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7a3||fffd|
  Dim StrGJJsx As String, GJJsx As String
  Dim StrQYGJJsx As String, QYGJJsx As String
  Dim StrQYNJsx As String, QYNJsx As String
  Dim SZ() As String
  Dim Px As DocumentProperty
 '=============|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then StrGJJsx = Px.Value
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then StrQYGJJsx = Px.Value
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then StrQYNJsx = Px.Value
    Next
 '=======================================================================
  
  
  
   '|fffd||fffd||fffd||275||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Set W1 = Application.Workbooks.Add
   
   Application.ScreenUpdating = False
   
   
   Dim DIC, DicHZ
   Set DIC = CreateObject("scripting.dictionary")
   Set DicHZ = CreateObject("scripting.dictionary")
   Dim ColYFXJ As Long
   Dim ColGJJ As Long
   Dim ColQYNJ As Long
   Dim colYLBX As Long
   Dim colYL As Long
   Dim colSY As Long
   Dim colGS As Long
   Dim YF As Long
   
   Dim DC_Row As Long, XM As String
   
   For YF = 1 To ThisYF
       If DIC.Count > 0 Then DIC.RemoveAll
       DC_Row = 0
   
       Set SH1 = W1.Worksheets.Add(After:=W1.Sheets(W1.Sheets.Count))
       With SH1
           .Name = CStr(YF) & "|fffd||b7||fffd|"
           .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
           .Range("C1").Value = "*|5a4||fffd||57a||fffd||fffd||fffd|"
           .Range("D1").Value = "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("E1").Value = "|4e6||fffd||fffd||421||fffd||fffd|"
           .Range("F1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||577||fffd|"
           .Range("G1").Value = "|fffd||fffd||fffd||fffd||4bd||fffd||1b1||fffd||fffd||577||fffd|"
           .Range("H1").Value = "|2a7||4b5||fffd||fffd||fffd||577||fffd|"
           .Range("I1").Value = "|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("J1").Value = "|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("K1").Value = "|fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("L1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||275||139||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("M1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||33b39||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7b2||fffd||fffd||fffd|"
           .Range("N1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd|"
           .Range("O1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Range("P1").Value = "|fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd|"
           .Range("Q1").Value = "|fffd||47f||6f8||fffd||2f0|"
           
           .Range("K2").Formula = "=IF(J2=0,I2,MIN(I2,J2))"
           .Range("M2").Formula = "=IF(L2=""|fffd||fffd|"",I2-K2,0)"
           .Range("P2").Formula = "=IF(O2=0,N2,MIN(N2,O2))"
           .Range("D2").Formula = "=E2+M2"

           .Range("B1,C1,D1,F1,G1,H1,K1,P1").Font.ColorIndex = 5
        
           .Rows(1).RowHeight = 43
           .Rows(1).HorizontalAlignment = xlCenter
           .Rows(1).WrapText = True
           .Cells.ColumnWidth = 11
           .Columns(1).Hidden = True
           .Columns(2).ColumnWidth = 8
           .Columns("M:M").ColumnWidth = 12
           .Columns(3).ColumnWidth = 20
           .Cells.NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
            ActiveWindow.DisplayGridlines = False
            ActiveWindow.SplitRow = 1
            ActiveWindow.SplitColumn = 2
            ActiveWindow.FreezePanes = True
            
            GJJsx = "": If StrGJJsx <> "" Then SZ = Split(StrGJJsx, ","):        GJJsx = SZ(YF - 1)   'SZ|fffd||fffd||fffd||b1||fffd||fffd|0|fffd||fffd||2bc|
            QYNJsx = "": If StrQYNJsx <> "" Then SZ = Split(StrQYNJsx, ","):     QYNJsx = SZ(YF - 1) 'SZ|fffd||fffd||fffd||b1||fffd||fffd|0|fffd||fffd||2bc|
            QYGJJsx = ""
            If StrQYGJJsx <> "" Then
               If InStr(StrQYGJJsx, ",") = 0 Then QYGJJsx = StrQYGJJsx Else SZ = Split(StrQYGJJsx, ","):     QYGJJsx = SZ(YF - 1)
            End If
            
            
            For I = 1 To W.Worksheets.Count
                Set SH = W.Worksheets(I)
                If Left(SH.Name, Len(CStr(YF)) + 2) = CStr(YF) & "|fffd||b7||fffd|" Then
                   If IsGZB(SH) And Right(SH.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
                      gzHJH = HJH(SH)
                      ColYFXJ = YFXJL(SH)
                      ColGJJ = KXL("|fffd||fffd||fffd||fffd||fffd||fffd|", SH)
                      ColQYNJ = KXL("|fffd||fffd||4b5||fffd||fffd||fffd|", SH)
                      colYLBX = KXL("|fffd||fffd||fffd||3f1||fffd||fffd||fffd|", SH)
                      colYL = KXL("|4bd||fffd||1b1||fffd||fffd||fffd|", SH)
                      colSY = KXL("|2a7||4b5||fffd||fffd||fffd||fffd|", SH)
                      colGS = KXL("|fffd||fffd||2f0|", SH)
                      
                      For H = 6 To gzHJH - 1
                          S = SH.Range("C" & H)
                          
                          If DIC.Exists(S) = False Then  '|fffd||fffd||fffd||fffd|1|fffd||fffd|
                             DC_Row = DIC.Count + 1 + 1 '|fffd||fffd||4bb||fffd||fffd|+1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||6b6||fffd||fffd||fffd|+1|fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                             DIC(S) = DC_Row
                             
                            .Range("J" & DC_Row) = Val(GJJsx)
                             If QYGJJsx <> "" Then .Range("L" & DC_Row) = QYGJJsx
                            .Range("O" & DC_Row) = Val(QYNJsx)
                             XM = SH.Range("B" & H)
                            .Range("B" & DC_Row) = XM
                             DicHZ(S) = XM
                            .Range("C" & DC_Row) = "'" & S
                            
                            .Range("E" & DC_Row) = SH.Cells(H, ColYFXJ)
                            .Range("F" & DC_Row) = SH.Cells(H, colYLBX)
                            .Range("G" & DC_Row) = SH.Cells(H, colYL)
                            .Range("H" & DC_Row) = SH.Cells(H, colSY)
                            .Range("I" & DC_Row) = SH.Cells(H, ColGJJ)
                            .Range("N" & DC_Row) = SH.Cells(H, ColQYNJ)
                            .Range("Q" & DC_Row) = SH.Cells(H, colGS)
                          Else
                             DC_Row = DIC(S)
                            .Range("E" & DC_Row) = .Range("E" & DC_Row) + SH.Cells(H, ColYFXJ)
                            .Range("F" & DC_Row) = .Range("F" & DC_Row) + SH.Cells(H, colYLBX)
                            .Range("G" & DC_Row) = .Range("G" & DC_Row) + SH.Cells(H, colYL)
                            .Range("H" & DC_Row) = .Range("H" & DC_Row) + SH.Cells(H, colSY)
                            .Range("I" & DC_Row) = .Range("I" & DC_Row) + SH.Cells(H, ColGJJ)
                            .Range("N" & DC_Row) = .Range("N" & DC_Row) + SH.Cells(H, ColQYNJ)
                            .Range("Q" & DC_Row) = .Range("Q" & DC_Row) + SH.Cells(H, colGS)
                          End If
                      Next H
                      DC_Row = DIC.Count + 1 '|fffd||fffd||3aa||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||b8||fffd||fffd||1b9||fffd||2bd|
                     .Range("K2").AutoFill Destination:=.Range("K2:K" & DC_Row)
                     .Range("M2").AutoFill Destination:=.Range("M2:M" & DC_Row)
                     .Range("P2").AutoFill Destination:=.Range("P2:P" & DC_Row)
                     .Range("D2").AutoFill Destination:=.Range("D2:D" & DC_Row)
                      
                      '|fffd||fffd||fffd||27a||3fc||fffd||fffd||423||fffd||fffd||fffd|
                     .Range("B" & DC_Row + 1) = "|fffd||fffd|   |fffd||fffd|"
                     .Range("D" & DC_Row + 1).Formula = "=SUM(D2:D" & CStr(DC_Row) & ")"
                     .Range("D" & DC_Row + 1).AutoFill Destination:=.Range("D" & DC_Row + 1 & ":Q" & DC_Row + 1)
                     .Range("J" & DC_Row + 1).Formula = ""
                     .Range("L" & DC_Row + 1).Formula = ""
                     .Range("O" & DC_Row + 1).Formula = ""
                     .Range("B1:Q" & DC_Row + 1).Borders.LineStyle = xlContinuous
                     .Range("B1:Q1").Interior.ColorIndex = 19
                     '.Range("B" & DC_Row & ":Q" & DC_Row).Interior.ColorIndex = 24
                     
                     .Range("Q1") = "|fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||47f||6f8||fffd||2f0|"
                   End If
                End If
            Next I
       End With
   Next YF
   
   
   '|27e||fffd||fffd||fffd||571||fffd|
   Application.DisplayAlerts = False
   For I = W1.Worksheets.Count To 1 Step -1
       If IsEmpty(W1.Worksheets(I).UsedRange) Then W1.Worksheets(I).Delete
   Next I
   Application.DisplayAlerts = True

    '|fffd||fffd||fffd||27b||fffd||fffd||731||fffd||fffd||fffd|
    Dim SHhz As Worksheet
    W1.Sheets(1).Copy before:=Sheets(1)
    Set SHhz = W1.ActiveSheet
    ActiveWindow.DisplayZeros = False
    With SHhz
        .Name = "|fffd||fffd||fffd||fffd|"
        .Rows("2:" & .UsedRange.Rows.Count).Delete '|27e||fffd||fffd||52d||fffd||fffd||fffd||fffd||fffd||fffd|
        
        .Range("R1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||6f3||fffd|"
        .Range("S1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||6f3||fffd|"
        .Range("T1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||1bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||6f3||fffd|"
        .Range("U1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||5a7||fffd||fffd||fffd||6f3||fffd|"
        .Range("V1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||5e1||fffd||fffd||fffd||fffd||fffd||5a7||fffd||5bf||6f3||fffd|"
        .Range("W1").Value = "|fffd||fffd||23b||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||5b9||fffd||fffd||fffd||fffd||fffd||134||fffd||4bd||fffd||fffd|"
        .Range("X1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd|(|fffd||fffd||3b4||fffd||fffd||ff||fffd||fffd|5000)"
        .Range("Y1").Value = "|fffd||6fc||fffd||fffd||b7||fffd|"
        .Range("Z1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||4e6||fffd||278||fffd||2f0|"
        .Range("AA1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||4e6||fffd||278||fffd||fffd||fffd|"
        .Range("AB1").Value = "|fffd||fffd||fffd||7f2||fffd||fffd||fffd|"
        '.Range("AC1").Value = "|fffd||fffd||fffd||fffd||fffd||b5||5f9||fffd||fffd||2b1||fffd||fffd||47f||6f8||fffd||2f0|"
        .Range("AD1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||524||fffd||278||fffd||2f0|"
        '.Range("AE1").Value = "|fffd||fffd||fffd||7f2||fffd||fffd||fffd|"
        .Range("AF1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2f0|"
        .Range("AG1").Value = "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||4e6||fffd||278||fffd||2f0|"
        .Range("AH1").Value = "|fffd||fffd||fffd||7f2||fffd||fffd||fffd|"
        .Range("X2").Formula = "=D2-SUM(F2:H2,K2,P2,R2:W2)"
        .Range("Z2").Formula = "=ROUND(MAX((X2-5000*Y2)*{0.03,0.1,0.2,0.25,0.3,0.35,0.45}-{0,2520,16920,31920,52920,85920,181920},0),2)"
        .Range("AB2").Formula = "=Z2-AA2"
        .Range("AF2").Formula = "=Z2-AD2"
        .Range("AH2").Formula = "=AF2-AG2"
        
         With .Range("AF1").AddComment
              .Text Text:="|fffd||631||fffd||fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e6||fffd||278||fffd||2f0||fffd||1f8||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||772||fffd||fffd||fffd||fffd||fffd||5b8||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & ""
              .Visible = True
              .Shape.ScaleHeight 0.5, msoFalse, msoScaleFromTopLeft
              .Shape.ScaleWidth 5, msoFalse, msoScaleFromTopLeft
              .Visible = False  '|fffd||fffd||fffd||6b6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||435||fffd||52d||fffd||fffd||5bb||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||623||fffd||fffd||fffd||fffd||fffd||fffd||363||fffd||fffd||2b1||fffd||17b||fffd||fffd||fffd||5a1||fffd|
         End With
        .Range("R1:V1,AA1,AD1,AG1").Font.ColorIndex = 21
        .Range("W1").Font.ColorIndex = 3
        .Columns("R:X").ColumnWidth = 14
        .Columns("AC").Hidden = True
        .Columns("AE").Hidden = True
        
        
        '|fffd||fffd||fffd||27b||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If DIC.Count > 0 Then DIC.RemoveAll '|fffd||fffd||fffd|DIC|fffd||5b5||48ec||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b4||6d22||fffd||fffd||fffd||731||fffd||fffd||fffd||fffd||43a||fffd|
        
        Dim Keys()
        Keys = DicHZ.Keys  '|5bb||fffd||fffd||fffd||fffd||fffd||6b0||f6a32||fffd||fffd||fffd||5b1||fffd||fffd||f6||fffd||679||63c||fffd||fffd||5a3||fffd|DicHZ.Keys(I)
        For I = 0 To UBound(Keys)
            S = Keys(I)
            H = I + 1 + 1 '|fffd||fffd||fffd||fffd|+1|fffd||fffd||fffd||fffd||3aa||fffd||431||fffd||fffd||fffd||fffd||fffd|
            DIC(S) = H
           .Cells(H, 3) = "'" & S
           .Cells(H, 2) = DicHZ(S)
        Next
       
        
        Dim SumH As Long, sumL As Long '|fffd||fffd||fffd||731||fffd||fffd||fffd||fffd||43a||fffd||fffd||fffd|
        For I = 2 To W1.Worksheets.Count
           Set SH = W1.Worksheets(I)
            For H = 2 To SH.UsedRange.Rows.Count
                .Range("Y" & H) = ThisYF
                S = SH.Cells(H, 3)
                If DIC.Exists(S) Then
                   SumH = DIC(S)
                   For sumL = 4 To 17
                      If sumL <> 10 And sumL <> 12 And sumL <> 15 Then
                        .Cells(SumH, sumL) = .Cells(SumH, sumL) + SH.Cells(H, sumL)
                      End If
                   Next sumL
                End If
            Next H
        Next I
    End With
    
    
    
 '|461||fffd||fffd||4aa||fffd||23d||3f5||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Dim CanDrSW As Boolean
  CanDrSW = True

 With Application.FileDialog(msoFileDialogOpen)
    .Title = "|fffd||fffd||fffd||fffd||23b||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||fffd||43d||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd|Excel|fffd||135||fffd||fffd||fffd|"
    .Show
     If .SelectedItems.Count = 0 Then CanDrSW = False
     If CanDrSW Then Set W2 = Workbooks.Open(.SelectedItems.Item(1), , True)
 End With
 If Not W2 Is Nothing Then Set SH = W2.Sheets(1)
 
 
 
  '|fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||775||138||fffd||2f0||fffd||1f7||fffd||fffd||fffd||237|
  If CanDrSW Then
    With SH
       S = "|fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||23b||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||fffd||43d||fffd||fffd||fffd||2f0||fffd||fffd||fffd||761||fffd|" & vbCrLf & vbCrLf
       If .Range("D1") <> "|5a4||fffd||57a||fffd||fffd||fffd|" Then MsgBox S & "D1|fffd||fffd||52a||fffd||fffd||fffd||fffd||5a4||fffd||57a||fffd||fffd||b8e1|", vbCritical, "|fffd||fffd||2be|":                              CanDrSW = False
       If .Range("S1") <> "|fffd||6fc||fffd||fffd||fffd||fffd||fffd||fffd|" Then MsgBox S & "S1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||fffd||fffd||e8e1|", vbCritical, "|fffd||fffd||2be|":                          CanDrSW = False
       If .Range("U1") <> "|fffd||6fc||fffd||5e8||fffd||fffd||6f3||fffd|" Then MsgBox S & "U1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||5e8||fffd||fffd||6f3||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|":                      CanDrSW = False
       If .Range("V1") <> "|fffd||6fc||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||6f3||fffd|" Then MsgBox S & "V1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||6f3||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|":      CanDrSW = False
       If .Range("AC1") <> "|fffd||6fc||fffd||4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd|" Then MsgBox S & "AC1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||e8e1|", vbCritical, "|fffd||fffd||2be|":            CanDrSW = False
       If .Range("AF1") <> "|fffd||6fc||fffd||4e6||fffd||fffd||2f0||fffd||fffd|" Then MsgBox S & "AF1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||4e6||fffd||fffd||2f0||fffd||e8e1|", vbCritical, "|fffd||fffd||2be|":                    CanDrSW = False
       If .Range("AI1") <> "|fffd||6fc||fffd||fffd||fffd||524||fffd||fffd||2f0||fffd||fffd|" Then MsgBox S & "AI1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||fffd||fffd||524||fffd||fffd||2f0||fffd||e8e1|", vbCritical, "|fffd||fffd||2be|":                CanDrSW = False
       If .Range("AJ1") <> "|fffd||6fc||fffd||4e6||fffd||fffd|(|fffd||fffd|)|2f0||fffd||fffd|" Then MsgBox S & "AJ1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||6fc||fffd||4e6||fffd||fffd|(|fffd||fffd|)|2f0||fffd||e8e1|", vbCritical, "|fffd||fffd||2be|":            CanDrSW = False
       
       S = .Range("F2")  '|2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b9|
       If S <> "" Then
         If Month(CDate(S)) <> ThisYF Then MsgBox "|fffd||fffd||1f0||461||fffd||fffd||fffd||fffd||b7||fffd||3aa|" & ComboBox1.Text & "|fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||435||13d||fffd||5b9||fffd||b7||fffd||3aa|" & CStr(Month(CDate(S))) & "|fffd||a3||fffd||fffd||fffd||fffd||fffd||2b1||fffd||4cbb||4bb||fffd||a3||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||fffd|6|fffd||fffd||5e8||fffd||ee3d||fffd||4ff||6f3||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||e863|", vbInformation, "|fffd||fffd||2be|": CanDrSW = False
       End If
    End With
  End If
  
  If CanDrSW Then
    '|fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||763||fffd|
     Dim FileOpened As Boolean, JGfile As String, WDRcount As Long
     JGfile = W.Path + "\" + "temp.txt"
     Open JGfile For Output As #1: FileOpened = True
    
     With SHhz
         For H = 2 To SH.UsedRange.Rows.Count
             S = SH.Range("D" & H)
             If DIC.Exists(S) = False Then  '|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||6b5||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fb||fffd||fffd|
                WDRcount = WDRcount + 1
                Print #1, "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||531||fffd||fffd|" & SH.Range("B" & H) & "|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||3aa||fffd||fffd|" & S & "|fffd||fffd||fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fb||fffd||434||fffd||fffd||2e1||fffd|"
             Else
                DC_Row = DIC(S)
               .Range("R" & DC_Row) = Val(SH.Range("V" & H))
               .Range("S" & DC_Row) = Val(SH.Range("W" & H))
               .Range("T" & DC_Row) = Val(SH.Range("X" & H))
               .Range("U" & DC_Row) = Val(SH.Range("Y" & H))
               .Range("V" & DC_Row) = Val(SH.Range("Z" & H))
               .Range("AA" & DC_Row) = Val(SH.Range("AF" & H))
               .Range("AD" & DC_Row) = Val(SH.Range("AI" & H))
               .Range("AG" & DC_Row) = Val(SH.Range("AJ" & H))
             End If
         Next
     End With
     Close #1
  End If
  If Not W2 Is Nothing Then W2.Close False


  With SHhz
        '|237||fffd||fffd||fffd||3fc||fffd||fffd||fffd||fffd||43a||163||fffd|
        DC_Row = DicHZ.Count + 1 + 1 ' DC_Row|fffd||fffd||fffd||fffd||fffd||3fc||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd|+1|fffd||fffd||fffd||fffd||3aa||fffd||1fa||3fc||fffd||fffd||fffd|
       .Range("B1:AH" & DC_Row).Borders.LineStyle = xlContinuous
       .Range("AB1:AB" & DC_Row).Interior.ColorIndex = 34
       .Range("AE1:AE" & DC_Row).Interior.ColorIndex = 34
       .Range("AH1:AH" & DC_Row).Interior.ColorIndex = 34

        
       '|fffd||fffd||fffd||b8||fffd||fffd||1b9||fffd||2bd||fffd||fffd|
       .Range("X2").AutoFill Destination:=.Range("X2:X" & DC_Row - 1)
       .Range("Z2").AutoFill Destination:=.Range("Z2:Z" & DC_Row - 1)
       .Range("AB2").AutoFill Destination:=.Range("AB2:AB" & DC_Row - 1)
       .Range("AF2").AutoFill Destination:=.Range("AF2:AF" & DC_Row - 1)
       .Range("AH2").AutoFill Destination:=.Range("AH2:AH" & DC_Row - 1)
       '|fffd||fffd||fffd||27a||3fc||fffd||fffd||fffd|
       .Range("B" & DC_Row) = "|fffd||fffd|   |fffd||fffd|"
       .Range("D" & DC_Row).Formula = "=SUM(D2:D" & CStr(DC_Row - 1) & ")"
       .Range("D" & DC_Row).AutoFill Destination:=.Range("D" & DC_Row & ":AH" & DC_Row)
       .Range("B" & DC_Row & ":AH" & DC_Row).Interior.ColorIndex = 24
  End With

    Application.ScreenUpdating = True
  
    S = ComboBox1.Text
    W1.SaveAs W.Path & "\" & S & "|fffd||fffd||2f0||fffd||fffd||fffd||77a||2f6||531||fffd|.xls", xlExcel8
    Unload Me
    
    MsgBox "|fffd||47e||fffd||fffd||fffd||fffd||278||fffd||2f0||fffd||fffd||fffd||77a||2f6||531||fffd||fffd||fffd|" & IIf(CanDrSW, "", vbCrLf & vbCrLf & "|fffd||fffd||fffd||fffd||3b4||fffd||fffd||461||fffd||fffd||fffd||fffd||237||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||3b4||fffd||735||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd||5a7||fffd||fffd||fffd||fffd|6|fffd||fffd||5e8||fffd||ee3d||fffd||4ff||6f3||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||e863|"), vbInformation, "|fffd||fffd||2be|"
    
    W1.Activate
    W1.Sheets(1).Activate
    
     If WDRcount > 0 Then
          MsgBox "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd|" & WDRcount & "|fffd||2e3||fffd||fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fb||fffd||423||fffd||3b4||fffd||735||fffd||fffd||fffd||fffd||fffd||429||531||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||761||fffd|", vbInformation, "|fffd||fffd||2be|"
          Shell "notepad.exe " + JGfile, vbNormalFocus
    End If

    
    Set DIC = Nothing: Set DicHZ = Nothing
    Set SH = Nothing: Set SH1 = Nothing
    Set W = Nothing: Set W2 = Nothing: Set W2 = Nothing
  
AA:    ErrSub:  If FileOpened = True Then Close #1
End Sub



Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "oBM, 5, 0, MSForms, ComboBox"
Attribute VB_Control = "oGZB, 4, 1, MSForms, ComboBox"
Attribute VB_Control = "oXM, 1, 2, MSForms, ComboBox"
Option Explicit

Private Sub oBM_Click()
On Error GoTo AA:
  Dim S As String
  Dim I, HJ As Long
  
  S = oGZB.Text
  If oGZB.ListCount = 0 Then Exit Sub
  If HasSheet(S) = False Then Exit Sub
  
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  
  HJ = HJH(Sheets(S))
  
  Dim Str As String, sBM As String
  Dim X As Long

  Range("D4:D50,F4:F50,H4:H50").ClearContents

  X = -1
  sBM = oBM.Text
  With oXM
       Str = .Text
      .Clear
       For I = 6 To HJ - 1
           With Sheets(S)
             If sBM = "" Then
                oXM.AddItem .Cells(I, 2).Value
             Else
                If .Cells(I, 5).Value = sBM Then oXM.AddItem .Cells(I, 2).Value
             End If
           End With
       Next I
      
       If Str <> "" Then
          For I = 0 To .ListCount - 1
              If Str = .List(I) Then X = I: Exit For
          Next I
       End If
       If X > -1 Then .ListIndex = X
       
  End With
  SheetProtect

AA: ErrSub

End Sub


Private Sub oGZB_Click()
 On Error GoTo AA:
  Dim S As String
  Dim I, HJ As Long
  
  S = oGZB.Text
  If oGZB.ListCount = 0 Then Exit Sub
  If HasSheet(S) = False Then Exit Sub
  
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  
  HJ = HJH(Sheets(S))
  
  Dim Str As String
  Dim X As Long

  Range("D4:D50,F4:F50,H4:H50").ClearContents

  X = -1
  With oXM
       Str = .Text
       .Clear
       For I = 6 To HJ - 1
           .AddItem Sheets(S).Cells(I, 2).Value
       Next I
      
       If Str <> "" Then
          For I = 0 To .ListCount - 1
              If Str = .List(I) Then X = I: Exit For
          Next I
       End If
       If X > -1 Then .ListIndex = X
  End With
  oBM.ListIndex = 0
  SheetProtect

AA: ErrSub
End Sub

Private Sub oXM_Click()
 On Error GoTo AA:
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"

 Dim H As Long
 
 H = ZGH(oXM.Text, Sheets(oGZB.Text))
 If H = 0 Then Exit Sub
 
 Cells(4, 4) = Sheets(oGZB.Text).Cells(H, 4) '|fffd||fffd||2be||fffd||2ba||fffd|
 Cells(4, 6) = Sheets(oGZB.Text).Cells(H, 3) '|fffd||fffd||2be||fffd||fffd||fffd||77a||fffd|
 Cells(4, 8) = Sheets(oGZB.Text).Cells(H, 5) '|fffd||fffd||2be||fffd||fffd||fffd||fffd|
 
 Dim LastRow As Long
 
 
 Dim Rx As Range
 Dim L As Long
 Dim S As String
 For Each Rx In Intersect(ActiveSheet.UsedRange, ActiveSheet.Columns(7))
     If Rx.Value = "|2b5||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        LastRow = Rx.Row
        Exit For
     End If
 Next
 If LastRow = 0 Then Exit Sub
 
 For Each Rx In Union(Range("D5:D" + CStr(LastRow)), Range("F5:F" + CStr(LastRow)), Range("H5:H" + CStr(LastRow)))
     S = Rx.Offset(0, -1).Value
     If S <> "" Then
        L = KXL(S, Sheets(oGZB.Text))
        If L > 0 Then Rx.Value = Sheets(oGZB.Text).Cells(H, L)
     End If
 Next
  SheetProtect

AA:
ErrSub
End Sub

Private Sub Worksheet_Activate()
  On Error GoTo AA:
  WBcheck
  If HLSJ = False Then SheetActiveEvent
AA: ErrSub
End Sub

Sub SheetActiveEvent()
 Dim I As Long
 Dim Str As String
 Dim X As Long
 Dim B As DocumentProperty
 
 
 Application.ScreenUpdating = False
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 
 Set B = ActiveWorkbook.BuiltinDocumentProperties.Item("Company")
 If B.Value = "Microsoft" Or B.Value = "" Then
    For I = 1 To Sheets.Count - 2
        If IsGZB(Sheets(I)) = True Then B.Value = Sheets(I).Cells(1, 1).Value: Exit For
    Next I
 End If
 Cells(2, 3) = B.Value
 
 Cells(3, 4).Locked = False
 Cells(3, 6).Locked = False
 Cells(3, 8).Locked = False

 X = -1
 With oGZB
      Str = .Text
      .Clear
      For I = 1 To Sheets.Count - 2
          If IsGZB(Sheets(I)) = True Then .AddItem Sheets(I).Name
      Next I
      
      If Str <> "" Then
         For I = 0 To .ListCount - 1
             If Str = .List(I) Then
                X = I
                Exit For
             End If
         Next I
      End If
      If X > -1 Then .ListIndex = X
 End With
 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||fffd||fffd||13f|
 
 Dim H, TyfH, TkkH, L As Long
 TyfH = Int((UBound(YFarray) - 1) / 3) + 1
 TkkH = Int((UBound(KKarray) - 1) / 3) + 1
 
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 Rows("5:50").Delete

 For I = 1 To UBound(YFarray) - 1
     H = Int((I - 1) / 3) + 5
     L = ((I - 1) Mod 3) * 2 + 3
     Cells(H, L) = YFarray(I)
 Next I
 
 Cells(TyfH + 5, 7) = "|4e6||fffd||fffd||421||fffd||fffd|"
 Cells(TyfH + 5, 7).Font.Bold = True
 Cells(TyfH + 5, 8).Font.Bold = True
 
 For I = 1 To UBound(KKarray) - 1
     H = Int((I - 1) / 3) + 5 + TyfH + 1
     L = ((I - 1) Mod 3) * 2 + 3
     Cells(H, L) = KKarray(I)
 Next I
 
 Cells(TyfH + 5 + TkkH + 1, 7) = "|fffd||6ff||fffd||421||fffd||fffd|"
 Cells(TyfH + 5 + TkkH + 1, 7).Font.Bold = True
 Cells(TyfH + 5 + TkkH + 1, 8).Font.Bold = True
 
 Cells(TyfH + 5 + TkkH + 2, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 Cells(TyfH + 5 + TkkH + 3, 7) = "|2b5||fffd||fffd||fffd||fffd||fffd||fffd|"
 Cells(TyfH + 5 + TkkH + 3, 7).Font.Bold = True
 Cells(TyfH + 5 + TkkH + 3, 8).Font.Bold = True
 
 Dim LH As Long
 LH = TyfH + 5 + TkkH + 3
 Range("C5:C" + CStr(LH) + "," + "E5:E" + CStr(LH) + "," + "G5:G" + CStr(LH)).Interior.ColorIndex = 24
 Range("D5:D" + CStr(LH) + "," + "F5:F" + CStr(LH) + "," + "H5:H" + CStr(LH)).Interior.ColorIndex = 20
 Range("B2:I" + CStr(LH + 1)).BorderAround LineStyle:=xlDouble, ColorIndex:=15, Weight:=xlThick
 SheetProtect

  oBM.Clear
  oBM.AddItem ""
  '|4aa||fffd||173||fffd| |5e8||fffd||fffd|_  |fffd||fffd||377||fffd||137||1f2||fffd||fffd||fffd||fffd||fffd||fffd||1b5||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd|
  For Each B In ActiveWorkbook.CustomDocumentProperties
      If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then oBM.AddItem B.Name
  Next B

 oGZB_Click

 Application.ScreenUpdating = True
End Sub

Private Sub Worksheet_Deactivate()  '|fffd||fffd||fffd||fffd||fffd||536||fffd||fffd||fffd||fffd||639||fffd||fffd||2b5||fffd|
 On Error GoTo AA:
  WBcheck
  ThisWorkbook.Unprotect
  Sheets("|fffd||fffd||fffd||2b5||fffd|").Visible = xlSheetHidden
 ThisWorkbook.Protect Structure:=True
AA: ErrSub
End Sub

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "TAX_|fffd||fffd||363||fffd||fffd|"
Attribute VB_Base = "0{7DAD489E-A32E-481A-A905-605259A78F4B}{78D87E19-FD3D-4C26-BC57-D4A1EA631219}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Option Explicit

Private Sub CheckBox1_Click()
  OptionButton2.Value = True
End Sub

Private Sub CommandButton1_Click()
 On Error GoTo AA:
  SS.Text = "+":  SS.SelStart = 0:    SS.SelLength = SS.TextLength
  SS.Copy
  BDS.Paste
AA:  ErrSub
End Sub

Private Sub CommandButton2_Click()
 On Error GoTo AA:
  SS.Text = "-":  SS.SelStart = 0:    SS.SelLength = SS.TextLength
  SS.Copy
  BDS.Paste
AA:  ErrSub
End Sub

Private Sub CommandButton3_Click()
 On Error GoTo AA:
  If L1.ListIndex < 0 Then L1.ListIndex = 0
  SS.Text = L1.List(L1.ListIndex):   SS.SelStart = 0:    SS.SelLength = SS.TextLength
  SS.Copy
  BDS.Paste
AA:  ErrSub
End Sub

Private Sub CommandButton4_Click()
  BDS.Text = "|4e6||fffd||fffd||421||fffd||fffd|-|fffd||fffd||fffd||3f1||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|-|4bd||fffd||1b1||fffd||fffd||fffd|-|2a7||4b5||fffd||fffd||fffd||fffd|-|fffd||fffd||4b5||fffd||fffd||fffd|"
  GSJS.Text = "5000"
  OptionButton1.Value = True
  MaxGJJ.Visible = False
  Label4.Visible = False
  
  CheckBox1.Value = False
  
  OptionButton3.Value = True
  MaxQYNJ.Visible = False
  Label5.Visible = False
End Sub

Private Sub CommandButton5_Click()
 On Error GoTo AA:
  
 Dim S As String, SL As String, DZ As String, HZ As String, hasXM As Boolean
 Dim I As Long, J As Long, Last As Long
 
 If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
 
 S = Trim(BDS.Text)
 If Right(S, 1) = "+" Or Right(S, 1) = "-" Then S = Left(S, Len(S) - 1)
 
 If InStr(S, "++") > 0 Or InStr(S, "+-") > 0 Or InStr(S, "-+") > 0 Or InStr(S, "--") > 0 Then MsgBox "|fffd||fffd||fffd||fffd||2bd||fffd||fffd||5a7||fffd||5b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||13c||4fc||fffd||fffd||fffd||fffd||38e1||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": BDS.SetFocus
  
 If Trim(MaxGJJ.Text) = "" Then OptionButton1.Value = True
  
 '|423||fffd||9e6b||2bd||fffd||fffd|
 S = S + "+" '+|fffd||fffd||fffd||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f|
 Last = 1
 For I = 1 To Len(S)
    If Mid(S, I, 1) = "+" Or Mid(S, I, 1) = "-" Then
       HZ = Mid(S, Last, I - Last)
       hasXM = False
       For J = 5 To KKXJL - 2
          If Cells(5, J).Value = HZ Then
             hasXM = True
             SL = Columns(J).Address(False, False)
             DZ = DZ + Left(SL, InStr(SL, ":") - 1) + Mid(S, I, 1)
             Exit For
          End If
       Next J
       Last = I + 1
       If hasXM = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||6a1||fffd|" + HZ + "|fffd||fffd||fffd||fffd|" + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd||3f8||fffd||2f6||539||fffd||2bd||fffd||fffd|", vbCritical, "|fffd||fffd||2bd||fffd||fffd||fffd||f4||fffd||fffd||fffd|": BDS.SetFocus: Exit Sub
    End If
 Next I
 
 '|5ea||fffd||fffd||fffd||271||fffd||5fc||fffd||fffd||2bd||fffd||fffd|
 I = MsgBox("|237||2b5||4aa||fffd||535||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||138||fffd||2f0||fffd||fffd||2bd||fffd||fffd||fffd||435||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo + vbDefaultButton2, "|fffd||fffd||2be|")
 If I = vbNo Then Unload Me: Exit Sub
 
 Dim GSL As Long, gjjL As Long, qynjL As Long, MaxH As Long, DZx As String
 
 ActiveSheet.Unprotect "gzglxt"
 gjjL = KXL("|fffd||fffd||fffd||fffd||fffd||fffd|"): GSL = KXL("|fffd||fffd||2f0|"): MaxH = HJH
 qynjL = KXL("|fffd||fffd||4b5||fffd||fffd||fffd|")

 For J = 6 To MaxH - 1
   Last = 1
   DZx = ""
   For I = 1 To Len(DZ)
     If Mid(DZ, I, 1) = "+" Or Mid(DZ, I, 1) = "-" Then
        DZx = DZx + Mid(DZ, Last, I - Last) + CStr(J) + Mid(DZ, I, 1)
        Last = I + 1
     End If
   Next I
   DZx = Left(DZx, Len(DZx) - 1) '|225||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|+|fffd||fffd|
   
   '|fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7a3||fffd|
   Dim sQYgjj As String
   If CheckBox1.Value = True Then sQYgjj = "TRUE" Else sQYgjj = "FALSE"
   
   If OptionButton2.Value = True Then
      S = Columns(gjjL).Address(False, False)
      S = Left(S, InStr(S, ":") - 1) + CStr(J)
      DZx = Replace(DZx, S, "tgjj(" + S + "," + CStr(Val(MaxGJJ)) + "," + sQYgjj + ")")    '|fffd||fffd||fffd||78fa|tgjj(L6,1500,TRUE)
   End If
   
      '|fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7a3||fffd|
   If OptionButton4.Value = True Then
      S = Columns(qynjL).Address(False, False)
      S = Left(S, InStr(S, ":") - 1) + CStr(J)
      DZx = Replace(DZx, S, "IF(" + S + ">=" + CStr(Val(MaxQYNJ)) + "," + CStr(Val(MaxQYNJ)) + "," + S + ")")  '|fffd||fffd||fffd||78fa|IF(L6>=1000,1000,L6)
   End If
   
   Cells(J, GSL).Formula = "=gs(" + DZx + "," + CStr(Val(GSJS)) + ")"
 Next J
 Unload Me
 SheetProtect
AA:  ErrSub
End Sub

Private Sub CommandButton6_Click()
  Unload Me
End Sub

Private Sub CommandButton7_Click()
 Dim S As String
 S = "|fffd||fffd||2f0||4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd||12c||fffd||3f1||fffd||fffd||fffd||2bd||3aa||fffd||fffd|" + vbCrLf + vbCrLf
 S = S + "|4e6||fffd||fffd||421||fffd||fffd|-|fffd||fffd||fffd||3f1||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|-|4bd||fffd||1b1||fffd||fffd||fffd|-|2a7||4b5||fffd||fffd||fffd||fffd|" + vbCrLf + vbCrLf
 S = S + "|fffd||631||fffd||fffd||fffd||fffd||463||fffd|" + vbCrLf + vbCrLf
 S = S + "|fffd||f1||fffd||fffd||fffd||2bd||fffd||fffd||5a7||fffd||5b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||13c||4fc||fffd||fffd||fffd||fffd||38e1|" + vbCrLf + vbCrLf
 S = S + "|fffd||6bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||2b1||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b9||fffd||2bd||fffd||fffd|" + vbCrLf + vbCrLf + " =gs(|4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||e8ec||fffd||6f3||fffd||fffd||fffd||fffd||fffd|)" + vbCrLf + vbCrLf
 S = S + "|fffd||fffd||fffd||423||fffd|" + vbCrLf + vbCrLf
 S = S + "gs|fffd||fffd||fffd||fffd||fffd||fffd||fffd||536||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||3eaf||fffd||fffd||fffd||fffd||fffd||fffd|9|fffd||fffd||2f0||fffd||2bd||fffd||fffd||43c||fffd||fffd||3863|" + vbCrLf + vbCrLf
 
 MsgBox S, vbInformation, "|fffd||fffd||2be|"
End Sub


Private Sub Frame3_Click()

End Sub

Private Sub GSJS_Change()
  If IsNumeric(GSJS.Text) = False Then GSJS.Text = CStr(Val(GSJS.Text))
End Sub

Private Sub L1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
 CommandButton3_Click
End Sub

Private Sub MaxGJJ_Change()
  If IsNumeric(MaxGJJ.Text) = False Then MaxGJJ.Text = CStr(Val(MaxGJJ.Text))
End Sub

Private Sub MaxQYNJ_Change()
  If IsNumeric(MaxQYNJ.Text) = False Then MaxQYNJ.Text = CStr(Val(MaxQYNJ.Text))
End Sub

Private Sub OptionButton1_Click()
  MaxGJJ.Visible = False
  Label4.Visible = False
  CheckBox1.Value = False
  OptionButton1.Value = True
End Sub

Private Sub OptionButton2_Click()
  MaxGJJ.Visible = True
  Label4.Visible = True
  MaxGJJ.SetFocus
End Sub

Private Sub OptionButton3_Click()
  MaxQYNJ.Visible = False
  Label5.Visible = False
End Sub

Private Sub OptionButton4_Click()
  MaxQYNJ.Visible = True
  Label5.Visible = True
  MaxQYNJ.SetFocus
End Sub

Private Sub UserForm_Initialize()
  On Error GoTo AA:
  
  Dim S As String, GSGS As String, gjjL As Long, qynjL As Long
  
  '|fffd||fffd||2f0||fffd||6f3||fffd||fffd||fffd||fffd||fffd|
  Dim JSw1 As Long, JSw As Long, JSm As Long
  S = Cells(6, KXL("|fffd||fffd||2f0|")).Formula   '|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b8||fffd||fffd||4f9||fffd||2bd|  =gs(H6-I6-IF(J6>=1800,1800,J6)-K6-L6,1600)
  
 '|fffd||fffd||fffd||4f9||fffd||fffd||fffd||fffd||fffd||13f|
  Dim I As Long, Last As Long, HZ As String
  L1.Clear
  For I = 6 To KKXJL - 2  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|,|fffd||2b4||fffd|5|fffd||fffd||3aa|6
      L1.AddItem Cells(5, I).Value
  Next I
  
  If Left(S, 1) <> "=" Then Exit Sub
  
  GSGS = S
  
  Dim Str As String
  JSw = InStrRev(S, ",")
  If JSw = 0 Then JSm = 5000 Else JSm = Val(Mid(S, JSw + 1, Len(S) - JSw))
  GSJS.Text = CStr(JSm)
 
  
  Dim sXM As Currency
  Dim sQYgjj As String
  sXM = 0
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  gjjL = KXL("|fffd||fffd||fffd||fffd||fffd||fffd|")
  Str = Cells(6, gjjL).Address(False, False)
  If InStr(S, Str) > 0 Then
     S = Mid(S, InStr(S, Str), InStr(S, ")") - InStr(S, Str) + 1)
     S = Right(S, Len(S) - InStr(S, ","))
     If InStr(S, ",") >= 1 Then sXM = Val(Left(S, InStr(S, ",") - 1))
        
     CheckBox1.Value = False
     sQYgjj = "FALSE"
     If Right(LCase(S), 5) = "true)" Then CheckBox1.Value = True: sQYgjj = "TRUE"
     If Right(LCase(S), 6) = "false)" Then CheckBox1.Value = False: sQYgjj = "FALSE"
 End If
        
  If sXM > 0 Then
    OptionButton2.Value = True: MaxGJJ.Visible = True: Label4.Visible = True: MaxGJJ.Text = CStr(sXM)
    If InStr(LCase(GSGS), "tgjj") = 0 Then
       S = "IF(" + Str + ">=" + CStr(sXM) + "," + CStr(sXM) + "," + Str + ")"  '|fffd||270||6e6b||fffd||fffd||fffd||fffd||2bd|
    Else
       S = "tgjj(" + Str + "," + CStr(sXM) + "," + sQYgjj + ")"   '|fffd||b0||6e6b||fffd||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd||fffd||78fa|tgjj(L6,1500,TRUE)
    End If
    GSGS = Replace(GSGS, S, Cells(6, gjjL).Address(False, False))
 End If
    
   '|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  qynjL = KXL("|fffd||fffd||4b5||fffd||fffd||fffd|")
  Str = Cells(6, qynjL).Address(False, False)
   sXM = 0
   S = GSGS
  If InStr(S, Str) > 0 Then
     If InStr(UCase(S), "IF(" & Str) > 0 Then
        S = Mid(S, InStr(S, Str), InStr(S, ")") - InStr(S, Str) + 1)
        S = Right(S, Len(S) - InStr(S, ","))
        If InStr(S, ",") >= 1 Then sXM = Val(Left(S, InStr(S, ",") - 1))
     End If
  End If
  If sXM > 0 Then
    OptionButton4.Value = True: MaxQYNJ.Visible = True: Label5.Visible = True: MaxQYNJ.Text = CStr(sXM)
    S = "IF(" + Str + ">=" + CStr(sXM) + "," + CStr(sXM) + "," + Str + ")"
     GSGS = Replace(GSGS, S, Cells(6, qynjL).Address(False, False))
 End If
   
 
  '|5ea||fffd||fffd||fffd||27a||fffd||fffd||5b9||fffd||2bd|
  GSGS = Mid(GSGS, 5, InStr(GSGS, ",") - 5)
  Last = 1
  GSGS = GSGS + "+"
  For I = 1 To Len(GSGS)
    If Mid(GSGS, I, 1) = "+" Or Mid(GSGS, I, 1) = "-" Then
       S = Mid(GSGS, Last, I - Last)
       HZ = HZ + Range(S).Offset(-1, 0).Value + Mid(GSGS, I, 1)
       Last = I + 1
    End If
  Next I
  BDS.Text = Left(HZ, Len(HZ) - 1)   '|225||fffd||fffd||fffd||fffd||fffd||4b1||7f5||fffd|+|fffd||fffd|
  

AA: ErrSub
End Sub
Attribute VB_Name = "TAXexport"
Attribute VB_Base = "0{5F9CD1FE-5BCE-4B10-A34B-510E7D05BBEF}{0C757E9D-149A-41C7-BDA6-127C537E7810}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton5_Click()
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
   
   Dim W As Workbook, W1 As Workbook
   Dim SH As Worksheet, SH_Base As Worksheet, SH1 As Worksheet, SH2 As Worksheet, SHx As Worksheet
   Dim I As Long, S As String, SFZts As String, strBaseYF As String, XH As Long
   
   Set W = ActiveWorkbook
   Set SH = ActiveSheet
   
   Dim Path As String
   Path = ThisWorkbook.Path

   Dim gzHJH As Long
   
   
    Dim YF As Long
    S = Cells(2, 1).Value
    YF = Val(Mid(S, 6, InStr(S, "|fffd||b7||fffd|") - 6))
    
    strBaseYF = Left(SH.Name, InStr(SH.Name, "|fffd||b7||fffd|") - 1) + "|fffd||b7||fffd|"
    Set SH_Base = Sheets(strBaseYF)

   
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd|
   For XH = 1 To Sheets.Count
       Set SHx = Sheets(XH)
       If IsGZB(SHx) And Left(SHx.Name, Len(strBaseYF)) = strBaseYF And Right(SHx.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then '|fffd||fffd||fffd||fffd||fffd||7b3||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd|
          gzHJH = HJH(SHx)
          For I = 6 To gzHJH - 1
              S = Trim(SHx.Cells(I, 3))
              If S = "" Then MsgBox "|fffd||fffd|" & SHx.Name & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd|" & CStr(I) & "|fffd||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
              SFZts = SFZJY(S)
              If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|fffd||fffd|" & SHx.Name & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd|" & CStr(I) & "|fffd||435||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3aa|" & S & "|fffd||fffd|" & vbCrLf & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|":    Exit Sub
          Next I
       End If
   Next XH
   Set SHx = Nothing
   

    If Val(Trim(MaxGJJ.Text)) <= 0 Then If MsgBox("|2f0||fffd||fffd||fffd||3f6||538||fffd||fffd||2fd||fffd||fffd||275||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43f||6f3||fffd||fffd||fffd||fffd||7b5||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo) <> vbYes Then Exit Sub
    If Val(Trim(MaxNJ.Text)) <= 0 Then If MsgBox("|2f0||fffd||fffd||fffd||3f6||538||fffd||fffd||2fd||fffd||fffd||275||fffd||fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||43f||6f3||fffd||fffd||fffd||fffd||7b5||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo) <> vbYes Then Exit Sub
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd| HLTS:=True
    
    
    
    '|fffd||fffd||fffd||275||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set W1 = Application.Workbooks.Add
    
    Application.DisplayAlerts = False
    If W1.Sheets.Count > 1 Then W1.Sheets(W1.Sheets.Count).Delete
    If W1.Sheets.Count > 1 Then W1.Sheets(W1.Sheets.Count).Delete
    Application.DisplayAlerts = True
    
    ActiveWindow.DisplayGridlines = False
    Set SH1 = W1.ActiveSheet
    With SH1
     .Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43d||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C1").Value = "*|5a4||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("D1").Value = "*|5a4||fffd||57a||fffd||fffd||fffd|"
     .Range("E1").Value = "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("F1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd|"
     .Range("G1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||577||fffd|"
     .Range("H1").Value = "|fffd||fffd||fffd||fffd||4bd||fffd||1b1||fffd||fffd||577||fffd|"
     .Range("I1").Value = "|2a7||4b5||fffd||fffd||fffd||577||fffd|"
     .Range("J1").Value = "|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("K1").Value = "|fffd||6fc||fffd||fffd||fffd||16e||fffd||fffd||fffd||fffd|"
     .Range("L1").Value = "|fffd||6fc||1bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("M1").Value = "|fffd||6fc||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2|"
     .Range("N1").Value = "|fffd||6fc||fffd||5e1||fffd||fffd||fffd||fffd||fffd|"
     .Range("O1").Value = "|fffd||6fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("P1").Value = "|fffd||fffd||4b5|(|5b0||4b5|)|fffd||fffd||fffd|"
     .Range("Q1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("R1").Value = "|2f0||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd|"
     .Range("S1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("T1").Value = "|5fc||fffd||fffd||6f3||fffd||fffd||13e||fffd||fffd||fffd||fffd||fffd|"
     .Range("U1").Value = "|fffd||fffd||fffd||fffd||2f0||fffd||fffd|"
     .Range("V1").Value = "|fffd||fffd||5e2|"
     .Columns("A:P").ColumnWidth = 15
     .Columns(4).ColumnWidth = 20
     .Columns(6).Hidden = True
     .Columns("E:V").NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
     .Columns("K:O").EntireColumn.Hidden = True
     .Columns("Q:V").EntireColumn.Hidden = True
     
      ActiveWindow.SplitRow = 1
      ActiveWindow.FreezePanes = True
    End With
    
    Set SH2 = W1.Sheets.Add(After:=W1.Sheets(1))
    ActiveWindow.DisplayGridlines = False
    With SH2
     .Name = "|fffd||fffd||fffd||fffd||2f5||fffd||fffd|"
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C1").Value = "*|5a4||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("D1").Value = "*|5a4||fffd||57a||fffd||fffd||fffd|"
     .Range("F1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("G1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("H1").Value = "|fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("I1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||5b3||fffd||fffd||fffd||fffd||fffd|"
     .Range("J1").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7bc||4fc||fffd||fffd||fffd||fffd||fffd|"
     .Range("K1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd|"
     .Range("L1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("M1").Value = "|fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||4b5||fffd||fffd||fffd|"
     .Range("N1").Value = "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("O1").Formula = "|4e6||fffd||fffd||421||fffd||fffd|"

     .Range("H2").Formula = "=IF(G2=0,F2,MIN(F2,G2))"
     .Range("J2").Formula = "=IF(I2=""|fffd||fffd|"",F2-H2,0)"
     .Range("M2").Formula = "=IF(L2=0,K2,MIN(K2,L2))"
     .Range("N2").Formula = "=J2+O2"
     
     .Columns("A:N").ColumnWidth = 10
     .Columns(4).ColumnWidth = 20
     .Columns(5).Hidden = True
     .Columns("O:AO").ColumnWidth = 10
     .Columns("E:AO").NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
     .Range("G1:N1").WrapText = True
     .Rows(1).RowHeight = 42
     
      ActiveWindow.SplitRow = 1
      ActiveWindow.SplitColumn = 4
      ActiveWindow.FreezePanes = True
    End With
    
    
    '|fffd||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|
    Dim VmaxGJJ As Currency: VmaxGJJ = Val(Trim(MaxGJJ.Text))
    Dim VmaxNJ As Currency: VmaxNJ = Val(Trim(MaxNJ.Text))
    Dim IsQYGJJR As String: If ChkQYGJJ.Value = True Then IsQYGJJR = "|fffd||fffd|" Else IsQYGJJR = ""
    
    Dim ColYFXJ As Long: ColYFXJ = YFXJL(SH_Base)
    Dim ColGJJ As Long: ColGJJ = KXL("|fffd||fffd||fffd||fffd||fffd||fffd|", SH_Base)
    Dim ColQYNJ As Long: ColQYNJ = KXL("|fffd||fffd||4b5||fffd||fffd||fffd|", SH_Base)
    Dim colYLBX As Long: colYLBX = KXL("|fffd||fffd||fffd||3f1||fffd||fffd||fffd|", SH_Base)
    Dim colYL As Long: colYL = KXL("|4bd||fffd||1b1||fffd||fffd||fffd|", SH_Base)
    Dim colSY As Long: colSY = KXL("|2a7||4b5||fffd||fffd||fffd||fffd|", SH_Base)
    
    Dim DIC
    Set DIC = CreateObject("scripting.dictionary")
    
    With SH_Base
    
         gzHJH = HJH(SH_Base)
          
         For I = 6 To gzHJH - 1
             SH1.Range("A" & I - 4) = "'" & .Range("A" & I)
             SH2.Range("A" & I - 4) = "'" & .Range("A" & I)
             
             SH1.Range("B" & I - 4) = "'" & .Range("B" & I)
             SH2.Range("B" & I - 4) = "'" & .Range("B" & I)
             
             SH1.Range("C" & I - 4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4|"
             SH2.Range("C" & I - 4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4|"
             
             S = .Range("C" & I)
             SH1.Range("D" & I - 4) = "'" & S
             SH2.Range("D" & I - 4) = "'" & S
             DIC(S) = I - 4
             
             SH2.Range("O" & I - 4) = .Cells(I, ColYFXJ).Value
             SH2.Range("F" & I - 4) = Val(.Cells(I, ColGJJ))
             SH2.Range("G" & I - 4) = VmaxGJJ
             SH2.Range("I" & I - 4) = IsQYGJJR
             SH2.Range("K" & I - 4) = Val(.Cells(I, ColQYNJ))
             SH2.Range("L" & I - 4) = VmaxNJ
             
             SH1.Range("G" & I - 4) = .Cells(I, colYLBX)
             SH1.Range("H" & I - 4) = .Cells(I, colYL)
             SH1.Range("I" & I - 4) = .Cells(I, colSY)
         Next I
    End With
    
    
    
    Dim DC_Row As Long
    For XH = 1 To W.Sheets.Count
       Set SHx = W.Sheets(XH)
       If IsGZB(SHx) And Left(SHx.Name, Len(strBaseYF)) = strBaseYF And Right(SHx.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then '|fffd||fffd||fffd||fffd||fffd||7b3||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd|
          If SHx.Name <> strBaseYF Then  '|fffd||173||fffd||fffd||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||175||fffd||fffd||fffd||fffd|
             gzHJH = HJH(SHx)
             ColYFXJ = YFXJL(SHx)
             ColGJJ = KXL("|fffd||fffd||fffd||fffd||fffd||fffd|", SHx)
             ColQYNJ = KXL("|fffd||fffd||4b5||fffd||fffd||fffd|", SHx)
             colYLBX = KXL("|fffd||fffd||fffd||3f1||fffd||fffd||fffd|", SHx)
             colYL = KXL("|4bd||fffd||1b1||fffd||fffd||fffd|", SHx)
             colSY = KXL("|2a7||4b5||fffd||fffd||fffd||fffd|", SHx)

             With SHx
               For I = 6 To gzHJH - 1
                 S = SHx.Range("C" & I)
                 If DIC.Exists(S) Then
                    DC_Row = DIC(S)
                    SH1.Range("G" & DC_Row).Value = SH1.Range("G" & DC_Row).Value + .Cells(I, colYLBX).Value
                    SH1.Range("H" & DC_Row).Value = SH1.Range("H" & DC_Row).Value + .Cells(I, colYL).Value
                    SH1.Range("I" & DC_Row).Value = SH1.Range("I" & DC_Row).Value + .Cells(I, colSY).Value
                    
                    SH2.Range("F" & DC_Row).Value = SH2.Range("F" & DC_Row).Value + .Cells(I, ColGJJ).Value
                    SH2.Range("K" & DC_Row).Value = SH2.Range("K" & DC_Row).Value + .Cells(I, ColQYNJ).Value
                    SH2.Range("O" & DC_Row).Value = SH2.Range("O" & DC_Row).Value + .Cells(I, ColYFXJ).Value
                 Else '|fffd||fffd||fffd||b5||fffd||4bb||fffd||3b9||fffd||fffd||2b1||fffd||fffd||fffd||fb||fffd||435||fffd||531||fffd||fffd||fffd||fffd|
                    DC_Row = DIC.Count + 1 + 1 '|fffd||fffd||4bb||fffd||fffd|+1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||6b6||fffd||fffd||fffd|+1|fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    
                    SH1.Range("A" & DC_Row) = "'" & .Range("A" & I)
                    SH2.Range("A" & DC_Row) = "'" & .Range("A" & I)
             
                    SH1.Range("B" & DC_Row) = "'" & .Range("B" & I)
                    SH2.Range("B" & DC_Row) = "'" & .Range("B" & I)
             
                    SH1.Range("C" & DC_Row) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4|"
                    SH2.Range("C" & DC_Row) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4|"
             
                    S = .Range("C" & I)
                    SH1.Range("D" & DC_Row) = "'" & S
                    SH2.Range("D" & DC_Row) = "'" & S
                    DIC(S) = DC_Row
             
                    SH2.Range("O" & DC_Row) = .Cells(I, ColYFXJ).Value
                    SH2.Range("F" & DC_Row) = Val(.Cells(I, ColGJJ))
                    SH2.Range("G" & DC_Row) = VmaxGJJ
                    SH2.Range("I" & DC_Row) = IsQYGJJR
                    SH2.Range("K" & DC_Row) = Val(.Cells(I, ColQYNJ))
                    SH2.Range("L" & DC_Row) = VmaxNJ
             
                    SH1.Range("G" & DC_Row) = .Cells(I, colYLBX)
                    SH1.Range("H" & DC_Row) = .Cells(I, colYL)
                    SH1.Range("I" & DC_Row) = .Cells(I, colSY)
                 End If
               Next I
             End With
          End If
       End If
   Next XH
   Set SHx = Nothing
    
    DC_Row = DIC.Count + 1 '|fffd||fffd||3aa||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    SH2.Range("H2").AutoFill Destination:=SH2.Range("H2:H" & DC_Row)
    SH2.Range("J2").AutoFill Destination:=SH2.Range("J2:J" & DC_Row)
    SH2.Range("M2:N2").AutoFill Destination:=SH2.Range("M2:N" & DC_Row)
    
    SH1.Range("E2").Formula = "=|fffd||fffd||fffd||fffd||2f5||fffd||fffd|!N2"
    SH1.Range("J2").Formula = "=|fffd||fffd||fffd||fffd||2f5||fffd||fffd|!H2"
    SH1.Range("P2").Formula = "=|fffd||fffd||fffd||fffd||2f5||fffd||fffd|!M2"
    SH1.Range("E2").AutoFill Destination:=SH1.Range("E2:E" & DC_Row)
    SH1.Range("J2").AutoFill Destination:=SH1.Range("J2:J" & DC_Row)
    SH1.Range("P2").AutoFill Destination:=SH1.Range("P2:P" & DC_Row)
    
    
    S = SH.Range("A2").Value
    W1.SaveAs Path & "\" & Left(S, InStr(S, "|fffd||fffd|")) & "|fffd||fffd||fffd||fffd||43d||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||6bc||fffd||fffd||fffd||fffd||fffd||ac68||fffd||fffd||2f0|).xls", xlExcel8
    Unload Me
    W1.Activate
    W1.Sheets(1).Activate
    
    Set DIC = Nothing
    Set SH = Nothing: Set SH1 = Nothing: Set SH2 = Nothing: Set SH_Base = Nothing
    
    MsgBox "|fffd||47e||fffd||fffd||fffd||275||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|"
    
AA: ErrSub
End Sub



Private Sub CommandButton6_Click()
  Unload Me
End Sub

Private Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Optional HLTS As Boolean = False)
 On Error GoTo AA:
 If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 
 
 Dim YF As Long, S As String, I As Long
 Dim SZ() As String

 S = Cells(2, 1).Value
 YF = Val(Mid(S, 6, InStr(S, "|fffd||b7||fffd|") - 6))
 
 If HLTS = False Then
    If Val(Trim(MaxGJJ.Text)) <= 0 Then If MsgBox("|2f0||fffd||fffd||fffd||3f6||538||fffd||fffd||2fd||fffd||fffd||275||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7b5||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo) <> vbYes Then Exit Sub
    If Val(Trim(MaxNJ.Text)) <= 0 Then If MsgBox("|2f0||fffd||fffd||fffd||3f6||538||fffd||fffd||2fd||fffd||fffd||275||fffd||fffd||fffd||4b5||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||7b5||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo) <> vbYes Then Exit Sub
 End If
 
 
  Dim P As DocumentProperty, Px As DocumentProperty
 '=============|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
 If Val(MaxGJJ.Text) > 0 Then
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then Set P = Px: Exit For
    Next
    If P Is Nothing Then Set P = ActiveWorkbook.CustomDocumentProperties.Add(Name:="|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LinkToContent:=False, Type:=msoPropertyTypeString, Value:="")
    
    S = "0,0,0,0,0,0,0,0,0,0,0,0"
    If P.Value <> "" Then S = P.Value
    SZ = Split(S, ",")
    SZ(YF - 1) = Trim(MaxGJJ.Text)
    P.Value = Join(SZ, ",")
    Set P = Nothing
  End If
 '=======================================================================
 
   '=============|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then Set P = Px:  Exit For
    Next
    If P Is Nothing Then Set P = ActiveWorkbook.CustomDocumentProperties.Add(Name:="|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LinkToContent:=False, Type:=msoPropertyTypeString, Value:="")
    S = P.Value
    If S <> "" Then
       If InStr(S, ",") = 0 Then S = S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S
    Else
       S = "|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|"
    End If
    SZ = Split(S, ",")
    If ChkQYGJJ.Value Then SZ(YF - 1) = "|fffd||fffd|" Else SZ(YF - 1) = "|fffd||fffd|"
    P.Value = Join(SZ, ",")
    Set P = Nothing
 '=======================================================================

 
  '=============|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
 If Val(MaxNJ.Text) > 0 Then
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then Set P = Px: Exit For
    Next
    If P Is Nothing Then Set P = ActiveWorkbook.CustomDocumentProperties.Add(Name:="|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LinkToContent:=False, Type:=msoPropertyTypeString, Value:="")
    
    S = "0,0,0,0,0,0,0,0,0,0,0,0"
    If P.Value <> "" Then S = P.Value
    SZ = Split(S, ",")
    SZ(YF - 1) = Trim(MaxNJ.Text)
    P.Value = Join(SZ, ",")
    Set P = Nothing
  End If
 '=======================================================================
AA: ErrSub
End Sub




Private Sub UserForm_Initialize()
 On Error GoTo AA:
 Dim YF As Long, S As String
 Dim SZ() As String

 S = Cells(2, 1).Value
 YF = Val(Mid(S, 6, InStr(S, "|fffd||b7||fffd|") - 6))
 
 
  Dim Px As DocumentProperty
 '=============|5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
           If Px.Value <> "" Then
              SZ = Split(Px.Value, ",")
              If Val(SZ(YF - 1)) > 0 Then MaxGJJ.Text = SZ(YF - 1)
           End If
           Exit For
        End If
    Next
 '=======================================================================
 
  '=============|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
    For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
           S = Px.Value
           If S <> "" Then
              If InStr(S, ",") = 0 Then S = S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S & "," & S: Px.Value = S
              SZ = Split(S, ",")
              If SZ(YF - 1) = "|fffd||fffd|" Then ChkQYGJJ.Value = True Else ChkQYGJJ.Value = False
           Else
             ChkQYGJJ.Value = False
           End If
           Exit For
        End If
    Next
 '=======================================================================

 
  '=============|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|==============================================
  For Each Px In ActiveWorkbook.CustomDocumentProperties
        If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
           If Px.Value <> "" Then
              SZ = Split(Px.Value, ",")
              If Val(SZ(YF - 1)) > 0 Then MaxNJ.Text = SZ(YF - 1)
           End If
           Exit For
        End If
    Next
 '=======================================================================
AA: ErrSub
End Sub


Private Sub CommandButton7_Click()
 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Workbook_Activate()
' MenuItemDisplayControl
End Sub
Private Sub Workbook_BeforePrint(Cancel As Boolean)
  On Error GoTo AA:
  Dim I As Long
  WBcheck
  If IsGZB And TaxPrompt <> "" Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + vbCrLf + "|237||2b5||4aa||fffd||fffd||13f||1f0||fffd||fffd||fffd||774||fffd||4e1||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
     If I = vbNo Then Cancel = True
  End If
AA: ErrSub
End Sub

Private Sub Workbook_Deactivate()
 'MenuItemDisplayControl
End Sub

Private Sub Workbook_PivotTableCloseConnection(ByVal Target As PivotTable)

End Sub

Private Sub Workbook_SheetActivate(ByVal SH As Object)
  'MenuItemDisplayControl
End Sub
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
  Dim S As String
  On Error GoTo AA:
  WBcheck
  If ActiveWorkbook.ProtectStructure = False Then ActiveWorkbook.Protect Structure:=True
  
  With Sheets("|fffd||6fa||3f2||fffd||46f|")
    If .Visible = xlSheetVisible Then
       .Cells.ClearContents
       .Cells.ClearOutline
        ThisWorkbook.Unprotect
       .Visible = False
        ThisWorkbook.Protect Structure:=True
    End If
  End With
  
  If ActiveSheet.Name = "|fffd||fffd||fffd||2b5||fffd|" Then
     ThisWorkbook.Unprotect
     Sheets("|fffd||fffd||fffd||2b5||fffd|").Visible = xlSheetHidden
     ThisWorkbook.Protect Structure:=True
  End If
  
  S = Trim(PiZhu(ActiveSheet.Cells(1, 1)))
  If IsGZB(ActiveSheet) = True Then '|fffd||fffd||fffd||fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||1f2||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
     If InStr(S, "|fffd||5b2||fffd||fffd||fffd||fffd||fffd|") > 0 And Workbooks.Count = 1 Then
        If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
        SheetProtect
     End If
  End If
AA: ErrSub
End Sub

Private Sub Workbook_Open()
  On Error GoTo AA:
  
'  Dim HasGZmenu As Boolean
  Dim I, gzYear, gzMonth As Long
  Dim S, S1 As String
  
  If HLSJ = True Then Exit Sub
  
  Set ThisWB = Application.ActiveWorkbook
  
  '6.0|fffd||6fea||2bc||2b9||fffd||fffd|Ribbon |fffd||fffd||fffd||fffd||2b9||fffd||fffd||fffd||536||fffd||fffd||fffd||2f5||fffd||fffd||fffd|
  'HasGZmenu = False
  'Application.Caption = "|fffd||fffd||fffd||2b9||fffd||fffd||fffd||3f5||373|"
  'For I = 1 To Application.CommandBars(1).Controls.Count
      'S = Application.CommandBars(1).Controls(I).Caption
      'If S = "|fffd||fffd||fffd||2b9||fffd||fffd||fffd|(&G)" Then HasGZmenu = True: Exit For
  'Next I
  'If HasGZmenu = False Then AddMenu
  
   
   '|fffd||4bc||fffd||fffd||2f5||fffd||fffd||fffd|
   Dim R As CommandBarButton
  Set R = Application.CommandBars("Cell").Controls.Add(Type:=msoControlButton, before:=1, temporary:=True)
      R.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)":  R.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click": R.FaceId = 29

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bc||fffd||fffd||2f5||fffd||fffd||fffd|
  Set R = Application.CommandBars("PLY").Controls.Add(Type:=msoControlButton, before:=1, temporary:=True)
      R.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)":  R.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click": R.FaceId = 29:    R.BeginGroup = True

  Dim GSL As Long
  
  Application.ScreenUpdating = False
  For I = 1 To Sheets.Count
      With Sheets(I)
           '*****|fffd||fffd||fffd||fffd||1f0||fffd||b7||779||fffd||fffd||2b1||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|*******************
           S = Trim(PiZhu(.Cells(1, 1)))
           If IsGZB(Sheets(I)) = True Then '|fffd||fffd||fffd||fffd||fffd||f1||fffd||fffd||1e1||fffd||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||1f2||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd|
              If Not (InStr(S, "|22b||fffd||6c63||fffd||fffd|") > 0 And .ProtectContents = True) Then
                 S1 = .Range("A2").Value
                 gzYear = Val(Left(S1, 4))
                 gzMonth = Val(Mid(S1, 6, InStr(S1, "|fffd||b7||fffd|") - 1))
                 If gzYear * 12 + gzMonth < Year(Now) * 12 + Month(Now) Then
                    If .ProtectContents = True Then .Unprotect "gzglxt"
                    .Cells.Locked = True
                    .Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|(Sheets(I))).Interior.ColorIndex = 0
                    
                    GSL = KXL("|fffd||fffd||2f0|", Sheets(I))
                   .Range(.Cells(6, GSL), .Cells(HJH(Sheets(I)) - 1, GSL)).Interior.ColorIndex = 0  '|225||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||26b|
                    
                    .Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|22b||fffd||6c63||fffd||fffd|"
                     Sheets(I).PageSetup.PrintTitleRows = "$1:$5"
                    .Protect Password:="gzglxt", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
                 Else
                    If .ProtectContents = False Then
                       .Cells.Locked = True
                       .Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|(Sheets(I))).Locked = False
                       .Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|(Sheets(I))).Interior.ColorIndex = 20
                       .Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
                       .Protect Password:="gzglxt", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
                    End If
                 End If
              End If
           End If
      End With
  Next I
  
  'MenuItemDisplayControl
  Application.ScreenUpdating = True
  
  '|fffd||fffd||4bb||fffd||fffd||2b9||fffd||f1||fffd||3f5||373||fffd||536||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  If Sheets.Count = 3 And Cells(1, 1) = "XX|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3b9||fffd||2fe|" And Cells(2, 1) = "2019|fffd||fffd|1|fffd||b7||779||fffd||fffd||2b1||fffd|" Then |fffd||7b8||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click |fffd||536||fffd|:=True
  
AA: ErrSub
End Sub



Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{BE7D1B03-497A-4D04-8582-B1D64D894A5C}{02FBEE18-1365-4102-A527-E9C00344AFD2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Dim EndRow As Long, EndColumn As Long


Private Sub CommandButton1_Click()  '|fffd||fffd||fffd||438||fffd||2bd|
 On Error GoTo AA:
 Dim FileName As String
 If EndRow = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||3fd||fffd||fffd||fffd||fffd||431||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 If EndColumn = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 
 If Left(Range("A2").Value, 2) <> "20" Then
    FileName = "|fffd||fffd||fffd||2b1||fffd|.txt"
 Else
    FileName = Trim(Range("A2").Value) + ".txt"
End If
Dim I As Long
Dim XM As String
Dim GZ, GZHJ As Currency
Open ActiveWorkbook.Path + "\" + FileName For Output As #1
For I = 6 To EndRow - 1    '*************|12c||fffd||3f4||4f5||fffd|6|fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    XM = Range("B" + CStr(I))
    Do While InStr(XM, " ") > 0
       XM = Replace(XM, " ", "")
    Loop
    GZ = Cells(I, EndColumn)
    GZHJ = GZHJ + GZ
    Print #1, CStr(I - 5) + "|" + Range("D" + CStr(I)) + "|" + XM + "|" + CStr(Format(GZ, "##0.00"))
Next I
If GZHJ <> Cells(EndRow, EndColumn) Then
   MsgBox "|fffd||fffd||fffd||2b1||fffd||fffd||3f5||139||fffd||fffd||2ba||3fc||fffd||fffd||fffd||3aa||fffd||fffd|" + CStr(Range(EndColumn + CStr(EndRow))) + "|fffd||fffd||fffd||fffd||fffd||6fc||4fd||fffd||fffd||3aa||fffd||fffd|" + CStr(GZHJ) + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||ba||2f6||fffd||fffd||fffd||fffd||763||fffd|", vbCritical
End If

MsgBox "|fffd||47e||fffd||fffd||6b5||fffd||1f0||13f||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd|" + FileName + vbCrLf + vbCrLf _
       & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(EndRow - 6) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||1a3||fffd|" + Format(GZHJ, "#,##0.00") + "|52a||fffd||fffd|"
Close #1
Unload Me
AA:  ErrSub: Close #1

End Sub

Private Sub CommandButton4_Click()   '|fffd||fffd||fffd||438||fffd||2bd|   excel|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||163||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2ba||163||fffd||fffd||fffd||fffd|
On Error GoTo AA
  Dim strSH As String
  strSH = ActiveWorkbook.BuiltinDocumentProperties("Category")
  strSH = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||5ea||fffd||fffd||fffd||fffd||2a1||fffd||423||fffd||fffd||fffd||fffd||78fa|51-|fffd||134||fffd|", "|fffd||fffd||2be|", strSH)
  If strSH = "" Then Exit Sub
  If strSH <> "" Then ActiveWorkbook.BuiltinDocumentProperties("Category") = strSH
  
 Dim FileName As String, FullName As String
 If EndRow = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||3fd||fffd||fffd||fffd||fffd||431||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 If EndColumn = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 
 If Left(Range("A2").Value, 2) <> "20" Then
    FileName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd|"
 Else
    FileName = Trim(Range("A2").Value)
End If
FullName = ActiveWorkbook.Path + "\" + FileName

Dim I As Long
Dim XM As String
Dim GZ, GZHJ As Currency

Dim SH As Worksheet, WB1 As Workbook, SH1 As Worksheet
Set SH = Application.ActiveSheet
Set WB1 = Application.Workbooks.Add
Set SH1 = WB1.ActiveSheet


With SH1
     .Range("A1").Value = "|4b5||fffd||fffd||fffd||fffd||fffd||363||fffd|"
     .Range("B1").Value = "C1-|fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd|"
     .Range("C1").Value = "|5ea||fffd||fffd||fffd||2fa||163||fffd|"
     .Range("E1").Value = "|fffd||fffd||fffd||5a3||fffd|"
     .Range("F1").Value = "CNY-|fffd||fffd||fffd||fffd||fffd|"
     .Range("G1").Value = "|4b5||fffd||fffd||56a||4aa||fffd||fffd|"
     .Range("H1").Value = "EV-|fffd||fffd||fffd||fffd|"
     .Range("A3").Value = "|fffd||fffd||fffd|"
     .Range("B3").Value = "|5ea||fffd||fffd||fffd||2fa||fffd|"
     .Range("C3").Value = "|5ea||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("D3").Value = "|fffd||fffd||fffd|"
     .Range("E3").Value = "|5ea||fffd||fffd||fffd||fffd||2a1||fffd||fffd|"
     .Range("F3").Value = "|5a4||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("G3").Value = "|5a4||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("H3").Value = "|fffd||fffd||5e2|"
     .Range("I3").Value = "|fffd||fffd||fffd||fffd||fffd||2b6|"
  End With

For I = 6 To EndRow - 1    '*************|12c||fffd||3f4||4f5||fffd|6|fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    XM = SH.Range("B" + CStr(I))
    'XM = Replace(XM, " ", "") '|fffd||fffd||fffd||fffd||4aa||225||fffd||fffd||fffd||fffd||fffd||fffd||13f||578||fffd|
    GZ = SH.Cells(I, EndColumn)
    GZHJ = GZHJ + GZ
    'Print #1, CStr(I - 5) + "|" + SH.Range("D" + CStr(I)) + "|" + XM + "|" + CStr(Format(GZ, "##0.00"))
    SH1.Cells(I - 4 + 2, 1) = CStr(I - 5)
    SH1.Cells(I - 4 + 2, 2) = "'" & SH.Range("D" + CStr(I))
    SH1.Cells(I - 4 + 2, 3) = XM
    SH1.Cells(I - 4 + 2, 4) = GZ
    SH1.Cells(I - 4 + 2, 5) = strSH
Next I

Application.ActiveWindow.DisplayGridlines = False
 SH1.Columns(4).NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
 SH1.Columns(2).ColumnWidth = 20
 SH1.Range("A3:I" & EndRow - 4 + 2).Borders.LineStyle = xlContinuous


If GZHJ <> SH.Cells(EndRow, EndColumn) Then
   MsgBox "|fffd||fffd||fffd||2b1||fffd||fffd||3f5||139||fffd||fffd||2ba||3fc||fffd||fffd||fffd||3aa||fffd||fffd|" + CStr(SH.Cells(EndRow, EndColumn)) + "|fffd||fffd||fffd||fffd||fffd||6fc||4fd||fffd||fffd||3aa||fffd||fffd|" + CStr(GZHJ) + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||ba||2f6||fffd||fffd||fffd||fffd||763||fffd|", vbCritical: Exit Sub
End If

Application.DisplayAlerts = False
WB1.Close True, FullName
Application.DisplayAlerts = True
Set SH = Nothing
Set WB1 = Nothing
Set SH1 = Nothing

MsgBox "|fffd||47e||fffd||fffd||6b5||fffd||1f0||13f||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd|" + FileName + vbCrLf + vbCrLf _
       & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(EndRow - 6) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||1a3||fffd|" + Format(GZHJ, "#,##0.00") + "|52a||fffd||fffd|"
       
Unload Me


AA: ErrSub
End Sub



Private Sub CommandButton3_Click()
  Unload Me
End Sub

Private Sub CommandButton5_Click()
 On Error GoTo AA:
  Dim S As String, GS As String, JG As String
  Dim FileName As String
  Dim pXH As Long, pZH As Long, pXM As Long, pGZ As Long

  S = ActiveWorkbook.BuiltinDocumentProperties("Comments")
  If Left(S, 12) = "|fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||2b8||fffd||2bd||fffd||fffd|" Then GS = Right(S, Len(S) - 12)
  If GS = "" Then CommandButton6_Click: Exit Sub
  
  If EndRow = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||3fd||fffd||fffd||fffd||fffd||431||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
  If EndColumn = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 
  Dim I As Long
  Dim XM As String
  Dim GZ, GZHJ As Currency
 
     If Left(Range("A2").Value, 2) <> "20" Then FileName = "|fffd||fffd||fffd||2b1||fffd|.txt" Else FileName = Trim(Range("A2").Value) + ".txt"
  
     Open ActiveWorkbook.Path + "\" + FileName For Output As #1
     For I = 6 To EndRow - 1    '*************|12c||fffd||3f4||4f5||fffd|6|fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       XM = Range("B" + CStr(I))
       Do While InStr(XM, " ") > 0
          XM = Replace(XM, " ", "")
       Loop
       GZ = Cells(I, EndColumn)
       GZHJ = GZHJ + GZ
    
       JG = GS
    
       pXH = InStr(JG, "|fffd||fffd||fffd|")
       If pXH > 0 Then JG = Left(JG, pXH - 1) + CStr(I - 5) + Right(JG, Len(JG) - pXH - 1)
    
       pZH = InStr(JG, "|fffd||2ba||fffd|")
       If pZH > 0 Then JG = Left(JG, pZH - 1) + Range("D" + CStr(I)) + Right(JG, Len(JG) - pZH - 1)
    
       pXM = InStr(JG, "|fffd||fffd||fffd||fffd|")
       If pXM > 0 Then JG = Left(JG, pXM - 1) + XM + Right(JG, Len(JG) - pXM - 1)
  
       pGZ = InStr(JG, "|fffd||fffd||fffd||fffd|")
       If pGZ > 0 Then JG = Left(JG, pGZ - 1) + CStr(Format(GZ, "##0.00")) + Right(JG, Len(JG) - pGZ - 1)
    
       Print #1, JG
     Next I
   If GZHJ <> Cells(EndRow, EndColumn) Then
      MsgBox "|fffd||fffd||fffd||2b1||fffd||fffd||3f5||139||fffd||fffd||2ba||3fc||fffd||fffd||fffd||3aa||fffd||fffd|" + CStr(Range(EndColumn + CStr(EndRow))) + "|fffd||fffd||fffd||fffd||fffd||6fc||4fd||fffd||fffd||3aa||fffd||fffd|" + CStr(GZHJ) + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||ba||2f6||fffd||fffd||fffd||fffd||763||fffd|", vbCritical
   End If

   MsgBox "|fffd||47e||fffd||fffd||6b5||fffd||1f0||13f||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd|" + FileName + vbCrLf + vbCrLf _
          & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(EndRow - 6) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||1a3||fffd|" + Format(GZHJ, "#,##0.00") + "|52a||fffd||fffd|"
   Close #1
Unload Me
AA:  ErrSub: Close #1
End Sub

Private Sub CommandButton6_Click()
 On Error GoTo AA:
  UserForm10.Show
AA:   ErrSub
End Sub

Private Sub CommandButton7_Click()
 On Error GoTo AA:
 Dim FileName As String, FullName As String
 If EndRow = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||3fd||fffd||fffd||fffd||fffd||431||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 If EndColumn = 0 Then MsgBox "|fffd||fffd||fffd||7b7||fffd||fffd||436||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||68e1|":    Exit Sub
 
 If Left(Range("A2").Value, 2) <> "20" Then
    FileName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd|"
 Else
    FileName = Trim(Range("A2").Value)
End If
FullName = ActiveWorkbook.Path + "\" + FileName

Dim I As Long
Dim XM As String
Dim GZ, GZHJ As Currency

Dim SH As Worksheet, WB1 As Workbook, SH1 As Worksheet
Set SH = Application.ActiveSheet
Set WB1 = Application.Workbooks.Add
Set SH1 = WB1.ActiveSheet

SH1.Cells(1, 1) = "|fffd||fffd||fffd|"
SH1.Cells(1, 2) = "|fffd||fffd||fffd||fffd|"
SH1.Cells(1, 3) = "|fffd||2ba||fffd|"
SH1.Cells(1, 4) = "|fffd||fffd||fffd|"
If FJSJ <> "" Then SH1.Cells(1, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd|"

For I = 6 To EndRow - 1    '*************|12c||fffd||3f4||4f5||fffd|6|fffd||43f||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    XM = SH.Range("B" + CStr(I))
    Do While InStr(XM, " ") > 0
       XM = Replace(XM, " ", "")
    Loop
    GZ = SH.Cells(I, EndColumn)
    GZHJ = GZHJ + GZ
    'Print #1, CStr(I - 5) + "|" + SH.Range("D" + CStr(I)) + "|" + XM + "|" + CStr(Format(GZ, "##0.00"))
    SH1.Cells(I - 4, 1) = CStr(I - 5)
    SH1.Cells(I - 4, 2) = XM
    SH1.Cells(I - 4, 3) = "'" & SH.Range("D" + CStr(I))
    SH1.Cells(I - 4, 4) = GZ
    If FJSJ <> "" Then SH1.Cells(I - 4, 5) = FJSJ
Next I
If GZHJ <> SH.Cells(EndRow, EndColumn) Then
   MsgBox "|fffd||fffd||fffd||2b1||fffd||fffd||3f5||139||fffd||fffd||2ba||3fc||fffd||fffd||fffd||3aa||fffd||fffd|" + CStr(SH.Cells(EndRow, EndColumn)) + "|fffd||fffd||fffd||fffd||fffd||6fc||4fd||fffd||fffd||3aa||fffd||fffd|" + CStr(GZHJ) + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||ba||2f6||fffd||fffd||fffd||fffd||763||fffd|", vbCritical: Exit Sub
End If

Application.DisplayAlerts = False
WB1.Close True, FullName
Application.DisplayAlerts = True
Set SH = Nothing
Set WB1 = Nothing
Set SH1 = Nothing

MsgBox "|fffd||47e||fffd||fffd||6b5||fffd||1f0||13f||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd|" + FileName + vbCrLf + vbCrLf _
       & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(EndRow - 6) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||1a3||fffd|" + Format(GZHJ, "#,##0.00") + "|52a||fffd||fffd|"
       
Unload Me

If FJSJ <> "" Then ActiveWorkbook.BuiltinDocumentProperties("KeyWords") = FJSJ

AA: ErrSub
End Sub



Private Sub FJSJ_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
 If KeyCode = 13 Then CommandButton7_Click
End Sub


Private Sub UserForm_Initialize()
 On Error GoTo AA:
 
 Dim S As String
 
 R13.Caption = Range(R11.Caption).Value
 R23.Caption = Range(R21.Caption).Value
 R33.Caption = Range(R31.Caption).Value
 
 EndRow = HJH
 EndColumn = SFGZL
 If EndColumn > 0 Then
    S = Cells(1, EndColumn).Address(False, False)
    R43.Caption = "|fffd||fffd||fffd||fffd||28ec||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + Left(S, Len(S) - 1) + "|fffd||fffd|"
 Else
    R43.Caption = "|fffd||fffd||fffd||fffd||28ec||3b4||fffd||4b5||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||423||fffd|":    R43.ForeColor = &HFF&
 End If
 
 If EndRow > 0 Then
    R53.Caption = "|fffd||fffd||fffd||fffd||28ec||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd|" + CStr(EndRow) + "|fffd||fffd|"
 Else
    R53.Caption = "|fffd||7b7||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||f1||fffd||5be|":         R53.ForeColor = &HFF&
 End If
 
 
 S = ActiveWorkbook.BuiltinDocumentProperties("KeyWords")
 If S <> "" Then FJSJ.Text = S
AA:   ErrSub
End Sub

Attribute VB_Name = "UserForm10"
Attribute VB_Base = "0{A79FDCE4-EDC6-44F7-A012-A3025BF147E0}{047BB47A-D995-45A4-9E4D-156850C42187}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
On Error GoTo AA
  Dim S As String, I As Long
  S = GS.Text
  If InStr(S, "|fffd||2ba||fffd|") = 0 Or InStr(S, "|fffd||fffd||fffd||fffd|") = 0 Then MsgBox "|fffd||fffd||fffd||2b8||fffd||2bd||fffd||fffd||fb||fffd||fffd||fffd||2ba||17b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||63c||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2bd||fffd||fffd||fffd||fffd|": GS.SetFocus: Exit Sub
  I = MsgBox("|237||2b5||fffd||fffd||4aa||fffd||7b8||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||2b8||fffd||2bd||fffd||fffd|", vbInformation + vbYesNo, "|fffd||fffd||2be|")
  If I = vbYes Then ActiveWorkbook.BuiltinDocumentProperties("Comments") = "|fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||2b8||fffd||2bd||fffd||fffd|" + S
  Unload Me
AA: ErrSub
End Sub

Private Sub CommandButton2_Click()
  Unload Me
End Sub


Private Sub UserForm_Initialize()
On Error GoTo AA
  Dim S As String, I As Long
  S = ActiveWorkbook.BuiltinDocumentProperties("Comments")
  If Left(S, 12) = "|fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||2b8||fffd||2bd||fffd||fffd|" Then GS.Text = Right(S, Len(S) - 12)
AA: ErrSub
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{0AFEA972-1914-4CA8-BF34-779A49C30113}{4B23C9AE-BB94-4B35-A658-1F37CC39216A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit

Private Sub CommandButton1_Click()
On Error GoTo AA:
 
 Dim S1 As String, S2 As String
 If L1.ListCount < 2 Then Exit Sub
 If L1.ListIndex <= 0 Then L1.ListIndex = 0: Exit Sub
 
 Dim I As Long
 
 I = L1.ListIndex
 
 S1 = L1.List(I - 1)
 S2 = L1.List(I)

 L1.List(I - 1) = S2
 L1.List(I) = S1
 L1.ListIndex = I - 1

 Dim I1 As Long, I2 As Long
 With ActiveWorkbook.CustomDocumentProperties
   For I = 1 To ActiveWorkbook.CustomDocumentProperties.Count '|fffd||fffd||174||fffd|1|fffd||fffd||2bc|,|fffd||fffd||fffd||fffd|0,|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If .Item(I).Name = S1 Then I1 = I
      If .Item(I).Name = S2 Then I2 = I
   Next
    .Item(I1).Name = S1 & CStr(Time)
    .Item(I2).Name = S2 & CStr(Time)
    
    .Item(I1).Name = S2
    .Item(I2).Name = S1
 End With
 
AA: ErrSub
End Sub

Private Sub CommandButton2_Click()
On Error GoTo AA:
 
 Dim S1 As String, S2 As String
 If L1.ListCount < 2 Then Exit Sub
 If L1.ListIndex = L1.ListCount - 1 Then Exit Sub
 If L1.ListIndex = -1 Then L1.ListIndex = L1.ListCount - 1: Exit Sub
 
 Dim I As Long
 
 I = L1.ListIndex
 S1 = L1.List(I)
 S2 = L1.List(I + 1)
 L1.List(I) = S2
 L1.List(I + 1) = S1
 L1.ListIndex = I + 1

 
 Dim I1 As Long, I2 As Long
 With ActiveWorkbook.CustomDocumentProperties
   For I = 1 To ActiveWorkbook.CustomDocumentProperties.Count '|fffd||fffd||174||fffd|1|fffd||fffd||2bc|,|fffd||fffd||fffd||fffd|0,|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If .Item(I).Name = S1 Then I1 = I
      If .Item(I).Name = S2 Then I2 = I
   Next
    .Item(I1).Name = S1 & CStr(Time)
    .Item(I2).Name = S2 & CStr(Time)
    
    .Item(I1).Name = S2
    .Item(I2).Name = S1
 End With

 
AA: ErrSub
End Sub

Private Sub CommandButton3_Click()
On Error GoTo AA:
  If L1.ListCount = 0 Then Exit Sub
  If L1.ListIndex = -1 Then Exit Sub
  
  Dim I As Long, S As String
  I = L1.ListIndex
  
  Dim B As DocumentProperty
  For Each B In ActiveWorkbook.CustomDocumentProperties
      If B.Name = L1.List(I) Then B.Delete: Exit For
  Next B
  L1.RemoveItem I
AA: ErrSub
End Sub

Private Sub CommandButton6_Click()
  Unload Me
End Sub

Private Sub CommandButton7_Click()
On Error GoTo AA:
  Dim S As String, I As Long
  S = Trim(InputBox("|fffd||fffd||fffd||fffd||fffd||bcbf||fffd||fffd||fffd||fffd||fffd||1a3||fffd|", "|fffd||fffd||fffd||4f2||fffd||fffd||fffd|"))
  If S = "" Then Exit Sub
  
  For I = 0 To L1.ListCount - 1
    If L1.List(I) = S Then MsgBox "|fffd||47e||fffd||fffd||438||f2||fffd||fffd||163||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
  Next I
  
  ActiveWorkbook.CustomDocumentProperties.Add Name:=S, LinkToContent:=False, Type:=msoPropertyTypeString, Value:=""
  L1.AddItem S
  L1.ListIndex = L1.ListCount - 1
  
AA: ErrSub
End Sub

Private Sub CommandButton8_Click()
On Error GoTo AA:
  Dim S As String, S1 As String, I As Long
  
  If L1.ListCount = 0 Then Exit Sub
  If L1.ListIndex = -1 Then Exit Sub
  S = Trim(InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||13a||fffd||132||fffd||fffd||fffd||fffd||fffd||fffd||1a3||fffd|", "|fffd||7b8||fffd|", L1.List(L1.ListIndex)))
  
  S1 = L1.List(L1.ListIndex)
  If S = S1 Then Exit Sub
  
  For I = 0 To L1.ListCount - 1
    If L1.List(I) = S Then MsgBox "|fffd||7b8||13a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
  Next I
  
  
  Dim B As DocumentProperty
  For Each B In ActiveWorkbook.CustomDocumentProperties
      If B.Name = S1 Then B.Name = S: Exit For
  Next B
  
    L1.List(L1.ListIndex) = S

AA: ErrSub
End Sub

Private Sub UserForm_Initialize()
On Error GoTo AA:
  Dim B As DocumentProperty
  '|4aa||fffd||173||fffd| |5e8||fffd||fffd|_  |fffd||fffd||377||fffd||137||1f2||fffd||fffd||fffd||fffd||fffd||fffd||1b5||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd|
  For Each B In ActiveWorkbook.CustomDocumentProperties
      If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then L1.AddItem B.Name
  Next B
  
  
AA: ErrSub
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{179EB5DE-F9DF-4544-9E18-00A5B8A463FC}{FC54741E-6737-4A14-8A63-579C3B031264}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Option Explicit

Private Sub CommandButton1_Click()
  Unload Me
End Sub

Private Sub Frame1_Click()

End Sub

Private Sub Label13_Click()
  Shell "explorer.exe http://blog.sina.com.cn/s/blog_5488e3a901000ayc.html"
End Sub

Private Sub Label4_Click()
  Shell "explorer.exe http://blog.sina.com.cn/s/blog_5488e3a90100gwo4.html"
End Sub



Private Sub UserForm_Initialize()
 Dim B As DocumentProperty
 Set B = ActiveWorkbook.BuiltinDocumentProperties.Item("Company")
 If B.Value <> "" Then Label10.Caption = "|fffd||fffd||228||fffd||fffd||fffd||fffd|" + B.Value + "|fffd||fffd||fffd||fffd||fffd||fffd||5e8||fffd||e1||fffd|"
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{27A00563-EDF0-4C3E-83CA-D0A0E8B44C50}{C1CF72C4-F92B-412A-9303-839EA63F1C48}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Option Explicit
Private Sub ComboBox1_Click()
  On Error GoTo AA:
  L1.Clear
    
  Dim I As Long
  If ComboBox1.ListIndex = 0 Then
     For I = 6 To YFXJL - 1  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f2||fffd||fffd||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|,|fffd||2b4||fffd|5|fffd||fffd||3aa|6
         L1.AddItem Cells(5, I).Value
     Next I
  Else
     For I = YFXJL + 1 To KKXJL - 2
         L1.AddItem Cells(5, I).Value
     Next I
  End If
AA: ErrSub
End Sub

Private Sub CommandButton1_Click()
   On Error GoTo AA:
   
   If L1.ListCount = 0 Then Exit Sub
   If L1.ListIndex = 0 Then Exit Sub
   If L1.ListIndex = -1 Then L1.ListIndex = 0:     Exit Sub
   
   Dim C, H As Long
   C = KXL(L1.List(L1.ListIndex))
   H = HJH
   If C = 0 Then Exit Sub
   
   Application.DisplayAlerts = False
   If L1.ListIndex = 1 Then  '|fffd||fffd|2|fffd||fffd|
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range(Cells(5, C - 1), Cells(H, C - 1)).Cut
      Range(Cells(5, C + 1), Cells(H, C + 1)).Insert
      If QTBFL > 0 Then Range(Cells(4, QTBFL), Cells(5, QTBFL)).Merge
      If SFGZL > 0 Then Range(Cells(4, SFGZL), Cells(5, SFGZL)).Merge
      SheetProtect
   End If
   If L1.ListIndex > 1 Then
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range(Cells(5, C), Cells(H, C)).Cut
      Range(Cells(5, C - 1), Cells(H, C - 1)).Insert
      If QTBFL > 0 Then Range(Cells(4, QTBFL), Cells(5, QTBFL)).Merge
      If SFGZL > 0 Then Range(Cells(4, SFGZL), Cells(5, SFGZL)).Merge
      SheetProtect
   End If
   
   Dim S As String
   S = L1.List(L1.ListIndex)
   L1.List(L1.ListIndex) = L1.List(L1.ListIndex - 1)
   L1.List(L1.ListIndex - 1) = S
   L1.ListIndex = L1.ListIndex - 1
   Application.DisplayAlerts = True
AA: ErrSub
End Sub

Private Sub CommandButton3_Click()
   On Error GoTo AA:
   
   If L1.ListCount = 0 Then Exit Sub
   If L1.ListIndex = L1.ListCount - 1 Then Exit Sub
   If L1.ListIndex = -1 Then L1.ListIndex = 0:     Exit Sub
   
   Dim C, H As Long
   C = KXL(L1.List(L1.ListIndex))
   H = HJH
   If C = 0 Then Exit Sub
   Application.DisplayAlerts = False
   If L1.ListIndex = L1.ListCount - 2 Then  '|fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd|
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range(Cells(5, C + 1), Cells(H, C + 1)).Cut
      Range(Cells(5, C), Cells(H, C)).Insert
      If QTBFL > 0 Then Range(Cells(4, QTBFL), Cells(5, QTBFL)).Merge
      If SFGZL > 0 Then Range(Cells(4, SFGZL), Cells(5, SFGZL)).Merge
      SheetProtect
   End If
   If L1.ListIndex < L1.ListCount - 2 Then
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range(Cells(5, C), Cells(H, C)).Cut
      Range(Cells(5, C + 2), Cells(H, C + 2)).Insert
      If QTBFL > 0 Then Range(Cells(4, QTBFL), Cells(5, QTBFL)).Merge
      If SFGZL > 0 Then Range(Cells(4, SFGZL), Cells(5, SFGZL)).Merge
      SheetProtect
   End If
   
   Dim S As String
   S = L1.List(L1.ListIndex)
   L1.List(L1.ListIndex) = L1.List(L1.ListIndex + 1)
   L1.List(L1.ListIndex + 1) = S
   L1.ListIndex = L1.ListIndex + 1
   Application.DisplayAlerts = True
AA: ErrSub
End Sub

Private Sub CommandButton4_Click()
  Unload Me
End Sub



Private Sub SC_Click()
On Error GoTo AA:
 Dim C As Long
 Dim S As String, I As Long
 If L1.ListIndex < 0 Then Exit Sub
 S = L1.List(L1.ListIndex)
 I = ExistGZXM(S)
 If I = 1 Then MsgBox "|fffd||fffd||fffd||fffd||27e||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
 If ComboBox1.ListIndex = 0 Then If L1.ListCount < 3 Then MsgBox "|3aa||fffd||fffd||5a4||fffd||fffd||379||fffd||2bd||fffd||fffd||fffd||fffd||237||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||e8e1|", vbCritical, "|fffd||fffd||fffd||fffd|": Exit Sub
    
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 
 C = KXL(L1.List(L1.ListIndex))
 L1.RemoveItem L1.ListIndex
 
 Columns(C).Delete
 If ComboBox1.ListIndex = 0 Then Cells(4, 6) = "|4e6| |fffd||fffd| |fffd||fffd| |fffd||fffd|" Else Cells(4, KXL("|4e6||fffd||fffd||421||fffd||fffd|") + 1) = "|fffd||6ff||fffd||373||fffd||fffd|"
 SheetProtect
AA: ErrSub
End Sub

Private Sub UserForm_Initialize()
  ComboBox1.AddItem "|4e6||fffd||fffd||fffd||fffd||13f|"
  ComboBox1.AddItem "|fffd||6ff||fffd||fffd||fffd||13f|"
  ComboBox1.ListIndex = 0
End Sub

Private Sub XJ_Click()
On Error GoTo AA:

 Dim C As Long
 Dim S As String, I As Long, J As Long, NewS As String
 If L1.ListIndex < 0 Then Exit Sub
 S = L1.List(L1.ListIndex)
 I = ExistGZXM(S)
 If I = 1 Then MsgBox "|fffd||fffd||fffd||fffd||fffd||7b8||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub

 NewS = Trim(InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||13a||fffd||139||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||1a3||fffd|", "|fffd||fffd||fffd||fffd|", S))
 If NewS = "" Or NewS = S Then Exit Sub
    
 J = ExistGZXM(NewS)
 If J <> 0 Then MsgBox "|fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||474||fffd||fffd||6a3||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
 
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 C = KXL(L1.List(L1.ListIndex))
 L1.List(L1.ListIndex) = NewS
 Cells(5, C) = NewS
 SheetProtect
AA: ErrSub
End Sub

Private Sub ZJ_Click()
On Error GoTo AA:
 Dim C As Long, HJrow As Long
 Dim S As String, I As Long
 S = Trim(InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||1a3||fffd|", "|fffd||fffd||fffd||fffd|"))
 If S = "" Then Exit Sub
 If S = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||3aa||fffd||fffd||2f0||fffd||fffd||fffd||3dfd||2bd||fffd||fffd||36c||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||5bb||fffd||733||fffd||fffd||fffd||fffd||6b5||fffd||fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||421||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
 I = ExistGZXM(S)
 If I <> 0 Then MsgBox "|fffd||fffd||fffd||fffd||13f||fffd||474||fffd||fffd||6a3||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
    
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 
 '|fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||423||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd|sum|fffd||fffd||2bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2cbf||fffd||5a3||fffd|
 If L1.ListIndex < 0 Then L1.ListIndex = L1.ListCount - 1
 If L1.ListIndex = 0 Then L1.ListIndex = 1
 C = KXL(L1.List(L1.ListIndex))
 L1.AddItem S, L1.ListIndex
 L1.ListIndex = L1.ListIndex - 1
 
 Columns(C).EntireColumn.Insert
 Cells(5, C).Value = S
 HJrow = HJH
 Cells(HJrow, C).Formula = "=SUM(" + Range(Cells(6, C), Cells(HJrow - 1, C)).Address(False, False) + ")"
 SheetProtect
AA: ErrSub
End Sub
Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{EAB39AC4-50FB-4526-8CE5-B5D449DA52C4}{5F982C9F-F145-4F1F-AF4E-9B0D436293A1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Public QuXiao As Boolean

Function FirstSelected() As Long
  Dim I As Long
  FirstSelected = -1
  For I = 0 To ListBox1.ListCount - 1
      If ListBox1.Selected(I) = True Then FirstSelected = I: Exit For
  Next I
End Function

Private Sub cBC_Click()
  On Error GoTo AA:
  Dim I, C As Long

  If ListBox1.ListCount = 0 Then Exit Sub
  'If Trim(sXH.Text) = "" Then: MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||731||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXH.SetFocus: Exit Sub   '|5e2||fffd||375||fffd||fffd||fffd||52d||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||fffd||638||fffd|
  If Trim(sXM.Text) = "" Then: MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||731||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXM.SetFocus: Exit Sub
 '|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||1ff||fffd||461||fffd||e8ec||fffd||fffd||1ff||fffd||fffd||bc||fffd||fffd|  If Trim(sSFZH.Text) = "" Then MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd|,|fffd||fffd||fffd||731||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sSFZH.SetFocus: Exit Sub
  
  Dim strXH, strXM, strZH, strSFZH As String, strBM As String
  strXH = Trim(sXH.Text): sXH.Text = strXH
  
  strXM = Trim(sXM.Text)
  strSFZH = Trim(sSFZH.Text)
  If Len(strXM) = 2 Or (Len(strXM) = 3 And Mid(strXM, 2, 1) = " ") Then strXM = Left(strXM, 1) + "  " + Right(strXM, 1)
  
  
    If strSFZH <> "" Then
     Dim SFZts As String
     SFZts = SFZJY(strSFZH)
     If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||b863|", vbCritical, "|fffd||fffd||2be|": sSFZH.SetFocus: Exit Sub
  End If

     
  sXM.Text = strXM
  strZH = Trim(sZH.Text): sZH.Text = strZH
  
  C = FirstSelected
  If C = -1 Then MsgBox "|fb||fffd||fffd||461||fffd||fffd||5b0||fffd||fffd|,|fffd||7b7||fffd||fffd||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|": Exit Sub
  
  For I = 0 To ListBox1.ListCount - 1
      If I <> C Then
         If strXH <> "" Then If Cells(I + 6, 1) = strXH Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd|,|fffd||fffd||fffd||731||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|":     sXH.SetFocus:   Exit Sub
         If Cells(I + 6, 2) = strXM Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||b863|" & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||436||3f2||fffd||36c||5b0||fffd||fffd||fffd||fffd||3a8||4bb||5b5||fffd||fffd||5be||fffd||fffd||fffd||fffd||fffd||532||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||237||2b5||36c||fffd||fffd||fffd||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd| |fffd||237||fffd||2bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a1||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXM.SetFocus: Exit Sub '|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3aa||3a8||4bb||fffd||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         If strSFZH <> "" Then If Cells(I + 6, 3) = strSFZH Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sSFZH.SetFocus: Exit Sub
          If strZH <> "" Then If Cells(I + 6, 4) = strZH Then MsgBox "|5b0||fffd||fffd||fffd||2ba||fffd||fffd||638||fffd|,|fffd||fffd||fffd||731||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sZH.SetFocus:    Exit Sub
      End If
  Next I
  
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  Cells(C + 6, 1) = "'" & sXH.Text
  Cells(C + 6, 2) = sXM.Text
  Cells(C + 6, 3) = "'" & sSFZH.Text
  Cells(C + 6, 4) = "'" & sZH.Text
  ListBox1.List(C) = sXM.Text
  SheetProtect
  |36c||fffd||fffd||fffd||fffd||fffd||4f2||fffd||fffd||fffd| C
  
AA: ErrSub

End Sub

Private Sub CommandButton1_Click()
   On Error GoTo AA:
   Dim Li As Long
   Li = FirstSelected
   If ListBox1.ListCount = 0 Then Exit Sub
   If Li = -1 Then ListBox1.Selected(0) = True: Li = 0
   If Li = 0 Then Exit Sub
   
   Dim H As Long
   H = HJH
   If H < 7 Then Exit Sub
   
   Application.DisplayAlerts = False
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   If Li = 1 Then Rows(Li + 6 - 1).Cut:       Rows(Li + 6 + 1).Insert  '|fffd||fffd|2|fffd||fffd|
   If Li > 1 Then Rows(Li + 6).Cut:           Rows(Li + 6 - 1).Insert
   
   SheetProtect
   
    |fffd||7b8||fffd||fffd||3fc||fffd||fffd||439||fffd||2bd|
       
   Dim S As String
   S = ListBox1.List(Li)
   ListBox1.List(Li) = ListBox1.List(Li - 1)
   ListBox1.List(Li - 1) = S
   
   Dim I As Long
   For I = 0 To ListBox1.ListCount - 1
       If I <> Li - 1 Then ListBox1.Selected(I) = False Else ListBox1.Selected(I) = True
   Next I
   
   Application.DisplayAlerts = True
   
   
   
   
AA: ErrSub
End Sub

Private Sub CommandButton2_Click()
   On Error GoTo AA:
   Dim Li As Long
   Li = FirstSelected
   If ListBox1.ListCount = 0 Then Exit Sub
   If Li = -1 Then ListBox1.Selected(ListBox1.ListCount - 1) = True: Li = ListBox1.ListCount - 1
   If Li = ListBox1.ListCount - 1 Then Exit Sub
   
   Dim H As Long
   H = HJH
   If H < 7 Then Exit Sub
   
   Application.DisplayAlerts = False
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   If Li = ListBox1.ListCount - 2 Then Rows(Li + 6 + 1).Cut:      Rows(Li + 6).Insert '|fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd|
   If Li < ListBox1.ListCount - 2 Then Rows(Li + 6).Cut:          Rows(Li + 6 + 2).Insert
   
   SheetProtect
   
   |fffd||7b8||fffd||fffd||3fc||fffd||fffd||439||fffd||2bd|

   Dim S As String
   S = ListBox1.List(Li)
   ListBox1.List(Li) = ListBox1.List(Li + 1)
   ListBox1.List(Li + 1) = S
   
   Dim I As Long
   For I = 0 To ListBox1.ListCount - 1
       If I <> Li + 1 Then ListBox1.Selected(I) = False Else ListBox1.Selected(I) = True
   Next I
   
   Application.DisplayAlerts = True
AA:
ErrSub
End Sub
Private Sub |fffd||7b8||fffd||fffd||3fc||fffd||fffd||439||fffd||2bd|()
 On Error GoTo AA:
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   Dim R As Range
   Dim H As Long
   H = HJH
   Set R = Cells(H, 6)
   R.Formula = "=SUM(F6:F" & CStr(H - 1) & ")"
   R.AutoFill Destination:=Range(R, Cells(H, SFGZL))
   SheetProtect
AA: ErrSub
End Sub


Private Sub CommandButton3_Click()
 On Error GoTo AA:
 If IsGZB = False Then Exit Sub
 
 Dim I As Long, Icount As Long, S As String
 
 For I = 0 To ListBox1.ListCount - 1
     If ListBox1.Selected(I) = True Then Icount = Icount + 1: S = S + CStr(I + 6) + ":" + CStr(I + 6) + ","
 Next I
 If S = "" Then Exit Sub Else S = Left(S, Len(S) - 1) '|225||fffd||fffd||fffd||fffd||fffd||4b1||7f5||136||fffd||fffd||fffd|
 
 If ListBox1.ListCount <= 2 Or Icount > ListBox1.ListCount - 2 Then MsgBox "|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|Excel|fffd||fffd|SUM|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":      Exit Sub
 
 I = MsgBox("|237||2b5||4aa||27e||fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", vbInformation + vbYesNo + vbDefaultButton2, "|fffd||fffd||fffd||463||fffd|")
 If I = vbYes Then
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Range(S).Delete
    
    SheetProtect
    
    |fffd||7b8||fffd||fffd||3fc||fffd||fffd||439||fffd||2bd|
    
    Icount = ListBox1.ListCount
    For I = Icount - 1 To 0 Step -1
       If ListBox1.Selected(I) = True Then ListBox1.RemoveItem I
    Next I
    sXH = ""
    sXM = ""
    sSFZH = ""
    sZH = ""
    sBM = ""
 End If
AA:
ErrSub
End Sub

Private Sub CommandButton4_Click()
  If ListBox1.ListCount = 0 Then Exit Sub
  If FirstSelected = -1 Then ListBox1.Selected(ListBox1.ListCount - 1) = True
  
  sXH.Enabled = True
  sXM.Enabled = True
  sSFZH.Enabled = True
  sZH.Enabled = True
  sBM.Enabled = True
  cBC.Enabled = True
End Sub


Private Sub CommandButton6_Click()
  Unload Me
End Sub


Private Sub CommandButton7_Click()
  On Error GoTo AA:
  
 ' If InStr(ActiveSheet.Name, "|fffd||b7||fffd| (") > 0 Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f1||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||139||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||6a1||fffd|" & Left(ActiveSheet.Name, InStr(ActiveSheet.Name, "|fffd||b7||fffd|") - 1) + "|fffd||b7||fffd|" & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|": Exit Sub
  
  
  Dim I As Long
  If ListBox1.ListCount < 2 Then
    MsgBox "|fffd||fffd||fffd||6b8||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||123||fffd||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd|" + vbCrLf + " |fffd||fffd||fffd||fffd|Excel|fffd||fffd|SUM|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|"
    Exit Sub
  End If
  UserForm6.Show 1
  
  If QuXiao = True Then Exit Sub
  
  Application.ScreenUpdating = False
  I = ListBox1.ListCount - 1
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  Rows(I + 6).Insert
  Cells(I + 6, 1) = "'" & Trim(sXH.Text)
  Cells(I + 6, 2) = Trim(sXM.Text)
  Cells(I + 6, 3) = "'" & Trim(sSFZH.Text)
  Cells(I + 6, 4) = "'" & Trim(sZH.Text)
  |36c||fffd||fffd||fffd||fffd||fffd||4f2||fffd||fffd||fffd| I
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  
  Dim R As Range
  Set R = Cells(I + 6, YFXJL)
  R.Offset(-1, 0).AutoFill Destination:=Range(R.Offset(-1, 0), R), Type:=xlFillDefault
  
  
  '|5bb||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||1b8||fffd||2f0||fffd||fffd||2bd||3ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||761||fffd|
   If Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
      Cells(I + 6, KXL("|fffd||fffd||2f0|")).Formula = "=QNJ(" & Cells(I + 6, KXL("|4e6||fffd||fffd||421||fffd||fffd|")).Address(False, False) & ")"
   End If

  
  
  Set R = Cells(I + 6, KKXJL)
  R.Offset(-1, 0).AutoFill Destination:=Range(R.Offset(-1, 0), R), Type:=xlFillDefault
  Set R = Cells(I + 6, SFGZL)
  R.Offset(-1, 0).AutoFill Destination:=Range(R.Offset(-1, 0), R), Type:=xlFillDefault
  
  Rows(I + 6 + 1).Cut
  Rows(I + 6).Insert
  SheetProtect
  
  |fffd||7b8||fffd||fffd||3fc||fffd||fffd||439||fffd||2bd|
  
  ListBox1.AddItem Trim(sXM.Text)
  For I = 0 To ListBox1.ListCount - 1
     ListBox1.Selected(I) = False
  Next I
  ListBox1.Selected(ListBox1.ListCount - 1) = True
  Application.ScreenUpdating = True
  
AA: ErrSub
End Sub

Private Sub Frame2_Click()

End Sub

Private Sub Label4_Click()

End Sub

Private Sub ListBox1_Change()
  On Error GoTo AA:
  Dim I As Long, J As Long
  
  J = FirstSelected
  If J = -1 Then Exit Sub
  
  sXH = Cells(J + 6, 1)
  sXM = Cells(J + 6, 2)
  sSFZH = Cells(J + 6, 3)
  sZH = Cells(J + 6, 4)
  sBM = Cells(J + 6, 5)
  Cells(J + 6, 2).Activate
    
  sXH.Enabled = False
  sXM.Enabled = False
  sSFZH.Enabled = False
  sZH.Enabled = False
  sBM.Enabled = False
  cBC.Enabled = False

AA: ErrSub
End Sub


Private Sub TextBox1_Change()

End Sub

Private Sub sF_Change()

End Sub

Private Sub UserForm_Initialize()
   On Error GoTo AA:
   ListBox1.Clear
   Dim I, RC As Long
   Dim T As Long
   T = HJH
   If HJH < 7 Then Exit Sub
   
   For I = 6 To T - 1
      ListBox1.AddItem Cells(I, 2)
   Next I
   
   Dim B As DocumentProperty
   '|4aa||fffd||173||fffd| |5e8||fffd||fffd|_  |fffd||fffd||377||fffd||137||1f2||fffd||fffd||fffd||fffd||fffd||fffd||1b5||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd|
   sBM.AddItem ""
   For Each B In ActiveWorkbook.CustomDocumentProperties
       If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then sBM.AddItem B.Name
   Next B
   
   RC = ActiveCell.Row
   If RC < T And RC > 5 Then
      ListBox1.Selected(RC - 6) = True
      sXH = Cells(RC, 1)
      sXM = Cells(RC, 2)
      sSFZH = Cells(RC, 3)
      sZH = Cells(RC, 4)
      sBM = Cells(RC, 5)
   End If
AA: ErrSub
End Sub

Sub |36c||fffd||fffd||fffd||fffd||fffd||4f2||fffd||fffd||fffd|(C As Long)
  On Error GoTo AA:
  Dim S As String, HasS As Boolean, ZJ As Long, I As Long
  S = Trim(sBM.Text)
  If S = "" Then
     If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
     Cells(C + 6, 5) = S
     SheetProtect
  Else
     If sBM.ListCount > 0 Then
        For I = 0 To sBM.ListCount - 1
            If sBM.List(I) = S Then HasS = True: Exit For
        Next I
     End If
     If HasS = False Then
        ZJ = MsgBox("|fffd||fffd|" + S + "|fffd||fffd|" + "|fffd||fffd||fffd||fffd||fffd||435||132||fffd||fffd||fffd||fffd||432||fffd||fffd||fffd||fffd||6a3||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e3||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
        If ZJ = vbYes Then sBM.AddItem S
     End If
     If ZJ = vbYes Or HasS = True Then
           If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
           Cells(C + 6, 5) = sBM.Text
           SheetProtect
     End If
  
     HasS = False
     Dim B As DocumentProperty
     For Each B In ActiveWorkbook.CustomDocumentProperties
         If B.Name = S Then HasS = True: Exit For
     Next B
     If HasS = False And ZJ = vbYes Then ActiveWorkbook.CustomDocumentProperties.Add Name:=S, LinkToContent:=False, Type:=msoPropertyTypeString, Value:=""
  End If
AA:   ErrSub
End Sub


Attribute VB_Name = "UserForm6"
Attribute VB_Base = "0{4452528D-CCB5-4FEE-AA42-74ECBD6C625E}{F2D40B0B-5B2A-40CD-A2A0-BA66EE39082D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub Frame2_Click()

End Sub

Private Sub QD_Click()
  On Error GoTo AA:
    
  Dim strXH As String, strXM As String, strSFZH As String, strZH As String, strBM As String
  
  strXH = Trim(sXH.Text)
  strXM = Trim(sXM.Text)
  strSFZH = Trim(sSFZH.Text)
  strZH = Trim(sZH.Text)
  strBM = Trim(sBM.Text)
  

  'If strXH = "" Then MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||163||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXH.SetFocus: Exit Sub
  If strXM = "" Then MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXM.SetFocus: Exit Sub
  '|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||1ff||fffd||461||fffd||e8ec||fffd||fffd||1ff||fffd||fffd||bc||fffd||fffd|  If strSFZH = "" Then MsgBox "|fffd||fffd||3b4||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||163||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sSFZH.SetFocus: Exit Sub
  
  If Len(strXM) = 2 Or (Len(strXM) = 3 And Mid(strXM, 2, 1) = " ") Then strXM = Left(strXM, 1) + "  " + Right(strXM, 1)
  
  If strSFZH <> "" Then
     Dim SFZts As String
     SFZts = SFZJY(strSFZH)
     If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||b863|", vbCritical, "|fffd||fffd||2be|": sSFZH.SetFocus: Exit Sub
  End If
  
  Dim I As Long, Lcount As Long
  
  Lcount = UserForm5.ListBox1.ListCount - 1
  
  For I = 0 To Lcount
    If strXH <> "" Then If Cells(I + 6, 1) = strXH Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||b863|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXH.SetFocus: Exit Sub
    If Cells(I + 6, 2) = strXM Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||b863|" & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||436||3f2||fffd||36c||5b0||fffd||fffd||fffd||fffd||3a8||4bb||5b5||fffd||fffd||5be||fffd||fffd||fffd||fffd||fffd||532||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||237||2b5||36c||fffd||fffd||fffd||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd| |fffd||237||fffd||2bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a1||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sXM.SetFocus: Exit Sub '|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3aa||3a8||4bb||fffd||fffd||5be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If strSFZH <> "" Then If Cells(I + 6, 3) = strSFZH Then MsgBox "|5b0||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sSFZH.SetFocus: Exit Sub
    If strZH <> "" Then If Cells(I + 6, 4) = strZH Then MsgBox "|5b0||fffd||fffd||fffd||2ba||fffd||fffd||638||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||463||fffd|": sZH.SetFocus: Exit Sub
  Next I
  
  UserForm5.sXH.Text = strXH
  UserForm5.sXM.Text = strXM
  UserForm5.sSFZH.Text = strSFZH
  UserForm5.sZH.Text = strZH
  UserForm5.sBM.Text = strBM
  Unload Me
AA: ErrSub
End Sub

Private Sub TC_Click()
  UserForm5.QuXiao = True
  Unload Me
End Sub


Private Sub UserForm_Initialize()
 On Error GoTo AA:
 
   Dim V  As Variant
   UserForm5.QuXiao = False
 
   V = Cells(HJH - 1, 1)
   If IsNumeric(V) Then
      sXH.Text = V + 1
      If Len(V) - Len(V + 1) > 0 Then sXH.Text = String(Len(V) - Len(V + 1), "0") & CStr(V + 1)
   Else
      sXH.Text = V
   End If
 
   Dim B As DocumentProperty
   sBM.AddItem ""
   For Each B In ActiveWorkbook.CustomDocumentProperties
       If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then sBM.AddItem B.Name
   Next B
AA: ErrSub
End Sub
Attribute VB_Name = "UserForm7"
Attribute VB_Base = "0{B5CD53A7-6531-4FBD-9B19-31B8FCEE032F}{C517E209-7CBF-4FCF-A615-97AED1A49530}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Option Explicit

Private Sub CommandButton1_Click()
On Error GoTo AA:

Dim QR As Long
If O1.Value = True Then '|1ff||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|
   |1ff||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|
   Unload Me
 End If
 
If O2.Value = True Then '|221||fffd||fffd||fffd||535||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||22b||fffd||6c63||fffd||fffd|
   If IsGZB = False Then Exit Sub
   If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then
      Dim I, gzYear, gzMonth As Long
      Dim S1 As String
      
      S1 = Range("A2").Value
      gzYear = Val(Left(S1, 4))
      gzMonth = Val(Mid(S1, 6, InStr(S1, "|fffd||b7||fffd|") - 1))
      If gzYear * 12 + gzMonth < Year(Now) * 12 + Month(Now) Then
         QR = MsgBox("|3aa||237||fffd||fffd||fffd||fffd||1f0||fffd||b7||775||139||fffd||fffd||2b2||fffd||fffd||fffd||fffd||6f8||123||fffd||fffd||fffd||fffd||fffd||221||fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||b7||779||fffd||fffd||2b1||fffd||fffd||fffd||22b||fffd||6c63||fffd||fffd|!" + vbCrLf + vbCrLf + "     |237||2b5||4aa||fffd||7b8||fffd||fffd||fffd||1f0||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical + vbYesNo + vbDefaultButton2, "|fffd||fffd||fffd||fffd|")
         If QR = vbNo Then Unload Me: Exit Sub
      End If
         
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Cells.Locked = True
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
      Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
      SheetProtect
   Else
      MsgBox "|fffd||fffd||3b4||fffd||535||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||22b||fffd||6c63||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   Unload Me
 End If
 

If O5.Value = True Then '|fffd||fffd||fffd||4f8||fffd||fffd||4f1||fffd|
   Dim S As String
   S = InputBox("|fffd||fffd||fffd||fffd||fffd||be3d||fffd||4f1||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|")
   If S = "" Then Exit Sub
   For I = 1 To Sheets.Count
       If S = Sheets(I).Name Then
          MsgBox "|fffd||fffd||fffd||fffd||fffd||1b5||139||fffd||fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||6a3||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|"
          Exit Sub
       End If
   Next I
    
   ThisWorkbook.Unprotect
   Sheets.Add before:=Worksheets(Worksheets.Count - 1)
   ThisWorkbook.Unprotect
   ActiveSheet.Name = S
   ThisWorkbook.Protect Structure:=True
   Unload Me
End If

If O6.Value = True Then '|27e||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||4f1||fffd|
   If IsGZB = True Or ActiveSheet.Name = "|fffd||fffd||fffd||2b5||fffd|" Or ActiveSheet.Name = "|fffd||6fa||3f2||fffd||46f|" Then
      MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f8||fffd||fffd||4f1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
 
   ThisWorkbook.Unprotect
   ActiveSheet.Delete
   ThisWorkbook.Protect Structure:=True
   Unload Me
End If

If O7.Value = True Then '|fffd||fffd||fffd||4f5||fffd||fffd||b9||fffd||fffd||2b1||fffd|
   Dim M As Long
   S = ""
   For I = Sheets.Count To 1 Step -1
       If IsGZB(Sheets(I)) = True Then
          S = Sheets(I).Name
          If InStr(S, "|fffd||b7||fffd|") = 0 Then MsgBox "|fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||139||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd|" & S & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub
          If Right(S, 2) = "|fffd||b7||fffd|" Then Exit For  '|fffd||4b5||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||139||fffd||fffd||fffd||fffd||fffd|
       End If
   Next I
   If S = "" Then MsgBox "|fffd||f9||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||139||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub

   M = Val(Left(S, InStr(S, "|fffd||b7||fffd|") - 1))
   If M < Month(Now) Then
      MsgBox CStr(Month(Now)) + "|fffd||bb||fffd||3b4||fffd||fffd||fffd||179||fffd||fffd||fffd||fffd||2a3||fffd||fffd||b870||5b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b9||fffd||fffd||2a1||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   If M > Month(Now) Then
      MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||2bc||fffd||fffd||fffd||179||fffd||fffd||2a3||fffd||fffd||fffd||fffd||73d||fffd||fffd||434||2f2||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   
   If MsgBox("|fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||7f5||13d||fffd||fffd||fffd||fffd||fffd||fffd||6b2||fffd||fffd||fffd||fffd||fffd||fffd||be64||fffd||2b0||fffd||fffd||fffd||fffd||fffd||73d||fffd||2f0||fffd||fffd||fffd||fffd||2b9||fffd||e1||fffd||fffd||6b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & vbCrLf & "|fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|") <> vbYes Then Exit Sub
   
   
   ThisWorkbook.Unprotect
   Sheets(S).Copy before:=Worksheets(Worksheets.Count - 1)
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).ClearContents
   
   Cells(3, 1).Value = "|fffd||1b1||fffd||2b1||fffd||48fa|" + CStr(Year(Now)) + "|fffd||fffd|" + CStr(Month(Now)) + "|fffd||fffd|" + CStr(Day(Now)) + "|fffd||fffd|"
   Cells.Locked = True
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
   Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
   
   Dim gzHJH As Long
   gzHJH = HJH(ActiveSheet)
   
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||52d||fffd||435||138||fffd||2f0||fffd||fffd||fffd||763||fffd|
   Dim GSrange As Range
   Set GSrange = Range(Cells(6, KXL("|fffd||fffd||2f0|")), Cells(gzHJH - 1, KXL("|fffd||fffd||2f0|")))
   GSrange.ClearContents
   GSrange.Interior.ColorIndex = 0
     
   
   Cells(gzHJH + 1, 1) = "|fffd||fffd||2fe||fffd||cd7c||fffd||fffd|                                            |fffd||fffd||fffd||178||fffd||fffd||fffd||fffd||2e3||fffd|                           "
   Cells(gzHJH + 1, 18) = "|fffd||1b1||fffd||fffd||2e3||fffd|"
   Cells(gzHJH + 2, 1) = "|fffd||fffd||5e2||fffd||fffd|"
   
   'Columns(KXL("|fffd||fffd||fffd||3f1||fffd||fffd||fffd|")).Hidden = True
   'Columns(KXL("|fffd||fffd||fffd||fffd||fffd||fffd|")).Hidden = True
   'Columns(KXL("|4bd||fffd||1b1||fffd||fffd||fffd|")).Hidden = True
   'Columns(KXL("|2a7||4b5||fffd||fffd||fffd||fffd|")).Hidden = True
   'Columns(KXL("|fffd||fffd||4b5||fffd||fffd||fffd|")).Hidden = True

   SheetProtect
   ThisWorkbook.Protect Structure:=True
   Unload Me
End If




If OQN.Value = True Then  '|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd|
   If Year(Now) > 2021 Then MsgBox "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||7e3||fffd||fffd||fffd||fffd||fffd|2019-2021|fffd||fffd||fffd||fffd||427|", vbCritical, "|fffd||fffd||2be|": Exit Sub
   
   S = ""
   For I = Sheets.Count To 1 Step -1
       If IsGZB(Sheets(I)) = True Then
          S = Sheets(I).Name
          If InStr(S, "|fffd||b7||fffd|") = 0 Then MsgBox "|fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||139||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd|" & S & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub
          If Right(S, 2) = "|fffd||b7||fffd|" Then Exit For  '|fffd||4b5||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||139||fffd||fffd||fffd||fffd||fffd|
       End If
   Next I
   If S = "" Then MsgBox "|fffd||f9||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||139||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub

   For I = Sheets.Count To 1 Step -1
       If IsGZB(Sheets(I)) = True Then
          If Sheets(I).Name = S & "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
             MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e1||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
          Else
             If InStr(Sheets(I).Name, "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|") > 0 Then
                If MsgBox("|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||6a1||fffd|" & Sheets(I).Name & "|fffd||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||ff||3bb||531||fffd||fffd||ff||fffd||fffd||5bb||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||3b8||fffd||fffd||fffd||fffd||7e3||fffd||5bb||fffd||431||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||738||fffd||fffd||fffd||fffd||7f5||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||437||fffd||fffd||17d||fffd||e8ec||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|") <> vbYes Then Exit Sub
             End If
          End If
       End If
   Next I

   
   
   M = Val(Left(S, InStr(S, "|fffd||b7||fffd|") - 1))
   If M < Month(Now) Then
      MsgBox CStr(Month(Now)) + "|fffd||bb||fffd||3b4||fffd||fffd||fffd||179||fffd||fffd||fffd||fffd||2a3||fffd||fffd||b870||5b4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b9||fffd||fffd||2a1||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   If M > Month(Now) Then
      MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||2bc||fffd||fffd||fffd||179||fffd||fffd||2a3||fffd||fffd||fffd||fffd||73d||fffd||fffd||434||2f2||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   
   If MsgBox("      |fffd||fffd||fffd||463||fffd||fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||7f5||13d||fffd||fffd||23b32||fffd||fffd||fffd||fffd||be64||fffd||2b0||fffd||fffd||fffd||fffd||fffd||73d||fffd||2f0||fffd||fffd||fffd||fffd||fffd||5bc||fffd||fffd||3ba||fffd||2f0||1f0||fffd||6f3||fffd||fffd||e8ec||fffd||fffd||fffd||6b6||de2|1|fffd||fffd||1ee||fffd||f7b||fffd||fffd||1e7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||ccbb||fffd||38ec|2019-2021|fffd||fffd||ff||fffd||fffd||ff||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||3b4||fffd||fffd||fffd||fffd||7e3||fffd||fffd||fffd||fffd||fffd||fffd||23d||fffd||fffd||433||feee||fffd||fffd||fffd||fffd||fffd||fffd||fffd||235||fffd||fffd||fffd||fffd||fffd||677||fffd||fffd||fffd||57e||fffd||fffd||fffd||fffd||165||fffd||2fd||2cec||fffd||fffd||2b5||fffd||f5||133||feee||fffd||fffd||fffd||261||fffd|" & vbCrLf & vbCrLf & "|fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|") <> vbYes Then Exit Sub
   
  
   ThisWorkbook.Unprotect
   Sheets(S).Copy before:=Worksheets(Worksheets.Count - 1)
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).ClearContents
   
   Range("A2").Value = Replace(Range("A2").Value, "|fffd||fffd||fffd||2b1||fffd|", "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd|")
   Cells(3, 1).Value = "|fffd||1b1||fffd||2b1||fffd||48fa|" + CStr(Year(Now)) + "|fffd||fffd|" + CStr(Month(Now)) + "|fffd||fffd|" + CStr(Day(Now)) + "|fffd||fffd|"
   Cells.Locked = True
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
   Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"

   
   Dim SH As Worksheet
   Set SH = ActiveSheet
   
   SH.Name = Left(SH.Name, InStr(SH.Name, "|fffd||b7||fffd|") + 1) & "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|"
   
   gzHJH = HJH(SH)
   
   Cells(gzHJH + 1, 1) = "|fffd||fffd||2fe||fffd||cd7c||fffd||fffd|                                            |fffd||fffd||fffd||178||fffd||fffd||fffd||fffd||2e3||fffd|                           "
   Cells(gzHJH + 1, 18) = "|fffd||1b1||fffd||fffd||2e3||fffd|"
   Cells(gzHJH + 2, 1) = "|fffd||fffd||5e2||fffd||fffd|"
   
   
   Dim GSL As Long
   GSL = KXL("|fffd||fffd||2f0|")
   Set GSrange = Range(Cells(6, GSL), Cells(gzHJH - 1, GSL))
   GSrange.ClearContents
   GSrange.Interior.ColorIndex = 0
   
   '|fffd||fffd||fffd||4f8||fffd||2f0||fffd||fffd||2bd||fffd||fffd|
   Cells(6, GSL).Formula = "=QNJ(" & Cells(6, KXL("|4e6||fffd||fffd||421||fffd||fffd|")).Address(False, False) & ")"
   Cells(6, GSL).AutoFill Destination:=GSrange

   
   Range(Cells(1, 6 + 1), Cells(1, SFGZL - 1)).EntireColumn.Hidden = True  '|fffd||fffd|6|fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||135||fffd||4bb||fffd||fffd|
   Cells(5, 6).Value = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" '|fffd||fffd|6|fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||135||fffd||4bb||fffd||fffd|
   Columns(6).ColumnWidth = 15  '|fffd||fffd|6|fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||135||fffd||4bb||fffd||fffd|
   Columns(KXL("|4e6||fffd||fffd||421||fffd||fffd|")).ColumnWidth = 15
   Columns(GSL).ColumnWidth = 15
   Columns(SFGZL).ColumnWidth = 15
   Columns(KXL("|4e6||fffd||fffd||421||fffd||fffd|")).Hidden = False
   Columns(GSL).Hidden = False
   

   SheetProtect
   ThisWorkbook.Protect Structure:=True
   Unload Me


End If







If O8.Value = True Then '|27e||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|
   If IsGZB = False Then
      MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then
      MsgBox "|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||47e||fffd||22b||fffd||6c63||fffd||fffd||fffd||139||fffd||fffd||2b1||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   
   Dim SheetCount As Long
   SheetCount = 0
   For I = 1 To Sheets.Count - 2
       If IsGZB(Sheets(I)) = True Then SheetCount = SheetCount + 1
   Next I
   If SheetCount < 2 Then
      MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||13f||1f0||3a8||4bb||fffd||139||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   ThisWorkbook.Unprotect
   ActiveSheet.Delete
   ThisWorkbook.Protect Structure:=True
   Unload Me
End If




If O9.Value = True Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||b9||fffd||fffd||2b1||fffd|
   S = ""
   For I = Sheets.Count To 1 Step -1
       If IsGZB(Sheets(I)) = True And Right(Sheets(I).Name, 2) = "|fffd||b7||fffd|" Then  '|fffd||4b5||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||b5||fffd||4bb||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||139||fffd||fffd||fffd||fffd||fffd|
          S = Sheets(I).Name
          Exit For
       End If
   Next I
   
   If InStr(S, "|fffd||b7||fffd|") = 0 Then
      MsgBox "|fffd||f9||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||139||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
      Exit Sub
   End If
   
   Sheets(I).Activate
   |1ff||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|
   
   M = Val(Left(S, InStr(S, "|fffd||b7||fffd|") - 1))
   If M < 12 Then
      ThisWorkbook.Unprotect
      Sheets(I).Copy before:=Worksheets(Worksheets.Count - 1)
      ActiveSheet.Name = CStr(M + 1) + "|fffd||b7||fffd|"
      ThisWorkbook.Protect Structure:=True
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range("A2").Value = Left(Range("A2").Value, 5) + CStr(M + 1) + "|fffd||b7||779||fffd||fffd||2b1||fffd|"
      Cells(3, 1).Value = "|fffd||1b1||fffd||2b1||fffd||48fa|" + CStr(Year(Now)) + "|fffd||fffd|" + CStr(Month(Now)) + "|fffd||fffd|" + CStr(Day(Now)) + "|fffd||fffd|"
      
      Cells.Locked = True
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
      Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
      
      '|fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||763||fffd|
     'Dim GSL As Long
     GSL = KXL("|fffd||fffd||2f0|")
     Range(Cells(6, GSL), Cells(HJH - 1, GSL)).ClearContents
     
     SheetProtect
      
     '========|fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||7bd||fffd||5ea||fffd||fffd||fffd||fffd||fffd||fffd|=========================================
      Dim Px As DocumentProperty
      Dim SZ() As String
       
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             If Px.Value <> "" Then
                SZ = Split(Px.Value, ",")
                If Val(SZ(M - 1)) > 0 Then
                   If Val(SZ(M)) = 0 Then SZ(M) = SZ(M - 1)
                   Px.Value = Join(SZ, ",")
                End If
             End If
             Exit For
          End If
      Next Px
      
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             S1 = Px.Value
             If S1 <> "" Then
                If InStr(S1, ",") = 0 Then S1 = S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1
                SZ = Split(S1, ",")
                SZ(M) = SZ(M - 1)
                Px.Value = Join(SZ, ",")
             End If
             Exit For
          End If
      Next Px
    
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             If Px.Value <> "" Then
                SZ = Split(Px.Value, ",")
                If Val(SZ(M - 1)) > 0 Then
                   If Val(SZ(M)) = 0 Then SZ(M) = SZ(M - 1)
                   Px.Value = Join(SZ, ",")
                End If
             End If
             Exit For
          End If
      Next
    '=========================================================================================
      
   End If
   
   If M = 12 Then '|fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Application.DisplayAlerts = False
      Application.ScreenUpdating = False
      S = Range("A1").Value + CStr(Val(Left(Range("A2").Value, 4)) + 1) + "|fffd||fffd||239||fffd||fffd||fffd||3f5||373|.xlsm"
      S = ThisWorkbook.Path + "\" + S
      ThisWorkbook.SaveCopyAs S
      Workbooks.Open S
      ActiveWorkbook.Unprotect
      
      Sheets(I).Move before:=Worksheets(Worksheets.Count - 1)
      Do While Sheets.Count > 3
         Sheets(1).Delete
      Loop
      Sheets(1).Name = "1|fffd||b7||fffd|"
      Sheets(1).Activate
      ActiveWorkbook.Protect Structure:=True
      
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Range("A2").Value = CStr(Val(Left(Range("A2").Value, 4)) + 1) + "|fffd||fffd|1|fffd||b7||779||fffd||fffd||2b1||fffd|"
      Cells(3, 1).Value = "|fffd||1b1||fffd||2b1||fffd||48fa|" + CStr(Year(Now)) + "|fffd||fffd|" + CStr(Month(Now)) + "|fffd||fffd|" + CStr(Day(Now)) + "|fffd||fffd|"
      
      Cells.Locked = True
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
      Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
      
      '|fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||763||fffd|
     GSL = KXL("|fffd||fffd||2f0|")
     Range(Cells(6, GSL), Cells(HJH - 1, GSL)).ClearContents
      
      SheetProtect
      
      
      '========|fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||7bd||fffd||5ea||fffd||fffd||fffd||fffd||fffd||fffd|=========================================
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             If Px.Value <> "" Then
                SZ = Split(Px.Value, ",")
                If Val(SZ(12 - 1)) > 0 Then '12|fffd||fffd|
                   Px.Value = SZ(12 - 1) & ",0,0,0,0,0,0,0,0,0,0,0"
                End If
             End If
             Exit For
          End If
      Next Px
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             S1 = Px.Value
             If S1 <> "" Then
                If InStr(S1, ",") <> 0 Then SZ = Split(S1, ","): S1 = SZ(12 - 1)
                S1 = S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1 & "," & S1
                Px.Value = S1
             End If
             Exit For
          End If
      Next Px
      For Each Px In ActiveWorkbook.CustomDocumentProperties
          If Px.Name = "|5e8||fffd||fffd|_|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
             If Px.Value <> "" Then
                SZ = Split(Px.Value, ",")
                If Val(SZ(12 - 1)) > 0 Then '12|fffd||fffd|
                   Px.Value = SZ(12 - 1) & ",0,0,0,0,0,0,0,0,0,0,0"
                End If
             End If
             Exit For
          End If
      Next
    '=========================================================================================
    
      ActiveWorkbook.Save
      
      ActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly
      ActiveWorkbook.Close False
      Application.ScreenUpdating = True
      Application.DisplayAlerts = True
      MsgBox "|fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||239||fffd||fffd||2b1||fffd||fffd||fffd|" + vbCrLf + S, vbInformation, "|2f5||fffd||fffd|"
   End If
   Unload Me
End If

AA: ErrSub
End Sub

Private Sub CommandButton2_Click()
  Unload Me
End Sub



Private Sub UserForm_Initialize()
On Error GoTo AA:
 If IsGZB = True Then
    O6.Enabled = False
 Else
    O1.Enabled = False
    O2.Enabled = False
    O7.Enabled = False
    O8.Enabled = False
    O9.Enabled = False
 End If
 
AA:
ErrSub
End Sub

Sub |1ff||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|()
   If IsGZB = False Then Exit Sub
   If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then
      Exit Sub
   End If
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   Cells.Locked = True
   Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 0
   
   Dim GSL As Long
   GSL = KXL("|fffd||fffd||2f0|")
   Range(Cells(6, GSL), Cells(HJH - 1, GSL)).Interior.ColorIndex = 0
   
   Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|22b||fffd||6c63||fffd||fffd|"
    SheetProtect
End Sub

Attribute VB_Name = "UserForm8"
Attribute VB_Base = "0{2D96A1CA-4F48-479E-9DFC-91D2043AB43E}{844899F6-B995-4C19-9B7E-B1214B0115AB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Public TotalL As Long

Private Sub chkHLQNJ_Click()
  On Error GoTo AA
  Dim S As String, I As Long
  S = oGZB.Text
    
  oGZB.Clear
  oGZB.AddItem "|22b||fffd||fffd|"
  For I = 1 To Sheets.Count
      If IsGZB(Sheets(I)) = True Then
         If chkHLQNJ.Value = False Or (chkHLQNJ.Value = True And Right(Sheets(I).Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|") Then
            oGZB.AddItem Sheets(I).Name
         End If
      End If
  Next I
  
  If chkHLQNJ.Value = True And Right(S, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
     oGZB.ListIndex = 0
  Else
    oGZB.Text = S
  End If
  
AA:  ErrSub
End Sub

Private Sub CommandButton1_Click()
  Unload Me
End Sub
Sub |fffd||fffd||2be||fffd||fffd|()
  On Error GoTo AA:
  With Sheets("|fffd||6fa||3f2||fffd||46f|")
       If .ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
       .Cells.ClearContents
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||fffd||fffd||13f| HLqnj:=chkHLQNJ.Value
 
       .Cells(1, 2) = "|fffd||6fa||3f2||fffd||46f|"
       .Cells(2, 2) = "|fffd||b7||fffd|"
       .Cells(2, 3) = "|fffd||fffd||fffd||fffd|"
       .Cells(2, 4) = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|"
       .Cells(2, 5) = "|fffd||2ba||fffd|"
       .Cells(2, 6) = "|fffd||fffd||fffd||fffd|"  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
 
       Dim I, X, L, BDL, Si As Long
 
       For I = 1 To UBound(YFarray) - 1
           .Cells(2, 6 + I) = YFarray(I)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
       Next I
       .Cells(2, 6 + I) = "|4e6||fffd||fffd||421||fffd||fffd|"  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
 
       For I = 1 To UBound(KKarray) - 1
           .Cells(2, 6 + UBound(YFarray) + I) = KKarray(I)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
       Next I
 
       .Cells(2, 6 + UBound(YFarray) + I) = "|fffd||6ff||fffd||421||fffd||fffd|"
       .Cells(2, 6 + UBound(YFarray) + I + 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
       .Cells(2, 6 + UBound(YFarray) + I + 2) = "|2b5||fffd||fffd||fffd||fffd||fffd||fffd|"
       TotalL = 6 + UBound(YFarray) + I + 2
  End With
AA: ErrSub
End Sub

Sub |fffd||fffd||46f|()
 Dim I As Long, X As Long, L As Long, BDL As Long, Si As Long, HJ As Long
 Dim SH As String, Sx As String, Ssfz As String, SZ As String, Sb As String
 Dim sGZB As String, sBM As String, sXM As String, sXJ As String
 Dim T1 As Boolean, T2 As Boolean, T3 As Boolean
 
 sGZB = oGZB.Text: sBM = oBM.Text: sXM = oXM.Text: sXJ = oXJ.Text
 
 X = 3
 
 Dim IsCX As Boolean
 
 With Sheets("|fffd||6fa||3f2||fffd||46f|")
  .Range(.Cells(2, 7), .Cells(2, TotalL)).EntireColumn.NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "

   For Si = 1 To Sheets.Count
     If IsGZB(Sheets(Si)) = True Then
        IsCX = True
        If chkHLQNJ.Value = True Then
             If Right(Sheets(Si).Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then IsCX = False
        End If

        If IsCX Then
          HJ = HJH(Sheets(Si))
          For I = 6 To HJ - 1
            SH = Sheets(Si).Name
            Sx = Sheets(Si).Cells(I, 2)
            Ssfz = Sheets(Si).Cells(I, 3)
            SZ = Sheets(Si).Cells(I, 4)
            Sb = Sheets(Si).Cells(I, 5)
            
            If sGZB = "|22b||fffd||fffd|" Then T1 = True Else T1 = (SH = sGZB)
            If sBM = "|22b||fffd||fffd|" Then T2 = True Else T2 = (Sb = sBM)
            If sXM = "|22b||fffd||fffd|" Then T3 = True Else T3 = (Sx = sXM)
            
            If T1 And T2 And T3 Then
              .Cells(X, 2) = SH
              .Cells(X, 3) = Sx
              .Cells(X, 4) = "'" + Ssfz
              .Cells(X, 5) = "'" + SZ
              .Cells(X, 6) = Sb  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
            
               For L = 7 To TotalL
                  BDL = KXL(.Cells(2, L), Sheets(Si))
                  If BDL > 0 Then .Cells(X, L) = Sheets(Si).Cells(I, BDL)
               Next L
               X = X + 1
            End If
          Next I
        End If
     End If
   Next Si
 End With
 
 
 Dim XJL As Long, Larray() As Long, SortL As Long
 
 
 If X > 3 Then
    If sXJ = "|fffd||fffd||421||fffd||fffd|" Then
       |368||fffd||fa||3fc||fffd| X
    Else  '|421||fffd||1a3||fffd|
      If sXJ = "|fffd||fffd||fffd||b7||fffd||421||fffd||fffd|" Then XJL = 2: SortL = 2
      If sXJ = "|fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||fffd|" Then XJL = 6: SortL = 6 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||17a||e3b34||fffd|5|fffd||fffd||fffd||fffd||fffd|6
      If sXJ = "|fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||fffd|" Then XJL = 3: SortL = 3
      
      ReDim Larray(7 To TotalL)
      For I = 7 To TotalL
          Larray(I) = I
      Next I
      With Sheets("|fffd||6fa||3f2||fffd||46f|")
          .Range("2:" + CStr(X - 1)).Sort Key1:=.Cells(3, SortL), Header:=xlYes
          .Range("2:" + CStr(X - 1)).Subtotal GroupBy:=XJL, Function:=xlSum, TotalList:=Larray, Replace:=True, PageBreaks:=False, SummaryBelowData:=True
      End With
    End If
 End If
 
 With Sheets("|fffd||6fa||3f2||fffd||46f|")
     .Range(.Cells(2, 2), .UsedRange.SpecialCells(xlCellTypeLastCell)).Borders.LineStyle = xlContinuous
     .Rows(2).HorizontalAlignment = xlCenter
     .Range(.Cells(2, 2), .Cells(2, TotalL)).Interior.ColorIndex = 19
 End With
 
    
End Sub
Private Sub oCX_Click()
  On Error GoTo AA:
  If ActiveWorkbook.ProtectStructure = True Then ActiveWorkbook.Unprotect
  
  With Sheets("|fffd||6fa||3f2||fffd||46f|")
      .Visible = True
      .Activate
      .Cells.Clear

      .Cells.Font.Size = 9
      .Cells.ClearOutline
  End With
  
  ActiveWorkbook.Protect Structure:=True
  ActiveWindow.ScrollRow = 1
  
  |fffd||fffd||2be||fffd||fffd|
  
   Application.ScreenUpdating = False
   |fffd||fffd||46f|
   Application.ScreenUpdating = True
  Unload Me
AA: ErrSub
End Sub

Private Sub UserForm_Initialize()
  On Error GoTo AA:
  Dim I, H, N As Long
  oGZB.Clear
  oGZB.AddItem "|22b||fffd||fffd|"
  For I = 1 To Sheets.Count
      If IsGZB(Sheets(I)) = True Then oGZB.AddItem Sheets(I).Name
  Next I
  oGZB.ListIndex = 0
  
  oBM.Clear
  oBM.AddItem "|22b||fffd||fffd|"
  
  '|4aa||fffd||173||fffd| |5e8||fffd||fffd|_  |fffd||fffd||377||fffd||137||1f2||fffd||fffd||fffd||fffd||fffd||fffd||1b5||fffd||fffd||536||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd|
  Dim B As DocumentProperty
  For Each B In ActiveWorkbook.CustomDocumentProperties
      If Left(B.Name, 3) <> "|5e8||fffd||fffd|_" Then oBM.AddItem B.Name
  Next B
  oBM.ListIndex = 0
  
  oXM.Clear
  oXM.AddItem "|22b||fffd||fffd|"
  Dim XM, S() As String
  ReDim S(1)
  Dim HJ As Long
  Dim hasXM As Boolean
  For I = Sheets.Count To 1 Step -1
      If IsGZB(Sheets(I)) = True Then
         HJ = HJH(Sheets(I))
         For H = 6 To HJ - 1
             XM = Sheets(I).Cells(H, 2)
             hasXM = False
             For N = 1 To UBound(S)
                 If S(N) = XM Then hasXM = True:     Exit For
             Next N
             If hasXM = False Then S(UBound(S)) = XM: ReDim Preserve S(UBound(S) + 1): oXM.AddItem XM
         Next H
      End If
  Next I
  oXM.ListIndex = 0
  
  oXJ.Clear
  oXJ.AddItem "|fffd||fffd||421||fffd||fffd|"
  oXJ.AddItem "|fffd||fffd||fffd||b7||fffd||421||fffd||fffd|"
  oXJ.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||fffd|"
  oXJ.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||421||fffd||fffd|"
  oXJ.ListIndex = 0
AA:
ErrSub

End Sub

Sub |368||fffd||fa||3fc||fffd|(ByVal X As Long)
  With Sheets("|fffd||6fa||3f2||fffd||46f|")
   .Cells(X, 3) = "|fffd||fffd| |fffd||fffd|"
   .Cells(X, 3).Activate
   .Cells(X, 7).Formula = "=SUM(" + "R3C7:R" + CStr(X - 1) + "C7" + ")"
   Dim GS As String
   GS = .Cells(X, 7).Formula
   Do While InStr(GS, "$") > 0
       GS = Replace(GS, "$", "")
   Loop
   .Cells(X, 7).Formula = GS
   .Cells(X, 7).AutoFill Destination:=.Range(.Cells(X, 7), .Cells(X, TotalL)), Type:=xlFillDefault
  End With
End Sub
Attribute VB_Name = "UserForm9"
Attribute VB_Base = "0{92FE8476-DFB1-4F39-B767-89A345FCAF97}{05268FA2-15F9-49D6-8B0A-EC38B4E9C530}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub CommandButton1_Click()
 On Error GoTo AA:
 Dim H1 As Long, H As Long
 Dim S1 As Worksheet
 If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Unload Me: Exit Sub

 
 If ComboBox1.ListCount <= 0 Then Exit Sub
 If CheckBox1.Value = False And CheckBox3.Value = False And CheckBox4.Value = False And CheckBox5.Value = False Then Exit Sub
 
 
 If ComboBox1.Text = ActiveSheet.Name Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b8||fffd||fffd||1bb||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
 Set S1 = Sheets(ComboBox1.Text)
 
 If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
 H1 = HJH(S1): H = HJH(ActiveSheet)
 
 If CheckBox1.Value = True Then CopyBaseInfo S1, H1, H, 1
 If CheckBox3.Value = True Then CopyBaseInfo S1, H1, H, 3
 If CheckBox4.Value = True Then CopyBaseInfo S1, H1, H, 4
 If CheckBox5.Value = True Then CopyBaseInfo S1, H1, H, 5
 
 SheetProtect
 Set S1 = Nothing
 Unload Me
 
 MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||fffd||fffd||263||fffd|", vbInformation, "|fffd||fffd||2be|"

AA: ErrSub
End Sub
Private Sub CopyBaseInfo(ByRef S1 As Worksheet, ByVal H1 As Long, ByVal H As Long, ByVal Col As Long)
    On Error GoTo AA:
    Dim I1 As Long, J As Long
    Dim ZD As String, XM As String
    For I1 = 6 To H1
        ZD = S1.Cells(I1, Col)
        If ZD <> "" Then
           XM = S1.Cells(I1, 2)
           For J = 6 To H
               If Cells(J, 2) = XM Then Cells(J, Col) = IIf(Col = 5, "", "'") & ZD: Exit For
           Next J
        End If
    Next I1
AA: ErrSub
End Sub



Private Sub CommandButton2_Click()
 Dim S As String
 S = S + "|fffd||f9||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||6b4||4fe||270||6c7e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||761||fffd|" + Chr(13) + Chr(13)
 S = S + "    |fffd||fffd||fffd||78ec||fffd||47e||fffd||fffd||43c||fffd||fffd||fffd||fffd||b9||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||fffd||fffd||fffd||a3||fffd||fffd||fffd||1f0||fb||fffd||432||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||4f2||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a3||fffd||fffd||fffd||fffd||fffd||5bb||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||ff||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||432||fffd||fffd||fffd||fffd||fffd||3e2||fffd||7b8||123||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||f8||f7||fffd||fffd||fffd||fffd||fffd||fffd||438||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a5||fffd||48e9||fffd||fffd|"
 MsgBox S, vbInformation, "|fffd||fffd||2be|"
End Sub

Private Sub CommandButton3_Click()
  Unload Me
End Sub

Private Sub UserForm_Initialize()
 On Error GoTo AA:
 Dim I As Long
 For I = 1 To Sheets.Count
    If IsGZB(Sheets(I)) = True Then ComboBox1.AddItem Sheets(I).Name
 Next I
 If ComboBox1.ListCount > 0 Then ComboBox1.ListIndex = 0
AA: ErrSub
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|"
Option Explicit

Public YFarray(), KKarray() As String  '|fffd||fffd||32c||fffd||fffd||fffd||fffd|
Public HLSJ As Boolean  '|fffd||fffd||fffd||fffd||fffd||bc||fffd|
Public ThisWB As Workbook '|fffd||fffd||2b6||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd|

Function GS(|4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd| As Currency, |fffd||6f3||fffd||fffd||fffd||fffd||fffd| As Currency) As Currency  '|fffd||fffd||fffd||fffd||fffd||fffd|
  Dim JE As Currency
  If |4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd| <= 0 Then Exit Function
  
  If |fffd||6f3||fffd||fffd||fffd||fffd||fffd| = 0 Then |fffd||6f3||fffd||fffd||fffd||fffd||fffd| = 5000   '2018|fffd||fffd|10|fffd||fffd|1|fffd||57f||fffd||2bc||5b4||fffd||fffd|
  JE = |4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd| - |fffd||6f3||fffd||fffd||fffd||fffd||fffd|
  If JE > 0 Then
    Select Case JE
    Case Is <= 3000
    GS = JE * 0.03
    Case Is <= 12000
    GS = JE * 0.1 - 210
    Case Is <= 25000
    GS = JE * 0.2 - 1410
    Case Is <= 35000
    GS = JE * 0.25 - 2660
    Case Is <= 55000
    GS = JE * 0.3 - 4410
    Case Is <= 80000
    GS = JE * 0.35 - 7160
    Case Is > 80000
    GS = JE * 0.45 - 15160
   End Select
   GS = Application.WorksheetFunction.Round(GS, 2)
  End If
End Function
Function tgjj(ByVal |fffd||fffd||fffd||fffd||fffd||fffd| As Currency, ByVal |fffd||fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||fffd| As Currency, ByVal |fffd||1f7||fffd||fffd||fffd||4b5||fffd||236||fffd||fffd||fffd||275||139||fffd||fffd||fffd||fffd||fffd||4b2||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3a7| As Boolean) As Currency  '|fffd||fffd||fffd||fffd||fffd||fffd|
  Dim Vgjj As Currency
  Dim JS As Currency
  Dim IsNR As Boolean
  Vgjj = |fffd||fffd||fffd||fffd||fffd||fffd|
  JS = |fffd||fffd||fffd||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||fffd|
  IsNR = |fffd||1f7||fffd||fffd||fffd||4b5||fffd||236||fffd||fffd||fffd||275||139||fffd||fffd||fffd||fffd||fffd||4b2||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3a7|
  
  If IsNR = False Then
     tgjj = IIf(Vgjj >= JS, JS, Vgjj)
  Else
    If Vgjj >= JS Then tgjj = 2 * JS - Vgjj Else tgjj = Vgjj
  End If
End Function

Function QNJ(JE As Currency) As Currency
  Dim KC As Long, SL As Currency, JE1 As Currency
  If JE > 0 Then
     JE1 = JE / 12
     Select Case JE1
            Case Is <= 3000: SL = 0.03: KC = 0
            Case Is <= 12000: SL = 0.1: KC = 210
            Case Is <= 25000: SL = 0.2: KC = 1410
            Case Is <= 35000: SL = 0.25: KC = 2660
            Case Is <= 55000: SL = 0.3: KC = 4410
            Case Is <= 80000: SL = 0.35: KC = 7160
            Case Is > 80000: SL = 0.45: KC = 15160
     End Select
     QNJ = Application.WorksheetFunction.Round(JE * SL - KC, 2)
  End If
End Function


Function JY(|fffd||fffd||fffd| As Currency) As Currency '|5bb||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||1fe||37d||fffd|1|52a|
 If |fffd||fffd||fffd| = 0 Then Exit Function
 Dim L, R As Currency
 L = Fix(|fffd||fffd||fffd|)
 R = Round(|fffd||fffd||fffd| - L, 2)
 If Abs(R) >= 0.1 Then JY = L + 1 Else JY = L
End Function
Function ExistGZXM(GZXM As String) As Long           '|237||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||1f7||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd|,1:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,2:|fffd||474||fffd||fffd||fffd|
    Dim I  As Long
    
    Select Case GZXM
       Case "|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|", "|fffd||2ba||fffd|", "|fffd||fffd||fffd||fffd|", "|4e6||fffd||fffd||421||fffd||fffd|", "|fffd||fffd||2f0|", "|fffd||6ff||fffd||421||fffd||fffd|", "|2b5||fffd||fffd||fffd||fffd||fffd||fffd|": ExistGZXM = 1: Exit Function
       Case "|fffd||fffd||fffd||3f1||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|4bd||fffd||1b1||fffd||fffd||fffd|", "|2a7||4b5||fffd||fffd||fffd||fffd|", "|fffd||fffd||4b5||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": ExistGZXM = 1: Exit Function
    End Select
      
    If IsGZB(ActiveSheet) = True Then
       For I = 5 To SFGZL
           If GZXM = Cells(5, I) Then ExistGZXM = 2: Exit Function
       Next I
    End If
End Function


Public Function PiZhu(R As Range) As String
 On Error GoTo pz:
 Dim S As String
 PiZhu = R.Comment.Text
 Exit Function
pz:
End Function

Function SFGZL(Optional SH As Worksheet) As Long '|237||fffd||fffd||2b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim Rx As Range
 If SH Is Nothing Then Set SH = ActiveSheet

 For Each Rx In Intersect(SH.UsedRange, SH.Rows("4:5"))
     If Rx.Value = "|2b5||fffd||fffd||fffd||fffd||fffd||fffd|" Then SFGZL = Rx.Column:       Exit For
 Next
End Function
Function QTBFL(Optional SH As Worksheet) As Long '|237||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Dim Rx As Range
 If SH Is Nothing Then Set SH = ActiveSheet

 For Each Rx In Intersect(SH.UsedRange, SH.Rows("4:5"))
     If Rx.Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then QTBFL = Rx.Column:       Exit For
 Next
End Function

Function YFXJL(Optional SH As Worksheet) As Long '|237||fffd||fffd||4e6||fffd||fffd||421||fffd||fffd||fffd||fffd|
 Dim Rx As Range
 If SH Is Nothing Then Set SH = ActiveSheet
 For Each Rx In Intersect(SH.UsedRange, SH.Rows("4:5"))
     If Rx.Value = "|4e6||fffd||fffd||421||fffd||fffd|" Then YFXJL = Rx.Column:       Exit For
 Next
End Function
Function KKXJL(Optional SH As Worksheet) As Long '|237||fffd||fffd||fffd||6ff||fffd||421||fffd||fffd||fffd||fffd|
 Dim Rx As Range
 If SH Is Nothing Then Set SH = ActiveSheet
 For Each Rx In Intersect(SH.UsedRange, SH.Rows("4:5"))
     If Rx.Value = "|fffd||6ff||fffd||421||fffd||fffd|" Then KKXJL = Rx.Column:       Exit For
 Next
End Function
Function KXL(|fffd||fffd||fffd||fffd||fffd||fffd| As String, Optional SH As Worksheet) As Long '|237||fffd||fffd||fffd||fffd||461||fffd||fffd|
 Dim Rx As Range
 If SH Is Nothing Then Set SH = ActiveSheet
 For Each Rx In Intersect(SH.UsedRange, SH.Rows("4:5"))
     If Rx.Value = |fffd||fffd||fffd||fffd||fffd||fffd| Then KXL = Rx.Column:             Exit For
 Next
End Function
Function HJH(Optional SH As Worksheet) As Long  '|237||fffd||fffd||fffd||3fc||fffd||fffd||fffd|
 Dim I As Long, RowCount As Long
 
 If SH Is Nothing Then Set SH = ActiveSheet
 RowCount = SH.Cells(SH.Rows.Count, 1).End(xlUp).Row
 
 For I = 1 To RowCount
     If SH.Cells(I, 1) = "|fffd||fffd| |fffd||fffd|" Then HJH = I:              Exit For
 Next I
End Function

Function ZGH(|fffd||fffd||fffd||fffd| As String, Optional SH As Worksheet) As Long '|237||fffd||fffd||fffd||fffd||461||fffd||fffd|
 Dim Rx As Range
 Dim H As Long
 H = HJH(SH)
 If SH Is Nothing Then Set SH = ActiveSheet
 For Each Rx In SH.Range(SH.Cells(6, 2), SH.Cells(H - 1, 2))
     If Rx.Value = |fffd||fffd||fffd||fffd| Then ZGH = Rx.Row:                  Exit For
 Next
End Function


Function |fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|(Optional SH As Worksheet) As String
 On Error GoTo AA:
 If SH Is Nothing Then Set SH = ActiveSheet
 
 Dim YFXJL1 As Long, KKXJL1 As Long, HJH1 As Long, SFGZL1 As Long, QTBFL1 As Long
 YFXJL1 = YFXJL(SH)
 KKXJL1 = KKXJL(SH)
 HJH1 = HJH(SH)
 SFGZL1 = SFGZL(SH)
 QTBFL1 = QTBFL(SH)
 
 
 If YFXJL1 = 0 Or KKXJL1 = 0 Or HJH1 = 0 Then
   |fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd| = ""
 Else
   If QTBFL1 > 0 Then
      |fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd| = Union(SH.Range(SH.Cells(3, 1), SH.Cells(3, YFXJL1)), SH.Range(SH.Cells(6, 6), SH.Cells(HJH1 - 1, YFXJL1 - 1)), SH.Range(SH.Cells(6, YFXJL1 + 1), SH.Cells(HJH1 - 1, KKXJL1 - 2)), SH.Range(SH.Cells(HJH1 + 1, 1), SH.Cells(HJH1 + 2, SFGZL1)), SH.Range(SH.Cells(6, QTBFL1), SH.Cells(HJH1 - 1, QTBFL1)), SH.Range(SH.Cells(4, SFGZL1 + 1), SH.Cells(HJH1, SH.Columns.Count))).Address
   Else
      |fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd| = Union(SH.Range(SH.Cells(3, 1), SH.Cells(3, YFXJL1)), SH.Range(SH.Cells(6, 6), SH.Cells(HJH1 - 1, YFXJL1 - 1)), SH.Range(SH.Cells(6, YFXJL1 + 1), SH.Cells(HJH1 - 1, KKXJL1 - 2)), SH.Range(SH.Cells(HJH1 + 1, 1), SH.Cells(HJH1 + 2, SFGZL1)), SH.Range(SH.Cells(4, SFGZL1 + 1), SH.Cells(HJH1, SH.Columns.Count))).Address
   End If
 End If
AA: ErrSub
End Function
Function IsGZB(Optional SH As Worksheet) As Boolean  '|fffd||436||fffd||fffd||1f7||fffd||fffd||1f9||fffd||fffd||2b1||fffd|
  Dim S As String, S1 As String, TJ As Boolean
  On Error GoTo AA:
  If SH Is Nothing Then Set SH = ActiveSheet
  S1 = Trim(PiZhu(SH.Cells(1, 1)))
  '2009|fffd||fffd|4|fffd||fffd|18|fffd||fffd||fffd||fffd||fffd||4e3||fffd||1ff||fffd||fffd||fffd||539||fffd||fffd||2b1||fffd||fffd||fffd||fffd||436||3e3||fffd||fffd||fffd||5b9||fffd||fffd||fffd||4f1||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||1f9||fffd||fffd||2b1||fffd|
  S = SH.Name
  TJ = False
  If (Left(S1, 7) = "%%|fffd||fffd||fffd||2b1||fffd|%%") Then TJ = True Else TJ = False  'A1|fffd||fffd||52a||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd|
  If TJ And ((Len(S) >= 3 And Len(S) <= 4) Or (Len(S) >= 7 And Len(S) <= 9)) Or InStr(S, "|fffd||b7||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|") > 0 Then TJ = True Else TJ = False
  If TJ And (InStr(S, "|fffd||b7||fffd|") >= 2 And InStr(S, "|fffd||b7||fffd|") <= 3) Then TJ = True Else TJ = False
  If TJ And (Val(S) >= 1 And Val(S) <= 12) Then TJ = True Else TJ = False
  If TJ And Len(S) >= 7 And InStr(S, "|fffd||b7||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|") <= 0 Then
     If InStr(S, " (") > 0 And InStr(S, ")") > 0 Then TJ = True Else TJ = False
  End If
  IsGZB = TJ
AA: ErrSub
End Function
Function HasSheet(SheetName) As Boolean  '|fffd||436||fffd||5b8||fffd||fffd||fffd||fffd||fffd||1b5||139||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd|
 On Error GoTo AA:
 Dim I As Long
 For I = 1 To Sheets.Count
     If Sheets(I).Name = SheetName Then HasSheet = True: Exit For
 Next I
AA: ErrSub
End Function


Function SFZJY(|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|, Optional |fffd||531||fffd| As String)
'1|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|15|3bb||fffd||fffd|2|fffd||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd|3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||773||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|1-12)
'4|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b3||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|1-31|fffd||fffd||3a7||fffd||fffd|)|fffd||fffd|5|fffd||fffd|18|3bb||423||fffd||fffd||3bb||fffd||fffd||fffd||fffd||fffd||fffd|6|fffd||fffd|18|3bb||fffd||fffd||fffd||fffd||5a4||fffd||fffd||773||fffd||fffd||fffd|
On Error GoTo AA:
Dim S1, S2 As String
Dim jym, X As Long
Dim NewId As String
Dim I As Long
Dim SID As String

|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd| = Trim(|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|)
SID = CStr(|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|): SID = UCase(SID)
|fffd||531||fffd| = CStr(|fffd||531||fffd|)
If |fffd||531||fffd| = "" Then
   If Len(SID) = 15 Then |fffd||531||fffd| = (Mid(SID, 15, 1) Mod 2)
   If Len(SID) = 18 Then |fffd||531||fffd| = (Mid(SID, 17, 1) Mod 2)
   If |fffd||531||fffd| = "0" Then |fffd||531||fffd| = "2"
End If
If |fffd||531||fffd| = "1" Then X = 1
If |fffd||531||fffd| = "|fffd||fffd|" Then X = 1
If |fffd||531||fffd| = "2" Then X = 0
If |fffd||531||fffd| = "|16e|" Then X = 0
If InStr("12|fffd||fffd||16e|", |fffd||531||fffd|) < 1 Then GoTo XB:

S1 = " 7 910 5 8 4 2 1 6 3 7 910 5 8 4 2"
S2 = "10X98765432"
If Len(SID) <> 15 And Len(SID) <> 18 Then
SFZJY = "|fffd||fffd||fffd||fffd||5a4||3bb||fffd||fffd||fffd||fffd||fffd||fffd|"  '|fffd||fffd||fffd||fffd|15|3bb||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3e2|
ElseIf Len(SID) = 15 And Val(Mid(SID, 7, 2)) < 10 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf Len(SID) = 15 And Val(Mid(SID, 9, 2)) > 12 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||b7||774||fffd||fffd||fffd|!"
ElseIf Len(SID) = 15 And Val(Mid(SID, 11, 2)) > 31 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd|!"
ElseIf Len(SID) = 15 And Mid(SID, 15, 1) Mod 2 <> X Then
SFZJY = "|fffd||531||fffd||fffd||fffd||fffd|!"
ElseIf Len(SID) = 15 Then
NewId = Left(SID, 6) + "19" + Right(SID, 9)
jym = 0
For I = 1 To 17
jym = jym + Val(Mid(S1, I * 2 - 1, 2)) * Val(Mid(NewId, I, 1))
Next I
SFZJY = NewId + Mid(S2, jym Mod 11 + 1, 1)
'|fffd||fffd||fffd||fffd|18|3bb||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3e2|
ElseIf Len(SID) = 18 And Val(Mid(SID, 7, 2)) < 19 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
'ElseIf Len(SID) = 18 And Val(Mid(SID, 9, 2)) < 10 Then
'SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf Len(SID) = 18 And Val(Mid(SID, 11, 2)) > 12 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||b7||774||fffd||fffd||fffd|!"
ElseIf Len(SID) = 18 And Val(Mid(SID, 13, 2)) > 31 Then
SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd|!"
ElseIf Len(SID) = 18 And Mid(SID, 17, 1) Mod 2 <> X Then
SFZJY = "|fffd||531||fffd||fffd||fffd||fffd|!"
Else
NewId = Left(SID, 17)
jym = 0
For I = 1 To 17
jym = jym + Val(Mid(S1, I * 2 - 1, 2)) * Val(Mid(NewId, I, 1))
Next I

If Mid(S2, jym Mod 11 + 1, 1) <> Mid(SID, 18, 1) Then
SFZJY = "|2b6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e6||3aa||fffd||fffd|" & Mid(S2, jym Mod 11 + 1, 1)
Else
SFZJY = "|fffd||fffd||fffd||fffd|"
  If InStr("11,12,13,14,15,21,22,23,31,32,33,34,35,36,37,41,42,43,44,45,46,50,51,52,53,54,61,62,63,64,65,71,81,82,91", Left(|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|, 2)) <= 0 Then SFZJY = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  If Right(CStr(|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd|), 1) = "x" Then SFZJY = SFZJY & "|fffd||fffd|(|423||fffd||fffd||fffd||fffd||3aa||421||434|x)"
End If

End If
GoTo AA:
XB:
SFZJY = "|fffd||531||fffd||fffd||fffd||fffd|"

AA:
If Err.Number <> 0 Then SFZJY = Err.Description
End Function

Function TaxPrompt() As String   '|fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd|
  On Error GoTo AA:
  Dim SH As Worksheet
  Set SH = ActiveSheet
  If IsGZB(SH) And Right(SH.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
     Dim GSJE As Currency
     GSJE = SH.Cells(HJH(SH), KXL("|fffd||fffd||2f0|", SH)).Value
     
     TaxPrompt = "|fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||138||fffd||2f0||fffd||3fc||1bd||fffd||fffd||3aa|" & Format(GSJE, "#,##0.00") & "|52a||fffd||fffd|" + vbCrLf + vbCrLf + "|3aa||237||fffd||fffd||fffd||fffd||2f0||fffd||fffd||237||fffd||523||fffd||fffd||fffd||237||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||771||4daf||fffd||fffd||fffd||fffd||fffd||b4||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||2f8||fffd||2f0||fffd||fffd||fffd||761||fffd|"
  End If
AA: ErrSub
End Function




Attribute VB_Name = "|fffd||2f5||fffd||fffd||bc||fffd|"
Option Explicit
Sub |fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f6||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
    Dim I As Long, Has1 As Boolean
    Has1 = False
    For I = 1 To Sheets.Count
        If IsGZB(Sheets(I)) Then If Left(Sheets(1).Name, 3) = "1|fffd||b7||fffd|" Then Has1 = True: Exit For
    Next I
    If Has1 = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||1f4||fffd|1|fffd||b7||77f||fffd||2bc||fffd||fffd||fffd||f5||123||fffd||fffd||fffd||fffd||73b||fffd||fffd||73c||fffd||fffd||fffd||22b||fffd||fffd||fffd||2f0||fffd||fffd|", vbInformation, "|fffd||fffd||2be|": Exit Sub
    GSHD.Show
AA:  ErrSub
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||3e64||fffd||fffd||43d||fffd||fffd||fffd||2f0|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
   If Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||1f0||fffd||fffd||3aa||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||8d7c||fffd||fffd||fffd||fffd||fffd||775||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub

   TAXexport.Show 1
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||2f0|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
   If Right(ActiveSheet.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||2b9||fffd||e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||3e64||fffd||fffd||43d||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||721||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub

   Dim W As Workbook, W1 As Workbook
   Dim SH As Worksheet, SH1 As Worksheet
   Dim I As Long, S As String, gzHJH As Long, SFZts As String

   Set W = ActiveWorkbook
   Set SH = ActiveSheet
   
   Dim Path As String
   Path = ThisWorkbook.Path
   gzHJH = HJH(SH)
   
   Dim QNJcol As Long
   QNJcol = KXL("|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|")
   If QNJcol = 0 Then MsgBox "|fffd||fffd||1f0||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||2bd||fffd||fffd||fffd||1bb||fffd||fffd||fffd||fffd||7b7||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub

   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd|
   For I = 6 To gzHJH - 1
       S = Trim(SH.Cells(I, 3))
       If S = "" Then MsgBox "|fffd||fffd|" & SH.Name & "|fffd||fffd||fffd||fffd||fffd||171||fffd||fffd||135||fffd|" & CStr(I) & "|fffd||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
       SFZts = SFZJY(S)
       If Left(SFZts, 2) <> "|fffd||fffd||fffd||fffd|" Then MsgBox "|fffd||fffd|" & SH.Name & "|fffd||fffd||fffd||fffd||fffd||171||fffd||fffd||135||fffd|" & CStr(I) & "|fffd||435||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||3aa|" & S & "|fffd||fffd|" & vbCrLf & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & SFZts & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1ba||fffd||fffd||fffd||5b4||fffd||431||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||2be|":    Exit Sub
   Next I

   '|fffd||fffd||fffd||275||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set W1 = Application.Workbooks.Add
    
    Application.DisplayAlerts = False
    If W1.Sheets.Count > 1 Then W1.Sheets(W1.Sheets.Count).Delete
    If W1.Sheets.Count > 1 Then W1.Sheets(W1.Sheets.Count).Delete
    Application.DisplayAlerts = True
    
    ActiveWindow.DisplayGridlines = False
    Set SH1 = W1.ActiveSheet
    With SH1
     .Range("A1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("B1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("C1").Value = "*|5a4||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("D1").Value = "*|5a4||fffd||57a||fffd||fffd||fffd|"
     .Range("E1").Value = "*|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd|"
     .Range("F1").Value = "|fffd||fffd||2f0||fffd||fffd||fffd||fffd|"
     .Range("G1").Value = "|fffd||fffd||4b5|(|5b0||4b5|)|fffd||fffd||fffd|"
     .Range("H1").Value = "|fffd||fffd||4b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     .Range("I1").Value = "|2f0||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd|"
     .Range("J1").Value = "|fffd||fffd||fffd||fffd|"
     .Range("K1").Value = "|5fc||fffd||fffd||6f3||fffd||fffd||13e||fffd||fffd||fffd||fffd||fffd|"
     .Range("L1").Value = "|fffd||fffd||fffd||fffd||2f0||fffd||fffd|"
     .Range("M1").Value = "|fffd||47f||6fd||fffd||2f0||fffd||fffd|"
     .Range("N1").Value = "|fffd||fffd||5e2|"
     
     .Columns("A:N").ColumnWidth = 15
     .Columns(4).ColumnWidth = 20
     .Columns("F:N").Hidden = True
     .Columns("C:N").NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
     
      ActiveWindow.SplitRow = 1
      ActiveWindow.FreezePanes = True
     .Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43d||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    
    '|fffd||fffd||2bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|
    With SH
         For I = 6 To gzHJH - 1
             SH1.Range("A" & I - 4) = "'" & .Range("A" & I)
             SH1.Range("B" & I - 4) = "'" & .Range("B" & I)
             SH1.Range("C" & I - 4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4|"
             SH1.Range("D" & I - 4) = "'" & .Range("C" & I)
             SH1.Range("E" & I - 4) = .Cells(I, QNJcol)
         Next I
    End With


    S = SH.Range("A2").Value
    W1.SaveAs Path & "\" & Left(S, InStr(S, "|fffd||fffd|")) & "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|(|fffd||fffd||fffd||fffd||fffd||ac68||fffd||fffd||2f0|).xls", xlExcel8
    W1.Activate
    W1.Sheets(1).Activate
    
    Set SH = Nothing: Set SH1 = Nothing
    
    MsgBox "|fffd||47e||fffd||fffd||fffd||275||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|"

AA: ErrSub
End Sub


Sub |fffd||7b8||138||fffd||2f0||fffd||fffd||fffd||771||f2d||5f4||32c|_Click(Optional control As IRibbonControl)
   On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
   If Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||1f0||fffd||fffd||3aa||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b9||fffd||fffd||7b8||138||fffd||2f0||fffd||fffd||fffd||761||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub
   If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
   
   If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
   
   Dim GSL As Long
   GSL = KXL("|fffd||fffd||2f0|")
   
   Dim R As Range
   Set R = Range(Cells(6, GSL), Cells(HJH - 1, GSL))
   Dim LockStatus As Boolean
   LockStatus = R.Locked
   R.Locked = Not LockStatus
   
   R.Interior.ColorIndex = IIf(LockStatus, 20, 0)
   Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
   
   SheetProtect

AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
   If Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||1f0||fffd||fffd||3aa||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||761||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub

   If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
   
   Dim W As Workbook, W1 As Workbook
   Dim SH As Worksheet, SH1 As Worksheet, SHx As Worksheet
   Dim I As Long, J As Long, MaxH As Long, gzHJH As Long
   Dim S As String, GSL As Long, GSJE As Currency, SWzgs As Currency, GZzgs As Currency
   
   Set W = ActiveWorkbook
   Set SH = ActiveSheet

   
 '|fffd||fffd||fffd||fffd||2bd|
  gzHJH = HJH(SH)
  If gzHJH < 8 Then
    MsgBox "|fffd||fffd||fffd||6b5||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||123||fffd||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|" + vbCrLf + " |fffd||fffd||fffd||fffd||fffd||fffd|Excel|fffd||fffd|SUM|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":      Exit Sub
  End If

  If MsgBox("|fffd||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||763||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||438||fffd||2f0||fffd||fffd||fffd||763||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|") <> vbYes Then Exit Sub
   
   With Application.FileDialog(msoFileDialogOpen)
    .Show
     If .SelectedItems.Count = 0 Then Exit Sub
     Set W1 = Workbooks.Open(.SelectedItems.Item(1), , True)
 End With
 Set SH1 = W1.Sheets(1)
 W.Activate

   Dim DIC
   Set DIC = CreateObject("scripting.dictionary")


 '|fffd||fffd||2bd||fffd||fffd||9f30||fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||fffd||fffd||98fa|
  With SH1
       If .Range("D1") <> "|5a4||fffd||57a||fffd||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|D1|fffd||fffd||52a||fffd||fffd||fffd||fffd||3aa||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||3aa||5a4||fffd||57a||fffd||fffd||b8e1|", vbCritical, "|fffd||fffd||2be|": W1.Close False: Exit Sub
       If .Range("AJ1") <> "|fffd||6fc||fffd||4e6||fffd||fffd|(|fffd||fffd|)|2f0||fffd||fffd|" Then MsgBox "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd|AJ1|fffd||fffd||52a||fffd||fffd||fffd||fffd||3aa||fffd||5b6||fffd||fffd||fffd||fffd||1a3||fffd||fffd||fffd||fffd||fffd||3aa||fffd||6fc||fffd||4e6||fffd||fffd|(|fffd||fffd|)|2f0||fffd||e8e1|", vbCritical, "|fffd||fffd||2be|": W1.Close False: Exit Sub
       MaxH = .UsedRange.Rows.Count
       For I = 2 To MaxH
           S = Trim(.Cells(I, 4))  '|5a4||fffd||57a||fffd||fffd||fffd|
           If S <> "" Then
              GSJE = .Range("AJ" & I)
              DIC(S) = GSJE
              SWzgs = SWzgs + GSJE
           Else
              MaxH = I: Exit For
           End If
        Next I
  End With
  W1.Close False
  Set W1 = Nothing: Set SH1 = Nothing
  
  
  Dim FileOpened As Boolean, CanDR As Boolean, JGfile As String
  Application.ScreenUpdating = False
  If Right(W.Path, 1) = "\" Then JGfile = Left(W.Path, Len(W.Path) - 1) Else JGfile = W.Path
  JGfile = JGfile + "\" + "temp.txt"
  Open JGfile For Output As #1: FileOpened = True
  If SH.ProtectContents = True Then SH.Unprotect "gzglxt"
  
  Dim strSFZH As String
  Dim H As Long, XH As Long
  Dim S1 As String
  
  
  Dim strBaseYF  As String
  strBaseYF = Left(SH.Name, InStr(SH.Name, "|fffd||b7||fffd|") - 1) + "|fffd||b7||fffd|"
  
  For XH = 1 To Sheets.Count
       Set SHx = Sheets(XH)
       If IsGZB(SHx) And Left(SHx.Name, Len(strBaseYF)) = strBaseYF And Right(SHx.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then  '|fffd||fffd||fffd||fffd||fffd||7b3||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||435||138||fffd||2f0||fffd||fffd|
          gzHJH = HJH(SHx)
          GSL = KXL("|fffd||fffd||2f0|", SHx)
          If SHx.Name <> SH.Name Then
             For I = 6 To gzHJH - 1
                 GSJE = SHx.Cells(I, GSL).Value
                 If GSJE <> 0 Then
                    S = SHx.Cells(I, 3)
                    If DIC.Exists(S) Then DIC(S) = DIC(S) - GSJE: GZzgs = GZzgs + GSJE
                 End If
             Next I
             Print #1, "|fffd||2d7c||fffd||fffd||fffd||2f0||fffd||fffd||3f5||373||fffd||fffd||2f0||fffd||fffd||fffd||763||fffd||fffd||47e||fffd||fffd||6fc||fffd||fffd||2e1||fffd|" & SHx.Name & "|fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||e863|"
             Print #1, ""
          End If
       End If
  Next XH
  Set SHx = Nothing
  
  '|fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||763||fffd|
   gzHJH = HJH(SH)
   GSL = KXL("|fffd||fffd||2f0|", SH)
   SH.Range(SH.Cells(6, GSL), SH.Cells(gzHJH - 1, GSL)).ClearContents
              
   For I = 6 To gzHJH - 1
       S1 = Trim(SH.Cells(I, 2))
       S = Trim(SH.Cells(I, 3))
       If DIC.Exists(S) Then
          GSJE = DIC(S)
          GZzgs = GZzgs + GSJE
          SH.Cells(I, GSL) = GSJE
          DIC(S) = 0
          Print #1, "|fffd||475||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa|" & S1 & "|fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||3aa|" & S & "|fffd||138||fffd||2f0||fffd||fffd||fffd||763||fffd|" & GSJE
      End If
  Next I


  SheetProtect SH
  Application.ScreenUpdating = True
  
  Print #1, ""
  If Abs(SWzgs - GZzgs) >= 0.01 Then
     Print #1, "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||738||fffd||2f0||fffd||fffd||fffd||3aa|" & SWzgs & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||738||fffd||2f0||fffd||fffd||fffd||3aa|" & GZzgs & " |fffd||fffd||fffd||fffd||fffd||fffd||e8fa| " & SWzgs - GZzgs
  Else
     Print #1, "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||738||fffd||2f0||fffd||fffd||fffd||3aa|" & SWzgs & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||738||fffd||2f0||fffd||fffd||fffd||3aa|" & GZzgs & " |fffd||fffd||fffd||fffd||fffd||fffd||22b||4bb||fffd||a1||fffd| "
  End If
  
  
  Dim DicKeys(), DicValues()
  DicKeys = DIC.Keys: DicValues = DIC.items
  Print #1, ""
  For I = 0 To DIC.Count - 1
      If DicValues(I) <> 0 Then Print #1, "|2f0||fffd||fffd||3f5||373||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||3aa|" & DicKeys(I) & "|fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fb||fffd||438||fffd||fffd||fffd||fffd||fffd||5a4||fffd||175||fffd||531||fffd||fffd||fffd||fffd|" & " |fffd||fffd||fffd||2f0||fffd||fffd||fffd| " & DicValues(I) & "|3b4||fffd||735||fffd||fffd||b863|"
  Next I
  Close #1
  
  Set W = Nothing
  Set SH = Nothing:
  Set DIC = Nothing
  

  MsgBox "|fffd||fffd||fffd||775||fffd||fffd||fffd||fffd||fffd||263||fffd|", vbInformation, "|fffd||fffd||2be|"
  Shell "notepad.exe " + JGfile, vbNormalFocus
  
AA: ErrSub:  If FileOpened = True Then Close #1
End Sub

Sub ErrPrompt()
   MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||fffd||fffd||221||fffd||fffd||22b||fffd||6c63||fffd||fffd||5ae||1f0||fffd||fffd||fffd||fffd||fffd||7b8||123||fffd|" + Chr(13) + Chr(13) + "(|fffd||6a1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||423||fffd||fffd||1e69||fffd||2e1||fffd||221||fffd||fffd||fffd||535||fffd||1f0||fffd||fffd||fffd||2b1||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||721||fffd|)", vbInformation, "|fffd||fffd||2be|"
End Sub
Sub |fffd||fffd||2be||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
    
    If Columns("E").Hidden = False Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|", vbInformation, "|fffd||fffd||2be|":  Exit Sub
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("E").Hidden = False
    SheetProtect
AA: ErrSub
End Sub
Sub |fffd||fffd||fffd||632||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

    If Columns("E").Hidden = True Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||623||fffd|", vbInformation, "|fffd||fffd||2be|":  Exit Sub
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("E").Hidden = True
    SheetProtect
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

    ActiveWindow.FreezePanes = False
    Rows("1:3").Hidden = False
    
    ActiveWindow.SplitRow = 0
    ActiveWindow.SplitColumn = 0
    Cells(1).Select
    
    ActiveWindow.SplitColumn = 2
    ActiveWindow.SplitRow = 5
    ActiveWindow.FreezePanes = True
AA: ErrSub
End Sub
Sub |fffd||fffd||236||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

    ActiveWindow.FreezePanes = False
    Rows("1:3").Hidden = False
    ActiveWindow.SplitRow = 0
    ActiveWindow.SplitColumn = 0
    Cells(1).Select

    
    ActiveWindow.SplitColumn = 2
    ActiveWindow.SplitRow = 5
    ActiveWindow.FreezePanes = True
    Rows("1:3").Hidden = True
AA: ErrSub
End Sub
Sub |221||fffd||fffd||fffd||fffd||fffd||fffd||fffd||436||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

    Rows("1:3").Hidden = False
    ActiveWindow.SplitColumn = 0
    ActiveWindow.SplitRow = 0
    Cells(1).Select

    ActiveWindow.FreezePanes = False
AA: ErrSub
End Sub
Sub |fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||174||fffd||4e1||fffd||139||fffd||fffd||2b1||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

  Dim B As Boolean, H As Long
  Dim I As Long, J As Long, LastJ As Long, Li As Long, L As Long, S As String, Sx As String
  Dim FY As Long
  Dim sXJ As String
  Dim Rxj As Range  '20100902
  
  If IsGZB And TaxPrompt <> "" Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
     If I = vbNo Then Exit Sub
  End If
  
  Application.ScreenUpdating = False
  FY = MsgBox("|fffd||1f7||70d32||fffd||fffd||17d||fffd||fffd||437||fffd||4b3||fffd||fffd|", vbInformation + vbYesNo, "|fffd||fffd||2be|")
  B = IsGZB(ActiveSheet)
  H = HJH(ActiveSheet)
  L = SFGZL(ActiveSheet)
  Cells.Copy
  Workbooks.Add

  Cells.PasteSpecial xlPasteValues  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||678||fffd||2bd|
  Cells.PasteSpecial xlPasteFormats
  With ActiveSheet.PageSetup
         If B = True Then .PrintTitleRows = "$1:$5"
        .Orientation = xlLandscape
        .BlackAndWhite = True
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
  End With
  ActiveWindow.DisplayGridlines = False
  Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|(ActiveSheet)).Interior.ColorIndex = 0

  ActiveWindow.ScrollRow = 1
  Cells(1, 1).Select
  Columns("C:D").Hidden = True
  Columns(2).ColumnWidth = 12
  Range("6:" + CStr(H - 1)).Sort Key1:=Range("E6")  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd|D|fffd||431||fffd||fffd|E|fffd||423||fffd|
  ActiveSheet.Name = "|fffd||fffd||3f8||fffd||fffd|"
  Application.DisplayAlerts = False
  If Sheets.Count > 1 Then Sheets(2).Delete
  If Sheets.Count > 1 Then Sheets(2).Delete
  Application.DisplayAlerts = True
  
  S = Cells(6, 5)  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||434||4f5||fffd|4|fffd||431||fffd||275||fffd|5|fffd||423||fffd|
  LastJ = 6
  J = 6 + 1
  
  Set Rxj = Range("1:5") '20100902
  
  For I = 6 + 1 To H - 1
      Sx = Cells(J, 5) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||434||4f5||fffd|4|fffd||431||fffd||275||fffd|5|fffd||423||fffd|
      If Sx <> S Then
         Rows(J).Insert
         If FY = vbYes Then ActiveSheet.HPageBreaks.Add before:=Cells(J + 1, 1)
         Range("A" + CStr(J) + ":B" + CStr(J)).Merge
         Cells(J, 1) = S + "|421||fffd||fffd|"
         sXJ = sXJ & CStr(J) + ":" + CStr(J) + ","
         Set Rxj = Union(Rxj, Range(CStr(J) + ":" + CStr(J))) '20100902
         For Li = 6 To L  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bc||fffd||431||fffd||fffd||fffd||2f5||fffd|6|fffd||fffd|
             Cells(J, Li).Formula = "=SUM(" + Range(Cells(LastJ, Li), Cells(J - 1, Li)).Address(False, False) + ")"
         Next Li
         LastJ = J + 1
         S = Cells(J + 1, 5) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||434||4f5||fffd|4|fffd||431||fffd||275||fffd|5|fffd||423||fffd|
         J = J + 2
      Else
         J = J + 1
      End If
  Next I
  Rows(J).Insert
  Range("A" + CStr(J) + ":B" + CStr(J)).Merge
  Cells(J, 1) = S + "|421||fffd||fffd|"
  sXJ = "1:5," & sXJ & CStr(J) + ":" + CStr(J + 1 + 2): Range(Cells(J + 1, 1), Cells(J + 1, L)).Borders.LineStyle = xlContinuous
  Set Rxj = Union(Rxj, Range(CStr(J) + ":" + CStr(J + 1 + 2))) '20100902

  
  For Li = 6 To L '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bc||fffd||431||fffd||fffd||fffd||2f5||fffd|6|fffd||fffd|
      Cells(J, Li).Formula = "=SUM(" + Range(Cells(LastJ, Li), Cells(J - 1, Li)).Address(False, False) + ")"
  Next Li
  
  FY = MsgBox("|fffd||1f7||fffd||fffd||fffd||fffd||272||fffd||fffd||17b||fffd||fffd||731||fffd||fffd||fffd|", vbInformation + vbYesNo, "|fffd||fffd||2be|")
  If FY = vbYes Then
     Rxj.Copy  '20100902
     Sheets.Add before:=ActiveSheet
     ActiveSheet.Paste
     With ActiveSheet.PageSetup
         If B = True Then .PrintTitleRows = "$1:$5"
        .Orientation = xlLandscape
        .BlackAndWhite = True
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
      End With
      ActiveWindow.DisplayGridlines = False
      Columns("C:D").Hidden = True
      Columns(2).ColumnWidth = 12
      Cells(2, 1).Value = Cells(2, 1).Value + "|fffd||fffd||fffd||fffd||fffd||723||fffd|"
      Range(Cells(1, L + 1), Cells(1, Columns.Count)).EntireColumn.Clear
      Cells(1, 1).Select
      ActiveSheet.Name = "|fffd||fffd||fffd||731||fffd|"
  End If
  Application.ScreenUpdating = True
AA: ErrSub
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
  DR.Show 1
AA: ErrSub
End Sub


Sub |373||4bb||fffd||fffd||fffd||3d71||fffd||b6||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||138||fffd||2f0|_Click(Optional control As IRibbonControl)  '|fffd||47e||fffd||363||fffd||fffd|
  On Error GoTo AA:
  Dim S As String, S1 As String, sErr As String, C As Long, I As Long, J As Long
  Dim GzSH() As Worksheet, SH1 As Worksheet
    
  Dim W As Workbook, W1 As Workbook
  Set W = ActiveWorkbook
    
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":       Exit Sub
  
  S = ActiveSheet.Name
  S = Left(S, InStr(S, "|fffd||b7||fffd|") - 1) + "|fffd||b7||fffd|"
  
  C = 0
  For I = 1 To Sheets.Count
     If IsGZB(Sheets(I)) And Left(Sheets(I).Name, Len(S)) = S Then C = C + 1: ReDim Preserve GzSH(C): Set GzSH(C) = Sheets(I)
  Next I
  If C = 1 Then MsgBox S + "|5bb||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||3b9||fffd||fffd||2a3||fffd||fffd||fffd||fffd||fffd||4aa||22b||fffd||fffd||373||4bb||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd|", vbInformation, "|fffd||fffd||2be|": Exit Sub
  
  If GzSH(1).Name <> S Then MsgBox S + "|fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||1f0||fffd||68e1|" + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||3f5||373||fffd||fffd||fffd||1f7||fffd||fffd||7b8||123||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||5b4||fffd||423||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|": Exit Sub
  
  S = ""
  For I = 2 To C
     S1 = S1 + GzSH(I).Name + "|fffd||fffd|"
     If InStr(PiZhu(GzSH(I).Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And GzSH(I).ProtectContents = True Then S = S + GzSH(I).Name + "|fffd||fffd|"
  Next I
  If S <> "" Then S = Left(S, Len(S) - 1): MsgBox S + "|fffd||fffd||fffd||2b1||fffd||fffd||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||fffd||fffd||221||fffd||fffd||22b||fffd||6c63||fffd||fffd||5ae||1f0||fffd||7b7||fffd||fffd||fffd||271||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + Chr(13) + Chr(13) + "(|fffd||6a1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||a3||fffd||fffd||1e69||fffd||2e1||fffd||221||fffd||fffd||fffd||535||fffd||1f0||fffd||fffd||fffd||2b1||fffd||22b||fffd||6c63||fffd||fffd||fffd||fffd||fffd||139||fffd||fffd||721||fffd|)", vbInformation, "|fffd||fffd||2be|": Exit Sub
  
  
  I = MsgBox("   |fffd||fffd||fffd||fffd||fffd||735||13c||fffd||fffd||fffd||52d||fffd||fffd|" + vbCrLf + vbCrLf + "|fffd||6b1||fffd||fffd||5b1||fffd||fffd||b5||fffd||4bb||fffd||fffd||fffd||fffd||fffd||772||fffd||fffd||fffd||13b||fffd||fffd||fffd||fffd||3e3||fffd|" + vbCrLf + vbCrLf + "=|fffd||fffd||fffd||b5||fffd||4bb||fffd||fffd||fffd||175||fffd||4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd|" + vbCrLf + vbCrLf + "+|fffd||53a||fffd||fffd||fffd||3b7||fffd||fffd||175||fffd||4e6||fffd||fffd||421||fffd||1a3||fffd||fffd||fffd||fffd||fffd||fffd||676||53f||6f3||fffd||fffd||fffd||fffd||fffd||43f||6f3||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd||739||fffd||4e6||fffd||fffd||fffd||275||fffd||2f0|" + vbCrLf + vbCrLf + "-|1f0||fffd||3b7||fffd||fffd||fffd||fffd||47d||fffd||fffd||275||fffd||2f0||fffd||fffd|" + vbCrLf + vbCrLf + vbCrLf + "|237||2b5||4aa||fffd||fffd|" + Left(S1, Len(S1) - 1) + "|fffd||fffd||fffd||2b1||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||fffd||373||4bb||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
  If I = vbNo Then Erase GzSH: Exit Sub
  
  Dim H As Long, MaxH As Long, GSL As Long, TmpL As Long, yfL As Long
  Dim YSje() As Currency, YJse() As Currency, YKse() As Currency, XM() As String, SZcount As Long '|4e6||2f0||fffd||fffd||e862||4e6||fffd||fffd||2f0||fffd||fffd||e862||fffd||47f||fffd||2f0||fffd||fffd||e862||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||52a||fffd||635||138||fffd||fffd||fffd|
  Dim XMx As String
  Dim JSw1 As Long, JSw As Long, JSm As Currency
    
    
 Set W1 = Workbooks.Add
 Application.DisplayAlerts = False
 W1.Sheets(1).Delete
 W1.Sheets(1).Delete
 Application.DisplayAlerts = True
 W1.Sheets(1).Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 ActiveWindow.DisplayGridlines = False
 ActiveWindow.DisplayZeros = False
 ActiveWindow.SplitRow = 5
 ActiveWindow.SplitColumn = 1
 ActiveWindow.FreezePanes = True
 Set SH1 = W1.Sheets(1)
 With SH1
   .Cells.Font.Size = 9
   .Rows.RowHeight = 16
   .Rows("4:5").HorizontalAlignment = xlCenter
   .Columns.ColumnWidth = 9
   .Cells.NumberFormatLocal = "#,##0.00_ ;[|fffd||fffd||26b|]-#,##0.00 "
   .Cells.ShrinkToFit = True
   .Cells(1, 1) = "|fffd||fffd||fffd||fffd||373||4bb||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||2f6||531||fffd|"
   .Cells(4, 1) = "|fffd||fffd||fffd||fffd|"
   .Cells(4, 2) = GzSH(1).Name
   .Cells(5, 2) = "|4e6||2f0||fffd||fffd||fffd|"
   .Cells(5, 3) = "|4e6||fffd||fffd||fffd||fffd||2f0|"
   .Rows("2:3").Hidden = True
 End With
    
 '|4e6||fffd||fffd||2f0||fffd||fffd||fffd||f6||fffd|
  With GzSH(1) '|fffd||fffd||fffd||b5||fffd||4bb||fffd||3b9||fffd||fffd||2b1||fffd|
    MaxH = HJH(GzSH(1)): SZcount = MaxH - 1
    ReDim Preserve YSje(MaxH): ReDim Preserve YJse(MaxH): ReDim Preserve YKse(MaxH): ReDim Preserve XM(MaxH)
    GSL = KXL("|fffd||fffd||2f0|", GzSH(1))
    TmpL = SFGZL(GzSH(1)) + 1
      
    If .ProtectContents = True Then .Unprotect "gzglxt"
    For I = 6 To MaxH - 1
      YJse(I) = .Cells(I, GSL).Value: SH1.Cells(I, 3).Value = YJse(I)
      YKse(I) = YJse(I)
      XM(I) = .Cells(I, 2).Value: SH1.Cells(I, 1).Value = XM(I)
      
     '|237||fffd||fffd||fffd||fffd||2f0||fffd||6f3||fffd||fffd||fffd||fffd||fffd|
      S = .Cells(I, GSL).Formula
      Dim Str As String

     JSw = InStrRev(S, ",")
     If I = 6 Then If JSw = 0 Then JSm = 5000 Else JSm = Val(Mid(S, JSw + 1, Len(S) - JSw)) '|fffd||fffd||f8||fffd||2f0||fffd||6f3||fffd||fffd||fffd||fffd||fffd|
      
      If JSw = 0 Then S = Mid(S, 5, Len(S) - 5) Else S = Mid(S, 5, JSw - 5)
     .Cells(I, TmpL).Formula = "=" + S
      YSje(I) = .Cells(I, TmpL).Value: SH1.Cells(I, 2).Value = YSje(I)
     .Cells(I, TmpL).ClearContents
    Next I
    SheetProtect GzSH(1)
  End With
  
  Dim XMwz As Long
    
  For I = 2 To C
    With GzSH(I)
       If .ProtectContents = True Then .Unprotect "gzglxt"
       
       MaxH = HJH(GzSH(I))
       yfL = YFXJL(GzSH(I))
       GSL = KXL("|fffd||fffd||2f0|", GzSH(I))
      TmpL = SFGZL(GzSH(I)) + 1
      
       SH1.Cells(4, (I - 1) * 4) = GzSH(I).Name
       SH1.Cells(5, (I - 1) * 4) = "|fffd||fffd||fffd||fffd||4e6||2f0||fffd||fffd||fffd|"
       SH1.Cells(5, (I - 1) * 4 + 1) = "|fffd||6fc||fffd||4e6||2f0||fffd||fffd||fffd|"
       SH1.Cells(5, (I - 1) * 4 + 2) = "|fffd||6fc||fffd||4e6||fffd||fffd||fffd||fffd||2f0|"
       SH1.Cells(5, (I - 1) * 4 + 3) = "|fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2f0|"
      
       For H = 6 To MaxH - 1
          XMx = .Cells(H, 2).Value
          
          XMwz = 0
          For J = 6 To SZcount
            If XM(J) = XMx Then XMwz = J: Exit For
          Next J
          If XMwz = 0 Then
             SZcount = SZcount + 1
             ReDim Preserve YSje(SZcount): ReDim Preserve YJse(SZcount): ReDim Preserve YKse(SZcount): ReDim Preserve XM(SZcount)
             
             S = .Cells(H, GSL).Formula
             If Left(S, 4) <> "=gs(" Then
                YSje(SZcount) = .Cells(H, yfL).Value
                sErr = "   " + .Name + "|fffd||fffd||fffd||435||fffd|" + XMx + "|fffd||6b1||fffd||fffd||fffd||1f0||fffd||fffd||138||fffd||fffd||fffd||fffd||2b1||fffd||fffd||432||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||fffd||2f0||fffd||fffd||fffd||3e6b||2bd||fffd||fffd||5bb||fffd||fffd||fffd||fffd||3b4||fffd||fffd||fffd||6f3||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||4e6||2f0||fffd||fffd||e862||fffd||535||fffd||1f0||fffd||fffd||2f0||fffd||fffd||3aa||4e6||fffd||fffd||fffd||fffd||2f0||fffd||fffd|" + Chr(10) + "|1ff||fffd||4bd||fffd||fffd||fffd||fffd||6b0||fffd||fffd||fffd||373||4bb||fffd||fffd||fffd||fffd||5ae||1f0||fffd||538||f1||fffd||fffd||fffd||fffd||63d||fffd||fffd||fffd||2f0||fffd||fffd||2bd||fffd||fffd|"
                SH1.Rows(SZcount).Font.ColorIndex = 3
             Else
                If InStr(S, "IF") > 0 Then
                   JSw1 = InStr(Right(S, Len(S) - InStr(S, ")")), ",")
                   If JSw1 > 0 Then JSw = InStr(S, ")") + JSw1 Else JSw = 0
                Else
                   JSw = InStr(S, ",")
                End If
                If JSw = 0 Then S = Mid(S, 5, Len(S) - 5) Else S = Mid(S, 5, JSw - 5)
               .Cells(H, TmpL).Formula = "=" + S
     
                YSje(SZcount) = .Cells(H, TmpL).Value
               .Cells(H, TmpL).ClearContents
                sErr = "   " + .Name + "|fffd||fffd||fffd||435||fffd|" + XMx + "|fffd||6b1||fffd||fffd||fffd||1f0||fffd||fffd||138||fffd||fffd||fffd||fffd||2b1||fffd||fffd||432||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||435||139||fffd||2bd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd|"
             End If
             YJse(SZcount) = .Cells(H, GSL).Value
             YKse(SZcount) = YJse(SZcount)
             XM(SZcount) = .Cells(H, 2).Value
             SH1.Cells(SZcount, 1) = XM(SZcount)
             SH1.Cells(SZcount, (I - 1) * 4) = YSje(SZcount)
             SH1.Cells(SZcount, (I - 1) * 4 + 1) = YSje(SZcount)
             SH1.Cells(SZcount, (I - 1) * 4 + 2) = YJse(SZcount)
             SH1.Cells(SZcount, (I - 1) * 4 + 3) = YJse(SZcount)
              With SH1.Cells(SZcount, (I - 1) * 4 + 3)
                 .Interior.ColorIndex = 10
                 .AddComment
                 .Comment.Text Text:=sErr
                 .Comment.Shape.ScaleWidth 3, msoFalse, msoScaleFromTopLeft
                 .Comment.Shape.ScaleHeight 1, msoFalse, msoScaleFromTopLeft
             End With
          Else
             YSje(XMwz) = YSje(XMwz) + .Cells(H, yfL).Value
             YJse(XMwz) = GS(YSje(XMwz), JSm)
            .Cells(H, GSL).Value = YJse(XMwz) - YKse(XMwz)
             YKse(XMwz) = YJse(XMwz)
             SH1.Cells(XMwz, (I - 1) * 4) = .Cells(H, yfL).Value
             SH1.Cells(XMwz, (I - 1) * 4 + 1) = YSje(XMwz)
             SH1.Cells(XMwz, (I - 1) * 4 + 2) = YJse(XMwz)
             SH1.Cells(XMwz, (I - 1) * 4 + 3) = .Cells(H, GSL).Value
          End If
       Next H
       SheetProtect GzSH(I)
    End With
  Next I
  
  With SH1
    .Range("A1:D1").Merge
    .Range("A4:A5").Merge
    .Range("B4:C4").Merge
     For J = 4 To (I - 2) * 4 + 3 Step 4
       .Range(.Cells(4, J), .Cells(4, J + 3)).Merge
     Next J
    .Cells(SZcount + 1, 1) = "|fffd||fffd|   |fffd||1a3||fffd|"
    .Range(.Cells(4, 1), .Cells(5, (I - 2) * 4 + 3)).Interior.ColorIndex = 24
    .Range(.Cells(SZcount + 1, 1), .Cells(SZcount + 1, (I - 2) * 4 + 3)).Interior.ColorIndex = 19
    .Cells(SZcount + 1, 2).Formula = "=SUM(B6:B" + CStr(SZcount) + ")"
    .Cells(SZcount + 1, 2).AutoFill Destination:=.Range(.Cells(SZcount + 1, 2), .Cells(SZcount + 1, (I - 2) * 4 + 3))
    .Range(.Cells(4, 1), .Cells(SZcount + 1, (I - 2) * 4 + 3)).Borders.LineStyle = xlContinuous
  End With
  
  Erase GzSH:  Erase YSje:  Erase YJse:  Erase YKse:  Erase XM
  Set W = Nothing: Set W1 = Nothing: Set SH1 = Nothing
AA: ErrSub
End Sub

Sub |fffd||536||fffd||fffd||5d71||1f0||fffd||fffd||fffd||fffd||2f0||fffd||fffd||2bd|_Click(Optional control As IRibbonControl)  '|fffd||47e||fffd||363||fffd||e3||fffd||fffd||fffd|
  On Error GoTo AA:
  Dim SN As String, I As Long
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
  
  SN = ActiveSheet.Name
  If InStr(SN, "|fffd||b7||fffd| (") > 0 Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + "|fffd||f3||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||3e6b||2bd||fffd||fffd||fffd||fffd||fffd||735||f5||fffd||fffd||fffd||237||fffd||fffd||22b||fffd||bb||fffd||fffd||735||13d||fffd||2f0||fffd||fffd||e863|" + vbCrLf + vbCrLf + "|237||2b5||4aa||fffd||536||fffd||fffd||5c7e||fffd||3b7||fffd||fffd||175||138||fffd||2f0||fffd||fffd||2bd||fffd||fffd|", vbQuestion + vbYesNo + vbDefaultButton2, "|fffd||fffd||2be|")
     If I = vbNo Then Exit Sub
  End If
  
  TAX.Show 1
  
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
  UserForm9.Show
  
AA: ErrSub
End Sub

Sub |fffd||fffd||2be||fffd||2ba||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

 
 Dim X As Long
 If Columns("D").Hidden = False Then MsgBox "|fffd||2ba||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|", vbInformation, "|fffd||fffd||2be|":  Exit Sub
 X = MsgBox("|fffd||fffd||2be||fffd||2ba||fffd||fffd||423||fffd||fffd||fffd||fffd||73b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||fffd||fffd||2f9||fffd||fffd||fffd||fffd||2ba||163||fffd||237||2b5||4aa||fffd||fffd||2be||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||fffd||fffd|")
 If X = vbYes Then
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("D").Hidden = False
     SheetProtect
 End If
AA: ErrSub
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||2ba||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 
 If Range("D4").Value = "|fffd||2ba||fffd|" Then
    If Columns("D").Hidden = True Then MsgBox "|fffd||2ba||fffd||fffd||fffd||fffd||fffd||fffd||623||fffd|", vbInformation, "|fffd||fffd||2be|":   Exit Sub
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("D").Hidden = True
     SheetProtect
 End If
AA: ErrSub
End Sub

Sub |fffd||fffd||2be||fffd||fffd||fffd||fffd||5a4||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 
 Dim X As Long
 If Columns("C").Hidden = False Then MsgBox "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|", vbInformation, "|fffd||fffd||2be|":  Exit Sub
 X = MsgBox("|fffd||fffd||2be||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||73b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||163||fffd||237||2b5||4aa||fffd||fffd||2be||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||fffd||fffd|")
 If X = vbYes Then
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("C").Hidden = False
     SheetProtect
 End If
AA: ErrSub
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
   If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 
 
 If Range("C4").Value = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|" Then
    If Columns("C").Hidden = True Then MsgBox "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||623||fffd|", vbInformation, "|fffd||fffd||2be|":   Exit Sub
    If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
    Columns("C").Hidden = True
     SheetProtect
 End If
AA: ErrSub
End Sub



Sub |fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
 
  Dim I As Long
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub

  Dim YF As Long, sF As Long, HJ As Long
  YF = YFXJL: sF = SFGZL:  HJ = HJH
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  
  Application.ScreenUpdating = False
  Rows.Hidden = False
  For I = 6 To HJ - 1
    If Cells(I, YF).Value = 0 And Cells(I, sF).Value = 0 Then Rows(I).Hidden = True
  Next I
  Application.ScreenUpdating = True
  SheetProtect
AA: ErrSub
End Sub
Sub |5bb||fffd||fffd||2be||fffd||bd71||1f0||5b0||fffd||fffd||36c||fffd||fffd||fffd||175||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  Dim I As Long
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub

  Dim S As String, HJ As Long, DQH As Long
  HJ = HJH
  DQH = ActiveCell.Row
  If DQH < 6 Or DQH >= HJ Then MsgBox "|fffd||fffd||1f0||fffd||432||fffd||fffd||fffd||fffd||fffd||133||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||68e1|", vbCritical, "|fffd||fffd||2be|": Exit Sub
  S = Cells(DQH, 4).Value
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  
  Application.ScreenUpdating = False
  Rows.Hidden = False
  For I = 6 To HJ - 1
    If Cells(I, 4).Value = S Then Rows(I).Hidden = False Else Rows(I).Hidden = True
  Next I
  Application.ScreenUpdating = True
  SheetProtect
AA: ErrSub
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  Dim I As Long
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub

  Dim sF, HJ As Long
  sF = SFGZL
  HJ = HJH
  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"

  For I = 5 To sF - 1
    If Cells(HJ, I).Value = 0 Then Columns(I).Hidden = True
  Next I
  SheetProtect
AA: ErrSub
End Sub

Sub |fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub

  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  Rows.Hidden = False
  SheetProtect
AA: ErrSub
End Sub

Sub |fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub

  If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
  Columns.Hidden = False
  SheetProtect
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

 
  Dim I As Long
  If IsGZB And TaxPrompt <> "" Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
     If I = vbNo Then Exit Sub
  End If
  
  UserForm1.Show 1
AA: ErrSub
End Sub

 Sub |423||fffd||fffd||fffd||fffd||fffd||275||13d||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
 With Application.FileDialog(msoFileDialogOpen)
      .Filters.Add "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd|", "*.txt", 1
     .Show
     If .SelectedItems.Count = 0 Then Exit Sub
     
     Dim FileName As String
     FileName = .SelectedItems.Item(1)
  End With
  
  Dim S As String
  Dim X1, X2, X3, I As Long
  Dim JE As Currency
  Open FileName For Input As #1
  I = 0
  Do While Not EOF(1)
     Line Input #1, S
     I = I + 1
     X1 = InStr(1, S, "|")
     X2 = InStr(X1 + 1, S, "|")
     X3 = InStr(X2 + 1, S, "|")
     JE = JE + Val(Right(S, Len(S) - X3))
  Loop
  Close #1
 MsgBox "|fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|" + CStr(I) + "|fffd||fffd||fffd||fffd||bc||fffd||fffd||fffd||fffd||ee72||fffd||1a3||fffd|" + Format(JE, "#,##0.00") + "|52a||fffd||fffd|", vbInformation, "|fffd||fffd||fffd|"
  
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||179||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
    UserForm2.Show
End Sub


Sub |2b9||fffd||fffd||2f5||fffd||fffd|_Click(Optional control As IRibbonControl)
  UserForm3.Show
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||13f|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
    If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
    If Right(ActiveSheet.Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then MsgBox "|fffd||fffd||1f0||fffd||fffd||3aa||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f9||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|": Exit Sub
    If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
    UserForm4.Show 1
AA: ErrSub
End Sub

Sub |5b0||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
 On Error GoTo AA:
 If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
 If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
 UserForm5.Show 1

AA:
ErrSub
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  Dim B As Boolean
  B = IsGZB(ActiveSheet)
  
  Dim I As Long
  If IsGZB And TaxPrompt <> "" Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
     If I = vbNo Then Exit Sub
  End If
  
  Cells.Copy
  Workbooks.Add:  'MenuItemDisplayControl
  Cells.PasteSpecial xlPasteValues  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||678||fffd||2bd|
  Cells.PasteSpecial xlPasteFormats
  With ActiveSheet.PageSetup
         If B = True Then .PrintTitleRows = "$1:$5"
        .Orientation = xlLandscape
        .BlackAndWhite = True
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
  End With
  ActiveWindow.DisplayGridlines = False
  Cells(1, 1).Select

AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  Dim S As String, I As Long, J As Long, V() As String
  Dim R As Range, Rx As Range
  
  J = 0
  For I = 1 To Sheets.Count
      S = Sheets(I).Name
      If S <> "|fffd||fffd||fffd||2b5||fffd|" And S <> "|fffd||6fa||3f2||fffd||46f|" Then
         J = J + 1
         ReDim Preserve V(1 To J)
         V(J) = S
      End If
  Next I
  
 Dim W As Workbook, W1 As Workbook, SN As String
 Set W = ActiveWorkbook
 Sheets(V).Copy
 Set W1 = ActiveWorkbook
 
 For I = 1 To Sheets.Count
     With Sheets(I)
          SN = .Name
          If .ProtectContents = True Then .Unprotect "gzglxt"
         .Cells(1, 1).ClearComments
          On Error Resume Next
          Set R = .Cells.SpecialCells(xlCellTypeFormulas, xlErrors)
          If Not (R Is Nothing) Then
            For Each Rx In R
               Rx.Value = W.Sheets(SN).Range(Rx.Address).Value
            Next
          End If
          Set R = Nothing
     End With
 Next I
 Set W = Nothing: Set W1 = Nothing
AA:  If Err.Number <> 0 And Err.Number <> 1004 Then MsgBox "|fffd||fffd||fffd||fffd||163||fffd|" + CStr(Err.Number) + vbCrLf + Err.Description, vbInformation, "|fffd||fffd||fffd||fffd|": Application.ScreenUpdating = True: Application.DisplayAlerts = True
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
    UserForm7.Show 1
End Sub

Sub |fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  If ActiveWorkbook.ProtectStructure = True Then ActiveWorkbook.Unprotect
  Sheets("|fffd||fffd||fffd||2b5||fffd|").Visible = True
  Sheets("|fffd||fffd||fffd||2b5||fffd|").Activate
  ActiveWorkbook.Protect Structure:=True
AA: ErrSub
End Sub
Sub |fffd||6fa||3f2||fffd||46f|_Click(Optional control As IRibbonControl)
 UserForm8.Show 1
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  Dim QR As Long, I As Long
  Dim YfileName As String
  Dim WB As Workbook, WB1 As Workbook, SH1 As Worksheet
  Dim NotGZ As Boolean, HasGRGZD As Boolean, HasGZZHCX As Boolean
  Dim GSL As Long, H As Long
  Dim N As Long, Y As Long, Y1 As Long
  Dim S As String, S1 As String
  Dim B As DocumentProperty
  Dim SHi As Long

  Dim Sname() As String, Sname1() As String
  If Sheets.Count > 2 Then ReDim Sname(1 To Sheets.Count - 2) As String
  
  QR = MsgBox("    |3aa||fffd||fffd||2b9||52d||fffd||230||6c7e||fffd||139||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||739||fffd||2b9||fffd||fffd||fffd||fffd||fffd||b9||fffd||fffd||723||fffd||fffd||fffd||fffd||fffd||fffd||1e69||fffd||2f1||fffd||fffd||fffd||fffd||721||fffd|" _
  & vbCrLf + vbCrLf + "    |fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||435||139||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||237||2b5||4aa||fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||fffd||fffd|")
  If QR = vbYes Then
     If ActiveWorkbook.ProtectStructure = True Then ActiveWorkbook.Unprotect

     If Sheets("|fffd||fffd||fffd||2b5||fffd|").Visible = False Then Sheets("|fffd||fffd||fffd||2b5||fffd|").Visible = True
     SHi = 0
     For I = 1 To Sheets.Count
         S1 = Sheets(I).Name
         If Not (S1 = "|fffd||fffd||fffd||2b5||fffd|" Or S1 = "|fffd||6fa||3f2||fffd||46f|" Or S1 = "|fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|" Or S1 = "|fffd||fffd||fffd||fffd||fffd||6fa||3f2||fffd||46f|") Then
             SHi = SHi + 1
             Sname(SHi) = S1
         End If
     Next I
     
     With Application.FileDialog(msoFileDialogOpen)
         .Show
         If .SelectedItems.Count = 0 Then Exit Sub
         YfileName = .SelectedItems.Item(1)
     End With
     
     Set WB = ActiveWorkbook
     HLSJ = True
     Set WB1 = Application.Workbooks.Open(YfileName)
     HLSJ = False
     If WB1.Sheets.Count <= 2 Then
        NotGZ = True
     Else
        ReDim Sname1(1 To WB1.Sheets.Count - 2) As String
        For I = 1 To WB1.Sheets.Count
            S1 = WB1.Sheets(I).Name
            If S1 = "|fffd||fffd||fffd||2b5||fffd|" Or S1 = "|fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|" Then HasGRGZD = True
            If S1 = "|fffd||6fa||3f2||fffd||46f|" Or S1 = "|fffd||fffd||fffd||fffd||fffd||6fa||3f2||fffd||46f|" Then HasGZZHCX = True
        Next I
        If HasGRGZD And HasGZZHCX Then
           For I = 1 To WB1.Sheets.Count
               S1 = WB1.Sheets(I).Name
               If Not (S1 = "|fffd||fffd||fffd||2b5||fffd|" Or S1 = "|fffd||6fa||3f2||fffd||46f|" Or S1 = "|fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|" Or S1 = "|fffd||fffd||fffd||fffd||fffd||6fa||3f2||fffd||46f|") Then
                  Sname1(I) = S1
               End If
           Next I
        End If
     End If
     
     If NotGZ = True Or HasGRGZD = False Or HasGZZHCX = False Then
        MsgBox "|fffd||fffd||fffd||fffd||461||fffd||fffd||fffd|EXCEL|fffd||135||fffd||fffd||fffd||fffd||1f9||fffd||fffd||fffd||fffd||fffd||fffd||763||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||68fa|"
        WB1.Close False
        Exit Sub
     End If
     
     Application.DisplayAlerts = False
     Application.ScreenUpdating = False
     
     
     
     For I = 1 To WB1.Sheets.Count
       Set SH1 = WB1.Sheets(I)
       If IsGZB(SH1) = True Then
         With SH1
            H = HJH(SH1)
            
           '|fffd||33b||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||138||fffd||2f0||fffd||fffd||fffd||763||fffd||fffd||fffd||3aa|2019|fffd||afea||2bc||fffd||fffd||5bb||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd||fffd||fffd||fffd||f9||fffd||2bd||fffd||fffd||fffd||38ec||fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||6bc||fffd||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||f5||fffd||fffd||fffd||fffd||2f0||fffd||fffd||2bd||fffd||fffd|
            If Right(.Name, 6) <> "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then
               If .ProtectContents = True Then .Unprotect "gzglxt"
               GSL = KXL("|fffd||fffd||2f0|", SH1)
               If GSL = 0 Then GSL = KXL("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0|", SH1)
              .Range(.Cells(6, GSL), .Cells(H - 1, GSL)).Copy
              .Range(.Cells(6, GSL), .Cells(H - 1, GSL)).PasteSpecial Paste:=xlPasteValues
            End If
            
            
            '|3aa|3.0|5ae||1f0||fffd||fffd||fffd||fffd||fffd||6b0||6c7e||fffd||fffd||fffd||4f2||fffd||fffd||fffd||fffd||fffd|
            If .Cells(4, 4) <> "|fffd||fffd||fffd||fffd|" And .Cells(4, 5) <> "|fffd||fffd||fffd||fffd|" Then
                If .ProtectContents = True Then .Unprotect "gzglxt"
               .Columns(4).Insert
               .Range("D4:D5").Merge
               .Cells(4, 4) = "|fffd||fffd||fffd||fffd|"
               .Columns(4).ColumnWidth = 12.38
               .Range(.Cells(6, 5), .Cells(H, SFGZL(SH1))).NumberFormatLocal = "0.00_ ;[|fffd||fffd||26b|]-0.00 "
            End If
            
           '|3aa|3.0|5ae||1f0||fffd||fffd||fffd||fffd||fffd||6b0||6c7e||fffd||421||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0||fffd||fffd||22b||fffd||fffd||fffd||6efb||fffd||261||fffd||fffd||fffd||2f0||fffd||fffd|
            Dim J As Long
            J = KXL("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f0|", SH1)
            If J > 0 Then
                If .ProtectContents = True Then .Unprotect "gzglxt"
                .Cells(5, J) = "|fffd||fffd||2f0|"
            End If

            
            '|3aa|4.0-6.0|5ae||1f0||fffd||6c7e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||1b4||fffd||fffd||fffd||178||fffd||fffd||fffd||3aa||fffd||fffd||fffd||163||fffd|
             If .Cells(4, 1) = "|fffd||fffd||fffd|" And .Cells(4, 4) = "|fffd||fffd||fffd||fffd|" Then
                If .ProtectContents = True Then .Unprotect "gzglxt"
                
               .Cells(4, 1) = "|fffd||fffd||fffd||fffd|"
               .Range("A6:A" & CStr(H - 1)).NumberFormatLocal = "@"
               
               .Columns(3).Insert
               .Range("C4:C5").Merge
               .Cells(4, 3) = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd|"
               .Columns(3).ColumnWidth = 14.5
               
               .Range(.Cells(6, 6), .Cells(H, SFGZL(SH1))).NumberFormatLocal = "0.00_ ;[|fffd||fffd||26b|]-0.00 "
            End If



            If WB1.CustomDocumentProperties.Count > 0 Then
                For Each B In WB.CustomDocumentProperties
                   B.Delete
                Next B
            For Each B In WB1.CustomDocumentProperties
                WB.CustomDocumentProperties.Add Name:=B.Name, LinkToContent:=False, Type:=msoPropertyTypeString, Value:=B.Value
                Next B
            End If
            
            
            If .ProtectContents = False Then SheetProtect SH1
            
         End With
       End If
     Next I
     Set B = WB1.BuiltinDocumentProperties.Item("Company")
     If B.Value <> "" Then WB.BuiltinDocumentProperties.Item("Company").Value = B.Value

     
     HLSJ = True   '|fffd||fffd|"|fffd||fffd||fffd||2b5||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd|Worksheet_Activate|fffd||bc||fffd|
     If WB.Sheets.Count > 2 Then WB.Sheets(Sname).Delete
     WB1.Sheets(Sname1).Copy before:=WB.Sheets(1)
     WB1.Close False
     HLSJ = False
     
     Application.Calculate
     
     Set WB = Nothing
     Set WB1 = Nothing
     Set SH1 = Nothing
     Set B = Nothing
     Application.DisplayAlerts = True
     Application.ScreenUpdating = True
     ActiveWorkbook.Protect Structure:=True
     
     Dim First As Long
     First = 0
     With Application.CommandBars("Cell")
          For I = 1 To .Controls.Count
              If .Controls(I).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)" And First = 0 Then First = I
              If .Controls(I).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)" And First > 0 Then .Controls(First).Delete: Exit For
          Next I
     End With
     
     First = 0
     With Application.CommandBars("PLY")
          For I = 1 To .Controls.Count
              If .Controls(I).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)" And First = 0 Then First = I
              If .Controls(I).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)" And First > 0 Then .Controls(First).Delete: Exit For
          Next I
     End With
     
     MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e3||fffd|" + Chr(13) + Chr(13) + "|fffd||fffd||fffd||231||fffd||fffd||fffd||fffd||631||571||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||b4||bfaba||fffd||37f||fffd||fffd||fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|"
  End If
AA: ErrSub
End Sub





Sub |fffd||7b8||135||fffd||3bb||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  Dim S As String
  Dim B As DocumentProperty
  
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub
  If InStr(PiZhu(Cells(1, 1)), "|22b||fffd||6c63||fffd||fffd|") > 0 And ActiveSheet.ProtectContents = True Then ErrPrompt: Exit Sub
  
  S = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||2b9||fffd||f5||fffd||3bb||fffd||fffd||fffd||1a3||fffd|", "|fffd||fffd||fffd||fffd|", Cells(1, 1).Value)
  If S <> "" Then
     ActiveSheet.Unprotect "gzglxt"
     Cells(1, 1).Value = S
     SheetProtect
     
     Set B = ActiveWorkbook.BuiltinDocumentProperties.Item("Company")
     B.Value = S
  End If
AA: ErrSub
End Sub

Sub |fffd||7b8||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl, Optional |fffd||536||fffd| As Boolean)
  On Error GoTo AA:
     
      If Sheets.Count > 3 Then MsgBox "|3f5||373||fffd||47e||fffd||fffd||fffd||fffd||e3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a3||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
     
      Dim N As Variant, Y As Variant, I As Long
      N = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:", "|fffd||fffd||2be|", Year(Now))
      If N = "" Then Exit Sub
      If N < 2019 Or N > 2100 Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||bcbb||fffd||fffd||237||fffd||fffd|" + vbCrLf + vbCrLf + "(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd|2019|fffd||af30||fffd||53a||fffd|)|fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
      Y = InputBox("|fffd||fffd||fffd||fffd||fffd||bfea||2bc||fffd||fffd||fffd||439||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||b7||fffd|:" & vbCrLf & vbCrLf & "|1ff||fffd||4bd||fffd||fffd||fffd||fffd|1|fffd||b7||77f||fffd||2bc||fffd||fffd||fffd||e3||fffd||fffd||fffd||23b||fffd||fffd||fffd||fffd||2b9||fffd||fffd||22b||fffd||fffd||fffd||2f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f6||539||fffd||fffd||723||fffd|", "|fffd||fffd||2be|", 1)
      If Y = "" Then Exit Sub
      
      If Y < 1 Or Y > 12 Then MsgBox "|fffd||b7||fffd||fffd||fffd||fffd||bcbb||fffd||fffd||237||fffd||fffd|", vbCritical, "|fffd||fffd||2be|": Exit Sub
      
      If ActiveSheet.ProtectContents = True Then ActiveSheet.Unprotect "gzglxt"
      Cells.Locked = True
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Locked = False
      Range(|fffd||fffd||5b1||fffd||4f1||f2d||fffd||fffd||fffd||fffd|).Interior.ColorIndex = 20
      Range("A1").Comment.Text "%%|fffd||fffd||fffd||2b1||fffd|%%|fffd||5b2||fffd||fffd||fffd||fffd||fffd|"
      
      Cells(2, 1) = CStr(N) + "|fffd||fffd|" + CStr(Y) + "|fffd||b7||779||fffd||fffd||2b1||fffd|"
      Cells(3, 1) = "|fffd||1b1||fffd||2b1||fffd||48fa|" + CStr(N) + "|fffd||fffd|" + CStr(Y) + "|fffd||fffd|1|fffd||fffd|"
      
      ThisWorkbook.Unprotect
      Sheets(1).Name = CStr(Y) + "|fffd||b7||fffd|"
      ThisWorkbook.Protect Structure:=True
      SheetProtect
      
      If |fffd||536||fffd| = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||123||fffd|", vbInformation, "|fffd||fffd||2be|"
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||279||fffd||fffd||fffd||fffd||fffd|_Click(Optional control As IRibbonControl)
  On Error GoTo AA:
  Dim colSFGZL As Long
  
  If IsGZB(ActiveSheet) = False Then MsgBox "|fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||1f9||fffd||fffd||2b1||fffd||fffd||fffd|", vbCritical, "|fffd||fffd||fffd||fffd|":    Exit Sub

  Dim I As Long
  If IsGZB And TaxPrompt <> "" Then
     I = MsgBox(TaxPrompt + vbCrLf + vbCrLf + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|")
     If I = vbNo Then Exit Sub
  End If
  
   Application.ScreenUpdating = False

  colSFGZL = SFGZL
  
  Cells.Copy
  Workbooks.Add:  'MenuItemDisplayControl

  Cells.PasteSpecial xlPasteValues  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||678||fffd||2bd|
  Cells.PasteSpecial xlPasteFormats
  Cells.Interior.ColorIndex = xlNone
  With ActiveSheet.PageSetup
        .Orientation = xlLandscape
        .BlackAndWhite = True
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
  End With
  ActiveWindow.DisplayGridlines = False
  
  Dim K As Long
  Dim HJ As Long
  Dim R As Range
  Dim YF As String
  K = 0
  HJ = HJH
   
   
  Range(Cells(1, colSFGZL + 11), Cells(1, Columns.Count)).EntireColumn.Clear
  
  Cells(4, colSFGZL + 11) = "|fffd||b7||fffd|"
  YF = (Val(Mid(Range("A2").Value, 6, InStr(Range("A2").Value, "|fffd||b7||fffd|") - 1)))
 
  For I = 6 To HJ - 1
     Cells(I, colSFGZL + 11) = YF
  Next I
   
    Columns(colSFGZL).Copy
    Columns(colSFGZL + 11).PasteSpecial Paste:=xlPasteFormats
    Application.CutCopyMode = False
    Columns(colSFGZL + 11).NumberFormatLocal = "@"
    Columns(colSFGZL + 11).ColumnWidth = 4
    
    Range(Cells(6, colSFGZL + 1), Cells(HJ, colSFGZL + 10)).Borders.LineStyle = xlContinuous
    For I = 1 To 10
      Range(Cells(4, colSFGZL + I), Cells(5, colSFGZL + I)).BorderAround LineStyle:=xlContinuous
      Range(Cells(4, colSFGZL + I), Cells(5, colSFGZL + I)).HorizontalAlignment = xlCenter
      If Application.WorksheetFunction.Count(Range(Cells(6, colSFGZL + I), Cells(HJ - 1, colSFGZL + I))) = 0 Then Columns(colSFGZL + I).Hidden = True
    Next I
   
  '|fffd||fffd||fffd||fffd||fffd||17d||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Range("6:" + CStr(HJ - 1)).Sort Key1:=Range("E6")  '|fffd||7b8||fffd||1f0|Range("D6")
   
   
  Rows(5).Copy
  Rows(7).Insert
  Rows(7).Insert
  Rows(7).RowHeight = 3
  
  Set R = Range(Cells(7, 1), Cells(7, colSFGZL + 11))
  R.Borders.LineStyle = xlNone
  R.BorderAround LineStyle:=xlContinuous
  Set R = Nothing
  
  Dim Rx As Range
  For Each Rx In Intersect(ActiveSheet.UsedRange, Rows(8))
      If Rx.Value = "" Then Rx.Value = Rx.Offset(-4, 0).Value
  Next
  Cells(8, 3).HorizontalAlignment = xlCenter
  Cells(8, 4).HorizontalAlignment = xlCenter
  Cells(8, 5).HorizontalAlignment = xlCenter
  
  For I = 9 To HJH - 2
      Rows("7:8").Copy
      Rows(I + 1 + K).Insert
      K = K + 2
  Next I
  Rows(I + 1 + K).Delete
  Rows(I + 1 + K).Delete
  Rows(I + 1 + K).Delete
  
  Dim FY As Long
  FY = MsgBox("|fffd||1f7||70d32||fffd||fffd||17d||fffd||fffd||437||fffd||4b3||fffd||fffd|", vbInformation + vbYesNo, "|fffd||fffd||2be|")
  If FY = vbYes Then
     For I = 9 To (HJ - 6) * 3 + 3 Step 3
         If Cells(I, 5).Value <> Cells(I - 3, 5).Value Then ActiveSheet.HPageBreaks.Add before:=Cells(I - 2, 1)
     Next I
  End If

  Cells(1, 1).Select
  Application.ScreenUpdating = True

AA: ErrSub
End Sub

Sub |fffd||677||fffd||fffd||fffd||57e|_Click(Optional control As IRibbonControl)
  On Error GoTo AA
    Shell "explorer.exe http://www.ahzll.top"
AA: ErrSub
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|"
Option Explicit
Public MyRibbon As IRibbonUI
Public IsVisible As Boolean


Public Sub ribbonLoaded(Ribbon As IRibbonUI)
    Set MyRibbon = Ribbon
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|(Optional ByVal XH As String)
  On Error GoTo AA:

  Cells.Copy
  Workbooks.Add:  'MenuItemDisplayControl
  Cells.PasteSpecial xlPasteValues  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||678||fffd||2bd|
  Cells.PasteSpecial xlPasteFormats
  ActiveWindow.DisplayGridlines = False
  Columns("C:H").ColumnWidth = 18
  ActiveSheet.PageSetup.BlackAndWhite = True
  ActiveSheet.PageSetup.Orientation = xlLandscape  '|fffd||fffd||fffd||fffd|
  Cells(1, 1).Select
  
  Application.DisplayAlerts = False
  ActiveWorkbook.SaveAs ThisWorkbook.Path + "\" + XH + Trim(Range("H3").Value) + Range("D3").Value + "|fffd||139||fffd||fffd||2b5||fffd|.xlsx", xlWorkbookDefault
  ActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly
  ActiveWorkbook.Close False
  Application.DisplayAlerts = True
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|()
  On Error GoTo AA:
    Dim X As Long, I As Long, BHXH As Boolean, S As String
    If Sheets("|fffd||fffd||fffd||2b5||fffd|").oGZB.Text = "" Then Exit Sub
    X = Sheets("|fffd||fffd||fffd||2b5||fffd|").oXM.ListIndex
    
    BHXH = False
    If MsgBox("|3aa||fffd||2f1||fffd||fffd||fffd||fffd||fffd||fffd||a3b35||fffd||fffd||fffd||fffd||139||fffd||fffd||2b5||fffd||fffd||1f7||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||163||fffd|", vbQuestion + vbYesNo, "|fffd||fffd||2be|") = vbYes Then BHXH = True
    
    For I = 0 To Sheets("|fffd||fffd||fffd||2b5||fffd|").oXM.ListCount - 1
      Sheets("|fffd||fffd||fffd||2b5||fffd|").oXM.ListIndex = I
      If BHXH Then S = CStr(I + 1) + "." Else S = ""
      |fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd| S
    Next I
    Sheets("|fffd||fffd||fffd||2b5||fffd|").oXM.ListIndex = X
    MsgBox "|fffd||47e||fffd||fffd||fffd||fffd||fffd|" + Range("D3").Value + "|fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||139||fffd||fffd||2b5||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||2be|"
AA: ErrSub
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||fffd||fffd||13f|(Optional HLqnj As Boolean = False)  '|fffd||fffd||fffd||fffd||22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|
 On Error GoTo AA:
 ReDim YFarray(1): ReDim KKarray(1)      '|fffd||fffd||fffd||b3||fffd||2bc||fffd||fffd|
 Dim SS As String
 Dim I, J, N As Long
 Dim YF, KK As Long
 Dim HASgzl As Boolean
 
 Dim IsCX As Boolean
 For I = Sheets.Count To 1 Step -1
     If IsGZB(Sheets(I)) = True Then
        IsCX = True
        If HLqnj Then
             If Right(Sheets(I).Name, 6) = "|22b||fffd||fffd||4bb||fffd||fffd||fffd||53d||fffd|" Then IsCX = False
        End If
        
        If IsCX Then
           YF = YFXJL(Sheets(I))
           KK = KKXJL(Sheets(I))
           For J = 6 To KK  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f2||fffd||fffd||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||5a4||fffd||fffd|,|fffd||2b4||fffd|5|fffd||fffd||3aa|6
               If J < YF Then
                  SS = Sheets(I).Cells(5, J)
                  HASgzl = False
                  For N = 1 To UBound(YFarray)
                      If YFarray(N) = SS Then HASgzl = True: Exit For
                  Next N
                  If HASgzl = False Then
                     YFarray(UBound(YFarray)) = SS
                     ReDim Preserve YFarray(UBound(YFarray) + 1)
                  End If
               End If
               If J > YF And J < KK Then
                  SS = Sheets(I).Cells(5, J)
                  HASgzl = False
                  For N = 1 To UBound(KKarray)
                      If KKarray(N) = SS Then HASgzl = True:   Exit For
                  Next N
                  If HASgzl = False Then
                     KKarray(UBound(KKarray)) = SS
                     ReDim Preserve KKarray(UBound(KKarray) + 1)
                  End If
               End If
           Next J
        End If
     End If
 Next I
AA: ErrSub
End Sub

Sub ErrSub()
 If Err.Number <> 0 Then MsgBox "|fffd||fffd||fffd||fffd||163||fffd|" + CStr(Err.Number) + vbCrLf + Err.Description, vbInformation, "|fffd||fffd||fffd||fffd|": Application.ScreenUpdating = True: Application.DisplayAlerts = True
End Sub

Sub SheetProtect(Optional SH As Worksheet)
   If SH Is Nothing Then Set SH = ActiveSheet
   SH.Protect Password:="gzglxt", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub
Sub MenuItemDisplayControl()  '|fffd||fffd||363||fffd||fffd|
  On Error GoTo AA:
  Dim S As String
  Dim M As Object
  Dim I As Long
  Dim HasGZmenu As Boolean
  
  If HLSJ = True Then Exit Sub
  
  For I = 1 To Application.CommandBars(1).Controls.Count
      S = Application.CommandBars(1).Controls(I).Caption
      If S = "|fffd||fffd||fffd||2b9||fffd||fffd||fffd|(&G)" Then Set M = Application.CommandBars("Worksheet menu bar").Controls(I): HasGZmenu = True: Exit For
  Next I
  If HasGZmenu = False Then Exit Sub
  
  If Not ThisWB Is Nothing Then
     If ActiveWorkbook.FullName <> ThisWB.FullName Then
        M.Visible = False
        Application.Caption = "Microsoft Excel"
     Else
        M.Visible = True
        Application.Caption = "|fffd||fffd||fffd||2b9||fffd||fffd||fffd||3f5||373|"
     End If
  End If
  
  With M
      If IsGZB = False Then
        .Controls(1).Visible = False
        .Controls(2).Visible = False
        .Controls(3).Visible = False
        .Controls(4).Visible = False
        .Controls(5).Visible = False
        .Controls(9).Visible = False
        .Controls(10).Visible = False
      Else
        .Controls(1).Visible = True
        .Controls(2).Visible = True
        .Controls(3).Visible = True
        .Controls(4).Visible = True
        .Controls(5).Visible = True
        .Controls(9).Visible = True
        .Controls(10).Visible = True
      End If
  End With
  Set M = Application.CommandBars("Worksheet menu bar").Controls(I).Controls(6)
  With M
      If IsGZB = False Then
        .Controls(1).Visible = False
        .Controls(2).Visible = False
        .Controls(3).Visible = False
        .Controls(4).Visible = False
      Else
        .Controls(1).Visible = True
        .Controls(2).Visible = True
        .Controls(3).Visible = True
        .Controls(4).Visible = True
      End If
  End With
AA: ErrSub
End Sub

Sub AddMenu()  '|fffd||fffd||fffd||4f2||2f5||fffd||fffd||fffd| 6.0|fffd||6fea||2bc||2b9||fffd||fffd|Ribbon|fffd||fffd||fffd||fffd||fffd||fffd||2b9||fffd||fffd|
  On Error GoTo AA:
  Dim M, Z, N, R As Object
  Set M = Application.CommandBars("Worksheet menu bar").Controls.Add(Type:=msoControlPopup, before:=7, temporary:=True)
  M.Caption = "|fffd||fffd||fffd||2b9||fffd||fffd||fffd|(&G)"
  
  '|fffd||fffd||2be|/|fffd||fffd||fffd||fffd|-------------------------------------------------------
  Set Z = M.Controls.Add(Type:=msoControlPopup): Z.Caption = "|fffd||fffd||2be|/|fffd||fffd||fffd||fffd|(&X)"
  
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||2be||fffd||2ba||fffd|(&X)":    N.OnAction = "|fffd||fffd||2be||fffd||2ba||fffd|":     N.FaceId = 2988
  
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||2ba||fffd|(&Y)":     N.OnAction = "|fffd||fffd||fffd||fffd||fffd||2ba||fffd|":     N.FaceId = 2989
     
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||2be||fffd||fffd||fffd||fffd|(&D)":     N.OnAction = "|fffd||fffd||2be||fffd||fffd||fffd||fffd|": N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||632||fffd||fffd||fffd|(&B)":     N.OnAction = "|fffd||fffd||fffd||632||fffd||fffd||fffd|"
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|(&R)":     N.OnAction = "|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|": N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|5bb||fffd||fffd||2be||fffd||bd71||1f0||5b0||fffd||fffd||36c||fffd||fffd||fffd||175||fffd||fffd||fffd|(&S)":     N.OnAction = "|5bb||fffd||fffd||2be||fffd||bd71||1f0||5b0||fffd||fffd||36c||fffd||fffd||fffd||175||fffd||fffd||fffd|"
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&C)":     N.OnAction = "|fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|(&L)":     N.OnAction = "|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|": N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&H)":     N.OnAction = "|fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&F)":     N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd||fffd||436||fffd||fffd||fffd|(&U)":     N.OnAction = "|221||fffd||fffd||fffd||fffd||fffd||fffd||fffd||436||fffd||fffd||fffd|"
     
     
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-------------------------------------------------------
  Set Z = M.Controls.Add(Type:=msoControlPopup): Z.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&F)"
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&E)": N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": N.FaceId = 2144
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|423||fffd||fffd||fffd||fffd||fffd||275||13d||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd|(&V)":  N.OnAction = "|423||fffd||fffd||fffd||fffd||fffd||275||13d||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd|":  N.FaceId = 2152
  
  
  '|fffd||fffd||fffd||fffd||fffd||fffd||13f|-------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||13f|(&I)": N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||13f|": N.FaceId = 583
     
  
  '|5b0||fffd||fffd||fffd||fffd||fffd||fffd|-------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|5b0||fffd||fffd||fffd||fffd||fffd||fffd|(&Z)": N.OnAction = "|5b0||fffd||fffd||fffd||fffd||fffd||fffd|": N.FaceId = 2131: N.BeginGroup = True
     
  '|fffd||fffd||fffd||179||fffd||fffd||fffd|-------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|fffd||fffd||fffd||179||fffd||fffd||fffd|(&D)": N.OnAction = "|fffd||fffd||fffd||179||fffd||fffd||fffd|": N.FaceId = 702
     
  '|fffd||fffd||fffd||774||fffd||fffd||fffd|  -------------------------------------------------------
  Set Z = M.Controls.Add(Type:=msoControlPopup): Z.Caption = "|fffd||fffd||fffd||774||fffd||fffd||fffd|(&C)"
  
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||279||fffd||fffd||fffd||fffd||fffd|(&T)":      N.OnAction = "|fffd||fffd||fffd||279||fffd||fffd||fffd||fffd||fffd|":       N.FaceId = 251
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||2f9||fffd||fffd||2b5||fffd|(&D)":      N.OnAction = "|fffd||fffd||fffd||2b5||fffd|":       N.FaceId = 209
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||174||fffd||4e1||fffd||139||fffd||fffd||2b1||fffd|(&B)":       N.OnAction = "|fffd||fffd||fffd||270||fffd||fffd||fffd||fffd||174||fffd||4e1||fffd||139||fffd||fffd||2b1||fffd|":      N.FaceId = 364: N.BeginGroup = True
     
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|(&I)":       N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||fffd||fffd||fffd||1f0||fffd||fffd||fffd||2b1||fffd|":      N.FaceId = 162: N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd|(&B)":       N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd|":      N.FaceId = 142: N.BeginGroup = True
     
     Set N = Z.Controls.Add(Type:=msoControlButton)
     N.Caption = "|fffd||fffd||fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&H)":       N.OnAction = "|fffd||fffd||fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":      N.FaceId = 695
     
  '|fffd||6fa||3f2||fffd||46f|  -------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|fffd||6fa||3f2||fffd||46f|(&Q)":      N.OnAction = "|fffd||6fa||3f2||fffd||46f|":         N.FaceId = 109
     
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  -------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)":    N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":       N.FaceId = 29
  
  '|fffd||fffd||2f0||fffd||fffd||fffd||fffd|  -------------------------------------------------------
  Set Z = M.Controls.Add(Type:=msoControlPopup): Z.Caption = "|fffd||fffd||2f0||fffd||fffd||fffd||fffd|(&G)": Z.BeginGroup = True
     
    Set N = Z.Controls.Add(Type:=msoControlButton)
    N.Caption = "|373||4bb||fffd||fffd||fffd||3d71||fffd||b6||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||138||fffd||2f0|(&G)":      N.OnAction = "|373||4bb||fffd||fffd||fffd||3d71||fffd||b6||fffd||3b7||fffd||fffd||179||fffd||fffd||2b5||138||fffd||2f0|": N.FaceId = 303
     
    Set N = Z.Controls.Add(Type:=msoControlButton)
    N.Caption = "|fffd||536||fffd||fffd||5d71||1f0||fffd||fffd||fffd||fffd||2f0||fffd||fffd||2bd|(&R)":      N.OnAction = "|fffd||536||fffd||fffd||5d71||1f0||fffd||fffd||fffd||fffd||2f0||fffd||fffd||2bd|": N.FaceId = 624
  
    
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  -------------------------------------------------------
  Set Z = M.Controls.Add(Type:=msoControlPopup): Z.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&T)"
  
    
    Set N = Z.Controls.Add(Type:=msoControlButton)
    N.Caption = "|fffd||7b8||135||fffd||3bb||fffd||fffd||fffd||fffd|(&N)":  N.OnAction = "|fffd||7b8||135||fffd||3bb||fffd||fffd||fffd||fffd|":       N.FaceId = 301: N.BeginGroup = True
    
    Set N = Z.Controls.Add(Type:=msoControlButton)
    N.Caption = "|fffd||7b8||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&Q)":  N.OnAction = "|fffd||7b8||fffd||3f5||373||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":       N.FaceId = 734
    
    Set N = Z.Controls.Add(Type:=msoControlButton)
    N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&D)":  N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":       N.FaceId = 327
    
    
  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  -------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&U)":    N.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":       N.FaceId = 107
  
  
  '|2b9||fffd||fffd||2f5||fffd||fffd|  -------------------------------------------------------
  Set N = M.Controls.Add(Type:=msoControlButton)
  N.Caption = "|2b9||fffd||fffd||2f5||fffd||fffd|(&H)":      N.OnAction = "|2b9||fffd||fffd||2f5||fffd||fffd|":       N.FaceId = 984
     
     
  '|fffd||4bc||fffd||fffd||2f5||fffd||fffd||fffd|
  Set R = Application.CommandBars("Cell").Controls.Add(Type:=msoControlButton, before:=1, temporary:=True)
      R.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)":  R.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": R.FaceId = 29

  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bc||fffd||fffd||2f5||fffd||fffd||fffd|
  Set R = Application.CommandBars("PLY").Controls.Add(Type:=msoControlButton, before:=1, temporary:=True)
      R.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&M)":  R.OnAction = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": R.FaceId = 29:    R.BeginGroup = True

AA: ErrSub
End Sub

Sub WBcheck()
 If Application.Workbooks.Count > 1 And Not (ThisWB Is Nothing) Then
    If ActiveWorkbook.FullName <> ThisWB.FullName Then Exit Sub
 End If
End Sub






INQUEST-PP=macro
