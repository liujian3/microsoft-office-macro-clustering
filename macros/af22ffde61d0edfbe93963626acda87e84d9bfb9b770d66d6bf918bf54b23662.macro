Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'************************************************************************************************
'  Workbook_BeforePrint - Header and footers for the excel sheets                               *
'                                                                                               *
'  OTHER FILES REQUIRED:                                                                        *
'       None                                                                                    *
'                                                                                               *
'  AUTHOR:   Matthias Chan                                                                      *
'  EMAIL:    Matthias.P.Chan@ehi.com                                                            *
'  CREATED:  01/09/2012                                                                         *
'************************************************************************************************

'*******************************************BEGIN CODE*******************************************
Private Sub Workbook_BeforePrint(cancel As Boolean)

ActiveSheet.PageSetup.CenterHeader = "&18National Dropcharges - " & ActiveSheet.Name
ActiveSheet.PageSetup.RightFooter = "&iLast Updated " & _
    Format(FileDateTime(ThisWorkbook.FullName), "mmmm dd,yyyy&i")
ActiveSheet.PageSetup.LeftFooter = "&iFranchise operations" & Chr(13) & _
    "Dropcharges are subject to change without notice&i"

End Sub
'********************************************END CODE********************************************


'************************************************************************************************
'  Workbook_Open - Open correct files and re-save to protect data                               *
'                                                                                               *
'  OTHER FILES REQUIRED:                                                                        *
'       Drop Charges Loader.xls                                                                 *
'                                                                                               *
'  AUTHOR:   Matthias Chan                                                                      *
'  EMAIL:    Matthias.P.Chan@ehi.com                                                            *
'  CREATED:  01/09/2012                                                                         *
'************************************************************************************************

'*******************************************BEGIN CODE*******************************************
Private Sub Workbook_Open()

Dim strFileNm As String
Dim boolTempOpen As Boolean
Dim boolLoadOpen As Boolean
Dim wbkMLAC As Workbook
Dim wbkTemp As Workbook

strFileNm = Path & "\" & Name
Set wbkMLAC = ActiveWorkbook

Application.DisplayAlerts = False

If Right(Name, 3) = "xls" Then
    For Each wbkTemp In Workbooks
        If wbkTemp.Name = Left(Name, Len(Name) - 4) & " Temp.xls" Then
            boolTempOpen = True
        End If
        If wbkTemp.Name = "Drop Charges Loader.xls" Then
            boolLoadOpen = True
        End If
    Next wbkTemp
    If boolTempOpen = False Then
        SaveAs Left(strFileNm, Len(strFileNm) - 4) & " Temp"
    End If
Else
    For Each wbkTemp In Workbooks
        If wbkTemp.Name = Left(Name, Len(Name) - 5) & " Temp.xlsm" Then
            boolTempOpen = True
        End If
        If wbkTemp.Name = "Drop Charges Loader.xls" Then
            boolLoadOpen = True
        End If
    Next wbkTemp
    If boolTempOpen = False Then
        SaveAs Left(strFileNm, Len(strFileNm) - 5) & " Temp"
    End If
End If

If boolLoadOpen = False Then
    Workbooks.Open (Path & "\Drop Charges Loader.xls")
End If

Application.DisplayAlerts = True

wbkMLAC.Activate
End Sub
'********************************************END CODE********************************************




Attribute VB_Name = "UpdateAndSave"
Option Explicit

'************************************************************************************************
'  updateAndSave - Find data that was updated and load into the Drop Charges Loader             *
'                                                                                               *
'  OTHER FILES REQUIRED:                                                                        *
'       Drop Charges Loader.xls                                                                 *
'                                                                                               *
'  AUTHOR:   Matthias Chan                                                                      *
'  EMAIL:    Matthias.P.Chan@ehi.com                                                            *
'  CREATED:  01/09/2012                                                                         *
'************************************************************************************************

'*******************************************BEGIN CODE*******************************************
Sub updateAndSave()

Application.ScreenUpdating = False
Application.StatusBar = "Looking for updated cells"

'******************************************DECLARATIONS******************************************
Dim wbkNationalNew As Workbook
Dim wbkNationalOld As Workbook
Dim wbkChgLoad As Workbook
Dim shtInstructions As Worksheet
Dim shtCountryNew As Worksheet
Dim shtCountryOld As Worksheet
Dim rngCountryDataNew As Range
Dim rngCountryDataOld As Range
Dim intNewRec As Integer
Dim intRow As Integer
Dim intCol As Integer
Dim intType As Integer
Dim bytReply As Byte

'*******************************************INITIALIZE*******************************************
Application.DisplayAlerts = False
If InStr(LCase$(ThisWorkbook.Name), "temp") = 0 Then
    If Right(ThisWorkbook.Name, 3) = "xls" Then
        ThisWorkbook.SaveAs ThisWorkbook.Path & "\" & _
        Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4) & " Temp"
    Else
        ThisWorkbook.SaveAs ThisWorkbook.Path & "\" & _
        Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 5) & " Temp"
    End If
End If
Application.DisplayAlerts = True

Set wbkNationalNew = ActiveWorkbook

If Right(ThisWorkbook.Name, 3) = "xls" Then
    Workbooks.Open (ThisWorkbook.Path & "\" & _
    Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 9) & ".xls")
Else
    Workbooks.Open (ThisWorkbook.Path & "\" & _
    Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 10) & ".xlsm")
End If
Set wbkNationalOld = ActiveWorkbook
Set wbkChgLoad = Workbooks("Drop Charges Loader")
Set shtInstructions = Sheets("Instructions")
wbkNationalNew.Activate

intRow = 5
intNewRec = 0
Do While intNewRec = 0
    If Len(wbkChgLoad.ActiveSheet.Cells(intRow, 1)) = 0 Then
        intNewRec = intRow
    Else
        intRow = intRow + 1
    End If
Loop

'***************************************FIND UPDATED CELLS***************************************
For Each shtCountryNew In wbkNationalNew.Sheets
    If shtCountryNew.Name <> "Instructions" Then
        Set shtCountryOld = wbkNationalOld.Sheets(shtCountryNew.Name)
        shtCountryNew.Activate
        Set rngCountryDataNew = shtCountryNew.Range("D8", Range("D8").End(xlDown).End(xlToRight))
        shtCountryOld.Activate
        Set rngCountryDataOld = shtCountryOld.Range("D8", Range("D8").End(xlDown).End(xlToRight))
        If ActiveSheet.Name = "Peru" Then
            shtCountryNew.Activate
            Set rngCountryDataNew = Range("D8")
            shtCountryOld.Activate
            Set rngCountryDataOld = Range("D8")
        End If
        For intRow = 1 To rngCountryDataNew.Rows.Count
            For intCol = 1 To rngCountryDataNew.Columns.Count
                If rngCountryDataNew(intRow, intCol) <> rngCountryDataOld(intRow, intCol) Then
                    wbkChgLoad.ActiveSheet.Cells(intNewRec, 1) = "National"
                    wbkChgLoad.ActiveSheet.Cells(intNewRec, 3) = _
                        shtCountryNew.Cells(intRow + 7, 3)
                    wbkChgLoad.ActiveSheet.Cells(intNewRec, 7) = _
                        shtCountryNew.Cells(7, intCol + 3)
                    wbkChgLoad.ActiveSheet.Cells(intNewRec, 9) = _
                        rngCountryDataNew(intRow, intCol)
                    intNewRec = intNewRec + 1
                End If
            Next intCol
        Next intRow
    End If
Next shtCountryNew

'******************************************SAVE WORKBOOK*****************************************
wbkNationalNew.Activate
Sheets("Instructions").Activate

intType = vbYesNo
bytReply = MsgBox("Would you like to save the file?", intType, "MLAC Drop Charge National")

Application.DisplayAlerts = False
If Right(ThisWorkbook.Name, 3) = "xls" Then
    Workbooks(Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 9) & ".xls").Close
    If bytReply = vbYes Then
        ThisWorkbook.SaveAs ThisWorkbook.Path & "\" & _
        Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 9) & ".xls"
    End If
Else
    Workbooks(Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 10) & ".xlsm").Close
    If bytReply = vbYes Then
        ThisWorkbook.SaveAs ThisWorkbook.Path & "\" & _
        Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 10) & ".xlsm"
    End If
End If
Application.DisplayAlerts = True

Application.ScreenUpdating = True
Application.StatusBar = False
End Sub
'********************************************END CODE********************************************






INQUEST-PP=macro
