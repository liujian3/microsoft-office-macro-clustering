Attribute VB_Name = "EditorialMacros"
Option Explicit


Public Sub InitForEditorial()
  '
  ' Code for editorial special setups that need to be called
  '  after saving or on worksheet initialization.
  '
    Application.ScreenUpdating = False
    Application.EnableEvents = False

    If Sheet2.Range("DiscDetail1").Value = "All of the necessary " & _
            "questions have not been answered completely. Please " & _
            "return to the Input worksheet for completion." Then

        Sheet2.Visible = xlSheetVeryHidden
    End If

    If Range("Question4b").Rows.Hidden = True Then
        Sheet1.Q4bYes.Visible = False
        Sheet1.Q4bNo.Visible = False
    End If
    If Range("Question4a").Rows.Hidden = True Then
        Sheet1.Q4aYes.Visible = False
        Sheet1.Q4aNo.Visible = False
    End If
    If Range("Question3TB").Rows.Hidden = True Then
        Sheet1.TB3b.Visible = False
        Sheet1.TB3a.Visible = False
    End If
    If Range("Question3").Rows.Hidden = True Then
        Sheet1.Q3Yes.Visible = False
        Sheet1.Q3No.Visible = False
    End If
    If Range("Question2").Rows.Hidden = True Then
        Sheet1.Q2Yes.Visible = False
        Sheet1.Q2No.Visible = False
    End If

    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Public Sub Workbook_BeforeClose_Editorial()
  '
  ' Code for editorial special setups that need to be called
  '  before close.
  '

End Sub

Attribute VB_Name = "EditorialMacros_Deactivate"
Option Explicit

Public Sub Workbook_Deactivate_Editorial()
  '
  ' Code for editorial special setups that need to be called
  '  when leaving the workbook without closing it. This, will
  '  also run when closing workbook.
  '
End Sub

Attribute VB_Name = "PPC_CodeModule"
Public Sub MacroCheck()
'Do nothing. This sub will be called from .NET code to check macro is enabled or not
End Sub


Public Function PPC_GetClientName()
  PPC_GetClientName = Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Client_Name")
End Function

Public Function PPC_GetBalanceSheetDate()
  PPC_GetBalanceSheetDate = Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Engagement_Date")
End Function

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RollforwardButton, 22, 1, MSForms, CommandButton"
Attribute VB_Control = "Q4bNo, 16, 2, MSForms, OptionButton"
Attribute VB_Control = "Q4bYes, 15, 3, MSForms, OptionButton"
Attribute VB_Control = "Q4aNo, 14, 4, MSForms, OptionButton"
Attribute VB_Control = "Q4aYes, 13, 5, MSForms, OptionButton"
Attribute VB_Control = "TB3b, 12, 6, MSForms, TextBox"
Attribute VB_Control = "TB3a, 10, 7, MSForms, TextBox"
Attribute VB_Control = "Q3No, 8, 8, MSForms, OptionButton"
Attribute VB_Control = "Q3Yes, 7, 9, MSForms, OptionButton"
Attribute VB_Control = "Q2No, 5, 10, MSForms, OptionButton"
Attribute VB_Control = "Q2Yes, 4, 11, MSForms, OptionButton"
Attribute VB_Control = "ClearButton, 3, 12, MSForms, CommandButton"

Private Sub ClearButton_Click()

    Dim ans As String
    Dim WPEENAME As String
    WPEENAME = "PPC's Workpapers"
    
    Beep
    ans = MsgBox("Are you sure you want to clear all inputs?", vbYesNo, WPEENAME)
        If ans = vbNo Then
            Exit Sub
        End If
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Sheet2.Visible = xlSheetHidden
    
    Range("InputClear").ClearContents
    With Range("Conclude1")
        .Font.Italic = True
        .IndentLevel = 2
        .RowHeight = 25.5
        .WrapText = True
        .Value = "Enter the statement of financial position date in the " & _
                 "header above before answering Step 1."
    End With
'*****Clear Instruct31*****
    Range("InstructQ31").Value = ""
'**************************
    Q2Hide
    Q3Hide
    Q3TBHide
    Q4Hide
    
    Range("YearEnd").Value = "=PPC_GetBalanceSheetDate()"
    Range("Client").Value = "=PPC_GetClientName()"
    Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Client_Name") = "[Client Name]"
    Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Engagement_Date") = ""
    Application.ActiveWorkbook.ActiveSheet.EnableCalculation = False
    Application.ActiveWorkbook.ActiveSheet.EnableCalculation = True
    
    Range("a1").Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Step3Show()

    If Q3Yes.Value = False And Q3No.Value = False Then
        Range("Question3").EntireRow.Hidden = False
        With Q3Yes
            .Visible = True
            .Left = 421.5
            .Top = Range("Question3").Top + 12.75
            .Value = False
        End With
        With Q3No
            .Visible = True
            .Left = 459.75
            .Top = Range("Question3").Top + 12.75
            .Value = False
        End With
        Q3TBHide
        Q4Hide
        Range("Question3").Cells(1, 2).Select
        Sheet2.Visible = xlSheetVeryHidden
    ElseIf Q3Yes.Value = True Or Q3No.Value = True Then
'*****Add TB input instructions to Instruct 31???*****
        Application.ActiveWindow.ScrollRow = Range("Question1").Row
        If TB3a.Value = "" Then
            Q4Hide
            TB3a_GotFocus
            Sheet2.Visible = xlSheetVeryHidden
        ElseIf TB3a.Value <> "" And TB3b.Value = "" Then
            Q4Hide
            TB3b_GotFocus
            Sheet2.Visible = xlSheetVeryHidden
        Else
'*****Clear Instruct31???*****
            Range("InstructQ32").Font.Italic = False
            If Q3Yes.Value = True Then
                With Range("InstructQ32")
                    .IndentLevel = 3
                    .Rows.RowHeight = 12.75
                    .Value = "Go to Step 4a."
                End With
                Application.ActiveWindow.ScrollRow = Range("Question3").Row
                Step4Show
            ElseIf Q3No.Value = True Then
                With Range("InstructQ32")
                    .IndentLevel = 3
                    .Rows.RowHeight = 38.25
                    .Value = "Substantial doubt about the Organization|fffd|s ability to " & _
                             "continue as a going concern is alleviated, but " & _
                             "disclosure is necessary. Go to the Disclosure worksheet."
                End With
                Application.ActiveWindow.ScrollRow = Range("Question2").Row
                Sheet2.Visible = xlSheetVisible
                Range("InstructQ32").Select
            End If
        End If
    End If
        
End Sub

Private Sub Step4Show()

    If Q4aYes.Value = False And Q4aNo.Value = False Then
        Range("Question4a").EntireRow.Hidden = False
        With Q4aYes
            .Visible = True
            .Left = 421.5
            .Top = Range("Question4a").Top + 38.25
            .Value = False
        End With
        With Q4aNo
            .Visible = True
            .Left = 459.75
            .Top = Range("Question4a").Top + 38.25
        End With
        Range("Question4a").Cells(3, 2).Select
        Sheet2.Visible = xlSheetVeryHidden
    ElseIf Q4bYes.Value = False And Q4bNo.Value = False Then
        Range("Question4b").EntireRow.Hidden = False
        With Q4bYes
            .Visible = True
            .Left = 421.5
            .Top = Range("Question4b").Top + 12
            .Value = False
        End With
        With Q4bNo
            .Visible = True
            .Left = 459.75
            .Top = Range("Question4b").Top + 12
            .Value = False
        End With
        Range("Question4b").Cells(1, 2).Select
        Sheet2.Visible = xlSheetVeryHidden
    Else
        Range("Conclude4").Select
        If Sheet2.Visible = xlSheetVeryHidden Then
            Sheet2.Visible = xlSheetVisible
        End If
    End If

End Sub

Private Sub RollforwardButton_Click()
'
'
    Dim ans As String
    Dim WPEENAME As String
    WPEENAME = "PPC's Workpapers"
    
    Beep
        ans = MsgBox("Certain information will be carried forward to " & vbCrLf & _
                     "the next period. Do you want to continue?", vbYesNo, WPEENAME)
    
    If ans = vbNo Then
        Exit Sub
    End If
    If ans = vbYes Then
    
        Application.ScreenUpdating = False
        Application.EnableEvents = False
    
        Sheet2.Visible = xlSheetHidden
        Range("ClearRoll").ClearContents
        With Range("Conclude1")
            .Font.Italic = True
            .IndentLevel = 2
            .RowHeight = 25.5
            .WrapText = True
            .Value = "Enter the statement of financial position date in the " & _
                     "header above before answering Step 1."
        End With
        Q4Hide
        If Range("Question3").EntireRow.Hidden = True Then
            Q2Hide
        Else
            If Q3Yes.Value = False And Q3No.Value = False Then
                Q3TBHide
            ElseIf Q3Yes.Value = True And Q3No.Value = False Then
                If TB3a = "" And TB3b = "" Then
                    Q3TBHide
                Else
'*****Changed from Instruct32 to Instruct31*****
                    With Range("InstructQ31")
                        .Font.Italic = True
                        .Rows.RowHeight = 12.75
                        .IndentLevel = 2
                        .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                                 "before proceeding."
                    End With
                End If
            ElseIf Q3Yes.Value = False And Q3No.Value = True Then
                If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Then
                    If TB3a = "" And TB3b = "" Then
                        Q3TBHide
                    Else
'*****Changed from Instruct32 to Instruct31*****
                        With Range("InstructQ31")
                            .EntireRow.Hidden = True
                            .RowHeight = 12.75
                            .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                                 "before proceeding."
                        End With
                    End If
                ElseIf Q2No.Value = True Or IsNull(Q2No.Value) Then
                    Q3TBHide
                End If
           End If
        End If
        If Q3Yes.Value = True And Q3No.Value = False Then
            Q2No.Value = False 'And Q2Yes.Value = Null 'IsNull(Q2Yes.Value)
            Q2Yes.Value = ""
        ElseIf Q3Yes.Value = False And Q3No.Value = True Then
            Q2Yes.Value = False 'And IsNull(Q2No.Value)
            Q2No.Value = ""
        ElseIf Q3Yes.Value = False And Q3No.Value = False Then
            Q2Yes.Value = False 'And Q2No.Value = False
            Q2No.Value = False
        End If
        If IsNull(Q2Yes.Value) Or IsNull(Q2No.Value) Then
            Q3Yes.Value = False
            Q3No.Value = False
            Conclude3Comment
        Else
            Q2Hide
            Q3Hide
            Conclude3Comment
        End If
'*****Added Clear Instruct32*****
        Range("InstructQ32").Value = ""
'********************************
        Range("YearEnd").Value = "=PPC_GetBalanceSheetDate()"
        Range("YearEnd").Value = "=PPC_GetBalanceSheetDate()"
        Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Engagement_Date") = ""
        Application.ActiveWorkbook.ActiveSheet.EnableCalculation = False
        Application.ActiveWorkbook.ActiveSheet.EnableCalculation = True
        
        Range("a1").Select
    End If
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Conclude3Comment()

    If Not Range("Conclude3").Offset(0, -1).Comment Is Nothing Then
       Range("Conclude3").Offset(0, -1).Comment.Delete
    End If
    If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Then
        If Q3Yes.Value = True Or Q3No.Value = True Then
            Range("Conclude3").Offset(0, -1).AddComment
            With Range("Conclude3").Offset(0, -1).Comment
                If Q3Yes.Value = True Then
                    .Text Text:="If there was substantial doubt about the Organization|fffd|s " & vbCrLf & _
                        "ability to continue as a going concern in the prior period " & vbCrLf & _
                        "that continues in the current period, the current period's" & vbCrLf & _
                        "going concern disclosures about the relevant conditions or" & vbCrLf & _
                        "events and management|fffd|s plans (in the two textboxes)" & vbCrLf & _
                        "should become more extensive than those of the prior" & vbCrLf & _
                        "period as additional information becomes available."
                ElseIf Q3No.Value = True Then
                     .Text Text:="If there was substantial doubt about the Organization|fffd|s ability to " & vbCrLf & _
                        "continue as a going concern in the prior period that was " & vbCrLf & _
                        "resolved in the current period, the current period's going " & vbCrLf & _
                        "concern disclosures about the relevant conditions or events " & vbCrLf & _
                        "(in the first textbox) should become more extensive than " & vbCrLf & _
                        "those of the prior period as additional information becomes" & vbCrLf & _
                        "available. Also, the current period's disclosures should " & vbCrLf & _
                        "describe (in the second textbox) how the relevant conditions" & vbCrLf & _
                        "or events that raised substantial doubt were resolved."
                End If
                With Range("Conclude3").Offset(0, -1).Comment.Shape
                    With .TextFrame
                        .AutoSize = True
                        .Characters.Font.Size = 8
                    End With
                End With
            End With
        End If
    End If

End Sub




Private Static Sub TB3a_GotFocus()

    Dim BegText As String

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    If TB3a.Activate = False Then
        Exit Sub
    End If
    TB3a.BorderColor = &H8000& ''green border to show textbox has focus
    
    BegText = TB3a.Text           'the next 3 lines used to force the green border to appear
    TB3a.Text = TB3a.Text & vbCrLf
    TB3a.Text = BegText

    Application.ScreenUpdating = True

End Sub

Private Sub TB3a_Change()

    Application.EnableEvents = False
    Application.EnableEvents = True

End Sub

Private Sub TB3a_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    
    Dim MoveBack As Boolean
        
    Select Case KeyCode
            ''' This is the only key necessary.
        Case vbKeyTab
            Application.ScreenUpdating = False
                ''' Determine if need to move backwards.
            MoveBack = CBool(Shift And 1)
                ''' Activate appropriate control based on key(s) pressed.
            If MoveBack Then
                Call TB3a_LostFocus
                Range("Question3").Cells(1, 2).Select
            Else
                Call TB3a_LostFocus
            End If
                
            Application.ScreenUpdating = True
    End Select

End Sub

Private Sub TB3a_LostFocus()

    Dim TargetCellTB3a As Range
    Dim AnchorSheet As Worksheet
    Set TargetCellTB3a = ActiveCell
    Set AnchorSheet = ActiveSheet
    Application.EnableEvents = False
   
    If AnchorSheet.Name = "Disclosure" Then
        Sheet1.Activate
    Else
        TB3a.Activate
    End If
    TB3a.BorderColor = &HC0C0C0 'grey border to show no focus
    TB3a.Width = 454.5
    If TB3a.Height < 408 Then
        TB3a.ScrollBars = fmScrollBarsNone
    End If
    If TB3a.LineCount <= 4 Then
        TB3a.Height = 52.5
        Range("TB3aBegin").RowHeight = 51
    ElseIf TB3a.LineCount > 4 And TB3a.LineCount <= 9 Then
        TB3a.Height = ((TB3a.LineCount) * 1.02) * 12.75
        Range("TB3aBegin").RowHeight = ((TB3a.LineCount) * 1.02) * 12.75
    ElseIf TB3a.LineCount > 9 And TB3a.LineCount <= 20 Then
        TB3a.Height = ((TB3a.LineCount) * 0.99) * 12.75
        Range("TB3aBegin").RowHeight = ((TB3a.LineCount) * 0.99) * 12.75
    ElseIf TB3a.LineCount > 20 And TB3a.LineCount <= 30 Then
        TB3a.Height = ((TB3a.LineCount) * 0.98) * 12.75
        Range("TB3aBegin").RowHeight = ((TB3a.LineCount) * 0.98) * 12.75
    ElseIf TB3a.LineCount > 30 And TB3a.LineCount <= 33 Then
        TB3a.Height = ((TB3a.LineCount) * 0.97) * 12.75
        Range("TB3aBegin").RowHeight = ((TB3a.LineCount) * 0.97) * 12.75
    ElseIf TB3a.LineCount > 33 Then
        With TB3a
            .Height = 408
            .ScrollBars = fmScrollBarsVertical
        End With
        Range("TB3aBegin").RowHeight = 408
    End If
    If AnchorSheet.Name = "Disclosure" Then
        Range("Conclude3").Select
        Application.EnableEvents = True
        Sheet2.Activate
        Exit Sub
    Else
        With TB3b
            .Visible = True
            .Left = 33.75
            .Top = Range("TB3bBegin").Top
            .Width = 454.5
        End With
        TB3b_GotFocus
    End If
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True


End Sub

Private Static Sub TB3b_GotFocus()

    Dim BegText As String

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    If TB3b.Activate = False Then
        Exit Sub
    End If
    TB3b.BorderColor = &H8000& ''green border to show textbox has focus
    
    BegText = TB3b.Text           'the next 3 lines used to force the green border to appear
    TB3b.Text = TB3b.Text & vbCrLf
    TB3b.Text = BegText

    Application.ScreenUpdating = True

End Sub

Private Sub TB3b_Change()

    Application.EnableEvents = False
    Application.EnableEvents = True

End Sub

Private Sub TB3b_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    
    Dim MoveBack As Boolean
    Dim TargetCell As Range
    Set TargetCell = ActiveCell
    
    Select Case KeyCode
            ''' This is the only key necessary.
        Case vbKeyTab
            Application.ScreenUpdating = False
                ''' Determine if need to move backwards.
            MoveBack = CBool(Shift And 1)
                ''' Activate appropriate control based on key(s) pressed.
            If MoveBack Then
                Call TB3b_LostFocus
                With TB3a
                    .Visible = True
                    .Left = 33.75
                    .Top = Range("TB3aBegin").Top
                    .Width = 454.5
                End With
                TB3a_GotFocus
            Else
                Call TB3b_LostFocus
            End If
                
            Application.ScreenUpdating = True
    End Select

End Sub

Private Sub TB3b_LostFocus()

    Dim TargetCellTB3b As Range
    Dim AnchorSheet As Worksheet
    Set TargetCellTB3b = ActiveCell
    Set AnchorSheet = ActiveSheet
    Application.EnableEvents = False
   
    If AnchorSheet.Name = "Disclosure" Then
        Sheet1.Activate
    Else
        TB3b.Activate
    End If
    TB3b.BorderColor = &HC0C0C0 'grey border to show no focus
    TB3b.Width = 454.5
    If TB3b.Height < 408 Then
        TB3b.ScrollBars = fmScrollBarsNone
    End If
    If TB3b.LineCount <= 4 Then
        TB3b.Height = 52.5
        Range("TB3bBegin").RowHeight = 51
    ElseIf TB3b.LineCount > 4 And TB3b.LineCount <= 9 Then
        TB3b.Height = ((TB3b.LineCount) * 1.02) * 12.75
        Range("TB3bBegin").RowHeight = ((TB3b.LineCount) * 1.02) * 12.75
    ElseIf TB3b.LineCount > 9 And TB3b.LineCount <= 20 Then
        TB3b.Height = ((TB3b.LineCount) * 0.99) * 12.75
        Range("TB3bBegin").RowHeight = ((TB3b.LineCount) * 0.99) * 12.75
    ElseIf TB3b.LineCount > 20 And TB3b.LineCount <= 30 Then
        TB3b.Height = ((TB3b.LineCount) * 0.98) * 12.75
        Range("TB3bBegin").RowHeight = ((TB3b.LineCount) * 0.98) * 12.75
    ElseIf TB3b.LineCount > 30 And TB3b.LineCount <= 33 Then
        TB3b.Height = ((TB3b.LineCount) * 0.97) * 12.75
        Range("TB3bBegin").RowHeight = ((TB3b.LineCount) * 0.97) * 12.75
    ElseIf TB3b.LineCount > 33 Then
        With TB3b
            .Height = 408
            .ScrollBars = fmScrollBarsVertical
        End With
        Range("TB3bBegin").RowHeight = 408
    End If
    
''''''''''''
    If Q2Yes.Value = False And Q2No.Value = False Then
        Range("Question2").Cells(1, 2).Select
        GoTo Anchor
    End If
    If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Then
        If Q3Yes.Value = False And Q3No.Value = False Then
            Step3Show
            GoTo Anchor
        End If
        If TB3a.Value = "" Or TB3b.Value = "" Then
'*****Changed from Instruct32 to Instruct31*****
            With Range("InstructQ31")
                .Font.Italic = True
                .Rows.RowHeight = 25.5
                .IndentLevel = 2
                If Q3Yes.Value = True Then
                    .Value = "Both textboxes will become part of the disclosure " & _
                             "on the Disclosure worksheet. Complete both " & _
                             "textboxes before proceeding to the next Step."
                ElseIf Q3No.Value = True Then
                    .Value = "Both textboxes will become part of the disclosure " & _
                             "on the Disclosure worksheet. Complete both " & _
                             "textboxes before proceeding."
                End If
            End With
'*****Added this*****
            With Range("InstructQ32")
                .Font.Italic = False
                .IndentLevel = 3
                .Rows.RowHeight = 12.75
                .Value = ""
            End With
'********************
            Q4Hide
            Conclude4Hide
        End If
        If TB3a.Value = "" Then
            Range("TB3aBegin").Offset(-1, 0).Select
            GoTo Anchor
        End If
        If TB3b.Value = "" Then
            Range("TB3bBegin").Offset(-1, 0).Select
            GoTo Anchor
        End If
        If TB3b.Value <> "" Then
'*****Clear Instruct31*****
            Range("InstructQ31").Value = ""
'**************************
            If Q3Yes.Value = True Then
                Application.ActiveWindow.ScrollRow = Range("Question3").Row
                With Range("InstructQ32")
                    .Font.Italic = False
                    .IndentLevel = 3
                    .Rows.RowHeight = 12.75
                    .Value = "Go to Step 4a."
                End With
                Step4Show
            End If
            If Q3No.Value = True Then
                Application.ActiveWindow.ScrollRow = Range("Question2").Row
                With Range("InstructQ32")
                    .Font.Italic = False
                    .IndentLevel = 3
                    .Rows.RowHeight = 30
                    .Value = "Substantial doubt about the Organization|fffd|s ability to " & _
                             "continue as a going concern is alleviated, but " & _
                             "disclosure is necessary. Go to the Disclosure worksheet."
                End With
                Sheet2.Visible = xlSheetVisible
                Q4Hide
                Conclude4Hide
                Range("InstructQ32").Select
            End If
        End If
    End If
''''''''''''
    If Q2No.Value = True Or IsNull(Q2No.Value) Then
        If TB3a.Value = "" Or TB3b.Value = "" Then
'*****Changed from Instruct32 to Instruct31*****
            With Range("InstructQ31")
                .Font.Italic = True
                .Rows.RowHeight = 25.5
                .IndentLevel = 2
                .Value = "Both textboxes will become part of the disclosure on the " & _
                         "Disclosure worksheet. Complete both textboxes before " & _
                         "proceeding to the next Step."
            End With
'*****Added this*****
            With Range("InstructQ32")
                .Font.Italic = False
                .IndentLevel = 3
                .Rows.RowHeight = 12.75
                .Value = ""
            End With
'********************
        End If
        If Q3Yes.Value = False And Q3No.Value = False Then
'*****Changed from Instruct32 to Instruct31*****
            With Range("InstructQ31")
                .Rows.RowHeight = 12.75
                .Value = "Answer ""Yes"" or ""No"" to the Step 3 question before " & _
                         "proceeding."
            End With
            Range("Question3").Cells(1, 2).Select
            GoTo Anchor
        End If
        If Q3Yes.Value = True Then
            If TB3a.Value = "" Then
                Range("TB3aBegin").Offset(-1, 0).Select
'*****Added this*****
                With Range("InstructQ32")
                    .Font.Italic = False
                    .IndentLevel = 3
                    .Rows.RowHeight = 12.75
                    .Value = ""
                End With
'********************
                Q4Hide
                GoTo Anchor
            End If
            If TB3b.Value = "" Then
                Range("TB3bBegin").Offset(-1, 0).Select
'*****Added this*****
                With Range("InstructQ32")
                    .Font.Italic = False
                    .IndentLevel = 3
                    .Rows.RowHeight = 12.75
                    .Value = ""
                End With
'********************
                Q4Hide
                GoTo Anchor
            End If
            If TB3b.Value <> "" Then
                Application.ActiveWindow.ScrollRow = Range("Question3").Row
'*****Clear Instruct31*****
                Range("InstructQ31").Value = ""
'**************************
                With Range("InstructQ32")
                    .Font.Italic = False
                    .IndentLevel = 3
                    .Rows.RowHeight = 12.75
                    .Value = "Go to Step 4a."
                End With
                Step4Show
            End If
        End If
        If Q3No.Value = True Then
            Q4Hide
            With Range("InstructQ32")
                .Font.Italic = False
                .Rows.EntireRow.Hidden = True
                .Rows.RowHeight = 12.75
                .Value = ""
            End With
            Range("Conclude3").Select
            GoTo Anchor
        End If
    End If
    
Anchor:
    If AnchorSheet.Name = "Disclosure" Then
        Application.EnableEvents = True
        Sheet2.Visible = xlSheetVisible
        Sheet2.Activate
    End If
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_Activate()
    
    If Sheet2.Range("DiscDetail1").Value = "All of the necessary " & _
            "questions have not been answered completely. Please " & _
            "return to the Input worksheet for completion." Then

        Sheet2.Visible = xlSheetVeryHidden
    End If

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
'This routine launches whenever a change is made to the spreadsheet. If the
'change is made to  the Answer1 ranges (currently cell $H$11) this routine
'launches a related routine Question1Answer. Otherwise, the routine ends
'without any action.


    If Not Application.Intersect(Range("Answer1"), Range(Target.Address)) _
    Is Nothing Then
        NewEntry = Range("Answer1").Value
        Application.EnableEvents = False
        Application.Undo
        oldentry = Range("Answer1").Value
        Range("Answer1").Value = NewEntry
        Application.EnableEvents = True
        Question1Answer (oldentry)
    End If

End Sub

Private Sub Question1Answer(oldentry)

'When changes are made to Answer1 (currently cell $H$11, this routine
'is called [by the Private Sub Worksheet_Change(ByVal Target As Range)] to
'determine whether the statement of financial position date (in the header) was previously
'entered and if the statement of financial position date precedes the Answer1 date input by the
'user. If the conditions are not satified, the conclusion instructs the user
'to correct the error and moves the cursor to the problem cell. When all dates
'are valid, Question 2 becomes visible.

    Dim ans As String
    Dim WPEENAME As String
    WPEENAME = "PPC's Workpapers"


    Application.ScreenUpdating = False
    Application.EnableEvents = False

    With Range("Conclude1")
        .Font.Italic = True
        .IndentLevel = 2
        .RowHeight = 12.75
        .WrapText = False
    End With
    If Range("Answer1").Value = "" Then
        Range("Conclude1").Value = "A date must be entered to continue."
        If Range("Question2").EntireRow.Hidden = False Then
            If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Or Q2No.Value = True _
             Or IsNull(Q2No.Value) Then
                If oldentry <> "" Then
                    Beep
                    ans = MsgBox("Deleting this date will clear the remaining " & _
                             vbCrLf & "worksheet. To keep existing data, select " & _
                             vbCrLf & """Yes"" and overwrite the old date with " & _
                             "a " & vbCrLf & "new date. Otherwise, select " & _
                             """No"".", vbYesNo, WPEENAME)
                    Range("Answer1").Value = oldentry
                    With Range("Conclude1")
                        .Font.Italic = False
                        .IndentLevel = 3
                        .Value = "Go to Step 2."
                    End With
                    If ans = vbNo Then
                        Range("Answer1").Value = ""
                        Range("conclude1").Value = ""
                        Q2Hide
                        Q3Hide
                        Q3TBHide
                        Q4Hide
                    End If
                End If
            ElseIf Q2Yes.Value = False And Q2No.Value = False Then
                Q2Hide
            End If
        End If
        Range("Answer1").Select
        GoTo Quit
    End If

    If Range("Answer1").Value <> "" And Range("YearEnd").Value = "" Then
        With Range("Conclude1")
            .RowHeight = 25.5
            .WrapText = True
            .Value = "Enter the statement of financial position date in the " & _
                     "header above before answering this question."
        End With
        Range("Answer1").Value = ""
        If Range("Question2").EntireRow.Hidden = False Then
            If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Or Q2No.Value = True _
             Or IsNull(Q2No.Value) Then
                Q2Hide
                Q3Hide
                Q3TBHide
            ElseIf Q2Yes.Value = False And Q2No.Value = False Then
                Q2Hide
                Q3Hide
                Q3TBHide
            End If
        End If
        Range("InstructQ32").Value = ""
        Range("InstructQ32").EntireRow.Hidden = True
        Q4Hide
        Range("YearEnd").Select
        GoTo Quit
    End If
    If Range("Answer1").Value <> "" And Range("Answer1").Value <= Range("YearEnd").Value Then
        With Range("Conclude1")
            .RowHeight = 25.5
            .WrapText = True
            .Value = "The date that the financial statements are available to be " & _
                     "issued must occur after the statement of financial position date."
        End With
        If Range("Question2").EntireRow.Hidden = False Then
            If Q2Yes.Value = False And Q2No.Value = False Then
                Q2Hide
                Q3Hide
                Q3TBHide
            ElseIf Q2Yes.Value = True Or IsNull(Q2Yes.Value) Or Q2No.Value = True _
             Or IsNull(Q2No.Value) Then
                If oldentry <> "" And oldentry > Range("Answer1").Value Then
                    Beep
                    ans = MsgBox("The date entered is prior to the " & vbCrLf & _
                             "statement of financial position date. " & vbCrLf & _
                             "Keeping this date will clear the " & vbCrLf & _
                             "remainder of this worksheet." & vbCrLf & vbCrLf & _
                             "To keep the remainder of the worksheet " & vbCrLf & _
                             "entries, select ""Yes"" and enter an " & vbCrLf & _
                             "appropriate date before proceeding. " & vbCrLf & _
                             "Otherwise, select ""No"".", vbYesNo, WPEENAME)
                    If ans = vbYes Then
                        Range("Answer1").Value = oldentry
                        With Range("Conclude1")
                            .Font.Italic = False
                            .IndentLevel = 3
                            .RowHeight = 12.75
                            .Value = "Go to Step 2."
                        End With
                        Range("Answer1").Select
                        GoTo Quit
                    End If
                    If ans = vbNo Then
                        Q2Hide
                        Q3Hide
                        Q3TBHide
                        Q4Hide
                        Range("Answer1").Select
                        GoTo Quit
                    End If
                End If
            Else
                Range("Conclude1").RowHeight = 38.25
                Range("Conclude1").Value = Range("Conclude1").Value & " Enter an " & _
                                         "appropriate date before proceeding."
            End If
        End If
        Range("InstructQ32").Value = ""
        Range("InstructQ32").EntireRow.Hidden = True
        Q4Hide
        Range("Answer1").Select
        GoTo Quit
    End If
    If Range("Answer1").Value <> "" And Range("Answer1").Value > Range("YearEnd").Value Then
        If Range("Question2").EntireRow.Hidden = False Then
            With Range("Conclude1")
                .Font.Italic = False
                .IndentLevel = 3
                .Value = "Go to Step 2."
            End With
            If Q2Yes.Value = False And Q2No.Value = False Then
                Range("Question2").Cells(1, 2).Select
            ElseIf Q2Yes.Value = True Or IsNull(Q2Yes.Value) Or Q2No.Value = True _
             Or IsNull(Q2No.Value) Then
                If oldentry <> "" And oldentry > Range("YearEnd").Value Then
                    Beep
                    ans = MsgBox("Based on the new date the financial statements " & vbCrLf & _
                                 "are available to be issued, reconsider revisions" & vbCrLf & _
                                 "to the steps already completed.", vbOK, WPEENAME)
                End If
                Range("Answer1").Value = Range("Answer1").Value
                Range("Question2").Cells(1, 2).Select
                If IsNull(Q2Yes.Value) Or IsNull(Q2No.Value) Then
                    Range("Question3").Cells(1, 2).Select
                End If
            End If
        End If
        If Range("Question2").EntireRow.Hidden = True Then
            With Range("Conclude1")
                .Font.Italic = False
                .IndentLevel = 3
                .Value = "Go to Step 2."
            End With
            Range("Question2").EntireRow.Hidden = False
            With Q2Yes
                .Visible = True
                .Left = 421.5
                .Top = Range("Question2").Top + 6
                .Value = False
            End With
            With Q2No
                .Visible = True
                .Left = 459.75
                .Top = Range("Question2").Top + 6
                .Value = False
            End With
            Range("Conclude2").Value = ""
            Q3Hide
            Q3TBHide
            Q4Hide
            Range("Question2").Cells(1, 2).Select
        End If
    End If

Quit:
    Conclude3Comment

    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub

Private Sub Q2Yes_Click()

'
    Dim ans As String
    Dim WPEENAME As String
    WPEENAME = "PPC's Workpapers"

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Q4Hide
    Range("Conclude2").Value = "Go to Step 3."
    If Range("Question3").EntireRow.Hidden = False Then
        If Q3Yes.Value = False And Q3No.Value = False Then
'*****Added this in 2019*****
            With Range("InstructQ31")
                .Rows.RowHeight = 12.75
                .Value = "Answer ""Yes"" or ""No"" to the Step 3 question before " & _
                         "proceeding."
            End With
'*********************
            Q3TBHide
            Range("Question3").Cells(1, 2).Select
            GoTo QuitQ2Yes
        End If
        If Q3Yes.Value = True Or Q3No.Value = True Then
            With Range("Conclude3")
'*****2019 update begin*****
'                .Rows.RowHeight = 38.25
'                .Value = "Update the prior period's description of the " & _
'                         "conditions/events and management's evaluation of the " & _
'                         "significance of those conditions/events in relation " & _
'                         "to the entity's ability to meet its obligations when " & _
'                         "they become due:"
                .Rows.RowHeight = 25.5
                .Value = "Update the conditions/events that raised doubt in the prior " & _
                         "year providing appropriate context and continuity in " & _
                         "describing how conditions or events have changed in the " & _
                         "current year."
'*****2019 update end*******
            End With
            With Range("TB3bBegin").Offset(-1, 0)
                If Q3Yes.Value = True Then
                    .Rows.RowHeight = 25.5
                    .Value = "Update the prior period's description of management's " & _
                             "plans for addressing the adverse conditions/events."
                ElseIf Q3No.Value = True Then
                    .Rows.RowHeight = 12.75
                    .Value = "Describe how the relevant conditions/events that raised " & _
                             "substantial doubt were resolved."
                End If
            End With
            If TB3a.Value = "" And TB3b.Value = "" Then
                Q3Yes.Value = False
                Q3No.Value = False
 '*****Added this*****
                With Range("InstructQ31")
                    .Font.Italic = True
                    .Rows.RowHeight = 12.75
                    .IndentLevel = 2
                    .Value = "Answer ""Yes"" or ""No"" to the Step 3 question before " & _
                             "proceeding."
                End With
'*********************
               Q3TBHide
                Range("Question3").Cells(1, 2).Select
                GoTo QuitQ2Yes
            ElseIf TB3a.Value <> "" And TB3b.Value <> "" Then
                Q3Yes.Value = False
                Q3No.Value = False
'*****Added this*****
                With Range("InstructQ31")
                    .Font.Italic = True
                    .Rows.RowHeight = 12.75
                    .IndentLevel = 2
                    .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                             "before proceeding."
                End With
                Range("InstructQ32").Value = ""
'*********************
                Beep
                ans = MsgBox("This selection may require revisions to " & vbCrLf & _
                         "the textboxes below." & vbCrLf & vbCrLf & _
                         "To keep/revise the textboxes, select ""Yes""." & vbCrLf & _
                         "To clear the textboxes, select ""No"".", vbYesNo, WPEENAME)
                If ans = vbYes Then
'*****Why only in WPN and not WPC?*****Changed from Instruct 32 to Instruct 31*****
'*****Is it necessary with the above addition?*****
                    With Range("InstructQ31")
                        .Font.Italic = True
                        .Rows.RowHeight = 12.75
                        .IndentLevel = 2
                        .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                                 "before proceeding."
                    End With
'**************************************
                    Range("Question3").Cells(1, 2).Select
                    GoTo QuitQ2Yes
                End If
                If ans = vbNo Then
                    Q3TBHide
                    Range("Question3").Cells(1, 2).Select
                    GoTo QuitQ2Yes
                End If
            ElseIf TB3a.Value <> "" Or TB3b.Value <> "" Then
                Q3Yes.Value = False
                Q3No.Value = False
'*****Added this*****
                With Range("InstructQ31")
                    .Font.Italic = True
                    .Rows.RowHeight = 12.75
                    .IndentLevel = 2
                    .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                             "before proceeding."
                End With
                Range("InstructQ32").Value = ""
'*********************
                Beep
                ans = MsgBox("This selection may require revisions to " & vbCrLf & _
                         "a textbox below." & vbCrLf & vbCrLf & _
                         "To keep/revise the textbox, select ""Yes""." & vbCrLf & _
                         "To clear the textbox, select ""No"".", vbYesNo, WPEENAME)
                If ans = vbYes Then
'*****Why only in WPN and not WPC?*****Changed from Instruct 32 to Instruct 31*****
'*****Is it necessary with the above addition?*****
                    With Range("InstructQ31")
                        .Font.Italic = True
                        .Rows.RowHeight = 12.75
                        .IndentLevel = 2
                        .Value = "Answer ""Yes"" or ""No"" to the Step 3 question " & _
                                 "before proceeding."
                    End With
'**************************************
                    Range("Question3").Cells(1, 2).Select
                    GoTo QuitQ2Yes
               End If
                If ans = vbNo Then
                    Q3TBHide
                    Range("Question3").Cells(1, 2).Select
                    GoTo QuitQ2Yes
                End If
            End If
        End If
    End If
    Range("Question3").EntireRow.Hidden = False
    With Q3Yes
        .Visible = True
        .Left = 421.5
        .Top = Range("Question3").Top + 12.75
        .Value = False
    End With
    With Q3No
        .Visible = True
        .Left = 459.75
        .Top = Range("Question3").Top + 12.75
        .Value = False
    End With
    
    Conclude3Comment
    Range("Question3").Cells(1, 2).Select
    
QuitQ2Yes:
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub

Private Sub Q2No_Click()
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("Conclude2").Value = "Go to Step 3."
    Range("Conclude2").EntireRow.Hidden = False
    Range("Question3").EntireRow.Hidden = False
    Range("Conclude3").Value = ""
    With Q3Yes
        .Visible = True
        .Left = 421.5
        .Top = Range("Question3").Top + 12.75
        .Value = False
    End With
    With Q3No
        .Visible = True
        .Left = 459.75
        .Top = Range("Question3").Top + 12.75
        .Value = False
    End With
'*****Added this*****
        With Range("InstructQ31")
            .Rows.RowHeight = 12.75
            .Value = "Answer ""Yes"" or ""No"" to the Step 3 question before " & _
                     "proceeding."
        End With
'********************
    Q3TBHide
    Q4Hide
    Range("Question3").Cells(1, 2).Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub

Private Sub Q3Yes_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("Conclude3").Offset(-1, 0).Rows.Hidden = False
    Range("Question3TB").Rows.Hidden = False
    Range("Conclude3").Select
    Selection.UnMerge
    Range("Conclude3").Select
    Selection.Merge
    With Selection
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .MergeCells = True
        .IndentLevel = 2
        .Font.ColorIndex = xlAutomatic
        .Rows.RowHeight = 25.5
        .Value = "Describe the conditions/events and management's evaluation " & _
                 "of the significance of those conditions/events in relation " & _
                 "to the Organization's ability to meet its obligations when due."
    End With
    With Range("TB3bBegin").Offset(-1, 0)
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .Rows.RowHeight = 12.75
        .Value = "Describe management|fffd|s plans for addressing the adverse " & _
                 "conditions/events."
    End With
    With TB3a
        .Visible = True
        .Left = 33.75
        .Top = Range("TB3aBegin").Top
        .Width = 454.5
    End With
    With TB3b
        .Visible = True
        .Left = 33.75
        .Top = Range("TB3bBegin").Top
        .Width = 454.5
    End With
    If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Then
'*****2019 update begin*****
'        If TB3a.Value <> "" Then
'            With Range("Conclude3")
'                .Rows.RowHeight = 38.25
'                .Value = "Update the prior period's description of the " & _
'                         "conditions/events and management's evaluation of the " & _
'                         "significance of those conditions/events in relation " & _
'                         "to the entity's ability to meet its obligations when " & _
'                         "they become due."
'            End With
'        End If
'        If TB3b.Value <> "" Then
'            With Range("TB3bBegin").Offset(-1, 0)
'                .VerticalAlignment = xlTop
'                .WrapText = True
'                .Orientation = 0
'                .Rows.RowHeight = 25.5
'                .Value = "Update the prior period's description of management's " & _
'                         "plans for addressing the adverse conditions/events."
'            End With
        
'        If TB3a.Value <> "" Then
        With Range("Conclude3")
            .Rows.RowHeight = 38.25
            .Value = "Update the prior period's description of the " & _
                     "conditions/events and management's evaluation of the " & _
                     "significance of those conditions/events in relation " & _
                     "to the Organization's ability to meet its obligations when " & _
                     "they become due."
        End With
'        End If
'        If TB3b.Value <> "" Then
        With Range("TB3bBegin").Offset(-1, 0)
            .VerticalAlignment = xlTop
            .WrapText = True
            .Orientation = 0
            .Rows.RowHeight = 25.5
            .Value = "Update the prior period's description of management's " & _
                     "plans for addressing the adverse conditions/events."
        End With
'        End If
'*****2019 update end*******
'*****Changed from Instruct32 to Instruct31*****
        With Range("InstructQ31")
            .Font.Italic = True
            .Rows.RowHeight = 25.5
            .IndentLevel = 2
            If TB3a.Value = "" Or TB3b.Value = "" Then
                .Value = "Both textboxes will become part of the disclosure on " & _
                         "the Disclosure worksheet. Complete both textboxes " & _
                         "before proceeding to the next Step."
            ElseIf TB3a.Value <> "" And TB3b.Value <> "" Then
                .Value = "Both textboxes will become part of the disclosure on " & _
                         "the Disclosure worksheet. Update both textboxes " & _
                         "before proceeding to the next Step."
            End If
        End With
        Q4Hide
        Conclude4Hide
        TB3a_GotFocus
        GoTo QuitQ3Yes
    End If
    
    If TB3a.Value = "" Or TB3b.Value = "" Then
'*****Changed from Instruct32 to Instruct31*****
        With Range("InstructQ31")
            .Font.Italic = True
            .Rows.RowHeight = 25.5
            .IndentLevel = 2
            .Value = "Both textboxes will become part of the disclosure on the " & _
                     "Disclosure worksheet. Complete both textboxes before " & _
                     "proceeding to the next Step."
        End With
        Q4Hide
        Conclude4Hide
        If TB3a.Value = "" Then
            TB3a_GotFocus
        Else
            TB3b_GotFocus
        End If
    Else
        With Range("InstructQ32")
            .Font.Italic = False
            .IndentLevel = 3
            .Rows.RowHeight = 12.75
            .Value = "Go to Step 4a."
        End With
        Application.ActiveWindow.ScrollRow = Range("TB3aBegin").Offset(-1, 0).Row
        If Q4aYes.Value = False And Q4aNo.Value = False Then
            Range("Question4a").EntireRow.Hidden = False
            With Q4aYes
                .Visible = True
                .Left = 421.5
                .Top = Range("Question4a").Top + 38.25
                .Value = False
            End With
            With Q4aNo
                .Visible = True
                .Left = 459.75
                .Top = Range("Question4a").Top + 38.25
            End With
            Range("Question4a").Cells(3, 2).Select
            Sheet2.Visible = xlSheetVeryHidden
        ElseIf Q4bYes.Value = False And Q4bNo.Value = False Then
            Range("Question4b").EntireRow.Hidden = False
            With Q4bYes
                .Visible = True
                .Left = 421.5
                .Top = Range("Question4b").Top + 12
                .Value = False
            End With
            With Q4bNo
                .Visible = True
                .Left = 459.75
                .Top = Range("Question4b").Top + 12
                .Value = False
            End With
            Range("Question4b").Cells(1, 2).Select
            Sheet2.Visible = xlSheetVeryHidden
        Else
            Range("Conclude4").Select
            If Sheet2.Visible = xlSheetVeryHidden Then
                Sheet2.Visible = xlSheetVisible
            End If
        End If
    End If

QuitQ3Yes:

    Conclude3Comment

    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q3No_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Q4Hide
    Conclude4Hide
    
    If Q2Yes.Value = True Or IsNull(Q2Yes.Value) Then
        If Range(Range("Conclude3"), Range("Conclude3").Offset(2, 0)) _
        .EntireRow.Hidden = True Then
            Range(Range("Conclude3"), Range("Conclude3").Offset(2, 0)) _
            .EntireRow.Hidden = False
            With TB3a
                .Top = Range("TB3aBegin").Top
                .Visible = True
            End With
            If TB3a.Value <> "" Then
                TB3a.Value = ""
            End If
        End If
        If Range(Range("TB3bBegin").Offset(-1, 0), Range("TB3bBegin").Offset(2, 0)) _
        .EntireRow.Hidden = True Then
            Range(Range("TB3bBegin").Offset(-1, 0), Range("TB3bBegin").Offset(2, 0)) _
            .EntireRow.Hidden = False
            With TB3b
                .Top = Range("TB3bBegin").Top
                .Visible = True
            End With
            If TB3b.Value <> "" Then
                TB3b.Value = ""
            End If
        End If
        With Range("Conclude3")
            .VerticalAlignment = xlTop
            .WrapText = True
            .Orientation = 0
            .Font.ColorIndex = xlAutomatic
            If TB3a.Value = "" Then
                .IndentLevel = 2
                .Rows.RowHeight = 25.5
'*****2019 update*****
'                .Value = "Describe the conditions/events and management's evaluation " & _
'                         "of the significance of those conditions/events in relation " & _
'                         "to the entity's ability to meet its obligations when due:"
                .Value = "Update the conditions/events that raised doubt in the prior " & _
                         "year providing appropriate context and continuity in " & _
                         "describing how conditions or events have changed in the " & _
                         "current year."
            Else
'                .Rows.RowHeight = 38.25
'                .Value = "Update the prior period's description of the " & _
'                         "conditions/events and management's evaluation of the " & _
'                         "significance of those conditions/events in relation " & _
'                         "to the entity's ability to meet its obligations when they " & _
'                         "become due:"
                .Rows.RowHeight = 25.5
                .Value = "Update the conditions/events that raised doubt in the prior " & _
                         "year providing appropriate context and continuity in " & _
                         "describing how conditions or events have changed in the " & _
                         "current year."
 '**********************
           End If
        End With
        With Range("TB3bBegin").Offset(-1, 0)
            .VerticalAlignment = xlTop
            .WrapText = True
            .Orientation = 0
            .Font.ColorIndex = xlAutomatic
            .Rows.RowHeight = 12.75
            .Value = "Describe how the relevant conditions/events that raised " & _
                     "substantial doubt were resolved."
        End With
'*****Changed from Instruct32 to Instruct31*****
        With Range("InstructQ31")
            .Font.Italic = True
            .Rows.RowHeight = 25.5
            .IndentLevel = 2
            If TB3a.Value = "" Or TB3b.Value = "" Then
                .Value = "Both textboxes will become part of the disclosure on " & _
                         "the Disclosure worksheet. Complete both textboxes " & _
                         "before proceeding."
            ElseIf TB3a.Value <> "" And TB3b.Value <> "" Then
                .Value = "Both textboxes will become part of the disclosure on " & _
                         "the Disclosure worksheet. Update both textboxes " & _
                         "before proceeding."
            End If
        End With
'*****Added this*****
        With Range("InstructQ32")
            .Font.Italic = False
            .IndentLevel = 3
            .Rows.RowHeight = 12.75
            .Value = ""
        End With
'********************
        Conclude3Comment
        TB3a_GotFocus
        Exit Sub
    End If
'****************If Q2No.Value = True or Null
    Q3TBHide
'*****Clear Instruct31*****
    Range("InstructQ31").Value = ""
'**************************
    With Range("Conclude3")
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .MergeCells = True
        .IndentLevel = 3
        .EntireRow.Hidden = False
        .Font.ColorIndex = 3 'Red
        .Rows.RowHeight = 25.5
        .Value = "No other questions are necessary. No disclosures are " & _
                 "necessary specific to going concern."
    End With
    Range("Conclude3").Select
    Sheet2.Visible = xlSheetVeryHidden

    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q4aYes_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("Question4b").EntireRow.Hidden = False
    With Q4bYes
        .Visible = True
        .Left = 421.5
        .Top = Range("Question4b").Top + 12
        .Value = False
    End With
    With Q4bNo
        .Visible = True
        .Left = 459.75
        .Top = Range("Question4b").Top + 12
        .Value = False
    End With
    Sheet2.Visible = xlSheetVeryHidden
    Conclude4Hide
    Range("Question4b").Cells(1, 2).Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q4aNo_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Q4bHide
   
    Range("Conclude4").RowHeight = 30
    Range("Conclude4").EntireRow.Hidden = False
    Range("Conclude4").Value = "Substantial doubt about the " & _
        "Organization|fffd|s ability to continue as a going concern is " & _
        "NOT alleviated. Go to the Disclosure worksheet."
    Sheet2.Visible = xlSheetVisible
    Range("Conclude4").Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q4bYes_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("Conclude4").RowHeight = 42.5
    Range("Conclude4").Value = "Substantial doubt about the " & _
        "Organization|fffd|s ability to continue as a going concern " & _
        "is alleviated, but disclosure is necessary. Go " & _
        "to the Disclosure worksheet."
    Sheet2.Visible = xlSheetVisible
    Range("Conclude4").Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q4bNo_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("Conclude4").RowHeight = 30
    Range("Conclude4").Value = "Substantial doubt about the " & _
        "Organization|fffd|s ability to continue as a going concern is " & _
        "NOT alleviated. Go to the Disclosure worksheet."
    If Sheet2.Visible <> xlSheetVisible Then
        Sheet2.Visible = xlSheetVisible
    End If
    Range("Conclude4").Select
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub

Private Sub Q1Hide()
    
    Range("Question1").EntireRow.Hidden = True
    Range("Answer1").Value = ""

End Sub
    
Private Sub Q2Hide()
    
    Q2Yes.Visible = False
    Q2Yes.Value = False
    Q2No.Visible = False
    Q2No.Value = False
    Range("Question2").EntireRow.Hidden = True
    
End Sub
    
Private Sub Q3Hide()
    
    Range("Question3").EntireRow.Hidden = True
    Q3Yes.Visible = False
    Q3Yes.Value = False
    Q3No.Visible = False
    Q3No.Value = False

End Sub
    
Private Sub Q3TBHide()
    
    If TB3a.Value <> "" Then
        TB3a_GotFocus
        TB3a.Value = ""
        TB3a_LostFocus
    End If
    TB3a.Visible = False
    If TB3b.Value <> "" Then
        TB3b_GotFocus
        TB3b.Value = ""
        TB3b_LostFocus
    End If
    TB3b.Visible = False
    Conclude3Comment
    Range("Question3TB").EntireRow.Hidden = True

End Sub
    
Private Sub Q4Hide()
    
    Range("Question4").EntireRow.Hidden = True
    Q4aYes.Visible = False
    Q4aYes.Value = False
    Q4aNo.Visible = False
    Q4aNo.Value = False
    Q4bYes.Visible = False
    Q4bYes.Value = False
    Q4bNo.Visible = False
    Q4bNo.Value = False
    Conclude4Hide

End Sub
    
Private Sub Q4aHide()
    
    Range("Question4a").EntireRow.Hidden = True
    Q4aYes.Visible = False
    Q4aYes.Value = False
    Q4aNo.Visible = False
    Q4aNo.Value = False
    
    Q4bHide

End Sub
       
Private Sub Q4bHide()
    
    Range("Question4b").EntireRow.Hidden = True
    Q4bYes.Visible = False
    Q4bYes.Value = False
    Q4bNo.Visible = False
    Q4bNo.Value = False
    
    Conclude4Hide
    
End Sub

Private Sub Conclude4Hide()

    Range("Conclude4").Value = ""
    Range("Conclude4").RowHeight = 12.75

End Sub

Private Sub Worksheet_Deactivate()

End Sub


Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
    
    
    Dim DDNoInputs As String
    Dim DD1 As String
    Dim DD2Pt1Yes As String
    Dim DD2Pt1No As String
    Dim DD2Pt2 As String
    Dim DD3 As String

    DDNoInputs = "All of the necessary questions have not been " & _
                  "answered completely. Please return to the Input " & _
                  "worksheet for completion."
''*****2019 change begin*****
''    DD1 = "The financial statements have been prepared on the " & _
''          "going concern basis, which assumes that the Organization will " & _
''          "continue in operation. However, management has identified " & _
''          "the following conditions and events that created an " & _
''          "uncertainty about the ability of the Organization to continue " & _
''          "as a going concern. "
    
    DD1 = "The financial statements have been prepared on the " & _
          "going concern basis, which assumes that the Organization will " & _
          "continue in operation. However, "
'''''If a prior year going concern
          If Sheet1.Q2Yes = True Or IsNull(Sheet1.Q2Yes.Value) Then
              DD1 = DD1 + "in the prior year, management identified the " & _
                    "following conditions and events that created an "
''''''If also a current year going concern
'              If Sheet1.Q3Yes = True Then
'                    DD1 = DD1 + "a remaining "
''''''If not current year going concern
'              ElseIf Sheet1.Q3No = True Then
'                    DD1 = DD1 + "an "
'              End If
'''''If no prior year going concern
          Else
              DD1 = DD1 + "management has identified the following " & _
                    "conditions and events that created an "
          End If
'''''All instances
          DD1 = DD1 + "uncertainty about the ability of the " & _
                "Organization to continue as a going concern. "
    
''    DD2Pt1YesGCPYOnly = "The following describes management's plans that " & _
''                        "alleviated substantial doubt about the Organization's " & _
''                        "ability to continue as a going concern through " & _
''                        Format(DateAdd("yyyy", 1, Sheet1.Range("Answer1").Value), _
''                        "mmmm d, yyyy") & " (one year after the date that the " & _
''                        "financial statements are available to be issued). "
''
    DD2Pt1YesGCPYOnly = "The following describes how the conditions and events " & _
                        "that raised substantial doubt about the Organization's " & _
                        "ability to continue as a going concern in the prior " & _
                        "year were resolved."
''*****2019 change end*****

    DD2Pt1YesGCCY = "The following describes management's plans to " & _
                    "alleviate substantial doubt about the Organization's " & _
                    "ability to continue as a going concern through " & _
                    Format(DateAdd("yyyy", 1, Sheet1.Range("Answer1").Value), _
                    "mmmm d, yyyy") & " (one year after the date that the " & _
                    "financial statements are available to be issued). "

    DD2Pt1No = "The following describes management's plans that are " & _
               "intended to mitigate the conditions and events that raise " & _
               "substantial doubt about the Organization's ability to " & _
               "continue as a going concern. "
    
    DD2Pt2 = " The Organization's ability to meet its obligations as they " & _
             "become due is dependent upon the success of management's " & _
             "plans, as described above."
             
    DD3 = "These conditions and events create substantial doubt about " & _
          "the ability of the Organization to continue as a going concern " & _
          "through " & Format(DateAdd("yyyy", 1, Sheet1.Range("Answer1").Value), "mmmm d, yyyy") & _
          " (one year after the date that the financial statements are " & _
          "available to be issued). The financial statements do not include " & _
          "any adjustments that might be necessary should the Organization be " & _
          "unable to continue as a going concern."
    
    Application.ScreenUpdating = False

    Range("DiscRange").Font.ColorIndex = xlAutomatic
    Range("DiscDetailCaption").Value = "NOTE X|fffd|GOING CONCERN MATTERS"
    Range("DiscDetail2").Value = ""
    Range("DiscDetail3").Value = ""
    
'   The first "If" Statement covers the disclosure variables for the _
    period through which subsequent events were analyzed.

'1st disclosure paragraph
''   Question 1 not answered
    If Sheet1.Range("Answer1") = "" Then
        Range("DiscDetailCaption").Value = ""
        With Range("DiscDetail1")
            .Font.Color = 255
            .Value = DDNoInputs
        End With
    End If
''Question 1 answered
    If Sheet1.Range("Answer1") <> "" Then
'''If Question 3 for current year going concern not answered
        If Sheet1.Q3Yes = False And Sheet1.Q3No = False Then
            Range("DiscDetailCaption").Value = ""
            With Range("DiscDetail1")
                .Font.Color = 255
                .Value = DDNoInputs
            End With
'''If current year going concern
        ElseIf Sheet1.Q3Yes = True Then
''''If textbox(es) not completed
            If Sheet1.TB3a.Value = "" Or Sheet1.TB3b.Value = "" Then
                Range("DiscDetailCaption").Value = ""
                With Range("DiscDetail1")
                    .Font.Color = 255
                    .Value = DDNoInputs
                End With
''''If both textboxes completed
            ElseIf Sheet1.TB3a.Value <> "" And Sheet1.TB3b.Value <> "" Then
                Range("DiscDetail1").Value = DD1 + Sheet1.TB3a.Value
            End If
'''If no current year going cconcern
        ElseIf Sheet1.Q3No = True Then
''''If prior year going concern
            If Sheet1.Q2Yes = True Or IsNull(Sheet1.Q2Yes.Value) Then
'''''If textbox(es) not completed
                If Sheet1.TB3a.Value = "" Or Sheet1.TB3b.Value = "" Then
                    Range("DiscDetailCaption").Value = ""
                    With Range("DiscDetail1")
                        .Font.Color = 255
                        .Value = DDNoInputs
                    End With
'''''If both textboxes completed
                ElseIf Sheet1.TB3a.Value <> "" And Sheet1.TB3b.Value <> "" Then
                    Range("DiscDetail1").Value = DD1 & Sheet1.TB3a.Value
                End If
''''If no prior year going concern
            ElseIf Sheet1.Q2No = True Or IsNull(Q2No.Value) Then
                With Range("DiscDetail1")
                    .Font.Color = 255
                    .Value = "Disclosure is not necessary. Please return " & _
                             "to the Input worksheet."
                End With
            End If
        End If
'2nd disclosure paragraph
''If prior year and/or current year going concern
        If Range("DiscDetail1").Value = DD1 & Sheet1.TB3a.Value Then
'''If prior year going concern
            If Sheet1.Q2Yes = True Or IsNull(Sheet1.Q2Yes.Value) Then
''''If no current year going cconcern
                If Sheet1.Q3No = True Then
                    Range("DiscDetail2").Value = DD2Pt1YesGCPYOnly & _
                                                 Sheet1.TB3b.Value
                End If
            End If
'''If current year going concern
            If Sheet1.Range("Question4").EntireRow.Hidden = False Then
''''If question 4a not answered...warn usere to make additional inputs
                If Sheet1.Q4aYes = False And Sheet1.Q4aNo = False Then
                    With Range("DiscDetail2")
                        .Font.Color = 255
                        .Value = DDNoInputs
                    End With
''''If management's plans will not be effectively implemented
                ElseIf Sheet1.Q4aYes = False And Sheet1.Q4aNo = True Then
                    Range("DiscDetail2").Value = DD2Pt1No & Sheet1.TB3b.Value & _
                                                 "" & DD2Pt2
                    Range("DiscDetail3").Value = DD3
''''If management's plans will be effectively implemented
                ElseIf Sheet1.Q4aYes = True And Sheet1.Q4aNo = False Then
'''''If question 4b not answered...warn usere to make additional inputs
                    If Sheet1.Q4bYes = False And Sheet1.Q4bNo = False Then
                        With Range("DiscDetail2")
                            .Font.Color = 255
                            .Value = DDNoInputs
                        End With
'''''If management's plans will be effectively implemented but should not be sucessful
                    ElseIf Sheet1.Q4bYes = False And Sheet1.Q4bNo = True Then
                        Range("DiscDetail2").Value = DD2Pt1No & Sheet1.TB3b.Value & _
                                                     "" & DD2Pt2
                        Range("DiscDetail3").Value = DD3
'''''If management's plans will be effectively implemented and should be sucessful
                    ElseIf Sheet1.Q4bYes = True And Sheet1.Q4bNo = False Then
                        Range("DiscDetail2").Value = DD2Pt1YesGCCY & Sheet1.TB3b.Value & _
                                                     "" & DD2Pt2
                    End If
                End If
            End If
        End If
    End If

''   The second "If" Statement covers the disclosure variables if the user _
     has or has not answered question 5 concerning whether a subsequnt _
     event is to be disclosed.
    
    If Range("DiscDetail1").Font.Color = 255 Then
        Range("DiscDetail2").Value = ""
        Range("DiscDetail3").Value = ""
    End If
    If Range("DiscDetail2").Font.Color = 255 Then
        Range("DiscDetail3").Value = ""
    End If
''   See the description of the MergeUnmerge routine below.
Merge:
    Call MergeUnmerge
    Range("a1").Select

    Application.ScreenUpdating = True

    End Sub
Private Sub MergeUnmerge()

'   To enable the rows on the disclosure worksheet to automatically _
    adjust height depending on the amount of text to be held, the _
    cells in each of the 3 disclosure rows need to be unmerged before _
    the "AutoFit" is performed. After the AutoFit, the cells of each _
    of the 3 rows are remerged.

    Range("DiscDetail1").Select
    Selection.UnMerge
    Range("DiscDetail1").Select
    Selection.ColumnWidth = 76
    Selection.Rows.AutoFit
    Selection.ColumnWidth = 34.43
    Range(Range("DiscDetail1"), Range("DiscDetail1").Offset(0, 2)).Select
    Selection.Merge
    With Selection
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .MergeCells = True
    End With
    Range("DiscDetail2").Select
    Selection.UnMerge
    Range("DiscDetail2").Select
    Selection.ColumnWidth = 76
    Selection.Rows.AutoFit
    Selection.ColumnWidth = 34.43
    Range(Range("DiscDetail2"), Range("DiscDetail2").Offset(0, 2)).Select
    Selection.Merge
    With Selection
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .MergeCells = True
    End With
    Range("DiscDetail3").Select
    Selection.UnMerge
    Range("DiscDetail3").Select
    Selection.ColumnWidth = 76
    Selection.Rows.AutoFit
    Selection.ColumnWidth = 34.43
    Range(Range("DiscDetail3"), Range("DiscDetail3").Offset(0, 2)).Select
    Selection.Merge
    With Selection
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .MergeCells = True
    End With
    Range("a1").Select

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'
' This code is protected and passworded when complete.
'

Private Const XL4MACRO As String = "PPCSecurityMacro"
Private Const INFORMATION As String = "INFORMATION"

Private Const bIsIDxR As Boolean = False        ' Set True if Interactive Disclosure Library
#Const IDxR = 0                                 ' Set 1 if Interactive Disclosure Library

      ' Declare security class

Private Sub Workbook_Activate()

  
  InitForEditorial
  
  On Error GoTo 0
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
  Workbook_BeforeClose_Editorial
End Sub



Public Function bIsSaving() As Boolean
  bIsSaving = False
End Function



INQUEST-PP=macro
