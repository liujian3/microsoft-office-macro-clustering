Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Name = "basCommonFunc"
Sub Change_LineSpacing(pLineSpacingRule, pLineSpacing As Integer)
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    
    If Not Selection.Find.Found Then Exit Sub
    
    ''''|fffd||fffd||fffd||fffd||124|@|fffd|j|fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    ''''|fffd||fffd||fffd||fffd|
    Selection.EndKey Unit:=wdStory, Extend:=wdExtend
    
    ''''|fffd|]|fffd||324|p|fffd||6c2a||fffd||fffd| 0
    With Selection.ParagraphFormat
        .LineSpacingRule = pLineSpacingRule
        If pLineSpacing > 0 Then
            .LineSpacing = pLineSpacing
        End If
    End With
    Selection.HomeKey Unit:=wdStory
    
    ActiveDocument.UndoClear

End Sub

Public Function Proc_Return_New_Func_Code(ByVal sOri_Code As String, ByVal iAdd As Integer) As String

Dim wTmp_Code As String
Dim wTmp_Num As String
Dim wQues_Cnt As String
    
    wTmp_Code = sOri_Code
    wQues_Cnt = ""
    Proc_Return_New_Func_Code = ""
    
    If InStr(1, wTmp_Code, "eq \o(\s\do 0(") > 0 Then
        wTmp_Code = Replace(wTmp_Code, "eq \o(\s\do 0(", "")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
    ElseIf InStr(1, wTmp_Code, "eq \o(\s\do 3(") > 0 Then
        wTmp_Code = Replace(wTmp_Code, "eq \o(\s\do 3(", "")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
        wTmp_Num = TrimByCh(wTmp_Code, "(")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
    ElseIf InStr(1, wTmp_Code, "eq \o(\s\do 5(") > 0 Then
        wTmp_Code = Replace(wTmp_Code, "eq \o(\s\do 5(", "")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
        wTmp_Num = TrimByCh(wTmp_Code, "(")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
        wTmp_Num = TrimByCh(wTmp_Code, "(")
        wTmp_Num = TrimByCh(wTmp_Code, ")")
        wQues_Cnt = wQues_Cnt & wTmp_Num
    End If
    
    wQues_Cnt = Proc_Full_To_Half_Code(wQues_Cnt)
    wQues_Cnt = Format(Val(wQues_Cnt) + iAdd, "#")
    wQues_Cnt = Convert_Chi(wQues_Cnt, "1")
    
    Select Case Len(Trim(wQues_Cnt))
        Case 1
            wStr1 = Convert_Chi(Trim(Str(wQues_Cnt)), "1")
            Proc_Return_New_Func_Code = "eq \o(\s\do 0(" + wStr1 + "))"
        Case 2
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Proc_Return_New_Func_Code = "eq \o(\s\do 3(" + wStr1 + "),\s\do -3(" + wStr2 + "))"
        Case 3
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Mid(Trim(Str(wQues_Cnt)), 2, 1), "1")
            wStr3 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Proc_Return_New_Func_Code = "eq \o(\s\do 5(" + wStr1 + "),\s\do 0(" + wStr2 + "),\s\do -5(" + wStr3 + "))"
        Case Else
            Proc_Return_New_Func_Code = ""
    End Select
    
End Function

Function TrimByCh(OriStr As String, Optional TrimChr, Optional flgCondition) As String 'Ver3.1 Dec 5/1999'
   Dim MyPosi As Integer, flgPoint As Boolean, tmpChr As String, tmpInt As Integer
   Dim flgKeep As Boolean, flgL2R As Boolean, flgSpec As Boolean '-1:UCase-only; -2:LCase-only; -4:Numeric; -8:+-*/.^; -16:()[]{}
   Dim errMsg As String

   On Error Resume Next
   If IsMissing(TrimChr) Then TrimChr = Space(1)
   If IsMissing(flgCondition) Then flgCondition = vbNormal
   If TrimChr = "" Then errMsg = "|fffd||466||4a6|r|fffd||a923||fffd|i|fffd|H|fffd||165||561|I": GoTo Err_Lab
   GoSub Get_Condition

   If flgL2R Then
      For MyPosi = 1 To Len(OriStr) + IIf(flgSpec, 0, 1 - Len(TrimChr))
         tmpChr = Mid(OriStr, MyPosi, IIf(flgSpec, 1, Len(TrimChr))): GoSub Get_chkPoint
         If flgPoint Then GoTo L2RPosiLab
      Next
      GoTo MissTrimLab
L2RPosiLab:
      TrimByCh = Left$(OriStr, MyPosi - 1) 'Trim$(Left$(OriStr, MyPosi - 1))
      If Not flgKeep Then OriStr = Mid$(OriStr, MyPosi + IIf(flgSpec, 1, Len(TrimChr))) 'Trim$(Mid$(OriStr, MyPosi + IIf(flgSpec, 1, Len(TrimChr))))
   Else
      For MyPosi = Len(OriStr) + IIf(flgSpec, 0, 1 - Len(TrimChr)) To 1 Step -1
         tmpChr = Mid(OriStr, MyPosi, IIf(flgSpec, 1, Len(TrimChr))): GoSub Get_chkPoint
         If flgPoint Then GoTo R2LPosiLab
      Next
      GoTo MissTrimLab
R2LPosiLab:
      TrimByCh = Mid$(OriStr, MyPosi + IIf(flgSpec, 1, Len(TrimChr))) 'Trim$(Mid$(OriStr, MyPosi + IIf(flgSpec, 1, Len(TrimChr))))
      If Not flgKeep Then OriStr = Left$(OriStr, MyPosi - 1) 'Trim$(Left$(OriStr, MyPosi - 1))
   End If
   flgCondition = vbNormal
Exit Function
MissTrimLab:
   flgCondition = fcKeep
   TrimByCh = OriStr
   If Not flgKeep Then OriStr = ""
Exit Function
Get_chkPoint:
   If flgSpec Then
      tmpInt = -Val(TrimChr)
      If tmpInt > 0 Then
         flgPoint = True
         If (tmpInt Mod 2 = 1) Then flgPoint = flgPoint And (tmpChr Like "[!A-Z]"): tmpInt = Int(tmpInt / 2)
         If (tmpInt Mod 2 = 1) Then flgPoint = flgPoint And (tmpChr Like "[!a-z]"): tmpInt = Int(tmpInt / 2)
         If (tmpInt Mod 2 = 1) Then flgPoint = flgPoint And (tmpChr Like "!#"): tmpInt = Int(tmpInt / 2)
         If (tmpInt Mod 2 = 1) Then flgPoint = flgPoint And (tmpChr <> "+" And tmpChr <> "-" And tmpChr <> "*" _
            And tmpChr <> "/" And tmpChr <> "."): tmpInt = Int(tmpInt / 2)
         If (tmpInt Mod 2 = 1) Then flgPoint = flgPoint And (tmpChr <> "(" And tmpChr <> ")" And tmpChr <> "[" _
            And tmpChr <> "]" And tmpChr <> "{" And tmpChr <> "}"): tmpInt = Int(tmpInt / 2)
      Else
         flgPoint = False
         For tmpInt = 1 To Len(TrimChr)
            If tmpChr = Mid(TrimChr, tmpInt, 1) Then flgPoint = True: Exit For
         Next tmpInt
      End If
   Else
      flgPoint = (tmpChr = TrimChr)
   End If
Return
Get_Condition:
   tmpInt = Abs(flgCondition)
   flgKeep = (tmpInt Mod 2 = 1): tmpInt = Int(tmpInt / 2)
   flgSpec = (tmpInt Mod 2 = 1): tmpInt = Int(tmpInt / 2)
   flgL2R = Not (tmpInt Mod 2 = 1)
Return
Err_Lab:
   MsgBox errMsg, vbCritical
End Function


Public Function Proc_Full_To_Half_Code(sString As String) As String
'|fffd||fffd||fffd||fffd||fffd|r|fffd||fffd|b|fffd||fffd|
    sString = Replace(sString, "|fffd||fffd|", "0")
    sString = Replace(sString, "|fffd||fffd|", "1")
    sString = Replace(sString, "|fffd||fffd|", "2")
    sString = Replace(sString, "|fffd||fffd|", "3")
    sString = Replace(sString, "|fffd||fffd|", "4")
    sString = Replace(sString, "|fffd||fffd|", "5")
    sString = Replace(sString, "|fffd||fffd|", "6")
    sString = Replace(sString, "|fffd||fffd|", "7")
    sString = Replace(sString, "|fffd||fffd|", "8")
    sString = Replace(sString, "|fffd||fffd|", "9")
    
    Proc_Full_To_Half_Code = sString
End Function
Function Get_Button_By_Name(pName As String) As Boolean
    Dim i As Integer
    Dim Get_Yn As Boolean
    
    
    Get_Yn = False
    For i = 1 To Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls.Count
        If UCase(Trim(Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls(i).Caption)) = UCase(Trim(pName)) Then
            Get_Yn = True
            Exit For
        End If
    Next
    
    Get_Button_By_Name = Get_Yn
    
    
End Function


Private Function Check_Ques_Paper_Only() As Boolean
    
    
    Check_Ques_Paper_Only = False
    
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    Do While 1 = 1
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            Selection.MoveRight Unit:=wdCharacter, Count:=1
            
            If Selection.Text = Chr(13) Then Exit Do '|fffd||fffd||fffd||fffd||568||fffd||fffd||32b||1b71||fffd|F
                
            Select Case Selection.Font.ColorIndex
                Case wdAuto, wdBlack
                Case Else
                    Exit Function
            End Select
            
        Else
            Exit Do
        End If
    Loop
    
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    
    Check_Ques_Paper_Only = True
    

End Function

Sub Get_Dis_Ques_Type_20130110(bQues_Type() As String)
    Dim i As Integer, J As Integer
    
    
    
    ReDim bQues_Type(0)
    
    i = 0
    Do While 1 = 1
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        
        i = i + 1 '|fffd|C|fffd|@|fffd|D|fffd||fffd||fffd|h|fffd|d
        wFind = Convert_Chi(Trim(Str(i)), "2") + "|fffd|B"
        
        Selection.Find.ClearFormatting
        Selection.Find.Text = wFind
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            ReDim Preserve bQues_Type(UBound(bQues_Type) + 1)
            bQues_Type(UBound(bQues_Type)) = ""
            Do While 1 = 1
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                If Selection.Font.Bold = True Then
                    bQues_Type(UBound(bQues_Type)) = bQues_Type(UBound(bQues_Type)) + Selection.Text
                    Selection.MoveRight Unit:=wdCharacter, Count:=1
                Else
                    If Right(bQues_Type(UBound(bQues_Type)), 1) = Chr(13) Then
                        bQues_Type(UBound(bQues_Type)) = Mid(bQues_Type(UBound(bQues_Type)), 1, Len(bQues_Type(UBound(bQues_Type))) - 1)
                    End If
                    Exit Do
                End If
            Loop
        Else
            Exit Do
        End If
    Loop
    
    If Trim(bQues_Type(UBound(bQues_Type))) = "" Then
        ReDim Preserve bQues_Type(UBound(bQues_Type) - 1)
    End If
    'For I = 1 To UBound(bQues_Type)
    '    MsgBox bQues_Type(I)
    'Next
    
End Sub
Sub Get_Dis_Ques_Type(bQues_Type() As String)
    Dim i As Integer, J As Integer
    Dim bEnter As Boolean
    Dim bPrint_H As Boolean
    
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
        bPrint_H = True
    Else
        bPrint_H = False
    End If
    
    ReDim bQues_Type(0)
    
    i = 0
    Do While 1 = 1
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        
        i = i + 1 '|fffd|C|fffd|@|fffd|D|fffd||fffd||fffd|h|fffd|d
        wFind = Convert_Chi(Trim(Str(i)), "2") + "|fffd|B"
        
        Selection.Find.ClearFormatting
        Selection.Find.Text = wFind
        Selection.Find.Forward = True
        Selection.Find.Font.Bold = True
        Selection.Find.Execute
        bEnter = False
        
        If Selection.Find.Found Then
            ReDim Preserve bQues_Type(UBound(bQues_Type) + 1)
            bQues_Type(UBound(bQues_Type)) = ""
            Do While 1 = 1
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                If Selection.Text = Chr(13) Then
                    bEnter = True
                End If
                If bPrint_H Then '|fffd||fffd||fffd|
                    If Selection.Font.Bold = True Then
                        bQues_Type(UBound(bQues_Type)) = bQues_Type(UBound(bQues_Type)) + Selection.Text
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Else
                        If Right(bQues_Type(UBound(bQues_Type)), 1) = Chr(13) Then
                            bQues_Type(UBound(bQues_Type)) = Mid(bQues_Type(UBound(bQues_Type)), 1, Len(bQues_Type(UBound(bQues_Type))) - 1)
                        End If
                        Exit Do
                    End If
                Else
                    If Selection.Font.Bold = True And _
                      ((Selection.Font.ColorIndex = wdDarkBlue And Not bEnter) Or _
                       (Selection.Font.ColorIndex <> wdDarkBlue Or Selection.Text = "|fffd|G")) Then
                        bQues_Type(UBound(bQues_Type)) = bQues_Type(UBound(bQues_Type)) + Selection.Text
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Else
                        If Right(bQues_Type(UBound(bQues_Type)), 1) = Chr(13) Then
                            bQues_Type(UBound(bQues_Type)) = Mid(bQues_Type(UBound(bQues_Type)), 1, Len(bQues_Type(UBound(bQues_Type))) - 1)
                        End If
                        Exit Do
                    End If
                End If
            Loop
        Else
            Exit Do
        End If
    Loop
    
    'For I = 1 To UBound(bQues_Type)
    '    MsgBox bQues_Type(I)
    'Next
    
End Sub

Function Convert_Chi(source1 As String, source2 As String) As String
' |fffd||1a6|r|fffd||3ad|^|fffd||fffd|r|fffd||fffd||fffd||d2b| source2 = 1 ---> |fffd||fffd||fffd||fffd||fffd||1a6|r,|fffd|^|fffd||fffd|r|fffd||fffd|
'                              2 ---> |fffd||fffd|r|fffd||1a6|r (|fffd|@|fffd|G|fffd|T....)
'                              3 ---> |fffd||fffd|r|fffd||1a6|r (|fffd||fffd||fffd|L|fffd||fffd|....)
Dim i As Long, J As Long
Dim out_text As String
   out_text = ""
   For i = 1 To Lenx(Trimx(source1))
      If source2 = "1" Then
         If Midx(Trimx(source1), i, 1) = "0" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "1" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "2" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "3" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "4" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "5" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "6" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "7" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "8" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "9" Then
            out_text = out_text + "|fffd||fffd|"
         End If
      End If
      If source2 = "2" Then
'         If Midx(Trimx(source1), i, 1) = "0" Then
'           out_text = out_text + "|fffd||fffd|"
'         End If
         If Midx(Trimx(source1), i, 1) = "1" Then
            out_text = out_text + "|fffd|@"
         End If
         If Midx(Trimx(source1), i, 1) = "2" Then
            out_text = out_text + "|fffd|G"
         End If
         If Midx(Trimx(source1), i, 1) = "3" Then
            out_text = out_text + "|fffd|T"
         End If
         If Midx(Trimx(source1), i, 1) = "4" Then
            out_text = out_text + "|fffd||"
         End If
         If Midx(Trimx(source1), i, 1) = "5" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "6" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "7" Then
            out_text = out_text + "|fffd|C"
         End If
         If Midx(Trimx(source1), i, 1) = "8" Then
            out_text = out_text + "|fffd|K"
         End If
         If Midx(Trimx(source1), i, 1) = "9" Then
            out_text = out_text + "|fffd|E"
         End If
         If (Lenx(Trimx(source1)) = 2 And i = 1) Or (Lenx(Trimx(source1)) = 3 And i = 2) Then
            If Midx(Trimx(source1), i, 1) <> "0" Then
               If Midx(Trimx(source1), i, 1) = "1" Then
                  out_text = "|fffd|Q"
               Else
                  out_text = out_text + "|fffd|Q"
               End If
            End If
         End If
         If Lenx(Trimx(source1)) = 3 And i = 1 Then
            If Midx(Trimx(source1), i, 1) <> "0" Then
               If Midx(Trimx(source1), i, 1) = "1" Then
                  out_text = "|fffd|@|fffd||fffd|"
               Else
                  out_text = out_text + "|fffd||fffd|"
               End If
            End If
         End If
      End If
      If source2 = "3" Then
         If Midx(Trimx(source1), i, 1) = "0" Then
            out_text = out_text + "|fffd|s"
         End If
         If Midx(Trimx(source1), i, 1) = "1" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "2" Then
            out_text = out_text + "|fffd|L"
         End If
         If Midx(Trimx(source1), i, 1) = "3" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "4" Then
            out_text = out_text + "|fffd|v"
         End If
         If Midx(Trimx(source1), i, 1) = "5" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "6" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "7" Then
            out_text = out_text + "|fffd|m"
         End If
         If Midx(Trimx(source1), i, 1) = "8" Then
            out_text = out_text + "|fffd||fffd|"
         End If
         If Midx(Trimx(source1), i, 1) = "9" Then
            out_text = out_text + "|fffd|h"
         End If
      End If
      If Midx(Trimx(source1), i, 1) = "." Then
         out_text = out_text + "|fffd|D"
      End If
      If Midx(Trimx(source1), i, 1) = "," Then
         out_text = out_text + "|fffd|A"
      End If
      If Midx(Trimx(source1), i, 1) = "A" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "B" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "C" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "D" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "E" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "F" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "G" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "H" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "I" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "J" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "K" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "L" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "M" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "N" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "O" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "P" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "Q" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "R" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "S" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "T" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "U" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "V" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "W" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "X" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "Y" Then
         out_text = out_text + "|fffd||fffd|"
      End If
      If Midx(Trimx(source1), i, 1) = "Z" Then
         out_text = out_text + "|fffd||fffd|"
      End If
   Next
   Convert_Chi = out_text
End Function



Function Lenx(s_text As Variant) As Integer

Lenx = LenB(StrConv(s_text, 128))

End Function


Function Midx(s_text As Variant, ByVal start_pos As Long, end_pos As Long) As String
'  |fffd|P Function mid (|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd| 32bits)
Dim wk_len As Integer
Dim u As Integer
Dim wk_out As String
    wk_len = 0
    wk_out = ""
    For u = 1 To Len(s_text)
       If AscW(Mid(s_text, u, 1)) > 128 Or AscW(Mid(s_text, u, 1)) < -128 Then
          wk_len = wk_len + 2
       Else
          wk_len = wk_len + 1
       End If
       If wk_len >= start_pos And wk_len <= start_pos + end_pos - 1 Then
          wk_out = wk_out + Mid(s_text, u, 1)
       End If
    Next
    Midx = wk_out

End Function



Sub ReRank_QuesNo_H_20140611(pType As String)
    Dim i As Integer, J As Integer
    Dim wType_Idx As Integer
    Dim wQues_Type() As String
    Dim wGalary_Idx As Integer
    Dim wQues_Cnt As Integer
    Dim FirstLineIndent As Currency
    
    
    ''''|fffd||c9b3||fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|
    Call Get_Dis_Ques_Type(wQues_Type())
    
    
    wQues_Cnt = 0
    
    
    
    For wType_Idx = 1 To UBound(wQues_Type)
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        Selection.Find.ClearFormatting
        Selection.Find.Text = wQues_Type(wType_Idx)
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            wQues_Cnt = wQues_Cnt + 1
            
            Selection.MoveRight Unit:=wdCharacter, Count:=2 '|fffd||fffd||fffd||fffd||124|@|fffd|D
            
            ''''|fffd|C|fffd|@|fffd|j|fffd|D|fffd||fffd||fffd||7a5||fffd| ListGalleries 7 |fffd||fffd|
            wGalary_Idx = 7
            
            ''''|fffd|]|fffd|w|fffd|C|fffd|@|fffd|j|fffd|D|fffd||fffd| ListGalleries 7 |fffd||fffd||fffd||fffd||fffd||4a6||fffd|
            With ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx).ListLevels(1)
                .NumberStyle = wdListNumberStyleArabic
                .NumberFormat = "%1."
                .TrailingCharacter = wdTrailingSpace
                
                ''''|fffd||7a5||3ad||fffd||fffd||fffd|w|fffd||fffd||fffd|I|fffd||fffd||fffd|Y|fffd||fffd|
                On Error Resume Next
                .NumberPosition = Selection.Range.ListFormat.ListTemplate.ListLevels(1).NumberPosition
                .TextPosition = Selection.Range.ListFormat.ListTemplate.ListLevels(1).TextPosition
                On Error GoTo 0
                
                .Alignment = wdListLevelAlignRight
                .TabPosition = wdUndefined
                .ResetOnHigher = 0
                
                If pType = "Continue" Then
                    .StartAt = wQues_Cnt '|fffd|C|fffd|j|fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|s|fffd||fffd|
                Else
                    .StartAt = 1         '|fffd|C|fffd|j|fffd|D|fffd|q 1 |fffd|}|fffd|l
                End If
                
                With .Font
                    .Bold = True
                    .Italic = False
                    .StrikeThrough = False
                    .Subscript = False
                    .Superscript = False
                    .Shadow = False
                    .Outline = False
                    .Emboss = False
                    .Engrave = False
                    .AllCaps = False
                    .Hidden = False
                    .Underline = False
                    .ColorIndex = wdAuto
                    .Size = 12
                    .Spacing = 0
                    .Scaling = 100
                    .Position = 0
                    .Animation = False
                    .DoubleStrikeThrough = False
                    On Error Resume Next
                    .Borders(1).LineStyle = wdLineStyleNone
                    On Error GoTo 0
                    .Name = "|fffd|s|fffd||4e9||fffd||fffd||fffd|"
                End With
                .LinkedStyle = ""
            End With
            
            
            ''''|fffd||124|@|fffd|D --> ContinuePreviousList:=False
            Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx), _
            ContinuePreviousList:=False, ApplyTo:=wdListApplyToWholeList
            
            
            Do While 1 = 1
                Selection.Find.ClearFormatting
                Selection.Find.Text = Chr(13)
                Selection.Find.Forward = True
                Selection.Find.Execute
                
                If Selection.Find.Found Then
                    Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    
                    If Selection.Font.Bold = True Then '|fffd||fffd||fffd|U|fffd|@|fffd||fffd||fffd|D|fffd||fffd||fffd||fffd|
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        Selection.MoveLeft Unit:=wdCharacter, Count:=1
                        Exit Do
                    Else
                        If Selection.Text = Chr(13) Then Exit Do '|fffd||fffd||fffd||fffd||568||fffd||fffd||32b||1b71||fffd|F
                        
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        
                        Select Case Selection.Font.ColorIndex
                            Case wdAuto, wdBlack
                                ''''|fffd||fffd||fffd||fffd|W|fffd|@|fffd||4fd|s|fffd||fffd| --> ContinuePreviousList:=True
                                Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx), _
                                ContinuePreviousList:=True, ApplyTo:=wdListApplyToWholeList
                                
                                wQues_Cnt = wQues_Cnt + 1
                                
                        End Select
                    End If
                    
                Else
                    Exit Do
                End If
            Loop
            
        End If
    Next
        
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
        
End Sub



Function Check_Hidden_Yn() As Boolean
    Dim i As Integer, Get_Yn As Boolean
    Dim wChk_Color()
    
    On Error Resume Next
    
    Application.ScreenUpdating = False
    
    ReDim wChk_Color(5)
    wChk_Color(1) = wdBlue        '|fffd||fffd||fffd||fffd|
    wChk_Color(2) = wdGreen       '|fffd||46a|R
    wChk_Color(3) = wdViolet      '|fffd||fffd|O|fffd||fffd||fffd||fffd|
    wChk_Color(4) = wdDarkYellow  '|fffd||fffd||fffd||fffd||fffd||fffd|
    wChk_Color(5) = wdDarkRed     '|fffd|D|fffd||fffd|
    
    
    ActiveWindow.View.ShowHiddenText = True
    
    For i = 1 To UBound(wChk_Color)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Font.ColorIndex = wChk_Color(i)
        Selection.Find.Forward = True
        Selection.Find.Execute
        If Selection.Find.Found Then
            If Selection.Font.Hidden = True Then
                Get_Yn = True
                Exit For
            End If
        End If
    Next
    ActiveWindow.View.ShowHiddenText = False
    
    Application.ScreenUpdating = True
    
    'MsgBox Get_Yn
    Check_Hidden_Yn = Get_Yn
    
End Function

Sub ReRank_QuesNo_V_20140611(pType As String)
    Dim i As Integer, J As Integer
    Dim wType_Idx As Integer
    Dim wQues_Type() As String
    Dim wGalary_Idx As Integer
    Dim wQues_Cnt As Integer
    Dim FirstLineIndent As Currency
    
    
    ''''|fffd||c9b3||fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|
    Call Get_Dis_Ques_Type(wQues_Type())
    
    
    wQues_Cnt = 0
    
    
    
    For wType_Idx = 1 To UBound(wQues_Type)
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        Selection.Find.ClearFormatting
        Selection.Find.Text = wQues_Type(wType_Idx)
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            If pType = "Continue" Then
                wQues_Cnt = wQues_Cnt + 1
            Else
                wQues_Cnt = 1
            End If
            
            ''''Mark |fffd||fffd||fffd|D|fffd||fffd||fffd||fffd||fffd||124|@|fffd|D|fffd||fffd||fffd|D|fffd||fffd|
            Selection.MoveRight Unit:=wdCharacter, Count:=2
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            
            GoSub Write_Ques_No
                
            
            Do While 1 = 1
                For i = 1 To 2
                    Selection.Find.ClearFormatting
                    Selection.Find.Text = Chr(13)
                    Selection.Find.Font.ColorIndex = wdAuto
                    Selection.Find.Forward = True
                    Selection.Find.Execute
                Next
                Selection.Find.ClearFormatting
                Selection.Find.Text = Chr(13)
                Selection.Find.Forward = False
                Selection.Find.Execute
                
                If Selection.Find.Found Then
                    Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    
                    If Selection.Font.Bold = True And Selection.Font.ColorIndex <> wdDarkBlue Then   '|fffd||fffd||fffd|U|fffd|@|fffd||fffd||fffd|D|fffd||fffd||fffd||fffd|
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        Selection.MoveLeft Unit:=wdCharacter, Count:=1
                        Exit Do
                    Else
                        If Selection.Text = Chr(13) Then Exit Do '|fffd||fffd||fffd||fffd||568||fffd||fffd||32b||1b71||fffd|F
                        
                        Select Case Selection.Font.ColorIndex
                            Case wdAuto, wdBlack, wdDarkBlue
                                wQues_Cnt = wQues_Cnt + 1
                                GoSub Write_Ques_No
                                
                        End Select
                    End If
                    
                Else
                    Exit Do
                End If
            Loop
            
        End If
    Next
        
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    
    Exit Sub
    
    
    
    
Write_Ques_No:
    If Selection.Font.ColorIndex = wdDarkBlue Then
        Selection.Delete
    Else
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
    End If
    With Selection.Font
        .ColorIndex = wdDarkBlue
        .Size = 12
        .Name = "|fffd|s|fffd||4e9||fffd||fffd||fffd|"
        .Spacing = 0
        .Bold = False
        .StrikeThrough = False
        .Underline = wdUnderlineNone
        .Italic = False
    End With
    Select Case Len(Trim(wQues_Cnt))
        Case 1
            wStr1 = Convert_Chi(Trim(Str(wQues_Cnt)), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 0(" + wStr1 + "))", PreserveFormatting:=False
        Case 2
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 3(" + wStr1 + "),\s\do -3(" + wStr2 + "))", PreserveFormatting:=False
        Case 3
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Mid(Trim(Str(wQues_Cnt)), 2, 1), "1")
            wStr3 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 5(" + wStr1 + "),\s\do 0(" + wStr2 + "),\s\do -5(" + wStr3 + "))", PreserveFormatting:=False
        Case Else
            Selection.TypeText Text:=ques_no + "."
    End Select
    Return
    
    
    
End Sub
Sub ReRank_QuesNo_H(pType As String)
    Dim i As Integer, J As Integer
    Dim wType_Idx As Integer
    Dim wQues_Type() As String
    Dim wGalary_Idx As Integer
    Dim wQues_Cnt As Integer
    Dim FirstLineIndent As Currency
    
    
    ''''|fffd||c9b3||fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|
    Call Get_Dis_Ques_Type(wQues_Type())
    
    
    wQues_Cnt = 0
    
    
    
    For wType_Idx = 1 To UBound(wQues_Type)
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        Selection.Find.ClearFormatting
        Selection.Find.Text = wQues_Type(wType_Idx)
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            wQues_Cnt = wQues_Cnt + 1
            
            Selection.MoveRight Unit:=wdCharacter, Count:=2 '|fffd||fffd||fffd||fffd||124|@|fffd|D
            
            ''''|fffd|C|fffd|@|fffd|j|fffd|D|fffd||fffd||fffd||7a5||fffd| ListGalleries 7 |fffd||fffd|
            wGalary_Idx = 7
            
            ''''|fffd|]|fffd|w|fffd|C|fffd|@|fffd|j|fffd|D|fffd||fffd| ListGalleries 7 |fffd||fffd||fffd||fffd||fffd||4a6||fffd|
            With ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx).ListLevels(1)
                .NumberStyle = wdListNumberStyleArabic
                .NumberFormat = "%1."
                .TrailingCharacter = wdTrailingSpace
                
                ''''|fffd||7a5||3ad||fffd||fffd||fffd|w|fffd||fffd||fffd|I|fffd||fffd||fffd|Y|fffd||fffd|
                On Error Resume Next
                .NumberPosition = Selection.Range.ListFormat.ListTemplate.ListLevels(1).NumberPosition
                .TextPosition = Selection.Range.ListFormat.ListTemplate.ListLevels(1).TextPosition
                On Error GoTo 0
                
                .Alignment = wdListLevelAlignRight
                .TabPosition = wdUndefined
                .ResetOnHigher = 0
                
                If pType = "Continue" Then
                    .StartAt = wQues_Cnt '|fffd|C|fffd|j|fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|s|fffd||fffd|
                Else
                    .StartAt = 1         '|fffd|C|fffd|j|fffd|D|fffd|q 1 |fffd|}|fffd|l
                End If
                
                With .Font
                    .Bold = True
                    .Italic = False
                    .StrikeThrough = False
                    .Subscript = False
                    .Superscript = False
                    .Shadow = False
                    .Outline = False
                    .Emboss = False
                    .Engrave = False
                    .AllCaps = False
                    .Hidden = False
                    .Underline = False
                    .ColorIndex = wdAuto
                    .Size = 12
                    .Spacing = 0
                    .Scaling = 100
                    .Position = 0
                    .Animation = False
                    .DoubleStrikeThrough = False
                    On Error Resume Next
                    .Borders(1).LineStyle = wdLineStyleNone
                    On Error GoTo 0
                    .Name = "|fffd|s|fffd||4e9||fffd||fffd||fffd|"
                End With
                .LinkedStyle = ""
            End With
            
            
            ''''|fffd||124|@|fffd|D --> ContinuePreviousList:=False
            Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx), _
            ContinuePreviousList:=False, ApplyTo:=wdListApplyToWholeList
            
            
            Do While 1 = 1
                Selection.Find.ClearFormatting
                Selection.Find.Text = Chr(13)
                Selection.Find.Forward = True
                Selection.Find.Execute
                
                If Selection.Find.Found Then
                    Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    
                    If Selection.Font.Bold = True Then '|fffd||fffd||fffd|U|fffd|@|fffd||fffd||fffd|D|fffd||fffd||fffd||fffd|
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        Selection.MoveLeft Unit:=wdCharacter, Count:=1
                        Exit Do
                    Else
                        If Selection.Text = Chr(13) Then Exit Do '|fffd||fffd||fffd||fffd||568||fffd||fffd||32b||1b71||fffd|F
                        
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        
                        Select Case Selection.Font.ColorIndex
                            Case wdAuto, wdBlack
                                ''''|fffd||fffd||fffd||fffd|W|fffd|@|fffd||4fd|s|fffd||fffd| --> ContinuePreviousList:=True
                                Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdOutlineNumberGallery).ListTemplates(wGalary_Idx), _
                                ContinuePreviousList:=True, ApplyTo:=wdListApplyToWholeList
                                
                                wQues_Cnt = wQues_Cnt + 1
                                
                        End Select
                    End If
                    
                Else
                    Exit Do
                End If
            Loop
            
        End If
    Next
        
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
        
End Sub


Sub ReRank_QuesNo_V(pType As String)
    Dim i As Integer, J As Integer
    Dim wType_Idx As Integer
    Dim wQues_Type() As String
    Dim wGalary_Idx As Integer
    Dim wQues_Cnt As Integer
    Dim FirstLineIndent As Currency
    
    
    ''''|fffd||c9b3||fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|
    Call Get_Dis_Ques_Type(wQues_Type())
    
    
    wQues_Cnt = 0
    
    
    
    For wType_Idx = 1 To UBound(wQues_Type)
        Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
        Selection.Find.ClearFormatting
        Selection.Find.Text = wQues_Type(wType_Idx)
        Selection.Find.Forward = True
        Selection.Find.Execute
        
        If Selection.Find.Found Then
            If pType = "Continue" Then
                wQues_Cnt = wQues_Cnt + 1
            Else
                wQues_Cnt = 1
            End If
            
            
            ''''Mark |fffd||fffd||fffd|D|fffd||fffd||fffd||fffd||fffd||124|@|fffd|D|fffd||fffd||fffd|}|fffd|Y
            Selection.MoveRight Unit:=wdCharacter, Count:=2
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            
            ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
            If Selection.Text = "|fffd|]" Then
                ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
                Selection.MoveRight Unit:=wdCharacter, Count:=4
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                
                If Selection.Text = "|fffd|]" Then
                    ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    
                    If Selection.Text = "|fffd|]" Then
                        ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                        Selection.MoveRight Unit:=wdCharacter, Count:=4
                        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    End If
                End If
            End If
            
            
            GoSub Write_Ques_No
                
            
            Do While 1 = 1
                For i = 1 To 2
                    Selection.Find.ClearFormatting
                    Selection.Find.Text = Chr(13)
                    Selection.Find.Font.ColorIndex = wdAuto
                    Selection.Find.Forward = True
                    Selection.Find.Execute
                Next
                Selection.Find.ClearFormatting
                Selection.Find.Text = Chr(13)
                Selection.Find.Forward = False
                Selection.Find.Execute
                
                If Selection.Find.Found Then
                    Selection.MoveRight Unit:=wdCharacter, Count:=1
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                    
                    If Selection.Font.Bold = True Then '|fffd||fffd||fffd|U|fffd|@|fffd||fffd||fffd|D|fffd||fffd||fffd||fffd|
                        Selection.MoveRight Unit:=wdCharacter, Count:=1
                        Selection.MoveLeft Unit:=wdCharacter, Count:=1
                        Exit Do
                    Else
                        If Selection.Text = Chr(13) Then Exit Do '|fffd||fffd||fffd||fffd||568||fffd||fffd||32b||1b71||fffd|F
                        
                        Select Case Selection.Font.ColorIndex
                            Case wdAuto, wdBlack, wdDarkBlue
                                wQues_Cnt = wQues_Cnt + 1
                                
                                ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
                                If Selection.Text = "|fffd|]" Then
                                    ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
                                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                                    
                                    If Selection.Text = "|fffd|]" Then
                                        ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                                        Selection.MoveRight Unit:=wdCharacter, Count:=4
                                        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                                        
                                        If Selection.Text = "|fffd|]" Then
                                            ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                                            Selection.MoveRight Unit:=wdCharacter, Count:=4
                                            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                                        End If
                                    End If
                                End If
                                
                                GoSub Write_Ques_No
                                
                        End Select
                    End If
                    
                Else
                    Exit Do
                End If
            Loop
            
        End If
    Next
        
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    
    Exit Sub
    
    
    
    
Write_Ques_No:
    If Selection.Font.ColorIndex = wdDarkBlue Then
        Selection.Delete
    Else
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
    End If
    With Selection.Font
        .ColorIndex = wdDarkBlue
        .Size = 12
        .Name = "|fffd|s|fffd||4e9||fffd||fffd||fffd|"
        .Spacing = 0
        .Bold = False
        .StrikeThrough = False
        .Underline = wdUnderlineNone
        .Italic = False
    End With
    Select Case Len(Trim(wQues_Cnt))
        Case 1
            wStr1 = Convert_Chi(Trim(Str(wQues_Cnt)), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 0(" + wStr1 + "))", PreserveFormatting:=False
        Case 2
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 3(" + wStr1 + "),\s\do -3(" + wStr2 + "))", PreserveFormatting:=False
        Case 3
            wStr1 = Convert_Chi(Left(Trim(Str(wQues_Cnt)), 1), "1")
            wStr2 = Convert_Chi(Mid(Trim(Str(wQues_Cnt)), 2, 1), "1")
            wStr3 = Convert_Chi(Right(Trim(Str(wQues_Cnt)), 1), "1")
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:="eq \o(\s\do 5(" + wStr1 + "),\s\do 0(" + wStr2 + "),\s\do -5(" + wStr3 + "))", PreserveFormatting:=False
        Case Else
            Selection.TypeText Text:=ques_no + "."
    End Select
    Return
    
    
    
End Sub



Function Trimx(s_text As Variant) As String

Trimx = Trim(StrConv(s_text, 0))

End Function





Attribute VB_Name = "basFuncKey"
Sub |fffd|A|fffd||fffd||fffd||fffd|V()
    '|fffd|]
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd|]"
        .Replacement.Text = "|fffd|]"
        .Replacement.Font.Name = "|fffd|L|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd|"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    '|fffd|^
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd|^"
        .Replacement.Text = "|fffd|^"
        .Replacement.Font.Name = "|fffd|L|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd|"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    '|fffd|m
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd|m"
        .Replacement.Text = "|fffd|m"
        .Replacement.Font.Name = "|fffd|L|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd|"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    '|fffd|n
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd|n"
        .Replacement.Text = "|fffd|n"
        .Replacement.Font.Name = "|fffd|L|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd|"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll

End Sub

Sub |fffd||fffd||fffd||6c2a|_15()
    
    Application.ScreenUpdating = False
    
    Call Change_LineSpacing(wdLineSpace1pt5, -1)
    
    Application.ScreenUpdating = True
    
    
End Sub

Sub |fffd||fffd||fffd||6c2a|_20()
    
    Application.ScreenUpdating = False
    
    Call Change_LineSpacing(wdLineSpaceDouble, -1)
    
    Application.ScreenUpdating = True
    
    
End Sub


Sub |fffd|]|fffd|wA4()
    On Error Resume Next
    
    With ActiveDocument.PageSetup
        If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
            .PageWidth = CentimetersToPoints(21)
            .PageHeight = CentimetersToPoints(29.7)
        Else
            .PageWidth = CentimetersToPoints(29.7)
            .PageHeight = CentimetersToPoints(21)
        End If
    End With
    
End Sub

Sub |fffd|]|fffd|wB4()
    On Error Resume Next
    
    With ActiveDocument.PageSetup
        If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
            .PageWidth = CentimetersToPoints(25.7)
            .PageHeight = CentimetersToPoints(36.4)
        Else
            .PageWidth = CentimetersToPoints(36.4)
            .PageHeight = CentimetersToPoints(25.7)
        End If
    End With

End Sub


Sub |fffd|]|fffd|wB5()
    On Error Resume Next
    
    With ActiveDocument.PageSetup
        If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
            .PageWidth = CentimetersToPoints(18.2)
            .PageHeight = CentimetersToPoints(25.7)
        Else
            .PageWidth = CentimetersToPoints(25.7)
            .PageHeight = CentimetersToPoints(18.2)
        End If
    End With

End Sub



Sub |fffd|]|fffd|wA3()
    On Error Resume Next
    
    With ActiveDocument.PageSetup
        If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
            .PageWidth = CentimetersToPoints(29.7)
            .PageHeight = CentimetersToPoints(42)
        Else
            .PageWidth = CentimetersToPoints(42)
            .PageHeight = CentimetersToPoints(29.7)
        End If
    End With
    
End Sub



Sub |fffd||fffd||fffd||fffd|()
    On Error Resume Next
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type <> wdPrintView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    'With ActiveDocument.PageSetup.TextColumns
    With ActiveDocument.Range(Start:=Selection.Start, End:=ActiveDocument.Content.End).PageSetup.TextColumns
        .SetCount NumColumns:=1
        .EvenlySpaced = True
        .LineBetween = True
        '.Width = CentimetersToPoints(14.65)
        '.Spacing = CentimetersToP oints(1.27)
    End With

End Sub

Sub |fffd||fffd||fffd||ed||fffd||fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||ed||fffd||fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||ed||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||72d||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||ed||fffd||fffd||fffd|").Caption = "|fffd||fffd||72d||fffd||fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||72d||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||fffd||ed||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||72d||fffd||fffd||fffd|").Caption = "|fffd||fffd||fffd||ed||fffd||fffd||fffd|"
    End If
    
    
End Sub

Sub |fffd||fffd||fffd||fffd|()
    
Dim i As Integer
Dim iChar_Cnt As Integer
    
    On Error Resume Next
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type <> wdPrintView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveDocument.Range(Start:=Selection.Start, End:=Selection.Start).InsertBreak Type:=wdSectionBreakContinuous
    Selection.Start = Selection.Start + 1
    'With ActiveDocument.PageSetup.TextColumns
    With ActiveDocument.Range(Start:=Selection.Start, End:=ActiveDocument.Content.End).PageSetup.TextColumns
        .SetCount NumColumns:=2
        .EvenlySpaced = True
        .LineBetween = True
        '.Width = CentimetersToPoints(6.95)
        '.Spacing = CentimetersToPoints(0.75)
    End With
    
    '|fffd|R|fffd||fffd||fffd|h|fffd||fffd| Selection
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.ExtendMode = True
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    iChar_Cnt = 1
    Do While InStr(1, Selection.Text, Chr(13)) <= 0
        Selection.ExtendMode = False
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        Selection.ExtendMode = True
        Selection.MoveRight Unit:=wdCharacter, Count:=1
        iChar_Cnt = iChar_Cnt + 1
    Loop
    Selection.ExtendMode = False
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    If iChar_Cnt >= 3 Then
        For i = 3 To iChar_Cnt
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.ExtendMode = True
            Selection.MoveRight Unit:=wdCharacter, Count:=1
            Selection.Delete
            Selection.ExtendMode = False
        Next
    End If
    
End Sub


Sub |fffd||fffd||5a6||6c2a|()
    Dim wLineSpacing As Integer
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    
    If Not Selection.Find.Found Then Exit Sub
    
    Application.ScreenUpdating = False
    
    ''''|fffd||fffd||fffd||fffd||124|@|fffd|j|fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    wLineSpacing = Selection.ParagraphFormat.LineSpacing
    wLineSpacing = wLineSpacing - 4
    If wLineSpacing < 12 Then wLineSpacing = 12
    If wLineSpacing > 1584 Then wLineSpacing = 1584
    
        
    Call Change_LineSpacing(wdLineSpaceAtLeast, wLineSpacing)
    
    
    Application.ScreenUpdating = True
    
    
End Sub

Sub |fffd|W|fffd|[|fffd||6c2a|()
    Dim wLineSpacing As Integer
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = "|fffd|@|fffd|B"
    Selection.Find.Forward = True
    Selection.Find.Execute
    
    If Not Selection.Find.Found Then Exit Sub
    
    Application.ScreenUpdating = False
    
    ''''|fffd||fffd||fffd||fffd||124|@|fffd|j|fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    wLineSpacing = Selection.ParagraphFormat.LineSpacing
    wLineSpacing = wLineSpacing + 4
    If wLineSpacing < 12 Then wLineSpacing = 12
    If wLineSpacing > 1584 Then wLineSpacing = 1584
    
        
    Call Change_LineSpacing(wdLineSpaceAtLeast, wLineSpacing)
    
    
    Application.ScreenUpdating = True
    
    
End Sub


Sub |fffd||fffd||6da1||fffd|Z()
    
    Application.ScreenUpdating = False
    
    Call Change_LineSpacing(wdLineSpaceSingle, -1)
    
    Application.ScreenUpdating = True
    
    
End Sub


Sub |fffd||324|p|fffd||6c2a|()
    
    Application.ScreenUpdating = False
    
    Call Change_LineSpacing(wdLineSpaceAtLeast, 12)
    
    Application.ScreenUpdating = True
    
    
End Sub



Sub |fffd|D|fffd||fffd||fffd||fffd||fffd||fffd|()
    
    ''''|fffd||2ec|d
    If Check_QuesNo_Hidden_Yn = True Then
        MsgBox "|fffd|D|fffd||fffd||fffd||fffd||fffd||fffd||fffd||ee||261|A|fffd||fffd||fffd||fffd||fffd||466||fffd||fffd|\|fffd||fffd|I", vbInformation, "|fffd||2ec|d"
        Exit Sub
    End If
    
    Application.ScreenUpdating = False
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
        Call ReRank_QuesNo_H("ReStart")
    Else
        Call ReRank_QuesNo_V("ReStart")
    End If
    Application.ScreenUpdating = True
    
    MsgBox "|fffd|i|fffd|D|fffd||fffd||fffd||fffd||fffd||1a1|j|fffd|B|fffd|z|fffd||fffd||fffd||fffd||fffd|I", vbInformation, "|fffd||fffd||fffd||fffd|"
    
End Sub

Sub |fffd|D|fffd||624|U|fffd||fffd|()
    Dim i As Integer, Get_Yn As Boolean
    Dim wMk_St As String, wMk_End As String, wMk_Chk As String
    Dim wNow_Ques_Seq As Integer
    Dim wOri_QuesNo As String, wNew_QuesNo As String
    
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd||470||fffd||fffd|@|fffd|}|fffd|l|fffd|O|fffd|Q Mark |fffd|Y|fffd|@|fffd|q|fffd|r|fffd||fffd||fffd||fffd||fffd|p
    '*************************************************************
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    
    If Selection.Font.Bold = True Then Exit Sub
    
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd||fffd||fffd||ea||fffd||fffd||fffd|r|fffd||261|A|fffd||fffd||fffd||fffd||fffd||69b9||fffd|\|fffd||fffd|
    '*************************************************************
    ''''|fffd||fffd||fffd|W Mark
    wMk_Chk = "{@@Mark_Chk@@}"
    Selection.TypeText wMk_Chk
    
    ''''|fffd||2ec|d
    If Check_Hidden_Yn = True Then
        ''''|fffd|^|fffd||fffd| Mark |fffd||fffd||fffd||fffd|m
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Text = wMk_Chk
        Selection.Find.Forward = True
        Selection.Find.Execute
        Selection.MoveRight Unit:=wdCharacter, Count:=1
        For i = 1 To Len(wMk_Chk)
            Selection.TypeBackspace
        Next
        MsgBox "|fffd||fffd||fffd||fffd||fffd||ee||261|A|fffd||fffd||fffd||fffd||fffd||466||fffd||fffd|\|fffd||fffd|I", vbInformation, "|fffd||2ec|d"
        Exit Sub
    End If
    
    
    ''''|fffd||470||fffd| Mark|fffd|A|fffd|^|fffd||fffd||fffd||fffd|m
    Selection.HomeKey Unit:=wdStory
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_Chk
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    For i = 1 To Len(wMk_Chk)
        Selection.TypeBackspace
    Next
    
    
    
    '*************************************************************
    ''''|fffd|Y|fffd||fffd||fffd|O|fffd||fffd||fffd|D|fffd||630||3e1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|D|fffd||630||fffd|
    '*************************************************************
    If Selection.Font.ColorIndex <> wdAuto And Selection.Font.ColorIndex <> wdDarkBlue Then
        Do While 1 = 1
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then Exit Do
        Loop
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
    End If
    
    
    
    
    '*************************************************************
    ''''|fffd||76c|O|fffd|_|fffd|O|fffd||fffd||fffd|j|fffd|D|fffd||fffd||fffd||32b||fffd|@|fffd|D
    '*************************************************************
    ''''|fffd||fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|D|fffd||627||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    Selection.Find.ClearFormatting
    Selection.Find.Font.ColorIndex = wdAuto
    Selection.Find.Forward = True
    Selection.Find.Execute
    If Selection.Find.Found Then
        Selection.MoveLeft Unit:=wdCharacter, Count:=2
        If Selection.Font.Bold = True Or Selection.Text = Chr(13) Then
            MsgBox "|fffd||fffd||fffd|D|fffd||fffd||fffd||32b||fffd|@|fffd|D|fffd|I", vbInformation, "|fffd||2ec|d"
            Exit Sub
        Else
            For i = 1 To 2
                Selection.Find.ClearFormatting
                Selection.Find.Text = Chr(13)
                Selection.Find.Font.ColorIndex = wdAuto
                Selection.Find.Forward = False
                Selection.Find.Execute
            Next
        End If
    End If
    
    
    
    
    wMk_St = "{@@Mark_St@@}"
    wMk_End = "{@@Mark_End@@}"
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd|Q|fffd||fffd||fffd||fffd|n|fffd||fffd||fffd||2aa||fffd||fffd|o|fffd||fffd||fffd|D|fffd||625|[|fffd|_|fffd||fffd||fffd||fffd| Mark
    '*************************************************************
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Font.ColorIndex = wdAuto
    Selection.Find.Forward = True
    Selection.Find.Execute
    If Selection.Find.Found Then
    Else
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Font.ColorIndex = wdDarkBlue
        Selection.Find.Forward = True
        Selection.Find.Execute
    End If
    
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.Find.Execute
    
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
    Else
        ''''|fffd||f97b||fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|G+1
        
        
        ''''|fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
        ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
        If Selection.Text = "|fffd|]" Then
            ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
            Selection.MoveRight Unit:=wdCharacter, Count:=4
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            If Selection.Text = "|fffd|]" Then
                ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                Selection.MoveRight Unit:=wdCharacter, Count:=4
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                
                If Selection.Text = "|fffd|]" Then
                    ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                End If
            End If
        End If
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        
        
        
        
        ''''|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||73c||1a5|N|fffd|X
        Selection.Fields.ToggleShowCodes
        Selection.Find.ClearFormatting
        Selection.Find.Text = "eq \o(\s\do"
        Selection.Find.Forward = True
        Selection.ExtendMode = False
        Selection.Find.Execute
        If Selection.Find.Found Then
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.Find.ClearFormatting
            Selection.Find.Text = "))"
            Selection.Find.Forward = True
            Selection.ExtendMode = True
            Selection.Find.Execute
            If Selection.Find.Found Then
                wOri_QuesNo = Selection.Text
                wNew_QuesNo = Proc_Return_New_Func_Code(wOri_QuesNo, 1)
                If wNew_QuesNo <> "" Then
                    Selection.TypeText Text:=wNew_QuesNo
                End If
            End If
        End If
        Selection.Fields.ToggleShowCodes
    End If
    
    
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    ''''|fffd||fffd||fffd|D|fffd|[|fffd|W|fffd|_|fffd|l|fffd||fffd| Mark
    Selection.TypeText wMk_St
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    ''''|fffd||2ec|d|fffd|O|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    If Selection.Text <> "}" Then
        Selection.MoveRight Unit:=wdCharacter, Count:=2
        For i = 1 To Len(wMk_St)
            Selection.TypeBackspace
        Next
        Exit Sub
    End If
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd|i|fffd|D|fffd||630||3e1|j|fffd||fffd||fffd||32b||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd||fffd||fffd||32b||fffd|A|fffd||e5|[|fffd|W Mark
    If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then
    Else
        Do While 1 = 1
            Selection.MoveRight Unit:=wdCharacter, Count:=1
            If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then Exit Do
        Loop
    End If
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.TypeText wMk_End
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    
    
    '*************************************************************
    ''''|fffd||1bb|s|fffd||fffd||fffd|D|fffd|D|fffd||fffd|
    '*************************************************************
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    
    ''''|fffd||1bb|s|fffd||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_End + Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    Selection.Copy
    Selection.ExtendMode = False
    
    
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_End
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    
    '*************************************************************
    ''''|fffd|^|fffd||fffd|U|fffd|G|fffd|D|fffd||fffd||fffd|}|fffd|Y
    '*************************************************************
    If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Font.ColorIndex = wdAuto
        Selection.Find.Forward = True
        Selection.Find.Execute
        If Selection.Find.Found Then
        Else
            Selection.Find.ClearFormatting
            Selection.Find.Text = Chr(13)
            Selection.Find.Font.ColorIndex = wdDarkBlue
            Selection.Find.Forward = True
            Selection.Find.Execute
        End If
    End If
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Font.ColorIndex = wdAuto
        Selection.Find.Forward = True
        Selection.Find.Execute
        If Selection.Find.Found Then
        Else
            Selection.Find.ClearFormatting
            Selection.Find.Text = Chr(13)
            Selection.Find.Font.ColorIndex = wdDarkBlue
            Selection.Find.Forward = True
            Selection.Find.Execute
        End If
    Next
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    '*************************************************************
    ''''|fffd|K|fffd|W
    '*************************************************************
    'Selection.PasteAndFormat (wdPasteDefault)
    Selection.Paste
    
    
    
    '*************************************************************
    ''''|fffd|R|fffd||fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D
    '*************************************************************
    ''''|fffd|^|fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Text = wMk_St
        Selection.Find.Forward = False
        Selection.ExtendMode = False
        Selection.Find.Execute
    Next
    
    ''''|fffd|R|fffd||fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_End + Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    Selection.Delete
    Selection.ExtendMode = False
    
    
    
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
    Else
        ''''|fffd||fffd||6f9||fffd|t|fffd|@|fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|G-1
        
        
        ''''|fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
        ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
        If Selection.Text = "|fffd|]" Then
            ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
            Selection.MoveRight Unit:=wdCharacter, Count:=4
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            If Selection.Text = "|fffd|]" Then
                ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                Selection.MoveRight Unit:=wdCharacter, Count:=4
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                
                If Selection.Text = "|fffd|]" Then
                    ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                End If
            End If
        End If
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        
        
        
        
        ''''|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||73c||1a5|N|fffd|X
        Selection.Fields.ToggleShowCodes
        Selection.Find.ClearFormatting
        Selection.Find.Text = "eq \o(\s\do"
        Selection.Find.Forward = True
        Selection.ExtendMode = False
        Selection.Find.Execute
        If Selection.Find.Found Then
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.Find.ClearFormatting
            Selection.Find.Text = "))"
            Selection.Find.Forward = True
            Selection.ExtendMode = True
            Selection.Find.Execute
            If Selection.Find.Found Then
                wOri_QuesNo = Selection.Text
                wNew_QuesNo = Proc_Return_New_Func_Code(wOri_QuesNo, -1)
                If wNew_QuesNo <> "" Then
                    Selection.TypeText Text:=wNew_QuesNo
                End If
            End If
        End If
        Selection.Fields.ToggleShowCodes
    End If
    
    
    
    '*************************************************************
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    '*************************************************************
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = True
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    
    
    ''''|fffd||fffd||fffd||fffd| Mark
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            Select Case i
                Case 1:   .Text = wMk_St
                Case 2:   .Text = wMk_End
            End Select
            .Replacement.Text = ""
            .Forward = True
            .Wrap = wdFindStop
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
    Next
    
    
    
    ''''|fffd||fffd||fffd||fffd||3e5||565||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    
    Selection.Find.ClearFormatting
    Selection.Find.Font.ColorIndex = wdAuto
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    If Selection.Find.Found Then
    Else
        Selection.Find.ClearFormatting
        Selection.Find.Font.ColorIndex = wdDarkBlue
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = True
        Selection.ExtendMode = True
        Selection.Find.Execute
    End If
    
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = False
        Selection.ExtendMode = True
        Selection.Find.Execute
    Next
    Selection.ExtendMode = False
    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    
End Sub

Sub |fffd|D|fffd||624|W|fffd||fffd|()
    Dim i As Integer, Get_Yn As Boolean
    Dim wMk_St As String, wMk_End As String, wMk_Chk As String
    Dim wNow_Ques_Seq As Integer
    Dim wOri_QuesNo As String, wNew_QuesNo As String
    
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd||470||fffd||fffd|@|fffd|}|fffd|l|fffd|O|fffd|Q Mark |fffd|Y|fffd|@|fffd|q|fffd|r|fffd||fffd||fffd||fffd||fffd|p
    '*************************************************************
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    
    If Selection.Font.Bold = True Then Exit Sub
    
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd||fffd||fffd||ea||fffd||fffd||fffd|r|fffd||261|A|fffd||fffd||fffd||fffd||fffd||69b9||fffd|\|fffd||fffd|
    '*************************************************************
    ''''|fffd||fffd||fffd|W Mark
    wMk_Chk = "{@@Mark_Chk@@}"
    Selection.TypeText wMk_Chk
    
    ''''|fffd||2ec|d
    If Check_Hidden_Yn = True Then
        ''''|fffd|^|fffd||fffd| Mark |fffd||fffd||fffd||fffd|m
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Text = wMk_Chk
        Selection.Find.Forward = True
        Selection.Find.Execute
        Selection.MoveRight Unit:=wdCharacter, Count:=1
        For i = 1 To Len(wMk_Chk)
            Selection.TypeBackspace
        Next
        MsgBox "|fffd||fffd||fffd||fffd||fffd||ee||261|A|fffd||fffd||fffd||fffd||fffd||466||fffd||fffd|\|fffd||fffd|I", vbInformation, "|fffd||2ec|d"
        Exit Sub
    End If
    
    
    ''''|fffd||470||fffd| Mark|fffd|A|fffd|^|fffd||fffd||fffd||fffd|m
    Selection.HomeKey Unit:=wdStory
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_Chk
    Selection.Find.Forward = True
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    For i = 1 To Len(wMk_Chk)
        Selection.TypeBackspace
    Next
    
    
    
    '*************************************************************
    ''''|fffd|Y|fffd||fffd||fffd|O|fffd||fffd||fffd|D|fffd||630||3e1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|D|fffd||630||fffd|
    '*************************************************************
    If Selection.Font.ColorIndex <> wdAuto And Selection.Font.ColorIndex <> wdDarkBlue Then
        Do While 1 = 1
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then Exit Do
        Loop
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
    End If
    
    
    
    
    '*************************************************************
    ''''|fffd||76c|O|fffd|_|fffd|O|fffd||fffd||fffd|j|fffd|D|fffd||fffd||fffd||124|@|fffd|D
    '*************************************************************
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.Find.Execute
    If Selection.Font.Bold = True Then
        Selection.MoveRight Unit:=wdCharacter, Count:=2
        MsgBox "|fffd||fffd||fffd|D|fffd||fffd||fffd||124|@|fffd|D|fffd|I", vbInformation, "|fffd||2ec|d"
        Exit Sub
    End If
    
    
    
    
    wMk_St = "{@@Mark_St@@}"
    wMk_End = "{@@Mark_End@@}"
    
    
    '*************************************************************
    ''''|fffd||fffd||fffd|Q|fffd||fffd||fffd||fffd|n|fffd||fffd||fffd||2aa||fffd||fffd|o|fffd||fffd||fffd|D|fffd||625|[|fffd|_|fffd||fffd||fffd||fffd| Mark
    '*************************************************************
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
    Else
        ''''|fffd||f97b||fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|G-1
        
        
        ''''|fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
        ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
        If Selection.Text = "|fffd|]" Then
            ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
            Selection.MoveRight Unit:=wdCharacter, Count:=4
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            If Selection.Text = "|fffd|]" Then
                ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                Selection.MoveRight Unit:=wdCharacter, Count:=4
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                
                If Selection.Text = "|fffd|]" Then
                    ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                End If
            End If
        End If
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        
        
        
        
        ''''|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||73c||1a5|N|fffd|X
        Selection.Fields.ToggleShowCodes
        Selection.Find.ClearFormatting
        Selection.Find.Text = "eq \o(\s\do"
        Selection.Find.Forward = True
        Selection.ExtendMode = False
        Selection.Find.Execute
        If Selection.Find.Found Then
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.Find.ClearFormatting
            Selection.Find.Text = "))"
            Selection.Find.Forward = True
            Selection.ExtendMode = True
            Selection.Find.Execute
            If Selection.Find.Found Then
                wOri_QuesNo = Selection.Text
                wNew_QuesNo = Proc_Return_New_Func_Code(wOri_QuesNo, -1)
                If wNew_QuesNo <> "" Then
                    Selection.TypeText Text:=wNew_QuesNo
                End If
            End If
        End If
        Selection.Fields.ToggleShowCodes
    End If
    
    
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    ''''|fffd||fffd||fffd|D|fffd|[|fffd|W|fffd|_|fffd|l|fffd||fffd| Mark
    Selection.TypeText wMk_St
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    ''''|fffd||2ec|d|fffd|O|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    If Selection.Text <> "}" Then
        Selection.MoveRight Unit:=wdCharacter, Count:=2
        For i = 1 To Len(wMk_St)
            Selection.TypeBackspace
        Next
        Exit Sub
    End If
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd|i|fffd|D|fffd||630||3e1|j|fffd||fffd||fffd||32b||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    ''''|fffd||fffd||fffd||c97b||fffd|D|fffd||fffd||fffd||32b||fffd|A|fffd||e5|[|fffd|W Mark
    If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then
    Else
        Do While 1 = 1
            Selection.MoveRight Unit:=wdCharacter, Count:=1
            If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then Exit Do
        Loop
    End If
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.TypeText wMk_End
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    
    
    '*************************************************************
    ''''|fffd||1bb|s|fffd||fffd||fffd|D|fffd|D|fffd||fffd|
    '*************************************************************
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    
    ''''|fffd||1bb|s|fffd||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_End + Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    Selection.Copy
    Selection.ExtendMode = False
    
    
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=2
    
    
    
    '*************************************************************
    ''''|fffd|^|fffd||fffd|W|fffd|@|fffd|D|fffd||fffd||fffd|}|fffd|Y
    '*************************************************************
    If Selection.Font.ColorIndex = wdAuto Or Selection.Font.ColorIndex = wdDarkBlue Then Get_Yn = True
    
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Font.ColorIndex = wdAuto
    Selection.Find.Forward = False
    Selection.Find.Execute
    If Selection.Find.Found Then
    Else
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Font.ColorIndex = wdDarkBlue
        Selection.Find.Forward = False
        Selection.Find.Execute
    End If
    
    If Get_Yn = False Then
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = False
        Selection.Find.Execute
    End If
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
    Else
        ''''|fffd||fffd||6f9||fffd|t|fffd|@|fffd|D|fffd||fffd||fffd|D|fffd||fffd||fffd|G+1
        
        
        ''''|fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        
        ''''|fffd||776|}|fffd|Y|fffd|O|fffd||fffd||fffd|O|fffd|A|fffd||fffd|
        If Selection.Text = "|fffd|]" Then
            ''''|fffd|I|fffd||fffd||124|@|fffd||4ec|A|fffd||fffd|
            Selection.MoveRight Unit:=wdCharacter, Count:=4
            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            
            If Selection.Text = "|fffd|]" Then
                ''''|fffd|I|fffd||fffd||124|G|fffd||4ec|A|fffd||fffd|
                Selection.MoveRight Unit:=wdCharacter, Count:=4
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                
                If Selection.Text = "|fffd|]" Then
                    ''''|fffd|I|fffd||fffd||124|T|fffd||4ec|A|fffd||fffd|
                    Selection.MoveRight Unit:=wdCharacter, Count:=4
                    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                End If
            End If
        End If
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
        
        
        
        
        ''''|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||73c||1a5|N|fffd|X
        Selection.Fields.ToggleShowCodes
        Selection.Find.ClearFormatting
        Selection.Find.Text = "eq \o(\s\do"
        Selection.Find.Forward = True
        Selection.ExtendMode = False
        Selection.Find.Execute
        If Selection.Find.Found Then
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.Find.ClearFormatting
            Selection.Find.Text = "))"
            Selection.Find.Forward = True
            Selection.ExtendMode = True
            Selection.Find.Execute
            If Selection.Find.Found Then
                wOri_QuesNo = Selection.Text
                wNew_QuesNo = Proc_Return_New_Func_Code(wOri_QuesNo, 1)
                If wNew_QuesNo <> "" Then
                    Selection.TypeText Text:=wNew_QuesNo
                End If
            End If
        End If
        Selection.Fields.ToggleShowCodes
    End If
    
    
    
    
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    
    
    '*************************************************************
    ''''|fffd|K|fffd|W
    '*************************************************************
    'Selection.PasteAndFormat (wdPasteDefault)
    Selection.Paste
    
    
    
    '*************************************************************
    ''''|fffd|R|fffd||fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D
    '*************************************************************
    ''''|fffd|^|fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd||fffd|}|fffd|Y
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = True
    Selection.ExtendMode = False
    Selection.Find.Execute
    
    ''''|fffd|R|fffd||fffd||fffd|Q|fffd||1bb|s|fffd||fffd||fffd||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_End + Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    Selection.Delete
    Selection.ExtendMode = False
    
    
    
    
    '*************************************************************
    ''''|fffd|^|fffd||c97b||fffd|D|fffd||fffd||fffd|}|fffd|Y
    '*************************************************************
    Selection.Find.ClearFormatting
    Selection.Find.Text = wMk_St
    Selection.Find.Forward = False
    Selection.ExtendMode = False
    Selection.Find.Execute
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    
    
    
    ''''|fffd||fffd||fffd||fffd| Mark
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            Select Case i
                Case 1:   .Text = wMk_St
                Case 2:   .Text = wMk_End
            End Select
            .Replacement.Text = ""
            .Forward = True
            .Wrap = wdFindStop
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
    Next
    
    
    ''''|fffd||fffd||fffd||fffd||3e5||565||fffd||fffd|D
    Selection.Find.ClearFormatting
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    
    Selection.Find.ClearFormatting
    Selection.Find.Font.ColorIndex = wdAuto
    Selection.Find.Text = Chr(13)
    Selection.Find.Forward = True
    Selection.ExtendMode = True
    Selection.Find.Execute
    If Selection.Find.Found Then
    Else
        Selection.Find.ClearFormatting
        Selection.Find.Font.ColorIndex = wdDarkBlue
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = True
        Selection.ExtendMode = True
        Selection.Find.Execute
    End If
    
    For i = 1 To 2
        Selection.Find.ClearFormatting
        Selection.Find.Text = Chr(13)
        Selection.Find.Forward = False
        Selection.ExtendMode = True
        Selection.Find.Execute
    Next
    Selection.ExtendMode = False
    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    
End Sub
Sub |fffd|D|fffd||fffd||fffd|s|fffd||fffd|()

    ''''|fffd||2ec|d
    If Check_QuesNo_Hidden_Yn = True Then
        MsgBox "|fffd|D|fffd||fffd||fffd||fffd||fffd||fffd||fffd||ee||261|A|fffd||fffd||fffd||fffd||fffd||466||fffd||fffd|\|fffd||fffd|I", vbInformation, "|fffd||2ec|d"
        Exit Sub
    End If
    
    Application.ScreenUpdating = False
    If ActiveDocument.Range.Orientation = wdTextOrientationHorizontal Then '|fffd||fffd||fffd|
        Call ReRank_QuesNo_H("Continue")
    Else
        Call ReRank_QuesNo_V("Continue")
    End If
    Application.ScreenUpdating = True
    
    MsgBox "|fffd|i|fffd|D|fffd||fffd||fffd|s|fffd||fffd|j|fffd|B|fffd|z|fffd||fffd||fffd||fffd||fffd|I", vbInformation, "|fffd||fffd||fffd||fffd|"

End Sub
Sub |fffd||fffd||fffd||f5||fffd||fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||f5||fffd||fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||f5||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||735||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||f5||fffd||fffd||fffd|").Caption = "|fffd||fffd||735||fffd||fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||735||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||fffd||f5||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||735||fffd||fffd||fffd|").Caption = "|fffd||fffd||fffd||f5||fffd||fffd||fffd|"
    End If
    
    
End Sub


Sub |fffd||fffd||72d||fffd||fffd||fffd|()
    
    Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
    
End Sub

Sub |fffd||fffd||735||fffd||fffd||fffd|()
    
    Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd|")
    
End Sub



Sub |fffd||fffd||fffd||fffd|(pType As String)
    
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    
    Do While 1 = 1
        With Selection.Find
            .ClearFormatting
            .Text = ""
            
            Select Case pType
                Case "|fffd||fffd||fffd||fffd|":        .Font.ColorIndex = wdBlue
                Case "|fffd||46a|R":        .Font.ColorIndex = wdGreen
                Case "|fffd||fffd|O|fffd||fffd||fffd||fffd|":    .Font.ColorIndex = wdViolet
                Case "|fffd||fffd||fffd||fffd||fffd||fffd|":      .Font.ColorIndex = wdDarkYellow
                Case "|fffd|D|fffd||fffd|":        .Font.ColorIndex = wdDarkRed
                Case "|fffd|{|fffd||fffd||fffd|h|fffd||fffd|":    .Font.ColorIndex = wdTeal
                Case "|fffd||fffd||fffd||fffd|":        .Font.ColorIndex = wdRed
            End Select
            
            .Forward = True
            .Execute
        End With
        If Selection.Find.Found Then
            Selection.Font.Hidden = True
        Else
            Exit Do
        End If
    Loop
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
End Sub

Sub |fffd||fffd||fffd|(pType As String)
    
    ActiveWindow.View.ShowHiddenText = True
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
    Do While 1 = 1
        With Selection.Find
            .ClearFormatting
            .Text = ""
            
            Select Case pType
                Case "|fffd||fffd||fffd||fffd|":        .Font.ColorIndex = wdBlue
                Case "|fffd||46a|R":        .Font.ColorIndex = wdGreen
                Case "|fffd||fffd|O|fffd||fffd||fffd||fffd|":    .Font.ColorIndex = wdViolet
                Case "|fffd||fffd||fffd||fffd||fffd||fffd|":      .Font.ColorIndex = wdDarkYellow
                Case "|fffd|D|fffd||fffd|":        .Font.ColorIndex = wdDarkRed
                Case "|fffd|{|fffd||fffd||fffd|h|fffd||fffd|":    .Font.ColorIndex = wdTeal
                Case "|fffd||fffd||fffd||fffd|":        .Font.ColorIndex = wdRed
            End Select
            
            .Forward = True
            .Execute
        End With
        If Selection.Find.Found Then
            Selection.Font.Hidden = False
        Else
            Exit Do
        End If
    Loop
    
    ActiveWindow.View.ShowHiddenText = False
    Selection.HomeKey Unit:=wdStory '|fffd||32b|e|fffd||fffd|
    
End Sub


Sub |fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd|D|fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|").TooltipText = "|fffd||fffd||fffd||fffd|D|fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|").Caption = "|fffd||fffd||fffd||fffd|D|fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd|D|fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd|D|fffd||fffd|").TooltipText = "|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd|D|fffd||fffd|").Caption = "|fffd||fffd||fffd||fffd||fffd|D|fffd||fffd|"
    End If
    
    
End Sub

Sub |fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd|{|fffd||fffd||fffd|h|fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|").TooltipText = "|fffd||fffd||73b|{|fffd||fffd||fffd|h|fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|").Caption = "|fffd||fffd||73b|{|fffd||fffd||fffd|h|fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd|{|fffd||fffd||fffd|h|fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||73b|{|fffd||fffd||fffd|h|fffd||fffd|").TooltipText = "|fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||73b|{|fffd||fffd||fffd|h|fffd||fffd|").Caption = "|fffd||fffd||fffd||fb|{|fffd||fffd||fffd|h|fffd||fffd|"
    End If
    
    
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd||fffd||fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
    
    
End Sub



Sub |fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd||fffd|O|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||72f||fffd|O|fffd||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|").Caption = "|fffd||fffd||72f||fffd|O|fffd||fffd||fffd||fffd|"
    
    Else
        Call |fffd||fffd||fffd|("|fffd||fffd|O|fffd||fffd||fffd||fffd|")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||72f||fffd|O|fffd||fffd||fffd||fffd|").TooltipText = "|fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||72f||fffd|O|fffd||fffd||fffd||fffd|").Caption = "|fffd||fffd||fffd||ef||fffd|O|fffd||fffd||fffd||fffd|"
    End If
    
    
End Sub


Sub |fffd||fffd||fffd||f8||46a|R()
    Dim Get_Yn As Boolean
    
    
    Get_Yn = Get_Button_By_Name("|fffd||fffd||fffd||f8||46a|R")
    
    If Get_Yn = True Then
        Call |fffd||fffd||fffd||fffd|("|fffd||46a|R")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||f8||46a|R").TooltipText = "|fffd||fffd||738||46a|R"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||fffd||f8||46a|R").Caption = "|fffd||fffd||738||46a|R"
    
    Else
        Call |fffd||fffd||fffd|("|fffd||46a|R")
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||738||46a|R").TooltipText = "|fffd||fffd||fffd||f8||46a|R"
        Application.CommandBars("|fffd|d|fffd|a|fffd|D|fffd|w").Controls("|fffd||fffd||738||46a|R").Caption = "|fffd||fffd||fffd||f8||46a|R"
    End If
    
    
End Sub


Sub |fffd||fffd||72f||fffd|O|fffd||fffd||fffd||fffd|()
    
    Call |fffd||fffd||fffd|("|fffd||fffd|O|fffd||fffd||fffd||fffd|")
    
End Sub



Sub |fffd||fffd||fffd||fffd|D|fffd||fffd|()
    
    Call |fffd||fffd||fffd|("|fffd|D|fffd||fffd|")
    
End Sub





Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    
    Call |fffd||fffd||fffd|("|fffd||fffd||fffd||fffd||fffd||fffd|")
    
End Sub




Sub |fffd||fffd||738||46a|R()
    
    Call |fffd||fffd||fffd|("|fffd||46a|R")
    
End Sub







INQUEST-PP=macro
