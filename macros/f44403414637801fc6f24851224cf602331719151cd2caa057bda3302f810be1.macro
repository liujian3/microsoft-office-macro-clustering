Attribute VB_Name = "MD5"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'@name      MD5|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
'@version   1.00 - Sun May 13, 2012
'           1.01 - Fri Jul  5, 2013
'           1.02 - Wed Feb  5, 2014
'
'@author    Syunzi Shimohata    <webmaster@taru-net.jp>   http://www.taru-net.jp/
'           Online Reference [http://www.taru-net.jp/excel/excelVBA/MD5/readme.html]
'
'@copyright (C) 2012, Syunzi Shimohata. Japan. All Rights Reserved.
'
'@memo      http://www.ipa.go.jp/security/rfc/RFC1321JA.html
'           md5c.c
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/

'Constants for MD5Transform routine.
Private Const S11 = 7
Private Const S12 = 12
Private Const S13 = 17
Private Const S14 = 22
Private Const S21 = 5
Private Const S22 = 9
Private Const S23 = 14
Private Const S24 = 20
Private Const S31 = 4
Private Const S32 = 11
Private Const S33 = 16
Private Const S34 = 23
Private Const S41 = 6
Private Const S42 = 10
Private Const S43 = 15
Private Const S44 = 21

'MD5 context.
Private Type Context
    state(3) As Long
    count(1) As Long
    buffer(63) As Long
End Type


Private mvarCharset As String
Private mvarText As String
Private mvarFilePath As String
Private mvarStrLen As Long
Private mvarStrByte() As Byte


Private Sub Class_Initialize()
    Me.Charset = "SHIFT-JIS"
End Sub
Private Sub Class_Terminate()
End Sub


'F, G, H and I are basic MD5 functions.
Private Function F(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    F = (x And y) Or ((Not x) And z)
End Function

Private Function G(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    G = (x And z) Or (y And (Not z))
End Function

Private Function h(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    h = x Xor y Xor z
End Function

Private Function i(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    i = y Xor (x Or (Not z))
End Function


'ROTATE_LEFT rotates x left n bits.
Private Function ROTATE_LEFT(ByVal x As Long, ByVal n As Byte) As Long
    ROTATE_LEFT = fncLeftShift(x, n) Or fncRightShift(x, 32 - n)
End Function


'FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
'Rotation is separate from addition to prevent recomputation.
Private Sub FF(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, F(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub GG(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, G(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub HH(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, h(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub II(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, i(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub


'MD5 initialization. Begins an MD5 operation, writing a new context.
Private Sub MD5Init(ByRef Context As Context)
    Context.count(0) = 0
    Context.count(1) = 0
    
    'Load magic initialization constants.
    Context.state(0) = &H67452301
    Context.state(1) = &HEFCDAB89
    Context.state(2) = &H98BADCFE
    Context.state(3) = &H10325476
End Sub


'MD5 block update operation. Continues an MD5 message-digest
'operation, processing another message block, and updating the
'context.
Private Sub MD5Update(ByRef Context As Context, ByRef valInput As Variant, ByVal inputLen As Long)
    Dim i As Long
    Dim index As Byte
    Dim partLen As Byte


    'Compute number of bytes mod 64
    index = fncRightShift(Context.count(0), 3) And &H3F
    
    'Update number of bits
    Context.count(0) = fucAddBit(Context.count(0), fncLeftShift(inputLen, 3))
    If Context.count(0) < fncLeftShift(inputLen, 3) Then
        Context.count(1) = fucAddBit(Context.count(1), 1)
    End If

    Context.count(1) = fucAddBit(Context.count(1), fncRightShift(inputLen, 29))
    partLen = 64 - index
    
    'Transform as many times as possible.
    If inputLen >= partLen Then
        Call MD5_memcpy(Context.buffer, index, valInput, 0, partLen)
        Call MD5Transform(Context.state, Context.buffer, 0)

        For i = partLen To inputLen - 63 - 1 Step 64
            Call MD5Transform(Context.state, valInput, i)
        Next
        index = 0
    Else
        i = 0
    End If

    'Buffer remaining input
    'Context.buffer = valBuf()
    Call MD5_memcpy(Context.buffer, index, valInput, i, inputLen - i)
End Sub


'MD5 finalization. Ends an MD5 message-digest operation, writing the
'the message digest and zeroizing the context.
Private Sub MD5Final(ByRef digest As Variant, ByRef Context As Context)
    Dim bits(7) As Byte
    Dim index As Byte
    Dim padLen As Byte
    Dim i As Byte

    Call Encode(bits, Context.count, 8)
    index = fncRightShift(Context.count(0), 3) And &H3F
    If index < 56 Then
        padLen = 56 - index
    Else
        padLen = 120 - index
    End If
    

    Call MD5Update(Context, Me.PADDING, padLen)
    Call MD5Update(Context, bits, 8)
    Call Encode(digest, Context.state, 16)
End Sub


'MD5 basic transformation. Transforms state based on block.
Private Sub MD5Transform(ByRef state As Variant, ByRef block As Variant, ByVal offset As Long)
    Dim a As Long
    Dim b As Long
    Dim c As Long
    Dim d As Long

    
    a = state(0)
    b = state(1)
    c = state(2)
    d = state(3)
    
    
    Dim x(15)
    Call Decode(x, block, offset, 64)


    ' Round 1
    Call FF(a, b, c, d, x(0), S11, &HD76AA478)  '  1
    Call FF(d, a, b, c, x(1), S12, &HE8C7B756)  '  2
    Call FF(c, d, a, b, x(2), S13, &H242070DB)  '  3
    Call FF(b, c, d, a, x(3), S14, &HC1BDCEEE)  '  4
    Call FF(a, b, c, d, x(4), S11, &HF57C0FAF)  '  5
    Call FF(d, a, b, c, x(5), S12, &H4787C62A)  '  6
    Call FF(c, d, a, b, x(6), S13, &HA8304613)  '  7
    Call FF(b, c, d, a, x(7), S14, &HFD469501)  '  8
    Call FF(a, b, c, d, x(8), S11, &H698098D8)  '  9
    Call FF(d, a, b, c, x(9), S12, &H8B44F7AF)  ' 10
    Call FF(c, d, a, b, x(10), S13, &HFFFF5BB1) ' 11
    Call FF(b, c, d, a, x(11), S14, &H895CD7BE) ' 12
    Call FF(a, b, c, d, x(12), S11, &H6B901122) ' 13
    Call FF(d, a, b, c, x(13), S12, &HFD987193) ' 14
    Call FF(c, d, a, b, x(14), S13, &HA679438E) ' 15
    Call FF(b, c, d, a, x(15), S14, &H49B40821) ' 16

    ' Round 2
    Call GG(a, b, c, d, x(1), S21, &HF61E2562)  ' 17
    Call GG(d, a, b, c, x(6), S22, &HC040B340)  ' 18
    Call GG(c, d, a, b, x(11), S23, &H265E5A51) ' 19
    Call GG(b, c, d, a, x(0), S24, &HE9B6C7AA)  ' 20
    Call GG(a, b, c, d, x(5), S21, &HD62F105D)  ' 21
    Call GG(d, a, b, c, x(10), S22, &H2441453)  ' 22
    Call GG(c, d, a, b, x(15), S23, &HD8A1E681) ' 23
    Call GG(b, c, d, a, x(4), S24, &HE7D3FBC8)  ' 24
    Call GG(a, b, c, d, x(9), S21, &H21E1CDE6)  ' 25
    Call GG(d, a, b, c, x(14), S22, &HC33707D6) ' 26
    Call GG(c, d, a, b, x(3), S23, &HF4D50D87)  ' 27
    Call GG(b, c, d, a, x(8), S24, &H455A14ED)  ' 28
    Call GG(a, b, c, d, x(13), S21, &HA9E3E905) ' 29
    Call GG(d, a, b, c, x(2), S22, &HFCEFA3F8)  ' 30
    Call GG(c, d, a, b, x(7), S23, &H676F02D9)  ' 31
    Call GG(b, c, d, a, x(12), S24, &H8D2A4C8A) ' 32

    ' Round 3
    Call HH(a, b, c, d, x(5), S31, &HFFFA3942)  ' 33
    Call HH(d, a, b, c, x(8), S32, &H8771F681)  ' 34
    Call HH(c, d, a, b, x(11), S33, &H6D9D6122) ' 35
    Call HH(b, c, d, a, x(14), S34, &HFDE5380C) ' 36
    Call HH(a, b, c, d, x(1), S31, &HA4BEEA44)  ' 37
    Call HH(d, a, b, c, x(4), S32, &H4BDECFA9)  ' 38
    Call HH(c, d, a, b, x(7), S33, &HF6BB4B60)  ' 39
    Call HH(b, c, d, a, x(10), S34, &HBEBFBC70) ' 40
    Call HH(a, b, c, d, x(13), S31, &H289B7EC6) ' 41
    Call HH(d, a, b, c, x(0), S32, &HEAA127FA)  ' 42
    Call HH(c, d, a, b, x(3), S33, &HD4EF3085)  ' 43
    Call HH(b, c, d, a, x(6), S34, &H4881D05)   ' 44
    Call HH(a, b, c, d, x(9), S31, &HD9D4D039)  ' 45
    Call HH(d, a, b, c, x(12), S32, &HE6DB99E5) ' 46
    Call HH(c, d, a, b, x(15), S33, &H1FA27CF8) ' 47
    Call HH(b, c, d, a, x(2), S34, &HC4AC5665)  ' 48

    ' Round 4
    Call II(a, b, c, d, x(0), S41, &HF4292244)  ' 49
    Call II(d, a, b, c, x(7), S42, &H432AFF97)  ' 50
    Call II(c, d, a, b, x(14), S43, &HAB9423A7) ' 51
    Call II(b, c, d, a, x(5), S44, &HFC93A039)  ' 52
    Call II(a, b, c, d, x(12), S41, &H655B59C3) ' 53
    Call II(d, a, b, c, x(3), S42, &H8F0CCC92)  ' 54
    Call II(c, d, a, b, x(10), S43, &HFFEFF47D) ' 55
    Call II(b, c, d, a, x(1), S44, &H85845DD1)  ' 56
    Call II(a, b, c, d, x(8), S41, &H6FA87E4F)  ' 57
    Call II(d, a, b, c, x(15), S42, &HFE2CE6E0) ' 58
    Call II(c, d, a, b, x(6), S43, &HA3014314)  ' 59
    Call II(b, c, d, a, x(13), S44, &H4E0811A1) ' 60
    Call II(a, b, c, d, x(4), S41, &HF7537E82)  ' 61
    Call II(d, a, b, c, x(11), S42, &HBD3AF235) ' 62
    Call II(c, d, a, b, x(2), S43, &H2AD7D2BB)  ' 63
    Call II(b, c, d, a, x(9), S44, &HEB86D391)  ' 64

    state(0) = fucAddBit(state(0), a)
    state(1) = fucAddBit(state(1), b)
    state(2) = fucAddBit(state(2), c)
    state(3) = fucAddBit(state(3), d)
    
End Sub


'Encodes input (UINT4) into output (unsigned char). Assumes len is
'a multiple of 4.
Private Sub Encode(ByRef output As Variant, ByRef valInput As Variant, ByVal valLen As Long)
    Dim i As Long
    Dim j As Long
    
    i = 0
    j = 0
    
    Do While j < valLen
        output(j) = valInput(i) And &HFF
        output(j + 1) = fncRightShift(valInput(i), 8) And &HFF
        output(j + 2) = fncRightShift(valInput(i), 16) And &HFF
        output(j + 3) = fncRightShift(valInput(i), 24) And &HFF
        i = i + 1
        j = j + 4
    Loop
End Sub


'Decodes input (unsigned char) into output (UINT4). Assumes len is
'a multiple of 4.
Private Sub Decode(ByRef output As Variant, ByRef valInput As Variant, ByVal inputPoint As Long, _
                   ByVal valLen As Long)
    Dim i As Long
    Dim j As Long
    Dim Buf As Long
          
    i = 0
    j = 0
    Buf = 0
    
    Do While j < valLen
        Buf = j + inputPoint
        output(i) = valInput(Buf) Or fncLeftShift(valInput(Buf + 1), 8) Or _
                    fncLeftShift(valInput(Buf + 2), 16) Or fncLeftShift(valInput(Buf + 3), 24)
        i = i + 1
        j = j + 4
    Loop
End Sub


'Note: Replace "for loop" with standard memcpy if possible.
Private Sub MD5_memcpy(ByRef output As Variant, ByVal outputPoint As Long, ByRef valInput As Variant, _
                       ByVal inputPoint As Long, ByVal valLen As Long)
    Dim i As Long
    For i = 0 To valLen - 1
        output(i + outputPoint) = valInput(i + inputPoint)
    Next
End Sub


Private Function MDPrint(ByRef digest As Variant) As String
    Dim Str As String
    Dim i As Integer
    
    For i = 0 To 16 - 1
        Str = Str & Right("00" & LCase(Hex(digest(i))), 2)
    Next
    
    MDPrint = Str
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|PADDING();
'@title     : [PADDING]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     :
'
'@return    : [PADDING]|fffd||8414||fffd|z|fffd||fffd|/Variant
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Get PADDING() As Variant()
    Dim valArray() As Variant
    valArray = Array( _
        &H80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, _
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, _
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 _
    )

    PADDING = valArray
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncLeftShift();
'@title     : |fffd||fffd||fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[<<]|fffd||255||3c2||fffd||fffd|A|fffd||fffd||fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Long
'             |fffd|V|fffd|t|fffd|g|fffd||fffd|/Byte
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fncLeftShift(ByVal val As Long, ByVal nBit As Byte) As Long
    Dim msb As Long
    Dim lsb As Long
    Dim tmp As Long
    
    If nBit = 0 Then
        msb = val
    Else
        lsb = 2 ^ (31 - nBit)
        tmp = val And (lsb - 1)
        msb = tmp * (2 ^ nBit)
        
        If val And lsb Then
            msb = msb Or &H80000000
        End If
    End If
    
    fncLeftShift = msb
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncRightShift();
'@title     : |fffd|E|fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[>>]|fffd||255||3c2||fffd||fffd|A|fffd|E|fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Long
'             |fffd|V|fffd|t|fffd|g|fffd||fffd|/Byte
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fncRightShift(ByVal val As Long, ByVal nBit As Byte) As Long
    Dim msb As Long
    Dim lsb As Long

    If nBit = 0 Then
        msb = val
    Else
        lsb = val And &H7FFFFFFF

        If nBit = 31 Then
            msb = 0
        Else
            msb = lsb \ (2 ^ nBit)
        End If
        
        If lsb <> val Then
            msb = msb Or (2 ^ (31 - nBit))
        End If
    End If
        
    fncRightShift = msb
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fucAddBit();
'@title     : |fffd|r|fffd|b|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[+=]|fffd||255||3c2||fffd||fffd|A|fffd|r|fffd|b|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Currency
'             |fffd|l/Currency
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fucAddBit(ByVal a As Currency, ByVal b As Currency) As Long
    Dim tmp As Currency
    
    tmp = a + b
    If tmp > &H7FFFFFFF Then
        tmp = tmp - (2 ^ 32)
    ElseIf tmp < &H80000000 Then
        tmp = tmp + (2 ^ 32)
    End If
    
    fucAddBit = CLng(tmp)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncSpritStr();
'@title     : |fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd||3ca||fffd||fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||255||fffd||fffd||fffd||fffd||fffd||fffd||3c9||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd||58a|i|fffd|[|fffd||fffd||fffd||fffd|B
'
'@param     :
'
'@return    :
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Sub fncSpritStr()
    Dim valByte() As Byte
    Dim valArray() As Byte
    Dim num As Variant
    Dim count As Long
    Dim ADODB As Object
    Set ADODB = CreateObject("ADODB.Stream")

    If Me.Text = "" Then
        Me.StrByte = valArray
        Me.StrLen = 0
    Else
        ADODB.Open
        ADODB.Type = 2
        ADODB.Charset = Me.Charset
        ADODB.WriteText Me.Text
        ADODB.Position = 0
        ADODB.Type = 1
        
        If Me.Charset = "UNICODE" Then
            ADODB.Position = 2
            valByte = ADODB.Read
            
            count = 0
            For Each num In valByte
                If Not num = 0 Then
                    ReDim Preserve valArray(count)
                    valArray(count) = num
                    count = count + 1
                End If
            Next num

        ElseIf Me.Charset = "SHIFT-JIS" Then
            ADODB.Position = 0
            valArray = ADODB.Read
        
        ElseIf Me.Charset = "UTF-8" Then
            ADODB.Position = 3
            valArray = ADODB.Read
            
        End If

        ADODB.Close
        Me.StrByte = valArray
        Me.StrLen = UBound(valArray) + 1
    End If
End Sub


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncSpritFile();
'@title     : |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd||58a|i|fffd|[|fffd||fffd||fffd||fffd|B
'             |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||34b||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     :
'
'@return    :
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Sub fncSpritFile()
    Dim valByte() As Byte
    Dim valArray() As Byte
    Dim inputFn As Long
    Dim num As Variant
    Dim count As Long


    If Dir(Me.FilePath) = "" Then
        Me.StrByte = valArray
        Me.StrLen = 0
    Else
        inputFn = FreeFile
        Open Me.FilePath For Binary As #inputFn
            ReDim valArray(LOF(inputFn))
            Get #inputFn, , valArray
        Close #inputFn

        If UBound(valArray) = 0 Then
            Me.StrLen = 0
        Else
            ReDim Preserve valArray(UBound(valArray) - 1)
            Me.StrLen = UBound(valArray) + 1
        End If
        Me.StrByte = valArray

    End If
End Sub


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|TextHash();
'@title     : |fffd||fffd||fffd||fffd||fffd||fffd||fffd|MD|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||8576||fffd||fffd||fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|B
'
'@param     :
'
'@return    : |fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Function TextHash() As String
    Dim Context As Context
    Dim digest(15) As Variant
    
    fncSpritStr

    Call MD5Init(Context)
    Call MD5Update(Context, Me.StrByte, Me.StrLen)
    Call MD5Final(digest, Context)

    TextHash = MDPrint(digest)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|FileHash();
'@title     : |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|MD|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||741|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|B
'             |fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||341|A|fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'             [d41d8cd98f00b204e9800998ecf8427e]
'
'@param     :
'
'@return    : |fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Function FileHash() As String
    Dim Context As Context
    Dim digest(15) As Variant
    
    fncSpritFile

    Call MD5Init(Context)
    Call MD5Update(Context, Me.StrByte, Me.StrLen)
    Call MD5Final(digest, Context)

    FileHash = MDPrint(digest)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|Charset();
'@title     : [Charset]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [Charset]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'
'@return    : [Charset]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let Charset(ByVal value As String)
    mvarCharset = UCase(value)
End Property
Public Property Get Charset() As String
    Charset = mvarCharset
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|Text();
'@title     : [Text]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [Text]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'
'@return    : [Text]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let Text(ByVal value As String)
    mvarText = value
End Property
Public Property Get Text() As String
    Text = mvarText
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|FilePath();
'@title     : [FilePath]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [FilePath]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X/String
'
'@return    : [FilePath]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let FilePath(ByVal value As String)
    mvarFilePath = value
End Property
Public Property Get FilePath() As String
    FilePath = mvarFilePath
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|StrByte();
'@title     : [StrByte]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [StrByte]|fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd|/Byte
'
'@return    : [StrByte]|fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd|/Byte
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let StrByte(ByRef value() As Byte)
    mvarStrByte = value
End Property
Public Property Get StrByte() As Byte()
    StrByte = mvarStrByte
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|StrLen();
'@title     : [StrLen]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [StrLen]|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y/Long
'
'@return    : [StrLen]|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let StrLen(ByVal value As Long)
    mvarStrLen = value
End Property
Public Property Get StrLen() As Long
    StrLen = mvarStrLen
End Property



Attribute VB_Name = "Module1"
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd||a287||fffd||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim ClickPostJudge As String

'*************************************************************
Application.Run "|fffd|e|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd|"
'|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||835e||fffd||782||fffd||fffd||1c2||fffd||fffd||fffd|
If Sheets("Config").Cells(28, 2) = "ON" Then
    Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||742||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"
End If


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||34f||fffd||24e||fffd||835e||fffd||fffd|
Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||742||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||451||582||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O"

'|fffd||38f||6ca|OSKU|fffd||30f||fffd||fffd|O
If Sheets("Config").Cells(67, 2) = "ON" Then
    Application.StatusBar = "|fffd||38f||6ca|OSKU|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd|O"
End If

'|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|
Dim CrepoX As Long
    CrepoX = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
    If CrepoX < 2 Then
        MsgBox "|fffd|o|fffd||5d1||38f||6cc||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||308||5c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf & _
                "|fffd||fffd||fffd|u|fffd|O|fffd||fffd||fffd||195||fffd||fffd||30f||fffd||fffd|O|fffd|F|fffd||fffd||fffd||fffd||fffd|v|fffd||30f||a347||fffd||fffd||fffd||fffd|" & vbLf & _
                "  |fffd||fffd||fffd||fffd|~|fffd|X|fffd||202||1c2||142||fffd||84bc||fffd||fffd||fffd||202||1c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|2|fffd|x|fffd|g|fffd||fffd||fffd||fffd|" & vbLf & _
                "  |fffd||4d0|}|fffd||fffd||fffd||fffd||fffd||38f||6d6||fffd||fffd||fffd||fffd||242||202||fffd||702||fffd||fffd|B" & vbLf & vbLf & _
                "  |fffd||fffd||fffd||30f||a347||fffd||341|A|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||102||fffd||84bc||fffd||fffd||fffd||fffd||fffd|A" & vbLf & _
                "  |fffd|O|fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||84ee||fffd||153||fffd||fffd||342||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbLf & _
                "|fffd|@|fffd|u|fffd|O|fffd||fffd||fffd||195||fffd||fffd||30f||fffd||fffd|O|fffd|F|fffd||84ee||fffd|v|fffd||242||fffd||fffd||10e||84ee||fffd||152||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||48f|W|fffd||fffd||fffd||fffd||202||1c2||fffd||fffd||10e|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End
    End If

ClickPostReStart:
'|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|f|fffd|[|fffd|^|fffd||12355||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd|V|fffd|[|fffd|g|fffd||256||7c2||fffd||fffd||10d||10e||fffd||fffd|s
If ClickPostJudge = "|fffd||38f||fffd|" Or ClickPostJudge = "|fffd||fffd||fffd||5c2||111||38f||fffd|" Then
    Application.Run "|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
    ClickPostJudge = "|fffd||fffd||fffd||fffd|"
    Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd|
If Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" And ClickPostJudge <> "|fffd||fffd||fffd||fffd|" Then
    '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd||5c2||fffd|
    ClickPostJudge = CheckCP()
    
    If ClickPostJudge = "|fffd||fffd||fffd||5c2||111||38f||fffd|" Then
        MsgBox "|fffd||fffd||fffd||5c2||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||38f||6c2||30f|o|fffd||5c2||202||302||141|A|fffd|P|fffd||fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
        GoTo ClickPostReStart
    Else
        If ClickPostJudge = "|fffd||38f||fffd|" Then
            MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||38f||6c2||30f|o|fffd||5c2||fffd||fffd||fffd||fffd||fffd||302||141|A|fffd|Q|fffd||fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
        End If
    End If
    '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||395||282||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|V|fffd|[|fffd|g|fffd||248||682||fffd|
        '|fffd||fffd||fffd||295||3d0||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
End If



'**************************************************************

'|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||34f||fffd||24f|o|fffd||fffd|
Application.StatusBar = "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||30d||c42c|/|fffd|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||303|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd|F|fffd|t"
    Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd|"

'**************************************************************

'|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd|
'If Sheets("Config").Cells(16, 2) = "ON" Then
    If Sheets("TOP").Cells(5, 9) <> "DM|fffd||fffd|" And Sheets("TOP").Cells(5, 9) <> "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Application.StatusBar = "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
        If Sheets("Config").Cells(18, 2) = "|fffd||fffd||fffd||fffd|" Then
            Application.Run "|fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
        Else
            Application.Run "|fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
        End If
    End If
'End If

'**************************************************************

'|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd|
If Sheets("Config").Cells(31, 2) = "ON" Then
Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p"
End If

'**************************************************************

'|fffd|o|fffd||5d2||292|m|fffd||fffd||fffd||1c2||30c|`|fffd||fffd||fffd||14d||c42c||fffd||fffd||fffd||90a9|
If Sheets("TOP").Cells(5, 9) = "DM|fffd||fffd|" Then
    Application.StatusBar = "|fffd||fffd||fffd|}|fffd|gDM|fffd||582||fffd|B2|fffd|pCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "DM|fffd||597|p|fffd||fffd|CSV|fffd||c42c|"
Else
    Application.StatusBar = "|fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    If Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Application.Run "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd|o|fffd||fffd|"
        MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||308||a287||fffd|o|fffd|^|fffd|pCSV|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||102||fffd||fffd||fffd||702||fffd||fffd||302||141|A" & vbLf _
                    & "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|T|fffd|C|fffd|g|fffd||148||a287||fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||3c1||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|" & vbLf _
                    & "|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||252||1d0||554||50d||fffd||fffd||313||fffd||fffd||342||fffd||fffd|s|fffd||fffd||fffd||10f|o|fffd||5d2||292|m|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|" & vbLf & vbLf _
                    & "|fffd||fffd|40|fffd||fffd||fffd||12d02||fffd||fffd||fffd||a347||fffd||242||fffd|40|fffd||fffd||fffd||fffd||fffd||182||255||fffd||fffd||fffd||fffd||fffd||fffd||10f|o|fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
    End If
    Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||18f|o|fffd||fffd|"
End If



If Sheets("Picking").Cells(Rows.count, 12).End(xlUp).Row > 3 And Sheets("TOP").Cells(5, 9) <> "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
Dim rc As Long
    rc = MsgBox("|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd|g|fffd|p|fffd|i|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||fffd||fffd||702||702||fffd||102||fffd||a347||fffd||302||741|j|fffd||fffd||fffd|m|fffd||80b5||fffd||fffd|OK|fffd|H" & vbLf & "|fffd||fffd||fffd||70a9||fffd||317||fffd||fffd|R|fffd||142||fffd||84bc||fffd||fffd||fffd||a347||fffd||341|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbYesNo + vbQuestion)
    If rc = "6" Then
        Sheets("TOP").Cells(43, 2) = Sheets("TOP").Cells(44, 2)
    Else
        MsgBox "|fffd|c|fffd|[|fffd||fffd||fffd||fffd||312||1d0||554||50d||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||fffd||24d||fffd||fffd||55a82||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||302||141|A|fffd||508||fffd||fffd||fffd||101|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||a347||fffd||242||341|A|fffd||20d|~|fffd||154||50d||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||60a4||fffd||252||fffd||fffd||4c2||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||84ee||fffd||154||50d||fffd||fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd||202||1c1|j"
    End If
End If

'|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Sheets("Config").Cells(120, 2) = "ON" Then
    Application.Run "|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24e||fffd||fffd||6d7||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If

If Sheets("MailConfig").Cells(13, 2) = "ON" Or Sheets("MailConfig").Cells(18, 2) = "ON" Then
'|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|
    rc = MsgBox("|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|OK|fffd|H" & vbLf & "|fffd||fffd||fffd|M|fffd|J|fffd|n|fffd||253||fffd||fffd||fffd||182||fffd||fffd||382||70ad||fffd||fffd||fffd||c0aa||fffd|o|fffd||fffd||fffd||202||fffd||fffd||202||fffd||702||fffd||fffd||302||141|A|fffd||fffd||fffd||202||fffd||fffd|^|fffd|C|fffd|~|fffd||fffd||fffd|O|fffd||141|u|fffd||342||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd||fffd||fffd||fffd||508||10a2||fffd||202||1c2||142||fffd||84bc||fffd||fffd||fffd||a347||fffd||341|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbYesNo + vbQuestion)
    If rc = "6" Then
        Application.Run "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|"
    End If
End If
'****************************************************************

If ClickPostJudge = "|fffd||38f||fffd|" Then
    MsgBox "|fffd||fffd||fffd||fffd||fffd||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B"
    GoTo ClickPostReStart
End If
If ClickPostJudge = "|fffd||fffd||fffd||fffd|" Then
    Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
End If

If Sheets("Config").Cells(44, 2) = "|fffd||fffd||fffd||fffd|" Then
    MsgBox "|fffd||fffd||fffd||5c2||102||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd||fffd||fffd|o|fffd||5d2||292|m|fffd||311||fffd||fffd|M|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||242||34e||84ee||fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
Else
    MsgBox "|fffd||fffd||fffd||5c2||102||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||fffd||6c2||30d||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||18f|o|fffd||5d2||292|m|fffd||303|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||5cd||fffd||18a||fffd||fffd||fffd||fffd||142||fffd||fffd|B"
End If
End Sub

Function CheckCP()

    
Dim a As Long
Dim Ini() As String

Dim ExistNum As Long
    If Sheets("Config").Cells(135, 2) = "ON" Then
        For a = 138 To 150
            If Sheets("Config").Cells(a, 2) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
                ReDim Preserve Ini(ExistNum)
                Ini(ExistNum) = Sheets("Config").Cells(a, 1)
                ExistNum = ExistNum + 1
            End If
        DoEvents
        Next
    End If
Dim AutoSend As String
    If Sheets("Config").Cells(153, 2) = "ON" Then
        AutoSend = Sheets("Config").Cells(155, 2)
    End If
    '|fffd||38f||6c2||fffd||fffd||202||fffd||fffd||fffd||394||fffd||fffd||fffd||fffd||fffd|
    If ExistNum = 0 And AutoSend <> "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Exit Function
    End If

Dim CrepoX As Long
    CrepoX = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
Dim TotalCount As Long
    TotalCount = CrepoX - 1
Dim b As Long
Dim c As Long
Dim SKU As String
Dim TargetNum As Long
Dim CpX As Long
    CpX = Sheets("ChumonReport-CP").Cells(Rows.count, 1).End(xlUp).Row
    '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|
    If CpX > 1 Then
            Sheets("ChumonReport-CP").Rows("2:" & CpX).Delete
    End If
    
'|fffd||38f||6d7||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||93c8||fffd||fffd|
Dim SkuCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
        SkuCol = Sheets("ChumonReport").Rows(1).Find("sku").Column
    Else
        SkuCol = 8
    End If
    
Dim ItemPriceCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
        ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price").Column
    Else
        ItemPriceCol = 12
    End If

Dim SendPriceCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
        SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price").Column
    Else
        SendPriceCol = 14
    End If


Dim ItemPrice As Long
Dim SendPrice As Long
Dim JudgePrice As Long
    JudgePrice = Sheets("Config").Cells(154, 2)

Dim CheckIni As String
Dim d As Long

Dim CpCount As Long

    For b = 2 To CrepoX
        If b > CrepoX Then
            Exit For
        End If
        SKU = Sheets("ChumonReport").Cells(b, SkuCol)
        
        'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||30b|L|fffd||682||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd|OFF|fffd||202||fffd||fffd|
        If Sheets("Config").Cells(135, 2) = "OFF" Then
            GoTo PriceCheck
        End If
        
        '|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||62f||fffd||fffd||7fd||102||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd|
        For c = 0 To ExistNum - 1
            If Left(SKU, Len(Ini(c))) = Ini(c) Then
                CpX = Sheets("ChumonReport-CP").Cells(Rows.count, 1).End(xlUp).Row + 1
                Sheets("ChumonReport").Rows(b) _
                    .Copy Destination:= _
                Sheets("ChumonReport-CP").Rows(CpX)
                Sheets("ChumonReport").Rows(b).Delete
                CrepoX = CrepoX - 1
                b = b - 1
                CheckCP = "|fffd||38f||fffd|"
                CpCount = CpCount + 1
                GoTo PriceCP
            End If
        DoEvents
        Next
        
        '|fffd||fffd||fffd||fffd|SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||250||752||80b3||fffd||fffd||102||202||fffd||fffd||fffd||38d||fffd||fffd|z|fffd||fffd||fffd|i|fffd||fffd||fffd|f
        If AutoSend = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
            For d = 138 To 150
                CheckIni = Sheets("Config").Cells(d, 1)
                If CheckIni = "" Then
                    GoTo PriceCheck
                End If
                If Left(SKU, Len(CheckIni)) = CheckIni Then
                    GoTo PriceCP
                End If
            DoEvents
            Next
        End If
PriceCheck:
        
        If Sheets("Config").Cells(153, 2) = "ON" And Sheets("Config").Cells(155, 2) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
                '|fffd||1c2||fffd||242||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||116||fffd||fffd||fffd||fffd||fffd||38d||fffd||fffd|z|fffd||fffd||fffd|i|fffd||314||fffd||fffd||fffd||253||fffd||fffd||fffd|
                ItemPrice = Sheets("ChumonReport").Cells(b, ItemPriceCol)
                SendPrice = Sheets("ChumonReport").Cells(b, SendPriceCol)
                If AutoSend = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" _
                And ItemPrice + SendPrice >= JudgePrice Then
                    CpX = Sheets("ChumonReport-CP").Cells(Rows.count, 1).End(xlUp).Row + 1
                    Sheets("ChumonReport").Rows(b) _
                        .Copy Destination:= _
                    Sheets("ChumonReport-CP").Rows(CpX)
                    Sheets("ChumonReport").Rows(b).Delete
                    CrepoX = CrepoX - 1
                    b = b - 1
                    CheckCP = "|fffd||38f||fffd|"
                    CpCount = CpCount + 1
                    GoTo PriceCP
                End If
        End If
        
PriceCP:
    DoEvents
    Next

    
    If CpCount > 0 Then
        CheckCP = "|fffd||38f||fffd|"
    End If
    
'|fffd|S|fffd||102||fffd||fffd||62f||fffd||fffd||7fd||102||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If CpCount = TotalCount Then
        CheckCP = "|fffd||fffd||fffd||5c2||111||38f||fffd|"
    End If

End Function

Sub |fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|()

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport-CP").Cells(Rows.count, 1).End(xlUp).Row
    If LastIndex > 1 Then
                Sheets("ChumonReport-CP").Columns("A:AC") _
                    .Copy Destination:= _
                Sheets("ChumonReport").Columns("A:AC")
                Sheets("ChumonReport-CP").Rows("2:" & LastIndex).Delete
    Else
        MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||38f||6c2||fffd||fffd||fffd||fffd||fffd||fffd||302||14f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
        End
    
    End If
End Sub

Sub |fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd|P|fffd||30e||fffd||fffd|s()

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        ChangeJudge = "|fffd||38f||fffd|"
    End If

    '|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If Sheets("Config").Cells(120, 2) = "ON" Then
        Application.Run "|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24e||fffd||fffd||6d7||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        If ChangeJudge = "|fffd||38f||fffd|" Then
            MsgBox "|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||582||30b|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & vbLf _
                    & "|fffd||fffd||fffd||fffd||fffd||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||248||682||fffd||302||141|A" _
                    & "Step2 |fffd||303|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End If
    Else
        If ChangeJudge = "|fffd||38f||fffd|" Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||750||752||80aa|OFF|fffd||308||5c1|A|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||582||30b|L|fffd||fffd||fffd||34d|s|fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf _
                    & "|fffd||fffd||fffd||fffd||fffd||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||248||682||fffd||302||141|A" _
                    & "Step2 |fffd||303|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        Else
            If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
                MsgBox "|fffd|S|fffd||102||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Else
                MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||750||752||80aa|OFF|fffd||308||5c1|A|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd||fffd|B"
            End If
        End If
    End If
    
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
        End
    End If
    
    If ChangeJudge = "|fffd||38f||fffd|" Then
        Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
        Application.Run "|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
    End If
End Sub



Sub |fffd|e|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd|()
Dim BeforePath As String
    BeforePath = ThisWorkbook.Path
Dim i As Long
    For i = 1 To Len(BeforePath)
        If Left(Right(BeforePath, i), 1) = "\" Then
            BeforePath = Left(BeforePath, Len(BeforePath) - i)
            Exit For
        End If
    Next
Sheets("Config").Cells(36, 2) = BeforePath & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g.txt"
Sheets("Config").Cells(38, 2) = BeforePath & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g.txt"
Sheets("Config").Cells(43, 2) = ActiveWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|o|fffd||5d2||292|m"
Sheets("Config").Cells(126, 2) = ActiveWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|O|fffd||fffd||fffd|A|fffd|gCSV"

End Sub


Sub |fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24e||fffd||fffd||6d7||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
'|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24e||fffd||fffd||6d1||fffd||fffd||fffd||fffd||18e||fffd||fffd||6d7||fffd||fffd|v|fffd||193|_|fffd||fffd||fffd||fffd||fffd|L|fffd||682||fffd||fffd||fffd|
Dim rc As Long

    rc = MsgBox("|fffd||fffd||fffd||fffd||fffd||197||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24b|L|fffd||682||fffd||fffd||702||fffd||fffd||fffd||fffd|H" & vbLf & "|fffd|L|fffd||682||fffd||fffd||202||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34e||84ee||fffd||14b|L|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbYesNo + vbQuestion)
    
    Dim RealSendPrice As String
    Dim PickingX As Long
    Dim ItemCount As Long
    Dim TotalBuyPrice As Long
    Dim TotalProfit As Long
    Dim SendPriceJudge As String
    Dim SendMethod As String
    Dim SendPrice As Long
    Dim ItemNumber As Long
    Dim IdeaSendPrice As Long
    
    If rc = "6" Then
        '|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||15dc2||fffd|
        RealSendPrice = InputBox("|fffd||fffd||fffd||6c2||311||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||302||741|i|fffd||fffd||fffd||fffd||fffd||342||253c||fffd|p|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||30f||a347||fffd|z|fffd||8457||fffd||fffd||fffd||fffd||fffd||317|p|fffd|j")
        If RealSendPrice = Empty Or IsNumeric(RealSendPrice) = False Then
            SendPriceJudge = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        PickingX = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row
        '|fffd||fffd||fffd||6d7||fffd||fffd|v|fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|--------------------------------------------------
        For w = 4 To PickingX
            '|fffd||fffd||fffd||fffd||fffd||fffd|
            If Sheets("Picking").Cells(w, 5) <> "" Then
                ItemNumber = Sheets("Picking").Cells(w, 5)
            Else
                ItemNumber = 1
            End If
            ItemCount = ItemCount + ItemNumber
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|
            SendMethod = Sheets("Picking").Cells(w, 11)
            If SendMethod = "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|" Then
                SendPrice = Sheets("Config").Cells(159, 3)
            Else
                SendPrice = Application.WorksheetFunction.VLookup(SendMethod, Sheets("Config").Range("A159:C164"), 3, False)
            End If
            IdeaSendPrice = IdeaSendPrice + ItemNumber * SendPrice
        DoEvents
        Next
        '---------------------------------------------------------------------
        '|fffd||fffd||fffd|v|fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|
        TotalProfit = Sheets("Picking").Cells(2, 10)
        '|fffd||fffd||fffd||fffd||fffd||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        If SendPriceJudge = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            RealSendPrice = IdeaSendPrice
            TotalProfit = Sheets("Picking").Cells(2, 10)
        Else
            TotalProfit = TotalProfit + (IdeaSendPrice - RealSendPrice)
        End If
        '|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd|l
        TotalBuyPrice = Sheets("Picking").Cells(2, 7)
        '----------------------------------------------------------------------
        '|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||24b|L|fffd||fffd||fffd|i|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||6d7||fffd||fffd|v|fffd|j
        Dim MyBook As Workbook
            Set MyBook = ThisWorkbook
            
        Dim TargetName As String
            TargetName = Format(Now(), "YYYY") & "|fffd|N|fffd|x|fffd||fffd||fffd||1c2||fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\.xlsm"
            
        Dim MyFilePath As String
            MyFilePath = ThisWorkbook.Path
        
        Dim TargetPath As String
            TargetPath = MyFilePath
            For i = 2 To 100
                If Left(Right(MyFilePath, i), 1) = "\" Then
                    TargetPath = Left(MyFilePath, Len(MyFilePath) - i) & "\|fffd||fffd||fffd||1c2||fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\\" & TargetName
                    Exit For
                End If
            DoEvents
            Next
        
        Dim TargetSheetName As String
            TargetSheetName = Format(Now(), "M") & "|fffd||fffd|"
            
        '|fffd||fffd||fffd|v|fffd||1d7||fffd||fffd|\|fffd||24b|L|fffd||fffd|------------------------------------------------------------------
            Application.ScreenUpdating = False
            Workbooks.Open TargetPath
        
        Dim TargetRow As Long
            TargetRow = Format(Now(), "D") + 5
            
            Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 11) _
             = Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 11) + RealSendPrice
            'Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 11) _
             = Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 11) + TotalProfit
            'Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 12) _
             = Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 12) + TotalBuyPrice
            'Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 13) _
             = Workbooks(TargetName).Sheets(TargetSheetName).Cells(TargetRow, 13) + ItemCount
            
            Application.DisplayAlerts = False
            Workbooks(TargetName).Save
            Application.DisplayAlerts = False
            Workbooks(TargetName).Close
            Application.ScreenUpdating = True
        
        MsgBox "|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||582||30f||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    End If

End Sub



Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|e|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||fffd|()


Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim Res

If Sheets("TOP").Cells(14, 12) <> "|fffd||28f||fffd|" Then
    Res = MsgBox("|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||182||30d||fffd||fffd||74f||fffd||fffd||fffd||fffd||313|r|fffd||fffd||fffd||143||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||743|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf _
            & "|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||742||fffd||fffd||fffd||fffd||84bc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|A" & vbLf _
            & "|fffd||fffd||fffd||fffd||103|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||242||341|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKCancel)
    If Res = vbCancel Then
        Exit Sub
    Else
        Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
    End If
End If

Application.Run "|fffd|e|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd|"
If Sheets("Config").Cells(31, 2) = "ON" Then
    Application.Run "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"
End If



Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"

Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||451||582||fffd|"

Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O"


If Sheets("Config").Cells(67, 2) = "ON" Then
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd|O"
End If

'|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|
Dim CrepoX As Long
    CrepoX = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
    If CrepoX < 2 Then
        MsgBox "|fffd|o|fffd||5d1||38f||6cc||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||308||5c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf & _
                "|fffd||fffd||fffd|u|fffd|O|fffd||fffd||fffd||195||fffd||fffd||30f||fffd||fffd|O|fffd|F|fffd||fffd||fffd||fffd||fffd|v|fffd||30f||a347||fffd||fffd||fffd||fffd|" & vbLf & _
                "  |fffd||fffd||fffd||fffd|~|fffd|X|fffd||202||1c2||142||fffd||84bc||fffd||fffd||fffd||202||1c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|2|fffd|x|fffd|g|fffd||fffd||fffd||fffd|" & vbLf & _
                "  |fffd||4d0|}|fffd||fffd||fffd||fffd||fffd||38f||6d6||fffd||fffd||fffd||fffd||242||202||fffd||702||fffd||fffd|B" & vbLf & vbLf & _
                "  |fffd||fffd||fffd||30f||a347||fffd||341|A|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||102||fffd||84bc||fffd||fffd||fffd||fffd||fffd|A" & vbLf & _
                "  |fffd|O|fffd||fffd||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||84ee||fffd||153||fffd||fffd||342||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbLf & _
                "|fffd|@|fffd|u|fffd|O|fffd||fffd||fffd||195||fffd||fffd||30f||fffd||fffd|O|fffd|F|fffd||84ee||fffd|v|fffd||242||fffd||fffd||10e||84ee||fffd||152||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||48f|W|fffd||fffd||fffd||fffd||202||1c2||fffd||fffd||10e|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End
    End If


Dim CPJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        GoTo Skip
    End If
    
    If Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        CPJudge = CheckCP()
        If CPJudge = "|fffd||38f||fffd|" Then
                Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O"
                MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||38f||6c2||30f|o|fffd||5c2||18d||fffd||fffd||742||fffd||fffd||102||fffd||fffd||fffd||302||141|A|fffd||fffd||243|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf _
                        & "|fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||582||30b|L|fffd||fffd||fffd||702||14f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||308||fffd||fffd||fffd||fffd||fffd||fffd||113|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & vbLf _
                        & "|fffd|@|fffd||fffd||fffd||fffd||fffd|v|fffd|m|fffd|F|fffd|\|fffd||582||30b|L|fffd||fffd|OFF|fffd||30f||a347||fffd||142||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
                End
        Else
            If CPJudge = "|fffd||fffd||fffd||5c2||111||38f||fffd|" Then
                Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
                MsgBox "|fffd||fffd||fffd||5c2||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||38f||6c2||30f|o|fffd||5c2||142||fffd||fffd|B" & vbLf & vbLf _
                        & "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd||fffd|`|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||702||142|P|fffd||fffd||fffd||fffd||fffd||fffd|OK|fffd||142||fffd||fffd|B"
                Application.Run "|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
                End
            Else
                Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
                MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||311||38f||6c2||182||202||fffd|o|fffd||5c2||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf _
                        & "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd||fffd|`|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||702||142|P|fffd||fffd||fffd||fffd||fffd||fffd|OK|fffd||142||fffd||fffd|B"
            End If
        End If
    Else
        MsgBox "|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||74a||fffd||fffd||fffd|"
    End If
Skip:


End Sub


Sub |fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd||c42c||fffd||fffd||fffd||108||fffd||fffd||fffd|{|fffd|^|fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
        ChangeJudge = "|fffd||38f||fffd|"
    End If
    

Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o"

Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||303|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd|F|fffd|t"

Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd|"

    If ChangeJudge = "|fffd||38f||fffd|" Then
        Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If

MsgBox "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||308||fffd||fffd||fffd|w|fffd||fffd||fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

End Sub



Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p()



Dim LabelMode As String
    LabelMode = Sheets("Config").Cells(19, 2)
Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(18, 2)
    
If LabelMode = "10|fffd||fffd|" Then
    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||14f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||14f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If
Else
    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||153||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||153||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If
End If



End Sub


Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p()


Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(30, 2)
    

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If
    

End Sub





Sub |fffd||a287||fffd||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
Application.Run "|fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||835e||fffd||fffd||155||fffd||fffd||451||582||fffd|"

Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||312||fffd||fffd|o|fffd||188||fffd||fffd|"

If Sheets("Config").Cells(16, 2) = "ON" Then
    Application.Run "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p"
End If

If Sheets("Config").Cells(31, 2) = "ON" Then
    Application.Run "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p"
End If

Application.Run "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||18f|o|fffd||fffd|"

End Sub



Sub |fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||835e||fffd||fffd||155||fffd||fffd||451||582||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
Application.Run "|fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"
Application.Run "|fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||451||582||fffd|"

If Sheets("Config").Cells(67, 2) = "ON" Then
    Application.Run "SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd|O"
End If

End Sub


Sub |fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||312||fffd||fffd|o|fffd||188||fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o"
Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||30c|r|fffd||fffd||fffd||190|F|fffd|t"
Application.Run "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd|"
End Sub
Sub |fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p()

Dim LabelMode As String
    LabelMode = Sheets("Config").Cells(19, 2)
Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(18, 2)
    
If LabelMode = "10|fffd||fffd|" Then
    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If
Else
    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If
End If


End Sub

Sub |fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||308||a287||fffd||fffd||fffd|s|fffd|p()


Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(30, 2)
    

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If


End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||312|P|fffd||30e||fffd||fffd|s()
If Sheets("Config").Cells(16, 2) = "OFF" Then
    MsgBox "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd|OFF|fffd||752||fffd||242||202||fffd||fffd||102||fffd||fffd||fffd||302||149||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
    End
End If

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
        ChangeJudge = "|fffd||38f||fffd|"
    End If

Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
Dim LabelMode As String
    LabelMode = Sheets("Config").Cells(19, 2)
Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(18, 2)
    

    If Sheets("Config").Cells(45, 2) = "DM|fffd||fffd|" Or Sheets("Config").Cells(45, 2) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        MsgBox "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||38f||6ca|O|fffd||314|z|fffd||fffd||fffd||fffd||fffd|@|fffd||142||fffd||fffd|B"
        If ChangeJudge = "|fffd||38f||fffd|" Then
            Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        Exit Sub
    End If

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If

If ChangeJudge = "|fffd||38f||fffd|" Then
    Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If

MsgBox "|fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||311||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

End Sub

Sub |fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||312|P|fffd||30e||fffd||fffd|s()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(18, 2)
    

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|"
    Else
        Application.Run "|fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|"
    End If


End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||312|P|fffd||30e||fffd||fffd|s()
If Sheets("Config").Cells(31, 2) = "OFF" Then
    MsgBox "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|OFF|fffd||752||fffd||202||302||149||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
    End
End If
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
        ChangeJudge = "|fffd||38f||fffd|"
    End If

Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(30, 2)
    

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|"
    Else
        Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|"
    End If
    
If ChangeJudge = "|fffd||38f||fffd|" Then
    Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If

    MsgBox "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd|w|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End Sub

Sub |fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||312|P|fffd||30e||fffd||fffd|s()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim PrintMethod As String
    PrintMethod = Sheets("Config").Cells(30, 2)
    

    If PrintMethod = "|fffd||fffd||fffd||fffd|" Then
        Application.Run "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|"
    Else
        Application.Run "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|"
    End If


End Sub


Sub |fffd|o|fffd||5d2||292|m|fffd|P|fffd||30e||fffd||fffd|s()

Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd||c42c||fffd||188||fffd||fffd||fffd|s|fffd|v|fffd||74c||24d||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||fffd|"

MsgBox "|fffd|o|fffd||5d2||292|m|fffd||30f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

End Sub


Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd||c42c||fffd||188||fffd||fffd||fffd|s|fffd|v|fffd||74c||24d||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
        ChangeJudge = "|fffd||38f||fffd|"
    End If

'|fffd|o|fffd||5d2||292|m|fffd||fffd||fffd||1c2||30c|`|fffd||fffd||fffd||14d||c42c||fffd||fffd||fffd||90a9|
If Sheets("TOP").Cells(5, 9) = "DM|fffd||fffd|" Then
Application.StatusBar = "|fffd||fffd||fffd|}|fffd|gDM|fffd||582||fffd|B2|fffd|pCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Application.Run "DM|fffd||597|p|fffd||fffd|CSV|fffd||c42c|"
Else
Application.StatusBar = "|fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    If Sheets("TOP").Cells(5, 9) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Application.Run "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd|o|fffd||fffd|"
        'If Sheets("Config").Cells(45, 3) = "|fffd||fffd||fffd||fffd|" Then
            MsgBox "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||308||a287||fffd|o|fffd|^|fffd|pCSV|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||102||fffd||fffd||fffd||702||fffd||fffd||302||141|A" & vbLf _
                    & "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|T|fffd|C|fffd|g|fffd||148||a287||fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||3c1||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|" & vbLf _
                    & "|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||252||1d0||554||50d||fffd||fffd||313||fffd||fffd||342||fffd||fffd|s|fffd||fffd||fffd||10f|o|fffd||5d2||292|m|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|" & vbLf & vbLf _
                    & "|fffd||fffd|40|fffd||fffd||fffd||12d02||fffd||fffd||fffd||a347||fffd||242||fffd|40|fffd||fffd||fffd||fffd||fffd||182||255||fffd||fffd||fffd||fffd||fffd||fffd||10f|o|fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        'End If
    End If
    Application.Run "|fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||18f|o|fffd||fffd|"
End If

If ChangeJudge = "|fffd||38f||fffd|" Then
    Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If

'|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|OFF|fffd||14d||fffd||fffd||74f||fffd||fffd||fffd||fffd||202||fffd||202||70b1||fffd||fffd||fffd||143|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||250||602||fffd||582||fffd||fffd||fffd|
If Sheets("MailConfig").Cells(13, 2) = "OFF" And Sheets("MailConfig").Cells(18, 2) = "OFF" _
    And Sheets("Config").Cells(120, 2) = "OFF" Then
    
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
    End If
    
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O" Then
            Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
            Application.Run "|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
            MsgBox "|fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||34a||fffd||fffd||fffd|" & vbLf & vbLf _
                   & "|fffd||fffd||fffd||fffd||fffd||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||248||682||fffd||302||fffd|" & vbLf _
                    & "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||308||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||fffd|i|fffd||7c2||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            GoTo Skip
    End If

End If

MsgBox "|fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||34a||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
Skip:
End Sub
Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||752||fffd|V|fffd|[|fffd|g|fffd||fffd|()
Sheets("MailConfig").Select
End Sub


Sub |fffd|Z|fffd||fffd||fffd||3cd|X|fffd|V|fffd|[|fffd|g|fffd||fffd|()
Sheets("AddressChange").Select
End Sub

Sub TOP|fffd||596||7c2||fffd|()
Sheets("TOP").Select
End Sub

Sub |fffd||752||fffd||fffd||282||fffd|()
Sheets("Config").Select
End Sub

Sub |fffd|[|fffd|i|fffd||fffd||fffd||fffd||282||fffd|()
Sheets("AddPaper").Select
End Sub

Sub |fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|o|fffd|^|fffd||fffd|()
Sheets("Cancel").Select
End Sub

Sub |fffd|g|fffd|p|fffd||fffd||fffd||90c9||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|()

    Sheets("AutoLabel").Select

End Sub
Attribute VB_Name = "Module10"
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


'|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||752||fffd|
Dim LabelPrinter As String
    LabelPrinter = Sheets("Config").Cells(5, 2)
'|fffd||38f||6c2||313||1c2||74d||fffd||fffd||fffd|
Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
Dim wsout As Worksheet
    Set wsout = Sheets("AutoLabel")
Dim Config As Worksheet
    Set Config = Sheets("Config")

Dim Start As Long
    If Sheets("TOP").Cells(17, 2) = "" Then
        Start = 2
    Else
        Start = (Sheets("TOP").Cells(17, 2) - 1) * 10 + 2
    End If
    
Dim Fin As Long
    If Sheets("TOP").Cells(18, 2) = "" Then
        Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row
    Else
        Fin = (Sheets("TOP").Cells(18, 2) - 1) * 10 + 11
        If Fin > wsin.Cells(Rows.count, 8).End(xlUp).Row Then
            Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row
        End If
    End If
    
'|fffd||ce682||255|K|fffd|v|fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim OrderId As String
Dim SendMethod As String
Dim ZipCode As String
Dim Pref As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Address4 As String
Dim AddressText As String
Dim OverSeaAddressText As String
Dim Country As String
Dim CountryNotice As String
Dim Tracking As String
Dim Name As String
Dim Product As String
Dim SKU As String
Dim EAN As String
Dim City As String
Dim Region As String
Dim RegionNotice As String
'|fffd||fffd||fffd|X|fffd||702||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
Dim SelfZip As String
    SelfZip = Config.Cells(11, 2)
Dim MyAddress As String
    MyAddress = Config.Cells(12, 2) & " " & Config.Cells(10, 2)
Dim SendInfo1 As String
    SendInfo1 = Config.Cells(17, 2)
Dim SendInfo2 As String
    SendInfo2 = Config.Cells(17, 3)
'|fffd|C|fffd|O|fffd||30f||a347||fffd||30e||fffd||fffd||fffd||fffd||30f||fffd||fffd|
Dim OverSeaSendInfo1 As String
'    OverSeaSendInfo1 = Config.Cells(31, 3)
Dim OverSeaSendInfo2 As String
'    OverSeaSendInfo2 = Config.Cells(32, 3)
Dim OverSeaMyAddress As String
'    OverSeaMyAddress = Config.Cells(28, 3) & " " & Config.Cells(29, 3)
Dim RegionNum As Long
'|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|
Dim Position As Long
Dim RowNum As Long
Dim ColNum As Long
'////////////////////////////////////////
Dim v As Variant
    v = wsout.Range("A1:J59")

'1|fffd||fffd||fffd||fffd||fffd||30f||a347|
'If Sheets("Config").Cells(35, 2) = "1|fffd||fffd|" Then
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & "A4|fffd||fffd|10|fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|x|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Application.WorksheetFunction.RoundUp((Fin - 1) / 10, 0) & "|fffd||142||fffd||fffd|B"
'End If

Dim PacketCount As Long
    PacketCount = 0


    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "sku") > 0 Then
            SkuCol = wsin.Rows(1).Find("sku").Column
        Else
            SkuCol = 8
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = wsin.Rows(1).Find("ship-postal-code").Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-state") > 0 Then
            PrefCol = wsin.Rows(1).Find("ship-state").Column
        Else
            PrefCol = 22
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-1") > 0 Then
            Address1Col = wsin.Rows(1).Find("ship-address-1").Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-2") > 0 Then
            Address2Col = wsin.Rows(1).Find("ship-address-2").Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-3") > 0 Then
            Address3Col = wsin.Rows(1).Find("ship-address-3").Column
        Else
            Address3Col = 20
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "recipient-name") > 0 Then
            NameCol = wsin.Rows(1).Find("recipient-name").Column
        Else
            NameCol = 17
        End If
        
    Dim CountryCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-country") > 0 Then
            CountryCol = wsin.Rows(1).Find("ship-country").Column
        Else
            CountryCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-city") > 0 Then
            CityCol = wsin.Rows(1).Find("ship-city").Column
        Else
            CityCol = 21
        End If
        
    Dim AdOrderIdCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "order-id") > 0 Then
            AdOrderIdCol = wsin.Rows(1).Find("order-id").Column
        Else
            AdOrderIdCol = 1
        End If
    '---------------------------------


For i = Start To Fin
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||30d||c42c||fffd||188||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@" & i - 1 & "/" & Fin - 1
    SKU = wsin.Cells(i, SkuCol)
    '|fffd|J|fffd|e|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||fffd||fffd||14f||fffd||fffd|i|fffd||fffd||fffd||fffd|
    
    
    ZipCode = "|fffd||fffd|" & wsin.Cells(i, ZipCodeCol)
    Pref = wsin.Cells(i, PrefCol)
    Address1 = wsin.Cells(i, Address1Col)
    Address2 = wsin.Cells(i, Address2Col)
    Address3 = wsin.Cells(i, Address3Col)
    Name = wsin.Cells(i, NameCol)
    Country = wsin.Cells(i, CountryCol)
    City = wsin.Cells(i, CityCol)
    
    '-----------------------
    '|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||1c9||fffd|
    Dim AdOrderId As String
        AdOrderId = wsin.Cells(i, AdOrderIdCol)
    Dim AdRow As Long
        If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), AdOrderId) > 0 Then
            AdRow = Sheets("AddressChange").Columns("A:A").Find(AdOrderId).Row
                ZipCode = "|fffd||fffd|" & Sheets("AddressChange").Cells(AdRow, 2)
                Pref = ""
                Address1 = Sheets("AddressChange").Cells(AdRow, 3)
                Address2 = ""
                Address3 = ""
                If Sheets("AddressChange").Cells(AdRow, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(AdRow, 4)
                End If
                'Country = ""
                City = ""
        End If
    '-----------------------
    
    '|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||752||fffd|
    SendMethod = Sheets("Picking").Cells(i + 2, 11)
    
    If Country <> "JP" Then
        RegionNum = Sheets("Region").Columns("A:A").Find(Country).Row
        Region = Sheets("Region").Cells(RegionNum, 3) & "(" & Sheets("Region").Cells(RegionNum, 5) & "-" & Sheets("Region").Cells(RegionNum, 2) & ")"
        RegionNotice = wsin.Cells(i, 22)
        SendMethod = "SAL"
    End If
    
    
    If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" Then
        SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
    End If
    
    Tracking = Empty
    If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
        If PacketCount = 0 Then
        '|fffd||14f||fffd||fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(43, 2)
                    Case ""
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(43, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        Else
        '2|fffd||96||688||20d|~|fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(44, 2)
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(44, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        End If
    PacketCount = PacketCount + 1
    
    End If
    
    
    If Tracking <> Empty Then
        Tracking = "a" & Tracking & Tracking - Int(Tracking / 7) * 7 & "a"
        Sheets("Picking").Cells(i + 2, 12) = Tracking
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||182||7c2||fffd|
    AddressText = Pref & Address1 & Address2 & Address3 & vbLf & Name & " |fffd|l"
    
    OverSeaAddressText = "Dear " & Name & vbLf & Address1 & "," & Address2 & "," & Address3 & City & vbLf & Pref & vbLf & Region & vbLf
  
    '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||16102||7c2||fffd|
    Position = (i - 1) Mod 10
    If Position = 0 Then
        Position = 10
    End If
    
    If Position <= 5 Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 1) * 12 + 2
        ColNum = 3
    Else
        '|fffd|E|fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 5 - 1) * 12 + 2
        ColNum = 8
    End If
    
    v(RowNum, ColNum) = SendMethod
    v(RowNum, ColNum + 2) = ZipCode
    If Country = "JP" Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = AddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
        If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
            v(RowNum + 6, ColNum) = "|fffd||1d0||554||50d||fffd|"
            'v(RowNum + 6, ColNum + 2) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            v(RowNum + 7, ColNum + 2) = SendInfo2 & vbLf & MyAddress
            v(RowNum + 7, ColNum) = Tracking
            v(RowNum + 9, ColNum) = Tracking
        Else
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = SendInfo1
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
            If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N" Then
                'v(RowNum + 9, ColNum) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            Else
                'v(RowNum + 9, ColNum) = ""
            End If
        End If
    Else
        '|fffd|C|fffd|O|fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = OverSeaAddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = "|fffd|yFrom Japan|fffd|z"
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
    End If
    '|fffd|z|fffd||fffd||fffd||645c||fffd|\|fffd||fffd|t|fffd||fffd|--------------------------------------------------------------------
    Dim PicPath As String
    Dim TargetRange As String
        Select Case ColNum
            Case "3"
                TargetRange = "C" & RowNum
            Case "8"
                TargetRange = "H" & RowNum
        End Select
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                PicPath = ActiveWorkbook.Path & "\pic\yuMail.png"
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\yuPacket.png"
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\LP.png"
            Case "SAL"
                PicPath = ActiveWorkbook.Path & "\pic\SAL.png"
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\yuPack.png"
            Case "|fffd||fffd||fffd||fffd|e|fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\ePacket.png"
        End Select
        
        
        Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range(TargetRange), PicPath)

    '---------------------------------------------------------------------------------------
    If Position = 10 Or i = Fin Then
        If Position <> 10 Then
            For m = Position + 1 To 10
                If m <= 5 Then
                    '|fffd||fffd||fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 1) * 12 + 2
                    ColNum = 3
                Else
                    '|fffd|E|fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 5 - 1) * 12 + 2
                    ColNum = 8
                End If
                '|fffd|c|fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||d4482||242||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|
                v(RowNum, ColNum) = ""
                v(RowNum, ColNum + 2) = ""
                v(RowNum, ColNum + 1) = ""
                v(RowNum + 1, ColNum + 1) = ""
                v(RowNum + 4, ColNum) = ""
                v(RowNum + 6, ColNum) = ""
                v(RowNum + 6, ColNum + 2) = ""
                v(RowNum + 7, ColNum + 2) = ""
                v(RowNum + 7, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
            DoEvents
            Next
        End If
        wsout.Range("A1:J59") = v
         wsout.PrintOut From:=1, To:=1, Copies:=1, ActivePrinter:=LabelPrinter, Collate _
        :=True
        v = wsout.Range("A1:J59")
        '|fffd||645c||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd|I|fffd||fffd||fffd|
        Dim myRng As Range
        Dim sp As Variant
            Set myRng = Sheets("AutoLabel").Range("C2:H50")
            For Each sp In Sheets("AutoLabel").Shapes
                If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then
                sp.Delete
                End If
            DoEvents
            Next
        Set myRng = Nothing
            
    End If
DoEvents
Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

'|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||752||fffd|
Dim LabelPrinter As String
    LabelPrinter = Sheets("Config").Cells(5, 2)
'|fffd||38f||6c2||313||1c2||74d||fffd||fffd||fffd|
Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
Dim wsout As Worksheet
    Set wsout = Sheets("AutoLabel")
Dim Config As Worksheet
    Set Config = Sheets("Config")

Dim Start As Long
    If Sheets("TOP").Cells(18, 2) = "" Then
        Start = 2
    Else
        Start = wsin.Cells(Rows.count, 8).End(xlUp).Row - (Sheets("TOP").Cells(18, 2) - 1) * 10 - 9
    End If
    If Start < 2 Then
        Start = 2
    End If
    
Dim Fin As Long
    If Sheets("TOP").Cells(17, 2) = "" Then
        Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row
    Else
        Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row - (Sheets("TOP").Cells(17, 2) - 1) * 10
        If Fin < 0 Then
            MsgBox "|fffd|J|fffd|n|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B"
            Exit Sub
        End If
    End If
    
'|fffd||ce682||255|K|fffd|v|fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim OrderId As String
Dim SendMethod As String
Dim ZipCode As String
Dim Pref As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Address4 As String
Dim AddressText As String
Dim OverSeaAddressText As String
Dim Country As String
Dim CountryNotice As String
Dim Tracking As String
Dim Name As String
Dim Product As String
Dim SKU As String
Dim EAN As String
Dim City As String
Dim Region As String
Dim RegionNotice As String
'|fffd||fffd||fffd|X|fffd||702||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
Dim SelfZip As String
    SelfZip = Config.Cells(11, 2)
Dim MyAddress As String
    MyAddress = Config.Cells(12, 2) & " " & Config.Cells(10, 2)
Dim SendInfo1 As String
    SendInfo1 = Config.Cells(17, 2)
Dim SendInfo2 As String
    SendInfo2 = Config.Cells(17, 3)
'|fffd|C|fffd|O|fffd||30f||a347||fffd||30e||fffd||fffd||fffd||fffd||30f||fffd||fffd|
Dim OverSeaSendInfo1 As String
'    OverSeaSendInfo1 = Config.Cells(31, 3)
Dim OverSeaSendInfo2 As String
'    OverSeaSendInfo2 = Config.Cells(32, 3)
Dim OverSeaMyAddress As String
'    OverSeaMyAddress = Config.Cells(28, 3) & " " & Config.Cells(29, 3)
Dim RegionNum As Long
'|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|
Dim Position As Long
Dim RowNum As Long
Dim ColNum As Long
'////////////////////////////////////////
Dim v As Variant
    v = wsout.Range("A1:J59")

'1|fffd||fffd||fffd||fffd||fffd||30f||a347|
'If Sheets("Config").Cells(35, 2) = "1|fffd||fffd|" Then
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & "A4|fffd||fffd|10|fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|x|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Application.WorksheetFunction.RoundUp((Fin - 1) / 10, 0) & "|fffd||142||fffd||fffd|B"
'End If

Dim PacketCount As Long
    PacketCount = 0

    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "sku") > 0 Then
            SkuCol = wsin.Rows(1).Find("sku").Column
        Else
            SkuCol = 8
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = wsin.Rows(1).Find("ship-postal-code").Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-state") > 0 Then
            PrefCol = wsin.Rows(1).Find("ship-state").Column
        Else
            PrefCol = 22
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-1") > 0 Then
            Address1Col = wsin.Rows(1).Find("ship-address-1").Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-2") > 0 Then
            Address2Col = wsin.Rows(1).Find("ship-address-2").Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-3") > 0 Then
            Address3Col = wsin.Rows(1).Find("ship-address-3").Column
        Else
            Address3Col = 20
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "recipient-name") > 0 Then
            NameCol = wsin.Rows(1).Find("recipient-name").Column
        Else
            NameCol = 17
        End If
        
    Dim CountryCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-country") > 0 Then
            CountryCol = wsin.Rows(1).Find("ship-country").Column
        Else
            CountryCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-city") > 0 Then
            CityCol = wsin.Rows(1).Find("ship-city").Column
        Else
            CityCol = 21
        End If
        
    Dim AdOrderIdCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "order-id") > 0 Then
            AdOrderIdCol = wsin.Rows(1).Find("order-id").Column
        Else
            AdOrderIdCol = 1
        End If
    '---------------------------------



For i = Fin To Start Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||30d||c42c||fffd||188||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@" & Fin - i + 1 & "/" & Fin
    SKU = wsin.Cells(i, SkuCol)
    '|fffd|J|fffd|e|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||fffd||fffd||14f||fffd||fffd|i|fffd||fffd||fffd||fffd|
    ZipCode = "|fffd||fffd|" & wsin.Cells(i, ZipCodeCol)
    Pref = wsin.Cells(i, PrefCol)
    Address1 = wsin.Cells(i, Address1Col)
    Address2 = wsin.Cells(i, Address2Col)
    Address3 = wsin.Cells(i, Address3Col)
    Name = wsin.Cells(i, NameCol)
    Country = wsin.Cells(i, CountryCol)
    City = wsin.Cells(i, CityCol)
    
        '-----------------------
    '|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||1c9||fffd|
    Dim AdOrderId As String
        AdOrderId = wsin.Cells(i, AdOrderIdCol)
    Dim AdRow As Long
        If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), AdOrderId) > 0 Then
            AdRow = Sheets("AddressChange").Columns("A:A").Find(AdOrderId).Row
                ZipCode = "|fffd||fffd|" & Sheets("AddressChange").Cells(AdRow, 2)
                Pref = ""
                Address1 = Sheets("AddressChange").Cells(AdRow, 3)
                Address2 = ""
                Address3 = ""
                If Sheets("AddressChange").Cells(AdRow, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(AdRow, 4)
                End If
                'Country = ""
                City = ""
        End If
    '-----------------------
    
    '|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||752||fffd|
    SendMethod = Sheets("Picking").Cells(i + 2, 11)
    
    If Country <> "JP" Then
        RegionNum = Sheets("Region").Columns("A:A").Find(Country).Row
        Region = Sheets("Region").Cells(RegionNum, 3) & "(" & Sheets("Region").Cells(RegionNum, 5) & "-" & Sheets("Region").Cells(RegionNum, 2) & ")"
        RegionNotice = wsin.Cells(i, 22)
        SendMethod = "SAL"
    End If
    
    
    If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" Then
        SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
    End If
    
    Tracking = Empty
    If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
        If PacketCount = 0 Then
        '|fffd||14f||fffd||fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(43, 2)
                    Case ""
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(43, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        Else
        '2|fffd||96||688||20d|~|fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(44, 2)
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(44, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        End If
    PacketCount = PacketCount + 1
    
    End If
    
    
    If Tracking <> Empty Then
        Tracking = "a" & Tracking & Tracking - Int(Tracking / 7) * 7 & "a"
        Sheets("Picking").Cells(i + 2, 12) = Tracking
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||182||7c2||fffd|
    AddressText = Pref & Address1 & Address2 & Address3 & vbLf & Name & " |fffd|l"
    
    OverSeaAddressText = "Dear " & Name & vbLf & Address1 & "," & Address2 & "," & Address3 & City & vbLf & Pref & vbLf & Region & vbLf
 
    '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||16102||7c2||fffd|
    Position = (Fin - i + 1) Mod 10
    If Position = 0 Then
        Position = 10
    End If
    
    If Position <= 5 Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 1) * 12 + 2
        ColNum = 3
    Else
        '|fffd|E|fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 5 - 1) * 12 + 2
        ColNum = 8
    End If
    
    v(RowNum, ColNum) = SendMethod
    v(RowNum, ColNum + 2) = ZipCode
    If Country = "JP" Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = AddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
        If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
            v(RowNum + 6, ColNum) = "|fffd||1d0||554||50d||fffd|"
            'v(RowNum + 6, ColNum + 2) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            v(RowNum + 7, ColNum + 2) = SendInfo2 & vbLf & MyAddress
            v(RowNum + 7, ColNum) = Tracking
            v(RowNum + 9, ColNum) = Tracking
        Else
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = SendInfo1
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
            If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N" Then
                'v(RowNum + 9, ColNum) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            Else
                'v(RowNum + 9, ColNum) = ""
            End If
        End If
    Else
        '|fffd|C|fffd|O|fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = OverSeaAddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = "|fffd|yFrom Japan|fffd|z"
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
    End If
    '|fffd|z|fffd||fffd||fffd||645c||fffd|\|fffd||fffd|t|fffd||fffd|--------------------------------------------------------------------
    Dim PicPath As String
    Dim TargetRange As String
        Select Case ColNum
            Case "3"
                TargetRange = "C" & RowNum
            Case "8"
                TargetRange = "H" & RowNum
        End Select
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                PicPath = ActiveWorkbook.Path & "\pic\yuMail.png"
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\yuPacket.png"
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\LP.png"
            Case "SAL"
                PicPath = ActiveWorkbook.Path & "\pic\SAL.png"
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\yuPack.png"
            Case "|fffd||fffd||fffd||fffd|e|fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\ePacket.png"
        End Select
        
        
        Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range(TargetRange), PicPath)

    '---------------------------------------------------------------------------------------
    If Position = 10 Or i = 2 Then
        If Position <> 10 Then
            For m = Position + 1 To 10
                If m <= 5 Then
                    '|fffd||fffd||fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 1) * 12 + 2
                    ColNum = 3
                Else
                    '|fffd|E|fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 5 - 1) * 12 + 2
                    ColNum = 8
                End If
                '|fffd|c|fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||d4482||242||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|
                v(RowNum, ColNum) = ""
                v(RowNum, ColNum + 2) = ""
                v(RowNum, ColNum + 1) = ""
                v(RowNum + 1, ColNum + 1) = ""
                v(RowNum + 4, ColNum) = ""
                v(RowNum + 6, ColNum) = ""
                v(RowNum + 6, ColNum + 2) = ""
                v(RowNum + 7, ColNum + 2) = ""
                v(RowNum + 7, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
            DoEvents
            Next
        End If
        wsout.Range("A1:J59") = v
         wsout.PrintOut From:=1, To:=1, Copies:=1, ActivePrinter:=LabelPrinter, Collate _
        :=True
        v = wsout.Range("A1:J59")
        '|fffd||645c||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd|I|fffd||fffd||fffd|
        Dim myRng As Range
        Dim sp As Variant
            Set myRng = Sheets("AutoLabel").Range("C2:H50")
            For Each sp In Sheets("AutoLabel").Shapes
                If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then
                sp.Delete
                End If
            DoEvents
            Next
        Set myRng = Nothing
            
    End If
DoEvents
Next



Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub

Sub |fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = LastIndex Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If
    
    

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = 2 Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next

                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Module11"
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long
Dim Promo As Long
Dim Point As Long
Dim FinalPrice As String
Dim PointInfo As String
Dim PromoInfo As String

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("ChumonReport").Columns("A:A")) - 1
    
Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------


    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            OrderIdCol = 1
        End If

    Dim OrderDateCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "purchase-date") > 0 Then
            OrderDateCol = Sheets("ChumonReport").Rows(1).Find("purchase-date", LookAt:=xlWhole).Column
        Else
            OrderDateCol = 3
        End If

    Dim BuyerNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-name") > 0 Then
            BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("buyer-name", LookAt:=xlWhole).Column
        Else
            BuyerNameCol = 6
        End If
        
    Dim RecipientNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            RecipientNameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            RecipientNameCol = 17
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
            Address1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
            Address2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
            Address3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
            CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If
        
    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
            PrefCol = Sheets("ChumonReport").Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
            SkuCol = Sheets("ChumonReport").Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If
        
    Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name", LookAt:=xlWhole).Column
        Else
            TittleCol = 9
        End If
        
    Dim NumberCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "quantity-purchased") > 0 Then
            NumberCol = Sheets("ChumonReport").Rows(1).Find("quantity-purchased", LookAt:=xlWhole).Column
        Else
            NumberCol = 10
        End If
        
    Dim ItemPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
            ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price", LookAt:=xlWhole).Column
        Else
            ItemPriceCol = 12
        End If
        
    Dim SendPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
            SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price", LookAt:=xlWhole).Column
        Else
            SendPriceCol = 14
        End If
        
    '|fffd|o|fffd|i|fffd||68d||5c2||317||fffd||50d||fffd||fffd||64fe|
    Dim SyosaiSkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|o|fffd|i|fffd||fffd|SKU") > 0 Then
            SyosaiSkuCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|o|fffd|i|fffd||fffd|SKU", LookAt:=xlWhole).Column
        Else
            SyosaiSkuCol = 3
        End If
    
    Dim ConditionCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|") > 0 Then
            ConditionCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            ConditionCol = 9
        End If
        
    Dim CommentCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
            CommentCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            CommentCol = 8
        End If
        
        
    '---------------------------------

    For i = 2 To LastIndex
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & Page & "/" & MaxPage
    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("ChumonReport").Cells(i, OrderIdCol)
            OrderDate = Sheets("ChumonReport").Cells(i, OrderDateCol)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("ChumonReport").Cells(i, BuyerNameCol)
            RecipientName = Sheets("ChumonReport").Cells(i, RecipientNameCol)
            Address = "|fffd||fffd|" & Sheets("ChumonReport").Cells(i, ZipCodeCol) & " " & Sheets("ChumonReport").Cells(i, PrefCol) & " " & Sheets("ChumonReport").Cells(i, CityCol) & Sheets("ChumonReport").Cells(i, Address1Col) & " " & Sheets("ChumonReport").Cells(i, Address2Col) & " " & Sheets("ChumonReport").Cells(i, Address3Col)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("ChumonReport").Cells(i, TittleCol)
            SKU = Sheets("ChumonReport").Cells(i, SkuCol)
            
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|-----------------------
            
            
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol).Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, ConditionCol)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, CommentCol)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("ChumonReport").Cells(i, NumberCol)
            ItemPrice = Sheets("ChumonReport").Cells(i, ItemPriceCol)
            
            FinalPrice = ItemPrice
            
            SendPrice = Sheets("ChumonReport").Cells(i, SendPriceCol)
            '----------------------------------------------------------------------
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(16, 3) = FinalPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
            Page = Page + 1
            '----------------------------------------------------------------------
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub


Sub |fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long
Dim Promo As Long
Dim Point As Long
Dim FinalPrice As String
Dim PointInfo As String
Dim PromoInfo As String

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("ChumonReport").Columns("A:A")) - 1

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String


'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            OrderIdCol = 1
        End If

    Dim OrderDateCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "purchase-date") > 0 Then
            OrderDateCol = Sheets("ChumonReport").Rows(1).Find("purchase-date", LookAt:=xlWhole).Column
        Else
            OrderDateCol = 3
        End If

    Dim BuyerNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-name") > 0 Then
            BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("buyer-name", LookAt:=xlWhole).Column
        Else
            BuyerNameCol = 6
        End If
        
    Dim RecipientNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            RecipientNameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            RecipientNameCol = 17
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
            Address1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
            Address2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
            Address3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
            CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If
        
    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
            PrefCol = Sheets("ChumonReport").Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
            SkuCol = Sheets("ChumonReport").Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If
        
    Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name", LookAt:=xlWhole).Column
        Else
            TittleCol = 9
        End If
        
    Dim NumberCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "quantity-purchased") > 0 Then
            NumberCol = Sheets("ChumonReport").Rows(1).Find("quantity-purchased", LookAt:=xlWhole).Column
        Else
            NumberCol = 10
        End If
        
    Dim ItemPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
            ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price", LookAt:=xlWhole).Column
        Else
            ItemPriceCol = 12
        End If
        
    Dim SendPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
            SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price", LookAt:=xlWhole).Column
        Else
            SendPriceCol = 14
        End If
        
    '|fffd|o|fffd|i|fffd||68d||5c2||317||fffd||50d||fffd||fffd||64fe|
    Dim SyosaiSkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|o|fffd|i|fffd||fffd|SKU") > 0 Then
            SyosaiSkuCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|o|fffd|i|fffd||fffd|SKU", LookAt:=xlWhole).Column
        Else
            SyosaiSkuCol = 3
        End If
    
    Dim ConditionCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|") > 0 Then
            ConditionCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            ConditionCol = 9
        End If
        
    Dim CommentCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
            CommentCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            CommentCol = 8
        End If
        
        
    '---------------------------------
    For i = LastIndex To 2 Step -1
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & Page & "/" & MaxPage
    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("ChumonReport").Cells(i, OrderIdCol)
            OrderDate = Sheets("ChumonReport").Cells(i, OrderDateCol)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("ChumonReport").Cells(i, BuyerNameCol)
            RecipientName = Sheets("ChumonReport").Cells(i, RecipientNameCol)
            Address = "|fffd||fffd|" & Sheets("ChumonReport").Cells(i, ZipCodeCol) & " " & Sheets("ChumonReport").Cells(i, PrefCol) & " " & Sheets("ChumonReport").Cells(i, CityCol) & Sheets("ChumonReport").Cells(i, Address1Col) & " " & Sheets("ChumonReport").Cells(i, Address2Col) & " " & Sheets("ChumonReport").Cells(i, Address3Col)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("ChumonReport").Cells(i, TittleCol)
            SKU = Sheets("ChumonReport").Cells(i, SkuCol)
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|-----------------------
            
            
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol).Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, ConditionCol)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, CommentCol)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("ChumonReport").Cells(i, NumberCol)
            ItemPrice = Sheets("ChumonReport").Cells(i, ItemPriceCol)
            
            FinalPrice = ItemPrice
            
            SendPrice = Sheets("ChumonReport").Cells(i, SendPriceCol)
            '----------------------------------------------------------------------
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(16, 3) = FinalPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
            Page = Page + 1
            '----------------------------------------------------------------------
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub



Sub |fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long
Dim Promo As Long
Dim Point As Long
Dim FinalPrice As String
Dim PointInfo As String
Dim PromoInfo As String

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("ChumonReport").Columns("A:A")) - 1

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

Dim StartPage As Long
    If Sheets("TOP").Cells(23, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(23, 2)
    Else
        StartPage = 1
    End If

Dim PageCount As Long
    PageCount = 1

Dim FinPage As Long
    If Sheets("TOP").Cells(24, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(24, 2)
    Else
        FinPage = 9999
    End If


'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            OrderIdCol = 1
        End If

    Dim OrderDateCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "purchase-date") > 0 Then
            OrderDateCol = Sheets("ChumonReport").Rows(1).Find("purchase-date", LookAt:=xlWhole).Column
        Else
            OrderDateCol = 3
        End If

    Dim BuyerNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-name") > 0 Then
            BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("buyer-name", LookAt:=xlWhole).Column
        Else
            BuyerNameCol = 6
        End If
        
    Dim RecipientNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            RecipientNameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            RecipientNameCol = 17
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
            Address1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
            Address2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
            Address3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If

    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
            CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
            PrefCol = Sheets("ChumonReport").Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
            SkuCol = Sheets("ChumonReport").Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If
        
    Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name", LookAt:=xlWhole).Column
        Else
            TittleCol = 9
        End If
        
    Dim NumberCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "quantity-purchased") > 0 Then
            NumberCol = Sheets("ChumonReport").Rows(1).Find("quantity-purchased", LookAt:=xlWhole).Column
        Else
            NumberCol = 10
        End If
        
    Dim ItemPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
            ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price", LookAt:=xlWhole).Column
        Else
            ItemPriceCol = 12
        End If
        
        
    Dim SendPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
            SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price", LookAt:=xlWhole).Column
        Else
            SendPriceCol = 14
        End If
        
    '|fffd|o|fffd|i|fffd||68d||5c2||317||fffd||50d||fffd||fffd||64fe|
    Dim SyosaiSkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|o|fffd|i|fffd||fffd|SKU") > 0 Then
            SyosaiSkuCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|o|fffd|i|fffd||fffd|SKU", LookAt:=xlWhole).Column
        Else
            SyosaiSkuCol = 3
        End If
    
    Dim ConditionCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|") > 0 Then
            ConditionCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            ConditionCol = 9
        End If
        
    Dim CommentCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
            CommentCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            CommentCol = 8
        End If
        
        
    '---------------------------------

    For i = 2 To LastIndex
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & PageCount & "/" & FinPage - StartPage + 1
    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("ChumonReport").Cells(i, OrderIdCol)
            OrderDate = Sheets("ChumonReport").Cells(i, OrderDateCol)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("ChumonReport").Cells(i, BuyerNameCol)
            RecipientName = Sheets("ChumonReport").Cells(i, RecipientNameCol)
            Address = "|fffd||fffd|" & Sheets("ChumonReport").Cells(i, ZipCodeCol) & " " & Sheets("ChumonReport").Cells(i, PrefCol) & " " & Sheets("ChumonReport").Cells(i, CityCol) & Sheets("ChumonReport").Cells(i, Address1Col) & " " & Sheets("ChumonReport").Cells(i, Address2Col) & " " & Sheets("ChumonReport").Cells(i, Address3Col)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("ChumonReport").Cells(i, TittleCol)
            SKU = Sheets("ChumonReport").Cells(i, SkuCol)
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|-----------------------
            
            
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol).Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, ConditionCol)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, CommentCol)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("ChumonReport").Cells(i, NumberCol)
            ItemPrice = Sheets("ChumonReport").Cells(i, ItemPriceCol)
            
            If PromoCol <> Empty Then
                If Sheets("ChumonReport").Cells(i, PromoCol) <> Empty Then
                    Promo = Sheets("ChumonReport").Cells(i, PromoCol)
                Else
                    Promo = Empty
                End If
            End If
            
            If PointCol <> Empty Then
                If Sheets("ChumonReport").Cells(i, PointCol) <> Empty Then
                    Point = Sheets("ChumonReport").Cells(i, PointCol)
                Else
                    Point = Empty
                End If
            End If
            
            FinalPrice = ItemPrice
            
            SendPrice = Sheets("ChumonReport").Cells(i, SendPriceCol)
            '----------------------------------------------------------------------
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(16, 3) = FinalPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            If StartPage <= Page And Page <= FinPage Then
                Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
                PageCount = PageCount + 1
            End If
            '----------------------------------------------------------------------
            Page = Page + 1
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub





Sub |fffd||fffd||fffd||fffd||fffd|||fffd||154|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long
Dim Promo As Long
Dim Point As Long
Dim FinalPrice As String
Dim PointInfo As String
Dim PromoInfo As String

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("ChumonReport").Columns("A:A")) - 1

Dim StartPage As Long
    If Sheets("TOP").Cells(23, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(23, 2)
    Else
        StartPage = 1
    End If

Dim PageCount As Long
    PageCount = 1

Dim FinPage As Long
    If Sheets("TOP").Cells(24, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(24, 2)
    Else
        FinPage = 9999
    End If

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------

    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            OrderIdCol = 1
        End If

    Dim OrderDateCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "purchase-date") > 0 Then
            OrderDateCol = Sheets("ChumonReport").Rows(1).Find("purchase-date", LookAt:=xlWhole).Column
        Else
            OrderDateCol = 3
        End If

    Dim BuyerNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-name") > 0 Then
            BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("buyer-name", LookAt:=xlWhole).Column
        Else
            BuyerNameCol = 6
        End If
        
    Dim RecipientNameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            RecipientNameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            RecipientNameCol = 17
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
            Address1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
            Address2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
            Address3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If

    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
            CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
            PrefCol = Sheets("ChumonReport").Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
            SkuCol = Sheets("ChumonReport").Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If
        
    Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name", LookAt:=xlWhole).Column
        Else
            TittleCol = 9
        End If
        
    Dim NumberCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "quantity-purchased") > 0 Then
            NumberCol = Sheets("ChumonReport").Rows(1).Find("quantity-purchased", LookAt:=xlWhole).Column
        Else
            NumberCol = 10
        End If
        
    Dim ItemPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
            ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price", LookAt:=xlWhole).Column
        Else
            ItemPriceCol = 12
        End If
        
        
    Dim SendPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
            SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price", LookAt:=xlWhole).Column
        Else
            SendPriceCol = 14
        End If
        
    '|fffd|o|fffd|i|fffd||68d||5c2||317||fffd||50d||fffd||fffd||64fe|
    Dim SyosaiSkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|o|fffd|i|fffd||fffd|SKU") > 0 Then
            SyosaiSkuCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|o|fffd|i|fffd||fffd|SKU", LookAt:=xlWhole).Column
        Else
            SyosaiSkuCol = 3
        End If
    
    Dim ConditionCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|") > 0 Then
            ConditionCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            ConditionCol = 9
        End If
        
    Dim CommentCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Rows(1), "|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
            CommentCol = Sheets("SypnSyosaiReport").Rows(1).Find("|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", LookAt:=xlWhole).Column
        Else
            CommentCol = 8
        End If
        
        
    '---------------------------------

    For i = LastIndex To 2 Step -1
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & PageCount & "/" & FinPage - StartPage + 1

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("ChumonReport").Cells(i, OrderIdCol)
            OrderDate = Sheets("ChumonReport").Cells(i, OrderDateCol)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("ChumonReport").Cells(i, BuyerNameCol)
            RecipientName = Sheets("ChumonReport").Cells(i, RecipientNameCol)
            Address = "|fffd||fffd|" & Sheets("ChumonReport").Cells(i, ZipCodeCol) & " " & Sheets("ChumonReport").Cells(i, PrefCol) & " " & Sheets("ChumonReport").Cells(i, CityCol) & Sheets("ChumonReport").Cells(i, Address1Col) & " " & Sheets("ChumonReport").Cells(i, Address2Col) & " " & Sheets("ChumonReport").Cells(i, Address3Col)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("ChumonReport").Cells(i, TittleCol)
            SKU = Sheets("ChumonReport").Cells(i, SkuCol)
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|-----------------------
            
            
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns(SyosaiSkuCol).Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, ConditionCol)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, CommentCol)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("ChumonReport").Cells(i, NumberCol)
            ItemPrice = Sheets("ChumonReport").Cells(i, ItemPriceCol)
            
            If PromoCol <> Empty Then
                If Sheets("ChumonReport").Cells(i, PromoCol) <> Empty Then
                    Promo = Sheets("ChumonReport").Cells(i, PromoCol)
                Else
                    Promo = Empty
                End If
            End If
            
            If PointCol <> Empty Then
                If Sheets("ChumonReport").Cells(i, PointCol) <> Empty Then
                    Point = Sheets("ChumonReport").Cells(i, PointCol)
                Else
                    Point = Empty
                End If
            End If
            

            FinalPrice = ItemPrice
            
            SendPrice = Sheets("ChumonReport").Cells(i, SendPriceCol)
            '----------------------------------------------------------------------
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(16, 3) = FinalPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            If StartPage <= Page And Page <= FinPage Then
                Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
                PageCount = PageCount + 1
            End If
            '----------------------------------------------------------------------
            Page = Page + 1
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub

Attribute VB_Name = "Module12"
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||18f|o|fffd||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim OrderId As String
Dim ItemID As String
Dim Number As String

Dim ShipDate As String
    ShipDate = Format(Now() + Sheets("TOP").Cells(3, 9), "YYYY-MM-DD")
Dim CarrierName As String
Dim ShipMethod As String
    ShipMethod = Sheets("Config").Cells(45, 2)
    If ShipMethod = "DM|fffd||fffd|" Then
        CarrierName = "|fffd||fffd||fffd|}|fffd|g|fffd|^|fffd|A"
    Else
        CarrierName = "|fffd||fffd||fffd|{|fffd|X|fffd||fffd|"
    End If
Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim SendFileX As Long
    SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row
Dim TrackingNumber As String
Dim ans_Trucking As String
Dim Name As String
Dim Tittle As String

    If SendFileX > 3 Then
        Sheets("SendFile").Rows("4:" & SendFileX).ClearContents
        Sheets("SendFile").Rows("4:" & SendFileX).Font.ColorIndex = 1
    End If

    For i = 2 To LastIndex
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
            SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row + 1
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ItemID = Sheets("ChumonReport").Cells(i, 2)
            Number = Sheets("ChumonReport").Cells(i, 10)
            Name = Sheets("ChumonReport").Cells(i, 17)
            Tittle = Sheets("ChumonReport").Cells(i, 9)
            
            Sheets("SendFile").Cells(SendFileX, 1) = OrderId
            Sheets("SendFile").Cells(SendFileX, 2) = Format(ItemID, "00000000000000")
            Sheets("SendFile").Cells(SendFileX, 3) = Number
            Sheets("SendFile").Cells(SendFileX, 4) = Format(ShipDate, "YYYY-MM-DD")
            Sheets("SendFile").Cells(SendFileX, 5) = "Other"
            Sheets("SendFile").Cells(SendFileX, 6) = CarrierName
            

            ShipMethod = Sheets("Picking").Cells(i + 2, 11)
            If ShipMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
                TrackingNumber = Sheets("Picking").Cells(i + 2, 12)
                TrackingNumber = Format(Mid(TrackingNumber, 2, Len(TrackingNumber) - 2), "000000000000")
                Sheets("SendFile").Cells(SendFileX, 7) = TrackingNumber
            End If
            Sheets("SendFile").Cells(SendFileX, 8) = ShipMethod
            
        End If
    DoEvents
    Next



Dim Address As String

Dim RowNum As Long
Dim Cancel As Long
    Cancel = 4
Dim BeforeRow As Long

    '|fffd||1d0||554||50d||fffd||fffd||fffd||fffd||351||38f||6c2||fffd||fffd||fffd||fffd||fffd||a347|---------------------------------------------------

    If Application.WorksheetFunction.CountIf(Sheets("SendFile").Columns("H:H"), "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X") > 0 Or _
        Application.WorksheetFunction.CountIf(Sheets("SendFile").Columns("H:H"), "|fffd||40a4||fffd|p|fffd|b|fffd|N") > 0 Or _
        Application.WorksheetFunction.CountIf(Sheets("SendFile").Columns("H:H"), "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g") > 0 Then
        
        MsgBox "|fffd|y|fffd||fffd||fffd|{|fffd|X|fffd||582||fffd||fffd||311||fffd||fffd|i|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|E|fffd||40a4||fffd|p|fffd|b|fffd|N|fffd|E|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|j|fffd|z|fffd||312||1d0||554||50d||fffd||fffd||313||fffd||fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf _
            & "|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd||fffd||5c2||10a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||251||389||fffd||fffd||fffd||fffd||fffd||1d0||554||50d||fffd||fffd||fffd||fffd||fffd||341|i|fffd|o|fffd|[|fffd|R|fffd|[|fffd|h|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|s|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & vbLf _
            & "|fffd|uOK|fffd|v|fffd||153||1c2||74e||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Else
        GoTo labelSKIP
    End If
    
    SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row
ReStart:
    For m = Cancel To SendFileX
        '|fffd||38f||6ca|O|fffd||202||fffd|X|fffd|L|fffd|b|fffd|v
        If Sheets("SendFile").Cells(m, 8) <> "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" And _
            Sheets("SendFile").Cells(m, 8) <> "|fffd||40a4||fffd|p|fffd|b|fffd|N" And _
            Sheets("SendFile").Cells(m, 8) <> "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
        
            GoTo NextRow
        End If
        
'|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id").Column
        Else
            OrderIdCol = 1
        End If
        
    Dim itemIDCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-item-id") > 0 Then
            itemIDCol = Sheets("ChumonReport").Rows(1).Find("order-item-id").Column
        Else
            itemIDCol = 2
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            NameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name").Column
        Else
            NameCol = 19
        End If
        
    Dim ZipCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
            ZipCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code").Column
        Else
            ZipCol = 25
        End If
        
    Dim StateCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
            StateCol = Sheets("ChumonReport").Rows(1).Find("ship-state").Column
        Else
            StateCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
            CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city").Column
        Else
            CityCol = 23
        End If
 
     Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
            Address1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1").Column
        Else
            Address1Col = 20
        End If

     Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
            Address2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2").Column
        Else
            Address2Col = 21
        End If

     Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
            Address3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3").Column
        Else
            Address3Col = 22
        End If
        
     Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name").Column
        Else
            TittleCol = 9
        End If
'---------------------------------
        
        OrderId = Sheets("SendFile").Cells(m, 1)
        ItemID = Format(Sheets("SendFile").Cells(m, 2), "00000000000000")
        ShipMethod = Sheets("SendFile").Cells(m, 8)
        
        For x = 2 To LastIndex
            If Sheets("ChumonReport").Cells(x, OrderIdCol) = OrderId And Format(Sheets("ChumonReport").Cells(x, itemIDCol), "00000000000000") = Format(ItemID, "00000000000000") Then
                RowNum = x
                Exit For
            End If
        DoEvents
        Next
                
        Name = Sheets("ChumonReport").Cells(RowNum, NameCol)
        Address = "|fffd||fffd|" & Sheets("ChumonReport").Cells(RowNum, ZipCol) & vbLf _
                    & Sheets("ChumonReport").Cells(RowNum, StateCol) & " " & Sheets("ChumonReport").Cells(RowNum, CityCol) _
                    & Sheets("ChumonReport").Cells(RowNum, Address1Col) & " " & Sheets("ChumonReport").Cells(RowNum, Address2Col) & " " & Sheets("ChumonReport").Cells(RowNum, Address3Col)
        Tittle = Sheets("ChumonReport").Cells(RowNum, TittleCol)
                
        ans = InputBox(m - 3 & "/" & SendFileX - 3 & vbLf & vbLf & Address & vbLf & Name & "|fffd||fffd||fffd||fffd|" & vbLf & vbLf & Tittle _
                        & vbLf & vbLf & "|fffd||312||1d0||554||50d||fffd||fffd||341|H(" & ShipMethod & ")|fffd|@|fffd||fffd||fffd|o|fffd|[|fffd|R|fffd|[|fffd|h|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbLf & vbLf _
                        & "|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||356||fffd||fffd||fffd||fffd||342||fffd|1|fffd||91|O|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|" & vbLf _
                        & "|fffd||fffd||fffd|u|fffd|I|fffd||fffd||fffd|v|fffd||193||fffd||fffd||342||fffd||fffd||fffd||393||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B", "", "")
        If ans = "|fffd|I|fffd||fffd|" Then
            GoTo labelSKIP
        End If
                
        If ans <> "" Then
            If IsNumeric(Left(ans, 1)) = False And IsNumeric(Right(ans, 1)) = False Then
                ans = Mid(ans, 2, Len(ans) - 2)
            End If
            Sheets("SendFile").Cells(m, 7) = ans
            Sheets("Picking").Cells(m, 12) = ans
            BeforeRow = m
        Else
            '|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A1|fffd||91|O|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||38d||14f||fffd||fffd|j|fffd||256||7c2||fffd|
            If BeforeRow = Empty Then
                Cancel = 4
            Else
                Cancel = BeforeRow
            End If
            MsgBox "1|fffd||91|O|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
            GoTo ReStart
        End If
NextRow:
    DoEvents
    Next
labelSKIP:

    '-----------------------------------------------------------------------
    Application.Run "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|"
    
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd|s|fffd|v|fffd|o|fffd|^|fffd||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||350||fffd|I|fffd||fffd|()

Dim a As String
With Application.FileDialog(msoFileDialogFolderPicker)
.Show
a = .SelectedItems(1)

End With
    
    Sheets("Config").Range("B122") = a

End Sub

Sub |fffd|s|fffd|v|fffd||242||202||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|o|fffd|^|fffd||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'-------------------------------------------------------
Dim SKU As String
Dim RowNum As String
Dim SypnFileX As Long
Dim LastIndex As Long
    LastIndex = Sheets("SypnFile").Cells(Rows.count, 1).End(xlUp).Row

If LastIndex > 3 Then
    Sheets("SypnFile").Range("A4:P" & LastIndex).ClearContents
End If

    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
    
    For i = 2 To LastIndex
        Application.StatusBar = "|fffd|s|fffd|v|fffd||20d||74c||253|o|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|@" & i & "/" & LastIndex
        SKU = Sheets("ChumonReport").Cells(i, 8)
        SypnFileX = Sheets("SypnFile").Cells(Rows.count, 1).End(xlUp).Row + 1
        
        If Application.WorksheetFunction.CountIf(Sheets("SypnReport").Columns("A:A"), SKU) > 0 Then
            RowNum = Sheets("SypnReport").Columns("A:A").Find(SKU).Row
            If Sheets("SypnReport").Cells(RowNum, 4) = 0 Then
                Sheets("SypnFile").Cells(SypnFileX, 1) = SKU
                Sheets("SypnFile").Cells(SypnFileX, 12) = "x"
            End If
        End If
    Next

'-----------------------------------------------------------------------
Application.StatusBar = "|fffd|s|fffd|v|fffd||242||202||fffd||fffd||fffd||fffd|o|fffd|^|fffd||30d||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|"
    
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True

End Sub


Sub |fffd|s|fffd|v|fffd|o|fffd|^|fffd||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim SaveSheet As Worksheet
    Set SaveSheet = Sheets("SypnFile")
    
Dim SendFileName As String
    

Dim LastIndex As Long
    LastIndex = Sheets("SypnFile").Cells(Rows.count, 1).End(xlUp).Row

Dim MyFile As String

    SendFileName = "Delete" & Format(Now(), "YYYYMMDD") & "-" & Format(Now(), "hhmm") & "-" & Format(LastIndex - 3, "000")
'==============================================
Dim ws As Worksheet
Set ws = ThisWorkbook.Worksheets("SypnFile")
Dim OutPutPass As String
    OutPutPass = Sheets("Config").Cells(122, 2)
Dim datFile As String
    datFile = OutPutPass & "\" & SendFileName & ".txt"


 
Open datFile For Output As #1
 
Dim i As Long
i = 1
Do While ws.Cells(i, 1).value <> ""
    Application.StatusBar = "|fffd||d3dc||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|@" & i & "/" & LastIndex
    Print #1, ws.Cells(i, 1).value & vbTab _
            & ws.Cells(i, 2).value & vbTab _
            & ws.Cells(i, 3).value & vbTab _
            & ws.Cells(i, 4).value & vbTab _
            & ws.Cells(i, 5).value & vbTab _
            & ws.Cells(i, 6).value & vbTab _
            & ws.Cells(i, 7).value & vbTab _
            & ws.Cells(i, 8).value & vbTab _
            & ws.Cells(i, 9).value & vbTab _
            & ws.Cells(i, 10).value & vbTab _
            & ws.Cells(i, 11).value & vbTab _
            & ws.Cells(i, 12).value & vbTab _
            & ws.Cells(i, 13).value & vbTab _
            & ws.Cells(i, 14).value & vbTab _
            & ws.Cells(i, 15).value & vbTab _
            & ws.Cells(i, 16).value
    i = i + 1
Loop
 
Close #1
 
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module13"
Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Sub Button26_Click()
Sheets("Picking").Select
End Sub

Sub DM|fffd||597|p|fffd||fffd|CSV|fffd||c42c|()

Dim wsout As Worksheet
    Set wsout = Sheets("YamatoDM")

Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
    
Dim DMX As Long
    DMX = wsout.Cells(Rows.count, 1).End(xlUp).Row
    
    If DMX > 1 Then
        wsout.Rows("2:" & DMX).ClearContents
    End If

Dim NO As Long
    NO = 1
Dim ShippingDay As String
    ShippingDay = Format(Now() + Sheets("TOP").Cells(29, 2), "YYYYMMDD")
Dim Yamato As String
    Yamato = "Y" & ShippingDay & "-" & Format(Now(), "hhmmss")
Dim YamatoNO As String
Dim SendPattern As String
    SendPattern = "3"

Dim Tel As String
Dim Name As String
Dim Zip As String
Dim Address As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String

Dim OrderId As String
Dim ItemID As String
Dim Number As Long
Dim Carrier As String
    Carrier = Sheets("Config").Cells(44, 2)
Dim SendMethod As String
    SendMethod = Sheets("Config").Cells(45, 2)
    
Dim LastIndex As Long
    LastIndex = wsin.Cells(Rows.count, 1).End(xlUp).Row
    
    For i = 2 To LastIndex
        DMX = wsout.Cells(Rows.count, 1).End(xlUp).Row + 1
        NO = DMX - 1
        YamatoNO = Yamato & "-" & Format(NO, "000")
        Tel = "=""" & wsin.Cells(i, 7) & """"
        OrderId = wsin.Cells(i, 1)
        ItemID = wsin.Cells(i, 2)
        Number = wsin.Cells(i, 10)
        Name = wsin.Cells(i, 17)
        Zip = wsin.Cells(i, 23)
        Address = wsin.Cells(i, 22) & wsin.Cells(i, 21) & wsin.Cells(i, 18) & wsin.Cells(i, 19) & wsin.Cells(i, 20)
        Address = StrConv(Address, vbNarrow)
        If Len(Address) <= 32 Then
            Address1 = Address
            Address2 = Empty
        Else
            Address1 = Left(Address, 32)
            Address2 = Mid(Address, 33, Len(Address) - 32)
            If Len(Address2) > 16 Then
                Address2 = Left(Address2, 16)
                Address3 = Mid(Address2, 17, Len(Address) - 16)
                If Len(Address3) + Len(Name) + 1 <= 16 Then
                    Name = Address3 & " " & Name
                Else
                    MsgBox NO & "|fffd||96||682||312||fffd||fffd||fffd|" & vbLf & vbLf & Address3 & "|fffd||fffd|" & 16 - Len(Name) - 1 & "|fffd||fffd||fffd||fffd||fffd||213||fffd||fffd||24e||fffd||fffd||7c2||109||fffd||fffd||fffd||fffd||fffd|"
                End If
            End If
        End If
        
        wsout.Cells(DMX, 1) = YamatoNO
        wsout.Cells(DMX, 2) = ShippingDay
        wsout.Cells(DMX, 3) = SendPattern
        wsout.Cells(DMX, 4) = Tel
        wsout.Cells(DMX, 5) = Name
        wsout.Cells(DMX, 6) = Zip
        wsout.Cells(DMX, 7) = Address1
        wsout.Cells(DMX, 8) = Address2
        wsout.Cells(DMX, 9) = OrderId
        wsout.Cells(DMX, 10) = Format(ItemID, "00000000000000")
        wsout.Cells(DMX, 11) = Number
        wsout.Cells(DMX, 12) = Format(Now() + Sheets("TOP").Cells(29, 2), "YYYY-MM-DD")
        wsout.Cells(DMX, 13) = "Other"
        wsout.Cells(DMX, 14) = Carrier
        wsout.Cells(DMX, 16) = SendMethod
    DoEvents
    Next
    
    Call YamatoCSV(Yamato)
    
    MsgBox Yamato & ".csv |fffd||143||fffd||fffd|}|fffd|g|fffd|p|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||102||fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf _
                    & Yamato & "|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||112||1d0||554||50d||fffd||fffd||fffd||fffd|i|fffd||835e||fffd||fffd||fffd|CSV|fffd||fffd||fffd|Q|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & vbLf _
                    & "|fffd||fffd||fffd|}|fffd|g|fffd||fffd||fffd||fffd||fffd|CSV|fffd||fffd||fffd|p|fffd||4c2||142||fffd||fffd||fffd||fffd||fffd|OK|fffd||fffd||fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
    
    Application.Run "|fffd||fffd||fffd|}|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
    Application.Run "|fffd||fffd||fffd|}|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd||fffd||fffd||fffd||fffd|"
    Application.Run "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|"
    
End Sub

Function YamatoCSV(Yamato As String)
Dim ws As Worksheet
Set ws = ThisWorkbook.Worksheets("YamatoDM")
Dim OutPutPass As String
    OutPutPass = Sheets("Config").Cells(126, 2)
Dim datFile As String
    datFile = OutPutPass & "\" & Yamato & ".csv"


 
Open datFile For Output As #1
 
Dim i As Long
i = 1
Do While ws.Cells(i, 1).value <> ""
    Application.StatusBar = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|@" & i & "/" & LastIndex
    Print #1, ws.Cells(i, 1).value & "," _
            & ws.Cells(i, 2).value & "," _
            & ws.Cells(i, 3).value & "," _
            & ws.Cells(i, 4).value & "," _
            & ws.Cells(i, 5).value & "," _
            & ws.Cells(i, 6).value & "," _
            & ws.Cells(i, 7).value & "," _
            & ws.Cells(i, 8).value
    i = i + 1
Loop
 
Close #1

End Function


Sub |fffd||fffd||fffd|}|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------

Dim YamatoFullPath As String

'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||310||752||fffd|----------------------------------

If Sheets("Config").Cells(129, 2) = "|fffd|C|fffd||fffd||fffd|X|fffd|g|fffd|[|fffd||fffd||fffd|^" Then
    YamatoFullPath = Sheets("Config").Range("B128")
Else
    Dim Path As String
        Path = Sheets("Config").Range("B128") & "\"
    Dim YamatoBuf As String
        YamatoBuf = Dir(Path & "*_|fffd||fffd||fffd|s|fffd||3c3|f|fffd|[|fffd|^.csv")
    
    Dim YamatoName As Currency
    
        Do While YamatoBuf <> ""
                YamatoName = Application.WorksheetFunction.Max(YamatoName, Left(YamatoBuf, 14))
           
            YamatoBuf = Dir()
            DoEvents
        Loop
    YamatoFullPath = Path & YamatoName & "_|fffd||fffd||fffd|s|fffd||3c3|f|fffd|[|fffd|^.csv"
End If

Dim YamatoX As Long

'|fffd||fffd||fffd|}|fffd|g|fffd||fffd|CSV|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("YamatoTracking").Columns("A:I").ClearContents

'|fffd|^|fffd|u|fffd||fffd||602||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|S|fffd||115||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113||1c2||74d||fffd||fffd||fffd|

    Dim FileName As String
    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd|
    FileName = YamatoFullPath


        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("YamatoTracking").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FileName))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FileName For Input As #FileNo
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            Cnt = Cnt + 1
            SplitString = Split(Buf, ",")
            For i = 0 To UBound(SplitString)
                Sheets("YamatoTracking").Cells(Cnt, i + 1) = SplitString(i)
            Next i
            Application.StatusBar = "|fffd||fffd||fffd|}|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
        Loop
        Application.StatusBar = ""
        Close #FileNo
    Application.ScreenUpdating = True
End Sub

Sub |fffd||fffd||fffd|}|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd||fffd||fffd||fffd||fffd|()

Dim TrkNo As String
Dim AuthNO As String

Dim wsin As Worksheet
    Set wsin = Sheets("YamatoTracking")
Dim wsout As Worksheet
    Set wsout = Sheets("YamatoDM")

Dim RowNum As Long
    
Dim LastIndex As Long
    LastIndex = wsin.Cells(Rows.count, 1).End(xlUp).Row
    
Dim TrkCol As Long
    TrkCol = wsin.Rows(1).Find("""|fffd|`|fffd|[|fffd||50d||fffd|""").Column
Dim AuthCol As Long
    AuthCol = wsin.Rows(1).Find("""|fffd||fffd||fffd|q|fffd|l|fffd||1d7||fffd||fffd||50d||fffd|""").Column
    
    For i = 2 To LastIndex
        TrkNo = wsin.Cells(i, TrkCol)
        TrkNo = Mid(TrkNo, 2, Len(TrkNo) - 2)
        AuthNO = wsin.Cells(i, AuthCol)
        AuthNO = Mid(AuthNO, 2, Len(AuthNO) - 2)
        
        RowNum = wsout.Columns("A:A").Find(AuthNO).Row
        wsout.Cells(RowNum, 15) = Format(TrkNo, "000000000000")
    DoEvents
    Next
    
    LastIndex = wsout.Cells(Rows.count, 1).End(xlUp).Row
    
Dim SendFileX As Long
    SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row
    
    If SendFileX > 3 Then
        Sheets("SendFile").Rows("4:" & SendFileX).ClearContents
    End If
    
    
    For n = 2 To LastIndex
        For m = 1 To 9
            Sheets("SendFile").Cells(n + 2, m) = wsout.Cells(n, m + 8)
        DoEvents
        Next
    DoEvents
    Next

End Sub

Sub |fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd|o|fffd||fffd|()

Dim Fin As Long
    Fin = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim CpX As Long
    CpX = Sheets("ClickPost").Cells(Rows.count, 1).End(xlUp).Row
    If CpX > 1 Then
        Sheets("ClickPost").Rows("2:" & CpX).ClearContents
    End If

Dim Zip As String
Dim Address(6) As String
Dim Name As String
Dim Product As String
    Product = "|fffd|{|fffd|E|fffd|b|fffd|c|fffd|E|fffd|c|fffd|u|fffd|c|fffd||fffd|"
Dim SpellLen As Long


Dim OrderId As String
Dim ItemID As String
Dim SendFileX As Long
    SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row
    If SendFileX > 3 Then
        Sheets("SendFile").Rows("4:" & SendFileX).ClearContents
    End If

    For i = 2 To Fin
        Application.StatusBar = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd||c42c||fffd||fffd|"
        If Sheets("ChumonReport").Cells(i, 1) = "" Then
            GoTo labelSKIP
        End If
        CpX = Sheets("ClickPost").Cells(Rows.count, 1).End(xlUp).Row + 1
        SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row + 1
        
       
        
        '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|p|fffd||fffd||5228f|o
        Zip = Sheets("ChumonReport").Cells(i, 23)
        Address(1) = Sheets("ChumonReport").Cells(i, 22)
        Address(2) = Sheets("ChumonReport").Cells(i, 21)
        Address(3) = Sheets("ChumonReport").Cells(i, 18)
        Address(4) = Sheets("ChumonReport").Cells(i, 19)
        Address(5) = Sheets("ChumonReport").Cells(i, 20)
        Name = Sheets("ChumonReport").Cells(i, 17)
        
        '|fffd|S|fffd|p20|fffd||fffd||fffd||fffd||fffd||213||fffd||fffd||250||fffd||fffd|`
        Address(0) = Address(1) + Address(2) + Address(3) + Address(4) + Address(5)
        Address(1) = ""
        Address(2) = ""
        Address(3) = ""
        Address(4) = ""
        Address(5) = ""
        For n = 0 To 3
            If Len(Address(n)) > 20 Then
                SpellLen = Len(Address(n))
                Address(n + 1) = Mid(Address(n), 21, SpellLen - 20)
                Address(n) = Left(Address(n), 20)
            End If
        Next
                
        Sheets("ClickPost").Cells(CpX, 1) = Zip
        Sheets("ClickPost").Cells(CpX, 2) = Name
        Sheets("ClickPost").Cells(CpX, 3) = "|fffd|l"
        Sheets("ClickPost").Cells(CpX, 4) = Address(0)
        Sheets("ClickPost").Cells(CpX, 5) = Address(1)
        Sheets("ClickPost").Cells(CpX, 6) = Address(2)
        Sheets("ClickPost").Cells(CpX, 7) = Address(3)
        Sheets("ClickPost").Cells(CpX, 8) = Product
        
        Zip = Empty
        Name = Empty
        Address(0) = Empty
        Address(1) = Empty
        Address(2) = Empty
        Address(3) = Empty
        Address(4) = Empty
        Address(5) = Empty
        
        '40|fffd||fffd||fffd||c2||82||255||fffd||fffd||fffd|
        If CpX = 41 Or i = Fin Then
         Sleep 1000
            Application.Run "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|"
            If i <> Fin Then
                Sheets("ClickPost").Rows("2:" & CpX).ClearContents
            End If
        End If
        
labelSKIP:
    DoEvents
    Next
End Sub

Sub |fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd|pCSV|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|()

Dim LastIndex As Long
    LastIndex = Sheets("ClickPost").Cells(Rows.count, 1).End(xlUp).Row

Dim CPFileName As String
    CPFileName = "clickpost" & Format(Now(), "YYMMDD") & "-" & Format(Now(), "hhmmss")
'==============================================

Dim OutPutPass As String
    OutPutPass = ActiveWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|O|fffd||fffd||fffd|A|fffd|gCSV"
Dim datFile As String
    datFile = ActiveWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|O|fffd||fffd||fffd|A|fffd|gCSV\" & CPFileName & ".csv"
Dim ws As Worksheet
Set ws = ThisWorkbook.Worksheets("ClickPost")

 
Open datFile For Output As #1
 
Dim i As Long
i = 1
Do While ws.Cells(i, 1).value <> ""
    Application.StatusBar = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|@" & i & "/" & LastIndex
    Print #1, ws.Cells(i, 1).value & "," _
            & ws.Cells(i, 2).value & "," _
            & ws.Cells(i, 3).value & "," _
            & ws.Cells(i, 4).value & "," _
            & ws.Cells(i, 5).value & "," _
            & ws.Cells(i, 6).value & "," _
            & ws.Cells(i, 7).value & "," _
            & ws.Cells(i, 8).value
    i = i + 1
Loop
 
Close #1
 
Application.StatusBar = ""
Application.StatusBar = OutPutPass & "|fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|u" & CPFileName & ".csv|fffd|v|fffd||141|A|fffd|o|fffd|i|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"

'==============================================
End Sub
Attribute VB_Name = "Module14"

Public Declare Sub UrlSign Lib "Sign.dll" (ByVal Url As String, ByVal SignedUrl As String, ByVal SecretKey As String)
'advapi32.dll
'http://su-u.jp/juju/%B5%A4%A4%DE%A4%B0%A4%EC%C6%FC%B5%AD/2007-03-08.html
Private Declare Function CryptAcquireContext Lib "advapi32.dll" Alias "CryptAcquireContextA" _
                            (ByRef phProv As Long, ByVal pszContainer As String, ByVal pszProvider As String, _
                             ByVal dwProvType As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptReleaseContext Lib "advapi32.dll" _
                            (ByVal hProv As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptCreateHash Lib "advapi32.dll" _
                            (ByVal hProv As Long, ByVal Algid As Long, ByVal hKey As Long, ByVal dwFlags As Long, _
                             ByRef phHash As Long) As Long
Private Declare Function CryptDestroyHash Lib "advapi32.dll" _
                            (ByVal hHash As Long) As Long
Private Declare Function CryptHashData Lib "advapi32.dll" _
                            (ByVal hHash As Long, pbData As Any, ByVal cbData As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptGetHashParam Lib "advapi32.dll" _
                            (ByVal hHash As Long, ByVal dwParam As Long, pbData As Any, ByRef pcbData As Long, _
                             ByVal dwFlags As Long) As Long
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMs As Long)

Private Const PROV_RSA_FULL   As Long = 1
Private Const PROV_RSA_AES    As Long = 24
Private Const CRYPT_VERIFYCONTEXT As Long = &HF0000000

Private Const HP_HASHVAL      As Long = 2
Private Const HP_HASHSIZE     As Long = 4

Private Const ALG_TYPE_ANY    As Long = 0
Private Const ALG_CLASS_HASH  As Long = 32768

Private Const ALG_SID_MD2     As Long = 1
Private Const ALG_SID_MD4     As Long = 2
Private Const ALG_SID_MD5     As Long = 3
Private Const ALG_SID_SHA     As Long = 4
Private Const ALG_SID_SHA_256 As Long = 12
Private Const ALG_SID_SHA_384 As Long = 13
Private Const ALG_SID_SHA_512 As Long = 14

Private Const CALG_MD2        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD2)
Private Const CALG_MD4        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD4)
Private Const CALG_MD5        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD5)
Private Const CALG_SHA        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA)
Private Const CALG_SHA_256    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_256)
Private Const CALG_SHA_384    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_384)
Private Const CALG_SHA_512    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_512)

'/////////////////////////////////////////////////////////////////////////////////////////////

' Create Hash
Private Function CreateHash(abytData() As Byte, ByVal lngAlgID As Long) As String
    Dim hProv As Long, hHash As Long
    Dim abytHash(0 To 63) As Byte
    Dim lngLength As Long
    Dim lngResult As Long
    Dim strHash As String
    Dim i As Long
    strHash = ""
    If CryptAcquireContext(hProv, vbNullString, vbNullString, _
                           IIf(lngAlgID >= CALG_SHA_256, PROV_RSA_AES, PROV_RSA_FULL), _
                           CRYPT_VERIFYCONTEXT) <> 0& Then
        If CryptCreateHash(hProv, lngAlgID, 0&, 0&, hHash) <> 0& Then
            lngLength = UBound(abytData()) - LBound(abytData()) + 1
            If lngLength > 0 Then lngResult = CryptHashData(hHash, abytData(LBound(abytData())), lngLength, 0&) _
                             Else lngResult = CryptHashData(hHash, ByVal 0&, 0&, 0&)
            If lngResult <> 0& Then
                lngLength = UBound(abytHash()) - LBound(abytHash()) + 1
                If CryptGetHashParam(hHash, HP_HASHVAL, abytHash(LBound(abytHash())), lngLength, 0&) <> 0& Then
                    For i = 0 To lngLength - 1
                        strHash = strHash & Right$("0" & Hex$(abytHash(LBound(abytHash()) + i)), 2)
                    Next
                End If
            End If
            CryptDestroyHash hHash
        End If
        CryptReleaseContext hProv, 0&
    End If
    CreateHash = LCase$(strHash)
End Function

' Create Hash From String(Shift_JIS)
Private Function CreateHashString(ByVal strData As String, ByVal lngAlgID As Long) As String
    CreateHashString = CreateHash(StrConv(strData, vbFromUnicode), lngAlgID)
End Function

' Create Hash From File
Private Function CreateHashFile(ByVal strFileName As String, ByVal lngAlgID As Long) As String
    Dim abytData() As Byte
    Dim intFile As Long
    Dim lngError As Long
    On Error Resume Next
        If Len(Dir(strFileName)) > 0 Then
            intFile = FreeFile
            Open strFileName For Binary Access Read Shared As #intFile
            abytData() = InputB(LOF(intFile), #intFile)
            Close #intFile
        End If
        lngError = Err.Number
    On Error GoTo 0
    If lngError = 0 Then CreateHashFile = CreateHash(abytData(), lngAlgID) _
                    Else CreateHashFile = ""
End Function

' MD5
Public Function CreateMD5Hash(abytData() As Byte) As String
    CreateMD5Hash = CreateHash(abytData(), CALG_MD5)
End Function
Public Function CreateMD5HashString(ByVal strData As String) As String
    CreateMD5HashString = CreateHashString(strData, CALG_MD5)
End Function
Public Function CreateMD5HashFile(ByVal strFileName As String) As String
    CreateMD5HashFile = CreateHashFile(strFileName, CALG_MD5)
End Function

' SHA-1
Public Function CreateSHA1Hash(abytData() As Byte) As String
    CreateSHA1Hash = CreateHash(abytData(), CALG_SHA)
End Function
Public Function CreateSHA1HashString(ByVal strData As String) As String
    CreateSHA1HashString = CreateHashString(strData, CALG_SHA)
End Function
Public Function CreateSHA1HashFile(ByVal strFileName As String) As String
    CreateSHA1HashFile = CreateHashFile(strFileName, CALG_SHA)
End Function

' SHA-256
Public Function CreateSHA256Hash(abytData() As Byte) As String
    CreateSHA256Hash = CreateHash(abytData(), CALG_SHA_256)
End Function
Public Function CreateSHA256HashString(ByVal strData As String) As String
    CreateSHA256HashString = CreateHashString(strData, CALG_SHA_256)
End Function
Public Function CreateSHA256HashFile(ByVal strFileName As String) As String
    CreateSHA256HashFile = CreateHashFile(strFileName, CALG_SHA_256)
End Function

' SHA-384
Public Function CreateSHA384Hash(abytData() As Byte) As String
    CreateSHA384Hash = CreateHash(abytData(), CALG_SHA_384)
End Function
Public Function CreateSHA384HashString(ByVal strData As String) As String
    CreateSHA384HashString = CreateHashString(strData, CALG_SHA_384)
End Function
Public Function CreateSHA384HashFile(ByVal strFileName As String) As String
    CreateSHA384HashFile = CreateHashFile(strFileName, CALG_SHA_384)
End Function

' SHA-512
Public Function CreateSHA512Hash(abytData() As Byte) As String
    CreateSHA512Hash = CreateHash(abytData(), CALG_SHA_512)
End Function
Public Function CreateSHA512HashString(ByVal strData As String) As String
    CreateSHA512HashString = CreateHashString(strData, CALG_SHA_512)
End Function
Public Function CreateSHA512HashFile(ByVal strFileName As String) As String
    CreateSHA512HashFile = CreateHashFile(strFileName, CALG_SHA_512)
End Function

'/////////////////////////////////////////////////////////////////////////

Function URLhenkan(Str As String) As String
Set sc = CreateObject("ScriptControl")
sc.Language = "Jscript"
Set js = sc.CodeObject
URLhenkan = js.encodeURIComponent(Str)
End Function
'Hmac-SHA256
'http://plus-sys.jugem.jp/?eid=215
Public Function Hmac(sKey, rawTextToSign As String) As String

Dim arKey() As Byte
Dim ipad As String
Dim opad As String
Dim buff() As Byte, offset As Long

'|fffd||fffd||fffd||fffd||fffd||fffd|
    ipad = ""
    opad = ""
    hash = ""
    ReDim arKey(0 To 63)

'|fffd||95a7||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||c2||93||1cd||fffd||fffd||741|A|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||595||3ca||fffd||fffd||fffd|z|fffd||fffd||58a|i|fffd|[
    For i = 0 To Len(sKey) - 1
        arKey(i) = Asc(Mid(sKey, i + 1, 1))
    Next

'64|fffd||fffd||fffd||fffd||fffd||256||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||341|A|fffd|[|fffd||fffd||fffd|Z|fffd|b|fffd|g
    For i = Len(sKey) To 63
        arKey(i) = 0
    Next

'innerpad|fffd|y|fffd||fffd|outerpad|fffd||c42c|
    For i = 0 To 63
        ipad = ipad & Chr(arKey(i) Xor &H36)
        opad = opad & Chr(arKey(i) Xor &H5C)
    Next

'|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd|
'(innerpad+|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd||fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|E|fffd|E|fffd|E|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|1
    hash = CreateSHA256HashString(ipad & rawTextToSign)

'|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd|
    buff = StrConv(opad, vbFromUnicode)
    offset = UBound(buff)
    ReDim Preserve buff(offset + Len(hash) \ 2)

    For i = 1 To (Len(hash) \ 2)
        buff(offset + i) = CByte("&H" & Mid(hash, (i - 1) * 2 + 1, 2))
    Next
    hash = CreateSHA256Hash(buff)
    Hmac = hash

End Function
Public Function HEX2BIN(ByVal hx As String) As String
    Dim num As Long
    Dim bin As String
    Dim i As Long
    num = CLng("&H" & hx)
        For i = Len(hx) * 4 - 1 To 0 Step -1
            bin = bin & -CInt((num And (2 ^ i)) <> 0)
        Next
    HEX2BIN = bin
End Function
'n|fffd|i|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|strNumber|fffd||fffd|10|fffd|i|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||255||3ca||fffd||fffd||fffd||fffd||115||502||fffd|
'http://www5d.biglobe.ne.jp/~tomoya03/shtml/algorithm/Convert.htm
Public Function ncdec(ByVal n As Long, ByVal strNumber As String) As Long

    Dim lngt As Long
    Dim c As Long
    Dim i As Long
    lngt = 0&
    c = 1&
    For i = 1& To Len(strNumber)
        lngt = lngt + subncdec(Left$(Right$(strNumber, i), 1)) * c
        c = c * n
    Next i
    ncdec = lngt

End Function
'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
'http://www.geocities.co.jp/SilkRoad/4511/vb/urlenc.htm
Public Function URLencode(ByRef strSource As String) As String

 Dim lngLength As Long                                          '|fffd||fffd||fffd||fffd||fffd||fffd||303|T|fffd|C|fffd|Y(S-JIS |fffd||3ca||fffd||fffd||fffd|)|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim bytSource() As Byte                                        'ANSI/S-JIS |fffd||255||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|^|fffd|z|fffd||fffd|
 Dim strBuffer As String                                        'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@
 Dim bytSingle As Byte                                          '|fffd|z|fffd||42a42||7532||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim strSingleHex As String                                     '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim lngReadCount As Long                                       'bytSource |fffd||1c2||74d||fffd||fffd||748||292|u|fffd|J|fffd|E|fffd||fffd||fffd|^
 Dim lngWriteCount As Long                                      'strBuffer |fffd||fffd||fffd||fffd||fffd||fffd||fffd||748||292|u|fffd|J|fffd|E|fffd||fffd||fffd|^
 
    lngLength = LenB(StrConv(strSource, vbFromUnicode))         'ANSI/S-JIS |fffd||3ca||fffd||fffd||fffd||303|T|fffd|C|fffd|Y|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    If Not CBool(lngLength) Then Exit Function                  '0 |fffd|o|fffd|C|fffd|g|fffd||30f||a347||fffd||590||fffd||fffd||14c82||fffd||fffd||fffd|
    ReDim bytSource(lngLength - 1)                              'ANSI/S-JIS |fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||308||fffd||fffd||fffd|m|fffd||fffd|
    bytSource = StrConv(strSource, vbFromUnicode)               'ANSI/S-JIS |fffd||255||3ca||fffd||fffd||fffd| bytSource |fffd||24a|i|fffd|[
    
    strBuffer = String$(lngLength * 3, vbNullChar)              'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|i|fffd|[|fffd|o|fffd|b|fffd|t|fffd|@|fffd||fffd||fffd|m|fffd||fffd|
    strSingleHex = "%00"                                        '16 |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||fffd||fffd|m|fffd||fffd|
    lngWriteCount = 1                                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||fffd|J|fffd|n
    
    Do                                                          '|fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd|[|fffd||702||143||fffd||fffd|[|fffd|v
        bytSingle = bytSource(lngReadCount)                     '|fffd|z|fffd||42a42||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||fffd||fffd||846c||fffd||fffd||fffd|H)
        If ((bytSingle >= &H81) And (bytSingle <= &H9F)) Or _
           ((bytSingle >= &HE0) And (bytSingle <= &HEF)) Then   'Shift-JIS 2 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||18a|m|fffd|F|fffd||fffd||fffd||a0bd||fffd||a347|
            Mid(strSingleHex, 2, 2) = Hex$(bytSingle)           '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|(|fffd||fffd||283|o|fffd|C|fffd|g)
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
            If lngReadCount = lngLength Then Exit Do            '|fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd|[|fffd||252|B|fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            bytSingle = bytSource(lngReadCount)                 '|fffd|z|fffd||42a42||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd|
            Mid(strSingleHex, 2, 2) = Hex$(bytSingle)           '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|(|fffd||fffd||fffd||283|o|fffd|C|fffd|g)
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
        ElseIf bytSingle = &H20 Then                            '|fffd||fffd||fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd|(" ")|fffd||30f||a347|
            Mid(strBuffer, lngWriteCount, 1) = "+"              '"+" |fffd||fffd||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 1                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||20b7|
        ElseIf ((bytSingle >= &H40) And (bytSingle <= &H5A)) Or _
               ((bytSingle >= &H61) And (bytSingle <= &H7A)) Or _
               ((bytSingle >= &H30) And (bytSingle <= &H39)) Or _
               (bytSingle = &H2A) Or _
               (bytSingle = &H2D) Or _
               (bytSingle = &H2E) Or _
               (bytSingle = &H5F) Then                          '|fffd||fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||a347|
            Mid(strBuffer, lngWriteCount, 1) = Chr$(bytSingle)  '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||15d8e||fffd||fffd||fffd||256||7c2||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(^^;
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 1                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||20b7|
        Else                                                    '|fffd||fffd||fffd||311||fffd||fffd||315||fffd||fffd||fffd||fffd||30f||a347|
            If bytSingle <= &HF Then                            'Hex$() |fffd||30c||fffd||fffd||282||fffd| 1 |fffd||fffd||fffd||fffd||fffd||242||202||fffd||a347|
                Mid(strSingleHex, 2, 1) = "0"                   '0 |fffd||fffd||64ea||fffd||255|t|fffd||fffd|
                Mid(strSingleHex, 3, 1) = Hex$(bytSingle)       '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|
            Else                                                '0 |fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||202||fffd||fffd||a347|
                Mid(strSingleHex, 2, 2) = Hex$(bytSingle)       '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|
            End If
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
        End If
    Loop Until lngReadCount = lngLength

    Erase bytSource                                             '|fffd|o|fffd|C|fffd|g|fffd|^|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If lngWriteCount > 1 Then                                   '|fffd|o|fffd|b|fffd|t|fffd|@|fffd||255||fffd||fffd||fffd||fffd||42a8f||fffd||fffd||fffd||fffd||fffd||fffd||702||a0bd||fffd||a347|
        URLencode = Left$(strBuffer, lngWriteCount - 1)         '|fffd|o|fffd|b|fffd|t|fffd|@|fffd||317|]|fffd||fffd||fffd||215||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||7c2||fffd|l|fffd||182||fffd||fffd||fffd|
    End If

End Function
Public Function subncdec(ByVal b As String) As Long
    
    Dim R As Long
    R = Asc(UCase(b))
    If R > 64& Then
        subncdec = R - 55&
    Else
        subncdec = CLng(b)
    End If
    
End Function
'////////////////////////////////////////////////////////////////////////////////////////////////////////

Function AmazonFee(SKU As String, SypnPrice As Long, SendPrice As Long)



Dim FullFillment As String
    FullFillment = "false"
Dim FeeRatio As Long
Dim AbsolutedFee As Long


'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||315||3d0||fffd|------------------------------------------------
Dim Url As String
Dim xmldata As Object
Dim Result As Object
Dim tmpPrice As Double
Dim tmpObj As Object
Dim rawText As String
Dim timestamp As String
Dim SignedUrl As String

'******************************
Dim MWSsKey As String
    MWSsKey = Worksheets("Config").Range("B52")
Dim sKey As String
    sKey = Worksheets("Debug").Range("B4")
Dim AWSkey As String
    AWSkey = Worksheets("Debug").Range("B3")
Dim MarketPlaceID As String
    MarketPlaceID = "A1VC38T7YXB528"
Dim sellerID As String
    sellerID = Worksheets("Config").Range("B53")
'******************************
Dim SelfExclude As String
    SelfExclude = "False"

Dim ItemCondition As String
    ItemCondition = "All"

Dim Action As String
    Action = "GetMyFeesEstimate"

Dim APIVersion As String
    APIVersion = "2011-10-01"
    
Dim ecsaddress As String
    ecsaddress = "mws.amazonservices.jp"
   
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||302||fffd||fffd||7c2||315||3d0||fffd|-----------------------------------------------------
Dim hash, hash_2, hash_cut2, hash_10, hash_cut10 As String
Dim base64Array As Variant
Dim base64Array2 As Variant
Dim sign As String
Dim sign2 As String
Dim rawTextToSign As String
Dim rawTextToSign2 As String

Dim i As Long, j As Long, k As Long

'-------------------------------------------------------
'|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|v|fffd||fffd||fffd|W|fffd|F|fffd|N|fffd|g|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||315|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|Amazon2excel|fffd||fffd||149|E|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||101|A
'|fffd|@|fffd||6cc||fffd|^|fffd|u|fffd|`|fffd|v|fffd||fffd||fffd|W|fffd|F|fffd|N|fffd|g|fffd|\|fffd||fffd||fffd|p|fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||90b1||fffd||181|B
'|fffd|@|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||315||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd|13|fffd|P|fffd|^|fffd||20f||fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||392||fffd||fffd||fffd||fffd||642||1c2||60a2||fffd|`|fffd||242||fffd||fffd||90b1||fffd||181|B
ChDrive ActiveWorkbook.Path
ChDir ActiveWorkbook.Path
'--------------------------------------
'

'|fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|MWS|fffd|f|fffd|[|fffd|^|fffd||64fe|================================================================================================================
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||24e|g|fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|v---------------------------------------------------------------------------------
If Format(Now(), "hh") >= 9 Then
    timestamp = Format(Date, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
Else
    timestamp = Format(Date - 1, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
End If


'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd|iGetMyPriceForSKU|fffd|A10/sec)***********************

    Dim xmldata3 As Object
    Dim Result3 As Object
    
    rawText = ""
        ' |fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||c42c|(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||343|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||fffd||fffd||202||302||14f||fffd||fffd||502||fffd||3c2||fffd||fffd||fffd||fffd|NG)
        rawText = rawText _
                & "AWSAccessKeyId=" & AWSkey _
                & "&Action=" & Action _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IdType=SellerSKU" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IdValue=" & SKU _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.Identifier=request1" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IsAmazonFulfilled=" & FullFillment _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.MarketplaceId=" & MarketPlaceID _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.Amount=" & SypnPrice _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.CurrencyCode=JPY" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsMonetaryValue.Amount=0" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsMonetaryValue.CurrencyCode=JPY" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsNumber=0" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Shipping.Amount=" & SendPrice _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Shipping.CurrencyCode=JPY" _
                & "&MWSAuthToken=" & MWSsKey _
                & "&SellerId=" & sellerID _
                & "&SignatureMethod=HmacSHA256" _
                & "&SignatureVersion=2" _
                & "&Timestamp=" & timestamp _
                & "&Version=" & APIVersion
       
        rawTextToSign = "GET" & vbLf & ecsaddress & vbLf & "/Products/2011-10-01" & vbLf & rawText
        hash = Hmac(sKey, rawTextToSign)
        
'|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|URL|fffd||30d||c42c|-----------------------------------------------------------------

        '2|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
        hash_2 = ""
        For k = 1 To 64 Step 2
            hash_cut2 = Mid(hash, k, 2)
            hash_2 = hash_2 & HEX2BIN(hash_cut2)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|00|fffd||156||fffd||fffd||7c2||fffd|
        hash_2 = hash_2 & "00"
          
        'BASE64|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = ""
        For k = 1 To 256 Step 6
            hash_cut10 = Mid(hash_2, k, 6)
            hash_10 = ncdec(2, hash_cut10)
            base64Array = Array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "+", "/")
            sign = sign & base64Array(hash_10)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|=|fffd||156||fffd||fffd||7c2||fffd|
        sign = sign & "="
        'URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = URLencode(sign)
        Url = "https://" & ecsaddress & "/Products/2011-10-01?" & rawText & "&Signature=" & sign
        
        '|fffd|f|fffd|o|fffd|b|fffd|O|fffd|p
        If Sheets("Debug").Cells(1, 3) = "ON" Then
            Sheets("Debug").Cells(1, 2) = Url
        End If
    
'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s---------------------------------------
    Set xmldata3 = CreateObject("Microsoft.XMLDOM")
    xmldata3.async = False
    xmldata3.Load Url
'XML|fffd|f|fffd|[|fffd|^|fffd||30e||fffd||fffd|o|fffd||fffd|-------------------------------------
    Set Result3 = xmldata3.SelectNodes("GetMyFeesEstimateResponse/GetMyFeesEstimateResult/FeesEstimateResultList/FeesEstimateResult/FeesEstimate/FeeDetailList/FeeDetail")
'Dim AbsolutedFee As Long
'Dim BuyPrice As Long
'Dim FeeRatio As Long
'Dim ProfitRatio As Long
'Dim ProfitPlus As Long
        AbsolutedFee = Empty
    If Not Result3 Is Nothing Then '|fffd||64fe||fffd||fffd||42a82||fffd||fffd||fffd||381|A
            If Not Result3(0) Is Nothing Then
                FeeRatio = Int(Result3(0).SelectSingleNode("FinalFee/Amount").Text * 1.08)
                'FeeRatio = Application.WorksheetFunction.RoundUp((FeeRatio / SypnPrice * 100), 0)
                AbsolutedFee = Result3(1).SelectSingleNode("FinalFee/Amount").Text * 1.08
                If FullFillment = "true" Then
                    AbsolutedFee = AbsolutedFee + Result3(3).SelectSingleNode("FinalFee/Amount").Text * 1.08
                End If
                '|fffd||fffd||fffd||214|z|fffd||fffd||fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||317||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|v
            End If
    End If

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||30c|v|fffd|Z
    AmazonFee = AbsolutedFee + FeeRatio
    Sleep 200
End Function

Attribute VB_Name = "Module15"
Sub |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()


'|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||752||fffd|
Dim LabelPrinter As String
    LabelPrinter = Sheets("Config").Cells(5, 2)
'|fffd||38f||6c2||313||1c2||74d||fffd||fffd||fffd|
Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
Dim wsout As Worksheet
    Set wsout = Sheets("AutoLabel")
Dim Config As Worksheet
    Set Config = Sheets("Config")
Dim Fin As Long
    Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row
'|fffd||ce682||255|K|fffd|v|fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim OrderId As String
Dim SendMethod As String
Dim ZipCode As String
Dim Pref As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Address4 As String
Dim AddressText As String
Dim OverSeaAddressText As String
Dim Country As String
Dim CountryNotice As String
Dim Tracking As String
Dim Name As String
Dim Product As String
Dim SKU As String
Dim EAN As String
Dim City As String
Dim Region As String
Dim RegionNotice As String
'|fffd||fffd||fffd|X|fffd||702||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
Dim SelfZip As String
    SelfZip = Config.Cells(11, 2)
Dim MyAddress As String
    MyAddress = Config.Cells(12, 2) & " " & Config.Cells(10, 2)
Dim SendInfo1 As String
    SendInfo1 = Config.Cells(17, 2)
Dim SendInfo2 As String
    SendInfo2 = Config.Cells(17, 3)
'|fffd|C|fffd|O|fffd||30f||a347||fffd||30e||fffd||fffd||fffd||fffd||30f||fffd||fffd|
Dim OverSeaSendInfo1 As String
'    OverSeaSendInfo1 = Config.Cells(31, 3)
Dim OverSeaSendInfo2 As String
'    OverSeaSendInfo2 = Config.Cells(32, 3)
Dim OverSeaMyAddress As String
'    OverSeaMyAddress = Config.Cells(28, 3) & " " & Config.Cells(29, 3)
Dim RegionNum As Long
'|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|
Dim Position As Long
Dim RowNum As Long
Dim ColNum As Long
'////////////////////////////////////////
Dim v As Variant
    v = wsout.Range("A1:J59")

'1|fffd||fffd||fffd||fffd||fffd||30f||a347|
'If Sheets("Config").Cells(35, 2) = "1|fffd||fffd|" Then
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & "A4|fffd||fffd|10|fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|x|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Application.WorksheetFunction.RoundUp((Fin - 1) / 10, 0) & "|fffd||142||fffd||fffd|B"
'End If

Dim PacketCount As Long
    PacketCount = 0
    
    
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "sku") > 0 Then
            SkuCol = wsin.Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = wsin.Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-state") > 0 Then
            PrefCol = wsin.Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-1") > 0 Then
            Address1Col = wsin.Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-2") > 0 Then
            Address2Col = wsin.Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-3") > 0 Then
            Address3Col = wsin.Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "recipient-name") > 0 Then
            NameCol = wsin.Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            NameCol = 17
        End If
        
    Dim CountryCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-country") > 0 Then
            CountryCol = wsin.Rows(1).Find("ship-country", LookAt:=xlWhole).Column
        Else
            CountryCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-city") > 0 Then
            CityCol = wsin.Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If
        
    Dim AdOrderIdCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "order-id") > 0 Then
            AdOrderIdCol = wsin.Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            AdOrderIdCol = 1
        End If
    '---------------------------------
    

For i = 2 To Fin
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||30d||c42c||fffd||188||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@" & i - 1 & "/" & Fin - 1
    SKU = wsin.Cells(i, SkuCol)
    '|fffd|J|fffd|e|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||fffd||fffd||14f||fffd||fffd|i|fffd||fffd||fffd||fffd|
    
    ZipCode = "|fffd||fffd|" & wsin.Cells(i, ZipCodeCol)
    Pref = wsin.Cells(i, PrefCol)
    Address1 = wsin.Cells(i, Address1Col)
    Address2 = wsin.Cells(i, Address2Col)
    Address3 = wsin.Cells(i, Address3Col)
    Name = wsin.Cells(i, NameCol)
    Country = wsin.Cells(i, CountryCol)
    City = wsin.Cells(i, CityCol)
    
    
    '-----------------------
    '|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||1c9||fffd|
    Dim AdOrderId As String
        AdOrderId = wsin.Cells(i, AdOrderIdCol)
    Dim AdRow As Long
        If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), AdOrderId) > 0 Then
            AdRow = Sheets("AddressChange").Columns("A:A").Find(AdOrderId).Row
                ZipCode = "|fffd||fffd|" & Sheets("AddressChange").Cells(AdRow, 2)
                Pref = ""
                Address1 = Sheets("AddressChange").Cells(AdRow, 3)
                Address2 = ""
                Address3 = ""
                If Sheets("AddressChange").Cells(AdRow, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(AdRow, 4)
                End If

                City = ""
        End If
    '-----------------------
    
    '|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||752||fffd|
    SendMethod = Sheets("Picking").Cells(i + 2, 11)
    
    If Country <> "JP" Then
        RegionNum = Sheets("Region").Columns("A:A").Find(Country).Row
        Region = Sheets("Region").Cells(RegionNum, 3) & "(" & Sheets("Region").Cells(RegionNum, 5) & "-" & Sheets("Region").Cells(RegionNum, 2) & ")"
        RegionNotice = wsin.Cells(i, 22)
        SendMethod = "SAL"
    End If
    
    
    If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" Then
        SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
    End If
    
    Tracking = Empty
    If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
        If PacketCount = 0 Then
        '|fffd||14f||fffd||fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(43, 2)
                    Case ""
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(43, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        Else
        '2|fffd||96||688||20d|~|fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(44, 2)
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(44, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        End If
    PacketCount = PacketCount + 1
    
    End If
    
    
    If Tracking <> Empty Then
        Tracking = "a" & Tracking & Tracking - Int(Tracking / 7) * 7 & "a"
        Sheets("Picking").Cells(i + 2, 12) = Tracking
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||182||7c2||fffd|
    AddressText = Pref & Address1 & Address2 & Address3 & vbLf & Name & " |fffd|l"

    OverSeaAddressText = "Dear " & Name & vbLf & Address1 & "," & Address2 & "," & Address3 & City & vbLf & Pref & vbLf & Region & vbLf
    
    
    '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||16102||7c2||fffd|
    Position = (i - 1) Mod 10
    If Position = 0 Then
        Position = 10
    End If
    
    If Position <= 5 Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 1) * 12 + 2
        ColNum = 3
    Else
        '|fffd|E|fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 5 - 1) * 12 + 2
        ColNum = 8
    End If
    
    v(RowNum, ColNum) = SendMethod
    v(RowNum, ColNum + 2) = ZipCode
    If Country = "JP" Or Country = "" Or Country = Empty Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = AddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
        If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
            v(RowNum + 6, ColNum) = "|fffd||1d0||554||50d||fffd|"
            'v(RowNum + 6, ColNum + 2) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            v(RowNum + 7, ColNum + 2) = SendInfo2 & vbLf & MyAddress
            v(RowNum + 7, ColNum) = Tracking
            v(RowNum + 9, ColNum) = Tracking
        Else
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = SendInfo1
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
            If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N" Then
                'v(RowNum + 9, ColNum) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            Else
                'v(RowNum + 9, ColNum) = ""
            End If
        End If
    Else
        '|fffd|C|fffd|O|fffd||202||fffd|
        v(RowNum, ColNum + 1) = "To"
        v(RowNum + 1, ColNum + 1) = OverSeaAddressText
        v(RowNum + 4, ColNum) = RegionNotice
        'v(RowNum + 6, ColNum) = OverSeaSendInfo2
        'v(RowNum + 6, ColNum + 2) = OverSeaSendInfo1
        'v(RowNum + 7, ColNum + 2) = OverSeaMyAddress
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = "|fffd|yFrom Japan|fffd|z"
            v(RowNum + 7, ColNum + 2) = MyAddress
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
    End If
    '|fffd|z|fffd||fffd||fffd||645c||fffd|\|fffd||fffd|t|fffd||fffd|--------------------------------------------------------------------
    Dim PicPath As String
    Dim TargetRange As String
        Select Case ColNum
            Case "3"
                TargetRange = "C" & RowNum
            Case "8"
                TargetRange = "H" & RowNum
        End Select
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                PicPath = ActiveWorkbook.Path & "\pic\yuMail.png"
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\yuPacket.png"
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\LP.png"
            Case "SAL"
                PicPath = ActiveWorkbook.Path & "\pic\SAL.png"
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\yuPack.png"
            Case "|fffd||fffd||fffd||fffd|e|fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\ePacket.png"
        End Select
        
        
        Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range(TargetRange), PicPath)

    '---------------------------------------------------------------------------------------
    If Position = 10 Or i = Fin Then
        If Position <> 10 Then
            For m = Position + 1 To 10
                If m <= 5 Then
                    '|fffd||fffd||fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 1) * 12 + 2
                    ColNum = 3
                Else
                    '|fffd|E|fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 5 - 1) * 12 + 2
                    ColNum = 8
                End If
                '|fffd|c|fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||d4482||242||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|
                v(RowNum, ColNum) = ""
                v(RowNum, ColNum + 2) = ""
                v(RowNum, ColNum + 1) = ""
                v(RowNum + 1, ColNum + 1) = ""
                v(RowNum + 4, ColNum) = ""
                v(RowNum + 6, ColNum) = ""
                v(RowNum + 6, ColNum + 2) = ""
                v(RowNum + 7, ColNum + 2) = ""
                v(RowNum + 7, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
            DoEvents
            Next
        End If
        wsout.Range("A1:J59") = v
        If Sheets("Config").Cells(16, 2) = "ON" Then
             wsout.PrintOut From:=1, To:=1, Copies:=1, ActivePrinter:=LabelPrinter, Collate _
            :=True
        End If
        v = wsout.Range("A1:J59")
        '|fffd||645c||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd|I|fffd||fffd||fffd|
        Dim myRng As Range
        Dim sp As Variant
            Set myRng = Sheets("AutoLabel").Range("C2:H50")
            For Each sp In Sheets("AutoLabel").Shapes
                If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then
                sp.Delete
                End If
            DoEvents
            Next
        Set myRng = Nothing
            
    End If
DoEvents
Next

End Sub


Sub |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

'|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||752||fffd|
Dim LabelPrinter As String
    LabelPrinter = Sheets("Config").Cells(5, 2)
'|fffd||38f||6c2||313||1c2||74d||fffd||fffd||fffd|
Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
Dim wsout As Worksheet
    Set wsout = Sheets("AutoLabel")
Dim Config As Worksheet
    Set Config = Sheets("Config")
Dim Fin As Long
    Fin = wsin.Cells(Rows.count, 8).End(xlUp).Row
'|fffd||ce682||255|K|fffd|v|fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim OrderId As String
Dim SendMethod As String
Dim ZipCode As String
Dim Pref As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Address4 As String
Dim AddressText As String
Dim OverSeaAddressText As String
Dim Country As String
Dim CountryNotice As String
Dim Tracking As String
Dim Name As String
Dim Product As String
Dim SKU As String
Dim EAN As String
Dim City As String
Dim Region As String
Dim RegionNotice As String
'|fffd||fffd||fffd|X|fffd||702||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
Dim SelfZip As String
    SelfZip = Config.Cells(11, 2)
Dim MyAddress As String
    MyAddress = Config.Cells(12, 2) & " " & Config.Cells(10, 2)
Dim SendInfo1 As String
    SendInfo1 = Config.Cells(17, 2)
Dim SendInfo2 As String
    SendInfo2 = Config.Cells(17, 3)
'|fffd|C|fffd|O|fffd||30f||a347||fffd||30e||fffd||fffd||fffd||fffd||30f||fffd||fffd|
Dim OverSeaSendInfo1 As String
'    OverSeaSendInfo1 = Config.Cells(31, 3)
Dim OverSeaSendInfo2 As String
'    OverSeaSendInfo2 = Config.Cells(32, 3)
Dim OverSeaMyAddress As String
'    OverSeaMyAddress = Config.Cells(28, 3) & " " & Config.Cells(29, 3)
Dim RegionNum As Long
'|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|
Dim Position As Long
Dim RowNum As Long
Dim ColNum As Long
'////////////////////////////////////////
Dim v As Variant
    v = wsout.Range("A1:J59")

'1|fffd||fffd||fffd||fffd||fffd||30f||a347|
'If Sheets("Config").Cells(35, 2) = "1|fffd||fffd|" Then
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & "A4|fffd||fffd|10|fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|x|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Application.WorksheetFunction.RoundUp((Fin - 1) / 10, 0) & "|fffd||142||fffd||fffd|B"
'End If

Dim PacketCount As Long
    PacketCount = 0
    
    
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "sku") > 0 Then
            SkuCol = wsin.Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = wsin.Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-state") > 0 Then
            PrefCol = wsin.Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-1") > 0 Then
            Address1Col = wsin.Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-2") > 0 Then
            Address2Col = wsin.Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-3") > 0 Then
            Address3Col = wsin.Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "recipient-name") > 0 Then
            NameCol = wsin.Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            NameCol = 17
        End If
        
    Dim CountryCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-country") > 0 Then
            CountryCol = wsin.Rows(1).Find("ship-country", LookAt:=xlWhole).Column
        Else
            CountryCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-city") > 0 Then
            CityCol = wsin.Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If
        
    Dim AdOrderIdCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "order-id") > 0 Then
            AdOrderIdCol = wsin.Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            AdOrderIdCol = 1
        End If
    '---------------------------------
    
    

For i = Fin To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||30d||c42c||fffd||188||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@" & Fin - i + 1 & "/" & Fin
    SKU = wsin.Cells(i, SkuCol)
    '|fffd|J|fffd|e|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||fffd||fffd||14f||fffd||fffd|i|fffd||fffd||fffd||fffd|
    ZipCode = "|fffd||fffd|" & wsin.Cells(i, ZipCodeCol)
    Pref = wsin.Cells(i, PrefCol)
    Address1 = wsin.Cells(i, Address1Col)
    Address2 = wsin.Cells(i, Address2Col)
    Address3 = wsin.Cells(i, Address3Col)
    Name = wsin.Cells(i, NameCol)
    Country = wsin.Cells(i, CountryCol)
    
    City = wsin.Cells(i, CityCol)
    
    '-----------------------
    '|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||1c9||fffd|
    Dim AdOrderId As String
        AdOrderId = wsin.Cells(i, AdOrderIdCol)
    Dim AdRow As Long
        If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), AdOrderId) > 0 Then
            AdRow = Sheets("AddressChange").Columns("A:A").Find(AdOrderId).Row
                ZipCode = "|fffd||fffd|" & Sheets("AddressChange").Cells(AdRow, 2)
                Pref = ""
                Address1 = Sheets("AddressChange").Cells(AdRow, 3)
                Address2 = ""
                Address3 = ""
                If Sheets("AddressChange").Cells(AdRow, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(AdRow, 4)
                End If
                Country = ""
                City = ""
        End If
    '-----------------------
    
    '|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||752||fffd|
    SendMethod = Sheets("Picking").Cells(i + 2, 11)
    
    If Country <> "JP" Then
        RegionNum = Sheets("Region").Columns("A:A").Find(Country).Row
        Region = Sheets("Region").Cells(RegionNum, 3) & "(" & Sheets("Region").Cells(RegionNum, 5) & "-" & Sheets("Region").Cells(RegionNum, 2) & ")"
        RegionNotice = wsin.Cells(i, 22)
        SendMethod = "SAL"
    End If
    
    
    If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" Then
        SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
    End If
    
    Tracking = Empty
    If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
        If PacketCount = 0 Then
        '|fffd||14f||fffd||fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(43, 2)
                    Case ""
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(43, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        Else
        '2|fffd||96||688||20d|~|fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(44, 2)
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(44, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        End If
    PacketCount = PacketCount + 1
    
    End If
    
    
    If Tracking <> Empty Then
        Tracking = "a" & Tracking & Tracking - Int(Tracking / 7) * 7 & "a"
        Sheets("Picking").Cells(i + 2, 12) = Tracking
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||182||7c2||fffd|
    AddressText = Pref & Address1 & Address2 & Address3 & vbLf & Name & " |fffd|l"

    OverSeaAddressText = "Dear " & Name & vbLf & Address1 & "," & Address2 & "," & Address3 & City & vbLf & Pref & vbLf & Region & vbLf
      
    '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||16102||7c2||fffd|
    Position = (Fin - i + 1) Mod 10
    If Position = 0 Then
        Position = 10
    End If
    
    If Position <= 5 Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 1) * 12 + 2
        ColNum = 3
    Else
        '|fffd|E|fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 5 - 1) * 12 + 2
        ColNum = 8
    End If
    
    v(RowNum, ColNum) = SendMethod
    v(RowNum, ColNum + 2) = ZipCode
    If Country = "JP" Or Country = "" Or Country = Empty Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = AddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
        If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
            v(RowNum + 6, ColNum) = "|fffd||1d0||554||50d||fffd|"
            'v(RowNum + 6, ColNum + 2) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            v(RowNum + 7, ColNum + 2) = SendInfo2 & vbLf & MyAddress
            v(RowNum + 7, ColNum) = Tracking
            v(RowNum + 9, ColNum) = Tracking
        Else
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = SendInfo1
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
            If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N" Then
                'v(RowNum + 9, ColNum) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            Else
                'v(RowNum + 9, ColNum) = ""
            End If
        End If
    Else
        '|fffd|C|fffd|O|fffd||202||fffd|
        v(RowNum, ColNum + 1) = "To"
        v(RowNum + 1, ColNum + 1) = OverSeaAddressText
        v(RowNum + 4, ColNum) = RegionNotice
        'v(RowNum + 6, ColNum) = OverSeaSendInfo2
        'v(RowNum + 6, ColNum + 2) = OverSeaSendInfo1
        'v(RowNum + 7, ColNum + 2) = OverSeaMyAddress
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = "|fffd|yFrom Japan|fffd|z"
            v(RowNum + 7, ColNum + 2) = MyAddress
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
    End If
    '|fffd|z|fffd||fffd||fffd||645c||fffd|\|fffd||fffd|t|fffd||fffd|--------------------------------------------------------------------
    Dim PicPath As String
    Dim TargetRange As String
        Select Case ColNum
            Case "3"
                TargetRange = "C" & RowNum
            Case "8"
                TargetRange = "H" & RowNum
        End Select
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                PicPath = ActiveWorkbook.Path & "\pic\yuMail.png"
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\yuPacket.png"
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\LP.png"
            Case "SAL"
                PicPath = ActiveWorkbook.Path & "\pic\SAL.png"
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                PicPath = ActiveWorkbook.Path & "\pic\yuPack.png"
            Case "|fffd||fffd||fffd||fffd|e|fffd|p|fffd|P|fffd|b|fffd|g"
                PicPath = ActiveWorkbook.Path & "\pic\ePacket.png"
        End Select
        
        
        Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range(TargetRange), PicPath)

    '---------------------------------------------------------------------------------------
    If Position = 10 Or i = 2 Then
        If Position <> 10 Then
            For m = Position + 1 To 10
                If m <= 5 Then
                    '|fffd||fffd||fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 1) * 12 + 2
                    ColNum = 3
                Else
                    '|fffd|E|fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 5 - 1) * 12 + 2
                    ColNum = 8
                End If
                '|fffd|c|fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||d4482||242||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|
                v(RowNum, ColNum) = ""
                v(RowNum, ColNum + 2) = ""
                v(RowNum, ColNum + 1) = ""
                v(RowNum + 1, ColNum + 1) = ""
                v(RowNum + 4, ColNum) = ""
                v(RowNum + 6, ColNum) = ""
                v(RowNum + 6, ColNum + 2) = ""
                v(RowNum + 7, ColNum + 2) = ""
                v(RowNum + 7, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
            DoEvents
            Next
        End If
        wsout.Range("A1:J59") = v
        If Sheets("Config").Cells(16, 2) = "ON" Then
             wsout.PrintOut From:=1, To:=1, Copies:=1, ActivePrinter:=LabelPrinter, Collate _
            :=True
        End If
        v = wsout.Range("A1:J59")
        '|fffd||645c||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd|I|fffd||fffd||fffd|
        Dim myRng As Range
        Dim sp As Variant
            Set myRng = Sheets("AutoLabel").Range("C2:H50")
            For Each sp In Sheets("AutoLabel").Shapes
                If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then
                sp.Delete
                End If
            DoEvents
            Next
        Set myRng = Nothing
            
    End If
DoEvents
Next




End Sub


Function |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(ByRef tgtRange, Optional fname As String)

     If fname = "" Then
          If tgtRange.Text = "" Then Exit Function
          fname = Replace(ActiveWorkbook.FullName, _
                      ActiveWorkbook.Name, "") & tgtRange.Text
     End If

     ' |fffd|\|fffd||fffd|t|fffd||fffd||fffd||292|u|fffd|E|fffd|T|fffd|C|fffd|Y|fffd||312||fffd||fffd||fffd|
     ' ( Width, Height|fffd||30e|w|fffd||80aa||fffd|K|fffd|{|fffd||302||fffd||fffd||7c1|A|fffd||fffd||fffd||312|l|fffd||fffd||752||fffd| )
     Dim objShape
     Set objShape = tgtRange.Parent.Shapes.AddPicture( _
          FileName:=fname, _
          LinkToFile:=False, _
          SaveWithDocument:=True, _
          Left:=tgtRange.Left + 1, _
          Top:=tgtRange.Top + 1, _
          Width:=tgtRange.MergeArea.Width, _
          Height:=tgtRange.MergeArea.Height)
     With objShape
          .ScaleHeight 1, msoTrue
          .ScaleWidth 1, msoTrue
          .LockAspectRatio = msoTrue '|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||152||fffd|B
          '.Width = tgtRange.MergeArea.Width
          '.Height = tgtRange.MergeArea.Height
     End With

End Function

Sub |fffd|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd||fffd||fffd|s()

Dim PicPath As String
    PicPath = ActiveWorkbook.Path & "\pic\"
'|fffd||645c||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd|
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("M2"), PicPath & "yuMail.png")
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("N2"), PicPath & "SAL.png")
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("O2"), PicPath & "yuPacket.png")
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("P2"), PicPath & "LP.png")
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("R2"), PicPath & "ePacket.png")
Call |fffd||38f||6c3|Z|fffd||fffd||fffd||249||645c||fffd||128c2||fffd|t|fffd||fffd||fffd||fffd|(Sheets("AutoLabel").Range("S2"), PicPath & "yuPack.png")
'|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||752||fffd|
Dim LabelPrinter As String
    LabelPrinter = Sheets("Config").Cells(5, 2)
'|fffd||38f||6c2||313||1c2||74d||fffd||fffd||fffd|
Dim wsin As Worksheet
    Set wsin = Sheets("ChumonReport")
Dim wsout As Worksheet
    Set wsout = Sheets("AutoLabel")
Dim Config As Worksheet
    Set Config = Sheets("Config")
Dim LastIndex As Long
    LastIndex = wsin.Cells(Rows.count, 8).End(xlUp).Row
Dim Start As Long
    Start = (Sheets("TOP").Cells(17, 2) - 1) * 10 + 2
    If Start > LastIndex Then
        MsgBox "|fffd|y|fffd|[|fffd|W|fffd|w|fffd||80aa||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B"
        End
    End If
Dim Fin As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        Fin = Sheets("TOP").Cells(18, 2) * 10 + 1
        If Fin > LastIndex Then
            Fin = LastIndex
        End If
    Else
        Fin = LastIndex
    End If
'|fffd||ce682||255|K|fffd|v|fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim OrderId As String
Dim SendMethod As String
Dim ZipCode As String
Dim Pref As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Address4 As String
Dim AddressText As String
Dim OverSeaAddressText As String
Dim Country As String
Dim CountryNotice As String
Dim Tracking As String
Dim Name As String
Dim Product As String
Dim SKU As String
Dim EAN As String
Dim City As String
Dim Region As String
Dim RegionNotice As String
'|fffd||fffd||fffd|X|fffd||702||30f||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
Dim SelfZip As String
    SelfZip = Config.Cells(11, 2)
Dim MyAddress As String
    MyAddress = Config.Cells(12, 2) & " " & Config.Cells(10, 2)
Dim SendInfo1 As String
    SendInfo1 = Config.Cells(17, 2)
Dim SendInfo2 As String
    SendInfo2 = Config.Cells(17, 3)
'|fffd|C|fffd|O|fffd||30f||a347||fffd||30e||fffd||fffd||fffd||fffd||30f||fffd||fffd|
'Dim OverSeaSendInfo1 As String
'    OverSeaSendInfo1 = Config.Cells(31, 3)
'Dim OverSeaSendInfo2 As String
'    OverSeaSendInfo2 = Config.Cells(32, 3)
'Dim OverSeaMyAddress As String
'    OverSeaMyAddress = Config.Cells(28, 3) & " " & Config.Cells(29, 3)
'Dim RegionNum As Long
'|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|
Dim Position As Long
Dim RowNum As Long
Dim ColNum As Long
'////////////////////////////////////////
Dim v As Variant
    v = wsout.Range("A1:J59")

'1|fffd||fffd||fffd||fffd||fffd||30f||a347|
'If Sheets("Config").Cells(35, 2) = "1|fffd||fffd|" Then
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & "A4|fffd||fffd|10|fffd||281|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|x|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Application.WorksheetFunction.RoundUp((Fin - 1) / 10, 0) & "|fffd||142||fffd||fffd|B"
'End If

Dim PacketCount As Long
    PacketCount = 0
    
    
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "sku") > 0 Then
            SkuCol = wsin.Rows(1).Find("sku", LookAt:=xlWhole).Column
        Else
            SkuCol = 8
        End If

    Dim ZipCodeCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-postal-code") > 0 Then
            ZipCodeCol = wsin.Rows(1).Find("ship-postal-code", LookAt:=xlWhole).Column
        Else
            ZipCodeCol = 23
        End If
        
    Dim PrefCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-state") > 0 Then
            PrefCol = wsin.Rows(1).Find("ship-state", LookAt:=xlWhole).Column
        Else
            PrefCol = 22
        End If
        
    Dim Address1Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-1") > 0 Then
            Address1Col = wsin.Rows(1).Find("ship-address-1", LookAt:=xlWhole).Column
        Else
            Address1Col = 18
        End If
        
    Dim Address2Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-2") > 0 Then
            Address2Col = wsin.Rows(1).Find("ship-address-2", LookAt:=xlWhole).Column
        Else
            Address2Col = 19
        End If
        
    Dim Address3Col As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-address-3") > 0 Then
            Address3Col = wsin.Rows(1).Find("ship-address-3", LookAt:=xlWhole).Column
        Else
            Address3Col = 20
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "recipient-name") > 0 Then
            NameCol = wsin.Rows(1).Find("recipient-name", LookAt:=xlWhole).Column
        Else
            NameCol = 17
        End If
        
    Dim CountryCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-country") > 0 Then
            CountryCol = wsin.Rows(1).Find("ship-country", LookAt:=xlWhole).Column
        Else
            CountryCol = 24
        End If
        
    Dim CityCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "ship-city") > 0 Then
            CityCol = wsin.Rows(1).Find("ship-city", LookAt:=xlWhole).Column
        Else
            CityCol = 21
        End If
        
    Dim AdOrderIdCol As Long
        If Application.WorksheetFunction.CountIf(wsin.Rows(1), "order-id") > 0 Then
            AdOrderIdCol = wsin.Rows(1).Find("order-id", LookAt:=xlWhole).Column
        Else
            AdOrderIdCol = 1
        End If
    '---------------------------------
    

For i = Start To Fin
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||30d||c42c||fffd||188||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@" & i - 1 & "/" & Fin - 1
    SKU = wsin.Cells(i, SkuCol)
    '|fffd|J|fffd|e|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||382||fffd||fffd||fffd||fffd||14f||fffd||fffd|i|fffd||fffd||fffd||fffd|
    
    
    ZipCode = "|fffd||fffd|" & wsin.Cells(i, ZipCodeCol)
    Pref = wsin.Cells(i, PrefCol)
    Address1 = wsin.Cells(i, Address1Col)
    Address2 = wsin.Cells(i, Address2Col)
    Address3 = wsin.Cells(i, Address3Col)
    Name = wsin.Cells(i, NameCol)
    Country = wsin.Cells(i, CountryCol)
    City = wsin.Cells(i, CityCol)
    
    
    '-----------------------
    '|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||1c9||fffd|
    Dim AdOrderId As String
        AdOrderId = wsin.Cells(i, AdOrderIdCol)
    Dim AdRow As Long
        If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), AdOrderId) > 0 Then
            AdRow = Sheets("AddressChange").Columns("A:A").Find(AdOrderId).Row
                ZipCode = "|fffd||fffd|" & Sheets("AddressChange").Cells(AdRow, 2)
                Pref = ""
                Address1 = Sheets("AddressChange").Cells(AdRow, 3)
                Address2 = ""
                Address3 = ""
                If Sheets("AddressChange").Cells(AdRow, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(AdRow, 4)
                End If

                City = ""
        End If
    '-----------------------
    
    If Country <> "JP" Then
        'RegionNum = Sheets("Region").Columns("A:A").Find(Country).Row
        'Region = Sheets("Region").Cells(RegionNum, 3) & "(" & Sheets("Region").Cells(RegionNum, 5) & "-" & Sheets("Region").Cells(RegionNum, 2) & ")"
        'RegionNotice = wsin.Cells(i, 22)
    End If
    
    '|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||312||1d0||554||50d||fffd||fffd||752||fffd|
    SendMethod = Sheets("Picking").Cells(i + 2, 11)
    If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X" Then
        SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N"
    End If
    Tracking = Empty
    If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
        If PacketCount = 0 Then
        '|fffd||14f||fffd||fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(43, 2)
                    Case ""
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(43, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        Else
        '2|fffd||96||688||20d|~|fffd||302||40a4||fffd|p|fffd|P|fffd|b|fffd|g|fffd||30f||a347|
            If Sheets("TOP").Cells(40, 2) <> "" Then
                Select Case Sheets("TOP").Cells(44, 2)
                    Case Is >= Sheets("TOP").Cells(41, 2)
                        Sheets("Config").Cells(40, 2) = Sheets("Config").Cells(40, 3)
                        Sheets("Config").Cells(41, 2) = Sheets("Config").Cells(41, 3)
                        Tracking = Sheets("TOP").Cells(40, 2)
                        Sheets("TOP").Cells(44, 2) = Tracking
                    Case Else
                        Tracking = Sheets("TOP").Cells(44, 2) + 1
                        Sheets("TOP").Cells(44, 2) = Tracking
                End Select
            End If
        End If
    PacketCount = PacketCount + 1
    
    End If
    
    
    If Tracking <> Empty Then
        Tracking = "a" & Tracking & Tracking - Int(Tracking / 7) * 7 & "a"
        Sheets("Picking").Cells(i + 2, 12) = Tracking
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||182||7c2||fffd|
    AddressText = Pref & Address1 & Address2 & Address3 & vbLf & Name & " |fffd|l"
    OverSeaAddressText = Address1 & "," & Address2 & "," & Address3 & City & vbLf & Pref & vbLf & Region & vbLf & "Dear " & Name
    
    '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||16102||7c2||fffd|
    Position = (i - 1) Mod 10
    If Position = 0 Then
        Position = 10
    End If
    
    If Position <= 5 Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 1) * 12 + 2
        ColNum = 3
    Else
        '|fffd|E|fffd||fffd||fffd||202||fffd|
        RowNum = (Position - 5 - 1) * 12 + 2
        ColNum = 8
    End If
    
    v(RowNum, ColNum) = SendMethod
    v(RowNum, ColNum + 2) = ZipCode
    If Country = "JP" Or Country = "" Or Country = Empty Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd|
        v(RowNum, ColNum + 1) = ""
        v(RowNum + 1, ColNum + 1) = AddressText
        v(RowNum + 4, ColNum) = ""
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
        If SendMethod = "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g" Then
            v(RowNum + 6, ColNum) = "|fffd||1d0||554||50d||fffd|"
            'v(RowNum + 6, ColNum + 2) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            v(RowNum + 7, ColNum + 2) = SendInfo2 & vbLf & MyAddress
            v(RowNum + 7, ColNum) = Tracking
            v(RowNum + 9, ColNum) = Tracking
        Else
            v(RowNum + 6, ColNum) = SendInfo2
            v(RowNum + 6, ColNum + 2) = SendInfo1
            v(RowNum + 7, ColNum + 2) = MyAddress
            v(RowNum + 7, ColNum) = ""
            If SendMethod = "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N" Then
                'v(RowNum + 9, ColNum) = "|fffd||fffd||fffd|e|fffd|i|fffd|F" & Product
            Else
                'v(RowNum + 9, ColNum) = ""
            End If
        End If
    Else
        '|fffd|C|fffd|O|fffd||202||fffd|
        v(RowNum, ColNum + 1) = "To"
        v(RowNum + 1, ColNum + 1) = OverSeaAddressText
        v(RowNum + 4, ColNum) = RegionNotice
        v(RowNum + 6, ColNum) = OverSeaSendInfo2
        v(RowNum + 6, ColNum + 2) = OverSeaSendInfo1
        v(RowNum + 7, ColNum + 2) = OverSeaMyAddress
        v(RowNum + 7, ColNum) = ""
        v(RowNum + 9, ColNum) = ""
    End If
    
    
    If Position = 10 Or i = Fin Then
        If Position <> 10 Then
            For m = Position + 1 To 10
                If m <= 5 Then
                    '|fffd||fffd||fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 1) * 12 + 2
                    ColNum = 3
                Else
                    '|fffd|E|fffd||fffd||fffd||202||fffd|
                    RowNum = (m - 5 - 1) * 12 + 2
                    ColNum = 8
                End If
                '|fffd|c|fffd||fffd||303||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||d4482||242||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|
                v(RowNum, ColNum) = ""
                v(RowNum, ColNum + 2) = ""
                v(RowNum, ColNum + 1) = ""
                v(RowNum + 1, ColNum + 1) = ""
                v(RowNum + 4, ColNum) = ""
                v(RowNum + 6, ColNum) = ""
                v(RowNum + 6, ColNum + 2) = ""
                v(RowNum + 7, ColNum + 2) = ""
                v(RowNum + 7, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
                v(RowNum + 9, ColNum) = ""
            DoEvents
            Next
        End If
        wsout.Range("A1:J59") = v
         wsout.PrintOut From:=1, To:=1, Copies:=1, ActivePrinter:=LabelPrinter, Collate _
        :=True
        v = wsout.Range("A1:J59")
    End If
DoEvents
Next

    '|fffd||645c||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd|I|fffd||fffd||fffd|
Dim myRng As Range
Dim sp As Variant
Set myRng = Sheets("AutoLabel").Range("M2:S2")
For Each sp In Sheets("AutoLabel").Shapes
If Not Intersect(Range(sp.TopLeftCell, sp.BottomRightCell), myRng) Is Nothing Then
sp.Delete
End If
Next
Set myRng = Nothing


End Sub

Attribute VB_Name = "Module16"
Sub |fffd|p|fffd|X|fffd|Q|fffd||182||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||150||752||80b7||fffd||fffd|()
Dim TargetPass As String
    TargetPass = ThisWorkbook.Path

Dim SendFilePass As String
Dim OtherFilePass As String

    SendFilePass = TargetPass & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|o|fffd||5d2||292|m"
    OtherFilePass = TargetPass & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|O|fffd||fffd||fffd|A|fffd|gCSV"

Dim OrderRepoPass As String
Dim SyosaiRepoPass As String

    For q = 1 To Len(TargetPass)
        If Left(Right(TargetPass, q), 1) = "\" Then
            TargetPass = Left(TargetPass, Len(TargetPass) - q) & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\"
            Exit For
        End If
    DoEvents
    Next
    
    OrderRepoPass = TargetPass & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g.txt"
    SyosaiRepoPass = TargetPass & "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g.txt"

    

    Sheets("Config").Range("B36") = OrderRepoPass
    Sheets("Config").Range("B38") = SyosaiRepoPass

    Sheets("Config").Range("B43") = SendFilePass
    Sheets("Config").Range("B126") = OtherFilePass
    
End Sub
Attribute VB_Name = "Module17"
Sub IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|()

Dim AWS As String
    AWS = Sheets("Config").Cells(52, 2)
Dim OrderId As String
    OrderId = Sheets("Config").Cells(55, 2)

Dim AuthAWS As String

'IE|fffd||fffd||fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|---------
Dim httpReq As XMLHTTP60
Set httpReq = New XMLHTTP60

httpReq.Open "GET", "http://kakakaka.info/auth/license/sedori-tool/" & OrderId & ".html", True, "kakakaka", "password"
httpReq.send

Do While httpReq.readyState < 4
    DoEvents
Loop

Dim htmlDoc As Variant
htmlDoc = httpReq.responseText

AuthAWS = Mid(htmlDoc, InStr(htmlDoc, "<div class=""AWS"">") + Len("<div class=""AWS"">"), InStr(htmlDoc, "<div class=""Mail"">") - InStr(htmlDoc, "<div class=""AWS"">") - Len("<div class=""AWS"">") - 7)


    If AuthAWS = "" Then
        MsgBox "|fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||948d||fffd||fffd||fffd||50d||fffd||fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & vbCrLf _
                & "|fffd|c|fffd|[|fffd||fffd||fffd||303|}|fffd|j|fffd||fffd||fffd|A|fffd||fffd||fffd|T|fffd|C|fffd|g|fffd||fffd||fffd|MWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End
    End If

    If AuthAWS = "Undecided" Then
        Application.StatusBar = "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||610||fffd||fffd||fffd||142||fffd||fffd|B"
    Else
        If AWS = AuthAWS Then
            Application.StatusBar = "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||610||fffd||fffd||fffd||142||fffd||fffd|B"
        Else
            If Len(AuthAWS) = 20 Then
                MsgBox "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||fffd|NG|fffd||142||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||fffd|AWS|fffd|L|fffd|[|fffd||142||314|F|fffd||602||302||702||701|i|fffd||c2||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|j|fffd||302||60a4||fffd||202||302||141|A" & vbCrLf _
                        & "|fffd|}|fffd|j|fffd||fffd||fffd|A|fffd||fffd||fffd|T|fffd|C|fffd|g|fffd||fffd||fffd||113|x|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||80a2||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd|c|fffd|[|fffd||fffd||fffd|_|fffd||4e782||301|yPayPal|fffd||fffd||fffd||fffd|ID|fffd|z|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z|fffd|y|fffd||fffd||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||80a2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|c|fffd|[|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||60a4||fffd||242||202||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||602||242||82||fffd||fffd||115|s|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd|A" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||253|o|fffd|^|fffd||fffd||fffd||fffd||102||90c1||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z" & vbCrLf _
                        & "|fffd||fffd|Y|fffd||fffd||fffd||101|unosuke1@nosukenosusume.info|fffd|v|fffd||702||142||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            Else
                MsgBox "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||fffd|NG|fffd||142||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd||fffd|MWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd||311|g|fffd||74d||fffd||fffd||d0b9||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||508||10a2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||381|A" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||253|o|fffd|^|fffd||fffd||fffd||fffd||102||90c1||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z" & vbCrLf _
                        & "|fffd||fffd|Y|fffd||fffd||fffd||101|unosuke1@nosukenosusume.info|fffd|v|fffd||702||142||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            End If
            End
        End If
    End If

Set htmlDoc = Nothing
Set httpReq = Nothing
'-----------------------------

End Sub

Attribute VB_Name = "Module18"
Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
'|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||24a||582||fffd||fffd||fffd|}|fffd|N|fffd||fffd|

Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd|P|fffd||30e||fffd||fffd|s()

Application.Run "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|"

If Sheets("MailConfig").Cells(18, 2) <> "ON" And Sheets("MailConfig").Cells(13, 2) <> "ON" Then
    MsgBox "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||752||80aa|OFF|fffd||242||202||fffd||fffd||102||fffd||fffd||702||fffd|"
Else
    MsgBox "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End If

End Sub


Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|()

Dim ChangeJudge As String
    If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O" And Sheets("TOP").Cells(5, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        ChangeJudge = "|fffd||38f||fffd|"
    End If

If Sheets("MailConfig").Cells(13, 2) = "OFF" And Sheets("MailConfig").Cells(18, 2) = "OFF" Then
    MsgBox "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||310||752||80aa|OFF|fffd||308||5c1|A|fffd||fffd||fffd||251||fffd||fffd||90c1||fffd|[|fffd||fffd||fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
    End
End If

Dim Res
Res = MsgBox("|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B" & vbLf & vbLf & "|fffd||508||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||242||341|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKCancel)
If Res = vbCancel Then Exit Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd|
If Sheets("MailConfig").Cells(13, 2) = "ON" Then
    Application.Run "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||1228f|o|fffd||fffd||fffd||fffd|"
    Application.Run "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|"
    Application.Run "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||30f|o|fffd||fffd|"
End If

'2|fffd||296||683||fffd||fffd|[|fffd||fffd|
If Sheets("MailConfig").Cells(18, 2) = "ON" Then
    Application.Run "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|"
    Application.Run "|fffd||fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|"
End If

'|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|OFF|fffd||202||70b1||fffd||fffd||fffd||143|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||590||602||fffd||582||fffd|
If Sheets("Config").Cells(120, 2) = "OFF" Then

        If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||20a|O" Then
            Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
            Application.Run "|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||835e||fffd||fffd|"
            MsgBox "|fffd||fffd||fffd||fffd||fffd||103|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||248||682||fffd||302||fffd|" & vbLf _
                    & "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||308||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||fffd|i|fffd||7c2||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            GoTo Skip
        End If
        If Sheets("TOP").Cells(14, 12) = "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g" Then
            Sheets("TOP").Cells(14, 12) = "|fffd||28f||fffd|"
            MsgBox "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|" & vbLf & vbLf _
                    & "|fffd|S|fffd||102||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|OFF|fffd||302||fffd||fffd||7c1|j"
            GoTo Skip
        End If

End If

MsgBox "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd|I"
Skip:
End Sub



Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||1228f|o|fffd||fffd||fffd||fffd|()

Dim MailAddress() As String
Dim SendAddress() As String
Dim BuyerName() As String
Dim ItemName() As String
Dim SendMethod() As String
Dim TrackingNumber() As String
Dim ShippingDate() As Date

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
    
    ReDim MailAddress(LastIndex)
    ReDim SendAddress(LastIndex)
    ReDim BuyerName(LastIndex)
    ReDim ItemName(LastIndex)
    ReDim SendMethod(LastIndex)
    ReDim TrackingNumber(LastIndex)
    ReDim ShippingDate(LastIndex)
    
Dim MailX As Long
    MailX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    If MailX > 1 Then
        Sheets("MailList").Rows("2:" & MailX).ClearContents
        MailX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    End If

Dim PickingX As Long
    PickingX = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row

Dim OrderId As String
Dim RowNum As Long

'|fffd||38f||6d7||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||93c8||fffd||fffd|
Dim ZipCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-postal-code") > 0 Then
        ZipCol = Sheets("ChumonReport").Rows(1).Find("ship-postal-code").Column
    Else
        ZipCol = 23
    End If
    
Dim StateCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-state") > 0 Then
        StateCol = Sheets("ChumonReport").Rows(1).Find("ship-state").Column
    Else
        StateCol = 22
    End If
    
Dim CityCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-city") > 0 Then
        CityCol = Sheets("ChumonReport").Rows(1).Find("ship-city").Column
    Else
        CityCol = 21
    End If
    
Dim Add1Col As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-1") > 0 Then
        Add1Col = Sheets("ChumonReport").Rows(1).Find("ship-address-1").Column
    Else
        Add1Col = 18
    End If
    
Dim Add2Col As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-2") > 0 Then
        Add2Col = Sheets("ChumonReport").Rows(1).Find("ship-address-2").Column
    Else
        Add2Col = 19
    End If
    
Dim Add3Col As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-address-3") > 0 Then
        Add3Col = Sheets("ChumonReport").Rows(1).Find("ship-address-3").Column
    Else
        Add3Col = 20
    End If
    
Dim ReciptCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
        ReciptCol = Sheets("ChumonReport").Rows(1).Find("recipient-name").Column
    Else
        ReciptCol = 17
    End If
    
Dim BuyerNameCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-name") > 0 Then
        BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("buyer-name").Column
    Else
        BuyerNameCol = 6
    End If

Dim ItemNameCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
        BuyerNameCol = Sheets("ChumonReport").Rows(1).Find("product-name").Column
    Else
        BuyerNameCol = 9
    End If
    

Dim SkuCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
        SkuCol = Sheets("ChumonReport").Rows(1).Find("sku").Column
    Else
        SkuCol = 8
    End If
    

Dim MailCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "buyer-email") > 0 Then
        MailCol = Sheets("ChumonReport").Rows(1).Find("buyer-email").Column
    Else
        MailCol = 5
    End If

Dim OrderIdCol As Long
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
        OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id").Column
    Else
        OrderIdCol = 1
    End If


For a = 2 To LastIndex

    MailAddress(a) = Sheets("ChumonReport").Cells(a, MailCol)
    OrderId = Sheets("ChumonReport").Cells(a, OrderIdCol)
    '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
        RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
        SendAddress(a) = "|fffd||fffd|" & Sheets("AddressChange").Cells(RowNum, 2) & vbLf _
                        & Sheets("AddressChange").Cells(RowNum, 3) _
                        & vbLf & Sheets("AddressChange").Cells(RowNum, 4) & "|fffd|l"
        RowNum = Empty
    Else
        SendAddress(a) = "|fffd||fffd|" & Sheets("ChumonReport").Cells(a, ZipCol) & vbLf _
                        & Sheets("ChumonReport").Cells(a, StateCol) _
                        & Sheets("ChumonReport").Cells(a, CityCol) _
                        & Sheets("ChumonReport").Cells(a, Add1Col) _
                        & Sheets("ChumonReport").Cells(a, Add2Col) _
                        & Sheets("ChumonReport").Cells(a, Add3Col) _
                        & vbLf & Sheets("ChumonReport").Cells(a, ReciptCol) & "|fffd|l"
    End If
    
    BuyerName(a) = Sheets("ChumonReport").Cells(a, BuyerNameCol)
    ItemName(a) = Sheets("ChumonReport").Cells(a, BuyerNameCol)
    
    For b = 4 To PickingX
        If Sheets("ChumonReport").Cells(a, SkuCol) = Sheets("Picking").Cells(b, 2) _
        And Sheets("ChumonReport").Cells(a, ReciptCol) = Sheets("Picking").Cells(b, 4) Then
            SendMethod(a) = Sheets("Picking").Cells(b, 11)
            TrackingNumber(a) = Replace(Sheets("Picking").Cells(b, 12), "a", "")
        Exit For
        End If
    DoEvents
    Next
    
    ShippingDate(a) = Now

DoEvents
Next

'|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For c = 2 To LastIndex
    Sheets("MailList").Cells(c, 1) = BuyerName(c)
    Sheets("MailList").Cells(c, 2) = Format(ShippingDate(c), "YYYY/MM/DD")
    Sheets("MailList").Cells(c, 3) = SendMethod(c)
    Sheets("MailList").Cells(c, 4) = TrackingNumber(c)
    Sheets("MailList").Cells(c, 5) = SendAddress(c)
    Sheets("MailList").Cells(c, 6) = MailAddress(c)
    Sheets("MailList").Cells(c, 7) = ItemName(c)
DoEvents
Next

End Sub


Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||30f|o|fffd||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim SaveSheet As Worksheet
    Set SaveSheet = Sheets("MailList")
    
Dim FileName As String
    

Dim LastIndex As Long
    LastIndex = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row

Dim MyFile As String

    FileName = "Mail" & Format(Now(), "YYYYMMDD") & "-" & Format(Now(), "hhmmss") & "-" & Format(LastIndex - 1, "000")
'==============================================
Dim ws As Worksheet
Set ws = ThisWorkbook.Worksheets("MailList")
Dim OutPutPass As String
    OutPutPass = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g"
Dim datFile As String
    datFile = OutPutPass & "\" & FileName & ".txt"


 
Open datFile For Output As #1
 
Dim i As Long
i = 1
Do While ws.Cells(i, 1).value <> ""
    Application.StatusBar = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|@" & i & "/" & LastIndex
    ws.Cells(i, 5) = Replace(ws.Cells(i, 5), vbLf, "%%lf%%")
    Print #1, ws.Cells(i, 1).value & vbTab _
            & ws.Cells(i, 2).value & vbTab _
            & ws.Cells(i, 3).value & vbTab _
            & ws.Cells(i, 4).value & vbTab _
            & ws.Cells(i, 5).value & vbTab _
            & ws.Cells(i, 6).value & vbTab _
            & ws.Cells(i, 7).value
    i = i + 1
Loop
 
Close #1
 
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||38f||6c3|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|()

Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    If MailListX > 1 Then
        Sheets("MailList").Rows("2:" & MailListX).ClearContents
    End If
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row + 1
    
Dim TargetDay As String
    TargetDay = Format(Date - Sheets("MailConfig").Cells(19, 2), "YYYYMMDD")

Dim Pass As String
    Pass = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g"
    
    
Dim Buf As String, Cnt As Long
Dim TotalNumber As Long
Dim Path As String
Buf = Dir(Pass & "\" & "*.txt")

Set FSO = CreateObject("Scripting.FileSystemObject")
Dim count As Long


    Do While Buf <> ""

        If Mid(Buf, 5, 8) = TargetDay Then
            '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||835e||fffd||742||303|t|fffd|@|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd|
            Call ReadMailList(Buf)
            If Sheets("MailConfig").Cells(6, 2) = "|fffd||693||fffd|" Then
                Name Pass & "\" & Buf As Pass & "\|fffd||fffd||fffd||fffd||fffd||3c2||fffd|\" & Buf
            Else
                Kill Pass & "\" & Buf
            End If
           
        End If
        
        Buf = Dir()
        DoEvents
    Loop
    
    '2|fffd||296||682||303||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd|t|fffd|@|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd|

End Sub

Function ReadMailList(FileName As String)
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------



Dim FullPass As String
    FullPass = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g\" & FileName


Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row + 1





    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    Dim SendAddress As String
    
        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("MailList").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FullPass))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FullPass For Input As #FileNo
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            Cnt = Cnt + 1
            SplitString = Split(Buf, vbTab)
            MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row + 1
            SendAddress = ""
            If Cnt > 1 Then
                For i = 0 To UBound(SplitString)
                    Select Case i
                        Case 4
                            Sheets("MailList").Cells(MailListX, i + 1) = Replace(SplitString(i), "%%lf%%", vbLf)
                        Case Else
                            Sheets("MailList").Cells(MailListX, i + 1) = SplitString(i)
                    End Select
                Next i
            End If
            Application.StatusBar = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
        Loop
        Application.StatusBar = ""
        Close #FileNo
        
End Function


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|()

Dim msg As String
Dim Server As String, MailTo As String, MailFrom As String, Subject As String, Body As String
    
    Server = Sheets("MailConfig").Cells(2, 2) & ":465" '":587" ''SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    MailFrom = Sheets("MailConfig").Cells(5, 2) ''|fffd||fffd||fffd|o|fffd||fffd||fffd|l

    If InStr(MailFrom, "@gmail.com") = 0 Then
        'Server = Sheets("MailConfig").Cells(2, 2) & ":587" ''X|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
        MsgBox "|fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B" & vbLf & "|fffd||fffd||fffd||fffd|Gmail|fffd||302||743||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Exit Sub
    Else
        Server = Sheets("MailConfig").Cells(2, 2) & ":587" '":465" '":587" ''G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    End If
    
Dim PassWord As String
    PassWord = Sheets("MailConfig").Cells(4, 2)

Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    
Dim WaitTime As Long
    WaitTime = Sheets("MailConfig").Cells(7, 2)

Dim SendAddress As String
Dim BuyerName As String
Dim ItemName As String
Dim SendMethod As String
Dim TrackingNumber As String
Dim ShippingDate As String

Dim MailCol As Long
    
    For a = 2 To MailListX
        Application.StatusBar = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|@" & a - 1 & "/" & MailListX - 1
        MailTo = "vn1z4278l62qhh0+A0289444B39YWUH3HZMA@marketplace.amazon.co.jp"
        SendAddress = "|fffd|_|fffd||790||c327||fffd||302||1c2||fffd||fffd||fffd|"
        BuyerName = "|fffd||fffd||fffd|M|fffd|e|fffd|X|fffd|g"
        ItemName = "|fffd||2cb||fffd|A|fffd|C|fffd|e|fffd||fffd|"
        SendMethod = "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
        ShippingDate = "YYYY|fffd|NMM|fffd||fffd|DD|fffd||fffd|"
        
        MailTo = Sheets("MailList").Cells(a, 6) ''|fffd||fffd||fffd||fffd|
            
        
        SendAddress = Sheets("MailList").Cells(a, 5)
            
        
        BuyerName = Sheets("MailList").Cells(a, 1)
            
            
        ItemName = Sheets("MailList").Cells(a, 7)
            
            
        SendMethod = Sheets("MailList").Cells(a, 3)
            
            
        TrackingNumber = Sheets("MailList").Cells(a, 4)
        ShippingDate = Format(Sheets("MailList").Cells(a, 2), "YYYY|fffd|NMM|fffd||fffd|DD|fffd||fffd|")
            
            
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                MailCol = 3
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                MailCol = 4
            Case "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
                MailCol = 5
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X"
                MailCol = 6
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                MailCol = 7
            Case "DM|fffd||fffd|"
                MailCol = 8
            Case Else
                MailCol = 3
        End Select
        
        
        Subject = Sheets("MailConfig").Cells(15, MailCol) ''|fffd||85bc|
        Body = Sheets("MailConfig").Cells(16, MailCol) ''|fffd|{|fffd||fffd|
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||352|u|fffd||fffd|
        Subject = Replace(Subject, "%BuyerName%", BuyerName)
        Body = Replace(Body, "%BuyerName%", BuyerName)
        
        Subject = Replace(Subject, "%SendAddress%", SendAddress)
        Body = Replace(Body, "%SendAddress%", SendAddress)
        
        Subject = Replace(Subject, "%ItemName%", ItemName)
        Body = Replace(Body, "%ItemName%", ItemName)
        
        Subject = Replace(Subject, "%SendMethod%", SendMethod)
        Body = Replace(Body, "%SendMethod%", SendMethod)
        
        Subject = Replace(Subject, "%TrackingNumber%", TrackingNumber)
        Body = Replace(Body, "%TrackingNumber%", TrackingNumber)
        
        Subject = Replace(Subject, "%ShippingDate%", ShippingDate)
        Body = Replace(Body, "%ShippingDate%", ShippingDate)
        
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd|iUTF-8|fffd||151||fffd||fffd|M|fffd|j
            SendGmail2 MailFrom, _
                Sheets("MailConfig").Cells(4, 2), _
                MailTo, _
                "", _
                "", _
                Subject, _
                Body, _
                "utf-8"
    
        For b = 1 To WaitTime
            Application.StatusBar = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||48b|@|fffd|@" & b & "/" & WaitTime
            Sleep 1000
        DoEvents
        Next
        Application.StatusBar = ""
    DoEvents
    Next
    
    
    Set bobj = Nothing
                    
End Sub



Sub |fffd||fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|()

Dim msg As String
Dim Server As String, MailTo As String, MailFrom As String, Subject As String, Body As String
    
    Server = Sheets("MailConfig").Cells(2, 2) & ":465" '":587" ''SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    MailFrom = Sheets("MailConfig").Cells(5, 2) ''|fffd||fffd||fffd|o|fffd||fffd||fffd|l
    If InStr(MailFrom, "@gmail.com") = 0 Then
        'Server = Sheets("MailConfig").Cells(2, 2) & ":587" ''X|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
        MsgBox "|fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B" & vbLf & "|fffd||fffd||fffd||fffd|Gmail|fffd||302||743||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Exit Sub
    Else
        Server = Sheets("MailConfig").Cells(2, 2) & ":587" '":465" '":587" ''G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    End If
    
Dim PassWord As String
    PassWord = Sheets("MailConfig").Cells(4, 2)

Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    
Dim WaitTime As Long
    WaitTime = Sheets("MailConfig").Cells(7, 2)

Dim SendAddress As String
Dim BuyerName As String
Dim ItemName As String
Dim SendMethod As String
Dim TrackingNumber As String
Dim ShippingDate As String

Dim MailCol As Long
    
    For a = 2 To MailListX
        Application.StatusBar = "2|fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|@" & a - 1 & "/" & MailListX - 1
    
        MailTo = Sheets("MailList").Cells(a, 6) ''|fffd||fffd||fffd||fffd|
        SendAddress = Sheets("MailList").Cells(a, 5)
        BuyerName = Sheets("MailList").Cells(a, 1)
        ItemName = Sheets("MailList").Cells(a, 7)
        SendMethod = Sheets("MailList").Cells(a, 3)
        TrackingNumber = Sheets("MailList").Cells(a, 4)
        ShippingDate = Format(Sheets("MailList").Cells(a, 2), "YYYY|fffd|NMM|fffd||fffd|DD|fffd||fffd|")
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                MailCol = 3
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                MailCol = 4
            Case "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
                MailCol = 5
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X"
                MailCol = 6
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                MailCol = 7
            Case "DM|fffd||fffd|"
                MailCol = 8
            Case Else
                MailCol = 3
        End Select
        
        
        Subject = Sheets("MailConfig").Cells(21, MailCol) ''|fffd||85bc|
        Body = Sheets("MailConfig").Cells(22, MailCol) ''|fffd|{|fffd||fffd|
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||352|u|fffd||fffd|
        Subject = Replace(Subject, "%BuyerName%", BuyerName)
        Body = Replace(Body, "%BuyerName%", BuyerName)
        
        Subject = Replace(Subject, "%SendAddress%", SendAddress)
        Body = Replace(Body, "%SendAddress%", SendAddress)
        
        Subject = Replace(Subject, "%ItemName%", ItemName)
        Body = Replace(Body, "%ItemName%", ItemName)
        
        Subject = Replace(Subject, "%SendMethod%", SendMethod)
        Body = Replace(Body, "%SendMethod%", SendMethod)
        
        Subject = Replace(Subject, "%TrackingNumber%", TrackingNumber)
        Body = Replace(Body, "%TrackingNumber%", TrackingNumber)
        
        Subject = Replace(Subject, "%ShippingDate%", ShippingDate)
        Body = Replace(Body, "%ShippingDate%", ShippingDate)
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M
            SendGmail2 MailFrom, _
                Sheets("MailConfig").Cells(4, 2), _
                MailTo, _
                "", _
                "", _
                Subject, _
                Body, _
                "utf-8"
    
        For b = 1 To WaitTime
            Application.StatusBar = "2|fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||48b|@|fffd|@" & b & "/" & WaitTime
            Sleep 1000
        DoEvents
        Next
        Application.StatusBar = ""
    DoEvents
    Next
    
    
    Set bobj = Nothing
                    
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||303|e|fffd|X|fffd|g|fffd||fffd||fffd|M()

Dim msg As String
Dim Server As String, MailTo As String, MailFrom As String, Subject As String, Body As String
    
    Server = Sheets("MailConfig").Cells(2, 2) & ":465" '":587" ''SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    MailFrom = Sheets("MailConfig").Cells(5, 2) ''|fffd||fffd||fffd|o|fffd||fffd||fffd|l
    If InStr(MailFrom, "@gmail.com") = 0 Then
        'Server = Sheets("MailConfig").Cells(2, 2) & ":587" ''X|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
        MsgBox "|fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B" & vbLf & "|fffd||fffd||fffd||fffd|Gmail|fffd||302||743||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Exit Sub
    Else
        Server = Sheets("MailConfig").Cells(2, 2) & ":587" '":465" '":587" ''G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    End If
    
Dim PassWord As String
    PassWord = Sheets("MailConfig").Cells(4, 2)

Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    
Dim WaitTime As Long
    WaitTime = Sheets("MailConfig").Cells(7, 2)

Dim SendAddress As String
Dim BuyerName As String
Dim ItemName As String
Dim SendMethod As String
Dim TrackingNumber As String
Dim ShippingDate As String

Dim MailCol As Long
    
        Application.StatusBar = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|@" & a - 1 & "/" & MailListX - 1
        MailTo = Sheets("MailConfig").Cells(3, 7)
        SendAddress = "|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        BuyerName = "|fffd||fffd||fffd|w|fffd||fffd||fffd||496||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ItemName = "|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        SendMethod = Sheets("MailConfig").Cells(4, 7)
        ShippingDate = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        TrackingNumber = "|fffd||fffd||fffd||1d0||554||50d||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                MailCol = 3
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                MailCol = 4
            Case "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
                MailCol = 5
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X"
                MailCol = 6
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                MailCol = 7
            Case "DM|fffd||fffd|"
                MailCol = 8
        End Select
        
        
        Subject = Sheets("MailConfig").Cells(15, MailCol) ''|fffd||85bc|
        Body = Sheets("MailConfig").Cells(16, MailCol) ''|fffd|{|fffd||fffd|
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||352|u|fffd||fffd|
        Subject = Replace(Subject, "%BuyerName%", BuyerName)
        Body = Replace(Body, "%BuyerName%", BuyerName)
        
        Subject = Replace(Subject, "%SendAddress%", SendAddress)
        Body = Replace(Body, "%SendAddress%", SendAddress)
        
        Subject = Replace(Subject, "%ItemName%", ItemName)
        Body = Replace(Body, "%ItemName%", ItemName)
        
        Subject = Replace(Subject, "%SendMethod%", SendMethod)
        Body = Replace(Body, "%SendMethod%", SendMethod)
        
        Subject = Replace(Subject, "%TrackingNumber%", TrackingNumber)
        Body = Replace(Body, "%TrackingNumber%", TrackingNumber)
        
        Subject = Replace(Subject, "%ShippingDate%", ShippingDate)
        Body = Replace(Body, "%ShippingDate%", ShippingDate)
        
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd|iUTF-8|fffd||151||fffd||fffd|M|fffd|j
            SendGmail2 MailFrom, _
                Sheets("MailConfig").Cells(4, 2), _
                MailTo, _
                "", _
                "", _
                Subject, _
                Body, _
                "utf-8"
    
    Set bobj = Nothing
    
    MsgBox "1|fffd||296||681|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||251||fffd||fffd||90c1||fffd|[|fffd||fffd||fffd|j|fffd||303|e|fffd|X|fffd|g|fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                    
End Sub
Sub |fffd||fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||303|e|fffd|X|fffd|g|fffd||fffd||fffd|M()

Dim msg As String
Dim Server As String, MailTo As String, MailFrom As String, Subject As String, Body As String
    
    Server = Sheets("MailConfig").Cells(2, 2) & ":465" '":587" ''SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    MailFrom = Sheets("MailConfig").Cells(5, 2) ''|fffd||fffd||fffd|o|fffd||fffd||fffd|l
    If InStr(MailFrom, "@gmail.com") = 0 Then
        'Server = Sheets("MailConfig").Cells(2, 2) & ":587" ''X|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
        MsgBox "|fffd||fffd||fffd|M|fffd||fffd||fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B" & vbLf & "|fffd||fffd||fffd||fffd|Gmail|fffd||302||743||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Exit Sub
    Else
        Server = Sheets("MailConfig").Cells(2, 2) & ":587" '":465" '":587" ''G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|SMTP|fffd|T|fffd|[|fffd|o|fffd|[
    End If
    
Dim PassWord As String
    PassWord = Sheets("MailConfig").Cells(4, 2)

Dim MailListX As Long
    MailListX = Sheets("MailList").Cells(Rows.count, 1).End(xlUp).Row
    
Dim WaitTime As Long
    WaitTime = Sheets("MailConfig").Cells(7, 2)

Dim SendAddress As String
Dim BuyerName As String
Dim ItemName As String
Dim SendMethod As String
Dim TrackingNumber As String
Dim ShippingDate As String

Dim MailCol As Long
    
        Application.StatusBar = "2|fffd||296||683||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M|fffd||fffd||fffd|@" & a - 1 & "/" & MailListX - 1
    
        MailTo = Sheets("MailConfig").Cells(3, 7)
        SendAddress = "|fffd||fffd||fffd|z|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        BuyerName = "|fffd||fffd||fffd|w|fffd||fffd||fffd||496||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ItemName = "|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        SendMethod = Sheets("MailConfig").Cells(4, 7)
        ShippingDate = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        TrackingNumber = "|fffd||fffd||fffd||1d0||554||50d||fffd||fffd||252|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        
        Select Case SendMethod
            Case "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
                MailCol = 3
            Case "|fffd||40a4||fffd|p|fffd|P|fffd|b|fffd|g"
                MailCol = 4
            Case "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|||fffd|X|fffd|g"
                MailCol = 5
            Case "|fffd||fffd||fffd|^|fffd|[|fffd|p|fffd|b|fffd|N|fffd|v|fffd||fffd||fffd|X"
                MailCol = 6
            Case "|fffd||40a4||fffd|p|fffd|b|fffd|N"
                MailCol = 7
            Case "DM|fffd||fffd|"
                MailCol = 8
        End Select
        
        
        Subject = Sheets("MailConfig").Cells(21, MailCol) ''|fffd||85bc|
        Body = Sheets("MailConfig").Cells(22, MailCol) ''|fffd|{|fffd||fffd|
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||352|u|fffd||fffd|
        Subject = Replace(Subject, "%BuyerName%", BuyerName)
        Body = Replace(Body, "%BuyerName%", BuyerName)
        
        Subject = Replace(Subject, "%SendAddress%", SendAddress)
        Body = Replace(Body, "%SendAddress%", SendAddress)
        
        Subject = Replace(Subject, "%ItemName%", ItemName)
        Body = Replace(Body, "%ItemName%", ItemName)
        
        Subject = Replace(Subject, "%SendMethod%", SendMethod)
        Body = Replace(Body, "%SendMethod%", SendMethod)
        
        Subject = Replace(Subject, "%TrackingNumber%", TrackingNumber)
        Body = Replace(Body, "%TrackingNumber%", TrackingNumber)
        
        Subject = Replace(Subject, "%ShippingDate%", ShippingDate)
        Body = Replace(Body, "%ShippingDate%", ShippingDate)
        
        '|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|M
            SendGmail2 MailFrom, _
                Sheets("MailConfig").Cells(4, 2), _
                MailTo, _
                "", _
                "", _
                Subject, _
                Body, _
                "utf-8"
    
    Set bobj = Nothing
                    
     MsgBox "2|fffd||296||681|i" & Sheets("MailConfig").Cells(19, 2) & "|fffd||fffd||fffd||fffd||251||fffd||fffd||90c1||fffd|[|fffd||fffd||fffd|j|fffd||303|e|fffd|X|fffd|g|fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
End Sub

' Option Explicit
Public Sub Sample()
  SendGmail "(Google |fffd|A|fffd|J|fffd|E|fffd||fffd||fffd|g)@gmail.com", _
            "(Google |fffd|A|fffd|J|fffd|E|fffd||fffd||fffd|g |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h)", _
            "(To|fffd|A|fffd|h|fffd||fffd||fffd|X)", _
            "", _
            "", _
            "|fffd||fffd||fffd||fffd|", _
            "|fffd|{|fffd||fffd||fffd||142||fffd||fffd|B", _
            ""
End Sub
 
Private Sub SendGmail(ByVal AccountAddress As String, _
                      ByVal AccountPassword As String, _
                      ByVal MailTo As String, _
                      ByVal MailCc As String, _
                      ByVal MailBcc As String, _
                      ByVal MailSubject As String, _
                      ByVal MailBody As String, _
                      Optional ByVal AttachmentFilePath As String = "")
'CDO|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|Gmail|fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|
  Const cdoBasic = 1
  Const cdoSendUsingPort = 2
  Const cdoSendPassword = "http://schemas.microsoft.com/cdo/configuration/sendpassword"
  Const cdoSendUserName = "http://schemas.microsoft.com/cdo/configuration/sendusername"
  Const cdoSendUsingMethod = "http://schemas.microsoft.com/cdo/configuration/sendusing"
  Const cdoSMTPConnectionTimeout = "http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout"
  Const cdoSMTPServer = "http://schemas.microsoft.com/cdo/configuration/smtpserver"
  Const cdoSMTPServerPort = "http://schemas.microsoft.com/cdo/configuration/smtpserverport"
  Const cdoSMTPUseSSL = "http://schemas.microsoft.com/cdo/configuration/smtpusessl"
  Const cdoSMTPAuthenticate = "http://schemas.microsoft.com/cdo/configuration/smtpauthenticate"
  
  With CreateObject("CDO.Message")
    .From = AccountAddress
    .To = MailTo
    If Len(Trim(MailCc)) > 0 Then .CC = MailCc
    If Len(Trim(MailBcc)) > 0 Then .BCC = MailBcc
    .Subject = MailSubject
    .TextBody = MailBody
    If Len(Trim(AttachmentFilePath)) > 0 Then .AddAttachment AttachmentFilePath
    With .Configuration.fields
      .Item(cdoSendPassword).value = AccountPassword
      .Item(cdoSendUserName).value = AccountAddress
      .Item(cdoSendUsingMethod).value = cdoSendUsingPort
      .Item(cdoSMTPConnectionTimeout).value = 100
      .Item(cdoSMTPAuthenticate).value = cdoBasic
      .Item(cdoSMTPServer).value = "smtp.gmail.com"
      .Item(cdoSMTPServerPort).value = 465
      .Item(cdoSMTPUseSSL).value = True
      .Update
    End With
    On Error Resume Next
    .send
    If Err.Number <> 0 Then
      MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & _
             "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & _
             "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical + vbSystemModal
    End If
    On Error GoTo 0
  End With
End Sub

Private Sub SendGmail2(ByVal AccountAddress As String, _
                      ByVal AccountPassword As String, _
                      ByVal MailTo As String, _
                      ByVal MailCc As String, _
                      ByVal MailBcc As String, _
                      ByVal MailSubject As String, _
                      ByVal MailBody As String, _
                      Optional ByVal MailCharset As String = "iso-2022-jp", _
                      Optional ByVal AttachmentFilePath As String = "")
'CDO|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|Gmail|fffd||fffd||fffd|M|fffd||fffd||fffd|s|fffd||fffd|
  Const cdoBasic = 1
  Const cdoSendUsingPort = 2
  Const cdoSendPassword = "http://schemas.microsoft.com/cdo/configuration/sendpassword"
  Const cdoSendUserName = "http://schemas.microsoft.com/cdo/configuration/sendusername"
  Const cdoSendUsingMethod = "http://schemas.microsoft.com/cdo/configuration/sendusing"
  Const cdoSMTPConnectionTimeout = "http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout"
  Const cdoSMTPServer = "http://schemas.microsoft.com/cdo/configuration/smtpserver"
  Const cdoSMTPServerPort = "http://schemas.microsoft.com/cdo/configuration/smtpserverport"
  Const cdoSMTPUseSSL = "http://schemas.microsoft.com/cdo/configuration/smtpusessl"
  Const cdoSMTPAuthenticate = "http://schemas.microsoft.com/cdo/configuration/smtpauthenticate"
   
  'Charset|fffd||752||fffd|
  MailCharset = LCase(StrConv(MailCharset, vbNarrow))
  Select Case MailCharset
    Case "big5", "euc-jp", "euc-kr", "gb2312", "iso-2022-jp", _
         "iso-2022-kr", "iso-8859-1", "iso-8859-2", "iso-8859-3", "iso-8859-4", _
         "iso-8859-5", "iso-8859-6", "iso-8859-7", "iso-8859-8", "iso-8859-9", _
         "koi8-r", "shift-jis", "us-ascii", "utf-7", "utf-8"
    Case Else: MailCharset = "shift-jis"
  End Select
   
  With CreateObject("CDO.Message")
    .From = AccountAddress
    .To = MailTo
    .BodyPart.Charset = MailCharset
    If Len(Trim(MailCc)) > 0 Then .CC = MailCc
    If Len(Trim(MailBcc)) > 0 Then .BCC = MailBcc
    .Subject = MailSubject
    .TextBody = MailBody
    If Len(Trim(AttachmentFilePath)) > 0 Then .AddAttachment AttachmentFilePath
    With .Configuration.fields
      .Item(cdoSendPassword).value = AccountPassword
      .Item(cdoSendUserName).value = AccountAddress
      .Item(cdoSendUsingMethod).value = cdoSendUsingPort
      .Item(cdoSMTPConnectionTimeout).value = 100
      .Item(cdoSMTPAuthenticate).value = cdoBasic
      .Item(cdoSMTPServer).value = "smtp.gmail.com"
      .Item(cdoSMTPServerPort).value = 465
      .Item(cdoSMTPUseSSL).value = True
      .Update
    End With
    On Error Resume Next
    .send
    If Err.Number <> 0 Then
      MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & _
             "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & _
             "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical + vbSystemModal
    End If
    On Error GoTo 0
  End With
End Sub
                    
Function EncodeUTF8(ByVal DataText As String) As String '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|UTF-8|fffd||143|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||90c6||fffd|[|fffd|U|fffd|[|fffd||fffd|`|fffd||590||fffd|

 

Dim Data As Variant
Dim d() As String
Dim D2() As String
Dim i As Integer
Dim j As Integer

 

ReDim Data(Len(DataText))
ReDim d(Len(DataText) * 4)
ReDim D2(Len(DataText) * 3)

 

If DataText = "" Then
        EncodeUTF8 = CVErr(xlErrValue)
        Exit Function
End If

For i = 1 To Len(DataText)
    Data(i) = Hex(AscW(Mid$(DataText, i, 1)))
    For j = 1 To 4
        d(i * 4 - 4 + j) = Mid$(Data(i), j, 1)
    Next j
Next i

For i = 1 To Len(DataText)
    If Len(Data(i)) = 4 Then
            D2(i * 3 - 3 + 1) = "%" & Hex(Hex("&H" & d(i * 3 - 3 + 1) + &HE0))
            D2(i * 3 - 3 + 2) = "%" & Hex(Hex(("&H" & d(i * 3 - 3 + 2) * 4 + &H80) + ("&H" & d(i * 3 - 3 + 3) And &HC) / 4))
            D2(i * 3 - 3 + 3) = "%" & Hex(("&H" & (d(i * 3 - 3 + 3) & d(i * 3 - 3 + 4)) And &H3F) + &H80)
           
            EncodeUTF8 = EncodeUTF8 & D2(i * 3 - 3 + 1) & D2(i * 3 - 3 + 2) & D2(i * 3 - 3 + 3)
        Else
            EncodeUTF8 = EncodeUTF8 & "%" & Data(i)
    End If
Next i

 

End Function
                    
Attribute VB_Name = "Module19"

'// |fffd|w|fffd||fffd|URL|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
Private Declare Function URLDownloadToFile _
    Lib "urlmon" Alias "URLDownloadToFileA" _
    (ByVal pCaller As Long, _
    ByVal szURL As String, _
    ByVal szFileName As String, _
    ByVal dwReserved As Long, _
    ByVal lpfnCB As Long) As Long
 
'// |fffd|L|fffd||fffd||fffd|b|fffd|V|fffd||fffd||fffd|N|fffd||fffd||fffd|A
Private Declare Function DeleteUrlCacheEntry _
    Lib "wininet" Alias "DeleteUrlCacheEntryA" _
    (ByVal lpszUrlName As String) As Long
 
'// |fffd|X|fffd||fffd||fffd|[|fffd|v
Private Declare Sub Sleep _
    Lib "kernel32" (ByVal dwMilliseconds As Long)


Option Explicit
Const FileNameSheet = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|"
Const FileNameCell = "A1"
Const HashStoreSheet = "|fffd|T|fffd||fffd||fffd|l"
Const HashStoreColumn = "B"

Dim Crc32Table&(255)


Function TsvSend(strFileName As String)
'|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|MD5|fffd||fffd||fffd|K|fffd|{|fffd|B|fffd|@|fffd||fffd||fffd||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||248||682||fffd||fffd||a347||fffd||34e|Q|fffd||190||752||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|B
'|fffd||3d0||fffd||fffd||933e|=======================================================================================================
'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||315||3d0||fffd|------------------------------------------------
Dim Url As String
Dim rawText As String
Dim timestamp As String
Dim SignedUrl As String

'******************************
Dim MWSsKey As String
    MWSsKey = Worksheets("Config").Range("B52")
Dim sKey As String
    sKey = Worksheets("Debug").Range("B4")
Dim AWSkey As String
    AWSkey = Worksheets("Debug").Range("B3")
    
'******************************
    
Dim MarketPlaceID As String
    MarketPlaceID = "A1VC38T7YXB528"
Dim sellerID As String
    sellerID = Worksheets("Config").Range("B53")

Dim APIVersion As String
    APIVersion = "2011-10-01"
Dim ecsaddress As String
    ecsaddress = "mws.amazonservices.jp"
   
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||302||fffd||fffd||7c2||315||3d0||fffd|-----------------------------------------------------
Dim hash, hash_2, hash_cut2, hash_10, hash_cut10 As String
Dim base64Array As Variant
Dim base64Array2 As Variant
Dim sign As String
Dim sign2 As String
Dim rawTextToSign As String
Dim rawTextToSign2 As String

Dim i As Integer, j As Integer, k As Integer

'********************************************************************************************************



'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||24e|g|fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|v---------------------------------------------------------------------------------
If Format(Now(), "hh") >= 9 Then
    timestamp = Format(Date, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
Else
    timestamp = Format(Date - 1, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
End If


'************************
'|fffd||fffd||fffd|M|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|MD5|fffd||64fe|

    ChDrive ActiveWorkbook.Path
    ChDir ActiveWorkbook.Path

    
Dim objMD5 As New MD5 'Class|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|MD5|fffd|Q|fffd||fffd|
    objMD5.FilePath = strFileName  'Class|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|MD5|fffd|Q|fffd||fffd|
Dim myMD5 As String
    myMD5 = objMD5.FileHash  'Class|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|MD5|fffd|Q|fffd||fffd|

'Base64|fffd||583|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|iMD5|fffd|w|fffd|b|fffd|_|fffd||30f||a347||fffd||fffd|URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|s|fffd|v|fffd|j
Dim myMD5_base64 As String
    myMD5_base64 = HexToBase64(myMD5)
    'myMD5_base64 = URLencode(myMD5_base64)|fffd|w|fffd|b|fffd|_|fffd||242||343|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|s|fffd|v
        
'************************
'|fffd||fffd||fffd||fffd||fffd||38f||6d5||fffd||fffd||fffd||fffd||fffd|i|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|j|fffd||c42c|
                
    rawText = ""
        ' |fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||c42c|(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||343|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||fffd||fffd||202||302||14f||fffd||fffd||502||fffd||3c2||fffd||fffd||fffd||fffd|NG)
    rawText = rawText _
  & "AWSAccessKeyId=" & AWSkey _
  & "&Action=SubmitFeed" _
  & "&FeedType=_POST_FLAT_FILE_FULFILLMENT_DATA_" _
  & "&MWSAuthToken=" & MWSsKey _
  & "&MarketplaceIdList.Id.1=A1VC38T7YXB528" _
  & "&SellerId=" & sellerID _
  & "&SignatureMethod=HmacSHA256" _
  & "&SignatureVersion=2" _
  & "&Timestamp=" & timestamp _
  & "&Version=2009-01-01" _

  '|fffd||202||fffd||fffd||102||fffd||fffd||fffd||fffd|C|fffd||203|N|fffd|G|fffd||fffd|
  '& "&ContentMD5Value=" & myMD5_base64 _
  '  & "&PurgeAndReplace=false" _

        '|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|URL|fffd||30d||c42c|-----------------------------------------------------------------
        '|fffd||fffd||fffd||fffd||fffd||38f||6d5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||103|V|fffd|[|fffd|N|fffd||fffd||fffd|b|fffd|g|fffd|L|fffd|[|fffd||143|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd|
        rawTextToSign = "POST" & vbLf & ecsaddress & vbLf & "/" & vbLf & rawText
        hash = Hmac(sKey, rawTextToSign)
        
        '2|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
        hash_2 = ""
        For k = 1 To 64 Step 2
            hash_cut2 = Mid(hash, k, 2)
            hash_2 = hash_2 & HEX2BIN(hash_cut2)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|00|fffd||156||fffd||fffd||7c2||fffd|
        hash_2 = hash_2 & "00"
          
        'BASE64|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = ""
        For k = 1 To 256 Step 6
            hash_cut10 = Mid(hash_2, k, 6)
            hash_10 = ncdec(2, hash_cut10)
            base64Array = Array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "+", "/")
            sign = sign & base64Array(hash_10)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|=|fffd||156||fffd||fffd||7c2||fffd|
        sign = sign & "="
        'URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = URLencode(sign)
        '|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|gURL|fffd||fffd||fffd||fffd|
        Url = "https://" & ecsaddress & "/?" & rawText & "&Signature=" & sign
        '----------------------------------------------------------------------------------
        
    '|fffd|f|fffd|o|fffd|b|fffd|O|fffd|p
    If Sheets("Debug").Cells(1, 3) = "ON" Then
        Sheets("Debug").Cells(1, 2) = Url
    End If

'*******************************************


    '-------------------------------------------
    '|fffd||fffd||fffd|M|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd|
    Dim objHTTP
    Dim stream

    ' XMLHTTP|fffd||fffd||fffd||c42c|
    Set objHTTP = CreateObject("MSXML2.XMLHTTP")
    ' Stream |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||30d||c42c|
    Set stream = CreateObject("ADODB.Stream")
    
    ' Stream|fffd||303|I|fffd|[|fffd|v|fffd||fffd|
    stream.Open
    stream.Type = 1 ' adTypeBinary
    
    ' |fffd||fffd||fffd|M|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||fffd|
    stream.LoadFromFile = strFileName
    
    '-------------------------------------------
    '|fffd|t|fffd|B|fffd|[|fffd|h|fffd||115c2||fffd|
    Dim msg1 As String
    
    '|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||702||fffd|URL|fffd||fffd|OK
    Call objHTTP.Open("POST", Url, False)
    '|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call objHTTP.setRequestHeader("user-agent", "KTN-TOOL (VBA)")  '|fffd||302||fffd||fffd||24f||18d||fffd||fffd||142||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd|
    Call objHTTP.setRequestHeader("Content-MD5", myMD5_base64) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|K|fffd|v|fffd||202||fffd|
    Call objHTTP.setRequestHeader("Content-Type", "text/tab-separated-values; charset=Shift_JIS")
    '|fffd|o|fffd|i|fffd|t|fffd|@|fffd|C|fffd||fffd|(I)|fffd||115d0|M
    Call objHTTP.send(stream.Read(stream.Size))
    ' Stream|fffd||fffd||82||fffd||fffd||fffd|
    stream.Close
    
    '|fffd|f|fffd|o|fffd|b|fffd|O|fffd|p
    If Sheets("Debug").Cells(1, 3) = "ON" Then
        Sheets("Debug").Cells(2, 2) = objHTTP.responseText
    End If
    
    '|fffd||fffd||fffd|X|fffd|||fffd||fffd||fffd|X|fffd||fffd||fffd||c2bce||fffd||fffd|iXML|fffd||14e||c2bce||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||20b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||642||fffd||fffd||fffd||fffd||60b3||fffd||fffd||fffd||fffd||fffd|j
    Dim xmldata As Object
    Dim Result As Object
    Dim SubmitId As String
'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s---------------------------------------
    Set xmldata = CreateObject("Microsoft.XMLDOM")
    xmldata.async = False
    xmldata.LoadXML (objHTTP.responseText)
    
'XML|fffd|f|fffd|[|fffd|^|fffd||30e||fffd||fffd|o|fffd||fffd|-------------------------------------
    Set Result = xmldata.SelectNodes("SubmitFeedResponse/SubmitFeedResult/FeedSubmissionInfo")
    Dim ReportRequestId As String

    If Not Result Is Nothing Then '|fffd||64fe||fffd||fffd||42a82||fffd||fffd||fffd||381|A
        If Result(0).SelectSingleNode("FeedProcessingStatus").Text = "_SUBMITTED_" Then
            TsvSend = Result(0).SelectSingleNode("FeedSubmissionId").Text
        Else
            TsvSend = Result(0).SelectSingleNode("FeedProcessingStatus").Text
        End If
    End If

    '|fffd||fffd||fffd|MOK|fffd||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||243|o|fffd|b|fffd|`ID|fffd||fffd||fffd||82||fffd||fffd||10d||3c3|t|fffd|H|fffd||fffd||fffd|_|fffd||588||693||fffd|
    '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd|G|fffd||fffd||fffd|[|fffd|\|fffd|L|fffd||183|o|fffd|b|fffd|`ID
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||fffd|
    
    If IsNumeric(TsvSend) = True Then
        Name strFileName As Left(strFileName, Len(strFileName) - 25) & "\|fffd|A|fffd|b|fffd|v|fffd||3c2||fffd|\" & Replace(Right(strFileName, 25), ".txt", "") & "|fffd|A|fffd|b|fffd|v|fffd||3c2||fffd|_" & TsvSend & ".txt"
        MsgBox "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|Amazon|fffd||251||fffd||fffd|M|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|o|fffd|b|fffd|`ID|fffd||fffd| " & TsvSend & "  |fffd||142||fffd||fffd|B"
    Else
        Name strFileName As Left(strFileName, Len(strFileName) - 25) & "\" & Replace(Right(strFileName, 25), ".txt", "") & "|fffd||fffd||fffd|M|fffd||fffd||fffd|s_" & TsvSend & ".txt"
        MsgBox "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311||fffd||fffd|M|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd| " & TsvSend & "  |fffd||142||fffd||fffd|B" & vbLf & vbLf & "|fffd||c42c||fffd||fffd||fffd||fffd||fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||341|u" & Replace(Right(strFileName, 25), ".txt", "") & "|fffd||fffd||fffd|M|fffd||fffd||fffd|s_" & TsvSend & ".txt |fffd||14f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
    End If


'*******************************************


End Function



Public Function HexToBase64(ByVal strHex As String) As String
     
    ' Function to convert a hex string into a base64 encoded string.
    Dim lngValue    As Long
    Dim lngTemp     As Long
    Dim lngChar     As Long
    Dim intLen      As Integer
    Dim k           As Integer
    Dim j           As Integer
    Dim strWord     As String
    Dim str64       As String
    Dim intTerm     As Integer
    
    Const B64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
     
    intLen = Len(strHex)
     
    ' Pad with zeros to multiple of 3 bytes.
    intTerm = intLen Mod 6
    If (intTerm = 4) Then
        strHex = strHex & "00"
        intLen = intLen + 2
    End If
    If (intTerm = 2) Then
        strHex = strHex & "0000"
        intLen = intLen + 4
    End If
     
    ' Parse into groups of 3 hex bytes.
    For k = 1 To intLen Step 2
        j = j + 1
        strWord = strWord & Mid(strHex, k, 2)
        If (j = 3) Then
            ' Convert 3 8-bit bytes into 4 6-bit characters.
            lngValue = CCur("&H" & strWord)
             
            lngTemp = Fix(lngValue / 64)
            lngChar = lngValue - (64 * lngTemp)
            str64 = Mid(B64, lngChar + 1, 1)
            lngValue = lngTemp
             
            lngTemp = Fix(lngValue / 64)
            lngChar = lngValue - (64 * lngTemp)
            str64 = Mid(B64, lngChar + 1, 1) & str64
            lngValue = lngTemp
             
            lngTemp = Fix(lngValue / 64)
            lngChar = lngValue - (64 * lngTemp)
            str64 = Mid(B64, lngChar + 1, 1) & str64
             
            str64 = Mid(B64, lngTemp + 1, 1) & str64
             
            HexToBase64 = HexToBase64 & str64
            j = 0
            strWord = ""
        End If
    Next
    
    ' Account for padding.
    If (intTerm = 4) Then HexToBase64 = Left(HexToBase64, Len(HexToBase64) - 1) & "="
    If (intTerm = 2) Then HexToBase64 = Left(HexToBase64, Len(HexToBase64) - 2) & "=="

End Function

' |fffd|w|fffd||80b5||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| MD5 |fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Function GetFileHashMD5(strFileName)
    Dim MD5
    Set MD5 = CreateObject("System.Security.Cryptography.MD5CryptoServiceProvider")
    MD5.ComputeHash_2 (ReadBinaryFile(strFileName))
    Dim msxml
    Set msxml = CreateObject("MSXML2.DOMDocument")
    Dim el
    Set el = msxml.createElement("tmp")
    el.dataType = "bin.hex"
    el.nodeTypedValue = MD5.hash
    GetFileHashMD5 = el.Text
End Function
' |fffd|w|fffd||80b5||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|o|fffd|C|fffd|g|fffd|z|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Function ReadBinaryFile(strFileName)
    Const adTypeBinary = 1
    Dim stm
    Set stm = CreateObject("ADODB.Stream")
    stm.Type = adTypeBinary
    stm.Open
    stm.LoadFromFile strFileName
    ReadBinaryFile = stm.Read
End Function


'|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd|16|fffd|i|fffd||fffd||fffd|`|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function encodeToHex(bytes() As Byte)
    encodeToHex = Encode("bin.Hex", bytes)
End Function
 
'|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd|BASE64|fffd|`|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function encodeToBase64(bytes() As Byte)
    encodeToBase64 = Encode("bin.base64", bytes)
End Function
 
'16|fffd|i|fffd||fffd||fffd|`|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd||fffd||243|f|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function decodeFromHex(Text As String)
    decodeFromHex = Decode("bin.Hex", Text)
End Function
 
'BASE64|fffd|`|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd||fffd||243|f|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function decodeFromBase64(Text As String)
    decodeFromBase64 = Decode("bin.base64", Text)
End Function
 
'|fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd|w|fffd||fffd|^|fffd|C|fffd|v|fffd||315||fffd||fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function Encode(dataType As String, bytes() As Byte)
    Dim oXmlDoc As New DOMDocument60 'Microsoft XML, v6.0|fffd||fffd||fffd|K|fffd|v
    With oXmlDoc
        .LoadXML ("<root />")
        .DocumentElement.dataType = dataType
        .DocumentElement.nodeTypedValue = bytes
    End With
    Encode = Replace(oXmlDoc.DocumentElement.Text, vbLf, "")
End Function
 
'|fffd|w|fffd||fffd|^|fffd|C|fffd|v|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd||fffd||243|f|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|B
Function Decode(dataType As String, Text As String)
    Dim oXmlDoc As New DOMDocument60 'Microsoft XML, v6.0|fffd||fffd||fffd|K|fffd|v
    With oXmlDoc
        .LoadXML ("<root />")
        .DocumentElement.dataType = dataType
        .DocumentElement.Text = Text
    End With
    Decode = oXmlDoc.DocumentElement.nodeTypedValue
End Function

Function EncodeBase64(Text As String) As String
  Dim arrData() As Byte
  arrData = StrConv(Text, vbFromUnicode)

  Dim objXML As MSXML2.DOMDocument60
  Dim objNode As MSXML2.IXMLDOMElement

  Set objXML = New MSXML2.DOMDocument60
  Set objNode = objXML.createElement("b64")

  objNode.dataType = "bin.base64"
  objNode.nodeTypedValue = arrData
  EncodeBase64 = objNode.Text

  Set objNode = Nothing
  Set objXML = Nothing
End Function



' |fffd||209||fffd||fffd|R|fffd|s|fffd|y
' http://d.hatena.ne.jp/n7shi/20100910/1284112553
' https://code.msdn.microsoft.com/office/VBACRC-32-dad7d087
' Dim I%, J%, R&, R1&|fffd||fffd||fffd|Q|fffd|l
' http://www.atmarkit.co.jp/fdotnet/vb6tonet/vb6tonet30/vb6tonet30_01.html

Private Sub InitCrc32Table()
    Dim i%, j%, R&, R1&
    For i = 0 To 255
        R = i
        For j = 0 To 7
            R1 = R And 1
            R = (R - R1) / 2
            If R < 0 Then R = R - &H80000000
            If R1 Then R = R Xor &HEDB88320
        Next j
        Crc32Table(i) = R
    Next i
End Sub

Public Function GetCrc32FromFile&(Path$)
    Dim R&, i&, b As Byte, FL&
    If Crc32Table(255) = 0 Then InitCrc32Table
    FL = FileLen(Path)
    Open Path For Binary Lock Read As #2
    R = Not 0
    For i = 1 To FL
        Get #2, , b
        R = (Int(R / 256) And &HFFFFFF) Xor Crc32Table((R Xor b) And &HFF)
    Next i
    Close #2
    GetCrc32FromFile = Not R
End Function



Attribute VB_Name = "Module2"
Sub |fffd|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd|I|fffd||fffd|()
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "txt |327||fffd||fffd| (*.txt),*.txt"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||835e||fffd||78f|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(40, 2).value = fPath
End Sub

Sub |fffd|O|fffd||fffd||fffd|A|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_()
Dim a As String
With Application.FileDialog(msoFileDialogFolderPicker)
.Show
a = .SelectedItems(1)

End With
    
    Sheets("Config").Range("B126") = a
End Sub

Sub |fffd||fffd||fffd|}|fffd|g|fffd||30e||fffd||835e||fffd||fffd|CSV|fffd|I|fffd||fffd|()

If Sheets("Config").Cells(129, 2) = "|fffd|C|fffd||fffd||fffd|X|fffd|g|fffd|[|fffd||fffd||fffd|^" Then
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "csv |327||fffd||fffd| (*.csv),*.csv"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||1d0||554||50d||fffd||fffd||fffd||835e||fffd||757|p|fffd||303||fffd||fffd|}|fffd|g|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(128, 2).value = fPath
Else
    Dim a As String
    With Application.FileDialog(msoFileDialogFolderPicker)
    .Show
    a = .SelectedItems(1)
    
    End With
        
        Sheets("Config").Range("B128") = a
End If

End Sub

Sub |fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd|I|fffd||fffd|()
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "txt |327||fffd||fffd| (*.txt),*.txt"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||835e||fffd||796||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(34, 2).value = fPath
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd|I|fffd||fffd|()
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "txt |327||fffd||fffd| (*.txt),*.txt"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||835e||fffd||792||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(36, 2).value = fPath
End Sub

Sub |fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd|I|fffd||fffd|()
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "txt |327||fffd||fffd| (*.txt),*.txt"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||835e||fffd||78f|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(38, 2).value = fPath
End Sub

Sub |fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------


Dim UnSendPass As String
Dim UnSendFullPass As String
Dim UnSendFile As String
Dim UnSendName As String


'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||310||752||fffd|----------------------------------


UnSendPass = Sheets("Config").Range("J34")
UnSendFullPass = Sheets("Config").Range("B34")
UnSendFile = Sheets("Config").Range("K34")
UnSendName = Sheets("Config").Range("L34")

Dim UnsendX As Long

'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("Report").Columns("A:AC").ClearContents

'|fffd|^|fffd|u|fffd||fffd||602||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|S|fffd||115||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113||1c2||74d||fffd||fffd||fffd|

    Dim FileName As String
    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd|
    FileName = UnSendFullPass


        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("Report").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FileName))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FileName For Input As #FileNo
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            Cnt = Cnt + 1
            SplitString = Split(Buf, vbTab)
            For i = 0 To UBound(SplitString)
                Sheets("Report").Cells(Cnt, i + 1) = SplitString(i)
            Next i
            Application.StatusBar = "|fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|X|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
        Loop
        Application.StatusBar = ""
        Close #FileNo

'|fffd||14f|I|fffd||312||fffd||fffd||fffd||fffd||fffd||fffd||64fe|---------------------------
Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LastOrderID As String
    LastOrderID = Sheets("Report").Cells(LastIndex, 1)
Dim LastItemID As String
    LastItemID = Sheets("Report").Cells(LastIndex, 2)
Dim LastSKU As String
    LastSKU = Sheets("Report").Cells(LastIndex, 11)
    
Sheets("TOP").Cells(34, 16) = LastOrderID
Sheets("TOP").Cells(35, 16) = Format(LastItemID, "00000000000000")
Sheets("TOP").Cells(36, 16) = LastSKU
    
'---------------------------------------------

Application.StatusBar = "|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd||fffd||fffd|o|fffd||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||451||582||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

If Sheets("Config").Cells(48, 2) = "|fffd|~|fffd||fffd|" Then
    Sheets("Report").Rows("1:1").AutoFilter
    Sheets("Report").AutoFilter.Sort.SortFields.Clear
    Sheets("Report").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("K1"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With Sheets("Report").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("Report").Rows("1:1").AutoFilter

Else
    Sheets("Report").Rows("1:1").AutoFilter
    Sheets("Report").AutoFilter.Sort.SortFields.Clear
    Sheets("Report").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("K1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With Sheets("Report").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("Report").Rows("1:1").AutoFilter
End If
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub
Sub SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd|O()

If Sheets("Config").Cells(67, 2) = "ON" Then
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
    Application.ScreenUpdating = False

    Dim LastIndex As Long
        LastIndex = Sheets("Report").Cells(Rows.count, 11).End(xlUp).Row
    
    Dim Ini1 As String
    Dim Ini2 As String
    Dim Ini3 As String
    Dim Ini4 As String
    Dim Ini5 As String
    Dim Ini6 As String
    Dim Ini7 As String
    Dim Ini8 As String
    Dim Ini9 As String
    Dim Ini0 As String
    
    Ini1 = Sheets("Config").Cells(68, 2)
    Ini2 = Sheets("Config").Cells(69, 2)
    Ini3 = Sheets("Config").Cells(70, 2)
    Ini4 = Sheets("Config").Cells(71, 2)
    Ini5 = Sheets("Config").Cells(72, 2)
    Ini6 = Sheets("Config").Cells(73, 2)
    Ini7 = Sheets("Config").Cells(74, 2)
    Ini8 = Sheets("Config").Cells(75, 2)
    Ini9 = Sheets("Config").Cells(76, 2)
    Ini0 = Sheets("Config").Cells(77, 2)
    
    Dim SKU As String
    Dim DelateJudge As String
    

    For i = 2 To LastIndex
        SKU = Sheets("Report").Cells(i, 11)
        
        If Left(SKU, Len(Ini1)) = Ini1 And Ini1 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini2)) = Ini2 And Ini2 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If

        If Left(SKU, Len(Ini3)) = Ini3 And Ini3 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini4)) = Ini4 And Ini4 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini5)) = Ini5 And Ini5 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini6)) = Ini6 And Ini6 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini7)) = Ini7 And Ini7 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini8)) = Ini8 And Ini8 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini9)) = Ini9 And Ini9 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini0)) = Ini0 And Ini0 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
    
        
labelDel:
        If DelateJudge = "ON" Then
            Sheets("Report").Rows(i & ":" & i).ClearContents
            DelateJudge = "OFF"
        End If
    
    Application.StatusBar = "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|SKU|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|@" & i & "/" & LastIndex
    DoEvents
    Next

    Application.StatusBar = ""
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
    Application.ScreenUpdating = True

End If
End Sub

Sub |fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim ReportX As Long
    ReportX = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row
    
Dim NO As Long
Dim SKU As String
Dim Tittle As String
Dim Name As String
Dim BuyNumber As Long
Dim OrderId As String
Dim OrderNumber As Long


Dim PickingX As Long
    PickingX = Sheets("Picking").Cells(Rows.count, 3).End(xlUp).Row
    
    Sheets("Picking").Range("G2:J2").ClearContents
    '|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    If PickingX > 3 Then
        Sheets("Picking").Range("A4:J" & PickingX).ClearContents
        
        Sheets("Picking").Range("A4:J" & PickingX).Borders.LineStyle = False
        Sheets("Picking").Range("A4:J" & PickingX).Font.ColorIndex = 1
    End If
    
    Sheets("Picking").Cells(1, 3) = "|fffd|o|fffd||353||fffd||fffd||fffd||fffd|F " & Format(Now(), "YYYY/MM/DD") & "   " & Format(Now(), "hh:mm")
    
    
    For i = 2 To ReportX
    If Sheets("Report").Cells(i, 1) <> "" Then
        PickingX = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row + 1
        
        NO = Format(PickingX - 3, "000")
        SKU = Sheets("Report").Cells(i, 11)
        Tittle = Sheets("Report").Cells(i, 12)
        If Len(Tittle) > 50 Then '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7427||fffd||fffd|
            Tittle = Left(Tittle, 50)
        End If
        Name = Sheets("Report").Cells(i, 17)
        BuyNumber = Sheets("Report").Cells(i, 15)
        OrderId = Sheets("Report").Cells(i, 1)
        
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N
        OrderNumber = Application.WorksheetFunction.CountIf(Sheets("Report").Columns("A:A"), OrderId)
        
        '|fffd|s|fffd||fffd||fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        
        Sheets("Picking").Cells(PickingX, 1) = NO
        Sheets("Picking").Cells(PickingX, 2) = SKU
        Sheets("Picking").Cells(PickingX, 3) = Tittle
        Sheets("Picking").Cells(PickingX, 4) = Name
        
        If BuyNumber > 1 Then
            Sheets("Picking").Cells(PickingX, 5) = BuyNumber
        End If
        
        If OrderNumber > 1 Then
            Sheets("Picking").Cells(PickingX, 6) = OrderNumber
        End If
        

        '---------------------------------------------------------------------------------------
        '|fffd||fffd||fffd||fffd||fffd|F|fffd|P
        
        '|fffd||fffd||fffd||fffd||fffd|F2
    End If
        Application.StatusBar = "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o|fffd||fffd||fffd|@" & i & "/" & ReportX
    DoEvents
    Next

    Sheets("Picking").Cells(PickingX + 1, 3) = "|fffd||20f||fffd| " & NO & "|fffd|_"

    '|fffd|r|fffd||fffd|------------------------------
                    With Sheets("Picking").Range("A4:F" & PickingX)
                    .Borders(xlEdgeTop).LineStyle = xlDouble
                    .Borders(xlEdgeBottom).LineStyle = xlContinuous
                    .Borders(xlEdgeRight).LineStyle = xlContinuous
                    .Borders(xlEdgeLeft).LineStyle = xlContinuous
                    .Borders(xlInsideVertical).LineStyle = xlContinuous
                    .Borders(xlInsideHorizontal).LineStyle = xlDot
                    End With
    '-----------------------------------
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True

End Sub

Sub |fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||30c|r|fffd||fffd||fffd||190|F|fffd|t()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

'|fffd|r|fffd||fffd||fffd||310||752||fffd|
Dim OrderColer As String
    OrderColer = Sheets("Config").Cells(51, 2)
Dim NumberColer As String
    NumberColer = Sheets("Config").Cells(52, 2)
Dim InitialLine As String
    InitialLine = Sheets("Config").Cells(53, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row

For i = 4 To LastIndex
    '|fffd|F|fffd|t|fffd||30e||fffd||fffd|{---------------------------------------------------------------------------
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||310|F|fffd|t
    If OrderColer = "ON" Then
        If Sheets("Picking").Cells(i, 6) <> "" Then
            Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 41
        End If
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||310|F|fffd|t
    If NumberColer = "ON" Then
        If Sheets("Picking").Cells(i, 5) <> "" And Sheets("Picking").Cells(i, 6) <> "" Then
            Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 7
        Else
            '|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd||fffd||fffd||310|F|fffd|t
            If Sheets("Picking").Cells(i, 5) <> "" And OrderColer = "ON" Then
                Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 3
            End If
        End If
    End If
    '----------------------------------------------------------------------------------------
    '|fffd|I|fffd||fffd||fffd||182||30c|r|fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------------------------------------------
    If InitialLine = "ON" And i <> 4 Then
        If Left(Sheets("Picking").Cells(i, 2), 1) <> Left(Sheets("Picking").Cells(i - 1, 2), 1) Then
                    With Sheets("Picking").Range("A" & i & ":F" & i)
                    .Borders(xlEdgeTop).LineStyle = xlContinuous
                    End With
        End If
    End If
    '----------------------------------------------------------------------------------------
Application.StatusBar = "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||310|F|fffd||fffd||fffd||fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|{|fffd|@" & i & "/" & LastIndex
DoEvents
Next

Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True

End Sub


Sub |fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||fffd||fffd|()
    Sheets("Picking").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(6, 2), Collate _
        :=True
End Sub
Attribute VB_Name = "Module20"
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'@name      MD5|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
'@version   1.00 - Sun May 13, 2012
'           1.01 - Fri Jul  5, 2013
'           1.02 - Wed Feb  5, 2014
'
'@author    Syunzi Shimohata    <webmaster@taru-net.jp>   http://www.taru-net.jp/
'           Online Reference [http://www.taru-net.jp/excel/excelVBA/MD5/readme.html]
'
'@copyright (C) 2012, Syunzi Shimohata. Japan. All Rights Reserved.
'
'@memo      http://www.ipa.go.jp/security/rfc/RFC1321JA.html
'           md5c.c
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/

'Constants for MD5Transform routine.
Private Const S11 = 7
Private Const S12 = 12
Private Const S13 = 17
Private Const S14 = 22
Private Const S21 = 5
Private Const S22 = 9
Private Const S23 = 14
Private Const S24 = 20
Private Const S31 = 4
Private Const S32 = 11
Private Const S33 = 16
Private Const S34 = 23
Private Const S41 = 6
Private Const S42 = 10
Private Const S43 = 15
Private Const S44 = 21

'MD5 context.
Private Type Context
    state(3) As Long
    count(1) As Long
    buffer(63) As Long
End Type


Private mvarCharset As String
Private mvarText As String
Private mvarFilePath As String
Private mvarStrLen As Long
Private mvarStrByte() As Byte


Private Sub Class_Initialize()
    Me.Charset = "SHIFT-JIS"
End Sub
Private Sub Class_Terminate()
End Sub


'F, G, H and I are basic MD5 functions.
Private Function F(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    F = (x And y) Or ((Not x) And z)
End Function

Private Function G(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    G = (x And z) Or (y And (Not z))
End Function

Private Function h(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    h = x Xor y Xor z
End Function

Private Function i(ByVal x As Long, ByVal y As Long, ByVal z As Long) As Long
    i = y Xor (x Or (Not z))
End Function


'ROTATE_LEFT rotates x left n bits.
Private Function ROTATE_LEFT(ByVal x As Long, ByVal n As Byte) As Long
    ROTATE_LEFT = fncLeftShift(x, n) Or fncRightShift(x, 32 - n)
End Function


'FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
'Rotation is separate from addition to prevent recomputation.
Private Sub FF(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, F(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub GG(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, G(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub HH(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, h(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub

Private Sub II(ByRef a As Long, ByVal b As Long, ByVal c As Long, ByVal d As Long, _
               ByVal x As Long, ByVal s As Long, ByVal ac As Long)
    a = fucAddBit(a, i(b, c, d))
    a = fucAddBit(a, x)
    a = fucAddBit(a, ac)
    a = ROTATE_LEFT(a, s)
    a = fucAddBit(a, b)
End Sub


'MD5 initialization. Begins an MD5 operation, writing a new context.
Private Sub MD5Init(ByRef Context As Context)
    Context.count(0) = 0
    Context.count(1) = 0
    
    'Load magic initialization constants.
    Context.state(0) = &H67452301
    Context.state(1) = &HEFCDAB89
    Context.state(2) = &H98BADCFE
    Context.state(3) = &H10325476
End Sub


'MD5 block update operation. Continues an MD5 message-digest
'operation, processing another message block, and updating the
'context.
Private Sub MD5Update(ByRef Context As Context, ByRef valInput As Variant, ByVal inputLen As Long)
    Dim i As Long
    Dim index As Byte
    Dim partLen As Byte


    'Compute number of bytes mod 64
    index = fncRightShift(Context.count(0), 3) And &H3F
    
    'Update number of bits
    Context.count(0) = fucAddBit(Context.count(0), fncLeftShift(inputLen, 3))
    If Context.count(0) < fncLeftShift(inputLen, 3) Then
        Context.count(1) = fucAddBit(Context.count(1), 1)
    End If

    Context.count(1) = fucAddBit(Context.count(1), fncRightShift(inputLen, 29))
    partLen = 64 - index
    
    'Transform as many times as possible.
    If inputLen >= partLen Then
        Call MD5_memcpy(Context.buffer, index, valInput, 0, partLen)
        Call MD5Transform(Context.state, Context.buffer, 0)

        For i = partLen To inputLen - 63 - 1 Step 64
            Call MD5Transform(Context.state, valInput, i)
        Next
        index = 0
    Else
        i = 0
    End If

    'Buffer remaining input
    'Context.buffer = valBuf()
    Call MD5_memcpy(Context.buffer, index, valInput, i, inputLen - i)
End Sub


'MD5 finalization. Ends an MD5 message-digest operation, writing the
'the message digest and zeroizing the context.
Private Sub MD5Final(ByRef digest As Variant, ByRef Context As Context)
    Dim bits(7) As Byte
    Dim index As Byte
    Dim padLen As Byte
    Dim i As Byte

    Call Encode(bits, Context.count, 8)
    index = fncRightShift(Context.count(0), 3) And &H3F
    If index < 56 Then
        padLen = 56 - index
    Else
        padLen = 120 - index
    End If
    

    Call MD5Update(Context, Me.PADDING, padLen)
    Call MD5Update(Context, bits, 8)
    Call Encode(digest, Context.state, 16)
End Sub


'MD5 basic transformation. Transforms state based on block.
Private Sub MD5Transform(ByRef state As Variant, ByRef block As Variant, ByVal offset As Long)
    Dim a As Long
    Dim b As Long
    Dim c As Long
    Dim d As Long

    
    a = state(0)
    b = state(1)
    c = state(2)
    d = state(3)
    
    
    Dim x(15)
    Call Decode(x, block, offset, 64)


    ' Round 1
    Call FF(a, b, c, d, x(0), S11, &HD76AA478)  '  1
    Call FF(d, a, b, c, x(1), S12, &HE8C7B756)  '  2
    Call FF(c, d, a, b, x(2), S13, &H242070DB)  '  3
    Call FF(b, c, d, a, x(3), S14, &HC1BDCEEE)  '  4
    Call FF(a, b, c, d, x(4), S11, &HF57C0FAF)  '  5
    Call FF(d, a, b, c, x(5), S12, &H4787C62A)  '  6
    Call FF(c, d, a, b, x(6), S13, &HA8304613)  '  7
    Call FF(b, c, d, a, x(7), S14, &HFD469501)  '  8
    Call FF(a, b, c, d, x(8), S11, &H698098D8)  '  9
    Call FF(d, a, b, c, x(9), S12, &H8B44F7AF)  ' 10
    Call FF(c, d, a, b, x(10), S13, &HFFFF5BB1) ' 11
    Call FF(b, c, d, a, x(11), S14, &H895CD7BE) ' 12
    Call FF(a, b, c, d, x(12), S11, &H6B901122) ' 13
    Call FF(d, a, b, c, x(13), S12, &HFD987193) ' 14
    Call FF(c, d, a, b, x(14), S13, &HA679438E) ' 15
    Call FF(b, c, d, a, x(15), S14, &H49B40821) ' 16

    ' Round 2
    Call GG(a, b, c, d, x(1), S21, &HF61E2562)  ' 17
    Call GG(d, a, b, c, x(6), S22, &HC040B340)  ' 18
    Call GG(c, d, a, b, x(11), S23, &H265E5A51) ' 19
    Call GG(b, c, d, a, x(0), S24, &HE9B6C7AA)  ' 20
    Call GG(a, b, c, d, x(5), S21, &HD62F105D)  ' 21
    Call GG(d, a, b, c, x(10), S22, &H2441453)  ' 22
    Call GG(c, d, a, b, x(15), S23, &HD8A1E681) ' 23
    Call GG(b, c, d, a, x(4), S24, &HE7D3FBC8)  ' 24
    Call GG(a, b, c, d, x(9), S21, &H21E1CDE6)  ' 25
    Call GG(d, a, b, c, x(14), S22, &HC33707D6) ' 26
    Call GG(c, d, a, b, x(3), S23, &HF4D50D87)  ' 27
    Call GG(b, c, d, a, x(8), S24, &H455A14ED)  ' 28
    Call GG(a, b, c, d, x(13), S21, &HA9E3E905) ' 29
    Call GG(d, a, b, c, x(2), S22, &HFCEFA3F8)  ' 30
    Call GG(c, d, a, b, x(7), S23, &H676F02D9)  ' 31
    Call GG(b, c, d, a, x(12), S24, &H8D2A4C8A) ' 32

    ' Round 3
    Call HH(a, b, c, d, x(5), S31, &HFFFA3942)  ' 33
    Call HH(d, a, b, c, x(8), S32, &H8771F681)  ' 34
    Call HH(c, d, a, b, x(11), S33, &H6D9D6122) ' 35
    Call HH(b, c, d, a, x(14), S34, &HFDE5380C) ' 36
    Call HH(a, b, c, d, x(1), S31, &HA4BEEA44)  ' 37
    Call HH(d, a, b, c, x(4), S32, &H4BDECFA9)  ' 38
    Call HH(c, d, a, b, x(7), S33, &HF6BB4B60)  ' 39
    Call HH(b, c, d, a, x(10), S34, &HBEBFBC70) ' 40
    Call HH(a, b, c, d, x(13), S31, &H289B7EC6) ' 41
    Call HH(d, a, b, c, x(0), S32, &HEAA127FA)  ' 42
    Call HH(c, d, a, b, x(3), S33, &HD4EF3085)  ' 43
    Call HH(b, c, d, a, x(6), S34, &H4881D05)   ' 44
    Call HH(a, b, c, d, x(9), S31, &HD9D4D039)  ' 45
    Call HH(d, a, b, c, x(12), S32, &HE6DB99E5) ' 46
    Call HH(c, d, a, b, x(15), S33, &H1FA27CF8) ' 47
    Call HH(b, c, d, a, x(2), S34, &HC4AC5665)  ' 48

    ' Round 4
    Call II(a, b, c, d, x(0), S41, &HF4292244)  ' 49
    Call II(d, a, b, c, x(7), S42, &H432AFF97)  ' 50
    Call II(c, d, a, b, x(14), S43, &HAB9423A7) ' 51
    Call II(b, c, d, a, x(5), S44, &HFC93A039)  ' 52
    Call II(a, b, c, d, x(12), S41, &H655B59C3) ' 53
    Call II(d, a, b, c, x(3), S42, &H8F0CCC92)  ' 54
    Call II(c, d, a, b, x(10), S43, &HFFEFF47D) ' 55
    Call II(b, c, d, a, x(1), S44, &H85845DD1)  ' 56
    Call II(a, b, c, d, x(8), S41, &H6FA87E4F)  ' 57
    Call II(d, a, b, c, x(15), S42, &HFE2CE6E0) ' 58
    Call II(c, d, a, b, x(6), S43, &HA3014314)  ' 59
    Call II(b, c, d, a, x(13), S44, &H4E0811A1) ' 60
    Call II(a, b, c, d, x(4), S41, &HF7537E82)  ' 61
    Call II(d, a, b, c, x(11), S42, &HBD3AF235) ' 62
    Call II(c, d, a, b, x(2), S43, &H2AD7D2BB)  ' 63
    Call II(b, c, d, a, x(9), S44, &HEB86D391)  ' 64

    state(0) = fucAddBit(state(0), a)
    state(1) = fucAddBit(state(1), b)
    state(2) = fucAddBit(state(2), c)
    state(3) = fucAddBit(state(3), d)
    
End Sub


'Encodes input (UINT4) into output (unsigned char). Assumes len is
'a multiple of 4.
Private Sub Encode(ByRef output As Variant, ByRef valInput As Variant, ByVal valLen As Long)
    Dim i As Long
    Dim j As Long
    
    i = 0
    j = 0
    
    Do While j < valLen
        output(j) = valInput(i) And &HFF
        output(j + 1) = fncRightShift(valInput(i), 8) And &HFF
        output(j + 2) = fncRightShift(valInput(i), 16) And &HFF
        output(j + 3) = fncRightShift(valInput(i), 24) And &HFF
        i = i + 1
        j = j + 4
    Loop
End Sub


'Decodes input (unsigned char) into output (UINT4). Assumes len is
'a multiple of 4.
Private Sub Decode(ByRef output As Variant, ByRef valInput As Variant, ByVal inputPoint As Long, _
                   ByVal valLen As Long)
    Dim i As Long
    Dim j As Long
    Dim Buf As Long
          
    i = 0
    j = 0
    Buf = 0
    
    Do While j < valLen
        Buf = j + inputPoint
        output(i) = valInput(Buf) Or fncLeftShift(valInput(Buf + 1), 8) Or _
                    fncLeftShift(valInput(Buf + 2), 16) Or fncLeftShift(valInput(Buf + 3), 24)
        i = i + 1
        j = j + 4
    Loop
End Sub


'Note: Replace "for loop" with standard memcpy if possible.
Private Sub MD5_memcpy(ByRef output As Variant, ByVal outputPoint As Long, ByRef valInput As Variant, _
                       ByVal inputPoint As Long, ByVal valLen As Long)
    Dim i As Long
    For i = 0 To valLen - 1
        output(i + outputPoint) = valInput(i + inputPoint)
    Next
End Sub


Private Function MDPrint(ByRef digest As Variant) As String
    Dim Str As String
    Dim i As Integer
    
    For i = 0 To 16 - 1
        Str = Str & Right("00" & LCase(Hex(digest(i))), 2)
    Next
    
    MDPrint = Str
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|PADDING();
'@title     : [PADDING]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     :
'
'@return    : [PADDING]|fffd||8414||fffd|z|fffd||fffd|/Variant
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Get PADDING() As Variant()
    Dim valArray() As Variant
    valArray = Array( _
        &H80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, _
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, _
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 _
    )

    PADDING = valArray
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncLeftShift();
'@title     : |fffd||fffd||fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[<<]|fffd||255||3c2||fffd||fffd|A|fffd||fffd||fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Long
'             |fffd|V|fffd|t|fffd|g|fffd||fffd|/Byte
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fncLeftShift(ByVal val As Long, ByVal nBit As Byte) As Long
    Dim msb As Long
    Dim lsb As Long
    Dim tmp As Long
    
    If nBit = 0 Then
        msb = val
    Else
        lsb = 2 ^ (31 - nBit)
        tmp = val And (lsb - 1)
        msb = tmp * (2 ^ nBit)
        
        If val And lsb Then
            msb = msb Or &H80000000
        End If
    End If
    
    fncLeftShift = msb
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncRightShift();
'@title     : |fffd|E|fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[>>]|fffd||255||3c2||fffd||fffd|A|fffd|E|fffd|V|fffd|t|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Long
'             |fffd|V|fffd|t|fffd|g|fffd||fffd|/Byte
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fncRightShift(ByVal val As Long, ByVal nBit As Byte) As Long
    Dim msb As Long
    Dim lsb As Long

    If nBit = 0 Then
        msb = val
    Else
        lsb = val And &H7FFFFFFF

        If nBit = 31 Then
            msb = 0
        Else
            msb = lsb \ (2 ^ nBit)
        End If
        
        If lsb <> val Then
            msb = msb Or (2 ^ (31 - nBit))
        End If
    End If
        
    fncRightShift = msb
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fucAddBit();
'@title     : |fffd|r|fffd|b|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
'@summary   : C|fffd||fffd||fffd||fffd||fffd|[+=]|fffd||255||3c2||fffd||fffd|A|fffd|r|fffd|b|fffd|g|fffd||fffd||fffd|Z|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     : |fffd|l/Currency
'             |fffd|l/Currency
'
'@return    : |fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Function fucAddBit(ByVal a As Currency, ByVal b As Currency) As Long
    Dim tmp As Currency
    
    tmp = a + b
    If tmp > &H7FFFFFFF Then
        tmp = tmp - (2 ^ 32)
    ElseIf tmp < &H80000000 Then
        tmp = tmp + (2 ^ 32)
    End If
    
    fucAddBit = CLng(tmp)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncSpritStr();
'@title     : |fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd||3ca||fffd||fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||255||fffd||fffd||fffd||fffd||fffd||fffd||3c9||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd||58a|i|fffd|[|fffd||fffd||fffd||fffd|B
'
'@param     :
'
'@return    :
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Sub fncSpritStr()
    Dim valByte() As Byte
    Dim valArray() As Byte
    Dim num As Variant
    Dim count As Long
    Dim ADODB As Object
    Set ADODB = CreateObject("ADODB.Stream")

    If Me.Text = "" Then
        Me.StrByte = valArray
        Me.StrLen = 0
    Else
        ADODB.Open
        ADODB.Type = 2
        ADODB.Charset = Me.Charset
        ADODB.WriteText Me.Text
        ADODB.Position = 0
        ADODB.Type = 1
        
        If Me.Charset = "UNICODE" Then
            ADODB.Position = 2
            valByte = ADODB.Read
            
            count = 0
            For Each num In valByte
                If Not num = 0 Then
                    ReDim Preserve valArray(count)
                    valArray(count) = num
                    count = count + 1
                End If
            Next num

        ElseIf Me.Charset = "SHIFT-JIS" Then
            ADODB.Position = 0
            valArray = ADODB.Read
        
        ElseIf Me.Charset = "UTF-8" Then
            ADODB.Position = 3
            valArray = ADODB.Read
            
        End If

        ADODB.Close
        Me.StrByte = valArray
        Me.StrLen = UBound(valArray) + 1
    End If
End Sub


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|fncSpritFile();
'@title     : |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd||58a|i|fffd|[|fffd||fffd||fffd||fffd|B
'             |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||34b||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
'
'@param     :
'
'@return    :
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Private Sub fncSpritFile()
    Dim valByte() As Byte
    Dim valArray() As Byte
    Dim inputFn As Long
    Dim num As Variant
    Dim count As Long


    If Dir(Me.FilePath) = "" Then
        Me.StrByte = valArray
        Me.StrLen = 0
    Else
        inputFn = FreeFile
        Open Me.FilePath For Binary As #inputFn
            ReDim valArray(LOF(inputFn))
            Get #inputFn, , valArray
        Close #inputFn

        If UBound(valArray) = 0 Then
            Me.StrLen = 0
        Else
            ReDim Preserve valArray(UBound(valArray) - 1)
            Me.StrLen = UBound(valArray) + 1
        End If
        Me.StrByte = valArray

    End If
End Sub


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|TextHash();
'@title     : |fffd||fffd||fffd||fffd||fffd||fffd||fffd|MD|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||8576||fffd||fffd||fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|B
'
'@param     :
'
'@return    : |fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Function TextHash() As String
    Dim Context As Context
    Dim digest(15) As Variant
    
    fncSpritStr

    Call MD5Init(Context)
    Call MD5Update(Context, Me.StrByte, Me.StrLen)
    Call MD5Final(digest, Context)

    TextHash = MDPrint(digest)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|FileHash();
'@title     : |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|MD|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'@summary   : |fffd|w|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||741|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|B
'             |fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||341|A|fffd||fffd||303|n|fffd|b|fffd|V|fffd||fffd||fffd|l|fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'             [d41d8cd98f00b204e9800998ecf8427e]
'
'@param     :
'
'@return    : |fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Function FileHash() As String
    Dim Context As Context
    Dim digest(15) As Variant
    
    fncSpritFile

    Call MD5Init(Context)
    Call MD5Update(Context, Me.StrByte, Me.StrLen)
    Call MD5Final(digest, Context)

    FileHash = MDPrint(digest)
End Function


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|Charset();
'@title     : [Charset]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [Charset]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'
'@return    : [Charset]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let Charset(ByVal value As String)
    mvarCharset = UCase(value)
End Property
Public Property Get Charset() As String
    Charset = mvarCharset
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|Text();
'@title     : [Text]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [Text]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'
'@return    : [Text]|fffd||fffd||fffd||fffd||fffd||fffd|/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let Text(ByVal value As String)
    mvarText = value
End Property
Public Property Get Text() As String
    Text = mvarText
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|FilePath();
'@title     : [FilePath]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [FilePath]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X/String
'
'@return    : [FilePath]|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X/String
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let FilePath(ByVal value As String)
    mvarFilePath = value
End Property
Public Property Get FilePath() As String
    FilePath = mvarFilePath
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|StrByte();
'@title     : [StrByte]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [StrByte]|fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd|/Byte
'
'@return    : [StrByte]|fffd|o|fffd|C|fffd|g|fffd|z|fffd||fffd|/Byte
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let StrByte(ByRef value() As Byte)
    mvarStrByte = value
End Property
Public Property Get StrByte() As Byte()
    StrByte = mvarStrByte
End Property


'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'|fffd||fffd|StrLen();
'@title     : [StrLen]|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B
'
'@param     : [StrLen]|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y/Long
'
'@return    : [StrLen]|fffd||fffd||fffd||fffd||fffd|T|fffd|C|fffd|Y/Long
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
Public Property Let StrLen(ByVal value As Long)
    mvarStrLen = value
End Property
Public Property Get StrLen() As Long
    StrLen = mvarStrLen
End Property



Attribute VB_Name = "Module21"
Sub |fffd||fffd||fffd|p|fffd||fffd||fffd||38f||6c2||30f|o|fffd||5c3|c|fffd|[|fffd||fffd||fffd||fffd|I|fffd||fffd|()
    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("TOP")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "Excel |327||fffd||fffd| (*.xlsm),*.xlsm"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||fffd||fffd||702||14e|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|o|fffd||5c3|c|fffd|[|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(48, 2).value = fPath

End Sub

Sub |fffd|o|fffd||5c3|c|fffd|[|fffd||fffd||fffd||308||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|()

Dim OldFileFullPass As String
Dim OldFilePass As String
Dim OldFile As String
Dim OldFileName As String

OldFileFullPass = Sheets("TOP").Cells(48, 2)

For a = 6 To Len(OldFileFullPass)
    If Left(Right(OldFileFullPass, a), 1) = "\" Then
        OldFilePass = Left(OldFileFullPass, Len(OldFileFullPass) - a)
        OldFile = Right(OldFileFullPass, a - 1)
        OldFileName = Replace(OldFile, ".xlsm", "")
        Exit For
    End If
DoEvents
Next

Dim MyFileFullPass As String
Dim MyFilePass As String
Dim MyFile As String
Dim MyFileName As String

MyFilePass = ActiveWorkbook.Path
MyFile = ActiveWorkbook.Name
MyFileName = Left(MyFile, Len(MyFile) - 5)
MyFileFullPass = MyFilePass & "\" & MyFile




Application.ScreenUpdating = False
Workbooks.Open OldFileFullPass


    'TOP|fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd|p|fffd||fffd|
    Workbooks(MyFile).Sheets("TOP").Range("H3:I3").value = _
        Workbooks(OldFile).Sheets("TOP").Range("H3:I3").value
     
    Workbooks(MyFile).Sheets("TOP").Range("I5").value = _
        Workbooks(OldFile).Sheets("TOP").Range("I5").value
        
    Workbooks(MyFile).Sheets("TOP").Range("P34:P36").value = _
        Workbooks(OldFile).Sheets("TOP").Range("P34:P36").value

    Workbooks(MyFile).Sheets("TOP").Range("B40:C41").value = _
        Workbooks(OldFile).Sheets("TOP").Range("B40:C41").value
        
    Workbooks(MyFile).Sheets("TOP").Range("B43:B44").value = _
        Workbooks(OldFile).Sheets("TOP").Range("B43:B44").value



    
    'Config|fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd|p|fffd||fffd|
    Workbooks(MyFile).Sheets("Config").Range("B4:B6").value = _
        Workbooks(OldFile).Sheets("Config").Range("B4:B6").value
        
    Workbooks(MyFile).Sheets("Config").Range("B10:B13").value = _
        Workbooks(OldFile).Sheets("Config").Range("B10:B13").value
    
    Workbooks(MyFile).Sheets("Config").Range("B16:B18").value = _
        Workbooks(OldFile).Sheets("Config").Range("B16:B18").value
    
    Workbooks(MyFile).Sheets("Config").Range("B17").value = _
        Workbooks(OldFile).Sheets("Config").Range("B17").value
    
    Workbooks(MyFile).Sheets("Config").Range("B22:B31").value = _
        Workbooks(OldFile).Sheets("Config").Range("B22:B31").value
    
    Workbooks(MyFile).Sheets("Config").Range("B48").value = _
        Workbooks(OldFile).Sheets("Config").Range("B48").value
    
    Workbooks(MyFile).Sheets("Config").Range("B50:C50").value = _
        Workbooks(OldFile).Sheets("Config").Range("B50:C50").value
        
    Workbooks(MyFile).Sheets("Config").Range("E50").value = _
        Workbooks(OldFile).Sheets("Config").Range("E50").value
    
    Workbooks(MyFile).Sheets("Config").Range("B53").value = _
        Workbooks(OldFile).Sheets("Config").Range("B53").value
    
    Workbooks(MyFile).Sheets("Config").Range("B55").value = _
        Workbooks(OldFile).Sheets("Config").Range("B55").value
    
    Workbooks(MyFile).Sheets("Config").Range("B67:B77").value = _
        Workbooks(OldFile).Sheets("Config").Range("B67:B77").value
    
    Workbooks(MyFile).Sheets("Config").Range("B120").value = _
        Workbooks(OldFile).Sheets("Config").Range("B120").value
    
    Workbooks(MyFile).Sheets("Config").Range("B128:B129").value = _
        Workbooks(OldFile).Sheets("Config").Range("B128:B129").value
    
    Workbooks(MyFile).Sheets("Config").Range("B135").value = _
        Workbooks(OldFile).Sheets("Config").Range("B135").value
    
    Workbooks(MyFile).Sheets("Config").Range("A138:B150").value = _
        Workbooks(OldFile).Sheets("Config").Range("A138:B150").value
        
    Workbooks(MyFile).Sheets("Config").Range("B153:B155").value = _
        Workbooks(OldFile).Sheets("Config").Range("B153:B155").value
        
    Workbooks(MyFile).Sheets("Config").Range("C159:D164").value = _
        Workbooks(OldFile).Sheets("Config").Range("C159:D164").value
        
    
    
    'MailConfig|fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd|p|fffd||fffd|
    Workbooks(MyFile).Sheets("MailConfig").Range("B4:B7").value = _
        Workbooks(OldFile).Sheets("MailConfig").Range("B4:B7").value
    
    Workbooks(MyFile).Sheets("MailConfig").Range("B13").value = _
        Workbooks(OldFile).Sheets("MailConfig").Range("B13").value
    
    Workbooks(MyFile).Sheets("MailConfig").Range("C15:H16").value = _
        Workbooks(OldFile).Sheets("MailConfig").Range("C15:H16").value
    
    Workbooks(MyFile).Sheets("MailConfig").Range("B18:B19").value = _
        Workbooks(OldFile).Sheets("MailConfig").Range("B18:B19").value
    
    Workbooks(MyFile).Sheets("MailConfig").Range("C21:H22").value = _
        Workbooks(OldFile).Sheets("MailConfig").Range("C21:H22").value
    

    
    
    'AddressChange|fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd|p|fffd||fffd|
    Dim LastRow As Long
        LastRow = Workbooks(OldFile).Sheets("AddressChange").Cells(Rows.count, 1).End(xlUp).Row
    If LastRow > 1 Then
        Workbooks(MyFile).Sheets("AddressChange").Range("A2:E" & LastRow).value = _
            Workbooks(OldFile).Sheets("AddressChange").Range("A2:E" & LastRow).value
    End If
    
    'Cancel|fffd|V|fffd|[|fffd|g|fffd||308||fffd||fffd|p|fffd||fffd|

    LastRow = Workbooks(OldFile).Sheets("Cancel").Cells(Rows.count, 1).End(xlUp).Row
    If LastRow > 1 Then
        Workbooks(MyFile).Sheets("Cancel").Range("A2:B" & LastRow).value = _
            Workbooks(OldFile).Sheets("Cancel").Range("A2:B" & LastRow).value
    End If
    
    'AddPaper|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||55742||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
    Dim myBaseRng As Range, myNewRng As Range
    Dim myRow As Long, myClm As Long

    Set myBaseRng = Workbooks(OldFile).Sheets("AddPaper").Range("A1:F25")
    Set myNewRng = Workbooks(MyFile).Sheets("AddPaper").Range("A1:F25")
    With myBaseRng
        For myClm = 1 To 6
            myNewRng.Columns(myClm).ColumnWidth _
                = .Columns(myClm).ColumnWidth
        Next
        For myRow = 1 To 25
            myNewRng.Rows(myRow).RowHeight _
                = .Rows(myRow).RowHeight
        Next
    End With
    
    'AutoLabel|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||55742||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
    Set myBaseRng = Workbooks(OldFile).Sheets("AutoLabel").Range("A1:K60")
    Set myNewRng = Workbooks(MyFile).Sheets("AutoLabel").Range("A1:K60")
    With myBaseRng
        For myClm = 1 To 11
            myNewRng.Columns(myClm).ColumnWidth _
                = .Columns(myClm).ColumnWidth
        Next
        For myRow = 1 To 60
            myNewRng.Rows(myRow).RowHeight _
                = .Rows(myRow).RowHeight
        Next
    End With
    
    'Picking|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||55742||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
    Set myBaseRng = Workbooks(OldFile).Sheets("Picking").Range("A1:K1")
    Set myNewRng = Workbooks(MyFile).Sheets("Picking").Range("A1:K1")
    With myBaseRng
        For myClm = 1 To 11
            myNewRng.Columns(myClm).ColumnWidth _
                = .Columns(myClm).ColumnWidth
        Next
    End With

Workbooks(OldFile).Close SaveChanges:=False
Application.ScreenUpdating = True

MsgBox "|fffd|f|fffd|[|fffd|^|fffd||308||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"



End Sub
Attribute VB_Name = "Module22"
Sub |fffd||fffd||fffd|p|fffd||fffd||fffd||38f||6c2||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd|()


    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("Config")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "Excel |327||fffd||fffd| (*.xlsm),*.xlsm"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd|o|fffd|i|fffd|c|fffd|[|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(208, 2).value = fPath

End Sub


Sub |fffd|o|fffd|i|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd||7457||fffd||fffd||fffd||30f||345d||fffd||752||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|()

Dim OldFileFullPass As String
Dim OldFilePass As String
Dim OldFile As String
Dim OldFileName As String

OldFileFullPass = Sheets("Config").Cells(208, 2)

For a = 6 To Len(OldFileFullPass)
    If Left(Right(OldFileFullPass, a), 1) = "\" Then
        OldFilePass = Left(OldFileFullPass, Len(OldFileFullPass) - a)
        OldFile = Right(OldFileFullPass, a - 1)
        OldFileName = Replace(OldFile, ".xlsm", "")
        Exit For
    End If
DoEvents
Next

Dim MyFileFullPass As String
Dim MyFilePass As String
Dim MyFile As String
Dim MyFileName As String

MyFilePass = ActiveWorkbook.Path
MyFile = ActiveWorkbook.Name
MyFileName = Left(MyFile, Len(MyFile) - 5)
MyFileFullPass = MyFilePass & "\" & MyFile

Application.ScreenUpdating = False
Workbooks.Open OldFileFullPass

    '|fffd||fffd||fffd|p|fffd||fffd|
    Workbooks(MyFile).Sheets("Config").Range("B169:B196").value = _
        Workbooks(OldFile).Sheets("Config").Range("B26:B53").value
     
    Workbooks(MyFile).Sheets("Config").Range("A197:B206").value = _
        Workbooks(OldFile).Sheets("Config").Range("A54:B63").value
    
Workbooks(OldFile).Close SaveChanges:=False
Application.ScreenUpdating = True

MsgBox "|fffd|f|fffd|[|fffd|^|fffd||313||1c2||74d||fffd||fffd||742||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"
End Sub
Attribute VB_Name = "Module3"
Sub |fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = LastIndex Then
               Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = 2 Then
               Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next
    
Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub

Sub |fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = LastIndex Then
               Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = 2 Then
               Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next

Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module4"
Sub |fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If
    

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = LastIndex Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
                Page = Page + 1
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If
    
    
    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = 2 Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
                Page = Page + 1
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next
    
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub

Sub |fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = LastIndex Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd|y|fffd|[|fffd|W|fffd|w|fffd||fffd||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1
Dim StartPage As Long
    If Sheets("TOP").Cells(17, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(17, 2)
    Else
        StartPage = 1
    End If
    
Dim FinPage As Long
    If Sheets("TOP").Cells(18, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(18, 2)
    Else
        FinPage = 9999
    End If
    
    

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("Report").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("Report").Cells(i, 1)
            ZipCode = Sheets("Report").Cells(i, 23)
            Pref = Sheets("Report").Cells(i, 22)
            Address0 = Sheets("Report").Cells(i, 21)
            Address1 = Sheets("Report").Cells(i, 18)
            Address2 = Sheets("Report").Cells(i, 19)
            Address3 = Sheets("Report").Cells(i, 20)
            Name = Sheets("Report").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = 2 Then
                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next

                If StartPage <= Page And Page <= FinPage Then
                    Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
                End If

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module5"
Sub |fffd|z|fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||3c2||755||fffd||fffd||d3dc|()

Application.ScreenUpdating = False


Dim Res
Res = MsgBox("|fffd||fffd||fffd||142||24f|o|fffd||5cd||fffd||182||30a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||508||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||242||341|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKCancel)
If Res = vbCancel Then Exit Sub
If Res = vbOK Then
    Res = MsgBox("|fffd|}|fffd|W|fffd||14f||fffd||fffd||fffd||fffd||fffd|OK|fffd|H", vbOKCancel)
    If Res = vbCancel Then Exit Sub
End If


'-----------------
Dim LastIndex As Long
    LastIndex = Sheets("AddressChange").Cells(Rows.count, 1).End(xlUp).Row

For i = 2 To LastIndex
    If Sheets("AddressChange").Cells(i, 5) <> "" Then
        Sheets("AddressChange").Rows(i & ":" & i).ClearContents
    End If
Next
'----------------
Application.ScreenUpdating = True

End Sub


Sub |fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||3c2||755||fffd||fffd||d3dc|()

Application.ScreenUpdating = False


Dim Res
Res = MsgBox("|fffd||fffd||fffd||142||24f|o|fffd||5cd||fffd||182||30a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||508||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||242||341|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbOKCancel)
If Res = vbCancel Then Exit Sub
If Res = vbOK Then
    Res = MsgBox("|fffd|}|fffd|W|fffd||14f||fffd||fffd||fffd||fffd||fffd|OK|fffd|H", vbOKCancel)
    If Res = vbCancel Then Exit Sub
End If


'-----------------
Dim LastIndex As Long
    LastIndex = Sheets("Cancel").Cells(Rows.count, 1).End(xlUp).Row

For i = 2 To LastIndex
    If Sheets("Cancel").Cells(i, 2) <> "" Then
        Sheets("Cancel").Rows(i & ":" & i).ClearContents
    End If
Next
'----------------
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module6"
Sub |fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("Report").Columns("A:A")) - 1
    
Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------


    For i = 2 To LastIndex
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & Page & "/" & MaxPage
    
        If Sheets("Report").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("Report").Cells(i, 1)
            OrderDate = Sheets("Report").Cells(i, 3)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("Report").Cells(i, 9)
            RecipientName = Sheets("Report").Cells(i, 17)
            Address = "|fffd||fffd|" & Sheets("Report").Cells(i, 23) & " " & Sheets("Report").Cells(i, 22) & " " & Sheets("Report").Cells(i, 21) & Sheets("Report").Cells(i, 18) & " " & Sheets("Report").Cells(i, 19) & " " & Sheets("Report").Cells(i, 20)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("Report").Cells(i, 12)
            SKU = Sheets("Report").Cells(i, 11)
            'Condition = Sheets(i, 1)
            'Comment = Sheets(i, 1)
            Number = Sheets("Report").Cells(i, 13)
            'ItemPrice = Sheets("Report").Cells(i, 1)
            'SendPrice = Sheets("Report").Cells(i, 1)
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|=======================================================================================
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns("C:C"), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns("C:C").Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, 9)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, 8)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("Report").Cells(i, 13)
            Sheets("AddPaper").Cells(16, 2) = ""
            Sheets("AddPaper").Cells(17, 2) = ""
            Sheets("AddPaper").Cells(16, 3) = ""
            Sheets("AddPaper").Cells(17, 3) = ""
            '============================================================================================================
            '----------------------------------------------------------------------
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
            Page = Page + 1
            '----------------------------------------------------------------------
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub


Sub |fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("Report").Columns("A:A")) - 1

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------


    For i = LastIndex To 2 Step -1
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & Page & "/" & MaxPage
    
        If Sheets("Report").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("Report").Cells(i, 1)
            OrderDate = Sheets("Report").Cells(i, 3)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("Report").Cells(i, 9)
            RecipientName = Sheets("Report").Cells(i, 17)
            Address = "|fffd||fffd|" & Sheets("Report").Cells(i, 23) & " " & Sheets("Report").Cells(i, 22) & " " & Sheets("Report").Cells(i, 21) & Sheets("Report").Cells(i, 18) & " " & Sheets("Report").Cells(i, 19) & " " & Sheets("Report").Cells(i, 20)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("Report").Cells(i, 12)
            SKU = Sheets("Report").Cells(i, 11)
            'Condition = Sheets(i, 1)
            'Comment = Sheets(i, 1)
            Number = Sheets("Report").Cells(i, 13)
            'ItemPrice = Sheets("Report").Cells(i, 1)
            'SendPrice = Sheets("Report").Cells(i, 1)
            '----------------------------------------------------------------------
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|=======================================================================================
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns("C:C"), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns("C:C").Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, 9)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, 8)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("Report").Cells(i, 13)
            Sheets("AddPaper").Cells(16, 2) = ""
            Sheets("AddPaper").Cells(17, 2) = ""
            Sheets("AddPaper").Cells(16, 3) = ""
            Sheets("AddPaper").Cells(17, 3) = ""
            '============================================================================================================
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(16, 3) = ItemPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
            Page = Page + 1
            '----------------------------------------------------------------------
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub



Sub |fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("Report").Columns("A:A")) - 1

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

Dim StartPage As Long
    If Sheets("TOP").Cells(23, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(23, 2)
    Else
        StartPage = 1
    End If

Dim PageCount As Long
    PageCount = 1

Dim FinPage As Long
    If Sheets("TOP").Cells(24, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(24, 2)
    Else
        FinPage = 9999
    End If


'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------


    For i = 2 To LastIndex
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & PageCount & "/" & FinPage - StartPage + 1
    
        If Sheets("Report").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("Report").Cells(i, 1)
            OrderDate = Sheets("Report").Cells(i, 3)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("Report").Cells(i, 9)
            RecipientName = Sheets("Report").Cells(i, 17)
            Address = "|fffd||fffd|" & Sheets("Report").Cells(i, 23) & " " & Sheets("Report").Cells(i, 22) & " " & Sheets("Report").Cells(i, 21) & Sheets("Report").Cells(i, 18) & " " & Sheets("Report").Cells(i, 19) & " " & Sheets("Report").Cells(i, 20)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("Report").Cells(i, 12)
            SKU = Sheets("Report").Cells(i, 11)
            'Condition = Sheets(i, 1)
            'Comment = Sheets(i, 1)
            Number = Sheets("Report").Cells(i, 13)
            'ItemPrice = Sheets("Report").Cells(i, 1)
            'SendPrice = Sheets("Report").Cells(i, 1)
            '----------------------------------------------------------------------
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|=======================================================================================
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns("C:C"), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns("C:C").Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, 9)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, 8)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("Report").Cells(i, 13)
            Sheets("AddPaper").Cells(16, 2) = ""
            Sheets("AddPaper").Cells(17, 2) = ""
            Sheets("AddPaper").Cells(16, 3) = ""
            Sheets("AddPaper").Cells(17, 3) = ""
            '============================================================================================================
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(16, 3) = ItemPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            If StartPage <= Page And Page <= FinPage Then
                Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
                PageCount = PageCount + 1
            End If
            '----------------------------------------------------------------------
            Page = Page + 1
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub





Sub |fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||143|y|fffd|[|fffd|W|fffd|w|fffd||fffd|()

Application.ScreenUpdating = False

Dim OrderId As String
Dim OrderDate As String
Dim TrueDay As Date
Dim FalseTime As Long
Dim BuyerName As String
Dim RecipientName As String
Dim Address As String

Dim Tittle As String
Dim SKU As String
Dim Condition As String
Dim Comment As String

Dim ItemPrice As Long
Dim SendPrice As Long

Dim Number As Long

Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim Page As Long
    Page = 1
    
Dim MaxPage As Long
    MaxPage = Application.WorksheetFunction.CountA(Sheets("Report").Columns("A:A")) - 1

Dim StartPage As Long
    If Sheets("TOP").Cells(23, 2) <> "" Then
        StartPage = Sheets("TOP").Cells(23, 2)
    Else
        StartPage = 1
    End If

Dim PageCount As Long
    PageCount = 1

Dim FinPage As Long
    If Sheets("TOP").Cells(24, 2) <> "" Then
        FinPage = Sheets("TOP").Cells(24, 2)
    Else
        FinPage = 9999
    End If

Dim RowNum As Long
Dim ZipCode As String
Dim ShipAdd As String
Dim Name As String

'|fffd||152||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd|-----------------------------------------------------
    Sheets("AddPaper").Cells(1, 3) = Sheets("Config").Cells(22, 2)
    Sheets("AddPaper").Cells(4, 3) = Sheets("Config").Cells(23, 2)
    Sheets("AddPaper").Cells(18, 3) = Sheets("Config").Cells(24, 2)
    Sheets("AddPaper").Cells(19, 3) = Sheets("Config").Cells(25, 2)
    
    Sheets("AddPaper").Cells(21, 4) = "|fffd||fffd|" & Sheets("Config").Cells(11, 2)
    Sheets("AddPaper").Cells(22, 4) = Sheets("Config").Cells(12, 2)
    Sheets("AddPaper").Cells(23, 4) = Sheets("Config").Cells(10, 2)
    Sheets("AddPaper").Cells(24, 4) = Sheets("Config").Cells(13, 2)
    
    Sheets("AddPaper").Cells(6, 2) = "|fffd||fffd||fffd||fffd||fffd||50d||fffd|:"
    Sheets("AddPaper").Cells(7, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(8, 2) = "|fffd||fffd||fffd|w|fffd||fffd||fffd||48e||fffd||fffd||fffd|:"
    Sheets("AddPaper").Cells(9, 2) = "|fffd||fffd||fffd||342||fffd||fffd||60b2||fffd|Z|fffd||fffd|:"
    Sheets("AddPaper").Cells(15, 2) = "|fffd||fffd||fffd||fffd|:"

'|fffd||752||fffd||282||315|\|fffd||fffd||fffd||fffd||fffd||682||18d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------
    
    If Sheets("Config").Cells(26, 2) = "ON" Then 'SKU
        Sheets("AddPaper").Cells(12, 2) = "|fffd||fffd||fffd|i|fffd||1d7||fffd||fffd||50d||fffd||fffd|F"
        Sheets("AddPaper").Rows(12).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(12, 2).ClearContents
        Sheets("AddPaper").Rows(12).RowHeight = 0
    End If


    If Sheets("Config").Cells(27, 2) = "ON" Then '|fffd||fffd||fffd|i|fffd|\|fffd||fffd|
        Sheets("AddPaper").Cells(16, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd|i|fffd|F"
        Sheets("AddPaper").Rows(16).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(17, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(17).RowHeight = 13.5
    Else
        Sheets("AddPaper").Cells(16, 2).ClearContents
        Sheets("AddPaper").Rows(16).RowHeight = 0
        
        Sheets("AddPaper").Cells(17, 2).ClearContents
        Sheets("AddPaper").Rows(17).RowHeight = 0
    End If
    

    If Sheets("Config").Cells(28, 2) = "ON" Then '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||183|R|fffd||fffd||fffd||fffd||fffd|g
        Sheets("AddPaper").Cells(13, 2) = "|fffd||fffd||fffd|i|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(13).RowHeight = 13.5
        
        Sheets("AddPaper").Cells(14, 2) = "|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|F"
        Sheets("AddPaper").Rows(14).RowHeight = 150
        
        Sheets("AddPaper").Rows(5).RowHeight = 12
        Sheets("AddPaper").Rows(10).RowHeight = 10
        Sheets("AddPaper").Rows(18).RowHeight = 216
    Else
        Sheets("AddPaper").Cells(13, 2).ClearContents
        Sheets("AddPaper").Rows(13).RowHeight = 0
        
        Sheets("AddPaper").Cells(14, 2).ClearContents
        Sheets("AddPaper").Rows(14).RowHeight = 0
        
        Sheets("AddPaper").Rows(5).RowHeight = 50
        Sheets("AddPaper").Rows(10).RowHeight = 50
        Sheets("AddPaper").Rows(18).RowHeight = 276
    End If
'---------------------------------------------------------------------


    For i = LastIndex To 2 Step -1
        Application.StatusBar = "|fffd|[|fffd|i|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|@" & PageCount & "/" & FinPage - StartPage + 1

    
        If Sheets("Report").Cells(i, 1) <> "" Then
            '|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30f||fffd||fffd||64fe|---------------------------------------------------
            OrderId = Sheets("Report").Cells(i, 1)
            OrderDate = Sheets("Report").Cells(i, 3)
            TrueDay = Left(OrderDate, 4) & "/" & Mid(OrderDate, 6, 2) & "/" & Mid(OrderDate, 9, 2)
            FalseTime = Mid(OrderDate, InStr(OrderDate, "T") + 1, InStr(OrderDate, ":") - InStr(OrderDate, "T") - 1)
            If FalseTime >= 15 Then '+9h|fffd||202||302||fffd|
                TrueDay = TrueDay + 1
            End If
        
            BuyerName = Sheets("Report").Cells(i, 9)
            RecipientName = Sheets("Report").Cells(i, 17)
            Address = "|fffd||fffd|" & Sheets("Report").Cells(i, 23) & " " & Sheets("Report").Cells(i, 22) & " " & Sheets("Report").Cells(i, 21) & Sheets("Report").Cells(i, 18) & " " & Sheets("Report").Cells(i, 19) & " " & Sheets("Report").Cells(i, 20)

            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                Address = "|fffd||fffd|" & ZipCode & " " & ShipAdd
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    RecipientName = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd|[|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            End If

            Tittle = Sheets("Report").Cells(i, 12)
            SKU = Sheets("Report").Cells(i, 11)
            'Condition = Sheets(i, 1)
            'Comment = Sheets(i, 1)
            Number = Sheets("Report").Cells(i, 13)
            'ItemPrice = Sheets("Report").Cells(i, 1)
            'SendPrice = Sheets("Report").Cells(i, 1)
            '----------------------------------------------------------------------
            '|fffd|o|fffd|i|fffd||68d||5c2||30e|Q|fffd||fffd|=======================================================================================
            If Application.WorksheetFunction.CountIf(Sheets("SypnSyosaiReport").Columns("C:C"), SKU) > 0 Then
                RowNum = Sheets("SypnSyosaiReport").Columns("C:C").Find(SKU).Row
                Condition = Sheets("SypnSyosaiReport").Cells(RowNum, 9)
                
                    Select Case Condition
                        Case "11"
                            Condition = "|fffd|V|fffd|i"
                        Case "10"
                            Condition = "|fffd||110||fffd||fffd|i"
                        Case "8"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd|"
                        Case "7"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||1c2||fffd|"
                        Case "6"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "5"
                            Condition = "|fffd|R|fffd||fffd||fffd|N|fffd|^|fffd|[|fffd||fffd||fffd|i; |fffd||642||690|V|fffd|i"
                        Case "4"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd|"
                        Case "3"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||1c2||fffd|"
                        Case "2"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||fffd||fffd||257||1c2||fffd|"
                        Case "1"
                            Condition = "|fffd||fffd||fffd||fffd|; |fffd||642||690|V|fffd|i"
                    End Select
                
                Comment = Sheets("SypnSyosaiReport").Cells(RowNum, 8)
            Else
                Condition = Sheets("Config").Cells(29, 2)
                Comment = Sheets("Config").Cells(29, 2)
            End If
            
            Number = Sheets("Report").Cells(i, 13)
            Sheets("AddPaper").Cells(16, 2) = ""
            Sheets("AddPaper").Cells(17, 2) = ""
            Sheets("AddPaper").Cells(16, 3) = ""
            Sheets("AddPaper").Cells(17, 3) = ""
            '============================================================================================================
            '|fffd|[|fffd|i|fffd||fffd||fffd||582||313|]|fffd|L--------------------------------------------------------
            Sheets("AddPaper").Cells(3, 2) = RecipientName & " |fffd|l"
            Sheets("AddPaper").Cells(6, 3) = OrderId
            Sheets("AddPaper").Cells(7, 3) = TrueDay
            Sheets("AddPaper").Cells(8, 3) = BuyerName & " |fffd|l"
            Sheets("AddPaper").Cells(9, 3) = Address
            Sheets("AddPaper").Cells(11, 3) = Tittle
            
            If Sheets("Config").Cells(26, 2) = "ON" Then
                Sheets("AddPaper").Cells(12, 3) = SKU
            End If
            
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(13, 3) = Condition
            End If
            If Sheets("Config").Cells(28, 2) = "ON" Then
                'Sheets("AddPaper").Cells(14, 3) = Comment
            End If
            
            Sheets("AddPaper").Cells(15, 3) = Number
            
            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(16, 3) = ItemPrice
            End If

            If Sheets("Config").Cells(27, 2) = "ON" Then
                'Sheets("AddPaper").Cells(17, 3) = SendPrice
            End If
            
            '----------------------------------------------------------------------
            '|fffd||fffd||fffd|------------------------------------------------------------------
            If StartPage <= Page And Page <= FinPage Then
                Sheets("AddPaper").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(4, 2), Collate:=True
                PageCount = PageCount + 1
            End If
            '----------------------------------------------------------------------
            Page = Page + 1
        End If
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True


End Sub
Attribute VB_Name = "Module7"
Sub |fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||350||fffd|I|fffd||fffd|()

Dim a As String
With Application.FileDialog(msoFileDialogFolderPicker)
.Show
a = .SelectedItems(1)

End With
    
    Sheets("Config").Range("B43") = a

End Sub

Sub |fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||18f|o|fffd||fffd|()
Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim OrderId As String
Dim ItemID As String
Dim Number As String

Dim ShipDate As String
    ShipDate = Format(Now() + Sheets("TOP").Cells(29, 2), "YYYY-MM-DD")
Dim CarrierName As String
    CarrierName = Sheets("Config").Cells(44, 2)
Dim ShipMethod As String
    ShipMethod = Sheets("Config").Cells(45, 2)
    
Dim LastIndex As Long
    LastIndex = Sheets("Report").Cells(Rows.count, 1).End(xlUp).Row

Dim SendFileX As Long
    SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row

    If SendFileX > 3 Then
        Sheets("SendFile").Rows("4:" & SendFileX).ClearContents
        Sheets("SendFile").Rows("4:" & SendFileX).Font.ColorIndex = 1
    End If

    For i = 2 To LastIndex
        If Sheets("Report").Cells(i, 1) <> "" Then
            SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row + 1
            OrderId = Sheets("Report").Cells(i, 1)
            ItemID = Sheets("Report").Cells(i, 2)
            Number = Sheets("Report").Cells(i, 13)
            
            Sheets("SendFile").Cells(SendFileX, 1) = OrderId
            Sheets("SendFile").Cells(SendFileX, 2) = Format(ItemID, "00000000000000")
            Sheets("SendFile").Cells(SendFileX, 3) = Number
            Sheets("SendFile").Cells(SendFileX, 4) = ShipDate
            Sheets("SendFile").Cells(SendFileX, 5) = "Other"
            Sheets("SendFile").Cells(SendFileX, 6) = CarrierName
            
            Sheets("SendFile").Cells(SendFileX, 8) = ShipMethod

        End If
    Next

    '|fffd||1d0||554||50d||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||a347|---------------------------------------------------
    If Sheets("Config").Cells(45, 3) = "|fffd||fffd||fffd||fffd|" Then
        '|fffd||fffd||fffd||a48d||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd|o------------
        SendFileX = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row
        Dim SameOrder As Long
        For n = 4 To SendFileX
            OrderId = Sheets("SendFile").Cells(n, 1)
            SameOrder = Application.WorksheetFunction.CountIf(Sheets("SendFile").Columns("A:A"), OrderId)
            If SameOrder > 1 Then
                Sheets("SendFile").Rows(n).Font.ColorIndex = 41
            End If
        Next
        '---------------------------
    
        MsgBox ("|fffd||1d0||554||50d||fffd||fffd||313||fffd||fffd||342||181|A|fffd|K|fffd|v|fffd||249||fffd||fffd||fffd||fffd||114|z|fffd||fffd||fffd||fffd||fffd|@|fffd||30f|C|fffd||fffd||fffd||202||1c2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||241|A|fffd|o|fffd||5d2||292|m|fffd||30f|o|fffd||343|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd||95||fffd||fffd||fffd||fffd||353||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||142||fffd||fffd|B|fffd||fffd||fffd||442||343|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd|B")
        Sheets("SendFile").Select
        Exit Sub
    End If
    '-----------------------------------------------------------------------
    Application.Run "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|"
    
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd||1d0||554||50d||fffd||fffd||fffd||fffd||34a||fffd||fffd||fffd||fffd||143|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||342||fffd|TOP|fffd||256||7c2||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Application.Run "|fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|"

Sheets("TOP").Select

Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd|o|fffd||5d2||292|m|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim SaveSheet As Worksheet
    Set SaveSheet = Sheets("SendFile")
    
Dim SendFileName As String
    

Dim LastIndex As Long
    LastIndex = Sheets("SendFile").Cells(Rows.count, 1).End(xlUp).Row

Dim MyFile As String

    SendFileName = "Ship" & Format(Now(), "YYYYMMDD") & "-" & Format(Now(), "hhmm") & "-" & Format(LastIndex - 3, "000")
'==============================================
Dim ws As Worksheet
Set ws = Sheets("SendFile")
Dim OutPutPass As String
    OutPutPass = Sheets("Config").Cells(43, 2)
Dim datFile As String
    datFile = ActiveWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|\|fffd|o|fffd||5d2||292|m\" & SendFileName & ".txt"


 
Open datFile For Output As #1
 
Dim i As Long
i = 1
Do While ws.Cells(i, 1).value <> ""
    Application.StatusBar = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|@" & i & "/" & LastIndex
    Print #1, ws.Cells(i, 1).value & vbTab _
            & Format(ws.Cells(i, 2).value, "00000000000000") & vbTab _
            & ws.Cells(i, 3).value & vbTab _
            & Format(ws.Cells(i, 4).value, "YYYY-MM-DD") & vbTab _
            & ws.Cells(i, 5).value & vbTab _
            & ws.Cells(i, 6).value & vbTab _
            & ws.Cells(i, 7).value & vbTab _
            & ws.Cells(i, 8).value & vbTab _
            & ws.Cells(i, 9).value
    i = i + 1
Loop
 
Close #1


Dim SubmitId As String
    If Sheets("Config").Cells(44, 2) = "|fffd||fffd||fffd||fffd|" Then
        '|fffd|o|fffd||5d2||292|m|fffd||fffd||fffd|M|fffd||303|t|fffd|@|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s========================
        SubmitId = TsvSend(datFile)
        '========================================================
    End If
    
    
    
 
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module8"
Sub |fffd|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()


'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------


Dim SypnPass As String
Dim SypnFullPass As String
Dim SypnFile As String
Dim SypnName As String


'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||310||752||fffd|----------------------------------


SypnPass = Sheets("Config").Range("J40")
SypnFullPass = Sheets("Config").Range("B40")
SypnFile = Sheets("Config").Range("K40")
SypnName = Sheets("Config").Range("L40")

Dim UnsendX As Long

'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("SypnReport").Columns("A:AC").ClearContents

'|fffd|^|fffd|u|fffd||fffd||602||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|S|fffd||115||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113||1c2||74d||fffd||fffd||fffd|

    Dim FileName As String
    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd|
    FileName = SypnFullPass


        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("SypnReport").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FileName))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FileName For Input As #FileNo
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            If Buf <> "" Then
            Cnt = Cnt + 1
            SplitString = Split(Buf, vbTab)
            For i = 0 To UBound(SplitString)
                Sheets("SypnReport").Cells(Cnt, i + 1) = SplitString(i)
            Next i
            Application.StatusBar = "|fffd|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
            End If
        Loop
        Application.StatusBar = ""
        Close #FileNo


Application.StatusBar = "|fffd|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub |fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()


'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------


Dim SyosaiPass As String
Dim SyosaiFullPass As String
Dim SyosaiFile As String
Dim SyosaiName As String

Dim TargetPass As String
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||310||752||fffd|----------------------------------



SyosaiFullPass = Sheets("Config").Range("B38")
SyosaiFile = Sheets("Config").Range("K38")
SyosaiName = Sheets("Config").Range("L38")
SyosaiPass = Sheets("Config").Range("J38")


'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("SypnSyosaiReport").Columns("A:Q").ClearContents


If Sheets("Config").Cells(39, 2) = "|fffd||1549||fffd||5d7|D|fffd||fffd|" Then '=======================================================
'|fffd|^|fffd|u|fffd||fffd||602||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|S|fffd||115||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113||1c2||74d||fffd||fffd||fffd|

    Dim FileName As String
    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd|
    FileName = SyosaiFullPass


        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("SypnSyosaiReport").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FileName))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FileName For Input As #FileNo
        Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|j|fffd|@"
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            Cnt = 0
            SplitString = Split(Buf, vbLf)
            If Buf <> "" Then
                For i = 0 To UBound(SplitString)
                    SplitString2 = Split(SplitString(i), vbTab)
                    Cnt = Cnt + 1
                    For k = 0 To UBound(SplitString2)
                        Sheets("SypnSyosaiReport").Cells(Cnt, k + 1) = SplitString2(k)
                    Next
                    Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt & "/" & UBound(SplitString)
                Next i
            End If

            
        DoEvents
        Loop
        Application.StatusBar = ""
        Close #FileNo
    Dim MyFile As String
    MyFile = ActiveWorkbook.Name
    If Workbooks(MyFile).Worksheets("SypnSyosaiReport").Cells(1, 1) <> "|fffd||fffd||fffd|i|fffd||fffd|" Then
        Application.StatusBar = "|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||3ca||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|j"
        Call Utf8ToSjis(SyosaiFullPass, SyosaiFullPass)
        GoTo ReStart
    End If
        
Else '=====================================================================================================

    MyFile = ActiveWorkbook.Name
ReStart:
    Workbooks.Open SyosaiFullPass
    Workbooks(SyosaiFile).Sheets(SyosaiName).Columns("A:Q").Copy Destination:=Workbooks(MyFile).Worksheets("SypnSyosaiReport").Columns("A:Q")
    
    Application.DisplayAlerts = False
    Workbooks(SyosaiFile).Close
    
    Workbooks(MyFile).Activate
    'Sheets("TOP").Select
    'UTF-8|fffd||fffd||1c2||74d||fffd||fffd||42f8d||fffd||fffd||542||fffd||fffd||fffd||fffd||fffd||fffd|
    If Workbooks(MyFile).Worksheets("SypnSyosaiReport").Cells(1, 2) = "" Then
        Application.StatusBar = "|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||3ca||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|j"
        Call Utf8ToSjis(SyosaiFullPass, SyosaiFullPass)
        GoTo ReStart
    End If
End If

Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Function Utf8ToSjis(a_sFrom, a_sTo)
    Dim streamRead  As New ADODB.stream '// |fffd||1c2||74d||fffd||fffd||743|f|fffd|[|fffd|^
    Dim streamWrite As New ADODB.stream '// |fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|f|fffd|[|fffd|^
    Dim sText                           '// |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|f|fffd|[|fffd|^
    
    '// |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1c2||74d||fffd||fffd||fffd|
    streamRead.Type = adTypeText
    streamRead.Charset = "UTF-8"
    streamRead.Open
    Call streamRead.LoadFromFile(a_sFrom)
    
    '// |fffd||fffd||fffd|s|fffd|R|fffd|[|fffd|hLF|fffd||fffd|CRLF|fffd||255||3ca||fffd|
    sText = streamRead.ReadText
    sText = Replace(sText, vbLf, vbCrLf)
    sText = Replace(sText, vbCr & vbCr, vbCr)
    
    '// |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    streamWrite.Type = adTypeText
    streamWrite.Charset = "Shift-JIS"
    streamWrite.Open
    
    '// |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call streamWrite.WriteText(sText)
    
    '// |fffd||6d1||fffd|
    Application.DisplayAlerts = False
    Call streamWrite.SaveToFile(a_sTo, adSaveCreateOverWrite)
    
    '// |fffd|N|fffd||fffd||fffd|[|fffd|Y
    Application.DisplayAlerts = False
    streamRead.Close
    streamWrite.Close
End Function


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False
'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||312||fffd|`----------------------------------


Dim ChumonPass As String
Dim ChumonFullPass As String
Dim ChumonFile As String
Dim ChumonName As String


'|fffd||fffd|{|fffd||752||856a||fffd||315||3d0||fffd||fffd||310||752||fffd|----------------------------------


ChumonPass = Sheets("Config").Range("J36")
ChumonFullPass = Sheets("Config").Range("B36")
ChumonFile = Sheets("Config").Range("K36")
ChumonName = Sheets("Config").Range("L36")

Dim UnsendX As Long

'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("ChumonReport").Columns("A:AZ").ClearContents

'|fffd|^|fffd|u|fffd||fffd||602||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|S|fffd||115||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113||1c2||74d||fffd||fffd||fffd|

    Dim FileName As String
    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd|
    FileName = ChumonFullPass


        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("ChumonReport").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(FileName))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open FileName For Input As #FileNo
        Do Until EOF(FileNo)
            If Buf <> "" Then
                Line Input #FileNo, Buf
                Cnt = Cnt + 1
                SplitString = Split(Buf, vbTab)
                For i = 0 To UBound(SplitString)
                    Sheets("ChumonReport").Cells(Cnt, i + 1) = SplitString(i)
                Next i
                Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
            End If
        Loop
        Application.StatusBar = ""
        Close #FileNo
 '|fffd||14f|I|fffd||312||fffd||fffd||fffd||fffd||fffd||fffd||64fe|---------------------------
Dim LastOrderID As String
    LastOrderID = Sheets("TOP").Cells(34, 16)
Dim LastItemID As String
    LastItemID = Sheets("TOP").Cells(35, 16)
Dim LastSKU As String
    LastSKU = Sheets("TOP").Cells(36, 16)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
   
'|fffd|O|fffd||fffd||182||303|J|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc|----------------------------------------------
If Sheets("TOP").Cells(3, 8) = "|fffd||fffd||fffd||fffd|" Then
    For n = 2 To LastIndex
        If Sheets("ChumonReport").Cells(n, 1) = LastOrderID _
                And Sheets("ChumonReport").Cells(n, 2) = LastItemID _
                    And Sheets("ChumonReport").Cells(n, 8) = LastSKU Then
            Sheets("ChumonReport").Rows("2:" & n).Delete
            GoTo labelEsc:
        End If
    Next
End If
'-----------------------------------------------------------------------
labelEsc:
    
'|fffd||fffd||fffd||fffd|p|fffd||30d||14f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|--------------------------
LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

    LastOrderID = Sheets("ChumonReport").Cells(LastIndex, 1)

    LastItemID = Sheets("ChumonReport").Cells(LastIndex, 2)

    LastSKU = Sheets("ChumonReport").Cells(LastIndex, 8)
    
Sheets("TOP").Cells(34, 16) = LastOrderID
Sheets("TOP").Cells(35, 16) = Format(LastItemID, "00000000000000")
Sheets("TOP").Cells(36, 16) = LastSKU
    
'---------------------------------------------

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||315||fffd||fffd||451||582||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

If Sheets("Config").Cells(48, 2) = "|fffd|~|fffd||fffd|" Then
    Sheets("ChumonReport").Rows("1:1").AutoFilter
    Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
    Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("H1"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With Sheets("ChumonReport").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("ChumonReport").Rows("1:1").AutoFilter

Else
    Sheets("ChumonReport").Rows("1:1").AutoFilter
    Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
    Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
        ("H1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With Sheets("ChumonReport").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("ChumonReport").Rows("1:1").AutoFilter
End If

'|fffd|v|fffd||fffd||fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30b||d4495||fffd||fffd||fffd||fffd||30d||d3dc||fffd||18a||fffd||fffd||fffd||fffd||183|||fffd|C|fffd||fffd||fffd|g|fffd||314||fffd||fffd|f
Dim OrderIDLast As Long
    OrderIDLast = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
Dim OtherColLast As Long
    For w = 2 To OrderIDLast + 1
        If Sheets("ChumonReport").Cells(w, 3) = "" Then
            OtherColLast = w - 1
            Exit For
        End If
    DoEvents
    Next
Dim ExistLast As Long
Dim Price As Long
Dim Sale As Long
Dim Point As Long
    '|fffd||d448d|s|fffd||d3dc|
    If OrderIDLast <> OtherColLast Then
        If Sheets("Config").Cells(48, 2) = "|fffd|~|fffd||fffd|" Then
            For i = 2 To OrderIDLast
                If Sheets("ChumonReport").Cells(i, 3) = "" Then
                    ExistLast = i
                    Exit For
                End If
                DoEvents
            Next
            Sheets("ChumonReport").Rows(ExistLast & ":" & OrderIDLast).Delete
        Else
            For i = 2 To OrderIDLast
                If Sheets("ChumonReport").Cells(i, 3) <> "" Then
                    ExistLast = i - 1
                    Exit For
                End If
                DoEvents
            Next
            Sheets("ChumonReport").Rows("2:" & ExistLast).Delete
        End If
    End If
    
    
Dim ColNum(2) As Long
Dim SendPrice As Long

    '|fffd||38f||6d7||42a82||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd||5c2||fffd|
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-promotion-discount") > 0 Then
        ColNum(0) = Sheets("ChumonReport").Rows(1).Find("item-promotion-discount").Column
    End If
    
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "ship-promotion-discount") > 0 Then
        ColNum(1) = Sheets("ChumonReport").Rows(1).Find("ship-promotion-discount").Column
    End If
    
    If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "points-granted") > 0 Then
        ColNum(2) = Sheets("ChumonReport").Rows(1).Find("points-granted").Column
    End If
    
    '|fffd|||fffd|C|fffd||fffd||fffd|g|fffd|E|fffd||fffd||fffd||fffd||fffd||314||fffd||fffd|f
        OrderIDLast = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
        For n = 2 To OrderIDLast
                Price = Sheets("ChumonReport").Cells(n, 12)
                SendPrice = Sheets("ChumonReport").Cells(n, 14)
                
                '|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(item-promotion-discount)
                If ColNum(0) <> 0 Then
                    If IsNumeric(Sheets("ChumonReport").Cells(n, ColNum(0))) = True Then
                        Sale = Sheets("ChumonReport").Cells(n, ColNum(0))
                        Price = Price + Sale
                        Sheets("ChumonReport").Cells(n, 12) = Price
                    End If
                End If
                '|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(ship-promotion-discount)
                If ColNum(1) <> 0 Then
                    If IsNumeric(Sheets("ChumonReport").Cells(n, ColNum(1))) = True Then
                        Sale = Sheets("ChumonReport").Cells(n, ColNum(1))
                        SendPrice = SendPrice + Sale
                        Sheets("ChumonReport").Cells(n, 14) = SendPrice
                    End If
                End If
                '|fffd|||fffd|C|fffd||fffd||fffd|g|fffd|ipoints-granted)
                If ColNum(2) <> 0 Then
                    If IsNumeric(Sheets("ChumonReport").Cells(n, ColNum(2))) = True Then
                        Point = Sheets("ChumonReport").Cells(n, ColNum(2))
                        Price = Price - Point
                        Sheets("ChumonReport").Cells(n, 12) = Price
                    End If
                End If
        Next
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub



Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd|SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd|O()

If Sheets("Config").Cells(67, 2) = "ON" Then
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
    Application.ScreenUpdating = False

    Dim LastIndex As Long
        LastIndex = Sheets("ChumonReport").Cells(Rows.count, 11).End(xlUp).Row
    
    Dim Ini1 As String
    Dim Ini2 As String
    Dim Ini3 As String
    Dim Ini4 As String
    Dim Ini5 As String
    Dim Ini6 As String
    Dim Ini7 As String
    Dim Ini8 As String
    Dim Ini9 As String
    Dim Ini0 As String
    
    Ini1 = Sheets("Config").Cells(68, 2)
    Ini2 = Sheets("Config").Cells(69, 2)
    Ini3 = Sheets("Config").Cells(70, 2)
    Ini4 = Sheets("Config").Cells(71, 2)
    Ini5 = Sheets("Config").Cells(72, 2)
    Ini6 = Sheets("Config").Cells(73, 2)
    Ini7 = Sheets("Config").Cells(74, 2)
    Ini8 = Sheets("Config").Cells(75, 2)
    Ini9 = Sheets("Config").Cells(76, 2)
    Ini0 = Sheets("Config").Cells(77, 2)
    
    Dim SKU As String
    Dim DelateJudge As String
    

    For i = 2 To LastIndex
        SKU = Sheets("ChumonReport").Cells(i, 8)
        
        If Left(SKU, Len(Ini1)) = Ini1 And Ini1 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini2)) = Ini2 And Ini2 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If

        If Left(SKU, Len(Ini3)) = Ini3 And Ini3 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini4)) = Ini4 And Ini4 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini5)) = Ini5 And Ini5 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini6)) = Ini6 And Ini6 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini7)) = Ini7 And Ini7 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini8)) = Ini8 And Ini8 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini9)) = Ini9 And Ini9 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
        
        If Left(SKU, Len(Ini0)) = Ini0 And Ini0 <> "" Then
            DelateJudge = "ON"
            GoTo labelDel
        End If
    
        
labelDel:
        If DelateJudge = "ON" Then
            Sheets("ChumonReport").Rows(i & ":" & i).ClearContents
            DelateJudge = "OFF"
        End If
    
    Application.StatusBar = "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|SKU|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|@" & i & "/" & LastIndex
    DoEvents
    Next
    '|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||10b||d448d|s|fffd||fffd||fffd||382||fffd|
    If Sheets("Config").Cells(48, 2) = "|fffd|~|fffd||fffd|" Then
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
            ("H1"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
            xlSortNormal
        With Sheets("ChumonReport").AutoFilter.Sort
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
    
    Else
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
            ("H1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
            xlSortNormal
        With Sheets("ChumonReport").AutoFilter.Sort
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
    End If

    Application.StatusBar = ""
    '|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
    Application.ScreenUpdating = True

End If
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O()

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim OrderId As String
Dim RowNum As Long

    For i = 2 To LastIndex
        OrderId = Sheets("ChumonReport").Cells(i, 1)
        If Application.WorksheetFunction.CountIf(Sheets("Cancel").Columns("A:A"), OrderId) > 0 Then
            RowNum = Sheets("Cancel").Columns("A:A").Find(OrderId).Row
            Sheets("Cancel").Cells(RowNum, 2) = "|fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Sheets("ChumonReport").Rows(i & ":" & i).ClearContents
        End If
    Next
    '|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||10b||d448d|s|fffd||fffd||fffd||382||fffd|
    If Sheets("Config").Cells(48, 2) = "|fffd|~|fffd||fffd|" Then
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
            ("H1"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
            xlSortNormal
        With Sheets("ChumonReport").AutoFilter.Sort
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
    
    Else
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Clear
        Sheets("ChumonReport").AutoFilter.Sort.SortFields.Add Key:=Range _
            ("H1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
            xlSortNormal
        With Sheets("ChumonReport").AutoFilter.Sort
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        Sheets("ChumonReport").Columns("A:AL").AutoFilter
    End If

End Sub


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim ReportX As Long
    ReportX = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row
    
Dim NO As Long
Dim SKU As String
Dim Tittle As String
Dim Name As String
Dim BuyNumber As Long
Dim OrderId As String
Dim OrderNumber As Long
Dim BuyPrice As Long
Dim ItemPrice As Long
Dim SendPrice As Long

Dim FirstBar As Long
Dim SecondBar As Long
Dim SaleJudge As String
Dim SaleRatio As Long

Dim Profit As Long
Dim SendFeeRatio As Long
Dim ItemFeeRatio As Long
Dim Fee As Long
Dim MySendExp As Long
Dim OtherExp As Long
Dim RowNum As Long

Dim TotalBuyPrice As Long
Dim TotalItemPrice As Long
Dim TotalSendPrice As Long
Dim TotalProfit As Long
Dim TotalBuyNumber As Long

Dim PickingX As Long
    PickingX = Sheets("Picking").Cells(Rows.count, 3).End(xlUp).Row
    
    '|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    If PickingX > 3 Then
        Sheets("Picking").Range("G2:J2").ClearContents
        Sheets("Picking").Range("A4:L" & PickingX).ClearContents
        Sheets("Picking").Range("A4:L" & PickingX).Borders.LineStyle = False
        Sheets("Picking").Range("A4:L" & PickingX).Font.ColorIndex = 1
    End If
    
    Sheets("Picking").Cells(1, 3) = "|fffd|o|fffd||353||fffd||fffd||fffd||fffd|F " & Format(Now(), "YYYY/MM/DD") & "   " & Format(Now(), "hh:mm")
    
    '|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|F|fffd||fffd|-------------------
    Dim SkuCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "sku") > 0 Then
            SkuCol = Sheets("ChumonReport").Rows(1).Find("sku").Column
        Else
            SkuCol = 8
        End If
        
    Dim TittleCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "product-name") > 0 Then
            TittleCol = Sheets("ChumonReport").Rows(1).Find("product-name").Column
        Else
            TittleCol = 9
        End If
        
    Dim NameCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "recipient-name") > 0 Then
            NameCol = Sheets("ChumonReport").Rows(1).Find("recipient-name").Column
        Else
            NameCol = 17
        End If
        
    Dim BuyNumberCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "quantity-purchased") > 0 Then
            BuyNumberCol = Sheets("ChumonReport").Rows(1).Find("quantity-purchased").Column
        Else
            BuyNumberCol = 10
        End If
        
    Dim OrderIdCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "order-id") > 0 Then
            OrderIdCol = Sheets("ChumonReport").Rows(1).Find("order-id").Column
        Else
            OrderIdCol = 1
        End If
        
    Dim ItemPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "item-price") > 0 Then
            ItemPriceCol = Sheets("ChumonReport").Rows(1).Find("item-price").Column
        Else
            ItemPriceCol = 12
        End If
        
    Dim SendPriceCol As Long
        If Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Rows(1), "shipping-price") > 0 Then
            SendPriceCol = Sheets("ChumonReport").Rows(1).Find("shipping-price").Column
        Else
            SendPriceCol = 14
        End If
    '---------------------------------
    
    
    For i = 2 To ReportX
    If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        PickingX = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row + 1
        
        NO = Format(PickingX - 3, "000")
        SKU = Sheets("ChumonReport").Cells(i, SkuCol)
        Tittle = Sheets("ChumonReport").Cells(i, TittleCol)
        If Len(Tittle) > 50 Then '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7427||fffd||fffd|
            Tittle = Left(Tittle, 50)
        End If
        Name = Sheets("ChumonReport").Cells(i, NameCol)
        BuyNumber = Sheets("ChumonReport").Cells(i, BuyNumberCol)
        OrderId = Sheets("ChumonReport").Cells(i, OrderIdCol)
        
        FirstBar = 0
        SecondBar = 0
        SaleJudge = ""
        SaleRatio = 0
        
        For n = 2 To Len(SKU)
            If Left(Right(SKU, n), 1) = "-" And FirstBar = 0 Then
                FirstBar = n
            End If
            
            If Left(Right(SKU, n), 1) = "-" And FirstBar <> n Then
                SecondBar = n
                If Left(Right(SKU, n), 2) = "-S" Then
                    SaleJudge = "ON"
                    If IsNumeric(Mid(SKU, Len(SKU) - SecondBar + 3, SecondBar - FirstBar - 2)) = True Then
                        SaleRatio = Mid(SKU, Len(SKU) - SecondBar + 3, SecondBar - FirstBar - 2)
                    Else
                        SaleRatio = 0
                    End If
                End If
                GoTo labelEsc:
            End If
        Next
labelEsc:
        If FirstBar = 0 Then
            BuyPrice = Sheets("Config").Cells(64, 2)
        Else
            If IsNumeric(Right(SKU, FirstBar - 1)) = True Then
                BuyPrice = Right(SKU, FirstBar - 1)
            Else
                BuyPrice = Sheets("Config").Cells(64, 2)
            End If
        End If
        
        If SaleJudge = "ON" Then
            BuyPrice = Int(BuyPrice * (100 - SaleRatio) / 100)
        End If
        
        If Sheets("Config").Cells(50, 3) > BuyPrice Or BuyPrice > Sheets("Config").Cells(50, 5) Then
            BuyPrice = Sheets("Config").Cells(50, 2)
        End If
        
        '|fffd||fffd||fffd||fffd||fffd||fffd|SKU|fffd||fffd||fffd||30e|d|fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd||20e|d|fffd||fffd||fffd|l|fffd|Z|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim SkuIniNum As Long
        For n = 1 To 37
            If Sheets("Config").Cells(169 + n, 1) <> "" Then
                SkuIniNum = Len(Sheets("Config").Cells(169 + n, 1))
                If Left(SKU, SkuIniNum) = Sheets("Config").Cells(169 + n, 1) Then
                    BuyPrice = BuyPrice - Sheets("Config").Cells(169 + n, 2)
                    GoTo SkuIniSkip
                End If
            End If
            DoEvents
        Next
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||345d||fffd||202||fffd|
        If Sheets("Config").Cells(169, 2) <> "" Then
            BuyPrice = BuyPrice - Sheets("Config").Cells(169, 2)
        End If
SkuIniSkip:
        
        ItemPrice = Sheets("ChumonReport").Cells(i, ItemPriceCol)
        SendPrice = Sheets("ChumonReport").Cells(i, SendPriceCol)
        
    
    Dim SendRowNum As Long
    Dim SendMethod As String
        SendRowNum = Empty
        'SKU|fffd||fffd||fffd||314|z|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||281|i20180518|fffd||1c9||fffd||fffd|j=========================================================
        If Sheets("Config").Cells(45, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" And Sheets("Config").Cells(135, 2) = "ON" Then
            SendRowNum = CheckSendRowNum(SKU)
        End If
        If SendRowNum <> Empty Then
            SendMethod = Sheets("Config").Cells(SendRowNum, 2)
            SendExp = Sheets("Config").Cells(SendRowNum, 3)
        Else
            SendMethod = Sheets("TOP").Cells(5, 9)
            If SendMethod = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                SendMethod = "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
            End If
            SendExp = Application.WorksheetFunction.VLookup(SendMethod, Sheets("Config").Range("A159:B164"), 2, False)
        End If
        
        If SendMethod = "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|" And Sheets("Config").Cells(153, 2) = "ON" Then
            If ItemPrice + SendPrice >= Sheets("Config").Cells(154, 2) Then
                SendMethod = Sheets("Config").Cells(155, 2)
                SendExp = Application.WorksheetFunction.VLookup(SendMethod, Sheets("Config").Range("A159:B164"), 2, False)
            End If
        End If
        '=============================================================================================
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N
        OrderNumber = Application.WorksheetFunction.CountIf(Sheets("ChumonReport").Columns(OrderIdCol), OrderId)
        
        '|fffd||fffd||fffd||fffd||fffd||14e||8414||fffd||fffd||fffd|v|fffd|Z|fffd||fffd|MWS|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Profit = ItemPrice + SendPrice - BuyPrice - SendExp - OtherExp - AmazonFee(SKU, ItemPrice, SendPrice)
        
        '|fffd|s|fffd||fffd||fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        
        Sheets("Picking").Cells(PickingX, 1) = NO
        Sheets("Picking").Cells(PickingX, 2) = SKU
        Sheets("Picking").Cells(PickingX, 3) = Tittle
        Sheets("Picking").Cells(PickingX, 4) = Name
        
        '20180518|fffd||1c9||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|@===============================
        Sheets("Picking").Cells(PickingX, 11) = SendMethod
        '===================================================
        
        If BuyNumber > 1 Then
            Sheets("Picking").Cells(PickingX, 5) = BuyNumber
        End If
        
        If OrderNumber > 1 Then
            Sheets("Picking").Cells(PickingX, 6) = OrderNumber
        End If
        

            Sheets("Picking").Cells(PickingX, 7) = BuyPrice * BuyNumber
            Sheets("Picking").Cells(PickingX, 8) = ItemPrice * BuyNumber
            Sheets("Picking").Cells(PickingX, 9) = SendPrice * BuyNumber
            Sheets("Picking").Cells(PickingX, 10) = Profit * BuyNumber
    
            TotalBuyPrice = TotalBuyPrice + BuyPrice * BuyNumber
            TotalItemPrice = TotalItemPrice + ItemPrice * BuyNumber
            TotalSendPrice = TotalSendPrice + SendPrice * BuyNumber
            TotalProfit = TotalProfit + Profit * BuyNumber
            TotalBuyNumber = TotalBuyNumber + BuyNumber

        '---------------------------------------------------------------------------------------

    End If
        Application.StatusBar = "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|o|fffd||fffd||fffd|@" & i & "/" & ReportX
    DoEvents
    Next

    Sheets("Picking").Cells(PickingX + 1, 3) = "|fffd||20f||fffd| " & TotalBuyNumber & "|fffd|_"
    

        Sheets("Picking").Cells(2, 7) = TotalBuyPrice
        Sheets("Picking").Cells(2, 8) = TotalItemPrice
        Sheets("Picking").Cells(2, 9) = TotalSendPrice
        Sheets("Picking").Cells(2, 10) = TotalProfit

    '|fffd|r|fffd||fffd|------------------------------
                    With Sheets("Picking").Range("A4:J" & PickingX)
                    .Borders(xlEdgeTop).LineStyle = xlDouble
                    .Borders(xlEdgeBottom).LineStyle = xlContinuous
                    .Borders(xlEdgeRight).LineStyle = xlContinuous
                    .Borders(xlEdgeLeft).LineStyle = xlContinuous
                    .Borders(xlInsideVertical).LineStyle = xlContinuous
                    .Borders(xlInsideHorizontal).LineStyle = xlDot
                    End With
    '-----------------------------------
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True

End Sub


Function CheckSendRowNum(SKU As String) As Long


Dim SKUIni() As String
Dim SKUSend() As String
Dim SKUTotalNum As Long
    SKUTotalNum = Application.WorksheetFunction.CountA(Sheets("Config").Range("A138:A150")) + 137
    SKUTotalNum = SKUTotalNum - 137
ReDim SKUIni(SKUTotalNum - 1)
ReDim SKUSend(SKUTotalNum - 1)
    For i = 0 To SKUTotalNum - 1
        SKUIni(i) = Sheets("Config").Cells(138 + i, 1)
        SKUSend(i) = Sheets("Config").Cells(138 + i, 2)
    DoEvents
    Next

Dim BasicSend As String
    BasicSend = Sheets("Config").Cells(45, 2)
    If BasicSend = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        BasicSend = "|fffd||40a4||fffd||fffd||fffd|[|fffd||fffd|"
    End If

    For m = 0 To SKUTotalNum - 1
        If Left(SKU, Len(SKUIni(m))) = SKUIni(m) Then
            CheckSendRowNum = m + 138
            Exit Function
        End If
    DoEvents
    Next

    CheckSendRowNum = Empty

End Function


Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||303|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd|[|fffd|F|fffd|t()

'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

'|fffd|r|fffd||fffd||fffd||310||752||fffd|
Dim OrderColer As String
    OrderColer = "ON"
Dim NumberColer As String
    NumberColer = "ON"
Dim InitialLine As String
    InitialLine = "ON"

Dim LastIndex As Long
    LastIndex = Sheets("Picking").Cells(Rows.count, 1).End(xlUp).Row

For i = 4 To LastIndex
    '|fffd|F|fffd|t|fffd||30e||fffd||fffd|{---------------------------------------------------------------------------
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||310|F|fffd|t
    If OrderColer = "ON" Then
        If Sheets("Picking").Cells(i, 6) <> "" Then
            Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 41
        End If
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||310|F|fffd|t
    If NumberColer = "ON" Then
        If Sheets("Picking").Cells(i, 5) <> "" And Sheets("Picking").Cells(i, 6) <> "" Then
            Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 7
        Else
            '|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd||fffd||fffd||310|F|fffd|t
            If Sheets("Picking").Cells(i, 5) <> "" And OrderColer = "ON" Then
                Sheets("Picking").Range("A" & i & ":F" & i).Font.ColorIndex = 3
            End If
        End If
    End If
    '----------------------------------------------------------------------------------------
    '|fffd|I|fffd||fffd||fffd||182||30c|r|fffd||fffd||fffd||fffd||fffd||fffd|------------------------------------------------------------------------
    If InitialLine = "ON" And i <> 4 Then
        If Left(Sheets("Picking").Cells(i, 2), 1) <> Left(Sheets("Picking").Cells(i - 1, 2), 1) Then
                    With Sheets("Picking").Range("A" & i & ":J" & i)
                    .Borders(xlEdgeTop).LineStyle = xlContinuous
                    End With
        End If
    End If
    '----------------------------------------------------------------------------------------
Application.StatusBar = "|fffd|s|fffd|b|fffd|L|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g|fffd||310|F|fffd||fffd||fffd||fffd||fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|{|fffd|@" & i & "/" & LastIndex
DoEvents
Next

Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module9"
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||14f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = LastIndex Then
               Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||14f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label").Columns("A:J").ClearContents
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 6 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`5|fffd||702||fffd|
                Sheets("Label").Cells(2 + (LabelPosition - 1) * 8, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 1) * 8, 5) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 1) * 8, 5) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 1) * 8, 5) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 1) * 8, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|6|fffd|`|fffd||30f||a347|
                Sheets("Label").Cells(2 + (LabelPosition - 6) * 8, 10) = "|fffd||fffd|" & ZipCode
                Sheets("Label").Cells(3 + (LabelPosition - 6) * 8, 10) = ShipAdd
                Sheets("Label").Cells(4 + (LabelPosition - 6) * 8, 10) = Name & " |fffd|l"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label").Cells(5 + (LabelPosition - 6) * 8, 10) = Message
                Sheets("Label").Cells(6 + (LabelPosition - 6) * 8, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            End If
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 10 Or i = 2 Then
               Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 11 Then
                LabelPosition = 1
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next
    
Sheets("Label").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub

Sub |fffd||fffd||fffd||fffd||fffd|||fffd||153||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||10ccf||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1

    For i = 2 To LastIndex
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@" & i & "/" & LastIndex

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = LastIndex Then
               Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
        
        End If
    
    DoEvents
    Next

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Sub |fffd||fffd||fffd||fffd||fffd|||fffd||153||fffd|l|fffd||28f|Z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False


Dim ZipCode As String
Dim Pref As String
Dim Address0 As String
Dim Address1 As String
Dim Address2 As String
Dim Address3 As String
Dim Name As String
Dim OrderId As String

Dim ShipAdd As String

Dim MyZip As String
    MyZip = Sheets("Config").Cells(11, 2)
Dim MyShop As String
    MyShop = Sheets("Config").Cells(10, 2)
Dim MyAddress As String
    MyAddress = Sheets("Config").Cells(12, 2)
Dim Message As String
    Message = Sheets("Config").Cells(17, 2)

Dim LastIndex As Long
    LastIndex = Sheets("ChumonReport").Cells(Rows.count, 1).End(xlUp).Row

Dim LabelPosition As Long
    LabelPosition = 1

Dim RowNum As Long
Dim Page As Long
    Page = 1

    For i = LastIndex To 2 Step -1
    Application.StatusBar = "|fffd|z|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||64fe||fffd||188||fffd||fffd||fffd||30e||fffd||fffd|s|fffd|@|fffd|c|fffd||fffd| " & i

    
        If Sheets("ChumonReport").Cells(i, 1) <> "" Then
        
        '|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
        If LabelPosition = 1 Then
            Sheets("Label24").Columns("A:O").ClearContents
            Sheets("Label24").Cells(1, 3) = Page
            Sheets("Label24").Cells(1, 4) = "|fffd||fffd||fffd||fffd|"
        End If
        
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            OrderId = Sheets("ChumonReport").Cells(i, 1)
            ZipCode = Sheets("ChumonReport").Cells(i, 23)
            Pref = Sheets("ChumonReport").Cells(i, 22)
            Address0 = Sheets("ChumonReport").Cells(i, 21)
            Address1 = Sheets("ChumonReport").Cells(i, 18)
            Address2 = Sheets("ChumonReport").Cells(i, 19)
            Address3 = Sheets("ChumonReport").Cells(i, 20)
            Name = Sheets("ChumonReport").Cells(i, 17)
            
            '|fffd|Z|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
            If Application.WorksheetFunction.CountIf(Sheets("AddressChange").Columns("A:A"), OrderId) > 0 Then
                RowNum = Sheets("AddressChange").Columns("A:A").Find(OrderId).Row
                ZipCode = Sheets("AddressChange").Cells(RowNum, 2)
                ShipAdd = Sheets("AddressChange").Cells(RowNum, 3)
                If Sheets("AddressChange").Cells(RowNum, 4) <> "" Then
                    Name = Sheets("AddressChange").Cells(RowNum, 4)
                End If
                Sheets("AddressChange").Cells(RowNum, 5) = "|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||3c2||fffd|"
            Else
                ShipAdd = Pref & Address0 & Address1 & Address2 & Address3
            End If
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||248||fffd|
            
            If LabelPosition < 9 Then
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd||fffd|`8|fffd||702||fffd|
                Sheets("Label24").Cells(4 + (LabelPosition - 1) * 7, 5) = "|fffd||fffd|" & ZipCode
                Sheets("Label24").Cells(5 + (LabelPosition - 1) * 7, 5) = ShipAdd
                Sheets("Label24").Cells(6 + (LabelPosition - 1) * 7, 5) = Name & " |fffd|l"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 3) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                Sheets("Label24").Cells(7 + (LabelPosition - 1) * 7, 5) = Message
                Sheets("Label24").Cells(8 + (LabelPosition - 1) * 7, 3).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
            Else
                If LabelPosition < 17 Then
                '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|9|fffd|`16|fffd||702||fffd|
                    Sheets("Label24").Cells(4 + (LabelPosition - 9) * 7, 10) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 9) * 7, 10) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 9) * 7, 10) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 8) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 9) * 7, 10) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 9) * 7, 8).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                Else
                    '|fffd||fffd||fffd|x|fffd||fffd||fffd||292|u|fffd||fffd|17|fffd|`|fffd||30f||a347|
                    Sheets("Label24").Cells(4 + (LabelPosition - 17) * 7, 15) = "|fffd||fffd|" & ZipCode
                    Sheets("Label24").Cells(5 + (LabelPosition - 17) * 7, 15) = ShipAdd
                    Sheets("Label24").Cells(6 + (LabelPosition - 17) * 7, 15) = Name & " |fffd|l"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 13) = "|fffd|y|fffd||fffd||fffd||fffd||fffd|E|fffd||511||fffd||fffd||fffd|z"
                    Sheets("Label24").Cells(7 + (LabelPosition - 17) * 7, 15) = Message
                    Sheets("Label24").Cells(8 + (LabelPosition - 17) * 7, 13).MergeArea = "|fffd||fffd|" & MyZip & " " & MyAddress & " " & MyShop
                End If
            End If
            
          
            
            '10|fffd||82||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||34d||14c||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If LabelPosition = 24 Or i = 2 Then
               Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True
            End If
            
            
            '|fffd||fffd||fffd|x|fffd||fffd||fffd||308||292|u|fffd||fffd||fffd|J|fffd||fffd||30b0||fffd||fffd|
            LabelPosition = LabelPosition + 1
            
            If LabelPosition = 25 Then
                LabelPosition = 1
                Page = Page + 1
                Sheets("Label24").Cells(1, 3) = Page
            End If
            
            If i = 2 Then
                GoTo labelSKIP
            End If
        
        End If
    
    DoEvents
    Next

Sheets("Label24").PrintOut Copies:=1, ActivePrinter:=Worksheets("Config").Cells(5, 2), Collate:=True

labelSKIP:

Application.StatusBar = ""
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' \zUA
' 4om8{
' m.+-

INQUEST-PP=macro
