Attribute VB_Name = "DefZahlavi"
Attribute VB_Base = "0{F58F5073-F20E-4CDC-BFF1-D7F30C42D38E}{A481DD79-0D6A-4F20-BD48-8C6BDE295ABF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
    Unload DefZahlavi
End Sub

Private Sub TextBox1_Change()
    TitulniList.Cells(1, 41) = TextBox1.Value
End Sub
Attribute VB_Name = "HlaskaPrubehu"
Attribute VB_Base = "0{B38CF197-A01B-480D-968E-FFD519CCB26D}{32B21DDB-F12A-4F57-B85E-AD6DEEC14C82}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "Module1"
Sub ObsahPlanu()
    
    ReDim Protected(ThisWorkbook.Sheets.Count) As Boolean
    Dim Sh As Worksheet
    Dim Radek As Integer
    Dim RadekZahlavi As Integer
    Dim PosledniSloupec As Integer
    Dim PrvniSloupec As Integer
    Dim PosledniRadek As Integer
    Dim CisloStranky As Integer
    Dim Tiskarna As String
    Dim i As Integer
    With Application
        .StatusBar = "Upravuje se rozvr|fffd|en|fffd|...v|fffd|b|fffd|r list|fffd| k tisku"
        .ScreenUpdating = False
'        Tiskarna = .ActivePrinter
'        .ActivePrinter = "Microsoft XPS Document Writer na Ne00:"
    End With
    Obsah.Activate
   
    If Obsah.ProtectContents = True Then
        Protected(Obsah.Index) = True
        Obsah.Unprotect
    End If
    Radek = 5
    Obsah.Range("A5:C65536").ClearContents
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.Visible = True Then Sh.Select (False)
    Next
    With ActiveSheet.PageSetup
        .CenterHorizontally = True
        .CenterVertically = False
        .Orientation = xlPortrait
        .PaperSize = xlPaperA4
        .Zoom = False
        .FitToPagesWide = 1
        .FitToPagesTall = False
    End With
    
    Application.StatusBar = "Upravuje se rozvr|fffd|en|fffd|...seznam list|fffd|"
    'Seznam list|fffd|
    
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.CodeName <> "TitulniList" And Sh.Visible = True Then
            Obsah.Cells(Radek, 1) = Sh.Cells(1, 1) & Chr(10) & Sh.Cells(2, 1)
            With Obsah.Cells(Radek, 1).Characters(1, Len(Sh.Cells(1, 1))).Font
                .Size = 10
            End With
            With Obsah.Cells(Radek, 1).Characters(Len(Sh.Cells(1, 1)) + 1, Len(Obsah.Cells(Radek, 1))).Font
                .Size = 8
            End With
            Radek = Radek + 1
            With Sh.PageSetup
                If Vodorovne(Sh.CodeName) = True Then
                    .Orientation = xlLandscape
                    .LeftMargin = Application.CentimetersToPoints(1)
                    .TopMargin = Application.CentimetersToPoints(2)
                    .HeaderMargin = Application.CentimetersToPoints(1.5)
                Else
                    .Orientation = xlPortrait
                    .LeftMargin = Application.CentimetersToPoints(2)
                    .TopMargin = Application.CentimetersToPoints(1.3)
                    .HeaderMargin = Application.CentimetersToPoints(0.8)
                End If
                .RightMargin = Application.CentimetersToPoints(1)
                .BottomMargin = Application.CentimetersToPoints(0.9)
                .FirstPageNumber = xlAutomatic
            End With
        End If
        DoEvents
    Next
'    Application.ActivePrinter = Tiskarna
    'Str|fffd|nkov|fffd|n|fffd|
    CisloStranky = 2
    Radek = 5
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.CodeName <> "TitulniList" And Sh.Visible = True Then
            Sh.Activate
            Application.StatusBar = "Upravuje se rozvr|fffd|en|fffd|..." & Sh.Name
            If Sh.ProtectContents = True Then
                Protected(Sh.Index) = True
                Sh.Unprotect
            End If
            Application.StatusBar = "Upravuje se rozvr|fffd|en|fffd|..." & Sh.Name & " hledan|fffd| oblasti tisku"
            
            RadekZahlavi = 1
            Do While Cells(RadekZahlavi, 2).Borders(xlEdgeBottom).LineStyle <> xlDouble And RadekZahlavi < 30
                RadekZahlavi = RadekZahlavi + 1
            Loop
            If RadekZahlavi = 30 Then
                Application.ScreenUpdating = True
                DefZahlavi.Show
                Application.ScreenUpdating = False
                RadekZahlavi = TitulniList.Cells(1, 41)
            End If
            PosledniSloupec = Cells(RadekZahlavi, 256).End(xlToLeft).Column
            With Range(Cells(RadekZahlavi + 1, 1), Cells(65536, PosledniSloupec)).Borders(xlInsideHorizontal)
                .LineStyle = xlContinuous
                .ColorIndex = 0
               ' .TintAndShade = 0
                .Weight = xlThin
            End With
            Application.StatusBar = "Upravuje se rozvr|fffd|en|fffd|..." & Sh.Name & " nastavov|fffd|n|fffd| konce posledn|fffd| str|fffd|nky"

            DoEvents
            PrvniSloupec = Cells(RadekZahlavi, 3).End(xlToLeft).Column
            
            ActiveWindow.View = xlPageBreakPreview
            ActiveSheet.PageSetup.PrintArea = Range(Columns(PrvniSloupec), Columns(PosledniSloupec)).Address
            Range("A65536:F65536") = "X"
            For i = 1 To ActiveSheet.HPageBreaks.Count
                Range(Cells(ActiveSheet.HPageBreaks(i).Location.Row - 1, PrvniSloupec), Cells(ActiveSheet.HPageBreaks(i).Location.Row - 1, PosledniSloupec)).Borders(xlEdgeBottom).Weight = xlMedium
                If Cells(ActiveSheet.HPageBreaks(i).Location.Row, PrvniSloupec) = "" Then Exit For
            Next
            ActiveSheet.PageSetup.PrintArea = Range(Cells(1, PrvniSloupec), Cells(ActiveSheet.HPageBreaks(i).Location.Row - 1, PosledniSloupec)).Address
            
            ActiveWindow.View = xlNormalView

            Obsah.Cells(Radek, 3) = CisloStranky
            ActiveSheet.PageSetup.FirstPageNumber = CisloStranky
            CisloStranky = CisloStranky + Sh.HPageBreaks.Count + 1

            Radek = Radek + 1
            Range("A65536:F65536").ClearContents
        End If
    Next
    Obsah.Activate
    
    For Each Sh In ThisWorkbook.Worksheets
        If Protected(Sh.Index) = True Then Sh.Protect
    Next
    
    With Application
        .StatusBar = False
    End With
End Sub

Sub PredTiskem()
    Dim Sh As Worksheet
    Dim CZ(1) As String
    Dim EN(1) As String
    Dim DE(1) As String
    Dim RU(1) As String
    Dim RO(1) As String
    Dim PL(1) As String
    Dim HR(1) As String
    Dim Prim(1) As String
    Dim Sek(1) As String
    Dim PocetStran As Integer
    CZ(0) = "Strana"
    CZ(1) = "Dokument |fffd|."
    EN(0) = "Page"
    EN(1) = "Document No."
    DE(0) = "Seite"
    DE(1) = "Dokument-Nr."
    RU(0) = ChrW(1057) & ChrW(1090) & ChrW(1088) & ChrW(1072) & ChrW(1085) & ChrW(1080) & ChrW(1094) & ChrW(1072)
    RU(1) = ChrW(1044) & ChrW(1086) & ChrW(1082) & ChrW(1091) & ChrW(1084) & ChrW(1077) & ChrW(1085) & ChrW(1090) & ChrW(160) & ChrW(8470)
    RO(0) = "Pagin|fffd|"
    RO(1) = "Document Nr."
    PL(0) = "Strona"
    PL(1) = "Dokument Nr"
    HR(0) = "Stranica"
    HR(1) = "Dokument Br."
    Select Case TitulniList.Cells(1, 14)
        Case 1
            Prim(0) = CZ(0)
            Prim(1) = CZ(1)
        Case 2
            Prim(0) = EN(0)
            Prim(1) = EN(1)
        Case 3
            Prim(0) = DE(0)
            Prim(1) = DE(1)
        Case 4
            Prim(0) = RU(0)
            Prim(1) = RU(1)
        Case 5
            Prim(0) = RO(0)
            Prim(1) = RO(1)
        Case 6
            Prim(0) = PL(0)
            Prim(1) = PL(1)
        Case 7
            Prim(0) = HR(0)
            Prim(1) = HR(1)
    End Select
    Select Case TitulniList.Cells(2, 14)
        Case 1
            Sek(0) = CZ(0)
            Sek(1) = CZ(1)
        Case 2
            Sek(0) = EN(0)
            Sek(1) = EN(1)
        Case 3
            Sek(0) = DE(0)
            Sek(1) = DE(1)
        Case 4
            Sek(0) = RU(0)
            Sek(1) = RU(1)
        Case 5
            Sek(0) = RO(0)
            Sek(1) = RO(1)
        Case 6
            Sek(0) = PL(0)
            Sek(1) = PL(1)
        Case 7
            Sek(0) = HR(0)
            Sek(1) = HR(1)
    End Select
    
    Application.StatusBar = "|fffd|prava z|fffd|hlav|fffd| list|fffd|..."
    TitulniList.PageSetup.RightHeader = ""
    PocetStran = ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count).PageSetup.FirstPageNumber + ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count).HPageBreaks.Count
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.CodeName <> "TitulniList" Then
            With Sh.PageSetup
                .RightHeader = "&""Arial,Norm|fffd|ln|fffd|""&10" & Prim(0) & ", " & Sek(0) & ": &P / " & PocetStran
                .LeftHeader = "&""Arial,Tu|fffd|n|fffd|""&12&G " & Prim(1) & ", " & Sek(1) & ": " & TitulniList.Cells(21, 5) & ", Rev. " & TitulniList.Cells(1, 2).End(xlDown)
                .CenterHeader = ""
            End With
        End If
        Sh.DisplayPageBreaks = False
    Next
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.Visible = True Then Sh.Select (False)
    Next
    Application.Calculate
    Application.StatusBar = False
End Sub
Sub PoTisku()
    ActiveSheet.Select
End Sub


Attribute VB_Name = "Module2"
Function Priradit(Pole As Range, Hledat As Variant)
    Application.Volatile
    Dim Bunka As Range
    Priradit = 0
    For Each Bunka In Pole
        If Bunka = Hledat Then
            Priradit = Bunka.Column - Pole.Column + 1
            Exit For
        End If
    Next
End Function
Function PrislusnaBunka(sShape As Shape) As Range
    Dim Radek As Integer
    Dim sloupec As Integer
    Dim Bunka As Range
    Radek = sShape.TopLeftCell.Row
    sloupec = sShape.TopLeftCell.Column
    If sShape.TopLeftCell.Width - (sShape.Left - sShape.TopLeftCell.Left) < sShape.Width / 2 Then sloupec = sShape.TopLeftCell.Column + 1
    If sShape.TopLeftCell.Height - (sShape.Top - sShape.TopLeftCell.Top) < sShape.Height / 2 Then Radek = sShape.TopLeftCell.Row + 1
    Set PrislusnaBunka = Cells(Radek, sloupec)
End Function
Sub VybratObrazek()
    With Nakresy
        .Visible = True
        .ScrollArea = "A1:A1"
        .Activate
    End With
    Application.Goto Reference:=Cells(1, 1), Scroll:=True
End Sub
Sub ObrazekVybran()
    Dim Protected As Boolean
    Dim Sh As Shape
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    If Sheets("" & TitulniList.Cells(1, 38)).ProtectContents = True Then
        Protected = True
        Sheets("" & TitulniList.Cells(1, 38)).Unprotect
    End If
    If ActiveSheet.CodeName = "Nakresy" Then
        If Sheets("" & TitulniList.Cells(1, 38)).Range(TitulniList.Cells(1, 40)).MergeCells = True Then
            Sheets("" & TitulniList.Cells(1, 38)).Activate
            MsgBox "Do slou|fffd|en|fffd| bu|fffd|ky nelze obr|fffd|zek vlo|fffd|it."
            GoTo konec
        End If
        For Each Sh In Sheets("" & TitulniList.Cells(1, 38)).Shapes
            If Sh.TopLeftCell.Address = TitulniList.Cells(1, 40) Then Sh.Delete
        Next
        ActiveSheet.Shapes(Application.Caller).TopLeftCell.Copy _
        Sheets("" & TitulniList.Cells(1, 38)).Range("" & TitulniList.Cells(1, 40))
        Sheets("" & TitulniList.Cells(1, 38)).Activate
        Application.Calculate
        Nakresy.Visible = xlSheetHidden
    Else
        TitulniList.Cells(1, 38) = ActiveSheet.Name
        TitulniList.Cells(1, 40) = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Address
        'ActiveSheet.Shapes(Application.Caller).Delete
        VybratObrazek
    End If
konec:
    If Protected = True Then
        Sheets("" & TitulniList.Cells(1, 38)).Protect
    End If
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub
Sub narovnat()
    Dim Protected As Boolean
    Application.ScreenUpdating = False
    If ActiveSheet.ProtectContents = True Then
        Protected = True
        ActiveSheet.Unprotect
    End If
    On Error Resume Next
    For i = 1 To ActiveSheet.Shapes.Count
        If Left(ActiveSheet.Shapes(i).Name, 9) = "Drop Down" Then GoTo jump
        With ActiveSheet.Shapes(i)
            .Visible = True
            .LockAspectRatio = msoTrue
            .Width = .TopLeftCell.Width - 4
            .Top = .TopLeftCell.Top + 2
            If .Height > .TopLeftCell.Height - 2 Then .Height = .TopLeftCell.Height - 3
            .Left = .TopLeftCell.Left + (.TopLeftCell.Width - .Width) / 2
            .OnAction = "ObrazekVybran"
            .Placement = xlMoveAndSize
        End With
jump:
    Next
    If Protected = True Then
        ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, userinterfaceonly:=True
        'ActiveSheet.EnableAutoFilter = True
    End If
    Application.ScreenUpdating = False
End Sub
Sub PridatPrazdnouTabulku()
    Application.ScreenUpdating = False
    Dim i As Integer
    For i = ThisWorkbook.Sheets.Count To 1 Step -1
        If Left(Sheets(i).CodeName, 7) = "Tabulka" Then Exit For
    Next
    With TabulkaSvaru
        .Visible = True
        .Copy After:=Sheets(i)
        .Visible = False
    End With
    Application.ScreenUpdating = True
End Sub
Function Vodorovne(Nazev As String) As Boolean
    Vodorovne = False
    If InStr(1, Nazev, "SeznamPWHT") > 0 Or InStr(1, Nazev, "SeznamWPS") > 0 Or InStr(1, Nazev, "SeznamSvarecu") > 0 Or InStr(1, Nazev, "TabulkaSvaru") > 0 Then
        Vodorovne = True
    End If
End Function
Sub UniDoubleClick(Target As Range)
    Application.ScreenUpdating = False
    Dim Montazni As Boolean
    Dim SeznamTvaru(3) As String
    Montazni = True
    If Target.Column = 3 And Target.Row > 18 Then
        TitulniList.Cells(1, 38) = ActiveSheet.Name
        TitulniList.Cells(1, 40) = Target.Address
        VybratObrazek
    End If
    If Target.Column = 6 And Target.Row > 18 Then
        For Each Sh In ActiveSheet.Shapes
            If Sh.TopLeftCell.Address = Target.Address Then
                Sh.Delete
                Montazni = False
            End If
        Next
        If Montazni = True Then
            ActiveSheet.Shapes.AddLine(Target.Left + Target.Width / 2 + 2, Target.Top + 35, Target.Left + Target.Width / 2 + 2, Target.Top + 45).Name = "Mont " & ActiveSheet.Shapes.Count
            ActiveSheet.Shapes.AddLine(Target.Left + Target.Width / 2 - 3, Target.Top + 37, Target.Left + Target.Width / 2 + 2, Target.Top + 35).Name = "Mont " & ActiveSheet.Shapes.Count
            ActiveSheet.Shapes.AddLine(Target.Left + Target.Width / 2 - 3, Target.Top + 37, Target.Left + Target.Width / 2 + 2, Target.Top + 39).Name = "Mont " & ActiveSheet.Shapes.Count
            For i = ActiveSheet.Shapes.Count - 3 To ActiveSheet.Shapes.Count - 1
                With ActiveSheet.Shapes("Mont " & i).Line
                    .Visible = msoTrue
                    .Style = msoLineSingle
                    .Weight = 0.15
                    .ForeColor.SchemeColor = 8
                End With
            Next
        End If
    End If
    Application.ScreenUpdating = False
End Sub
Sub SeraditListy()
    Dim PrvniList As Integer
    PrvniList = 0
    Dim PosledniList As Integer
    For Each Sh In ThisWorkbook.Worksheets
        If InStr(1, Sh.CodeName, "Tabulka") > 0 Then
            If PrvniList = 0 Then PrvniList = Sh.Index
            PosledniList = Sh.Index
        End If
    Next
    For lCount = PrvniList To PosledniList
        For lCount2 = lCount To PosledniList
            If UCase(Sheets(lCount2).Cells(5, 3)) < UCase(Sheets(lCount).Cells(5, 3)) Then Sheets(lCount2).Move Before:=Sheets(lCount)
        Next lCount2
    Next lCount
    TitulniList.Activate
    Application.EnableEvents = True
End Sub
Function DatumVytvoreni() As Date
    Application.Volatile
    Dim oFS As Object
    Set oFS = CreateObject("Scripting.FileSystemObject")
    DatumVytvoreni = oFS.GetFile(ThisWorkbook.FullName).DateCreated
End Function

Sub barva555()
    Range(Columns(9), Columns(256)).Interior.ColorIndex = 15
    Range(Rows(27), Rows(65536)).Interior.ColorIndex = 15
End Sub
Attribute VB_Name = "Module3"
Type FILETIME
dwLowDateTime As Long
dwHighDateTime As Long
End Type
Option Explicit
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' modListPrinters
' By Chip Pearson, chip@cpearson.com  www.cpearson.com
' Created 22-Sept-2012
' This provides a function named GetPrinterFullNames that
' returns a String array, each element of which is the name
' of a printer installed on the machine.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Private Const HKEY_CURRENT_USER As Long = &H80000001
Private Const HKCU = HKEY_CURRENT_USER
Private Const KEY_QUERY_VALUE = &H1&
Private Const ERROR_NO_MORE_ITEMS = 259&
Private Const ERROR_MORE_DATA = 234

Private Declare Function RegOpenKeyEx Lib "advapi32" _
    Alias "RegOpenKeyExA" ( _
    ByVal HKey As Long, _
    ByVal lpSubKey As String, _
    ByVal ulOptions As Long, _
    ByVal samDesired As Long, _
    phkResult As Long) As Long

Private Declare Function RegEnumValue Lib "advapi32.dll" _
    Alias "RegEnumValueA" ( _
    ByVal HKey As Long, _
    ByVal dwIndex As Long, _
    ByVal lpValueName As String, _
    lpcbValueName As Long, _
    ByVal lpReserved As Long, _
    lpType As Long, _
    lpData As Byte, _
    lpcbData As Long) As Long

Private Declare Function RegCloseKey Lib "advapi32.dll" ( _
    ByVal HKey As Long) As Long


 

Sub Printers()
    Dim aPrinter As Variant
    With TitulniList.SeznamTiskaren
        .Clear
        For Each aPrinter In GetPrinterFullNames
            .AddItem aPrinter 'FindPrinter(aPrinter)
        Next aPrinter
        For Each aPrinter In GetPrinterFullNames
            Application.ActivePrinter = aPrinter
            Exit For
        Next aPrinter
        .Text = Application.ActivePrinter
    End With
End Sub


Function FindPrinter(ByVal PrinterName As String) As String

 'This works with Windows 2000 and up
 
  Dim Arr As Variant
  Dim Device As Variant
  Dim Devices As Variant
  Dim Printer As String
  Dim RegObj As Object
  Dim RegValue As String
  Const HKEY_CURRENT_USER = &H80000001
       
    Set RegObj = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv")
    RegObj.enumvalues HKEY_CURRENT_USER, "Software\Microsoft\Windows NT\CurrentVersion\Devices", Devices, Arr
    
      For Each Device In Devices
        RegObj.getstringvalue HKEY_CURRENT_USER, "Software\Microsoft\Windows NT\CurrentVersion\Devices", Device, RegValue
        Printer = Device & " na " & Split(RegValue, ",")(1)
        If InStr(1, Printer, PrinterName, vbTextCompare) > 0 Then
           FindPrinter = Printer
           Exit Function
        End If
      Next
      
      
End Function
Public Function GetPrinterFullNames() As String()
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    ' GetPrinterFullNames
    ' By Chip Pearson, chip@cpearson.com, www.cpearson.com
    ' Returns an array of printer names, where each printer name
    ' is the device name followed by the port name. The value can
    ' be used to assign a printer to the ActivePrinter property of
    ' the Application object. Note that setting the ActivePrinter
    ' changes the default printer for Excel but does not change
    ' the Windows default printer.
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    Dim Printers() As String ' array of names to be returned
    Dim PNdx As Long    ' index into Printers()
    Dim HKey As Long    ' registry key handle
    Dim Res As Long     ' result of API calls
    Dim Ndx As Long     ' index for RegEnumValue
    Dim ValueName As String ' name of each value in the printer key
    Dim ValueNameLen As Long    ' length of ValueName
    Dim DataType As Long        ' registry value data type
    Dim ValueValue() As Byte    ' byte array of registry value value
    Dim ValueValueS As String   ' ValueValue converted to String
    Dim CommaPos As Long        ' position of comma character in ValueValue
    Dim ColonPos As Long        ' position of colon character in ValueValue
    Dim M As Long               ' string index
    
    ' registry key in HCKU listing printers
    Const PRINTER_KEY = "Software\Microsoft\Windows NT\CurrentVersion\Devices"
    
    PNdx = 0
    Ndx = 0
    ' assume printer name is less than 256 characters
    ValueName = String$(256, Chr(0))
    ValueNameLen = 255
    ' assume the port name is less than 1000 characters
    ReDim ValueValue(0 To 999)
    ' assume there are less than 1000 printers installed
    ReDim Printers(1 To 1000)
    
    ' open the key whose values enumerate installed printers
    Res = RegOpenKeyEx(HKCU, PRINTER_KEY, 0&, _
        KEY_QUERY_VALUE, HKey)
    ' start enumeration loop of printers
    Res = RegEnumValue(HKey, Ndx, ValueName, _
        ValueNameLen, 0&, DataType, ValueValue(0), 1000)
    ' loop until all values have been enumerated
    Do Until Res = ERROR_NO_MORE_ITEMS
        M = InStr(1, ValueName, Chr(0))
        If M > 1 Then
            ' clean up the ValueName
            ValueName = Left(ValueName, M - 1)
        End If
        ' find position of a comma and colon in the port name
        CommaPos = InStr(1, ValueValue, ",")
        ColonPos = InStr(1, ValueValue, ":")
        ' ValueValue byte array to ValueValueS string
        On Error Resume Next
        ValueValueS = Mid(ValueValue, CommaPos + 1, ColonPos - CommaPos)
        On Error GoTo 0
        ' next slot in Printers
        PNdx = PNdx + 1
        Printers(PNdx) = ValueName & " na " & ValueValueS
        ' reset some variables
        ValueName = String(255, Chr(0))
        ValueNameLen = 255
        ReDim ValueValue(0 To 999)
        ValueValueS = vbNullString
        ' tell RegEnumValue to get the next registry value
        Ndx = Ndx + 1
        ' get the next printer
        Res = RegEnumValue(HKey, Ndx, ValueName, ValueNameLen, _
            0&, DataType, ValueValue(0), 1000)
        ' test for error
        If (Res <> 0) And (Res <> ERROR_MORE_DATA) Then
            Exit Do
        End If
    Loop
    ' shrink Printers down to used size
    ReDim Preserve Printers(1 To PNdx)
    Res = RegCloseKey(HKey)
    ' Return the result array
    GetPrinterFullNames = Printers
End Function


Attribute VB_Name = "Module4"
    Sub Import()
        Dim Importovany As Workbook
        Dim List As Worksheet
        Dim ImList
        Dim AdresyKopie
        Dim AdresyKopieDat
        Application.Dialogs(xlDialogOpen).Show
        If ActiveWorkbook.Name = ThisWorkbook.Name Then Exit Sub
        
        Set Importovany = ActiveWorkbook
        
        'On Error Resume Next
        '1) TitulniList
'        For Each List In Importovany.Sheets
'            If List.CodeName = "TitulniList" Then Set ImList = List
'        Next
'        If Not ImList Is Nothing Then
'            AdresyKopie = Array("B2:G10", "B13:G16")
'            For i = 0 To UBound(AdresyKopie)
'                ImList.Range(AdresyKopie(i)).Copy TitulniList.Range(AdresyKopie(i))
'            Next
'            AdresyKopieDat = Array("C20", "C22", "F20", "F22", "D24")
'            For i = 0 To UBound(AdresyKopieDat)
'                ImList.Range(AdresyKopieDat(i)).Copy
'                TitulniList.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
'            Next
'            Set AdresyKopie = Nothing
'            Set AdresyKopieDat = Nothing
'            Set ImList = Nothing
'        End If
        
        '2) TabulkaSvaru
        For Each List In Importovany.Sheets
            If InStr(1, List.CodeName, "TabulkaSvaru") > 0 And List.Visible = xlSheetVisible Then
                Set ImList = List
                ThisWorkbook.Activate
                With TabulkaSvaru
                    .Visible = True
                    .Copy After:=TabulkaSvaru
                    .Visible = False
                End With
                AdresyKopie = Array("B21:T100")
                For i = 0 To UBound(AdresyKopie)
                    ImList.Range(AdresyKopie(i)).Copy Range(AdresyKopie(i))
                Next
                AdresyKopieDat = Array("C5", "H5", "H6")
                For i = 0 To UBound(AdresyKopieDat)
                    ImList.Range(AdresyKopieDat(i)).Copy
                    Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
                Next
                Set AdresyKopie = Nothing
                Set AdresyKopieDat = Nothing
                Set ImList = Nothing
            End If
        Next
        
        '3)SeznamNDT
        For Each List In Importovany.Sheets
            If List.CodeName = "SeznamNDT" Then Set ImList = List
        Next
        If Not ImList Is Nothing Then
    '        AdresyKopie = Array("")
    '        For i = 0 To UBound(AdresyKopie)
    '            ImList.Range(AdresyKopie(i)).Copy SeznamNDT.Range(AdresyKopie(i))
    '        Next
            AdresyKopieDat = Array("A5:G100")
            For i = 0 To UBound(AdresyKopieDat)
                ImList.Range(AdresyKopieDat(i)).Copy
                SeznamNDT.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
            Next
            Set AdresyKopie = Nothing
            Set AdresyKopieDat = Nothing
            Set ImList = Nothing
        End If
        
        '4) SeznamPWHT
        For Each List In Importovany.Sheets
            If List.CodeName = "SeznamPWHT" Then Set ImList = List
        Next
        If Not ImList Is Nothing Then
    '        AdresyKopie = Array("")
    '        For i = 0 To UBound(AdresyKopie)
    '            ImList.Range(AdresyKopie(i)).Copy SeznamPWHT.Range(AdresyKopie(i))
    '        Next
            AdresyKopieDat = Array("A5:I100")
            For i = 0 To UBound(AdresyKopieDat)
                ImList.Range(AdresyKopieDat(i)).Copy
                SeznamPWHT.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
            Next
            Set AdresyKopie = Nothing
            Set AdresyKopieDat = Nothing
            Set ImList = Nothing
        End If
        
        '5) SeznamSvarecu
        For Each List In Importovany.Sheets
            If List.CodeName = "SeznamSvarecu" Then Set ImList = List
        Next
        If Not ImList Is Nothing Then
    '        AdresyKopie = Array("")
    '        For i = 0 To UBound(AdresyKopie)
    '            ImList.Range(AdresyKopie(i)).Copy SeznamSvarecu.Range(AdresyKopie(i))
    '        Next
            AdresyKopieDat = Array("A5:G100")
            For i = 0 To UBound(AdresyKopieDat)
                ImList.Range(AdresyKopieDat(i)).Copy
                SeznamSvarecu.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
            Next
            Set AdresyKopie = Nothing
            Set AdresyKopieDat = Nothing
            Set ImList = Nothing
        End If
        
        '6) SeznamWPS
        For Each List In Importovany.Sheets
            If List.CodeName = "SeznamWPS" Then Set ImList = List
        Next
        If Not ImList Is Nothing Then
    '        AdresyKopie = Array("")
    '        For i = 0 To UBound(AdresyKopie)
    '            ImList.Range(AdresyKopie(i)).Copy SeznamWPS.Range(AdresyKopie(i))
    '        Next
            AdresyKopieDat = Array("A5:J100")
            For i = 0 To UBound(AdresyKopieDat)
                ImList.Range(AdresyKopieDat(i)).Copy
                SeznamWPS.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
            Next
            Set AdresyKopie = Nothing
            Set AdresyKopieDat = Nothing
            Set ImList = Nothing
        End If
        
        '7) NetlakoveSvary
        For Each List In Importovany.Sheets
            If List.CodeName = "NetlakoveSvary" Then Set ImList = List
        Next
        If Not ImList Is Nothing Then
    '        AdresyKopie = Array("")
    '        For i = 0 To UBound(AdresyKopie)
    '            ImList.Range(AdresyKopie(i)).Copy NetlakoveSvary.Range(AdresyKopie(i))
    '        Next
            AdresyKopieDat = Array("A18:E100")
            For i = 0 To UBound(AdresyKopieDat)
                ImList.Range(AdresyKopieDat(i)).Copy
                NetlakoveSvary.Range(AdresyKopieDat(i)).PasteSpecial (xlPasteFormulas)
            Next
            Set AdresyKopie = Nothing
            Set AdresyKopieDat = Nothing
            Set ImList = Nothing
        End If
    End Sub
    Sub ProhoditJazyky()
        Dim Sh As Worksheet
        Dim Napis As String
        Dim Znak As Long
        For Each Sh In ThisWorkbook.Worksheets
            If InStr(1, Sh.CodeName, "TabulkaSvaru") > 0 Then
                Napis = Sh.Cells(5, 8).Value
                Sh.Cells(5, 8).Value = Sh.Cells(6, 8).Value
                Sh.Cells(6, 8).Value = Napis
            End If
        Next
        With NetlakoveSvary
            For i = 18 To .UsedRange.Rows.Count
                If InStr(1, .Cells(i, 3), Chr(10)) > 0 Then
                    Znak = InStr(1, .Cells(i, 3), Chr(10))
                    .Cells(i, 3) = Right(.Cells(i, 3), Len(.Cells(i, 3)) - Znak) & Chr(10) & Left(.Cells(i, 3), Znak - 1)
                    Znak = InStr(1, .Cells(i, 3), Chr(10))
                    With .Cells(i, 3).Characters(Start:=Znak + 1, Length:=Len(.Cells(i, 3)) - Znak).Font
                        .Size = 8
                    End With
                End If
            Next
        End With
    End Sub
    
    Sub ZkopirovatVyskySirky()
        Dim Sesit1 As Workbook
        Dim Sesit2 As Workbook
        
        Set Sesit1 = Workbooks("svarovaci plan montazni_V12.xlt")
        Set Sesit2 = Workbooks("svarovaci plan_V12.xlt")
        
    End Sub
Attribute VB_Name = "Nakresy"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Storno, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "Prazdne, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "NarovnatObrazky, 3, 2, MSForms, CommandButton"
Private Sub NarovnatObrazky_Click()
    narovnat
End Sub

Private Sub Prazdne_Click()
    Dim Protected As Boolean
    Dim Sh As Shape
    Application.ScreenUpdating = False
    If Sheets("" & TitulniList.Cells(1, 38)).ProtectContents = True Then
        Protected = True
        Sheets("" & TitulniList.Cells(1, 38)).Unprotect
    End If
    For Each Sh In Sheets("" & TitulniList.Cells(1, 38)).Shapes
        If Sh.TopLeftCell.Address = TitulniList.Cells(1, 40) Then Sh.Delete
    Next
    If Protected = True Then
        Sheets("" & TitulniList.Cells(1, 38)).Protect
    End If
    Sheets("" & TitulniList.Cells(1, 38)).Activate
    Application.ScreenUpdating = True
End Sub

Private Sub Storno_Click()
    Sheets("" & TitulniList.Cells(1, 38)).Activate
End Sub

Private Sub Worksheet_Deactivate()
    Nakresy.Visible = False
End Sub

Attribute VB_Name = "NetlakoveSvary"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Obsah"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "SeznamNDT"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SeznamPWHT"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SeznamSvarecu"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SeznamWPS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "TabulkaNahrad"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
        .Calculation = xlCalculationManual
    End With
    Dim Sh As Worksheet
    For Each Sh In ThisWorkbook.Worksheets
        If Sh.CodeName = "TabulkaNahrad" Then GoTo skok1
        For i = 2 To Cells(65536, 1).End(xlUp).Row
            Sh.Cells.Replace What:=Cells(i, 1), Replacement:=Cells(i, 2), LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Next
skok1:
    Next
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
        .Calculation = xlCalculationManual
    End With
End Sub
Attribute VB_Name = "TabulkaSvaru"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "DwgNo, 487, 0, MSForms, Label"
Attribute VB_Control = "DwgNo2, 488, 1, MSForms, Label"
Attribute VB_Control = "PridatPrazdnou, 491, 2, MSForms, CommandButton"
Attribute VB_Control = "TextBox1, 493, 3, MSForms, TextBox"
Attribute VB_Control = "Label1, 494, 4, MSForms, Label"
Private Sub PridatPrazdnou_Click()
    PridatPrazdnouTabulku
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    UniDoubleClick Target
    Cancel = True
End Sub

Private Sub Worksheet_Calculate()
    On Error Resume Next
    With DwgNo
        .Caption = Cells(5, 2)
        .Left = 2
        .Top = Cells(5, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
    With DwgNo2
        .Caption = Cells(6, 2)
        .Left = 2
        .Top = Cells(6, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
End Sub
Attribute VB_Name = "TabulkaSvaru2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "DwgNo, 1, 0, MSForms, Label"
Attribute VB_Control = "DwgNo2, 2, 1, MSForms, Label"
Attribute VB_Control = "PridatPrazdnou, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "TextBox1, 4, 3, MSForms, TextBox"
Attribute VB_Control = "Label1, 5, 4, MSForms, Label"
Private Sub PridatPrazdnou_Click()
    PridatPrazdnouTabulku
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    UniDoubleClick Target
    Cancel = True
End Sub

Private Sub Worksheet_Calculate()
    On Error Resume Next
    With DwgNo
        .Caption = Cells(5, 2)
        .Left = 2
        .Top = Cells(5, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
    With DwgNo2
        .Caption = Cells(6, 2)
        .Left = 2
        .Top = Cells(6, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
End Sub
Attribute VB_Name = "TabulkaSvaru3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "DwgNo, 1, 0, MSForms, Label"
Attribute VB_Control = "DwgNo2, 2, 1, MSForms, Label"
Attribute VB_Control = "PridatPrazdnou, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "TextBox1, 4, 3, MSForms, TextBox"
Attribute VB_Control = "Label1, 5, 4, MSForms, Label"
Private Sub PridatPrazdnou_Click()
    PridatPrazdnouTabulku
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    UniDoubleClick Target
    Cancel = True
End Sub

Private Sub Worksheet_Calculate()
    On Error Resume Next
    With DwgNo
        .Caption = Cells(5, 2)
        .Left = 2
        .Top = Cells(5, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
    With DwgNo2
        .Caption = Cells(6, 2)
        .Left = 2
        .Top = Cells(6, 2).Top + 1
        .WordWrap = False
        .AutoSize = True
    End With
End Sub
Attribute VB_Name = "Tento_se|fffd|it"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Vytvo|fffd|il: Ing. Zbyn|fffd|k Studni|fffd|ka
'Ekol, spol. s r.o., Divize kotl|fffd|
'
'
'Verze V1.2: kv|fffd|ten 2018 - p|fffd|id|fffd|n|fffd| v|fffd|hru|fffd|ky p|fffd|i zak|fffd|zan|fffd|ch makrech
'Verze V1.1: kv|fffd|ten 2017 - zm|fffd|na spu|fffd|t|fffd|n|fffd| grafick|fffd|ch |fffd|prav pro tisk na manu|fffd|ln|fffd|
'Verze V1.0: prosinec 2016 - nastaviteln|fffd| jak sekund|fffd|rn|fffd|, tak prim|fffd|rn|fffd| jazyk; m|fffd|niteln|fffd| logo
'Verze V0.4: listopad 2016 - oprava ob|fffd|asn|fffd| chyby p|fffd|i zalamov|fffd|n|fffd| str|fffd|nek
'Verze V0.3: srpen 2016 - oprava chyby Application.Caller u obr|fffd|zk|fffd|
'Verze V0.2: kv|fffd|ten 2016 - dopln|fffd|n|fffd| listu se seznamem netlakov|fffd|ch svar|fffd|
'Verze V0.1: kv|fffd|ten 2016 - |fffd|prava seznamu WPS, v|fffd|b|fffd|r tisk|fffd|rny na tituln|fffd|m listu
'Verze V0: duben 2016
'


Dim JeUlozene As Boolean






Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    If ThisWorkbook.Path = "" Then Exit Sub
    Dim Sh As Worksheet
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
        .StatusBar = "Ukl|fffd|d|fffd| se " & ThisWorkbook.FullName
    End With
    For Each Sh In ThisWorkbook.Sheets
        Sh.DisplayPageBreaks = False
    Next
    Set Sh = ActiveSheet
    TitulniList.Activate
    TitulniList.Vyhruzka.Visible = True
    ThisWorkbook.Save
    TitulniList.Vyhruzka.Visible = False
    Sh.Activate
    Cancel = True
    With Application
        .ScreenUpdating = True
        .EnableEvents = True
        .StatusBar = False
    End With
    ThisWorkbook.Saved = True
End Sub

Private Sub Workbook_Open()
    On Error Resume Next
    TitulniList.Vyhruzka.Visible = False
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
    End With
    TitulniList.Cells(1, 44) = Application.DefaultSaveFormat
    Application.DefaultSaveFormat = xlExcel8
    Printers
    ActiveWorkbook.CheckCompatibility = False
    ThisWorkbook.Saved = True
    With Application
        .ScreenUpdating = True
        .EnableEvents = True
    End With
End Sub


Private Sub Workbook_BeforeClose(Cancel As Boolean)
    'On Error Resume Next
    If JeUlozene = True Then
        ThisWorkbook.Saved = True
        JeUlozene = False
    End If
    Application.DefaultSaveFormat = TitulniList.Cells(1, 44)
    If ThisWorkbook.Path = "" Then Exit Sub
    If ThisWorkbook.Saved = False Then
        Cancel = True
        Moznost = MsgBox("Save changes in " & ThisWorkbook.Name & "?", vbExclamation + vbYesNoCancel, "Microsoft Office Excel")
        Select Case Moznost
        Case vbYes
            Application.EnableEvents = False
            TitulniList.Activate
            TitulniList.Vyhruzka.Visible = True
            ThisWorkbook.Save
            Application.EnableEvents = True
            ThisWorkbook.Close
        Case vbNo
            JeUlozene = True
            ThisWorkbook.Close SaveChanges:=False
        End Select
    End If
End Sub

Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
    If InStr(1, ActiveSheet.CodeName, "TabulkaSvaru", vbTextCompare) > 0 Then
        i = 1
        For Each Sh In ActiveSheet.Shapes
            If Sh.Type = msoPicture Then
                If Left(Sh.Name, 1) = "A" Then Sh.Name = "B" & i Else Sh.Name = "A" & i
                i = i + 1
            End If
        Next
        If Target.Column > 10 And Target.Column < 20 And (Target.Column) / 2 <> Application.WorksheetFunction.Round((Target.Column) / 2, 0) And Target.Count = 1 Then
            If Target.Value = "-" Then
                Target.Value = "'---"
                Cells(Target.Row, Target.Column + 1).Value = "'---"
                If Cells(Target.Row, Target.Column + 1).Address = ActiveCell.Address Then Cells(Target.Row, Target.Column + 2).Select
            End If
        End If
        If Target.Row > 20 And Target.Column = 7 And Target.Count = 1 Then
            If Target.Value <> "" And Left(Target.Value, 1) <> "'" Then Target.Value = "'" & Target.Text
        End If
    End If
End Sub





Attribute VB_Name = "TitulniList"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image1, 219, 0, MSForms, Image"
Attribute VB_Control = "SeznamTiskaren, 264, 1, MSForms, ComboBox"
Attribute VB_Control = "Label1, 265, 2, MSForms, Label"
Attribute VB_Control = "Image2, 276, 3, MSForms, Image"
Attribute VB_Control = "PripravitTisk, 281, 4, MSForms, CommandButton"
Attribute VB_Control = "Vyhruzka, 282, 5, MSForms, Image"
Attribute VB_Control = "SeraditTabulky, 283, 6, MSForms, CommandButton"
Attribute VB_Control = "Prohozeni, 284, 7, MSForms, CommandButton"
Attribute VB_Control = "Importovat, 285, 8, MSForms, CommandButton"
Private Sub CommandButton1_Click()

End Sub

Private Sub Image1_Click()
    Image1.Visible = False
    Image1.PrintObject = False
    Image2.Visible = True
    Image2.PrintObject = True
End Sub

Private Sub Image2_Click()
    Image1.Visible = True
    Image1.PrintObject = True
    Image2.Visible = False
    Image2.PrintObject = False
End Sub

Private Sub Importovat_Click()
    Import
End Sub

Private Sub PripravitTisk_Click()
    HlaskaPrubehu.Show
    DoEvents
    On Error Resume Next
    With Application
        .ScreenUpdating = False
        .EnableEvents = False
        .Calculation = xlCalculationManual
        .PrintCommunication = False
    End With
    On Error GoTo 0
    ObsahPlanu
    PredTiskem
    Unload HlaskaPrubehu
    TitulniList.Activate
    On Error Resume Next
    With Application
        .OnTime Now(), "PoTisku"
        .ScreenUpdating = True
        .EnableEvents = True
        .Calculation = xlCalculationAutomatic
        .PrintCommunication = True
    End With
End Sub

Private Sub Prohozeni_Click()
    ProhoditJazyky
End Sub

Private Sub SeraditTabulky_Click()
    SeraditListy
End Sub

Private Sub SeznamTiskaren_Change()
    On Error Resume Next
    Application.ActivePrinter = SeznamTiskaren.Text
    SeznamTiskaren.Text = Application.ActivePrinter
End Sub

Private Sub Worksheet_Activate()
    SeznamTiskaren.Text = Application.ActivePrinter
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Sub pokus()
    ComboBox1.AddItem "EN"
    ComboBox1.AddItem "RU"
End Sub


INQUEST-PP=macro
