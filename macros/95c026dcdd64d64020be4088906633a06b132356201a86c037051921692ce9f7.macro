Attribute VB_Name = "Formular"
Attribute VB_Base = "0{1C8F480E-948D-44B0-8299-79BE22B700B7}{296FD5B1-0A74-4455-BC67-F1E01476E073}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Sub OKButton_Click()

Dim a As String, b As String, c As String
Dim Formular As Variant, Novy_Majetek As Variant, List As Variant, Zdroj As Variant
Dim msg As String
Dim Zakonne_Prestavky As Variant, Priplatek1 As Variant, Priplatek2 As Variant, Cena_Stravenky As Variant, Pocet_Stravenek As Variant

On Error GoTo Chyba
Formular = form.Value
    If form.Value = "" Or form.Value = ActiveSheet.Name Or form.Value < 1 Or form.Value > 30 Then
   'msg = "Vyberte z rozev|fffd|rac|fffd|ho seznamu po|fffd|adovan|fffd| um|fffd|st|fffd|n|fffd|."
    Unload Me
    Exit Sub
    End If
Unload Me
a = MsgBox("Vybral(a) jste |fffd||fffd|slo formul|fffd||fffd|e: [" & Formular & "]." & vbCrLf & vbCrLf _
& "POZOR: b|fffd|hem duplikace |fffd|daj|fffd| dojde k v|fffd|mazu dat ze v|fffd|ech" & vbCrLf _
& "p|fffd||fffd|stupn|fffd|ch pol|fffd| v tomto formul|fffd||fffd|i a budou nahrazena daty" & vbCrLf _
& "z vybran|fffd|ho formul|fffd||fffd|e [" & Formular & "]." & vbCrLf & vbCrLf _
& "Opravdu chcete pokra|fffd|ovat v duplikaci |fffd|daj|fffd|?", vbYesNo + vbExclamation, "Posledn|fffd| dotaz p|fffd|ed duplikac|fffd| |fffd|daj|fffd|")
If a <> vbYes Then Exit Sub
'Exit Sub
List = ActiveSheet.Name

Application.ScreenUpdating = False
Range("D16:E46,J16:L46,O16:R46,W16:Y46,G50,G68,G70,L60,L62").Select
    Range("L62").Activate
    Selection.ClearContents
Range("D16").Select

Sheets(Formular).Select
Zdroj = ActiveSheet.Name
'P|fffd||fffd|chod-Odchod
Range("D16:E46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("H16").Select
'P|fffd|es|fffd|as
Sheets(Zdroj).Activate
Range("H16:H46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("J16").Select
'Pohotovost+Status
Sheets(Zdroj).Activate
Range("J16:K46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("L16").Select
'Pozn|fffd|mka
Sheets(Zdroj).Activate
Range("L16:L46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("O16").Select
'P|fffd|est|fffd|vky
Sheets(Zdroj).Activate
Range("O16:R46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("W16").Select
'Pohotovost od-do
Sheets(Zdroj).Activate
Range("W16:X46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("Y16").Select
'Pozn|fffd|mka 2
Sheets(Zdroj).Activate
Range("Y16:Y46").Select
Selection.Copy
    Sheets(List).Activate
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("D16").Select
'P|fffd|enos ostatn|fffd|ch prom|fffd|nn|fffd|ch
Sheets(Zdroj).Activate
Range("D16").Select
Zakonne_Prestavky = Range("G50").Value
Priplatek1 = Range("G68").Value
Priplatek2 = Range("G70").Value
Cena_Stravenky = Range("L60").Value
Pocet_Stravenek = Range("L62").Value
Sheets(List).Select
Range("G50").Value = Zakonne_Prestavky
Range("G68").Value = Priplatek1
Range("G70").Value = Priplatek2
Range("L60").Value = Cena_Stravenky
Range("L62").Value = Pocet_Stravenek

Exit Sub
Chyba:
Application.StatusBar = False
MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|", vbOKOnly + vbCritical, "Chyba aplikace"

End Sub

Private Sub STORNOButton1_Click()
Unload Me
End Sub


Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Licence"
Attribute VB_Base = "0{B2740052-46C4-4925-AF14-AA7FC52EF749}{6E0AEBD6-6EB7-4A67-94EC-8F21B658E718}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub OKButton_Click()
Unload Licence
End Sub


Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Option Explicit
Option Private Module

'32-bit API declaration
Private Declare Function GetSystemMetrics Lib "user32" _
  (ByVal nIndex As Long) As Long

Public Const SM_CXSCREEN = 0
Public Const SM_CYSCREEN = 1
'32-bit API declarations
Private Declare Function SHGetPathFromIDList Lib "shell32.dll" _
  Alias "SHGetPathFromIDListA" (ByVal pidl As Long, ByVal pszPath As String) As Long

Private Declare Function SHBrowseForFolder Lib "shell32.dll" _
Alias "SHBrowseForFolderA" (lpBrowseInfo As BROWSEINFO) As Long

Private Type BROWSEINFO
    hOwner As Long
    pidlRoot As Long
    pszDisplayName As String
    lpszTitle As String
    ulFlags As Long
    lpfn As Long
    lParam As Long
    iImage As Long
End Type

Private Declare Function GetProfileStringA Lib "kernel32" _
    (ByVal lpAppName As String, _
    ByVal lpKeyName As String, _
    ByVal lpDefault As String, _
    ByVal lpReturnedString As _
    String, ByVal nSize As Long) As Long
Private Function GetDirectory(Optional msg) As String
    Dim bInfo As BROWSEINFO
    Dim path As String
    Dim r As Long, x As Long, pos As Integer
 
'   Root folder = Desktop
    bInfo.pidlRoot = 0&

'   Title in the dialog
    If IsMissing(msg) Then
        bInfo.lpszTitle = "Select a folder."
    Else
        bInfo.lpszTitle = msg
    End If
    
'   Type of directory to return
    bInfo.ulFlags = &H1

'   Display the dialog
    x = SHBrowseForFolder(bInfo)
    
'   Parse the result
    path = Space$(512)
    r = SHGetPathFromIDList(ByVal x, ByVal path)
    
    If r Then
        pos = InStr(path, Chr$(0))
        GetDirectory = Left(path, pos - 1)
    Else
        GetDirectory = ""
    End If
End Function

Sub InfoVychoziTiskarny()
    Dim strLPT As String * 255
    Dim Vysledek As String
    Dim DelkaVysledku As Integer
    Dim Carka1 As Integer
    Dim Carka2 As Integer
    Dim Tiskarna As String
    Dim Ovladac As String
    Dim Port As String
    Dim Zprava As String

    Call GetProfileStringA("Windows", "Device", "", strLPT, 254)

    Vysledek = Application.Trim(strLPT)
    DelkaVysledku = Len(Vysledek)

    Carka1 = InStr(1, Vysledek, ",", 1)
    Carka2 = InStr(Carka1 + 1, Vysledek, ",", 1)

    ' n|fffd|zev tisk|fffd|rny
    Tiskarna = Left(Vysledek, Carka1 - 1)
 
    ' |fffd|daje o ovlada|fffd|i tisk|fffd|rny
    Ovladac = Mid(Vysledek, Carka1 + 1, Carka2 - Carka1 - 1)

    ' posledn|fffd| |fffd||fffd|st z |fffd||fffd|dku textu
    Port = Right(Vysledek, DelkaVysledku - Carka2)

    ' zpr|fffd|va
    Zprava = "Tisk|fffd|rna:" & Chr(9) & Tiskarna & Chr(13)
    Zprava = Zprava & "Ovlada|fffd|:" & Chr(9) & Ovladac & Chr(13)
    Zprava = Zprava & "Port:" & Chr(9) & Port

    ' hl|fffd|en|fffd|
    MsgBox Zprava, vbInformation, "Informace o v|fffd|choz|fffd| tisk|fffd|rn|fffd|"
End Sub
Private Function NazevSouboru(Cesta) As String
Dim i As Integer, length As Integer, temp As String
length = Len(Cesta)
temp = ""
For i = length To 1 Step -1
    If Mid(Cesta, i, 1) = Application.PathSeparator Then
    NazevSouboru = temp
    Exit Function
    End If
    temp = Mid(Cesta, i, 1) & temp
Next i
NazevSouboru = Cesta
MsgBox Cesta

End Function

Sub Vymaz_nabidek_zamestnancu()
'
' Vymaz_nabidek_zamestnancu Makro

Dim dotaz As String, Zprava As String

    On Error GoTo Chyba
    dotaz = MsgBox("Opravdu chcete vymazat p|fffd||fffd|stupn|fffd| pole v jednotliv|fffd|ch formul|fffd||fffd||fffd|ch u v|fffd|ech zam|fffd|stnanc|fffd|?" & vbCrLf & vbCrLf _
    & "Budou vymaz|fffd|na v|fffd|echna p|fffd||fffd|stupn|fffd| pole v jednotliv|fffd|ch formul|fffd||fffd||fffd|ch v|fffd|ech zam|fffd|stnanc|fffd|.", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed pro|fffd|i|fffd|t|fffd|n|fffd|m aplikace")
        If dotaz = vbNo Then
        Exit Sub
        End If
    Application.ScreenUpdating = False
    Sheets("1").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
    Sheets("2").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
    Sheets("3").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
    Sheets("4").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
    Sheets("5").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("6").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("7").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("8").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("9").Select
   Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("10").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("11").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("12").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("13").Select
   Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("14").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("15").Select
   Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("16").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("17").Select
   Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("18").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("19").Select
   Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("20").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("21").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("22").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("23").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("24").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
     Sheets("25").Select
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
    
    
    Sheets("|fffd|VOD").Select
    Application.ScreenUpdating = True
    Zprava = MsgBox("V|fffd|echna p|fffd||fffd|stupn|fffd| pole byla v cel|fffd| aplikaci vymaz|fffd|na.", vbOKOnly + vbInformation, "Zpr|fffd|va o pro|fffd|i|fffd|t|fffd|n|fffd| aplikace")
'    Range("A1").Select
    Exit Sub
Chyba:
Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub Vymaz_nabidek_zamestnancu_jednotl()
'
' Vymaz_nabidek_zamestnance Makro

Dim dotaz As String, Zprava As String
Dim Zamestnanec As String



    On Error GoTo Chyba
    ActiveSheet.Select
'    Range("D16").Select
    Zamestnanec = Range("F7").Value
    dotaz = MsgBox("Opravdu chcete vymazat p|fffd||fffd|stupn|fffd| pole ve formul|fffd||fffd|i u zam|fffd|stnance: " & Zamestnanec & "?" & vbCrLf & vbCrLf _
    & "Budou vymaz|fffd|na v|fffd|echna p|fffd||fffd|stupn|fffd| pole v tomto formul|fffd||fffd|i.", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed pro|fffd|i|fffd|t|fffd|n|fffd|m formul|fffd||fffd|e")
        If dotaz = vbNo Then
        Exit Sub
        End If
    Application.ScreenUpdating = False
    Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L52,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select
        
    Application.ScreenUpdating = True
    
    Exit Sub
Chyba:
'Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub

Sub Vyplneni_casu_prichodu_a_odchodu()

Dim nazev_listu As String, dotaz As String, Zprava As String, Zprava2 As String, Zprava3 As String
Dim pocet_listu As Integer, Pocet_Dnu As Integer, pocet_aktiv As Integer
Dim Prichod_PO As Variant, Odchod_PO As Variant, Prest_PO_1_Od As Variant, Prest_PO_1_Do As Variant, Prest_PO_2_Od As Variant, Prest_PO_2_Do As Variant
Dim Prichod_UT As Variant, Odchod_UT As Variant, Prest_UT_1_Od As Variant, Prest_UT_1_Do As Variant, Prest_UT_2_Od As Variant, Prest_UT_2_Do As Variant
Dim Prichod_ST As Variant, Odchod_ST As Variant, Prest_ST_1_Od As Variant, Prest_ST_1_Do As Variant, Prest_ST_2_Od As Variant, Prest_ST_2_Do As Variant
Dim Prichod_CT As Variant, Odchod_CT As Variant, Prest_CT_1_Od As Variant, Prest_CT_1_Do As Variant, Prest_CT_2_Od As Variant, Prest_CT_2_Do As Variant
Dim Prichod_PA As Variant, Odchod_PA As Variant, Prest_PA_1_Od As Variant, Prest_PA_1_Do As Variant, Prest_PA_2_Od As Variant, Prest_PA_2_Do As Variant
Dim Prichod_SO As Variant, Odchod_SO As Variant, Prest_SO_1_Od As Variant, Prest_SO_1_Do As Variant, Prest_SO_2_Od As Variant, Prest_SO_2_Do As Variant
Dim Prichod_NE As Variant, Odchod_NE As Variant, Prest_NE_1_Od As Variant, Prest_NE_1_Do As Variant, Prest_NE_2_Od As Variant, Prest_NE_2_Do As Variant
Dim Den As Integer


 On Error GoTo Chyba
 
 Sheets("|fffd|VOD").Select
 pocet_aktiv = Range("BP27").Value
 If Range("BP27").Value = 0 Then
 Zprava = MsgBox("Nebyl zji|fffd|t|fffd|n ani jeden aktivovan|fffd| zam|fffd|stnanec. Vypl|fffd|te v t|fffd|to nab|fffd|dce minim|fffd|ln|fffd| 1) P|fffd||fffd|jmen|fffd| a jm|fffd|no, 2) Denn|fffd| pracovn|fffd| |fffd|vazek a 3) Pracovn|fffd| dobu od-do alespo|fffd| v 1 dni.", vbOKOnly + vbInformation, "Zpr|fffd|va o po|fffd|tu aktivovan|fffd|ch zam|fffd|stnanc|fffd|")
 Range("E28").Select
 Exit Sub
 End If
 If Range("BO27").Value = 0 Then
 Zprava = MsgBox("Nebylo nastaveno sledovan|fffd| obdob|fffd|. Vyberte rok a m|fffd|s|fffd|c a volbu opakujte.", vbOKOnly + vbExclamation, "Nevypln|fffd|n|fffd| sledovan|fffd| obdob|fffd|")
 Range("D8").Select
 Exit Sub
 End If
 
    dotaz = MsgBox("Opravdu chcete vyplnit u v|fffd|ech aktivovan|fffd|ch zam|fffd|stnanc|fffd|* |fffd|asy p|fffd||fffd|chodu, odchodu a doby p|fffd|est|fffd|vek?" & vbCrLf & vbCrLf _
    & "Touto operac|fffd| budou vymaz|fffd|na v|fffd|echna p|fffd||fffd|stupn|fffd| pole u aktivovan|fffd|ch zam|fffd|stnanc|fffd|" & vbCrLf _
    & "a z|fffd|rove|fffd| budou v jednotliv|fffd|ch dnech** vypln|fffd|ny jejich |fffd|asy p|fffd||fffd|chodu, odchodu a doby p|fffd|est|fffd|vek." & vbCrLf & vbCrLf _
    & "---------------------------------------------------------------------" & vbCrLf _
    & "*   Aktivovan|fffd| zam|fffd|stnanec = zam|fffd|stnanec, kter|fffd| m|fffd| vypln|fffd|no minim|fffd|ln|fffd|: p|fffd||fffd|jmen|fffd| a jm|fffd|no, denn|fffd|" & vbCrLf _
    & "    pracovn|fffd| |fffd|vazek a pracovn|fffd| dobu od-do alespo|fffd| v 1 dni (m|fffd| zelen|fffd| podbarveno po|fffd|adov|fffd| |fffd||fffd|slo)." & vbCrLf & vbCrLf _
    & "** |fffd|asy p|fffd||fffd|chodu, odchodu a doby p|fffd|est|fffd|vek budou vypln|fffd|ny ve dnech, kter|fffd| jsou aktu|fffd|ln|fffd| zad|fffd|ny" & vbCrLf _
    & "     v [Z|fffd|kladn|fffd|m nastaven|fffd| atribut|fffd| hromadn|fffd|ho p|fffd|edvypln|fffd|n|fffd|].", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed vypln|fffd|n|fffd|m p|fffd||fffd|chod|fffd|, odchod|fffd| a |fffd|as|fffd| p|fffd|est|fffd|vek")
        If dotaz = vbNo Then
        Exit Sub
        End If
        
'Call Vymaz_nabidek_zamestnancu
Application.StatusBar = "STRPEN|fffd||fffd|KO, MAK|fffd|M NA PLN|fffd| OBR|fffd|TKY - VYPL|fffd|UJI JEDNOTLIV|fffd| FORMUL|fffd||fffd|E..."
Application.ScreenUpdating = False
Sheets("|fffd|VOD").Select
Range("BP28").Select

 For pocet_listu = 1 To 25
    If ActiveCell.Value = 1 Then
nazev_listu = ActiveCell.Offset(0, -3).Value
Prichod_PO = ActiveCell.Offset(0, -53).Value
Odchod_PO = ActiveCell.Offset(0, -52).Value
Prest_PO_1_Od = ActiveCell.Offset(0, -51).Value
Prest_PO_1_Do = ActiveCell.Offset(0, -50).Value
Prest_PO_2_Od = ActiveCell.Offset(0, -49).Value
Prest_PO_2_Do = ActiveCell.Offset(0, -48).Value

Prichod_UT = ActiveCell.Offset(0, -47).Value
Odchod_UT = ActiveCell.Offset(0, -46).Value
Prest_UT_1_Od = ActiveCell.Offset(0, -45).Value
Prest_UT_1_Do = ActiveCell.Offset(0, -44).Value
Prest_UT_2_Od = ActiveCell.Offset(0, -43).Value
Prest_UT_2_Do = ActiveCell.Offset(0, -42).Value

Prichod_ST = ActiveCell.Offset(0, -41).Value
Odchod_ST = ActiveCell.Offset(0, -40).Value
Prest_ST_1_Od = ActiveCell.Offset(0, -39).Value
Prest_ST_1_Do = ActiveCell.Offset(0, -38).Value
Prest_ST_2_Od = ActiveCell.Offset(0, -37).Value
Prest_ST_2_Do = ActiveCell.Offset(0, -36).Value

Prichod_CT = ActiveCell.Offset(0, -35).Value
Odchod_CT = ActiveCell.Offset(0, -34).Value
Prest_CT_1_Od = ActiveCell.Offset(0, -33).Value
Prest_CT_1_Do = ActiveCell.Offset(0, -32).Value
Prest_CT_2_Od = ActiveCell.Offset(0, -31).Value
Prest_CT_2_Do = ActiveCell.Offset(0, -30).Value

Prichod_PA = ActiveCell.Offset(0, -29).Value
Odchod_PA = ActiveCell.Offset(0, -28).Value
Prest_PA_1_Od = ActiveCell.Offset(0, -27).Value
Prest_PA_1_Do = ActiveCell.Offset(0, -26).Value
Prest_PA_2_Od = ActiveCell.Offset(0, -25).Value
Prest_PA_2_Do = ActiveCell.Offset(0, -24).Value

Prichod_SO = ActiveCell.Offset(0, -23).Value
Odchod_SO = ActiveCell.Offset(0, -22).Value
Prest_SO_1_Od = ActiveCell.Offset(0, -21).Value
Prest_SO_1_Do = ActiveCell.Offset(0, -20).Value
Prest_SO_2_Od = ActiveCell.Offset(0, -19).Value
Prest_SO_2_Do = ActiveCell.Offset(0, -18).Value

Prichod_NE = ActiveCell.Offset(0, -17).Value
Odchod_NE = ActiveCell.Offset(0, -16).Value
Prest_NE_1_Od = ActiveCell.Offset(0, -15).Value
Prest_NE_1_Do = ActiveCell.Offset(0, -14).Value
Prest_NE_2_Od = ActiveCell.Offset(0, -13).Value
Prest_NE_2_Do = ActiveCell.Offset(0, -12).Value



Sheets(nazev_listu).Select
 Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L62").Select
    Range("L62").Activate
    Selection.ClearContents
  
 Range("D16").Select
    For Pocet_Dnu = 1 To 31
    If ActiveCell.Offset(0, -2) <> "" Then
    Den = ActiveCell.Offset(0, 37).Value
        
    Select Case Den
    Case Is = 1
        ActiveCell.Value = Prichod_PO
        ActiveCell.Offset(0, 1).Value = Odchod_PO
            If (Prichod_PO <> 0 Or Odchod_PO <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_PO_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_PO_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_PO_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_PO_2_Do
    Case Is = 2
        ActiveCell.Value = Prichod_UT
        ActiveCell.Offset(0, 1).Value = Odchod_UT
            If (Prichod_UT <> 0 Or Odchod_UT <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_UT_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_UT_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_UT_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_UT_2_Do
    Case Is = 3
        ActiveCell.Value = Prichod_ST
        ActiveCell.Offset(0, 1).Value = Odchod_ST
            If (Prichod_ST <> 0 Or Odchod_ST <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_ST_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_ST_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_ST_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_ST_2_Do
    Case Is = 4
        ActiveCell.Value = Prichod_CT
        ActiveCell.Offset(0, 1).Value = Odchod_CT
            If (Prichod_CT <> 0 Or Odchod_CT <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_CT_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_CT_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_CT_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_CT_2_Do
    Case Is = 5
        ActiveCell.Value = Prichod_PA
        ActiveCell.Offset(0, 1).Value = Odchod_PA
            If (Prichod_PA <> 0 Or Odchod_PA <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_PA_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_PA_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_PA_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_PA_2_Do
    Case Is = 6
        ActiveCell.Value = Prichod_SO
        ActiveCell.Offset(0, 1).Value = Odchod_SO
            If (Prichod_SO <> 0 Or Odchod_SO <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_SO_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_SO_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_SO_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_SO_2_Do
    Case Is = 7
        ActiveCell.Value = Prichod_NE
        ActiveCell.Offset(0, 1).Value = Odchod_NE
            If (Prichod_NE <> 0 Or Odchod_NE <> 0) Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_NE_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_NE_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_NE_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_NE_2_Do
    End Select
        
        ActiveCell.Offset(1, 0).Select
        Else
        ActiveCell.Offset(1, 0).Select
        End If
    Next Pocet_Dnu
    
Range("D16").Select
Sheets("|fffd|VOD").Select
'Vymaz|fffd|n|fffd| prom|fffd|nn|fffd| !
ActiveCell.Offset(1, 0).Select
    Else
ActiveCell.Offset(1, 0).Select
    End If
Next pocet_listu

Application.StatusBar = False
Application.ScreenUpdating = True
Range("D28").Select

    Select Case pocet_aktiv
Case Is > 1
Zprava2 = MsgBox("|fffd|asy p|fffd||fffd|chodu, odchodu a p|fffd|est|fffd|vek byly vypln|fffd|ny celkem u " & pocet_aktiv & " aktivovan|fffd|ch zam|fffd|stnanc|fffd|.", vbOKOnly + vbInformation, "Zpr|fffd|va o vypln|fffd|n|fffd| |fffd|as|fffd|")
Case Is = 1
Zprava3 = MsgBox("|fffd|asy p|fffd||fffd|chodu, odchodu a p|fffd|est|fffd|vek byly vypln|fffd|ny celkem u 1 aktivovan|fffd|ho zam|fffd|stnance.", vbOKOnly + vbInformation, "Zpr|fffd|va o vypln|fffd|n|fffd| |fffd|as|fffd|")
    End Select
 Exit Sub
Chyba:
Application.StatusBar = False
Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub Vyplneni_casu_prichodu_a_odchodu_jednotl()

Dim dotaz As Variant, Zprava As Variant, Zprava2 As String, Zprava3 As String
Dim Pocet_Dnu As Integer, pocet_aktiv As Integer
Dim cas_prichodu As Variant, cas_odchodu As Variant, cas_prichodu_prestavka_1 As Variant, cas_prichodu_prestavka_2 As Variant, cas_odchodu_prestavka_1 As Variant, cas_odchodu_prestavka_2 As Variant
Dim Prichod_PO As Variant, Odchod_PO As Variant, Prest_PO_1_Od As Variant, Prest_PO_1_Do As Variant, Prest_PO_2_Od As Variant, Prest_PO_2_Do As Variant
Dim Prichod_UT As Variant, Odchod_UT As Variant, Prest_UT_1_Od As Variant, Prest_UT_1_Do As Variant, Prest_UT_2_Od As Variant, Prest_UT_2_Do As Variant
Dim Prichod_ST As Variant, Odchod_ST As Variant, Prest_ST_1_Od As Variant, Prest_ST_1_Do As Variant, Prest_ST_2_Od As Variant, Prest_ST_2_Do As Variant
Dim Prichod_CT As Variant, Odchod_CT As Variant, Prest_CT_1_Od As Variant, Prest_CT_1_Do As Variant, Prest_CT_2_Od As Variant, Prest_CT_2_Do As Variant
Dim Prichod_PA As Variant, Odchod_PA As Variant, Prest_PA_1_Od As Variant, Prest_PA_1_Do As Variant, Prest_PA_2_Od As Variant, Prest_PA_2_Do As Variant
Dim Prichod_SO As Variant, Odchod_SO As Variant, Prest_SO_1_Od As Variant, Prest_SO_1_Do As Variant, Prest_SO_2_Od As Variant, Prest_SO_2_Do As Variant
Dim Prichod_NE As Variant, Odchod_NE As Variant, Prest_NE_1_Od As Variant, Prest_NE_1_Do As Variant, Prest_NE_2_Od As Variant, Prest_NE_2_Do As Variant
Dim Den As Integer

 On Error GoTo Chyba
 
 ActiveSheet.Select
' Range("D16").Select
' pocet_aktiv = Range("U26").Value
 If Range("AC15").Value = 0 Then
 Zprava = MsgBox("Tento zam|fffd|stnanec NEBYL je|fffd|t|fffd| AKTIVOV|fffd|N*." & vbCrLf & vbCrLf _
 & "Vypl|fffd|te v nab|fffd|dce [|fffd|VOD] minim|fffd|ln|fffd|:" & vbCrLf & vbCrLf _
 & "1) p|fffd||fffd|jmen|fffd| a jm|fffd|no;" & vbCrLf _
 & "2) denn|fffd| pracovn|fffd| |fffd|vazek" & vbCrLf _
 & "3) pracovn|fffd| dobu od-do alespo|fffd| v 1 dni." & vbCrLf & vbCrLf _
 & "---------------------------------------------------------" & vbCrLf _
 & "*Aktivovan|fffd| zam|fffd|stnanec = zam|fffd|stnanec, kter|fffd| m|fffd| minim|fffd|ln|fffd| vypln|fffd|no" & vbCrLf _
 & "p|fffd||fffd|jmen|fffd| a jm|fffd|no, denn|fffd| pracovn|fffd| |fffd|vazek a pracovn|fffd| dobu od-do alespo|fffd| v 1 dni.", vbOKOnly + vbInformation, "Zpr|fffd|va o (ne)aktivaci zam|fffd|stnance")
' Range("D16").Select
 Exit Sub
 End If
 If Range("AH13").Value = 0 Then
 Zprava = MsgBox("V nab|fffd|dce |fffd|VOD nebylo nastaveno sledovan|fffd| obdob|fffd|. Vyberte rok a m|fffd|s|fffd|c a volbu opakujte.", vbOKOnly + vbExclamation, "Nevypln|fffd|n|fffd| sledovan|fffd| obdob|fffd|")
 Exit Sub
 End If
    dotaz = MsgBox("Opravdu chcete vyplnit u tohoto zam|fffd|stnance |fffd|asy p|fffd||fffd|chod|fffd|, odchod|fffd| a pravideln|fffd|ch p|fffd|est|fffd|vek?" & vbCrLf & vbCrLf _
    & "Touto operac|fffd| budou vymaz|fffd|na v|fffd|echna p|fffd||fffd|stupn|fffd| pole u tohoto zam|fffd|stnance a z|fffd|rove|fffd| budou v jednotliv|fffd|ch dnech vypln|fffd|ny |fffd|asy p|fffd||fffd|chodu, odchodu a doby p|fffd|est|fffd|vek.", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed vypln|fffd|n|fffd|m p|fffd||fffd|chod|fffd| a odchod|fffd|")
        If dotaz = vbNo Then
        Exit Sub
        End If
        
'Call Vymaz_nabidek_zamestnancu
Application.ScreenUpdating = False

Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    
Range("D16").Select
Prichod_PO = Range("BA16").Value
Odchod_PO = Range("BB16").Value
Prest_PO_1_Od = Range("BC16").Value
Prest_PO_1_Do = Range("BD16").Value
Prest_PO_2_Od = Range("BE16").Value
Prest_PO_2_Do = Range("BF16").Value

Prichod_UT = Range("BA17").Value
Odchod_UT = Range("BB17").Value
Prest_UT_1_Od = Range("BC17").Value
Prest_UT_1_Do = Range("BD17").Value
Prest_UT_2_Od = Range("BE17").Value
Prest_UT_2_Do = Range("BF17").Value

Prichod_ST = Range("BA18").Value
Odchod_ST = Range("BB18").Value
Prest_ST_1_Od = Range("BC18").Value
Prest_ST_1_Do = Range("BD18").Value
Prest_ST_2_Od = Range("BE18").Value
Prest_ST_2_Do = Range("BF18").Value

Prichod_CT = Range("BA19").Value
Odchod_CT = Range("BB19").Value
Prest_CT_1_Od = Range("BC19").Value
Prest_CT_1_Do = Range("BD19").Value
Prest_CT_2_Od = Range("BE19").Value
Prest_CT_2_Do = Range("BF19").Value

Prichod_PA = Range("BA20").Value
Odchod_PA = Range("BB20").Value
Prest_PA_1_Od = Range("BC20").Value
Prest_PA_1_Do = Range("BD20").Value
Prest_PA_2_Od = Range("BE20").Value
Prest_PA_2_Do = Range("BF20").Value

Prichod_SO = Range("BA21").Value
Odchod_SO = Range("BB21").Value
Prest_SO_1_Od = Range("BC21").Value
Prest_SO_1_Do = Range("BD21").Value
Prest_SO_2_Od = Range("BE21").Value
Prest_SO_2_Do = Range("BF21").Value

Prichod_NE = Range("BA22").Value
Odchod_NE = Range("BB22").Value
Prest_NE_1_Od = Range("BC22").Value
Prest_NE_1_Do = Range("BD22").Value
Prest_NE_2_Od = Range("BE22").Value
Prest_NE_2_Do = Range("BF22").Value

    For Pocet_Dnu = 1 To 31
        If ActiveCell.Offset(0, -2) <> "" Then
     Den = ActiveCell.Offset(0, 37).Value
       
    Select Case Den
    Case Is = 1
        ActiveCell.Value = Prichod_PO
        ActiveCell.Offset(0, 1).Value = Odchod_PO
            If (Prichod_PO <> "" Or Odchod_PO <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_PO_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_PO_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_PO_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_PO_2_Do
    Case Is = 2
        ActiveCell.Value = Prichod_UT
        ActiveCell.Offset(0, 1).Value = Odchod_UT
            If (Prichod_UT <> "" Or Odchod_UT <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_UT_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_UT_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_UT_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_UT_2_Do
    Case Is = 3
        ActiveCell.Value = Prichod_ST
        ActiveCell.Offset(0, 1).Value = Odchod_ST
            If (Prichod_ST <> "" Or Odchod_ST <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_ST_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_ST_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_ST_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_ST_2_Do
    Case Is = 4
        ActiveCell.Value = Prichod_CT
        ActiveCell.Offset(0, 1).Value = Odchod_CT
            If (Prichod_CT <> "" Or Odchod_CT <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_CT_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_CT_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_CT_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_CT_2_Do
    Case Is = 5
        ActiveCell.Value = Prichod_PA
        ActiveCell.Offset(0, 1).Value = Odchod_PA
            If (Prichod_PA <> "" Or Odchod_PA <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_PA_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_PA_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_PA_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_PA_2_Do
    Case Is = 6
        ActiveCell.Value = Prichod_SO
        ActiveCell.Offset(0, 1).Value = Odchod_SO
            If (Prichod_SO <> "" Or Odchod_SO <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_SO_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_SO_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_SO_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_SO_2_Do
    Case Is = 7
        ActiveCell.Value = Prichod_NE
        ActiveCell.Offset(0, 1).Value = Odchod_NE
            If (Prichod_NE <> "" Or Odchod_NE <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prest_NE_1_Od
        ActiveCell.Offset(0, 12).Value = Prest_NE_1_Do
        ActiveCell.Offset(0, 13).Value = Prest_NE_2_Od
        ActiveCell.Offset(0, 14).Value = Prest_NE_2_Do
    End Select
        ActiveCell.Offset(1, 0).Select
        Else
        ActiveCell.Offset(1, 0).Select
        End If
    Next Pocet_Dnu
    
Range("D16").Select
Application.ScreenUpdating = True

 Exit Sub
Chyba:

   Range("D16").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub zact()
Dim msg As String
Dim ValidEntry As Boolean
Dim UserEntry As String
Dim a As String, b As String, Nazev As String, IC As Currency, hl As String, hact As String
    
Sheets("|fffd|VOD").Select

hl = "exelman"
hact = "bar"

    msg = "Enter password"
    
    ValidEntry = False
    Do
        UserEntry = InputBox(msg)
        
    Application.ScreenUpdating = False
    
            If UserEntry = hact Then
                ValidEntry = True
                Sheets("|fffd|VOD").Select
                Nazev = Range("F12").Value
                IC = Range("D18").Value
                Sheets("|fffd|VOD").Unprotect Password:=hl
                Range("CB28").Value = Nazev
                Range("CB29").Value = IC
              
    Sheets("|fffd|VOD").Protect Password:=hl, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Application.ScreenUpdating = True
    Range("F14").Select
                If Range("BN522").Value = 0 Then
                a = MsgBox("Activation is ready.", vbOKOnly + vbInformation, "Activation")
                Else
                b = MsgBox("Activation isn|fffd|t ready.", vbOKOnly + vbCritical, "Activation")
                End If

                                             
            Else
                msg = "Enter adm password."
            End If
        
        If UserEntry = "" Then Exit Sub
    Loop Until ValidEntry
    
End Sub

Sub ZobrazLicenci()

Licence.Show
End Sub

Sub Nastaveni_Atributu()
Dim Nastaveni As String
Dim Prichod_PO As Variant, Odchod_PO As Variant, Prest_PO_1_Od As Variant, Prest_PO_1_Do As Variant, Prest_PO_2_Od As Variant, Prest_PO_2_Do As Variant
Dim Prichod_UT As Variant, Odchod_UT As Variant, Prest_UT_1_Od As Variant, Prest_UT_1_Do As Variant, Prest_UT_2_Od As Variant, Prest_UT_2_Do As Variant
Dim Prichod_ST As Variant, Odchod_ST As Variant, Prest_ST_1_Od As Variant, Prest_ST_1_Do As Variant, Prest_ST_2_Od As Variant, Prest_ST_2_Do As Variant
Dim Prichod_CT As Variant, Odchod_CT As Variant, Prest_CT_1_Od As Variant, Prest_CT_1_Do As Variant, Prest_CT_2_Od As Variant, Prest_CT_2_Do As Variant
Dim Prichod_PA As Variant, Odchod_PA As Variant, Prest_PA_1_Od As Variant, Prest_PA_1_Do As Variant, Prest_PA_2_Od As Variant, Prest_PA_2_Do As Variant
Dim Prichod_SO As Variant, Odchod_SO As Variant, Prest_SO_1_Od As Variant, Prest_SO_1_Do As Variant, Prest_SO_2_Od As Variant, Prest_SO_2_Do As Variant
Dim Prichod_NE As Variant, Odchod_NE As Variant, Prest_NE_1_Od As Variant, Prest_NE_1_Do As Variant, Prest_NE_2_Od As Variant, Prest_NE_2_Do As Variant
Dim Odecet As String, Dopocet_doby As String


On Error GoTo Chyba
ActiveSheet.Select


Prichod_PO = Range("AC16").Value
Odchod_PO = Range("AC17").Value
Prest_PO_1_Od = Range("AC18").Value
Prest_PO_1_Do = Range("AC19").Value
Prest_PO_2_Od = Range("AC20").Value
Prest_PO_2_Do = Range("AC21").Value

Prichod_UT = Range("AC22").Value
Odchod_UT = Range("AC23").Value
Prest_UT_1_Od = Range("AC24").Value
Prest_UT_1_Do = Range("AC25").Value
Prest_UT_2_Od = Range("AC26").Value
Prest_UT_2_Do = Range("AC27").Value

Prichod_ST = Range("AC28").Value
Odchod_ST = Range("AC29").Value
Prest_ST_1_Od = Range("AC30").Value
Prest_ST_1_Do = Range("AC31").Value
Prest_ST_2_Od = Range("AC32").Value
Prest_ST_2_Do = Range("AC33").Value

Prichod_CT = Range("AC34").Value
Odchod_CT = Range("AC35").Value
Prest_CT_1_Od = Range("AC36").Value
Prest_CT_1_Do = Range("AC37").Value
Prest_CT_2_Od = Range("AC38").Value
Prest_CT_2_Do = Range("AC39").Value

Prichod_PA = Range("AC40").Value
Odchod_PA = Range("AC41").Value
Prest_PA_1_Od = Range("AC42").Value
Prest_PA_1_Do = Range("AC43").Value
Prest_PA_2_Od = Range("AC44").Value
Prest_PA_2_Do = Range("AC45").Value

Prichod_SO = Range("AC46").Value
Odchod_SO = Range("AC47").Value
Prest_SO_1_Od = Range("AC48").Value
Prest_SO_1_Do = Range("AC49").Value
Prest_SO_2_Od = Range("AC50").Value
Prest_SO_2_Do = Range("AC51").Value

Prichod_NE = Range("AC52").Value
Odchod_NE = Range("AC53").Value
Prest_NE_1_Od = Range("AC54").Value
Prest_NE_1_Do = Range("AC55").Value
Prest_NE_2_Od = Range("AC56").Value
Prest_NE_2_Do = Range("AC57").Value

Odecet = Range("AC58").Value
Dopocet_doby = Range("AC60").Value

Nastaveni = MsgBox("DEN:     PRACOVN|fffd| DOBA:    P|fffd|EST|fffd|VKA1:    P|fffd|EST|fffd|VKA2:" & vbCrLf & vbCrLf & vbCrLf _
& "PO:          " & Prichod_PO & " - " & Odchod_PO & "       " & Prest_PO_1_Od & " - " & Prest_PO_1_Do & "     " & Prest_PO_2_Od & " - " & Prest_PO_2_Do & vbCrLf & vbCrLf _
& "UT:          " & Prichod_UT & " - " & Odchod_UT & "       " & Prest_UT_1_Od & " - " & Prest_UT_1_Do & "     " & Prest_UT_2_Od & " - " & Prest_UT_2_Do & vbCrLf & vbCrLf _
& "ST:          " & Prichod_ST & " - " & Odchod_ST & "       " & Prest_ST_1_Od & " - " & Prest_ST_1_Do & "     " & Prest_ST_2_Od & " - " & Prest_ST_2_Do & vbCrLf & vbCrLf _
& "CT:          " & Prichod_CT & " - " & Odchod_CT & "       " & Prest_CT_1_Od & " - " & Prest_CT_1_Do & "     " & Prest_CT_2_Od & " - " & Prest_CT_2_Do & vbCrLf & vbCrLf _
& "PA:          " & Prichod_PA & " - " & Odchod_PA & "       " & Prest_PA_1_Od & " - " & Prest_PA_1_Do & "     " & Prest_PA_2_Od & " - " & Prest_PA_2_Do & vbCrLf & vbCrLf _
& "SO:          " & Prichod_SO & " - " & Odchod_SO & "       " & Prest_SO_1_Od & " - " & Prest_SO_1_Do & "     " & Prest_SO_2_Od & " - " & Prest_SO_2_Do & vbCrLf & vbCrLf _
& "NE:          " & Prichod_NE & " - " & Odchod_NE & "       " & Prest_NE_1_Od & " - " & Prest_NE_1_Do & "     " & Prest_NE_2_Od & " - " & Prest_NE_2_Do & vbCrLf & vbCrLf _
& "Ode|fffd|et p|fffd|est|fffd|vek z doby [CELKEM] do [NORMAL]: " & Odecet & vbCrLf _
& "Automatick|fffd| dopo|fffd|et odprac. doby p|fffd|i p|fffd|ldenn|fffd|m m|fffd|du: " & Dopocet_doby & vbCrLf & vbCrLf & vbCrLf _
& "------------------" & vbCrLf _
& "Zm|fffd|na nastaven|fffd| atribut|fffd| se prov|fffd|d|fffd| v nab|fffd|dce [|fffd|VOD].", vbOKOnly + vbInformation, "AKTU|fffd|LN|fffd| NASTAVEN|fffd| ATRIBUT|fffd| HROMADN|fffd|HO P|fffd|EDVYPLN|fffd|N|fffd|")
Exit Sub
Chyba:

   Range("D16").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"

End Sub
Sub Export_do_PDF()

Dim Nazev_Protokolu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String


ActiveSheet.Select

Nazev_Protokolu = Range("AF14").Value


On Error GoTo Chyba


If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else


msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| formul|fffd||fffd| do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Protokolu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, From:=1, To:=1, OpenAfterPublish:=False
b = MsgBox("Doklad v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Protokolu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
MsgBox "P|fffd|i exportu* formul|fffd||fffd|e do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub
Sub Export_do_PDF_Souhrn()

Dim Nazev_Protokolu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String


ActiveSheet.Select

Nazev_Protokolu = Range("AH14").Value


On Error GoTo Chyba


If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else


msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| formul|fffd||fffd| do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Protokolu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, From:=1, To:=1, OpenAfterPublish:=False
b = MsgBox("Doklad v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Protokolu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
MsgBox "P|fffd|i exportu* formul|fffd||fffd|e do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub
Sub Tisk_formulare()
'
' Tisk_formulare_ Makro
'
'

'
On Error GoTo Chyba

    ActiveSheet.Select
    Application.ScreenUpdating = False
    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1
    Application.ScreenUpdating = True
    Exit Sub
Chyba:
  Range("D16").Select
  MsgBox "P|fffd|i tisku do|fffd|lo k chyb|fffd|. Jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in m|fffd||fffd|e b|fffd|t nep|fffd|ipojen|fffd| tisk|fffd|rna. Pou|fffd|ijte pros|fffd|m standardn|fffd|ch p|fffd||fffd|kaz|fffd| programu k vyti|fffd|t|fffd|n|fffd|.", vbOKOnly + vbCritical, "Chyba tisku"
  
End Sub

Sub Verze_Excelu()

On Error GoTo Chyba
MsgBox "Verze pr|fffd|v|fffd| spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Verze Excelu"
 Exit Sub
Chyba:
  
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"

End Sub
Sub Hromadny_export_do_PDF()

Dim Nazev_Protokolu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String
Dim Pocet_formularu As Integer, Souhrn As Integer


Sheets("|fffd|VOD").Select

Nazev_Protokolu = Range("CC56").Value
Pocet_formularu = Range("CC54").Value

On Error GoTo Chyba


If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else


msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| soubor do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
Application.ScreenUpdating = False
Application.StatusBar = "MOMENT, EXPORTUJI DATA DO SOUBORU..."

    Select Case Pocet_formularu
    Case Is = 1
    Sheets(Array("1")).Select
    Sheets("1").Activate
    Case Is = 2
    Sheets(Array("1", "2")).Select
    Sheets("1").Activate
    Case Is = 3
    Sheets(Array("1", "2", "3")).Select
    Sheets("1").Activate
    Case Is = 4
    Sheets(Array("1", "2", "3", "4")).Select
    Sheets("1").Activate
    Case Is = 5
    Sheets(Array("1", "2", "3", "4", "5")).Select
    Sheets("1").Activate
    Case Is = 6
    Sheets(Array("1", "2", "3", "4", "5", "6")).Select
    Sheets("1").Activate
    Case Is = 7
    Sheets(Array("1", "2", "3", "4", "5", "6", "7")).Select
    Sheets("1").Activate
    Case Is = 8
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8")).Select
    Sheets("1").Activate
    Case Is = 9
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9")).Select
    Sheets("1").Activate
    Case Is = 10
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10")).Select
    Sheets("1").Activate
    Case Is = 11
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11")).Select
    Sheets("1").Activate
    Case Is = 12
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12")).Select
    Sheets("1").Activate
    Case Is = 13
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13")).Select
    Sheets("1").Activate
    Case Is = 14
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14")).Select
    Sheets("1").Activate
    Case Is = 15
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15")).Select
    Sheets("1").Activate
    Case Is = 16
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16")).Select
    Sheets("1").Activate
     Case Is = 17
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17")).Select
    Sheets("1").Activate
     Case Is = 18
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18")).Select
    Sheets("1").Activate
     Case Is = 19
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19")).Select
    Sheets("1").Activate
     Case Is = 20
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")).Select
    Sheets("1").Activate
    Case Is = 21
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21")).Select
    Sheets("1").Activate
     Case Is = 22
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22")).Select
    Sheets("1").Activate
     Case Is = 23
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23")).Select
    Sheets("1").Activate
     Case Is = 24
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24")).Select
    Sheets("1").Activate
    Case Is = 25
    Sheets(Array("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25")).Select
    Sheets("1").Activate
    End Select

ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Protokolu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, OpenAfterPublish:=False
Application.StatusBar = False
Application.ScreenUpdating = True
Sheets("|fffd|VOD").Select
b = MsgBox("Soubor v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Protokolu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
Application.StatusBar = False
MsgBox "P|fffd|i exportu* formul|fffd||fffd|e do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) N|fffd|zev firmy v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub
Sub Tisk_dovolenky()
' Tisk_dovolenek

Dim Oblast_tisku As Integer

On Error GoTo Chyba
    Sheets("Tiskopisy").Select
    Oblast_tisku = Range("Z4").Value
    Application.ScreenUpdating = False
    Select Case Oblast_tisku
    Case Is = 1
    Application.GoTo Reference:="dovolenka1"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 2
    Application.GoTo Reference:="dovolenka2"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 3
    Application.GoTo Reference:="dovolenka12"
    Selection.PrintOut Copies:=1, Collate:=True
    End Select
    Application.ScreenUpdating = True
    Range("C4").Select
    Exit Sub
Chyba:
  Range("C4").Select
  MsgBox "P|fffd|i tisku do|fffd|lo k chyb|fffd|. Jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in m|fffd||fffd|e b|fffd|t nep|fffd|ipojen|fffd| tisk|fffd|rna. Pou|fffd|ijte pros|fffd|m standardn|fffd|ch p|fffd||fffd|kaz|fffd| programu k vyti|fffd|t|fffd|n|fffd|.", vbOKOnly + vbCritical, "Chyba tisku"
  
End Sub
Sub Tisk_zadosti_o_pracovni_volno()
' Tisk |fffd||fffd|dost|fffd| o pracovn|fffd| volno

Dim Oblast_tisku As Integer

On Error GoTo Chyba
    Sheets("Tiskopisy").Select
    Oblast_tisku = Range("Z61").Value
    Application.ScreenUpdating = False
    Select Case Oblast_tisku
    Case Is = 1
    Application.GoTo Reference:="zadost1"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 2
    Application.GoTo Reference:="zadost2"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 3
    Application.GoTo Reference:="zadost12"
    Selection.PrintOut Copies:=1, Collate:=True
    End Select
    Application.ScreenUpdating = True
    Range("C61").Select
    Exit Sub
Chyba:
  Range("C4").Select
  MsgBox "P|fffd|i tisku do|fffd|lo k chyb|fffd|. Jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in m|fffd||fffd|e b|fffd|t nep|fffd|ipojen|fffd| tisk|fffd|rna. Pou|fffd|ijte pros|fffd|m standardn|fffd|ch p|fffd||fffd|kaz|fffd| programu k vyti|fffd|t|fffd|n|fffd|.", vbOKOnly + vbCritical, "Chyba tisku"
  
End Sub
Sub Tisk_propustek()
' Tisk propustek

Dim Oblast_tisku As Integer

On Error GoTo Chyba
    Sheets("Tiskopisy").Select
    Oblast_tisku = Range("Z125").Value
    Application.ScreenUpdating = False
    Select Case Oblast_tisku
    Case Is = 1
    Application.GoTo Reference:="prospustka1"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 2
    Application.GoTo Reference:="propustka2"
    Selection.PrintOut Copies:=1, Collate:=True
    Case Is = 3
    Application.GoTo Reference:="propustka12"
    Selection.PrintOut Copies:=1, Collate:=True
    End Select
    Application.ScreenUpdating = True
    Range("C125").Select
    Exit Sub
Chyba:
  Range("C4").Select
  MsgBox "P|fffd|i tisku do|fffd|lo k chyb|fffd|. Jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in m|fffd||fffd|e b|fffd|t nep|fffd|ipojen|fffd| tisk|fffd|rna. Pou|fffd|ijte pros|fffd|m standardn|fffd|ch p|fffd||fffd|kaz|fffd| programu k vyti|fffd|t|fffd|n|fffd|.", vbOKOnly + vbCritical, "Chyba tisku"
  
End Sub
Sub Vyplneni_dovolenky()

Dim Volny_Tiskopis As Integer
Dim Dny_Dovolene As String
Dim Jmeno As String
Dim Pocet_Dnu As Variant
Dim Zprava1 As String, Zprava2 As String
Dim Dotaz1 As Variant
Dim Dnes As Date

On Error GoTo Chyba
ActiveSheet.Select

Pocet_Dnu = Range("I62").Value
Dny_Dovolene = Range("AX14").Value
Jmeno = Range("F7").Value
Volny_Tiskopis = Range("AW14").Value

If Range("AC15").Value = 0 Then
 Zprava1 = MsgBox("Tento zam|fffd|stnanec NEBYL je|fffd|t|fffd| AKTIVOV|fffd|N*." & vbCrLf & vbCrLf _
 & "Vypl|fffd|te v nab|fffd|dce [|fffd|VOD] minim|fffd|ln|fffd|:" & vbCrLf & vbCrLf _
 & "1) p|fffd||fffd|jmen|fffd| a jm|fffd|no;" & vbCrLf _
 & "2) denn|fffd| pracovn|fffd| |fffd|vazek" & vbCrLf _
 & "3) pracovn|fffd| dobu od-do alespo|fffd| v 1 dni." & vbCrLf & vbCrLf _
 & "---------------------------------------------------------" & vbCrLf _
 & "*Aktivovan|fffd| zam|fffd|stnanec = zam|fffd|stnanec, kter|fffd| m|fffd| minim|fffd|ln|fffd| vypln|fffd|no" & vbCrLf _
 & "p|fffd||fffd|jmen|fffd| a jm|fffd|no, denn|fffd| pracovn|fffd| |fffd|vazek a pracovn|fffd| dobu od-do alespo|fffd| v 1 dni.", vbOKOnly + vbInformation, "Zpr|fffd|va o (ne)aktivaci zam|fffd|stnance")
 Exit Sub
 End If

If Pocet_Dnu = 0 Then
 Zprava2 = MsgBox("U zam|fffd|stnance: " & Jmeno & " nebyly zad|fffd|ny |fffd||fffd|dn|fffd| dny dovolen|fffd|." & vbCrLf & vbCrLf _
 & "Nelze proto vyplnit dovolenku.", vbOKOnly + vbInformation, "Nevypln|fffd|n|fffd| dny dovolen|fffd|")
 Exit Sub
End If

If Volny_Tiskopis = 0 Then
 Dotaz1 = MsgBox("V obou tiskopisech dovolenky byly nalezeny zadan|fffd| |fffd|daje*." & vbCrLf & vbCrLf _
 & "Chcete p|fffd|esto vyplnit |fffd|daje v tiskopise 1?" & vbCrLf & vbCrLf _
 & "---------------------------------------------------------" & vbCrLf _
 & "*Testuje se obsah pol|fffd| [P|fffd||fffd|jmen|fffd| a jm|fffd|no] a [Vypln|fffd|n|fffd| dny].", vbYesNo + vbQuestion, "Dotaz na p|fffd|eps|fffd|n|fffd| |fffd|daj|fffd|")
' If Dotaz1 = vbNo Then
' Exit Sub
    If Dotaz1 = vbYes Then
 Application.ScreenUpdating = False
 Sheets("Tiskopisy").Select
 Dnes = Range("Z10").Value
 Range("C4").Value = Jmeno
 Range("G10").Value = Dny_Dovolene
 Range("K11").Value = Pocet_Dnu
 Range("F22").Value = Pocet_Dnu
 Range("D15").Value = Dnes
 Range("C4").Select
 Application.ScreenUpdating = True
 Else
 Exit Sub
    End If
 End If
 
Application.ScreenUpdating = False
Select Case Volny_Tiskopis
    Case Is = 1
 Sheets("Tiskopisy").Select
 Dnes = Range("Z10").Value
 Range("C4").Value = Jmeno
 Range("G10").Value = Dny_Dovolene
 Range("K11").Value = Pocet_Dnu
 Range("F22").Value = Pocet_Dnu
 Range("D15").Value = Dnes
    Case Is = 2
Sheets("Tiskopisy").Select
Dnes = Range("Z10").Value
 Range("C33").Value = Jmeno
 Range("G39").Value = Dny_Dovolene
 Range("K40").Value = Pocet_Dnu
 Range("F51").Value = Pocet_Dnu
 Range("D44").Value = Dnes
End Select
Range("C4").Select
Application.ScreenUpdating = False

Exit Sub
Chyba:

   Range("D16").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"

End Sub
Sub Vymaz_dovolenky_1()
'
' Vymaz_nabidek_zamestnance Makro

    
    On Error GoTo Chyba
    Sheets("Tiskopisy").Select
    Application.ScreenUpdating = False
    Range("C4:G4,G10:J11,D15:E15,D17:E17,F19:G19,F22,F24:G24,K11").Select
    Range("K11").Activate
    Selection.ClearContents
    Range("C4").Select
        
    Application.ScreenUpdating = True
    
    Exit Sub
Chyba:
'Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub Vymaz_dovolenky_2()
'
' Vymaz_nabidek_zamestnance Makro

    
    On Error GoTo Chyba
    Sheets("Tiskopisy").Select
    Application.ScreenUpdating = False
   Range("C33:G33,G39:J40,D44:E44,D46:E46,F48:G48,F51,F53:G53,K40").Select
    Range("K40").Activate
    Selection.ClearContents
    Range("C33").Select
    Application.ScreenUpdating = True
    
    Exit Sub
Chyba:
'Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub Vymaz_dovolenek_1_2()
'
' Vymaz_nabidek_zamestnance Makro

    
    On Error GoTo Chyba
    Application.ScreenUpdating = False
    Sheets("Tiskopisy").Select
'    Application.ScreenUpdating = False
   Call Vymaz_dovolenky_2
   Call Vymaz_dovolenky_1
    Application.ScreenUpdating = True
    
    Exit Sub
Chyba:
'Sheets("|fffd|VOD").Select
   Range("A1").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Sub Export_do_PDF_dovolenky()

Dim Nazev_Tiskopisu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String


Sheets("Tiskopisy").Select

Nazev_Tiskopisu = Range("Z8").Value


On Error GoTo Chyba


If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else


msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| tiskopis do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
'Application.Goto Reference:="dovolenka1"
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Tiskopisu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, From:=1, To:=1, OpenAfterPublish:=False
ActiveSheet.DisplayPageBreaks = False
b = MsgBox("Doklad v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Tiskopisu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
MsgBox "P|fffd|i exportu* tiskopisu do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub
Sub Export_do_PDF_zadost_o_pracovni_volno()

Dim Nazev_Tiskopisu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String


Sheets("Tiskopisy").Select
Nazev_Tiskopisu = Range("Z65").Value

On Error GoTo Chyba

If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else

msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| tiskopis do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Tiskopisu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, From:=2, To:=2, OpenAfterPublish:=False

b = MsgBox("Doklad v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Tiskopisu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
MsgBox "P|fffd|i exportu* tiskopisu do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub

Sub Export_do_PDF_propustka()

Dim Nazev_Tiskopisu As Variant
Dim Cesta1 As Variant, Cesta2 As Variant
Dim a As String, b As String, c As String, msg As String, d As String


Sheets("Tiskopisy").Select
Nazev_Tiskopisu = Range("Z129").Value

On Error GoTo Chyba

If Val(Application.Version) < 12 Then
d = MsgBox("Automatick|fffd| export doklad|fffd| do PDF form|fffd|tu je mo|fffd|n|fffd| pouze u verze MS Excel 12 [2007] a vy|fffd||fffd||fffd|." _
& vbCrLf & vbCrLf & "Tato [pr|fffd|v|fffd| pou|fffd||fffd|van|fffd|] verze MS Excel je: " & Val(Application.Version) & ".", vbOKOnly + vbInformation, "Star|fffd||fffd| verze MS Excel")
Exit Sub
Else

msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it vyexportovan|fffd| tiskopis do PDF form|fffd|tu."
    Cesta1 = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta1 = "" Then Exit Sub
    If Len(Cesta1) = 3 Then
        Cesta1 = Replace(Cesta1, "\", "")
    End If
ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Cesta1 & "\" & Nazev_Tiskopisu _
        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
        :=False, From:=3, To:=3, OpenAfterPublish:=False

b = MsgBox("Doklad v PDF form|fffd|tu byl vyexportov|fffd|n do adres|fffd||fffd|e:" _
& vbCrLf & Cesta1 & vbCrLf & "pod n|fffd|zvem: " & Nazev_Tiskopisu & ".pdf.", vbOKOnly + vbInformation, "Um|fffd|st|fffd|n|fffd| a n|fffd|zev PDF souboru")
    End If
                            
Exit Sub
Chyba:
MsgBox "P|fffd|i exportu* tiskopisu do PDF form|fffd|tu do|fffd|lo k probl|fffd|mu." & vbCrLf & vbCrLf _
& "Mo|fffd|n|fffd| p|fffd||fffd||fffd|iny probl|fffd|mu:" & vbCrLf & vbCrLf _
& "1) Nemo|fffd|nost z|fffd|pisu do adres|fffd||fffd|e, vybran|fffd|ho pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "2) P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce [|fffd|VOD] obsahuje nepovolen|fffd| znak [\/:*?<>|nebo uvozovka]" & vbCrLf _
& "    pro ulo|fffd|en|fffd| formul|fffd||fffd|e do PDF form|fffd|tu." & vbCrLf _
& "3) K Excelu nen|fffd| instalov|fffd|n dopln|fffd|k k mo|fffd|n|fffd|mu exportu dokument|fffd| do PDF form|fffd|tu." & vbCrLf & vbCrLf _
& " * Automatick|fffd| export do PDF form|fffd|tu je pln|fffd| funk|fffd|n|fffd| pouze ve verzi Excelu 12 (2007) a vy|fffd||fffd||fffd|;" & vbCrLf _
& "Verze spu|fffd|t|fffd|n|fffd|ho Excelu je: " & Val(Application.Version) & ".", vbOKOnly + vbCritical, "Export formul|fffd||fffd|e do PDF form|fffd|tu"

End Sub
Sub EXPORT_DAT()
'
' Export zadan|fffd|ch dat Makro
' Makro zaznamenan|fffd| 31.7.2016, ing Roman |fffd|ev|fffd||fffd|k
'
    Dim EXPORT_ As Workbook
    Dim hexpoimpo As String
    Dim msg, a As String
    Dim Cesta As String, IC As String
    Dim Cas As String
    Dim Cas2 As String
    Dim b As Variant
    Dim Pocet_Zaznamu As Integer
    Dim Prijmeni_a_jmeno As String, Mesic As String
    Dim Rok As Integer
    Dim Zdroj As Variant, Export As Variant
    
    
    On Error GoTo Chyba
       
    Range("K70").Select
    hexpoimpo = "napalm"
    Prijmeni_a_jmeno = Range("F7").Value
    Mesic = Range("E5").Value
    Rok = Range("H5").Value
    Zdroj = ActiveWorkbook.Name
    msg = "Vyberte pros|fffd|m adres|fffd||fffd|, kam se m|fffd| ulo|fffd|it exportn|fffd| soubor."
    Cesta = GetDirectory(msg)
    'Odstran|fffd|n|fffd| lom|fffd|tka v p|fffd||fffd|pad|fffd|, |fffd|e se jde do Rootu
    If Cesta = "" Then Exit Sub
    If Len(Cesta) = 3 Then
        Cesta = Replace(Cesta, "\", "")
    End If
    'Cas = Replace(Now, ":", "-")
    'Cas2 = Now
    Application.StatusBar = "MOMENT|fffd|K, PROB|fffd|HA EXPORT DAT..."
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    
    Set EXPORT_ = Workbooks.Add
       
    With EXPORT_
        '.Sheets(1).Protect Password:=hl, DrawingObjects:=True, Contents:=True, Scenarios:=True
        '.Protect Password:=hs, Structure:=True, Workbooks:=False
        .SaveAs Filename:=Cesta & "\EXPORT_" & Prijmeni_a_jmeno & "_" & Mesic & "-" & Rok & ".xls", FileFormat:=xlWorkbookNormal, Password:=hexpoimpo
        .Close SaveChanges:=False
    End With
    
    Workbooks.Open Filename:=Cesta & "\EXPORT_" & Prijmeni_a_jmeno & "_" & Mesic & "-" & Rok & ".xls", Password:=hexpoimpo
    Export = ActiveWorkbook.Name
    Range("Q1").Value = "RRNPD"
    Columns("Q:Q").Select
    Selection.EntireColumn.Hidden = True
    Range("A1").Select
    
    Workbooks(Zdroj).Activate
    Range("D16:E46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Workbooks(Zdroj).Activate
    Range("H16:H46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("C1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("J16:K46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("D1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("L16:M46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("F1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("G1").Select
    Workbooks(Zdroj).Activate
    Range("O16:R46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("K1").Select
    Workbooks(Zdroj).Activate
    Range("W16:X46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("M1").Select
    Workbooks(Zdroj).Activate
    Range("Y16:Z46").Select
    Selection.Copy
    Workbooks(Export).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("G50").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("A33").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A34").Select
    Workbooks(Zdroj).Activate
    Range("G68").Select
    Selection.Copy
    Workbooks(Export).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("G70").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("A35").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("L60").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("B33").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Workbooks(Zdroj).Activate
    Range("L62").Select
    Selection.Copy
    Workbooks(Export).Activate
    Range("B34").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("A1").Select
    Application.CutCopyMode = False
    Range("E33").Value = Prijmeni_a_jmeno
    Range("E34").Value = Rok
    Range("E35").Value = Mesic
        
    ActiveWorkbook.Save
    ActiveWorkbook.Close
    Application.StatusBar = False
    Workbooks(Zdroj).Activate
    Range("D16").Select
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
   
    MsgBox ("Exportn|fffd| soubor byl ulo|fffd|en do: " & Cesta & "\EXPORT_" & Prijmeni_a_jmeno & "_" & Mesic & "-" & Rok & ".xls."), vbOKOnly + vbInformation, "INFORMACE O UM|fffd|ST|fffd|N|fffd| A N|fffd|ZVU EXPORTN|fffd|HO SOUBORU"
    Exit Sub
Chyba:
    EXPORT_.Close SaveChanges:=False
    Application.StatusBar = False
    Application.ScreenUpdating = True
    MsgBox "Do|fffd|lo k chyb|fffd| p|fffd|i exportu dat, jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in je chyb|fffd|j|fffd|c|fffd| datov|fffd| m|fffd|dium nebo nepovolen|fffd| z|fffd|pis na V|fffd|mi zvolen|fffd| datov|fffd| m|fffd|dium." & vbCrLf & vbCrLf _
    & "Dal|fffd||fffd| p|fffd||fffd||fffd|inou m|fffd||fffd|e b|fffd|t nepovolen|fffd| znak [<, >, : ,/ ,\ ,| ,? , *]v poli P|fffd||fffd|jmen|fffd| a jm|fffd|no v nab|fffd|dce |fffd|VOD." & vbCrLf & vbCrLf _
    & "Zkontrolujte tyto skute|fffd|nosti a export opakujte.", vbOKOnly + vbExclamation, "Chyba p|fffd|i exportu"
    
End Sub
Sub IMPORT_DAT()
' Import_dat

Dim Cesta As Variant
Dim Aplikace As Variant, Zdroj As Variant, Heslo As Variant
Dim dotaz, a, c, d As Long
Dim Prijmeni_a_jmeno As String, Mesic As String, Typ_Aplikace As String
Dim i As Integer
Dim Rok As Integer
Dim Row As Variant
Dim b As Object
Dim hexpoimpo As String

On Error GoTo Chyba

Aplikace = ActiveWorkbook.Name
hexpoimpo = "napalm"
Cesta = Application.GetOpenFilename("Soubory Microsoft Excel (*.xls),*.*", _
Title:="Vyberte pros|fffd|m exportn|fffd| soubor, ze kter|fffd|ho se maj|fffd| importovat data do formul|fffd||fffd|e")
    If Cesta = False Then
Exit Sub
    End If
    If (Left(NazevSouboru(Cesta), 7) <> "EXPORT_") Then
a = MsgBox("Nebyl vybr|fffd|n soubor, ur|fffd|en|fffd| k importu dat do formul|fffd||fffd|e!" _
& vbCrLf & vbCrLf & vbCrLf & "Maska n|fffd|zvu souboru mus|fffd| b|fffd|t :" & vbCrLf & vbCrLf & "<EXPORT_P|fffd||fffd|jmen|fffd| a jm|fffd|no_m|fffd|s|fffd|c-rok>", vbOKOnly + vbCritical, "NEPLATN|fffd| N|fffd|ZEV VYBRAN|fffd|HO SOUBORU")
    Exit Sub
    End If
    
Application.ScreenUpdating = False
Workbooks.Open Filename:=Cesta, Password:=hexpoimpo
Sheets(1).Select
If (ActiveWorkbook.Sheets(1).Range("Q1").Value <> "RRNPD" And ActiveWorkbook.Sheets(1).Range("Q1").Value <> "RRPPD") Then
ActiveWorkbook.Close
Workbooks(Aplikace).Activate
c = MsgBox("Byla poru|fffd|ena struktura exportn|fffd|ho souboru." & vbCrLf & vbCrLf & "Import dat nem|fffd||fffd|e b|fffd|t proveden!", vbOKOnly + vbCritical, "PORU|fffd|EN|fffd| EXPORTN|fffd| SOUBOR")
Exit Sub

Else

Prijmeni_a_jmeno = Range("E33").Value
Mesic = Range("E35").Value
Rok = Range("E34").Value
Typ_Aplikace = Range("Q1").Value
ActiveWorkbook.Close
Workbooks(Aplikace).Activate
dotaz = MsgBox("Vybral(a) jste " & Cesta & "." & vbCrLf & vbCrLf _
& "B|fffd|hem importu dat do formul|fffd||fffd|e dojde k v|fffd|mazu dat ze v|fffd|ech p|fffd||fffd|stupn|fffd|ch pol|fffd|" _
& " a budou nahrazena daty z vybran|fffd|ho exportn|fffd|ho souboru s t|fffd|mito |fffd|daji:" & vbCrLf & vbCrLf _
& "P|fffd||fffd|jmen|fffd| a jm|fffd|no: " & Prijmeni_a_jmeno & ";" & vbCrLf _
& "M|fffd|s|fffd|c: " & Mesic & ";" & vbCrLf _
& "Rok: " & Rok & ";" & vbCrLf _
& "Typ zdrojov|fffd| aplikace exportn|fffd|ho souboru: " & Typ_Aplikace & "." & vbCrLf & vbCrLf _
& "M|fffd|m pokra|fffd|ovat v importu dat?", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed importem dat")
If dotaz <> vbYes Then Exit Sub

Application.StatusBar = "MOMENT|fffd|K, IMPORTUJI DATA DO FORMUL|fffd||fffd|E..."
Range("D16:E46,J16:L46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    Range("D16").Select

Workbooks.Open Filename:=Cesta, Password:=hexpoimpo
Zdroj = ActiveWorkbook.Name
'Od-do
 Range("A1:B31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
 Range("H16").Select
Workbooks(Zdroj).Activate
'P|fffd|es|fffd|asy
Range("C1:C31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("J16").Select
Workbooks(Zdroj).Activate
'Pohotovost
Range("D1:D31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("K16").Select
Workbooks(Zdroj).Activate
'Status
Range("E1:E31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("L16").Select
Workbooks(Zdroj).Activate
'Pozn|fffd|mka 1
Range("F1:F31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("O16").Select
Workbooks(Zdroj).Activate
'P|fffd|est|fffd|vka 1-2 od-do
Range("G1:J31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("W16").Select
Workbooks(Zdroj).Activate
'Pohotovost od-do
Range("K1:L31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("Y16").Select
Workbooks(Zdroj).Activate
'Pozn|fffd|mka 2
Range("M1:M31").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("G50").Select
Workbooks(Zdroj).Activate
'Souhrn prestavek
Range("A33").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("G68").Select
Workbooks(Zdroj).Activate
'Priplatek 1
Range("A34").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("G70").Select
Workbooks(Zdroj).Activate
'Priplatek 2
Range("A35").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("L60").Select
Workbooks(Zdroj).Activate
'Cena stravenky
Range("B33").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("L62").Select
Workbooks(Zdroj).Activate
'Pocet stravenek
Range("B34").Select
    Selection.Copy
    Workbooks(Aplikace).Activate
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
Range("D16").Select
Workbooks(Zdroj).Activate
ActiveWorkbook.Close
Application.StatusBar = False
Workbooks(Aplikace).Activate
End If
Exit Sub
Chyba:
    Workbooks(Zdroj).Close SaveChanges:=False
    Application.StatusBar = False
    Application.ScreenUpdating = True
    MsgBox "Do|fffd|lo k chyb|fffd| p|fffd|i importu dat, jedna z mo|fffd|n|fffd|ch p|fffd||fffd||fffd|in je po|fffd|kozen|fffd| exportn|fffd| soubor.", vbOKOnly + vbExclamation, "Chyba p|fffd|i importu dat"

End Sub

Sub ZOBRAZ_FORMULAR()

On Error GoTo Chyba
Formular.Show
Exit Sub
Chyba:
  MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|", vbOKOnly + vbCritical, "Chyba aplikace"

End Sub
Sub Vyplneni_casu_prichodu_a_odchodu_jednotl_sm()

Dim dotaz As Variant, Zprava As Variant, Zprava2 As String, Zprava3 As String
Dim Pocet_Dnu As Integer, pocet_aktiv As Integer
Dim Den As Integer
Dim Smena_1 As Variant, Smena_2 As Variant, Smena_3 As Variant, Smena_4 As Variant, Smena_5 As Variant
Dim Smena_1_Prichod As Variant, Smena_1_Odchod As Variant, Prestavka_1_Smena_1_Od As Variant, Prestavka_1_Smena_1_Do As Variant, Prestavka_2_Smena_1_Od As Variant, Prestavka_2_Smena_1_Do As Variant
Dim Smena_2_Prichod As Variant, Smena_2_Odchod As Variant, Prestavka_1_Smena_2_Od As Variant, Prestavka_1_Smena_2_Do As Variant, Prestavka_2_Smena_2_Od As Variant, Prestavka_2_Smena_2_Do As Variant
Dim Smena_3_Prichod As Variant, Smena_3_Odchod As Variant, Prestavka_1_Smena_3_Od As Variant, Prestavka_1_Smena_3_Do As Variant, Prestavka_2_Smena_3_Od As Variant, Prestavka_2_Smena_3_Do As Variant
Dim Smena_4_Prichod As Variant, Smena_4_Odchod As Variant, Prestavka_1_Smena_4_Od As Variant, Prestavka_1_Smena_4_Do As Variant, Prestavka_2_Smena_4_Od As Variant, Prestavka_2_Smena_4_Do As Variant
Dim Smena_5_Prichod As Variant, Smena_5_Odchod As Variant, Prestavka_1_Smena_5_Od As Variant, Prestavka_1_Smena_5_Do As Variant, Prestavka_2_Smena_5_Od As Variant, Prestavka_2_Smena_5_Do As Variant
Dim Smena As Variant

 On Error GoTo Chyba
 
 ActiveSheet.Select
' Range("D16").Select
' pocet_aktiv = Range("U26").Value
' If Range("AC15").Value = 0 Then
' Zprava = MsgBox("Tento zam|fffd|stnanec NEBYL je|fffd|t|fffd| AKTIVOV|fffd|N*." & vbCrLf & vbCrLf _
' & "Vypl|fffd|te v nab|fffd|dce [|fffd|VOD] minim|fffd|ln|fffd|:" & vbCrLf & vbCrLf _
' & "1) p|fffd||fffd|jmen|fffd| a jm|fffd|no;" & vbCrLf _
' & "2) denn|fffd| pracovn|fffd| |fffd|vazek" & vbCrLf _
' & "3) pracovn|fffd| dobu od-do alespo|fffd| v 1 dni." & vbCrLf & vbCrLf _
' & "---------------------------------------------------------" & vbCrLf _
' & "*Aktivovan|fffd| zam|fffd|stnanec = zam|fffd|stnanec, kter|fffd| m|fffd| minim|fffd|ln|fffd| vypln|fffd|no" & vbCrLf _
' & "p|fffd||fffd|jmen|fffd| a jm|fffd|no, denn|fffd| pracovn|fffd| |fffd|vazek a pracovn|fffd| dobu od-do alespo|fffd| v 1 dni.", vbOKOnly + vbInformation, "Zpr|fffd|va o (ne)aktivaci zam|fffd|stnance")
'' Range("D16").Select
' Exit Sub
' End If
 If Range("AH13").Value = 0 Then
 Zprava = MsgBox("V nab|fffd|dce |fffd|VOD nebylo nastaveno sledovan|fffd| obdob|fffd|. Vyberte rok a m|fffd|s|fffd|c a volbu opakujte.", vbOKOnly + vbExclamation, "Nevypln|fffd|n|fffd| sledovan|fffd| obdob|fffd|")
 Exit Sub
 End If
    dotaz = MsgBox("Opravdu chcete vyplnit u tohoto zam|fffd|stnance |fffd|asy p|fffd||fffd|chod|fffd|, odchod|fffd| a pravideln|fffd|ch p|fffd|est|fffd|vek?" & vbCrLf & vbCrLf _
    & "Touto operac|fffd| budou vymaz|fffd|na v|fffd|echna p|fffd||fffd|stupn|fffd| pole u tohoto zam|fffd|stnance - vyjma pole [Sm|fffd|na]- a z|fffd|rove|fffd| budou v jednotliv|fffd|ch dnech vypln|fffd|ny |fffd|asy p|fffd||fffd|chodu, odchodu a doby p|fffd|est|fffd|vek dle jednotliv|fffd|ch sm|fffd|n.", vbYesNo + vbQuestion, "Posledn|fffd| dotaz p|fffd|ed vypln|fffd|n|fffd|m p|fffd||fffd|chod|fffd| a odchod|fffd|")
        If dotaz = vbNo Then
        Exit Sub
        End If
        
'Call Vymaz_nabidek_zamestnancu
Application.ScreenUpdating = False

Range("D16:E46,J16:K46,H16:H46,O16:R46,W16:Y46,G50,G68,G70,L60,L62").Select
    Range("L62").Activate
    Selection.ClearContents
    
Range("D16").Select
Smena_1 = Sheets("|fffd|VOD").Range("O56").Value
Smena_2 = Sheets("|fffd|VOD").Range("O57").Value
Smena_3 = Sheets("|fffd|VOD").Range("O58").Value
Smena_4 = Sheets("|fffd|VOD").Range("O59").Value
Smena_5 = Sheets("|fffd|VOD").Range("O60").Value

Smena_1_Prichod = Sheets("|fffd|VOD").Range("R56").Value
Smena_1_Odchod = Sheets("|fffd|VOD").Range("S56").Value
Prestavka_1_Smena_1_Od = Sheets("|fffd|VOD").Range("T56").Value
Prestavka_1_Smena_1_Do = Sheets("|fffd|VOD").Range("U56").Value
Prestavka_2_Smena_1_Od = Sheets("|fffd|VOD").Range("V56").Value
Prestavka_2_Smena_1_Do = Sheets("|fffd|VOD").Range("W56").Value

Smena_2_Prichod = Sheets("|fffd|VOD").Range("R57").Value
Smena_2_Odchod = Sheets("|fffd|VOD").Range("S57").Value
Prestavka_1_Smena_2_Od = Sheets("|fffd|VOD").Range("T57").Value
Prestavka_1_Smena_2_Do = Sheets("|fffd|VOD").Range("U57").Value
Prestavka_2_Smena_2_Od = Sheets("|fffd|VOD").Range("V57").Value
Prestavka_2_Smena_2_Do = Sheets("|fffd|VOD").Range("W57").Value

Smena_3_Prichod = Sheets("|fffd|VOD").Range("R58").Value
Smena_3_Odchod = Sheets("|fffd|VOD").Range("S58").Value
Prestavka_1_Smena_3_Od = Sheets("|fffd|VOD").Range("T58").Value
Prestavka_1_Smena_3_Do = Sheets("|fffd|VOD").Range("U58").Value
Prestavka_2_Smena_3_Od = Sheets("|fffd|VOD").Range("V58").Value
Prestavka_2_Smena_3_Do = Sheets("|fffd|VOD").Range("W58").Value

Smena_4_Prichod = Sheets("|fffd|VOD").Range("R59").Value
Smena_4_Odchod = Sheets("|fffd|VOD").Range("S59").Value
Prestavka_1_Smena_4_Od = Sheets("|fffd|VOD").Range("T59").Value
Prestavka_1_Smena_4_Do = Sheets("|fffd|VOD").Range("U59").Value
Prestavka_2_Smena_4_Od = Sheets("|fffd|VOD").Range("V59").Value
Prestavka_2_Smena_4_Do = Sheets("|fffd|VOD").Range("W59").Value

Smena_5_Prichod = Sheets("|fffd|VOD").Range("R60").Value
Smena_5_Odchod = Sheets("|fffd|VOD").Range("S60").Value
Prestavka_1_Smena_5_Od = Sheets("|fffd|VOD").Range("T60").Value
Prestavka_1_Smena_5_Do = Sheets("|fffd|VOD").Range("U60").Value
Prestavka_2_Smena_5_Od = Sheets("|fffd|VOD").Range("V60").Value
Prestavka_2_Smena_5_Do = Sheets("|fffd|VOD").Range("W60").Value


    For Pocet_Dnu = 1 To 31
        If ActiveCell.Offset(0, -2) <> "" Then
     Smena = ActiveCell.Offset(0, 8).Value
       
    Select Case Smena
    Case Is = Smena_1
        ActiveCell.Value = Smena_1_Prichod
        ActiveCell.Offset(0, 1).Value = Smena_1_Odchod
            If (Smena_1_Prichod <> "" And Smena_1_Odchod <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prestavka_1_Smena_1_Od
        ActiveCell.Offset(0, 12).Value = Prestavka_1_Smena_1_Do
        ActiveCell.Offset(0, 13).Value = Prestavka_2_Smena_1_Od
        ActiveCell.Offset(0, 14).Value = Prestavka_2_Smena_1_Do
    Case Is = Smena_2
     ActiveCell.Value = Smena_2_Prichod
        ActiveCell.Offset(0, 1).Value = Smena_2_Odchod
            If (Smena_2_Prichod <> "" And Smena_2_Odchod <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prestavka_1_Smena_2_Od
        ActiveCell.Offset(0, 12).Value = Prestavka_1_Smena_2_Do
        ActiveCell.Offset(0, 13).Value = Prestavka_2_Smena_2_Od
        ActiveCell.Offset(0, 14).Value = Prestavka_2_Smena_2_Do
    Case Is = Smena_3
     ActiveCell.Value = Smena_3_Prichod
        ActiveCell.Offset(0, 1).Value = Smena_3_Odchod
            If (Smena_3_Prichod <> "" And Smena_3_Odchod <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prestavka_1_Smena_3_Od
        ActiveCell.Offset(0, 12).Value = Prestavka_1_Smena_3_Do
        ActiveCell.Offset(0, 13).Value = Prestavka_2_Smena_3_Od
        ActiveCell.Offset(0, 14).Value = Prestavka_2_Smena_3_Do
    Case Is = Smena_4
     ActiveCell.Value = Smena_4_Prichod
        ActiveCell.Offset(0, 1).Value = Smena_4_Odchod
            If (Smena_4_Prichod <> "" And Smena_4_Odchod <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prestavka_1_Smena_4_Od
        ActiveCell.Offset(0, 12).Value = Prestavka_1_Smena_4_Do
        ActiveCell.Offset(0, 13).Value = Prestavka_2_Smena_4_Od
        ActiveCell.Offset(0, 14).Value = Prestavka_2_Smena_4_Do
    Case Is = Smena_5
     ActiveCell.Value = Smena_5_Prichod
        ActiveCell.Offset(0, 1).Value = Smena_5_Odchod
            If (Smena_5_Prichod <> "" And Smena_5_Odchod <> "") Then
        ActiveCell.Offset(0, 7).Value = "Odpracov|fffd|no"
            End If
        ActiveCell.Offset(0, 11).Value = Prestavka_1_Smena_5_Od
        ActiveCell.Offset(0, 12).Value = Prestavka_1_Smena_5_Do
        ActiveCell.Offset(0, 13).Value = Prestavka_2_Smena_5_Od
        ActiveCell.Offset(0, 14).Value = Prestavka_2_Smena_5_Do
    End Select
        ActiveCell.Offset(1, 0).Select
        Else
        ActiveCell.Offset(1, 0).Select
        End If
    Next Pocet_Dnu
    
Range("D16").Select
Application.ScreenUpdating = True

 Exit Sub
Chyba:

   Range("D16").Select
   MsgBox "P|fffd|i b|fffd|hu aplikace do|fffd|lo k chyb|fffd|.", vbOKOnly + vbCritical, "Chyba aplikace"
End Sub
Attribute VB_Name = "Module2"
Sub zam()
Attribute zam.VB_ProcData.VB_Invoke_Func = "w\n14"
'
' zam Makro
'
' Kl|fffd|vesov|fffd| zkratka: Ctrl+w
'
    ActiveWindow.SmallScroll Down:=-27
    Range("D16").Select
    ActiveWindow.DisplayGridlines = False
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Workbook_Open()
On Error GoTo konec
ActiveWindow.WindowState = xlMaximized
Sheets("|fffd|VOD").Select
If Range("CB34").Value <> 0 Then
'MsgBox "Lituji, ale tato DEMO verze aplikace nen|fffd| ur|fffd|ena k pln|fffd|mu vyu|fffd|it|fffd|." & vbCrLf & vbCrLf & "Objedn|fffd|n|fffd| pln|fffd| verze m|fffd||fffd|ete prov|fffd|st prost|fffd|ednictv|fffd|m" & vbCrLf & "www.sevrom.cz     nebo" & vbCrLf & "e-mailu: sevrom@email.cz.", vbOKOnly + vbCritical, "Neplatn|fffd| licence"
MsgBox "Lituji, ale do|fffd|lo k poru|fffd|en|fffd| licen|fffd|n|fffd|ch podm|fffd|nek." & vbCrLf & vbCrLf & "Objedn|fffd|n|fffd| pln|fffd| verze m|fffd||fffd|ete prov|fffd|st prost|fffd|ednictv|fffd|m" & vbCrLf & "www.sevrom.cz     nebo" & vbCrLf & "e-mailu: sevrom@email.cz.", vbOKOnly + vbCritical, "Neplatn|fffd| licence"
ActiveWorkbook.Saved = True
ActiveWorkbook.Close
Else
Range("D28").Select
    End If
Exit Sub
konec:
End Sub


INQUEST-PP=macro
