Attribute VB_Name = "Modul_Aktualisieren"
Sub Aktualisieren()
Attribute Aktualisieren.VB_ProcData.VB_Invoke_Func = " \n14"

    ActiveSheet.PivotTables("Piv_FT").PivotCache.Refresh
    
End Sub
Attribute VB_Name = "Modul_Ausgaben"
Sub Ausgaben_Filter_l|fffd|schen()

    On Error Resume Next
    Range("Ausgaben_Start").AutoFilter
    Range("Ausgaben_Start").AutoFilter

End Sub
Sub Ausgaben_Fehler_filtern()

Call Ausgaben_Filter_l|fffd|schen

If Range("Ausgaben_Fehler").Value = 0 Then

    MsgBox ("Keine Fehler gefunden.")

Else

    Tabelle5.ListObjects("Tab_Ausgaben").Range.AutoFilter Field:=1, Criteria1:=">0", Operator:=xlAnd
    
End If

End Sub

Sub Ausgaben_FORMELN()

On Error GoTo Fehler

    Range("Tab_Ausgaben[Weiterverrechnung EUR Brutto]").FormulaR1C1 = "=[@[Betrag EUR excl. VAT]]*1.2"
    Range("Tab_Ausgaben[Controlling: Weiterverrechnung im Zeitraum]").FormulaR1C1 = "=IF(AND(LEFT([@[Bezeichnung:]],50)<>""Leistungen f|fffd|r die Betreuung der Vernetzungsstelle"",[@[Zahlungs-ausgang am:]]>=VON,[@[Zahlungs-ausgang am:]]<=BIS),[@[Weiterverrechnung EUR Brutto]],"""")"
    Range("Tab_Ausgaben[davon Zeitaufzeichnung]").FormulaR1C1 = "=IF(AND(LEFT([@[Bezeichnung:]],50)=""Leistungen f|fffd|r die Betreuung der Vernetzungsstelle"",[@[Zahlungs-ausgang am:]]>=VON,[@[Zahlungs-ausgang am:]]<=BIS),[@[Weiterverrechnung EUR Brutto]],"""")"
    Range("Tab_Ausgaben[davon Akonto]").FormulaR1C1 = "=IF(AND(OR(Tab_Ausgaben[@[Kosten-Art]]=""Akonto"",IFERROR(FIND(""Akonto"",Tab_Ausgaben[@Ma|fffd|nahme]),0)>0),Tab_Ausgaben[@[Zahlungs-ausgang am:]]>=VON,Tab_Ausgaben[@[Zahlungs-ausgang am:]]<=BIS),Tab_Ausgaben[@[Weiterverrechnung EUR Brutto]],"""")"

Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Ausgaben*: Formeln konnten nicht die Spalten G, L, M, N und O geschrieben werden. Haben Sie die Spalten|fffd|berschriften ge|fffd|ndert oder Spalten hinzugef|fffd|gt oder gel|fffd|scht?")
    
End Sub
Sub Ausgaben_Formeln_Check()

    Range("Tab_Ausgaben[Dropdowncheck]").Value = ""
    Range("Tab_Ausgaben[Dropdowncheck]").FormulaR1C1 = "=COUNTIF(Ma|fffd|nahme,[@Ma|fffd|nahme])"
    
    Range("Tab_Ausgaben[Fehler]").Value = ""
    Range("Tab_Ausgaben[Fehler]").FormulaR1C1 = "=IF(OR([@Organisation]=OE_1,[@Organisation]=OE_2,[@Organisation]=OE_3,[@Organisation]=OE_4,[@Organisation]=OE_5),0,1)+COUNTIF([@Ma|fffd|nahme],"""")+COUNTIF([@[Kosten-Art]],"""")+IF(OR([@[Zahlungs-ausgang am:]]<Projektstart,[@[Zahlungs-ausgang am:]]>Projektende),1,0)+COUNTIF([@Dropdowncheck],0)+IF(ISNUMBER([@[Betrag EUR excl. VAT]])=FALSE,1,0)+IF(ISNUMBER([@[Betrag EUR i" & _
        "nkl. VAT]])=FALSE,1,0)"

End Sub
Sub Ausgaben_leeren()

On Error GoTo Fehler

If MsgBox("Wollen Sie wirklich alle Ausgabeneintr|fffd|ge l|fffd|schen?", vbYesNo) = vbYes Then

    Call Link_Ausgaben
    
    Call Ausgaben_Filter_l|fffd|schen
        
    Range("Ausgaben_Start1").Activate
    
    Call Tabelle_l|fffd|schen
    
    Call Ausgaben_FORMELN

End If

Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Ausgaben*: Eintr|fffd|ge in der Ausgabenliste konnten nicht gel|fffd|scht werden.")
    
End Sub

Sub neue_Ausgabenzeile()

On Error GoTo Fehler

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Call Ausgaben_Filter_l|fffd|schen
    
    'Zeile einf|fffd|gen, Formatierung kopieren
    Range("Ausgaben_Start1").ListObject.ListRows.Add (1)
    
    Call Ausgaben_FORMELN
    
    Range("Ausgaben_Start1").Activate
    
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

Exit Sub
Fehler:
    MsgBox ("Ausgabenzeile konnte nicht eingef|fffd|gt werden.")
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    
End Sub
Sub Export_Ausgaben()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

On Error Resume Next
    
    Call Blattschutz_aufheben
    
    Range("Tab_Ausgaben[#All]").Copy
    Workbooks.Add
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues
    
    Rows("1:1").Select
    Selection.Font.Bold = True
    Selection.AutoFilter
    Columns("i:j").NumberFormat = "dd/mm/yyyy"
    
Application.DisplayAlerts = True
Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Modul_Controlling"
Sub Controlling_Filter_l|fffd|schen()

    On Error Resume Next
    
    Call Blattschutz_aufheben
    
    Range("Controlling_Start").AutoFilter
    Range("Controlling_Start").AutoFilter
    
    Call Blattschutz_setzen
    
End Sub
Sub Controlling_Finanztabelle_|fffd|bertragen()

On Error GoTo Fehler

    Call alle_Tabellenbl|fffd|tter_einblenden

    Tabelle8.Activate
        
        Call Blattschutz_aufheben
        
        'Tabelle leeren
        Range("Controlling_Start1").Activate
        Call Tabelle_l|fffd|schen
        
        'KS und Ma|fffd|nahmen aus Finanztabelle SOLL kopieren und in Controlling einf|fffd|gen
        Range("Tab_SOLL[[Kostenstelle]:[Ma|fffd|nahme]]").Copy
        Range("Controlling_Start1").PasteSpecial Paste:=xlPasteValues
                      
        'Kostenstellen anpassen mit Kostenstellenliste
        Range("Tab_Controlling[Kostenstelle]").FormulaR1C1 = "=IFERROR(INDEX(Tab_Kostenstellen[Dropdown Ma|fffd|nahmen],MATCH(Tab_Controlling[@Ma|fffd|nahme],Tab_Kostenstellen[Ma|fffd|nahme],0)),"""")"
        Range("Tab_Controlling[Kostenstelle]").Copy
        Range("Tab_Controlling[Kostenstelle]").PasteSpecial Paste:=xlPasteValues
        
        'Stand einf|fffd|gen
        Range("Controlling_Datum").FormulaR1C1 = "=""Gesamt Brutto IST per: ""&TEXT(TODAY(),""tt.MM.JJJJ"")&"":"""
        Range("Controlling_Datum").Copy
        Range("Controlling_Datum").PasteSpecial Paste:=xlPasteValues
    
    Call Controlling_FORMELN
    Call alle_Tabellenbl|fffd|tter_ausblenden
    Call Link_Controlling
    
    Call Blattschutz_setzen

Exit Sub
Fehler:
    Call alle_Tabellenbl|fffd|tter_ausblenden
    MsgBox ("Controlling konnte nicht korrekt erstellt werden!")
        
End Sub

Sub Controlling_FORMELN()
    
    Call Blattschutz_aufheben
    
    Range("Tab_Controlling[[Gesamt Soll]:[WINN Soll]]").Value = ""

    Range("Tab_Controlling[Gesamt Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    Range("Tab_Controlling[APV Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[APV Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    Range("Tab_Controlling[LK|fffd| Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[LK|fffd| Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    Range("Tab_Controlling[|fffd|AR Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[|fffd|AR Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    Range("Tab_Controlling[UWD Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[UWD Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    Range("Tab_Controlling[WINN Soll]").FormulaR1C1 = "=IFERROR(INDEX(Tab_SOLL[WINN Kosten gesamt],MATCH([@Ma|fffd|nahme],Tab_SOLL[Ma|fffd|nahme],0)),"""")"
    
    Call Blattschutz_setzen
    
End Sub
Sub Druck_Controlling_APV()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

    Call Blattschutz_aufheben
    
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False

    Tabelle8.Columns("C:L").EntireColumn.Hidden = True
    Tabelle8.Columns("Q:AF").EntireColumn.Hidden = True
    Tabelle8.Columns("AM:BJ").EntireColumn.Hidden = True
    
    On Error Resume Next
        Tabelle8.Shapes("Button 4").Select
        Selection.Font.Bold = True
      
        Tabelle8.Shapes.Range(Array("Button 5", "Button 1", "Button 2", "Button 3", "Button 6")).Select
        Selection.Font.Bold = False
    On Error GoTo 0
    
    Range("B6").Activate

Application.ScreenUpdating = True
Application.DisplayAlerts = True


End Sub
Sub Druck_Controlling_Gesamt()

Application.ScreenUpdating = False

    Call Blattschutz_aufheben
    
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False

    On Error Resume Next
    Tabelle8.Shapes("Button 1").Select
    Selection.Font.Bold = True

    Tabelle8.Shapes.Range(Array("Button 4", "Button 5", "Button 2", "Button 3", "Button 6")).Select
    Selection.Font.Bold = False

    Range("B6").Activate

Application.ScreenUpdating = True

End Sub
Sub Druck_Controlling_LKOE()

Application.ScreenUpdating = False
    
    Call Blattschutz_aufheben
    
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False

    Tabelle8.Columns("C:P").EntireColumn.Hidden = True
    Tabelle8.Columns("U:AL").EntireColumn.Hidden = True
    Tabelle8.Columns("AS:BJ").EntireColumn.Hidden = True

On Error Resume Next
    Tabelle8.Shapes("Button 5").Select
    Selection.Font.Bold = True
    
    Tabelle8.Shapes.Range(Array("Button 4", "Button 1", "Button 2", "Button 3", "Button 6")).Select
    Selection.Font.Bold = False
On Error GoTo 0

    Range("B6").Activate
    
    Call Blattschutz_setzen
        
Application.ScreenUpdating = True

End Sub
Sub Druck_Controlling_OEAR()

Application.ScreenUpdating = False
    
    Call Blattschutz_aufheben
        
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False
    
    Tabelle8.Columns("C:T").EntireColumn.Hidden = True
    Tabelle8.Columns("Y:AR").EntireColumn.Hidden = True
    Tabelle8.Columns("AY:BJ").EntireColumn.Hidden = True
    
On Error Resume Next
    Tabelle8.Shapes("Button 2").Select
    Selection.Font.Bold = True
    
    Tabelle8.Shapes.Range(Array("Button 4", "Button 1", "Button 5", "Button 3" _
    , "Button 6")).Select
    Selection.Font.Bold = False
On Error GoTo 0

    Range("B6").Activate

    Call Blattschutz_setzen

Application.ScreenUpdating = True
End Sub
Sub Druck_Controlling_UWD()

Application.ScreenUpdating = False

    Call Blattschutz_aufheben
    
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False
    Tabelle8.Columns("C:X").EntireColumn.Hidden = True
    Tabelle8.Columns("AC:AX").EntireColumn.Hidden = True
    Tabelle8.Columns("BE:BJ").EntireColumn.Hidden = True
    
On Error Resume Next
    Tabelle8.Shapes("Button 3").Select
    Selection.Font.Bold = True
    
    Tabelle8.Shapes.Range(Array("Button 4", "Button 1", "Button 5", "Button 2" _
    , "Button 6")).Select
    Selection.Font.Bold = False
On Error GoTo 0

    Range("B6").Activate

    Call Blattschutz_setzen
    
Application.ScreenUpdating = True
End Sub
Sub Druck_Controlling_WINN()

Application.ScreenUpdating = False

    Call Blattschutz_aufheben
    
    Tabelle8.Columns("B:BJ").EntireColumn.Hidden = False
    Tabelle8.Columns("C:AB").EntireColumn.Hidden = True
    Tabelle8.Columns("AG:BD").EntireColumn.Hidden = True
    
On Error Resume Next
    Tabelle8.Shapes("Button 6").Select
    Selection.Font.Bold = True
    
    Tabelle8.Shapes.Range(Array("Button 4", "Button 1", "Button 5", "Button 2" _
    , "Button 3")).Select
    Selection.Font.Bold = False

    Range("B6").Activate
    
    Call Blattschutz_setzen
    
Application.ScreenUpdating = True
End Sub

Sub Export_Controlling()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

On Error Resume Next
    
    Call Blattschutz_aufheben
    
    Tabelle8.Columns("A:BJ").EntireColumn.Hidden = False
    Tabelle8.Columns("A:BJ").Copy
    Workbooks.Add
    
    Columns("A:A").Select
    ActiveSheet.Paste
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues
    
    Rows("1:1").RowHeight = 30.75
    Rows("3:3").RowHeight = 30.75
    Rows("2:2").RowHeight = 22.5

    Columns("A:A").ColumnWidth = 2.78
    Columns("B:B").ColumnWidth = 29.33
    ActiveWindow.View = xlPageBreakPreview
    
    Set ActiveSheet.VPageBreaks(1).Location = Range("I1")
    Set ActiveSheet.VPageBreaks(2).Location = Range("M1")
    Set ActiveSheet.VPageBreaks(3).Location = Range("Q1")
    Set ActiveSheet.VPageBreaks(4).Location = Range("U1")
    Set ActiveSheet.VPageBreaks(5).Location = Range("Y1")

    ActiveWindow.View = xlNormalView
    ActiveWindow.DisplayGridlines = False
    Range("A10").Select
    ActiveWindow.FreezePanes = True
    ActiveSheet.DrawingObjects.Cut

    ActiveSheet.Name = "Controlling"
    
    Call Blattschutz_setzen
    
Application.ScreenUpdating = True
Application.DisplayAlerts = True

End Sub

Sub DRUCK_Controlling_alles()

    ActiveWindow.SelectedSheets.PrintOut Copies:=1
    
End Sub

Sub Controlling_leeren()

On Error GoTo Fehler

If MsgBox("Wollen Sie wirklich alle Eintr|fffd|ge im Controlling l|fffd|schen?", vbYesNo) = vbYes Then

    Call Link_Controlling
    Call Blattschutz_aufheben
    Range("Controlling_Start1").Activate
    Call Tabelle_l|fffd|schen
    Call Blattschutz_setzen
    
End If

Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Controlling*: Eintr|fffd|ge in der Controllingliste konnten nicht gel|fffd|scht werden.")
    
End Sub


Attribute VB_Name = "Modul_Einfuegen"
Sub Einfuegen()
Attribute Einfuegen.VB_ProcData.VB_Invoke_Func = "v\n14"

    Selection.PasteSpecial Paste:=xlPasteValues
    
End Sub
Attribute VB_Name = "Modul_Finanztabelle"
Sub Finanztabelle_Filter_l|fffd|schen()

On Error Resume Next

    Call Blattschutz_aufheben
    
    Range("Finanztabelle_Start").AutoFilter
    Range("Finanztabelle_Start").AutoFilter
    
    Call Blattschutz_setzen
    
End Sub
Sub Finanztabelle_Spalten_einblenden()
 
 Call Blattschutz_aufheben
 
 Columns("E:CB").EntireColumn.Hidden = False
 
 Range("D9").Select

 
End Sub
Sub Finanztabelle_Formelspalten_einblenden()
    
 Call Blattschutz_aufheben

    Columns("E:CB").EntireColumn.Hidden = False
    Columns("P:R").EntireColumn.Hidden = True
    Columns("W:Y").EntireColumn.Hidden = True
    Columns("AC:AE").EntireColumn.Hidden = True
    Columns("AJ:AL").EntireColumn.Hidden = True
    Columns("AP:AR").EntireColumn.Hidden = True
    Columns("AW:AY").EntireColumn.Hidden = True
    Columns("BC:BE").EntireColumn.Hidden = True
    Columns("BJ:BL").EntireColumn.Hidden = True
    Columns("BP:BR").EntireColumn.Hidden = True
    Columns("BW:BY").EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 7
 
 Range("C9").Activate

End Sub

Sub Finanztabelle_Formelspalten_ausblenden()
    
 Call Blattschutz_aufheben

    Tabelle1.Columns("E:CB").EntireColumn.Hidden = False
    Tabelle1.Columns("G:O").EntireColumn.Hidden = True
    Tabelle1.Columns("S:V").EntireColumn.Hidden = True
    Tabelle1.Columns("Z:AB").EntireColumn.Hidden = True
    Tabelle1.Columns("AF:AI").EntireColumn.Hidden = True
    Tabelle1.Columns("AM:AO").EntireColumn.Hidden = True
    Tabelle1.Columns("AS:AV").EntireColumn.Hidden = True
    Tabelle1.Columns("AZ:BB").EntireColumn.Hidden = True
    Tabelle1.Columns("BF:BI").EntireColumn.Hidden = True
    Tabelle1.Columns("BM:BO").EntireColumn.Hidden = True
    Tabelle1.Columns("BS:BV").EntireColumn.Hidden = True
    Tabelle1.Columns("BZ:CB").EntireColumn.Hidden = True
    ActiveWindow.ScrollColumn = 7
        
 Tabelle1.Range("C9").Activate
 
End Sub
Sub Finanztabelle_Eingabespalten_leeren()
    
If MsgBox("Wollen Sie wirklich alle Zahlen aus den Eingabespalten l|fffd|schen?", vbYesNoCancel) = vbYes Then

    Tabelle1.Activate
    
    Call Blattschutz_aufheben
    
    Call Finanztabelle_Formelspalten_ausblenden
    
    Range("Tab_SOLL[[APV Expertise intern PT]:[WINN Reisekosten]]").SpecialCells(xlCellTypeVisible).ClearContents
    
End If
    
End Sub
Sub Finanztabelle_leeren()
    
    Call Blattschutz_aufheben
    
    Call Finanztabelle_Formelspalten_ausblenden
    
    Range("Finanztabelle_Start1").Activate
    
    Call Tabelle_l|fffd|schen
    
    MsgBox ("Finanztabelle erfolgreich geleert. Sie k|fffd|nnen nun neue Kostenstellen eingeben.")

End Sub
Sub Finanztabelle_Fehler_Check()

Call Blattschutz_aufheben

    Range("Tab_SOLL[Fehler]").FormulaR1C1 = "=IF(COUNTIF(Tab_Kostenstellen[Ma|fffd|nahme],[@Ma|fffd|nahme])=0,1,0)+COUNTIF([@[|fffd|berschrift 1]],"""")+COUNTIF([@Kostenstelle],"""")+COUNTIF([@Ma|fffd|nahme],"""")+IF(ISFORMULA([@[Kosten gesamt]]),0,1)+IF(ISFORMULA([@[APV Kosten gesamt]]),0,1)+IF(ISFORMULA([@[LK|fffd| Kosten gesamt]]),0,1)+IF(ISFORMULA([@[|fffd|AR Kosten gesamt]]),0,1)+IF(ISFORMULA([@[UWD Kosten gesamt]]),0,1)+IF(ISFORMULA(" & _
        "[@[WINN Kosten gesamt]]),0,1)+IF(ISFORMULA([@[Personalk. intern]]),0,1)+IF(ISFORMULA([@[Kosten  extern]]),0,1)+IF(ISFORMULA([@[APV Personalk. intern]]),0,1)+IF(ISFORMULA([@[APV Kosten extern]]),0,1)+IF(ISFORMULA([@[LK|fffd| Personalk. intern]]),0,1)+IF(ISFORMULA([@[LK|fffd| Kosten extern]]),0,1)+IF(ISFORMULA([@[|fffd|AR Personalk. intern]]),0,1)+IF(ISFORMULA([@[|fffd|AR Kosten extern]]" & _
        "),0,1)+IF(ISFORMULA([@[UWD Personalk. intern]]),0,1)+IF(ISFORMULA([@[UWD Kosten extern]]),0,1)+IF(ISFORMULA([@[WINN Personalk. intern]]),0,1)+IF(ISFORMULA([@[WINN Kosten  extern]]),0,1)+IF(ISFORMULA([@[Expertise Kosten]]),0,1)+IF(ISFORMULA([@[Mischsatz Kosten]]),0,1)+IF(ISFORMULA([@[Assistenz Kosten]]),0,1)+IF(ISFORMULA([@[Personalk. extern]]),0,1)+IF(ISFORMULA([@Sa" & _
        "chkosten]),0,1)+IF(ISFORMULA([@Reisekosten]),0,1)+IF(ISFORMULA([@[APV Expertise Kosten]]),0,1)+IF(ISFORMULA([@[WINN Kosten  extern]]),0,1)+IF(ISFORMULA([@[APV Mischsatz Kosten]]),0,1)+IF(ISFORMULA([@[APV Assistenz Kosten]]),0,1)+IF(ISFORMULA([@[APV Personalk. extern]]),0,1)+IF(ISFORMULA([@[LK|fffd| Expertise Kosten]]),0,1)+IF(ISFORMULA([@[LK|fffd| Mischsatz Kosten]]),0,1)+IF(" & _
        "ISFORMULA([@[LK|fffd| Assistenz Kosten]]),0,1)+IF(ISFORMULA([@[LK|fffd| Personalk. extern]]),0,1)+IF(ISFORMULA([@[|fffd|AR Personalk. extern]]),0,1)+IF(ISFORMULA([@[UWD Assistenz Kosten]]),0,1)+IF(ISFORMULA([@[UWD Personalk. extern]]),0,1)+IF(ISFORMULA([@[WINN Personalk. extern]]),0,1)+IF(ISFORMULA([@[|fffd|AR Expertise Kosten]]),0,1)+IF(ISFORMULA([@[|fffd|AR Mischsatz Kosten]]),0,1)+IF(ISF" & _
        "ORMULA([@[|fffd|AR Assistenz Kosten]]),0,1)+IF(ISFORMULA([@[UWD Expertise Kosten]]),0,1)+IF(ISFORMULA([@[UWD Mischsatz Kosten]]),0,1)+IF(ISFORMULA([@[WINN Expertise Kosten]]),0,1)+IF(ISFORMULA([@[WINN Mischsatz Kosten]]),0,1)+IF(ISFORMULA([@[WINN Assistenz Kosten]]),0,1)" & _
        ""

End Sub
Sub Finanztabelle_Fehler_filtern()

Call Finanztabelle_Filter_l|fffd|schen

If Range("Finanztabelle_Fehler").Value = 0 Then

    MsgBox ("Keine Fehler gefunden.")

Else
    
    Call Blattschutz_aufheben
    Tabelle1.ListObjects("Tab_Soll").Range.AutoFilter Field:=1, Criteria1:=">0", Operator:=xlAnd
    Call Blattschutz_setzen
    
End If

End Sub

Sub Export_Finanztabelle()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

On Error Resume Next
    
    Call Finanztabelle_Formelspalten_ausblenden
    
    Range("Tab_SOLL[#All]").SpecialCells(xlCellTypeVisible).Copy
    Workbooks.Add
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues
    
    Columns("A:A").Delete
    
    Rows("1:1").Select
    Selection.Font.Bold = True
    Selection.AutoFilter
    
    With Selection
        .VerticalAlignment = xlTop
        .WrapText = True
    End With
    
    Range("A2").Select
    ActiveWindow.FreezePanes = True
    
Application.DisplayAlerts = True
Application.ScreenUpdating = True

End Sub

Attribute VB_Name = "Modul_Kostenstellen"
Sub Kostenstellenliste_Filter_l|fffd|schen()

On Error Resume Next
Worksheets("Kostenstellenliste").ShowAllData
On Error GoTo 0

End Sub

Sub Kostenstellen_erstellen()
Attribute Kostenstellen_erstellen.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False
Application.DisplayAlerts = False

    Call alle_Tabellenbl|fffd|tter_einblenden

    'alte KS leeren
    Tabelle2.Activate
    Range("Kostenstellenliste_Start").Activate
    Call Tabelle_l|fffd|schen

    
    'neue KS aus Finanztabelle kopieren und in KS Liste |fffd|bertragen
    Range("Tab_Soll[[Kostenstelle]:[Ma|fffd|nahme]]").Copy
    Range("Tab_Kostenstellen[Kostenstelle]").PasteSpecial Paste:=xlPasteValues
    
   
    'neue KS kopieren und in Zeiterfassung Vorlage |fffd|bertragen
    Tabelle3.Range("Ma|fffd|nahme").ClearContents
    Range("Kostenstellenliste").Copy
    Tabelle3.Range("P3").PasteSpecial Paste:=xlPasteValues, Transpose:=True
    
    
    'neue KS kopieren und in Controlling |fffd|bertragen
    Call Controlling_Finanztabelle_|fffd|bertragen


    'Stand
    Range("Summe_Kostenstellen").FormulaR1C1 = "=COUNT(Tab_Kostenstellen[Kostenstelle])"
    Range("Kostenstelle_Letztstand").FormulaR1C1 = "=""zuletzt ge|fffd|ndert: ""&TEXT(NOW(),""tt.MM.JJJJ hh:mm"")"
    Range("Summe_Kostenstellen:Kostenstelle_Letztstand").Copy
    Range("Summe_Kostenstellen:Kostenstelle_Letztstand").PasteSpecial Paste:=xlPasteValues
    
    ActiveWorkbook.RefreshAll
    
    Call alle_Tabellenbl|fffd|tter_ausblenden
       
Application.ScreenUpdating = True
Application.DisplayAlerts = True
 
End Sub
Sub Kostenstellen_|fffd|ndern()
Attribute Kostenstellen_|fffd|ndern.VB_ProcData.VB_Invoke_Func = " \n14"

On Error GoTo Fehler

    Call Link_Finanztabelle
    Range("Tab_Soll[Kostenstelle]").Activate
    
    MsgBox ("Hier k|fffd|nnen Sie bestehende Kostenstellen |fffd|ndern oder neue hinzuf|fffd|gen. Bitte achten Sie darauf, dass Sie nach jeder |fffd|nderung auf den Button *neue Kostenstellen ins Dropdown |fffd|bertragen* klicken m|fffd|ssen, damit die neuen Kostenstellen |fffd|bernommen werden k|fffd|nnen. Achtung: Sie m|fffd|ssen nach jeder |fffd|nderung die Zeiterfassungsvorlage an Ihre Kollegen verschicken, da sonst die Dropdowns beim Import nicht |fffd|bereinstimmen! Sie sollten deshalb innerhalb eines Jahres m|fffd|glichst keine Kostenstellen|fffd|nderungen durchf|fffd|hren.")
    
Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Finanztabelle (SOLL)*: haben Sie das Blatt oder dis Spalte *Kostenstelle* gel|fffd|scht oder umbenannt?")
End Sub
Sub Kostenstellen_leeren()
    
On Error GoTo Fehler

    Call Link_Kostenstellenliste
    
    'alte KS in Kostenstellenliste l|fffd|schen
    Range("Kostenstellenliste_Start").Activate
    Call Tabelle_l|fffd|schen
    
    'Stand
    Range("Summe_Kostenstellen").FormulaR1C1 = "=COUNT(Tab_Kostenstellen[Kostenstelle])"
    Range("Kostenstelle_Letztstand").FormulaR1C1 = "=""zuletzt ge|fffd|ndert: ""&TEXT(NOW(),""tt.MM.JJJJ hh:mm"")"
    Range("Summe_Kostenstellen:Kostenstelle_Letztstand").Copy
    Range("Summe_Kostenstellen:Kostenstelle_Letztstand").PasteSpecial Paste:=xlPasteValues
          
    'Controlling Zeitraum l|fffd|schen
    Sheets("HOME").Select
    Range("Von").ClearContents
    Range("Bis").ClearContents
    
Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *HOME* und *Kostenstellenliste*: alte Kostenstellenliste konnte nicht gel|fffd|scht werden!")
    
End Sub

Attribute VB_Name = "Modul_Links"
Sub Link_Zeiterfassung()
Attribute Link_Zeiterfassung.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False
    
    Call alle_Tabellenbl|fffd|tter_ausblenden
    
    Sheets("Zeitaufzeichnung").Visible = True
        
    Range(Tabelle2.Range("D3"), Tabelle2.Range("D3").End(xlDown)).Copy
    Tabelle2.Range("P3").PasteSpecial Paste:=xlPasteValues, Transpose:=True
    
    Tabelle2.Activate
    Range("G4").Activate
    
Application.ScreenUpdating = True

End Sub
Sub Link_ZeiterfassungGesamt()
Attribute Link_ZeiterfassungGesamt.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden

    Tabelle4.Visible = True
    Tabelle4.Activate
    
    Range("C6").Activate
    
Application.ScreenUpdating = True

End Sub
Sub Link_Kostenstellenliste()

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden

    Tabelle2.Visible = True
    Tabelle2.Activate
    
    Range("B2").Activate
    
Application.ScreenUpdating = True

End Sub

Sub Link_Finanztabelle()
Attribute Link_Finanztabelle.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
    Tabelle1.Visible = True
    Tabelle1.Activate
    
    Call Finanztabelle_Spalten_einblenden
    
    Call Gruppieren
           
Application.ScreenUpdating = True

End Sub

Sub Gruppieren()

    Call Blattschutz_aufheben
    
    Sheets("Finanztabelle (SOLL)").Outline.ShowLevels RowLevels:=0, ColumnLevels:=1

    Call Blattschutz_setzen
    
End Sub
Sub alle_Tabellenbl|fffd|tter_einblenden()

On Error GoTo Fehler

    Tabelle1.Visible = True
    Tabelle2.Visible = True
    Tabelle3.Visible = True
    Tabelle4.Visible = True
    Tabelle5.Visible = True
    Tabelle6.Visible = True
    Tabelle8.Visible = True
    
Exit Sub
Fehler:
    MsgBox ("Fehler! Ein Tabellenblatt ist gel|fffd|scht worden, deshalb konnten die Bl|fffd|tter nicht alle eingeblendet werden. |fffd|ndern Sie alle wieder um in: *HOME*, *Zeitaufzeichnung*, *Zeitaufzeichnung GESAMT*, *Ausgaben*, *Controlling*, *NetzwerkFinanztabelle (SOLL)* und *Kostenstellenliste*.")
    
End Sub
Sub alle_Tabellenbl|fffd|tter_ausblenden()

On Error GoTo Fehler

    Tabelle1.Visible = False
    Tabelle2.Visible = False
    Tabelle3.Visible = False
    Tabelle4.Visible = False
    Tabelle5.Visible = False
    Tabelle8.Visible = False
    Tabelle6.Activate
    
Exit Sub
Fehler:
    MsgBox ("Fehler! Ein Tabellenblatt ist gel|fffd|scht worden, deshalb konnten die Bl|fffd|tter nicht alle ausgeblendet werden. |fffd|ndern Sie alle wieder um in: *HOME*, *Zeitaufzeichnung*, *Zeitaufzeichnung GESAMT*, *Ausgaben*, *Controlling*, *NetzwerkFinanztabelle (SOLL)* und *Kostenstellenliste*.")
    
End Sub
Sub Link_Ausgaben()
Attribute Link_Ausgaben.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
    Tabelle5.Visible = True
    Tabelle5.Activate
    
    Call Ausgaben_FORMELN
    
    Range("A9").Activate

Application.ScreenUpdating = True

End Sub
Sub Link_Controlling()
Attribute Link_Controlling.VB_ProcData.VB_Invoke_Func = " \n14"

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
    Tabelle8.Visible = True
    Tabelle8.Activate

Application.ScreenUpdating = True

End Sub
Sub Link_Home()

Application.ScreenUpdating = False

    Call alle_Tabellenbl|fffd|tter_ausblenden

Application.ScreenUpdating = True

End Sub

Sub Controlling()

Application.ScreenUpdating = False
Application.DisplayAlerts = False


If Range("Von").Value = "" Or Range("Bis").Value = "" Then

    MsgBox ("Bite geben Sie zuerst einen Controlling Zeitraum ein (Datum *von* und Datum *bis*) und dr|fffd|cken Sie dann wieder auf den Button *Controlling*.")

Else
    
    Call Ausgaben_FORMELN
    Call Controlling_Finanztabelle_|fffd|bertragen
    
End If

Application.ScreenUpdating = True
Application.DisplayAlerts = True

End Sub
Sub Link_Back_Tabelle()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub
Sub Link_Back_KS()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub
Sub Link_Back_ZA()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub
Sub Link_Back_ZEG()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub
Sub Link_Back_Ausgaben()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub
Sub Link_Back_Controlling()

    Call alle_Tabellenbl|fffd|tter_ausblenden
    
End Sub

Sub DRUCK_Home()

    ActiveWindow.SelectedSheets.PrintOut Copies:=1
    
End Sub

Sub Filter_l|fffd|schen()

    If ActiveSheet.FilterMode Then ActiveSheet.ShowAllData

End Sub

Sub Tabelle_l|fffd|schen()

On Error Resume Next

If Not ActiveCell.ListObject Is Nothing Then
    ActiveCell.ListObject.DataBodyRange.Delete
    Selection.ListObject.ListRows.Add (1)
End If

End Sub

Sub Blattschutz_aufheben()

    ActiveSheet.Unprotect
    
End Sub

Sub Blattschutz_setzen()
    
    ActiveSheet.Protect
    
End Sub
Sub Entsperren()

    Tabelle1.Unprotect
    
End Sub
Sub Sperren()

    Tabelle1.Protect

End Sub
Attribute VB_Name = "Modul_Reset"
Sub RESET()

Call Ausgaben_leeren
Call Zeitaufzeichnungen_leeren
Call Finanztabelle_Eingabespalten_leeren
Call alle_Tabellenbl|fffd|tter_ausblenden

End Sub
Attribute VB_Name = "Modul_Zeit"
Sub Import_Zeit()

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
On Error GoTo Fehler

    Tabelle4.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues

    'letzter erfolgreicher Import am
    Tabelle4.Range("importiert").FormulaR1C1 = "=""letzter erfolgreicher Import am ""&TEXT(TODAY(),""tt.MM.jj"")&"" um ""&TEXT(NOW()-TODAY(),""hh:mm"")"
    Tabelle4.Range("importiert").Copy
    Tabelle4.Range("importiert").PasteSpecial Paste:=xlPasteValues
    
    'Zeilenh|fffd|he einstellen
    Tabelle4.Range(Rows("11:11"), Rows("11:11").End(xlDown)).RowHeight = 30
    
    Call Zeit_Filter_l|fffd|schen
    Call ZEIT_Gesamt_korrigieren
    Call Duplikate_l|fffd|schen
    Call ZEIT_Ma|fffd|nahme_bereinigen
    Call ZEIT_sortieren
    Call ZEIT_Formeln
    
    MsgBox ("Zeitaufzeichnung erfolgreich importiert. Duplikate wurden gel|fffd|scht. Gesamtstunden berechnet. Ma|fffd|nahmen aufgrund nicht kompatibler Kostenstellen korrigiert. Fehlende Eintr|fffd|ge sind gelb gekennzeichnet. Gelbes Dreieck klicken, um gefundene Fehler zu filtern. Bitte auf andere potentielle Fehler pr|fffd|fen.")
    
Application.ScreenUpdating = True
Application.DisplayAlerts = True

Exit Sub
Fehler:
    MsgBox ("Sie haben keine Daten kopiert oder der Import einer ausgef|fffd|llten Zeiterfassung war nicht erfolgreich.")
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    
End Sub

Sub Zeit_Filter_l|fffd|schen()

On Error Resume Next

    Range("Zeit_Start").AutoFilter
    Range("Zeit_Start").AutoFilter
    
End Sub

Sub ZEIT_Gesamt_korrigieren()

On Error GoTo Fehler
    
    'Filter l|fffd|schen
    Call Zeit_Filter_l|fffd|schen
    
    'Formel Gesamt-h
    Range("Tab_Zeitaufzeichnungen[Gesamt h]").FormulaR1C1 = "=SUM(Tab_Zeitaufzeichnungen[@[Experten-h]:[Assistenz-h]])"
    Range("Tab_Zeitaufzeichnungen[Gesamt h]").Copy
    Range("Tab_Zeitaufzeichnungen[Gesamt h]").PasteSpecial Paste:=xlPasteValues
    
Exit Sub
Fehler:
    MsgBox ("Gesamtstunden konnten nicht korrigiert werden. Haben Sie die Spalte *Gesamt h* umbenannt oder gel|fffd|scht?")
    
End Sub

Sub Duplikate_l|fffd|schen()

On Error GoTo Fehler
    
    Application.ScreenUpdating = False
    
    n = Range("Spalte_Duplikate").Value
    
    Range("Tab_Zeitaufzeichnungen[Duplikate]").FormulaR1C1 = "=[@Organisation]&[@Name]&[@Datum]&[@Was]&[@Ma|fffd|nahme]&[@[Gesamt h]]"
    Range("Tab_Zeitaufzeichnungen[Duplikate]").Copy
    Range("Tab_Zeitaufzeichnungen[Duplikate]").PasteSpecial Paste:=xlPasteValues
    Range("Tab_Zeitaufzeichnungen[Duplikate]").RemoveDuplicates Columns:=n, Header:=xlYes
    
    Application.ScreenUpdating = True
    
Exit Sub
Fehler:
    Application.ScreenUpdating = True
    MsgBox ("Fehler im Tabellenblatt *Zeitaufzeichnung GESAMT*: Duplikate konnten nicht gel|fffd|scht werden. Haben Sie das Tabellenblatt, die Tabelle *Tabelle 1* oder die Spalte *Duplikate* umbenannt oder gel|fffd|scht?")
    
End Sub
Sub Zeitaufzeichnungen_leeren()

On Error GoTo Fehler

If MsgBox("Wollen Sie wirklich alle Zeiterfassungen l|fffd|schen?", vbYesNo) = vbYes Then

    Call Link_ZeiterfassungGesamt
    
    Range("Zeit_Start1").Activate
    
    Call Tabelle_l|fffd|schen
       
End If

Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Zeitaufzeichnung GESAMT*: Eintr|fffd|ge in der Liste konnten nicht gel|fffd|scht werden. Haben Sie das Tabellenblatt oder die Tabelle umbenannt, verschoben oder gel|fffd|scht?")
    
End Sub

Sub ZEIT_Fehler_filtern()

    Call ZEIT_Fehler_Check
    Call Zeit_Filter_l|fffd|schen

    If Range("Zeit_Fehler").Value = 0 Then
    
        MsgBox ("Keine Fehler gefunden.")
    
    Else
    
        Tabelle4.ListObjects("Tab_Zeitaufzeichnungen").Range.AutoFilter Field:=1, Criteria1:=">0", Operator:=xlAnd
        
    End If

End Sub

Sub ZEIT_Ma|fffd|nahme_bereinigen()

On Error GoTo Fehler

    Range("Tab_Zeitaufzeichnungen[Kosten-stelle]").FormulaR1C1 = "=IF([@Ma|fffd|nahme]="""",[@[Hilfsspalte Speicher]],[@Ma|fffd|nahme])"
    Range("Tab_Zeitaufzeichnungen[Kosten-stelle]").Copy
    Range("Tab_Zeitaufzeichnungen[Kosten-stelle]").PasteSpecial Paste:=xlPasteValues
    Range("Tab_Zeitaufzeichnungen[Hilfsspalte Speicher]").PasteSpecial Paste:=xlPasteValues


    Range("Tab_Zeitaufzeichnungen[Hilfsspalte]").FormulaR1C1 = "=RIGHT([@Ma|fffd|nahme],(LEN([@Ma|fffd|nahme])-5))"
    Range("Tab_Zeitaufzeichnungen[Hilfsspalte]").Copy
    Range("Tab_Zeitaufzeichnungen[Hilfsspalte]").PasteSpecial Paste:=xlPasteValues
    
    
    Range("Tab_Zeitaufzeichnungen[Ma|fffd|nahme bereinigt]").FormulaR1C1 = "=IFERROR(INDEX(Tab_Kostenstellen[Dropdown Ma|fffd|nahmen],MATCH([@Hilfsspalte],Tab_Kostenstellen[Ma|fffd|nahme],0)),INDEX([Ma|fffd|nahme],MATCH([@[Kosten-stelle]],[Hilfsspalte Speicher],0)))"
    Range("Tab_Zeitaufzeichnungen[Ma|fffd|nahme bereinigt]").Copy
    Range("Tab_Zeitaufzeichnungen[Ma|fffd|nahme bereinigt]").PasteSpecial Paste:=xlPasteValues
    Range("Tab_Zeitaufzeichnungen[Ma|fffd|nahme]").PasteSpecial Paste:=xlPasteValues
         
        
    Range("A10").Activate
    
Exit Sub
Fehler:
    MsgBox ("Fehler im Tabellenblatt *Zeitaufzeichnung GESAMT*: Kostenstellen konnten nicht bereinigt werden! Bitte kontrollieren Sie die Kostenstellen. Haben Sie Spalten|fffd|berschriften ge|fffd|ndert oder die Spalte G *Kosten-stellen* gel|fffd|scht?")
        
End Sub

Sub ZEIT_sortieren()

On Error GoTo Fehler
    
    'Sortierung l|fffd|schen
    ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort.SortFields.Clear
    
    'zuerst nach Organisation sortieren
    ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort.SortFields.Add Key:=Range("Tab_Zeitaufzeichnungen[Organisation]"), SortOn:= _
        xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    'dann nach Name
    ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort.SortFields.Add Key:=Range("Tab_Zeitaufzeichnungen[Name]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    
    'dann nach Datum
    ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort.SortFields.Add Key:=Range("Tab_Zeitaufzeichnungen[Datum]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    
    'dann nach Ma|fffd|nahme
    ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort.SortFields.Add Key:=Range("Tab_Zeitaufzeichnungen[Ma|fffd|nahme]"), SortOn:= _
        xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    'aktivieren
    With ActiveWorkbook.Worksheets("Zeitaufzeichnung GESAMT").ListObjects("Tab_Zeitaufzeichnungen").Sort
        .Apply
    End With
    
Exit Sub
Fehler:
    MsgBox ("Tabelle konnte nicht sortiert werden. Haben Sie |fffd|berschriften ver|fffd|ndert oder die Tabelle umbenannt?")
    
End Sub
Sub ZEIT_Fehler_Check()
    
    Range("Tab_Zeitaufzeichnungen[Dropdowncheck]").FormulaR1C1 = "=COUNTIF(Ma|fffd|nahme,Tab_Zeitaufzeichnungen[@Ma|fffd|nahme])"
        
    Range("Tab_Zeitaufzeichnungen[Fehler]").FormulaR1C1 = _
        "=IF(OR(Tab_Zeitaufzeichnungen[@Name]="""",Tab_Zeitaufzeichnungen[@Name]=0),0,IF(OR(Tab_Zeitaufzeichnungen[@Organisation]=OE_1,Tab_Zeitaufzeichnungen[@Organisation]=OE_2,Tab_Zeitaufzeichnungen[@Organisation]=OE_3,Tab_Zeitaufzeichnungen[@Organisation]=OE_4,Tab_Zeitaufzeichnungen[@Organisation]=OE_5),0,1)+COUNTIF(Tab_Zeitaufzeichnungen[@Name],"""")+IF(OR(Tab_Zeitaufzei" & _
        "chnungen[@Datum]<Projektstart,Tab_Zeitaufzeichnungen[@Datum]>Projektende,Tab_Zeitaufzeichnungen[@Datum]>TODAY(),ISTEXT(Tab_Zeitaufzeichnungen[@Datum])),1,0)+IF(OR(ISBLANK(Tab_Zeitaufzeichnungen[@Ma|fffd|nahme]),ISNUMBER(Tab_Zeitaufzeichnungen[@Ma|fffd|nahme])),1,0)+COUNTIF(Tab_Zeitaufzeichnungen[@Dropdowncheck],0)+IF(SUM(Tab_Zeitaufzeichnungen[@[Experten-h]],Tab_Zeitaufzeichn" & _
        "ungen[@[Mix-h]],Tab_Zeitaufzeichnungen[@[Assistenz-h]])<>Tab_Zeitaufzeichnungen[@[Gesamt h]],1,0))" & _
        ""
        
End Sub

Sub EXPORT_zeiterfassung()
    
Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
    'kopieren
    Tabelle3.Select
    Cells.Select
    Selection.Copy
    
    'neues Workbook
    Workbooks.Add
    
    'einf|fffd|gen
    Cells.Select
    ActiveSheet.Paste
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues
    
    'Buttons l|fffd|schen
    On Error Resume Next
    ActiveSheet.Shapes.Range(Array("Button_Zeit_Export")).Delete
    ActiveSheet.Shapes.Range(Array("Home")).Delete
    
    'Sheet umbenennen
    ActiveSheet.Name = "Zeitaufzeichnung"
    
    'Fenster fixieren und Grid l|fffd|schen
    Range("A9").Select
    ActiveWindow.FreezePanes = True
    ActiveWindow.DisplayGridlines = False
    
    'Zeilenh|fffd|he einstellen
    Rows("1:9").RowHeight = 20
    
    'Formeln
    Range("Tab_Vorlage[Kostenstelle]").FormulaR1C1 = "=IF([Ma|fffd|nahmenzuordnung]="""","""",LEFT([Ma|fffd|nahmenzuordnung],3))"
    Range("Tab_Vorlage[Gesamt-h]").FormulaR1C1 = "=Tab_Vorlage[[#This Row],[Experten-h]]+Tab_Vorlage[[#This Row],[Mix-h]]+Tab_Vorlage[[#This Row],[Assistenz-h]]"
    Range("I7").FormulaR1C1 = "=SUBTOTAL(9,Tab_Vorlage[Experten-h])"
    Range("J7").FormulaR1C1 = "=SUBTOTAL(9,Tab_Vorlage[Mix-h])"
    Range("K7").FormulaR1C1 = "=SUBTOTAL(9,Tab_Vorlage[Assistenz-h])"
    Range("L7").FormulaR1C1 = "=SUBTOTAL(9,Tab_Vorlage[Gesamt-h])"
    Range("D7").FormulaR1C1 = "=IF(SUBTOTAL(3,Tab_Vorlage[Datum])=1,SUBTOTAL(3,Tab_Vorlage[Datum])&"" Eintrag"",SUBTOTAL(3,Tab_Vorlage[Datum])&"" Eintr|fffd|ge"")"
    Range("Tab_Vorlage[Organisation]").FormulaR1C1 = "=IF(R4C7="""","""",R4C7)"
    Range("Tab_Vorlage[Name]").FormulaR1C1 = "=IF(R5C7="""","""",TRIM(R5C7))"
    
    'Dropdown
    ActiveWorkbook.Names("Ma|fffd|nahme").RefersToR1C1 = _
        "=OFFSET(Zeitaufzeichnung!R3C16,0,0,1,COUNTA(Zeitaufzeichnung!R3C16:R3C131))"
        
    'Druckeinstellungen mit Wiederholungszeichen
    Application.PrintCommunication = False
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$1:$8"
        .Orientation = xlLandscape
    End With
    Application.PrintCommunication = True
    
    Range("G4").Activate

Application.DisplayAlerts = True
Application.ScreenUpdating = True

End Sub
Sub Export_Zeiterfassungen()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

On Error Resume Next
    
    Call Blattschutz_aufheben
    
    Range("Tab_Zeitaufzeichnungen[#All]").Copy
    Workbooks.Add
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues
    
    Rows("1:1").Select
    Selection.Font.Bold = True
    Selection.AutoFilter
    Columns("D:D").NumberFormat = "dd/mm/yyyy"
    
Application.DisplayAlerts = True
Application.ScreenUpdating = True

End Sub

Sub ZEIT_Formeln()

    Range("Tab_Zeitaufzeichnungen[Experten-h |fffd|]").FormulaR1C1 = _
        "=IF(Tab_Zeitaufzeichnungen[Experten-h]="""",0,Tab_Zeitaufzeichnungen[Experten-h]*Expertentag/8)"

    Range("Tab_Zeitaufzeichnungen[Mix-h |fffd|]").FormulaR1C1 = _
        "=IF(Tab_Zeitaufzeichnungen[Mix-h]="""",0,Tab_Zeitaufzeichnungen[Mix-h]*Mixtag/8)"

    Range("Tab_Zeitaufzeichnungen[Assistenz-h |fffd|]").FormulaR1C1 = _
        "=IF(Tab_Zeitaufzeichnungen[Assistenz-h]="""",0,Tab_Zeitaufzeichnungen[Assistenz-h]*Assistenztag/8)"

    Range("Tab_Zeitaufzeichnungen[Gesamt |fffd|]").FormulaR1C1 = _
        "=SUM(Tab_Zeitaufzeichnungen[@[Experten-h |fffd|]],Tab_Zeitaufzeichnungen[@[Mix-h |fffd|]],Tab_Zeitaufzeichnungen[@[Assistenz-h |fffd|]])"

    Range("Tab_Zeitaufzeichnungen[Controlling Gesamt-h]").FormulaR1C1 = _
        "=IF(AND(Tab_Zeitaufzeichnungen[@Datum]>=VON,Tab_Zeitaufzeichnungen[@Datum]<=BIS),Tab_Zeitaufzeichnungen[@[Gesamt h]],"""")"

    Range("Tab_Zeitaufzeichnungen[Controlling Gesamt EUR Brutto]").FormulaR1C1 = _
        "=IF(AND(Tab_Zeitaufzeichnungen[@Datum]>=VON,Tab_Zeitaufzeichnungen[@Datum]<=BIS),Tab_Zeitaufzeichnungen[@[Gesamt |fffd|]],"""")"

End Sub

Attribute VB_Name = "Module1"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Range("Tab_SOLL[#All]").SpecialCells(xlCellTypeVisible).Copy
End Sub
Sub Macro3()
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
'

'
    Range("Tab_SOLL[#All]").Select
    Range("Tab_SOLL[[#Headers],[|fffd|berschrift 2]]").Activate
    Selection.Copy
    Workbooks.Add
    Application.Run _
        "'2019-07-25 01_Projektbudgets JAP 2019_Vorlage_2020.xlsb'!Einfuegen"
    Range("K8").Select
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_activate()

    Call Finanztabelle_Filter_l|fffd|schen
    Call Finanztabelle_Fehler_Check
    
End Sub

Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_activate()

    Call Zeit_Filter_l|fffd|schen

End Sub
Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_activate()

    Call Ausgaben_Filter_l|fffd|schen
    Call Ausgaben_Formeln_Check
    
End Sub

Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_activate()

    Call Controlling_Filter_l|fffd|schen
    
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
