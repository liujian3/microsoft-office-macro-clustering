Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Modul1"
Sub enable_ein_Projekt()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
    ActiveSheet.Shapes("rectangle 23").Visible = True
    ActiveSheet.Shapes("rechteck 41").Visible = True
    ActiveWindow.DisplayGridlines = False
End Sub
Sub enable_aus_Projekt()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    ActiveSheet.Shapes("rechteck 23").Visible = False
    ActiveSheet.Shapes("rechteck 41").Visible = False
    ActiveWindow.DisplayGridlines = True
    
End Sub
Sub enable_ein_Zone()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub enable_aus_Zone()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
'    ActiveSheet.Shapes("rectangle 1").Visible = False
End Sub
Sub enable_ein_BT()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub enable_aus_BT()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
End Sub
Sub enable_ein()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveWindow.DisplayGridlines = False

End Sub

Sub enable_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
'    ActiveSheet.Shapes("Button 2064").Visible = True 'Kopfdaten
    
    ActiveSheet.Shapes("rechteck 36").Visible = False
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveWindow.DisplayGridlines = True
End Sub
Sub enable_ein_ohne()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

    ActiveWindow.DisplayGridlines = False

End Sub
Sub enable_aus_Ohne()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveWindow.DisplayGridlines = True
End Sub

Sub enable_ein_Schlafen()
'    ActiveSheet.Shapes("rechteck 36").Visible = True
    Application.EnableEvents = True
    Application.ScreenUpdating = True
'    ActiveSheet.Protect
End Sub

Sub enable_ein_Druck()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub enable_aus_Druck()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
End Sub

Sub enable_aus_Schlafen()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
End Sub
Sub enable_aus_Gr|fffd|()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
End Sub
Sub enable_ein_FormBlatt()
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub enable_aus_FormBlatt()
Range("A1").Select
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
End Sub

'Sub enable_aus_FormBlatt()
'Range("A1").Select
'    Application.EnableEvents = False
'    Application.ScreenUpdating = False
'    ActiveSheet.Unprotect
'End Sub
Sub enable_ein_Nomo_AW()
    Application.EnableEvents = truee
    Application.ScreenUpdating = True
    ActiveSheet.Protect
    
    ActiveSheet.Shapes("rectangle 27").Visible = True
End Sub
Sub enable_aus_Nomo_AW()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rectangle 27").Visible = False
End Sub
Sub enable_ein_Nomo_AT_Mess()
    Application.EnableEvents = truee
    Application.ScreenUpdating = True
    ActiveSheet.Protect
    
    ActiveSheet.Shapes("rectangle 11").Visible = True
End Sub
Sub enable_aus_Nomo_AT_Mess()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rectangle 11").Visible = False
End Sub

Sub RahmenAus()

If [q3] = -1 Then
    ActiveSheet.Shapes("Group Box 11").Visible = False
    ActiveSheet.Shapes("Group Box 31").Visible = False
    ActiveSheet.Shapes("Group Box 19").Visible = False

Else
    ActiveSheet.Shapes("Group Box 11").Visible = True
    ActiveSheet.Shapes("Group Box 31").Visible = True
    ActiveSheet.Shapes("Group Box 19").Visible = True

End If

[q3] = [q3] * -1

End Sub
Sub Sortier()

j = 230
For i = 206 To 225
    If Cells(i, 139) > 0 Then
        Cells(j, 159) = Cells(i, 139)
        j = j + 1
    End If
Next

End Sub

Sub Bl|fffd|tter_aus()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Sheets("Hilfsblatt Projekt").Visible = False
Sheets("Hilfsblatt Zone").Visible = False
Sheets("Hilfsblatt-Raum").Visible = False
Sheets("Infiltration 12831 Neu-Z1").Visible = False
Sheets("Gr|fffd|").Visible = False
Sheets("Gro|fffd|e |fffd|ffnungen").Visible = False
Sheets("Raum").Visible = False

End Sub


































Attribute VB_Name = "Modul10"
Sub Luftdichtheit_Tab_11()
MsgBox (678)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = [D101]

If Index < 3 Then
    ActiveSheet.Shapes("dropdown 110905").Visible = True
    Range("O11").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O10").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    [O10] = [G105]
    [O11] = "=O10*G16/G13" 'Umrechnung in n50
  Else
    [O11] = 1.5 'Eingabe n50 (Vorschlag)
    ActiveSheet.Shapes("dropdown 11090").Visible = False
    Range("O10").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O11").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    [O11] =
    [O10] = "=O11*G13/G16" 'Umrechnung in n50
End If

Application.EnableEvents = True
Application.ScreenUpdating = True
'ActiveSheet.Protect

End Sub
Sub Daten_l|fffd|schen()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

[H6] = "" 'Bezeichbnung

[F11] = 0 'L|fffd|nge
[F12] = 0 'Breite
[F14] = 0 'H|fffd|he
If [F15] = 0 Then [F15] = "=2*F11+2*F12" 'Summe AW

['Hilfsblatt Projekt'!D31] = 1 'Delta U-WB
['Hilfsblatt Projekt'!D16] = 1 '
['Hilfsblatt Projekt'!D44] = 1 '
['Hilfsblatt Projekt'!D48] = 1 '
['Hilfsblatt Projekt'!D31] = 1 '
['Hilfsblatt Projekt'!O32] = 1 '
['Hilfsblatt Projekt'!O37] = 2 '
['Hilfsblatt Projekt'!D31] = 2 '
['Hilfsblatt Projekt'!D59] = 1 'HR Wind

['HL Raum'!D8] = "AW1" 'HR Wind
['HL Raum'!D10] = "AW1" 'HR Wind
['HL Raum'!F8] = "AW1" 'HR Wind
['HL Raum'!F10] = "AW1" 'HR Wind

[I23] = 15 'c-eff

[F32] = 3 'w-Wind

[M36] = "=J$36" 'h-Geb|fffd|ude = h-Referenz

[F46] = 0 'Erdreich
[F47] = "=F$15" '
[F48] = "=if(F47>0,F13/(0.5*F47),0)" '

[O52] = False 'Zuschl|fffd|ge in Heizlast?
ActiveSheet.Shapes("rechteck 42").Visible = True

'Application.ScreenUpdating = False
'Sheets("HL Raum").Select
'    Application.ScreenUpdating = False
'    Call Tab_neu
'    Application.ScreenUpdating = False

'Sheets("Projektdaten").Select
'Application.ScreenUpdating = False

Range("H1").Select

z:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Drucken()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

If [J6] = Falsch And [J8] = Falsch And [J10] = Falsch And [J12] = Falsch And [J14] = Falsch And [J16] = Falsch And [J18] = Falsch Then
    MsgBox ("Bitte zumindest eine Druckoption w|fffd|hlen")
    GoTo Ende
End If

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

D1 = [K6]
D2 = [K8]
D3 = [K10]
D4 = [K12]
D5 = [K14]
D6 = [K16]
D7 = [K18]

If D1 = 1 Then
   Sheets("Druck-Projekt").Visible = True
    Sheets("Druck-Projekt").Select
    Range("B2:M53").Activate
    Selection.PrintOut Copies:=1
    Sheets("Druck-Projekt").Visible = False
End If
If D2 = 1 Then
    Sheets("Druck-Projektdaten").Visible = True
    Sheets("Druck-Projektdaten").Select
    Range("B2:O56").Activate
    Selection.PrintOut Copies:=1
    Sheets("Druck-Projektdaten").Visible = False
End If
If D4 = 1 Then
    Sheets("Druck-Raum").Visible = True
    Sheets("Druck-Raum").Select
    Range("B2:Q54").Activate
    Selection.PrintOut Copies:=1
    Sheets("Druck-Raum").Visible = False
End If
If D5 = 1 Then
    If ['DruckBerechnungGr|fffd|'!B29] = 0 Then
        MsgBox ("Es liegt keine Berechnung vor")
        [J14] = False
        GoTo Weiter
      Else
        Sheets("DruckBerechnungGr|fffd|").Visible = True
        Sheets("DruckBerechnungGr|fffd|").Select
        Range("A1:O155").Activate
        Selection.PrintOut Copies:=1
        Sheets("DruckBerechnungGr|fffd|").Visible = False
    End If
End If
Weiter:
If D6 = 1 Then
    Sheets("Faktoren").Visible = True
    Sheets("Faktoren").Select
    Range("A1:S57").Activate
    Selection.PrintOut Copies:=1
    Sheets("Faktoren").Visible = False
End If
If D7 = 1 Then
    Sheets("Schwere").Visible = True
    Sheets("Schwere").Select
    Range("A1:N54").Activate
    Selection.PrintOut Copies:=1
    Sheets("Schwere").Visible = False
End If
If D3 = 1 Then
    Sheets("Druck-BT").Visible = True
    Sheets("Druck-BT").Select
    Range("A1:J50").Activate
    Selection.PrintOut Copies:=1
    Sheets("Druck-BT").Visible = False
End If

Ende:
'Sheets("Drucken").Visible = True
Sheets("Drucken").Select

'GoTo z
Sheets("Druck-Projekt").Visible = False
Sheets("Druck-Projektdaten").Visible = False
Sheets("Druck-BT").Visible = False
Sheets("Druck-Raum").Visible = False
Sheets("DruckBerechnungGr|fffd|").Visible = False
Sheets("Faktoren").Visible = False
Sheets("Schwere").Visible = False
Sheets("Volumenstrom Gr|fffd|").Visible = False

z:

Range("F4").Select
ActiveWindow.DisplayGridlines = False

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub











































Attribute VB_Name = "Modul2"
 
Sub Bildschirm_voll()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

    Application.DisplayFullScreen = True
    
    
    
    ActiveSheet.Shapes("Button 154").Visible = False 'ganzer Bildschirm ein > aus
    ActiveSheet.Shapes("Button 162").Visible = True 'Button Hilfe aus > ein

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Bildschirm_normal()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect
    
    Application.DisplayFullScreen = False
    ActiveSheet.Shapes("Button 154").Visible = True '
    ActiveSheet.Shapes("Button 162").Visible = False '
    
'    ActiveSheet.Shapes("Button 38").Visible = False '
'    ActiveSheet.Shapes("Button 41").Visible = False '
'    ActiveSheet.Shapes("Button 1089").Visible = False '
'    ActiveSheet.Shapes("Button 1092").Visible = False '
    
z:
Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Zonengeb|fffd|ude()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = ['Hilfsblatt Projekt'!D2]

n50 = ['Hilfsblatt Projekt'!$D$44] 'wenn 3, dann aus Messung

Range("M6").Select
If Index = 1 Then
    [M6] = 1
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    ActiveSheet.Shapes("rechteck 38").Visible = True
    Range("F11").Select
  Else
    ActiveSheet.Shapes("rechteck 38").Visible = False
    [L6] = "(mind. 2 Zonen)  "
    [M6] = 2
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Hilfsblatt Projekt'!$D$4:$D$14"
        .ShowError = False
    End With
End If
[F13] = "=F11*F12" 'Geb|fffd|udefl|fffd|che
[M14] = "=AE17" 'Volumen

z:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub W|fffd|rmebr|fffd|cken()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect


Index = ['Hilfsblatt Projekt'!D31]

Range("M20").Select
If Index < 5 Then 'Werte Tab 2
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
     [M20] = "=INDEX('Hilfsblatt Projekt'!G32:G36,'Hilfsblatt Projekt'!D31)"
  Else 'individuelle Eingabe
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Hilfsblatt Projekt'!$D$36:$D$40"
        .ShowError = False
    End With
|fffd|ber1:
End If
    
Range("A1").Select

z:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub W|fffd|rmekapa()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = ['Hilfsblatt Projekt'!D16]

Range("I23").Select

If Index < 3 Then 'Werte Tab 7
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    [I23] = ['Hilfsblatt Projekt'!E16]
    Range("F33").Select
  Else 'individuelle Eingabe
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='Hilfsblatt Projekt'!$G16:$G28"
        .ShowError = False
    End With
End If

z:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Luftdichtheit()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect


Index = ['Hilfsblatt Projekt'!D44]

'Range("J31").Select

If Index < 3 Then 'Werte Tab 7
    [M29] = "=AA20" 'q50
    [J29] = "=M29*M15/M13" 'Umrechnung auf  n50 (31) q50 = q50 *A/V
    Range("J29").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveSheet.Shapes("rechteck 27").Visible = False
    Range("A2").Select
  Else 'individuelle Eingabe
    [J29] = "" 'n50
    [M29] = "=J29*M13/M15" 'Umrechnung auf q50 (31) q50 = n50 *V/A
    Range("J29").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveSheet.Shapes("rechteck 27").Visible = True
'    Range("J29").Select
End If

'GoTo z


z:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Luftdichtheit_Zone()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = ['Hilfsblatt Zone'!E29]


If Index < 3 Then 'Werte Tab 7
    [N11] = "='Hilfsblatt Zone'!H33"
    
    ActiveSheet.Shapes("rechteck 22").Visible = False
    ActiveSheet.Shapes("rechteck 23").Visible = True
    Range("J14").Select
  Else 'individuelle Eingabe
    ActiveSheet.Shapes("rechteck 22").Visible = True
    ActiveSheet.Shapes("rechteck 23").Visible = False
    
    Range("N10").Select
    [N11] = "=N10*G13/n14" 'Umrechnung auf q50 (31) q50 = n50 *V/A

End If

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect


End Sub
Sub Luftdichtheit_Zonen()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = ['Hilfsblatt Zone'!E29]


If Index < 3 Then 'Werte Tab 7
    [T9] = "='Hilfsblatt Zone'!H33"
    
    ActiveSheet.Shapes("rechteck 28").Visible = False
    ActiveSheet.Shapes("rechteck 29").Visible = True
    Range("J14").Select
  Else 'individuelle Eingabe
    ActiveSheet.Shapes("rechteck 28").Visible = True
    ActiveSheet.Shapes("rechteck 29").Visible = False
    
    Range("T7").Select
    [T9] = "=if(j11>0,T7*J10/J11,0)" 'Umrechnung auf q50 (31) q50 = n50 *V/A

End If

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect


End Sub
Sub Innentemp()

ti = Mid([Q21], 7, 1) 'Art det Innentemperatur
TI_E = [AI22] 'erh|fffd|hte Temp

GoTo z

Range("J25:J37").Select
If ti = "S" Or ti = "E" Then
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("B29").Select
  Else
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("B29").Select
End If
If ti = "S" Then
    Cells(ze, 10) = Cells(ze, 9)
    For i = 25 To 37
        Cells(i, 10) = Cells(i, 9)
        If Cells(i, 9) = 0 Then
            Range(Cells(i, 10), Cells(i, 10)).Select
            Selection.ClearContents
            j = i
            i = 37
        End If
    Next
    Range(Cells(j, 1), Cells(j, 1)).Select
End If
If ti = "e" Then 'erh|fffd|hte ti
    Cells(ze, 10) = Cells(ze, 9) + TI_E
    For i = 25 To 37
        Cells(i, 10) = Cells(i, 9) + TI_E
        If Cells(i, 9) = 0 Then
            Range(Cells(i, 10), Cells(i, 10)).Select
            Selection.ClearContents
            j = i
            i = 37
        End If
    Next
    Range(Cells(j, 1), Cells(j, 1)).Select
End If

z:

End Sub

Sub Abschirmung_Z()
    [N14] = "=G12*L14+AG16" 'A-h|fffd|ll
    Range("A1").Select
End Sub

Sub Luftdichtheit_Tab11()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = [D101]

If Index < 3 Then
    ActiveSheet.Shapes("dropdown 110905").Visible = True
    Range("O11").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O10").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    [O10] = [G105]
    [O11] = "=O10*G16/G13" 'Umrechnung in n50
    [M9] = ""
  Else
    [O11] = 1.5 'Eingabe n50 (Vorschlag)
    ActiveSheet.Shapes("dropdown 110905").Visible = False
    Range("O10").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O11").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    [O10] = "=O11*G13/G16" 'Umrechnung in n50
    [M9] = "wird nicht abgefragt, da Messung"
End If

Application.EnableEvents = True
Application.ScreenUpdating = True
'ActiveSheet.Protect

End Sub
Sub Luftdichtheit_Anforderung_Zone()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

    [P12] = ['Hilfsblatt Zone'!G48]

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Wind_Ri()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Sheets("HL Raum").Select

'Hauptwindrichtungspfeile im Hilfetext 'gro|fffd|e |fffd|ffnungen
HR = ['Projektdaten'!F33]

ActiveSheet.Shapes("Richtungspfeil 451").Visible = False ''N
ActiveSheet.Shapes("Richtungspfeil 457").Visible = False 'NNO
ActiveSheet.Shapes("Richtungspfeil 454").Visible = False 'NO
ActiveSheet.Shapes("Richtungspfeil 458").Visible = False 'ONO
ActiveSheet.Shapes("Richtungspfeil 449").Visible = False 'O
ActiveSheet.Shapes("Richtungspfeil 459").Visible = False 'OSO
ActiveSheet.Shapes("Richtungspfeil 455").Visible = False 'SO
ActiveSheet.Shapes("Richtungspfeil 460").Visible = False 'SSO
ActiveSheet.Shapes("Richtungspfeil 452").Visible = False 'S
ActiveSheet.Shapes("Richtungspfeil 461").Visible = False 'SSW
ActiveSheet.Shapes("Richtungspfeil 456").Visible = False 'SW
ActiveSheet.Shapes("Richtungspfeil 464").Visible = False 'WSW
ActiveSheet.Shapes("Richtungspfeil 450").Visible = False 'W
ActiveSheet.Shapes("Richtungspfeil 463").Visible = False 'NWW
ActiveSheet.Shapes("Richtungspfeil 453").Visible = False 'NW
ActiveSheet.Shapes("Richtungspfeil 462").Visible = False 'NNW

If HR = "N" Then ActiveSheet.Shapes("Richtungspfeil 451").Visible = True ''N
If HR = "NNO" Then ActiveSheet.Shapes("Richtungspfeil 457").Visible = True 'NNO
If HR = "NO" Then ActiveSheet.Shapes("Richtungspfeil 454").Visible = True 'NO
If HR = "ONO" Then ActiveSheet.Shapes("Richtungspfeil 458").Visible = True 'ONO
If HR = "O" Then ActiveSheet.Shapes("Richtungspfeil 449").Visible = True 'O
If HR = "OSO" Then ActiveSheet.Shapes("Richtungspfeil 459").Visible = True 'OSO
If HR = "SO" Then ActiveSheet.Shapes("Richtungspfeil 455").Visible = True 'SO
If HR = "SSO" Then ActiveSheet.Shapes("Richtungspfeil 460").Visible = True 'SSO
If HR = "S" Then ActiveSheet.Shapes("Richtungspfeil 452").Visible = True 'S
If HR = "SSW" Then ActiveSheet.Shapes("Richtungspfeil 461").Visible = True 'SSW
If HR = "SW" Then ActiveSheet.Shapes("Richtungspfeil 456").Visible = True 'SW
If HR = "WSW" Then ActiveSheet.Shapes("Richtungspfeil 464").Visible = True 'WSW
If HR = "W" Then ActiveSheet.Shapes("Richtungspfeil 450").Visible = True 'W
If HR = "WNW" Then ActiveSheet.Shapes("Richtungspfeil 463").Visible = True 'NWW
If HR = "NW" Then ActiveSheet.Shapes("Richtungspfeil 453").Visible = True 'NW
If HR = "NNW" Then ActiveSheet.Shapes("Richtungspfeil 462").Visible = True 'NNW

GoTo z
ActiveSheet.Shapes("Richtungspfeil 451").Visible = True ''N
ActiveSheet.Shapes("Richtungspfeil 457").Visible = True 'NNO
ActiveSheet.Shapes("Richtungspfeil 454").Visible = True 'NO
ActiveSheet.Shapes("Richtungspfeil 458").Visible = True 'ONO
ActiveSheet.Shapes("Richtungspfeil 449").Visible = True 'O
ActiveSheet.Shapes("Richtungspfeil 459").Visible = True 'OSO
ActiveSheet.Shapes("Richtungspfeil 455").Visible = True 'SO
ActiveSheet.Shapes("Richtungspfeil 460").Visible = True 'SSO
ActiveSheet.Shapes("Richtungspfeil 452").Visible = True 'S
ActiveSheet.Shapes("Richtungspfeil 461").Visible = True 'SSW
ActiveSheet.Shapes("Richtungspfeil 456").Visible = True 'SW
ActiveSheet.Shapes("Richtungspfeil 464").Visible = True 'WSW
ActiveSheet.Shapes("Richtungspfeil 450").Visible = True 'W
ActiveSheet.Shapes("Richtungspfeil 463").Visible = True 'NWW
ActiveSheet.Shapes("Richtungspfeil 453").Visible = True 'NW
ActiveSheet.Shapes("Richtungspfeil 462").Visible = True 'NNW

z:

ActiveSheet.Protect

Sheets("DruckBerechnungGr|fffd|").Visible = True

Sheets("DruckBerechnungGr|fffd|").Select

        
'Hauptwindrichtungspfeile im Hilfetext 'gro|fffd|e |fffd|ffnungen
HR = ['Projektdaten'!F33]

ActiveSheet.Shapes("Richtungspfeil 451").Visible = False ''N
ActiveSheet.Shapes("Richtungspfeil 457").Visible = False 'NNO
ActiveSheet.Shapes("Richtungspfeil 454").Visible = False 'NO
ActiveSheet.Shapes("Richtungspfeil 458").Visible = False 'ONO
ActiveSheet.Shapes("Richtungspfeil 449").Visible = False 'O
ActiveSheet.Shapes("Richtungspfeil 459").Visible = False 'OSO
ActiveSheet.Shapes("Richtungspfeil 455").Visible = False 'SO
ActiveSheet.Shapes("Richtungspfeil 460").Visible = False 'SSO
ActiveSheet.Shapes("Richtungspfeil 452").Visible = False 'S
ActiveSheet.Shapes("Richtungspfeil 461").Visible = False 'SSW
ActiveSheet.Shapes("Richtungspfeil 456").Visible = False 'SW
ActiveSheet.Shapes("Richtungspfeil 464").Visible = False 'WSW
ActiveSheet.Shapes("Richtungspfeil 450").Visible = False 'W
ActiveSheet.Shapes("Richtungspfeil 463").Visible = False 'NWW
ActiveSheet.Shapes("Richtungspfeil 453").Visible = False 'NW
ActiveSheet.Shapes("Richtungspfeil 462").Visible = False 'NNW

If HR = "N" Then ActiveSheet.Shapes("Richtungspfeil 451").Visible = True ''N
If HR = "NNO" Then ActiveSheet.Shapes("Richtungspfeil 457").Visible = True 'NNO
If HR = "NO" Then ActiveSheet.Shapes("Richtungspfeil 454").Visible = True 'NO
If HR = "ONO" Then ActiveSheet.Shapes("Richtungspfeil 458").Visible = True 'ONO
If HR = "O" Then ActiveSheet.Shapes("Richtungspfeil 449").Visible = True 'O
If HR = "OSO" Then ActiveSheet.Shapes("Richtungspfeil 459").Visible = True 'OSO
If HR = "SO" Then ActiveSheet.Shapes("Richtungspfeil 455").Visible = True 'SO
If HR = "SSO" Then ActiveSheet.Shapes("Richtungspfeil 460").Visible = True 'SSO
If HR = "S" Then ActiveSheet.Shapes("Richtungspfeil 452").Visible = True 'S
If HR = "SSW" Then ActiveSheet.Shapes("Richtungspfeil 461").Visible = True 'SSW
If HR = "SW" Then ActiveSheet.Shapes("Richtungspfeil 456").Visible = True 'SW
If HR = "WSW" Then ActiveSheet.Shapes("Richtungspfeil 464").Visible = True 'WSW
If HR = "W" Then ActiveSheet.Shapes("Richtungspfeil 450").Visible = True 'W
If HR = "WNW" Then ActiveSheet.Shapes("Richtungspfeil 463").Visible = True 'NWW
If HR = "NW" Then ActiveSheet.Shapes("Richtungspfeil 453").Visible = True 'NW
If HR = "NNW" Then ActiveSheet.Shapes("Richtungspfeil 462").Visible = True 'NNW

GoTo x
ActiveSheet.Shapes("Richtungspfeil 451").Visible = True ''N
ActiveSheet.Shapes("Richtungspfeil 457").Visible = True 'NNO
ActiveSheet.Shapes("Richtungspfeil 454").Visible = True 'NO
ActiveSheet.Shapes("Richtungspfeil 458").Visible = True 'ONO
ActiveSheet.Shapes("Richtungspfeil 449").Visible = True 'O
ActiveSheet.Shapes("Richtungspfeil 459").Visible = True 'OSO
ActiveSheet.Shapes("Richtungspfeil 455").Visible = True 'SO
ActiveSheet.Shapes("Richtungspfeil 460").Visible = True 'SSO
ActiveSheet.Shapes("Richtungspfeil 452").Visible = True 'S
ActiveSheet.Shapes("Richtungspfeil 461").Visible = True 'SSW
ActiveSheet.Shapes("Richtungspfeil 456").Visible = True 'SW
ActiveSheet.Shapes("Richtungspfeil 464").Visible = True 'WSW
ActiveSheet.Shapes("Richtungspfeil 450").Visible = True 'W
ActiveSheet.Shapes("Richtungspfeil 463").Visible = True 'NWW
ActiveSheet.Shapes("Richtungspfeil 453").Visible = True 'NW
ActiveSheet.Shapes("Richtungspfeil 462").Visible = True 'NNW

x:

ActiveSheet.Protect


Sheets("Projekt").Select

Range("F9").Select

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Projekt_leer()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:N60").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Projekt_Druck()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:N60").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Projekt_G1()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:N51").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Drucken_Formblatt_Zone_leer()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:N55").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Vereinbarungen()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:K45").Activate
    Selection.PrintOut Copies:=1

Ende:

Range("A1").Select

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Drucken_Formblatt_Zone_Druck()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:V40").Activate
    Selection.PrintOut Copies:=1

Ende:

Range("A1").Select

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_HL()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:O55").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Raumliste()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:M45").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_Luftvolumenstr|fffd|m()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:N45").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Drucken_Formblatt_NU_Einheiten()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:P32").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Drucken_Formblatt_Geb|fffd|ude()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Antwort = MsgBox("Drucker eingeschaltet und drucken ?", vbYesNo)
If Antwort = vbNo Then GoTo Ende

    Range("A1:L55").Activate
    Selection.PrintOut Copies:=1

Ende:

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Wiederaufheiz()

Index = ['Hilfsblatt Projekt'!B26]

If Index = 1 Then ActiveSheet.Shapes("rechteck 22").Visible = True
If Index = 2 Then ActiveSheet.Shapes("rechteck 22").Visible = False

If Index = 1 Then ActiveSheet.Shapes("rechteck 61").Visible = True
If Index = 2 Then ActiveSheet.Shapes("rechteck 61").Visible = False


End Sub

Sub Erdreich_raumweise()

[Q21] = [Q21] * -1

End Sub
Sub Aufheiz()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

If [O52] = False Then 'kein Zuschlag
    ActiveSheet.Shapes("rechteck 42").Visible = True
    [M52] = 0
    [M53] = 0
    [M54] = 0
    Range("M52:M54").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    [M55] = 0.0001
'    Range("M52").Select
  Else
    [M52] = 8
    [M53] = 0.1
    [M54] = 2
 
    Range("M52").Select 'Zuschlag
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$Z$52:$Z$55"
    End With
    Range("M53").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$Y$52:$Y$53"
    End With
    Range("M54").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$X$52:$X$56"
    End With
    ActiveSheet.Shapes("rechteck 42").Visible = False
    [M55] = "=if(F13=0,0,'Hilfsblatt Projekt'!FW93)"
    Range("M52").Select 'Zuschlag
End If

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub






Attribute VB_Name = "Modul21"
Sub Lufttemp()
Attribute Lufttemp.VB_ProcData.VB_Invoke_Func = " \n14"
'
' a Makro
'
GoTo z
'
    ActiveWindow.SmallScroll Down:=-15
    Range("FG1:FU23").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("FG8:FT17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("FG10:FT16").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    Range("FK8:FK17").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("FH8:FJ17").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("FG8:FG9").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("FL8:FT16").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    Range("FH10:FH16").Select
    Selection.NumberFormat = "0.0"
    Selection.NumberFormat = "0.00"
    Range("FI10:FI16").Select
    Selection.NumberFormat = "0.00"
    Range("FJ10:FJ17").Select
    Selection.NumberFormat = "0.00"
    Selection.NumberFormat = "0.0"
    Range("FO10:FQ16").Select
    Selection.NumberFormat = "0.0"
    Range("FR10:FT17").Select
    Selection.NumberFormat = "0.000"
    Selection.NumberFormat = "0.00"
    With Selection
        .HorizontalAlignment = xlGeneral
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("FI3:FI4").Select
    Selection.NumberFormat = "0.000"
    Selection.NumberFormat = "0.00"
    Selection.NumberFormat = "0.0"
    Range("FI7").Select
    Selection.NumberFormat = "0.00"
    Selection.NumberFormat = "0.0"
    Selection.NumberFormat = "0"
    Range("FR19:FT21").Select
    Selection.NumberFormat = "0.000"
    Selection.NumberFormat = "0.00"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("FG2:FJ2").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("FL2:FT3").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("FL7:FT7").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
        Range("FL6:FT6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Bold = True
    Range("FL2:FT3").Select
    Selection.Font.Bold = True
    Range("FG2:FJ2").Select
    Selection.Font.Bold = True
    Range("FG17:FJ17").Select
    With Selection.Font
        .Color = -16776961
        .TintAndShade = 0
    End With
    Selection.Font.Bold = True
    Range("FL17:FT17").Select
    With Selection.Font
        .Color = -16776961
        .TintAndShade = 0
    End With
    Selection.Font.Bold = True
    Range("FQ21:FT21").Select
    With Selection.Font
        .Color = -16776961
        .TintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

z:
End Sub
Attribute VB_Name = "Modul3"
Sub Gro|fffd|e_|fffd|ffnungen_l|fffd|schen()

x = ['Hilfsblatt |fffd|ffnungen'!E28]

If x = 1 Then

    [E18] = 0
    [E19] = 0
    [E20] = 0
    [E21] = 0
    [E22] = 0

    [H18] = 0
    [H19] = 0
    [H20] = 0
    [H21] = 0
    [H22] = 0

    [J19] = 0
    [J20] = 0
    [J21] = 0
    [J22] = 0

End If
End Sub

Attribute VB_Name = "Modul4"

Sub Zone_neu()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Range("A25:Q37").Select 'Tabelle
Selection.ClearContents
Range("S25:U37").Select 'Tabelle
Selection.ClearContents
Range("A25").Select 'G


Sheets("HL Raum").Select

    Application.EnableEvents = False
    ActiveSheet.Unprotect
    
    Range("BS26:CR38").Select
    Selection.ClearContents
    Range("DU26:DW38").Select
    Selection.ClearContents
    Range("G8:G14").Select
    Selection.ClearContents
    Range("AJ14:AK14").Select
    Selection.ClearContents

'    Call Tab_neu
'Application.ScreenUpdating = False

zeA = 24
zeE = 43

'Erst L|fffd|schen
Range("A31:Q45").Select 'Tabelle
Selection.ClearContents
With Selection.Validation 'keine G|fffd|ltigkeiten
    .Delete
    .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
    :=xlBetween
End With
'G|fffd|ltigkeiten
Range("A31").Select 'Z+/Z-
With Selection.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
    xlBetween, Formula1:="=$AX$3:$AX4"
End With
Range("B31").Select 'Orientierung
With Selection.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
    xlBetween, Formula1:="=$AW$8:$AW16"
End With

'1-. Spalte Z+/Z-
Range(Cells(zeA, 1), Cells(zeE, 1)).Select 'O - L/H
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 10092543
    End With
'Felder gr|fffd|n
Range(Cells(zeA, 2), Cells(zeE, 6)).Select 'O - L/H
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0 'frei
    End With
Range(Cells(zeA, 7), Cells(zeE, 16)).Select
With Selection.Interior
    .Pattern = xlSolid
    .PatternColorIndex = xlAutomatic
    .Color = 13434828 'gr|fffd|n
End With

Range("G31:L45").Select 'sperren
Selection.Locked = True
Selection.FormulaHidden = False

Range("G17:G20").Select
With Selection.Interior
    .Pattern = xlSolid
    .PatternColorIndex = xlAutomatic
    .Color = 13434828 'gr|fffd|n
End With
Selection.Locked = True 'sperren
Selection.FormulaHidden = False
Selection.Borders(xlEdgeTop).LineStyle = xlNone 'keine Linien
Selection.Borders(xlEdgeBottom).LineStyle = xlNone
Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

Range("G31:L45").Select 'sperren
Selection.Locked = True
Selection.FormulaHidden = False

Range("A31:F45").Select 'sperren
Selection.Locked = False
Selection.FormulaHidden = False

'Korrektur Linien
Range("B31:P45").Select
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
With Selection.Borders(xlEdgeTop)
    .Weight = xlThin
End With
With Selection.Borders(xlEdgeBottom)
    .Weight = xlThin
End With
With Selection.Borders(xlInsideHorizontal)
    .Weight = xlHairline
End With
    
[G4] = 1
Range("G8").Select

Sheets("Zonen").Select

z:

Application.EnableEvents = True
Application.ScreenUpdating = True
'ActiveSheet.protect

End Sub
Sub R_Nr()

Nr = [G4]
        [K4] = Cells(Nr + 25, 118) 'Bez
        
        [O6] = Cells(Nr + 25, 120) 'LW
        [O12] = Cells(Nr + 25, 121) 'q-zu
        [O14] = Cells(Nr + 25, 122) 'q-ab
        [O15] = Cells(Nr + 25, 123) 'q-ALD
        [O18] = Cells(Nr + 25, 124) 'q-qomb
End Sub

Sub Raum_Kopf_neu()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Range("G8:G12").Select 'Tabelle
Selection.ClearContents

Range("DU26:DW50").Select 'Tabelle
Selection.ClearContents

[O7] = "=G14*O6" 'Vmin
[G10] = "=G8*G9" 'Fl|fffd|che
[G13] = "=G11-G12" 'lichte H|fffd|he
[G14] = "=G10*G13" 'Volumen
[D16] = "=AS21" 'Summe Wandl|fffd|nge
[G16] = "=D16*G11+AJ7" 'A-H|fffd|ll
[G18] = "='Projekt'!O11" 'A-H|fffd|ll

[AK7] = 1 'A-H|fffd|ll ohne FB oder DE
[AJ14] = 0 'L
[AK14] = 0 'B

[O7] = 0.25
[G8] = [AA1]
[G9] = [AA2]
[G11] = [AA3]
[G12] = [AU8]

Call Tab_neu


Range("G8").Select

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub


Sub Tab_neu() 'Tabelle

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

If ['Klimadaten'!M5] = 1 Then 'keine Auswahl
    MsgBox ("Bitte PLZ/Ort im Blatt 'Projektdaten' angeben (Zeile 36)")
    Sheets("Projektdaten").Visible = True
    Sheets("Projektdaten").Select
    GoTo z
End If

zeA = 24
zeE = 43

'Erst L|fffd|schen

Range(Cells(zeA, 2), Cells(zeE, 17)).Select 'sperren
Selection.ClearContents
With Selection.Validation 'keine G|fffd|ltigkeiten
    .Delete
    .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
    :=xlBetween
End With

'G|fffd|ltigkeiten
Range(Cells(zeA, 1), Cells(zeA, 1)).Select 'sperren
With Selection.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
    xlBetween, Formula1:="=$AX$3:$AX4"
End With
Range(Cells(zeA, 2), Cells(zeA, 2)).Select 'sperren
With Selection.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
    xlBetween, Formula1:="=$AW$8:$AW16"
End With
'1-. Spalte Z+/Z-
Range(Cells(zeA, 1), Cells(zeE, 1)).Select 'O - L/H
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 10092543
    End With
'Felder gr|fffd|n
Range(Cells(zeA, 2), Cells(zeE, 6)).Select 'O - L/H
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0 'frei
    End With
Range(Cells(zeA, 7), Cells(zeE, 16)).Select
With Selection.Interior
    .Pattern = xlSolid
    .PatternColorIndex = xlAutomatic
    .Color = 13434828 'gr|fffd|n
End With

Range(Cells(zeA, 2), Cells(zeE, 16)).Select 'sperren
Selection.Locked = True
Selection.FormulaHidden = False

Range(Cells(zeA, 7), Cells(zeE, 12)).Select 'sperren
'Range("G31:L51").Select 'sperren
Selection.Locked = True
Selection.FormulaHidden = False

Range(Cells(zeA, 2), Cells(zeE, 6)).Select 'sperren
'Range("A31:F51").Select 'sperren
Selection.Locked = False
Selection.FormulaHidden = False

'Korrektur Linien
Range(Cells(zeA, 2), Cells(zeE, 16)).Select 'sperren
'Range("B24:P43").Select
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
Selection.Borders(xlDiagonalUp).LineStyle = xlNone
With Selection.Borders(xlEdgeTop)
    .Weight = xlThin
End With
With Selection.Borders(xlEdgeBottom)
    .Weight = xlThin
End With
With Selection.Borders(xlInsideHorizontal)
    .Weight = xlHairline
End With
    
[B24] = ""

ActiveSheet.Shapes("rechteck 3").Visible = True 'nur, wenn Gr|fffd|

Range("B24").Select

z:

Application.EnableEvents = True
Application.ScreenUpdating = True

ActiveSheet.Protect

End Sub

Sub FB_B()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

zeA = 31
zeE = 45

'Korrektur FB
If zeFB <> "" Then
    For i = zeA To zeE
        If Left(Cells(i, 3), 2) = "FB" Then
            zeFB = i
            i = zeE
        End If
    Next
Cells(zeFB, 15) = Cells(zeFB, 105)
End If

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Zusatz_H()

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

If [J56] = "ja" Then
    [N56] = "='Projekt'!M59"
    Range("N56").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0 'frei
    End With
  Else
    [N56] = 0
    Range("N56").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
End If
Range("B31").Select

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Sub Au|fffd|enMa|fffd|e()
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect
   
Index = [AK7]

[G16] = 0

'zun|fffd|chst l|fffd|schen
[BB3] = "" 'Wandtyp L1
[BE3] = "" 'Wandtyp L1
[BC28] = "" 'Wandtyp L1
[BE28] = "" 'Wandtyp L1
    
    
[BC3] = 0 'Wanddicke L1
[BF3] = 0 'Wanddicke L2
[BD28] = 0 'Wanddicke B1
[BF28] = 0 'Wanddicke B2


UserForm2.ComboBox2 = "AW" 'Range("BB2") 'Vorschlag Wandtyp "AW"
UserForm2.ComboBox5 = "AW" 'Range("BE2") 'Vorschlag Wandtyp "IW"
UserForm2.ComboBox6 = "IW" 'Range("BB2") 'Vorschlag Wandtyp "AW"
UserForm2.ComboBox7 = "IW" 'Range("BE2") 'Vorschlag Wandtyp "IW"
        
 '   If Index = 1 Then GoTo z
    
'UserForm2.Show
        
WL1 = [BB3] 'Wandtyp L1
WL2 = [BE3] 'Wandtyp L1
WB1 = [BC28] 'Wandtyp L1
WB2 = [BE28] 'Wandtyp L1
    
    
L1 = [BC3] 'Wanddicke L1
L2 = [BF3] 'Wanddicke L2
B1 = [BD28] 'Wanddicke B1
B2 = [BF28] 'Wanddicke B2
    
Multi_L1 = 1 'L1
If WL1 = "IW" Then Multi_L1 = 0.5
Multi_L2 = 1 'L2
If WL2 = "IW" Then Multi_L2 = 0.5
Multi_B1 = 1 'B1
If WB1 = "IW" Then Multi_B1 = 0.5
Multi_B2 = 1 'B2
If WB2 = "IW" Then Multi_B2 = 0.5
        
L = [AJ13] + Multi_L1 * L1 + Multi_L2 * L2 'L|fffd|nge - addieren der Dicken (IW/2)
b = [AK13] + Multi_B1 * B1 + Multi_B2 * B2 'Breite - addieren der Dicken (IW/2)

[AJ14] = L
[AK14] = b

'MsgBox (" L1 = " & L1 & " L2 =  " & L2 & "  B1 =  " & B1 & " B2 =  " & B2)
z:

[G16] = "=D16*G11+AJ7"

Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub Korr_Tab_Linien()
zeA = 24
zeE = 43
    'Korrektur Linien
    Range(Cells(zeA, 2), Cells(zeE, 16)).Select
    'Range("B31:P45").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .Weight = xlHairline
    End With
End Sub
Attribute VB_Name = "Modul5"
Sub Hilfe_BeL|fffd|_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Rechteck 36").Visible = True
    ActiveSheet.Shapes("Button 223").Visible = True 'Hilfe-BeL|fffd| aus
    
    Columns("Q:EA").Select
    Selection.EntireColumn.Hidden = False
    
    ActiveSheet.Shapes("Rechteck 6335").Visible = False 'Hilfetext Kopfdaten
    ActiveSheet.Shapes("Rechteck 6343").Visible = False 'Hilfetext Tabelle
    
    'alle anderen Buttons unsichtbar (st|fffd|ren)
    ActiveSheet.Shapes("Button 222").Visible = False 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = False 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = False 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = False 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = False 'Temperature
    ActiveSheet.Shapes("Button 26902").Visible = False 'Temperature
    
    ActiveSheet.Shapes("rechteck 36").Visible = False
    ActiveSheet.Shapes("rechteck 69").Visible = True
        
    Range("A1").Select

    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_BeL|fffd|_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("rechteck 69").Visible = False
    
    ActiveSheet.Shapes("Button 222").Visible = True 'Hilfe-BeL|fffd| ein
    ActiveSheet.Shapes("Button 223").Visible = False 'Hilfe-BeL|fffd| aus
    
    'alle anderen Buttons wieder sichtbar
    ActiveSheet.Shapes("Button 222").Visible = True 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = True 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = True 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = True 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = True 'Temperaturen
    
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_gr|fffd|_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = False
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveSheet.Shapes("Button 711").Visible = True 'Hilfe-aus
    
    Columns("S:DZ").Select
    Selection.EntireColumn.Hidden = True
    
    'alle anderen Buttons unsichtbar (st|fffd|ren)
    ActiveSheet.Shapes("Button 222").Visible = False 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = False 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = False 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = False 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = False 'Tabelle
    ActiveSheet.Shapes("Button 26902").Visible = False 'Hilfe-ein Skizze
    
    Range("A1").Select
        
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub

Sub Hilfe_MitLuTemp_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    ActiveSheet.Shapes("rechteck 36").Visible = False
    ActiveSheet.Shapes("Button 711").Visible = False 'Hilfe-aus
    ActiveSheet.Shapes("Button 26902").Visible = True 'Hilfe-ein Skizze
'    ActiveSheet.Shapes("Button 109485").Visible = True 'Hilfe-ein Lufttemp
    ActiveSheet.Shapes("Button 136601").Visible = False 'Hilfe-aus Lufttemp
    ActiveSheet.Shapes("Button 136602").Visible = True 'Hilfe-aus Lufttemp
    
    Columns("S:FE").Select
    Selection.EntireColumn.Hidden = True

    'alle anderen Buttons unsichtbar (st|fffd|ren)
    ActiveSheet.Shapes("Button 222").Visible = False 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = False 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = False 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = False 'Tabelle
    ActiveSheet.Shapes("Button 26902").Visible = False 'Hilfe-aus Lufttemp
    
    Call Lufttemp
    
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
        
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
z:

End Sub
'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Sub Hilfe_MitLuTemp_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("Button 2064").Visible = True 'Hilfe-ein Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = True 'Hilfe-ein Tabelle
    ActiveSheet.Shapes("Button 222").Visible = True 'Hilfe-ein gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 1085").Visible = True 'Hilfe-ein gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 26902").Visible = False 'Hilfe-ein Skizze
    ActiveSheet.Shapes("Button 109485").Visible = False 'Hilfe-ein Lufttemp
    ActiveSheet.Shapes("Button 136601").Visible = True 'Hilfe-aus Lufttemp
    ActiveSheet.Shapes("Button 136602").Visible = False 'Hilfe-aus Lufttemp
   
    'alle anderen Buttons wieder sichtbar
    ActiveSheet.Shapes("Button 26902").Visible = True 'Hilfe-aus Lufttemp
    ActiveSheet.Shapes("Button 711").Visible = False 'Hilfe-aus

 '   ActiveSheet.Shapes("rechteck 36").Visible = False
    
    Columns("S:FF").Select
    Selection.EntireColumn.Hidden = False
'    Columns("Q:EA").Select
'    Selection.EntireColumn.Hidden = False

    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
z:

End Sub

Sub Hilfe_Projekt_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 14").Visible = True
 '   ActiveSheet.Shapes("rechteck 41").Visible = True
    ActiveSheet.Shapes("Button 155").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 156").Visible = True 'Hilfe-aus
    
 '   Sheets("Klimadaten").Select
 '   Sheets("Klimadaten").Visible = True
'    Sheets("Gr|fffd|").Select
'    Sheets("Gr|fffd|").Visible = True
   
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Projekt_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 14").Visible = False
    ActiveSheet.Shapes("Button 155").Visible = True 'Hilfe-ein
    ActiveSheet.Shapes("Button 156").Visible = False 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_ProjektDaten_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 2").Visible = True
    ActiveSheet.Shapes("rechteck 41").Visible = True
    ActiveSheet.Shapes("Button 4964").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 4970").Visible = True 'Hilfe-aus
    
    ActiveWindow.DisplayGridlines = False
   
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_ProjektDaten_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 2").Visible = False
    ActiveSheet.Shapes("Button 4964").Visible = True 'Hilfe-ein
    ActiveSheet.Shapes("Button 4970").Visible = False 'Hilfe-au
       
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Zone_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("Button 680").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 682").Visible = True 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Zone_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = False
    ActiveSheet.Shapes("Button 680").Visible = True 'Hilfe-ein
    ActiveSheet.Shapes("Button 682").Visible = False 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Bauteile_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 2").Visible = True
    ActiveSheet.Shapes("Button 6").Visible = True 'Hilfe-ein
    ActiveSheet.Shapes("Button 5").Visible = False 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Bauteile_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 2").Visible = False
    ActiveSheet.Shapes("Button 6").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 5").Visible = True 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

End Sub
Sub Hilfe_gr|fffd|_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("Button 711").Visible = False 'Hilfe-aus
    ActiveSheet.Shapes("Button 109485").Visible = False 'Hilfe-aus Lufttemp
   
    'alle anderen Buttons wieder sichtbar
    ActiveSheet.Shapes("Button 222").Visible = True 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = True 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = True 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = True 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = True 'Temperaturen

    Columns("Q:EA").Select
    Selection.EntireColumn.Hidden = False
    
    Range("A1").Select
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_gr|fffd|_Skizze_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Grafik 3").Visible = True
    ActiveSheet.Shapes("Button 26900").Visible = True 'Hilfe-ein
    ActiveSheet.Shapes("Button 26902").Visible = False 'Hilfe-aus
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_gr|fffd|_Skizze_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Grafik 3").Visible = False
    ActiveSheet.Shapes("Button 26900").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 26902").Visible = True 'Hilfe-aus
    ActiveSheet.Shapes("Button 2064").Visible = True 'Hilfe-ein
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub

Sub Hilfe_Kopf_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveSheet.Shapes("Button 2064").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 2065").Visible = True 'Hilfe-aus
    ActiveSheet.Shapes("Button 136602").Visible = False 'Hilfe-aus Lufttemp
    
    ActiveSheet.Shapes("Button 711").Visible = True 'Hilfe-aus
    
    'alle anderen Buttons auf "ein"
    ActiveSheet.Shapes("Button 222").Visible = True 'Hilfe-BeL|fffd| ein
    ActiveSheet.Shapes("Button 223").Visible = False 'Hilfe-BeL|fffd| aus
    ActiveSheet.Shapes("Button 1085").Visible = True 'Hilfe-Gr|fffd| ein
    ActiveSheet.Shapes("Button 711").Visible = False 'Hilfe-Gr|fffd| aus
    ActiveSheet.Shapes("Button 109485").Visible = False 'Hilfe-aus Lufttemp
    ActiveSheet.Shapes("Button 26902").Visible = False 'Hilfe-Skizze
    ActiveSheet.Shapes("Button 136601").Visible = False 'Hilfe-mittl. Temperaturen-ein
    ActiveSheet.Shapes("Button 136602").Visible = False '"-" - aus
    
    'alle anderen Buttons unsichtbar (st|fffd|ren)
    ActiveSheet.Shapes("Button 222").Visible = False 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = False 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = False 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = False 'Tabelle
    
    'Position
    ActiveSheet.Shapes("Rechteck 6335").Visible = True
    ActiveSheet.Shapes("Rechteck 6335").Select
    ActiveSheet.Shapes("Rectangle 6335").Left = 595
    ActiveSheet.Shapes("Rectangle 6335").Top = 60
    Selection.ShapeRange.Height = 580
    Selection.ShapeRange.Width = 400
    
    ActiveWindow.DisplayGridlines = False

 '   ActiveSheet.Shapes.Range(Array("Rectangle 1")).Select
 '   Selection.ShapeRange.ZOrder msoBringToFront

    Range("A1").Select
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Kopf_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Rechteck 6335").Visible = False

    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveSheet.Shapes("Button 2065").Visible = False 'Hilfe-Kopf aus
    ActiveSheet.Shapes("Button 136602").Visible = False 'Hilfe-aus Lufttemp

    'alle anderen Buttons wieder sichtbar
    ActiveSheet.Shapes("Button 222").Visible = True 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = True 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = True 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = True 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = True 'Hilfe-mittl. Temperaturen-ein
 
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub

Sub Hilfe_Tab_ein()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect

    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveSheet.Shapes("Button 2067").Visible = False 'Hilfe-ein
    ActiveSheet.Shapes("Button 2068").Visible = True 'Hilfe-aus
    ActiveSheet.Shapes("Button 136777").Visible = True 'Hilfe-ein Bruttofl|fffd|chen
    ActiveSheet.Shapes("Button 136778").Visible = False 'Hilfe-aus Bruttofl|fffd|chen
    ActiveSheet.Shapes("Button 137313").Visible = True 'Hilfe-ein Bruttofl|fffd|chen
    ActiveSheet.Shapes("Button 137314").Visible = False 'Hilfe-aus Bruttofl|fffd|chen

    'alle anderen Buttons unsichtbar (st|fffd|ren)
    ActiveSheet.Shapes("Button 222").Visible = False 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = False 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = False 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = False 'Tabelle
'    ActiveSheet.Shapes("Button 109214").Visible = False 'Hilfe-aus Lufttemp
'    ActiveSheet.Shapes("Button 109485").Visible = False 'Hilfe-aus Lufttemp
'    ActiveSheet.Shapes("Button 136777").Visible = False 'Hilfe-mittl. Temperaturen-ein
    ActiveSheet.Shapes("Button 136601").Visible = False 'Hilfe-ein Lufttemp
    ActiveSheet.Shapes("Button 136602").Visible = False 'Hilfe-aus Lufttemp

    ActiveSheet.Shapes("Rechteck 6343").Visible = True
    ActiveSheet.Shapes("Rechteck 6343").Select
    ActiveSheet.Shapes("Rectangle 6343").Left = 595
    ActiveSheet.Shapes("Rectangle 6343").Top = 60
    Selection.ShapeRange.Height = 755
30
    Selection.ShapeRange.Width = 500
    
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Tab_aus()
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Rechteck 6343").Visible = False
    ActiveSheet.Shapes("Rechteck 2").Visible = False 'Hilfetext Bruttofl|fffd|chen

    ActiveSheet.Shapes("rechteck 36").Visible = True
    ActiveSheet.Shapes("rechteck 69").Visible = False
    ActiveSheet.Shapes("rechteck 2").Visible = False 'Hilfe-Bruttofl|fffd|chen
    ActiveSheet.Shapes("rechteck 92").Visible = False ' dito Abzugsfl|fffd|chen
   
    
    ActiveSheet.Shapes("Button 2068").Visible = False 'Hilfe-Kopf aus
    ActiveSheet.Shapes("Button 109485").Visible = False 'Hilfe-Lufttemp
    ActiveSheet.Shapes("Button 136777").Visible = False 'Hilfe-Bruttofl|fffd|chen ein
    ActiveSheet.Shapes("Button 136778").Visible = False 'Bruttofl|fffd|chen aus
    
    'alle anderen Buttons wieder sichtbar
    ActiveSheet.Shapes("Button 222").Visible = True 'L|fffd|ftung
    ActiveSheet.Shapes("Button 1085").Visible = True 'Gro|fffd|e |fffd|ffnungen
    ActiveSheet.Shapes("Button 2064").Visible = True 'Kopfdaten
    ActiveSheet.Shapes("Button 2067").Visible = True 'Tabelle
    ActiveSheet.Shapes("Button 136601").Visible = True 'Hilfe-mittl. Temperaturen-ein
    ActiveSheet.Shapes("Button 136602").Visible = False '"-" - aus
    ActiveSheet.Shapes("Button 136777").Visible = False 'Hilfe-Bruttofl|fffd|chen
    ActiveSheet.Shapes("Button 136778").Visible = False '"-" - aus
    ActiveSheet.Shapes("Button 137313").Visible = False 'Hilfe-Abzugsfl|fffd|chen
    ActiveSheet.Shapes("Button 137314").Visible = False '"-" - aus

    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect
End Sub
Sub Hilfe_Bruttofl|fffd|chen_ein()
    
    ActiveSheet.Shapes("rechteck 2").Visible = True 'Hilfetext Bruttofl|fffd|chen
    ActiveSheet.Shapes("rechteck 92").Visible = False 'Hilfetext Abzugsfl|fffd|chen
    ActiveSheet.Shapes("rectangle 6343").Visible = False 'Hilfetext Abzugsfl|fffd|chen
   
    ActiveSheet.Shapes("Button 136777").Visible = False 'Hilfetext Bruttofl|fffd|chen ein ausschalten
    ActiveSheet.Shapes("Button 136778").Visible = True 'L|fffd|ftung
    ActiveSheet.Shapes("Button 137313").Visible = True 'Hilfe-Kopf ein
    ActiveSheet.Shapes("Button 137314").Visible = False 'Hilfe-Kopf aus
 
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
 '   Application.EnableEvents = True
 '  Application.ScreenUpdating = True
 '   ActiveSheet.Protect
End Sub
Sub Hilfe_Bruttofl|fffd|chen_aus()
'    Application.EnableEvents = False
'    Application.ScreenUpdating = False
'    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Rechteck 2").Visible = False
    ActiveSheet.Shapes("rectangle 6343").Visible = True 'Hilfetext Hauptmen|fffd|
    
    ActiveSheet.Shapes("Button 136778").Visible = False 'Hilfe-Kopf aus
    ActiveSheet.Shapes("Button 136777").Visible = True 'L|fffd|ftung
 
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
 '   Application.EnableEvents = True
 '  Application.ScreenUpdating = True
 '   ActiveSheet.Protect
End Sub
Sub Hilfe_Abzugsfl|fffd|chen_ein()
    
    ActiveSheet.Shapes("rechteck 92").Visible = True 'Hilfetext Bruttofl|fffd|chen
    ActiveSheet.Shapes("rechteck 2").Visible = False 'Hilfetext Bruttofl|fffd|chen
    ActiveSheet.Shapes("rectangle 6343").Visible = False 'Hilfetext Abzugsfl|fffd|chen
    
    ActiveSheet.Shapes("Button 137314").Visible = True 'Hilfetext Bruttofl|fffd|che aus
    ActiveSheet.Shapes("Button 137313").Visible = False 'Hilfe-Bruttofl|fffd|che ein
    ActiveSheet.Shapes("Button 136777").Visible = True 'Hilfetext Abzugsfl|fffd|che ein
    ActiveSheet.Shapes("Button 136778").Visible = False 'Hilfetext Abzugsfl|fffd|che aus
 
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
 '   Application.EnableEvents = True
 '  Application.ScreenUpdating = True
 '   ActiveSheet.Protect
End Sub
Sub Hilfe_Abzugsfl|fffd|chen_aus()
'    Application.EnableEvents = False
'    Application.ScreenUpdating = False
'    ActiveSheet.Unprotect
    
    ActiveSheet.Shapes("Rechteck 92").Visible = False
    ActiveSheet.Shapes("rectangle 6343").Visible = True 'Hilfetext Hauptmen|fffd|
    
    ActiveSheet.Shapes("Button 137314").Visible = False 'Hilfe-Kopf aus
    ActiveSheet.Shapes("Button 137313").Visible = True 'Hilfe-Kopf aus
 
    Range("A1").Select
    
    ActiveWindow.DisplayGridlines = False
    
 '   Application.EnableEvents = True
 '  Application.ScreenUpdating = True
 '   ActiveSheet.Protect
End Sub

Sub xyz()
    ActiveSheet.Shapes("Rechteck 6343").Visible = True

End Sub

Sub Nomo_AW()

    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect

    Index = [AK12]

    U = [D11]
    Sheets("Bauteile").Select
    
    Cells(Index + 3, 4) = U
    
    Sheets("Nomo-AW+IW").Select

    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

End Sub
Sub Nomo_IW()

    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect

    Index = [AK25]

    U = [D23]
    
    Sheets("Bauteile").Select
    
    Cells(Index + 16, 4) = U

    Sheets("Nomo-AW+IW").Select

    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

End Sub

Sub Temp_Mess()

    Application.EnableEvents = False
    Application.ScreenUpdating = False
    ActiveSheet.Unprotect

    Index = [Z7]

    U = [E12]
    y = [V5]
    Sheets("Bauteile").Select
    
    Cells(Index + y, 4) = U
    
    Sheets("U-Messung").Select

    Application.EnableEvents = True
    Application.ScreenUpdating = True
    ActiveSheet.Protect

End Sub

Sub L|fffd|sch_AW()
    Range("E5:I9").Select
    Selection.ClearContents
    Range("D5").Select '
End Sub
Sub L|fffd|sch_AF()
    Range("E10:H14").Select
    Selection.ClearContents
    Range("D10").Select
End Sub
Sub L|fffd|sch_AT()
    Range("E15:H17").Select
    Selection.ClearContents
    Range("F15:G17").Select
    Selection.ClearContents
    Range("D15").Select
End Sub
Sub L|fffd|sch_IW()
    Range("E21:I25").Select
    Selection.ClearContents
    Range("D21").Select
End Sub
Sub L|fffd|sch_Gr|fffd|()
    Range("E18:H20").Select
    Selection.ClearContents
    Range("F18").Select
End Sub
Sub L|fffd|sch_IF()
    Range("E26:H27").Select
    Selection.ClearContents
    Range("G26:H27").Select
    Selection.ClearContents
    Range("E26").Select
End Sub
Sub L|fffd|sch_IT()
    Range("E28:H29").Select
    Selection.ClearContents
    Range("G28:H29").Select
    Selection.ClearContents
    Range("E28").Select
End Sub
Sub L|fffd|sch_DE()
    Range("E30:I31").Select
    Selection.ClearContents
    Range("E30").Select
End Sub
Sub L|fffd|sch_DA()
    Range("E32:I33").Select
    Selection.ClearContents
    Range("E32").Select
End Sub
Sub L|fffd|sch_DF()
    Range("E34:H35").Select
    Selection.ClearContents
    Range("G34:H35").Select
    Selection.ClearContents
    Range("E34").Select
End Sub
Sub L|fffd|sch_FB()
    Range("E36:H37").Select
    Selection.ClearContents
    Range("E36").Select
End Sub

Sub Druck_Einzel()

[J6] = "False"
[J8] = "False"
[J10] = "False"
[J12] = "False"
[J14] = "False"
[J16] = "False"
[J18] = "False"

End Sub

Sub Druck_Alle()

[J6] = "True"
[J8] = "true"
[J10] = "true"
[J12] = "true"
[J14] = "true"
[J16] = "true"
[J18] = "true"

End Sub






















Attribute VB_Name = "Modul6"
Attribute VB_Name = "Modul7"
Attribute VB_Name = "Modul8"
Attribute VB_Name = "Modul9"
Sub a()
Attribute a.VB_ProcData.VB_Invoke_Func = " \n14"
'
' a Makro
'

'
    Range("E26").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$BM$2:$BM$4"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
    
Private Sub Worksheet_Change(ByVal Target As Range)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect
    
    If ['DruckBerechnungGr|fffd|'!B29] = 0 Then
        MsgBox ("Es liegt keine Berechnung vor")
        GoTo Ende
    
        [J14] = False
    
    
    End If

Ende:





Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Attribute VB_Name = "Tabelle20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public ze, sp, zeA, zeE, zeL, zeL_Korr, FlagAbzug, FlagZwi, FlagL|fffd|, FlagAW, FlagIW, FlagDE, FlagDA, FlagFB
Public U_AW, Art

Private Sub Worksheet_Change(ByVal Target As Range)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

ze = Target.Row
sp = Target.Column

zeA = 24
zeE = 43

ti = [G6]
ta = [A1]

'Alle Flags l|fffd|schen (Null setzen)
FlagZwi = 0
FlagL|fffd| = 0
FlagAbzug = 0
FlagAW = 0
FlagIW = 0
FlagDE = 0
FlagDA = 0
FlagFB = 0

'Ermittlung letzte Zeile
Call zeLetzt
If ze = zeA Then zeL = zeA

'Entsperren Z+/Z-
Range(Cells(zeA, 1), Cells(zeL + 1, 3)).Select
Selection.Locked = False
Selection.FormulaHidden = False
'Sperren unbelegte Zeilen
If ze > zeA Then
    Range(Cells(zeL + 1, 1), Cells(zeE, 1)).Select
    Selection.Locked = True
    Selection.FormulaHidden = False
    Range(Cells(zeL + 2, 1), Cells(zeE, 6)).Select 'Restzeilen + 1 auch sperren
    Selection.Locked = True
    Selection.FormulaHidden = False
End If
If [G5] < 5 Or [G5] > 30 Then
    MsgBox ("Bitte Eingabe zwischen 5 bis 30|fffd|C eingeben" & Chr(13) & Chr(13) & "Vorschlagswert Innentemperatur = 20|fffd|C")
    [G5] = 20
    GoTo z
End If

'Kontrolle, ob Anschl|fffd|sse eingegeben wurden
If ze > 23 And [E8] = 0 Then
    MsgBox ("Bitte linken Anschluss Au|fffd|enwandl|fffd|nge eingeben!")
    Range("D8").Select
    GoTo z
End If
If ze > 23 And [G8] = 0 Then
    MsgBox ("Bitte rechten Anschluss Au|fffd|enwandl|fffd|nge eingeben!")
    Range("F8").Select
    GoTo z
End If
If ze > 23 And [E10] = 0 Then
    MsgBox ("Bitte linken Anschluss Au|fffd|enwandbreite eingeben!")
    Range("D10").Select
    GoTo z
End If
If ze > 23 And [G10] = 0 Then
    MsgBox ("Bitte rechten Anschluss Au|fffd|enwandbreite eingeben!")
    Range("F10").Select
    GoTo z
End If
If ze > 23 And [G13] = 0 Then
    MsgBox ("Bitte Dach- oder Deckendicke eingeben!")
    Range("D13").Select
    GoTo z
End If
    
'Kontrolle, ob LW-min eingegeben
If [O8] < 0.01 Or [O8] > 1 Then
    MsgBox ("Bitte Eingabe Mindest-LW zwischen 0,01 bis 1,00 h-1 eingeben" & Chr(13) & Chr(13) & "Vorschlagswert Mindest-LW = 0,25 h-1")
    [O8] = 0.25
    GoTo z
End If

If ze = 8 And sp = 15 Then Range("B24").Select
'unvollst|fffd|ndige Eingabe
    For i = ze - 1 To zeA Step -1
        If Cells(i, 4) = 0 Then
            MsgBox ("Bitte in Zeile " & i & " die Anzahl eingeben")
            Range(Cells(i, 4), Cells(i, 4)).Select
            i = zeA
            GoTo z
        End If
        If Cells(i, 5) = 0 Then
            MsgBox ("Bitte in Zeile " & i & " die Breite eingeben")
            Range(Cells(i, 5), Cells(i, 5)).Select
            i = zeA
            GoTo z
        End If
        If Cells(i, 6) = 0 Then
            MsgBox ("Bitte in Zeile " & i & " die L|fffd|nge/H|fffd|he eingeben")
            Range(Cells(i, 6), Cells(i, 5)).Select
            i = zeA
            GoTo z
        End If
    Next

'Zeilen zwischenf|fffd|gen
'====================
'Pr|fffd|fung, ob noch Zeilen zwischengef|fffd|gt werden k|fffd|nnen
If ze > zeA - 1 And Cells(ze, 1) = "Z+" And Cells(zeE, 4) > 0 Then
    MsgBox ("max. Anzahl Zeilen 14 erreicht - kein weitere Eingabe von Bauteilen m|fffd|glich")
    Cells(ze, 1) = ""
    Range("B8").Select
    GoTo z
End If
'Kein Zwischenf|fffd|gen, wenn leere Zeile (= nach letzter Zeile)
If Cells(ze, 1) = "Z+" And Cells(ze, 4) = 0 Then
    MsgBox ("kein weiteres Zwischenf|fffd|gen m|fffd|glich")
    Cells(ze, 1) = ""
    GoTo z
End If
'Zwischenf|fffd|gen
If Cells(ze, 1) = "Z+" Then
    
    FlagZwi = 1
    'Sperren Z+/Z-
    Range("A24:A43").Select
    Selection.Locked = True
    Selection.FormulaHidden = False
    'Entsperren Z+/Z-
    Range(Cells(ze, 1), Cells(ze, 1)).Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    'Ermittlung letzte Zeile nach Zwischenf|fffd|gen
    For i = zeE To zeA Step -1
        If Cells(i, 3) <> 0 Or Cells(i, 3) <> "" Then
            zeL = i + 1 '+1, da zwischengef|fffd|gte Zeile zugezogen werden muss
            i = zeA
        End If
    Next
    Cells(ze, 1) = "" 'Feld wieder leer
    Art = (Left(Cells(ze, 3), 1)) 'Ermittlung gleicher zugeh|fffd|riger Abzugsfl|fffd|chen zur Bruttofl|fffd|che
    'Pr|fffd|fen, ob schon Leerzeile vorhanden

    'eine Zeile nach unten verschieben
    '=================================
    Range(Cells(ze, 2), Cells(zeE - 1, 17)).Select
    Selection.Copy
    Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
    Worksheets("HL Raum").Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
    Range(Cells(ze, 2), Cells(ze, 16)).Select
    Selection.ClearContents
    
    Range(Cells(ze, 26), Cells(zeE - 1, 28)).Select
    Selection.Copy
    Range(Cells(ze + 1, 26), Cells(ze + 1, 28)).Select
    Worksheets("HL Raum").Range(Cells(ze + 1, 26), Cells(ze + 1, 28)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
    Range(Cells(ze, 26), Cells(ze, 28)).Select
    Selection.ClearContents
   
    Range(Cells(ze, 10), Cells(ze, 13)).Select
    With Selection.Validation 'keine G|fffd|ltigkeiten
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True
    Selection.FormulaHidden = False
    zeL_Korr = zeL 'wichtig
    Call L|fffd|_Zwi
    'Orientierungen am Ende der Berechnung herstellen (nur wenn letzte Abzugsfl|fffd|che bzw. vor einer Bruttofl|fffd|che)
    Range(Cells(ze, 2), Cells(ze, 2)).Select 'zun|fffd|chst l|fffd|schen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    If Cells(ze + 1, 2) <> 0 Or Cells(ze + 1, 2) <> "" Then 'Nachfolgezeile ist Bruttozeile
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AW$8:$AW$16"
        End With
    End If
    'Position Cursor
 'GoTo z
     If Cells(ze - 1, 2) <> 0 And Cells(ze - 1, 8) = 0 Or Cells(ze - 1, 2) <> "" And Cells(ze - 1, 8) = 0 And ze > zeA Then
        
        Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
        If Left(Cells(zeL, 3), 2) = "DE" Or Left(Cells(zeL, 3), 1) = "F" Then
'MsgBox (Cells(zeL + 1, 2))
            Range(Cells(ze, 2), Cells(ze, 2)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AW$8:$AW$16" 'Orientierungen
            End With
            Range(Cells(zeL + 1, 3), Cells(zeL + 1, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
                :=xlBetween
            End With
            If Left(Cells(ze, 3), 2) = "DE" Or Left(Cells(ze, 3), 1) = "F" Then
                Range(Cells(ze, 3), Cells(ze, 6)).Select 'Spalte BT etc. l|fffd|schen
                With Selection.Validation
                    .Delete
                    .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
                    :=xlBetween
                End With
            End If
        End If
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        GoTo z
      Else
        If ze = zeA Then
            Range(Cells(ze, 2), Cells(ze, 2)).Select 'HR
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AW$8:$AW$16"
            End With
            Range(Cells(zeL + 1, 3), Cells(zeL + 1, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
                :=xlBetween
            End With
            Range(Cells(ze, 3), Cells(ze, 6)).Select 'Spalte BT etc. l|fffd|schen
            With Selection.Validation
            .Delete
                .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
                :=xlBetween
            End With

            Range(Cells(ze, 2), Cells(ze, 2)).Select
            GoTo z
        End If
        'G|fffd|ltigkeiten Abzugsfl|fffd|che unter letzte Zeile
        Range(Cells(zeL + 1, 3), Cells(zeL + 1, 3)).Select
        If Left(Cells(zeL, 3), 1) = "A" Then
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AY$8:AY10" 'AF, AT und Gr|fffd|
            End With
        End If
        If Left(Cells(zeL, 3), 1) = "I" Then
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BI$2:$BI5" 'IF1 - IT2
            End With
        End If
       
        If Left(Cells(zeL, 3), 2) = "DA" Or Left(Cells(zeL, 3), 2) = "DF" Then
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BJ$11:BJ12" 'DF1 - DF2
            End With
        End If
    End If
    'wenn Bruttofl|fffd|che, dann Feld sperren
    Call BruttoAnz1
    
    Range(Cells(ze, 3), Cells(ze, 3)).Select
    GoTo z
End If
'Ende Zwischenf|fffd|gen
'==================

'L|fffd|schen
'=======
If ze > zeA - 1 And Cells(ze, 1) = "Z-" Then
    FlagL|fffd| = 1
    Call Ori
    Cells(ze, 1) = ""
    
    'letzte Zeile vor L|fffd|schen
    For i = zeE To zeA Step -1
        If Cells(i, 3) <> "" Then
            zeL = i
            i = zeA
        End If
    Next
    'L|fffd|schen Leerzeile
    If Cells(ze, 3) = "" Then
        Range(Cells(ze + 1, 2), Cells(zeL, 17)).Select 'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        Worksheets("HL Raum").Range(Cells(ze, 2), Cells(ze, 2)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
        Range(Cells(zeL, 2), Cells(zeL, 17)).Select 'l|fffd|schen letzte Zeile
        Selection.ClearContents

        Range(Cells(ze + 1, 26), Cells(zeL, 28)).Select 'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 26), Cells(ze, 26)).Select
        Worksheets("HL Raum").Range(Cells(ze, 26), Cells(ze, 26)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
        Range(Cells(zeL, 26), Cells(zeL, 28)).Select 'l|fffd|schen letzte Zeile
        Selection.ClearContents

        zeL_Korr = zeL + 1
        
        Call L|fffd|_Zwi
    
        Art = Left(Cells(zeL, 3), 1)
        If Art = "G" Then Art = "A"

        GoTo weiter_L|fffd|sch
    End If
    'L|fffd|schen nur Bruttofl|fffd|che
    If Cells(ze, 2) <> "" And Cells(ze, 8) = 0 Then
        Range(Cells(ze + 1, 2), Cells(zeL, 17)).Select 'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        Worksheets("HL Raum").Range(Cells(ze, 2), Cells(ze, 2)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
        Range(Cells(zeL, 2), Cells(zeL, 17)).Select 'l|fffd|schen letzte Zeile
        Selection.ClearContents
        
        Range(Cells(ze + 1, 26), Cells(zeL, 28)).Select 'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 26), Cells(ze, 26)).Select
        Worksheets("HL Raum").Range(Cells(ze, 26), Cells(ze, 26)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
        Range(Cells(zeL, 26), Cells(zeL, 28)).Select 'l|fffd|schen letzte Zeile
        Selection.ClearContents
       
        For i = zeE To zeA Step -1
            If Cells(i, 3) <> "" Then
                zeL = i
                i = zeA
            End If
        Next
        
        zeL_Korr = zeL + 1
        
        Call L|fffd|_Zwi
    
        Art = Left(Cells(zeL, 3), 1)
        If Art = "G" Then Art = "A"
        
        GoTo weiter_L|fffd|sch
    End If
    'Speren Z+/Z- der gel|fffd|schten Zeile
    Range(Cells(zeL, 1), Cells(zeL, 1)).Select
    Selection.Locked = True
    Selection.FormulaHidden = False
    
    'Bruttofl|fffd|che mit Abzugsfl|fffd|chen
    If Left(Cells(ze, 3), 2) = "AW" Or Left(Cells(ze, 3), 2) = "IW" Or Left(Cells(ze, 3), 2) = "DA" Or Left(Cells(ze, 3), 2) = "DE" Or Left(Cells(ze, 3), 2) = "FB" Then
        If Cells(ze, 8) > 0 Then
            'Ermittlung letzte Zeile (vor L|fffd|schen)
            Art = Left(Cells(ze, 3), 1)
            If Art = "G" Then Art = "A"
            For i = ze + 1 To zeE
                Art_Abzug = Left(Cells(i, 3), 1)
                If Art_Abzug = "G" Then Art_Abzug = "A"
                If Art_Abzug <> Art Or Cells(i, 2) <> "" Then
                    zeL = i - 1
                    i = zeE
                End If
            Next
            Range(Cells(ze, 2), Cells(zeL, 17)).Select   'l|fffd|schen alle Folgezeilen
            Selection.ClearContents
            Range(Cells(zeL + 1, 2), Cells(zeE, 17)).Select
            Selection.Copy
            Range(Cells(ze, 2), Cells(ze, 2)).Select
            Worksheets("HL Raum").Range(Cells(ze, 2), Cells(ze, 2)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
        
            Range(Cells(ze, 26), Cells(zeL, 28)).Select   'l|fffd|schen alle Folgezeilen
            Selection.ClearContents
            Range(Cells(zeL + 1, 26), Cells(zeE, 28)).Select
            Selection.Copy
            Range(Cells(ze, 26), Cells(ze, 28)).Select
            Worksheets("HL Raum").Range(Cells(ze, 26), Cells(ze, 28)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats
           
           'Ermittlung letzte Zeile (nach L|fffd|schen)
            For i = zeE To zeA Step -1
                If Cells(i, 3) <> "" Then
                    zeL = i
                    i = zeA
                End If
            Next
        
            zeL_Korr = zeL + 1
        
            Call L|fffd|_Zwi

            Call Korr_Tab_Linien
        
            'Zuordnung G|fffd|ltigkeiten - Bruttofl|fffd|chen keine, da Folgezeilen (au|fffd|er letzter Bruttofl|fffd|che, wenn diese keine Abzugsfl|fffd|che hat)
            Art = Left(Cells(zeL, 3), 1)
            If Art = "G" Then Art = "A"
       
            GoTo weiter_L|fffd|sch
        End If
    End If
    
    'L|fffd|schen einer Abzugsfl|fffd|che
    If Cells(ze, 2) = "" And Cells(ze, 3) <> "" Then
        
        '1. Zeile Abzugsfl|fffd|che
        For i = ze To zeA Step -1
            If Cells(i, 2) <> "" Then
                zeAa = i + 1 'Zeile Abzug - anfang
                i = zeA
            End If
        Next
        'Zeile l|fffd|schen
        Range(Cells(ze + 1, 2), Cells(zeE, 17)).Select  'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        Worksheets("HL Raum").Range(Cells(ze, 2), Cells(ze, 2)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats

        Range(Cells(ze + 1, 26), Cells(zeE, 28)).Select  'kopieren alle Folgezeilen
        Selection.Copy
        Range(Cells(ze, 26), Cells(ze, 2)).Select
        Worksheets("HL Raum").Range(Cells(ze, 26), Cells(ze, 26)).PasteSpecial Paste:=xlPasteFormulasAndNumberFormats

        'f|fffd|r Summenbildung der Abzugsfl|fffd|chen der Bruttofl|fffd|che
        'letzte Zeile Abzugsfl|fffd|che
        Art = Left(Cells(ze - 1, 3), 1)
        If Cells(ze, 2) = "" Then Art = Left(Cells(ze - 1, 3), 1) 'wenn Abzugsfl|fffd|che, da wenn letzte Zeile gel|fffd|scht wird, leer
        If Art = "G" Then Art = "A" 'wenn gro|fffd|e |fffd|ffnung
        For i = zeAa To zeE
            Art_Abzug = Left(Cells(i, 3), 1)
            If Art_Abzug = "G" Then Art_Abzug = "A" 'wenn gro|fffd|e |fffd|ffnung
            If Art_Abzug <> Art Or Cells(i, 2) <> "" Then
                zeAe = i - 1 'Zeile Abzug - Ende
                i = zeE
            End If
        Next
        If zeAe >= zeAa Then
            Cells(zeAa - 1, 8) = "=sum(I" + Trim$(Str$(zeAa)) + ":I" + Trim$(Str$(zeAe)) + ")"
          Else
            Cells(zeAa - 1, 8) = 0
        End If
        
        'Ermittlung letzte Zeile (nach L|fffd|schen)
        For i = zeE To zeA Step -1
            If Cells(i, 3) <> "" Then
                zeL = i
                i = zeA
            End If
        Next
      
        zeL_Korr = zeL + 1
        
        Call L|fffd|_Zwi

        Call Korr_Tab_Linien
        
        'Zuordnung G|fffd|ltigkeiten - Bruttofl|fffd|chen keine, da Folgezeilen (au|fffd|er letzter Bruttofl|fffd|che, wenn diese keine Abzugsfl|fffd|che hat)
        Art = Left(Cells(zeL, 3), 1)
        If Art = "G" Then Art = "A"
    End If

weiter_L|fffd|sch:
    Call Ori
    
     Range(Cells(ze, 5), Cells(ze, 6)).Select
        With Selection.Interior 'Feld wei|fffd|
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
'        Selection.Locked = False
'        Selection.FormulaHidden = False
    
    Range(Cells(zeL, 1), Cells(zeL + 2, 3)).Select
    Selection.Locked = False
    Selection.FormulaHidden = False

    Range(Cells(zeL, 2), Cells(zeL, 2)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AW$8:$AW$16"
    End With
    
    Range(Cells(zeL + 1, 10), Cells(zeL + 1, 11)).Select 'offene Felder sperren und beg|fffd|nen bei IW oder DE
    Selection.Locked = True
    Selection.FormulaHidden = False
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With

    Range(Cells(zeL + 1, 4), Cells(zeE, 6)).Select 'Restzeilen + 1 auch sperren
    Selection.Locked = True
    Selection.FormulaHidden = False
    Range(Cells(zeL + 2, 1), Cells(zeE, 6)).Select 'Restzeilen + 1 auch sperren
    Selection.Locked = True
    Selection.FormulaHidden = False

    Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
    
    Call BruttoAnz1
    
    GoTo z
End If
'Ende L|fffd|schen

U_FB = 0 '?????????????????????????????????????
For i = zeE To zeA Step -1 'FB
    If Left(Cells(i, 3), 2) = "DE" And Cells(i, 13) > 0 Then
        U_FB = Cells(i, 13)
        i = zeA
    End If
Next
'wenn Bruttofl|fffd|chen, Anz = 1 und sperren
Call BruttoAnz1

'Spalte Orientierung
If sp = 2 Then
    If Cells(ze, 2) <> "H" Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AX$8:$AX$9" 'AW, IW
        End With
      Else
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AX$10:$AX$12" 'DE,DA (EG > EG)
        End With
    End If
End If
If sp = 2 Then GoTo z

'|fffd|berpr|fffd|fung, ob Leezeile
For i = zeE To zeA Step -1 'zun|fffd|chst letzte ausgef|fffd|llte Zeile suchen
    If Cells(i, 3) <> 0 Or Cells(i, 3) <> "" Then
        zeL = i
        i = zeA
    End If
Next
'MsgBox (zeL)

For i = zeA To zeL
'MsgBox (Cells(i, 3))
    If Cells(i, 3) = 0 Or Cells(i, 3) = "" Then
        MsgBox ("Bitte Leerzeile f|fffd|llen oder L|fffd|schen" & Chr(13) & Chr(13) & "Nach Best|fffd|tigung mit 'OK' wird der Cursor in Spalte 'B' zur Eingabe eine neuen Bruttofl|fffd|che positioniert" & Chr(13) & Chr(13) & " Zeile L|fffd|schen: Mausklick min Spalte 'A' und 'Z-' aktivieren")
        j = i
        i = zeE
        If j = zeA Then Range(Cells(j, 2), Cells(j, 2)).Select
        If Cells(j, 2) = "" And Cells(j + 1, 3) <> "" Then Range(Cells(j, 2), Cells(j, 2)).Select
        GoTo z
    End If
Next

'AW - Aussenwand
'===============
If Left(Cells(ze, 3), 2) = "AW" Then
    Call G|fffd|ltigkeiten_AW
    
    'Kennung variabel oder fest nur Abzugsfl|fffd|chen
    Cells(ze, 26) = ""
    Cells(ze, 27) = ""
    Cells(ze, 28) = ""
    
    If Mid(Cells(ze, 3), 3, 1) = "" And sp = 3 Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        If sp = 3 Then GoTo z
    End If
    
    'Vorbesetzungen
    If Cells(ze, 4) = 0 Then Cells(ze, 4) = 1 'Anzahl
    Range(Cells(ze, 4), Cells(ze, 4)).Select  'Feld Anzahl = 1 sperren und begr|fffd|nen
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True
    Selection.FormulaHidden = False 'entsperren
    
    Call AW
    
    If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
        MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definierte AW aufrufen!")
        Range(Cells(ze, 3), Cells(ze, 3)).Select
        GoTo z
    End If
    
    If Cells(ze, 10) = 0 Then Cells(ze, 10) = "e" 'an Au|fffd|enluft grenzend
    Cells(ze, 12) = "=F" + Trim$(Str$(ze)) & "/2"   ' mittlere H|fffd|he zur Berechnung t*, int,k (48)
    'angrenzende Situation
    Cells(ze, 11) = "=A$1" 'Temperatur AL
    Cells(ze, 13) = "=FQ" + Trim$(Str$(ze))  'Korr-Faktor an AL
    'Formeln einsetzen
    Cells(ze, 16) = "=N" + Trim$(Str$(ze)) & "+O" + Trim$(Str$(ze))  'U-korr
    'weitere Formeln einsetzen
    Cells(ze, 7) = "=D" + Trim$(Str$(ze)) & "*E" + Trim$(Str$(ze)) & "*F" + Trim$(Str$(ze))   'Bruttofl|fffd|che
    Cells(ze, 9) = "=G" + Trim$(Str$(ze)) & "-H" + Trim$(Str$(ze))  'Nettofl|fffd|che
    Cells(ze, 17) = "=I" + Trim$(Str$(ze)) & "*M" + Trim$(Str$(ze)) & "*P" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000" 'Q-Norm
    'Abzgsfl|fffd|chen
    AnzZ = 0
    For i = ze + 1 To zeE
        If Left(Cells(i, 3), 2) = "AF" Or Left(Cells(i, 3), 2) = "AT" Or Left(Cells(i, 3), 2) = "Gr" Then
            AnzZ = AnzZ + 1 'Ermittlung Anzahl Folgezeilen
'            zeB = i - 1 'Bruttozeile
          Else
            i = zeE
        End If
    Next
    A_Abzug = 0
    For i = ze + 1 To ze + 1 + AnzZ
        A_Abzug = A_Abzug + Cells(i, 9) 'Summierung
    Next
    If AnzZ > 0 Then Cells(ze, 8) = "=sum(I" + Trim$(Str$(ze + 1)) + ":I" + Trim$(Str$(ze + AnzZ)) + ")"
    
    'R|fffd|cksprung Folgezeile
    If Cells(ze, 13) > 0 And Cells(ze, 5) > 0 Then
        If Cells(ze, 10) = "e" Then Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
        If Cells(ze, 10) = "g" Then Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
    End If

    If FlagZwi = 1 And Cells(ze, 17) > 0 Then Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
    If FlagZwi = 0 And Cells(ze, 17) > 0 Then Range(Cells(zeL + 1, 3), Cells(zeL + 1, 3)).Select

    Call zeLetzt
    If FlagAW = 1 Then Call Ori
        If Cells(ze, 5) = 0 Then
        Range(Cells(ze, 5), Cells(ze, 5)).Select
      Else
        Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
    End If

    FlagAW = 0
    
    Call Cursorsteuerung

GoTo z
End If

'AF-AT-IF-IT-Gr|fffd|_DF (Abzugsfl|fffd|chen)
'==================================
If Left(Cells(ze, 3), 2) = "AF" Or Left(Cells(ze, 3), 2) = "AT" Or Left(Cells(ze, 3), 2) = "IT" Or Left(Cells(ze, 3), 2) = "IF" Or Left(Cells(ze, 3), 2) = "Gr" Or Left(Cells(ze, 3), 2) = "DF" Then
    FlagAbzug = 0
    '|fffd|ffnen in Folgezeile, da sonst Cursorversprung
    Range(Cells(zeL + 1, 4), Cells(zeL + 1, 6)).Select 'Feld Anzahl = 1 sperren und begr|fffd|nen
    With Selection.Interior 'Feld wei|fffd|
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False
    Selection.FormulaHidden = False
    
    Call AF_AT_IF_IT_Gr|fffd|_DF 'G|fffd|ltigkeiten
    
    If Mid(Cells(ze, 3), 3, 1) = "" And sp = 3 Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        If sp = 3 Then GoTo z
    End If
    If Left(Cells(ze, 3), 2) = "Gr" Then
        If Mid(Cells(ze, 3), 4, 1) = "" And sp = 3 Then
            Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
            If sp = 3 Then GoTo z
        End If
    End If
'Vorbesetzungen
    If Cells(ze, 4) = 0 Then Cells(ze, 4) = 1 'Anzahl
    Cells(ze, 13) = 0
    'AF
    Call Abzufl|fffd|
    
    If Left(Cells(ze, 3), 1) <> "G" Then
        If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
            MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definiertes " & Left(Cells(ze, 3), 2) & " aufrufen!")
            Range(Cells(ze, 3), Cells(ze, 3)).Select
            GoTo z
        End If
    End If
    
    If FlagAbzug = 1 Then GoTo z
    
    'AF+AT
    If Left(Cells(ze, 3), 1) = "A" Then
        Cells(ze, 10) = "e" 'an Au|fffd|enluft grenzend
        Cells(ze, 11) = "=A$1" 'Temperatur AL
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        'Feld t-a und Korr-Faktor = 1 nicht frei
        Range(Cells(ze, 11), Cells(ze, 12)).Select 'Korr-Faktor
        Selection.Locked = True
        Selection.FormulaHidden = False
        Range(Cells(ze, 12), Cells(ze, 12)).Select 'keine G|fffd|ltigkeit t-angrenzend, nur ta
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Cells(ze, 10) = Cells(ze - 1, 10) 'angrenzend, wie Bruttofl|fffd|che
        Cells(ze, 11) = Cells(ze - 1, 11) 'angr. Temperatur
        Cells(ze, 13) = "=FQ" & Trim$(Str$(ze))    ''Faktor
        Cells(ze, 15) = Cells(ze - 1, 15) 'WB-Zuschalg
    End If
    'Gr|fffd|
    If Left(Cells(ze, 3), 3) = "Gr|fffd|" Then
        ActiveSheet.Shapes("rechteck 3").Visible = False
        Cells(ze, 10) = 0 'leer
        Cells(ze, 13) = 0 'leer
        Cells(ze + 1, 13) = 0 'leer?? warum auch immer
        Cells(ze, 14) = 0 'leer
        Cells(ze, 15) = 0 'leer
        Cells(ze, 16) = 0 'leer
        Cells(ze, 17) = 0 'leer
    End If
     'Formeln einsetzen
    Cells(ze, 7) = "=D" + Trim$(Str$(ze)) & "*E" + Trim$(Str$(ze)) & "*F" + Trim$(Str$(ze))   'Bruttofl|fffd|che
    Cells(ze, 9) = "=G" + Trim$(Str$(ze)) & "-H" + Trim$(Str$(ze))  'Nettofl|fffd|che
    If Left(Cells(ze, 3), 1) = "A" Or Left(Cells(ze, 3), 1) = "I" Or Left(Cells(ze, 3), 1) = "D" Then
        Cells(ze, 16) = "=N" + Trim$(Str$(ze)) & "+O" + Trim$(Str$(ze))  'U-korr
        Cells(ze, 17) = "=I" + Trim$(Str$(ze)) & "*M" + Trim$(Str$(ze)) & "*P" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000" 'Q-Norm
      Else
        Cells(ze, 16) = "=N" + Trim$(Str$(ze)) & "+O" + Trim$(Str$(ze))  'U-korr
        Cells(ze, 17) = "=I" + Trim$(Str$(ze)) & "*BO" + Trim$(Str$(ze)) & "*O" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000" 'Q-Norm
    End If
    If Cells(ze, 12) > 0 Then Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
   
    'Ermittlung Abzugsfl|fffd|chen
    'AF + AT + Gr|fffd|
    If Left(Cells(ze, 3), 1) = "A" Or Left(Cells(ze, 3), 1) = "G" Then
        For i = ze To zeE
            If Left(Cells(i, 3), 2) = "AT" Or Left(Cells(i, 3), 2) = "AF" Or Left(Cells(i, 3), 2) = "Gr" Then
                zeL = i 'Letzte Zeile Abzugsfl|fffd|che
              Else
                i = zeE
            End If
        Next
        AnzZ = 0
        For i = zeL To zeA Step -1
            If Left(Cells(i, 3), 2) = "AT" Or Left(Cells(i, 3), 2) = "AF" Or Left(Cells(i, 3), 2) = "Gr" Then
                AnzZ = AnzZ + 1 'Ermittlung Anzahl Folgezeilen
                zeB = i - 1 'Bruttozeile
              Else
                i = zeA
            End If
        Next
        A_Abzug = 0
        zeB = (zeL - AnzZ) 'zugeh|fffd|rige Bruttozeile
        For i = zeL To zeL - AnzZ + 1 Step -1
            A_Abzug = A_Abzug + Cells(i, 9) 'Summierung
            Cells(i, 18) = Cells(zeB, 2) 'HR unsichtbar speichern f|fffd|r gr|fffd|
        Next
        Cells(zeB, 8) = "=sum(I" + Trim$(Str$(zeB + 1)) + ":I" + Trim$(Str$(zeL)) + ")"
        
        If Cells(zeL - AnzZ, 7) < Cells(zeL - AnzZ, 8) Then
            MsgBox ("Abzugsfl|fffd|che (" & Round(Cells(zeB, 8), 1) & " m" & Chr(178) & " )  > Bruttofl|fffd|che (" & Round(Cells(zeB, 7), 1) & " m" & Chr(178) & " ) " & Chr(13) & Chr(13) & "Bitte geeignete Korrektur!")
            Cells(ze, 4) = 0
            Range(Cells(ze, 4), Cells(ze, 4)).Select
            GoTo z
        End If
    End If
   
    'von Vorzeile
    If Left(Cells(ze, 3), 1) = "A" Then 'nicht Gr|fffd|
        Cells(ze, 10) = "e" 'angrenzende Situation
        Cells(ze, 11) = "=A$1" 'angrenzende Temperatur
    End If
    If Left(Cells(ze, 3), 1) = "I" Or Left(Cells(ze, 3), 1) = "D" Then 'nicht Gr|fffd|
        Cells(ze, 10) = Cells(ze - 1, 10) 'angrenzende Situation
        Cells(ze, 11) = Cells(ze - 1, 11) 'angrenzende Temperatur
        Cells(ze, 13) = Cells(ze - 1, 13) 'Faktor f
        Cells(ze, 15) = Cells(ze - 1, 15) 'WB-Zuschalg
    End If
    'IF + IT
    If Left(Cells(ze, 3), 1) = "I" Then
        For i = zeE To zeA Step -1
            If Left(Cells(i, 3), 2) = "IT" Or Left(Cells(i, 3), 2) = "IF" Then
                zeL = i 'Letzte Zeile Abzugsfl|fffd|che
                i = zeA
            End If
        Next
        AnzZ = 0
        For i = zeL To zeA Step -1
            If Left(Cells(i, 3), 2) = "IT" Or Left(Cells(i, 3), 2) = "IF" Then
                AnzZ = AnzZ + 1 'Ermittlung Anzahl Folgezeilen
                zeB = i - 1 'Bruttozeile
              Else
                i = zeA
            End If
        Next
        A_Abzug = 0
        For i = zeL To zeL - AnzZ + 1 Step -1
            A_Abzug = A_Abzug + Cells(i, 9) 'Summierung
            If Left(Cells(i, 3), 1) <> "I" Then
                i = zeA
            End If
        Next
        Cells(zeB, 8) = "=sum(I" + Trim$(Str$(zeB + 1)) + ":I" + Trim$(Str$(zeL)) + ")"
    
        If Cells(zeL - AnzZ, 7) <= Cells(zeL - AnzZ, 8) Then
            MsgBox ("Abzugsfl|fffd|che (" & Round(Cells(ze, 7), 1) & " m2)  > Bruttofl|fffd|che (" & Round(Cells(zeB, 7), 1) & " m2) " & Chr(13) & Chr(13) & "Bitte geeignete Korrektur!")
            Cells(ze, 4) = 0
            Range(Cells(ze, 4), Cells(ze, 4)).Select
            GoTo z
        End If
        
        Range(Cells(ze, 10), Cells(ze, 13)).Select
        With Selection.Interior
            .PatternColorIndex = xlAutomatic
            .Color = 13434828
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        Selection.Locked = True
        Selection.FormulaHidden = False
        
    End If
    
    'DF
    If Left(Cells(ze, 3), 2) = "DF" Then
        Cells(ze, 12) = [G12]  'Geschossh|fffd|he
        Cells(ze, 13) = "=FQ" & Trim$(Str$(ze))    ''Faktor
        For i = zeE To zeA Step -1
            If Left(Cells(i, 3), 2) = "DF" Then
                zeL = i 'Letzte Zeile Abzugsfl|fffd|che
                i = zeA
            End If
        Next
        AnzZ = 0
        For i = zeL To zeA Step -1
            If Left(Cells(i, 3), 2) = "DF" Then
                AnzZ = AnzZ + 1 'Ermittlung Anzahl Folgezeilen
                zeB = i - 1 'Bruttozeile
              Else
                i = zeA
            End If
        Next
        A_Abzug = 0
        For i = zeL To zeL - AnzZ + 1 Step -1
            A_Abzug = A_Abzug + Cells(i, 9) 'Summierung
            If Left(Cells(i, 3), 2) <> "DF" Then
                i = zeA
            End If
        Next
        Cells(zeB, 8) = "=sum(I" + Trim$(Str$(zeB + 1)) + ":I" + Trim$(Str$(zeL)) + ")"
    
        If Cells(zeL - AnzZ, 7) <= Cells(zeL - AnzZ, 8) Then
            MsgBox ("Abzugsfl|fffd|che (" & Round(Cells(ze, 7), 1) & " m2)  > Bruttofl|fffd|che (" & Round(Cells(zeB, 7), 1) & " m2) " & Chr(13) & Chr(13) & "Bitte geeignete Korrektur!")
            Cells(ze, 4) = 0
            Range(Cells(ze, 4), Cells(ze, 4)).Select
            GoTo z
        End If
        Cells(ze, 11) = Cells(ze - 1, 11) 'angrenzende Temperatur
        Cells(ze, 15) = Cells(ze - 1, 15)
    End If
    Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren

    Range(Cells(ze, 4), Cells(ze, 4)).Select   'Bruttofl|fffd|che
    If sp = 4 Then Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che

    'Cursorsteuerung
    If sp = 3 Then Range(Cells(ze, 4), Cells(ze, 4)).Select
    If sp = 3 Then GoTo z
    If Cells(ze, 5) = 0 Then Range(Cells(ze, 5), Cells(ze, 5)).Select
    If Cells(ze, 5) = 0 Then GoTo z
    If Cells(ze, 6) = 0 Then Range(Cells(ze, 6), Cells(ze, 6)).Select
    If Cells(ze, 6) = 0 Then GoTo z
    If Cells(ze, 6) > 0 Then Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
    If Cells(ze, 6) > 0 Then GoTo z
    
End If

'IW + DE + FB
'============
If Left(Cells(ze, 3), 2) = "IW" Or Left(Cells(ze, 3), 2) = "DE" Or Left(Cells(ze, 3), 2) = "FB" Then
    
    'Kennung variabel oder fest nur Abzugsfl|fffd|chen
    Cells(ze, 26) = ""
    Cells(ze, 27) = ""
    Cells(ze, 28) = ""
    
    Call G|fffd|ltigkeiten_IW_DE_FB
        
    If Mid(Cells(ze, 3), 3, 1) = "" And sp = 3 Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        If sp = 3 Then GoTo z
    End If
    
    'Vorbesetzungen
    If Cells(ze, 4) = 0 Then Cells(ze, 4) = 1 'Anzahl
    Range(Cells(ze, 4), Cells(ze, 4)).Select   'Feld Anzahl = 1 sperren und begr|fffd|nen
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True
    Selection.FormulaHidden = False 'entsperren

    
    If Cells(ze, 11) = 0 And sp <> 13 Then  ' Cells(ze, 11) = "=A$1" Then
        Cells(ze, 10) = "a"   'Vorschlag angrenzend beheizter Nachbarraum
        Cells(ze, 11) = 15   'Vorschlag Temperatur Nachbarraum'IW + DE
        If Left(Cells(ze, 3), 2) = "FB" Then Cells(ze, 11) = "=A$3" 'Vorschlag FB
    End If
    'IW
    If Left(Cells(ze, 3), 2) = "IW" Then
        Call IW
        
        If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
        MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definierte IW aufrufen!")
        Range(Cells(ze, 3), Cells(ze, 3)).Select
        GoTo z
    End If

        Cells(ze, 12) = "=F" + Trim$(Str$(ze)) & "/2"  ' mittlere H|fffd|he zur Berechnung t*, int,k (48)
   End If
    
    'DE
    If Left(Cells(ze, 3), 2) = "DE" Then
        
        Call DFB
        
        If Cells(ze, 10) = 0 Then Cells(ze, 10) = "a"  'an Nachbarraum grenzend
        
        If Right(Cells(ze, 3), 1) = 1 Then Cells(ze, 14) = "=CB$9" 'U-Werte
        If Right(Cells(ze, 3), 1) = 2 Then Cells(ze, 14) = "=CB$10"
       
        If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
            MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definierte DE aufrufen!")
            Range(Cells(ze, 3), Cells(ze, 3)).Select
            GoTo z
        End If
       
        Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
        With Selection.Validation 'keine G|fffd|ltzigkeit Korr-Faktor
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        
        If sp = 5 Then Range(Cells(ze, 6), Cells(ze, 6)).Select
        If sp = 5 Then GoTo z
    End If
        
    'FB
    If Left(Cells(ze, 3), 2) = "FB" Then
        
        Call DFB
        
        Cells(ze, 10) = "g"   'an Erdreich grenzend
        
        If Right(Cells(ze, 3), 1) = 1 Then Cells(ze, 14) = "=CG$9" 'U-Werte
        If Right(Cells(ze, 3), 1) = 2 Then Cells(ze, 14) = "=CG$10"
        
        If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
            MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definierten FB aufrufen!")
            Range(Cells(ze, 3), Cells(ze, 3)).Select
            GoTo z
        End If
        
        If sp = 5 Then Range(Cells(ze, 6), Cells(ze, 6)).Select
        If sp = 5 Then GoTo z
        
        Cells(ze, 12) = 0.00001 'sichtbar Null darstellen
        Cells(ze, 13) = "=FQ" + Trim$(Str$(ze)) '|fffd|bernahme Faktor Erdreich
        
        Range(Cells(ze, 10), Cells(ze, 12)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
        Range(Cells(ze, 12), Cells(ze, 12)).Select 'angr. Temperaturen
        With Selection.Validation 'keine G|fffd|ltzigkeit Korr-Faktor
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        Cells(ze, 16) = "=DA" + Trim$(Str$(ze)) 'U-equvi
    
        Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
        With Selection.Validation 'keine G|fffd|ltzigkeit Korr-Faktor
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
    End If

    'Cusorsteuerung
    If Cells(ze, 5) = 0 Then Range(Cells(ze, 5), Cells(ze, 5)).Select
    If Cells(ze, 5) = 0 Then GoTo z
            
    'Felder Faktor, Angr. Temp. und Korr-Faktor frei
    If Left(Cells(ze, 3), 2) <> "FB" Then
        Range(Cells(ze, 10), Cells(ze, 11)).Select
        With Selection.Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        Range(Cells(ze, 10), Cells(ze, 10)).Select 'zur a oder ae
        If Cells(ze, 10) = 0 Then GoTo z
    End If
    
    'auch DE
    If Cells(ze, 10) = "a" Then
        Range(Cells(ze, 13), Cells(ze, 13)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
        With Selection.Validation 'keine G|fffd|ltzigkeit Korr-Faktor
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Cells(ze, 15) = 0 'kein WB-Zuschlag
        Range(Cells(ze, 11), Cells(ze, 11)).Select 'zur Eingabe angr. Temperatur
        Cells(ze, 16) = "=N" + Trim$(Str$(ze)) & "+O" + Trim$(Str$(ze))  'U-korr
        
        Cells(ze, 13) = "=FQ" + Trim$(Str$(ze)) '|fffd|bernahme Faktor f1 + f2
        If Left(Cells(ze, 3), 2) = "DE" Then Cells(ze, 13) = "=FQ" + Trim$(Str$(ze)) '|fffd|bernahme Faktor f1 + f2
        If Cells(ze, 11) = [G6] Then
            MsgBox ("Angrenzende Temperatur = Raumtemoeratur! Bitte |fffd|ndern")
            Range(Cells(ze, 11), Cells(ze, 11)).Select
            GoTo z
        End If
        
        Range(Cells(ze, 13), Cells(ze, 13)).Select 'Korr-Faktor frei
        Selection.Locked = True
        Selection.FormulaHidden = False
    End If
    
    'ae
    'Decke
    If Cells(ze, 10) = "DE" Or Cells(ze, 10) = "ae" Then
        Range(Cells(ze, 11), Cells(ze, 11)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Range(Cells(ze, 13), Cells(ze, 13)).Select 'angr. Temperaturen
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AQ$14:$AQ22"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Cells(ze, 11) = 0
        If sp = 10 And Cells(ze, sp) = "ae" Then Cells(ze, 13) = "=FQ" + Trim$(Str$(ze))         'Korr-Faktor an AL

        Cells(ze, 15) = "=A$2" ' WB-Zuschlag
    End If
    'ae
    If Cells(ze, 10) = "a" And Left(Cells(ze, 3), 2) = "IW" Then
        For i = ze + 1 To zeE
            If Cells(i, 2) <> "" Or Cells(i, 2) <> 0 Then
                zeL = i - 1
                i = zeE
            End If
        Next
        For i = ze + 1 To zeL
            Cells(i, 13) = "=FQ" + Trim$(Str$(i))
        Next
    End If
    
    If Cells(ze, 10) = "ae" Then
        Range(Cells(ze, 12), Cells(ze, 12)).Select 'angr. Temperatur nicht frei
        Selection.Locked = True
        Selection.FormulaHidden = True
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
        If sp <> 13 Then Cells(ze, 13) = 0.5
        'Vorschlag f-u
        Range(Cells(ze, 12), Cells(ze, 12)).Select 'Korr-Faktor frei
        Selection.Locked = False
        Selection.FormulaHidden = False
        
        Range(Cells(ze, 13), Cells(ze, 13)).Select 'Korr-Faktor frei'Faktor f
        Selection.Locked = False
        Selection.FormulaHidden = False
        With Selection.Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
    
        For i = ze + 1 To zeE
           If Left(Cells(i, 3), 2) = "IT" Or Left(Cells(i, 3), 2) = "IF" Then
                Cells(i, 13) = Cells(i - 1, 13)
              Else
                i = zeE
            End If
        Next
'        GoTo z
    End If
    
    'Erdreich
    'Formeln einsetzen
    Cells(ze, 7) = "=D" + Trim$(Str$(ze)) & "*E" + Trim$(Str$(ze)) & "*F" + Trim$(Str$(ze))   'Bruttofl|fffd|che
    Cells(ze, 9) = "=G" + Trim$(Str$(ze)) & "-H" + Trim$(Str$(ze))  'Nettofl|fffd|che
    Cells(ze, 17) = "=I" + Trim$(Str$(ze)) & "*M" + Trim$(Str$(ze)) & "*P" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000"   'Q-Norm
    If Cells(ze, 10) = "FB" Or Cells(ze, 10) = "g" Then Cells(ze, 17) = "=A$5*A$7*I" + Trim$(Str$(ze)) & "*M" + Trim$(Str$(ze)) & "*P" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000"   'Q-Norm
    If Cells(ze, 3) = "DE" Or Cells(ze, 3) = "FB" Then GoTo Weiter

    'Ermittlung Anzahl Folgezeilen
    For i = ze To zeE
        If Left(Cells(i, 3), 1) <> "I" Then
            zeL = i - 1 'Letzte Zeile
            i = zeE
        End If
    Next
    'Korrektur Nachfolgefl|fffd|chen
    A_Abzug = 0
    For i = ze + 1 To zeL
        A_Abzug = A_Abzug + Cells(i, 9) 'Summierung der Abzugsfl|fffd|chen
        Cells(i, 10) = Cells(ze, 10) 'grenzt an
        Cells(i, 11) = Cells(ze, 11) 'Temperatur
        Cells(i, 15) = Cells(ze, 15) 'WB-Zuschlag
    Next
    Cells(ze, 8) = A_Abzug
Weiter:
    
    If Cells(ze, 13) > 0 And Cells(ze, 5) > 0 Then Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select 'neue Bruttofl|fffd|che
    If Left(Cells(ze, 3), 2) = "IW" And Cells(ze, 13) > 0 And Cells(ze, 5) > 0 Then Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select 'nach "IW" Abzugsfl|fffd|chen m|fffd|glich

    If Cells(ze, 17) > 0 And Left(Cells(ze, 3), 2) = "DE" Then Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select 'Kommende Eingabe = Bruttofl|fffd|che
    If Cells(ze, 17) > 0 And Left(Cells(ze, 3), 2) = "FB" Then Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select 'Kommende Eingabe = Bruttofl|fffd|che
    If sp = 10 Then Range(Cells(ze, 13), Cells(ze, 13)).Select 'Sprung Feld f Spalte 12

    Call zeLetzt
    If FlagIW = 1 Then Call Ori
        If Cells(ze, 5) = 0 Then
        Range(Cells(ze, 5), Cells(ze, 5)).Select
      Else
        Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
    End If

    FlagIW = 0
    
    Call Cursorsteuerung

GoTo z

End If

'Dach
'===================
Call DA
    
    'Kennung variabel oder fest nur Abzugsfl|fffd|chen
    Cells(ze, 26) = ""
    Cells(ze, 27) = ""
    Cells(ze, 28) = ""

Call zeLetzt
If FlagDA = 1 Then
Call Ori
FlagDA = 0
End If
    
GoTo z
MsgBox ("DA ???")

'|fffd|bertrag HR in Spalte 18 (Wegen Gr|fffd|)
For i = zeA To zeE
    Cells(i, 18) = Cells(i, 2)
Next
For i = zeA To zeE
    If Cells(i, 18) = 0 Or Cells(i, 18) = "" Then Cells(i, 18) = Cells(i - 1, 18)
Next


z:
Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub

Sub G|fffd|ltigkeiten_AW() 'G|fffd|ltigkeiten
    FlagAW = 1
    Range(Cells(ze, 2), Cells(ze, 6)).Select   'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    
    Range(Cells(ze, 1), Cells(ze, 1)).Select 'L|fffd|schen/Zwischenf|fffd|gen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AX$3:$AX$4"
    End With
    Range(Cells(ze, 3), Cells(ze, 3)).Select 'AW1 - AW5
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$BB$12:$BB$16"
    End With
    Range(Cells(ze, 4), Cells(ze, 4)).Select 'Anz Fl|fffd|chen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AO$8:$AO$9"
    End With
    Range(Cells(ze, 10), Cells(ze, 10)).Select 'angrenzend (e oder g)
    If [D4] = "UG" Or [D4] = "EG" Then
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AX$18:$AX$19" 'e, a, g
        End With
        With Selection.Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0 'frei
        End With
      Else
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
    End If
    Selection.Locked = False 'entsch|fffd|tzuen
    Selection.FormulaHidden = False
    
    'G|fffd|ltigkeiten Folgezeilen
    '------------------------
    Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    
    'Orientierungen
    If zeL < ze + 1 Then
        Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AW$8:$AW$16"
        End With
        'AF, AT und Gr|fffd|
        Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AY$8:$AY$10"
        End With
      Else
        FlagAW = 1
    End If
End Sub
Sub AF_AT_IF_IT_Gr|fffd|_DF() 'G|fffd|ltigkeit
    Range(Cells(ze, 2), Cells(ze, 6)).Select   'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
        
    Range(Cells(ze, 2), Cells(ze, 2)).Select   'L|fffd|schen G|fffd|ltigkeit Bruttofl|fffd|chen
    With Selection.Validation 'keine G|fffd|ltigkeiten
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With

    Range(Cells(ze, 1), Cells(ze + 1, 1)).Select 'L|fffd|schen/Zwischenf|fffd|gen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AX$3:$AX$4"
    End With
    
    Range(Cells(ze, 3), Cells(ze, 3)).Select
    If Left(Cells(ze, 3), 2) = "AF" Then 'AF1 - AF5
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BH$2:$BH$6"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "AT" Then 'AT1 - AT3
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BH$8:$BH$10"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "Gr" Then 'Gr|fffd|1 - Gr|fffd|3
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BL$2:$BL$4"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "IF" Then 'IF1 - IF2
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BI$2:$BI$5"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "IT" Then 'IT1 - IT2
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BI$8:$BI$9"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "DF" Then 'DF1 - DF2
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$11:$BJ$12"
        End With
    End If
    
    Range(Cells(ze, 4), Cells(ze, 4)).Select 'Anzahl
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AO$8:$AO$20"
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = False
    End With
    'Ung|fffd|ltigkeit "g", wenn Abzugsfl|fffd|chen als Folgezeile
    If Left(Cells(ze - 1, 3), 2) = "AW" Then
           Range(Cells(ze - 1, 10), Cells(ze - 1, 10)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'wieder gr|fffd|n
        End With
    End If
    'AF + AT
    If Left(Cells(ze, 3), 2) = "AF" Then
        'AF
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BP$8:$BP$13"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'L|fffd|nge
        End With
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BQ$8:$BQ$13"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 10), Cells(ze, 12)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
    End If
    If Left(Cells(ze, 3), 2) = "AT" Then
        'AT
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BS$8:$BS$11"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BT$8:$BT$11"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 10), Cells(ze, 12)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
    End If
    'IF + IT
    If Left(Cells(ze, 3), 2) = "IF" Then
        'IF
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BW$8:$BW$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BX$8:$BX$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
    End If
    If Left(Cells(ze, 3), 2) = "IT" Then
        'IT
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BZ$8:$BZ$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$CA$8:$CA$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
    End If
    If Cells(ze, 3) = "Gr|fffd|" Then
        Range(Cells(ze, 10), Cells(ze, 12)).Select 'keine G|fffd|ltigkeit Korr-Faktor
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Range(Cells(ze, 10), Cells(ze, 13)).Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
    End If
    If Left(Cells(ze, 3), 2) = "DF" Then
        'IT
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$CE$8:$CE$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$CF$8:$CF$10"
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = False
        End With
    End If
    
    'G|fffd|ltigkeiten Folgezeilen
    '------------------------
    Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    
    'Orientierungen
    Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AW$8:$AW$16"
    End With
    
    Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
    If Left(Cells(ze, 3), 1) = "A" Or Left(Cells(ze, 3), 1) = "G" Then
        'AF, AT und Gr|fffd|
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AY$8:$AY$10"
        End With
    End If
    If Left(Cells(ze, 3), 1) = "I" Then
       'IF, IT
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BI$2:$BI5"
        End With
    End If
    If Left(Cells(ze, 3), 1) = "D" Then
       'DF
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$11:BJ12"
        End With
    End If
End Sub
Sub G|fffd|ltigkeiten_IW_DE_FB()     'G|fffd|ltigkeiten
    FlagIW = 1
    FlagDE = 1
    FlagFB = 1
    
    Range(Cells(ze, 2), Cells(ze, 6)).Select   'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    
    Range(Cells(ze, 1), Cells(ze, 1)).Select 'L|fffd|schen/Zwischenf|fffd|gen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AX$3:$AX$4"
    End With
    Range(Cells(ze, 3), Cells(ze, 3)).Select 'IW1 - IW5
    
    If Left(Cells(ze, 3), 2) = "IW" Then 'IW1 - IW5
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BB$18:$BB$22"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "DE" Then 'DE1 - DE2
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$2:$BJ$3"
        End With
    End If
    If Left(Cells(ze, 3), 2) = "FB" Then 'FB1 - FB2
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BK$2:$BK$3"
        End With
    End If
    
    Range(Cells(ze, 4), Cells(ze, 4)).Select 'Anz Abzugsfl|fffd|chen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AO$8:$AO$9"
    End With
    Range(Cells(ze, 5), Cells(ze, 5)).Select 'Vorschlag Raumma|fffd|e
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=$AJ$14:$AJ$16"
    End With
    Range(Cells(ze, 10), Cells(ze, 10)).Select 'angrenzend (a, ae)
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AX$14:$AX$15"
    End With
    Range(Cells(ze, 10), Cells(ze, 11)).Select 'angrenzend (a, ae)
    Selection.Locked = False 'entsch|fffd|tzuen
    Selection.FormulaHidden = False
    Range(Cells(ze, 11), Cells(ze, 11)).Select 'angr. Temperaturen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AQ$7:$AQ$11"
    End With
    'IW
    If Left(Cells(ze, 3), 2) = "IW" Then
        Range(Cells(ze, 10), Cells(ze, 11)).Select 'Felder 'a', 'ae' und Korr-Faktor frei
        Selection.Locked = False
        Selection.FormulaHidden = False
        With Selection.Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0 'frei
        End With
    End If
    'FB
    If Left(Cells(ze, 3), 2) = "FB" Then
        Range(Cells(ze, 10), Cells(ze, 11)).Select 'Feld Korr-Faktor gesperrt
        Selection.Locked = True
        Selection.FormulaHidden = False
    End If
    'DE
    If Left(Cells(ze, 3), 2) = "DE" Then
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Vorschlag Raumma|fffd|e-Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AS$15:$AS$16"
        End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'Vorschlag Raumma|fffd|e-L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AT$15:$AT$16"
        End With
        Range(Cells(ze, 10), Cells(ze, 11)).Select ''Felder 'a', 'ae' und Korr-Faktor frei
        Selection.Locked = False
        Selection.FormulaHidden = False
        With Selection.Interior
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0 'frei
        End With
   End If
    'FB
    If Left(Cells(ze, 3), 2) = "FB" Then
        Range(Cells(ze, 5), Cells(ze, 5)).Select 'Vorschlag Raumma|fffd|e-Breite
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AS$15:$AS$16"
       End With
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'Vorschlag Raumma|fffd|e-L|fffd|nge
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AT$15:$AT$16"
        End With
        Range(Cells(ze, 10), Cells(ze, 10)).Select 'angrenzend (a, ae, g)
    End If
'MsgBox (ze & "   " & Cells(ze, 3))
'    If Left(Cells(ze + 1, 3), 2) = "AW" Or Left(Cells(ze + 1, 3), 2) = "IW" Or Left(Cells(ze + 1, 3), 2) = "DE" Or Left(Cells(ze + 1, 3), 2) = "DA" Or Left(Cells(ze + 1, 3), 2) = "FB" Then
'        Range(Cells(ze, 4), Cells(ze, 5)).Select 'Anzahl = 1 f|fffd|r bruttofl|fffd|chen nicht |fffd|berschreibbar
'       With Selection.Interior
'            .Pattern = xlSolid
'           .PatternColorIndex = xlAutomatic
'            .Color = 13434828 'gr|fffd|n
'        End With
'        Selection.Locked = True
'        Selection.FormulaHidden = False 'sperren
'    End If
    
    'G|fffd|ltigkeiten Folgezeilen
    '------------------------
    'Orientierungen
    Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    
    If zeL < ze + 1 Then
        Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AW$8:$AW$16"
        End With
        'IF, IT
        If Cells(ze, 3) = "IW" Then
            Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BI$2:$BI$5" 'IF1 - IT2
            End With
        End If
      Else
        FlagIW = 1
    End If
End Sub
Sub Abzufl|fffd|()
If Left(Cells(ze, 3), 2) = "AF" Then
'AAAA
    'AF1
    '-----------------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then
        If [BP9] > 0 Then
            Cells(ze, 5) = "=BP$9" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BQ9] > 0 Then
            Cells(ze, 6) = "=BQ$9" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
       End If
        Cells(ze, 12) = "=BP$14" 'H|fffd|he UK
        Cells(ze, 14) = "=BO$9" 'U-Wert
    End If

    'AF2
    '-----------------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then
        If [BP10] > 0 Then
            Cells(ze, 5) = "=BP$10" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BQ10] > 0 Then
            Cells(ze, 6) = "=BQ$10" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BP$15" 'H|fffd|he UK
        Cells(ze, 14) = "=BO$10" 'U-Wert
    End If
    'AF3
    '-----------------------------------------------
    If Right(Cells(ze, 3), 1) = 3 Then
        If [BP11] > 0 Then
            Cells(ze, 5) = "=BP$11" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BQ11] > 0 Then
            Cells(ze, 6) = "=BQ$11" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BP$16" 'H|fffd|he UK
        Cells(ze, 14) = "=BO$11" 'U-Wert
    End If
    'AF4
    '-----------------------------------------------
    If Right(Cells(ze, 3), 1) = 4 Then
        If [BP12] > 0 Then
            Cells(ze, 5) = "=BP$12" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BQ12] > 0 Then
            Cells(ze, 6) = "=BQ$12" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BP$17" 'H|fffd|he UK
        Cells(ze, 14) = "=BO$12" 'U-Wert
    End If
    'AF5
    '-----------------------------------------------
    If Right(Cells(ze, 3), 1) = 5 Then
        If [BP13] > 0 Then
            Cells(ze, 5) = "=BP$13" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BQ13] > 0 Then
            Cells(ze, 6) = "=BQ$13" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BP$18" 'H|fffd|he UK
        Cells(ze, 14) = "=BO$13" 'U-Wert
    End If
End If

'AT
If Left(Cells(ze, 3), 2) = "AT" Then
    If Right(Cells(ze, 3), 1) = 1 Then
        If [BS9] > 0 Then
            Cells(ze, 5) = "=BS$9" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BT9] > 0 Then
            Cells(ze, 6) = "=BT$9" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BS$12" 'H|fffd|he UK
        Cells(ze, 14) = "=BR$9" 'U-Wert
    End If
     If Right(Cells(ze, 3), 1) = 2 Then
        If [BS10] > 0 Then
            Cells(ze, 5) = "=BS$10" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BT10] > 0 Then
            Cells(ze, 6) = "=BT$10" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
         Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BS$13" 'H|fffd|he UK
        Cells(ze, 14) = "=BR$10" 'U-Wert
    End If
    If Right(Cells(ze, 3), 1) = 3 Then
        If [BS11] > 0 Then
            Cells(ze, 5) = "=BS$11" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BT11] > 0 Then
            Cells(ze, 6) = "=BT$11" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BS$13" 'H|fffd|he UK
        Cells(ze, 14) = "=BR$11" 'U-Wert
    End If
End If
'Gr|fffd|
If Left(Cells(ze, 3), 2) = "Gr" Then
    'Gr|fffd|1
    If Right(Cells(ze, 3), 1) = 1 Then
        If [BM2] > 0 Then
            Cells(ze, 5) = "=BM$2" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BM$2:$BM$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Cells(ze, 26) = "f"
        End If
        If [BN2] > 0 Then
            Cells(ze, 6) = "=BN$2" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BN$2:$BN$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Cells(ze, 27) = "f"
        End If
        If [BO2] > 0 Then
            Cells(ze, 12) = "=BO$2" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 28) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 28) = "f"
        End If
    End If
    'Gr|fffd|2
    If Right(Cells(ze, 3), 1) = 2 Then
        If [BM3] > 0 Then
'MsgBox ("Gr|fffd|2-B   " & [BM3])
            Cells(ze, 5) = "=BM$3" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BM$2:$BM$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Cells(ze, 26) = "f"
        End If
        If [BN3] > 0 Then
            Cells(ze, 6) = "=BN$3" 'H|fffd|he
'            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
'MsgBox ("Gr|fffd|2-H   " & [BN3])
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BN$2:$BN$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        If [BO3] > 0 Then
            Cells(ze, 12) = "=BO$3" 'H|fffd|he
'            Call H|fffd|he_Vari
            Cells(ze, 28) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 28) = "f"
        End If
    End If
    'Gr|fffd|3
    If Right(Cells(ze, 3), 1) = 3 Then
'MsgBox ([BM4])
        If [BM4] > 0 Then
            Cells(ze, 5) = "=BM$4" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BM$2:$BM$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Cells(ze, 26) = "f"
        End If
        If [BN4] > 0 Then
'MsgBox ([BN4])
            Cells(ze, 6) = "=BN$4" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BN$2:$BN$4"
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Cells(ze, 27) = "f"
        End If
        If [BO4] > 0 Then
            Cells(ze, 12) = "=BO$4" 'H|fffd|he
'            Call H|fffd|he_Vari
            Cells(ze, 28) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 28) = "f"
        End If
    End If
End If
'IF
If Left(Cells(ze, 3), 2) = "IF" Then
    If Right(Cells(ze, 3), 1) = 1 Then
        If [BW9] > 0 Then
            Cells(ze, 5) = "=BW$9" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BX9] > 0 Then
            Cells(ze, 6) = "=BX$9" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BW$11" 'H|fffd|he UK
        Cells(ze, 14) = "=BV$9" 'U-Wert
    End If
     If Right(Cells(ze, 3), 1) = 2 Then
        If [BW10] > 0 Then
            Cells(ze, 5) = "=BW$10" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [BX10] > 0 Then
            Cells(ze, 6) = "=BX$10" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BW$12" 'H|fffd|he UK
        Cells(ze, 14) = "=BV$10" 'U-Wert
    End If
End If
'IT
If Left(Cells(ze, 3), 2) = "IT" Then
    If Right(Cells(ze, 3), 1) = 1 Then
        If [BZ9] > 0 Then
            Cells(ze, 5) = "=BZ$9" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CA9] > 0 Then
            Cells(ze, 6) = "=CA$9" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BZ$11" 'H|fffd|he UK
        Cells(ze, 14) = "=BY$9" 'U-Wert
    End If
    If Right(Cells(ze, 3), 1) = 2 Then
        If [BZ10] > 0 Then
            Cells(ze, 5) = "=BZ$10" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
         Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CA10] > 0 Then
            Cells(ze, 6) = "=CA$10" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 12) = "=BZ$12" 'H|fffd|he UK
        Cells(ze, 14) = "=BY$10" 'U-Wert
    End If
End If
'DF
If Left(Cells(ze, 3), 2) = "DF" Then
    If Right(Cells(ze, 3), 1) = 1 Then
        If [CE9] > 0 Then
            Cells(ze, 5) = "=CE$9" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CF9] > 0 Then
            Cells(ze, 6) = "=CF$9" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
        Cells(ze, 14) = "=CD$9" 'U-Wert
    End If
    If Right(Cells(ze, 3), 1) = 2 Then
        If [CE10] > 0 Then
            Cells(ze, 5) = "=CE$10" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CF10] > 0 Then
            Cells(ze, 6) = "=CF$10" 'L|fffd|nge
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
       End If
        Cells(ze, 14) = "=CD$10" 'U-Wert
    End If
End If

Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
Selection.Locked = False
Selection.FormulaHidden = False 'entsperren

z:
End Sub

Sub DA()

If Left(Cells(ze, 3), 2) = "DA" Then

    'G|fffd|ltigkeiten
    '------------
    Range(Cells(ze, 1), Cells(ze, 1)).Select 'L|fffd|schen/Zwischenf|fffd|gen
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AX$3:$AX$4"
    End With
    'Folgezeile
    Range(Cells(ze + 1, 2), Cells(ze + 1, 3)).Select 'Bruttofl|fffd|che
    Selection.Locked = False
    Selection.FormulaHidden = False 'entsperren
    'Auswahl DA1 oder DA2
    Range(Cells(ze, 3), Cells(ze, 3)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$BJ$8:$BJ$9" 'DA1 + DA2
    End With
    
    Call DFB
   
    If Right(Cells(ze, 3), 1) = 1 Then Cells(ze, 14) = "=CC$9" 'U-Wert
    If Right(Cells(ze, 3), 1) = 2 Then Cells(ze, 14) = "=CC$10" 'U-Wert
    
    If Mid(Cells(ze, 3), 3, 1) = "" And sp = 3 Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select 'Bruttofl|fffd|che
        If sp = 3 Then GoTo z
    End If
   
    If Left(Cells(ze, 3), 2) = "DA" Then Range(Cells(ze, 3), Cells(ze, 3)).Select 'Auswahl DA1 oder DA2
    
    If Cells(ze, 14) = 0 Or Cells(ze, 14) = "" Then
        MsgBox ("Bitte vor Aufruf " & Cells(ze, 3) & " erst im Blatt 'Bauteile' U-Wert definieren" & Chr(13) & "oder bereits definiertes DA aufrufen!")
        Range(Cells(ze, 3), Cells(ze, 3)).Select
        GoTo z
    End If
        
    If Cells(ze, 4) = 0 Then Cells(ze, 4) = 1 'Anzahl
    Range(Cells(ze, 4), Cells(ze, 4)).Select   'Feld Anzahl = 1 sperren und begr|fffd|nen
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True
    Selection.FormulaHidden = False 'entsperren
    
    If Cells(ze, 5) = 0 Then Cells(ze, 5) = "=G$7" 'L|fffd|nge
    If Cells(ze, 6) = 0 Then Cells(ze, 6) = "=G$9" 'Breite
    
    If sp = 5 Then Range(Cells(ze, 6), Cells(ze, 6)).Select
    If sp = 5 Then GoTo z

    'G|fffd|ltigkeit Folgezeile
    If ze > zeA Then  'nicht wenn in 1. Zeile Zwischengef|fffd|gt wurde
        Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AW$8:$AW$16"
        End With
        Range(Cells(ze + 1, 3), Cells(ze + 1, 3)).Select 'DF1 - DF2
        With Selection.Validation '
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$11:BJ12"
        End With
      Else
        FlagDA = 1
    End If
    
    'Vorbesetzungen
    Cells(ze, 10) = "e"
    Cells(ze, 11) = "=A$1" 'Temperatur AL
    Cells(ze, 12) = "=G$12"    ' mittlere H|fffd|he zur Berechnung t*, int,k (48)
    ' mittlere H|fffd|he zur Berechnung t*, int,k (48)
    Cells(ze, 13) = "=FQ" + Trim$(Str$(ze))          'Korr-Faktor an AL

    'Korr-Faktur an AL"
    Cells(ze, 15) = "=A$2" 'WB-Zuschlag
    
    'Formeln einsetzen
    Cells(ze, 7) = "=D" + Trim$(Str$(ze)) & "*E" + Trim$(Str$(ze)) & "*F" + Trim$(Str$(ze))   'Bruttofl|fffd|che
    Cells(ze, 9) = "=G" + Trim$(Str$(ze)) & "-H" + Trim$(Str$(ze))  'Nettofl|fffd|che
    Cells(ze, 16) = "=N" + Trim$(Str$(ze)) & "+O" + Trim$(Str$(ze))  'U-korr
    Cells(ze, 17) = "=I" + Trim$(Str$(ze)) & "*M" + Trim$(Str$(ze)) & "*P" + Trim$(Str$(ze)) & "*(G$" + Trim$(Str$(5)) & "-A$" + Trim$(Str$(1)) + ")" & "/1000" 'Q-Norm
    
'    If Cells(ze, 13) > 0 And Cells(ze, 5) > 0 Then Range(Cells(ze + 1, 2), Cells(ze + 1, 2)).Select 'neue Bruttofl|fffd|che

End If
z:
End Sub
Sub L|fffd|_Zwi()

    HR = Cells(ze + 1, 2)
    Art = Left(Cells(ze - 1, 3), 1)
    If Art = "G" Then Art = "A"
    If HR <> "" Then 'Folgezeile ist Bruttofl|fffd|che
        Range(Cells(ze, 2), Cells(ze, 2)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AW8:AW16" 'HR
        End With
    End If
    Range(Cells(ze, 3), Cells(ze, 3)).Select
    If Art = "A" Then
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AY$8:AY$10"
        End With
    End If
    If Art = "I" Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BI$2:$BI5"
        End With
    End If
    If Left(Cells(ze - 1, 3), 2) = "DA" Or Left(Cells(ze - 1, 3), 2) = "DF" Then
        Range(Cells(ze, 3), Cells(ze, 3)).Select
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$11:BJ$12"
        End With
   End If
    'G|fffd|ltigkeiten bzw. Sperrungen (wird mit "Paste" nicht mitgegeben)
    For i = ze + 1 To zeL_Korr
        Range(Cells(i, 2), Cells(i, 12)).Select 'keine G|fffd|ltigkeiten
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
            :=xlBetween
        End With
        Range(Cells(i, 4), Cells(i, 4)).Select 'Anzahl
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AO$7:AO$16"
        End With
        Range(Cells(i, 7), Cells(i, 12)).Select 'gr|fffd|n
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828
        End With
        Selection.Locked = True 'sperren
        'AW
        If Left(Cells(i, 3), 2) = "AW" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BB$12:BB$16" 'AW1 - AW5
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=AJ14:AJ15" 'B oder L (oder frei)
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
            If Cells(i + 1, 2) <> "" Then 'nur wenn keine Abzugsfl|fffd|che an der AW h|fffd|ngt
            End If
        End If
       
        'AF
        If Left(Cells(i, 3), 2) = "AF" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BH$2:BH6" 'AF1 - AF5
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BP$8:BP13" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BQ$8:BQ13" 'H
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
        End If
        'AT
        If Left(Cells(i, 3), 2) = "AT" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BH$8:BH10"
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BS$8:BS11" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BT$8:BT11" 'H
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
        End If
        'Gr|fffd|
        If Left(Cells(i, 3), 2) = "Gr" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BL$2:BL4"
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BM$2:BM4" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BN$2:BN4" 'H
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
            Cells(i, 11) = "hu ="
        End If
        'IW
        If Left(Cells(i, 3), 2) = "IW" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BB$18:BB$22" 'IW1 - IW5
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ15" 'B oder L (oder frei)
            End With
            'a oder ae
            Range(Cells(i, 10), Cells(i, 10)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AX$14:$AX15" 'a, ae
            End With
            With Selection.Interior
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0 'frei
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False 'entsperren
            
            If Cells(i, 10) = "a" Then
                Range(Cells(i, 11), Cells(i, 11)).Select
                With Selection.Validation
                    .Delete
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                    xlBetween, Formula1:="=$AQ$7:$AQ12" '10 - 24 |fffd|C
                End With
                With Selection.Interior
                    .Pattern = xlNone
                    .TintAndShade = 0
                    .PatternTintAndShade = 0 'frei
                End With
                Selection.Locked = False
                Selection.FormulaHidden = False 'entsperren
              Else 'ae
                Range(Cells(i, 13), Cells(i, 13)).Select
                With Selection.Validation
                    .Delete
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                    xlBetween, Formula1:="=$AQ$15:$AQ22" 'f
                End With
                With Selection.Interior
                    .Pattern = xlNone
                    .TintAndShade = 0
                    .PatternTintAndShade = 0 'frei
                End With
                Selection.Locked = False
                Selection.FormulaHidden = False 'entsperren
            End If
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
        End If
        'IF und IT
        If Left(Cells(i, 3), 2) = "IF" Or Left(Cells(i, 3), 2) = "IT" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BI$2:BI$5" 'IF1 - IT2
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BW$8:BW10" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BX$8:$BX$10" 'H
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
            End With
        End If
GoTo FF
'        If Left(Cells(i, 3), 2) = "IT" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BI$2:$BI$5" 'IF1 - IT5
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BZ$8:$BZ$10" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CA$8:$CA$10" 'H
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
'        End If
FF:
        'DE
        If Left(Cells(i, 3), 2) = "DE" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BJ$2:$BJ$3" 'DE1 - DE2
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AS15:$AS16" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AT$15:$AT$15" 'L
            End With
            'a oder ae
            Range(Cells(i, 10), Cells(i, 10)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AX$14:$AX$15" 'a, ae
            End With
            With Selection.Interior
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0 'frei
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False 'entsperren
            If Cells(i, 10) = "a" Then
                Range(Cells(i, 11), Cells(i, 11)).Select
                With Selection.Validation
                    .Delete
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                    xlBetween, Formula1:="=$AQ$7:$AQ$12" '10 - 24 |fffd|C
                End With
                With Selection.Interior
                    .Pattern = xlNone
                    .TintAndShade = 0
                    .PatternTintAndShade = 0 'frei
                End With
                Selection.Locked = False
                Selection.FormulaHidden = False 'entsperren
              Else
                Range(Cells(i, 12), Cells(i, 12)).Select
                With Selection.Validation
                    .Delete
                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                    xlBetween, Formula1:="=$AQ$15:$AQ$22" 'f
                End With
                With Selection.Interior
                    .Pattern = xlNone
                    .TintAndShade = 0
                    .PatternTintAndShade = 0 'frei
                End With
                Selection.Locked = False
                Selection.FormulaHidden = False 'entsperren
            End If
        End If
        'FB
        If Left(Cells(i, 3), 2) = "FB" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BK$2:$BK$3" 'FB1 - FB2
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AS15:$AS16" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AT15:AT16" 'L
            End With
            'a oder ae
        End If
        'DA
        If Left(Cells(i, 3), 2) = "DA" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BJ$8:BJ$9" 'DA1 - DA2
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BK11:$BK$13" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BL$11:$BL$13" 'L
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
        End If
        'DF
        If Left(Cells(i, 3), 2) = "DF" Then
            Range(Cells(i, 3), Cells(i, 3)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$BJ$11:$BJ$12" 'DF1 - DF2
            End With
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CE$8:CE$10" 'B
            End With
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CD8:$CD$10" 'L
            End With
            Cells(i, 7) = "=D" + Trim$(Str$(i)) & "*E" + Trim$(Str$(i)) & "*F" + Trim$(Str$(i))   'Bruttofl|fffd|che
            Cells(i, 9) = "=G" + Trim$(Str$(i)) & "-H" + Trim$(Str$(i))  'Nettofl|fffd|che
        End If
    Next
    
   'restliche Zeilen
    Range(Cells(zeL_Korr + 1, 7), Cells(zeE, 12)).Select 'keine G|fffd|ltigkeiten
'    If Cells(zeA, 2) = "" Then Range(Cells(zeA, 7), Cells(zeE, 12)).Select   '1. Zeile leer
    Selection.ClearContents
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True 'sperren
'MsgBox (4 & "   " & Cells(25, 7))
z:
End Sub

Sub Luftdichtheit_Tab_11()
MsgBox (678)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

Index = [D101]

If Index < 3 Then
    ActiveSheet.Shapes("dropdown 110905").Visible = True
    Range("O11").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O10").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    [O10] = [G105]
    [O11] = "=O10*G16/G13" 'Umrechnung in n50
  Else
    [O11] = 1.5 'Eingabe n50 (Vorschlag)
    ActiveSheet.Shapes("dropdown 11090").Visible = False
    Range("O10").Select 'Feld q50
    With Selection.Interior 'hellgr|fffd|n
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("O11").Select 'Feld q50
    With Selection.Interior 'Feld n50 frei
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
'    [O11] =
    [O10] = "=O11*G13/G16" 'Umrechnung in n50
End If

Application.EnableEvents = True
Application.ScreenUpdating = True
'ActiveSheet.Protect

End Sub

Sub Cursorsteuerung()
'Bruttofl|fffd|chen
If Left(Cells(ze, 3), 2) = "AW" Or Left(Cells(ze, 3), 2) = "IW" Then
    If Cells(ze, 4) = 0 Then Range(Cells(ze, 4), Cells(ze, 4)).Select 'Anzahl
    If Cells(ze, 4) = 0 Then GoTo z
    If Cells(ze, 5) = 0 Then Range(Cells(ze, 5), Cells(ze, 5)).Select 'H|fffd|he (vorbesetzt)
    If Cells(ze, 5) = 0 Then GoTo z
    If Cells(ze, 6) = 0 Then
        Range(Cells(ze, 6), Cells(ze, 6)).Select 'H|fffd|he (vorbesetzt)
        GoTo z
    End If
End If
z:

End Sub
Sub zeLetzt()
    'Ermittlung letzte Zeile
    For i = zeE To zeA Step -1
        If Cells(i, 3) <> 0 Or Cells(i, 3) <> "" Then
            zeL = i
            i = zeA
        End If
    Next
End Sub
Sub Ori()
    Range(Cells(zeL + 1, 3), Cells(zeL + 1, 3)).Select 'G|fffd|ltigkeiten Abzugsfl|fffd|che
    If Left(Cells(zeL, 3), 1) = "A" Then
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$AY$8:AY10" 'AF, AT und Gr|fffd|
        End With
    End If
    If Left(Cells(zeL, 3), 1) = "I" Then
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BI$2:$BI5" 'IF1 - IT2
        End With
    End If
    If Left(Cells(zeL, 3), 2) = "DA" Or Left(Cells(zeL, 3), 2) = "DF" Then
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
            xlBetween, Formula1:="=$BJ$11:BJ12" 'DF1 - DF2
        End With
    End If
    Range(Cells(zeL + 1, 2), Cells(zeL + 1, 2)).Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$AW8:AW16" 'HR
    End With
 End Sub
Sub AW()
    'AW 1
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then 'AW1
        Cells(ze, 14) = "=BN$9" 'U-Werte
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        If [BL9] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BL$9" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'sperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BM9] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BM$9" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'L|fffd|nge aus Raumeingabe
                 .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
           End With
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'AW 2
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then 'AW2
        Cells(ze, 14) = "=BN$10"
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        If [BL10] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BL$10" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BM10] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BM$10" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'L|fffd|nge aus Raumeingabe
                 .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
           End With
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'AW 3
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 3 Then 'AW3
        Cells(ze, 14) = "=BN$11"
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        If [BL11] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BL$11" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BM11] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BM$11" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'AW 4
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 4 Then 'AW4
        Cells(ze, 14) = "=BN$12"
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        If [BL12] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BL$12" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BM12] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BM$12" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'H|fffd|he aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'AW 5
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 5 Then 'AW5
        Cells(ze, 14) = "=BN$13"
        Cells(ze, 15) = "=A$2" 'WB-Zuschlag
        If [BL13] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select 'L|fffd|nge
            Cells(ze, 5) = "=BL$13" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
             Cells(ze, 26) = "f"
       End If
        If [BM13] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select 'H|fffd|he
            Cells(ze, 6) = "=BM$13" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'H|fffd|he aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
             Cells(ze, 27) = "f"
       End If
    End If
z:
End Sub

Sub IW()
    'IW 1
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then '
        Cells(ze, 14) = "=BU$9" 'U-Werte
        Cells(ze, 15) = 0 'WB-Zuschlag
        If [BU19] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BU$19" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'sperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BV19] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BV$19" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'L|fffd|nge aus Raumeingabe
                 .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
           End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'IW 2
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then 'AW2
        Cells(ze, 14) = "=BU$10"
        Cells(ze, 15) = 0 'WB-Zuschlag
        If [BU20] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BU$20" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BV20] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BV$20" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'H|fffd|he aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
    'IW 3
    '--------------------------------------
   If Right(Cells(ze, 3), 1) = 3 Then 'AW3
        Cells(ze, 14) = "=BU$11"
        Cells(ze, 15) = 0 'WB-Zuschlag
        If [BU21] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BU$21" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BV21] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BV$21" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
             Cells(ze, 27) = "f"
       End If
    End If
    'IW 4
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 4 Then '
        Cells(ze, 14) = "=BU$12"
        Cells(ze, 15) = 0 'WB-Zuschlag
        If [BU22] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=BU$22" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BV22] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=BV$22" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'H|fffd|he aus Raumeingabe
                 .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
           End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
             Cells(ze, 27) = "f"
       End If
    End If
    'IW 5
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 5 Then
        Cells(ze, 14) = "=BU$13"
        Cells(ze, 15) = 0 'WB-Zuschlag
        If [BU23] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select 'L|fffd|nge
            Cells(ze, 5) = "=BU$23" 'Breite
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 26) = "v"
         Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AJ14:AJ16" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 26) = "f"
        End If
        If [BV23] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select 'H|fffd|he
            Cells(ze, 6) = "=BV$23" 'H|fffd|he
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'entsperren
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AL14:AL15" 'H|fffd|he aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
            Cells(ze, 27) = "f"
        End If
    End If
End Sub

Sub DFB()
    'sonst Versprung Cursor
    Range(Cells(zeL + 1, 4), Cells(zeL + 1, 6)).Select
    Selection.Locked = False
    Selection.FormulaHidden = False


If Left(Cells(ze, 3), 2) = "DE" Then
    'DE1
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then '1
        If [CB14] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CB$14" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CB14:CB15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
       End If
        If [CB17] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CB$17" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CB$17:CB$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
    End If
    'DE2
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then
        If [CB15] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CB$15" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CB14:CB15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CB18] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CB$18" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CB$17:CB$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
    End If
End If
If Left(Cells(ze, 3), 2) = "DA" Then
    'DA1
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then '1
        If [CC14] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CC$14" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CC14:CC15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
       End If
        If [CC17] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CC$17" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CC$17:CC$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
       End If
    End If
    'DA2
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then
        If [CC15] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CC$15" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CC14:CC15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CC18] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CC$18" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CC$17:CC$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
    End If
End If
If Left(Cells(ze, 3), 2) = "FB" Then
    'FB1
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 1 Then '1
        If [CG14] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CG$14" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CG14:CG15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
       End If
        If [CG17] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CG$17" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CG$17:CG$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
             Cells(ze, 27) = "f"
       End If
    End If
    'FB2
    '--------------------------------------
    If Right(Cells(ze, 3), 1) = 2 Then
        If [CG15] > 0 Then
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
            Cells(ze, 5) = "=CG$15" 'Breite
            Call Breite_Vari
            Cells(ze, 26) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
            Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CG14:CG15" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call Breite_frei
            Cells(ze, 26) = "f"
        End If
        If [CB18] > 0 Then
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
            Cells(ze, 6) = "=CG$18" 'H|fffd|he
            Call H|fffd|he_Vari
            Cells(ze, 27) = "v"
          Else
            If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
            Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
            With Selection.Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$CB$17:CB$18" 'L|fffd|nge aus Raumeingabe
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = False
            End With
            Call H|fffd|he_frei
            Cells(ze, 27) = "f"
        End If
    End If
End If
End Sub
Sub Breite_Vari()
    Range(Cells(ze, 5), Cells(ze, 5)).Select   'Bruttofl|fffd|che
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
    End With
    Selection.Locked = True
    Selection.FormulaHidden = False 'sperren
End Sub
Sub Breite_frei()
    If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 5) = 0 'Breite
    Range(Cells(ze, 5), Cells(ze, 5)).Select   'entsperren
    With Selection.Interior 'Feld wei|fffd|
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Sub H|fffd|he_Vari()
    Range(Cells(ze, 6), Cells(ze, 6)).Select   'Bruttofl|fffd|che
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 13434828 'gr|fffd|n
        End With
        Selection.Locked = True
        Selection.FormulaHidden = False 'sperren
End Sub
Sub H|fffd|he_frei()
    If sp <> 4 And sp <> 5 And sp <> 6 Then Cells(ze, 6) = 0 'Breite
    Range(Cells(ze, 6), Cells(ze, 6)).Select   'entsperren
    With Selection.Interior 'Feld wei|fffd|
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False
    Selection.FormulaHidden = False
End Sub
Sub BruttoAnz1()
For i = zeA To zeE
'MsgBox (99)
'GoTo z
    If Left(Cells(i, 3), 2) = "AW" Or Left(Cells(i, 3), 2) = "IW" Or Left(Cells(i, 3), 2) = "DE" Or Left(Cells(i, 3), 2) = "DA" Or Left(Cells(i, 3), 2) = "FB" Then
        Range(Cells(i, 4), Cells(i, 4)).Select   'Anzahl Bruttofl|fffd|che
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 13434828 'gr|fffd|n
        End With
        Selection.Locked = True
        Selection.FormulaHidden = False 'sperren
      Else
        Range(Cells(i, 4), Cells(i, 6)).Select   'Abzugsfl|fffd|che
        With Selection.Interior 'Feld wei|fffd|
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        Selection.Locked = False
        Selection.FormulaHidden = False
    End If
Next
For i = zeE To zeA Step -1
'MsgBox (i & "   " & Cells(i, 3))
    If Cells(i, 3) = 0 Or Cells(i, 3) = "" Then
        Range(Cells(i, 4), Cells(i, 6)).Select   'Bruttofl|fffd|che
        With Selection.Interior 'Feld wei|fffd|
            .Pattern = xlNone
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        Selection.Locked = True
        Selection.FormulaHidden = False
      Else
        j = i
        i = zeA
        Range(Cells(j + 1, 2), Cells(j + 1, 2)).Select 'Bruttofl|fffd|che
    Call Ori
    End If
Next

For i = zeA To zeL
'MsgBox (zeL)
    If Cells(i, 26) <> "" Or Cells(i, 27) <> "" Or Cells(i, 28) <> "" Then
'MsgBox (Cells(i, 3))
        'Abzugsfl|fffd|chen
        If Cells(i, 26) = "v" Then 'Variable
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'sperren
          Else
            Range(Cells(i, 5), Cells(i, 5)).Select
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
        End If
    End If
Next
For i = zeA To zeL
    If Cells(i, 26) <> "" Or Cells(i, 27) <> "" Or Cells(i, 28) <> "" Then
        If Cells(i, 27) = "v" Then 'Variable
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .Color = 13434828 'gr|fffd|n
            End With
            Selection.Locked = True
            Selection.FormulaHidden = False 'sperren
          Else
            Range(Cells(i, 6), Cells(i, 6)).Select
            With Selection.Interior 'Feld wei|fffd|
                .Pattern = xlNone
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Selection.Locked = False
            Selection.FormulaHidden = False
        End If
    End If
Next

'         If Cells(i, 28) = "v" Then 'Variable
'            Range(Cells(i, 12), Cells(i, 12)).Select
'            With Selection.Interior
'                .Pattern = xlSolid
'                .PatternColorIndex = xlAutomatic
'                .Color = 13434828 'gr|fffd|n
'            End With
'            Selection.Locked = True
'            Selection.FormulaHidden = False 'sperren
'          Else
'           Range(Cells(i, 12), Cells(i, 12)).Select
'            With Selection.Interior 'Feld wei|fffd|
'                .Pattern = xlNone
'                .TintAndShade = 0
'                .PatternTintAndShade = 0
'            End With
'            Selection.Locked = False
'            Selection.FormulaHidden = False
'        End If
  '  End If
'Next
z:
End Sub

Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

ze = Target.Row
sp = Target.Column



z:
Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle71"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)

Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect

ze = Target.Row
sp = Target.Column

'|fffd|bertrag in Blatt 'Bauteile'
['Bauteile'!G5] = [F11] 'AW1
['Bauteile'!H5] = [F14]
['Bauteile'!G6] = [F12] 'AW2
['Bauteile'!H6] = [F14]
['Bauteile'!G21] = [F12] 'IW1
['Bauteile'!H21] = [F14]
['Bauteile'!G22] = [F11] 'IW2
['Bauteile'!H22] = [F14]
['Bauteile'!G30] = [F11] 'DE
['Bauteile'!H30] = [F12]
['Bauteile'!G32] = [F11] 'DA
['Bauteile'!H32] = [F12]
['Bauteile'!G36] = [F11] 'FB
['Bauteile'!H36] = [F12]

'Cursorsteuernung
If [H1] > 0 And ze = 1 And sp = 8 Then 'Projekt
    Range("H6").Select 'Bezeichnung Halle
    GoTo z
End If
If [I3] > 0 And ze = 3 And sp = 9 Then 'Projekt
    Range("H6").Select 'Bezeichnung Halle
    GoTo z
End If
If [H6] > 0 And ze = 6 And sp = 8 Then 'Projekt
    Range("F11").Select 'Feld L|fffd|nge
    GoTo z
End If
If [F11] > 0 And ze = 11 And sp = 6 Then 'Feld L
    Range("F12").Select 'Feld B
    GoTo z
End If
If [F12] > 0 And ze = 12 And sp = 6 Then
    Range("F14").Select 'H|fffd|he
    GoTo z
End If
If [F14] > 0 And ze = 14 And sp = 6 Then
    Range("F15").Select 'Summe AW-L|fffd|nge
    [F15] = "=2*(F11+F12)" 'Summe Wandl|fffd|nge (Umfang)
    GoTo z
End If

'Geb|fffd|udeberechnung
If [F13] = 0 Or [F13] = "" Then
    [F13] = "=F11*F12" 'Fl|fffd|che
    Range("F14").Select 'H|fffd|he
End If

['Hilfsblatt Projekt'!$B$59] = 2
If [F16] = [F11] Or [F16] = [F12] Then ['Hilfsblatt Projekt'!$B$59] = 1  'mehr als eine exponierte WA

If [M20] = 0 Or [M20] = "" Then [M20] = "=INDEX('Hilfsblatt Projekt'!G32:G36,'Hilfsblatt Projekt'!D31)"

'Hinweis zu hohes Delta-WB
If [M17] > 0.2 Then
    Antwort = MsgBox("Der eingegebe W|fffd|rmebr|fffd|ckenzuschlag von " & [M17] & " W/m|fffd|K ist sehr hoch! OK?", vbYesNo)
    If Antwort = vbNo Then
        [M17] = 0
        Range("J37").Select
    End If
End If

If ze = 31 And sp = 10 Then [M31] = [J31] * [M14] / [M16]      'Umrechnung auf q50 (31) q50 = n50 *V/A

If [M36] = 0 Or [M36] = "" Then
    [M36] = "=J36" 'h-Geb|fffd|ude = h-Referenz
    Range("J37").Select
End If

If [F32] = 0 Or [F32] = "" Then [F32] = 3 'm/s Wind


If [F48] = 0 Or [F48] = "" Then [F48] = "=F16" 'erdreichber|fffd|hrter Umfang"

z:
If [F15] >= [X13] Then
    ['Hilfsblatt Projekt'!O32] = 2 'Index > 1 Fassade
    [F30] = "mehrere"
End If
If [F15] = [X11] Or [F15] = [X12] Then
    ['Hilfsblatt Projekt'!O32] = 1 'Index = 1 Fassade
    [F30] = "eine"
End If

'Fehlermeldungen
If ['Klimadaten'!M5] = 1 Then
    MsgBox ("Bitte PLZ und Ort im Blatt 'Projekt' ausw|fffd|hlen")
    Sheets("Projekt").Select
End If
If [M36] < [ J36] Then
    MsgBox ("Geb|fffd|ude muss mindestens die H|fffd|he des Referenzortes haben")
    [M36] = "=J36"
End If


Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect

End Sub
























Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' _z)^

INQUEST-PP=macro
