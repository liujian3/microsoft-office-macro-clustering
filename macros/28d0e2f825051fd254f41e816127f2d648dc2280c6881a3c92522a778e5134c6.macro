Attribute VB_Name = "Hitachi"
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
Option Explicit
'-----------------------------------------------------------
' <|fffd|T|fffd|u|fffd|V|fffd|X|fffd|e|fffd||fffd|> |fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|^|fffd|p|fffd|x|fffd||fffd||fffd|@|fffd|\
' <|fffd||fffd||fffd||fffd|>         Hitachi
' <|fffd|@|fffd|\>         |fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||34f|o|fffd||fffd|
' <|fffd||fffd||fffd|l>         Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||1374d||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||343|}|fffd|[|fffd|W|fffd|A|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||342||fffd||fffd||302||702||708||690|A|fffd|j
' <|fffd||fffd||fffd||fffd|>         Excel VBA
' <|fffd||fffd||fffd||fffd|>         |fffd||fffd||fffd||fffd||fffd||343|}|fffd|[|fffd|W|fffd|A|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||342||fffd||fffd||302||702||708||690|A
' V01R001 -      2018/09/01  |fffd|V|fffd|K|fffd||c42c|
' V01R002 -      2017/10/10  INS(|fffd|_|fffd|c)  H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 |fffd||fffd|d|fffd|E|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||314||fffd||fffd|l|fffd||fffd||fffd||389||fffd|
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-2 |fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|E|fffd||fffd|36|fffd|\|fffd|u|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|v|fffd||fffd||fffd||fffd|
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-5 |fffd||fffd||fffd|[|fffd||30a|J|fffd|n|fffd|s|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||30c||fffd||fffd|m|fffd||241|u|fffd|Z|fffd||fffd||fffd||316||fffd||fffd|O|fffd|v|fffd||fffd||752||80b5||fffd||389||fffd|
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 |fffd|V|fffd|G|fffd|l|fffd|V|fffd|[|fffd|g|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|{|fffd|A|fffd|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 |fffd|Z|fffd||fffd||fffd|f|fffd||282||582||30b|L|fffd||682||202||fffd||fffd||fffd||fffd||357|l|fffd||fffd|36|fffd|\|fffd||30d||c42c||fffd||34d|s|fffd||fffd||202||fffd|
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-1|fffd|u|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|v|fffd|@|fffd|\|fffd||312||1c9||fffd|
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 |fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|u|fffd|G|fffd||fffd||fffd|A|fffd|O|fffd|i|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||501|j|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd|u|fffd||fffd||fffd||48a||50e||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||3cd|X|fffd||389||fffd||fffd|j
' V01R003 -      2017/11/01  INS(|fffd|_|fffd|c)  H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||6d1||fffd||389||fffd|(|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||242||102|R|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||183|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||389||fffd||fffd|j
' V01R004 -      2017/11/20  INS(|fffd|_|fffd|c)  H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](10|fffd|s|fffd||688||20a|O|fffd||301|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||343|G|fffd||fffd||fffd|[|fffd|j
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||312||1c9||fffd||fffd|j
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd||fffd||fffd|[|fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j
'                                       H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](|fffd||fffd|\|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||182||fffd||fffd||fffd||389||fffd||fffd|i|fffd||6d1||fffd||389||fffd||fffd||242||10d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||302|R|fffd|V|fffd|[|fffd|g|fffd||389||fffd||fffd||fffd|{|fffd|d|fffd|l|fffd||255||3cd|X|fffd|j
' V01R005 -      2017/11/28  INS(|fffd|_|fffd|c)  H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||153||fffd||fffd||34c||fffd||fffd|i|fffd|N|fffd|x|fffd|j|fffd||24b||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||d3dc||fffd|j
' V01R006 -      2018/01/18  INS(|fffd|_|fffd|c)  |fffd||68b|q|fffd|v|fffd|]|fffd|@|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||58c||fffd||317|l|fffd||fffd||fffd||fffd|34|fffd||251||382||fffd||fffd||fffd|s|fffd||1c9||fffd||fffd|i|fffd||d3dc||fffd|j|fffd||fffd||fffd||94|\|fffd||182||fffd||fffd||fffd||389||fffd|
' V01R007 -      2018/02/16  INS(|fffd|_|fffd|c)  |fffd|s|fffd||f347||fffd||389||fffd|  |fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|E|fffd||fffd|36|fffd|\|fffd||301|u|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||481|v|fffd||311||fffd||fffd||fffd||fffd||242||101|u|fffd||fffd||fffd|v|fffd|v|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||102||fffd||fffd||702||fffd||fffd|s|fffd||f347||fffd||38d||fffd|
' V01R008 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]3 IR1 |fffd||2433||fffd|V|fffd|[|fffd|g|fffd||2ce||fffd|d|fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||253|]|fffd|L
' V01R009 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||c42c|
' V01R010 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]6 IR1 |fffd||a5d7||fffd||243|t|fffd|B|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
' V01R011 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 |fffd|L|fffd||68f||fffd||fffd|w|fffd||fffd|t|fffd||fffd||fffd|O|fffd||1c9||fffd|
' V01R012 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]22 IR1 |fffd||2433|(KW)|fffd|w|fffd||fffd|P|fffd|V|fffd|[|fffd|g|fffd|]|fffd|L
' V01R013 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 |fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||315||3cd|X
' V01R014 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]33 IR1 |fffd|{|fffd|^|fffd||fffd||fffd||248||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||18e||fffd||fffd|s|fffd||fffd|u|fffd|I|fffd|[|fffd|g|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||142||fffd||fffd|B|fffd||102||44f|o|fffd||fffd||fffd||60aa||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd|B|fffd|v|fffd||195|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' V01R015 -      2019/11/01  FSI(|fffd||fffd|c)  2019|fffd|N|fffd|x|fffd||fffd||fffd|C 2|fffd|N|fffd|x|fffd||692||1c9||fffd||fffd||389||fffd|
' All Rights Reserved , Copyright (C) 2017, 2018 , Hitachi , Ltd.
'-----------------------------------------------------------
Public Const CELLNAME = "10|fffd||fffd|kW|fffd||209||fffd||fffd||a287|"
'|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|[
Public Const SHEET_NM_LIST_ARRAY As String = "|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[,|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|["
'|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[|fffd||fffd|d
'2019/11/01 V01R015 UPD START
'Public Const RECEIVE_POWER_ARRAY As String = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d"
Public Const RECEIVE_POWER_ARRAY As String = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
'2019/11/01 V01R015 UPD END
'|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[|fffd||fffd||fffd|d
'2019/11/01 V01R015 UPD START
'Public Const TRANSMIT_POWER_ARRAY As String = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d" '
Public Const TRANSMIT_POWER_ARRAY As String = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
'2019/11/01 V01R015 UPD END
Public Const POWER_GENERATION_PRODUCER = "|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|"
Public Const GENERAL_POWER_TRANSMISSION = "|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|"
Public Const REGISTRATION_SPECIFIC_POWER_TRANSMISSION = "|fffd|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|"
Public Const RETAIL_ELECTRICITY_BUSINESS = "|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|"
Public Const POWER_TRANSMISSION_BUSINESS = "|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|"
Public Const SPECIFIC_POWER_TRANSMISSION = "|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|"
Public Const OTHER_BUSINESS = "|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|"
                            
Public Const AREA_HOKKAIDO = "|fffd|k|fffd|C|fffd||fffd|"
Public Const AREA_TOHOKU = "|fffd||fffd||fffd|k"
Public Const AREA_TOKYO = "|fffd||fffd||fffd||fffd|"
Public Const AREA_CHUBU = "|fffd||fffd||fffd||fffd|"
Public Const AREA_HOKURIKU = "|fffd|k|fffd||fffd|"
Public Const AREA_KANSEI = "|fffd||590||fffd|"
Public Const AREA_CYUUGOKU = "|fffd||fffd||fffd||fffd|"
Public Const AREA_SIGOKU = "|fffd|l|fffd||fffd|"
Public Const AREA_KYUSHU = "|fffd||fffd|B"
Public Const AREA_OUKINAWA = "|fffd||fffd||fffd||fffd|"
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY START
'Public Const NENSYU_OTHERS = "0"     '0|fffd|V|fffd|G|fffd|l|fffd||20a|O
Public Const NENSYU_OTHERS_NM = ""
Public Const NENSYU_ALWAYS_BACKUP = "|fffd||d39e||fffd|o|fffd|b|fffd|N|fffd|A|fffd|b|fffd|v"
Public Const NENSYU_COMPOSITE = "|fffd||fffd||fffd||311||fffd||fffd|i|fffd|d|fffd||fffd||fffd||fffd||28d||fffd||fffd||fffd||fffd||fffd||fffd|j"
Public Const NENSYU_WATER = "|fffd||fffd||fffd||fffd|"
Public Const NENSYU_HEAT = "|fffd||397||fffd|"
Public Const NENSYU_NUCLEAR = "|fffd||fffd||fffd|q|fffd||fffd|"
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY END
Public Const NENSYU_WIND_NM = "|fffd||fffd||fffd||fffd|"
Public Const NENSYU_SUN_ALL_NM = "|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j"
Public Const NENSYU_SUN_LEFT_NM = "|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j"
Public Const NENSYU_GROTHERMAL_NM = "|fffd|n|fffd|M"
Public Const NENSYU_BIOMASS_NM = "|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X"
Public Const NENSYU_WASTE_NM = "|fffd|p|fffd||fffd||fffd||fffd|"
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD START
Public Const KUBUN_JISYA_NM = "|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd|"
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD END
'
'|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s
Public Const COPY_ORIGIN_ST As Long = 25
'|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s
Public Const COPY_TARGET_ST As Long = 63
                            
Public Const SUBTOTAL = "|fffd||fffd|    |fffd|v"
'|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd|1
Public Const TOGETHER_FLAG = "1"
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
Public Const ProtectListSheetName As String = "|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g"
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START
Public AREA_NAME(1 To 10) As String
'|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a| 0:|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|, 1:|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|, 2:|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|, 3:|fffd||fffd||fffd||311||fffd|
'|fffd||fffd||fffd|G|fffd||fffd||fffd|A         1:|fffd|k|fffd|C|fffd||fffd|, 2:|fffd||fffd||fffd|k, 3:|fffd||fffd||fffd||fffd|, 4:|fffd||fffd||fffd||fffd|, 5:|fffd|k|fffd||fffd|, 6:|fffd||590||fffd|, 7:|fffd||fffd||fffd||fffd|, 8:|fffd|l|fffd||fffd|, 9:|fffd||fffd|B, 10:|fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd|       0:|fffd|V|fffd|G|fffd|l|fffd||20a|O, 1:|fffd||fffd||fffd||fffd|, 2:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j, 3:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j, 4:|fffd|n|fffd|M, 5:|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X, 6:|fffd|p|fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|             0:4|fffd||fffd|, 1:5|fffd||fffd|, 2:6|fffd||fffd|, 3:7|fffd||fffd|, 4:8|fffd||fffd|, 5:9|fffd||fffd|, 6:10|fffd||fffd|, 7:11|fffd||fffd|, 8:12|fffd||fffd|, 9:1|fffd||fffd|, 10:2|fffd||fffd|, 11:3|fffd||fffd|
'|fffd||fffd||fffd|N|fffd|x           0:|fffd||fffd||fffd|N|fffd|x, 1:+1|fffd|N|fffd|x, 2:+2|fffd|N|fffd|x, 3:+3|fffd|N|fffd|x, 4:+4|fffd|N|fffd|x, 5:+5|fffd|N|fffd|x, 6:+6|fffd|N|fffd|x, 7:+7|fffd|N|fffd|x, 8:+8|fffd|N|fffd|x, 9:+9|fffd|N|fffd|x
'OutPutData
'  L countTotal(3) As Long|fffd|@                         '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||303|g|fffd|[|fffd|^|fffd||fffd||fffd|s|fffd||fffd|
'  L countTotalSeparation(3) As Long                 '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O = |fffd||d4482||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||303|g|fffd|[|fffd|^|fffd||fffd||fffd|s|fffd||fffd|
'  L LicenseKind(3) As Long                          '|fffd|Y|fffd||fffd| |fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a|
'      L AreaInfo(1 To 10) As stArea|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@       '|fffd|Y|fffd||fffd| |fffd|G|fffd||fffd||fffd|A
'          L GenerationKind(6) As stGenerationKind   '|fffd|Y|fffd||fffd| |fffd||fffd||fffd|d|fffd||fffd||fffd|
'              L Syubetu As String                   '|fffd||fffd||fffd|l|fffd||fffd|1|fffd|s|fffd||68e||fffd||fffd|
'              L Biko As String|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  '|fffd||fffd||fffd|l|fffd||fffd|3|fffd|s|fffd||694||fffd||fffd|l
'              L ShortTermPower(11) As String        '|fffd|Z|fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd||313|d|fffd||357||282||30d||fffd||fffd|Z |fffd|@|fffd|@|fffd|@ |fffd|Y|fffd||fffd| |fffd||fffd|
'              L ShortTermMonthPower(11) As String   '|fffd|Z|fffd||fffd||fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313|d|fffd||357||282||30d||fffd||fffd|Z |fffd|Y|fffd||fffd| |fffd||fffd|
'              L LongTermPower8(9) As String         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j8|fffd||fffd| |fffd|Y|fffd||fffd| |fffd|N|fffd|x
'              L LongTermPower1(9) As String         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j1|fffd||fffd| |fffd|Y|fffd||fffd| |fffd|N|fffd|x
'              L LongTermYearPower(9) As String      '|fffd|N|fffd||512||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j |fffd|Y|fffd||fffd| |fffd|N|fffd|x
'              L countTotalTogether As Long          '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O = 1 |fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||303|g|fffd|[|fffd|^|fffd||fffd||fffd|s|fffd||fffd|
'              L SortNo As Long                      '|fffd|L|fffd||68f||fffd||fffd|w|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||342||30f||a347||fffd||341|u0|fffd|v|fffd|j
'              |fffd||209||fffd||fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||302||74e|g|fffd|p
'              L JigyosyaName As String              '|fffd||fffd||fffd||18e||496||fffd|
'              L AreaName As String                  '|fffd|G|fffd||fffd||fffd|A|fffd||fffd|
Public Type stGenerationKind
    Syubetu As String
    biko As String
    '2019/11/01 V01R015 UPD START
    'ShortTermPower(11) As String
    'ShortTermMonthPower(11) As String
    ShortTermPower(23) As String
    ShortTermMonthPower(23) As String
    '2019/11/01 V01R015 UPD END
    LongTermPower8(9) As String
    LongTermPower1(9) As String
    LongTermYearPower(9) As String
    countTotalTogether As Long
    JigyosyaName As String
    AreaName As String
    SortNo As Long
    DataCount As Long
End Type
Public Type stArea
    GenerationKind(6) As stGenerationKind
End Type
Public Type stLicenseKind
    AreaInfo(1 To 10) As stArea
End Type
Public Type stOutPutData
    countTotal() As Long
    countTotalSeparation() As Long
    LicenseKind() As stLicenseKind
End Type
Public OutPutData As stOutPutData
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD START
Public SortData() As stGenerationKind
Public Type stDataRow
    DataStartRow As Long
    DataEndRow As Long
End Type
Public Type stLicense
    License(3) As stDataRow
End Type
Public Type stDataStartEndInfo
    AreaInfo(1 To 10) As stLicense
End Type
Public DataStartEndInfo As stDataStartEndInfo
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
'|fffd||fffd|Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||281|A|fffd||fffd||fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||250||752||80b7||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: toWorkSheet|fffd|@|fffd|@|fffd|@-|fffd||38f||6c3|V|fffd|[|fffd|g
'             rowNo            -|fffd|s|fffd||513||fffd|
'             column|fffd|@         -|fffd||55d8e||fffd||fffd||fffd|
'             shubetsu|fffd|@       -|fffd||fffd||295||fffd||fffd||fffd||fffd||fffd|
'             biko|fffd|@|fffd|@|fffd|@       -|fffd||fffd||fffd|l
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||30d|s|fffd||24e||fffd||281|A|fffd||fffd||fffd||30d|s|fffd||254||fffd||fffd|l|fffd||fffd||752||80b7||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
'H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||314||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||389||fffd| Module|fffd||fffd||fffd||fffd|) MODIFY START
'Private Sub SetBiko(ByVal toWorkSheet As Worksheet, ByVal rowNo As Long, ByVal column As String, ByVal shubetsu As String, ByVal biko As String)
Public Sub SetBiko(ByVal toWorkSheet As Worksheet, ByVal rowNo As Long, ByVal column As String, ByVal shubetsu As String, ByVal biko As String)
'H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||314||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||389||fffd| Module|fffd||fffd||fffd||fffd|) MODIFY END
33310    toWorkSheet.Range(column & rowNo).Value = shubetsu
33320    toWorkSheet.Range(column & rowNo + 1).Value = biko
End Sub
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END

' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-1 IR1 20171010 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||58f||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Public Sub |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||fffd|()
33490    On Error GoTo OnErrHande
33500
33510    Dim Sheet As Worksheet            '|fffd|u|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|v|fffd|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
33520    Dim inputList As Range            ' |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||301|u|fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||a5d7||fffd||348||fffd|
33530    Dim inputRange As Range           ' |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||301|u|fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||a5d7||fffd||fffd||fffd||fffd|1|fffd|Z|fffd||fffd|
33540    Dim outputList As Range           ' |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||301|u|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|v|fffd||a5d7||fffd||348||fffd|
33550    Dim targetList As Range           '|fffd|u|fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||a5d7||fffd||181|u|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|v|fffd||a5d7||fffd||314||348||34c||fffd||fffd||fffd|
33560    Dim k As Integer                  ' |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||317||432c1|[|fffd|v|fffd|p|fffd||3d0||fffd|
33570    Dim j As Integer                  ' |fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||30d|s|fffd||fffd||fffd|[|fffd|v|fffd|p|fffd||3d0||fffd|
33580    Dim i As Integer                  ' |fffd||fffd||fffd||fffd||348||353||fffd||fffd|s|fffd||303||fffd||fffd|[|fffd|v|fffd|p|fffd||3d0||fffd|
33590    Dim target As String              ' targetList|fffd||fffd||fffd||312|P|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|
33600    Dim areaNameList As Range         ' |fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd|A|fffd|y|fffd||441|u|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O|fffd|v|fffd||310||752||fffd|l|fffd||314||348||fffd|
33610    Dim targetSheet As Worksheet      ' |fffd|\|fffd||fffd||fffd||611||591||38f||6c3|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
33620    Dim printAreaStr As String        ' |fffd||fffd||fffd||fffd||38f||6c2||303|Z|fffd||fffd||fffd||348||341|iA1|fffd|`|fffd||fffd||fffd|j
33630    Dim printAreaRange As Range       ' |fffd||fffd||fffd||fffd||348||342||303||fffd||fffd||fffd||fffd|W|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
33640    Dim StartRow As Long              ' |fffd|G|fffd||fffd||fffd|A|fffd|J|fffd|n|fffd|s|fffd||50d||fffd|
33650    Dim areaNo As Variant             ' |fffd|k|fffd|C|fffd||fffd||fffd||fffd|1|fffd|`|fffd||fffd||fffd||fffd||fffd|10|fffd||182||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||314||50d||fffd|
33660    Dim prevStartRow As Long          ' 1|fffd||91|O|fffd||303|G|fffd||fffd||fffd|A|fffd||30a|J|fffd|n|fffd|s|fffd||50d||fffd|
33670    Dim prevEndRow As Long            ' 1|fffd||91|O|fffd||303|G|fffd||fffd||fffd|A|fffd||30f|I|fffd||fffd||fffd|s|fffd||50d||fffd|
33680    Dim prevAreaNo As Variant         ' 1|fffd||91|O|fffd||303|G|fffd||fffd||fffd|A|fffd||50d||fffd|
33690    Dim defaultHiddenStartRow As Long ' |fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||242||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||314||fffd|\|fffd||fffd||fffd|J|fffd|n|fffd|s
33700    Dim defaultHiddenEndRow As Long   ' |fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||242||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||314||fffd|\|fffd||fffd||fffd|I|fffd||fffd||fffd|s
33710    Dim strErr() As String            ' |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
         Dim ws As Worksheet
         Dim TargetSheetName() As String
         Dim SheetCount As Long
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
33720
33730    Debug.Print Time & "|fffd|J|fffd|n"
33740
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE START
'33750    Application.ScreenUpdating = False
'33760    Application.Calculation = xlCalculationManual
'33770    Application.DisplayStatusBar = False
'33780    Application.EnableEvents = False
'33790    Application.EnableCancelKey = xlDisabled
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE END
33800
33810    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START
         If Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB21").Value) = "" Then
             MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|iAB21|fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
             Exit Sub
         End If
         If Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value) = "" Then
             MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10b||fffd||fffd|v|fffd|p|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|iAB18|fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
             Exit Sub
         End If
         Application.ScreenUpdating = False
         Application.Calculation = xlCalculationManual
         Application.DisplayStatusBar = False
         Application.EnableEvents = False
         Application.EnableCancelKey = xlDisabled
         SheetCount = 0
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END
33820
33830    Set Sheet = ThisWorkbook.Sheets("|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||fffd|")
33840    Set inputList = Sheet.Range("K3:K8")
         '2019/11/01 V01R015 UPD START
33850    'Set outputList = Sheet.Range("I3:I19")
         Set outputList = Sheet.Range("I3:I24")
         '2019/11/01 V01R015 UPD END
33860    Set targetList = Union(inputList, outputList)
33870
33880    '|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O|fffd||fffd||fffd|X|fffd|g
33890    Set areaNameList = ThisWorkbook.ActiveSheet.Range("B4:C13")
33900
33910    '|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd||432c1|[|fffd|v
33920    For k = 1 To targetList.Areas.Count Step 1
33930        '|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||591||38f||6d2||fffd||fffd|[|fffd|s|fffd||fffd||fffd|[|fffd|v
33940        For j = 1 To targetList.Areas(k).Rows.Count Step 1
33950            target = targetList.Areas(k).Rows(j).Columns(1).Value
33960
33970            i = 0
33980            StartRow = 0
33990            prevStartRow = 0
34000            prevEndRow = 0
34010            areaNo = Null
34020            prevAreaNo = Null
34030
34040            Set targetSheet = ThisWorkbook.Sheets(target)
34050            printAreaStr = targetSheet.PageSetup.PrintArea
34060            Set printAreaRange = targetSheet.Range(printAreaStr)
34070
                 'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'34080            ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
'34090            ThisWorkbook.Worksheets(target).Unprotect Password:=pass
                 Set ws = ThisWorkbook.Worksheets(target)
                 ReDim Preserve TargetSheetName(SheetCount)
                 TargetSheetName(SheetCount) = target
                 Call ProtectSheet(ws, False)
                 SheetCount = SheetCount + 1
                 'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
34100
34110            ' |fffd||fffd||fffd||fffd||348||353||fffd||fffd|s|fffd||fffd||fffd|[|fffd|v
34120            For i = 1 To printAreaRange.Rows.Count Step 1
34130                If printAreaRange(i, 2).Value Like "|fffd|l|fffd||fffd||fffd||fffd|R*" Then
34140                    '|fffd|l|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30f||a347|
34150                    '|fffd||fffd||fffd||742||30a|J|fffd|n|fffd|s|fffd|m|fffd||fffd|
34160                    StartRow = printAreaRange(i, 2).Row
34170                    '1|fffd||fffd||fffd|O|fffd||30d||14f|I|fffd|s|fffd|m|fffd||fffd|
34180                    prevEndRow = StartRow - 1
34190                Else
34200                End If
34210
34220                If StartRow = 0 And printAreaRange(i, 2).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
34230                    '|fffd||fffd||fffd||34e|x|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30f||a347|
34240                    '|fffd||fffd||fffd||742||30a|J|fffd|n|fffd|s|fffd|m|fffd||fffd|
34250                    StartRow = printAreaRange(i, 2).Row
34260                    '1|fffd||fffd||fffd|O|fffd||30d||14f|I|fffd|s|fffd|m|fffd||fffd|
34270                    prevEndRow = StartRow - 1
34280                Else
34290                End If
34300
34310                If StartRow <> 0 Then
34320                    If printAreaRange(i, 4).Value <> "" Then
34330                        ' |fffd||fffd||fffd||742||30a|J|fffd|n|fffd|s|fffd||fffd||fffd|m|fffd||80b5||fffd|AE|fffd||fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||611||595|\|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
34340                        areaNo = GetArea(printAreaRange(i, 4).Value, areaNameList)
34350                    ElseIf printAreaRange(i, 5).Value <> "" Then
34360                        ' |fffd||fffd||fffd||742||30a|J|fffd|n|fffd|s|fffd||fffd||fffd|m|fffd||80b5||fffd|AF|fffd||fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||611||595|\|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
34370                        areaNo = GetArea(printAreaRange(i, 5).Value, areaNameList)
34380                    End If
34390                Else
34400                End If
34410
34420                If StartRow <> 0 And IsNull(areaNo) = False Then
34430                    '|fffd||fffd||fffd||742||30a|J|fffd|n|fffd|s|fffd|A|fffd||fffd||fffd||742||310||611||595|\|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd|m|fffd||80b5||fffd||fffd||fffd||a347||fffd|A1|fffd||fffd||fffd|O|fffd||314||fffd|\|fffd||fffd|/|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|B
34440
34450                    defaultHiddenStartRow = 0
34460                    defaultHiddenEndRow = 0
34470
34480                    For Each inputRange In inputList
34490                       If target = inputRange.Value Then
34500                            defaultHiddenEndRow = prevEndRow - 1
34510                            defaultHiddenStartRow = defaultHiddenEndRow - 12
34520                            Exit For
34530                        Else
34540                        End If
34550                    Next inputRange
34560
34570                    Call SetAreaDisp(targetSheet, prevStartRow, prevEndRow, prevAreaNo, defaultHiddenStartRow, defaultHiddenEndRow)
34580
34590                    '|fffd||fffd||fffd||742||30f||fffd||fffd||fffd|1|fffd||fffd||fffd|O|fffd||30f||fffd||fffd||182||fffd||fffd||115||6ce||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
34600                    prevStartRow = StartRow
34610                    prevAreaNo = areaNo
34620
34630                    StartRow = 0
34640                    areaNo = Null
34650                Else
34660                End If
34670            Next i
34680
34690            If prevStartRow <> 0 And IsNull(prevAreaNo) = False Then
34700                ' |fffd||14f|I|fffd|G|fffd||fffd||fffd|A|fffd|i|fffd||fffd||fffd||fffd||202||1c1|j|fffd||302||fffd||fffd||7c2||241|A|fffd||fffd||fffd|[|fffd|v|fffd||fffd||254||fffd|\|fffd||fffd|/|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
34710                prevEndRow = Mid(printAreaStr, InStrRev(printAreaStr, "$") + 1)
34720
34730                defaultHiddenStartRow = 0
34740                defaultHiddenEndRow = 0
34750                For Each inputRange In inputList
34760                   If target = inputRange.Value Then
34770                        defaultHiddenEndRow = prevEndRow - 1
34780                        defaultHiddenStartRow = defaultHiddenEndRow - 12
34790                        Exit For
34800                    Else
34810                    End If
34820                Next inputRange
34830
34840                Call SetAreaDisp(targetSheet, prevStartRow, prevEndRow, prevAreaNo, defaultHiddenStartRow, defaultHiddenEndRow)
34850            Else
34860            End If
34870
34871            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]  20180118 |fffd||68b|q|fffd|v|fffd|](|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||58c||fffd||317|l|fffd||fffd||fffd||fffd|34|fffd||251||382||fffd||fffd||fffd||389||fffd|) ADD START
                 'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 DELETE START
'34872            If target Like "|fffd|l|fffd||fffd||fffd||fffd|34*" Then
'34873                ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
'34874                ThisWorkbook.Worksheets(target).Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True, AllowInsertingRows:=True, AllowDeletingRows:=True
'34875            Else
'34880                ' |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
'34890                ThisWorkbook.Worksheets(target).Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True
'34891            End If
                 'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 DELETE END
34892            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]  20180118 |fffd||68b|q|fffd|v|fffd|](|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||58c||fffd||317|l|fffd||fffd||fffd||fffd|34|fffd||251||382||fffd||fffd||fffd||389||fffd|) ADD START
34900        Next j
34910    Next k
34920
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
         For SheetCount = LBound(TargetSheetName()) To UBound(TargetSheetName())
             Set ws = ThisWorkbook.Worksheets(TargetSheetName(SheetCount))
             Call ProtectSheet(ws, True)
         Next
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
34930    GoTo ExitHande
34940
34950 OnErrHande:
34960    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||315||fffd||fffd||fffd|
34970    strErr = Split(Err.Description, ".")
34980    If UBound(strErr) > 0 Then
34990        Call ShowErrorMessage("|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||fffd|", Err.Number, strErr(0), strErr(1))
35000    Else
35010        Call ShowErrorMessage("|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||fffd|", Err.Number, Err.Description, VBA.Erl)
35020    End If
35030
35040 ExitHande:
35050    Sheet.Activate
35060
35070    Application.EnableCancelKey = xlInterrupt
35080    Application.Calculation = xlCalculationAutomatic
35090    Application.ScreenUpdating = True
35100    Application.DisplayStatusBar = True
35110    Application.EnableEvents = True
35120
35130    Debug.Print Time & "|fffd|I|fffd||fffd|"
35140
35150    If Err.Number = 0 Then
35160        MsgBox "|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||582||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
35170    Else
35180    End If
35190
35200    Err.Clear
End Sub

'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|w|fffd||fffd|G|fffd||fffd||fffd|A|fffd||303|G|fffd||fffd||fffd|A|fffd||50d||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd|G|fffd||fffd||fffd|A|fffd||50d||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetAreaName|fffd|@|fffd|@|fffd|@-|fffd||38f||6c3|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
'             areaNameList        -|fffd|u|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|X|fffd|g
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function GetArea(ByVal targetAreaName As String, ByRef areaNameList As Range) As Variant
35360    Dim AreaName As Range ' |fffd|u|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd|1|fffd|G|fffd||fffd||fffd|A|fffd||fffd|
35370    Dim result As Variant ' |fffd|G|fffd||fffd||fffd|A|fffd||314||50d||fffd|
35380    Dim i As Long         ' |fffd|u|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|v|fffd|p|fffd||3d0||fffd|
35390    result = Null
35400    For i = 1 To areaNameList.Rows.Count
35410        Set AreaName = areaNameList.Cells(i, 1)
35420        If AreaName.Value = targetAreaName Then
35430            result = areaNameList.Cells(i, 2).Value
35440            Exit For
35450        Else
35460        End If
35470    Next i
35480    GetArea = result
End Function

'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|G|fffd||fffd||fffd|A|fffd||315|\|fffd||fffd|/|fffd||fffd|\|fffd||fffd||fffd||752||fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetSheet|fffd|@|fffd|@|fffd|@     -|fffd||38f||6c3|V|fffd|[|fffd|g
'             startRow              -|fffd|J|fffd|n|fffd|s
'             endRow                -|fffd|I|fffd||fffd||fffd|s
'             dispFlg               -|fffd|\|fffd||fffd||fffd||611||583|t|fffd||fffd||fffd|O("":|fffd||fffd|\|fffd||fffd||fffd|A1:|fffd|\|fffd||fffd|)
'             defaultHiddenStartRow -|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||314||fffd|\|fffd||fffd||fffd|J|fffd|n|fffd|s
'             defaultHiddenEndRow   -|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||314||fffd|\|fffd||fffd||fffd|I|fffd||fffd||fffd|s
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||314||fffd|\|fffd||fffd||fffd|J|fffd|n|fffd|s|fffd|E|fffd|I|fffd||fffd||fffd|s|fffd||350|V|fffd|G|fffd|l|fffd||598|A|fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|s|fffd|p
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Sub SetAreaDisp(ByRef targetSheet As Worksheet, ByVal StartRow As Long, ByVal EndRow As Long, ByVal dispFlg As Variant, ByVal defaultHiddenStartRow As Long, ByVal defaultHiddenEndRow As Long)
35680    On Error GoTo OnErrHande
35690
35700    Dim isHidden As Boolean ' |fffd|s|fffd||314||fffd|\|fffd||fffd||fffd||752||fffd|p|fffd|t|fffd||fffd||fffd|O
35710
35720    If StartRow = 0 Then
35730        ' |fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||a347||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
35740        Exit Sub
35750    Else
35760    End If
35770
35780    If dispFlg = "" Then
35790        ' |fffd||fffd|\|fffd||fffd||fffd||30f||a347|
35800        isHidden = True
35810    ElseIf dispFlg = "1" Then
35820        ' |fffd|\|fffd||fffd||fffd||30f||a347|
35830        isHidden = False
35840    Else
35850        ' |fffd||fffd||fffd||fffd||20a|O|fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
35860        Exit Sub
35870    End If
35880
35890    If defaultHiddenStartRow = 0 And defaultHiddenEndRow = 0 Then
35900        '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|\|fffd||fffd||fffd||752||fffd||202||fffd|
35910        If targetSheet.Rows(StartRow & ":" & EndRow).Hidden = isHidden Then
35920            ' |fffd||fffd||fffd||250||752||fffd||282||fffd||30f||a347||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
35930            Exit Sub
35940        Else
35950            targetSheet.Rows(StartRow & ":" & EndRow).Hidden = isHidden
35960        End If
35970    Else
35980        '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|\|fffd||fffd||fffd||752||80a0||fffd||fffd|
35990        If targetSheet.Rows(StartRow & ":" & (defaultHiddenStartRow - 1)).Hidden = isHidden And _
                  targetSheet.Rows((defaultHiddenEndRow + 1) & ":" & EndRow).Hidden = isHidden Then
36010            ' |fffd||fffd||fffd||250||752||fffd||282||fffd||30f||a347||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
36020            Exit Sub
36030        Else
36040            targetSheet.Rows(StartRow & ":" & EndRow).Hidden = isHidden
36050
36060            If isHidden = False Then
36070                ' |fffd|\|fffd||fffd||fffd||752||fffd||141|A|fffd||fffd||fffd||83|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|\|fffd||fffd||fffd||752||80aa||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd|Y|fffd||fffd||fffd||4cf||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|B
36080                targetSheet.Rows(defaultHiddenStartRow & ":" & defaultHiddenEndRow).Hidden = True
36090            Else
36100            End If
36110        End If
36120    End If
36130
36140    Exit Sub
36150
36160 OnErrHande:
36170    Err.Raise Number:=Err.Number, Description:=Err.Description & "." & VBA.Erl
End Sub
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|V|fffd|G|fffd|l|fffd|V|fffd|[|fffd|g|fffd||310||752||fffd|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True           - |fffd|`|fffd|F|fffd|b|fffd|NOK|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ False          - |fffd|`|fffd|F|fffd|b|fffd|NNG|fffd|A|fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: iRow|fffd|@|fffd|@|fffd|@     -|fffd|s|fffd||50d||fffd|
'             dataSheet      -|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|V|fffd|[|fffd|g
'             reValue|fffd|@|fffd|@|fffd|@  -|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||3d0||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|V|fffd|G|fffd|l|fffd|V|fffd|[|fffd|g|fffd||303|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||18e||496||fffd||fffd|A|fffd|G|fffd||fffd||fffd|A|fffd||310||752||fffd|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function SettingCheckForNewEne(ByVal iRow As Long, ByVal dataSheet As Worksheet, ByRef reValue As String) As Boolean
45500    On Error GoTo OnErrHande
45510
45520    reValue = ""
45530    With dataSheet
45540        If IsEmpty(.Range("E" & iRow).Value) = True Then
45550            reValue = "|fffd|R|fffd|[|fffd|h"
45560            SettingCheckForNewEne = False
45570        ElseIf IsEmpty(.Range("I" & iRow).Value) = True Then
45580            reValue = "|fffd|G|fffd||fffd||fffd|A"
45590            SettingCheckForNewEne = False
45600        ElseIf IsError(.Range("F" & iRow).Value) Then
45610            SettingCheckForNewEne = False
45620        Else
45630            SettingCheckForNewEne = True
45640        End If
45650    End With
45660
45670    Exit Function
45680
45690 OnErrHande:
45700    Err.Raise Number:=Err.Number, Description:=Err.Description & "." & VBA.Erl
End Function
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD END

' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||281|A|fffd||fffd||fffd|l|fffd||fffd||fffd|\|fffd||fffd||fffd||302||24a|i|fffd|[|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: cellAJ|fffd|@|fffd|@|fffd|@          -|fffd||fffd||fffd|
'             cellAJBiko            -|fffd||fffd||fffd|l
'             cntTtlTogetherType|fffd|@  -|fffd||fffd||282||30a|i|fffd|[|fffd|p|fffd||3d0||fffd|
'             cntTtlTogetherBiko  |fffd|@-|fffd||fffd||fffd|l|fffd||30a|i|fffd|[|fffd|p|fffd||3d0||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||fffd|l|fffd||341|u,(|fffd||fffd||fffd|p|fffd|J|fffd||fffd||fffd|})|fffd|v|fffd||155||fffd||fffd||fffd||fffd||4c2cd||fffd||fffd||fffd||fffd|A|fffd||fffd||282||348||642||202||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|\|fffd||fffd||fffd||302||250||752||fffd||3c2||742||30f||a347||fffd||341|u|fffd||fffd||fffd||fffd||fffd|v|fffd||242||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Sub AddBiko(ByVal cellAJ As String, ByVal cellAJBiko As String, ByRef cntTtlTogetherType As String, ByRef cntTtlTogetherBiko As String)
45900    If cntTtlTogetherType = "" Then
45910        cntTtlTogetherType = cellAJ
45920    ElseIf cntTtlTogetherType <> cellAJ Then
45930        cntTtlTogetherType = NENSYU_COMPOSITE
45940    End If
45950
45960    If cntTtlTogetherBiko = "" Then
45970        cntTtlTogetherBiko = cellAJBiko
45980    Else
45990        cntTtlTogetherBiko = cntTtlTogetherBiko & "," & cellAJBiko
46000    End If
End Sub

' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||682||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
'
' |fffd||502||fffd|l|fffd|@|fffd|@: true:|fffd|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||697|L|fffd||fffd| false:|fffd|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||696||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetSheet|fffd|@|fffd|@|fffd|@     -|fffd||38f||6c3|V|fffd|[|fffd|g
'             startRow              -|fffd|J|fffd|n|fffd|s
'             endRow                -|fffd|I|fffd||fffd||fffd|s
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||348||353||fffd||fffd||252|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||682||252|l|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function CheckValue(ByRef targetSheet As Worksheet, ByVal StartRow As Long, ByVal EndRow As Long) As Boolean
46100    Dim rng As Range
46110    Dim emptyFlg As Boolean
46120    Dim i As Long
         '2019/11/01 V01R015 UPD START
         emptyFlg = False
         '2019/11/01 V01R015 UPD END

46130    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
46140    For i = StartRow To EndRow
            '2019/11/01 V01R015 UPD START
46150        'For Each rng In targetSheet.Range("L" & i & ":W" & i)
             For Each rng In targetSheet.Range("L" & i & ":AI" & i)
             '2019/11/01 V01R015 UPD END
46160            If rng.Value = "" Then
                      '2019/11/01 V01R015 UPD START
46170                 'emptyFlg = False
                      '2019/11/01 V01R015 UPD END
46180            Else
46190                ' |fffd|l|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|s
46200                emptyFlg = True
46210                Exit For
46220            End If
46230        Next rng
46240    Next i
46250    CheckValue = emptyFlg
End Function
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 ADD END
'2019/11/01 V01R015 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|N|fffd|x|fffd||292|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||682||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
'
' |fffd||502||fffd|l|fffd|@|fffd|@: true:|fffd|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||697|L|fffd||fffd| false:|fffd|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||696||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetSheet|fffd|@|fffd|@|fffd|@     -|fffd||38f||6c3|V|fffd|[|fffd|g
'             checkGyo              -|fffd|`|fffd|F|fffd|b|fffd|N|fffd|s
'             yerMode               -1:|fffd||fffd||fffd|N|fffd|x 2:|fffd||fffd||fffd|N|fffd|x
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|A|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||314||348||353||fffd||fffd||252|Z|fffd||fffd||fffd|f|fffd||28d||fffd||fffd||682||252|l|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function CheckValue2(ByRef targetSheet As Worksheet, ByVal checkGyo As Long, ByVal yerMode As Long) As Boolean
Dim rng As Range
Dim emptyFlg As Boolean
emptyFlg = False

    If yerMode = 1 Then
        '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
        For Each rng In targetSheet.Range("L" & checkGyo & ":W" & checkGyo)
            If rng.Value = "" Then
            Else
                emptyFlg = True
                Exit For
            End If
        Next rng
    Else
        '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
        For Each rng In targetSheet.Range("X" & checkGyo & ":AI" & checkGyo)
            If rng.Value = "" Then
            Else
                emptyFlg = True
                Exit For
            End If
        Next rng
    End If
    CheckValue2 = emptyFlg
End Function
'2019/11/01 V01R015 ADD END
' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||312||1c9||fffd||fffd|j|fffd|@START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||752||fffd|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True           - |fffd|`|fffd|F|fffd|b|fffd|NOK|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ False          - |fffd|`|fffd|F|fffd|b|fffd|NNG|fffd|A|fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: iRow|fffd|@|fffd|@|fffd|@     -|fffd|s|fffd||50d||fffd|
'             dataSheet      -|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|V|fffd|[|fffd|g
'             reValue|fffd|@|fffd|@|fffd|@  -|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||3d0||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|u|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd|A|fffd|u|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  |fffd|u|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|v|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||fffd||fffd|E|fffd|N|fffd||241|u|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd|v|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function SettingCheck2(ByVal iRow As Long, ByVal dataSheet As Worksheet, ByRef reValue As String) As Boolean
46300
46310    On Error GoTo OnErrHande
46320
46330    Dim i As Long
46340    Dim j As Long
46350    Dim k As Long
46360    Dim StartRow As Long
46370    Dim EndRow As Long
46380    Dim startColumns As Long
46390    Dim endColumns As Long
46400    Dim emptyFlg As Boolean  '|fffd|l|fffd|L|fffd||fffd|FTrue |fffd|l|fffd||fffd||fffd||fffd||fffd|FFalse
46410
46420    reValue = ""
46430    StartRow = iRow
46440    EndRow = iRow + 2
46450
46460    startColumns = 12
46470    endColumns = 23
46480
46490    With dataSheet
46500        If IsEmpty(.Range("E" & iRow).Value) = False Then
46510            For i = StartRow To EndRow
46520                For j = 1 To 2
46530                    If j = 1 Then
46540                        '|fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||343|`|fffd|F|fffd|b|fffd|N
46550                        emptyFlg = True
46560                        startColumns = 12
46570                        endColumns = 23
46580                    Else
46590                        '|fffd|N|fffd||512||fffd||fffd|B|fffd|d|fffd||343|`|fffd|F|fffd|b|fffd|N
46600                        emptyFlg = True
                             '2019/11/01 V01R015 UPD START
'46610                        startColumns = 26
'46620                        endColumns = 35
46610                        startColumns = 38
46620                        endColumns = 47
                             '2019/11/01 V01R015 UPD END
46630                    End If
46640
46650                    For k = startColumns To endColumns
46660                        If .Cells(i, k).Value = "" Then
46670                            ' |fffd|l|fffd||202||fffd|
46680                            emptyFlg = False
46690                        Else
46691                            If .Cells(EndRow, k).Value = "" Then
46692                                   '|fffd|G|fffd||fffd||fffd|[
46693                                   reValue = "|fffd||fffd||fffd|B|fffd|d|fffd||357||293||fffd||fffd||356||fffd||fffd||fffd|"
46694                                   SettingCheck2 = False
46695                                   Exit Function

46696                            Else
46697                               '|fffd||fffd||fffd||fffd|
46698                            End If
46699
46700                            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171128 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||153||fffd||fffd||34c||fffd||fffd|i|fffd|N|fffd|x|fffd|j|fffd||24b||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||d3dc||fffd|j|fffd|j START
46701                            '' |fffd|l|fffd||fffd||fffd||fffd|
46710                            'If emptyFlg = False Then
46720                            '   '|fffd|G|fffd||fffd||fffd|[
46730                            '   SettingCheck2 = False
46740                            '   Exit Function
46750                            'Else
46760                            '   '|fffd||fffd||fffd||fffd|
46770                            'End If
46771                            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171128 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||153||fffd||fffd||34c||fffd||fffd|i|fffd|N|fffd|x|fffd|j|fffd||24b||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||d3dc||fffd|j|fffd|j END
46780                            emptyFlg = True
46790                        End If
46800                    Next k
46810                Next j
46820                '1|fffd|s|fffd|X|fffd|L|fffd|b|fffd|v
46830                emptyFlg = True
46840            Next i
46850        End If
46860    End With
46870
46880    '|fffd||fffd||fffd||fffd|
46890    SettingCheck2 = True
46900    Exit Function
46910
46920 OnErrHande:
46930    Err.Raise Number:=Err.Number, Description:=Err.Description & "." & VBA.Erl
46940
End Function
' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||312||1c9||fffd||fffd|j END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]33 IR1 20180901 ADD START
Sub |fffd||fffd||fffd|[|fffd||c42c|_|fffd|}|fffd|N|fffd||fffd||fffd||102||44f|o|fffd||fffd|()
    Call |fffd||fffd||fffd|[|fffd||c42c|
End Sub
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]33 IR1 20180901 ADD END
' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-1 IR1 20171010 ADD END
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|u|fffd||fffd||fffd|[|fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|L|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|w|fffd||84a0||fffd|[|fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|u|fffd||fffd|d|fffd||fffd||fffd|[|fffd|v|fffd|A|fffd|u|fffd||fffd||fffd|d|fffd||fffd||fffd|[|fffd|v|fffd||242||fffd||fffd||fffd|u|fffd||fffd||fffd|[|fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|L|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|w|fffd||84a0||fffd|[|fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd|@|fffd|R|fffd|s|fffd|[|fffd||fffd|F|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\(|fffd|w|fffd||fffd|)_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\(|fffd|w|fffd||fffd|)_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\(|fffd|w|fffd||fffd|P)_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\(|fffd|w|fffd||fffd|Q)_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\(|fffd|w|fffd||fffd|P)_|fffd||fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\(|fffd|w|fffd||fffd|Q)_|fffd||fffd||fffd|d
'-----------------------------------------------------------
Public Sub |fffd||fffd||fffd|[|fffd||c42c|(Optional ByVal iFlag As Boolean = False, Optional ByRef oFlag As Boolean = True)
10190
10200    On Error GoTo OnErrHande
10210
10220    '|fffd||3d0||fffd||fffd||fffd|`
10230    Dim sheetNmList() As String                  '|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||191||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[
10240    Dim sheetListTransmitPower() As String       '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[ |fffd||fffd||fffd|d
10250    Dim sheetListReceivePower() As String        '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[ |fffd||fffd|d
10260    Dim shNameStr As String
10270    Dim shNameArr() As String
10280
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE START
'10290    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|F|fffd|@|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O = 1|fffd|A|fffd|G|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd|s|fffd||fffd|
'10300    Dim oData As OutData
'10310    Dim stData As shortTermData
'10320    Dim stmData As shortTermMonthData
'10330    Dim lt8Data As longTerm8Data
'10340    Dim lt1Data As longTerm1Data
'10350    Dim ltyData As longTermYearData
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE END
10360
10370    Dim SheetName As String                   '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|
10380    Dim sheetMaxRowNo As Long                 '|fffd|V|fffd|[|fffd|g|fffd||30d||151||fffd|s|fffd||fffd|
10390    Dim sheetStartRow As Long                 '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s
10400    Dim copystartRow As Long                  '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd|s
10410    Dim copyEndRow As Long                    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s
10420    Dim startRowCountArray() As Long
10430
10440    Dim cellE As String                       'E|fffd||fffd||312|l|fffd|@|fffd||656a|
10450    Dim cellF As String                       'F|fffd||fffd||312|l|fffd|@|fffd|R|fffd|[|fffd|h
10460    Dim cellI As String                       'I|fffd||fffd||312|l|fffd|@|fffd|G|fffd||fffd||fffd|A
10470    Dim cellJ As String                       'J|fffd||fffd||312|l|fffd|@|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O
10471    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY START
10480    Dim cellAJ As String                      'AJ|fffd||fffd||312|l|fffd|@|fffd||fffd||fffd|
10481    Dim cellAJBiko As String                  'AJ|fffd||fffd||312|l|fffd|@|fffd||fffd||fffd|l
10482    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY END
10490    Dim afterAreaF As String                  '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14c||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|fFlag
10500    Dim cellA As String
         '2019/11/01 V01R015 ADD START
         Dim cellAZ As String                      'AZ|fffd||fffd||312|l|fffd|@:|fffd||fffd||fffd||fffd||fffd||fffd| 3:|fffd|S 1:|fffd||fffd||fffd|N|fffd|x|fffd||302||fffd| 2:|fffd||fffd||fffd|N|fffd|x|fffd||302||fffd|
         '2019/11/01 V01R015 ADD END
10510    'for|fffd||315||3d0||fffd|
10520    Dim i As Long
10530    Dim index As Long
10540    Dim k As Long
10550    Dim j As Long
10560    Dim cnt As Long
10570    Dim cntType As Long
10580    '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
10590    Dim strErr() As String
10600    Dim reValue As String
10610    Dim ckFlag As Boolean
10620    Dim iniSheetName As String
10621    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD START
10622    Dim targetJigyouCode As String                  '|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||30b||fffd||fffd|v|fffd|p|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h
10623    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD END
10624    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD START
10625    Dim newEneList(5) As String
10626    Dim areaNameList(9) As String
10627    Dim AreaName As Variant
10628    Dim Sheet As Worksheet
10629    Dim cellC As String
10630    Dim licenseFlg As Boolean
10631    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD END
10632    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](10|fffd|s|fffd||688||20a|O|fffd||301|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||343|G|fffd||fffd||fffd|[|fffd|j ADD START
10633    Dim chki As Long
10634    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](10|fffd|s|fffd||688||20a|O|fffd||301|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||343|G|fffd||fffd||fffd|[|fffd|j ADD START
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
         Dim ws As Worksheet
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
10635
10640    Debug.Print Time & "|fffd|J|fffd|n"
10650
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE START
'10660    Application.ScreenUpdating = False
'10670    Application.Calculation = xlCalculationManual
'10680    Application.DisplayStatusBar = False
'10690    Application.EnableEvents = False
'10700    Application.EnableCancelKey = xlDisabled
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELETE END
         '2019/11/01 V01R015 ADDD START
         '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10c|v|fffd|Z|fffd||fffd||fffd|s|fffd||fffd|
         Application.CalculateFull
         '2019/11/01 V01R015 ADDD END
10710
10720    iniSheetName = ActiveSheet.Name
10730
10740    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s
10741    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-5 IR1 20171010 DELETE START
10750    ' sheetStartRow = COPY_ORIGIN_ST
10751    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-5 IR1 20171010 DELETE END
10760    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|[|fffd|@|fffd|@|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[,|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[
10770    sheetNmList = Split(SHEET_NM_LIST_ARRAY, ",")
10780    '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d
10790    sheetListReceivePower = Split(RECEIVE_POWER_ARRAY, ",")
10800    '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d,|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d
10810    sheetListTransmitPower = Split(TRANSMIT_POWER_ARRAY, ",")
10820
10830    shNameStr = RECEIVE_POWER_ARRAY & "," & TRANSMIT_POWER_ARRAY
10840    shNameArr = Split(shNameStr, ",")
10850
10860    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START
         If Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB21").Value) = "" Then
             MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|iAB21|fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
             ckFlag = True
             Exit Sub
         End If
         If Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value) = "" Then
             MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10b||fffd||fffd|v|fffd|p|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|iAB18|fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
             ckFlag = True
             Exit Sub
         End If
         Application.ScreenUpdating = False
         Application.Calculation = xlCalculationManual
         Application.DisplayStatusBar = False
         Application.EnableEvents = False
         Application.EnableCancelKey = xlDisabled
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'10870    Call ValueInitialize(oData, stData, stmData, lt8Data, lt1Data, ltyData)
         Call ValueInitialize
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
10880    ckFlag = False
10890
10900    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
10910    For j = 0 To UBound(shNameArr)
10920        SheetName = shNameArr(j)
10930        If ExistsWorksheet(SheetName) Then
                'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'10940           ThisWorkbook.Worksheets(sheetName).Unprotect Password:=pass
                Set ws = ThisWorkbook.Worksheets(SheetName)
                'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
                Call ProtectSheet(ws, False)
                'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
10950        End If
10951    Next j
10952
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELET START
'10953    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd||fffd||fffd|[|fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j ADD START
'10954    If Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB21").Value) = "" Then
'10955        MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
'10956        ckFlag = True
'10957        GoTo ExitHande
'10958    End If
'10959    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd||fffd||fffd|[|fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j ADD END
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 DELET END
10970
10971    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD START
10972    targetJigyouCode = ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value
10973    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD END
10974
10975    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD START
10976    newEneList(0) = NENSYU_WIND_NM
10977    newEneList(1) = NENSYU_SUN_ALL_NM
10978    newEneList(2) = NENSYU_SUN_LEFT_NM
10979    newEneList(3) = NENSYU_GROTHERMAL_NM
10980    newEneList(4) = NENSYU_BIOMASS_NM
10981    newEneList(5) = NENSYU_WASTE_NM
10982
10983    areaNameList(0) = AREA_HOKKAIDO
10984    areaNameList(1) = AREA_TOHOKU
10985    areaNameList(2) = AREA_TOKYO
10986    areaNameList(3) = AREA_CHUBU
10987    areaNameList(4) = AREA_HOKURIKU
10988    areaNameList(5) = AREA_KANSEI
10989    areaNameList(6) = AREA_CYUUGOKU
10990    areaNameList(7) = AREA_SIGOKU
10991    areaNameList(8) = AREA_KYUSHU
10992    areaNameList(9) = AREA_OUKINAWA
10993
10994    licenseFlg = True
10995
10996    For index = 0 To UBound(newEneList)
             '|fffd||fffd||fffd||341|A|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j|fffd|A|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j|fffd|A|fffd|n|fffd|M|fffd|A|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X|fffd|A|fffd|p|fffd||fffd||fffd||fffd|
10997        SheetName = newEneList(index)
10998
10999        If ExistsWorksheet(SheetName) Then
11000           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd|\|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||182||fffd||fffd||fffd||389||fffd|) MODIFY START
11001           '' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||242||102|R|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||183|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||389||fffd||fffd|j ADD START
11002           '|fffd|u|fffd|n|fffd|M|fffd|v|fffd|u|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X|fffd|v|fffd|u|fffd|p|fffd||fffd||fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|\|fffd||fffd|
11003           'If (sheetName = NENSYU_GROTHERMAL_NM Or sheetName = NENSYU_BIOMASS_NM Or sheetName = NENSYU_WASTE_NM) And (ThisWorkbook.Worksheets(sheetName).Visible = False) Then
11004           If ThisWorkbook.Worksheets(SheetName).Visible = False Then
11005              '|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd||202||fffd|
11006           Else
11007           '' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||242||102|R|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||183|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||389||fffd||fffd|j ADD END
11008           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd|\|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||182||fffd||fffd||fffd||389||fffd|) MODIFY END
11009               Set Sheet = ThisWorkbook.Worksheets(SheetName)
11010               sheetStartRow = 1
11011               For Each AreaName In areaNameList
11012                   sheetStartRow = Sheet.Columns("C:D").Find(what:="|fffd||656a|", after:=Cells(sheetStartRow, 3)).Row + 2
11013                   sheetMaxRowNo = sheetStartRow + UBound(areaNameList)
11014                   For i = sheetStartRow To sheetMaxRowNo
11015                       cellC = Sheet.Cells(i, 3).Value
11016                       cellE = Sheet.Cells(i, 5).Value
11017                       ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](10|fffd|s|fffd||688||20a|O|fffd||301|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||343|G|fffd||fffd||fffd|[|fffd|j ADD START
11018                       chki = sheetStartRow + 9
11019                       If cellC = KUBUN_JISYA_NM And i <> chki Then
11020                           '|fffd|G|fffd||fffd||fffd|[
11021                           ckFlag = True
11022                           Call MsgBox("1|fffd|s|fffd||681|`9|fffd|s|fffd||682||30b||656a||fffd||241|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||353||fffd||fffd||342||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & SheetName & vbCrLf & "|fffd|s|fffd|F" & i & "|fffd|s|fffd||fffd|", vbCritical)
11023                           GoTo ExitHande
11024                       Else
11025                           '|fffd||fffd||fffd||fffd|
11026                       End If
11027                       ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](10|fffd|s|fffd||688||20a|O|fffd||301|u|fffd||fffd||fffd||495||6d7|L|fffd|d|fffd||fffd||fffd|v|fffd||343|G|fffd||fffd||fffd|[|fffd|j ADD END
11028                       If cellC <> "" And cellC <> KUBUN_JISYA_NM Then
11029                          'C|fffd||fffd|E|fffd||fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||750||752||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
11030                           If SettingCheckForNewEne(i, Sheet, reValue) = False Then
11031                               ckFlag = True
11032                               Call ShowMessage(SheetName, reValue, i)
11033                               GoTo ExitHande
11034                           ElseIf Sheet.Range("E" & i).Value = targetJigyouCode Then
11035                               ckFlag = True
11036                               Call MsgBox("|fffd||fffd||fffd||48a||502||30e||fffd||fffd||fffd||34e||fffd||fffd||48a||50e||fffd||fffd||fffd||fffd||fffd|[|fffd||58b|L|fffd||682||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & SheetName & vbCrLf & "|fffd|s|fffd|F" & i & "|fffd|s|fffd||fffd|", vbCritical)
11037                               GoTo ExitHande
11038                           End If
11039                       End If
11040                   Next i
11041               Next AreaName
11042           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd||fffd||6d1||fffd||389||fffd|(|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||242||102|R|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||183|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||389||fffd||fffd|j ADD START
11043           End If
11044           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd||fffd||6d1||fffd||389||fffd|(|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||297|p|fffd||242||102|R|fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||183|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O|fffd||389||fffd||fffd|j ADD END
11045        Else
11046        End If
11047    Next index
11048    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-7 IR1 20171010 ADD END
11049    '|fffd||fffd||fffd|d|fffd|V|fffd|[|fffd|g|fffd|E|fffd||fffd|d|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
         '|fffd||fffd|0:|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[,1:|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|["
11050    For index = 0 To UBound(sheetNmList)
11051        SheetName = sheetNmList(index)
11052
11053        If ExistsWorksheet(SheetName) Then
11054          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-5 IR1 20171010 MODIFY START
               '|fffd||fffd||fffd||64ea||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|s Row25 |fffd||fffd||fffd|O|fffd||fffd|`|fffd||14e||64fe|
11055          sheetStartRow = ThisWorkbook.Worksheets(SheetName).Range("|fffd|J|fffd|n|fffd|s_" & SheetName).Row
11056          '|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd|L|fffd||fffd||fffd|MAX|fffd|s|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
11057          'sheetMaxRowNo = ThisWorkbook.Worksheets(sheetName).Cells(Rows.Count, 1).End(xlUp).Row()
               '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|I|fffd||fffd||fffd|s5 |fffd||fffd||fffd|O|fffd||fffd|`|fffd||14e||64fe|
11058          sheetMaxRowNo = ThisWorkbook.Worksheets(SheetName).Range("|fffd|I|fffd||fffd||fffd|s_" & SheetName).Row
11059          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-5 IR1 20171010 MODIFY END
11060
11061          '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
11070          For i = sheetStartRow To sheetMaxRowNo + 1
11080              'E|fffd||fffd||312|l|fffd|@|fffd||656a|
11090              cellE = ThisWorkbook.Worksheets(SheetName).Cells(i, 5).Value
11100              'J|fffd||fffd||312|l|fffd|@|fffd||a287||fffd|L|fffd||fffd|
11110              cellJ = ThisWorkbook.Worksheets(SheetName).Cells(i, 10).Value
11120              'I|fffd||fffd||312|l |fffd|G|fffd||fffd||fffd|A
11130              cellI = ThisWorkbook.Worksheets(SheetName).Cells(i, 9).Value
11140              'AJ|fffd||fffd||312|l |fffd|R|fffd||fffd|
11150              cellAJ = ThisWorkbook.Worksheets(SheetName).Cells(i, 48).Value
11151              ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
11152              'AJ|fffd||fffd|(|fffd||fffd||fffd|l)|fffd||312|l
11153              cellAJBiko = ThisWorkbook.Worksheets(SheetName).Cells(i + 2, 48).Value
11154              ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
11160              'A|fffd||fffd||312|l
11170              cellA = ThisWorkbook.Worksheets(SheetName).Cells(i, 1).Value
11180
                   '2019/11/01 V01R015 ADD START
                   '|fffd||fffd|AZ|fffd||fffd||312|l |fffd||fffd||fffd||34f||fffd||fffd|
                   cellAZ = ThisWorkbook.Worksheets(SheetName).Cells(i, 52).Value
                   '2019/11/01 V01R015 ADD END
11190              If cellE = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
11200
11210                  cellF = ThisWorkbook.Worksheets(SheetName).Cells(i, 6).Value
11220                  '|fffd||656a||fffd|s|fffd||702||14f||fffd||fffd||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s|fffd||fffd||752||80b7||fffd||fffd|
11230                  copystartRow = i + 3
11240                  i = i + 2
11250
11260              ElseIf cellE = "" Then
11270
11280                  '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||30d|s|fffd||30f||a347||fffd|A|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|A|fffd|Y|fffd||fffd||fffd|s-1|fffd||702||143|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
11290                  copyEndRow = i - 1
11300
11310                  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd|j|fffd||fffd||fffd||d448d|s|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||209||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||202||fffd|
11320                  If afterAreaF <> cellF And cellA <> "1" Then
11330
11340                      '|fffd|G|fffd||fffd||fffd|A|fffd|i|fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd|j|fffd||fffd||752||80b7||fffd||fffd|
11350                    afterAreaF = cellF
11360                    If copyEndRow - copystartRow <> 2 Then
11370                      '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|F|fffd|@|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||111||fffd||fffd|R|fffd|s|fffd|[|fffd|s|fffd||fffd||fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|
11380                      For k = 0 To 3          '|fffd|z|fffd||fffd|v|fffd|f|fffd||30c||90||fffd|(4)|fffd||343||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||10c||fffd||fffd||702||fffd|
11390
11400                          cnt = 0
                               'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
                               '|fffd||fffd||fffd||a287||fffd|t|fffd||fffd||fffd|O|fffd||752||fffd|J|fffd|E|fffd||fffd||fffd|g
'11410                          Call CountTogetherRow(oData, k, cnt)
                               Call CountTogetherRow(k, cnt)
                               'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11420
11430                          '|fffd|u10|fffd||fffd|kw|fffd||209||fffd||fffd||30e||fffd||fffd||18e||482||302||702||fffd||7c1|v|fffd||30d||fffd||fffd||682||fffd||fffd|A|fffd|u|fffd|P|fffd|v|fffd|F|fffd||702||fffd||7ce||fffd||fffd|{|fffd|L|fffd||30f||a347|
11440                          If cnt > 0 Then
11450                              '|fffd|u|fffd|P|fffd|v|fffd|F|fffd||702||fffd||7ce||fffd||fffd|{|fffd|L|fffd|@|fffd||182||202||fffd||fffd||102||fffd||fffd||fffd|s|fffd||fffd||fffd||702||182||7c2||101|A1|fffd|s|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11460                              oData.countTotal(k) = oData.countTotalSeparation(k) + cnt
                                    OutPutData.countTotal(k) = OutPutData.countTotalSeparation(k) + cnt
                                    '2019/11/01 V01R015 ADD START
                                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x(+4)|fffd|A|fffd||fffd||fffd|N|fffd|x(+8)|fffd||313||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||752||fffd|
                                    OutPutData.countTotal(k + 4) = OutPutData.countTotalSeparation(k + 4) + cnt
                                    OutPutData.countTotal(k + 8) = OutPutData.countTotalSeparation(k + 8) + cnt
                                    '2019/11/01 V01R015 ADD END
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11470                          Else
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11480                              oData.countTotal(k) = oData.countTotalSeparation(k)
                                    OutPutData.countTotal(k) = OutPutData.countTotalSeparation(k)
                                    '2019/11/01 V01R015 ADD START
                                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x(+4)|fffd|A|fffd||fffd||fffd|N|fffd|x(+8)|fffd||313||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||752||fffd|
                                    OutPutData.countTotal(k + 4) = OutPutData.countTotalSeparation(k + 4)
                                    OutPutData.countTotal(k + 8) = OutPutData.countTotalSeparation(k + 8)
                                    '2019/11/01 V01R015 ADD END
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11490                          End If
11500                      Next
11510
11520                      If SheetName = sheetNmList(0) Then
11530                          '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[|fffd|J|fffd||fffd||502||fffd||fffd|@|fffd||fffd|d
11540                          For j = 0 To UBound(sheetListReceivePower)
11550                              '|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd|L|fffd||fffd||fffd|MAX|fffd|s|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
11560                              sheetMaxRowNo = ThisWorkbook.Worksheets(sheetListReceivePower(j)).Cells(Rows.Count, "C").End(xlUp).Row()
11570                              '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||24d||fffd||fffd||d0b9||fffd||101|A|fffd|R|fffd|s|fffd|[|fffd||fffd|J|fffd|n|fffd|s|fffd||18f|I|fffd||fffd||fffd|s|fffd|v|fffd|Z|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11580                              startRowCountArray = MaxRowCount(sheetMaxRowNo, cellF, sheetListReceivePower(j), oData.countTotal)
                                    startRowCountArray = MaxRowCount(sheetMaxRowNo, cellF, sheetListReceivePower(j), OutPutData.countTotal)
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11590                              '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||202||fffd|
11600                              If copyEndRow > copystartRow Then
11610                                  '|fffd|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
                                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11620                                  Call Copy(startRowCountArray, copyEndRow, copystartRow, ThisWorkbook.Worksheets(sheetName), _
'                                                sheetListReceivePower(j), oData, stData, stmData, lt8Data, lt1Data, ltyData)
                                        Call Copy(startRowCountArray, copyEndRow, copystartRow, ThisWorkbook.Worksheets(SheetName), sheetListReceivePower(j))
                                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11640                              End If
11650                          Next
11660                      Else
11670                          '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[|fffd|J|fffd||fffd||502||fffd||fffd|@|fffd||fffd||fffd|d
11680                          For j = 0 To UBound(sheetListTransmitPower)
11690                              '|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd|L|fffd||fffd||fffd|MAX|fffd|s|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
11700                              sheetMaxRowNo = ThisWorkbook.Worksheets(sheetListTransmitPower(j)).Cells(Rows.Count, "C").End(xlUp).Row()
11710                              '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||24d||fffd||fffd||d0b9||fffd||101|A|fffd|R|fffd|s|fffd|[|fffd||fffd|J|fffd|n|fffd|s|fffd||18f|I|fffd||fffd||fffd|s|fffd|v|fffd|Z|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11720                              startRowCountArray = MaxRowCount(sheetMaxRowNo, cellF, sheetListTransmitPower(j), oData.countTotal)
                                    startRowCountArray = MaxRowCount(sheetMaxRowNo, cellF, sheetListTransmitPower(j), OutPutData.countTotal)
                                    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11730                              '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||202||fffd|
11740                              If copyEndRow > copystartRow Then
11750                                  '|fffd|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
                                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11760                                  Call Copy(startRowCountArray, copyEndRow, copystartRow, ThisWorkbook.Worksheets(sheetName), _
'                                                sheetListTransmitPower(j), oData, stData, stmData, lt8Data, lt1Data, ltyData)
                                        Call Copy(startRowCountArray, copyEndRow, copystartRow, ThisWorkbook.Worksheets(SheetName), sheetListTransmitPower(j))
                                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11780                              End If
11790                          Next
11800                      End If
11810                      '|fffd|z|fffd||4f24a||fffd||fffd||fffd|
                            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11820                      Call ValueInitialize(oData, stData, stmData, lt8Data, lt1Data, ltyData)
                            Call ValueInitialize
                            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11830                    End If
11840                  Else
11850                      i = i + 2
11860                  End If
11870              Else
                       '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||34d|s
11880                  '|fffd||752||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
11890                  If SettingCheck(i, ThisWorkbook.Worksheets(SheetName), reValue) = False Then
11900                      ckFlag = True
11910                      Call ShowMessage(SheetName, reValue, i)
11920                      GoTo ExitHande
11921                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD START
11922                  ElseIf ThisWorkbook.Worksheets(SheetName).Rows(i).Hidden = False And ThisWorkbook.Worksheets(SheetName).Range("F" & i).Value = targetJigyouCode Then
11923                      ckFlag = True
11924                      Call MsgBox("|fffd||fffd||fffd||48a||502||30e||fffd||fffd||fffd||34e||fffd||fffd||48a||50e||fffd||fffd||fffd||fffd||fffd|[|fffd||58b|L|fffd||682||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & SheetName & vbCrLf & "|fffd|s|fffd|F" & i & "|fffd|s|fffd||fffd|", vbCritical)
11925                      GoTo ExitHande
11926                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]|fffd||1c9||fffd|-3 IR1 20171010 ADD END
11930                  End If
11931                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||312||1c9||fffd||fffd|j|fffd|@START
11932                  If ThisWorkbook.Worksheets(SheetName).Rows(i).Hidden = False And ThisWorkbook.Worksheets(SheetName).Range("E" & i).Value <> "" Then
11933                      '|fffd|`|fffd|F|fffd|b|fffd|N
11934                      If SettingCheck2(i, ThisWorkbook.Worksheets(SheetName), reValue) = False Then
11935                          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171128 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||153||fffd||fffd||34c||fffd||fffd|i|fffd|N|fffd|x|fffd|j|fffd||24b||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||d3dc||fffd|j|fffd|j START
11936                          'If reValue = "" Then
11937                          '    ckFlag = True
11938                          '    Call MsgBox("|fffd||fffd||fffd|B|fffd|d|fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||352||fffd||fffd|B|fffd|d|fffd||357||282||24b||d4482||309||4cf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & sheetName & vbCrLf & "|fffd|s|fffd|F" & i & "|fffd|s|fffd||fffd|", vbCritical)
11939                          '    GoTo ExitHande
11940                          'Else
11941                          ckFlag = True
11942                          Call MsgBox("|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||fffd||fffd|E|fffd|N|fffd||252||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||4cf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & SheetName & vbCrLf & "|fffd|s|fffd|F" & i & "|fffd|s|fffd||fffd|", vbCritical)
11943                          GoTo ExitHande
11944                          'End If
11945                          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171128 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||153||fffd||fffd||34c||fffd||fffd|i|fffd|N|fffd|x|fffd|j|fffd||24b||d4482||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||d3dc||fffd|j|fffd|j END
11946                      Else
11947                          '|fffd||fffd||fffd||fffd|
11948                      End If
11949                  Else
11950                      '|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6ca|O
11951                  End If
11952                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd|A|fffd||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||312||1c9||fffd||fffd|j|fffd|@END
11953                  '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||343||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||101|A|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||1374c|v
11954                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY START
11955                  'Call RowCalculateByLicense(cellE, cellI, cellJ, cellAJ, oData, stData, stmData, lt8Data, lt1Data, ltyData, i, ThisWorkbook.Worksheets(sheetName))
                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'11956                  Call RowCalculateByLicense(cellE, cellI, cellJ, cellAJ, cellAJBiko, oData, stData, stmData, lt8Data, lt1Data, ltyData, i, ThisWorkbook.Worksheets(sheetName))
                       '2019/11/01 V01R015 UPD START
                       'If Not (RowCalculateByLicense(cellE, cellI, cellJ, cellAJ, cellAJBiko, i, ThisWorkbook.Worksheets(SheetName))) Then
                        If Not (RowCalculateByLicense(cellE, cellI, cellJ, cellAJ, cellAJBiko, cellAZ, i, ThisWorkbook.Worksheets(SheetName))) Then
                       '2019/11/01 V01R015 UPD END
                            ckFlag = True
                            GoTo ExitHande:
                        End If
                        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
11957                  ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 MODIFY END
11960                  '|fffd|f|fffd|[|fffd|^|fffd|L|fffd||fffd|A|fffd||fffd||fffd||656a||fffd||fffd|
11970                  i = i + 2
11980              End If
11990          Next i
12000          '|fffd|z|fffd||4f24a||fffd||fffd||fffd|
                'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'12010          Call ValueInitialize(oData, stData, stmData, lt8Data, lt1Data, ltyData)
                Call ValueInitialize
                'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
12020      End If
12030  Next index
       'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START
       If Not (ExecSort) Then
           ckFlag = True
           GoTo ExitHande:
       End If
       'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END
12040
12050  GoTo ExitHande
12060
12070 OnErrHande:
12080    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||fffd||602||fffd|
12090    strErr = Split(Err.Description, ".")
12100    If UBound(strErr) <> 0 Then
12110        '|fffd||fffd||fffd||30a||590||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd|
12120        Call ShowErrorMessage("|fffd||fffd||fffd|[|fffd||c42c|", Err.Number, strErr(0), strErr(1))
12130    Else
12140        '|fffd||fffd||fffd||30a||590||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd||fffd||fffd||202||fffd|
12150        Call ShowErrorMessage("|fffd||fffd||fffd|[|fffd||c42c|", Err.Number, Err.Description, VBA.Erl)
12160    End If
12170
12180    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||6d1||fffd||fffd||fffd||fffd|s|fffd||fffd||202||fffd|
12190    oFlag = False
12200
12210 ExitHande:
12220    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
12230    For j = 0 To UBound(shNameArr)
12240        SheetName = shNameArr(j)
12250        If ExistsWorksheet(SheetName) Then
12260          '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
12261          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-2 IR1 20171010 MODIFY START
12270          'ThisWorkbook.Worksheets(sheetName).Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True
               'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'12271          ThisWorkbook.Worksheets(SheetName).Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True
               Set ws = ThisWorkbook.Worksheets(SheetName)
               Call ProtectSheet(ws, True)
               'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
12272          ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-2 IR1 20171010 MODIFY END
12280        End If
12290    Next j
12300
12310    '|fffd||fffd||fffd||355|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||6d1||fffd||fffd||fffd||fffd|s|fffd||fffd||202||fffd|
12320    If ckFlag = True Then
12330        oFlag = False
12340    End If
12350
12360    ThisWorkbook.Worksheets(iniSheetName).Activate
12370
12380    ' |fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd|
12390    Application.EnableCancelKey = xlInterrupt
12400    Application.Calculation = xlCalculationAutomatic
12410    Application.ScreenUpdating = True
12420    Application.DisplayStatusBar = True
12430    Application.EnableEvents = True
12440
12450    Debug.Print Time & "|fffd|I|fffd||fffd|"
12460
12470    If Err.Number = 0 And ckFlag = False And iFlag = False Then
12480        MsgBox "|fffd||fffd||fffd|[|fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbInformation
12490    End If
12500
12510    Err.Clear
End Sub

'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|L|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|w|fffd||84a0||fffd|[|fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: toStartRow|fffd|@|fffd|@|fffd|@    |fffd|@|fffd|@-|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||103|R|fffd|s|fffd|[|fffd||fffd||30a|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'             copyEndRow          |fffd|@|fffd|@-|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd|s
'             copystartRow|fffd|@|fffd|@|fffd|@      -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|J|fffd|n|fffd|s
'             fromWorkSheet|fffd|@|fffd|@|fffd|@     -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g
'             sheetName|fffd|@|fffd|@|fffd|@     |fffd|@|fffd|@-|fffd|V|fffd|[|fffd|g|fffd||fffd|
'             paraData|fffd|@|fffd|@|fffd|@          -|fffd|\|fffd||fffd||fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:|fffd|R|fffd|s|fffd|[|fffd||fffd||242||fffd||fffd||fffd||101|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|s|fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd|1|fffd||30f||a347||fffd|A|fffd||702||182||7c2||101|A1|fffd|s|fffd||182||fffd||fffd||103|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
'            |fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||30f||a347||fffd|A|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|s|fffd|[
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||343|R|fffd|s|fffd|[|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||202||fffd|
'-----------------------------------------------------------
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'Private Sub Copy(ByRef toStartRow() As Long, ByVal copyEndRow As Long, ByVal copystartRow As Long, ByVal fromWorkSheet As Worksheet, ByVal sheetName As String, _
'        ByRef paraData As OutData, ByRef stData As shortTermData, ByRef stmData As shortTermMonthData, ByRef lt8Data As longTerm8Data, ByRef lt1Data As longTerm1Data, ByRef ltyData As longTermYearData)
Private Sub Copy(ByRef toStartRow() As Long, ByVal copyEndRow As Long, ByVal copystartRow As Long, ByVal fromWorkSheet As Worksheet, ByVal SheetName As String)
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
12740
12750    On Error GoTo OnErrHande
12760
12770    '|fffd||3d0||fffd||fffd||310||933e|
12780    Dim m As Long
12790    Dim n As Long
12800    Dim i As Long
12810    Dim ttlCnt As Long
12820    Dim strErr() As String
12830    Dim sheetListTransmitPower() As String   '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd||fffd|d|fffd|z|fffd||fffd|
12840    Dim sheetListReceivePower() As String    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd|d|fffd|z|fffd||fffd|
12850    Dim toWorkSheet As Worksheet             '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g
12860    Dim supplyAreaRow As Long                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
12870    supplyAreaRow = copystartRow - 3
12880
12890    Set toWorkSheet = ThisWorkbook.Worksheets(SheetName)
12900
12910    '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd||fffd|d
12920    sheetListTransmitPower = Split(TRANSMIT_POWER_ARRAY, ",")
12930    '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd|d
12940    sheetListReceivePower = Split(RECEIVE_POWER_ARRAY, ",")
12950
12960    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||343|R|fffd|s|fffd|[|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|
12970    If toStartRow(3) = 0 Then
12980        Exit Sub
12990    End If
13000
13010    '|fffd|R|fffd|s|fffd|[|fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd||fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347|
         '2019/11/01 V01R015 UPD START
13020    'If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Then
         If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Or SheetName = sheetListReceivePower(3) Or SheetName = sheetListTransmitPower(3) Then
         '2019/11/01 V01R015 UPD END
13030
13040        With fromWorkSheet
13050            '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
13060            For i = copystartRow To copyEndRow
13070                   '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||30f||a347||fffd|A|fffd|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
13080                   If .Range("J" & i).Value = "" Then
13090
13100                       If .Range("E" & i).Value = POWER_GENERATION_PRODUCER Then
13101                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13102                           If CheckValue(fromWorkSheet, i, i + 2) = True Then
13103                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13110                               '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13120                               Call CopySegmentation(SheetName, toStartRow, 0, i, fromWorkSheet)
13121                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13122                           Else
13123                           End If
13124                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13130                       ElseIf .Range("E" & i).Value = GENERAL_POWER_TRANSMISSION Then
13131                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13132                           If CheckValue(fromWorkSheet, i, i + 2) = True Then
13133                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13140                               '|fffd||656a||fffd||fffd||fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13150                               Call CopySegmentation(SheetName, toStartRow, 1, i, fromWorkSheet)
13151                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13152                           Else
13153                           End If
13154                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13160                       ElseIf .Range("E" & i).Value = REGISTRATION_SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = RETAIL_ELECTRICITY_BUSINESS Then
13061                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
12962                           If CheckValue(fromWorkSheet, i, i + 2) = True Then
12863                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13170                               '|fffd||656a||fffd||fffd||fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||341|@|fffd|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13180                               Call CopySegmentation(SheetName, toStartRow, 2, i, fromWorkSheet)
13181                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13182                           Else
13183                           End If
13184                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13190                       ElseIf .Range("E" & i).Value = POWER_TRANSMISSION_BUSINESS Or .Range("E" & i).Value = SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = OTHER_BUSINESS Then
13191                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13192                           If CheckValue(fromWorkSheet, i, i + 2) = True Then
13193                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13200                               '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||496||fffd||fffd||341|@|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||342||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13210                               Call CopySegmentation(SheetName, toStartRow, 3, i, fromWorkSheet)
13211                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY START
13212                           Else
13213                           End If
13214                           ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-9 IR1 20171010 MODIFY END
13215                       End If
13230                   Else
13240                       i = i + 2
13250                   End If
13260            Next
13270
13280        End With


13290        'To Sheet32
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'13300        Call CopyToSheet36(ttlCnt, toStartRow, toWorkSheet, paraData, stData, stmData)
             Call CopyToSheet36(ttlCnt, toStartRow, toWorkSheet)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
             
13310
13320    ElseIf SheetName = sheetListReceivePower(1) Or SheetName = sheetListTransmitPower(1) Then
13330
13340        With fromWorkSheet
13350            '|fffd|R|fffd|s|fffd|[|fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|@|fffd||fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347|
13360            '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
13370             For i = copystartRow To copyEndRow
13380                '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||30f||a347||fffd|A|fffd|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
13390                If .Range("J" & i).Value = "" Then
13400
13410                   If .Range("E" & i).Value = POWER_GENERATION_PRODUCER Then
13420                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13430                       Call CopySegmentation(SheetName, toStartRow, 0, i, fromWorkSheet)
13440                   ElseIf .Range("E" & i).Value = GENERAL_POWER_TRANSMISSION Then
13450                       '|fffd||656a||fffd||fffd||fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13460                       Call CopySegmentation(SheetName, toStartRow, 1, i, fromWorkSheet)
13470                   ElseIf .Range("E" & i).Value = REGISTRATION_SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = RETAIL_ELECTRICITY_BUSINESS Then
13480                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||341|@|fffd|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13490                       Call CopySegmentation(SheetName, toStartRow, 2, i, fromWorkSheet)
13500                   ElseIf .Range("E" & i).Value = POWER_TRANSMISSION_BUSINESS Or .Range("E" & i).Value = SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = OTHER_BUSINESS Then
13510                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||496||fffd||fffd||341|@|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||342||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13520                       Call CopySegmentation(SheetName, toStartRow, 3, i, fromWorkSheet)
13530                   End If
13540                Else
13550                 i = i + 2
13560                End If
13570             Next
13580        End With
13590        'To sheet32-8(|fffd||fffd|d)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'13600        Call CopyToSheetReceive(ttlCnt, toStartRow, toWorkSheet, paraData, lt8Data, ltyData)
             Call CopyToSheet32_8_1(ttlCnt, toStartRow, toWorkSheet)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
13610
13620    ElseIf SheetName = sheetListReceivePower(2) Or SheetName = sheetListTransmitPower(2) Then
13630        With fromWorkSheet
13640            '|fffd|R|fffd|s|fffd|[|fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d|fffd|@|fffd||fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347|
13650            '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
13660            For i = copystartRow To copyEndRow
13670                '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||30f||a347||fffd|A|fffd|f|fffd|[|fffd|^|fffd|R|fffd|s|fffd|[
13680                If .Range("J" & i).Value = "" Then
13690
13700                   If .Range("E" & i).Value = POWER_GENERATION_PRODUCER Then
13710                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13720                       Call CopySegmentation(SheetName, toStartRow, 0, i, fromWorkSheet)
13730                   ElseIf .Range("E" & i).Value = GENERAL_POWER_TRANSMISSION Then
13740                       '|fffd||656a||fffd||fffd||fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13750                       Call CopySegmentation(SheetName, toStartRow, 1, i, fromWorkSheet)
13760                   ElseIf .Range("E" & i).Value = REGISTRATION_SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = RETAIL_ELECTRICITY_BUSINESS Then
13770                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||341|@|fffd|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13780                       Call CopySegmentation(SheetName, toStartRow, 2, i, fromWorkSheet)
13790                   ElseIf .Range("E" & i).Value = POWER_TRANSMISSION_BUSINESS Or .Range("E" & i).Value = SPECIFIC_POWER_TRANSMISSION Or .Range("E" & i).Value = OTHER_BUSINESS Then
13800                       '|fffd||656a||fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||496||fffd||fffd||341|@|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|@|fffd||fffd||fffd||342||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
13810                       Call CopySegmentation(SheetName, toStartRow, 3, i, fromWorkSheet)
13820                   End If
13830                Else
13840                   i = i + 2
13850                End If
13860            Next
13870        End With
13880        'To sheet32-8(|fffd||fffd|d)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY START
'13890        Call CopyToSheetTrans(ttlCnt, toStartRow, toWorkSheet, paraData, lt1Data, ltyData)
             Call CopyToSheet32_8_2(ttlCnt, toStartRow, toWorkSheet)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 MODIFY END
13900
13910    End If
13920    Exit Sub
13930
13940 OnErrHande:
13950        strErr = Split(Err.Description, ".")
13960        If UBound(strErr) <> 0 Then
13970            Err.Raise Number:=Err.Number, Description:=Err.Description
13980        Else
13990            Err.Raise Number:=Err.Number, Description:="|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & "." & VBA.Erl
14000        End If
End Sub
                            
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||313||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd|R|fffd|s|fffd|[|fffd||fffd||30a|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: maxRowNO|fffd|@|fffd|@|fffd|@    -|fffd|R|fffd|s|fffd|[|fffd||fffd||30d||151||fffd|s
'             area          |fffd|@|fffd|@-|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|n|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|l|fffd|@|fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
'             sheetName|fffd|@|fffd|@|fffd|@   -|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|
'             countTotal|fffd|@|fffd|@|fffd|@|fffd|@-|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||111||fffd||fffd|s|fffd||fffd||fffd|z|fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|O|fffd|F|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||313||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
'             |fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||10a|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|A|fffd|z|fffd||fffd||595||6d1||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||34a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||50b|p
'-----------------------------------------------------------
Private Function MaxRowCount(ByVal maxRowNO As Long, ByVal Area As String, ByVal SheetName As String, ByRef countTotal() As Long) As Long()
14190
14200    On Error GoTo OnErrHande
14210    '|fffd||3d0||fffd||fffd||310||933e|
14220    Dim concat As String
14230    Dim copystartRow(3) As Long           '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||24d||fffd||fffd||d0b9||fffd||103|R|fffd|s|fffd|[|fffd||fffd||30a|J|fffd|n|fffd|s
14240    Dim copyEndRow(3) As Long             '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||24d||fffd||fffd||d0b9||fffd||103|R|fffd|s|fffd|[|fffd||fffd||30f|I|fffd||fffd||fffd|s
14250    Dim rowCountSegmentation(3) As Long   '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||24d||fffd||fffd||d0b9||fffd||103|R|fffd|s|fffd|[|fffd||fffd||30d||151||fffd|s|fffd||fffd|
14260    Dim i As Long
14270    Dim j As Long
14280    Dim k As Long
         '2019/11/01 V01R015 ADD START
         Dim yerFlg As Long
         '2019/11/01 V01R015 ADD END
14290    Dim flag As Boolean                   '|fffd|d|fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd|OFlag
14300    Dim areaE As String                   'E|fffd||fffd||312|l
14310    Dim rangeD As String                  'D|fffd||fffd||312|l
14320    Dim numberCount As Long
14330    Dim sheetListTransmitPower() As String   '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd||fffd|d|fffd|z|fffd||fffd|
14340    Dim sheetListReceivePower() As String    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd|d|fffd|z|fffd||fffd|
14350
14360    sheetListTransmitPower = Split(TRANSMIT_POWER_ARRAY, ",")       '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd||fffd|d
14370    sheetListReceivePower = Split(RECEIVE_POWER_ARRAY, ",")         '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd|d
14380
14390    '|fffd||fffd||fffd||fffd||fffd||fffd|
14400    For i = 0 To 3
14410        copystartRow(i) = 0
14420        copyEndRow(i) = 0
14430        rowCountSegmentation(i) = 0
14440    Next
14450
14460    flag = False
14470
14480    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|s|fffd||702||14c|J|fffd||fffd||502||fffd|
14490    For i = COPY_TARGET_ST To maxRowNO
14500        areaE = ThisWorkbook.Worksheets(SheetName).Cells(i, 5).Value
14510
14520        '|fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd|n|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|l|fffd||30f||a347||fffd|@|fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k
14530        If areaE = Area Then
14540            numberCount = i + 3
14550            flag = True
14560        ElseIf flag = True And areaE = SUBTOTAL Then  '="|fffd||fffd|    |fffd|v"
14570            numberCount = i + 2
14580        End If
14590
14600        '|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||10a|J|fffd|n|fffd|s|fffd||fffd||fffd||18f|I|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|A|fffd|z|fffd||fffd||595||6d1||fffd|
14610        If numberCount <> 0 Then
14620            rangeD = ThisWorkbook.Worksheets(SheetName).Range("D" & numberCount).Value
14630            '|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||64fe|
14640            If rangeD = POWER_GENERATION_PRODUCER Then
14650                copystartRow(0) = numberCount
14660            ElseIf rangeD = GENERAL_POWER_TRANSMISSION Then
14670                '|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|J|fffd|n|fffd|s|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||fffd||fffd||64fe|
14680                copystartRow(1) = numberCount
14690                copyEndRow(0) = numberCount - 4
14700            ElseIf rangeD = RETAIL_ELECTRICITY_BUSINESS Then
14710                '|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||482||30f||a347||fffd|A|fffd|J|fffd|n|fffd|s|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||fffd||fffd||64fe|
14720                copystartRow(2) = numberCount
14730                copyEndRow(1) = numberCount - 4
14740            ElseIf rangeD = "|fffd||fffd| |fffd||fffd| |fffd||fffd|" Then
14750                '|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||30f||a347||fffd|A|fffd|J|fffd|n|fffd|s|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||fffd||fffd||64fe|
14760                copystartRow(3) = numberCount
14770                copyEndRow(2) = numberCount - 4
14780            ElseIf rangeD = "|fffd||fffd|    |fffd|v" Then
14790                '|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||151||fffd|s|fffd||64fe|
14800                i = i + 2
14810                copyEndRow(3) = numberCount - 4
14820                Exit For
14830            End If
14840        End If
14850    Next
14860    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||34a|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||50b|p
14870    If copyEndRow(3) = 0 Then
14880        MaxRowCount = copystartRow
14890        Exit Function
14900    End If
14910
14920    For k = 0 To 3   '|fffd|z|fffd||fffd|v|fffd|f|fffd||30c||90||fffd|(4)|fffd||343||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||242||fffd||fffd||fffd||10c||fffd||fffd||702||fffd|
14930
14940        '|fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
             '2019/11/01 V01R015 UPD START
14950        'If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Then
             If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Or SheetName = sheetListReceivePower(3) Or SheetName = sheetListTransmitPower(3) Then
             '2019/11/01 V01R015 UPD END
14960            '|fffd|R|fffd|s|fffd|[|fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd||fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347||fffd|A|fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
14970            ThisWorkbook.Worksheets(SheetName).Activate
14980            ThisWorkbook.Worksheets(SheetName).Range("E" & copystartRow(k) & ":F" & copyEndRow(k) + 1).ClearContents
14990            ThisWorkbook.Worksheets(SheetName).Range("H" & copystartRow(k) & ":M" & (copyEndRow(k) + 1)).ClearContents
15000            ThisWorkbook.Worksheets(SheetName).Range("O" & copystartRow(k) & ":T" & (copyEndRow(k) + 1)).ClearContents
15001            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
15002            For j = copystartRow(k) To copyEndRow(k)
15003                ThisWorkbook.Worksheets(SheetName).Range("W" & j).ClearContents
15004                ThisWorkbook.Worksheets(SheetName).Range("W" & (j + 1)).ClearContents
15005                j = j + 1
15006            Next
15007            ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
15010        Else
15020
15030            '|fffd|R|fffd|s|fffd|[|fffd||fffd||357|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd||30f||a347||fffd|A|fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
15040            ThisWorkbook.Worksheets(SheetName).Activate
15050            ThisWorkbook.Worksheets(SheetName).Range("E" & copystartRow(k) & ":F" & copyEndRow(k) + 1).ClearContents
15060            ThisWorkbook.Worksheets(SheetName).Range("H" & copystartRow(k) & ":Q" & (copyEndRow(k) + 1)).ClearContents
15070            For j = copystartRow(k) To copyEndRow(k)
15080                ThisWorkbook.Worksheets(SheetName).Range("R" & j).ClearContents
15081                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
15082                ThisWorkbook.Worksheets(SheetName).Range("R" & (j + 1)).ClearContents
15083                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
15090                j = j + 1
15100            Next
15110        End If
15120
15130        '|fffd|R|fffd|s|fffd|[|fffd||fffd|s|fffd||fffd|
15140        rowCountSegmentation(k) = (copyEndRow(k) - copystartRow(k)) / 2 + 1
15150
             '2019/11/01 V01R015 ADD START
             '|fffd||fffd||fffd|Q|fffd||190||fffd|(+4:|fffd||fffd||fffd|N|fffd|x|fffd|A+8:|fffd||fffd||fffd|N|fffd|x)|fffd||fffd||752||fffd|
             '  |fffd||fffd||fffd|N|fffd|x|fffd||fffd||fffd||fffd||fffd||341|A|fffd||fffd||fffd|N|fffd|x|fffd||fffd||fffd||342||202||1d3||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||fffd||642||202||fffd||302||154|N|fffd|x|fffd||fffd||fffd||182||253||fffd||fffd||34c||fffd||fffd||fffd||fffd||fffd||6ce||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
             yerFlg = 0
             Select Case SheetName
                 Case sheetListReceivePower(0)
                     yerFlg = 4
                 Case sheetListTransmitPower(0)
                     yerFlg = 4
                 Case sheetListReceivePower(3)
                     yerFlg = 8
                 Case sheetListTransmitPower(3)
                     yerFlg = 8
             End Select
             '2019/11/01 V01R015 ADD START

15160        '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|s|fffd||fffd||fffd||183|R|fffd|s|fffd|[|fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
             '2019/11/01 V01R015 UPD START
15170        'If countTotal(k) - rowCountSegmentation(k) > 0 Then
             If countTotal(k + yerFlg) - rowCountSegmentation(k) > 0 Then
             '2019/11/01 V01R015 UPD START
15180            '|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd|
                 '2019/11/01 V01R015 UPD START
15190            'For i = 1 To countTotal(k) - rowCountSegmentation(k)
                 For i = 1 To countTotal(k + yerFlg) - rowCountSegmentation(k)
                 '2019/11/01 V01R015 UPD END
15200                concat = copystartRow(k) & ":" & (copystartRow(k) + 1)
15210                ThisWorkbook.Worksheets(SheetName).Rows(concat).Copy
15220                concat = (copystartRow(k) + 2) & ":" & (copystartRow(k) + 2)
15230                ThisWorkbook.Worksheets(SheetName).Rows(concat).Insert Shift:=xlDown
15240
15250                '|fffd||fffd||fffd||fffd||202||fffd||fffd|s|fffd||fffd||1c9||fffd||fffd||fffd|A|fffd|J|fffd|n|fffd|s|fffd||292|u|fffd||fffd||fffd||3c2||fffd||fffd||302||141|A|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||10c|v|fffd|Z|fffd||fffd||fffd||fffd|
15260                If k = 0 Then
15270                    'copy|fffd|J|fffd|nROW|fffd||fffd||fffd||1c9||fffd|
15280                    copystartRow(1) = copystartRow(1) + 2
15290                    copystartRow(2) = copystartRow(2) + 2
15300                    copystartRow(3) = copystartRow(3) + 2
15310                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15320                    copyEndRow(1) = copyEndRow(1) + 2
15330                    copyEndRow(2) = copyEndRow(2) + 2
15340                    copyEndRow(3) = copyEndRow(3) + 2
15350                ElseIf k = 1 Then
15360                    copystartRow(2) = copystartRow(2) + 2
15370                    copystartRow(3) = copystartRow(3) + 2
15380                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15390                    copyEndRow(2) = copyEndRow(2) + 2
15400                    copyEndRow(3) = copyEndRow(3) + 2
15410                ElseIf k = 2 Then
15420                    copystartRow(3) = copystartRow(3) + 2
15430                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15440                    copyEndRow(3) = copyEndRow(3) + 2
15441                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd|s|fffd||f347||fffd||389||fffd| 20180216 ADD START
15442                ElseIf k = 3 Then
15443                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15444                    copyEndRow(3) = copyEndRow(3) + 2
15445                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd|s|fffd||f347||fffd||389||fffd| 20180216 ADD END
15450                End If
15460            Next
15470        End If
15480
            '2019/11/01 V01R015 UPD START
15490       'If countTotal(k) - rowCountSegmentation(k) < 0 Then
            If countTotal(k + yerFlg) - rowCountSegmentation(k) < 0 Then
            '2019/11/01 V01R015 UPD END
15500           If rowCountSegmentation(k) <> 3 Then
15510             '|fffd|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
                 '2019/11/01 V01R015 UPD START
15520            'For i = 1 To rowCountSegmentation(k) - countTotal(k)
                 For i = 1 To rowCountSegmentation(k) - countTotal(k + yerFlg)
                 '2019/11/01 V01R015 UPD END
15530                 If copyEndRow(k) - copystartRow(k) = 4 Then
15540                    Exit For
15550                 End If
15560                concat = copystartRow(k) + 2 & ":" & (copystartRow(k) + 1) + 2 '|fffd||fffd|1|fffd|s|fffd||d3dc||fffd||fffd||fffd||fffd||18b||656a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||7c1|A+2|fffd|B
15570                ThisWorkbook.Worksheets(SheetName).Rows(concat).Delete
15580
15590                '|fffd|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|J|fffd|n|fffd|s|fffd||292|u|fffd||fffd||fffd||3c2||fffd||fffd||302||141|A|fffd|J|fffd|n|fffd|s|fffd||fffd||fffd||10c|v|fffd|Z|fffd||fffd||fffd||fffd|
15600                If k = 0 Then
15610                    'copy|fffd|J|fffd|nROW|fffd||fffd||fffd||1c9||fffd|
15620                    copystartRow(1) = copystartRow(1) - 2
15630                    copystartRow(2) = copystartRow(2) - 2
15640                    copystartRow(3) = copystartRow(3) - 2
15650                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15660                     copyEndRow(0) = copyEndRow(0) - 2
15670                    copyEndRow(1) = copyEndRow(1) - 2
15680                    copyEndRow(2) = copyEndRow(2) - 2
15690                    copyEndRow(3) = copyEndRow(3) - 2
15700                ElseIf k = 1 Then
15710                    copystartRow(2) = copystartRow(2) - 2
15720                    copystartRow(3) = copystartRow(3) - 2
15730                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15740                    copyEndRow(1) = copyEndRow(1) - 2
15750                    copyEndRow(2) = copyEndRow(2) - 2
15760                    copyEndRow(3) = copyEndRow(3) - 2
15770                ElseIf k = 2 Then
15780                    copystartRow(3) = copystartRow(3) - 2
15790                   'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15800                    copyEndRow(2) = copyEndRow(2) - 2
15810                    copyEndRow(3) = copyEndRow(3) - 2
15811                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd|s|fffd||f347||fffd||389||fffd| 20180216 ADD START
15812                ElseIf k = 3 Then
15813                    'copyENDROW|fffd||fffd||fffd||1c9||fffd|
15814                    copyEndRow(3) = copyEndRow(3) - 2
15815                ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] |fffd|s|fffd||f347||fffd||389||fffd| 20180216 ADD END
15820                End If
15830             Next
15840            End If
15850        End If
15860    Next
15870
15880    MaxRowCount = copystartRow
15890    Exit Function
15900
15910 OnErrHande:
15920    Err.Raise Number:=Err.Number, Description:="|fffd|s|fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd|s|fffd|B" & "." & VBA.Erl
15930
End Function
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|32 |fffd||fffd|8|fffd|\|fffd||fffd||fffd||fffd||457|l|fffd||fffd|36|fffd|\|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: sheetName|fffd|@|fffd|@|fffd|@    -|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|
'             toStartRow         -|fffd|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'             segmentNo|fffd|@|fffd|@|fffd|@    -|fffd|z|fffd||fffd|v|fffd|f
'             i|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@-|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||1c2||74d||fffd||fffd||792||fffd||fffd|s
'             fromWorkSheet      -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||242||fffd||fffd||fffd||101|A |fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||303|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd||202||fffd|
'-----------------------------------------------------------
Private Sub CopySegmentation(ByVal SheetName As String, ByRef toStartRow() As Long, ByVal segmentNo As Long, ByRef i As Long, ByVal fromWorkSheet As Worksheet)
16120
16130    On Error GoTo OnErrHande
16140    Dim toWorkSheet As Worksheet
16150
16160    Dim sheetListTransmitPower() As String   '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd||fffd|d|fffd|z|fffd||fffd|
16170    Dim sheetListReceivePower() As String    '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|@|fffd||fffd|d|fffd|z|fffd||fffd|
16180
         '2019/11/01 V01R015 UPD START
         Dim rng As Range
         Dim emptyFlg As Boolean
         emptyFlg = False
         '2019/11/01 V01R015 UPD END
16190    sheetListTransmitPower = Split(TRANSMIT_POWER_ARRAY, ",")       '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd||fffd|d
16200    sheetListReceivePower = Split(RECEIVE_POWER_ARRAY, ",")         '|fffd|R|fffd|s|fffd|[|fffd||64a0||fffd|[  |fffd||fffd|d
16210    Set toWorkSheet = ThisWorkbook.Worksheets(SheetName)            '|fffd|R|fffd|s|fffd|[|fffd||fffd|V|fffd|[|fffd|g
16220
16230    '|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd|1|fffd||142||342||202||fffd||fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd|J|fffd|n|fffd|s|fffd|FtoStartRow(segmentNo)|fffd||583|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
         '2019/11/01 V01R015 UPD START
16240    'If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Then
         If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Or SheetName = sheetListReceivePower(3) Or SheetName = sheetListTransmitPower(3) Then
         '2019/11/01 V01R015 UPD END
         '2019/11/01 V01R015 UPD START
         If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Then
            '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
            If CheckValue2(fromWorkSheet, i, 1) = True Then
                emptyFlg = True
           '2019/11/01 V01R015 UPD END
16250      '|fffd|R|fffd|s|fffd|[|fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd||fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd||702||fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)|fffd||fffd||fffd||357|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)|fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
16260      toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("H" & i).Value
16270      toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("I" & i).Value
16280
16290      toWorkSheet.Range("H" & toStartRow(segmentNo) & ":M" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("L" & i & ":Q" & i).Value
16300      toWorkSheet.Range("O" & toStartRow(segmentNo) & ":T" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("R" & i & ":W" & i).Value
           '2019/11/01 V01R015 ADD START
           toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
            Else
                toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = ""
                toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = ""
                toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = ""
            End If
            '2019/11/01 V01R015 ADD END
            
         '2019/11/01 V01R015 UPD START
         Else
           '|fffd||fffd|2|fffd|N|fffd|x|fffd||fffd|
           If CheckValue2(fromWorkSheet, i, 2) = True Then
               emptyFlg = True
           toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("H" & i).Value
           toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("I" & i).Value
           toWorkSheet.Range("H" & toStartRow(segmentNo) & ":M" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("X" & i & ":AC" & i).Value
           toWorkSheet.Range("O" & toStartRow(segmentNo) & ":T" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AD" & i & ":AI" & i).Value
           '2019/11/01 V01R015 UPD END
           toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
           '2019/11/01 V01R015 ADD START
            Else
                toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = ""
                toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = ""
                toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = ""
            End If
         End If
         '2019/11/01 V01R015 ADD END
16301      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
           '2019/11/01 V01R015 UPD START
16302      'toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AJ" & i).Value
           'toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
           '2019/11/01 V01R015 UPD END
16303      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD START
           '2019/11/01 V01R015 UPD START
           'toWorkSheet.Range("X" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AK" & i).Value
           toWorkSheet.Range("X" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AW" & i).Value
           '2019/11/01 V01R015 UPD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD END
16310
16320      i = i + 2

           '2019/11/01 V01R015 ADD START
           '|fffd||fffd||fffd||64ea||fffd||fffd||fffd||752||fffd|
           If emptyFlg = True Then
           '2019/11/01 V01R015 ADD END
16330      toStartRow(segmentNo) = toStartRow(segmentNo) + 1
         '2019/11/01 V01R015 UPD START
         If SheetName = sheetListReceivePower(0) Or SheetName = sheetListTransmitPower(0) Then
           '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
           '2019/11/01 V01R015 UPD END
16340      toWorkSheet.Range("H" & toStartRow(segmentNo) & ":M" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("L" & i & ":Q" & i).Value
16350      toWorkSheet.Range("O" & toStartRow(segmentNo) & ":T" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("R" & i & ":W" & i).Value
         '2019/11/01 V01R015 UPD START
         Else
           '|fffd||fffd|2|fffd|N|fffd|x|fffd||fffd|
           toWorkSheet.Range("H" & toStartRow(segmentNo) & ":M" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("X" & i & ":AC" & i).Value
           toWorkSheet.Range("O" & toStartRow(segmentNo) & ":T" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AD" & i & ":AI" & i).Value
         End If
         '2019/11/01 V01R015 UPD END
16351      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
           '2019/11/01 V01R015 UPD START
16352      'toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AJ" & i).Value
           'toWorkSheet.Range("W" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
           '2019/11/01 V01R015 UPD END
16353      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
16360
16370      toStartRow(segmentNo) = toStartRow(segmentNo) + 1
         '2019/11/01 V01R015 ADD START
         End If
         '2019/11/01 V01R015 ADD END
16380    ElseIf SheetName = sheetListReceivePower(1) Or SheetName = sheetListTransmitPower(1) Then
16390
16400      '|fffd|R|fffd|s|fffd|[|fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|@|fffd||fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
16410      toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("H" & i).Value
16420      toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("I" & i).Value
           '2019/11/01 V01R015 UPD START
16430      'If fromWorkSheet.Range("AJ" & i).Value = "0" Then
           If fromWorkSheet.Range("AV" & i).Value = "0" Then
           '2019/11/01 V01R015 UPD END
16440        toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = ""
16450      Else
             '2019/11/01 V01R015 UPD START
16460        'toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AJ" & i).Value
             toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
             '2019/11/01 V01R015 UPD END
16470      End If
16471      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
16472      ' |fffd||fffd||fffd|l|fffd||310||752||fffd|
           '2019/11/01 V01R015 UPD START
16473      'toWorkSheet.Range("R" & toStartRow(segmentNo) + 1).Value = fromWorkSheet.Range("AJ" & i + 2).Value
           toWorkSheet.Range("R" & toStartRow(segmentNo) + 1).Value = fromWorkSheet.Range("AV" & i + 2).Value
           '2019/11/01 V01R015 UPD END
16474      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD START
           '2019/11/01 V01R015 UPD START
           'toWorkSheet.Range("S" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AK" & i).Value
           toWorkSheet.Range("S" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AW" & i).Value
           '2019/11/01 V01R015 UPD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD END
16480
           '2019/11/01 V01R015 UPD START
16490      'toWorkSheet.Range("H" & toStartRow(segmentNo) & ":Q" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("Z" & i & ":AI" & i).Value
16500      'toWorkSheet.Range("H" & (toStartRow(segmentNo) + 1 & ":Q" & toStartRow(segmentNo) + 1)).Value = fromWorkSheet.Range("Z" & (i + 2) & ":AI" & (i + 2)).Value
           toWorkSheet.Range("H" & toStartRow(segmentNo) & ":Q" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AL" & i & ":AU" & i).Value
           toWorkSheet.Range("H" & (toStartRow(segmentNo) + 1 & ":Q" & toStartRow(segmentNo) + 1)).Value = fromWorkSheet.Range("AL" & (i + 2) & ":AU" & (i + 2)).Value
           '2019/11/01 V01R015 UPD END
16510      i = i + 2
16520      toStartRow(segmentNo) = toStartRow(segmentNo) + 2
16530    ElseIf SheetName = sheetListReceivePower(2) Or SheetName = sheetListTransmitPower(2) Then
16540
16550      '|fffd|R|fffd|s|fffd|[|fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d|fffd|@|fffd||fffd||fffd||341|@|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d|fffd||30f||a347||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
16560      toWorkSheet.Range("E" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("H" & i).Value
16570      toWorkSheet.Range("F" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("I" & i).Value
           '2019/11/01 V01R015 UPD START
16580      'If fromWorkSheet.Range("AJ" & i).Value = "0" Then
           If fromWorkSheet.Range("AV" & i).Value = "0" Then
           '2019/11/01 V01R015 UPD END
16590        toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = ""
16600      Else
            '2019/11/01 V01R015 UPD START
16610        'toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AJ" & i).Value
             toWorkSheet.Range("R" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AV" & i).Value
             '2019/11/01 V01R015 UPD END
16620      End If
16621      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD START
16622      ' |fffd||fffd||fffd|l|fffd||310||752||fffd|
           '2019/11/01 V01R015 UPD START
16623      'toWorkSheet.Range("R" & toStartRow(segmentNo) + 1).Value = fromWorkSheet.Range("AJ" & i + 2).Value
           toWorkSheet.Range("R" & toStartRow(segmentNo) + 1).Value = fromWorkSheet.Range("AV" & i + 2).Value
           '2019/11/01 V01R015 UPD END
16624      ' H30|fffd||fffd||fffd|P|fffd|v|fffd|]1-1 IR1 20171010 ADD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD START
           '2019/11/01 V01R015 UPD START
           'toWorkSheet.Range("S" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AK" & i).Value
           toWorkSheet.Range("S" & toStartRow(segmentNo)).Value = fromWorkSheet.Range("AW" & i).Value
           '2019/11/01 V01R015 UPD END
           'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD END
16630
           '2019/11/01 V01R015 UPD START
16640      'fromWorkSheet.Range("Z" & (i + 1) & ":AI" & (i + 2)).Copy
           fromWorkSheet.Range("AL" & (i + 1) & ":AU" & (i + 2)).Copy
           '2019/11/01 V01R015 UPD END
16650      toWorkSheet.Range("H" & toStartRow(segmentNo)).PasteSpecial Paste:=xlPasteValues
16660      i = i + 2
16670      toStartRow(segmentNo) = toStartRow(segmentNo) + 2
16680
16690    End If
16700    Exit Sub
16710
16720 OnErrHande:
16730    Err.Raise Number:=Err.Number, Description:="|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd||fffd||d4482||303|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & "." & VBA.Erl
16740
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|u|fffd||6d1||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd|Q|fffd|V|fffd|K|fffd|^|fffd||3cd|X|fffd|Q|fffd||fffd||fffd||18e||496||fffd||fffd|v|fffd||182||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd||202||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|u|fffd||6d1||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd|Q|fffd|V|fffd|K|fffd|^|fffd||3cd|X|fffd|Q|fffd||fffd||fffd||18e||496||fffd||fffd|v|fffd||182||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|o|fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd|o|fffd||656a||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|o|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd|@|fffd||fffd||fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|]|fffd|{|fffd|^|fffd||fffd||fffd||fffd|[|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|]|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||195||6d1||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|
'-----------------------------------------------------------
Public Sub |fffd||6d1||fffd|()
17730
17740    Dim copyFlag As Boolean
17750    Dim fileName As String
17760    Dim initFileName As String
17770    Dim JigyouCode As String
17780    Dim jigyouName As String
17790    Dim year As String
17800    Dim newOrEdit As String
17810
17820    On Error GoTo OnErrHande
17830
17840    ' ESC|fffd|L|fffd|[|fffd||16ccc||fffd||fffd||242||fffd||fffd||fffd|
17850    Application.EnableCancelKey = xlDisabled
17860    '|fffd|x|fffd||fffd||fffd||20c1||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd|
17870    Application.DisplayAlerts = False
17880
17890    '|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|
17900    If ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value = "" Then
17910        MsgBox "|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
17920        GoTo ExitHande
17921    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j ADD START
17922    ElseIf Trim(ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB21").Value) = "" Then
17923        MsgBox "|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
17924        GoTo ExitHande
17925    ' H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171120 |fffd||68b|q|fffd|v|fffd|](|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||242||10e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||315|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd||fffd|j ADD END
17930    ElseIf ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB24").Value = "" Then
17940        MsgBox "|fffd||fffd|o|fffd||656a||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
17950        GoTo ExitHande
17960    End If
17970
17980    copyFlag = True
17990    Call |fffd||fffd||fffd|[|fffd||c42c|(True, copyFlag)
18000    If copyFlag = False Then
18010        GoTo ExitHande
18020    End If
18030
18040    JigyouCode = ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value
18050    year = ThisWorkbook.Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|").Range("B3").Value
18060    newOrEdit = ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB24").Value
18070    jigyouName = ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("N18").Value
18080
18090    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h_|fffd|N|fffd|x_|fffd|V|fffd|K/|fffd||3cd|X_|fffd||fffd||fffd||18e||496||fffd|.xlsm|fffd|v
18100    initFileName = JigyouCode & "_" & year & "_" & newOrEdit & "_" & jigyouName & ".xlsm"
18110
18120    '|fffd|u|fffd||6d1||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|v|fffd|p|fffd|R|fffd|[|fffd|h|fffd|Q|fffd|V|fffd|K|fffd|^|fffd||3cd|X|fffd|Q|fffd||fffd||fffd||18e||496||fffd||fffd|v|fffd||182||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||fffd|B
18130    fileName = Application.GetSaveAsFilename(InitialFileName:=initFileName, FileFilter:="Excel|fffd|}|fffd|N|fffd||fffd||fffd|u|fffd|b|fffd|N,*.xlsm", FilterIndex:=3)
18170    If fileName = "False" Then
18180       Exit Sub
18190    End If
18200
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
         Application.ScreenUpdating = False
         Call ProtectSheet(ActiveSheet, True)
         ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Activate
         Application.ScreenUpdating = True
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
18210    '|fffd||6d1||fffd|
18220    ThisWorkbook.SaveAs fileName
18230    GoTo ExitHande
18240
18250 OnErrHande:
18260    Call ShowErrorMessage("|fffd||6d1||fffd|", Err.Number, Err.Description, VBA.Erl)
18270
18280 ExitHande:
18290    ' |fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd|
18300    Application.EnableCancelKey = xlInterrupt
18310    Application.DisplayAlerts = True
18320
18330    If Err.Number = 0 And copyFlag = True Then
18340        MsgBox "|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbInformation
18350    End If
End Sub
                        
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||18e||488||a5d7||fffd||30d||150|V|fffd||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd||202||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||18e||488||a5d7||fffd|v|fffd||24e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||18e||488||a5d7||fffd||30d||150|V|fffd||fffd||fffd||fffd||fffd||fffd|
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|o|fffd||fffd|
'-----------------------------------------------------------
Public Sub |fffd||fffd||fffd||18e||488||a5d7||fffd||150|V|fffd||fffd|()
18500
18510    Dim fromWorkbook As Workbook    '|fffd||fffd||fffd||18e||497|l|fffd||34d|L|fffd||fffd|T|fffd|C|fffd|g|fffd||fffd||fffd||fffd||150|V|fffd||303|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|v|fffd||193||fffd||fffd|l|fffd||217|l|fffd||fffd||fffd||fffd|Excel|fffd|t|fffd|@|fffd|C|fffd||fffd|
18520    Dim openFilePathName As String  '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
         Dim ws As Worksheet
         'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
18530
18540    '|fffd|G|fffd||fffd||fffd|[|fffd||16cce||fffd||fffd||fffd||fffd||fffd|
18550    On Error GoTo OnErrHande
18560
18570    Application.ScreenUpdating = False
18580    ' ESC|fffd|L|fffd|[|fffd||16ccc||fffd||fffd||242||fffd||fffd||fffd|
18590    Application.EnableCancelKey = xlDisabled
18600
18610    '|fffd||150|V|fffd||303|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|v|fffd||193||fffd||fffd|l|fffd||217|l|fffd||fffd||fffd||fffd|Excel|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
18620    openFilePathName = Application.GetOpenFilename("Microsoft Excel|fffd|u|fffd|b|fffd|N,*.xls;*.xlsx;*.xlsm?")
18630    If openFilePathName <> "False" Then
18640        '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
18650        Set fromWorkbook = Workbooks.Open(openFilePathName, ReadOnly:=True, UpdateLinks:=0)
18660    End If
18670
18680    If fromWorkbook Is Nothing Then
18690        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
18700        Exit Sub
18710    End If
18720
18730    If ExistsWorksheet("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|") = False Then
18740       '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||82||fffd||fffd||fffd|
18750        fromWorkbook.Close False
18760        Set fromWorkbook = Nothing
18770        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
18780        Exit Sub
18790    End If
18800
18810    Debug.Print Time & "|fffd||fffd||fffd||18e||488||a5d7||fffd||150|V|fffd||fffd|_|fffd|J|fffd|n"
18820    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
18830
18840    With ThisWorkbook.Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|")
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'18850        .Unprotect Password:=pass
             Set ws = ThisWorkbook.Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|")
             Call ProtectSheet(ws, False)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]6 IR1 20180711 ADD START
             Dim myFilter As AutoFilter
             Set myFilter = .AutoFilter
             If Not myFilter Is Nothing Then
                 If .AutoFilter.FilterMode Then
                     .ShowAllData
                 End If
             End If
            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]6 IR1 20180711 ADD END
18860        '|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
18870        .Range("B2:K1002").Value = fromWorkbook.Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|").Range("B2:K1002").Value
18880        .EnableAutoFilter = True
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'18890        .Protect Password:=pass, UserInterfaceOnly:=True, DrawingObjects:=False, AllowFormattingCells:=True
             Set ws = ThisWorkbook.Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|")
             Call ProtectSheet(ws, True)
             'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
18900    End With
18910
18920    ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Activate
18930
18940    GoTo ExitHande
18950
18960 OnErrHande:
18970    Call ShowErrorMessage("|fffd||fffd||fffd||18e||488||a5d7||fffd||635e|", Err.Number, Err.Description, VBA.Erl)
18980
18990 ExitHande:
19000    '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||82||fffd||fffd||fffd|
19010    If Not fromWorkbook Is Nothing Then
19020        fromWorkbook.Close False
19030        Set fromWorkbook = Nothing
19040    End If
19050
19060    Application.ScreenUpdating = True
19070    ' |fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||256||7c2||fffd|
19080    Application.EnableCancelKey = xlInterrupt
19090    Debug.Print Time & "|fffd||fffd||fffd||18e||488||a5d7||fffd||150|V|fffd||fffd|_|fffd|I|fffd||fffd|"
19100    If Err.Number = 0 Then
19110        MsgBox "|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd||30e||635e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbInformation
19120    End If
End Sub
                        
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd||fffd|B
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True|fffd|F|fffd||fffd||fffd||742||fffd||fffd||fffd|AFalse|fffd|F|fffd||fffd||fffd||742||fffd||fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: name|fffd|F|fffd|V|fffd|[|fffd|g|fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd||fffd|B
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function ExistsWorksheet(ByVal Name As String) As Boolean
19280
19290    Dim ws As Worksheet
19300
19310    '|fffd||fffd||fffd||5c2||102||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||502||fffd|
19320    For Each ws In ThisWorkbook.Worksheets
19330        If ws.Name = Name Then
19340            ' |fffd|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd|
19350            ExistsWorksheet = True
19360            Exit Function
19370        End If
19380    Next
19390
19400    ' |fffd||fffd||fffd||742||fffd||fffd||202||fffd|
19410    ExistsWorksheet = False
19420
End Function
                        
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|B
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrNumber|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrInfo|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrLine|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|s
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|o|fffd||fffd||fffd|B
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
'H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||314||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||389||fffd| Module|fffd||fffd||fffd||fffd|) MODIFY START
'Private Sub ShowErrorMessage(ByVal Name As String, ByVal ErrNumber As String, ByVal ErrInfo As String, ByVal ErrLine As String)
Public Sub ShowErrorMessage(ByVal Name As String, ByVal ErrNumber As String, ByVal ErrInfo As String, ByVal ErrLine As String)
'H30|fffd||fffd||fffd|P|fffd|v|fffd|] IR1 20171101 |fffd||6d1||fffd||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||314||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||389||fffd| Module|fffd||fffd||fffd||fffd|) MODIFY END
19600
19610    MsgBox Name & "|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||1d7||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|: " & ErrNumber _
                    & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e: " & ErrInfo & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|s: " & ErrLine, vbCritical
19630
End Sub
                        
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|B
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrNumber|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrInfo|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ErrLine|fffd|F|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|s
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|o|fffd||fffd||fffd|B
'
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Sub ShowMessage(ByVal shName As String, ByVal Info As String, ByVal Line As Long)
19810
19820    If Info <> "" Then
19830        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & Info & "|fffd||fffd|I|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & shName & vbCrLf & "|fffd|s|fffd|F" & Line & "|fffd|s|fffd||fffd|", vbCritical
19840    Else
19850        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30b||656a||fffd||183|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||656a|/|fffd|R|fffd|[|fffd|h|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|F" & shName & vbCrLf & "|fffd|s|fffd|F" & Line & "|fffd|s|fffd||fffd|", vbCritical
19860    End If
19870
End Sub
                                
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||752||fffd|l|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True           - |fffd|`|fffd|F|fffd|b|fffd|NOK|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ False          - |fffd|`|fffd|F|fffd|b|fffd|NNG|fffd|A|fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: [|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[]|fffd|A[|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[]|fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  |fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|A|fffd|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||18e||496||fffd||fffd|A|fffd|G|fffd||fffd||fffd|A|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd||183|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function SettingCheck(ByVal iRow As Long, ByVal dataSheet As Worksheet, ByRef reValue As String) As Boolean
20040
20050    On Error GoTo OnErrHande
20060
20070    reValue = ""
20080    With dataSheet
20090        If IsEmpty(.Range("F" & iRow).Value) = True Then
20100            reValue = "|fffd|R|fffd|[|fffd|h"
20110            SettingCheck = False
20120        ElseIf IsEmpty(.Range("I" & iRow).Value) = True Then
20130            reValue = "|fffd|G|fffd||fffd||fffd|A"
20140            SettingCheck = False
20150        ElseIf IsError(.Range("H" & iRow).Value) Then
20160            SettingCheck = False
20170        Else
20180            SettingCheck = True
20190        End If
20200    End With
20210
20220    Exit Function
20230
20240 OnErrHande:
20250        Err.Raise Number:=Err.Number, Description:=Err.Description & "." & VBA.Erl
20260
End Function

'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: string->double|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: double |fffd|l
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: string |fffd|l
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: string->double|fffd||fffd||fffd|s|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
'-----------------------------------------------------------
Private Function CheckEmptyToDbl(ByVal valueInArr As String) As Double
20410
20420    If valueInArr <> "" Then
20430        CheckEmptyToDbl = CDbl(valueInArr)
20440    Else
20450        CheckEmptyToDbl = CDbl("0")
20460    End If
20470
End Function
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END Module3|fffd|AM|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|AM|fffd||fffd||fffd|[|fffd||c42c|1|fffd|AM|fffd||fffd||fffd|[|fffd||c42c|2|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|\|fffd||fffd||fffd||301|iOutPutData|fffd|j|fffd||30f||fffd||fffd||fffd||fffd||fffd|
' |fffd||512|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Public Sub ValueInitialize()
Dim i                   As Long
Dim Area_idx            As Long
Dim GenerationKind_idx  As Long
Dim LicenseKind_idx     As Long
Dim Month_idx           As Long
Dim Nendo_idx           As Long
On Err GoTo Err_Exit

    AREA_NAME(1) = AREA_HOKKAIDO
    AREA_NAME(2) = AREA_TOHOKU
    AREA_NAME(3) = AREA_TOKYO
    AREA_NAME(4) = AREA_CHUBU
    AREA_NAME(5) = AREA_HOKURIKU
    AREA_NAME(6) = AREA_KANSEI
    AREA_NAME(7) = AREA_CYUUGOKU
    AREA_NAME(8) = AREA_SIGOKU
    AREA_NAME(9) = AREA_KYUSHU
    AREA_NAME(10) = AREA_OUKINAWA

    With OutPutData
       '2019/11/01 V01R015 UPD START
       '|fffd||fffd|0|fffd|`3:|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||182||310||752||830f||fffd||fffd|(|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|p)
       '  4|fffd|`7:|fffd||fffd||fffd|N|fffd|x|fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||182||310||752||830f||fffd||fffd|(|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j|fffd|p)
       '  8|fffd|`11:|fffd||fffd||fffd|N|fffd|x|fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||182||310||752||830f||fffd||fffd|(|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j(2|fffd|N|fffd|x|fffd||fffd|)|fffd|p)
       'ReDim .countTotal(3)
       'ReDim .countTotalSeparation(3)
        ReDim .countTotal(11)
        ReDim .countTotalSeparation(11)
        '2019/11/01 V01R015 UPD END
        ReDim .LicenseKind(3)
        For i = LBound(.countTotal()) To UBound(.countTotal())
            .countTotal(i) = 0
            .countTotalSeparation(i) = 0
        Next
        For LicenseKind_idx = LBound(.LicenseKind()) To UBound(.LicenseKind())
            For Area_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo()) To UBound(.LicenseKind(LicenseKind_idx).AreaInfo())
                For GenerationKind_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind()) _
                                      To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind())
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).JigyosyaName = ""
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).AreaName = ""
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).SortNo = 0
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).Syubetu = ""
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).biko = ""
                    For Month_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).ShortTermPower()) _
                                 To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).ShortTermPower())
                        .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).ShortTermPower(Month_idx) = ""
                        .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).ShortTermMonthPower(Month_idx) = ""
                    Next
                    For Nendo_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).LongTermPower8()) _
                                 To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).LongTermPower8())
                        .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).LongTermPower8(Nendo_idx) = ""
                        .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).LongTermPower1(Nendo_idx) = ""
                        .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).LongTermYearPower(Nendo_idx) = ""
                    Next
                    .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).countTotalTogether = 0
                Next
            Next
        Next
    End With
    Exit Sub
    
Err_Exit:
    MsgBox "OutPutData|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|\|fffd||fffd||fffd||301|iOutPutData|fffd|j|fffd||313||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd|toWorkSheet|fffd||14e|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||250||752||fffd|
' |fffd||512|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: ttlCnt|fffd|@|fffd|@|fffd|@    |fffd|@|fffd|@|fffd|@|fffd|@-|fffd|s|fffd||fffd|
'             toStartRow          |fffd|@|fffd|@-|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||310||752||fffd|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'             toWorkSheet|fffd|@|fffd|@|fffd|@     |fffd|@-|fffd||752||fffd||fffd|V|fffd|[|fffd|g|fffd|i|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd|j
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Public Sub CopyToSheet36(ByRef ttlCnt As Long, ByRef toStartRow() As Long, toWorkSheet As Worksheet)
Dim Area_idx            As Long
Dim GenerationKind_idx  As Long
Dim LicenseKind_idx     As Long
Dim Month_idx           As Long
'2019/11/01 V01R015 ADD START
Dim yer_2           As Long
Dim Data_Flg        As Boolean
yer_2 = 0
Data_Flg = False
'2019/11/01 V01R015 ADD END

On Err GoTo Err_Exit

    With OutPutData
        '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a| 0:|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|, 1:|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|, 2:|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|, 3:|fffd||fffd||fffd||311||fffd|
        For LicenseKind_idx = LBound(.LicenseKind()) To UBound(.LicenseKind())
            ttlCnt = 0
            '|fffd||fffd||fffd|G|fffd||fffd||fffd|A   1:|fffd|k|fffd|C|fffd||fffd|, 2:|fffd||fffd||fffd|k, 3:|fffd||fffd||fffd||fffd|, 4:|fffd||fffd||fffd||fffd|, 5:|fffd|k|fffd||fffd|, 6:|fffd||590||fffd|, 7:|fffd||fffd||fffd||fffd|, 8:|fffd|l|fffd||fffd|, 9:|fffd||fffd|B, 10:|fffd||fffd||fffd||fffd|
            For Area_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo()) To UBound(.LicenseKind(LicenseKind_idx).AreaInfo())
                '|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd| 0:|fffd|V|fffd|G|fffd|l|fffd||20a|O, 1:|fffd||fffd||fffd||fffd|, 2:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j, 3:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j, 4:|fffd|n|fffd|M, 5:|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X, 6:|fffd|p|fffd||fffd||fffd||fffd|
                For GenerationKind_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind()) _
                                      To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind())
                    
                    With .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx)
                    If .countTotalTogether <> 0 Then
                    
                        toWorkSheet.Range("E" & toStartRow(LicenseKind_idx) + ttlCnt).Value = CELLNAME
                        toWorkSheet.Range("F" & toStartRow(LicenseKind_idx) + ttlCnt).Value = AREA_NAME(Area_idx)
                        Call SetBiko(toWorkSheet, toStartRow(LicenseKind_idx) + ttlCnt, "W", .Syubetu, .biko)
                        toWorkSheet.Range("X" & toStartRow(LicenseKind_idx) + ttlCnt).Value = .SortNo
                        
                        '2019/11/01 V01R015 UPD START
                        'For Month_idx = LBound(.ShortTermPower()) To UBound(.ShortTermPower())
 
                        If toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Or toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Then
                            yer_2 = 12
                        Else
                            yer_2 = 0
                        End If
 
                        For Month_idx = 0 To 11 Step 1
                        '2019/11/01 V01R015 UPD END
                            If Month_idx <= 5 Then
                                If .ShortTermPower(Month_idx + yer_2) <> "" Then
                                    '2019/11/01 V01R015 ADD START
                                    If toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Or toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Then
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 8 + Month_idx).Value = .ShortTermPower(Month_idx + 12)
                                    Else
                                    '2019/11/01 V01R015 ADD END
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 8 + Month_idx).Value = .ShortTermPower(Month_idx)
                                    '2019/11/01 V01R015 ADD START
                                    End If
                                    Data_Flg = True
                                    '2019/11/01 V01R015 ADD END
                                End If
                                If .ShortTermMonthPower(Month_idx + yer_2) <> "" Then
                                    '2019/11/01 V01R015 ADD START
                                    If toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Or toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Then
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 8 + Month_idx).Value = .ShortTermMonthPower(Month_idx + 12)
                                    Else
                                    '2019/11/01 V01R015 ADD END
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 8 + Month_idx).Value = .ShortTermMonthPower(Month_idx)
                                    '2019/11/01 V01R015 ADD START
                                    End If
                                    Data_Flg = True
                                    '2019/11/01 V01R015 ADD END
                                End If
                            Else
                                If .ShortTermPower(Month_idx + yer_2) <> "" Then
                                    '2019/11/01 V01R015 ADD START
                                    If toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Or toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Then
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 9 + Month_idx).Value = .ShortTermPower(Month_idx + 12)
                                    Else
                                    '2019/11/01 V01R015 ADD END
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 9 + Month_idx).Value = .ShortTermPower(Month_idx)
                                    '2019/11/01 V01R015 ADD START
                                    End If
                                    Data_Flg = True
                                    '2019/11/01 V01R015 ADD END
                                End If
                                If .ShortTermMonthPower(Month_idx + yer_2) <> "" Then
                                    '2019/11/01 V01R015 ADD START
                                    If toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Or toWorkSheet.Name = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)" Then
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 9 + Month_idx).Value = .ShortTermMonthPower(Month_idx + 12)
                                    Else
                                    '2019/11/01 V01R015 ADD END
                                        toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 9 + Month_idx).Value = .ShortTermMonthPower(Month_idx)
                                    '2019/11/01 V01R015 ADD START
                                    End If
                                    Data_Flg = True
                                    '2019/11/01 V01R015 ADD END
                                End If
                            End If
                        Next
                        '2019/11/01 V01R015 ADD START
                        If Data_Flg = False Then
                            toWorkSheet.Range("E" & toStartRow(LicenseKind_idx) + ttlCnt).Value = ""
                            toWorkSheet.Range("F" & toStartRow(LicenseKind_idx) + ttlCnt).Value = ""
                            toWorkSheet.Range("W" & toStartRow(LicenseKind_idx) + ttlCnt).Value = ""
                            toWorkSheet.Range("X" & toStartRow(LicenseKind_idx) + ttlCnt).Value = ""
                        End If
                        Data_Flg = False
                        '2019/11/01 V01R015 ADD END
                        ttlCnt = ttlCnt + 2
                    End If
                    End With
                Next
            Next
        Next
    End With
    Exit Sub
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FCopyToSheet36|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|\|fffd||fffd||fffd||301|iOutPutData|fffd|j|fffd||313||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd|toWorkSheet|fffd||14e|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||250||752||fffd|
' |fffd||512|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: ttlCnt|fffd|@|fffd|@|fffd|@    |fffd|@|fffd|@|fffd|@|fffd|@-|fffd|s|fffd||fffd|
'             toStartRow          |fffd|@|fffd|@-|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||310||752||fffd|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'             toWorkSheet|fffd|@|fffd|@|fffd|@     |fffd|@-|fffd||752||fffd||fffd|V|fffd|[|fffd|g
'             toWorkSheet|fffd|@|fffd|@|fffd|@     |fffd|@-|fffd||752||fffd||fffd|V|fffd|[|fffd|g|fffd|i|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|j
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||3cd|X CopyToSheetReceive |fffd||fffd| CopyToSheet32_8_1
'-----------------------------------------------------------
Public Sub CopyToSheet32_8_1(ByRef ttlCnt As Long, ByRef toStartRow() As Long, toWorkSheet As Worksheet)
Dim Area_idx            As Long
Dim GenerationKind_idx  As Long
Dim LicenseKind_idx     As Long
Dim Nendo_idx           As Long
On Err GoTo Err_Exit

    With OutPutData
        '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a| 0:|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|, 1:|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|, 2:|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|, 3:|fffd||fffd||fffd||311||fffd|
        For LicenseKind_idx = LBound(.LicenseKind()) To UBound(.LicenseKind())
            ttlCnt = 0
            '|fffd||fffd||fffd|G|fffd||fffd||fffd|A   1:|fffd|k|fffd|C|fffd||fffd|, 2:|fffd||fffd||fffd|k, 3:|fffd||fffd||fffd||fffd|, 4:|fffd||fffd||fffd||fffd|, 5:|fffd|k|fffd||fffd|, 6:|fffd||590||fffd|, 7:|fffd||fffd||fffd||fffd|, 8:|fffd|l|fffd||fffd|, 9:|fffd||fffd|B, 10:|fffd||fffd||fffd||fffd|
            For Area_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo()) To UBound(.LicenseKind(LicenseKind_idx).AreaInfo())
                '|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd| 0:|fffd|V|fffd|G|fffd|l|fffd||20a|O, 1:|fffd||fffd||fffd||fffd|, 2:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j, 3:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j, 4:|fffd|n|fffd|M, 5:|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X, 6:|fffd|p|fffd||fffd||fffd||fffd|
                For GenerationKind_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind()) _
                                      To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind())
                    With .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx)
                    If .countTotalTogether <> 0 Then
                    
                        toWorkSheet.Range("E" & toStartRow(LicenseKind_idx) + ttlCnt).Value = CELLNAME
                        toWorkSheet.Range("F" & toStartRow(LicenseKind_idx) + ttlCnt).Value = AREA_NAME(Area_idx)
                        Call SetBiko(toWorkSheet, toStartRow(LicenseKind_idx) + ttlCnt, "R", .Syubetu, .biko)
                        toWorkSheet.Range("S" & toStartRow(LicenseKind_idx) + ttlCnt).Value = .SortNo
                        
                        For Nendo_idx = LBound(.LongTermPower8()) To UBound(.LongTermPower8())
                            If .LongTermPower8(Nendo_idx) <> "" Then
                                toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 8 + Nendo_idx).Value = .LongTermPower8(Nendo_idx)
                            End If
                            If .LongTermYearPower(Nendo_idx) <> "" Then
                                toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 8 + Nendo_idx).Value = .LongTermYearPower(Nendo_idx)
                            End If
                        Next
                        ttlCnt = ttlCnt + 2
                    End If
                    End With
                Next
            Next
        Next
    End With
    Exit Sub
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FCopyToSheet32_8_1|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|\|fffd||fffd||fffd||301|iOutPutData|fffd|j|fffd||313||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd|toWorkSheet|fffd||14e|w|fffd||80b3||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||250||752||fffd|
' |fffd||512|l|fffd|@|fffd|@|fffd|@: |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: ttlCnt|fffd|@|fffd|@|fffd|@    |fffd|@|fffd|@|fffd|@|fffd|@-|fffd|s|fffd||fffd|
'             toStartRow          |fffd|@|fffd|@-|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||310||752||fffd|J|fffd|n|fffd|s|fffd|z|fffd||fffd|
'             toWorkSheet|fffd|@|fffd|@|fffd|@     |fffd|@-|fffd||752||fffd||fffd|V|fffd|[|fffd|g|fffd|i|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d|fffd|j
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||3cd|X CopyToSheetTrans |fffd||fffd| CopyToSheet32_8_2
'-----------------------------------------------------------
Public Sub CopyToSheet32_8_2(ByRef ttlCnt As Long, ByRef toStartRow() As Long, toWorkSheet As Worksheet)
Dim Area_idx            As Long
Dim GenerationKind_idx  As Long
Dim LicenseKind_idx     As Long
Dim Nendo_idx           As Long
On Err GoTo Err_Exit

    With OutPutData
        '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a| 0:|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|, 1:|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|, 2:|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|, 3:|fffd||fffd||fffd||311||fffd|
        For LicenseKind_idx = LBound(.LicenseKind()) To UBound(.LicenseKind())
            ttlCnt = 0
            '|fffd||fffd||fffd|G|fffd||fffd||fffd|A   1:|fffd|k|fffd|C|fffd||fffd|, 2:|fffd||fffd||fffd|k, 3:|fffd||fffd||fffd||fffd|, 4:|fffd||fffd||fffd||fffd|, 5:|fffd|k|fffd||fffd|, 6:|fffd||590||fffd|, 7:|fffd||fffd||fffd||fffd|, 8:|fffd|l|fffd||fffd|, 9:|fffd||fffd|B, 10:|fffd||fffd||fffd||fffd|
            For Area_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo()) To UBound(.LicenseKind(LicenseKind_idx).AreaInfo())
                '|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd| 0:|fffd|V|fffd|G|fffd|l|fffd||20a|O, 1:|fffd||fffd||fffd||fffd|, 2:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j, 3:|fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j, 4:|fffd|n|fffd|M, 5:|fffd|o|fffd|C|fffd|I|fffd|}|fffd|X, 6:|fffd|p|fffd||fffd||fffd||fffd|
                For GenerationKind_idx = LBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind()) _
                                      To UBound(.LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind())
                    With .LicenseKind(LicenseKind_idx).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx)
                    If .countTotalTogether <> 0 Then
                    
                        toWorkSheet.Range("E" & toStartRow(LicenseKind_idx) + ttlCnt).Value = CELLNAME
                        toWorkSheet.Range("F" & toStartRow(LicenseKind_idx) + ttlCnt).Value = AREA_NAME(Area_idx)
                        Call SetBiko(toWorkSheet, toStartRow(LicenseKind_idx) + ttlCnt, "R", .Syubetu, .biko)
                        toWorkSheet.Range("S" & toStartRow(LicenseKind_idx) + ttlCnt).Value = .SortNo
                        
                        For Nendo_idx = LBound(.LongTermPower1()) To UBound(.LongTermPower1())
                            If .LongTermPower1(Nendo_idx) <> "" Then
                                toWorkSheet.Cells(toStartRow(LicenseKind_idx) + ttlCnt, 8 + Nendo_idx).Value = .LongTermPower1(Nendo_idx)
                            End If
                            If .LongTermYearPower(Nendo_idx) <> "" Then
                                toWorkSheet.Cells(toStartRow(LicenseKind_idx) + 1 + ttlCnt, 8 + Nendo_idx).Value = .LongTermYearPower(Nendo_idx)
                            End If
                        Next
                        ttlCnt = ttlCnt + 2
                    End If
                    End With
                Next
            Next
        Next
    End With
    Exit Sub
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FCopyToSheet32_8_2|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||241|A|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd|1|fffd||30f||a347||fffd|d|fffd||357||282||18d||fffd||fffd|Z|fffd|A1|fffd||20a|O|fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
' |fffd||512|l|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd|I|fffd||fffd|:True|fffd|A|fffd||64f||fffd|I|fffd||fffd|:False
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: cellE|fffd|@|fffd|@|fffd|@            -|fffd|R|fffd|s|fffd|[|fffd||fffd|E|fffd||fffd|
'             cellI         |fffd|@|fffd|@|fffd|@|fffd|@ -|fffd|R|fffd|s|fffd|[|fffd||fffd|J|fffd||fffd|
'             cellJ         |fffd|@|fffd|@|fffd|@|fffd|@ -|fffd|R|fffd|s|fffd|[|fffd||fffd|J|fffd||fffd|
'             Row|fffd|@|fffd|@|fffd|@              -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||1cd||fffd||fffd||74d|s
'             dataSheet|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@-|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
'|fffd|@|fffd|u|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|u1|fffd|v|fffd||314||fffd||fffd|d|fffd||fffd||fffd||18e||482||fffd||fffd||702||182||7c2||101|A|fffd|u10|fffd||fffd|kw|fffd||209||fffd||fffd||30e||fffd||fffd||18e||482||302||702||fffd||7c1|v|fffd||182||fffd||fffd||114||fffd||fffd|d|fffd||fffd||fffd||18e||482||590||752||fffd|
'|fffd|@|fffd|u|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|u1|fffd|v|fffd||308||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||fffd||fffd||702||182||7c2||101|A|fffd|u10|fffd||fffd|kw|fffd||209||fffd||fffd||30e||fffd||fffd||18e||482||302||702||fffd||7c1|v|fffd||182||fffd||fffd||108||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||590||752||fffd|
'|fffd|@|fffd|u|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|u1|fffd|v|fffd||30f||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||482||193|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||482||fffd||fffd||702||182||7c2||101|A|fffd|u10|fffd||fffd|kw|fffd||209||fffd||fffd||30e||fffd||fffd||18e||482||302||702||fffd||7c1|v|fffd||182||fffd||fffd||10f||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||482||590||752||fffd|
'|fffd|@|fffd|u|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|v|fffd||fffd||fffd|u1|fffd|v|fffd||311||fffd||fffd|d|fffd||fffd||fffd||18e||481|A|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|A|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||482||fffd||fffd||702||182||7c2||101|A|fffd|u10|fffd||fffd|kw|fffd||209||fffd||fffd||30e||fffd||fffd||18e||482||302||702||fffd||7c1|v|fffd||182||fffd||fffd||102||fffd||fffd||311||fffd||fffd||590||752||fffd|
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
'2019/11/01 V01R015 UPD START
'Function RowCalculateByLicense(cellE As String, cellI As String, cellJ As String, cellAJ As String, cellAJBiko As String, Row As Long, dataSheet As Worksheet) As Boolean
Function RowCalculateByLicense(cellE As String, cellI As String, cellJ As String, cellAJ As String, cellAJBiko As String, cellAZ As String, Row As Long, dataSheet As Worksheet) As Boolean
'2019/11/01 V01R015 UPD END
Dim LicenseKind As Long
On Err GoTo Err_Exit

    RowCalculateByLicense = False
    '|fffd||fffd||fffd||fffd||fffd||415||6d7|L|fffd|d|fffd||fffd||fffd||343|J|fffd|E|fffd||fffd||fffd|g|fffd||fffd||fffd||202||fffd|
    If cellE <> KUBUN_JISYA_NM Then
        '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||3ca||fffd| 0:|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|, 1:|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|, 2:|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|, 3:|fffd||fffd||fffd||311||fffd|
        Select Case cellE
        '|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|
        Case POWER_GENERATION_PRODUCER
            LicenseKind = 0
        '|fffd||fffd||fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|
        Case GENERAL_POWER_TRANSMISSION
            LicenseKind = 1
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|A|fffd|o|fffd|^|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|
        Case REGISTRATION_SPECIFIC_POWER_TRANSMISSION, RETAIL_ELECTRICITY_BUSINESS
            LicenseKind = 2
        '|fffd||fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||18e||481|A|fffd||fffd||fffd||8457||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|A|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|
        Case Else
            LicenseKind = 3
        End Select
        
        If cellJ = TOGETHER_FLAG Then
            If Not (RowCalByArea(cellI, cellAJ, cellAJBiko, Row, dataSheet, LicenseKind)) Then
                Exit Function
            End If
        Else
            OutPutData.countTotalSeparation(LicenseKind) = OutPutData.countTotalSeparation(LicenseKind) + 1
            '2019/11/01 V01R015 ADD START
            '|fffd||fffd||fffd||209||fffd||fffd||30f||fffd||fffd||fffd||fffd||157|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j|fffd||312||1c9||fffd||fffd|s|fffd||14ed2|f|fffd||fffd||fffd||702||fffd|
            Select Case cellAZ
                Case "1"
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd||582||313||fffd||fffd||342||302||742||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
                    OutPutData.countTotalSeparation(LicenseKind + 4) = OutPutData.countTotalSeparation(LicenseKind + 4) + 1
                Case "2"
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd||582||313||fffd||fffd||342||302||742||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
                    OutPutData.countTotalSeparation(LicenseKind + 8) = OutPutData.countTotalSeparation(LicenseKind + 8) + 1
                Case "3"
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd||fffd||fffd||fffd||457||fffd||fffd|N|fffd|x|fffd||582||313||fffd||fffd||342||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
                    OutPutData.countTotalSeparation(LicenseKind + 4) = OutPutData.countTotalSeparation(LicenseKind + 4) + 1
                    OutPutData.countTotalSeparation(LicenseKind + 8) = OutPutData.countTotalSeparation(LicenseKind + 8) + 1
            End Select
            '2019/11/01 V01R015 ADD END
        End If
    End If
    RowCalculateByLicense = True
    Exit Function
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FRowCalculateByLicense|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd||fffd|1|fffd||30f||a347||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|W|fffd||fffd|A|fffd||a287||fffd|L|fffd||688||20a|O|fffd||342||fffd||fffd||302||702||70d|\|fffd||fffd||fffd||302||24a|i|fffd|[
' |fffd||512|l|fffd|@|fffd|@  : |fffd||fffd||fffd||fffd|I|fffd||fffd|:True|fffd|A|fffd||64f||fffd|I|fffd||fffd|:False
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@: cellI|fffd|@|fffd|@|fffd|@             -|fffd|R|fffd|s|fffd|[|fffd||fffd|I|fffd||fffd|
'             cellAJ         |fffd|@|fffd|@|fffd|@|fffd|@ -|fffd|R|fffd|s|fffd|[|fffd||fffd|AJ|fffd||fffd|
'             Row|fffd|@|fffd|@|fffd|@               -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||1cd||fffd||fffd||74d|s
'             LicenseKind|fffd|@|fffd|@|fffd|@       -|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a|
'             dataSheet|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ -|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g
'             TogetherFlg             -|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||a287||fffd|L|fffd||68e||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
'             |fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd|W|fffd||42cc2||fffd||fffd|f|fffd|[|fffd|^|fffd||253||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Function RowCalByArea(cellI As String, cellAJ As String, cellAJBiko As String, Row As Long, dataSheet As Worksheet, LicenseKind As Long) As Boolean
Dim Month_idx As Long
Dim Nendo_idx As Long
On Err GoTo Err_Exit
    
    RowCalByArea = False
    With OutPutData.LicenseKind(LicenseKind).AreaInfo(GetAreaCode(cellI)).GenerationKind(GetSyubetu(cellAJ))
        .countTotalTogether = .countTotalTogether + 1
        '|fffd||fffd||fffd||fffd| 0 to 11
        For Month_idx = LBound(.ShortTermPower()) To UBound(.ShortTermPower())
            If dataSheet.Cells(Row, 12 + Month_idx).Value <> "" Then
                '|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j|fffd||313|d|fffd||357||282||30d||fffd||fffd|Z
                .ShortTermPower(Month_idx) = CheckEmptyToDbl(.ShortTermPower(Month_idx)) + dataSheet.Cells(Row, 12 + Month_idx).Value
            End If
            If dataSheet.Cells(Row + 2, 12 + Month_idx).Value <> "" Then
                '|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||313|d|fffd||357||282||30d||fffd||fffd|Z
                .ShortTermMonthPower(Month_idx) = CheckEmptyToDbl(.ShortTermMonthPower(Month_idx)) + dataSheet.Cells(Row + 2, 12 + Month_idx).Value
            End If
        Next
        '|fffd||fffd||fffd|N|fffd|x 0 to 9
        For Nendo_idx = LBound(.LongTermPower8()) To UBound(.LongTermPower8())
            '2019/11/01 V01R015 UPD START
            'If dataSheet.Cells(Row, 26 + Nendo_idx).Value <> "" Then
            If dataSheet.Cells(Row, 38 + Nendo_idx).Value <> "" Then
            '2019/11/01 V01R015 UPD END
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j8|fffd||fffd||fffd||30d||fffd||fffd|Z
                '2019/11/01 V01R015 UPD START
                '.LongTermPower8(Nendo_idx) = CheckEmptyToDbl(.LongTermPower8(Nendo_idx)) + dataSheet.Cells(Row, 26 + Nendo_idx).Value
                .LongTermPower8(Nendo_idx) = CheckEmptyToDbl(.LongTermPower8(Nendo_idx)) + dataSheet.Cells(Row, 38 + Nendo_idx).Value
                '2019/11/01 V01R015 UPD END
            End If
            '2019/11/01 V01R015 UPD START
            'If dataSheet.Cells(Row + 1, 26 + Nendo_idx).Value <> "" Then
            If dataSheet.Cells(Row + 1, 38 + Nendo_idx).Value <> "" Then
            '2019/11/01 V01R015 UPD END
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|iMW|fffd|j1|fffd||fffd||fffd||30d||fffd||fffd|Z
                '2019/11/01 V01R015 UPD START
                '.LongTermPower1(Nendo_idx) = CheckEmptyToDbl(.LongTermPower1(Nendo_idx)) + dataSheet.Cells(Row + 1, 26 + Nendo_idx).Value
                .LongTermPower1(Nendo_idx) = CheckEmptyToDbl(.LongTermPower1(Nendo_idx)) + dataSheet.Cells(Row + 1, 38 + Nendo_idx).Value
                '2019/11/01 V01R015 UPD END
            End If
            '2019/11/01 V01R015 UPD START
            'If dataSheet.Cells(Row + 2, 26 + Nendo_idx).Value <> "" Then
            If dataSheet.Cells(Row + 2, 38 + Nendo_idx).Value <> "" Then
            '2019/11/01 V01R015 UPD END
                '|fffd||fffd||fffd|N|fffd||512||fffd||fffd|B|fffd|d|fffd||357||281|iGWh|fffd|j|fffd||30d||fffd||fffd|Z
                '2019/11/01 V01R015 UPD START
                '.LongTermYearPower(Nendo_idx) = CheckEmptyToDbl(.LongTermYearPower(Nendo_idx)) + dataSheet.Cells(Row + 2, 26 + Nendo_idx).Value
                .LongTermYearPower(Nendo_idx) = CheckEmptyToDbl(.LongTermYearPower(Nendo_idx)) + dataSheet.Cells(Row + 2, 38 + Nendo_idx).Value
                '2019/11/01 V01R015 UPD END
            End If
        Next
        '|fffd||fffd||fffd||fffd||281|A|fffd||fffd||fffd|l
        Call AddBiko(cellAJ, cellAJBiko, .Syubetu, .biko)
        '|fffd||fffd||fffd|L|fffd||68f||fffd|
        '2019/11/01 V01R015 UPD START
        'If IsNumeric(dataSheet.Cells(Row, 37).Text) Then
            'If .DataCount >= 1 And .SortNo <> CLng(Trim(dataSheet.Cells(Row, 37).Value)) Then
        If IsNumeric(dataSheet.Cells(Row, 49).Text) Then
            If .DataCount >= 1 And .SortNo <> CLng(Trim(dataSheet.Cells(Row, 49).Value)) Then
            '2019/11/01 V01R015 UPD END
                '|fffd||fffd||fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd|W|fffd||42cc2||fffd||fffd|f|fffd|[|fffd|^|fffd||253||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[
                MsgBox "|fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||242||353||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                       "|fffd|u" & dataSheet.Name & "|fffd|v" & vbCrLf & _
                       "|fffd||656a||fffd|F" & Trim(dataSheet.Cells(Row, 5).Value) & vbCrLf & _
                       "|fffd||fffd||fffd||18e||496||fffd||fffd|F" & Trim(dataSheet.Cells(Row, 8).Value) & vbCrLf & _
                       "|fffd|G|fffd||fffd||fffd|A|fffd|F" & cellI & vbCrLf & _
                       "|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|F" & Trim(dataSheet.Cells(Row, 10).Value) & vbCrLf & _
                       "|fffd|L|fffd||68f||fffd||fffd|F" & Trim(dataSheet.Cells(Row, 49).Value) & vbCrLf & _
                       "|fffd||fffd||fffd||343|f|fffd|[|fffd|^|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Function
            Else
                '2019/11/01 V01R015 UPD START
                '.SortNo = dataSheet.Cells(Row, 37).Value
                .SortNo = dataSheet.Cells(Row, 49).Value
                '2019/11/01 V01R015 UPD END
                .DataCount = .DataCount + 1
            End If
        Else
            If .SortNo <> 0 Then
                '|fffd||fffd||fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd|W|fffd||42cc2||fffd||fffd|f|fffd|[|fffd|^|fffd||253||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[
                MsgBox "|fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||242||353||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                       "|fffd|u" & dataSheet.Name & "|fffd|v" & vbCrLf & _
                       "|fffd||656a||fffd|F" & Trim(dataSheet.Cells(Row, 5).Value) & vbCrLf & _
                       "|fffd||fffd||fffd||18e||496||fffd||fffd|F" & Trim(dataSheet.Cells(Row, 8).Value) & vbCrLf & _
                       "|fffd|G|fffd||fffd||fffd|A|fffd|F" & cellI & vbCrLf & _
                       "|fffd||a287||fffd|L|fffd||683|t|fffd||fffd||fffd|O|fffd|F" & Trim(dataSheet.Cells(Row, 10).Value) & vbCrLf & _
                      "|fffd|L|fffd||68f||fffd||fffd|F" & Trim(dataSheet.Cells(Row, 49).Value) & vbCrLf & _
                       "|fffd||fffd||fffd||343|f|fffd|[|fffd|^|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Function
            Else
                .SortNo = 0
                .DataCount = .DataCount + 1
            End If
        End If
    End With
    RowCalByArea = True
    Exit Function
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FRowCalByArea|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||243|R|fffd|s|fffd|[|fffd|s|fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
' |fffd||512|l|fffd|@  |fffd|@: |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@    :|fffd|@LicenseKind|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a|
'|fffd|@|fffd|@|fffd|@|fffd|@   :|fffd|@cnt|fffd|@|fffd|@          |fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd||311||fffd||fffd|s|fffd||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Public Sub CountTogetherRow(LicenseKind As Long, ByRef cnt As Long)
Dim Area_idx            As Long
Dim GenerationKind_idx  As Long
Dim LicenseKind_idx     As Long

    With OutPutData
        For Area_idx = LBound(.LicenseKind(LicenseKind).AreaInfo()) To UBound(.LicenseKind(LicenseKind).AreaInfo())
            For GenerationKind_idx = LBound(.LicenseKind(LicenseKind).AreaInfo(Area_idx).GenerationKind()) _
                                  To UBound(.LicenseKind(LicenseKind).AreaInfo(Area_idx).GenerationKind())
                If .LicenseKind(LicenseKind).AreaInfo(Area_idx).GenerationKind(GenerationKind_idx).countTotalTogether > 0 Then
                    '|fffd||fffd||fffd||a287||fffd|t|fffd||fffd||fffd|O|fffd||752||fffd|s|fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
                    cnt = cnt + 1
                End If
            Next
        Next
    End With
    
End Sub
Function GetAreaCode(Buff As String) As Long
Dim i As Long

    For i = LBound(AREA_NAME) To UBound(AREA_NAME)
        If AREA_NAME(i) = Buff Then
            GetAreaCode = i
            Exit Function
        End If
    Next
End Function
Function GetSyubetu(Buff As String) As Long

    Select Case Buff
    '|fffd||fffd||fffd||fffd||fffd||fffd|
    Case NENSYU_WIND_NM
        GetSyubetu = 1
    '|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|S|fffd||281|j
    Case NENSYU_SUN_ALL_NM
        GetSyubetu = 2
    '|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|i|fffd|]|fffd||fffd|j
    Case NENSYU_SUN_LEFT_NM
        GetSyubetu = 3
    '|fffd||fffd||fffd|n|fffd|M
    Case NENSYU_GROTHERMAL_NM
        GetSyubetu = 4
    '|fffd||fffd||fffd|o|fffd|C|fffd|I|fffd|}|fffd|X
    Case NENSYU_BIOMASS_NM
        GetSyubetu = 5
    '|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd|
    Case NENSYU_WASTE_NM
        GetSyubetu = 6
    '|fffd||fffd||fffd|V|fffd|G|fffd|l|fffd||20a|O|fffd|i|fffd||d39e||fffd|o|fffd|b|fffd|N|fffd|A|fffd|b|fffd|v|fffd|A|fffd||fffd||fffd||341|A|fffd||397||341|A|fffd||fffd||fffd|q|fffd||341|A|fffd||fffd||fffd||311||fffd||fffd|i|fffd|d|fffd||fffd||fffd||fffd||28d||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd|A|fffd|i|fffd|w|fffd||fffd||202||fffd||fffd|j|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|j
    Case Else
        '|fffd||fffd||fffd||a287||fffd|L|fffd||682||30f||a347||fffd|V|fffd|G|fffd|l|fffd||20a|O|fffd||351|S|fffd||102||702||182||7c2||fffd|
        GetSyubetu = 0
    End Select

End Function
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||209||fffd||fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|L|fffd||68f||fffd||fffd||24f|]|fffd||fffd||fffd|\|fffd|[|fffd|g|fffd|i|fffd|L|fffd||68f||fffd||fffd||313||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|{|fffd|j
' |fffd||512|l|fffd|@  |fffd|@: |fffd||fffd||fffd||fffd|I|fffd||fffd|:True|fffd|A|fffd||64f||fffd|I|fffd||fffd|:False
' |fffd||fffd||fffd||fffd||fffd|@    : |fffd||202||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||341|i|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd|j|fffd||81|i|fffd|L|fffd||68f||fffd||fffd||313||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||743|\|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd||fffd||fffd||302||fffd||fffd||182||256||fffd||fffd||fffd||fffd||342||303|f|fffd|[|fffd|^|fffd||fffd||fffd|]|fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||14f|o|fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ |fffd|Y|fffd||fffd||fffd|u|fffd||fffd||fffd|b|fffd|N|fffd||313||fffd||fffd||343|f|fffd|[|fffd|^|fffd||fffd|2|fffd||fffd||fffd||20f||30a9||fffd||8b|L|fffd||68f||fffd||fffd||fffd||fffd||342||fffd|1|fffd||fffd||fffd||20f||fffd||30f||a347||fffd||302||743|\|fffd|[|fffd|g|fffd|A|fffd||fffd||fffd|L|fffd||20a|O|fffd||30f||a347||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@: |fffd|L|fffd||68f||fffd||fffd||308||209||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@ |fffd|@1|fffd|u|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd|d|fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd|i|fffd|u32|fffd||fffd|8|fffd|\_|fffd||fffd|d|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30b||fffd||fffd||fffd||fffd||fffd||60aa||fffd|u|fffd|k|fffd|C|fffd||fffd||fffd|v|fffd||301|u|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||481|v|fffd||fffd|1|fffd|u|fffd||fffd||fffd|b|fffd|N |fffd|j
'             |fffd|A|fffd||a287||fffd|L|fffd||682||30f||a347||fffd|A|fffd|W|fffd||42cc2||fffd||fffd|f|fffd|[|fffd|^|fffd||253||fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|G|fffd||fffd||fffd|[|fffd|iRowCalByArea|fffd||14e||fffd||fffd|{|fffd|j
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@   |fffd||fffd||fffd|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||342||34b||fffd||fffd|e|fffd|A|fffd|i|fffd|L|fffd||68f||fffd||fffd||313||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||743|\|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd||fffd||fffd||302||fffd||fffd||182||256||fffd||fffd||fffd||fffd||342||303|f|fffd|[|fffd|^|fffd||fffd||fffd|]|fffd||fffd||fffd||30b|L|fffd||68f||fffd||fffd||14f|o|fffd||341|j
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@   |fffd|@1,6,7 |fffd||30e||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||34b||fffd||fffd|e
'             |fffd|@|fffd||fffd||fffd|l|fffd||20a|O|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||356||fffd||fffd||fffd|
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:|fffd||38f||6c3|V|fffd|[|fffd|g|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|A
'                      |fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|A
'                      |fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd|v
'-----------------------------------------------------------
Function ExecSort() As Boolean
'2019/11/01 V01R015 UPD START
'Dim TargetSheetName(5)  As String
Dim TargetSheetName(7)  As String
'2019/11/01 V01R015 UPD END
Dim Sheet_idx           As Long
Dim Area_idx            As Long
Dim License_idx         As Long
Dim DataStartRow        As Long
Dim StartRow            As Long
Dim EndRow              As Long
Dim Row                 As Long
Dim i                   As Long
Dim KyokyuCol           As Long
Dim AreaJigyosyaCol     As Long
Dim AreaCol             As Long
Dim SyubetuBikoCol      As Long
Dim SortNoCol           As Long
Dim EndRowChkCol        As Long
Dim Lbl1Pos             As Long
Dim Lbl2Pos             As Long
Dim DataCount           As Long
Dim SortNOCount         As Long
Dim SortNOMax           As Long
Dim SortNo              As Long
Dim SortData_idx        As Long
Dim SortNOCheck         As Object
On Error GoTo Err_Exit
    
    ExecSort = False

    TargetSheetName(0) = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d"
    TargetSheetName(1) = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d"
    TargetSheetName(2) = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d"
    TargetSheetName(3) = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d"
    TargetSheetName(4) = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d"
    TargetSheetName(5) = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d"
    '2019/11/01 V01R015 ADD START
    TargetSheetName(6) = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
    TargetSheetName(7) = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
    '2019/11/01 V01R015 ADD END
        
    '2019/11/01 V01R015 UPD START
    'For Sheet_idx = 0 To 5
    For Sheet_idx = 0 To 7
    '2019/11/01 V01R015 UPD END
        '|fffd||fffd||fffd|J|fffd|n|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||fffd|z|fffd||fffd||24a|i|fffd|[
        DataStartRow = 3
        KyokyuCol = 3
        AreaJigyosyaCol = 5
        AreaCol = 6
        EndRowChkCol = 7
        Select Case Sheet_idx
        Case 0, 1, 2, 3
            SyubetuBikoCol = 18
            SortNoCol = 19
        Case Else
            SyubetuBikoCol = 23
            SortNoCol = 24
        End Select
        Lbl1Pos = SortNoCol + 1
        Lbl2Pos = SortNoCol + 3
        For Area_idx = LBound(AREA_NAME()) To UBound(AREA_NAME())
            '|fffd||fffd||fffd|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||313||fffd||fffd||354||348||342||fffd||fffd||64fe|
            If Not (GetAreaInputRow(TargetSheetName(Sheet_idx), AREA_NAME(Area_idx), DataStartRow, KyokyuCol, AreaJigyosyaCol, EndRowChkCol, StartRow, EndRow)) Then
                Exit Function
            End If
            '|fffd||fffd|Lbl1Pos "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd|ALbl2Pos 1,3,5,7 |fffd||fffd|T|fffd||fffd||fffd||fffd||fffd|s|fffd||292|u|fffd||fffd|z|fffd||fffd||24a|i|fffd|[
            License_idx = 3
            For Row = EndRow To StartRow Step -1
                For i = 7 To 1 Step -2
                    If Workbooks(ThisWorkbook.Name).Sheets(TargetSheetName(Sheet_idx)).Cells(Row, Lbl1Pos) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|" And _
                       Workbooks(ThisWorkbook.Name).Sheets(TargetSheetName(Sheet_idx)).Cells(Row, Lbl2Pos) = i Then
                        DataStartEndInfo.AreaInfo(Area_idx).License(License_idx).DataEndRow = Row - 2
                        License_idx = License_idx - 1
                    End If
                Next
            Next
            DataStartEndInfo.AreaInfo(Area_idx).License(0).DataStartRow = StartRow
            '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd|J|fffd|n|fffd|s|fffd||341|A|fffd|P|fffd||91|O|fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||30f|I|fffd||fffd||fffd|s + 2
            For License_idx = LBound(OutPutData.LicenseKind()) To UBound(OutPutData.LicenseKind()) - 1
                DataStartEndInfo.AreaInfo(Area_idx).License(License_idx + 1).DataStartRow _
                   = DataStartEndInfo.AreaInfo(Area_idx).License(License_idx).DataEndRow + 4
            Next
            
            For License_idx = LBound(OutPutData.LicenseKind()) To UBound(OutPutData.LicenseKind())
                With Workbooks(ThisWorkbook.Name).Sheets(TargetSheetName(Sheet_idx))
                    
                    Set SortNOCheck = CreateObject("Scripting.Dictionary")
                    '|fffd||fffd||fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||656a||fffd||fffd||fffd|z|fffd||fffd||243|Z|fffd|b|fffd|g
                    DataCount = 0
                    SortNOCount = 0
                    SortNOMax = 0
                    For Row = DataStartEndInfo.AreaInfo(Area_idx).License(License_idx).DataStartRow _
                           To DataStartEndInfo.AreaInfo(Area_idx).License(License_idx).DataEndRow Step 2
                        If .Cells(Row, AreaJigyosyaCol) <> "" Then
                        
                            ReDim Preserve SortData(DataCount)
                            '|fffd||fffd||fffd||fffd||fffd||18e||496||fffd||fffd|A|fffd|G|fffd||fffd||fffd|A|fffd||fffd|
                            SortData(DataCount).JigyosyaName = .Cells(Row, AreaJigyosyaCol)
                            SortData(DataCount).AreaName = .Cells(Row, AreaCol)
                            
                            Select Case Sheet_idx
                            '|fffd||fffd|32|fffd||fffd|8|fffd|\
                            Case 0 To 3
                                For i = LBound(SortData(DataCount).LongTermPower8()) To UBound(SortData(DataCount).LongTermPower8())
                                    SortData(DataCount).LongTermPower8(i) = .Cells(Row, i + 8)
                                    SortData(DataCount).LongTermPower1(i) = .Cells(Row + 1, i + 8)
                                Next
                            '|fffd||fffd|36|fffd|\
                            Case Else
                                For i = LBound(SortData(DataCount).ShortTermPower()) To UBound(SortData(DataCount).ShortTermPower())
                                    If i <= 5 Then
                                        SortData(DataCount).ShortTermPower(i) = .Cells(Row, i + 8)
                                        SortData(DataCount).ShortTermMonthPower(i) = .Cells(Row + 1, i + 8)
                                    Else
                                        SortData(DataCount).ShortTermPower(i) = .Cells(Row, i + 9)
                                        SortData(DataCount).ShortTermMonthPower(i) = .Cells(Row + 1, i + 9)
                                    End If
                                Next
                            End Select
                            '|fffd||fffd||fffd||fffd||281|A|fffd||fffd||fffd|l|fffd|A|fffd|L|fffd||68f||fffd|
                            SortData(DataCount).Syubetu = .Cells(Row, SyubetuBikoCol)
                            SortData(DataCount).biko = .Cells(Row + 1, SyubetuBikoCol)
                            If IsNumeric(Trim(.Cells(Row, SortNoCol).Text)) Or IsNumeric(Trim(.Cells(Row, SortNoCol))) Then
                                '|fffd||fffd||fffd|L|fffd||68f||fffd||fffd|d|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                                If Not SortNOCheck.Exists(CLng(.Cells(Row, SortNoCol))) Then
                                    '|fffd||fffd||fffd|L|fffd||68f||fffd||fffd||fffd||fffd|w|fffd||fffd||34f|d|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||202||fffd|
                                    If CLng(.Cells(Row, SortNoCol)) <> 0 Then
                                        SortNOCheck.Add CLng(.Cells(Row, SortNoCol)), Null
                                    End If
                                Else
                                    '|fffd||fffd||fffd|L|fffd||68f||fffd||fffd|d|fffd||fffd||fffd|G|fffd||fffd||fffd|[
                                    MsgBox "|fffd|L|fffd||68f||fffd||fffd||30e|w|fffd||80aa||fffd|d|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                                           "|fffd|u" & Right(TargetSheetName(Sheet_idx), 2) & "|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v" & vbCrLf & _
                                           "|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|F" & AREA_NAME(Area_idx) & vbCrLf & _
                                           "|fffd||656a||fffd|F" & GetLicenseName(License_idx) & vbCrLf & _
                                           "|fffd||fffd||fffd||18e||496||fffd||fffd|F" & .Cells(Row, AreaJigyosyaCol) & vbCrLf & _
                                           "|fffd|G|fffd||fffd||fffd|A|fffd|F" & .Cells(Row, AreaCol) & vbCrLf & _
                                           "|fffd|L|fffd||68f||fffd||fffd|F" & Trim(.Cells(Row, SortNoCol)) & vbCrLf & _
                                           "|fffd||fffd||fffd||343|f|fffd|[|fffd|^|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                                    Exit Function
                                End If
                                SortData(DataCount).SortNo = CLng(.Cells(Row, SortNoCol))
                                If SortNOMax < CLng(.Cells(Row, SortNoCol)) Then
                                    SortNOMax = CLng(.Cells(Row, SortNoCol))
                                End If
                                SortNOCount = SortNOCount + 1
                            Else
                                SortData(DataCount).SortNo = 0
                            End If
                            DataCount = DataCount + 1
                        End If
                    Next
                    Set SortNOCheck = Nothing
                    '|fffd||fffd||fffd||fffd||fffd||343|f|fffd|[|fffd|^|fffd||fffd|2|fffd||fffd||fffd||20f||30a9||fffd||8b|L|fffd||68f||fffd||fffd||fffd||fffd||342||fffd|1|fffd||fffd||fffd||20f||fffd||30f||a347||fffd||302||74b|L|fffd||68f||fffd||fffd||24f|]|fffd||fffd||fffd|o|fffd||341|i|fffd|z|fffd||fffd||2c3|V|fffd|[|fffd|g|fffd|j
                    If DataCount >= 2 And SortNOCount >= 1 Then
                        Application.Calculation = xlCalculationManual
                        Row = DataStartEndInfo.AreaInfo(Area_idx).License(License_idx).DataStartRow
                        '|fffd||fffd||fffd|L|fffd||68f||fffd||fffd||24f|o|fffd||fffd|
                        DataCount = 0
                        For SortNo = 1 To SortNOMax
                            For SortData_idx = LBound(SortData()) To UBound(SortData())
                                With Workbooks(ThisWorkbook.Name).Sheets(TargetSheetName(Sheet_idx))
                                    If SortData(SortData_idx).SortNo = SortNo Then
                                        .Cells(Row + DataCount * 2, 5) = SortData(SortData_idx).JigyosyaName
                                        .Cells(Row + DataCount * 2, 6) = SortData(SortData_idx).AreaName
                                        Select Case Sheet_idx
                                        '|fffd||fffd|32|fffd||fffd|8|fffd|\
                                        Case 0 To 3
                                            For i = LBound(SortData(SortData_idx).LongTermPower8()) To UBound(SortData(SortData_idx).LongTermPower8())
                                                .Cells(Row + DataCount * 2, i + 8) = SortData(SortData_idx).LongTermPower8(i)
                                                .Cells(Row + DataCount * 2 + 1, i + 8) = SortData(SortData_idx).LongTermPower1(i)
                                            Next
                                            .Cells(Row + DataCount * 2, 18) = SortData(SortData_idx).Syubetu
                                            .Cells(Row + DataCount * 2 + 1, 18) = SortData(SortData_idx).biko
                                            .Cells(Row + DataCount * 2, 19) = SortData(SortData_idx).SortNo
                                        '|fffd||fffd|36|fffd|\
                                        Case Else
                                           '2019/11/01 V01R015 UPD START
'                                            For i = LBound(SortData(SortData_idx).ShortTermPower()) To UBound(SortData(SortData_idx).ShortTermPower())
'                                                If i <= 5 Then
'                                                    .Cells(Row + DataCount * 2, i + 8) = SortData(DataCount).ShortTermPower(i)
'                                                    .Cells(Row + DataCount * 2 + 1, i + 8) = SortData(DataCount).ShortTermMonthPower(i)
'                                                Else
'                                                    .Cells(Row + DataCount * 2, i + 9) = SortData(DataCount).ShortTermPower(i)
'                                                    .Cells(Row + DataCount * 2 + 1, i + 9) = SortData(DataCount).ShortTermMonthPower(i)
'                                                End If
'                                            Next
                                             '2019/11/01 V01R015 UPD END
                                            .Cells(Row + DataCount * 2, 23) = SortData(SortData_idx).Syubetu
                                            .Cells(Row + DataCount * 2 + 1, 23) = SortData(SortData_idx).biko
                                            .Cells(Row + DataCount * 2, 24) = SortData(SortData_idx).SortNo
                                        End Select
                                        DataCount = DataCount + 1
                                        Exit For
                                    End If
                                End With
                            Next
                        Next
                        '|fffd||fffd||fffd|L|fffd||68f||fffd||fffd||fffd||fffd||fffd||fffd||34f|o|fffd||fffd|
                        For SortData_idx = LBound(SortData()) To UBound(SortData())
                            With Workbooks(ThisWorkbook.Name).Sheets(TargetSheetName(Sheet_idx))
                                If SortData(SortData_idx).SortNo = 0 Then
                                    .Cells(Row + DataCount * 2, 5) = SortData(SortData_idx).JigyosyaName
                                    .Cells(Row + DataCount * 2, 6) = SortData(SortData_idx).AreaName
                                    Select Case Sheet_idx
                                    '|fffd||fffd|32|fffd||fffd|8|fffd|\
                                    Case 0 To 3
                                        For i = LBound(SortData(SortData_idx).LongTermPower8()) To UBound(SortData(SortData_idx).LongTermPower8())
                                            .Cells(Row + DataCount * 2, i + 8) = SortData(SortData_idx).LongTermPower8(i)
                                            .Cells(Row + DataCount * 2 + 1, i + 8) = SortData(SortData_idx).LongTermPower1(i)
                                        Next
                                        .Cells(Row + DataCount * 2, 18) = SortData(SortData_idx).Syubetu
                                        .Cells(Row + DataCount * 2 + 1, 18) = SortData(SortData_idx).biko
                                        .Cells(Row + DataCount * 2, 19) = ""
                                    '|fffd||fffd|36|fffd|\
                                    Case Else
                                       '2019/11/01 V01R015 UPD START
'                                        For i = LBound(SortData(SortData_idx).ShortTermPower()) To UBound(SortData(SortData_idx).ShortTermPower())
'                                            If i <= 5 Then
'                                                .Cells(Row + DataCount * 2, i + 8) = SortData(DataCount).ShortTermPower(i)
'                                                .Cells(Row + DataCount * 2 + 1, i + 8) = SortData(DataCount).ShortTermMonthPower(i)
'                                            Else
'                                                .Cells(Row + DataCount * 2, i + 9) = SortData(DataCount).ShortTermPower(i)
'                                                .Cells(Row + DataCount * 2 + 1, i + 9) = SortData(DataCount).ShortTermMonthPower(i)
'                                            End If
'                                        Next
                                         '2019/11/01 V01R015 UPD END
                                        .Cells(Row + DataCount * 2, 23) = SortData(SortData_idx).Syubetu
                                        .Cells(Row + DataCount * 2 + 1, 23) = SortData(SortData_idx).biko
                                        .Cells(Row + DataCount * 2, 24) = ""
                                    End Select
                                    DataCount = DataCount + 1
                                End If
                            End With
                        Next
                        Application.Calculation = xlCalculationAutomatic
                    End If
                End With
            Next
        Next
    Next
    ExecSort = True
    Exit Function
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FExecSort|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
Function GetLicenseName(Buff As Long) As String

    Select Case Buff
    Case 0
        GetLicenseName = "|fffd||fffd||fffd|d|fffd||fffd||fffd||18e||fffd|"
    Case 1
        GetLicenseName = "|fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|"
    Case 2
        GetLicenseName = "|fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||fffd|"
    Case 3
        GetLicenseName = "|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|"
    End Select
    
End Function
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]21 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]3 IR1 20180901 ADD START
Sub |fffd||2433||fffd|V|fffd|[|fffd|g|fffd|]|fffd|L()
Dim SheetName       As String
Dim InputSheetName  As String
Dim StartRow        As Long
Dim EndRow          As Long
Dim Row             As Long
Dim Col             As Long
Dim PasteRow        As Long
Dim BaseRow(1)      As Long
Dim KeyWord1        As String
Dim KeyWord2(1)     As String
Dim JigyosyaCode    As String
Dim JigyosyaName    As String
Dim AreaName        As String
Dim Item_idx        As Long
Dim ItemNum         As Long
Dim idx             As Long

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    SheetName = ActiveSheet.Name
    If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 2) = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||60aa||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|u|fffd||2433||fffd|ikW|fffd|j|fffd|w|fffd||fffd|P|fffd|v|fffd||313||fffd||fffd||342||fffd||fffd||3c2||fffd||142||fffd||fffd||90a9||fffd|A|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
        Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 2).Select
        Exit Sub
    End If
    
    Select Case SheetName
    Case "|fffd||2433||fffd|i|fffd||fffd||fffd|z|fffd||fffd||fffd|j|fffd|w|fffd||fffd|P"
        ItemNum = 2
        BaseRow(0) = 9
        BaseRow(1) = 15
        KeyWord1 = "|fffd||fffd||fffd|z|fffd||fffd|"
        KeyWord2(0) = "|fffd|S|fffd||fffd|"
        KeyWord2(1) = "|fffd|]|fffd||fffd|"
        InputSheetName = "|fffd||2433||fffd|i|fffd||fffd||fffd|z|fffd||fffd||fffd|j|fffd|w|fffd||fffd|Q"
    Case "|fffd||2433||fffd|i|fffd||fffd||fffd||341|j|fffd|w|fffd||fffd|P"
        ItemNum = 1
        BaseRow(0) = 9
        BaseRow(1) = 0
        KeyWord1 = "|fffd||fffd||fffd||fffd|"
        KeyWord2(0) = "|fffd||fffd||fffd||fffd|"
        KeyWord2(1) = ""
        InputSheetName = "|fffd||2433||fffd|i|fffd||fffd||fffd||341|j|fffd|w|fffd||fffd|Q"
    End Select

    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    For Item_idx = 0 To ItemNum - 1
        '|fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||fffd|
        '2019/11/01 V01R015 UPD START
        'For Col = 7 To 18
        For Col = 7 To 30
        '2019/11/01 V01R015 UPD END
            If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx), Col) = "" Then
                MsgBox KeyWord2(Item_idx) & "|fffd||fffd||fffd|B|fffd|d|fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Sub
            End If
        Next
        '|fffd||fffd||fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||fffd|
        '2019/11/01 V01R015 UPD START
        'For Col = 7 To 18
        For Col = 7 To 18
        '2019/11/01 V01R015 UPD END
            If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + 2, Col) = "" Then
                MsgBox KeyWord2(Item_idx) & "|fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||282||fffd||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Sub
            End If
        Next
        '|fffd||fffd|8|fffd||fffd||fffd|d|fffd||fffd|
        '2019/11/01 V01R015 UPD START
        'For Col = 20 To 28
        For Col = 32 To 39
        '2019/11/01 V01R015 UPD END
            If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx), Col) = "" Then
                MsgBox KeyWord2(Item_idx) & "8|fffd||fffd||fffd|d|fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Sub
            End If
        Next
        '|fffd||fffd|1|fffd||fffd||fffd|d|fffd||341|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd||30e||fffd||fffd||302||743|`|fffd|F|fffd|b|fffd|N|fffd|j
        If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 4) = 1 _
           Or Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 4) = 2 Then
            '2019/11/01 V01R015 UPD START
            'For Col = 20 To 28
            For Col = 32 To 39
            '2019/11/01 V01R015 UPD END
                If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + 1, Col) = "" Then
                    MsgBox KeyWord2(Item_idx) & "1|fffd||fffd||fffd|d|fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B" & vbCrLf & "|fffd|V|fffd|[|fffd|g|fffd|u" & InputSheetName & "|fffd|v|fffd||313||fffd||fffd||342||fffd||fffd||3c2||fffd||142||fffd||fffd||90a9||fffd|A|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                    Exit Sub
                End If
            Next
        End If
        '|fffd||fffd||fffd|N|fffd||513|d|fffd||357||fffd|
        '2019/11/01 V01R015 UPD START
        'For Col = 20 To 28
        For Col = 32 To 39
        '2019/11/01 V01R015 UPD END
            If Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + 2, Col) = "" Then
                MsgBox KeyWord2(Item_idx) & "|fffd|N|fffd||513|d|fffd||357||282||fffd||fffd||fffd||fffd||fffd||fffd||342||142||fffd||fffd|B|fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
                Exit Sub
            End If
        Next
    Next
        
    '|fffd||fffd||fffd|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||34a|J|fffd|n|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||64fe|
    AreaName = Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 2)
    If Not (GetAreaInputRow("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[", AreaName, 25, 5, 6, 1, StartRow, EndRow)) Then
        Exit Sub
    End If
        
    '|fffd||fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|]|fffd|L
    Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Activate
    Call ProtectSheet(ActiveSheet, False)
    For Item_idx = 0 To ItemNum - 1
        '|fffd||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||18e||496||fffd||fffd||64fe|
        If Not (GetJigyosyaCode(KeyWord1, KeyWord2(Item_idx), JigyosyaCode, JigyosyaName)) Then
            Exit Sub
        End If
        '|fffd||fffd||fffd||fffd||fffd||354||348||353||fffd||fffd||303||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
        PasteRow = 0
        For Row = StartRow To EndRow Step 3
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||2cf||33d1||fffd||fffd|
            If Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 5) = "|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|" And _
               Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 6) = JigyosyaCode And _
               Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 8) = JigyosyaName And _
               Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 9) = AreaName Then
                PasteRow = Row
                Exit For
            End If
        Next
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|^|fffd||202||fffd||fffd||2d0|V|fffd|K|fffd|o|fffd|^
        If PasteRow = 0 Then
            For Row = StartRow To EndRow Step 3
                If Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 5) & Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 6) & _
                   Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 8) & Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 9) = "" Then
                    PasteRow = Row
                    Exit For
                End If
            Next
        End If
        '|fffd||fffd||fffd|\|fffd||fffd|
        Rows(PasteRow & ":" & PasteRow + 2).Hidden = False
        '|fffd||fffd||fffd|]|fffd|L
        Application.Calculation = xlCalculationManual
        Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(PasteRow, 5) = "|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|"
        Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(PasteRow, 6) = JigyosyaCode
        Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(PasteRow, 8) = JigyosyaName
        Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(PasteRow, 9) = AreaName
        '|fffd||fffd||fffd||fffd||fffd|B|fffd|d|fffd||341|A|fffd||fffd||fffd||512||fffd||fffd|B|fffd|d|fffd||357||fffd|
        idx = 0
        For Row = PasteRow To PasteRow + 2 Step 2
            '2019/11/01 V01R015 UPD START
            'For Col = 12 To 23
            For Col = 12 To 35
            '2019/11/01 V01R015 UPD END
                Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, Col) _
                   = Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + idx, Col - 5).Value
            Next
            idx = idx + 2
        Next
        '|fffd||fffd|8|fffd||fffd||fffd|A1|fffd||fffd||fffd|A|fffd|N|fffd||513|d|fffd||357||281|A|fffd||fffd||fffd|l
        idx = 0
        For Row = PasteRow To PasteRow + 2
            '|fffd||fffd|1|fffd||fffd||fffd|d|fffd||341|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd||20a|O|fffd||30e||fffd||fffd|s|fffd|v|fffd||20e|Q|fffd||18e||fffd||fffd|N|fffd||fffd||fffd|A|fffd|j
            If Not (Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 4) = 1 Or Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(3, 4) = 2) And _
                Row = PasteRow + 1 Then
                '2019/11/01 V01R015 UPD START
                'Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 26) = ""
                Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 38) = ""
                Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, 39) = ""
                '2019/11/01 V01R015 UPD END
            End If
            '2019/11/01 V01R015 UPD START
            'For Col = 27 To 36
            '2019/11/21 |fffd|L|fffd||fffd|C|fffd||fffd|
            For Col = 39 To 48
                'Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, Col) _
                   = Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + idx, Col - 7).Value
                Workbooks(ThisWorkbook.Name).Sheets("|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[").Cells(Row, Col) _
                   = Workbooks(ThisWorkbook.Name).Sheets(SheetName).Cells(BaseRow(Item_idx) + idx, Col - 6).Value
                '2019/11/01 V01R015 UPD END
            Next
            idx = idx + 1
        Next
        Application.Calculation = xlCalculationAutomatic
    Next
    Call ProtectSheet(ActiveSheet, True)
    
    MsgBox "|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||582||313|]|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbInformation
    
End Sub
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|V|fffd|[|fffd|g|fffd|u|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|v|fffd||fffd||fffd||70bb||fffd||311||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||18e||496||fffd||fffd||fffd||fffd||64fe|
' |fffd||512|l|fffd|@|fffd|@  : |fffd||fffd||fffd||fffd|I|fffd||fffd| True |fffd|A|fffd||64f||fffd|I|fffd||fffd| False
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@  : IN |fffd|@KeyWord1     |fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h1
'             IN |fffd|@KeyWord2     |fffd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h2
'             OUT  JigyosyaCode |fffd|Y|fffd||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h
'             OUT  JigyosyaName |fffd|Y|fffd||fffd||fffd||fffd||fffd||18e||496||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||fffd||18e||496||fffd||fffd||fffd|KeyWord1|fffd|AKeyWord2|fffd||fffd||fffd||702||782||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd|A|fffd||fffd||fffd||18e||496||fffd||fffd||fffd||502||fffd|
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Function GetJigyosyaCode(KeyWord1 As String, KeyWord2 As String, JigyosyaCode As String, JigyosyaName As String) As Boolean
Dim i As Long
On Error GoTo Err_Exit

    GetJigyosyaCode = False
    
    JigyosyaCode = ""
    JigyosyaName = ""
    For i = 1 To Range("|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h").Count
        If InStr(1, Range("|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|").Item(i).Value, KeyWord1, vbTextCompare) > 0 And _
           InStr(1, Range("|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|").Item(i).Value, KeyWord2, vbTextCompare) > 0 Then
            JigyosyaCode = Range("|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h").Item(i).Value
            JigyosyaName = Range("|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|").Item(i).Value
            GetJigyosyaCode = True
            Exit For
        End If
    Next
    Exit Function
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FGetJigyosyaCode|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]3 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]3,21,22 IR1 20180901 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||fffd|CheckCol|fffd||fffd||30d||14f|I|fffd|s|fffd||fffd||fffd||64fe|
' |fffd||512|l|fffd|@|fffd|@  : |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||fffd|CheckCol|fffd||fffd||30d||14f|I|fffd|s
' |fffd||fffd||fffd||fffd||fffd|@  |fffd|@: SheetName |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||fffd|
'             CheckCol  |fffd||64fe||fffd||38f||6d7||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||fffd|\|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||142||fffd||fffd||64fe||fffd||94|\
'-----------------------------------------------------------
Function GetMaxRow(SheetName As String, CheckCol As Long) As Long
Dim ws As Worksheet
Dim LastRow As Long
Dim Buff As Variant
Dim Row As Long

    GetMaxRow = 0
    
    Set ws = ThisWorkbook.Sheets(SheetName)
    If Not Intersect(ws.UsedRange, ws.Columns(CheckCol)) Is Nothing Then
        LastRow = ws.UsedRange.Row + ws.UsedRange.Rows.Count - 1
        If LastRow > 1 Then
            Buff = ws.Range(ws.Cells(1, CheckCol), ws.Cells(LastRow, CheckCol)).Value
            For Row = UBound(Buff, 1) To 1 Step -1
                If Not IsEmpty(Buff(Row, 1)) Then
                    GetMaxRow = Row
                    Exit Function
                End If
            Next
        ElseIf Not IsEmpty(ws.Cells(1, CheckCol).Value) Then
            GetMaxRow = 1
        End If
    End If

End Function
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||34d|s|fffd||348||342||fffd||fffd||64fe|
' |fffd||512|l|fffd|@|fffd|@  : |fffd||fffd||fffd||fffd|I|fffd||fffd| True |fffd|A|fffd||64f||fffd|I|fffd||fffd| False
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@  : IN |fffd|@SheetName |fffd|@  |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||fffd||fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|j
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@IN |fffd|@AreaName      |fffd||38f||6c3|G|fffd||fffd||fffd|A|fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@IN |fffd|@DataStartRow  |fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s|fffd|@|fffd|@ |fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[ = 25|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d = 3|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d = 3|fffd|j
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@IN |fffd|@KyokyuCol    |fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||292|u|fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[ =  5|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d = 3|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d = 3|fffd|j
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@IN |fffd|@AreaCol       |fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||292|u|fffd|@ |fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[ =  6|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d = 5|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d = 5|fffd|j
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@IN |fffd|@EndRowChkCol  |fffd||14f|I|fffd|s|fffd||64fe||fffd||fffd||292|u |fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[ =  1|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d = 7|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d = 7|fffd|j
'             OUT  StartRow      |fffd||38f||6c3|G|fffd||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s
'             OUT  EndRow        |fffd||38f||6c3|G|fffd||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd|I|fffd||fffd||fffd|s|fffd|i|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||30f||a347||fffd||fffd|3|fffd|s|fffd||fffd|1|fffd|Z|fffd|b|fffd|g|fffd||fffd|1|fffd|s|fffd||681|j
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||38f||6c3|V|fffd|[|fffd|g|fffd||30a|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||313||fffd||fffd||34a|J|fffd|n|fffd|A|fffd|I|fffd||fffd||fffd|s|fffd||fffd||502||fffd|
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Function GetAreaInputRow(SheetName As String, AreaName As String, DataStartRow As Long, KyokyuCol As Long, AreaCol As Long, EndRowChkCol As Long, _
                         StartRow As Long, EndRow As Long) As Boolean
Dim Row         As Long
Dim MaxRow      As Long
Dim Area_idx    As Long
On Error GoTo Err_Exit

    GetAreaInputRow = False
    
    StartRow = 0
    EndRow = 0
    AREA_NAME(1) = AREA_HOKKAIDO
    AREA_NAME(2) = AREA_TOHOKU
    AREA_NAME(3) = AREA_TOKYO
    AREA_NAME(4) = AREA_CHUBU
    AREA_NAME(5) = AREA_HOKURIKU
    AREA_NAME(6) = AREA_KANSEI
    AREA_NAME(7) = AREA_CYUUGOKU
    AREA_NAME(8) = AREA_SIGOKU
    AREA_NAME(9) = AREA_KYUSHU
    AREA_NAME(10) = AREA_OUKINAWA
    
    For Area_idx = LBound(AREA_NAME()) To UBound(AREA_NAME())
        If AreaName = AREA_NAME(Area_idx) Then
            Exit For
        End If
    Next
    '|fffd||fffd||fffd||fffd||fffd||34d||151||fffd|s|fffd||64fe|
    MaxRow = GetMaxRow(SheetName, EndRowChkCol)
    With Workbooks(ThisWorkbook.Name).Sheets(SheetName)
    '|fffd||fffd||fffd||fffd||fffd||34a|J|fffd|n|fffd|s|fffd||64fe|
    For Row = DataStartRow To MaxRow
        If .Cells(Row, KyokyuCol) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" And .Cells(Row, AreaCol) = AreaName Then
            StartRow = Row
            Exit For
        End If
    Next
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||34f|I|fffd||fffd||fffd|s|fffd||64fe|
    If Area_idx = 10 Then
        If SheetName = "|fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[" Then
            EndRow = MaxRow - 2
        Else
            EndRow = MaxRow
        End If
        GetAreaInputRow = True
    Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||20a|O|fffd||fffd||fffd||34f|I|fffd||fffd||fffd|s|fffd||64fe|
        For Row = StartRow To MaxRow
            If .Cells(Row, KyokyuCol) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" And .Cells(Row, AreaCol) = AREA_NAME(Area_idx + 1) Then
                EndRow = Row
                GetAreaInputRow = True
                Exit For
            End If
        Next
        EndRow = EndRow - 4
    End If
    StartRow = StartRow + 3
    End With
    
    Exit Function
     
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FGetAreaInputRow|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]3,21,22 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]22 IR1 20180901 ADD START
'-----------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd|v|fffd|A|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd||fffd||fffd||fffd|
'             |fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P|fffd|v|fffd|A|fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j|fffd|v|fffd|A|fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q|fffd|v|fffd|i|fffd|w|fffd||fffd|Q|fffd||242||82||fffd||fffd||102||343|G|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd||20a|O|fffd|j|fffd||253|]|fffd|L
' |fffd||512|l|fffd|@|fffd|@  : |fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@  : |fffd||202||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||24e||fffd||fffd||18e||482||fffd||1c9||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|[|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||197|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|A|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd||30f||fffd||fffd|v|fffd|s|fffd||292|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||14f||fffd||fffd|v|fffd||313||fffd||fffd|e|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P|fffd|v|fffd||253|]|fffd|L
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'-----------------------------------------------------------
Sub |fffd||2433||fffd|w|fffd||fffd|1|fffd|]|fffd|L()
Dim AreaName        As String
Dim SheetName       As String
Dim StartRow        As Long
Dim EndRow          As Long
Dim Item_idx        As Long
Dim Row             As Long
Dim cnt             As Long
Dim i               As Long
Dim Lbl1Pos         As Long
Dim Lbl2Pos         As Long
Dim Col             As Long
Dim PostFlg         As Boolean
'|fffd||fffd||fffd|v|fffd|s|fffd||292|u |fffd|Y|fffd||fffd|1:0 |fffd|V|fffd|[|fffd|g|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|v|fffd|A1 |fffd|V|fffd|[|fffd|g|fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|A2 |fffd|V|fffd|[|fffd|g|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd|v|fffd|A3 |fffd|V|fffd|[|fffd|g|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd|v
'           |fffd|Y|fffd||fffd|2:0 |fffd||fffd||fffd|d|fffd||fffd||fffd||18e||481|A1 |fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||481|A2 |fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|A3 |fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||18e||fffd|
'2019/11/01 V01R015 UPD START
'Dim RowPos(5, 3)    As Long
Dim RowPos(7, 3)    As Long
'2019/11/01 V01R015 UPD END
On Error GoTo Err_Exit

    With Workbooks(ThisWorkbook.Name)
    AreaName = .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(2, 3)
    If AreaName = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(2, 3).Select
        Exit Sub
    End If
    If AreaName = "|fffd|k|fffd|C|fffd||fffd|" Or AreaName = "|fffd||fffd||fffd|k" Then
        PostFlg = True
    Else
        PostFlg = False
    End If
    '|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|s|fffd||292|u|fffd||fffd||fffd||64fe||fffd||fffd||fffd|z|fffd||fffd||24a|i|fffd|[
    For Item_idx = LBound(RowPos(), 1) To UBound(RowPos(), 1)
        Select Case Item_idx
        Case 0
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 20
            Lbl2Pos = 22
        Case 1
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 20
            Lbl2Pos = 22
        Case 2
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 25
            Lbl2Pos = 27
        Case 3
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 25
            Lbl2Pos = 27
        Case 4
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 20
            Lbl2Pos = 22
        Case 5
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 20
            Lbl2Pos = 22
        '2019/11/01 V01R015 ADD START
        Case 6
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 25
            Lbl2Pos = 27
        Case 7
            SheetName = "|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)"
            '|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd||fffd||292|u
            Lbl1Pos = 25
            Lbl2Pos = 27
           '2019/11/01 V01R015 ADD END
        End Select
        '|fffd||fffd||fffd|Y|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||354||348||34e||64fe|
        If Not (GetAreaInputRow(SheetName, AreaName, 3, 3, 5, 7, StartRow, EndRow)) Then
            Exit Sub
        End If
        '|fffd||fffd|Col=20 "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|"|fffd|ACol=22 1,3,5,7 |fffd||fffd|T|fffd||fffd||fffd||fffd||fffd|s|fffd||292|u|fffd||fffd|z|fffd||fffd||24a|i|fffd|[
        cnt = 3
        For Row = EndRow To StartRow Step -1
            For i = 7 To 1 Step -2
                If .Sheets(SheetName).Cells(Row, Lbl1Pos) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|Z|fffd||fffd|" And _
                   .Sheets(SheetName).Cells(Row, Lbl2Pos) = i Then
                    RowPos(Item_idx, cnt) = Row
                    cnt = cnt - 1
                End If
            Next
        Next
    Next
    
    Application.Calculation = xlCalculationManual
    '|fffd||fffd||fffd|]|fffd|L |fffd||1c9||fffd||fffd|d|fffd|l|fffd|u|fffd||fffd|d|fffd|v|fffd|u|fffd||fffd||fffd|d|fffd|v|fffd||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd|""|fffd||30f||a347||fffd|A|fffd|u0.0|fffd|v|fffd||142||202||fffd|""|fffd||752||fffd|
    For Item_idx = LBound(RowPos(), 2) To UBound(RowPos(), 2)
        '|fffd||fffd||fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P|fffd|v|fffd||fffd||fffd||fffd|
        For Col = 5 To 16
            If Col < 11 Then
                If Item_idx < 3 Then
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3))
                        '2019/11/01 V01R015 UPD END
                    End If
                    
                    '2019/11/01 V01R015 UPD START
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 3) = "" Then
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = ""
                    Else
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 3))
                    End If
                    '2019/11/01 V01R015 UPD END
                Else
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 3))
                        '2019/11/01 V01R015 UPD END
                    End If
                    
                    '2019/11/01 V01R015 ADD START
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 3) = "" Then
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col + 12) = ""
                    Else
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 3))
                    End If
                    '2019/11/01 V01R015 ADD END
                End If
            Else
                If Item_idx < 3 Then
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4))
                        '2019/11/01 V01R015 UPD END
                    End If
                    
                    '2019/11/01 V01R015 ADD START
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 4) = "" Then
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = ""
                    Else
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 4))
                    End If
                    '2019/11/01 V01R015 ADD END
                Else
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col + 4))
                        '2019/11/01 V01R015 UPD END
                    End If
                    '2019/11/01 V01R015 ADD START
                    '|fffd||fffd||fffd||fffd||fffd|N|fffd|x
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 4) = "" Then
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col + 12) = ""
                    Else
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(0, Item_idx), Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d (2|fffd|N|fffd|x|fffd||fffd|)").Cells(RowPos(1, Item_idx), Col + 4))
                    End If
                    '2019/11/01 V01R015 ADD END
                End If
            End If
        Next
        '|fffd||fffd||fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P|fffd|v|fffd|N|fffd||502|R|fffd|O|fffd|i|fffd|Q|fffd|O|fffd|P|fffd|X|fffd|j|fffd|N|fffd|x|fffd||34c|v|fffd|Z|fffd||fffd||fffd||242||10c||fffd||fffd||fffd|8|fffd||fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||302||153|]|fffd|L|fffd|s|fffd|v
        '2019/11/01 V01R015 UPD START
        'For Col = 19 To 27
        '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd|{|fffd||fffd||fffd|N|fffd|x|fffd||34c|v|fffd|Z|fffd||fffd||fffd||242||10c||fffd||fffd||fffd|8|fffd||fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||302||153|]|fffd|L|fffd|s|fffd|v
        For Col = 20 To 27
        '2019/11/01 V01R015 UPD END
            If Item_idx < 3 Then
                If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10) = "" Then
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = ""
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = ""
                    '2019/11/01 V01R015 UPD END
                Else
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx, Col) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10))
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx, Col + 12) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10))
                    '2019/11/01 V01R015 UPD END
                End If
                
            Else
                If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10) = "" Then
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = ""
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col + 12) = ""
                    '2019/11/01 V01R015 UPD END
                Else
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(12 + Item_idx + 1, Col) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10))
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|P").Cells(13 + Item_idx + 1, Col + 12) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx), Col - 10))
                    '2019/11/01 V01R015 UPD END
                End If
            End If
        Next
        '|fffd||fffd||fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q|fffd|v|fffd|k|fffd|C|fffd||fffd||fffd|A|fffd||fffd||fffd|k|fffd||30f||a347||fffd||302||754|N|fffd||503|f|fffd|[|fffd|^|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q|fffd|v|fffd||242||fffd||fffd|]|fffd|L
        If PostFlg Then
            '2019/11/01 V01R015 UPD START
            'For Col = 19 To 27
            '|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd|{|fffd||fffd||fffd|N|fffd|x|fffd||34c|v|fffd|Z|fffd||fffd||fffd||242||10c||fffd||fffd||fffd|8|fffd||fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||302||153|]|fffd|L|fffd|s|fffd|v
            For Col = 20 To 27
            '2019/11/01 V01R015 UPD END
                If Item_idx < 3 Then
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(12 + Item_idx, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(13 + Item_idx, Col + 12) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(12 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(13 + Item_idx, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10))
                        '2019/11/01 V01R015 UPD END
                    End If
                Else
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(12 + Item_idx + 1, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(13 + Item_idx + 1, Col + 12) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(12 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|Q").Cells(13 + Item_idx + 1, Col + 12) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd|d").Cells(RowPos(4, Item_idx), Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|Q|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(5, Item_idx), Col - 10))
                        '2019/11/01 V01R015 UPD END
                    End If
                End If
            Next
        End If
        '|fffd||fffd||fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j|fffd|v|fffd||fffd||fffd||501|@|fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d|fffd|v|fffd||cb2d3|d|fffd||357||fffd| - |fffd|u|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|d|fffd||357||fffd|
        For Col = 5 To 16
            If Col < 11 Then
                If Item_idx < 3 Then
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3))
                        '2019/11/01 V01R015 UPD END
                    End If
                Else
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 3)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 3))
                        '2019/11/01 V01R015 UPD END
                    End If
                End If
            Else
                If Item_idx < 3 Then
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col + 1) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col + 1) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col + 1) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col + 1) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4))
                        '2019/11/01 V01R015 UPD END
                    End If
                Else
                    If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4) = "" Then
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col + 1) = ""
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col + 1) = ""
                        '2019/11/01 V01R015 UPD END
                    Else
                        '2019/11/01 V01R015 UPD START
                        '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col + 1) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4))
                        .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col + 1) = _
                           CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col + 4)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|36|fffd|\|fffd|i|fffd|w|fffd||fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col + 4))
                        '2019/11/01 V01R015 UPD END
                    End If
                End If
            End If
        Next
        '|fffd||fffd||fffd|u|fffd||2433||fffd|i|fffd||fffd|W|fffd|j|fffd|w|fffd||fffd|v|fffd|N|fffd||502|R|fffd|O|fffd|i|fffd|Q|fffd|O|fffd|P|fffd|X|fffd|j|fffd|N|fffd|x|fffd||34c|v|fffd|Z|fffd||fffd||fffd||242||10c||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||102||fffd||fffd||fffd||302||153|]|fffd|L|fffd|s|fffd|v
        '  |fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d|fffd|v|fffd|N|fffd||50e||cb2d3|d|fffd||357||fffd| - |fffd|u|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d|fffd|v|fffd|N|fffd||513|d|fffd||357||fffd|
        For Col = 19 To 27
            If Item_idx < 3 Then
                If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10) = "" Then
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col + 2) = ""
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col + 2) = ""
                    '2019/11/01 V01R015 UPD END
                Else
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx, Col + 2) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10))
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx, Col + 2) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10))
                    '2019/11/01 V01R015 UPD END
                End If
            Else
                If .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10) = "" And .Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10) = "" Then
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col + 2) = ""
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col + 2) = ""
                    '2019/11/01 V01R015 UPD END
                Else
                    '2019/11/01 V01R015 UPD START
                    '.Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(12 + Item_idx + 1, Col + 2) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10))
                    .Sheets("|fffd||2433||fffd|i|fffd||fffd|W|fffd||fffd||fffd|j").Cells(13 + Item_idx + 1, Col + 2) = _
                       CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd|d").Cells(RowPos(0, Item_idx) + 1, Col - 10)) - CheckEmptyToDbl(.Sheets("|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|8|fffd|\|fffd|i|fffd|w|fffd||fffd|P|fffd|j_|fffd||fffd||fffd|d").Cells(RowPos(1, Item_idx) + 1, Col - 10))
                    '2019/11/01 V01R015 UPD END
                End If
            End If
        Next
    Next

    Application.Calculation = xlCalculationAutomatic
    End With
    Exit Sub
    
Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|F|fffd||2433||fffd|w|fffd||fffd|1|fffd|]|fffd|L|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Sub
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]22 IR1 20180901 ADD END
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
'----------------------------------------------------------------------------------------------------------------------
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@                 :|fffd||38f||6ce||fffd||fffd||18e||482||242||fffd||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|A|fffd||fffd||fffd||fffd||fffd||109cc||fffd|
' |fffd||512|l|fffd|@|fffd|@|fffd|@                 :|fffd||202||fffd|
' |fffd||fffd||fffd||fffd||fffd|@|fffd|@|fffd|@                 :ws|fffd|@|fffd|@|fffd|@    |fffd|@|fffd||38f||fffd|WorkSheet
'                             Protect       True:|fffd|V|fffd|[|fffd|g|fffd||6cc||c0b7||fffd||fffd|AFalse:|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@                 :|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||209||fffd||fffd||fffd||fffd||18e||482||34a|e|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@                 |fffd||fffd||291||fffd||fffd|z|fffd|d|fffd||fffd||fffd||18e||fffd|
'                             |fffd||fffd||fffd|d|fffd||fffd||fffd||18e||481|i|fffd||fffd||fffd||fffd||293|d|fffd|C|fffd||fffd||fffd||18e||481|j
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@                 |fffd||fffd||fffd||fffd||fffd|d|fffd|C|fffd||fffd||fffd||18e||481|i|fffd||fffd||fffd||fffd||293|d|fffd|C|fffd||fffd||fffd||18e||481|j
'                             |fffd|u|fffd|\|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|p|fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||34f||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||752||fffd|A|fffd||fffd||fffd||752||fffd||30f||a347||fffd||343||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||313||fffd||fffd||342||118c2||fffd||fffd|B
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@                 :|fffd||752||fffd||94|\|fffd||20d||fffd||fffd||682||18f||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|l|fffd||348||209||fffd||fffd||302||182||fffd||fffd||fffd|
'
' |fffd||8414|                       |fffd||38f||fffd|                                                                                                        |fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|l
' DrawingObjects             |fffd|`|fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||6cc||c0b3||fffd||fffd||fffd||fffd||242||341|ATrue |fffd||fffd||fffd|w|fffd||80b5||fffd||702||fffd|                                                         FALSE
' Contents                   |fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||313||fffd||fffd|e|fffd||fffd||6cc||c0b3||fffd||fffd||fffd||fffd||242||341|ATrue |fffd||fffd||fffd|w|fffd||80b5||fffd||702||fffd||fffd|B|fffd||38f||6c2||343||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30f||a347||fffd||343||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|Z|fffd||fffd||fffd||142||fffd|   TRUE
' Scenarios                  |fffd|V|fffd|i|fffd||fffd||fffd|I|fffd||fffd||6cc||c0b7||fffd||fffd||242||341|ATrue |fffd||fffd||fffd|w|fffd||80b5||fffd||702||fffd|                                                                   TRUE
' UserInterfaceOnly          True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||28f||30a9||fffd||fffd||315||3cd|X|fffd||355||6cc||c0b3||fffd||fffd||702||fffd||fffd||fffd||fffd|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||3cd|X|fffd||355||6cc||c0b3||fffd||fffd||702||fffd||fffd||fffd|B                     FALSE
'                            |fffd||fffd||fffd||308||fffd||fffd||fffd||fffd||fffd||fffd||217||fffd||fffd||fffd||fffd||fffd||181|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||28f||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||202||fffd||fffd||202||fffd||702||fffd||fffd|B
' AllowFormattingCells       True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||303|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd|                         FALSE
' AllowFormattingColumns     True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||317||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd|                           FALSE
' AllowFormattingRows        True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd|                           FALSE
' AllowInsertingColumns      True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||257||fffd||fffd|}|fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd|                             FALSE
' AllowInsertingRows         True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||24d|s|fffd||fffd|}|fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||702||fffd|                             FALSE
' AllowDeletingColumns       True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||317||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd|A                               FALSE
'                            |fffd||d3dc||fffd||fffd||fffd||fffd||fffd||fffd||303|Z|fffd||fffd||fffd||342||fffd||fffd||5c2||103||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|
' AllowDeletingRows          True |fffd||fffd||fffd|w|fffd||80b7||fffd||fffd||181|A|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||355||6cc||c0b3||fffd||a0bd||fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd|A                               FALSE
'                            |fffd||d3dc||fffd||fffd||fffd||fffd||fffd|s|fffd||303|Z|fffd||fffd||fffd||342||fffd||fffd||5c2||103||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|
'----------------------------------------------------------------------------------------------------------------------
Public Function ProtectSheet(ws As Worksheet, Protect As Boolean)
Dim ProtectList()   As String
Dim JigyouCode      As String
Dim ProtectFlg      As Long
Dim Row             As Long
Dim i               As Long
Dim Hidden          As Boolean
On Error GoTo Err_Exit

    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    If ws.Name = "|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|" Then
        If Protect Then
            '|fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd||34f||fffd||255||6cc||fffd|
            Workbooks(ThisWorkbook.Name).Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|").Protect Password:=pass, DrawingObjects:=False, Contents:=True, Scenarios:=True, _
               AllowFormattingCells:=True, AllowFormattingColumns:=False, AllowFormattingRows:=False, _
               AllowInsertingColumns:=False, AllowInsertingRows:=False, AllowDeletingColumns:=False, AllowDeletingRows:=False, UserInterfaceOnly:=False
        Else
            '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
            ws.Unprotect Password:=pass
        End If
        Exit Function
    End If

    JigyouCode = ThisWorkbook.Worksheets("|fffd|\|fffd||fffd|").Range("AB18").Value
    If JigyouCode = "" Then
        MsgBox "|fffd|u|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e||fffd||fffd||18e||483|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical
        Exit Function
    End If
    
    If Protect Then
        '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd|z|fffd||fffd||250||752||fffd|
        Row = 3
        Do While Workbooks(ThisWorkbook.Name).Sheets(ProtectListSheetName).Cells(Row, 1) <> ""
            ReDim Preserve ProtectList(Row - 3)
            ProtectList(Row - 3) = Workbooks(ThisWorkbook.Name).Sheets(ProtectListSheetName).Cells(Row, 1)
            Row = Row + 1
        Loop
        ProtectFlg = 1
        For i = LBound(ProtectList()) To UBound(ProtectList())
            If JigyouCode = ProtectList(i) Then
                ProtectFlg = 0
                Exit For
            End If
        Next
        Erase ProtectList
        
        '|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||348||fffd|d|fffd|A|fffd||fffd||fffd||fffd|d|fffd||20a|O =|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd||256||fffd||fffd||fffd||fffd||fffd||fffd||18e||fffd|
        If ProtectFlg = 1 Then
            '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd||fffd||fffd||fffd|
            ThisWorkbook.Unprotect Password:=pass
            Row = 8
            With Workbooks(ThisWorkbook.Name).Sheets(ProtectListSheetName)
            Do While .Cells(Row, 6) <> ""
                If .Cells(Row, 6) = ws.Name Then
                    '|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355|\|fffd||fffd|
                    If Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible <> xlSheetVisible Then
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
                        Hidden = True
                    Else
                        Hidden = False
                    End If
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Activate
                    '|fffd||fffd||fffd||fffd|U|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=pass
                    '|fffd||fffd||fffd||752||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Protect Password:=pass, DrawingObjects:=False, Contents:=True, Scenarios:=True, _
                       AllowFormattingCells:=.Cells(Row, 9), AllowFormattingColumns:=.Cells(Row, 10), AllowFormattingRows:=.Cells(Row, 11), _
                       AllowInsertingColumns:=.Cells(Row, 12), AllowInsertingRows:=.Cells(Row, 13), AllowDeletingColumns:=.Cells(Row, 14), AllowDeletingRows:=.Cells(Row, 15), UserInterfaceOnly:=False
                    '|fffd||fffd||fffd||fffd||fffd||30f||fffd||502||256||7c2||fffd|
                    If Hidden Then
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetHidden
                    Else
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
                    End If
                    Exit Do
                End If
                Row = Row + 1
            Loop
            End With
            '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd|
            ThisWorkbook.Protect Password:=pass
        Else
            '|fffd||fffd||fffd|z|fffd|z|fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||782||24c|W|fffd||70b8||fffd|A|fffd|V|fffd|[|fffd|g|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd||251||fffd||fffd||742||fffd||fffd||9396||fffd||18e||482||30f||a347||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
            ws.Unprotect Password:=pass
            '|fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd||34f||fffd||255||6cc||fffd|
            Workbooks(ThisWorkbook.Name).Worksheets("|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|").Protect Password:=pass, DrawingObjects:=False, Contents:=True, Scenarios:=True, _
               AllowFormattingCells:=True, AllowFormattingColumns:=False, AllowFormattingRows:=False, _
               AllowInsertingColumns:=False, AllowInsertingRows:=False, AllowDeletingColumns:=False, AllowDeletingRows:=False, UserInterfaceOnly:=False
        End If
        '|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|z|fffd|z|fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||782||24c|W|fffd||70b8||fffd|A|fffd|V|fffd|[|fffd|g|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd||251||fffd||fffd||742||fffd||fffd||9396||fffd||18e||482||30f||a347||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||343|V|fffd|[|fffd|g|fffd||6cc||fffd|
        If ws.Name = "|fffd|\|fffd||fffd|" Then
            '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd||fffd||fffd||fffd|
            ThisWorkbook.Unprotect Password:=pass
            Row = 8
            With Workbooks(ThisWorkbook.Name).Sheets(ProtectListSheetName)
            Do While .Cells(Row, 6) <> ""
                If .Cells(Row, 7) = "|fffd||" Then
                    '|fffd||fffd||fffd||38f||6c3|V|fffd|[|fffd|g|fffd||202||fffd|
                Else
                    '|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355|\|fffd||fffd|
                    If Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible <> xlSheetVisible Then
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
                        Hidden = True
                    Else
                        Hidden = False
                    End If
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Activate
                    '|fffd||fffd||fffd||fffd|U|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=pass
                    '|fffd||fffd||fffd||752||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd|U|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
                    Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Protect Password:=pass, DrawingObjects:=False, Contents:=True, Scenarios:=True, _
                       AllowFormattingCells:=.Cells(Row, 9), AllowFormattingColumns:=.Cells(Row, 10), AllowFormattingRows:=.Cells(Row, 11), _
                       AllowInsertingColumns:=.Cells(Row, 12), AllowInsertingRows:=.Cells(Row, 13), AllowDeletingColumns:=.Cells(Row, 14), AllowDeletingRows:=.Cells(Row, 15), UserInterfaceOnly:=False
                    '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|u|fffd||c42c||fffd||83c7||fffd|v|fffd|u|fffd|`|fffd|F|fffd|b|fffd|N|fffd|V|fffd|[|fffd|g|fffd|v|fffd|u|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7||fffd|v|fffd|u|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd|v|fffd|u|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||611||581|v|fffd|u|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||581|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd|S|fffd||102||303|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd|
                    If Not (.Cells(Row, 6) = "|fffd||c42c||fffd||83c7|" Or .Cells(Row, 6) = "|fffd|`|fffd|F|fffd|b|fffd|N|fffd|V|fffd|[|fffd|g" Or .Cells(Row, 6) = "|fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g|fffd||a5d7|" Or .Cells(Row, 6) = "|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||18e||483||fffd||fffd|X|fffd|g" _
                       Or .Cells(Row, 6) = "|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||611||fffd|" Or .Cells(Row, 6) = "|fffd|G|fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||611||fffd|") Then
                        If ProtectFlg <> 1 Then
                            Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=pass
                        End If
                    End If
                    '|fffd||fffd||fffd||fffd||fffd||30f||fffd||502||256||7c2||fffd|
                    If Hidden Then
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetHidden
                    Else
                        Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
                    End If
                End If
                Row = Row + 1
            Loop
            End With
            '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd|
            ThisWorkbook.Protect Password:=pass
        End If
    Else
        '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
        ws.Unprotect Password:=pass
    End If
    Exit Function

Err_Exit:
    MsgBox "|fffd||fffd||fffd||fffd||fffd|FProtectSheet|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number & vbCrLf & "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description, vbCritical
End Function
Sub |fffd|S|fffd|V|fffd|[|fffd|g|fffd||752||fffd|()
Dim Row     As Long
'2019/11/01 V01R015 UPD START
'Dim oldpass    As String
'2019/11/01 V01R015 UPD END
Dim pass    As String
On Error Resume Next

    Application.Calculation = xlCalculationManual
    '|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    '2019/11/01 V01R015 UPD START
    '|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||142||309||fffd||fffd||fffd||fffd||34d||d3dc||fffd||fffd||fffd||fffd|
    '  |fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7cb||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||142||313||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd|V|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||302||742||142||309||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
    'oldpass = "occtokyoukeipass"
    'pass = "20kyoukei19"
    pass = "2020kyoukei"
    '2019/11/01 V01R015 UPD END
    '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd||fffd||fffd||fffd|
    '2019/11/01 V01R015 UPD START
    'ThisWorkbook.Unprotect Password:=oldpass
    ThisWorkbook.Unprotect Password:=pass
    '2019/11/01 V01R015 UPD END
    '|fffd||fffd||fffd|S|fffd||102||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|
    Row = 8
    With Workbooks(ThisWorkbook.Name).Sheets(ProtectListSheetName)
    Do While .Cells(Row, 6) <> ""
        If .Cells(Row, 7) = "|fffd||" Then
            '|fffd||fffd||fffd||38f||6c3|V|fffd|[|fffd|g|fffd||202||fffd|
        Else
            '|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355|\|fffd||fffd|
            If Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible <> xlSheetVisible Then
                Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
            End If
            Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Activate
            '|fffd||fffd||fffd||fffd|U|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
            '2019/11/01 V01R015 UPD START
            'Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=oldpass
            '2019/11/01 V01R015 UPD END
            Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=pass
            '|fffd||fffd||fffd||752||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd|U|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|
            Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Protect Password:=pass, DrawingObjects:=False, Contents:=True, Scenarios:=True, _
               AllowFormattingCells:=.Cells(Row, 9), AllowFormattingColumns:=.Cells(Row, 10), AllowFormattingRows:=.Cells(Row, 11), _
               AllowInsertingColumns:=.Cells(Row, 12), AllowInsertingRows:=.Cells(Row, 13), AllowDeletingColumns:=.Cells(Row, 14), AllowDeletingRows:=.Cells(Row, 15), UserInterfaceOnly:=False

            If .Cells(Row, 8) = "False" Then
                '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd|
                Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Unprotect Password:=pass
            End If
            If .Cells(Row, 7) = "xlSheetVisible" Then
                '|fffd||fffd||fffd|\|fffd||fffd||fffd||30f||a347|
                Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetVisible
            Else
                '|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||30f||a347|
                Workbooks(ThisWorkbook.Name).Worksheets("" & .Cells(Row, 6) & "").Visible = xlSheetHidden
            End If
        End If
        Row = Row + 1
    Loop
    End With
    '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||6cc||fffd|
    ThisWorkbook.Protect Password:=pass
    Application.Calculation = xlCalculationAutomatic
    ThisWorkbook.Save

End Sub
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END

Attribute VB_Name = "KY_3A_0002"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "KY_3A_0003"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "KY_3A_0004"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "KY_3A_0013"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "KY_3A_0014"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Koiki"
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD START Module1|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
Option Explicit
'-----------------------------------------------------------
' <|fffd|T|fffd|u|fffd|V|fffd|X|fffd|e|fffd||fffd|> |fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|^|fffd|p|fffd|x|fffd||fffd||fffd|@|fffd|\
' <|fffd||fffd||fffd||fffd|>         Koiki
' <|fffd|@|fffd|\>         |fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||34f|o|fffd||fffd|
' <|fffd||fffd||fffd|l>         Module1|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
' <|fffd||fffd||fffd||fffd|>         Excel VBA
' <|fffd||fffd||fffd||fffd|>         |fffd||fffd||fffd||fffd||fffd||343|}|fffd|[|fffd|W|fffd|A|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||342||fffd||fffd||302||702||708||690|A
' V01R001 -      2018/09/01  |fffd|V|fffd|K|fffd||c42c|
' V01R002 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 |fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||315||3cd|X
' V01R003 -      2018/09/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||c42c|
' |fffd|@|fffd|@|fffd|@|fffd|@       2018/10/01  SIS(|fffd||fffd||fffd||fffd|)  H31|fffd||fffd||fffd|P|fffd|v|fffd|]34 IR1 |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X
' V01R004 -      2019/11/01  FSI(|fffd||fffd|c)  2019|fffd|N|fffd|x|fffd||fffd||fffd|C 2|fffd|N|fffd|x|fffd||692||1c9||fffd||fffd||389||fffd|
' All Rights Reserved , Copyright (C) 2017, 2018 , Hitachi , Ltd.
'-----------------------------------------------------------
    Public pass As String
Public Sub |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|()
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]34 IR1 20181001 MODIFY START
'    pass = "occtokyoukeipass"
    '2019/11/01 V01R015 UPD START
    'pass = "20kyoukei19"
    pass = "2020kyoukei"
    '2019/11/01 V01R015 UPD END
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]34 IR1 20181001 MODIFY END

End Sub
Sub |fffd|V|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||611||fffd|()

    Dim i As Integer
    Dim |fffd||e3c0||fffd|V|fffd|[|fffd|g|fffd||fffd|, |fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd| As String
        
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    Application.ScreenUpdating = False
    
    |fffd||e3c0||fffd|V|fffd|[|fffd|g|fffd||fffd| = ActiveSheet.Name
    ActiveWorkbook.Unprotect Password:=pass     '|fffd|u|fffd|b|fffd|N|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|

    For i = 1 To 33     '|fffd||fffd||fffd||fffd|
        If Cells(2 + i, 40) <> "" Then
            |fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd| = Cells(2 + i, 40)
            If Cells(3, 2 + i) = 1 Then
                Worksheets(|fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd|).Visible = xlSheetVisible
            Else
                Worksheets(|fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd|).Visible = xlSheetHidden
            End If
            Worksheets(|fffd||e3c0||fffd|V|fffd|[|fffd|g|fffd||fffd|).Activate
        End If
    Next i
    
    For i = 1 To 30     '|fffd||fffd||fffd||fffd|
        If Cells(2 + i, 48) <> "" Then
            |fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd| = Cells(2 + i, 48)
            If Cells(17, 2 + i) = 1 Then
                Worksheets(|fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd|).Visible = xlSheetVisible
            Else
                Worksheets(|fffd|e|fffd|V|fffd|[|fffd|g|fffd||fffd|).Visible = xlSheetHidden
            End If
            Worksheets(|fffd||e3c0||fffd|V|fffd|[|fffd|g|fffd||fffd|).Activate
        End If
    Next i
    
    ActiveWorkbook.Protect Password:=pass     '|fffd|u|fffd|b|fffd|N|fffd||315||6cc||fffd|
    Application.ScreenUpdating = True
    
End Sub
Sub |fffd|s|fffd||1c9||fffd|_|fffd||fffd||fffd||d2815|[|fffd|p()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.DisplayStatusBar = False
    Application.EnableEvents = False
    Application.EnableCancelKey = xlDisabled

    Dim i, j, k As Integer
    Dim Area As String

    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|

    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Area = ActiveSheet.Cells(3, 9)
    j = ActiveSheet.Cells(4, 9)

    If Area = "|fffd|k|fffd|C|fffd||fffd|" Or Area = "|fffd||fffd||fffd|k" Then    '|fffd||1c9||fffd||fffd|s|fffd||311|I|fffd||fffd|
        k = 0
    Else
        k = 3
    End If

    If Area = "" Or j < 1 Then
        MsgBox "|fffd|G|fffd||fffd||fffd|A|fffd||702||fffd||fffd||34d|s|fffd||fffd||fffd||10cc2||fffd||fffd||fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, "|fffd|G|fffd||fffd||fffd|Aor|fffd|s|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|["
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        Exit Sub
        GoTo Err_Exit
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Else
        For i = 1 To 5000
            If ActiveSheet.Cells(24 + i, 6) = Area Then      '|fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||30d||14f||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                If j > ActiveSheet.Cells(24 + i, 2) Then j = ActiveSheet.Cells(24 + i, 2)
                i = 27 + i
                Exit For
            End If
        Next i
        ActiveSheet.Rows(6 + k & ":" & 8 + k).Select        '|fffd|P|fffd|i|fffd|i|fffd|R|fffd|s|fffd|j|fffd||fffd||fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||111|}|fffd||fffd|
        Selection.Copy
        ActiveSheet.Rows(i + (j - 1) * 3).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Rows(i + (j - 1) * 3 & ":" & i + (j - 1) * 3 + 2).Hidden = False    '|fffd|s|fffd||30d||115|\|fffd||fffd|
        ActiveSheet.Cells(i + (j - 1) * 3, 4) = Area
        ActiveSheet.Cells(i + (j - 1) * 3, 9) = Area
    End If
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
Err_Exit:
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END

    Application.EnableCancelKey = xlInterrupt
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    Application.EnableEvents = True
End Sub
Sub |fffd|s|fffd||d3dc|_|fffd||fffd||fffd||d2815|[|fffd|p()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.DisplayStatusBar = False
    Application.EnableEvents = False
    Application.EnableCancelKey = xlDisabled

    Dim i, j, |fffd|{|fffd|^|fffd||fffd| As Integer
    Dim Area As String

    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|

    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Area = ActiveSheet.Cells(3, 9)
    j = ActiveSheet.Cells(4, 9)

    If Area = "" Or j < 1 Then
        MsgBox "|fffd|G|fffd||fffd||fffd|A|fffd||702||fffd||fffd||34d|s|fffd||fffd||fffd||10cc2||fffd||fffd||fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, "|fffd|G|fffd||fffd||fffd|Aor|fffd|s|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|["
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        Exit Sub
        GoTo Err_Exit
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Else
        For i = 1 To 5000
            If ActiveSheet.Cells(24 + i, 6) = Area Then      '|fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||30d||14f||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                If j > ActiveSheet.Cells(24 + i, 2) - 1 Then j = ActiveSheet.Cells(24 + i, 2) - 1
                i = 27 + i
                Exit For
            End If
        Next i
        If j <> 0 Then
            |fffd|{|fffd|^|fffd||fffd| = MsgBox(j & "|fffd|s|fffd||682||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B", vbOKCancel + vbExclamation, "|fffd|s|fffd||d3dc||fffd|m|fffd|F")
            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'            If |fffd|{|fffd|^|fffd||fffd| = vbCancel Then Exit Sub
            If |fffd|{|fffd|^|fffd||fffd| = vbCancel Then GoTo Err_Exit
            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
            ActiveSheet.Rows(i + (j - 1) * 3 & ":" & i + (j - 1) * 3 + 2).Select
            Selection.Delete Shift:=xlUp
        End If
    End If
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
Err_Exit:
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END

    Application.EnableCancelKey = xlInterrupt
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    Application.EnableEvents = True
End Sub
Sub |fffd|s|fffd||1c9||fffd|_|fffd|G|fffd||fffd||fffd|A|fffd|O|fffd||fffd||fffd|[|fffd|p()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.DisplayStatusBar = False
    Application.EnableEvents = False
    Application.EnableCancelKey = xlDisabled
    
    Dim i As Integer
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    i = Cells(3, 6)
        
    If i < 1 Then
        MsgBox "|fffd|s|fffd||fffd||fffd||10cc2||fffd||fffd||fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, "|fffd|s|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|["
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        Exit Sub
        GoTo Err_Exit
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Else
        If i > Cells(571, 1) Then i = Cells(571, 1)
    End If
    
    Rows(6 & ":" & 8).Select        '|fffd|P|fffd|i|fffd|i|fffd|R|fffd|s|fffd|j|fffd||fffd||fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||111|}|fffd||fffd|
    Selection.Copy
    Rows(574 + (i - 1) * 3).Select
    Selection.Insert Shift:=xlDown
    Rows(574 + (i - 1) * 3 & ":" & 574 + (i - 1) * 3 + 2).Hidden = False    '|fffd|s|fffd||30d||115|\|fffd||fffd|

'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
Err_Exit:
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    
    Application.EnableCancelKey = xlInterrupt
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    Application.EnableEvents = True

End Sub
Sub |fffd|s|fffd||d3dc|_|fffd|G|fffd||fffd||fffd|A|fffd|O|fffd||fffd||fffd|[|fffd|p()

    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.DisplayStatusBar = False
    Application.EnableEvents = False
    Application.EnableCancelKey = xlDisabled

    Dim i, |fffd|{|fffd|^|fffd||fffd| As Integer
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    i = Cells(3, 6)
    
    If i < 1 Then
        MsgBox "|fffd|s|fffd||fffd||fffd||10cc2||fffd||fffd||fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, "|fffd|s|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|["
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        Exit Sub
        GoTo Err_Exit
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    Else
        If i > Cells(571, 1) - 1 Then i = Cells(571, 1) - 1
        If i <> 0 Then
            |fffd|{|fffd|^|fffd||fffd| = MsgBox(i & "|fffd|s|fffd||682||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B", vbOKCancel + vbExclamation, "|fffd|s|fffd||d3dc||fffd|m|fffd|F")
            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'            If |fffd|{|fffd|^|fffd||fffd| = vbCancel Then Exit Sub
            If |fffd|{|fffd|^|fffd||fffd| = vbCancel Then GoTo Err_Exit
            'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
            Rows(574 + (i - 1) * 3 & ":" & 574 + (i - 1) * 3 + 2).Select
            Selection.Delete Shift:=xlUp
        End If
    End If
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD START
Err_Exit:
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 ADD END
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    
    Application.EnableCancelKey = xlInterrupt
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.DisplayStatusBar = True
    Application.EnableEvents = True

End Sub
Sub |fffd|s|fffd||1c9||fffd|_|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|5_6|fffd|\|fffd|p()

    Dim i As Integer
    Dim |fffd||656a| As String
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    |fffd||656a| = Cells(3, 5)
    If |fffd||656a| = "|fffd|H|fffd||fffd||fffd||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 2 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                Exit For
            End If
        Next i
        Rows(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Cells(i, 1) = 1                     '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd||656a||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|L|fffd||681|i|fffd|H|fffd||fffd||fffd||fffd||fffd|F1|fffd|A|fffd||fffd||fffd|H|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F2|fffd|A|fffd||fffd||fffd||311||fffd||fffd|F3|fffd|j
    ElseIf |fffd||656a| = "|fffd||fffd||fffd|H|fffd||fffd||fffd||fffd||fffd||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 3 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                Exit For
            End If
        Next i
        Rows(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Cells(i, 1) = 2                     '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd||656a||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|L|fffd||681|i|fffd|H|fffd||fffd||fffd||fffd||fffd|F1|fffd|A|fffd||fffd||fffd|H|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F2|fffd|A|fffd||fffd||fffd||311||fffd||fffd|F3|fffd|j
    ElseIf |fffd||656a| = "|fffd||fffd||fffd||311||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 4 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                Exit For
            End If
        Next i
        Rows(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Cells(i, 1) = 3                     '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd||656a||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|L|fffd||681|i|fffd|H|fffd||fffd||fffd||fffd||fffd|F1|fffd|A|fffd||fffd||fffd|H|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F2|fffd|A|fffd||fffd||fffd||311||fffd||fffd|F3|fffd|j
    End If
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END

End Sub
Sub |fffd|s|fffd||d3dc|_|fffd|l|fffd||fffd||fffd||fffd|32|fffd||fffd|5_6|fffd|\|fffd|p()

    Dim i, j As Integer
    Dim |fffd||656a| As String
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    |fffd||656a| = Cells(3, 5)
    If |fffd||656a| = "|fffd|H|fffd||fffd||fffd||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 2 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(j, 1) = 1 Then Rows(i).Delete      '|fffd||152||fffd|Q|fffd|s|fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    ElseIf |fffd||656a| = "|fffd||fffd||fffd|H|fffd||fffd||fffd||fffd||fffd||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 3 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(j, 1) = 2 Then Rows(i).Delete      '|fffd||152||fffd|Q|fffd|s|fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    ElseIf |fffd||656a| = "|fffd||fffd||fffd||311||fffd|" Then
        For i = 1 To 100
            If Cells(9 + i, 1) = 4 Then     '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 8 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(j, 1) = 3 Then Rows(i).Delete      '|fffd||152||fffd|Q|fffd|s|fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    End If
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END

End Sub
Sub |fffd|y|fffd|[|fffd|W|fffd|\|fffd||fffd||fffd||611||fffd|_|fffd|l|fffd||fffd||fffd||fffd|33_2|fffd|p()

    Dim i As Integer
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    i = Cells(3, 8)
    Rows.Hidden = False                     '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveSheet.PageSetup.PrintArea = Range(Cells(5, 2), Cells(78 + (i - 1) * 74, 16)).Address   '|fffd||fffd||fffd||fffd||348||342||310||752||fffd|
    If i = 1 Then
        Rows("79:226").Hidden = True        '1|fffd|y|fffd|[|fffd|W|fffd||682||fffd||fffd||fffd||fffd|\|fffd||fffd|
    ElseIf i = 2 Then
        Rows("153:226").Hidden = True       '1,2|fffd|y|fffd|[|fffd|W|fffd||682||fffd||fffd||fffd||fffd|\|fffd||fffd|
    End If
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    
End Sub
Sub |fffd||fffd||1c9||fffd|_|fffd|l|fffd||fffd||fffd||fffd|35|fffd||fffd|2|fffd|\|fffd|p()

    Dim i As Integer
    Dim |fffd|R|fffd||115||fffd||fffd||fffd| As String
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    |fffd|R|fffd||115||fffd||fffd||fffd| = Cells(3, 6)
    If |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd||392|Y|fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 2 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                Exit For
            End If
        Next i
        Columns(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Range(Cells(38, i - 1), Cells(66, i - 1)).Copy  '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||454|R|fffd||fffd||fffd||fffd||fffd|M|fffd||28c|v|fffd|Z|fffd||fffd||fffd|L|fffd||681|i|fffd||392|Y|fffd|n|fffd|F1|fffd|A|fffd|k|fffd|m|fffd|f|fffd|n|fffd|F2|fffd|A|fffd||396||fffd||fffd|n|fffd|F3|fffd|j
        ActiveSheet.Paste Range(Cells(38, i), Cells(66, i))
    ElseIf |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd|k|fffd|m|fffd|f|fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 3 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                Exit For
            End If
        Next i
        Columns(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Range(Cells(38, i - 1), Cells(66, i - 1)).Copy  '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||454|R|fffd||fffd||fffd||fffd||fffd|M|fffd||28c|v|fffd|Z|fffd||fffd||fffd|L|fffd||681|i|fffd||392|Y|fffd|n|fffd|F1|fffd|A|fffd|k|fffd|m|fffd|f|fffd|n|fffd|F2|fffd|A|fffd||396||fffd||fffd|n|fffd|F3|fffd|j
        ActiveSheet.Paste Range(Cells(38, i), Cells(66, i))
    ElseIf |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd||396||fffd||fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 4 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                Exit For
            End If
        Next i
        Columns(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Range(Cells(38, i - 1), Cells(66, i - 1)).Copy  '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||454|R|fffd||fffd||fffd||fffd||fffd|M|fffd||28c|v|fffd|Z|fffd||fffd||fffd||fffd||fffd|L|fffd||681|i|fffd||392|Y|fffd|n|fffd|F1|fffd|A|fffd|k|fffd|m|fffd|f|fffd|n|fffd|F2|fffd|A|fffd||396||fffd||fffd|n|fffd|F3|fffd|j
        ActiveSheet.Paste Range(Cells(38, i), Cells(66, i))
    End If
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END

End Sub
Sub |fffd||fffd||d3dc|_|fffd|l|fffd||fffd||fffd||fffd|35|fffd||fffd|2|fffd|\|fffd|p()

    Dim i, j As Integer
    Dim |fffd|R|fffd||115||fffd||fffd||fffd| As String
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
    'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    Call ProtectSheet(ActiveSheet, False)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    |fffd|R|fffd||115||fffd||fffd||fffd| = Cells(3, 6)
    If |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd||392|Y|fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 2 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(50, j) = 1 Then Columns(i).Delete      '|fffd||152||fffd|Q|fffd||fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    ElseIf |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd|k|fffd|m|fffd|f|fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 3 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(50, j) = 2 Then Columns(i).Delete      '|fffd||152||fffd|Q|fffd||fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    ElseIf |fffd|R|fffd||115||fffd||fffd||fffd| = "|fffd||396||fffd||fffd|n" Then
        For i = 1 To 100
            If Cells(50, 5 + i) = 4 Then   '|fffd||656a||fffd||fffd||fffd||30d||149|E|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 3 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(50, j) = 3 Then Columns(i).Delete      '|fffd||152||fffd|Q|fffd||fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
    End If
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'    ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
    Call ProtectSheet(ActiveSheet, True)
    'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    
End Sub
Sub |fffd|s|fffd||1c9||fffd|_|fffd|l|fffd||fffd|38_3|fffd|p()

    Dim i As Integer
    Dim |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| As Integer
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    If Cells(3, 6) <> "" Then
        |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| = Cells(3, 6)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
        'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        Call ProtectSheet(ActiveSheet, False)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
        
        For i = 1 To 100
            If Cells(8 + i, 1) = |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| + 1 Then    '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 6 + i
                Exit For
            End If
        Next i
        Rows(i).Insert copyorigin:=xlFormatFromLeftOrAbove
        Cells(i, 1) = |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd|                        '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd|A|fffd|n|fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|L|fffd||fffd|
'        Cells(i, 15) = "|fffd||fffd||fffd||fffd|"                           '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A9|fffd|N|fffd|x|fffd||316||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
'        Cells(i, 16) = "|fffd||fffd||fffd||fffd|"                           '|fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||742||303|R|fffd|s|fffd|[|fffd|}|fffd||fffd||fffd||302||fffd||fffd||7c1|A10|fffd|N|fffd|x|fffd||316||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
        Call ProtectSheet(ActiveSheet, True)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    End If
    
End Sub
Sub |fffd|s|fffd||d3dc|_|fffd|l|fffd||fffd|38_3|fffd|p()

    Dim i, j As Integer
    Dim |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| As Integer
    
    Call |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    
    If Cells(3, 6) <> "" Then
        |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| = Cells(3, 6)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
        'ActiveSheet.Unprotect Password:=pass     '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        Call ProtectSheet(ActiveSheet, False)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
            
        For i = 1 To 100
            If Cells(8 + i, 1) = |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| + 1 Then    '|fffd||656a||fffd||fffd||fffd||30d||149||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|
                i = 6 + i
                j = i - 2
                Exit For
            End If
        Next i
        If Cells(j, 1) = |fffd|A|fffd|n|fffd||fffd||fffd||50d||fffd| Then Rows(i).Delete      '|fffd||152||fffd|Q|fffd|s|fffd||34e|c|fffd||fffd||fffd||fffd||fffd||7c2||30f||fffd||fffd||fffd|
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY START
'        ActiveSheet.Protect Password:=pass, DrawingObjects:=False, AllowFormattingCells:=True, AllowFormattingRows:=True   '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||315||48f|W|fffd|E|fffd|Z|fffd||fffd||fffd|A|fffd|s|fffd||30f||fffd||fffd||fffd||fffd||752||fffd||34b||fffd||fffd||81|j
        Call ProtectSheet(ActiveSheet, True)
        'H31|fffd||fffd||fffd|P|fffd|v|fffd|]4 IR1 20180901 MODIFY END
    End If
    
End Sub
'H31|fffd||fffd||fffd|P|fffd|v|fffd|]27 IR1 20180901 ADD END Module1|fffd||30a||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||690|A
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet56"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet57"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet58"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet59"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet70"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet77"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
