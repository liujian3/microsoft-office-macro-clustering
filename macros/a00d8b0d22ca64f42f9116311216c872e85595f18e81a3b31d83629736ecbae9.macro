Attribute VB_Name = "Datenabgleich"
Option Explicit
Option Private Module

Sub MediCopy()
'Application.EnableEvents = 0
PW_Set

Sheets("Medikationsplan").Unprotect Password:=PW


Sheets("ATHINA-Bogen").Range("L18:R37").Copy
Sheets("Medikationsplan").Range("F10").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

Sheets("ATHINA-Bogen").Range("G18:G37").Copy
Sheets("Medikationsplan").Range("B10").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

Sheets("ATHINA-Bogen").Range("F18:F37").Copy
Sheets("Medikationsplan").Range("C10").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

Sheets("ATHINA-Bogen").Range("H18:i37").Copy
Sheets("Medikationsplan").Range("D10").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


'Application.CutCopyMode = False

'Sheets("Medikationsplan").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True
'Application.EnableEvents = 1
Application.CutCopyMode = False
End Sub
Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim i, Antwort

Private Sub Workbook_BeforeClose(Cancel As Boolean)


Antwort = MsgBox("Sollen Ver|fffd|nderungen in " & ActiveWorkbook.Name & " gespeichert werden?", vbYesNoCancel, "Athina-Bogen schlie|fffd|en...")

If Antwort = 6 Then
    
    'Bl|fffd|tter verstecken
    Sicherheit_setzen

    'Ereignisse deaktivieren
    Application.EnableEvents = False
    ThisWorkbook.Save
    Application.EnableEvents = True
End If

If Antwort = 7 Then
    Me.Saved = True
End If

If Antwort = 2 Then 'Abbrechen
    Cancel = True
End If

Ende:
Application.EnableEvents = True

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

On Error GoTo Errorhandler


'Bl|fffd|tter verstecken
Sicherheit_setzen

'Ereignisse deaktivieren
Application.ScreenUpdating = 1
Application.EnableEvents = False

If SaveAsUI = True Then
    '>>speichern unter<< wurde gew|fffd|hlt
    Application.Dialogs(xlDialogSaveAs).Show
Else
    '>>speichern wurde gew|fffd|hlt<<
    ThisWorkbook.Save
End If


'Bl|fffd|tter wieder einblenden
Sicherheit_aufheben

Application.ScreenUpdating = True

'Speichern aufgrund Workbook_beforeSave-Ereignis zur|fffd|cksetzen
Cancel = True

'Ereignisse wieder aktivieren
Application.EnableEvents = True
Exit Sub

Errorhandler:
'Antwort = MsgBox("Es ist ein Fehler im Makro aufgetreten! Bitte pr|fffd|fen Sie die Eingabe.", vbCritical, "Hoppla!")
Sicherheit_aufheben

Application.ScreenUpdating = True
Application.EnableEvents = True



End Sub

Private Sub Workbook_Open()
PW_Set
Sicherheit_aufheben

End Sub
Private Sub Sicherheit_setzen()

Application.ScreenUpdating = False


'Namen des aktiven Blatts ablegen
Schutz_aufheben
If ActiveSheet.Name <> "Dropdown Felder" And ActiveSheet.Name <> "Score" And ActiveSheet.Name <> "Datenexport" Then
    Sheets("Dropdown Felder").Cells(100, 100) = ActiveSheet.Name
Else
    Sheets("Dropdown Felder").Cells(100, 100) = "ATHINA-Bogen"
End If
Schutz_setzen
  

'alle relevanten Bl|fffd|tter unsichtbar machen

Application.EnableEvents = 0
Sheets("Willkommen").Visible = -1

Sheets("Angaben").Visible = 0
Sheets("ATHINA-Bogen").Visible = 0
If Sheets("Dropdown Felder").Visible <> 0 Then Sheets("Dropdown Felder").Visible = 0
Sheets("Medikationsplan").Visible = 0
If Sheets("Score").Visible <> 0 Then Sheets("Score").Visible = 0
If Sheets("Datenexport").Visible <> 0 Then Sheets("Datenexport").Visible = 0
Sheets("Hilfe").Visible = 0
Sheets("Bericht Medikationsanalyse").Visible = 0
Sheets("Patientenangaben").Visible = 0

Application.EnableEvents = 1
End Sub

Private Sub Sicherheit_aufheben()


Application.ScreenUpdating = False


'alle relevanten Bl|fffd|tter sichtbar machen
Sheets("Angaben").Visible = -1
Sheets("ATHINA-Bogen").Visible = -1
'Sheets("Dropdown Felder").Visible = -1
Sheets("Medikationsplan").Visible = -1
'Sheets("Score").Visible = -1
Sheets("Hilfe").Visible = -1
Sheets("Bericht Medikationsanalyse").Visible = -1
Sheets("Patientenangaben").Visible = -1

Sheets("Willkommen").Visible = 2

'Sheets("Angaben").CommandButton3.BackColor = 25855
'Sheets("Angaben").CommandButton3.Caption = "'Auswertung' einblenden"
'
'Sheets("Angaben").CommandButton4.BackColor = 25855
'Sheets("Angaben").CommandButton4.Caption = "'Dropdown Felder' einblenden"
'
'Sheets("Angaben").CommandButton5.BackColor = 25855
'Sheets("Angaben").CommandButton5.Caption = "'Score' einblenden"








Sheets(Format(Sheets("Dropdown Felder").Cells(100, 100))).Select


Application.ScreenUpdating = True

End Sub



Attribute VB_Name = "Mailversand"
Option Explicit
Option Private Module
Dim Dateiname$, Dateiname2$, Stadt, Apotheke, Bogennr, Name$, Nachname$
Public mail$, Antwort
Dim Nachricht(4) As String

Dim FileExtStr As String
Dim FileFormatNum As Long
Dim wb1 As Workbook
Dim Sourcewb As Workbook
Dim Destwb As Workbook
Dim TempFilePath As String
Dim TempFileName As String
Dim OutApp As Object
Dim OutMail As Object




Sub Mit_Outlook_verschicken()  'gesamte Athina-Mappe verschicken

On Error GoTo Errorhandler

Name$ = Sheets("Angaben").Cells(14, 2)
Nachname$ = Sheets("Angaben").Cells(14, 3)

'funktioniert mit Office 2000-2010
Antwort = MsgBox("F|fffd|r den ordnungsgem|fffd||fffd|en Versand der Datei stellen Sie bitte sicher, dass Outlook gestartet ist. Ansonsten wird die Mail unter Umst|fffd|nden nicht sofort versendet, sondern in den Outlook Postausgang gelegt. Der Versand erfolgt dann beim n|fffd|chsten Start von Outlook.", vbOKCancel, "Bitte sorgf|fffd|ltig lesen ;-)")
If Antwort = 2 Then Exit Sub

With Application
    .ScreenUpdating = False
    .EnableEvents = False
End With
mail$ = Sheets("Angaben").Cells(5, 10)
Stadt = Sheets("Angaben").Cells(7, 3)
Apotheke = Sheets("Angaben").Cells(5, 3)
Bogennr = Sheets("ATHINA-Bogen").Cells(4, 7)

If UCase(Sheets("Angaben").Cells(21, 3)) = "NEIN" Or Sheets("Angaben").Cells(21, 3) = "" Then
    Dateiname$ = Apotheke & " " & Stadt & " " & Bogennr
Else
    Dateiname$ = "Studie_" & Apotheke & " " & Stadt & " " & Bogennr
End If


Set wb1 = ActiveWorkbook

'Sichern der neuen Mappe/ versenden/ l|fffd|schen
TempFilePath = Environ$("temp") & "\"
FileExtStr = "." & LCase(Right(wb1.Name, Len(wb1.Name) - InStrRev(wb1.Name, ".", , 1)))
TempFileName = Dateiname$ & FileExtStr

'Namen l|fffd|schen
Sheets("Angaben").Cells(14, 2) = ""
Sheets("Angaben").Cells(14, 3) = ""

wb1.SaveCopyAs TempFilePath & TempFileName




Set OutApp = CreateObject("Outlook.Application")
Set OutMail = OutApp.CreateItem(0)

On Error Resume Next
With OutMail
    .To = mail$
    .CC = ""
    .BCC = ""
    .Subject = Dateiname$
    .Body = ""
    .Attachments.Add TempFilePath & TempFileName
    .display
    '.Send   'or use .Display
End With

'l|fffd|schen der gesendeten Datei
Kill TempFilePath & TempFileName

Set OutMail = Nothing
Set OutApp = Nothing

Sheets("Angaben").Cells(14, 2) = Name$
Sheets("Angaben").Cells(14, 3) = Nachname$




With Application
    .ScreenUpdating = True
    .EnableEvents = True
End With
Exit Sub


Errorhandler:
Antwort = MsgBox("Es ist ein Fehler im Makro aufgetreten! Bitte pr|fffd|fen Sie die Eingabe.", vbCritical, "Hoppla!")

Application.EnableEvents = 1
Application.ScreenUpdating = 1

End Sub

Sub Ohne_Outlook_verschicken() 'gesamte Athina-Mappe verschicken

On Error GoTo Errorhandler

Name$ = Sheets("Angaben").Cells(14, 2)
Nachname$ = Sheets("Angaben").Cells(14, 3)
Nachricht(1) = ""
Nachricht(2) = ""
Nachricht(3) = ""
Nachricht(4) = ""



'funktioniert mit Office 2000-2010
With Application
    .ScreenUpdating = False
    .EnableEvents = False
End With
mail$ = Sheets("Angaben").Cells(5, 10)
Stadt = Sheets("Angaben").Cells(7, 3)
Apotheke = Sheets("Angaben").Cells(5, 3)
Bogennr = Sheets("ATHINA-Bogen").Cells(4, 7)

If UCase(Sheets("Angaben").Cells(21, 3)) = "NEIN" Or Sheets("Angaben").Cells(21, 3) = "" Then
    Dateiname$ = Apotheke & " " & Stadt & " " & Bogennr
Else
    Dateiname$ = "Studie_" & Apotheke & " " & Stadt & " " & Bogennr
End If



Set wb1 = ActiveWorkbook

'Sichern der neuen Mappe/ versenden/ l|fffd|schen
TempFilePath = ActiveWorkbook.Path & "\"
FileExtStr = "." & LCase(Right(wb1.Name, Len(wb1.Name) - InStrRev(wb1.Name, ".", , 1)))
TempFileName = Dateiname$ & " - zum Verschicken" & FileExtStr

'Namen l|fffd|schen
Sheets("Angaben").Cells(14, 2) = ""
Sheets("Angaben").Cells(14, 3) = ""

wb1.SaveCopyAs TempFilePath & TempFileName

Sheets("Angaben").Cells(14, 2) = Name$
Sheets("Angaben").Cells(14, 3) = Nachname$




With Application
    .ScreenUpdating = True
    .EnableEvents = True
End With

Nachricht(1) = "Die Datei wurde anonymisiert unter dem Namen" & vbCrLf & vbCrLf & "'" & Dateiname$ & " - zum Verschicken'" & FileExtStr & vbCrLf & vbCrLf
Nachricht(2) = "im gleichen Verzeichnis wie die Originaldatei gespeichert." & vbCrLf
Nachricht(3) = "Bitte schicken Sie diese Datei mit Ihrem Mailprogramm an die Adresse:" & vbCrLf & vbCrLf & mail$ & vbCrLf & vbCrLf
Nachricht(4) = "Nach erfolgreichem Versand sollten Sie die anonymisierte Datei l|fffd|schen."
Antwort = MsgBox(Nachricht(1) & Nachricht(2) & Nachricht(3) & Nachricht(4), vbOKOnly, "Bitte beachten!")
Exit Sub


Errorhandler:
Antwort = MsgBox("Es ist ein Fehler im Makro aufgetreten! Bitte pr|fffd|fen Sie die Eingabe.", vbCritical, "Hoppla!")

Application.EnableEvents = 1
Application.ScreenUpdating = 1


End Sub




Attribute VB_Name = "Modul1"
Sub RGBAnzeige()
Attribute RGBAnzeige.VB_Description = "schutz aufheben"
Attribute RGBAnzeige.VB_ProcData.VB_Invoke_Func = " \n14"
    Dim Rot As Long, Gr|fffd|n As Long, Blau As Long, Wert As Long
    Dim Indexwert As Long
     Wert = ActiveCell.Interior.Color
       If ActiveCell.Interior.ColorIndex = xlNone Then
         Indexwert = 0
       Else
         Indexwert = ActiveCell.Interior.ColorIndex
       End If
     On Error Resume Next
    Rot = Wert Mod 256
    Wert = (Wert - Rot) / 256
    Gr|fffd|n = Wert Mod 256
    Wert = (Wert - Gr|fffd|n) / 256
    Blau = Wert Mod 256
      MsgBox "Rot   " & Rot & vbLf & "Gr|fffd|n     " & Gr|fffd|n & vbLf _
        & "Blau              " & Blau & vbLf & vbLf & "Index= " & _
       Indexwert, vbInformation, "Farbwerte"
End Sub


Sub aufheben()
Attribute aufheben.VB_ProcData.VB_Invoke_Func = "A\n14"
Schutz_aufheben
End Sub

Sub setzen()
Attribute setzen.VB_ProcData.VB_Invoke_Func = "S\n14"
Schutz_setzen
End Sub
Attribute VB_Name = "Modul2"
Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro
'

'
    Range("G45:K45").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    ActiveSheet.EnableSelection = xlUnlockedCells
End Sub
Sub Makro2()
Attribute Makro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro2 Makro
'

'
    ActiveSheet.Unprotect
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
End Sub

Sub Makro4()
Attribute Makro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro4 Makro
'

'
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:= _
        False
    ActiveSheet.EnableSelection = xlNoRestrictions
End Sub
Attribute VB_Name = "Security"
Option Explicit
Option Private Module
Global PW


Sub Schutz_setzen()
PW_Set
    
Sheets("ATHINA-Bogen").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Medikationsplan").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Angaben").Protect Password:=PW, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Dropdown Felder").Protect Password:=PW, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Score").Protect Password:=PW, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Hilfe").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Bericht Medikationsanalyse").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True
        ActiveSheet.EnableSelection = xlNoRestrictions

Sheets("Patientenangaben").Protect Password:=PW, DrawingObjects:=True, Contents:=True, Scenarios:= _
    False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True

Sheets("Patientenangaben Heim").Protect Password:=PW, DrawingObjects:=True, Contents:=True, Scenarios:= _
    False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True



End Sub


Sub Schutz_aufheben()
PW_Set
Application.ScreenUpdating = 0

Sheets("ATHINA-Bogen").Unprotect Password:=PW
Sheets("Medikationsplan").Unprotect Password:=PW
Sheets("Angaben").Unprotect Password:=PW
Sheets("Dropdown Felder").Unprotect Password:=PW
Sheets("Score").Unprotect Password:=PW
Sheets("Hilfe").Unprotect Password:=PW
Sheets("Bericht Medikationsanalyse").Unprotect Password:=PW
Sheets("Patientenangaben").Unprotect Password:=PW
Sheets("Patientenangaben Heim").Unprotect Password:=PW

Application.ScreenUpdating = 1
End Sub

Sub PW_Set()
PW = "@thina"
End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 3, 1, MSForms, CommandButton"
Option Explicit
Dim Fall(3), Check(3)

Private Sub CommandButton1_Click()
Mit_Outlook_verschicken
End Sub

Private Sub CommandButton2_Click()
Ohne_Outlook_verschicken
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

'GoTo Markus

If Target.Column = 6 Then
    Application.EnableEvents = False
    Check(1) = 0
    Check(2) = 0
    Check(3) = 0
    
        
    If Target.Row = 21 Or Target.Row = 25 Or Target.Row = 29 Then
        If UCase(Cells(21, 6)) = "JA" Then Fall(1) = 1 Else Fall(1) = 0
        If UCase(Cells(25, 6)) = "JA" Then Fall(2) = 1 Else Fall(2) = 0
        If UCase(Cells(29, 6)) = "JA" Then Fall(3) = 1 Else Fall(3) = 0
        If UCase(Target.Value) <> "JA" And Fall(1) = 0 And Fall(2) = 0 And Fall(3) = 0 Then
            'Ja wurde gel|fffd|scht oder durch nein ersetzt -> wird wieder eingetragen, keine |fffd|nderung an den Tabellen
            Cells(Target.Row, 6) = "ja"
            GoTo Ende
        End If
        If UCase(Target.Value) <> "JA" And Fall(1) + Fall(2) + Fall(3) > 0 Then
            'nein wurde gel|fffd|scht oder durch nein ersetzt -> wird wieder eingetragen, keine |fffd|nderung an den Tabellen
            Cells(Target.Row, 6) = "nein"
            GoTo Ende
        End If
        
        If Target.Row = 21 Then Check(1) = 1
        If Target.Row = 25 Then Check(2) = 1
        If Target.Row = 29 Then Check(3) = 1
    
        'ATHINA normal
        If Check(1) = 1 Then
            Cells(25, 6) = "nein"
            Cells(29, 6) = "nein"
            Sheets("ATHINA-Bogen").Columns("AQ:AW").EntireColumn.Hidden = True
            Sheets("ATHINA-Bogen").Columns("S:AL").EntireColumn.Hidden = False
        End If
        
        'ATHINA mit Follow Up
        If Check(2) = 1 Then
            Cells(21, 6) = "nein"
            Cells(29, 6) = "nein"
            Sheets("ATHINA-Bogen").Columns("AQ:AW").EntireColumn.Hidden = False
            Sheets("ATHINA-Bogen").Columns("S:AL").EntireColumn.Hidden = False
        End If
        
        'Kurzbogen
        If Check(3) = 1 Then
            Cells(21, 6) = "nein"
            Cells(25, 6) = "nein"
            Sheets("ATHINA-Bogen").Columns("AQ:AW").EntireColumn.Hidden = True
            Sheets("ATHINA-Bogen").Columns("S:AL").EntireColumn.Hidden = True
        End If
   End If
     
        'Patientenangaben Heim einblenden
    If Target.Row = 36 Then
        If UCase(Cells(36, 6)) = "JA" Then Sheets("Patientenangaben Heim").Visible = True
        If UCase(Cells(36, 6)) <> "JA" Then Sheets("Patientenangaben Heim").Visible = False
    End If


End If

Ende:
Application.EnableEvents = True

End Sub

Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit
Dim Zeile, Spalte, Breite, Tiefe, Antwort
Dim Check(15) As String, Nachricht(6) As String, Ausgabe(5) As String, i, x, y, Meldung, Short



Private Sub Pruefung()

Application.ScreenUpdating = False


Meldung = 0
Ausgabe(1) = ""
Ausgabe(2) = ""
Ausgabe(3) = ""
Ausgabe(4) = ""
Short = ""

'Check, ob alle Daten korrekt eingegeben sind

'Pr|fffd|fung auf Short-Version
If UCase(Sheets("Angaben").Cells(29, 6)) = "JA" Then Short = 1 Else Short = 0


If Short = 0 Then
    'Einsch|fffd|tzung
    Nachricht(3) = ""
    For i = 1 To 20
        If UCase(Cells(17 + i, 19)) = "X" And UCase(Cells(17 + i, 23)) <> "X" Then
            If UCase(Cells(17 + i, 36)) <> "X" And UCase(Cells(17 + i, 37)) <> "X" And UCase(Cells(17 + i, 38)) <> "X" Then Nachricht(3) = Nachricht(3) & Format(17 + i) & vbCrLf
        End If
        
        If UCase(Cells(17 + i, 19)) <> "X" And UCase(Cells(17 + i, 23)) = "X" Then
            If UCase(Cells(17 + i, 36)) <> "X" And UCase(Cells(17 + i, 37)) <> "X" And UCase(Cells(17 + i, 38)) <> "X" Then Nachricht(3) = Nachricht(3) & Format(17 + i) & vbCrLf
        End If
        
        If UCase(Cells(17 + i, 19)) <> "X" And UCase(Cells(17 + i, 23)) <> "X" And Cells(17 + i, 6) <> "" Then
            If UCase(Cells(17 + i, 36)) <> "X" And UCase(Cells(17 + i, 37)) <> "X" And UCase(Cells(17 + i, 38)) <> "X" Then Nachricht(3) = Nachricht(3) & Format(17 + i) & vbCrLf
        End If
    
        If UCase(Cells(17 + i, 19)) = "X" And UCase(Cells(17 + i, 23)) = "X" And Cells(17 + i, 6) <> "" Then
            If UCase(Cells(17 + i, 35)) <> "X" Then Nachricht(3) = Nachricht(3) & Format(17 + i) & vbCrLf
        End If
    
    
    
    
    Next i
    If Nachricht(3) <> "" Then
        Ausgabe(4) = "Bitte pr|fffd|fen Sie die 'Einsch|fffd|tzung' des Problems (Spalten AI bis AL) in Zeile:" & vbCrLf & vbCrLf & Nachricht(3)
    End If
End If


'Check, ob mindestens ein X gesetzt wurde bei eingetragenem Medikament
Nachricht(4) = ""   'Informationsbedarf des Patienten
Nachricht(5) = ""   'Ergebnis der |fffd|berpr|fffd|fung
Nachricht(6) = ""   '|fffd|nderung

If Short = 0 Then
    For i = 1 To 20
        If Cells(17 + i, 6) <> "" Then
            'Informationsbedarf des Patienten
            If UCase(Cells(17 + i, 19)) <> "X" And UCase(Cells(17 + i, 20)) <> "X" And UCase(Cells(17 + i, 21)) <> "X" And UCase(Cells(17 + i, 22)) <> "X" Then Nachricht(4) = Nachricht(4) & Format(17 + i) & vbCrLf
            'Ergebnis der |fffd|berpr|fffd|fung
            If UCase(Cells(17 + i, 23)) <> "X" And UCase(Cells(17 + i, 24)) <> "X" And UCase(Cells(17 + i, 25)) <> "X" And UCase(Cells(17 + i, 26)) <> "X" And UCase(Cells(17 + i, 27)) <> "X" And UCase(Cells(17 + i, 28)) <> "X" And UCase(Cells(17 + i, 29)) <> "X" And UCase(Cells(17 + i, 30)) <> "X" Then
                Nachricht(5) = Nachricht(5) & Format(17 + i) & vbCrLf
            End If
        End If
    Next i
End If

'|fffd|nderung muss immer ausgewertet werden
For i = 1 To 20
    If Cells(17 + i, 6) <> "" Then
        '|fffd|nderung
        If UCase(Cells(17 + i, 39)) = "X" And Cells(17 + i, 40) = "" Or UCase(Cells(17 + i, 39)) = "X" And Cells(17 + i, 40) = "--" Then Nachricht(6) = Nachricht(6) & Format(17 + i) & vbCrLf
    End If
Next i


If Nachricht(4) <> "" Then
    Ausgabe(1) = "Bitte markieren Sie den 'Informationsbedarf des Patienten' (Spalten S bis V) in Zeile:" & vbCrLf & vbCrLf & Nachricht(4) & vbCrLf & vbCrLf
End If
If Nachricht(5) <> "" Then
    Ausgabe(2) = "Bitte markieren Sie das 'Ergebnis der |fffd|berpr|fffd|fung' (Spalten W bis AD) in Zeile:" & vbCrLf & vbCrLf & Nachricht(5) & vbCrLf & vbCrLf
End If


If Nachricht(6) <> "" Then
    Ausgabe(3) = "Bitte geben Sie im Block '|fffd|nderung' die Art der |fffd|nderung an (Spalte AN) in Zeile:" & vbCrLf & vbCrLf & Nachricht(6) & vbCrLf & vbCrLf
End If

If Ausgabe(1) & Ausgabe(2) & Ausgabe(3) & Ausgabe(4) <> "" Then
    Antwort = MsgBox(Ausgabe(1) & Ausgabe(2) & Ausgabe(3) & Ausgabe(4), vbOKOnly, "Ergebnis der Pr|fffd|fung:")
    Meldung = 1
End If








'Check, ob alle Felder ausgef|fffd|llt sind
For i = 1 To 15
    Check(i) = ""
Next i
Nachricht(1) = ""
Nachricht(2) = ""

If Cells(4, 7) = "" Then Check(1) = "lfd. Nr. des ATHINA-Bogens:" & vbCrLf
If Cells(5, 7) = "" Then Check(2) = "bearbeitet von:" & vbCrLf
If Cells(6, 7) = "" Then Check(3) = "Geschlecht des Patienten:" & vbCrLf
If Cells(7, 7) = "" Then Check(4) = "Altersgruppe:" & vbCrLf
'If Cells(10, 7) = "" Then check(5) = "Intervention n|fffd|tig?" & vbCrLf
If Cells(9, 7) = "" Then Check(6) = "Kontaktaufnahme mit Arzt:" & vbCrLf
If Cells(11, 7) = "" Then Check(8) = "Dem Patienten bekannte Diagnosen (Fachtermini):" & vbCrLf
'If Cells(8, 17) = "" Then check(9) = "hatte der Pat. urspr|fffd|ngl. einen Medikationsplan?" & vbCrLf
'If Cells(3, 46) = "" Then check(10) = "Patientenzufriedenheit:" & vbCrLf
'If Cells(4, 46) = "" Then check(11) = "Zufriedenheit Personal:" & vbCrLf
If Cells(13, 7) = "" Then Check(12) = "abschlie|fffd|end bearbeitet am:" & vbCrLf
If Cells(14, 7) = "" Then Check(13) = "Dauer der |fffd|berpr|fffd|fung und der Ma|fffd|nahmen:" & vbCrLf

If UCase(Cells(9, 7)) = "JA" Then
    If Cells(10, 7) = "" Then Check(7) = "falls ja, Kontaktaufnahme mit dem Arzt:" & vbCrLf
ElseIf UCase(Cells(9, 7)) = "NEIN" Then
    Cells(10, 7) = "--"
Else
    Cells(10, 7) = ""
End If

'nicht mehr vorhanden ab Version 3
'If Cells(8, 17) = "ja" Then
'    If Cells(9, 17) = "" Then check(14) = "falls ja, Ausstelldatum des Medikationsplans:" & vbCrLf
'    If Cells(10, 17) = "" Then check(15) = "falls ja, wurde dieser Medikationsplan aktualisiert?" & vbCrLf
'ElseIf Cells(8, 17) = "nein" Then
'    Application.EnableEvents = 0
'    Cells(9, 17) = ""
'    Cells(10, 17) = ""
'    Application.EnableEvents = 1
'End If




Nachricht(1) = "Achtung, folgende Angaben fehlen, um den ATHINA-Bogen abzuschlie|fffd|en:" & vbCrLf & vbCrLf
For i = 1 To 15
    If Check(i) <> "" Then Nachricht(2) = Nachricht(2) & Check(i)
Next i

If Nachricht(2) <> "" Then
    Antwort = MsgBox(Nachricht(1) & Nachricht(2), vbOKOnly, "Ergebnis der Pr|fffd|fung:")
    Meldung = 1
End If


If Meldung = 0 Then
    MsgBox ("Der ATHINA-Bogen wurde gepr|fffd|ft. Es wurden keine Fehler gefunden!")
End If

Application.ScreenUpdating = True


End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
On Error GoTo Errorhandler

'Abfrage, ob die ge|fffd|nderte Zelle im Dateneingabebereich liegt

Zeile = Target.Row
Spalte = Target.Column
Breite = Target.Columns.count
Tiefe = Target.Rows.count

Application.EnableEvents = 0
Application.ScreenUpdating = 0
'Schutz_aufheben

For x = 1 To Tiefe
    Zeile = Zeile + x - 1
    For y = 1 To Breite
        Spalte = Spalte + y - 1
        If Zeile > 17 And Zeile < 38 Then Berechnung
        
        If Spalte = 17 And Zeile > 7 And Zeile < 11 Then Berechnung2
        
        If Spalte = 7 And Zeile > 2 And Zeile < 14 Then Berechnung3
    Next y
    Spalte = Target.Column  'f|fffd|r den Lauf in der n|fffd|chsten Zeile Spalte auf Anfangswert zur|fffd|cksetzen
Next x

'Schutz_setzen
Application.EnableEvents = 1
Application.ScreenUpdating = 1
Exit Sub
Errorhandler:
Antwort = MsgBox("Es ist ein Fehler im Makro aufgetreten! Bitte pr|fffd|fen Sie die Eingabe.", vbCritical, "Hoppla!")

'Schutz_setzen
Application.EnableEvents = 1
Application.ScreenUpdating = 1

End Sub

Private Sub Berechnung()

'Medikation
If Spalte = 10 Or Spalte = 11 Then
    If Spalte = 10 And UCase(Cells(Zeile, Spalte)) = "X" Then Cells(Zeile, 11) = ""
    If Spalte = 11 And UCase(Cells(Zeile, Spalte)) = "X" Then Cells(Zeile, 10) = ""
End If
    
'Informationsbedarf des Patienten
If Spalte > 18 And Spalte < 23 Then
    If Spalte = 19 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 20) = "--"
        Cells(Zeile, 21) = "--"
        Cells(Zeile, 22) = "--"
    End If
    If Spalte > 19 And Spalte < 23 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 19) = "--"
        If Cells(Zeile, 20) = "--" Then Cells(Zeile, 20) = ""
        If Cells(Zeile, 21) = "--" Then Cells(Zeile, 21) = ""
        If Cells(Zeile, 22) = "--" Then Cells(Zeile, 22) = ""
    End If
End If

If Spalte = 19 And UCase(Cells(Zeile, Spalte)) = "X" Then
    If UCase(Cells(Zeile, 23)) = "X" Then
        Cells(Zeile, 35) = "x"
        Cells(Zeile, 36) = "--"
        Cells(Zeile, 37) = "--"
        Cells(Zeile, 38) = "--"
    End If
End If


      
        

'Ergebnis der |fffd|berpr|fffd|fung
If Spalte > 22 And Spalte < 31 Then
    If Spalte = 23 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 24) = "--"
        Cells(Zeile, 25) = "--"
        Cells(Zeile, 26) = "--"
        Cells(Zeile, 27) = "--"
        Cells(Zeile, 28) = "--"
        Cells(Zeile, 29) = "--"
        Cells(Zeile, 30) = "--"
    End If
    If Spalte > 23 And Spalte < 31 And Cells(Zeile, Spalte) <> "" And Cells(Zeile, Spalte) <> "--" Then
        Cells(Zeile, 23) = "--"
        If Cells(Zeile, 24) = "--" Then Cells(Zeile, 24) = ""
        If Cells(Zeile, 25) = "--" Then Cells(Zeile, 25) = ""
        If Cells(Zeile, 26) = "--" Then Cells(Zeile, 26) = ""
        If Cells(Zeile, 27) = "--" Then Cells(Zeile, 27) = ""
        If Cells(Zeile, 28) = "--" Then Cells(Zeile, 28) = ""
        If Cells(Zeile, 29) = "--" Then Cells(Zeile, 29) = ""
        If Cells(Zeile, 30) = "--" Then Cells(Zeile, 30) = ""
    End If
End If


If Spalte = 23 And UCase(Cells(Zeile, Spalte)) = "X" Then
    If UCase(Cells(Zeile, 19)) = "X" Then
        Cells(Zeile, 35) = "x"
        Cells(Zeile, 36) = "--"
        Cells(Zeile, 37) = "--"
        Cells(Zeile, 38) = "--"
    End If
End If
'############################################################################################################################
'If Spalte = 27 And Cells(Zeile, Spalte) <> "" And Cells(Zeile, Spalte) <> "--" Then
'    Cells(Zeile, 26) = "x"
'End If


'If Spalte = 26 And Cells(Zeile, Spalte) = "--" Then
'    Cells(Zeile, 27) = "--"
'End If

'If Spalte = 27 And Cells(Zeile, Spalte) = "--" Then
'    Cells(Zeile, 26) = "--"
'End If

'If Spalte = 27 And Cells(Zeile, Spalte) = "" Then
'    Cells(Zeile, 26) = ""
'End If



'Kontakt mit dem Arzt
If Spalte = 32 And UCase(Cells(Zeile, Spalte)) = "X" Then
    If UCase(Cells(9, 7)) <> "JA" Then
        Antwort = MsgBox("Bitte in den Stammdaten oben (Zelle G11) 'Kontaktaufnahme mit dem Arzt' mit 'ja' ausf|fffd|llen.", vbOKOnly, "Achtung")
    End If
End If

'Anmerkungen Apotheke
If Spalte = 34 And UCase(Cells(Zeile, Spalte)) = "X" Then
    Antwort = MsgBox("Bitte auch 'Anmerkung der Apotheke' eintragen!", vbOKOnly, "Achtung!")
End If

'If Spalte = 26 And UCase(Cells(Zeile, Spalte)) = "X" Then
'    Antwort = MsgBox("Bitte auch nachfolgende Zelle 'Klassifikation der Interaktion' und 'Anmerkung der Apotheke' eintragen!", vbOKOnly, "Achtung!")
'End If

If Spalte = 30 And UCase(Cells(Zeile, Spalte)) = "X" Then
    Antwort = MsgBox("Bitte auch 'Anmerkung der Apotheke' eintragen!", vbOKOnly, "Achtung!")
End If

If Spalte = 40 And UCase(Cells(Zeile, Spalte)) = "SONSTIGES" Then
    Antwort = MsgBox("Bitte auch 'Anmerkung der Apotheke' eintragen!", vbOKOnly, "Achtung!")
End If

If Spalte = 48 And UCase(Cells(Zeile, Spalte)) = "SONSTIGES" Then
    Antwort = MsgBox("Bitte auch 'Anmerkung der Apotheke' eintragen!", vbOKOnly, "Achtung!")
End If

'Einsch|fffd|tzung
If Spalte > 34 And Spalte < 39 Then
    If Spalte = 35 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 36) = "--"
        Cells(Zeile, 37) = "--"
        Cells(Zeile, 38) = "--"
    End If
    If Spalte = 36 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 35) = "--"
        Cells(Zeile, 37) = "--"
        Cells(Zeile, 38) = "--"
    End If
    If Spalte = 37 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 35) = "--"
        Cells(Zeile, 36) = "--"
        Cells(Zeile, 38) = "--"
    End If
    If Spalte = 38 And UCase(Cells(Zeile, Spalte)) = "X" Then
        Cells(Zeile, 35) = "--"
        Cells(Zeile, 36) = "--"
        Cells(Zeile, 37) = "--"
    End If
End If



'Anmerkungen der Apotheke und des Tutors und Followup und Art der |fffd|nderung***ge|fffd|ndert
If Spalte = 40 Or Spalte = 41 Or Spalte = 42 Or Spalte = 48 Or Spalte = 49 Then
    Rows(Zeile).AutoFit
End If



'|fffd|nderung ***ge|fffd|ndert

If Spalte = 40 And Cells(Zeile, 40) <> "" And Cells(Zeile, 40) <> "--" Then
    Cells(Zeile, 39) = "x"
End If
If Spalte = 40 And Cells(Zeile, 40) = "" Or Spalte = 40 And Cells(Zeile, 40) = "--" Then
    Cells(Zeile, 39) = ""
End If
If Spalte = 39 And Cells(Zeile, 39) = "" Or Cells(Zeile, 39) = "--" Then
    Cells(Zeile, 40) = Cells(Zeile, 39)
End If

'Follow-up ***ge|fffd|ndert
If Spalte = 48 And Cells(Zeile, 48) <> "" And Cells(Zeile, 48) <> "--" Then
    Cells(Zeile, 47) = "x"
End If
If Spalte = 48 And Cells(Zeile, 48) = "" Or Spalte = 48 And Cells(Zeile, 48) = "--" Then
    Cells(Zeile, 47) = ""
End If
If Spalte = 47 And Cells(Zeile, 47) = "" Or Cells(Zeile, 47) = "--" Then
    Cells(Zeile, 48) = Cells(Zeile, 47)
End If

MediCopy

End Sub

Private Sub Berechnung2()
'Auswahlfelder rechts

If Zeile = 8 Then
    If UCase(Cells(Zeile, Spalte)) = "JA" Then
        Antwort = MsgBox("Bitte auch die nachfolgenden beiden Felder ausf|fffd|llen!", vbOKOnly, "Achtung!")
        Cells(Zeile + 1, Spalte) = ""
        Cells(Zeile + 2, Spalte) = ""
    ElseIf UCase(Cells(Zeile, Spalte)) = "NEIN" Then
        Cells(Zeile + 1, Spalte) = "--"
        Cells(Zeile + 2, Spalte) = "--"
    Else
        Cells(Zeile + 1, Spalte) = ""
        Cells(Zeile + 2, Spalte) = ""
    End If
End If
    


End Sub

Private Sub Berechnung3()
'Auswahlfelder links

'Kontaktaufnahme mit dem Arzt
If Zeile = 9 And UCase(Cells(9, 7)) = "JA" And Cells(10, 7) = "" Then
    Antwort = MsgBox("Bitte auch das nachfolgende Feld ausf|fffd|llen!", vbOKOnly, "Achtung!")
End If
If Zeile = 9 And UCase(Cells(9, 7)) = "NEIN" Then
    Cells(10, 7) = "--"
End If

If Zeile = 10 And Cells(10, 7) <> "" And Cells(10, 7) <> "--" Then
    Cells(9, 7) = "ja"
End If


End Sub


Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

'*********************
'*ATHINA-Bogen pr|fffd|fen*
'*********************

On Error GoTo Errorhandler

If Target.Row = 12 And Target.Column = 18 Then
    Application.EnableEvents = 0
    Pruefung
    Cells(14, 18).Select
    Application.EnableEvents = 1
    Exit Sub
End If


If Target.Row <> 16 Then Exit Sub

Application.ScreenUpdating = 0
Application.EnableEvents = 0
'Schutz_aufheben


PW_Set
Sheets("Athina-Bogen").Unprotect Password:=PW
'si: muss hier nicht Athina gro|fffd| geschrieben werden?
    
'************
'*Sortierung*
'************


'Nr
If Target.Column = 2 Then
    Rows("17:37").sort Key1:=Range("B16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 5).Select
End If


'Bezeichnung des Arzneimittels
If Target.Column = 6 Then
    Rows("17:37").sort Key1:=Range("F16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 6).Select
End If

'Wirkstoff
If Target.Column = 7 Then
    Rows("17:37").sort Key1:=Range("G16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 7).Select
End If


'Bedarfsmedikation
If Target.Column = 10 Then
    Rows("17:37").sort Key1:=Range("J16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 10).Select
End If

'Dauermedikation
If Target.Column = 11 Then
    Rows("17:37").sort Key1:=Range("K16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 11).Select
End If

'morgens
    If Target.Column = 12 Then
    Rows("17:37").sort Key1:=Range("L16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 12).Select
End If

'mittags
If Target.Column = 13 Then
    Rows("17:37").sort Key1:=Range("M16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 13).Select
End If

'abends
If Target.Column = 14 Then
    Rows("17:37").sort Key1:=Range("N16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 14).Select
End If

'nachts
If Target.Column = 15 Then
    Rows("17:37").sort Key1:=Range("O16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 15).Select
End If

'Einnahme-Anwendungshinweise
If Target.Column = 17 Then
    Rows("17:37").sort Key1:=Range("Q16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 17).Select
End If

'Behandlungsgrund
If Target.Column = 18 Then
    Rows("17:37").sort Key1:=Range("R16"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    Cells(18, 18).Select
End If



MediCopy

'Schutz_setzen
Sheets("ATHINA-Bogen").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True



Application.ScreenUpdating = 1
Application.EnableEvents = 1
Sheets("ATHINA-Bogen").Activate
Exit Sub

Errorhandler:
Antwort = MsgBox("Es ist ein Fehler im Makro aufgetreten! Bitte pr|fffd|fen Sie die Eingabe.", vbCritical, "Hoppla!")
'Schutz_setzen

Sheets("ATHINA-Bogen").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True


Application.ScreenUpdating = 1
Application.EnableEvents = 1

End Sub



Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim i, eingeblendet, Farbe


Private Sub Worksheet_Activate()

Application.ScreenUpdating = 0

Sheets("Medikationsplan").Unprotect Password:=PW

eingeblendet = 20

For i = 10 To 29
    Rows(i).AutoFit
    Rows(i).Hidden = 0
    If Sheets("ATHINA-Bogen").Cells(i + 8, 48) <> "" And Sheets("ATHINA-Bogen").Cells(i + 8, 48) <> "--" Then
        If UCase(Sheets("ATHINA-Bogen").Cells(i + 8, 48)) = "ABGESETZT" Then
            Rows(i).Hidden = 1
            eingeblendet = eingeblendet - 1
        End If
        If UCase(Sheets("ATHINA-Bogen").Cells(i + 8, 48)) = "PAUSIERT" Then
            Cells(i, 11) = "pausiert"
        End If
    Else
        If UCase(Sheets("ATHINA-Bogen").Cells(i + 8, 40)) = "ABGESETZT" Then
            Rows(i).Hidden = 1
            eingeblendet = eingeblendet - 1
        End If
        If UCase(Sheets("ATHINA-Bogen").Cells(i + 8, 40)) = "PAUSIERT" Then
            Cells(i, 11) = "pausiert"
        End If
    End If

Next i

For i = 29 To 10 Step -1
    If Cells(i, 2) = "" And Cells(i, 3) = "" And eingeblendet > 10 And Rows(i).Hidden = 0 Then
        Rows(i).Hidden = 1
        eingeblendet = eingeblendet - 1
    End If
Next i


'Farben neu setzen
Farbe = -4142
For i = 10 To 29
    If Rows(i).Hidden = 0 Then
        Range(Cells(i, 2), Cells(i, 12)).Interior.ColorIndex = Farbe
        If Farbe = -4142 Then
            Farbe = 15
        Else
            Farbe = -4142
        End If
    End If
Next i
  



Sheets("Medikationsplan").Protect Password:=PW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    True, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True
    
Application.CutCopyMode = False
Cells(1, 1).Select
Application.ScreenUpdating = 1

End Sub


Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' bz{^

INQUEST-PP=macro
