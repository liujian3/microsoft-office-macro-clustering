Attribute VB_Name = "Foglio1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Modulo1"
       Private Function Unita(ByVal k As Integer) As String
            Dim Lettere() As String
            Lettere = Split(",uno,due,tre,quattro,cinque,sei,sette,otto,nove,dieci,undici,dodici,tredici,quattordici,quindici,sedici,diciassette,diciotto,diciannove", ",")
            If (k < 0) Or (k > UBound(Lettere)) Then
                Unita = ""
            Else
                Unita = Lettere(k)
            End If
        End Function

 

        Private Function Decine(ByVal k As Integer) As String
            Dim Lettere() As String
            Lettere = Split(",dieci,venti,trenta,quaranta,cinquanta,sessanta,settanta,ottanta,novanta", ",")
            If (k < 0) Or (k > UBound(Lettere)) Then
                Decine = ""
            Else
                Decine = Lettere(k)
            End If
        End Function

 

        Private Function Migliaia(ByVal k As Integer) As String
            Dim Lettere() As String
            Lettere = Split(",mille,unmilione,unmiliardo,millemiliardi,mila,milioni,miliardi,milamiliardi,milamiliardi,migliaiadimiliardi", ",")
            If (k < 0) Or (k > UBound(Lettere)) Then
                Migliaia = ""
            Else
                Migliaia = Lettere(k)
            End If
        End Function
        

 

        Private Function CalcolaLettere(ByVal Importo As Currency) As String
            Dim result As String
            result = ""
            Dim intero As String
            intero = Format(Importo, "0.00")
            Dim resto As String
            resto = "/" + Right(intero, 2)
            intero = Left(intero, Len(intero) - 3)
            If Left(intero, 1) = "-" Then
                intero = Mid(intero, 2)
            End If
            If Importo = 0 Then
                CalcolaLettere = "zero/00"
                Exit Function
            End If
            Dim mille As Integer
            mille = -1
            Dim k As Integer
            k = Len(intero) Mod 3
            If Not (k = 0) Then
                intero = String(3 - k, "0") + intero
            End If
            While Not (intero = "")
                mille = mille + 1
                Dim parziale As String
                parziale = ""
                Dim tripla As String
                tripla = Right(intero, 3)
                Dim s As String
                s = ""
                intero = Left(intero, Len(intero) - 3)
                Dim tv As Integer
                tv = CInt(tripla)
                Dim td As Integer
                td = tv Mod 100
                Dim tc As Integer
                tc = (tv - td) / 100
                If Not (tc = 0) Then
                    parziale = "cento"
                    If tc > 1 Then
                        parziale = Unita(tc) + parziale
                    End If
                End If
                If td < 20 Then
                    parziale = parziale + Unita(td)
                Else
                    Dim x As Integer
                    x = td Mod 10
                    Dim y As Integer
                    y = (td - x) / 10
                    parziale = parziale + Decine(y)
                    s = Unita(x)
                    If (InStr(1, "uo", Left(s, 1)) <> 0) And (s <> "") And (Not (y = 0)) Then

                       parziale = Left(parziale, Len(parziale) - 1)
                    End If
                    parziale = parziale + s
                End If
                s = Migliaia(mille)
                If (mille > 0) And (Not (parziale = "")) Then
                    k = mille
                    If Not (parziale = "uno") Then
                        k = k + 4
                        s = Migliaia(k)
                        If Right(parziale, 3) = "uno" Then
                            parziale = Left(parziale, Len(parziale) - 1)
                        End If
                    Else
                        parziale = ""
                    End If
                    parziale = parziale + s
                End If
                result = parziale + result
            Wend
            If Importo < 0 Then
                result = "meno" + result
            End If
            CalcolaLettere = result + resto
        End Function
        Public Function Cifre2Lettere(ByVal Importo As Currency) As String
            Cifre2Lettere = CalcolaLettere(Importo)
        End Function
Attribute VB_Name = "Modulo2"

Sub EstraiRicevuteDaStampare()
Attribute EstraiRicevuteDaStampare.VB_ProcData.VB_Invoke_Func = "u\n14"
'
' estrae le ricevute da stampare (x) nella colonna
' "stampa ricevuta"
'

'
    Sheets("xstamparicevute").Select
    Rows("2:100").Select
    Selection.Delete Shift:=xlUp
    Range("A2").Select
    Sheets("Dettaglio Entrate Uscite 2017").Select
    Cells.Select
    ActiveSheet.Range("$A$1:$L$800").AutoFilter Field:=12, Criteria1:="<>"
    Rows("9:200").Select
    Selection.Copy
    Sheets("xstamparicevute").Select
    Range("A2").Select
    ActiveSheet.Paste
    Range("A2").Select
    
    'parte2
    Range(Selection, Selection.End(xlDown)).Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(0, 12).Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "0"
    ActiveCell.Select
    Selection.End(xlUp).Select
    ActiveCell.Offset(1, 0).Range("A1").Select
    ActiveCell.FormulaR1C1 = "=cifre2lettere(RC[-10])"
    ActiveCell.Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("A2").Select
    
    Sheets("xstamparicevute").Select
    Range("A2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(1, 0).Range("A1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A2").Select
End Sub
Attribute VB_Name = "Modulo3"
Attribute VB_Name = "Questa_cartella_di_lavoro"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' kj$bq

INQUEST-PP=macro
