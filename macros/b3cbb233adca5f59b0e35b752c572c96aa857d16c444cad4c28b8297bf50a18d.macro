Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{1A0A6E5F-075D-47F5-96B5-5DD7D482D2DF}{2CABA97C-86B5-472F-95DF-FE9C80ADE53E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim a, b As String
Dim summma As Currency

Private Sub Btn2_Click()
LastRo = |fffd||fffd||fffd||fffd|3.Cells(Rows.Count, Index).End(xlUp).Row + 1
UserForm1.Hide
UserForm2.Show
End Sub

Private Sub ComboBox2_Change()
Select Case ComboBox2
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox3.RowSource = "|fffd|1"
        ComboBox3.Visible = True
        Label8.Visible = True
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 1
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        ComboBox3.RowSource = "|fffd|1"
        ComboBox3.Visible = True
        Label8.Visible = True
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 3
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox3.RowSource = "|fffd|1"
        ComboBox3.Visible = True
        Label8.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox3.RowSource = "|fffd|1"
        ComboBox3.Visible = True
        Label8.Visible = True
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 9
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox3.RowSource = "|fffd|1"
        ComboBox3.Visible = True
        Label8.Visible = True
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 9
End Select
End Sub
Private Sub ComboBox3_Change()
Select Case ComboBox3
    Case "|fffd||fffd||fffd||fffd||fffd|"
        Label15.Visible = True
        TextBox8.Visible = True
        ComboBox4.RowSource = "|fffd|11"
        ComboBox7.RowSource = "|fffd||fffd|1"
        ComboBox4.Visible = True
        Label9.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Label15.Visible = True
        TextBox8.Visible = True
        Label15.Visible = True
        TextBox8.Visible = True
        ComboBox4.Visible = True
        ComboBox4.RowSource = "|fffd|13"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Label15.Visible = True
        TextBox8.Visible = True
        ComboBox4.RowSource = "|fffd|12"
        ComboBox4.Visible = True
        Label9.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Label15.Visible = True
        TextBox8.Visible = True
        ComboBox4.RowSource = "|fffd|11"
        ComboBox4.Visible = True
        Label9.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Label15.Visible = True
        TextBox8.Visible = True
        ComboBox4.RowSource = "|fffd|12"
        ComboBox4.Visible = True
        Label9.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox4.RowSource = "|fffd|12"
        ComboBox4.Visible = True
        Label9.Visible = True
        Index = 7
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox4.RowSource = "|fffd|13"
        ComboBox4.Visible = True
        Label9.Visible = True
        Index = 7
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Visible = False
        OptionButton5.Value = True
        OptionButton5.Visible = False
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 5
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Index = 7
End Select
End Sub

Private Sub ComboBox4_Change()
Select Case ComboBox4
    Case "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Visible = False
        OptionButton5.Value = True
        OptionButton5.Visible = False
        ComboBox5.Visible = True
        Label10.Visible = True
        ComboBox7.Visible = True
        Label12.Visible = True
        ComboBox8.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|1"
        ComboBox8.Visible = True
        Label13.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Visible = False
        OptionButton4.Value = True
        OptionButton5.Visible = False
        ComboBox5.Visible = True
        Label10.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Visible = False
        OptionButton5.Value = True
        OptionButton5.Visible = False
        ComboBox5.Visible = True
        Label10.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Value = True
        OptionButton4.Visible = False
        OptionButton5.Visible = False
        ComboBox8.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|2"
        ComboBox8.Visible = True
        Label13.Visible = True
        ComboBox7.RowSource = "|fffd||fffd|2"
        ComboBox7.Visible = True
        Label12.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        OptionButton4.Visible = False
        OptionButton4.Value = True
        OptionButton5.Visible = False
End Select
End Sub

Private Sub ComboBox5_Change()
Select Case ComboBox5
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox6.RowSource = "|fffd|41"
        ComboBox6.Visible = True
        Label11.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox6.RowSource = "|fffd|42"
        ComboBox6.Visible = True
        Label11.Visible = True
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox6.Visible = True
        Label11.Visible = True
        ComboBox6.RowSource = "|fffd|44"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ComboBox6.Visible = True
        Label11.Visible = True
        ComboBox6.RowSource = "|fffd|45"
End Select
End Sub


Private Sub CommandButton1_Click()
lLastRow = |fffd||fffd||fffd||fffd|1.Columns(1).Find(Empty, Cells(Rows.Count, 1), xlValues, xlWhole).Row
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 1) = ComboBox9.Value & "." & ComboBox10.Value & "." & ComboBox11.Value
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 2) = ComboBox1
If OptionButton4.Value = True Then
    summa = TextBox4
    |fffd||fffd||fffd||fffd|1.Cells(lLastRow, 3) = Replace(summa, ",", ".")
End If
If OptionButton5.Value = True Then
    summa = TextBox4
    |fffd||fffd||fffd||fffd|1.Cells(lLastRow, 4) = Replace(summa, ",", ".")
End If
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 5) = ComboBox16
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 6) = TextBox8
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 7) = ComboBox2
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 8) = ComboBox3
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 9) = ComboBox4
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 10) = ComboBox5
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 11) = ComboBox6
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 12) = ComboBox7
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 13) = Format(Replace(ComboBox8, ".", ","), "#,##0.00")
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 13) = |fffd||fffd||fffd||fffd|1.Cells(lLastRow, 13) / 100
|fffd||fffd||fffd||fffd|1.Cells(lLastRow, 13) = TextBox7
Unload UserForm1
End Sub

Private Sub UserForm_Initialize()
Index = 9
ComboBox1.RowSource = "|fffd||fffd||fffd||fffd||fffd|"
ComboBox2.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|1"
ComboBox5.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|4"
ComboBox3.Visible = False
Label8.Visible = False
ComboBox4.Visible = False
Label9.Visible = False
ComboBox5.Visible = False
Label10.Visible = False
ComboBox6.Visible = False
Label11.Visible = False
ComboBox7.Visible = False
Label12.Visible = False
ComboBox8.Visible = False
Label13.Visible = False
Label15.Visible = False
TextBox8.Visible = False
ComboBox9.RowSource = "|fffd||fffd||fffd||fffd||fffd|"
ComboBox10.RowSource = "|fffd||fffd||fffd||fffd||fffd|1"
ComboBox11.RowSource = "|fffd||fffd||fffd|"
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{26DBB302-6249-4B79-8659-BFD2BD57510A}{9B371DAA-F020-4B81-9F68-98351EB056B0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub Btn3_Click()

|fffd||fffd||fffd||fffd|3.Cells(LastRo, Index) = UserForm2.TextBox1.Value

Select Case UserForm1.ComboBox2
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Select
Select Case UserForm1.ComboBox3
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        UserForm1.ComboBox16.RowSource = "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Select

Unload UserForm2
UserForm1.Show

End Sub

Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{3FC05A7C-4FB8-4878-9462-8BFAF9E8BB43}{6F30145D-A8E0-4B43-A045-055DA32DB7A5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Public Gruppa, Podgruppa, DolgnaSegodnya, OsnovDolg As String
Dim Data As Date
Private Sub CommandButton1_Click()
Dogovor = TextBox8.Value
Data = ComboBox9.Value & "." & ComboBox10.Value & "." & ComboBox11.Value
IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow
    dat1 = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
    If |fffd||fffd||fffd||fffd|1.Cells(i, 6) = Dogovor Then
        If |fffd||fffd||fffd||fffd|1.Cells(i, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" Then
            Label19.Caption = |fffd||fffd||fffd||fffd|1.Cells(i, 5)
            DataVidachi = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
            Vidano = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            DataIzmSumDolga = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
            OsnovDolg = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            RP = |fffd||fffd||fffd||fffd|1.Cells(i, 12)
            Stavka = |fffd||fffd||fffd||fffd|1.Cells(i, 13)
            DataNachislenia = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
            Gruppa = |fffd||fffd||fffd||fffd|1.Cells(i, 10)
            Podgruppa = |fffd||fffd||fffd||fffd|1.Cells(i, 11)
        Else
            Oper = |fffd||fffd||fffd||fffd|1.Cells(i, 9)
            Select Case Oper
                Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| %"
                    Oplacheno = Oplacheno + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
                    If Stavka = 0 Then
                        OsnovDolg = OsnovDolg - |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                        DataIzmSumDolga = dat1
                    Else
                        dat4 = DataIzmSumDolga
                        DataIzmSumDolga = dat1
                        RaznicaData = DateDiff("d", dat4, dat1) / RP
                        Nachisleno = Nachisleno + OsnovDolg * Stavka * RaznicaData
                        OsnovDolg = OsnovDolg - |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                        DataNachislenia = dat1
                    End If
            End Select
        End If
    End If
Next i

    If Stavka = 0 Then
        DataNachislenia = dataNach
    Else
        RazData = (DateDiff("d", DataVidachi, Data) \ RP) * RP
        dataNach = DateAdd("d", RazData, DataVidachi)
        RazDat = DateDiff("d", DataNachislenia, dataNach)
        If RazDat < 0 Then
            RazDat = 0
            dataNach = DataNachislenia
        End If
        PeriodovProshlo = DateDiff("d", DataVidachi, Data) \ RP
        DneyProshlo = DateDiff("d", DataVidachi, Data) Mod RP
        Nachisleno = Nachisleno + OsnovDolg * Stavka * RazDat / RP
        Dolg = Oplacheno - Nachisleno
        RazDat = DateDiff("d", dataNach, Data)
        DolgnaSegodnya = Oplacheno - Nachisleno - RazDat * OsnovDolg * Stavka / RP
    End If
    DataNachislenia = dataNach
Label16.Caption = OsnovDolg - DolgnaSegodnya
End Sub

Private Sub CommandButton2_Click()
IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
Dogovor = TextBox8.Value
Data = ComboBox9.Value & "." & ComboBox10.Value & "." & ComboBox11.Value
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 1) = Data
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 2) = "|fffd||fffd||fffd||fffd| %"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 4) = CDbl(Format(Label16.Caption, "0.00"))
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 5) = Label19.Caption
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 6) = Dogovor
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 9) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 10) = Gruppa
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 11) = Podgruppa
|fffd||fffd||fffd||fffd|1.Cells(IRow + 1, 14) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 1) = Data
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 2) = "|fffd||fffd||fffd||fffd| %"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 3) = -DolgnaSegodnya
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 5) = Label19.Caption
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 6) = Dogovor
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 8) = "|fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 2, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| %"

|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 1) = Data
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 2) = "|fffd||fffd||fffd||fffd| %"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 3) = OsnovDolg
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 5) = Label19.Caption
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 6) = Dogovor
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 7) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 8) = "|fffd||fffd||fffd||fffd||fffd|"
|fffd||fffd||fffd||fffd|1.Cells(IRow + 3, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
End Sub

Private Sub UserForm_Activate()
    ComboBox9.RowSource = "|fffd||fffd||fffd||fffd||fffd|"
    ComboBox10.RowSource = "|fffd||fffd||fffd||fffd||fffd|1"
    ComboBox11.RowSource = "|fffd||fffd||fffd|"
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd|"
Sub Zaymi()

Dim i As Integer
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Set Sh1 = |fffd||fffd||fffd||fffd|4
    Application.ScreenUpdating = False
    Lr1 = Sh1.Cells(Rows.Count, 1).End(xlUp).Row
    Sh1.Range("A2:P1000").ClearContents
    For i = 2 To Lr1
        Sh1.Rows(i).Interior.ColorIndex = xlNone
    Next i
    Application.ScreenUpdating = True
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    dat1 = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
    dat2 = Format(Now, "dd.mm.yyyy")
    Ident = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
    Kassa = |fffd||fffd||fffd||fffd|1.Cells(i, 2)
    Oper = |fffd||fffd||fffd||fffd|1.Cells(i, 9)
    Raskhod = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    RaznicaDat = DateDiff("d", dat1, dat2)
    RaznicaDat1 = DateDiff("m", dat1, dat2)
    RP = |fffd||fffd||fffd||fffd|1.Cells(i, 12)
    Stavka = |fffd||fffd||fffd||fffd|1.Cells(i, 13)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|



'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    IRow2 = |fffd||fffd||fffd||fffd|4.Cells(Rows.Count, 1).End(xlUp).Row
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set Rng = |fffd||fffd||fffd||fffd|4.Columns(1).Find(What:=Ident, LookAt:=xlWhole)
    If Rng Is Nothing Then
        If Oper = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" Then
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 1) = Ident
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 2) = |fffd||fffd||fffd||fffd|1.Cells(i, 5)
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 3) = dat1
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 4) = Raskhod
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 5) = dat1
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 6) = Raskhod
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 7) = RP
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 8) = Stavka
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 13) = 0
            |fffd||fffd||fffd||fffd|4.Cells(IRow2 + 1, 14) = dat1
        End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Else
        Select Case Oper
            Case "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
                If |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 8) = 0 Then
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) = Raskhod + |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5) = dat1
                Else
                    dat4 = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5) = dat1
                    RaznicaDat2 = DateDiff("d", dat4, dat1) / |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 7)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 11) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 11) + |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 8) * RaznicaDat2
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) + Raskhod
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 14) = dat1
                End If
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| %"
                |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 12) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 12) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
                If |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 8) = 0 Then
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) - |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5) = dat1
                Else
                    dat4 = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 5) = dat1
                    RaznicaDat2 = DateDiff("d", dat4, dat1) / |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 7)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 11) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 11) + |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 8) * RaznicaDat2
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 6) - |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                    |fffd||fffd||fffd||fffd|4.Cells(Rng.Row, 14) = dat1
                End If
                
        End Select
    End If
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Next i

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For j = 2 To IRow2
    If |fffd||fffd||fffd||fffd|4.Cells(j, 8) = 0 Then
        |fffd||fffd||fffd||fffd|4.Cells(j, 14) = dataNach
    Else
        Razdat2 = (DateDiff("d", |fffd||fffd||fffd||fffd|4.Cells(j, 3), dat2) \ |fffd||fffd||fffd||fffd|4.Cells(j, 7)) * |fffd||fffd||fffd||fffd|4.Cells(j, 7)
        dataNach = DateAdd("d", Razdat2, |fffd||fffd||fffd||fffd|4.Cells(j, 3))
        RazDat = DateDiff("d", |fffd||fffd||fffd||fffd|4.Cells(j, 14), dataNach)
        If RazDat < 0 Then
            RazDat = 0
            dataNach = |fffd||fffd||fffd||fffd|4.Cells(j, 14)
        End If
        |fffd||fffd||fffd||fffd|4.Cells(j, 9) = DateDiff("d", |fffd||fffd||fffd||fffd|4.Cells(j, 3), dat2) \ |fffd||fffd||fffd||fffd|4.Cells(j, 7)
        |fffd||fffd||fffd||fffd|4.Cells(j, 10) = DateDiff("d", |fffd||fffd||fffd||fffd|4.Cells(j, 3), dat2) Mod |fffd||fffd||fffd||fffd|4.Cells(j, 7)
        |fffd||fffd||fffd||fffd|4.Cells(j, 11) = |fffd||fffd||fffd||fffd|4.Cells(j, 11) + |fffd||fffd||fffd||fffd|4.Cells(j, 6) * |fffd||fffd||fffd||fffd|4.Cells(j, 8) * (RazDat) / |fffd||fffd||fffd||fffd|4.Cells(j, 7)
        |fffd||fffd||fffd||fffd|4.Cells(j, 13) = |fffd||fffd||fffd||fffd|4.Cells(j, 12) - |fffd||fffd||fffd||fffd|4.Cells(j, 11)
        RazDat = DateDiff("d", dataNach, dat2)
        |fffd||fffd||fffd||fffd|4.Cells(j, 15) = |fffd||fffd||fffd||fffd|4.Cells(j, 12) - |fffd||fffd||fffd||fffd|4.Cells(j, 11) - RazDat * |fffd||fffd||fffd||fffd|4.Cells(j, 6) * |fffd||fffd||fffd||fffd|4.Cells(j, 8) / |fffd||fffd||fffd||fffd|4.Cells(j, 7)
        If |fffd||fffd||fffd||fffd|4.Cells(j, 12) < 0 Then
            |fffd||fffd||fffd||fffd|4.Rows(j).Interior.Color = vbRed
        End If
    End If
    |fffd||fffd||fffd||fffd|4.Cells(j, 14) = dataNach
Next j
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Sub Investori()

Dim i As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Set Sh2 = |fffd||fffd||fffd||fffd|5
    Application.ScreenUpdating = False
    Lr2 = Sh2.Cells(Rows.Count, 1).End(xlUp).Row
    Sh2.Range("A2:Z1000").ClearContents
    For j = 2 To Lr1
        Sh2.Rows(j).Interior.ColorIndex = xlNone
    Next j
    Application.ScreenUpdating = True
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|


IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    dat1 = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
    dat2 = Format(Now, "dd.mm.yyyy")
    Ident = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
    Kassa = |fffd||fffd||fffd||fffd|1.Cells(i, 2)
    Oper = |fffd||fffd||fffd||fffd|1.Cells(i, 9)
    Raskhod = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    RaznicaDat = DateDiff("d", dat1, dat2)
    RaznicaDat1 = DateDiff("m", dat1, dat2)
    RP = |fffd||fffd||fffd||fffd|1.Cells(i, 12)
    Stavka = |fffd||fffd||fffd||fffd|1.Cells(i, 13)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
IRow3 = |fffd||fffd||fffd||fffd|5.Cells(Rows.Count, 1).End(xlUp).Row
Set Rng = |fffd||fffd||fffd||fffd|5.Columns(1).Find(What:=Ident, LookAt:=xlWhole)
If Rng Is Nothing Then
    If Oper = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 1) = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 2) = |fffd||fffd||fffd||fffd|1.Cells(i, 5)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 3) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 4) = |fffd||fffd||fffd||fffd|1.Cells(i, 3)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 5) = |fffd||fffd||fffd||fffd|1.Cells(i, 12)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 6) = |fffd||fffd||fffd||fffd|1.Cells(i, 3)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 7) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 8) = |fffd||fffd||fffd||fffd|1.Cells(i, 13)
        |fffd||fffd||fffd||fffd|5.Cells(IRow3 + 1, 14) = "+-"
    End If
Else
        DataInvest = DateDiff("d", 1, "01." & Right(dat1, 7))
        Select Case Oper
        Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            If Right(dat1, 7) = Right(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 7) Then
                If |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) <> "+-" Then
                    T1 = Left(dat1, 2) - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2) + 1
                Else
                    T1 = Left(dat1, 2) - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2)
                End If
                T2v1 = "01." & Right(Format(DateAdd("m", 1, |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7)), "dd.mm.yyyy"), 7)
                T2v2 = Format(DateDiff("d", 1, T2v1), "dd.mm.yyyy")
                T2v3 = Left(T2v2, 2)
                T2 = T1 / T2v3
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T2
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7) = dat1
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "+"
            Else
                T1 = Left(dat1, 2)
                T2v1 = "01." & Right(Format(DateAdd("m", 1, dat1), "dd.mm.yyyy"), 7)
                T2v2 = Left(Format(DateDiff("d", 1, T2v1), "dd.mm.yyyy"), 2)
                T2 = T1 / T2v2
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T2
                T4v1 = "01." & Right(Format(DateAdd("m", 1, |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7)), "dd.mm.yyyy"), 7)
                T4v2 = Left(Format(DateDiff("d", 1, T4v1), "dd.mm.yyyy"), 2)
                If |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) <> "+-" Then
                    T4v3 = T4v2 - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2) + 1
                Else
                    T4v3 = T4v2 - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2)
                End If
                T4 = T4v3 / T4v2
                T3 = DateDiff("m", T4v1, dat1)
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T3
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T4
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7) = dat1
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 9) = dat1
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "+"
            End If
        Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 11) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 11) + |fffd||fffd||fffd||fffd|1.Cells(i, 4)
        Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                If Right(dat1, 7) = Right(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 7) Then
                    If |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) <> "-" Then
                        T1 = Left(dat1, 2) - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2) - 1
                    Else
                        T1 = Left(dat1, 2) - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2)
                    End If
                    T2v1 = "01." & Right(Format(DateAdd("m", 1, |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7)), "dd.mm.yyyy"), 7)
                    T2v2 = Left((Format(DateDiff("d", 1, T2v1), "dd.mm.yyyy")), 2)
                    T2 = T1 / T2v2
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T2
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7) = dat1
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "-"
                Else
                    If |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "-" Then
                        T1 = Left(dat1, 2) - 1
                    ElseIf |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "+-" Then
                        T1 = Left(dat1, 2) - 1
                    Else
                        T1 = Left(dat1, 2) - 1
                    End If
                    T2v1 = "01." & Right(Format(DateAdd("m", 1, dat1), "dd.mm.yyyy"), 7)
                    T2v2 = Left(Format(DateDiff("d", 1, T2v1), "dd.mm.yyyy"), 2)
                    T2 = T1 / T2v2
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T2
                    T4v1 = "01." & Right(Format(DateAdd("m", 1, |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7)), "dd.mm.yyyy"), 7)
                    T4v2 = Left(Format(DateDiff("d", 1, T4v1), "dd.mm.yyyy"), 2)
                    If |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "-" Then
                        T4v3 = T4v2 - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2) + 1
                    Else
                        T4v3 = T4v2 - Left(|fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7), 2)
                    End If
                    T4 = T4v3 / T4v2
                    T3 = DateDiff("m", T4v1, dat1)
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T3
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 10) + |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) * |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 8) * T4
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 7) = dat1
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 9) = dat1
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 6) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                    |fffd||fffd||fffd||fffd|5.Cells(Rng.Row, 14) = "-"
                End If
                        
        End Select
End If
Next i

For j = 2 To IRow3
    If Right(dat2, 7) <> Right(|fffd||fffd||fffd||fffd|5.Cells(j, 9), 7) Then
        |fffd||fffd||fffd||fffd|5.Cells(j, 9) = "01." & Right(dat2, 7)
        T2v1 = Format(DateAdd("m", 1, |fffd||fffd||fffd||fffd|5.Cells(j, 7)), "dd.mm.yyyy")
        T2v2 = Format("01." & Right(T2v1, 7), "dd.mm.yyyy")
        T2v3 = Format(DateDiff("d", 1, T2v2), "dd.mm.yyyy")
        t = Left(T2v3, 2)
        If |fffd||fffd||fffd||fffd|5.Cells(j, 14) = "+-" Then
            T2 = t - Left(|fffd||fffd||fffd||fffd|5.Cells(j, 7), 2)
        ElseIf |fffd||fffd||fffd||fffd|5.Cells(j, 14) = "-" Then
            T2 = t - Left(|fffd||fffd||fffd||fffd|5.Cells(j, 7), 2) + 1
        Else
            T2 = t - Left(|fffd||fffd||fffd||fffd|5.Cells(j, 7), 2)
        End If
        TT = T2 / t
        TT2 = "01." & Right(Format(dat2, "dd.mm.yyyy"), 7)
        RazDat = DateDiff("m", T2v2, TT2)
        If RazDat < 0 Then
            RazDat = 0
        End If
        |fffd||fffd||fffd||fffd|5.Cells(j, 10) = |fffd||fffd||fffd||fffd|5.Cells(j, 10) + |fffd||fffd||fffd||fffd|5.Cells(j, 6) * |fffd||fffd||fffd||fffd|5.Cells(j, 8) * (RazDat + TT)
        |fffd||fffd||fffd||fffd|5.Cells(j, 12) = |fffd||fffd||fffd||fffd|5.Cells(j, 11) - |fffd||fffd||fffd||fffd|5.Cells(j, 10)
        If |fffd||fffd||fffd||fffd|5.Cells(j, 10) > |fffd||fffd||fffd||fffd|5.Cells(j, 11) Then
            |fffd||fffd||fffd||fffd|5.Rows(j).Interior.Color = vbRed
        End If
    End If
    |fffd||fffd||fffd||fffd|5.Cells(j, 13) = |fffd||fffd||fffd||fffd|5.Cells(j, 12)
    T3 = Left(Right(dat2, 7), 2) - Left(Right(|fffd||fffd||fffd||fffd|5.Cells(j, 9), 7), 2)
    |fffd||fffd||fffd||fffd|5.Cells(j, 13) = |fffd||fffd||fffd||fffd|5.Cells(j, 13) - |fffd||fffd||fffd||fffd|5.Cells(j, 6) * |fffd||fffd||fffd||fffd|5.Cells(j, 8) * T3
    T1 = Left(dat2, 2)
    T2v1 = "01." & Right(Format(DateAdd("m", 1, dat2), "dd.mm.yyyy"), 7)
    T2v2 = Left(Format(DateDiff("d", 1, T2v1), "dd.mm.yyyy"), 2)
    T2 = T1 / T2v2
    |fffd||fffd||fffd||fffd|5.Cells(j, 13) = |fffd||fffd||fffd||fffd|5.Cells(j, 13) - |fffd||fffd||fffd||fffd|5.Cells(j, 6) * |fffd||fffd||fffd||fffd|5.Cells(j, 8) * T2
Next j

End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Dim i As Integer
Sub Komissionka()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Application.ScreenUpdating = False
Lr1 = |fffd||fffd||fffd||fffd|8.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To Lr1
    |fffd||fffd||fffd||fffd|8.Rows(i).Interior.ColorIndex = xlNone
Next i
|fffd||fffd||fffd||fffd|8.Range("A2:H1000").ClearContents
Application.ScreenUpdating = True

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow
    IRow2 = |fffd||fffd||fffd||fffd|8.Cells(Rows.Count, 1).End(xlUp).Row
    Set Rng = |fffd||fffd||fffd||fffd|8.Columns(1).Find(What:=|fffd||fffd||fffd||fffd|1.Cells(i, 6), LookAt:=xlWhole)
    If Rng Is Nothing Then
        If |fffd||fffd||fffd||fffd|1.Cells(i, 9) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            |fffd||fffd||fffd||fffd|8.Cells(IRow2 + 1, 1) = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
            |fffd||fffd||fffd||fffd|8.Cells(IRow2 + 1, 2) = |fffd||fffd||fffd||fffd|1.Cells(i, 14)
            |fffd||fffd||fffd||fffd|8.Cells(IRow2 + 1, 3) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
            |fffd||fffd||fffd||fffd|8.Cells(IRow2 + 1, 4) = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
        End If
    Else
        Select Case |fffd||fffd||fffd||fffd|1.Cells(i, 9)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 5) = |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 5) + |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 7) = |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 7) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
                |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 8) = |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 7) - |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 4) - |fffd||fffd||fffd||fffd|8.Cells(Rng.Row, 5)
        End Select
End If
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 21, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()
UserForm1.Show
End Sub

Private Sub CommandButton2_Click()
UserForm3.Show
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Dim i As Integer
Sub Obespechenie()

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Application.ScreenUpdating = False
Lr1 = |fffd||fffd||fffd||fffd|9.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To Lr1
    |fffd||fffd||fffd||fffd|9.Rows(i).Interior.ColorIndex = xlNone
Next i
|fffd||fffd||fffd||fffd|9.Range("A2:H1000").ClearContents
Application.ScreenUpdating = True

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow
    IRow2 = |fffd||fffd||fffd||fffd|9.Cells(Rows.Count, 1).End(xlUp).Row
    Set Rng = |fffd||fffd||fffd||fffd|9.Columns(1).Find(What:=|fffd||fffd||fffd||fffd|1.Cells(i, 6), LookAt:=xlWhole)
    If Rng Is Nothing Then
        If |fffd||fffd||fffd||fffd|1.Cells(i, 8) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 1) = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
            |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 2) = |fffd||fffd||fffd||fffd|1.Cells(i, 5)
            |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 3) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
            Set Rngg = |fffd||fffd||fffd||fffd|1.Columns(6).Find(What:=|fffd||fffd||fffd||fffd|1.Cells(i, 6), LookAt:=xlWhole)
            If Rngg Is Nothing Then
            Else
                |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 9) = |fffd||fffd||fffd||fffd|1.Cells(Rngg.Row, 14)
            End If
            Select Case |fffd||fffd||fffd||fffd|1.Cells(i, 9)
                Case "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 4) = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 8) = |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 7) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 4) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 5)
                Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 5) = |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 5) + |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 8) = |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 7) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 4) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 5)
                Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 7) = |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 7) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 6) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
                    |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 8) = |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 7) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 4) - |fffd||fffd||fffd||fffd|9.Cells(IRow2 + 1, 5)
            End Select
        End If
    Else
        Select Case |fffd||fffd||fffd||fffd|1.Cells(i, 9)
            Case "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 4) = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 8) = |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 7) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 4) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 5)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 5) = |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 5) + |fffd||fffd||fffd||fffd|1.Cells(i, 4)
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 8) = |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 7) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 4) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 5)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 7) = |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 7) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 6) = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
                |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 8) = |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 7) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 4) - |fffd||fffd||fffd||fffd|9.Cells(Rng.Row, 5)
        End Select
End If
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Sub Ostatki()

Dim i As Integer

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    |fffd||fffd||fffd||fffd|6.Cells(5, 3) = ""
    |fffd||fffd||fffd||fffd|6.Cells(6, 3) = ""
    |fffd||fffd||fffd||fffd|6.Cells(7, 3) = ""
    |fffd||fffd||fffd||fffd|6.Cells(8, 3) = ""
    |fffd||fffd||fffd||fffd|6.Cells(9, 3) = ""
    |fffd||fffd||fffd||fffd|6.Cells(10, 3) = ""
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Kassa = |fffd||fffd||fffd||fffd|1.Cells(i, 2)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Select Case Kassa
            Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
               |fffd||fffd||fffd||fffd|6.Cells(5, 3) = |fffd||fffd||fffd||fffd|6.Cells(5, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|6.Cells(6, 3) = |fffd||fffd||fffd||fffd|6.Cells(6, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|6.Cells(7, 3) = |fffd||fffd||fffd||fffd|6.Cells(7, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|6.Cells(8, 3) = |fffd||fffd||fffd||fffd|6.Cells(8, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|6.Cells(9, 3) = |fffd||fffd||fffd||fffd|6.Cells(9, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|6.Cells(10, 3) = |fffd||fffd||fffd||fffd|6.Cells(10, 3) + |fffd||fffd||fffd||fffd|1.Cells(i, 3) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    End Select
    
Next i

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Index, LastRo As Integer
Sub Finrezultat()

Dim i As Integer
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Set Sh4 = |fffd||fffd||fffd||fffd|7
    Application.ScreenUpdating = False
    Sh4.Range("H4:Z13").ClearContents
    Application.ScreenUpdating = True
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Chislo1 = "01." & Right(|fffd||fffd||fffd||fffd|7.Cells(2, 4), 7)
Chislo2 = "01." & Right(|fffd||fffd||fffd||fffd|7.Cells(2, 5), 7)
Chislo = DateDiff("m", Chislo1, Chislo2) + 8
|fffd||fffd||fffd||fffd|7.Cells(4, 8) = |fffd||fffd||fffd||fffd|7.Cells(2, 4)

For t = 9 To Chislo
    basic = |fffd||fffd||fffd||fffd|7.Cells(4, t - 1)
    |fffd||fffd||fffd||fffd|7.Cells(4, t) = DateAdd("m", 1, (|fffd||fffd||fffd||fffd|7.Cells(4, t - 1)))
Next t

IRow = |fffd||fffd||fffd||fffd|1.Cells(Rows.Count, 1).End(xlUp).Row
For i = 2 To IRow

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    dat1 = |fffd||fffd||fffd||fffd|1.Cells(i, 1)
    dat2 = Format(Now, "dd.mm.yyyy")
    Ident = |fffd||fffd||fffd||fffd|1.Cells(i, 6)
    Kassa = |fffd||fffd||fffd||fffd|1.Cells(i, 2)
    Oper = |fffd||fffd||fffd||fffd|1.Cells(i, 9)
    Raskhod = |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    RaznicaDat = DateDiff("d", dat1, dat2)
    RaznicaDat1 = DateDiff("m", dat1, dat2)
    RP = |fffd||fffd||fffd||fffd|1.Cells(i, 12)
    Stavka = |fffd||fffd||fffd||fffd|1.Cells(i, 13)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

DataOper = Right(|fffd||fffd||fffd||fffd|1.Cells(i, 1), 7)
Set RngDat = |fffd||fffd||fffd||fffd|7.Rows(4).Find(What:=DataOper, LookAt:=xlWhole)
If RngDat Is Nothing Then
Else
    ChM = RngDat.Column
    Select Case |fffd||fffd||fffd||fffd|1.Cells(i, 8)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(11, ChM) = |fffd||fffd||fffd||fffd|7.Cells(11, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(13, ChM) = |fffd||fffd||fffd||fffd|7.Cells(13, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(12, ChM) = |fffd||fffd||fffd||fffd|7.Cells(12, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(10, ChM) = |fffd||fffd||fffd||fffd|7.Cells(10, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(9, ChM) = |fffd||fffd||fffd||fffd|7.Cells(9, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(14, ChM) = |fffd||fffd||fffd||fffd|7.Cells(14, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(15, ChM) = |fffd||fffd||fffd||fffd|7.Cells(15, ChM) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(16, ChM) = |fffd||fffd||fffd||fffd|7.Cells(16, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    End Select
    Select Case |fffd||fffd||fffd||fffd|1.Cells(i, 9)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(6, ChM) = |fffd||fffd||fffd||fffd|7.Cells(6, ChM) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(6, ChM) = |fffd||fffd||fffd||fffd|7.Cells(6, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(6, ChM) = |fffd||fffd||fffd||fffd|7.Cells(6, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| %"
                |fffd||fffd||fffd||fffd|7.Cells(5, ChM) = |fffd||fffd||fffd||fffd|7.Cells(5, ChM) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(7, ChM) = |fffd||fffd||fffd||fffd|7.Cells(7, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(7, ChM) = |fffd||fffd||fffd||fffd|7.Cells(7, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(7, ChM) = |fffd||fffd||fffd||fffd|7.Cells(7, ChM) + |fffd||fffd||fffd||fffd|1.Cells(i, 3)
            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                |fffd||fffd||fffd||fffd|7.Cells(8, ChM) = |fffd||fffd||fffd||fffd|7.Cells(8, ChM) - |fffd||fffd||fffd||fffd|1.Cells(i, 4)
    End Select
End If
Next i

For i = 8 To Chislo
    For j = 5 To 16
        |fffd||fffd||fffd||fffd|7.Cells(18, i) = |fffd||fffd||fffd||fffd|7.Cells(18, i) + |fffd||fffd||fffd||fffd|7.Cells(j, i)
    Next j
Next i

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
