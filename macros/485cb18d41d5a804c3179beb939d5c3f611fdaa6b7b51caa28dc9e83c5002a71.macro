Attribute VB_Name = "Code_tir_al|fffd|atoire_de_base"
'Archive code de tir d'excel en mode al|fffd|atoire permanent

Sub TOUR_SUIVANT1()
'Protocole de passation de tour

'---------------------------------------------------------------------------
'Process particulier de sortie de sub en entr|fffd| de sub
If ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 Then Exit Sub 'si bouton en rose = d|fffd|sactivation bouton
If Range("NBTIR").Value <> 0 Then Exit Sub 'si reste toujours un ordre de tir sortir
If Range("TOUR").Value = "FIN" Then Exit Sub 'si reste toujours un ordre de tir sortir
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.ScreenUpdating = False
Application.EnableEvents = False
Sheets("Param|fffd|tres").Visible = True 'faire apparaitre feuille param|fffd|tres pour r|fffd|cup|fffd|rer les images fx
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Calcul du tir du joueur
Range("ADRESSE_TIR_JOUEUR").Calculate
ADRESSE_TIR_JOUEUR = Range("ADRESSE_TIR_JOUEUR_CONVER").Value
'+++++++++++++++++++++++++++++++++++++++++++
'Calcul du r|fffd|sultat du tir du joueur
If Range(ADRESSE_TIR_JOUEUR).Value = 1 Then
   Range(ADRESSE_TIR_JOUEUR).Value = 0 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
   Application.Speech.Speak "tir Rat|fffd| en " & Range("ADRESS_TIR").Value, True 'Message vocale rat|fffd|
   Range(Range("ADRESSE_TIR_REELLE").Value).Value = 0  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
   Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
'+++++++++++++++++++++++++++++++++++++++++++
Else
'+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "PA" Then  'tir sur porte avion
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_PA").Value = Range("ADV_VIE_PA").Value - 1
      If Range("ADV_VIE_PA").Value > 0 Then
         Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "Porte-avions ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CU" Then  'tir sur CUIRASSE
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CU").Value = Range("ADV_VIE_CU").Value - 1
      If Range("ADV_VIE_CU").Value > 0 Then
      Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "cuirass|fffd| ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CR1" Then  'tir sur CROISEUR 1
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CR1").Value = Range("ADV_VIE_CR1").Value - 1
      If Range("ADV_VIE_CR1").Value > 0 Then
      Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "CROISEUR ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CR2" Then  'tir sur CROISEUR 2
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CR2").Value = Range("ADV_VIE_CR2").Value - 1
      If Range("ADV_VIE_CR2").Value > 0 Then
      Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
   Else
      Application.Speech.Speak "CROISEUR ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "D1" Then  'tir sur DESTROYER 1
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_D1").Value = Range("ADV_VIE_D1").Value - 1
      If Range("ADV_VIE_D1").Value > 0 Then
      Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "DESTROYER ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "D2" Then  'tir sur DESTROYER 2
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_D2").Value = Range("ADV_VIE_D2").Value - 1
      If Range("ADV_VIE_D2").Value > 0 Then
      Application.Speech.Speak "Touch|fffd| EN " & Range("ADRESS_TIR").Value, True 'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "DESTROYER ENNEMI touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Niagara Solid"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "Flotte ennemie Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Calcul d'une adresse de tir valide sur joueur
Range("PLAGE_CALCUL_TIR_ADV").Calculate
ADRESSE_TIR_ADV = Range("TIR_CALCUL_ADV_REELLE").Value
Do While Range(ADRESSE_TIR_ADV).Value = -1 Or Range(ADRESSE_TIR_ADV).Value = 0 'Si valeur cellule non 1 alors recalcul
   Range("PLAGE_CALCUL_TIR_ADV").Calculate
   ADRESSE_TIR_ADV = Range("TIR_CALCUL_ADV_REELLE").Value
Loop
'+++++++++++++++++++++++++++++++++++++++++++
'Calcul du r|fffd|sultat du tir sur joueur joueur
If Range(ADRESSE_TIR_ADV).Value = 1 Then
   Application.Speech.Speak "tir ennemi Rat|fffd| en " & Range("TIR_CALCUL_GRILLE_ADV").Value, True 'Message vocale rat|fffd|
   Range(ADRESSE_TIR_ADV).Value = 0 'M|fffd|J r|fffd|sultat rat|fffd| dans grille joueur
   Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
   '1. Coller les images des navires sur la feuille de combat
   Worksheets("Param|fffd|tres").Select
   Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_RATE")).Select
   Selection.Copy
   Worksheets("Feuille de combat").Select
   Range(ADRESSE_TIR_ADV).Select
   ActiveSheet.Paste
   'Ajustement IMAGE FX
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
   Range("Z23").Select
'+++++++++++++++++++++++++++++++++++++++++++
Else
'+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "PA" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_PORTE_AVION").Value = Range("VIE_PORTE_AVION").Value - 1
      If Range("VIE_PORTE_AVION").Value > 0 Then
         Application.Speech.Speak "porte avions Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "Porte-avions touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CU" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CUIRASSE").Value = Range("VIE_CUIRASSE").Value - 1
      If Range("VIE_CUIRASSE").Value > 0 Then
         Application.Speech.Speak "cuirass|fffd| Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "cuirass|fffd| touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CR1" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CROISEUR1").Value = Range("VIE_CROISEUR1").Value - 1
      If Range("VIE_CROISEUR1").Value > 0 Then
         Application.Speech.Speak "CROISEUR 1 Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "CROISEUR 1 touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CR2" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CROISEUR2").Value = Range("VIE_CROISEUR2").Value - 1
      If Range("VIE_CROISEUR2").Value > 0 Then
         Application.Speech.Speak "CROISEUR 2 Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "CROISEUR 2 touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "D1" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE__DESTROYER1").Value = Range("VIE__DESTROYER1").Value - 1
      If Range("VIE__DESTROYER1").Value > 0 Then
         Application.Speech.Speak "DESTROYER 1 Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "DESTROYER 1 touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "D2" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_DESTROYER2").Value = Range("VIE_DESTROYER2").Value - 1
      If Range("VIE_DESTROYER2").Value > 0 Then
         Application.Speech.Speak "DESTROYER 2 Touch|fffd| EN " & Range("TIR_CALCUL_GRILLE_ADV").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "DESTROYER 2 touch|fffd| Coul|fffd|!", True 'Message vocale coul|fffd|
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "BrowalliaUPC"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("Feuille de combat").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "VOTRE Flotte EST Coul|fffd|!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "FIN"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'MaJ variables tableau
If Not Range("TOUR").Value = "FIN" Then Range("TOUR").Value = Range("TOUR").Value + 1 'changement compteur tour
If Not Range("TOUR").Value = "FIN" Then Range("NBTIR").Value = 1 'raz tir
Range("ADRESS_TIR").Value = "" 'raz adresse tir
Range("ETAT_NAVIRES").Calculate  'calcul plage ETAT_NAVIRES pour maj visuelle |fffd| user
If Range("TOUR").Value = "FIN" Then 'si fin du jeu
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 '9737945 rouge clair
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Sheets("Param|fffd|tres").Visible = False 'cacher feuille param|fffd|tres
Application.EnableEvents = True
Application.ScreenUpdating = True
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Traitement de fin de partie
If Range("TOUR").Value = "FIN" Then
   If Range("TOTAL_PERTES").Value > 0 Then
      Application.Speech.Speak ">Victoire!, partie termin|fffd|", True
      ActiveSheet.Shapes.Range(Array("amiral_lunettes")).Visible = msoTrue 'modification image amiral si victoire
      MsgBox "(^-^)> __" & Range("AFFICH_NOM_ADV").Value & " d|fffd|fait, Amiral__ (^-^)>" & Chr(10) & "VICTOIRE, la flotte adverse a |fffd|t|fffd| coul|fffd|e !" _
      & Chr(10) & Chr(10) & "(|fffd|-|fffd|)> Etat de votre flotte : " _
      & Chr(10) & "> " & Range("N7").Value & " " & Range("W7").Value _
      & Chr(10) & "> " & Range("N8").Value & " " & Range("W8").Value _
      & Chr(10) & "> " & Range("N9").Value & " " & Range("W9").Value _
      & Chr(10) & "> " & Range("N10").Value & " " & Range("W10").Value _
      & Chr(10) & "> " & Range("N11").Value & " " & Range("W11").Value _
      & Chr(10) & "> " & Range("N12").Value & " " & Range("W12").Value _
      & Chr(10) & "> Pertes dans les |fffd|quipages : " & Range("PERTES").Value & " sur " & Range("EQUIPAGE").Value _
      , vbInformation, ">>> VICTOIRE <<<  FIN DE PARTIE"
   '+++++++++++++++++++++++++++++++++++++++++++++++++++
   Else
   '+++++++++++++++++++++++++++++++++++++++++++++++++++
      Application.Speech.Speak ">d|fffd|faite!, partie termin|fffd|", True
      MsgBox "('|fffd|-|fffd|)> __" & Range("AFFICH_NOM_ADV").Value & " vous a d|fffd|fait, Amiral__ ('0-|fffd|)>" & Chr(10) & "DEFAITE, votre flotte a |fffd|t|fffd| coul|fffd|e !" _
      & Chr(10) & Chr(10) & "('_')> Etat de votre flotte : " _
      & Chr(10) & "> " & Range("N7").Value & " " & Range("W7").Value _
      & Chr(10) & "> " & Range("N8").Value & " " & Range("W8").Value _
      & Chr(10) & "> " & Range("N9").Value & " " & Range("W9").Value _
      & Chr(10) & "> " & Range("N10").Value & " " & Range("W10").Value _
      & Chr(10) & "> " & Range("N11").Value & " " & Range("W11").Value _
      & Chr(10) & "> " & Range("N12").Value & " " & Range("W12").Value _
      & Chr(10) & "> Pertes dans les |fffd|quipages : " & Range("PERTES").Value & " sur " & Range("EQUIPAGE").Value _
      , vbInformation, ">>> DEFAITE <<<  FIN DE PARTIE"
   End If
End If
'---------------------------------------------------------------------------
End Sub

Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "confirm_plac_d2, 261, 5, MSForms, CheckBox"
Attribute VB_Control = "confirm_plac_d1, 260, 6, MSForms, CheckBox"
Attribute VB_Control = "confirm_plac_cr2, 259, 7, MSForms, CheckBox"
Attribute VB_Control = "confirm_plac_cr1, 258, 8, MSForms, CheckBox"
Attribute VB_Control = "confirm_plac_cu, 257, 9, MSForms, CheckBox"
Attribute VB_Control = "confirm_plac_pa, 256, 10, MSForms, CheckBox"
Attribute VB_Control = "Image_actx_amiral, 15, 11, MSForms, Image"
Attribute VB_Control = "ctrle_porte_avions, 142, 12, MSForms, CheckBox"
Attribute VB_Control = "ctrle_cuirasse, 143, 13, MSForms, CheckBox"
Attribute VB_Control = "ctrle_croiseur1, 144, 14, MSForms, CheckBox"
Attribute VB_Control = "ctrle_croiseur2, 145, 15, MSForms, CheckBox"
Attribute VB_Control = "ctrle_destroyer1, 146, 16, MSForms, CheckBox"
Attribute VB_Control = "ctrle_destroyer2, 147, 17, MSForms, CheckBox"
Attribute VB_Control = "LISTE_CHOIX_PAYS_JOUEUR, 1268, 18, MSForms, ComboBox"
Public NOUVEAU_TOUR_PASSER As Boolean 'passe sub controleurs

'////////////////////////////////////////////////////////////////////////////////////////////////
'JEU EXCEL DE LA BATAILLE NAVALE - TOUCH|fffd|/COUL|fffd|
'CODE - FEUILLE DE COMBAT
'////////////////////////////////////////////////////////////////////////////////////////////////


Private Sub confirm_plac_pa_Click()
'Controle de validation placement porte avion

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_porte_avions.Value = True And confirm_plac_pa.Value = True Then 'controle que controle gauche cliqu|fffd|
   Application.Speech.Speak "Control for choice vessel inactivate", True
   MsgBox "('|fffd| ~|fffd|)>  To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_pa.Value = False
End If
If confirm_plac_pa.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF7").Calculate
If Not Range("AF7").Value = 0 Then Exit Sub 'si navire non plac|fffd| sort directement
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False 'd|fffd|sactivation |fffd|vents
Application.ScreenUpdating = False 'd|fffd|sactivation affichage
Application.Calculation = xlCalculationManual 'calcul manuel sur ordre
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next 'gestionnaire d'erreur
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_PA_DEB", "ID_ADRESS_PA_FIN").ClearContents 'efface plage pr|fffd|c|fffd|dent jeu
MARCHEUR_ADRESSE_PA = 1 'compteur marcheur taille navire
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "PA" And Range("ID_ADRESS_PA_DEB").Value = "" Then
      Range("ID_ADRESS_PA_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_PA = 1 Then Range("AZ18").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_PA = 1 Then Range("BE18").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_PA = MARCHEUR_ADRESSE_PA + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "PA" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_PA_DEB").Value Then
      Range("ID_ADRESS_PA_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_PA = 2 Then Range("BA18").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_PA = 3 Then Range("BB18").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_PA = 4 Then Range("BC18").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_PA = 5 Then Range("BD18").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_PA = 2 Then Range("BF18").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_PA = 3 Then Range("BG18").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_PA = 4 Then Range("BH18").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_PA = 5 Then Range("BI18").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_PA = MARCHEUR_ADRESSE_PA + 1
      End If
   End If
Next

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate 'calcul de la feuille
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO7").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC7").Value = "FAUX"
   ctrle_porte_avions.Enabled = False
   ctrle_porte_avions.Value = False
   confirm_plac_pa.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Aircrafts carrier is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)>  Emplacement of your Aircrafts carrier isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_pa.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub confirm_plac_cu_Click()
'Controle de validation placement cuirass|fffd|

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_cuirasse.Value = True And confirm_plac_cu.Value = True Then 'controle que controle gauche cliqu|fffd|
   MsgBox "('|fffd| ~|fffd|)>  To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cu.Value = False
End If
If confirm_plac_cu.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF8").Calculate
If Not Range("AF8").Value = 0 Then Exit Sub 'si navire non plac|fffd| sort directement
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next 'gestionnaire d'erreur
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_CU_DEB", "ID_ADRESS_CU_FIN").ClearContents 'efface plage pr|fffd|c|fffd|dent jeu
MARCHEUR_ADRESSE_CU = 1
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "CU" And Range("ID_ADRESS_CU_DEB").Value = "" Then
      Range("ID_ADRESS_CU_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_CU = 1 Then Range("AZ19").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_CU = 1 Then Range("BE19").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_CU = MARCHEUR_ADRESSE_CU + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "CU" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_CU_DEB").Value Then
      Range("ID_ADRESS_CU_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_CU = 2 Then Range("BA19").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CU = 3 Then Range("BB19").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CU = 4 Then Range("BC19").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CU = 5 Then Range("BD19").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CU = 2 Then Range("BF19").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CU = 3 Then Range("BG19").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CU = 4 Then Range("BH19").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CU = 5 Then Range("BI19").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_CU = MARCHEUR_ADRESSE_CU + 1
      End If
   End If
Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO8").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC8").Value = "FAUX"
   ctrle_cuirasse.Enabled = False
   ctrle_cuirasse.Value = False
   confirm_plac_cu.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Battleship is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)>  Emplacement of your Battleship isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cu.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub confirm_plac_cr1_Click()
'Controle de validation placement porte avion

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_croiseur1.Value = True And confirm_plac_cr1.Value = True Then 'controle que controle gauche cliqu|fffd|
   MsgBox "('|fffd| ~|fffd|)>  To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cr1.Value = False
End If
If confirm_plac_cr1.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF9").Calculate
If Not Range("AF9").Value = 0 Then Exit Sub 'si navire non plac|fffd| sort directement
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next 'gestionnaire d'erreur
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_CR1_DEB", "ID_ADRESS_CR1_FIN").ClearContents
MARCHEUR_ADRESSE_CR1 = 1
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "CR1" And Range("ID_ADRESS_CR1_DEB").Value = "" Then
      Range("ID_ADRESS_CR1_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_CR1 = 1 Then Range("AZ20").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_CR1 = 1 Then Range("BE20").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_CR1 = MARCHEUR_ADRESSE_CR1 + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "CR1" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_CR1_DEB").Value Then
      Range("ID_ADRESS_CR1_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_CR1 = 2 Then Range("BA20").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR1 = 3 Then Range("BB20").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR1 = 4 Then Range("BC20").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR1 = 5 Then Range("BD20").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR1 = 2 Then Range("BF20").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR1 = 3 Then Range("BG20").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR1 = 4 Then Range("BH20").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR1 = 5 Then Range("BI20").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_CR1 = MARCHEUR_ADRESSE_CR1 + 1
      End If
   End If
Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO9").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC9").Value = "FAUX"
   ctrle_croiseur1.Enabled = False
   ctrle_croiseur1.Value = False
   confirm_plac_cr1.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Cruiser 1 is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)> Emplacement of your Cruiser 1 isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cr1.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub confirm_plac_cr2_Click()
'Controle de validation placement croiseur 2

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_croiseur2.Value = True And confirm_plac_cr2.Value = True Then 'controle que controle gauche cliqu|fffd|
   MsgBox "('|fffd| ~|fffd|)> To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cr2.Value = False
End If
If confirm_plac_cr2.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF10").Calculate
If Not Range("AF10").Value = 0 Then Exit Sub
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_CR2_DEB", "ID_ADRESS_CR2_FIN").ClearContents
MARCHEUR_ADRESSE_CR2 = 1
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "CR2" And Range("ID_ADRESS_CR2_DEB").Value = "" Then
      Range("ID_ADRESS_CR2_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_CR2 = 1 Then Range("AZ21").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_CR2 = 1 Then Range("BE21").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_CR2 = MARCHEUR_ADRESSE_CR2 + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "CR2" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_CR2_DEB").Value Then
      Range("ID_ADRESS_CR2_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_CR2 = 2 Then Range("BA21").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR2 = 3 Then Range("BB21").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR2 = 4 Then Range("BC21").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR2 = 5 Then Range("BD21").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_CR2 = 2 Then Range("BF21").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR2 = 3 Then Range("BG21").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR2 = 4 Then Range("BH21").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_CR2 = 5 Then Range("BI21").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_CR2 = MARCHEUR_ADRESSE_CR2 + 1
      End If
   End If
Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO10").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC10").Value = "FAUX"
   ctrle_croiseur2.Enabled = False
   ctrle_croiseur2.Value = False
   confirm_plac_cr2.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Cruiser 2 is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)>  Emplacement of your Cruiser 2 isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_cr2.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub confirm_plac_d1_Click()
'Controle de validation placement destroyer 1

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_destroyer1.Value = True And confirm_plac_d1.Value = True Then 'controle que controle gauche cliqu|fffd|
   MsgBox "('|fffd| ~|fffd|)>  To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_d1.Value = False
End If
If confirm_plac_d1.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF11").Calculate
If Not Range("AF11").Value = 0 Then Exit Sub
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_D1_DEB", "ID_ADRESS_D1_FIN").ClearContents
MARCHEUR_ADRESSE_D1 = 1
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "D1" And Range("ID_ADRESS_D1_DEB").Value = "" Then
      Range("ID_ADRESS_D1_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_D1 = 1 Then Range("AZ22").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_D1 = 1 Then Range("BE22").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_D1 = MARCHEUR_ADRESSE_D1 + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "D1" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_D1_DEB").Value Then
      Range("ID_ADRESS_D1_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_D1 = 2 Then Range("BA22").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D1 = 3 Then Range("BB22").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D1 = 4 Then Range("BC22").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D1 = 5 Then Range("BD22").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D1 = 2 Then Range("BF22").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D1 = 3 Then Range("BG22").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D1 = 4 Then Range("BH22").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D1 = 5 Then Range("BI22").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_D1 = MARCHEUR_ADRESSE_D1 + 1
      End If
   End If
Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO11").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC11").Value = "FAUX"
   ctrle_destroyer1.Enabled = False
   ctrle_destroyer1.Value = False
   confirm_plac_d1.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Frigate 1 is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)>  Emplacement of your Frigate 1 isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_d1.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub confirm_plac_d2_Click()
'Controle de validation placement destroyer 2

'-----------------------------------------------------------------------------------------------
'Process de non validation
If NOUVEAU_TOUR_PASSER = True Then Exit Sub 'correction bug, suite |fffd| activation enabled
If Not ctrle_destroyer2.Value = True And confirm_plac_d2.Value = True Then 'controle que controle gauche cliqu|fffd|
   MsgBox "('|fffd| ~|fffd|)>  To validate this emplacement, the control of choice must be clicked.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_d2.Value = False
End If
If confirm_plac_d2.Value = False Then
   Application.EnableEvents = True
   End
End If
Range("AF12").Calculate
If Not Range("AF12").Value = 0 Then Exit Sub
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'CALCUL Adresses des navires
Range("ID_ADRESS_D2_DEB", "ID_ADRESS_D2_FIN").ClearContents
MARCHEUR_ADRESSE_D2 = 1
'+++++++++++++++++++++++++++++++++++++++++++++++++++++++
For Each EMPLAC_NAVIRE In Range("Grille_strat|fffd|gique_de_votre_flotte")
   'I. Recherche premi|fffd|re cellule des navires
   If EMPLAC_NAVIRE.Value = "D2" And Range("ID_ADRESS_D2_DEB").Value = "" Then
      Range("ID_ADRESS_D2_DEB").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
      If MARCHEUR_ADRESSE_D2 = 1 Then Range("AZ23").Value = EMPLAC_NAVIRE.Column
      If MARCHEUR_ADRESSE_D2 = 1 Then Range("BE23").Value = EMPLAC_NAVIRE.Row
      MARCHEUR_ADRESSE_D2 = MARCHEUR_ADRESSE_D2 + 1
   Else
      'II. Recherche derni|fffd|re cellule des navires
      If EMPLAC_NAVIRE.Value = "D2" And EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False) <> Range("ID_ADRESS_D2_DEB").Value Then
      Range("ID_ADRESS_D2_FIN").Value = EMPLAC_NAVIRE.Address(RowAbsolute:=False, ColumnAbsolute:=False)
         If MARCHEUR_ADRESSE_D2 = 2 Then Range("BA23").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D2 = 3 Then Range("BB23").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D2 = 4 Then Range("BC23").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D2 = 5 Then Range("BD23").Value = EMPLAC_NAVIRE.Column
         If MARCHEUR_ADRESSE_D2 = 2 Then Range("BF23").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D2 = 3 Then Range("BG23").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D2 = 4 Then Range("BH23").Value = EMPLAC_NAVIRE.Row
         If MARCHEUR_ADRESSE_D2 = 5 Then Range("BI23").Value = EMPLAC_NAVIRE.Row
         MARCHEUR_ADRESSE_D2 = MARCHEUR_ADRESSE_D2 + 1
      End If
   End If
Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
ActiveSheet.Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Information de validation
If Range("AO12").Value = "OK" Then
   Application.Speech.Speak "Deployment validated!", True
   Range("AC12").Value = "FAUX"
   ctrle_destroyer2.Enabled = False
   ctrle_destroyer2.Value = False
   confirm_plac_d2.Enabled = False
   MsgBox "(|fffd| o|fffd|)>  Emplacement of your Frigate 2 is validated and fixed.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
Else
   Application.Speech.Speak "Deployment invalid!", True
   MsgBox "('|fffd| ~|fffd|)>  Emplacement of your Frigate 2 isn't valid." & Chr(10) & "To be valid, cells of this emplacement must be place on line, in horizontal or in vertical." & Chr(10) & "> Nothing emplacement in diagonal position." & Chr(10) & "> Nothing cells of sea or a other ship in middle of emplacement of your vessel.", vbInformation, "INFORMATION VALIDATION OF EMPLACEMENT"
   confirm_plac_d2.Value = False
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = True
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_croiseur1_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_croiseur1.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur2.Value = False
   ctrle_cuirasse.Value = False
   ctrle_destroyer1.Value = False
   ctrle_destroyer2.Value = False
   ctrle_porte_avions.Value = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_croiseur2_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_croiseur2.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur1.Value = False
   'ctrle_croiseur2.Enabled = False
   ctrle_cuirasse.Value = False
   ctrle_destroyer1.Value = False
   ctrle_destroyer2.Value = False
   ctrle_porte_avions.Value = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_cuirasse_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_cuirasse.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur1.Value = False
   ctrle_croiseur2.Value = False
   'ctrle_cuirasse.Enabled = False
   ctrle_destroyer1.Value = False
   ctrle_destroyer2.Value = False
   ctrle_porte_avions.Value = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_destroyer1_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_destroyer1.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur1.Value = False
   ctrle_croiseur2.Value = False
   ctrle_cuirasse.Value = False
   'ctrle_destroyer1.Enabled = False
   ctrle_destroyer2.Value = False
   ctrle_porte_avions.Value = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_destroyer2_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_destroyer2.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur1.Value = False
   ctrle_croiseur2.Value = False
   ctrle_cuirasse.Value = False
   ctrle_destroyer1.Value = False
   'ctrle_destroyer2.Enabled = False
   ctrle_porte_avions.Value = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub ctrle_porte_avions_Click()

'-----------------------------------------------------------------------------------------------
If ctrle_porte_avions.Value = True Then 'activation/d|fffd|activation pour placement unitaire des navires
   ctrle_croiseur1.Value = False
   ctrle_croiseur2.Value = False
   ctrle_cuirasse.Value = False
   ctrle_destroyer1.Value = False
   ctrle_destroyer2.Value = False
   'ctrle_porte_avions.Enabled = False
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub Image_actx_amiral_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Ev|fffd|nement de passage sur image, vice-amiral

'-----------------------------------------------------------------------------------------------
On Error Resume Next
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
If X < Image_actx_amiral.Width And X > Image_actx_amiral.Width - 10 Or Y < Image_actx_amiral.Height And Y > Image_actx_amiral.Height - 10 Then
   If Range("TOUR").Value = 0 Then 'Si tour 0, alors calcul phrase relatif |fffd| l'|fffd|tat de ce tour
      Range("BQ10").Calculate
      Range("PHRASES_ALEATOIRES").Calculate
      Application.Speech.Speak Range("PHRASE_AMIRAL_TOUR0").Value
   Else 'si tour autre que tour 0, alors phrases relatif |fffd| l'|fffd|tat de ces tours
      If Range("TOUR").Value > 0 And Range("TOUR").Value <> "END" Then
         Range("BR8").Calculate
         Range("PLAGE_PERTES").Calculate
         Range("PERTES").Calculate
         Range("PHRASES_ALEATOIRES").Calculate
         Application.Speech.Speak Range("PHRASE_AMIRAL_TOURS").Value
      End If
   End If
End If
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub LISTE_CHOIX_PAYS_JOUEUR_Change()
'Recalcul du choix du pays du joueur sur ordre

'-----------------------------------------------------------------------------------------------
Range("choix_pays_joueur").Calculate
'-----------------------------------------------------------------------------------------------
End Sub




Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
'Protocole de gestion du double clic dans le tableur feuille 1
On Error Resume Next

'------------------------------------------------------------------------------------------------------------------------------------
'I. D|fffd|sactivation entr|fffd|e par double click dans TABLEUR
If Not Intersect(Target, Range("TABLEAU")) Is Nothing Then
   
   Application.ScreenUpdating = False
   Cancel = True
   Application.ScreenUpdating = True
End If
'------------------------------------------------------------------------------------------------------------------------------------
    
'------------------------------------------------------------------------------------------------------------------------------------
'II. CALCUL DE TIR SUR GRILLE ADVERSE
If Not Intersect(Target, Range("Grille_strat|fffd|gie_adverse")) Is Nothing Then
   Application.Calculation = xlCalculationManual
   Application.ScreenUpdating = False
   ActiveSheet.Unprotect
   '------------------------------------------------------------------------------------------------------------------------------------
   If Target.Value = 1 And Range("NBTIR").Value <> 0 Then
      Range("CALCUL_TIR_COL").Formula = "=VLOOKUP(" & Target.Column & ",PLAGE_ADRESSE_COL_TIR,2,FALSE)" 'calcul de la colonne de tir
      Range("CALCUL_TIR_COL").Calculate
      If Range("CALCUL_TIR_COL").Value = "i" Then Range("CALCUL_TIR_COL").Value = "hih" 'correction probl|fffd|me narrateur sur prononciation du i
      Range("CALCUL_TIR_LIGNE").Formula = "=VLOOKUP(" & Target.Row & ",PLAGE_LIGNE_TIR,2,FALSE)" 'calcul de la ligne de tir
      Range("CALCUL_TIR_LIGNE").Calculate
      Application.Speech.Speak "ORDER OF FIRING AT, " & Range("CALCUL_TIR_COL").Value & "!" & Range("CALCUL_TIR_LIGNE").Value & "!", True 'action vocale
      Range("CALCUL_TIR_LIGNE").Calculate
      If Range("CALCUL_TIR_COL").Value = "hih" Then Range("CALCUL_TIR_COL").Value = "I" 'correction probl|fffd|me narrateur sur prononciation du i
      Target.Value = 8 'marqueur cible
      Target.Font.Name = "Wingdings 2"
      Range("NBTIR").Value = 0 'ordre de tir consomm|fffd|
      Range("ADRESSE_TIR_REELLE").Value = Target.Address
      Range("ADRESS_TIR").Value = Range("CALCUL_TIR_COL").Value & Range("CALCUL_TIR_LIGNE").Value
      Range("CALCUL_TIR_COL").Value = ""
      Range("CALCUL_TIR_LIGNE").Value = ""
   '------------------------------------------------------------------------------------------------------------------------------------
   Else
      If Target.Value = 8 Then 'zone de tir d|fffd|j|fffd| pr|fffd|vu, redouble clic annule action pr|fffd|vue
         Application.Speech.Speak "Cancel target of fire ", True
         Target.Value = 1
         Target.Font.Name = "Calibri"
         Range("NBTIR").Value = 1
         Range("ADRESSE_TIR_REELLE").Value = ""
         Range("ADRESS_TIR").Value = ""
      End If
      '------------------------------------------------------------------------------------------------------------------------------------
      If Target.Value = 0 Then 'tir d|fffd|j|fffd| r|fffd|alis|fffd|, zone ras
         Application.Speech.Speak "Target Incorect, this cell has fired and without enemies", True
      End If
      '------------------------------------------------------------------------------------------------------------------------------------
      If Target.Value < 0 Then 'tir d|fffd|j|fffd| r|fffd|alis|fffd|, ennemi touch|fffd|
         Application.Speech.Speak "Target Incorect, this cell has fired, enemie in the sector", True
      End If
   End If
   ActiveSheet.Protect
   Cancel = True
   Application.ScreenUpdating = True
End If
'_____________________________________________________________________________________________________________________________
End Sub




Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'Protocole de gestion des selection cellule dans la grille strat|fffd|gique du joueur

'------------------------------------------------------------------------
If Not Range("TOUR").Value = 0 Then Exit Sub  'seulement si tour 0 = placement sinon sort directement
'------------------------------------------------------------------------
On Error GoTo passerselection: 'gestionnaire d'erreur, pour |fffd|viter bug selection de plusieurs cellules
'Application.ScreenUpdating = False
'------------------------------------------------------------------------
   'Placement des navires par user, par clic cellules
   If Not Intersect(Target, Range("Grille_strat|fffd|gique_de_votre_flotte")) Is Nothing And Range("TOUR").Value = 0 Then
      Range("CODE_ID_A_PLACER").Calculate
      Range("PLAGE_PLACE").Calculate
      Range("PLAGE_A_PLACER").Calculate
      Range("RESTE_CDE_ID_A_PLACER").Calculate
         If Target.Value = 1 And Range("RESTE_CDE_ID_A_PLACER").Value > 0 Then
            Target.Value = Range("CODE_ID_A_PLACER").Value 'placement valeur id navire
            Range("PLAGE_PLACE").Calculate
            Range("PLAGE_A_PLACER").Calculate
            Range("RESTE_CDE_ID_A_PLACER").Calculate
         Else
            Target.Value = 1 'annulation placement
            Range("PLAGE_PLACE").Calculate
            Range("PLAGE_A_PLACER").Calculate
            Range("RESTE_CDE_ID_A_PLACER").Calculate
         End If
   End If
'------------------------------------------------------------------------
passerselection:
'Application.ScreenUpdating = True
'------------------------------------------------------------------------
End Sub




Sub TEST_SON_NARRATEUR()
'Tester si le narrateur windows et le son est activ|fffd| chez l'user

'-----------------------------------------------------------------
On Error Resume Next 'Si erreur passe
'-----------------------------------------------------------------

'-----------------------------------------------------------------
'Message vocale test
Application.Speech.Speak "Sound test!, of windows narrator", True
'Msgbox gestion probl|fffd|me
If MsgBox("(|fffd|0|fffd|)?  Did you hear the Windows narrator ?", vbYesNo + vbQuestion, "SOUND TEST NARRATOR") = vbYes Then
   'Ok fin
   Application.Speech.Speak "narrator Function confirmated", True
   MsgBox "v(^ u^)v Cool", vbInformation, "SOUND TEST NARRATORSOUND TEST NARRATOR"
Else
   MsgBox "(* |fffd|~|fffd|')  Possibilities of resolving this problem :" & Chr(10) & "> Your sound device is connected correctly ?" & Chr(10) & "> The sound turned on and the sound is strong enough ?" & Chr(10) & "> the Windows narrator is installed on your computer ?" & Chr(10) & Chr(10) & "... End of the problem solver", vbInformation, "SOUND TEST NARRATOR"
   'Fin du gestionnaire probl|fffd|me
End If
'-----------------------------------------------------------------
End Sub




Sub PLACEMENT_FLOTTE()
'PLACEMENT DE IMAGES NAVIRES

'-----------------------------------------------------------------
'Process de sortie particulier d'entr|fffd|e de sub
If Range("TOUR").Value <> 0 Then Exit Sub 'Si non tour = 0 de placement du jeu, sort
If ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).Fill.ForeColor.ObjectThemeColor = msoThemeColorText2 And ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).Fill.ForeColor.Brightness = -0.25 Then Exit Sub 'si bleu ciel sort - bouton d|fffd|sactiv|fffd|e
ActiveSheet.Calculate
If Not Range("VALID_PLACEMENTS_VAL").Value = "VRAI" Then
   Application.Speech.Speak "placement invalid of your fleet, cancel deployment", True  'action vocale
   MsgBox "('|fffd| ~|fffd|)>  Placement invalid of your fleet or controler of validation aren't clicked, please verificate and validate the placements", vbInformation, "PLACEMENT OF YOUR FLEET INVALID"
   Exit Sub
End If
'-----------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
Sheets("Param|fffd|tres").Visible = True 'rendre visible la feuille param|fffd|tres o|fffd| se trouve les images pour faire le copier coller
ActiveSheet.Calculate
ActiveSheet.Unprotect
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
On Error Resume Next 'gestionnaire d'erreur
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'PLACEMENT images navires sur feuille combat
'1. Coller les images des navires sur la feuille de combat
Worksheets("Param|fffd|tres").Select
Worksheets("Param|fffd|tres").Shapes.Range(Array("_PA", "_CU", "_CR1", "_CR2", "_D1", "_D2")).Select
Selection.Copy
Worksheets("BATTLESHEET").Select
Range("M10").Select 'coller image sur partie visible pour |fffd|viter bug collage et changement de taille
ActiveSheet.Paste
Range("Y22").Select
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Placement porte avions
If Worksheets("BATTLESHEET").Range("POS_HV_PA").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_PA")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_PA_DEB") & ":" & Range("ID_ADRESS_PA_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_PA")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_PA_DEB") & ":" & Range("ID_ADRESS_PA_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_PA")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_PA")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_PA_DEB") & ":" & Range("ID_ADRESS_PA_FIN")).Top + 49
   Worksheets("BATTLESHEET").Shapes.Range(Array("_PA")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_PA_DEB") & ":" & Range("ID_ADRESS_PA_FIN")).Left - 47
End If
'++++++++++++++++++++++++++++++++++++++++++++++++++++++
'Placement cuirass|fffd|
If Worksheets("BATTLESHEET").Range("POS_HV_CU").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CU")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CU_DEB") & ":" & Range("ID_ADRESS_CU_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CU")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CU_DEB") & ":" & Range("ID_ADRESS_CU_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CU")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CU")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CU_DEB") & ":" & Range("ID_ADRESS_CU_FIN")).Top + 37
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CU")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CU_DEB") & ":" & Range("ID_ADRESS_CU_FIN")).Left - 35
End If
'++++++++++++++++++++++++++++++++++++++++++++++++++++++
'Placement croiseurs 1 + 2
If Worksheets("BATTLESHEET").Range("POS_HV_CR1").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR1")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR1_DEB") & ":" & Range("ID_ADRESS_CR1_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR1")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR1_DEB") & ":" & Range("ID_ADRESS_CR1_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR1")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR1")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR1_DEB") & ":" & Range("ID_ADRESS_CR1_FIN")).Top + 25
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR1")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR1_DEB") & ":" & Range("ID_ADRESS_CR1_FIN")).Left - 23
End If
If Worksheets("BATTLESHEET").Range("POS_HV_CR2").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR2")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR2_DEB") & ":" & Range("ID_ADRESS_CR2_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR2")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR2_DEB") & ":" & Range("ID_ADRESS_CR2_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR2")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR2")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR2_DEB") & ":" & Range("ID_ADRESS_CR2_FIN")).Top + 25
   Worksheets("BATTLESHEET").Shapes.Range(Array("_CR2")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_CR2_DEB") & ":" & Range("ID_ADRESS_CR2_FIN")).Left - 23
End If
'++++++++++++++++++++++++++++++++++++++++++++++++++++++
'Placement destroyers 1 + 2
If Worksheets("BATTLESHEET").Range("POS_HV_D1").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D1")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D1_DEB") & ":" & Range("ID_ADRESS_D1_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D1")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D1_DEB") & ":" & Range("ID_ADRESS_D1_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D1")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D1")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D1_DEB") & ":" & Range("ID_ADRESS_D1_FIN")).Top + 13
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D1")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D1_DEB") & ":" & Range("ID_ADRESS_D1_FIN")).Left - 11
End If
If Worksheets("BATTLESHEET").Range("POS_HV_D2").Value = "LIGNE" Then
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D2")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D2_DEB") & ":" & Range("ID_ADRESS_D2_FIN")).Top + 1
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D2")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D2_DEB") & ":" & Range("ID_ADRESS_D2_FIN")).Left + 1
Else 'placement en colonne si position vertical
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D2")).IncrementRotation -90
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D2")).Top = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D2_DEB") & ":" & Range("ID_ADRESS_D2_FIN")).Top + 13
   Worksheets("BATTLESHEET").Shapes.Range(Array("_D2")).Left = Worksheets("BATTLESHEET").Range(Range("ID_ADRESS_D2_DEB") & ":" & Range("ID_ADRESS_D2_FIN")).Left - 11
End If
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'd|fffd|sactive le bouton liste d|fffd|roulante de choix pays joueur
LISTE_CHOIX_PAYS_JOUEUR.Enabled = False
'+++++++++++++++++++++++++++++++++++++++++++++++
'd|fffd|sactive le bouton d|fffd|ploiement
ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).Fill.ForeColor.RGB = 15849926 '15849926
ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14136213 '14136213
'ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).Fill.ForeColor.RGB = 8210719 '8210719 bleu fonc|fffd|
'ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 16051931 '16051931 texte bleu clair
'+++++++++++++++++++++++++++++++++++++++++++++++
'd|fffd|sactive bouton changer pays ennemi
ActiveSheet.Shapes.Range(Array("BOUTON_CHANGER_PAY")).Fill.ForeColor.RGB = 9737945 '9737945 rouge clair d|fffd|sactivation
ActiveSheet.Shapes.Range(Array("BOUTON_CHANGER_PAY")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair d|fffd|sactivation
'+++++++++++++++++++++++++++++++++++++++++++++++
'active bouton tir
'ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 '9737945 rouge clair
'ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 3487637 '3487637 rouge
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14347005 '14347005 orange clair
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
'Activation variable de tour 1
Range("NBTIR").Value = 1
Range("TOUR").Value = 1
Range("MOT_DEPLOY").Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Sheets("Param|fffd|tres").Visible = False 'cacher |fffd| nouveau feuille param|fffd|tres
Application.ScreenUpdating = True
Application.EnableEvents = True
Application.Calculation = xlCalculationManual
ActiveSheet.Protect
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.Speech.Speak "OK fleet deployed and ready for the battle!", True
MsgBox "(`|fffd|o|fffd|)> Your fleet is deployed and the fleet is ready for the battle." & Chr(10) & "Waiting of your firing order, please select one target.", vbInformation, "INFORMATION FLEET DEPLOYMENT"
'-----------------------------------------------------------------------------------------------
End Sub





Sub CHANGE_ENNEMI()
'Bouton changement ennemi

'-----------------------------------------------------------------------------------------------
If ActiveSheet.Shapes.Range(Array("BOUTON_CHANGER_PAY")).Fill.ForeColor.RGB = 9737945 Then Exit Sub 'si bouton inactif sortir
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = False
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Range("choix_pays_ennemi").Calculate 'calcul al|fffd|atoire choix pays et correspondance id = nom
Range("FIXE_CHOIX_ADVERSAIRE").Value = Range("choix_pays_ennemi").Value
Range("E1").Calculate
'-----------------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------------
Application.ScreenUpdating = True
'-----------------------------------------------------------------------------------------------
End Sub




Sub GENERATION_GRILLE_ADV()
'g|fffd|n|fffd|ration d'une nouvelle grille avec nouvelles positions al|fffd|atoire pour l'adversaire

'---------------------------------------------------------------------------
Dim GEN_STOP As Boolean 'variable arr|fffd|t 1
Dim ADRESSE_POS_NAV_AD As String 'variable adresse
Dim TAILLE_NAVIRE As Double 'variable taille navire
Dim CONFIRM_TAILLE_NAV As Double 'variable de comparaison taille en cours de position avec taille du navire
Dim ID_NAVIRE As String 'variable nom du navire
Dim PASSER As Boolean 'variable arr|fffd|t si navire positionn|fffd| dans un sens
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.ScreenUpdating = False
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'd|fffd|finition variables de d|fffd|marrage
GEN_STOP = False
TAILLE_NAVIRE = Range("TAILLE").Value 'd|fffd|marrage sur porte avion
ID_NAVIRE = "PA"
CONFIRM_TAILLE_NAV = 1 'soit |fffd|gale |fffd| la 1er cellule selectionn|fffd|e du d|fffd|marrage
PASSER = False
'++++++++++++++++++++++++++++++++++++++++++++
'calcul adresse navire |fffd| positionner
ADRESSE_POS_NAV_AD = Range("ADRESSE_POS_ADV").Value
'recalcul d'une adresse si r|fffd|sultat adresse grille non vide (soit non 1)
Do While Range(ADRESSE_POS_NAV_AD).Value <> 1 'tant que mer
Range("COLONNE_POS_ADV", "NB_NAV_AD_DEP").Calculate
ADRESSE_POS_NAV_AD = Range("ADRESSE_POS_ADV").Value
Loop
Range("GRILLE_ADV").Value = 1 'RAZ grille |fffd| 1
Range("NB_NAV_AD_DEP").Value = 0 'RAZ valeur navires d|fffd|ploy|fffd|s
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Positionnement des navires
Do While GEN_STOP = False 'Boucle g|fffd|n|fffd|rale
   '++++++++++++++++++++++++++++++++++++++++++++
   'lecture vers la droite pour positionnement valide du navire
   For i = 1 To TAILLE_NAVIRE - 1
      If Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value + i).Address).Value = 1 And CONFIRM_TAILLE_NAV <= TAILLE_NAVIRE And Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value + i).Address).Column <= 16383 And GEN_STOP = False And PASSER = False Then 'si cellule mer, si pas en dehors de la grille, si inf|fffd|rieur |fffd| taille de navire, si variable arr|fffd|t inactive
         CONFIRM_TAILLE_NAV = CONFIRM_TAILLE_NAV + 1 'ajout 1 |fffd| selection taille navire
         If CONFIRM_TAILLE_NAV = TAILLE_NAVIRE Then
            CONFIRM_TAILLE_NAV = 1
            If TAILLE_NAVIRE = 4 And ID_NAVIRE = "PA" Then ID_NAVIRE = "CU"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CR1" Then ID_NAVIRE = "CR2"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CU" Then ID_NAVIRE = "CR1"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "D1" Then ID_NAVIRE = "D2"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "CR2" Then ID_NAVIRE = "D1"
            Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value).Address, Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value + i).Address).Value = ID_NAVIRE
            Range("NB_NAV_AD_DEP").Value = Range("NB_NAV_AD_DEP").Value + 1
            If ID_NAVIRE = "CR1" Or ID_NAVIRE = "D1" Then
               TAILLE_NAVIRE = TAILLE_NAVIRE 'ne pas changer pour garder taille pour CR2 et D2
            Else
               TAILLE_NAVIRE = TAILLE_NAVIRE - 1
            End If
            If Range("NB_NAV_AD_DEP").Value = 6 Then GEN_STOP = True 'si ok selection arr|fffd|t
            PASSER = True
         End If
      Else
         CONFIRM_TAILLE_NAV = 1
         Exit For
      End If
   Next
   '++++++++++++++++++++++++++++++++++++++++++++
   'lecture vers le haut pour positionnement valide du navire en cours
   For i = 1 To TAILLE_NAVIRE - 1
      If Range(Cells(Range("LIGNE_POS_ADV").Value + i, Range("COLONNE_POS_ADV").Value).Address).Value = 1 And CONFIRM_TAILLE_NAV <= TAILLE_NAVIRE And Range(Cells(Range("LIGNE_POS_ADV").Value + i, Range("COLONNE_POS_ADV").Value).Address).Row >= 4 And GEN_STOP = False And PASSER = False Then
         CONFIRM_TAILLE_NAV = CONFIRM_TAILLE_NAV + 1
         If CONFIRM_TAILLE_NAV = TAILLE_NAVIRE Then
            CONFIRM_TAILLE_NAV = 1
            If TAILLE_NAVIRE = 4 And ID_NAVIRE = "PA" Then ID_NAVIRE = "CU"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CR1" Then ID_NAVIRE = "CR2"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CU" Then ID_NAVIRE = "CR1"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "D1" Then ID_NAVIRE = "D2"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "CR2" Then ID_NAVIRE = "D1"
            Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value).Address, Cells(Range("LIGNE_POS_ADV").Value + i, Range("COLONNE_POS_ADV").Value).Address).Value = ID_NAVIRE
            Range("NB_NAV_AD_DEP").Value = Range("NB_NAV_AD_DEP").Value + 1
            If Range("NB_NAV_AD_DEP").Value = 6 Then GEN_STOP = True
            If ID_NAVIRE = "CR1" Or ID_NAVIRE = "D1" Then
               TAILLE_NAVIRE = TAILLE_NAVIRE 'ne pas changer pour garder taille pour CR2 et D2
            Else
               TAILLE_NAVIRE = TAILLE_NAVIRE - 1
            End If
            PASSER = True
         End If
      Else
         CONFIRM_TAILLE_NAV = 1
         Exit For
      End If
   Next
   '++++++++++++++++++++++++++++++++++++++++++++
   'lecture vers la gauche pour positionnement valide du navire en cours
   For i = 1 To TAILLE_NAVIRE - 1
      If Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value - i).Address).Value = 1 And CONFIRM_TAILLE_NAV <= TAILLE_NAVIRE And Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value - i).Address).Column >= 16374 And GEN_STOP = False And PASSER = False Then
         CONFIRM_TAILLE_NAV = CONFIRM_TAILLE_NAV + 1
         If CONFIRM_TAILLE_NAV = TAILLE_NAVIRE Then
            CONFIRM_TAILLE_NAV = 1
            If TAILLE_NAVIRE = 4 And ID_NAVIRE = "PA" Then ID_NAVIRE = "CU"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CR1" Then ID_NAVIRE = "CR2"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CU" Then ID_NAVIRE = "CR1"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "D1" Then ID_NAVIRE = "D2"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "CR2" Then ID_NAVIRE = "D1"
            Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value).Address, Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value - i).Address).Value = ID_NAVIRE
            Range("NB_NAV_AD_DEP").Value = Range("NB_NAV_AD_DEP").Value + 1
            If Range("NB_NAV_AD_DEP").Value = 6 Then GEN_STOP = True
            If ID_NAVIRE = "CR1" Or ID_NAVIRE = "D1" Then
               TAILLE_NAVIRE = TAILLE_NAVIRE 'ne pas changer pour garder taille pour CR2 et D2
            Else
               TAILLE_NAVIRE = TAILLE_NAVIRE - 1
            End If
            PASSER = True
         End If
      Else
         CONFIRM_TAILLE_NAV = 1
         Exit For
      End If
   Next
   '++++++++++++++++++++++++++++++++++++++++++++
   'lecture vers le bas pour positionnement valide du navire en cours
   For i = 1 To TAILLE_NAVIRE - 1
      If Range(Cells(Range("LIGNE_POS_ADV").Value - i, Range("COLONNE_POS_ADV").Value).Address).Value = 1 And CONFIRM_TAILLE_NAV <= TAILLE_NAVIRE And Range(Cells(Range("LIGNE_POS_ADV").Value - i, Range("COLONNE_POS_ADV").Value).Address).Row <= 13 And GEN_STOP = False And PASSER = False Then
         CONFIRM_TAILLE_NAV = CONFIRM_TAILLE_NAV + 1
         If CONFIRM_TAILLE_NAV = TAILLE_NAVIRE Then
            CONFIRM_TAILLE_NAV = 1
            If TAILLE_NAVIRE = 4 And ID_NAVIRE = "PA" Then ID_NAVIRE = "CU"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CR1" Then ID_NAVIRE = "CR2"
            If TAILLE_NAVIRE = 3 And ID_NAVIRE = "CU" Then ID_NAVIRE = "CR1"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "D1" Then ID_NAVIRE = "D2"
            If TAILLE_NAVIRE = 2 And ID_NAVIRE = "CR2" Then ID_NAVIRE = "D1"
            Range(Cells(Range("LIGNE_POS_ADV").Value, Range("COLONNE_POS_ADV").Value).Address, Cells(Range("LIGNE_POS_ADV").Value - i, Range("COLONNE_POS_ADV").Value).Address).Value = ID_NAVIRE
            Range("NB_NAV_AD_DEP").Value = Range("NB_NAV_AD_DEP").Value + 1
            If Range("NB_NAV_AD_DEP").Value = 6 Then GEN_STOP = True
            If ID_NAVIRE = "CR1" Or ID_NAVIRE = "D1" Then
               TAILLE_NAVIRE = TAILLE_NAVIRE 'ne pas changer pour garder taille pour CR2 et D2
            Else
               TAILLE_NAVIRE = TAILLE_NAVIRE - 1
            End If
         End If
      Else
         CONFIRM_TAILLE_NAV = 1
         Exit For
      End If
   Next
   '++++++++++++++++++++++++++++++++++++++++++++
   PASSER = False 'raz variable arr|fffd|t ok selection positionnement navire en cours
    '---------------------------------------------------------------------------
    'Changement adresse navire suivant
    If GEN_STOP = False And Range("NB_NAV_AD_DEP").Value < 6 Then
        Range("COLONNE_POS_ADV", "NB_NAV_AD_DEP").Calculate
        ADRESSE_POS_NAV_AD = Range("ADRESSE_POS_ADV").Value
        'recalcul d'une adresse si r|fffd|sultat adresse grille non vide (soit non 1)
        Do While Range(ADRESSE_POS_NAV_AD).Value <> 1 'tant que pas mer
         Range("COLONNE_POS_ADV", "NB_NAV_AD_DEP").Calculate
         ADRESSE_POS_NAV_AD = Range("ADRESSE_POS_ADV").Value
        Loop
    End If
    '---------------------------------------------------------------------------
Loop
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.ScreenUpdating = False
'---------------------------------------------------------------------------
End Sub




Sub NOUVEAU_JEU()
'Remise |fffd| z|fffd|ro du jeu et reg|fffd|n|fffd|ration d'une nouvelle partie

'---------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
ActiveSheet.Unprotect
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
On Error Resume Next 'gestionnaire d'erreur
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'RAZ grille du tableau du joueur
Range("Grille_strat|fffd|gie_adverse").Value = 1 'RAZ grille adverse vision joueur
Range("Grille_strat|fffd|gique_de_votre_flotte").Value = 1 'RZA grille joueur
Range("GRILLE_ADV").Value = 1 'RAZ grille adverse pr|fffd|c|fffd|dente
Range("ETAT_NAVIRES").Calculate  'calcul plage ETAT_NAVIRES pour maj visuelle |fffd| user
'+++++++++++++++++++++++++++++++++++++++++++
'RAZ vie navire adverse
Range("ADV_VIE_PA").Value = 5
Range("ADV_VIE_CU").Value = 4
Range("ADV_VIE_CR1").Value = 3
Range("ADV_VIE_CR2").Value = 3
Range("ADV_VIE_D1").Value = 2
Range("ADV_VIE_D2").Value = 2
'+++++++++++++++++++++++++++++++++++++++++++
'RAZ vie navire joueur
Range("VIE_PORTE_AVION").Value = 5
Range("VIE_CUIRASSE").Value = 4
Range("VIE_CROISEUR1").Value = 3
Range("VIE_CROISEUR2").Value = 3
Range("VIE__DESTROYER1").Value = 2
Range("VIE_DESTROYER2").Value = 2
'+++++++++++++++++++++++++++++++++++++++++++
'RAZ variable tableur
Range("XDN17").Value = ""
Range("XDN18").Value = ""
Range("NBTIR").Value = 0
Range("TOUR").Value = 0
Range("ADRESS_TIR").Value = ""
Range("DISTANCE_FLOTTE_ADV").Calculate 'Calcul distance al|fffd|atoire en milles nautique
Range("DISTANCE_REP_ADV").Value = Range("DISTANCE_FLOTTE_ADV").Value
Range("REPERE_TIR_SUR_JOUEUR").Value = "" 'raz r|fffd|sultat pr|fffd|c|fffd|dente partie
Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" 'raz r|fffd|sultat pr|fffd|c|fffd|dente partie
'+++++++++++++++++++++++++++++++++++++++++++
'Suppression des fichiers images
Worksheets("BATTLESHEET").Shapes.Range(Array("_PA", "_CU", "_CR1", "_CR2", "_D1", "_D2")).Delete
If ActiveSheet.Shapes.Range(Array("amiral_lunettes")).Visible = msoTrue Then ActiveSheet.Shapes.Range(Array("amiral_lunettes")).Visible = msoFalse 'enlever image lunettes de soleil de la victoire du vice amiral
'+++++++++++++++++++++++++++++++++++++++++++
'RAZ controleurs navires
NOUVEAU_TOUR_PASSER = True 'Activation passe macro pour |fffd|viter les bugs d'activation des macros confir_plac
ctrle_croiseur1.Enabled = True
ctrle_croiseur2.Enabled = True
ctrle_cuirasse.Enabled = True
ctrle_destroyer1.Enabled = True
ctrle_destroyer2.Enabled = True
ctrle_porte_avions.Enabled = True
confirm_plac_pa.Enabled = True
confirm_plac_pa.Value = False
confirm_plac_cu.Enabled = True
confirm_plac_cu.Value = False
confirm_plac_cr1.Enabled = True
confirm_plac_cr1.Value = False
confirm_plac_cr2.Enabled = True
confirm_plac_cr2.Value = False
confirm_plac_d1.Enabled = True
confirm_plac_d1.Value = False
confirm_plac_d2.Enabled = True
confirm_plac_d2.Value = False
NOUVEAU_TOUR_PASSER = False 'd|fffd|sactivation passe macro pour les macros confir_plac
'+++++++++++++++++++++++++++++++++++++++++++
'd|fffd|sactivation/r|fffd|activation boutons
LISTE_CHOIX_PAYS_JOUEUR.Enabled = True 'd|fffd|sactive le bouton liste d|fffd|roulante de choix pays joueur
ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).Fill.ForeColor.RGB = 8210719 '8210719 bleu fonc|fffd|
ActiveSheet.Shapes.Range(Array("BOUTON_DEPLOIEMENT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 16051931 '16051931 texte bleu clair
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 '9737945 rouge clair
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair
ActiveSheet.Shapes.Range(Array("BOUTON_CHANGER_PAY")).Fill.ForeColor.RGB = 192 '192 rouge fonc|fffd| activation
ActiveSheet.Shapes.Range(Array("BOUTON_CHANGER_PAY")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair activation
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'G|fffd|n|fffd|ration d'une nouvelle grille de d|fffd|ploiement adverse
GENERATION_GRILLE_ADV 'g|fffd|n|fffd|ration nouvelle grille
BOUCLE_SUPPRESSION_FX 'suppression image fx de la partie pr|fffd|c|fffd|dente
Range("ETAT_NAVIRES").Calculate  'calcul plage ETAT_NAVIRES pour maj visuelle |fffd| user
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.Speech.Speak "NEW GAME GENERATE", True
MsgBox "(|fffd| o|fffd|)>  One new battle was generate", vbInformation, "CONFIRMATION NEW BATTLE"
'---------------------------------------------------------------------------
End Sub




Sub TOUR_SUIVANT()
'Protocole de passation de tour

'---------------------------------------------------------------------------------------------------------------------
Dim FIN_CORRECT_TIR_ADVERSE As Boolean 'variable d'arr|fffd|t pour la boucle
Dim PASSE_IF_CALC_TIR_ADV As Boolean 'variable d'arr|fffd|t des tests du tour de boucle en cours
Dim VOCAL_CELL_TIR_SUR_JOUEUR As String
'---------------------------------------------------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Process particulier de sortie de sub en entr|fffd| de sub
If ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 Then Exit Sub 'si bouton en rose = d|fffd|sactivation bouton
If Range("NBTIR").Value <> 0 Then Exit Sub 'si reste toujours un ordre de tir sortir
If Range("TOUR").Value = "END" Then Exit Sub 'si reste toujours un ordre de tir sortir
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Waitform.Show 'montrer l'userform d'attente des calculs de tir
Waitform.Repaint 'raffraichissement userform
Application.ScreenUpdating = False
Application.EnableEvents = False
Sheets("Param|fffd|tres").Visible = True 'faire apparaitre feuille param|fffd|tres pour r|fffd|cup|fffd|rer les images fx
ActiveSheet.Unprotect
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Calcul du tir du joueur
Range("ADRESSE_TIR_JOUEUR").Calculate
ADRESSE_TIR_JOUEUR = Range("ADRESSE_TIR_JOUEUR_CONVER").Value
'+++++++++++++++++++++++++++++++++++++++++++
'Calcul du r|fffd|sultat du tir du joueur
If Range(ADRESSE_TIR_JOUEUR).Value = 1 Then
   Range(ADRESSE_TIR_JOUEUR).Value = 0 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
   Application.Speech.Speak "Missed shot at " & Range("ADRESS_TIR").Value, True 'Message vocale rat|fffd|
   Range(Range("ADRESSE_TIR_REELLE").Value).Value = 0  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
   Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
'+++++++++++++++++++++++++++++++++++++++++++
Else
'+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "PA" Then  'tir sur porte avion
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_PA").Value = Range("ADV_VIE_PA").Value - 1
      If Range("ADV_VIE_PA").Value > 0 Then
         Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
         Application.Speech.Speak "Aircraft carrier ennemy sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CU" Then  'tir sur CUIRASSE
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CU").Value = Range("ADV_VIE_CU").Value - 1
      If Range("ADV_VIE_CU").Value > 0 Then
      Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "battleship ENNEMy sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CR1" Then  'tir sur CROISEUR 1
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CR1").Value = Range("ADV_VIE_CR1").Value - 1
      If Range("ADV_VIE_CR1").Value > 0 Then
      Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "cruiser ENNEMy sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "CR2" Then  'tir sur CROISEUR 2
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_CR2").Value = Range("ADV_VIE_CR2").Value - 1
      If Range("ADV_VIE_CR2").Value > 0 Then
      Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
   Else
      Application.Speech.Speak "cruiser ENNEMi sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "D1" Then  'tir sur DESTROYER 1
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_D1").Value = Range("ADV_VIE_D1").Value - 1
      If Range("ADV_VIE_D1").Value > 0 Then
      Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True  'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "frigate ENNEMy sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_JOUEUR).Value = "D2" Then  'tir sur DESTROYER 2
      Range(ADRESSE_TIR_JOUEUR).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("ADV_VIE_D2").Value = Range("ADV_VIE_D2").Value - 1
      If Range("ADV_VIE_D2").Value > 0 Then
      Application.Speech.Speak "damaged at " & Range("ADRESS_TIR").Value, True 'Message vocale touch|fffd|
      Else
      Application.Speech.Speak "frigate ENNEMy sunk!", True 'Message vocale coul|fffd|
      End If
      Range(Range("ADRESSE_TIR_REELLE").Value).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(Range("ADRESSE_TIR_REELLE").Value).Font.Name = "Calibri"
      Range("VIE_TOTAL_ADV").Calculate
      If Range("VIE_TOTAL_ADV").Value = 0 Then
         Application.Speech.Speak "fleet of ennemy is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Calcul d'une adresse de tir valide sur joueur
Range("XDN17").Value = "" 'raz valeur tour pr|fffd|c|fffd|dent
Range("XDN18").Value = "" 'raz valeur tour pr|fffd|c|fffd|dent
If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then 'process normal d'adresse de tir adverse = al|fffd|atoire
   Range("PLAGE_CALCUL_TIR_ADV").Calculate
   Range("CTRLE_OKQUADRIL_TIR_SUR_JOUEUR").Calculate 'calcul si tir dans zone quadrill|fffd|
   ADRESSE_TIR_ADV = Range("TIR_CALCUL_ADV_REELLE").Value
   CTRLE_TOUR = 1 'controleur compteur de tour de boucle do while pour par|fffd| boucle trop  longue
   Do While Range(ADRESSE_TIR_ADV).Value = -1 Or Range(ADRESSE_TIR_ADV).Value = 0 Or Range("CTRLE_OKQUADRIL_TIR_SUR_JOUEUR").Value = "NON" 'Si valeur cellule non 1 alors recalcul
      Range("PLAGE_CALCUL_TIR_ADV").Calculate 'calcul adresse al|fffd|atoire potentiel
      Range("CTRLE_OKQUADRIL_TIR_SUR_JOUEUR").Calculate 'calcul si tir dans zone quadrill|fffd|
         If CTRLE_TOUR <= 100 Then 'si boucle de calcul trop longue prendre n'importe quelle cell
            If Range("CTRLE_OKQUADRIL_TIR_SUR_JOUEUR").Value = "OUI" Then ADRESSE_TIR_ADV = Range("TIR_CALCUL_ADV_REELLE").Value
         Else
            ADRESSE_TIR_ADV = Range("TIR_CALCUL_ADV_REELLE").Value
         End If
      CTRLE_TOUR = CTRLE_TOUR + 1
   Loop
VOCAL_CELL_TIR_SUR_JOUEUR = Range("TIR_CALCUL_GRILLE_ADV").Value
'-------------------------------------------------------------------------
Else 'process si tir pr|fffd|c|fffd|dent sur cible navire enregistr|fffd|
'-------------------------------------------------------------------------
   FIN_CORRECT_TIR_ADVERSE = False
   PASSE_IF_CALC_TIR_ADV = False
   ADRESSE_TIR_ADV_COL = Range(Range("REPERE_TIR_SUR_JOUEUR").Value).Column '|fffd|clatement adresse par lecture adresse type cell ligne/colonne
   ADRESSE_TIR_ADV_LIGNE = Range(Range("REPERE_TIR_SUR_JOUEUR").Value).Row '|fffd|clatement adresse par lecture adresse type cell ligne/colonne
   TIR_MARCHEUR = 1 'tour de boucle commence |fffd| 1
   '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   'Boucle de recherche d'adresse de tir valide, suite |fffd| rep|fffd|rage cible
   Do While FIN_CORRECT_TIR_ADVERSE = False 'Si valeur cellule non 1 alors recalcul
      PASSE_IF_CALC_TIR_ADV = False 'mise par d|fffd|faut de l'interrupteur de calcul if de ce tour de boucle |fffd| false
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test |fffd| droite // 1
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column < 24 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then 'si mer
               If TIR_MARCHEUR > 1 Then 'correction bug mouvement de la triangulation de tir
                  Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
               Else
                  Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2 'tourne
               End If
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column < 24 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True 'activation passe test if suivant pour reprendre calcul tir dans le sens du test
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column > 23 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test en haut // 2
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 15 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then 'si mer
               If TIR_MARCHEUR > 1 Then 'correction bug mouvement de la triangulation de tir
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
               Else
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3 'tourne
               End If
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 15 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 16 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test |fffd| gauche // 3
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column > 13 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then 'si mer
               If TIR_MARCHEUR > 1 Then 'correction bug mouvement de la triangulation de tir
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
               Else
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4 'tourne
               End If
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column > 13 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True 'activation passe test if suivant pour reprendre calcul tir dans le sens du test
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column < 13 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test en bas // 4
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 26 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then 'si mer
               If TIR_MARCHEUR > 1 Then 'correction bug mouvement de la triangulation de tir
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
               Else
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1 'tourne
               End If
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4
               TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 26 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 25 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      TIR_MARCHEUR = TIR_MARCHEUR + 1
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'force changement sens si boucle infinie
      If TIR_MARCHEUR > 5 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
         If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2 Then Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3
         If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4 Then Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   Loop
   '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   'Fonction correction adresse vocale suite |fffd| tir particulier avec correction de tir, pour ressortir l'adresse r|fffd|elle de la grille joueur
   Range("XDN17").Value = Range(ADRESSE_TIR_ADV).Column
   Range("XDN18").Value = Range(ADRESSE_TIR_ADV).Row
   Range("CORR_VOC_TIR_SUR_JOUEUR").Calculate
   VOCAL_CELL_TIR_SUR_JOUEUR = Range("CORR_VOC_TIR_SUR_JOUEUR").Value
End If
'+++++++++++++++++++++++++++++++++++++++++++
'+++++++++++++++++++++++++++++++++++++++++++
'+++++++++++++++++++++++++++++++++++++++++++
'Calcul du r|fffd|sultat du tir sur joueur joueur
If Range(ADRESSE_TIR_ADV).Value = 1 Then
   Application.Speech.Speak "Enemy shot missed in " & VOCAL_CELL_TIR_SUR_JOUEUR, True 'Message vocale rat|fffd|
   Range(ADRESSE_TIR_ADV).Value = 0 'M|fffd|J r|fffd|sultat rat|fffd| dans grille joueur
   Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
   '1. Coller les images des navires sur la feuille de combat
   Worksheets("Param|fffd|tres").Select
   Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_RATE")).Select
   Selection.Copy
   Worksheets("BATTLESHEET").Select
   Range(ADRESSE_TIR_ADV).Select
   ActiveSheet.Paste
   'Ajustement IMAGE FX
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
   Range("Z23").Select
'+++++++++++++++++++++++++++++++++++++++++++
Else
'+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "PA" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_PORTE_AVION").Value = Range("VIE_PORTE_AVION").Value - 1
      If Range("VIE_PORTE_AVION").Value > 0 Then
         Application.Speech.Speak "your aircraft carrier is damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "your aircraft carrier is sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CU" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CUIRASSE").Value = Range("VIE_CUIRASSE").Value - 1
      If Range("VIE_CUIRASSE").Value > 0 Then
         Application.Speech.Speak "battleship damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "battleship sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CR1" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CROISEUR1").Value = Range("VIE_CROISEUR1").Value - 1
      If Range("VIE_CROISEUR1").Value > 0 Then
         Application.Speech.Speak "your cruiser 1 damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "your cruiser 1 sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "CR2" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_CROISEUR2").Value = Range("VIE_CROISEUR2").Value - 1
      If Range("VIE_CROISEUR2").Value > 0 Then
         Application.Speech.Speak "your cruiser 2 damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "your CRuiser 2 sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "D1" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE__DESTROYER1").Value = Range("VIE__DESTROYER1").Value - 1
      If Range("VIE__DESTROYER1").Value > 0 Then
         Application.Speech.Speak "your frigate 1 damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "your frigate 1 sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
   If Range(ADRESSE_TIR_ADV).Value = "D2" Then  'tir sur porte avion
      Range(ADRESSE_TIR_ADV).Value = -1 'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse
      Range("VIE_DESTROYER2").Value = Range("VIE_DESTROYER2").Value - 1
      If Range("VIE_DESTROYER2").Value > 0 Then
         Application.Speech.Speak "your frigate 2 damaged at " & VOCAL_CELL_TIR_SUR_JOUEUR, True  'Message vocale touch|fffd|
         If Range("REPERE_TIR_SUR_JOUEUR").Value = "" Then Range("REPERE_TIR_SUR_JOUEUR").Value = Range(ADRESSE_TIR_ADV).Address(RowAbsolute:=False, ColumnAbsolute:=False)
      Else
         Application.Speech.Speak "your frigate 2 sunk!", True 'Message vocale coul|fffd|
         Range("REPERE_TIR_SUR_JOUEUR").Value = ""
         Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
      End If
      Range(ADRESSE_TIR_ADV).Value = -1  'M|fffd|J r|fffd|sultat rat|fffd| dans grille adverse du joueur
      Range(ADRESSE_TIR_ADV).Font.Name = "Calibri"
      '__________________
      '1. Coller les images des navires sur la feuille de combat
      Worksheets("Param|fffd|tres").Select
      Worksheets("Param|fffd|tres").Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
      Selection.Copy
      Worksheets("BATTLESHEET").Select
      Range(ADRESSE_TIR_ADV).Select
      ActiveSheet.Paste
      'Ajustement IMAGE FX
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Height = Range(ADRESSE_TIR_ADV).Height - 1
      ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Width = Range(ADRESSE_TIR_ADV).Width - 1
      Range("Z23").Select
      '__________________
      Range("PLAGE_PERTES").Calculate
      Range("TOTAL_PERTES").Calculate
      Range("EQUIPAGE").Calculate
      Range("PERTES").Calculate
      If Range("TOTAL_PERTES").Value = 0 Then
         Application.Speech.Speak "your fleet is sunk!", True 'Message vocale flotte adverse compl|fffd|tement coul|fffd|e
         Range("TOUR").Value = "END"
      End If
   End If
   '+++++++++++++++++++++++++++++++++++++++++++
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'MaJ variables tableau
If Not Range("TOUR").Value = "END" Then Range("TOUR").Value = Range("TOUR").Value + 1 'changement compteur tour
If Not Range("TOUR").Value = "END" Then Range("NBTIR").Value = 1 'raz tir
Range("ADRESS_TIR").Value = "" 'raz adresse tir
Range("ETAT_NAVIRES").Calculate  'calcul plage ETAT_NAVIRES pour maj visuelle |fffd| user
If Range("TOUR").Value = "END" Then 'si fin du jeu
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).Fill.ForeColor.RGB = 9737945 '9737945 rouge clair
ActiveSheet.Shapes.Range(Array("BOUTON_TOUR_SUIVANT")).TextFrame2.TextRange.Font.Fill.ForeColor.RGB = 14408946 '14408946 rose clair
End If
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Sheets("Param|fffd|tres").Visible = False 'cacher feuille param|fffd|tres
Waitform.Hide 'cacher l'userform d'attente calculs termin|fffd|s
Application.EnableEvents = True
Application.ScreenUpdating = True
ActiveSheet.Protect
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Traitement de fin de partie
If Range("TOUR").Value = "END" Then
   If Range("TOTAL_PERTES").Value > 0 Then
      Application.Speech.Speak ">victory!, you win!", True
      ActiveSheet.Shapes.Range(Array("amiral_lunettes")).Visible = msoTrue 'modification image amiral si victoire
      MsgBox "(^-^)> __" & Range("AFFICH_NOM_ADV").Value & " defeated, Admiral__ (^-^)>" & Chr(10) & "VICTORY, the fleet of ennemy is sunk !" _
      & Chr(10) & Chr(10) & "(|fffd|-|fffd|)> State of your fleet : " _
      & Chr(10) & "> " & Range("N7").Value & " " & Range("W7").Value _
      & Chr(10) & "> " & Range("N8").Value & " " & Range("W8").Value _
      & Chr(10) & "> " & Range("N9").Value & " " & Range("W9").Value _
      & Chr(10) & "> " & Range("N10").Value & " " & Range("W10").Value _
      & Chr(10) & "> " & Range("N11").Value & " " & Range("W11").Value _
      & Chr(10) & "> " & Range("N12").Value & " " & Range("W12").Value _
      & Chr(10) & "> Casualties in the crews : " & Range("PERTES").Value & " on " & Range("EQUIPAGE").Value _
      , vbInformation, ">>> VICTORY <<<  END GAME"
   '+++++++++++++++++++++++++++++++++++++++++++++++++++
   Else
   '+++++++++++++++++++++++++++++++++++++++++++++++++++
      Application.Speech.Speak ">defeat!, game over", True
      MsgBox "('|fffd|-|fffd|)> __" & Range("AFFICH_NOM_ADV").Value & " you are defeat, Admiral__ ('0-|fffd|)>" & Chr(10) & "DEFAITE, your fleet was sunk !" _
      & Chr(10) & Chr(10) & "('_')> State of your fleet : " _
      & Chr(10) & "> " & Range("N7").Value & " " & Range("W7").Value _
      & Chr(10) & "> " & Range("N8").Value & " " & Range("W8").Value _
      & Chr(10) & "> " & Range("N9").Value & " " & Range("W9").Value _
      & Chr(10) & "> " & Range("N10").Value & " " & Range("W10").Value _
      & Chr(10) & "> " & Range("N11").Value & " " & Range("W11").Value _
      & Chr(10) & "> " & Range("N12").Value & " " & Range("W12").Value _
      & Chr(10) & "> Casualties in the crews : " & Range("PERTES").Value & " on " & Range("EQUIPAGE").Value _
      , vbInformation, ">>> VICTORY <<<  END GAME"
   End If
End If
'---------------------------------------------------------------------------
End Sub





Sub BOUCLE_SUPPRESSION_FX()
'suppression des images fx de la partie pr|fffd|c|fffd|dente

'---------------------------------------------------------------------------
Dim error_passe As Boolean 'Interrupteur de boucle de suppression
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.EnableEvents = False
Application.ScreenUpdating = False
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
'Suppression par boucles invers|fffd|es en 2 temps, par tant que pas d'erreur, si erreur passe, raz du gestionnaire d'erreur et boucle suivante
error_passe = False 'interrupteur prend valeur arr|fffd|t
On Error Resume Next 'boucle passe toute erreur
'+++++++++++++++++++++++++++++++++++++++++++
'Boucle effect tir rat|fffd|
Do While error_passe = False
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Select
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Delete
   Range("Z23").Select
   If Err > 0 Then error_passe = True 'si erreur passe la boucle pour la suivante
Loop
'+++++++++++++++++++++++++++++++++++++++++++
error_passe = False 'interrupteur prend valeur arr|fffd|t
On Error GoTo 0 'RAZ gestionnaire erreur en cours
On Error Resume Next
'+++++++++++++++++++++++++++++++++++++++++++
'boucle suppression effect navire touch|fffd|
Do While error_passe = False
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Select
   ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_TOUCHE")).Delete
   Range("Z23").Select
   If Err > 0 Then error_passe = True 'si erreur passe la boucle pour fin macro
Loop
'+++++++++++++++++++++++++++++++++++++++++++
error_passe = False 'interrupteur prend valeur arr|fffd|t
On Error GoTo 0 'RAZ gestionnaire erreur en cours
'---------------------------------------------------------------------------

'---------------------------------------------------------------------------
Application.EnableEvents = True
Application.ScreenUpdating = True
'---------------------------------------------------------------------------
End Sub


Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Sub AJUSTEMENT_IMAGE_A_TAILLE_CELLULES()
'Archive code Macro d'ajustement des images |fffd| la taille de la plage cellule

'Ajustement porte avion
ActiveSheet.Shapes.Range(Array("_PA")).Height = Range("G203:K203").Height - 2
ActiveSheet.Shapes.Range(Array("_PA")).Width = Range("G203:K203").Width - 2
'Ajustement cuirass|fffd|
ActiveSheet.Shapes.Range(Array("_CU")).Height = Range("G204:J204").Height - 2
ActiveSheet.Shapes.Range(Array("_CU")).Width = Range("G204:J204").Width - 2
'Ajustement croiseurs
ActiveSheet.Shapes.Range(Array("_CR1")).Height = Range("G205:I205").Height - 2
ActiveSheet.Shapes.Range(Array("_CR1")).Width = Range("G205:I205").Width - 2
ActiveSheet.Shapes.Range(Array("_CR2")).Height = Range("G206:I206").Height - 2
ActiveSheet.Shapes.Range(Array("_CR2")).Width = Range("G206:I206").Width - 2
'Ajustement destroyers
ActiveSheet.Shapes.Range(Array("_D1")).Height = Range("G207:H207").Height - 2
ActiveSheet.Shapes.Range(Array("_D1")).Width = Range("G207:H207").Width - 2
ActiveSheet.Shapes.Range(Array("_D2")).Height = Range("G208:H208").Height - 2
ActiveSheet.Shapes.Range(Array("_D2")).Width = Range("G208:H208").Width - 2
'Ajustement effects graphiques
ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Height = Worksheets("Feuille de combat").Range("q20").Height - 1
ActiveSheet.Shapes.Range(Array("IM_GSF_TIR_RATE")).Width = Worksheets("Feuille de combat").Range("q20").Width - 1

End Sub



Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'////////////////////////////////////////////////////////////////////////////////////////////////
'//// TOUCHE / COULE - BATAILLE NAVALE DANS EXCEL                                           ////
'////////////////////////////////////////////////////////////////////////////////////////////////




'////////////////////////////////////////////////////////////////////////////////////////////////
'//// Jeu touch|fffd|-coul|fffd| : Bataille Navale dans Excel
'//// Version du jeu : 1.3
'//// Proposition d'application par COHENNY Tristan ou Waard, pour le site Excel-Pratique
'////////////////////////////////////////////////////////////////////////////////////////////////


Private Sub Workbook_Open()
'Event |fffd| l'ouverture du jeu

'--------------------------------------------------------------------------------------
Application.Speech.Speak "Excel open and ready for a battle sea", True
'--------------------------------------------------------------------------------------
On Error Resume Next
Waitform.Show
Waitform.Hide
UserForm1.Show
'--------------------------------------------------------------------------------------

End Sub


Private Sub Workbook_BeforeClose(Cancel As Boolean)
'Event |fffd| la fermeture du jeu

'--------------------------------------------------------------------------------------
On Error Resume Next
Unload Waitform
'--------------------------------------------------------------------------------------

End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{948B9A22-B8C2-4696-880F-BDCC4C27314E}{2EA32E8F-ECF3-47A4-ADE4-7917DEBC8D7C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'EVENTS USERFORM


'I BOUTON QUITTER JEU
Private Sub CommandButton1_Click()
UserForm1.Hide
End Sub


'II BOUTON QUITTER JEU
Private Sub CommandButton2_Click()
ThisWorkbook.Close (False)
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Waitform"
Attribute VB_Base = "0{1F85B69D-460D-4B23-80DA-7C149A6C219C}{ECE15AAD-E509-42F6-82EA-647F9311715E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub UserForm_Initialize()
On Error Resume Next
Me.Repaint
End Sub
Attribute VB_Name = "arch_tir_rep|fffd|re_cible"
'Archive code pour la fonction de correction de tir suite |fffd| rep|fffd|rage cible sur 1er tir r|fffd|ussi
Sub TIR_SUR_CIBLE_REPEREE()

'---------------------------------------------------------------------------------------------------------------------
Dim FIN_CORRECT_TIR_ADVERSE As Boolean 'variable d'arr|fffd|t pour la boucle
Dim PASSE_IF_CALC_TIR_ADV As Boolean 'variable d'arr|fffd|t des tests du tour de boucle en cours
'---------------------------------------------------------------------------------------------------------------------

'---------------------------------------------------------------------------------------------------------------------
'Fonction correction adresse de tir suite |fffd| rep|fffd|rage cible
If Range("REPERE_TIR_SUR_JOUEUR").Value <> "" Then
   FIN_CORRECT_TIR_ADVERSE = False
   PASSE_IF_CALC_TIR_ADV = False
   ADRESSE_TIR_ADV_COL = Range(Range("REPERE_TIR_SUR_JOUEUR").Value).Column '|fffd|clatement adresse par lecture adresse type cell ligne/colonne
   ADRESSE_TIR_ADV_LIGNE = Range(Range("REPERE_TIR_SUR_JOUEUR").Value).Row '|fffd|clatement adresse par lecture adresse type cell ligne/colonne
   TIR_MARCHEUR = 1 'tour de boucle commence |fffd| 1
   '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   'Boucle de recherche d'adresse de tir valide, suite |fffd| rep|fffd|rage cible
   Do While FIN_CORRECT_TIR_ADVERSE = False 'Si valeur cellule non 1 alors recalcul
      PASSE_IF_CALC_TIR_ADV = False 'mise par d|fffd|faut de l'interrupteur de calcul if de ce tour de boucle |fffd| false
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test |fffd| droite // 1
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column < 24 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then
               Range(ADRESSE_TIR_ADV).Value = 0
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range(ADRESSE_TIR_ADV).Value = -1
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column < 24 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True 'activation passe test if suivant pour reprendre calcul tir dans le sens du test
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 1
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL + TIR_MARCHEUR).Address).Column > 23 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test en haut // 2
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 15 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then
               Range(ADRESSE_TIR_ADV).Value = 0
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range(ADRESSE_TIR_ADV).Value = -1
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 15 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 2
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE - TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 16 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value + 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test |fffd| gauche // 3
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column > 13 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then
               Range(ADRESSE_TIR_ADV).Value = 0
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range(ADRESSE_TIR_ADV).Value = -1
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column > 13 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True 'activation passe test if suivant pour reprendre calcul tir dans le sens du test
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 3
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE, ADRESSE_TIR_ADV_COL - TIR_MARCHEUR).Address).Column < 13 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      'test en bas // 4
      If Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4 Or Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = "" Then
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> 0 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value <> -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 26 And PASSE_IF_CALC_TIR_ADV = False Then
            ADRESSE_TIR_ADV = Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Address(RowAbsolute:=False, ColumnAbsolute:=False)
            If Range(ADRESSE_TIR_ADV).Value = 1 Then
               Range(ADRESSE_TIR_ADV).Value = 0
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = ""
            End If
            If Range(ADRESSE_TIR_ADV).Value <> 1 And Range(ADRESSE_TIR_ADV).Value <> 0 Then
               Range(ADRESSE_TIR_ADV).Value = -1
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4
            End If
            FIN_CORRECT_TIR_ADVERSE = True
            PASSE_IF_CALC_TIR_ADV = True
         Else
            'activation passe test if suivant pour reprendre calcul tir dans le sens du test
            If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Value = -1 And Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row < 26 And Range("REPERE_SENS_TIR_SUR_JOUEUR").Value <> "" Then
               PASSE_IF_CALC_TIR_ADV = True
               Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = 4
            End If
         End If
         'Recherche de tir pass|fffd| en dehors de la grille inversion du sens de lecture
         If Range(Cells(ADRESSE_TIR_ADV_LIGNE + TIR_MARCHEUR, ADRESSE_TIR_ADV_COL).Address).Row > 25 Then 'marcheur pass|fffd| en dehors de la grille, rechercher le navire en sens oppos|fffd|
            Range("REPERE_SENS_TIR_SUR_JOUEUR").Value = Range("REPERE_SENS_TIR_SUR_JOUEUR").Value - 2 'sens oppos|fffd|
            PASSE_IF_CALC_TIR_ADV = True 'passe tous les tests pour raz 0
            TIR_MARCHEUR = 0 'tour de boucle commence |fffd| 1
         End If
      End If
      '++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      TIR_MARCHEUR = TIR_MARCHEUR + 1
   Loop
End If
'---------------------------------------------------------------------------------------------------------------------

End Sub



INQUEST-PP=macro
