Attribute VB_Name = "Classe1"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Class_Initialize()

End Sub
Attribute VB_Name = "EstaPastaDeTrabalho"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "GerarPDF"

Sub Save_PDF()
'
' Save_PDF Macro
'
' Keyboard Shortcut: Ctrl+s
'

'www.contextures.com
'for Excel 2010 and later
Dim bol As Boolean

bol = Verifify_Sub(bol)

If bol = True Then

    
    Dim wsA As Worksheet
    Dim wbA As Workbook
    Dim strTime As String
    Dim strName As String
    Dim strPath As String
    Dim strFile As String
    Dim strPathFile As String
    Dim myFile As Variant
    On Error GoTo errHandler
    
    Set wbA = ActiveWorkbook
    Set wsA = ActiveSheet
    strTime = Format(Now(), "yyyymmdd\_hhmm")
    
    'get active workbook folder, if saved
    strPath = wbA.Path
    If strPath = "" Then
      strPath = Application.DefaultFilePath
    End If
    strPath = strPath & "\"
    
    'replace spaces and periods in sheet name
    strName = "Formul|fffd|rio_de_Cota|fffd||fffd|o"
    strName = Replace(strName, ".", "_")
    
    'create default name for savng file
    strFile = strName & "_" & strTime & ".pdf"
    strPathFile = strPath & strFile
    
    'use can enter name and
    ' select folder for file
    myFile = Application.GetSaveAsFilename _
        (InitialFileName:=strPathFile, _
            FileFilter:="PDF Files (*.pdf), *.pdf", _
            Title:="Select Folder and FileName to save")
    
    'export to PDF if a folder was selected
    If myFile <> "False" Then
        wsA.ExportAsFixedFormat _
            Type:=xlTypePDF, _
            Filename:=myFile, _
            Quality:=xlQualityStandard, _
            IncludeDocProperties:=True, _
            IgnorePrintAreas:=False, _
            OpenAfterPublish:=False
        'confirmation message with file info
        MsgBox "O PDF foi criado: " _
          & vbCrLf _
          & myFile
    End If
    
exitHandler:
        Exit Sub
errHandler:
        MsgBox "N|fffd|o foi poss|fffd|vel criar o PDF"
        Resume exitHandler

End If


End Sub

Function Verifify_Sub(ByVal bol As Boolean) As Boolean

' Verifica se campos obrigat|fffd|rios foram preenchidos

    ' Primeira parte
    
        ' Faz uma valida|fffd||fffd|o do CNPJ
        
    If VerificarCNPJ(Range("F6").Text) = False Then
        MsgBox ("CNPJ informado |fffd| inv|fffd|lido")
        Range("F6").Select
        Exit Function
    End If
    
    
    For Each Cel In Range("F4:F17")
        With Cel
            If .Value = "" Then
                MsgBox (.Offset(0, -4).Text & " deve ser preenchido")
                .Select
                Exit Function
            End If
        End With
    Next Cel
    
    ' Segunda parte - tabela de produtos
    
    Dim row_lim As Integer
            
    row_lim = Sheets(1).[last_cell].Row
    
    'Para a op|fffd||fffd|o Material
    If Sheets(1).Material.Value = True Then
        For Each Cel In Range("G20:T" & row_lim)
        With Cel
            If .Value = "" Then
                MsgBox (Cells(19, Cel.Column).Text & " deve ser preenchido")
                .Select
                Exit Function
            End If
        End With
        Next Cel
    End If
    
    'Para a op|fffd||fffd|o Servi|fffd|o
    Dim req_cels As Variant
    
    req_cels = Array(6, 8, 9, 12, 19, 20, 22)
    
    If Sheets(1).Servico.Value = True Then
        For Each Cel In Range("F20:V" & row_lim)
        With Cel
            If .Value = "" And IsInArray(.Column, req_cels) Then
                MsgBox (Cells(19, Cel.Column).Text & " deve ser preenchido")
                .Select
                Exit Function
            End If
        End With
        Next Cel
    End If
    
    Verifify_Sub = True
    
End Function

Private Function IsInArray(valToBeFound As Variant, arr As Variant) As Boolean
'DEVELOPER: Ryan Wells (wellsr.com)
'DESCRIPTION: Function to check if a value is in an array of values
'INPUT: Pass the function a value to search for and an array of values of any data type.
'OUTPUT: True if is in array, false otherwise
Dim element As Variant
On Error GoTo IsInArrayError: 'array is empty
    For Each element In arr
        If element = valToBeFound Then
            IsInArray = True
            Exit Function
        End If
    Next element
Exit Function
IsInArrayError:
On Error GoTo 0
IsInArray = False
End Function


Public Function VerificarCNPJ(sCNPJ As String) As Boolean

    sCNPJ = WorksheetFunction.Substitute(WorksheetFunction.Substitute(WorksheetFunction.Substitute(sCNPJ, ".", ""), "-", ""), "/", "")
    Dim d1 As Integer
    Dim d2 As Integer
    Dim d3 As Integer
    Dim d4 As Integer
    Dim d5 As Integer
    Dim d6 As Integer
    Dim d7 As Integer
    Dim d8 As Integer
    Dim d9 As Integer
    Dim d10 As Integer
    Dim d11 As Integer
    Dim d12 As Integer
    Dim d13 As Integer
    Dim d14 As Integer
    Dim DV1 As Integer
    Dim DV2 As Integer
    Dim UltDig As Integer
    
    'Completa com zeros |fffd| esquerda caso n|fffd|o esteja com os 14 digitos
    If Len(sCNPJ) < 14 Then
        sCNPJ = String(14 - Len(sCNPJ), "0") & sCNPJ
    End If
    
    'Pega a posi|fffd||fffd|o do |fffd|ltimo d|fffd|gito
    UltDig = Len(sCNPJ)
    
    'Sai da fun|fffd||fffd|o caso a c|fffd|lula esteja vazia
    If sCNPJ = "00000000000000" Then
        VerificarCNPJ = False
        Exit Function
    End If
    
    
    'Pega cada d|fffd|gito do CNPJ informado e
    'coloca nas vari|fffd|veis espec|fffd|ficas
    
    d1 = CInt(Mid(sCNPJ, UltDig - 13, 1))
    d2 = CInt(Mid(sCNPJ, UltDig - 12, 1))
    d3 = CInt(Mid(sCNPJ, UltDig - 11, 1))
    d4 = CInt(Mid(sCNPJ, UltDig - 10, 1))
    d5 = CInt(Mid(sCNPJ, UltDig - 9, 1))
    d6 = CInt(Mid(sCNPJ, UltDig - 8, 1))
    d7 = CInt(Mid(sCNPJ, UltDig - 7, 1))
    d8 = CInt(Mid(sCNPJ, UltDig - 6, 1))
    d9 = CInt(Mid(sCNPJ, UltDig - 5, 1))
    d10 = CInt(Mid(sCNPJ, UltDig - 4, 1))
    d11 = CInt(Mid(sCNPJ, UltDig - 3, 1))
    d12 = CInt(Mid(sCNPJ, UltDig - 2, 1))
    d13 = CInt(Mid(sCNPJ, UltDig - 1, 1))    '<----- Aqui s|fffd|o os DVs informados
    d14 = CInt(Mid(sCNPJ, UltDig, 1))    '<----- no CNPJ analizado
    
    '----------- Aqui |fffd| executado o calculo para obter os digitos verificadores corretos
    DV1 = (d1 * 6) + (d2 * 7) + (d3 * 8) + (d4 * 9) + (d5 * 2) + (d6 * 3) + (d7 * 4) + (d8 * 5) + (d9 * 6) + (d10 * 7) + (d11 * 8) + (d12 * 9)
    DV1 = DV1 Mod 11    'Obtem o resto
    'se o resto for igual a 10 altera pra 0
    If DV1 = 10 Then
        DV1 = 0
    End If
    
    DV2 = (d1 * 5) + (d2 * 6) + (d3 * 7) + (d4 * 8) + (d5 * 9) + (d6 * 2) + (d7 * 3) + (d8 * 4) + (d9 * 5) + (d10 * 6) + (d11 * 7) + (d12 * 8) + (DV1 * 9)
    DV2 = DV2 Mod 11    'Obtem o resto
    'se o resto for igual a 10 altera pra 0
    If DV2 = 10 Then
        DV2 = 0
    End If
    
    '---------- Fazendo a compara|fffd||fffd|o dos dvs informados -------
    If d13 = DV1 And d14 = DV2 Then
        VerificarCNPJ = True
    Else
        VerificarCNPJ = False
    End If

End Function


Attribute VB_Name = "M|fffd|dulo1"

Sub add_row()
'
' add_row Macro
'

'
    Rows("20:20").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Rows("20:20").RowHeight = 32
    Range("B20:S20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("B20:S20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("B20:S20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("B20:S20").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("B20:S20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("B20:S20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("E20").Activate
    Range("D20:E20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("D20:E20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("D20:E20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("D20:E20").Borders(xlEdgeTop).LineStyle = xlNone
    With Range("D20:E20").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("D20:E20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("D20:E20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("D20:E20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("E20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("E20").Borders(xlDiagonalUp).LineStyle = xlNone
    Range("E20").Borders(xlEdgeLeft).LineStyle = xlNone
    Range("E20").Borders(xlEdgeTop).LineStyle = xlNone
    Range("E20").Borders(xlEdgeBottom).LineStyle = xlNone
    With Range("E20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("E20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("E20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("E21").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("E21").Borders(xlDiagonalUp).LineStyle = xlNone
    Range("E21").Borders(xlEdgeLeft).LineStyle = xlNone
    Range("E21").Borders(xlEdgeTop).LineStyle = xlNone
    Range("E21").Borders(xlEdgeBottom).LineStyle = xlNone
    With Range("E21").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("E21").Borders(xlInsideVertical).LineStyle = xlNone
    Range("E21").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("D20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("D20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("D20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("D20").Borders(xlEdgeTop).LineStyle = xlNone
    Range("D20").Borders(xlEdgeBottom).LineStyle = xlNone
    Range("D20").Borders(xlEdgeRight).LineStyle = xlNone
    Range("D20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("D20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Range("E20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("E20").Borders(xlDiagonalUp).LineStyle = xlNone
    Range("E20").Borders(xlEdgeLeft).LineStyle = xlNone
    Range("E20").Borders(xlEdgeTop).LineStyle = xlNone
    Range("E20").Borders(xlEdgeBottom).LineStyle = xlNone
    With Range("E20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("E20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("E20").Borders(xlInsideHorizontal).LineStyle = xlNone

    Range("T20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("T20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("T20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("T20").Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("T20").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("T20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("T20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("T20").Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("F20:U20").Style = "Hyperlink"
    

    With Range("F20:T20")
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

    With Range("L20")
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 2
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
    
    
    
    
    With Range("F20:T20").Font
        .Name = "Calibri"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleSingle
        .ColorIndex = 5
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("F20:T20").Font
        .Name = "Calibri"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleSingle
        .ColorIndex = 5
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    With Range("B20:C20")
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 1
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("B20:C20").Merge
    
    Range("T20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("T20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("T20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("T20").Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("T20").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("T20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("T20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("T20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    
    Range("V20").Borders(xlDiagonalDown).LineStyle = xlNone
    Range("V20").Borders(xlDiagonalUp).LineStyle = xlNone
    With Range("V20").Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("V20").Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Range("V20").Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range("V20").Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Range("V20").Borders(xlInsideVertical).LineStyle = xlNone
    Range("V20").Borders(xlInsideHorizontal).LineStyle = xlNone
    
    For Each Cel In Range("F20:V20")
    With Cel
        .Interior.Pattern = xlNone
        .Interior.TintAndShade = 0
        .Interior.PatternTintAndShade = 0
    End With
    Next Cel
    
    Dim row_lim As Integer
                
    row_lim = Sheets(1).[last_cell].Row
    
    If Sheets(1).Servico.Value = True Then
    
        For Each Cel In Range("L20:L" & row_lim)
            With Cel
                .FormulaR1C1 = "0000.00.00"
                .HorizontalAlignment = xlGeneral
            End With
        Next Cel
        
        For Each Cel In Range("I20:I" & row_lim)
            With Cel
                .FormulaR1C1 = "UA"
            End With
        Next Cel
        
    
                
    End If
    
    If Sheets(1).Material.Value = True Then
       
        For Each Cel In Range("I20:I" & row_lim)
            With Cel
                .FormulaR1C1 = "CDA"
            End With
        Next Cel
        

    End If
    
    
    Range("F20").NumberFormat = "$ #,##0.00"
    Range("T20").Style = "Percent"
End Sub


Sub del_row()
'
' del_row Macro
'

'
    Dim row_lim As Integer
                
    row_lim = Sheets(1).[last_cell].Row
    If (row_lim <> 20) Then
        Rows("20:20").Delete Shift:=xlUp
    End If
    
End Sub

Private Function IsInArray(valToBeFound As Variant, arr As Variant) As Boolean
'DEVELOPER: Ryan Wells (wellsr.com)
'DESCRIPTION: Function to check if a value is in an array of values
'INPUT: Pass the function a value to search for and an array of values of any data type.
'OUTPUT: True if is in array, false otherwise
Dim element As Variant
On Error GoTo IsInArrayError: 'array is empty
    For Each element In arr
        If element = valToBeFound Then
            IsInArray = True
            Exit Function
        End If
    Next element
Exit Function
IsInArrayError:
On Error GoTo 0
IsInArray = False
End Function

Attribute VB_Name = "M|fffd|dulo2"
Attribute VB_Name = "M|fffd|dulo3"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Range("T20").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
End Sub
Sub Macro2()
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
'

'
    Range("F20:T20").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13434879
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Range("K38").Select
End Sub
Sub Macro3()
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
'

'
    Range("J31").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
End Sub
Sub Macro4()
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
'

'
    Range("V20").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("O32").Select
End Sub
Attribute VB_Name = "Planilha1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Material, 8, 5, MSForms, OptionButton"
Attribute VB_Control = "Servico, 9, 6, MSForms, OptionButton"

Private Sub Material_Click()
    ButtonReset
    Range("L18").FormulaR1C1 = "ADICIONAR PRODUTO:"
    Range("F19").FormulaR1C1 = "PRE|fffd|O NET"
    Range("G19").FormulaR1C1 = "PRE|fffd|O BRUTO SEM IPI"
    With Range("G19").Characters(Start:=1, Length:=20).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("G19").Characters(Start:=21, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("H19").FormulaR1C1 = "QUANTID."
    With Range("H19").Characters(Start:=1, Length:=9).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("H19").Characters(Start:=10, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("I19").FormulaR1C1 = "UN. MEDIDA"
    With Range("I19").Characters(Start:=1, Length:=11).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("I19").Characters(Start:=12, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("J19").FormulaR1C1 = "CFOP"
    With Range("J19").Characters(Start:=1, Length:=6).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("J19").Characters(Start:=7, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("K19").FormulaR1C1 = "CST"
    With Range("K19").Characters(Start:=1, Length:=5).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("K19").Characters(Start:=6, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("L19").FormulaR1C1 = "NCM"
    With Range("L19").Characters(Start:=1, Length:=4).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("L19").Characters(Start:=5, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("M19").FormulaR1C1 = "IPI %"
    With Range("M19").Characters(Start:=1, Length:=7).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("M19").Characters(Start:=8, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("N19").FormulaR1C1 = "IPI R$"
    With Range("N19").Characters(Start:=1, Length:=8).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("N19").Characters(Start:=9, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("O19").FormulaR1C1 = "BC ICMS"
    With Range("O19").Characters(Start:=1, Length:=9).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("O19").Characters(Start:=10, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("P19").FormulaR1C1 = "ICMS (%)"
    With Range("P19").Characters(Start:=1, Length:=10).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("P19").Characters(Start:=11, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("Q19").FormulaR1C1 = "ICMS R$"
    With Range("Q19").Characters(Start:=1, Length:=9).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("Q19").Characters(Start:=10, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("R19").FormulaR1C1 = "ICMS-ST"
    With Range("R19").Characters(Start:=1, Length:=9).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("R19").Characters(Start:=10, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    Range("S19").FormulaR1C1 = "VALOR TOTAL"
    With Range("R19").Characters(Start:=1, Length:=13).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("S19").Characters(Start:=14, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    Range("V19").FormulaR1C1 = "ISS (%)"
    
    Range("T19").FormulaR1C1 = "PRAZO DE ENTREGA"
    
    Dim row_lim As Integer
            
    row_lim = Sheets(1).[last_cell].Row

    For Each Cel In Range("L20:L" & row_lim)
        With Cel
            .FormulaR1C1 = ""
        End With
    Next Cel
    
    For Each Cel In Range("I20:I" & row_lim)
            With Cel
                .FormulaR1C1 = "CDA"
            End With
    Next Cel
    
    For Each Cel In Range("F19:T19")
    With Cel
        .Interior.PatternColorIndex = xlAutomatic
        .Interior.Color = 13434879
        .Interior.TintAndShade = 0
        .Interior.PatternTintAndShade = 0
    End With
    Next Cel
    
    For Each Cel In Range("V19:V19")
    With Cel
        .Interior.Pattern = xlNone
        .Interior.TintAndShade = 0
        .Interior.PatternTintAndShade = 0
    End With
    Next Cel
    
 
    
    
    
    
End Sub

Private Sub Servico_Click()
    ButtonReset
    Range("L18").FormulaR1C1 = "ADICIONAR SERVI|fffd|O:"
    Range("F19").FormulaR1C1 = "PRE|fffd|O NET"
    With Range("F19").Characters(Start:=1, Length:=15).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("F19").Characters(Start:=16, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("G19").FormulaR1C1 = "PRE|fffd|O BRUTO SEM IPI"
    Range("H19").FormulaR1C1 = "QUANTID."
    With Range("H19").Characters(Start:=1, Length:=9).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("H19").Characters(Start:=10, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("I19").FormulaR1C1 = "UN. MEDIDA"
    With Range("I19").Characters(Start:=1, Length:=11).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("I19").Characters(Start:=12, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("J19").FormulaR1C1 = "CFOP"
    Range("K19").FormulaR1C1 = "CST"
    Range("L19").FormulaR1C1 = "NCM"
    Range("M19").FormulaR1C1 = "IPI %"
    Range("N19").FormulaR1C1 = "IPI R$"
    Range("L19").FormulaR1C1 = "NCM"
    With Range("L19").Characters(Start:=1, Length:=4).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("L19").Characters(Start:=5, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range("M19").FormulaR1C1 = "IPI %"
    Range("N19").FormulaR1C1 = "IPI R$"
    Range("O19").FormulaR1C1 = "BC ICMS"
    Range("P19").FormulaR1C1 = "ICMS (%)"
    Range("Q19").FormulaR1C1 = "ICMS R$"
    Range("R19").FormulaR1C1 = "ICMS-ST"
    Range("U19").FormulaR1C1 = "ISS (%)"
    With Range("U19").Characters(Start:=1, Length:=8).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    With Range("U19").Characters(Start:=9, Length:=1).Font
        .Name = "Calibri"
        .FontStyle = "Negrito"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = -16776961
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    
    Dim row_lim As Integer
            
    row_lim = Sheets(1).[last_cell].Row

    For Each Cel In Range("L20:L" & row_lim)
        With Cel
            .FormulaR1C1 = "0000.00.00"
        End With
    Next Cel
    
    For Each Cel In Range("I20:I" & row_lim)
            With Cel
                .FormulaR1C1 = "UA"
            End With
    Next Cel
    
    req_cels = Array(6, 8, 9, 12, 19, 20, 22)
    
        For Each Cel In Range("F19:V19")
            With Cel
                If IsInArray(.Column, req_cels) Then
                    .Interior.PatternColorIndex = xlAutomatic
                    .Interior.Color = 13434879
                    .Interior.TintAndShade = 0
                    .Interior.PatternTintAndShade = 0
                Else
                    .Interior.Pattern = xlNone
                    .Interior.TintAndShade = 0
                    .Interior.PatternTintAndShade = 0
                End If
            End With
        Next Cel
    
    
End Sub


Sub ButtonReset()
' To FIX ActiveX Controls Resizing Bug

Sheets(1).Servico.Left = Sheets(1).Servico.Left + 1
Sheets(1).Servico.Left = Sheets(1).Servico.Left - 1

Sheets(1).Material.Left = Sheets(1).Material.Left + 1
Sheets(1).Material.Left = Sheets(1).Material.Left - 1


End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub

Private Function IsInArray(valToBeFound As Variant, arr As Variant) As Boolean
'DEVELOPER: Ryan Wells (wellsr.com)
'DESCRIPTION: Function to check if a value is in an array of values
'INPUT: Pass the function a value to search for and an array of values of any data type.
'OUTPUT: True if is in array, false otherwise
Dim element As Variant
On Error GoTo IsInArrayError: 'array is empty
    For Each element In arr
        If element = valToBeFound Then
            IsInArray = True
            Exit Function
        End If
    Next element
Exit Function
IsInArrayError:
On Error GoTo 0
IsInArray = False
End Function
Attribute VB_Name = "Planilha2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' )^J)

INQUEST-PP=macro
