Attribute VB_Name = "DRUCK"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim speicherpfadbackup
Dim zaehler

Private WithEvents m_Menu1 As CommandBarButton
Attribute m_Menu1.VB_VarHelpID = -1
Private WithEvents m_Menu2 As CommandBarButton
Attribute m_Menu2.VB_VarHelpID = -1
Private WithEvents m_Menu3 As CommandBarButton
Attribute m_Menu3.VB_VarHelpID = -1
Private WithEvents m_Menu4 As CommandBarComboBox
Attribute m_Menu4.VB_VarHelpID = -1
Private WithEvents m_Menu5 As CommandBarComboBox
Attribute m_Menu5.VB_VarHelpID = -1
Private WithEvents m_Menu6 As CommandBarButton
Attribute m_Menu6.VB_VarHelpID = -1

Private Sub m_Menu1_Click( _
ByVal Ctrl As Office.CommandBarButton, _
CancelDefault As Boolean _
)
Zurueck
CancelDefault = True
End Sub

Private Sub m_Menu2_Click( _
ByVal Ctrl As Office.CommandBarButton, _
CancelDefault As Boolean _
)
Startx
CancelDefault = True
End Sub

Private Sub m_Menu3_Click( _
ByVal Ctrl As Office.CommandBarButton, _
CancelDefault As Boolean _
)
Vorwaerts
CancelDefault = True
End Sub

Private Sub m_Menu4_change( _
ByVal Ctrl As Office.CommandBarComboBox)

Auswahl
'CancelDefault = True
End Sub

Private Sub m_Menu5_change( _
ByVal Ctrl As Office.CommandBarComboBox)

Auswahl2
'CancelDefault = True
End Sub



Private Sub m_Menu6_Click( _
ByVal Ctrl As Office.CommandBarButton, _
CancelDefault As Boolean _
)
Hilfe2
CancelDefault = True
End Sub



Private Sub Workbook_Activate()
Dim cb As CommandBar

For Each cb In Application.CommandBars
 If cb.Name = "Haufe-V" Then Exit Sub
Next cb
SymbolLeisteErstellen
If ThisWorkbook.BuiltinDocumentProperties("Category").Value <> "" Then
ActiveWindow.Caption = "Haufe_" & ThisWorkbook.Sheets("Startseite").Range("B1").Value & "_" & ThisWorkbook.BuiltinDocumentProperties("Category").Value
Else
ActiveWindow.Caption = "Haufe_" & ThisWorkbook.Sheets("Startseite").Range("B1").Value
End If
StatusleisteEdit
Application.CommandBars("ply").Enabled = False

Set m_Menu1 = Application.CommandBars("Haufe-V").Controls(1) ' zur|fffd|ck
Set m_Menu2 = Application.CommandBars("Haufe-V").Controls(2) ' Hause
Set m_Menu3 = Application.CommandBars("Haufe-V").Controls(3) ' vor
Set m_Menu4 = Application.CommandBars("Haufe-V").Controls(7) ' Tabellenauswahl
Set m_Menu5 = Application.CommandBars("Haufe-V").Controls(16) ' Optionen
Set m_Menu6 = Application.CommandBars("Haufe-V").Controls(18)


SpeichernWeg
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Dim i As Integer


Application.ScreenUpdating = False
On Error Resume Next
SymbolLeisteLoeschen
SpeichernDa


Application.ScreenUpdating = True
End Sub

Private Sub Workbook_BeforePrint(Cancel As Boolean)

If ActiveSheet.Name = "Startseite" Then
'START.Shapes("Picture 15").Visible = False
End If

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
Dim strDat As String
Dim VarDat As Variant
Dim strname As String
Dim s As String

 
'Online-Variante
If InStr(ThisWorkbook.Path, "Temporary Internet Files") > 0 Then

On Error Resume Next
Kill ThisWorkbook.Path & "\Temporary Internet Files\" & ThisWorkbook.BuiltinDocumentProperties("Category") & ".xls"

zaehler = InStr(ThisWorkbook.Path, "Temporary Internet Files") - 1
speicherpfadbackup = Mid(ThisWorkbook.Path, 1, zaehler)
End If
speicherpfadbackup = Mid(ThisWorkbook.Path, 1, zaehler) & "\" & ThisWorkbook.BuiltinDocumentProperties("Category") & ".xls"

 
'MIME-Variante
strname = Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4)
If InStr(UCase(ThisWorkbook.FullName), "MIME\") > 0 Then
 If MsgBox("Bitte speichern Sie diese Datei au|fffd|erhalb des installierten Produktes " & vbLf & _
 "in einem Verzeichnis Ihrer Wahl - es besteht sonst die Gefahr, dass von " & vbLf & _
 "Ihnen eingegebene Daten bei einem Produktupdate verloren gehen.", vbOKCancel + vbInformation) = vbOK Then
 
 ChDir "C:\"
 CurDir "c:\"

 Application.EnableEvents = False
 s = Application.GetSaveAsFilename
 
 
 If s = "Falsch" Then
 Application.EnableEvents = True
 Cancel = True
 Exit Sub
 Else
  If InStr(UCase(CurDir), "MIME\") > 0 Then
    MsgBox "Bitte speichern Sie diese Datei au|fffd|erhalb des installierten Produktes " & vbLf & _
   "in einem Verzeichnis Ihrer Wahl - es besteht sonst die Gefahr, dass von " & vbLf & _
   "Ihnen eingegebene Daten bei einem Produktupdate verloren gehen.", vbInformation
   Cancel = True
   Application.EnableEvents = True
   Exit Sub
  Else
  On Error Resume Next
  ThisWorkbook.SaveAs s
  End If
  
  
  
 End If
 
 Application.EnableEvents = True
 SaveAsUI = True
 Cancel = True
  Else
  Cancel = True
   SaveAsUI = False
 End If

 End If

EreignisAn
 
End Sub


Private Sub Workbook_Deactivate()
Application.CommandBars("ply").Enabled = True
SymbolLeisteLoeschen
Application.StatusBar = False
SpeichernDa
End Sub

Private Sub Workbook_NewSheet(ByVal Sh As Object)
Application.CommandBars("Haufe-V").Controls(7).AddItem Sh.Name
End Sub

Private Sub Workbook_Open()
Dim Blatt As Worksheet
Dim i As Integer
Dim strname As String

'Tabellen und Diagramme ausblenden. Nur Tabellen ausblenden, bei denen die letzte Spalte nicht sichtbar ist
For i = 1 To ThisWorkbook.Sheets.Count
 If TypeName(Sheets(i)) = "Worksheet" Then
 If Sheets(i).Columns(256).Hidden = True Then
 Else
  Sheets(i).Visible = True
 End If
End If

If TypeName(Sheets(i)) = "Chart" Then
 Sheets(i).Visible = True
End If

Next i



On Error Resume Next
'Test gleich beim |fffd|ffnen - lokal speichern
If InStr(ThisWorkbook.Path, "Temporary Internet Files") > 0 Then
zaehler = InStr(ThisWorkbook.Path, "Temporary Internet Files") - 1
speicherpfadbackup = Mid(ThisWorkbook.Path, 1, zaehler)
Application.DisplayAlerts = False
Application.DisplayStatusBar = False
ThisWorkbook.SaveAs speicherpfadbackup & ThisWorkbook.BuiltinDocumentProperties("Category")
Application.DisplayStatusBar = True
Application.DisplayAlerts = True
End If


'F|fffd|r Excel 2007 - Zoom auf Hilfe-Seite hochsetzen, damit Grafiken richtig angezeigt werden
If Application.Version = "12.0" Then
Application.ScreenUpdating = False
 HILFE.Activate
 ActiveWindow.Zoom = 100
 START.Activate
Application.ScreenUpdating = True
End If

Sheets("Startseite").Activate
SymbolLeisteErstellen
SymbolleisteSchuetzen
StatusleisteEdit


If IsNumeric(Mid(ThisWorkbook.BuiltinDocumentProperties("Category").Value, 3)) = True And ThisWorkbook.BuiltinDocumentProperties("Category").Value <> "" Then
  ActiveWindow.Caption = "Haufe_" & ThisWorkbook.Sheets("Startseite").Range("B1").Value & "_" & ThisWorkbook.BuiltinDocumentProperties("Category").Value
  Else
  ActiveWindow.Caption = ThisWorkbook.Name
End If


ThisWorkbook.Sheets("VERLAUF").Columns(1).ClearContents
ThisWorkbook.Sheets("VERLAUF").Range("A1").Value = "Startseite"


For Each Blatt In ThisWorkbook.Worksheets

 If Blatt.Visible = True Then
  'Blatt.Unprotect
  Blatt.DisplayPageBreaks = False
  Blatt.EnableOutlining = True
  Blatt.EnableAutoFilter = True
  'Blatt.Protect contents:=True, userInterfaceOnly:=True
 End If

Next Blatt


Set m_Menu1 = Application.CommandBars("Haufe-V").Controls(1) ' zur|fffd|ck
Set m_Menu2 = Application.CommandBars("Haufe-V").Controls(2) ' Hause
Set m_Menu3 = Application.CommandBars("Haufe-V").Controls(3) ' vor
Set m_Menu4 = Application.CommandBars("Haufe-V").Controls(7) ' Tabellenauswahl
Set m_Menu5 = Application.CommandBars("Haufe-V").Controls(16) ' Optionen
Set m_Menu6 = Application.CommandBars("Haufe-V").Controls(18)


SpeichernWeg
Application.CommandBars("ply").Enabled = False
ActiveWindow.DisplayWorkbookTabs = True


On Error Resume Next
START.Shapes("TextMakro").Visible = False


'Zusatz zwecks Pr|fffd|fung des Fenstertitels
'Benutzerdefinierter Dateiname in Fensterzeile
strname = Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4)
If InStr(strname, Mid(ThisWorkbook.BuiltinDocumentProperties("Category").Value, 3)) > 0 And ThisWorkbook.BuiltinDocumentProperties("Category").Value <> "" Or _
  strname = "KlFoVo" Then
  ActiveWindow.Caption = "Haufe_" & ThisWorkbook.Sheets("Startseite").Range("B1").Value & "_" & ThisWorkbook.BuiltinDocumentProperties("Category").Value
  Else
  ActiveWindow.Caption = ThisWorkbook.Name
  ThisWorkbook.BuiltinDocumentProperties("Category").Value = ""
End If


End Sub

Private Sub Workbook_SheetActivate(ByVal Sh As Object)
Dim Treffer As Range
Dim strname As String

If Sh.Name = "VERLAUF" Then Exit Sub
If Sh.Name = "Tabvorlage (2)" Then Exit Sub


 With ThisWorkbook.Sheets("VERLAUF")
Set Treffer = .Columns(1).Find(what:=Sh.Name, lookat:=xlWhole)
If Treffer Is Nothing Then
 .Cells(.Range("A65536").End(xlUp).Row + 1, 1).Value = Sh.Name
 Else
End If
 
 End With

'Listbox synchronisieren
LBSynchron

On Error Resume Next
Application.CommandBars("Haufe-V").Controls(7).Text = Sh.Name

Sh.DisplayPageBreaks = False

'Zusatz zwecks Pr|fffd|fung des Fenstertitels
'Benutzerdefinierter Dateiname in Fensterzeile
strname = Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4)
If InStr(strname, Mid(ThisWorkbook.BuiltinDocumentProperties("Category").Value, 3)) > 0 And ThisWorkbook.BuiltinDocumentProperties("Category").Value <> "" Or _
  strname = "KlFoVo" Then
  ActiveWindow.Caption = "Haufe_" & ThisWorkbook.Sheets("Startseite").Range("B1").Value & "_" & ThisWorkbook.BuiltinDocumentProperties("Category").Value
  Else
  ActiveWindow.Caption = ThisWorkbook.Name
  ThisWorkbook.BuiltinDocumentProperties("Category").Value = ""
End If



End Sub










Attribute VB_Name = "HILFE"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "ICONS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Modul1"
Sub Startseite()
Attribute Startseite.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Startseite.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Startseite Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("Startseite").Select
End Sub
Sub BWA_Monatswerte()
Attribute BWA_Monatswerte.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute BWA_Monatswerte.VB_ProcData.VB_Invoke_Func = " \n14"
'
' BWA_Monatswerte Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("BWA - Monatswerte").Select
    Range("A2").Select
End Sub
Sub BWA_Kumulierte_Jahreswerte()
Attribute BWA_Kumulierte_Jahreswerte.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute BWA_Kumulierte_Jahreswerte.VB_ProcData.VB_Invoke_Func = " \n14"
'
' BWA_Kumulierte_Jahreswerte Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("BWA - Kumulierte Jahreswerte").Select
    Range("A2").Select
End Sub
Attribute VB_Name = "Modul2"
Sub Relationen_Erstes_Halbjahr()
Attribute Relationen_Erstes_Halbjahr.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Relationen_Erstes_Halbjahr.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Relationen_Erstes_Halbjahr Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("BWA - Relationen 1. HJ").Select
    Range("A3").Select
End Sub
Sub Relationen_Zweites_Halbjahr()
Attribute Relationen_Zweites_Halbjahr.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Relationen_Zweites_Halbjahr.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Relationen_Zweites_Halbjahr Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("BWA - Relationen 2. HJ").Select
End Sub
Sub Datenanzeige_als_Diagramm()
Attribute Datenanzeige_als_Diagramm.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Datenanzeige_als_Diagramm.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Datenanzeige_als_Diagramm Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    Sheets("Datenanzeige als Diagramm").Select
    ActiveSheet.ChartObjects("Diagramm 33").Activate
'    Windows("BWA-Daten|fffd|bersicht.xls").SmallScroll Down:=-60
    ActiveWindow.Visible = False
'    Windows("BWA-Daten|fffd|bersicht.xls").Activate
    Range("B2").Select
End Sub
Sub Diagrammanzeige()
Attribute Diagrammanzeige.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Diagrammanzeige.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Diagrammanzeige Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    ActiveWindow.SmallScroll Down:=20
    Range("B24").Select
End Sub
Sub Datenauswahl()
Attribute Datenauswahl.VB_Description = "Makro am 31.01.2006 von Kiermeier aufgezeichnet"
Attribute Datenauswahl.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Datenauswahl Makro
' Makro am 31.01.2006 von Kiermeier aufgezeichnet
'

'
    ActiveWindow.SmallScroll Down:=-8
    Range("B1").Select
End Sub
Attribute VB_Name = "START"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Private Sub Worksheet_SelectionChange(ByVal Target As Range)

 'If Target.Address = "TabkonfigAn" Then TabKonfigZeigen
If Intersect(Target, Range("TabKonfigAn")) Is Nothing Then
Else
 TabKonfigZeigen
End If
End Sub
Attribute VB_Name = "TABVORLAGE"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Attribute VB_Name = "TABVORLAGE1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Attribute VB_Name = "Tabelle10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "VERLAUF"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "dlg_KopfUndFuss"
Attribute VB_Base = "0{8DBEF42E-C8E4-4933-BF56-FC6017E6C6E9}{211A1569-ED8D-424F-97E9-BCE7DC947CE4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False






Private Sub CheckBox1_Change()
If CheckBox1.Value = False Then
 ComboBox1.ListIndex = 0
 OptionButton1.Value = False
 OptionButton2.Value = False
 OptionButton3.Value = False
End If
End Sub

Private Sub CheckBox2_Change()
If CheckBox2.Value = False Then
 ComboBox2.ListIndex = 0
 OptionButton4.Value = False
 OptionButton5.Value = False
 OptionButton6.Value = False
End If
End Sub



Private Sub CheckBox3_Change()
If CheckBox3.Value = False Then
 ComboBox3.ListIndex = 0
 OptionButton7.Value = False
 OptionButton8.Value = False
 OptionButton9.Value = False
End If
End Sub



Private Sub CheckBox4_Change()
If CheckBox4.Value = False Then
 ComboBox4.ListIndex = 0
 OptionButton10.Value = False
 OptionButton11.Value = False
 OptionButton12.Value = False
End If
End Sub



Private Sub CheckBox5_Change()
If CheckBox5.Value = False Then
 ComboBox5.ListIndex = 0
 OptionButton13.Value = False
 OptionButton14.Value = False
 OptionButton15.Value = False
End If
End Sub



Private Sub CheckBox6_Change()
If CheckBox6.Value = False Then
 ComboBox6.ListIndex = 0
 OptionButton16.Value = False
 OptionButton17.Value = False
 OptionButton18.Value = False
End If
End Sub



Private Sub cmd_cancel_Click()
'abbrechen
 Unload Me
End Sub

Private Sub cmd_Del_Click()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets
 With Blatt.PageSetup
  .LeftHeader = ""
  .CenterHeader = ""
  .RightHeader = ""
  .LeftFooter = ""
  .CenterFooter = ""
  .RightFooter = ""
 End With
Next Blatt

With dlg_KopfUndFuss
  .CheckBox1.Value = False
  .CheckBox2.Value = False
  .CheckBox3.Value = False
  .CheckBox4.Value = False
  .CheckBox5.Value = False
  .CheckBox6.Value = False
  .ComboBox1.ListIndex = 0
  .ComboBox2.ListIndex = 0
  .ComboBox3.ListIndex = 0
  .ComboBox4.ListIndex = 0
  .ComboBox5.ListIndex = 0
  .ComboBox6.ListIndex = 0
  .OptionButton1.Value = False
  .OptionButton2.Value = False
  .OptionButton3.Value = False
  .OptionButton4.Value = False
  .OptionButton5.Value = False
  .OptionButton6.Value = False
  .OptionButton7.Value = False
  .OptionButton8.Value = False
  .OptionButton9.Value = False
  .OptionButton10.Value = False
  .OptionButton11.Value = False
  .OptionButton12.Value = False
  .OptionButton13.Value = False
  .OptionButton14.Value = False
  .OptionButton15.Value = False
  .OptionButton16.Value = False
  .OptionButton17.Value = False
  .OptionButton18.Value = False
  TXT_Firma.Value = ""
  TXT_Abteilung.Value = ""
  TXT_Autor.Value = ""
  
  DRUCK.Range("A1:A6").Value = False
  DRUCK.Range("A7:A9").Value = ""
  DRUCK.Range("C1:E6").Value = False
  
End With

End Sub

Private Sub cmd_Save_Click()
'Kopf- und Fu|fffd|zeile zusammenstellen
Dim Blatt As Worksheet
Dim i_Tabz As Long
Dim i_TabMax As Long
Dim lArray() As Long
Dim b
Dim strname As String
Dim i As Integer

'Vorab Pr|fffd|fungen
If ComboBox1.Value = "Bitte w|fffd|hlen" And ComboBox2.Value = "Bitte w|fffd|hlen" And _
ComboBox3.Value = "Bitte w|fffd|hlen" And ComboBox4.Value = "Bitte w|fffd|hlen" And _
ComboBox5.Value = "Bitte w|fffd|hlen" And ComboBox6.Value = "Bitte w|fffd|hlen" Then
 MsgBox "Sie m|fffd|ssen zuerst auf der Registerkarte 'Kopf- und Fu|fffd|zeile anpassen' angeben," & vbLf & _
 "wo die Informationen angezeigt werden sollen!", vbInformation
 Exit Sub
End If

If CheckBox1.Value = True And ComboBox1.Value <> "Bitte w|fffd|hlen" Then
 If OptionButton1.Value = False And OptionButton2.Value = False And OptionButton3.Value = False Then
 MsgBox "Bitte Platzierung 'Firma' noch angeben!", vbCritical
 Exit Sub
 End If
End If
If CheckBox2.Value = True And ComboBox2.Value <> "Bitte w|fffd|hlen" Then
 If OptionButton4.Value = False And OptionButton5.Value = False And OptionButton6.Value = False Then
 MsgBox "Bitte Platzierung 'Abteilung' noch angeben!", vbCritical
 Exit Sub
 End If
End If
If CheckBox3.Value = True And ComboBox3.Value <> "Bitte w|fffd|hlen" Then
 If OptionButton7.Value = False And OptionButton8.Value = False And OptionButton9.Value = False Then
 MsgBox "Bitte Platzierung 'Autor' noch angeben!", vbCritical
 Exit Sub
 End If
End If
If CheckBox4.Value = True And ComboBox4.Value <> "Bitte w|fffd|hlen" Then
 If OptionButton10.Value = False And OptionButton11.Value = False And OptionButton12.Value = False Then
 MsgBox "Bitte Platzierung 'Letzte |fffd|nderung' noch angeben!", vbCritical
 Exit Sub
 End If
End If
If CheckBox5.Value = True And ComboBox5.Value <> "Bitte w|fffd|hlen" Then
 If OptionButton13.Value = False And OptionButton14.Value = False And OptionButton15.Value = False Then
 MsgBox "Bitte Platzierung 'Datei - Pfadname' noch angeben!", vbCritical
 Exit Sub
 End If
End If
If CheckBox6.Value = True And ComboBox6.Value <> "Bitte w|fffd|hlen" Then
If OptionButton16.Value = False And OptionButton17.Value = False And OptionButton18.Value = False Then
 MsgBox "Bitte Platzierung 'Seitenzahlen' noch angeben!", vbCritical
 Exit Sub
 End If
End If

'Zuerst einmal alles l|fffd|schen
ActiveSheet.PageSetup.LeftHeader = ""
ActiveSheet.PageSetup.CenterHeader = ""
ActiveSheet.PageSetup.RightHeader = ""
ActiveSheet.PageSetup.LeftFooter = ""
ActiveSheet.PageSetup.CenterFooter = ""
ActiveSheet.PageSetup.RightFooter = ""

'Hier neu am 28.06.2008
strname = ActiveSheet.Name
For i = 1 To ThisWorkbook.Sheets.Count
If Sheets(i).Visible = True Then
i_TabMax = i_TabMax + 1
End If
Next i



ReDim lArray(1 To i_TabMax)
For i_Tabz = 1 To i_TabMax
    lArray(i_Tabz) = i_Tabz
Next i_Tabz

If InStr(Application.Version, 12) = 0 Then
 ThisWorkbook.Sheets(lArray).Select
Else
End If

'Firma
If CheckBox1.Value = True Then
Select Case ComboBox1.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton1.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = TXT_Firma.Value
  End If
  If OptionButton2.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = TXT_Firma.Value
  End If
  If OptionButton3.Value = True Then
   ActiveSheet.PageSetup.RightHeader = TXT_Firma.Value
  End If
 Case "Fu|fffd|zeile"
 If OptionButton1.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = TXT_Firma.Value
  End If
  If OptionButton2.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = TXT_Firma.Value
  End If
  If OptionButton3.Value = True Then
   ActiveSheet.PageSetup.RightFooter = TXT_Firma.Value
  End If
End Select
End If

'Abteilung
If CheckBox2.Value = True Then
Select Case ComboBox2.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton4.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = TXT_Abteilung.Value
  End If
  If OptionButton5.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = TXT_Abteilung.Value
  End If
  If OptionButton6.Value = True Then
   ActiveSheet.PageSetup.RightHeader = TXT_Abteilung.Value
  End If
 Case "Fu|fffd|zeile"
 If OptionButton4.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = TXT_Abteilung.Value
  End If
  If OptionButton5.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = TXT_Abteilung.Value
  End If
  If OptionButton6.Value = True Then
   ActiveSheet.PageSetup.RightFooter = TXT_Abteilung.Value
  End If
End Select
End If

'Autor
If CheckBox3.Value = True Then
Select Case ComboBox3.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton7.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = TXT_Autor.Value
  End If
  If OptionButton8.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = TXT_Autor.Value
  End If
  If OptionButton9.Value = True Then
   ActiveSheet.PageSetup.RightHeader = TXT_Autor.Value
  End If
 Case "Fu|fffd|zeile"
 If OptionButton7.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = TXT_Autor.Value
  End If
  If OptionButton8.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = TXT_Autor.Value
  End If
  If OptionButton9.Value = True Then
   ActiveSheet.PageSetup.RightFooter = TXT_Autor.Value
  End If
End Select
End If

'letzte |fffd|nderung
If CheckBox4.Value = True Then
Select Case ComboBox4.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton10.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
  If OptionButton11.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
  If OptionButton12.Value = True Then
   ActiveSheet.PageSetup.RightHeader = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
 Case "Fu|fffd|zeile"
 If OptionButton10.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
  If OptionButton11.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
  If OptionButton12.Value = True Then
   ActiveSheet.PageSetup.RightFooter = Format(ThisWorkbook.BuiltinDocumentProperties("last save time"), "DD.MM.YYYY")
  End If
End Select
End If

'Datei-Pfadname
If CheckBox5.Value = True Then
Select Case ComboBox5.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton13.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = ThisWorkbook.FullName
  End If
  If OptionButton14.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = ThisWorkbook.FullName
  End If
  If OptionButton15.Value = True Then
   ActiveSheet.PageSetup.RightHeader = ThisWorkbook.FullName
  End If
 Case "Fu|fffd|zeile"
 If OptionButton13.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = ThisWorkbook.FullName
  End If
  If OptionButton14.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = ThisWorkbook.FullName
  End If
  If OptionButton15.Value = True Then
   ActiveSheet.PageSetup.RightFooter = ThisWorkbook.FullName
  End If
End Select
End If

'Seitenzahlen
If CheckBox6.Value = True Then
Select Case ComboBox6.Value
 Case "Bitte w|fffd|hlen"
  MsgBox "Bitte noch den Bereich ausw|fffd|hlen!": Exit Sub
 Case "Kopfzeile"
  If OptionButton16.Value = True Then
   ActiveSheet.PageSetup.LeftHeader = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
  If OptionButton17.Value = True Then
   ActiveSheet.PageSetup.CenterHeader = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
  If OptionButton18.Value = True Then
   ActiveSheet.PageSetup.RightHeader = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
 Case "Fu|fffd|zeile"
 If OptionButton16.Value = True Then
   ActiveSheet.PageSetup.LeftFooter = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
  If OptionButton17.Value = True Then
   ActiveSheet.PageSetup.CenterFooter = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
  If OptionButton18.Value = True Then
   ActiveSheet.PageSetup.RightFooter = "&""Verdana,Standard""Seite &P von &N Seiten"
  End If
End Select
End If

If InStr(Application.Version, 12) > 0 Then
'ALTER CODE
For Each Blatt In ThisWorkbook.Worksheets
If Blatt.Visible = True Then
  Blatt.PageSetup.LeftHeader = ActiveSheet.PageSetup.LeftHeader
  Blatt.PageSetup.CenterHeader = ActiveSheet.PageSetup.CenterHeader
  Blatt.PageSetup.RightHeader = ActiveSheet.PageSetup.RightHeader
  Blatt.PageSetup.LeftFooter = ActiveSheet.PageSetup.LeftFooter
  Blatt.PageSetup.CenterFooter = ActiveSheet.PageSetup.CenterFooter
  Blatt.PageSetup.RightFooter = ActiveSheet.PageSetup.RightFooter
 End If
Next Blatt
End If




'Zweiter Teil des Updates vom 28.06.08
For Each b In Windows(1).SelectedSheets
    With b
            .PageSetup.LeftHeader = ActiveSheet.PageSetup.LeftHeader
            .PageSetup.CenterHeader = ActiveSheet.PageSetup.CenterHeader
            .PageSetup.RightHeader = ActiveSheet.PageSetup.RightHeader
            .PageSetup.LeftFooter = ActiveSheet.PageSetup.LeftFooter
            .PageSetup.CenterFooter = ActiveSheet.PageSetup.CenterFooter
            .PageSetup.RightFooter = ActiveSheet.PageSetup.RightFooter
    End With
Next b

Sheets(strname).Select


'Ende Update vom 28.06.2008


'Speichern der Werte in Tabelle DRUCK
With DRUCK
 .Range("A1").Value = CheckBox1.Value
 .Range("A2").Value = CheckBox2.Value
 .Range("A3").Value = CheckBox3.Value
 .Range("A4").Value = CheckBox4.Value
 .Range("A5").Value = CheckBox5.Value
 .Range("A6").Value = CheckBox6.Value

 .Range("B1").Value = ComboBox1.Value
 .Range("B2").Value = ComboBox2.Value
 .Range("B3").Value = ComboBox3.Value
 .Range("B4").Value = ComboBox4.Value
 .Range("B5").Value = ComboBox5.Value
 .Range("B6").Value = ComboBox6.Value
 
 .Range("C1").Value = OptionButton1.Value
 .Range("D1").Value = OptionButton2.Value
 .Range("E1").Value = OptionButton3.Value
 .Range("C2").Value = OptionButton4.Value
 .Range("D2").Value = OptionButton5.Value
 .Range("E2").Value = OptionButton6.Value
 .Range("C3").Value = OptionButton7.Value
 .Range("D3").Value = OptionButton8.Value
 .Range("E3").Value = OptionButton9.Value
 .Range("C4").Value = OptionButton10.Value
 .Range("D4").Value = OptionButton11.Value
 .Range("E4").Value = OptionButton12.Value
 .Range("C5").Value = OptionButton13.Value
 .Range("D5").Value = OptionButton14.Value
 .Range("E5").Value = OptionButton15.Value
 .Range("C6").Value = OptionButton16.Value
 .Range("D6").Value = OptionButton17.Value
 .Range("E6").Value = OptionButton18.Value
 .Range("A7").Value = TXT_Firma.Value
 .Range("A8").Value = TXT_Abteilung.Value
 .Range("A9").Value = TXT_Autor.Value
End With



End Sub



Private Sub ComboBox1_Change()
If ComboBox1.Value = "Bitte w|fffd|hlen" Then
 OptionButton1.Value = False
 OptionButton2.Value = False
 OptionButton3.Value = False
End If
End Sub


Private Sub ComboBox2_Change()
If ComboBox2.Value = "Bitte w|fffd|hlen" Then
 OptionButton4.Value = False
 OptionButton5.Value = False
 OptionButton6.Value = False
End If
End Sub

Private Sub ComboBox3_Change()
If ComboBox3.Value = "Bitte w|fffd|hlen" Then
 OptionButton7.Value = False
 OptionButton8.Value = False
 OptionButton9.Value = False
End If
End Sub

Private Sub ComboBox4_Change()
If ComboBox4.Value = "Bitte w|fffd|hlen" Then
 OptionButton10.Value = False
 OptionButton11.Value = False
 OptionButton12.Value = False
End If
End Sub

Private Sub ComboBox5_Change()
If ComboBox5.Value = "Bitte w|fffd|hlen" Then
 OptionButton13.Value = False
 OptionButton14.Value = False
 OptionButton15.Value = False
End If
End Sub

Private Sub ComboBox6_Change()
If ComboBox6.Value = "Bitte w|fffd|hlen" Then
 OptionButton16.Value = False
 OptionButton17.Value = False
 OptionButton18.Value = False
End If
End Sub

Private Sub Image1_Click()
Dim i As Integer
'Application.Dialogs(xlDialogFont).Show
'Application.Dialogs(xlDialogFormatFont).Show
 Application.Dialogs(xlDialogStandardFont).Show
 
 
End Sub

Private Sub Label6_Click()
dlg_KopfUndFuss.Hide
Application.Dialogs(xlDialogPrintPreview).Show
dlg_KopfUndFuss.Show
End Sub

Private Sub MultiPage1_Change()

End Sub

Private Sub OptionButton1_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox1, "ComboBox1", OptionButton1.Caption)
If b = True Then OptionButton1.Value = False

End Sub

Private Sub OptionButton10_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox4, "ComboBox4", OptionButton10.Caption)
If b = True Then OptionButton10.Value = False
End Sub

Private Sub OptionButton11_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox4, "ComboBox4", OptionButton11.Caption)
If b = True Then OptionButton11.Value = False
End Sub

Private Sub OptionButton12_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox4, "ComboBox4", OptionButton12.Caption)
If b = True Then OptionButton12.Value = False
End Sub

Private Sub OptionButton13_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox5, "ComboBox5", OptionButton13.Caption)
If b = True Then OptionButton13.Value = False
End Sub

Private Sub OptionButton14_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox5, "ComboBox5", OptionButton14.Caption)
If b = True Then OptionButton14.Value = False
End Sub

Private Sub OptionButton15_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox5, "ComboBox5", OptionButton15.Caption)
If b = True Then OptionButton15.Value = False
End Sub

Private Sub OptionButton16_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox6, "ComboBox6", OptionButton16.Caption)
If b = True Then OptionButton16.Value = False
End Sub

Private Sub OptionButton17_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox6, "ComboBox6", OptionButton17.Caption)
If b = True Then OptionButton17.Value = False
End Sub

Private Sub OptionButton18_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox6, "ComboBox6", OptionButton18.Caption)
If b = True Then OptionButton18.Value = False
End Sub

Private Sub OptionButton2_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox1, "ComboBox1", OptionButton2.Caption)
If b = True Then OptionButton2.Value = False

End Sub

Private Sub OptionButton3_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox1, "ComboBox1", OptionButton3.Caption)
If b = True Then OptionButton3.Value = False

End Sub

Private Sub OptionButton4_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox2, "ComboBox2", OptionButton4.Caption)
If b = True Then OptionButton4.Value = False
End Sub

Private Sub OptionButton5_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox2, "ComboBox2", OptionButton5.Caption)
If b = True Then OptionButton5.Value = False
End Sub

Private Sub OptionButton6_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox2, "ComboBox2", OptionButton6.Caption)
If b = True Then OptionButton6.Value = False
End Sub

Private Sub OptionButton7_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox3, "ComboBox3", OptionButton7.Caption)
If b = True Then OptionButton7.Value = False
End Sub

Private Sub OptionButton8_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox3, "ComboBox3", OptionButton8.Caption)
If b = True Then OptionButton8.Value = False
End Sub

Private Sub OptionButton9_Click()
Dim b As Boolean
b = Pr|fffd|fSchonBelegt(ComboBox3, "ComboBox3", OptionButton9.Caption)
If b = True Then OptionButton9.Value = False
End Sub

Private Sub UserForm_Initialize()
dlg_KopfUndFuss.MultiPage1.Value = 0
dlg_KopfUndFuss.MultiPage1.Font = "Verdana"
dlg_KopfUndFuss.MultiPage1.Font.Size = 10
dlg_KopfUndFuss.BackColor = RGB(205, 205, 205)
dlg_KopfUndFuss.Label6.BackColor = RGB(205, 205, 205)
dlg_KopfUndFuss.cmd_cancel.BackColor = RGB(205, 205, 205)
dlg_KopfUndFuss.cmd_Save.BackColor = RGB(205, 205, 205)
dlg_KopfUndFuss.cmd_Del.BackColor = RGB(205, 205, 205)
dlg_KopfUndFuss.MultiPage1.BackColor = RGB(205, 205, 205)


With dlg_KopfUndFuss.ComboBox1
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

With dlg_KopfUndFuss.ComboBox2
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

With dlg_KopfUndFuss.ComboBox3
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

With dlg_KopfUndFuss.ComboBox4
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

With dlg_KopfUndFuss.ComboBox5
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

With dlg_KopfUndFuss.ComboBox6
 .AddItem "Bitte w|fffd|hlen"
 .AddItem "Kopfzeile"
 .AddItem "Fu|fffd|zeile"
 .ListIndex = 0
End With

'TXT_Firma.Value = ThisWorkbook.BuiltinDocumentProperties("Company")
'TXT_Autor.Value = ThisWorkbook.BuiltinDocumentProperties("Author")
TXT_Firma.Value = DRUCK.Range("A7").Value
TXT_Abteilung.Value = DRUCK.Range("A8").Value
TXT_Autor.Value = DRUCK.Range("A9").Value

With DRUCK
  CheckBox1.Value = .Range("A1").Value
  CheckBox2.Value = .Range("A2").Value
  CheckBox3.Value = .Range("A3").Value
  CheckBox4.Value = .Range("A4").Value
  CheckBox5.Value = .Range("A5").Value
  CheckBox6.Value = .Range("A6").Value

  ComboBox1.Value = .Range("B1").Value
  ComboBox2.Value = .Range("B2").Value
  ComboBox3.Value = .Range("B3").Value
  ComboBox4.Value = .Range("B4").Value
  ComboBox5.Value = .Range("B5").Value
  ComboBox6.Value = .Range("B6").Value
 
  OptionButton1.Value = .Range("C1").Value
  OptionButton2.Value = .Range("D1").Value
  OptionButton3.Value = .Range("E1").Value
  OptionButton4.Value = .Range("C2").Value
  OptionButton5.Value = .Range("D2").Value
  OptionButton6.Value = .Range("E2").Value
  OptionButton7.Value = .Range("C3").Value
  OptionButton8.Value = .Range("D3").Value
  OptionButton9.Value = .Range("E3").Value
  OptionButton10.Value = .Range("C4").Value
  OptionButton11.Value = .Range("D4").Value
  OptionButton12.Value = .Range("E4").Value
  OptionButton13.Value = .Range("C5").Value
  OptionButton14.Value = .Range("D5").Value
  OptionButton15.Value = .Range("E5").Value
  OptionButton16.Value = .Range("C6").Value
  OptionButton17.Value = .Range("D6").Value
  OptionButton18.Value = .Range("E6").Value
 
End With

End Sub
Attribute VB_Name = "dlg_Sicherheit"
Attribute VB_Base = "0{522CF3E8-7148-4CBD-8EB5-3F0E17F8942B}{E2DFB53E-0BF4-4123-81C7-EAA8FC73241D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Public Eigenschaft1 As String
Public Eigenschaft2 As Integer

Private Sub cmd_cancel_Click()
Unload Me
End Sub

Private Sub cmd_Del_Click()
 Application.DisplayAlerts = False
     ThisWorkbook.Sheets(dlg_Sicherheit.Eigenschaft1).Delete
     Application.DisplayAlerts = True

     'Herausnehmen des Eintrages aus dem Listenfeld
     dlg_TabKonfig.ListBox1.RemoveItem dlg_Sicherheit.Eigenschaft2
     'Positionieren auf Starttabelle
     dlg_TabKonfig.ListBox1.ListIndex = 0
    Unload Me
End Sub





Private Sub UserForm_Initialize()
dlg_Sicherheit.BackColor = RGB(205, 205, 205)
dlg_Sicherheit.LabelFehler.BackColor = RGB(205, 205, 205)
dlg_Sicherheit.Image1.BackColor = RGB(205, 205, 205)
dlg_Sicherheit.cmd_cancel.BackColor = RGB(205, 205, 205)
dlg_Sicherheit.cmd_Del.BackColor = RGB(205, 205, 205)
End Sub
Attribute VB_Name = "dlg_TabKonfig"
Attribute VB_Base = "0{9151F5AA-99B6-47A9-B242-BA54EA5E9319}{BB729A67-C1EC-4DC7-8296-58A7B58CA374}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub SortTab()
Dim i As Integer

With ListBox1
For i = .ListCount - 1 To 1 Step -1
  Sheets(.List(i)).Move after:=Sheets(.List(0))
Next i
ThisWorkbook.Sheets("Startseite").Select
End With
End Sub


Private Sub cmd_cancel_Click()
'Userform abbrechen
 Unload Me
End Sub

Private Sub cmd_copy_Click()
'Tabelle kopieren
 Dim s As String
 Dim i As Integer
 Dim ipos As Integer
 Dim strHilf As String
 Dim strZahl As String
 
 If ListBox1.ListIndex = 0 Then MsgBox "Die Startseite darf nicht dupliziert werden!", vbInformation: Exit Sub
 If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 
 If i = 0 Then Exit Sub
Application.DisplayAlerts = False
   s = ListBox1.List(i)
     
   ThisWorkbook.Sheets(s).Copy after:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)
   'Leere Zeichen aus Tabellennamen entfernen
   For ipos = 1 To Len(ActiveSheet.Name)
    Select Case Mid(ActiveSheet.Name, ipos, 1)
     Case " "
     
     Case Else
      
      strHilf = strHilf & Mid(ActiveSheet.Name, ipos, 1)
      strHilf = LeereRaus(ActiveSheet.Name)
      
    End Select
   Next ipos
   
   If TabExists(strHilf) = False Then
    ActiveSheet.Name = LeereRaus(strHilf)
   Else
    strZahl = Mid(strHilf, InStr(strHilf, "(") + 1, Len(strHilf) - InStr(strHilf, ")") + 1) + 1
    
   Do Until TabExists(LeereRaus(Left(strHilf, InStr(strHilf, "(")) & strZahl & ")")) = False
    strZahl = strZahl + 1
   Loop
    'If TabExists(LeereRaus(Left(strHilf, InStr(strHilf, "(")) & strZahl & ")")) = True Then
    'ActiveSheet.Name = LeereRaus(Left(strHilf, InStr(strHilf, "(")) & strZahl + 1 & ")")
    'Else
    ActiveSheet.Name = LeereRaus(Left(strHilf, InStr(strHilf, "(")) & strZahl & ")")
    'End If
   
   End If
   ListBox1.AddItem ActiveSheet.Name, ListBox1.ListCount
   
  
   
  Else
  MsgBox "Sie m|fffd|ssen zuerst eine Tabelle" & vbLf & _
  "im Listenfeld ausw|fffd|hlen!", vbInformation
 End If
Application.DisplayAlerts = True
ThisWorkbook.Sheets("Startseite").Select
LBSynchron
End Sub

Private Sub cmd_Del_Click()
'Tabelle l|fffd|schen
 Dim s As String
 Dim i As Integer
 Dim ir|fffd|ck As Integer
 
 If ListBox1.ListIndex = 0 Then MsgBox "Die Startseite darf nicht gel|fffd|scht werden!", vbInformation: Exit Sub
 If ListBox1.Value = "Hilfe" Then MsgBox "Die Hilfe-Seite darf nicht gel|fffd|scht werden!", vbInformation: Exit Sub
 If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   'L|fffd|schen der Tabelle
     dlg_Sicherheit.Eigenschaft1 = s
     dlg_Sicherheit.Eigenschaft2 = i
     dlg_Sicherheit.Show
     

     Else
     MsgBox "Sie m|fffd|ssen zuerst eine Tabelle" & vbLf & _
     "im Listenfeld ausw|fffd|hlen!", vbInformation
 End If
ThisWorkbook.Sheets("Startseite").Select

ThisWorkbook.Sheets("VERLAUF").Columns(1).ClearContents
ThisWorkbook.Sheets("VERLAUF").Range("A1").Value = "Startseite"


LBSynchron
End Sub



Private Sub cmd_Rename_Click()
 Dim s As String
 Dim i As Integer
 If ListBox1.ListIndex = -1 Then Exit Sub
 If ListBox1.List(ListBox1.ListIndex) = "Startseite" Then MsgBox "Die Startseite darf nicht umbenannt werden!", vbInformation: Exit Sub
 If ListBox1.List(ListBox1.ListIndex) = "Hilfe" Then MsgBox "Die Seite Hilfe darf nicht umbenannt werden!", vbInformation: Exit Sub
 
 If TXT_Tabname.Value <> "" Then
 
 If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   If TabExists(TXT_Tabname) = False Then
     ListBox1.RemoveItem i
     ListBox1.AddItem TXT_Tabname, i
     ListBox1.ListIndex = i
     Sheets(s).Name = TXT_Tabname
    Else
    'Tabelle kann nicht umbenannt werden, da der neue Name bereits existiert
    MsgBox "Der Tabellenname " & TXT_Tabname & " exisitiert bereits in der Mappe!", vbCritical
   End If
   Else
   MsgBox "Sie m|fffd|ssen zuerst eine Tabelle" & vbLf & _
  "im Listenfeld ausw|fffd|hlen!", vbInformation
 End If
 Else
 MsgBox "Bitte geben Sie zuerst einen neuen Namen " & vbLf & _
 "im Feld 'Neuer Tabellenname' ein!", vbInformation
 End If
 ThisWorkbook.Sheets("Startseite").Select
 TXT_Tabname.Value = ""
 LBSynchron
End Sub

Private Sub cmd_Save_Click()
'Konfiguration speichern
Dim imax As Integer
Dim iZeilen As Integer
Dim Startadress As String
Dim hyper As Hyperlink
Dim Bereich As Range
Dim zelle As Range

'Das Tabelleninhaltsverzeichnis l|fffd|schen

With ThisWorkbook.Sheets("Startseite")
.Activate
.Unprotect
Set Bereich = .Range("C11:I27")
For Each zelle In Bereich
 If zelle.Interior.ColorIndex = 15 Then
  If zelle.Value <> "Tabelle einf|fffd|gen / Startseite konfigurieren" Then
  zelle.Value = ""
  End If
 End If
Next zelle

.Range("A1").Select
End With


'Die Tabellenhyperlinks entfernen
For Each hyper In ThisWorkbook.Sheets("Startseite").Hyperlinks
 If InStr(hyper.TextToDisplay, "|fffd|") > 0 Then
  hyper.Delete
 End If
Next hyper


Startadress = ThisWorkbook.Sheets("Startseite").Range("C10").Address
'Eintr|fffd|ge in Listbox z|fffd|hlen abz|fffd|glich der ersten Seite
imax = ListBox1.ListCount - 1
iZeilen = Application.WorksheetFunction.RoundUp(imax / 2, 0)

'|fffd|
With ListBox1
For i = 1 To .ListCount - 1
  
  'Tabellenindex schreiben
  If i > iZeilen Then Exit For
  
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Value = ListBox1.List(i)
  
  If Left(Application.Version, 1) <> 8 Then
    
  If InStr(ListBox1.List(i), " ") > 0 Then
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        "'" & ListBox1.List(i) & "'" & "!A1", ScreenTip:=ListBox1.List(i), _
        TextToDisplay:="|fffd| " & ListBox1.List(i)
  Else
'  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
'        ListBox1.List(i) & "!A1", ScreenTip:=ListBox1.List(i), _
'        TextToDisplay:="|fffd| " & ListBox1.List(i)
'
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        "'" & ListBox1.List(i) & "'" & "!A1", ScreenTip:=ListBox1.List(i), _
        TextToDisplay:="|fffd| " & ListBox1.List(i)
        
  End If
    If Left(Range(Startadress).Offset(1, 0).Value, 1) <> "|fffd|" Then
    Range(Startadress).Offset(1, 0).Value = "|fffd| " & Range(Startadress).Offset(1, 0).Value
   End If

  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.ColorIndex = 47
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.Bold = True
  Startadress = ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Address
  
  Else
  
  If InStr(ListBox1.List(i), " ") > 0 Then
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        "'" & ListBox1.List(i) & "'" & "!A1"
  Else
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        ListBox1.List(i) & "!A1"
  End If
    If Left(Range(Startadress).Offset(1, 0).Value, 1) <> "|fffd|" Then
    Range(Startadress).Offset(1, 0).Value = "|fffd| " & Range(Startadress).Offset(1, 0).Value
   End If

  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.ColorIndex = 47
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.Bold = True
  Startadress = ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Address
  
  End If 'excel 97
  
Next i


Startadress = ThisWorkbook.Sheets("Startseite").Range("G10").Address
For i = i To .ListCount - 1
  'Tabellenindex schreiben
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Value = ListBox1.List(i)
  
  If Left(Application.Version, 1) <> 8 Then
  
  If InStr(ListBox1.List(i), " ") > 0 Then
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", _
        SubAddress:="'" & ListBox1.List(i) & "'" & "!A1", ScreenTip:=ListBox1.List(i), _
        TextToDisplay:="|fffd| " & ListBox1.List(i)
  Else

     ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        "'" & ListBox1.List(i) & "'" & "!A1", ScreenTip:=ListBox1.List(i), _
        TextToDisplay:="|fffd| " & ListBox1.List(i)
   End If
   If Left(Range(Startadress).Offset(1, 0).Value, 1) <> "|fffd|" Then
    Range(Startadress).Offset(1, 0).Value = "|fffd| " & Range(Startadress).Offset(1, 0).Value
   End If

  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.ColorIndex = 47
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.Bold = True
  Startadress = ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Address
  
  Else
  
  If InStr(ListBox1.List(i), " ") > 0 Then
  ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:="" _
        , SubAddress:="'" & ListBox1.List(i) & "'" & "!A1"
  Else

     ThisWorkbook.Sheets("Startseite").Hyperlinks.Add Anchor:=Range(Startadress).Offset(1, 0), Address:="", SubAddress:= _
        "'" & ListBox1.List(i) & "'" & "!A1"
   End If
   If Left(Range(Startadress).Offset(1, 0).Value, 1) <> "|fffd|" Then
    Range(Startadress).Offset(1, 0).Value = "|fffd| " & Range(Startadress).Offset(1, 0).Value
   End If

  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.ColorIndex = 47
  ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Font.Bold = True
  Startadress = ThisWorkbook.Sheets("Startseite").Range(Startadress).Offset(1, 0).Address
  
  End If 'excel 97
  
Next i

If iZeilen > 10 Then
 ThisWorkbook.Sheets("Startseite").Rows(23).Hidden = False
 ThisWorkbook.Sheets("Startseite").Rows(24).Hidden = False
 ThisWorkbook.Sheets("Startseite").Rows(25).Hidden = False
 ThisWorkbook.Sheets("Startseite").Rows(26).Hidden = False
 ThisWorkbook.Sheets("Startseite").Rows(27).Hidden = False
 ThisWorkbook.Sheets("Startseite").Rows(28).Hidden = False
 Else
 ThisWorkbook.Sheets("Startseite").Rows(23).Hidden = True
 ThisWorkbook.Sheets("Startseite").Rows(24).Hidden = True
 ThisWorkbook.Sheets("Startseite").Rows(25).Hidden = True
 ThisWorkbook.Sheets("Startseite").Rows(26).Hidden = True
 ThisWorkbook.Sheets("Startseite").Rows(27).Hidden = True
 ThisWorkbook.Sheets("Startseite").Rows(28).Hidden = True
End If

End With
ThisWorkbook.Sheets("Startseite").Protect
Unload Me
End Sub

Private Sub cmd_Search_Click()
'Grafik zuweisen
 Dim fd 'As FileDialog
 Dim i As Integer
 Dim sFilePfad As String
 Dim vrtSelectedItem As Variant

If Left(Application.Version, 1) = 8 Or Left(Application.Version, 1) = 9 Then
 'MsgBox "Excel 97, Excel 2000"
 GetFileName = Application.GetOpenFilename("Grafiken(*.gif; *.jpg; *.bmp),*.gif, *.jpg, *.bmp ,All Files (*.*),*.* ")

    If GetFileName <> False Then
         TXT_Logo.Value = GetFileName
    End If
 
Else

    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    With fd
            .Filters.Clear
            .Filters.Add "Bildformate / Grafiken", "*.gif;*.jpg;*.jpeg;*.bmp", 1
        If .Show = -1 Then


            For Each vrtSelectedItem In .SelectedItems

                sFilePfad = vrtSelectedItem


                i = Len(sFilePfad)

                Do Until Mid(sFilePfad, i, 1) = "\"
                    i = i - 1
                If i = 0 Then
                End If
                Exit Do
                Loop
              
                GetFileName = sFilePfad
                TXT_Logo.Value = GetFileName


            Next vrtSelectedItem
        
        Else
        End If
        
    End With


    '
    Set fd = Nothing
    
End If
       
End Sub

Private Sub cmd_TabAdd_Click()
'Tabelle hinzuf|fffd|gen
Dim i As Integer
Dim s As String

If TXT_Tabname = "" Then MsgBox "Sie m|fffd|ssen zuerst einen Namen" & vbLf & _
"f|fffd|r die neue Tabelle festlegen!", vbInformation: Exit Sub
 s = TXT_Tabname.Value
 If TabExists(TXT_Tabname) = False Then
 
 'Neuen Eintrag ans Ende der Listbox bewegen
 ListBox1.AddItem s, ListBox1.ListCount
 'Tabelle einf|fffd|gen undbenennen
 'Sheets.Add
 Application.DisplayAlerts = False
 Sheets("Tabvorlage").Visible = True
 Sheets("Tabvorlage").Copy after:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)
 ActiveSheet.Name = s
 Sheets(s).Unprotect
 Sheets(s).Columns.Hidden = False
 
 Sheets("Tabvorlage").Visible = False
 Application.DisplayAlerts = True
 SortTab
 Else
     MsgBox "Der Tabellenname " & TXT_Tabname & " existiert bereits in der Mappe!", vbCritical
 End If
LBSynchron
End Sub

Private Sub cmd_Upload_Click()
'Grafik auf alle Tabellen einf|fffd|gen
Dim Shp As Picture
Dim Blatt As Worksheet
Dim spalte As Integer
If TXT_Logo.Value = "" Then MsgBox "Bitte w|fffd|hlen Sie zuerst |fffd|ber die Schaltfl|fffd|che Duchsuchen eine Grafik aus!": Exit Sub

For Each Blatt In ThisWorkbook.Worksheets
 Select Case Blatt.Name
 Case "VERLAUF", "ICONS", "Tabelle1"
 
 Case Else
 Blatt.Unprotect
 Blatt.Activate

If HaufeLogo1("HaufeLogo") = True Then
 Set Shp = Blatt.Pictures.Insert(TXT_Logo.Value)
 
 Shp.Top = Selection.Top
 Shp.Left = Selection.Left + Blatt.Shapes("HaufeLogo").Width - Shp.Width
 ActiveSheet.Shapes("HaufeLogo").Delete
 Shp.Select
 Selection.Name = "ALogo"
 
 Else

 Set Shp = Blatt.Pictures.Insert(TXT_Logo.Value)
If ALogo1("ALogo") = True Then
 Shp.Top = Selection.Top
 Shp.Left = Selection.Left + Blatt.Shapes("ALogo").Width - Shp.Width
 ActiveSheet.Shapes("ALogo").Delete
 Shp.Select
 Selection.Name = "ALogo"
'  spalte = Blatt.Range("IV1").End(xlToLeft).Column
'  Set Shp = Blatt.Pictures.Insert(TXT_Logo.Value)
' Shp.Top = Blatt.Cells(1, spalte)
' Shp.Left = Blatt.Cells(1, spalte)
End If
End If
Blatt.Protect
End Select
Next Blatt

ThisWorkbook.Sheets("Startseite").Select
End Sub


Private Sub cmd_Gehezu_Click()
'Tabelle aktivieren
Dim i As Integer
Dim s As String

If ListBox1.ListIndex <> -1 Then
i = ListBox1.ListIndex
 'If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   ThisWorkbook.Sheets(s).Select
   Else
   MsgBox "Sie m|fffd|ssen zuerst eine Tabelle" & vbLf & _
  "im Listenfeld ausw|fffd|hlen!", vbInformation
 End If

End Sub

Private Sub Image1_Click()
'Ganz nach oben
Dim i As Integer
Dim s As String

If ListBox1.ListIndex = 0 Then Exit Sub
If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   ListBox1.RemoveItem i
   ListBox1.AddItem s, 1
   ListBox1.ListIndex = 1
   
End If
SortTab
End Sub

Private Sub Image2_Click()
'Ganz nach unten
Dim i As Integer
Dim s As String

If ListBox1.ListIndex = 0 Then Exit Sub
If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   ListBox1.RemoveItem i
   ListBox1.AddItem s, ListBox1.ListCount
   ListBox1.ListIndex = ListBox1.ListCount - 1
   
End If
SortTab
End Sub

Private Sub Label2_Click()

End Sub

Private Sub SpinButton1_SpinUp()
'Eine Position nach oben
Dim i As Integer
Dim s As String

If ListBox1.ListIndex = 0 Or ListBox1.ListIndex = 1 Then Exit Sub

If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = 0 Then Exit Sub
   s = ListBox1.List(i)
   ListBox1.RemoveItem i
   ListBox1.AddItem s, i - 1
   ListBox1.ListIndex = i - 1
   SpinButton1.Value = 0
End If
SortTab
End Sub


Private Sub SpinButton1_SpinDown()
'Eine Position nach unten
Dim i As Integer
Dim s As String

If ListBox1.ListIndex = 0 Then Exit Sub
If ListBox1.ListIndex <> -1 Then
 i = ListBox1.ListIndex
 If i = ListBox1.ListCount - 1 Then Exit Sub
 
   s = ListBox1.List(i)
   ListBox1.RemoveItem i
   ListBox1.AddItem s, i + 1
   ListBox1.ListIndex = i + 1
   SpinButton1.Value = 0
End If
SortTab
End Sub




Private Sub TXT_Tabname_Change()
'Leere Zeichen entfernen
If Len(TXT_Tabname.Value) = 1 Then
 Select Case TXT_Tabname.Value
   Case " ", ":", "/", "\", "?", "*", "[", "]"
        TXT_Tabname.Value = ""
   Case Else
  End Select
End If

Select Case Right(TXT_Tabname.Value, 1)
Case " ", ":", "/", "\", "?", "*", "[", "]"
  TXT_Tabname.Value = Left(TXT_Tabname.Value, Len(TXT_Tabname.Value) - 1)
Case Else
End Select

If Len(TXT_Tabname.Value) > 31 Then TXT_Tabname.Value = Left(TXT_Tabname, 31)
End Sub

Private Sub UserForm_Initialize()
'Listbox mit allen sichtbaren Tabellen und Diagrammbl|fffd|ttern f|fffd|llen
Dim iTab As Integer
dlg_TabKonfig.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Label1.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Label2.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Label3.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Label4.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Label5.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Rename.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_cancel.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_copy.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Save.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Search.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_TabAdd.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Upload.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Gehezu.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.cmd_Del.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.SpinButton1.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Image1.BackColor = RGB(205, 205, 205)
dlg_TabKonfig.Image2.BackColor = RGB(205, 205, 205)

For iTab = 1 To ThisWorkbook.Sheets.Count

 If ThisWorkbook.Sheets(iTab).Visible = True Then
 
  dlg_TabKonfig.ListBox1.AddItem ThisWorkbook.Sheets(iTab).Name
 
 End If


Next iTab
End Sub


Attribute VB_Name = "mdl_Dialog"
Sub TabKonfigZeigen()
 dlg_TabKonfig.Show
End Sub

Sub KopfUndFuss()
 dlg_KopfUndFuss.Show
End Sub
Attribute VB_Name = "mdl_Formatvorlage"


Sub StatusleisteEdit()
'Application.DisplayStatusBar = True
Application.StatusBar = "Haufe Index: HI1480767 - Version 1.1.1.9 - Stand: 30.03.2010 |fffd| Haufe-Lexware GmbH & Co. KG "
End Sub
Sub SymbolLeisteErstellen()
Dim SB As CommandBar
Dim DropSym As CommandBarControl
Dim Symbol As CommandBarControl
Dim Symbol2 As CommandBarButton
Dim NeuSymb As Object
Dim i As Integer
Dim z As Integer

  On Error Resume Next
  Set SB = Application.CommandBars.Add("Haufe-V", Position:=msoBarTop)
  SB.Visible = True
  
                
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
   Symbol.BeginGroup = True
   Symbol.FaceId = 1017
   Symbol.TooltipText = "zur|fffd|ck"
   Symbol.OnAction = "Zurueck"
   
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
   Symbol.FaceId = 1016
    Symbol.Caption = "START"
    Symbol.OnAction = "Startx"
         
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
     Symbol.FaceId = 1018
   Symbol.TooltipText = "vor"
   Symbol.OnAction = "Vorwaerts"
                          
    Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
    Symbol.Enabled = False
    Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
    Symbol.Enabled = False
    Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
    Symbol.Enabled = False
    
  
  
    
    Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlComboBox)
    Symbol.Width = 200
    With Symbol
    For i = 1 To ThisWorkbook.Sheets.Count
     If ThisWorkbook.Sheets(i).Visible = True Then
      .AddItem Text:=Sheets(i).Name
     End If
    Next i
    .ListIndex = 1
    .DropDownLines = i
    .DropDownWidth = 200
    .ListHeaderCount = 0
    .OnAction = "Auswahl"
End With
  
  For z = 1 To 3
    Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
    Symbol.Enabled = False
  Next z
  
'Speichern

Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton, ID:=748)
    Symbol.Caption = "Speichern..."
    Symbol.FaceId = 3
             
'Drucken
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton, ID:=2521)

'Kopieren
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton, ID:=19)

         
 'Einf|fffd|gen (Bei Excel 2000 und Excel 2007 ist das einf|fffd|gen-Symbol nicht mehr verf|fffd|gbar
If Left(Application.Version, 1) = 9 Or InStr(Application.Version, "12") > 0 Then
Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton, ID:=22)

Else
  Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=13, ID:=6002)
 End If
  'Ein leeres Symbol einf|fffd|gen
  Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
  Symbol.Enabled = False
  
  
    Set DropSym = SB.Controls.Add(Type:=msoControlDropdown)
  DropSym.Caption = "Optionen"
  
  DropSym.Width = 250
    With DropSym
        .AddItem Text:="Option ausw|fffd|hlen..."
        .AddItem Text:="Gitternetz ein/aus"
        .AddItem Text:="Zeilen- und Spaltenbeschriftung ein/aus"
        .AddItem Text:="Blattregister ein/aus"
        .AddItem Text:="Zoom einstellen"
        .AddItem Text:="Kopf-/Fu|fffd|zeile einstellen"
    .ListIndex = 1
    .DropDownLines = 6
    .DropDownWidth = 250
    .ListHeaderCount = 0
     '.OnAction = "Auswahl"
   End With
'Ein leeres Symbol einf|fffd|gen
  Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
  Symbol.Enabled = False
  
  Set Symbol2 = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
  Symbol2.Caption = "HILFE"
  Symbol2.Style = msoButtonCaption
  'Symbol.FaceId = 49
  Symbol2.OnAction = "Hilfex"
    
  Set Symbol = Application.CommandBars("Haufe-V").Controls _
    .Add(Type:=msoControlButton)
  Symbol.Enabled = False
    
End Sub

Sub SymbolLeisteLoeschen()
On Error Resume Next
 Application.CommandBars("Haufe-V").Delete
End Sub



Sub Auswahl()
Dim index As Integer

index = Application.CommandBars("Haufe-V").Controls.Item(7).ListIndex
Sheets(Application.CommandBars("Haufe-V").Controls.Item(7).List(Application.CommandBars("Haufe-V").Controls.Item(7).ListIndex)).Activate
 
End Sub

Sub Auswahl2()
Dim Index2 As Integer

Index2 = Application.CommandBars("Haufe-V").Controls.Item(16).ListIndex
 
 Select Case Index2
  Case 1
  
  Case 2
   Gitternetz
  Case 3
   Spaltenbeschriftung
  Case 4
   Blattregister
  Case 5
   Zoom
  Case 6
   KopfUndFuss
'
 End Select
 
 
End Sub




Sub Gitternetz()
If ActiveWindow.DisplayGridlines = True Then
ActiveWindow.DisplayGridlines = False
Else
ActiveWindow.DisplayGridlines = True
End If
End Sub


Sub Spaltenbeschriftung()
If ActiveWindow.DisplayHeadings = True Then
ActiveWindow.DisplayHeadings = False
Else
ActiveWindow.DisplayHeadings = True
End If
End Sub

Sub Startx()
 Sheets("Startseite").Activate
End Sub

Sub Hilfe2()
 
 
Sheets("Hilfe").Activate

End Sub



Sub Internet()

ThisWorkbook.FollowHyperlink Address:="http://www.haufe.de", _
    NewWindow:=True
        

End Sub


Sub StatusleisteWeg()
Application.DisplayStatusBar = True
Application.StatusBar = False
End Sub

Sub AnsichtWeg()
 ActiveWindow.DisplayHeadings = False
 ActiveWindow.DisplayWorkbookTabs = False
 'Application.DisplayStatusBar = False
 Application.DisplayFormulaBar = False
 
 ActiveWindow.DisplayWorkbookTabs = True
End Sub

Sub AnsichtDA()
ActiveWindow.DisplayHeadings = True
ActiveWindow.DisplayWorkbookTabs = True
Application.DisplayStatusBar = True
Application.DisplayFormulaBar = True

End Sub


Sub Blattregister()
If ActiveWindow.DisplayWorkbookTabs = True Then
ActiveWindow.DisplayWorkbookTabs = False
Else
ActiveWindow.DisplayWorkbookTabs = True
End If
End Sub


Sub Zoom()
Application.Dialogs(xlDialogZoom).Show
End Sub

Sub SymbolleisteSchuetzen()
With Application.CommandBars("Haufe-V")
    .Protection = msoBarNoChangeVisible + msoBarNoCustomize + msoBarNoMove
    .Visible = True
End With
End Sub


Sub sichtbar()
 Application.CommandBars("Toolbar list").Enabled = True
 ActiveWindow.DisplayHeadings = True
 Application.DisplayFormulaBar = True

End Sub

Sub Unsichtbar()
Application.CommandBars("Toolbar list").Enabled = True
 ActiveWindow.DisplayHeadings = False
 Application.DisplayFormulaBar = False
  ActiveWindow.DisplayGridlines = False
End Sub

Sub BerichtAufrufen()
UserForm2.Show
End Sub


Sub ZoomAuf85()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets
 Blatt.Activate
 ActiveWindow.Zoom = 85
Next Blatt
Sheets("Startseite").Select
End Sub



Sub LBSynchron()
On Error Resume Next
Set Symbol = Application.CommandBars("Haufe-V").Controls(7)

 Symbol.Clear


    With Symbol
    For i = 1 To ThisWorkbook.Sheets.Count
     If ThisWorkbook.Sheets(i).Visible = True Then
      .AddItem Text:=Sheets(i).Name
     End If
    Next i
    .ListIndex = 1
    .DropDownLines = i
    .DropDownWidth = 200
    .ListHeaderCount = 0
    .OnAction = "Auswahl"
    End With
        
End Sub


Sub Zurueck()
Dim ZeileMax As Long
Dim Zeile As Long
Dim b As Boolean

On Error Resume Next
b = False
With ThisWorkbook.Sheets("VERLAUF")
ZeileMax = .Range("A65536").End(xlUp).Row

For Zeile = ZeileMax To 1 Step -1

 If .Cells(Zeile, 1).Value = ActiveSheet.Name Then
  b = True
  Exit For
 End If

Next Zeile

If b = True Then
 If Zeile = 1 Then
 Sheets(.Cells(Zeile, 1).Value).Select
 Application.CommandBars("Haufe-V").Controls(7).Text = ActiveSheet.Name
 Else
  Sheets(.Cells(Zeile - 1, 1).Value).Select
  Application.CommandBars("Haufe-V").Controls(7).Text = ActiveSheet.Name
 End If
End If

End With

End Sub


Sub Vorwaerts()


Dim ZeileMax As Long
Dim Zeile As Long
Dim b As Boolean
On Error Resume Next
b = False
With ThisWorkbook.Sheets("VERLAUF")
ZeileMax = .Range("A65536").End(xlUp).Row

For Zeile = ZeileMax To 1 Step -1

 If .Cells(Zeile, 1).Value = ActiveSheet.Name Then
  b = True
  Exit For
 End If

Next Zeile

If b = True Then
If .Cells(Zeile + 1, 1).Value = "" Then
Sheets(.Cells(1, 1).Value).Select
Else
 Sheets(.Cells(Zeile + 1, 1).Value).Select

Application.CommandBars("Haufe-V").Controls(7).Text = ActiveSheet.Name

End If
 
End If

End With

End Sub

Attribute VB_Name = "mdl_Funktionen"



Function TabExists(Tabname As String) As Boolean
Dim i As Integer

TabExists = False
For i = 1 To ThisWorkbook.Sheets.Count

 If Tabname = ThisWorkbook.Sheets(i).Name Then
  TabExists = True
  Exit For
 End If

Next i
Exit Function

End Function

Function LeereRaus(s As String) As String
Dim i As Integer

For i = 1 To Len(s)
 Select Case Mid(s, i, 1)
  Case " "
  
  Case Else
   LeereRaus = LeereRaus & Mid(s, i, 1)
 
 End Select

Next i
End Function

Private Function GetFileName(sFilePfad As String)
    Dim i As Integer


    i = Len(sFilePfad)


    Do Until Mid(sFilePfad, i, 1) = "\"
       i = i - 1
       If i = 0 Then
          Exit Do
    Loop


    If i = 0 Then
       GetFileName = sFilePfad
    Else
       GetFileName = Mid(sFilePfad, i + 1)
    End If
End Function



Function HaufeLogo1(str As String) As Boolean
HaufeLogo1 = False
On Error GoTo fehler
ActiveSheet.Shapes("HaufeLogo").Select
HaufeLogo1 = True
Exit Function
fehler:

End Function


Function ALogo1(str As String) As Boolean
ALogo1 = False
On Error GoTo fehler
ActiveSheet.Shapes("aLogo").Select
ALogo1 = True
Exit Function
fehler:

End Function


Function Pr|fffd|fSchonBelegt(strCombo As String, StrComboNr As String, strOpt As String) As Boolean
Dim obj As Control
Dim strSchl|fffd|ssel As String
Dim vglstrSchl|fffd|ssel As String
Dim i As Integer

vglstrSchl|fffd|ssel = strCombo & strOpt
i = 0
Pr|fffd|fSchonBelegt = False
For Each obj In dlg_KopfUndFuss.Controls

Select Case obj.Name

Case "ComboBox1"

If strCombo = dlg_KopfUndFuss.ComboBox1.Value Then
  If dlg_KopfUndFuss.OptionButton1.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton1.Caption
  If dlg_KopfUndFuss.OptionButton2.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton2.Caption
  If dlg_KopfUndFuss.OptionButton3.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton3.Caption
End If

 Case "ComboBox2"
 If strCombo = dlg_KopfUndFuss.ComboBox2.Value Then
  If dlg_KopfUndFuss.OptionButton4.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton4.Caption
  If dlg_KopfUndFuss.OptionButton5.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton5.Caption
  If dlg_KopfUndFuss.OptionButton6.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton6.Caption
End If

 Case "ComboBox3"
If strCombo = dlg_KopfUndFuss.ComboBox3.Value Then
  If dlg_KopfUndFuss.OptionButton7.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton7.Caption
  If dlg_KopfUndFuss.OptionButton8.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton8.Caption
  If dlg_KopfUndFuss.OptionButton9.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton9.Caption
End If

 Case "ComboBox4"
If strCombo = dlg_KopfUndFuss.ComboBox4.Value Then
  If dlg_KopfUndFuss.OptionButton10.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton10.Caption
  If dlg_KopfUndFuss.OptionButton11.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton11.Caption
  If dlg_KopfUndFuss.OptionButton12.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton12.Caption
End If

 Case "ComboBox5"
If strCombo = dlg_KopfUndFuss.ComboBox5.Value Then
  If dlg_KopfUndFuss.OptionButton13.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton13.Caption
  If dlg_KopfUndFuss.OptionButton14.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton14.Caption
  If dlg_KopfUndFuss.OptionButton15.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton15.Caption
End If
 Case "ComboBox6"
 If strCombo = dlg_KopfUndFuss.ComboBox6.Value Then
  If dlg_KopfUndFuss.OptionButton16.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton16.Caption
  If dlg_KopfUndFuss.OptionButton17.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton17.Caption
  If dlg_KopfUndFuss.OptionButton18.Value = True Then strSchl|fffd|ssel = strCombo & dlg_KopfUndFuss.OptionButton18.Caption
End If
 Case Else
  strSchl|fffd|ssel = ""

End Select

If vglstrSchl|fffd|ssel = strSchl|fffd|ssel Then
i = i + 1
strSchl|fffd|ssel = ""
End If

If i > 1 Then
  MsgBox "Diese Kombination wird doppelt verwendet." & vbLf & _
  "Bitte eine andere Option setzen!", vbInformation
  Pr|fffd|fSchonBelegt = True
  Exit Function
End If


Next obj


End Function
Attribute VB_Name = "mdl_Tools"
Sub SpalteAKleinmachen()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets
 Blatt.Activate
 Columns(1).ColumnWidth = 0.1
Next Blatt
End Sub


Sub TabellenEntSch|fffd|tzen()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets

If Blatt.Visible = True Then
 Blatt.Activate
Blatt.Unprotect ""
 
End If
Next Blatt

End Sub


Sub TabellenSch|fffd|tzen()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets

 If Blatt.Visible = True Then
  Blatt.Unprotect
  Blatt.DisplayPageBreaks = False
  Blatt.EnableOutlining = True
  Blatt.EnableAutoFilter = True
  Blatt.Protect contents:=True, userInterfaceOnly:=True

 End If

Next Blatt

End Sub

Sub KommForm()
Dim Notiz As Comment
Dim Blatt As Worksheet
For Each Blatt In Worksheets
    For Each Notiz In Worksheets(Blatt.Name).Comments
        With Notiz.Shape.TextFrame.Characters.Font
         .Name = "Verdana"
         .Size = 10
        End With
    Next Notiz
Next Blatt
End Sub

Sub FarbenAuslesen()
 MsgBox ActiveCell.Interior.ColorIndex
End Sub

Sub farben|fffd|bernehmen()
ThisWorkbook.Colors = ActiveWorkbook.Colors
End Sub

Sub Kopf()
Dim Blatt As Worksheet
'muss f|fffd|r jedes Tool angepasst werden
For Each Blatt In ThisWorkbook.Worksheets

 If Blatt.Visible = True Then
 
  Blatt.PageSetup.LeftFooter = "Haufe Index: HI-Nummer - Version 1.1.1.6 - Stand: 17.11.2008"
  Blatt.DisplayPageBreaks = False
 End If

Next Blatt
End Sub

Sub SeitenAuf85Prozent()
Dim Blatt As Worksheet

For Each Blatt In ThisWorkbook.Worksheets

 If Blatt.Visible = True Then
  Blatt.Select
  ActiveWindow.Zoom = 85
 End If

Next Blatt
End Sub


Sub LabelsUmsetzenAllgemein()
Dim obj As Shape

With ActiveSheet
CheckBox2.BackColor = RGB(205, 205, 205)
 For Each obj In .Shapes
 
 If InStr(obj.Name, "CheckBox") > 0 Then
   obj.Select
   obj.Fill.BackColor.RGB = RGB(205, 205, 205)
 End If
 Next obj
End With
End Sub

Sub AlleSteuerelementeEinfaerbenAlle()
Dim OLEo As OLEObject


    Set OLEo = Nothing
    On Error Resume Next
    For Each OLEo In ActiveSheet.OLEObjects
 
   
     OLEo.Object.BackColor = RGB(204, 204, 204)
     'OLEo.Object.Font.Name = "Verdana"
     'OLEo.Object.Font.Size = 10
    
    Next OLEo
    
End Sub

Sub NamenL|fffd|schen()
Dim rngName As Name

For Each rngName In ThisWorkbook.Names

If InStr(rngName.RefersTo, "#REF") > 0 Then
On Error Resume Next
 rngName.Delete
End If

Next rngName
End Sub

Sub Version()
MsgBox Application.Version
End Sub



Sub SpaltenUndZeilenAusblenden()
Dim Blatt As Worksheet
For Each Blatt In ThisWorkbook.Worksheets
If Blatt.Visible = True Then
 Blatt.Activate
   ActiveWindow.DisplayHeadings = False
 End If
 Next Blatt

Sheets(1).Select
End Sub


Sub HyperlinkInfosWegmachen()
Dim Blatt As Worksheet
Dim hyper As Hyperlink

For Each Blatt In ThisWorkbook.Worksheets

If Blatt.Visible = True Then
Blatt.Unprotect ""
For Each hyper In Blatt.Hyperlinks
    hyper.ScreenTip = hyper.TextToDisplay
    
 Next hyper
Blatt.Protect ""
End If

Next Blatt
End Sub


Sub EreignisAn()
 Application.EnableEvents = True
End Sub


Sub menueid()
Dim cb As CommandBarControl

For Each cb In Application.CommandBars(1).Controls(1).Controls
 Debug.Print cb.Caption & " " & cb.ID
Next cb
End Sub


Sub SpeichernWeg()
Dim cb As CommandBarControl

For Each cb In Application.CommandBars _
("Worksheet Menu Bar").Controls(1).Controls

 If cb.ID = 3 Then
    cb.Enabled = False
 End If

Next cb


For Each cb In Application.CommandBars _
("Standard").Controls

 If cb.ID = 3 Then
    cb.Enabled = False
 End If

Next cb

Application.OnKey "^s", "MakroTest"


End Sub

Sub SpeichernDa()
Dim cb As CommandBarControl

For Each cb In Application.CommandBars _
("Worksheet Menu Bar").Controls(1).Controls

 If cb.ID = 3 Then
    cb.Enabled = True
 End If

Next cb
For Each cb In Application.CommandBars _
("Standard").Controls

 If cb.ID = 3 Then
    cb.Enabled = True
 End If

Next cb
Application.OnKey "^s"
End Sub

Sub Makrotest()
 MsgBox "Bitte benutzen Sie den Speicherbefehl in der Haufe-Symbolleiste!", vbInformation
End Sub


Sub Aufmachen()
Dim Tabelle As Worksheet

For Each Tabelle In ActiveWorkbook.Worksheets
 Tabelle.Visible = True
Next Tabelle

End Sub

Sub TabellenKontextmen|fffd|Aktivieren()
Application.CommandBars("Ply").Enabled = True
End Sub


Sub LetzteSpalteEin()
 ActiveSheet.Columns(256).ColumnWidth = 14
End Sub

Sub LockenUndSch|fffd|tzen()
Dim Blatt As Worksheet
Dim zelle As Range
Dim zz As Range

For Each Blatt In ActiveWorkbook.Worksheets

If Blatt.Visible = True Then

  Select Case Blatt.Name
  Case "Startseite", "Hilfe"
  
  Case Else
  
  Blatt.Unprotect
  
  For Each zelle In Blatt.UsedRange
  If zelle.HasFormula = True Then
  If zelle.MergeCells = True Then
   zelle.MergeArea.Cells.Locked = True
      Else
   zelle.Locked = True
    End If
  Else
   If zelle.Interior.ColorIndex = xlColorIndexNone Then
     If zelle.MergeCells = True Then
          zelle.MergeArea.Cells.Locked = False
      Else
      zelle.Locked = False
    End If
   End If
  End If
  
  Next zelle
  Blatt.Protect
  End Select
Else
Blatt.Unprotect
End If
Next Blatt
End Sub

Sub MakroWarnungAn()
On Error Resume Next
START.Shapes("TextMakro").Visible = True
End Sub

Sub MakroWarnungAus()
On Error Resume Next
START.Shapes("TextMakro").Visible = False
End Sub

Sub zzauf1()
zz = 1
Application.EnableEvents = True
End Sub

Sub Seitenumbruchvorschau_an()
Dim Blatt As Worksheet
For Each Blatt In ThisWorkbook.Worksheets
If Blatt.Visible = True Then
Blatt.Activate
ActiveWindow.View = xlPageBreakPreview
End If
Next Blatt
End Sub


Sub Seitenumbruchvorschau_aus()
Dim Blatt As Worksheet
For Each Blatt In ThisWorkbook.Worksheets
If Blatt.Visible = True Then
Blatt.Activate
ActiveWindow.View = xlNormalView
End If
Next Blatt
End Sub


Attribute VB_Name = "mdl_XXXfuerAutoren"


' InQuest injected base64 decoded content
' szp%

INQUEST-PP=macro
