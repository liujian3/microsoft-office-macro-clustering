Attribute VB_Name = "Module1"
Sub |fffd|V|fffd|f|fffd|[|fffd|^INPUT()

    If MsgBox("B2|fffd|Z|fffd||fffd||fffd||243|T|fffd||fffd||fffd|v|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd|H" & Chr(10) & "|fffd|u|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|O|fffd|v|fffd|V|fffd|[|fffd|g|fffd||351|S|fffd||103||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo) = vbNo Then Exit Sub
    
    n = Cells(1, 2)
    mtype = 0 '|fffd||fffd||fffd||58c|W|fffd||fffd||fffd|s|fffd||42a42||1c2||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|B|fffd||fffd||fffd||58d|s|fffd||fffd||202||fffd|mtype=0,|fffd||fffd||fffd||fffd||fffd|U|fffd||202||fffd|1
    For i = 1 To n
        If Cells(4 + i, 1 + i) <> 1 Then mtype = 1
    Next i
    If mtype = 1 Then 'mtype|fffd||341|A0|fffd|F|fffd||fffd||fffd||581|A1|fffd|F|fffd||fffd||fffd||fffd||fffd|U|fffd|A2|fffd|F|fffd|s|fffd||38b||fffd||fffd||fffd||fffd|U|fffd|A3|fffd|F|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|s|fffd||382||255||3ca||fffd|
        If MsgBox("|fffd||fffd||fffd||34b||fffd||fffd||fffd||fffd|U|fffd|s|fffd||fffd||30c|v|fffd|Z|fffd||fffd||fffd|@|fffd||341|H" & Chr(10) & Chr(10) & _
            "|fffd|@N|fffd||14a||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd|u|fffd||342||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|" & Chr(10) & _
            "|fffd|@N-1|fffd||14a||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|i|fffd|s|fffd||38b||fffd||fffd||fffd||fffd|U|fffd|j|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|", vbYesNo) = vbYes Then
                If MsgBox("|fffd|s|fffd||38b||fffd||fffd||fffd||fffd|U|fffd||255||3ca||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo) = vbYes Then mtype = 3
        Else
            mtype = 2
        End If
    End If

    Range("|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd||fffd|X|fffd|g").ClearContents
    Sheets("|fffd|W|fffd|{|fffd||fffd||fffd||fffd|").Select
    Range(Cells(5, 1), Cells(4 + n, 1)).Copy
    Sheets("|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|O").Select
    Range("A10").Select
    Selection.PasteSpecial Paste:=xlValues
    ActiveWorkbook.Names.Add Name:="|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd||fffd|X|fffd|g", RefersTo:=Application.Selection
    Sheets("|fffd|W|fffd|{|fffd||fffd||fffd||fffd|").Select
    Range("B4").Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
  
    ActiveWorkbook.Names.Add Name:="data", RefersTo:=Range(Cells(5, 2), Cells(4 + n, 1 + n))
    Range("data").Copy
    Range("A55").Select
    Selection.PasteSpecial Paste:=xlValues
    Selection.PasteSpecial Paste:=xlValues, SkipBlanks:=True, Transpose:=True
    Selection.Copy
    Range("B5").Select
    Selection.PasteSpecial Paste:=xlValues
    Range(Cells(55, 1), Cells(54 + n, n)).ClearContents
    Range("B5").Select
    Select Case mtype
        Case 0
            Cells(4, 1) = "|fffd|W|fffd|{|fffd||fffd||fffd||fffd|"
        Case 1
            Cells(4, 1) = "|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U"
        Case 2
            Cells(4, 1) = "|fffd|s|fffd||38b||fffd||fffd||fffd||fffd|U"
        Case 3
            Cells(4, 1) = Cells(2, 2) / (Cells(2, 2) - 1)
            Cells(4, 1).Copy
            Range("data").Select
            Selection.PasteSpecial Paste:=xlValues, Operation:=xlMultiply
            Cells(4, 1) = "|fffd|s|fffd||38b||fffd||fffd||fffd||fffd|U"
    End Select
        
    Sheets("|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|O").Select
     If Cells(603 + Cells(603, 5), 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >" Or Cells(602 + Cells(603, 5), 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >" Then
        ActiveSheet.Shapes("|fffd||1c9||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
        ActiveSheet.Shapes("|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
    End If
    Range(Cells(10, 2), Cells(49, 100)).ClearContents '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd||fffd|
    Range("E50:CG599").ClearContents                    '|fffd|v|fffd|Z|fffd||fffd||fffd||fffd||fffd|S|fffd||fffd||fffd||fffd||fffd||fffd|
    Range(Cells(621, 1), Cells(702, 5)).ClearContents   '|fffd||fffd||fffd||3cd|\|fffd||fffd||fffd||303|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
    Range(Cells(601, 6), Cells(605 + Cells(603, 5) + Cells(608, 5), 20 + Cells(603, 5))).ClearContents  '|fffd||1c9||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
    Cells(603, 5).ClearContents '|fffd|p|fffd||fffd||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    Range("E10:E49").Select
    Selection.Interior.ColorIndex = xlNone   '|fffd||3d0||fffd||fffd||fffd||fffd||302||182||fffd||fffd||fffd||310|F|fffd||fffd||fffd||fffd||fffd||fffd|
    |fffd|S|fffd||fffd||fffd|B|fffd||fffd|
    |fffd||a414||fffd||fffd||fffd||fffd|l|fffd|\|fffd||fffd|
    Rows("9:49").Hidden = False
End Sub
Sub |fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|()
    Range(Cells(4, 1), Cells(250, 250)).ClearContents
    Cells(4, 1) = "|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U"
End Sub
Sub |fffd||fffd||fffd|U|fffd||109d6||42d42||202||fffd|()
    Cells(2, 2) = "=COUNTA($E$10:$E$49)"
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    For i = 1 To NN
        Cells(9 + i, 5 + i) = "v"
    Next i
End Sub
Sub |fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||502||251||fffd||fffd||582||fffd||752||fffd|()
    
    Cells(2, 2) = "=COUNTA($E$10:$E$49)"
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|

    |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    
    For i = 2 To NN
        For j = 1 To i - 1
            If Cells(9 + i, 3) = 1 And Cells(9 + j, 3) = 1 Then
                Cells(9 + i, 5 + j) = "r"
            End If
        Next j
    Next i
End Sub
Sub |fffd||fffd||fffd|f|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N()
    Cells(2, 2) = "=COUNTA($E$10:$E$49)"
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    |fffd||fffd||fffd||755||3d0||fffd||fffd||310||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
End Sub
Sub |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N(NN)
    Range(Cells(10, 3), Cells(49, 4)).ClearContents '|fffd||702||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|S|fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 1 To NN
        If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 2) = 0 Then  '|fffd||fffd||fffd||755||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            Cells(9 + i, 4) = 1
        End If
        If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 3) = 0 Then  '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            Cells(9 + i, 3) = 1
        Else
            Cells(9 + i, 2).ClearContents
        End If
    Next i
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||343|G|fffd||fffd||fffd|A", RefersTo:=Range(Cells(10, 6), Cells(9 + NN, 5 + NN))
End Sub
Sub |fffd||fffd||fffd||755||3d0||fffd||fffd||310||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N(NN)
    For i = 1 To NN
        If Cells(9 + i, 4) = 1 Then
                If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(82, 5 + i) = 0 Then
                    If MsgBox("|fffd||fffd||fffd||755||3d0||fffd||fffd||202||302||255||fffd||fffd|U|fffd||242||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||42a82||202||fffd||fffd||42a82||fffd||fffd||fffd||702||fffd|" & Chr(10) & _
                        "|fffd|S|fffd||102||310||fffd||fffd||755||3d0||fffd||fffd||301|i|fffd|c|fffd||fffd||fffd|j|fffd||fffd||fffd|U|fffd||fffd|1|fffd||250||fffd||fffd||42d42||702||fffd||fffd||fffd||fffd|H", vbYesNo) = vbNo Then
                        Exit Sub
                    Else
                        |fffd||fffd||fffd||755||3d0||fffd||fffd||315||fffd||fffd|U|fffd||109d6||fffd| NN
                    End If
                    Exit Sub
                End If
        End If
    Next i
End Sub
Sub |fffd||fffd||fffd||755||3d0||fffd||fffd||315||fffd||fffd|U|fffd||109d6||fffd|(NN)
    For i = 1 To NN
        If Cells(9 + i, 4) = 1 Then Cells(9 + i, 5 + i) = "v:1"
    Next i
End Sub
Sub |fffd||fffd|m|fffd||fffd||fffd||3d0||fffd||fffd||fffd|()
    NN = Cells(2, 2)
    |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    For i = 1 To NN
        If Cells(9 + i, 3) = 1 And Cells(9 + i, 4) <> 1 Then
            Cells(9 + i, 2) = 1
            Cells(9 + i, 5 + i) = "v$"
        End If
    Next i
    For i = 2 To NN
        For j = 1 To i - 1
            If Cells(9 + i, 2) = 1 And Cells(9 + j, 2) = 1 Then
                Cells(9 + i, 5 + j) = "r$"
                Cells(9 + j, 5 + i).ClearContents
            End If
        Next j
    Next i
End Sub
Sub |fffd||fffd|m|fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd|()
    Range(Cells(10, 6), Cells(49, 45)).Select
    Selection.Replace What:="$", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Range(Cells(10, 2), Cells(49, 2)).ClearContents
End Sub
Sub |fffd|v|fffd|Z|fffd||fffd||fffd||fffd|()

    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    |fffd||fffd||fffd||755||3d0||fffd||fffd||310||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    n = Cells(3, 2)     '|fffd||3d1||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|N|fffd||182||fffd||fffd||fffd|
    
    Range("E50:CG599").ClearContents
'|fffd|e|fffd||fffd||fffd|s|fffd||fffd||18e|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd|G|fffd||fffd||fffd|A|fffd||256||fffd||fffd||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd|e|fffd||fffd||fffd|s|fffd||fffd|", RefersTo:=Range(Cells(51, 6), Cells(50 + NN, 5 + NN))
    ActiveWorkbook.Names.Add Name:="|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U", RefersTo:=Range(Cells(101, 6), Cells(100 + NN, 5 + NN))
    ActiveWorkbook.Names.Add Name:="|fffd|c|fffd||fffd||fffd||fffd||fffd|U", RefersTo:=Range(Cells(101, 2), Cells(100 + NN, 2))
   
    |fffd||3d0||fffd||fffd|Z|fffd|b|fffd|g n, NN
    |fffd||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd||fffd||fffd| NN, n
    |fffd||fffd||fffd|f|fffd||fffd|INPUT n, NN
    |fffd||fffd||fffd||fffd||fffd|l|fffd|Z|fffd|b|fffd|g
    |fffd||30d||650||fffd||fffd||fffd| NN, n
    Cells(10, 10).Select
    Application.CutCopyMode = False
End Sub
Sub |fffd||fffd||fffd|f|fffd||fffd||fffd|C|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    n = Cells(3, 2)     '|fffd||3d1||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|N|fffd||182||fffd||fffd||fffd|
    
    |fffd||3d0||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    |fffd||fffd||fffd||755||3d0||fffd||fffd||310||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N NN
    |fffd||3d0||fffd||fffd|Z|fffd|b|fffd|g n, NN
    |fffd||fffd||fffd|f|fffd||fffd|INPUT n, NN
    |fffd||fffd||fffd||fffd||fffd|l|fffd|Z|fffd|b|fffd|g
    |fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||115|\|fffd||fffd|
    |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||115|\|fffd||fffd|
    Cells(10, 10).Select
End Sub
Sub |fffd||3d0||fffd||fffd|Z|fffd|b|fffd|g(n, NN)

    Range(Rows(50), Rows(150)).Hidden = False
    Range("E10:E49").Interior.ColorIndex = xlNone   '|fffd||3d0||fffd||fffd||fffd||fffd||302||182||fffd||fffd||fffd||310|F|fffd||fffd||fffd||fffd||fffd||fffd|
    Cells(9, 5).ClearContents  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|R|fffd|s|fffd||fffd||fffd||202||fffd||fffd||60a4||fffd||242||fffd||fffd||fffd||fffd||fffd||fffd||55d8e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     If Cells(603 + Cells(603, 5), 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >" Or Cells(602 + Cells(603, 5), 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >" Then   '|fffd||1c9||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||60a4||fffd||202||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Shapes("|fffd||1c9||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
        ActiveSheet.Shapes("|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
    End If
    Range(Cells(601, 6), Cells(605 + Cells(603, 5) + Cells(608, 5), 20 + Cells(603, 5))).ClearContents

'|fffd||702||fffd||fffd|A|fffd||fffd||fffd||755||3d0||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||60a4||fffd||255||fffd||fffd||5d1||582||fffd||fffd||109|e|fffd||fffd||fffd|s|fffd||fffd|G|fffd||fffd||fffd|A|fffd||243|Z|fffd|b|fffd|g
    Range(Cells(9, 4), Cells(9 + NN, 5 + NN)).Copy
    Cells(50, 4).Select
    Selection.PasteSpecial Paste:=xlValues
    Selection.Sort Key1:=Range("D51"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, SortMethod _
        :=xlPinYin
    Range(Cells(10, 4), Cells(9 + NN, 4)).Copy
    Cells(99, 6).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Range(Cells(99, 6), Cells(50, 5 + NN)).Select
    Selection.Sort Key1:=Range("F99"), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlLeftToRight, SortMethod _
        :=xlPinYin                                  '|fffd||fffd||fffd||5d1||582||fffd||fffd||103|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Range(Cells(50, 4), Cells(50 + NN, 4)).ClearContents     '|fffd|]|fffd|v|fffd||202||fffd||fffd||302||fffd||fffd||fffd||fffd||fffd|
    Range(Cells(50, 5), Cells(50 + NN, 5 + NN)).Copy
    Cells(100, 5).Select    '|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd|s|fffd||fffd|G|fffd||fffd||fffd|A
    Selection.PasteSpecial Paste:=xlValues
  
    Range(Cells(51, 6), Cells(149, 100)).Interior.ColorIndex = xlNone  '|fffd|Z|fffd||fffd||fffd||310|F|fffd||fffd||fffd||182||80a0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        
End Sub
Sub |fffd||fffd||fffd|f|fffd||fffd|INPUT(n, NN)

'|fffd|e|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|R|fffd|p|fffd|X|fffd||fffd|b|fffd|A|fffd||152||fffd|p|fffd|X|fffd||342||fffd||fffd||310||fffd||fffd|l|fffd|A|fffd||fffd||fffd||fffd|0|fffd||242||202||fffd||60a4||fffd||fffd|
    Application.Goto Reference:="|fffd|e|fffd||fffd||fffd|s|fffd||fffd|"
    Selection.Replace What:="r*", Replacement:="", LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Selection.Replace What:="v*", Replacement:="", LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Selection.Replace What:="*:", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Selection.Replace What:="", Replacement:=0, LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
'|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd|s|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|R|fffd||a414||fffd||fffd|r|fffd||fffd|v|fffd|A|fffd||152||fffd||a414||fffd||342||fffd||fffd||310||fffd||fffd|l|fffd|A|fffd||fffd||fffd||fffd|0|fffd||242||202||fffd||60a4||fffd||fffd|
    Application.Goto Reference:="|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U"
    Selection.Replace What:="b*", Replacement:="", LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Selection.Replace What:="*:", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
    Selection.Replace What:="", Replacement:=0, LookAt:=xlWhole, _
        SearchOrder:=xlByRows, MatchCase:=False, MatchByte:=False
'|fffd||fffd||fffd|R|fffd||a414||fffd||fffd||fffd|Z|fffd|b|fffd|g
   npr = 0
    
    For i = 1 To NN
        For j = 1 To NN
            If Cells(50 + i, 5 + j) = "b" Then
                npr = npr + 1
                Cells(600 + npr, 6) = npr
                Cells(600 + npr, 7) = "|fffd|p|fffd|X"
                Cells(600 + npr, 8) = i
                Cells(600 + npr, 9) = j
                Cells(600 + npr, 10) = CStr(i) & "<-" & CStr(j)
                Cells(600 + npr, 11) = Cells(50 + i, 5)
                Cells(600 + npr, 12) = Cells(50 + j, 5)
                Cells(50 + i, 5 + j) = "=M" & CStr(600 + npr)
                Cells(50 + i, 5 + j).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
            End If
        Next j
    Next i
'|fffd||3d0||fffd||fffd||fffd||fffd||5d1||582||fffd||fffd||582||311||389||fffd||fffd|F|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||fffd|Q|fffd||182||fffd||fffd||fffd||182||fffd||fffd||341|Ai|fffd||fffd|CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))|fffd||fffd|OK
    For i = 1 To NN
             If Cells(100 + i, 5 + i) = "v" Then
                npr = npr + 1
                Cells(600 + npr, 6) = npr
                Cells(600 + npr, 7) = "|fffd||fffd||fffd|U"
                Cells(600 + npr, 8) = i
                Cells(600 + npr, 9) = i
                Cells(600 + npr, 10) = CStr(i) & "," & CStr(i)
                Cells(600 + npr, 11) = Cells(50 + i, 5)
                If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 3) <> 1 Then
                    Cells(600 + npr, 12) = "|fffd|c|fffd||fffd|"
                End If
                Cells(100 + i, 5 + i) = "=M" & CStr(600 + npr)
                Cells(100 + i, 5 + i).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
            ElseIf Cells(100 + i, 5 + i) = "v$" Then '|fffd||fffd|m|fffd||fffd||fffd||3d0||fffd||fffd||315||fffd||fffd|U|fffd|Z|fffd|b|fffd|g
                Cells(100 + i, 5 + i) = Cells(550 + i - Cells(4, 2), 5 + i - Cells(4, 2))
            End If
    Next i
    For i = 1 To NN
        For j = 1 To NN
            If Cells(100 + i, 5 + j) = "r" Then
                npr = npr + 1
                Cells(600 + npr, 6) = npr
                Cells(600 + npr, 7) = "|fffd||fffd||fffd||fffd||fffd|U"
                Cells(600 + npr, 8) = i
                Cells(600 + npr, 9) = j
                Cells(600 + npr, 10) = CStr(i) & "," & CStr(i)
                Cells(600 + npr, 11) = Cells(50 + i, 5)
                Cells(600 + npr, 12) = Cells(50 + j, 5)
                Cells(100 + i, 5 + j) = "=M" & CStr(600 + npr)
                Cells(100 + j, 5 + i) = "=M" & CStr(600 + npr)
                Cells(100 + i, 5 + j).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
                Cells(100 + j, 5 + i).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
            ElseIf Cells(100 + i, 5 + j) = "r$" Then '|fffd||fffd|m|fffd||fffd||fffd||3d0||fffd||fffd||30b||fffd||fffd||fffd||fffd|U|fffd|Z|fffd|b|fffd|g
                Cells(100 + i, 5 + j) = Cells(550 + i - Cells(4, 2), 5 + j - Cells(4, 2))
                Cells(100 + j, 5 + i) = Cells(550 + i - Cells(4, 2), 5 + j - Cells(4, 2))
            End If
        Next j
    Next i

    For i = 1 To NN
        For j = 1 To NN
            If IsNumeric(Cells(50 + i, 5 + j)) = False Then '|fffd||fffd||fffd|l|fffd||fffd||fffd||fffd|p|fffd||a414||fffd||fffd||fffd|x|fffd||fffd|
                Cells(50 + i, 5 + j).Interior.ColorIndex = 34 '|fffd||fffd||fffd|F|fffd||242||fffd||fffd||fffd|
                Cells(601 + npr, 11) = Cells(50 + i, 5 + j)
                Cells(601 + npr, 13).FormulaR1C1 = "=COUNTIF(R601C:R[-1]C,RC[-2])"
                If Cells(601 + npr, 13) = 0 Then
                    npr = npr + 1
                    Cells(600 + npr, 6) = npr
                    Cells(600 + npr, 7) = "|fffd||fffd||fffd|l"
                    Cells(600 + npr, 8) = "|fffd|Q|fffd||190||fffd|="
                    Cells(600 + npr, 9) = 1
                    Cells(600 + npr, 13) = Cells(50 + i, 5 + j)
                    Cells(50 + i, 5 + j) = "=M" & CStr(600 + npr)
                Else
                    Cells(601 + npr, 13).FormulaR1C1 = "=MATCH(RC[-2],R601C:R[-1]C,0)"
                    Cells(50 + i, 5 + j) = "=M" & CStr(600 + Cells(601 + npr, 13))
                    Cells(CStr(600 + Cells(601 + npr, 13)), 9) = Cells(CStr(600 + Cells(601 + npr, 13)), 9) + 1
                    Range(Cells(601 + npr, 11), Cells(601 + npr, 13)).ClearContents
                End If
            End If
        Next j
    Next i
    For i = 1 To NN
        For j = 1 To NN
            If IsNumeric(Cells(100 + i, 5 + j)) = False Then    '|fffd||fffd||fffd|l|fffd||fffd||fffd||fffd|p|fffd||a414||fffd||fffd||fffd|x|fffd||fffd|
                Cells(100 + i, 5 + j).Interior.ColorIndex = 34 '|fffd||fffd||fffd|F|fffd||242||fffd||fffd||fffd|
                Cells(100 + j, 5 + i).Interior.ColorIndex = 34 '|fffd||fffd||fffd|F|fffd||242||fffd||fffd||fffd|
                Cells(601 + npr, 11) = Cells(100 + i, 5 + j)
                Cells(601 + npr, 13).FormulaR1C1 = "=COUNTIF(R601C:R[-1]C,RC[-2])"
                If Cells(601 + npr, 13) = 0 Then
                    npr = npr + 1
                    Cells(600 + npr, 6) = npr
                    Cells(600 + npr, 7) = "|fffd||fffd||fffd|l"
                    Cells(600 + npr, 8) = "|fffd|Q|fffd||190||fffd|="
                    Cells(600 + npr, 9) = 1
                    Cells(600 + npr, 13) = Cells(100 + i, 5 + j)
                    Cells(100 + i, 5 + j) = "=M" & CStr(600 + npr)
                    Cells(100 + j, 5 + i) = "=M" & CStr(600 + npr)
                Else
                    Cells(601 + npr, 13).FormulaR1C1 = "=MATCH(RC[-2],R601C:R[-1]C,0)"
                    Cells(100 + i, 5 + j) = "=M" & CStr(600 + Cells(601 + npr, 13))
                    Cells(100 + j, 5 + i) = "=M" & CStr(600 + Cells(601 + npr, 13))
                    Cells(CStr(600 + Cells(601 + npr, 13)), 9) = Cells(CStr(600 + Cells(601 + npr, 13)), 9) + 1
                    Range(Cells(601 + npr, 11), Cells(601 + npr, 13)).ClearContents
                End If
            End If
        Next j
    Next i
    
    Cells(603, 5) = npr
    
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd|R|fffd||a414|", RefersTo:=Range(Cells(601, 13), Cells(600 + npr, 13))
End Sub
Sub |fffd||fffd||fffd||fffd||fffd|l|fffd|Z|fffd|b|fffd|g()
    Range(Cells(601, 13), Cells(600 + Cells(603, 5), 13)) = Cells(3, 9)
'|fffd|p|fffd|X
    If Cells(3, 7) > 0 Then
        Range(Cells(601, 13), Cells(600 + Cells(3, 7), 13)) = Cells(3, 8)
    End If
'|fffd||fffd||fffd|U
    If Cells(4, 7) > 0 Then
        Range(Cells(601 + Cells(3, 7), 13), Cells(600 + Cells(3, 7) + Cells(4, 7), 13)) = Cells(4, 8)
        If Cells(4, 9) <> "" Then
            For i = 1 To Cells(4, 7)
                If Cells(600 + Cells(3, 7) + i, 12) = "|fffd|c|fffd||fffd|" Then
                    Cells(600 + Cells(3, 7) + i, 13) = Cells(4, 9)
                End If
            Next i
        End If
        If Cells(5, 9) = "ON" Then
            For i = 1 To Cells(4, 7)
                If Cells(600 + Cells(3, 7) + i, 8) > Cells(4, 2) And Cells(600 + Cells(3, 7) + i, 12) <> "|fffd|c|fffd||fffd|" Then
                    Cells(600 + Cells(3, 7) + i, 13) = Cells(550 + Cells(600 + Cells(3, 7) + i, 8) - Cells(4, 2), 3)
                End If
            Next i
        End If
    End If
'|fffd||fffd||fffd||fffd|
    If Cells(5, 7) > 0 Then
        Range(Cells(601 + Cells(3, 7) + Cells(4, 7), 13), Cells(600 + Cells(3, 7) + Cells(4, 7) + Cells(5, 7), 13)) = Cells(5, 8)
        If Cells(5, 9) = "ON" Then
            For i = 1 To Cells(5, 7)
                r = Cells(601 + Cells(603, 5) - i, 8)
                c = Cells(601 + Cells(603, 5) - i, 9)
                If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + r, 1)), 3) = 1 And Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + c, 1)), 3) = 1 And _
                   Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + r, 1)), 4) <> 1 And Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + c, 1)), 4) <> 1 Then
                    Cells(601 + Cells(603, 5) - i, 13) = Cells(550 + r - Cells(4, 2), 5 + c - Cells(4, 2))
                End If
            Next i
        End If
    End If
    
    Cells(9, 5) = "|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(50, 4) = "|fffd|p|fffd|X|fffd|W|fffd||fffd|"
    Cells(609, 5).ClearContents
End Sub
Sub |fffd||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd||fffd||fffd|(NN, n)

'|fffd|P|fffd||28d|s|fffd||fffd||256||fffd||fffd||fffd|
    Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Visible = True
    Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Select
    ActiveWorkbook.Names.Add Name:="|fffd|P|fffd||28d|s|fffd||fffd|", RefersTo:=Range(Cells(1, 1), Cells(NN, NN))
    ActiveWorkbook.Names.Add Name:="|fffd|P|fffd||28d|s|fffd||fffd|", RefersTo:=Range(Cells(1, 1), Cells(n, n))
    ActiveWorkbook.Names.Add Name:="|fffd|O|fffd|p", RefersTo:=Range(Cells(41, 1), Cells(40 + n, n))
    Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Visible = False
    Sheets("|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|O").Select
'|fffd||a2e4||fffd||fffd||fffd|U|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", RefersTo:=Range(Cells(451, 6), Cells(450 + NN, 5 + NN))
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").FormulaArray = "=MINVERSE(|fffd|P|fffd||28d|s|fffd||fffd|-|fffd|e|fffd||fffd||fffd|s|fffd||fffd|)" '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||281|iI-A)^-1|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd||510||68c||fffd||fffd||fffd|", RefersTo:=Range(Cells(501, 6), Cells(500 + NN, 5 + NN))
    Range("|fffd||510||68c||fffd||fffd||fffd|").FormulaArray = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd|e|fffd||fffd||fffd|s|fffd||fffd|" '|fffd||82||fffd||fffd||142||24a||510||68c||fffd||fffd||282||fffd||fffd||fffd||fffd||7c2||102||fffd||fffd||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd||a2e4||fffd||fffd||fffd|U", RefersTo:=Range(Cells(151, 6), Cells(150 + NN, 5 + NN))
    Range("|fffd||a2e4||fffd||fffd||fffd|U").FormulaArray = "=MMULT(MMULT(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U),TRANSPOSE(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))"
    ActiveWorkbook.Names.Add Name:="|fffd||a2e4||fffd||fffd||fffd|U|fffd||fffd|", RefersTo:=Range(Cells(151 + NN - n, 6 + NN - n), Cells(150 + NN, 5 + NN))

'|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd|Z|fffd|b|fffd|g
    Range(Cells(100, 6 + NN - n), Cells(100, 5 + NN)).Copy
    Cells(550, 6).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(551, 5).Select
        Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    ActiveWorkbook.Names.Add Name:="|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd|", RefersTo:=Range(Cells(551, 5), Cells(550 + n, 5))
'|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||3d0||fffd||fffd||30f||fffd||fffd||24f|]|fffd||fffd||fffd||10e||fffd||fffd|o|fffd||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U", RefersTo:=Range(Cells(551, 6), Cells(550 + n, 5 + n))
    Range("|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U").FormulaArray = "=INDEX(data,MATCH(|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd|,|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd||fffd|X|fffd|g,0),TRANSPOSE(MATCH(|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd|,|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd||fffd|X|fffd|g,0)))"

'|fffd||a2e4||fffd||fffd||fffd|U|fffd||195|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd|s|fffd||42a42||fffd||38a|p|fffd||fffd||fffd||fffd||fffd||82||702||856a||fffd|U|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd|B
    ActiveWorkbook.Names.Add Name:="|fffd||a56a||fffd|U", RefersTo:=Range(Cells(151, 3), Cells(150 + NN, 3))
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd|{|fffd||fffd||fffd|U", RefersTo:=Range(Cells(551, 3), Cells(550 + n, 3))

'|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    Range(Cells(50, 5), Cells(50 + NN, 5 + NN)).Copy
    Cells(50, 7 + NN).Select '|fffd||fffd||fffd||fffd||fffd||255|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c2||115|\|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    Cells(100, 7 + NN).Select '|fffd||fffd||fffd||fffd||fffd||255|W|fffd||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd||7c2||115|\|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    Cells(150, 7 + NN).Select '|fffd||fffd||fffd||fffd||fffd||255||a44a||fffd||58d|s|fffd||fffd||fffd||fffd||fffd||fffd||7c2||115|\|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    Cells(450, 7 + NN).Select '|fffd||fffd||fffd||fffd||fffd||255|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd||7c2||115|\|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    Cells(500, 7 + NN).Select '|fffd||fffd||fffd||fffd||fffd||255|W|fffd||fffd||fffd||fffd||fffd||510||68c||fffd||fffd||282||fffd||fffd||fffd||fffd||7c2||115|\|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    
    Range("|fffd|e|fffd||fffd||fffd|s|fffd||fffd|").Copy
    Cells(51, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlFormats
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd|", RefersTo:=Application.Selection
    
    Range("|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U").Copy
    Cells(101, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlFormats
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U", RefersTo:=Application.Selection
    
    ActiveWorkbook.Names.Add Name:="|fffd||a44a||fffd||fffd|", RefersTo:=Range(Cells(151, 8 + NN), Cells(150 + NN, 7 + 2 * NN))
    
    Cells(50, 7 + NN) = "|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(100, 7 + NN) = "|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(150, 7 + NN) = "|fffd||a44a||fffd||fffd|"
    Cells(450, 7 + NN) = "|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(500, 7 + NN) = "|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(550, 7 + NN) = "|fffd|W|fffd|{|fffd||fffd||fffd||fffd|"
    Range("|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd|").FormulaArray = "=|fffd|e|fffd||fffd||fffd|s|fffd||fffd|*SQRT(TRANSPOSE(|fffd||a56a||fffd|U)/|fffd||a56a||fffd|U)"
    Range("|fffd|W|fffd||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U").FormulaArray = "=|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U/SQRT(TRANSPOSE(|fffd|c|fffd||fffd||fffd||fffd||fffd|U)*|fffd|c|fffd||fffd||fffd||fffd||fffd|U)"
    Range("|fffd||a44a||fffd||fffd|").FormulaArray = "=|fffd||a2e4||fffd||fffd||fffd|U/SQRT(TRANSPOSE(|fffd||a56a||fffd|U)*|fffd||a56a||fffd|U)"
    Range(Cells(451, 8 + NN), Cells(450 + NN, 7 + 2 * NN)).FormulaArray = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*SQRT(TRANSPOSE(|fffd||a56a||fffd|U)/|fffd||a56a||fffd|U)"
    Range(Cells(501, 8 + NN), Cells(500 + NN, 7 + 2 * NN)).FormulaArray = "=|fffd||510||68c||fffd||fffd||fffd|*SQRT(TRANSPOSE(|fffd||a56a||fffd|U)/|fffd||a56a||fffd|U)"
    Range(Cells(551, 8 + NN), Cells(550 + n, 7 + NN + n)).FormulaArray = "=|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U/SQRT(TRANSPOSE(|fffd|W|fffd|{|fffd||fffd||fffd|U)*|fffd|W|fffd|{|fffd||fffd||fffd|U)"

'|fffd|K|fffd||fffd||fffd|x|fffd|]|fffd||fffd||fffd||302||fffd||fffd||7c2||30a|e|fffd||fffd|s|fffd||4924e|Z
      
    ActiveWorkbook.Names.Add Name:="inv|fffd||fffd|~|fffd|W", RefersTo:=Range(Cells(201, 6), Cells(200 + n, 5 + n)) '|fffd||fffd|^-1*S|fffd||fffd||fffd||fffd||fffd||7c2||fffd||182||fffd||fffd||fffd|
    Range("inv|fffd||fffd|~|fffd|W").FormulaArray = "=MMULT(MINVERSE(|fffd||a2e4||fffd||fffd||fffd|U|fffd||fffd|),|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U)"
    Range("|fffd||3d1||fffd||fffd||3d0||fffd||fffd||fffd|").Copy    '|fffd||42f82||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||60a4|
    Cells(201, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(251, 5).Select    '|fffd||3d0||fffd||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd|
    Selection.PasteSpecial Paste:=xlValues
    Cells(301, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(351, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(401, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(400, 6).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Cells(400, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Cells(401, 7 + NN).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(550, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Cells(551, 7 + NN).Select
    Selection.PasteSpecial Paste:=xlValues
    
    ActiveWorkbook.Names.Add Name:="inv|fffd||fffd|~|fffd|W|fffd||311||38a|p", RefersTo:=Range(Cells(201, 4), Cells(200 + n, 4))
    ActiveWorkbook.Names.Add Name:="GFI|fffd||fffd||fffd|q|fffd||38a|p", RefersTo:=Range(Cells(251, 4), Cells(250 + n, 4))
    ActiveWorkbook.Names.Add Name:="GFI|fffd||fffd||fffd||fffd||38a|p", RefersTo:=Range(Cells(301, 4), Cells(300 + n, 4))
    ActiveWorkbook.Names.Add Name:="GLS|fffd|p|fffd||38a|p", RefersTo:=Range(Cells(351, 4), Cells(350 + n, 4))
    
    Range(Cells(251, 6), Cells(250 + n, 5 + n)).FormulaArray = "=MMULT(inv|fffd||fffd|~|fffd|W-|fffd|P|fffd||28d|s|fffd||fffd|,inv|fffd||fffd|~|fffd|W-|fffd|P|fffd||28d|s|fffd||fffd|)"
    ActiveWorkbook.Names.Add Name:="GFI|fffd||fffd||fffd|q", RefersTo:=Range(Cells(251, 6), Cells(250 + n, 5 + n))
        
    Range(Cells(301, 6), Cells(300 + n, 5 + n)).FormulaArray = "=MMULT(inv|fffd||fffd|~|fffd|W,inv|fffd||fffd|~|fffd|W)"
    ActiveWorkbook.Names.Add Name:="GFI|fffd||fffd||fffd||fffd|", RefersTo:=Range(Cells(301, 6), Cells(300 + n, 5 + n))
   
    'GLS|fffd|p|fffd||301|oS^-1*(S-|fffd||fffd|)}^2|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    ActiveWorkbook.Names.Add Name:="GLS|fffd|p", RefersTo:=Range(Cells(351, 6), Cells(350 + n, 5 + n))
    Range("GLS|fffd|p").FormulaArray = "=MMULT(MMULT(MINVERSE(|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U),|fffd|W|fffd||195||fffd||30d||fffd|),MMULT(MINVERSE(|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U),|fffd|W|fffd||195||fffd||30d||fffd|))"
    
    'S-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd||195||fffd||30d||fffd|", RefersTo:=Range(Cells(401, 6), Cells(400 + n, 5 + n))
    Range("|fffd|W|fffd||195||fffd||30d||fffd|").FormulaArray = "=|fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U-|fffd||a2e4||fffd||fffd||fffd|U|fffd||fffd|"
    ActiveWorkbook.Names.Add Name:="SRMR|fffd|p", RefersTo:=Range(Cells(401, 8 + NN), Cells(400 + n, 7 + NN + n))
    Range("SRMR|fffd|p").FormulaArray = "=|fffd|W|fffd||195||fffd||30d||fffd|/SQRT(TRANSPOSE(|fffd|W|fffd|{|fffd||fffd||fffd|U)*|fffd|W|fffd|{|fffd||fffd||fffd|U)"
    Cells(400, 7 + NN) = "|fffd|W|fffd||fffd||fffd||fffd||fffd|c|fffd||fffd|"

End Sub
Sub ML|fffd||fffd||fffd|s()
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 4, 11
    Cells(609, 5) = "ML"
    SolverOk SetCell:="$B$207", MaxMinVal:=2, ValueOf:="0", ByChange:="|fffd||fffd||fffd|R|fffd||a414|"
    SolverOptions AssumeNonNeg:=False
    SolverSolve userFinish:=True
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 4, 11
End Sub
Sub ULS|fffd||fffd||fffd|s()
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 403, 2
    Cells(609, 5) = "ULS"
    SolverOk SetCell:="$B$403", MaxMinVal:=2, ValueOf:="0", ByChange:="|fffd||fffd||fffd|R|fffd||a414|"
    SolverOptions AssumeNonNeg:=False
    SolverSolve userFinish:=True
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 403, 2
End Sub
Sub GLS|fffd||fffd||fffd|s()
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 4, 17
    Cells(609, 5) = "GLS"
    SolverOk SetCell:="$B$355", MaxMinVal:=2, ValueOf:="0", ByChange:="|fffd||fffd||fffd|R|fffd||a414|"
    SolverOptions AssumeNonNeg:=False
    SolverSolve userFinish:=True
    |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[ 4, 17
End Sub
Sub |fffd||156||796|@RUN()
    ML|fffd||fffd||fffd|s
    MsgBox "|fffd|v|fffd|Z|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End Sub
Sub |fffd|d|fffd||742||202||fffd||fffd||14f||fffd||fffd||fffd||fffd|@RUN()
    ULS|fffd||fffd||fffd|s
    MsgBox "|fffd|v|fffd|Z|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End Sub
Sub |fffd||fffd||289||fffd||fffd||14f||fffd||fffd||fffd||fffd|@RUN()
    GLS|fffd||fffd||fffd|s
    MsgBox "|fffd|v|fffd|Z|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End Sub
Sub |fffd|s|fffd|K|fffd||fffd||fffd|G|fffd||fffd||fffd|[(r, c)
    If IsError(Cells(r, c)) = True Then
        MsgBox "|fffd|s|fffd|K|fffd||fffd||308||fffd||142||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||3cd|X|fffd||fffd||fffd||102||742||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End
    End If
End Sub
Sub |fffd||fffd|i|fffd|K|fffd||fffd||fffd||fffd|RUN()
    |fffd|\|fffd||fffd||fffd|o|fffd|[|fffd||752||fffd| 39
    |fffd|I|fffd||fffd|RUN 39
    |fffd|\|fffd||fffd||fffd|o|fffd|[|fffd||752||fffd| 40
    |fffd|I|fffd||fffd|RUN 40
    |fffd|\|fffd||fffd||fffd|o|fffd|[|fffd||752||fffd| 41
    MsgBox "|fffd|v|fffd|Z|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
End Sub
Sub |fffd|\|fffd||fffd||fffd|o|fffd|[|fffd||752||fffd|(c)
    mtime = Cells(4, c)
    hanpuku = Cells(5, c)
    syuusoku = Cells(6, c)
    SolverReset
    SolverOptions MaxTime:=mtime, Iterations:=hanpuku, Convergence:=syuusoku, AssumeNonNeg:=False

End Sub
Sub |fffd|I|fffd||fffd|RUN(c)
    Select Case Cells(3, c)
        Case "|fffd||156||796|@"
            ML|fffd||fffd||fffd|s
        Case "ULS"
            ULS|fffd||fffd||fffd|s
        Case "GLS"
            GLS|fffd||fffd||fffd|s
    End Select
End Sub
Sub |fffd||30d||650||fffd||fffd||fffd|(NN, n)
    
    Range(Rows(10 + NN), Rows(49)).Hidden = True
    Range(Rows(51 + NN), Rows(99)).Hidden = True
    Range(Rows(101 + NN), Rows(149)).Hidden = True
    Range(Rows(151 + NN), Rows(199)).Hidden = True
    Range(Rows(201 + n), Rows(249)).Hidden = True
    Range(Rows(251 + n), Rows(299)).Hidden = True
    Range(Rows(301 + n), Rows(349)).Hidden = True
    Range(Rows(351 + n), Rows(399)).Hidden = True
    Range(Rows(401 + n), Rows(449)).Hidden = True
    Range(Rows(451 + NN), Rows(499)).Hidden = True
    Range(Rows(501 + NN), Rows(549)).Hidden = True
    Range(Rows(551 + n), Rows(597)).Hidden = True
    
    Range(Cells(101, 5), Cells(100 + NN, 5)).Copy
    Cells(151, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(451, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(501, 5).Select
    Selection.PasteSpecial Paste:=xlValues
    Cells(150, 6).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Cells(450, 6).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    Cells(500, 6).Select
    Selection.PasteSpecial Paste:=xlValues, Transpose:=True
    
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Font.ColorIndex = 0
    For i = 1 To NN
        Cells(450 + i, 5 + i).Font.ColorIndex = 2
    Next i
    Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Copy
    Cells(451, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlFormats
    Cells(501, 6).Select
    Selection.PasteSpecial Paste:=xlFormats
    Cells(501, 8 + NN).Select
    Selection.PasteSpecial Paste:=xlFormats
    
    Range(Cells(10, 46), Cells(49, 47)).ClearContents '|fffd|p|fffd|X|fffd|}|fffd||fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|
End Sub
Sub |fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||317|]|fffd||fffd||fffd||20d|s|fffd||115|\|fffd||fffd|()
    Range(Rows(9), Rows(49)).Hidden = False
End Sub
Sub |fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||115|\|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Range(Rows(50), Rows(50 + NN)).Hidden = False
    Range(Rows(51 + NN), Rows(99)).Hidden = True
End Sub
Sub |fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||fffd|\|fffd||fffd|()
    Range(Rows(51), Rows(99)).Hidden = True
End Sub
Sub |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||115|\|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Range(Rows(100), Rows(100 + NN)).Hidden = False
    Range(Rows(101 + NN), Rows(149)).Hidden = True
End Sub
Sub |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|()
    Range(Rows(101), Rows(149)).Hidden = True
End Sub
Sub |fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd|U|fffd||115|\|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Range(Rows(150), Rows(150 + NN)).Hidden = False
    Range(Rows(151 + NN), Rows(199)).Hidden = True
End Sub
Sub |fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|()
    Range(Rows(151), Rows(199)).Hidden = True
End Sub
Sub |fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||115|\|fffd||fffd|()
    NN = Cells(2, 2)
    Range(Rows(9), Rows(9 + NN)).Hidden = False
    Range(Rows(10 + NN), Rows(49)).Hidden = True
End Sub
Sub |fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||fffd|\|fffd||fffd|()
    Range(Rows(9), Rows(49)).Hidden = True
End Sub
Sub |fffd||68d||5cd|s|fffd||fffd|\|fffd||fffd|()
    Range(Rows(201), Rows(399)).Hidden = True
End Sub
Sub |fffd||68d||5cd|s|fffd||115|\|fffd||fffd|()
    n = Cells(3, 2)
    Range(Rows(200), Rows(399)).Hidden = False
    Range(Rows(201 + n), Rows(249)).Hidden = True
    Range(Rows(251 + n), Rows(299)).Hidden = True
    Range(Rows(301 + n), Rows(349)).Hidden = True
    Range(Rows(351 + n), Rows(399)).Hidden = True
End Sub
Sub |fffd|c|fffd||fffd||fffd|s|fffd||115|\|fffd||fffd|()
    n = Cells(3, 2)
    Range(Rows(400), Rows(400 + n)).Hidden = False
    Range(Rows(401 + n), Rows(449)).Hidden = True
End Sub
Sub |fffd|c|fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|()
    Range(Rows(401), Rows(449)).Hidden = True
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||294||fffd|\|fffd||fffd|()
    Range(Rows(451), Rows(499)).Hidden = True
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||295|\|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Range(Rows(450), Rows(450 + NN)).Hidden = False
    Range(Rows(451 + NN), Rows(499)).Hidden = True
End Sub
Sub |fffd||510||68c||fffd||fffd||294||fffd|\|fffd||fffd|()
    Range(Rows(501), Rows(549)).Hidden = True
End Sub
Sub |fffd||510||68c||fffd||fffd||295|\|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Range(Rows(500), Rows(500 + NN)).Hidden = False
    Range(Rows(501 + NN), Rows(549)).Hidden = True
End Sub
Sub |fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|()
    Range(Rows(551), Rows(599)).Hidden = True
End Sub
Sub |fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd|()
    n = Cells(3, 2)
    Range(Rows(550), Rows(550 + n)).Hidden = False
    Range(Rows(551 + n), Rows(599)).Hidden = True
End Sub
Sub |fffd||a414||fffd||fffd||fffd||fffd|l|fffd||fffd|\|fffd||fffd|()
    Range(Rows(601), Rows(605 + 2 * Cells(603, 5))).Hidden = True
    Range(Rows(610), Rows(611)).Hidden = False
End Sub
Sub |fffd||a414||fffd||fffd||fffd||fffd|l|fffd|\|fffd||fffd|()
    Range(Rows(601), Rows(605 + 2 * Cells(603, 5))).Hidden = False
End Sub
Sub |fffd|S|fffd||fffd||fffd|B|fffd||fffd|()
    |fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||fffd|\|fffd||fffd|
    |fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||fffd|\|fffd||fffd|
    |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|
    |fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|
    |fffd||68d||5cd|s|fffd||fffd|\|fffd||fffd|
    |fffd|c|fffd||fffd||fffd|s|fffd||fffd|\|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||294||fffd|\|fffd||fffd|
    |fffd||510||68c||fffd||fffd||294||fffd|\|fffd||fffd|
    |fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd||fffd|\|fffd||fffd|
    |fffd||a414||fffd||fffd||fffd||fffd|l|fffd||fffd|\|fffd||fffd|
End Sub
Sub |fffd|S|fffd||fffd||fffd|\|fffd||fffd|()
    |fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||115|\|fffd||fffd|
    |fffd|p|fffd|X|fffd|W|fffd||fffd||fffd||115|\|fffd||fffd|
    |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||115|\|fffd||fffd|
    |fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd|U|fffd||115|\|fffd||fffd|
    |fffd|c|fffd||fffd||fffd|s|fffd||115|\|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||295|\|fffd||fffd|
    |fffd||510||68c||fffd||fffd||295|\|fffd||fffd|
    |fffd|W|fffd|{|fffd||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd|
    |fffd||a414||fffd||fffd||fffd||fffd|l|fffd|\|fffd||fffd|
End Sub
Sub |fffd||fffd||fffd||283|`|fffd|F|fffd|b|fffd|N()
    Dim y As Range
    If Cells(609, 5) = "ML" Then
        Set y = Cells(2, 11)
        k = 2
    ElseIf Cells(609, 5) = "GLS" Then
        Set y = Cells(355, 2)
        k = 2 / Cells(6, 2)
    ElseIf Cells(609, 5) = "ULS" Then
        Set y = Cells(403, 2)
        k = 2 / Cells(6, 2)
    ElseIf Cells(609, 5) = "" Then
        MsgBox "|fffd||702||fffd||fffd|v|fffd|Z|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End
    End If
    |fffd||a414||fffd||308||fffd||fffd||842b| y, k
End Sub
Sub |fffd||a414||fffd||308||fffd||fffd||842b|(y, k)

    npr = Cells(603, 5)
    h = Cells(602, 5)
    
    Dim fij As Double, fi As Double, fj As Double, f As Double
        
    Range("|fffd||fffd||fffd|R|fffd||a414|").Copy
    Cells(601, 14).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd|R|fffd||a414||fffd||6d1||fffd|", RefersTo:=Application.Selection
    
    For i = 1 To npr
    Cells(605 + npr + i, 17 + i).Select
        For j = 1 To i - 1
            Cells(600 + i, 13) = Cells(600 + i, 14) + h / 2
            Cells(600 + j, 13) = Cells(600 + j, 14) + h / 2
            fij = y
            Cells(600 + i, 13) = Cells(600 + i, 14) - h / 2
            fj = y
            Cells(600 + j, 13) = Cells(600 + j, 14) - h / 2
            f = y
            Cells(600 + i, 13) = Cells(600 + i, 14) + h / 2
            fi = y
            
            Cells(605 + npr + i, 17 + j) = (fij - fi - fj + f) / h ^ 2
            Cells(605 + npr + j, 17 + i) = (fij - fi - fj + f) / h ^ 2
            
            Cells(600 + i, 13) = Cells(600 + i, 14)
            Cells(600 + j, 13) = Cells(600 + j, 14)
        Next j
    Next i
    
    For i = 1 To npr
        f = y
        Cells(600 + i, 13) = Cells(600 + i, 14) + h
        fj = y
        Cells(600 + i, 13) = Cells(600 + i, 14) - h
        fi = y
        Cells(605 + npr + i, 17 + i) = (fi + fj - 2 * f) / h ^ 2
        Cells(600 + i, 13) = Cells(600 + i, 14)
    Next i
    
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd|s|fffd||fffd|", RefersTo:=Range(Cells(606 + npr, 18), Cells(605 + 2 * npr, 17 + npr))
    ActiveWorkbook.Names.Add Name:="|fffd||a414||fffd||fffd||fffd||fffd||fffd|U", RefersTo:=Range(Cells(601, 18), Cells(600 + npr, 17 + npr))
    
    |fffd||fffd||fffd|s|fffd||fffd||30b|t|fffd|s|fffd||fffd| npr, k
    
    For i = 1 To npr
        If Cells(600 + i, 17 + i) <= 0 Then
            MsgBox "|fffd||1c2||fffd||fffd||fffd||70b1||fffd||303||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||142||34e||fffd||fffd||282||142||fffd||fffd||202||fffd||fffd||60a4||fffd||142||fffd|"
            Cells(600, 13).Select
            End
        Else
            Cells(600 + i, 14) = Sqr(Cells(600 + i, 17 + i))
        End If
    Next i
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||84dd||fffd|v|fffd||fffd|", RefersTo:=Range(Cells(601, 15), Cells(600 + npr, 15))
    Range("|fffd||fffd||fffd||84dd||fffd|v|fffd||fffd|").FormulaArray = "=ABS(|fffd||fffd||fffd|R|fffd||a414|/|fffd||fffd||fffd|R|fffd||a414||fffd||6d1||fffd|)"
    Range(Cells(601, 16), Cells(600 + npr, 16)).FormulaArray = "=2*(1-NORMSDIST(|fffd||fffd||fffd||84dd||fffd|v|fffd||fffd|))"
    
    Cells(601, 17) = "=MAX(|fffd||fffd||fffd|R|fffd||a414||fffd||6d1||fffd|)"
    Cells(602, 17) = "=MAX(|fffd|W|fffd|{|fffd||fffd||fffd|U)"
    If Cells(601, 17) > 10 * Cells(602, 17) Then
        MsgBox "|fffd||fffd||fffd||255|s|fffd||fffd||fffd||fffd||203|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||282||142||fffd||fffd||202||fffd||fffd||fffd||fffd||309||94|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
    Else
        MsgBox "|fffd|W|fffd||fffd||fffd||b377||fffd||fffd||fffd||fffd||fffd||251||50ab||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||202||fffd||fffd||fffd||381|A|fffd||fffd||fffd||282||142||fffd||fffd||102||fffd||fffd||fffd||194||fffd||fffd|f|fffd||142||fffd||fffd||702||fffd|"
    End If
    Range(Cells(601, 17), Cells(602, 17)).ClearContents
    Cells(600, 13).Select
End Sub
Sub |fffd||fffd||fffd|s|fffd||fffd||30b|t|fffd|s|fffd||fffd|(npr, k)    '|fffd||96||60e||fffd||fffd||303|}|fffd|N|fffd||fffd||fffd||fffd||fffd||617|p
    Dim a As Range
    Dim r() As Double, eps As Double
    Dim n As Integer
    Dim i As Integer, j As Integer
    Dim i0 As Integer, j0 As Integer

    Set a = Range("|fffd||fffd||fffd|s|fffd||fffd|")
    n = npr

    ReDim r(n, n)

    For i = 0 To n - 1
        For j = 0 To n - 1
            r(i, j) = a(i + 1, j + 1)
        Next j
    Next i

    i0 = 601
    j0 = 18
    eps = Cells(604, 5)
    
    If inv(r, n, eps) = 1 Then
        MsgBox "|fffd||1c2||fffd||fffd||fffd||70b1||fffd||303||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||142||34e||fffd||fffd||282||142||fffd||fffd||202||fffd||fffd||60a4||fffd||142||fffd|"
        Range("|fffd||fffd||fffd|s|fffd||fffd|").ClearContents
        ActiveWorkbook.Names("|fffd||fffd||fffd|s|fffd||fffd|").Delete
        Cells(600, 13).Select
        End
    Else
        For i = 0 To n - 1
            For j = 0 To n - 1
                Cells(i0, j0 + j) = r(i, j) * k
            Next j
            i0 = i0 + 1
        Next i
        Range("|fffd||fffd||fffd|s|fffd||fffd|").ClearContents
        ActiveWorkbook.Names("|fffd||fffd||fffd|s|fffd||fffd|").Delete
    End If
End Sub

' |fffd|t|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd|B|fffd||fffd||fffd||fffd| r |fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|A ip |fffd|s|fffd||fffd||311||50ab||fffd||fffd||fffd|i|fffd|s|fffd||fffd||fffd|j|fffd|A epsinv |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|l

Function inv(r() As Double, ip As Integer, epsinv As Double)
    Dim i As Integer, j As Integer, k As Integer, retv As Integer
    Dim b As Double, t As Double
    Dim l() As Integer, m() As Integer

    retv = 0

    ReDim l(ip), m(ip)

    For k = 0 To ip - 1
        m(k) = k
        l(k) = k
        b = r(k, k)
        For j = k To ip - 1
            For i = k To ip - 1
                If Abs(r(j, i)) > Abs(b) Then
                    b = r(j, i)
                    l(k) = i
                    m(k) = j
                End If
            Next i
        Next j
        If Abs(b) < epsinv Then
            inv = 1
            Exit Function
        End If
        j = l(k)
        If j > k Then
            For i = 0 To ip - 1
                t = -r(i, k)
                r(i, k) = r(i, j)
                r(i, j) = t
            Next i
        End If
        i = m(k)
        If i > k Then
            For j = 0 To ip - 1
                t = -r(k, j)
                r(k, j) = r(i, j)
                r(i, j) = t
            Next j
        End If
        For i = 0 To ip - 1
            If i <> k Then
                r(k, i) = r(k, i) / -b
            End If
        Next i
        For i = 0 To ip - 1
            For j = 0 To ip - 1
                If i <> k And j <> k Then
                    r(j, i) = r(j, i) + r(k, i) * r(j, k)
                End If
            Next j
        Next i
        For j = 0 To ip - 1
            If j <> k Then
                r(j, k) = r(j, k) / b
            End If
        Next j
        r(k, k) = 1 / b
    Next k

    For k = ip - 2 To 0 Step -1
        i = l(k)
        If i > k Then
            For j = 0 To ip - 1
                t = r(k, j)
                r(k, j) = -r(i, j)
                r(i, j) = t
            Next j
        End If
        j = m(k)
        If j > k Then
            For i = 0 To ip - 1
                t = r(i, k)
                r(i, k) = -r(i, j)
                r(i, j) = t
            Next i
        End If
    Next k
End Function
Sub |fffd||fffd||fffd||3cd|\|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g()
    NN = Cells(2, 2)
    n = Cells(3, 2)
    If MsgBox("|fffd||fffd||fffd||3c1|E|fffd||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd||fffd||303|G|fffd||fffd||fffd|A|fffd||351|S|fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo) = vbYes Then
        Range(Cells(619, 1), Cells(622 + 2 * NN, 5)).ClearContents
    Cells(619, 1) = "|fffd||3d0||fffd||fffd||fffd|"
    Cells(619, 2) = "|fffd|W|fffd|{|fffd||fffd||fffd||fffd|"
    Cells(619, 3) = "|fffd||fffd||fffd||fffd|"
    Cells(619, 4) = "|fffd||fffd||fffd||fffd|l"
    Cells(619, 5) = "|fffd||a57d||fffd||fffd|"
    Range(Cells(101, 5), Cells(100 + NN, 5)).Copy
    Range(Cells(621, 1), Cells(620 + NN, 1)).PasteSpecial Paste:=xlValues
    End If
End Sub
Sub |fffd||fffd||fffd||3cd|\|fffd||fffd|INPUT()
    NN = Cells(2, 2)
    n = Cells(3, 2)
    
    Range(Cells(623 + NN, 2), Cells(622 + 2 * NN, 5)).ClearContents
    Cells(622 + NN, 1) = "--------|fffd||fffd||fffd|R|fffd||a414||fffd||fffd||fffd||fffd|l|fffd|Q|fffd||18c||fffd|-------"
    npr = 0
    
    For i = 1 To NN
        If Cells(620 + i, 3) = "" Then
                Cells(623 + NN + npr, 3) = Cells(620 + i, 1)
                Cells(623 + NN + npr, 4) = Cells(620 + i, 2)
                Cells(620 + i, 4) = "=D" & CStr(623 + NN + npr)
                npr = npr + 1
        ElseIf IsNumeric(Cells(620 + i, 3)) = False Then
            Cells(620 + i, 4) = "=COUNTIF(C" & CStr(623 + NN) & ":C" & CStr(622 + NN + npr) & ",C" & CStr(620 + i) & ")"
            If Cells(620 + i, 4) = 0 Then
                Cells(623 + NN + npr, 3) = Cells(620 + i, 3)
                Cells(623 + NN + npr, 4) = Cells(620 + i, 2)
                Cells(620 + i, 4) = "=D" & CStr(623 + NN + npr)
                npr = npr + 1
            Else
                Cells(620 + i, 4) = "=MATCH(C" & CStr(620 + i) & ",C" & CStr(623 + NN) & ":C" & CStr(622 + NN + npr) & ",0)"
                j = Cells(620 + i, 4)
                Cells(620 + i, 4) = "=D" & CStr(622 + NN + j)
            End If
        Else
            Cells(620 + i, 4) = Cells(620 + i, 3)
        End If
    Next i
    Cells(618, 2) = npr
    
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||3ce||fffd||fffd|R|fffd||a414|", RefersTo:=Range(Cells(623 + NN, 4), Cells(622 + NN + npr, 4))
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||3d5||a414|", RefersTo:=Range(Cells(621, 4), Cells(620 + NN, 4))
    ActiveWorkbook.Names.Add Name:="|fffd||a57d||fffd||fffd|", RefersTo:=Range(Cells(621, 5), Cells(620 + NN, 5))
    ActiveWorkbook.Names.Add Name:="|fffd|W|fffd|{|fffd||fffd||fffd||fffd|", RefersTo:=Range(Cells(621 + NN - n, 2), Cells(620 + NN, 2))
    ActiveWorkbook.Names.Add Name:="|fffd||a57d||fffd||3cf||fffd|", RefersTo:=Range(Cells(621 + NN - n, 5), Cells(620 + NN, 5))

    Range("|fffd||a57d||fffd||fffd|").FormulaArray = "=MMULT(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||3d5||a414|)"

End Sub
Sub |fffd||fffd||fffd||3cb||fffd||fffd||fffd||fffd|U|fffd|\|fffd||fffd||fffd||156||796|@RUN()
    Cells(609, 5) = "ML"
    SolverOk SetCell:="$D$614", MaxMinVal:=2, ValueOf:="0", ByChange:="|fffd||fffd||fffd|R|fffd||a414|,|fffd||fffd||fffd||3ce||fffd||fffd|R|fffd||a414|"
    SolverOptions AssumeNonNeg:=False
    SolverSolve
End Sub
Sub |fffd||fffd||fffd||3cd|\|fffd||fffd||fffd|\|fffd||fffd|()
    Range(Rows(610), Rows(702)).Hidden = False
End Sub
Sub |fffd||fffd||fffd||3cd|\|fffd||fffd||fffd||fffd|\|fffd||fffd|()
    Range(Rows(612), Rows(702)).Hidden = True
End Sub
Sub |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|T|fffd||fffd|()
    |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim chi2 As Range
    |fffd||fffd|@|fffd|I|fffd||fffd| chi2
    |fffd|T|fffd||fffd||fffd||fffd||fffd|s chi2
    ActiveWorkbook.Names("|fffd||693|I|fffd||590||fffd|").Delete
    |fffd||a414||fffd||fffd||fffd||fffd|l|fffd|\|fffd||fffd|
    Cells(605 + Cells(603, 5), 13).Select
End Sub
Sub |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||208||552|T|fffd||fffd|()
    |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    Dim chi2 As Range
    |fffd||fffd|@|fffd|I|fffd||fffd| chi2
    |fffd||208||552|T|fffd||fffd||fffd||fffd||fffd|s chi2
    ActiveWorkbook.Names("|fffd||693|I|fffd||590||fffd|").Delete
    |fffd||a414||fffd||fffd||fffd||fffd|l|fffd|\|fffd||fffd|
    Cells(605 + Cells(603, 5), 13).Select
End Sub
Sub |fffd||fffd|@|fffd|I|fffd||fffd|(chi2)
    If Cells(609, 5) = "ML" Then
        ActiveWorkbook.Names.Add Name:="|fffd||693|I|fffd||590||fffd|", RefersTo:=Range("B207")
        Set chi2 = Range("K2")
    ElseIf Cells(609, 5) = "GLS" Then
        ActiveWorkbook.Names.Add Name:="|fffd||693|I|fffd||590||fffd|", RefersTo:=Range("B355")
        Set chi2 = Range("Q2")
    ElseIf Cells(609, 5) = "ULS" Then
        ActiveWorkbook.Names.Add Name:="|fffd||693|I|fffd||590||fffd|", RefersTo:=Range("B403")
        Set chi2 = Range("B405")
    ElseIf Cells(609, 5) = "" Then
        MsgBox "|fffd||702||fffd||fffd|v|fffd|Z|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End
    End If
End Sub
Sub |fffd|T|fffd||fffd||fffd||30d||fffd|(npr, m)
    If Cells(603 + npr, 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >" Then
        ActiveSheet.Shapes("|fffd||1c9||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
        ActiveSheet.Shapes("|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd|").Delete
    End If
    Range(Cells(606 + npr, 6), Cells(605 + npr + m, 17)).ClearContents
    
    Cells(603 + npr, 6) = "< |fffd||1c9||fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||30c||fffd||fffd| >"
    Cells(604 + npr, 6) = "No"
    Cells(604 + npr, 7) = "|fffd||fffd||fffd|"
    Cells(604 + npr, 8) = "i"
    Cells(604 + npr, 9) = "j"
    Cells(604 + npr, 10) = "i,j"
    Cells(604 + npr, 11) = "i|fffd||fffd||fffd||fffd|"
    Cells(604 + npr, 12) = "j|fffd||fffd||fffd||fffd|"
    Cells(604 + npr, 13) = "|fffd||fffd||fffd||fffd|l"
    Cells(604 + npr, 14) = "|fffd||fffd|2|fffd||fffd||fffd|P|fffd||fffd|"
    Cells(604 + npr, 15) = "p|fffd|l(|fffd||fffd|)"
    Cells(604 + npr, 16) = "|fffd||fffd|2"
    Cells(604 + npr, 17) = "p|fffd|l(|fffd||fffd||fffd|P|fffd||fffd|)"
    Cells(605 + npr, 6) = "----------------------------------------------------------------------------------"
    
    ActiveSheet.Shapes("|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|^|fffd||fffd|").Copy
    Cells(602 + npr, 10).Select
    ActiveSheet.Paste
    Selection.Characters.Text = "|fffd|I|fffd||fffd||fffd|s" & Chr(10) & "|fffd||fffd||1c9||fffd|"
    Selection.OnAction = "|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd|"
    Selection.Name = "|fffd||1c9||fffd||fffd|{|fffd|^|fffd||fffd|"
    Cells(602 + npr, 12).Select
    ActiveSheet.Paste
    Selection.Characters.Text = "|fffd||1c9||fffd||fffd||a414|" & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Selection.OnAction = "|fffd||1c9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d||10c|v|fffd|Z"
    Selection.Name = "|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd|"
End Sub
Sub |fffd|T|fffd||fffd||fffd||fffd||fffd|s(chi2)
    Dim x As Range, chi0 As Double
    
    NN = Cells(2, 2)
    npr = Cells(603, 5)
    chi0 = CDbl(chi2)
    m = Cells(608, 5)
    
    |fffd|T|fffd||fffd||fffd||30d||fffd| npr, m
    
    Range("|fffd||fffd||fffd|R|fffd||a414|").Copy
    Cells(601, 17).Select
    Selection.PasteSpecial Paste:=xlValues
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd||182||309||fffd|", RefersTo:=Application.Selection
    
    m = 0
    For i = 1 To NN
        For j = 1 To NN
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 2) <> 1 Or Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 2) <> 1 Then
            ActiveWorkbook.Names.Add Name:="x", RefersTo:=Cells(50 + i, 5 + j)
            If i <> j And Cells(50 + i, 5 + j) = 0 Then
                SolverOk SetCell:="|fffd||693|I|fffd||590||fffd|", MaxMinVal:=2, ValueOf:="0", ByChange:="x,|fffd||fffd||fffd|R|fffd||a414|"
                SolverOptions AssumeNonNeg:=False
                SolverSolve userFinish:=True
                If chi0 - CDbl(chi2) > Cells(607, 5) Then
                    m = m + 1
                    Cells(605 + npr + m, 6) = m
                    Cells(605 + npr + m, 7) = "|fffd|p|fffd|X"
                    Cells(605 + npr + m, 8) = i
                    Cells(605 + npr + m, 9) = j
                    Cells(605 + npr + m, 10) = CStr(i) & "<-" & CStr(j)
                    Cells(605 + npr + m, 11) = Cells(50 + i, 5)
                    Cells(605 + npr + m, 12) = Cells(50 + j, 5)
                    If Cells(605, 5) = "|fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                        Cells(605 + npr + m, 13) = Cells(50 + i, 5 + j)
                    Else
                        Cells(605 + npr + m, 13) = Cells(50 + i, 5 + j) * Sqr(Cells(150 + j, 3) / Cells(150 + i, 3))
                    End If
                    Cells(605 + npr + m, 14) = chi0 - CDbl(chi2)
                    Cells(605 + npr + m, 16) = CDbl(chi2)
                End If
                Cells(50 + i, 5 + j) = 0
                Range("|fffd||fffd||fffd||182||309||fffd|").Copy
                Range("|fffd||fffd||fffd|R|fffd||a414|").PasteSpecial Paste:=xlValues
            End If
        End If
        Next j
    Next i
If Cells(606, 5) = "|fffd|p|fffd|X&|fffd||fffd||fffd||fffd||fffd|U" Then
    For i = 2 To NN
        For j = 1 To i - 1
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 2) <> 1 Or Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 2) <> 1 Then
            ActiveWorkbook.Names.Add Name:="x", RefersTo:=Cells(100 + i, 5 + j)
            If Cells(100 + i, 5 + j) = 0 Then
                Cells(100 + j, 5 + i).FormulaR1C1 = "=R" & CStr(100 + i) & "C" & CStr(5 + j)
                SolverOk SetCell:="|fffd||693|I|fffd||590||fffd|", MaxMinVal:=2, ValueOf:="0", ByChange:="x,|fffd||fffd||fffd|R|fffd||a414|"
                SolverOptions AssumeNonNeg:=False
                SolverSolve userFinish:=True
                If chi0 - CDbl(chi2) > Cells(607, 5) Then
                    m = m + 1
                    Cells(605 + npr + m, 6) = m
                    Cells(605 + npr + m, 7) = "|fffd||fffd||fffd||fffd||fffd|U"
                    Cells(605 + npr + m, 8) = i
                    Cells(605 + npr + m, 9) = j
                    Cells(605 + npr + m, 10) = CStr(i) & "," & CStr(j)
                    Cells(605 + npr + m, 11) = Cells(50 + i, 5)
                    Cells(605 + npr + m, 12) = Cells(50 + j, 5)
                    If Cells(605, 5) = "|fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                        Cells(605 + npr + m, 13) = Cells(100 + i, 5 + j)
                    Else
                        Cells(605 + npr + m, 13) = Cells(100 + i, 5 + j) / Sqr(Cells(100 + j, 2) * Cells(100 + i, 2))
                    End If
                    Cells(605 + npr + m, 14) = chi0 - CDbl(chi2)
                    Cells(605 + npr + m, 16) = CDbl(chi2)
                End If
                Cells(100 + i, 5 + j) = 0
                Cells(100 + j, 5 + i) = 0
                Range("|fffd||fffd||fffd||182||309||fffd|").Copy
                Range("|fffd||fffd||fffd|R|fffd||a414|").PasteSpecial Paste:=xlValues
            End If
        End If
        Next j
    Next i
End If
    Application.CutCopyMode = False
    Cells(608, 5) = m
    If m = 0 Then End
    ActiveWorkbook.Names.Add Name:="x", RefersTo:=Range(Cells(606 + npr, 16), Cells(605 + npr + m, 16))
    Range(Cells(606 + npr, 17), Cells(605 + npr + m, 17)).Select
    Selection.FormulaArray = "=CHIDIST(x,K3-1)"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlValues
    ActiveWorkbook.Names.Add Name:="x", RefersTo:=Range(Cells(606 + npr, 14), Cells(605 + npr + m, 14))
    Range(Cells(606 + npr, 15), Cells(605 + npr + m, 15)).Select
    Selection.FormulaArray = "=CHIDIST(x,1)"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlValues
    Range("|fffd||fffd||fffd||182||309||fffd|").ClearContents
    ActiveWorkbook.Names("|fffd||fffd||fffd||182||309||fffd|").Delete
    Application.CutCopyMode = False
End Sub
Sub |fffd||208||552|T|fffd||fffd||fffd||fffd||fffd|s(chi2)
    Dim x As Range, chi0 As Double
    
    NN = Cells(2, 2)
    npr = Cells(603, 5)
    chi0 = CDbl(chi2)
    m = Cells(608, 5)
    
    |fffd|T|fffd||fffd||fffd||30d||fffd| npr, m
    
    m = 0
    For i = 1 To NN
        For j = 1 To NN
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 2) <> 1 Or Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 2) <> 1 Then
            ActiveWorkbook.Names.Add Name:="x", RefersTo:=Cells(50 + i, 5 + j)
            If i <> j And Cells(50 + i, 5 + j) = 0 Then
                SolverOk SetCell:="|fffd||693|I|fffd||590||fffd|", MaxMinVal:=2, ValueOf:="0", ByChange:="x"
                SolverOptions AssumeNonNeg:=False
                SolverSolve userFinish:=True
                If chi0 - CDbl(chi2) > Cells(607, 5) Then
                    m = m + 1
                    Cells(605 + npr + m, 6) = m
                    Cells(605 + npr + m, 7) = "|fffd|p|fffd|X"
                    Cells(605 + npr + m, 8) = i
                    Cells(605 + npr + m, 9) = j
                    Cells(605 + npr + m, 10) = CStr(i) & "<-" & CStr(j)
                    Cells(605 + npr + m, 11) = Cells(50 + i, 5)
                    Cells(605 + npr + m, 12) = Cells(50 + j, 5)
                    If Cells(605, 5) = "|fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                        Cells(605 + npr + m, 13) = Cells(50 + i, 5 + j)
                    Else
                        Cells(605 + npr + m, 13) = Cells(50 + i, 5 + j) * Sqr(Cells(150 + j, 3) / Cells(150 + i, 3))
                    End If
                    Cells(605 + npr + m, 14) = chi0 - CDbl(chi2)
                    Cells(605 + npr + m, 16) = CDbl(chi2)
                 End If
                Cells(50 + i, 5 + j) = 0
            End If
        End If
        Next j
    Next i
If Cells(606, 5) = "|fffd|p|fffd|X&|fffd||fffd||fffd||fffd||fffd|U" Then
    For i = 2 To NN
        For j = 1 To i - 1
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 2) <> 1 Or Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 2) <> 1 Then
            ActiveWorkbook.Names.Add Name:="x", RefersTo:=Cells(100 + i, 5 + j)
            If Cells(100 + i, 5 + j) = 0 Then
                Cells(100 + j, 5 + i).FormulaR1C1 = "=R" & CStr(100 + i) & "C" & CStr(5 + j)
                SolverOk SetCell:="|fffd||693|I|fffd||590||fffd|", MaxMinVal:=2, ValueOf:="0", ByChange:="x"
                SolverOptions AssumeNonNeg:=False
                SolverSolve userFinish:=True
                If chi0 - CDbl(chi2) > Cells(607, 5) Then
                    m = m + 1
                    Cells(605 + npr + m, 6) = m
                    Cells(605 + npr + m, 7) = "|fffd||fffd||fffd||fffd||fffd|U"
                    Cells(605 + npr + m, 8) = i
                    Cells(605 + npr + m, 9) = j
                    Cells(605 + npr + m, 10) = CStr(i) & "," & CStr(j)
                    Cells(605 + npr + m, 11) = Cells(50 + i, 5)
                    Cells(605 + npr + m, 12) = Cells(50 + j, 5)
                    If Cells(605, 5) = "|fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                        Cells(605 + npr + m, 13) = Cells(100 + i, 5 + j)
                    Else
                        Cells(605 + npr + m, 13) = Cells(100 + i, 5 + j) / Sqr(Cells(100 + j, 2) * Cells(100 + i, 2))
                    End If
                    Cells(605 + npr + m, 14) = chi0 - CDbl(chi2)
                    Cells(605 + npr + m, 16) = CDbl(chi2)
                End If
                Cells(100 + i, 5 + j) = 0
                Cells(100 + j, 5 + i) = 0
            End If
        End If
        Next j
    Next i
End If
    Application.CutCopyMode = False
    Cells(608, 5) = m
    If m = 0 Then End
    ActiveWorkbook.Names.Add Name:="x", RefersTo:=Range(Cells(606 + npr, 16), Cells(605 + npr + m, 16))
    Range(Cells(606 + npr, 17), Cells(605 + npr + m, 17)).Select
    Selection.FormulaArray = "=CHIDIST(x,K3-1)"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlValues
    ActiveWorkbook.Names.Add Name:="x", RefersTo:=Range(Cells(606 + npr, 14), Cells(605 + npr + m, 14))
    Range(Cells(606 + npr, 15), Cells(605 + npr + m, 15)).Select
    Selection.FormulaArray = "=CHIDIST(x,1)"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlValues
    Application.CutCopyMode = False
End Sub
Sub |fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd|()

    r = ActiveCell.Row
    i = Cells(r, 8)
    j = Cells(r, 9)
    |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    npr = Cells(603, 5)
    
    If r < 606 + npr Or r > 605 + npr + Cells(608, 5) Then
        MsgBox "|fffd||3c2||202||182||fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
        End
    End If
    npr = Cells(603, 5) + 1
    Cells(603, 5) = npr
    Cells(600 + npr, 6) = "|fffd||1c9||fffd|"
        
    Range(Cells(r, 7), Cells(r, 13)).Copy
    Range(Cells(600 + npr, 7), Cells(600 + npr, 13)).PasteSpecial Paste:=xlValues
    If Cells(605, 5) = "|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|" Then
        If Cells(600 + npr, 7) = "|fffd|p|fffd|X" Then Cells(600 + npr, 13) = Cells(r, 13) * Sqr(Cells(150 + i, 3) / Cells(150 + j, 3))
        If Cells(600 + npr, 7) = "|fffd||fffd||fffd||fffd||fffd|U" Then Cells(600 + npr, 13) = Cells(r, 13) * Sqr(Cells(100 + j, 2) * Cells(100 + i, 2))
    End If
    If Cells(600 + npr, 7) = "|fffd|p|fffd|X" Then
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1))) = "" Then
            Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1))) = "b"
        Else
            MsgBox "|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||241|ub|fffd|v|fffd||fffd||fffd|L|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||42a81|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||80b5||fffd||702||fffd|"
        End If
        Cells(50 + i, 5 + j) = "=M" & CStr(600 + npr)
        Cells(50 + i, 5 + j).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
    ElseIf Cells(600 + npr, 7) = "|fffd||fffd||fffd||fffd||fffd|U" Then
        If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1))) = "" Then
            Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1))) = "r"
        ElseIf Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))) = "" Then
            Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))) = "r"
        Else
            MsgBox "|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||241|ur|fffd|v|fffd||fffd||fffd|L|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||42a81|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||80b5||fffd||702||fffd|"
        End If
        Cells(100 + i, 5 + j) = "=M" & CStr(600 + npr)
        Cells(100 + i, 5 + j).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
        Cells(100 + j, 5 + i) = "=M" & CStr(600 + npr)
        Cells(100 + j, 5 + i).Interior.ColorIndex = 6 '|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd|R|fffd||a414|", RefersTo:=Range(Cells(601, 13), Cells(600 + npr, 13))
    
    |fffd||fffd|@|fffd||fffd|I|fffd||fffd||14c|v|fffd|Z|fffd||fffd||fffd|s
End Sub
Sub |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|()
    npr = Cells(603, 5)
    If Cells(600 + npr, 6) = "|fffd||1c9||fffd|" Then
        i0 = Cells(600 + npr, 8)
        j0 = Cells(600 + npr, 9)
        If Cells(600 + npr, 7) = "|fffd|p|fffd|X" Then
            Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i0, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j0, 1))).ClearContents
            Cells(50 + i0, 5 + j0) = 0
            Cells(50 + i0, 5 + j0).Interior.ColorIndex = xlNone
        ElseIf Cells(600 + npr, 7) = "|fffd||fffd||fffd||fffd||fffd|U" Then
            Cells(100 + i0, 5 + j0) = 0
            Cells(100 + j0, 5 + i0) = 0
            Cells(100 + i0, 5 + j0).Interior.ColorIndex = xlNone
            Cells(100 + j0, 5 + i0).Interior.ColorIndex = xlNone
            If Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i0, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j0, 1))) = "r" Then
                Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i0, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j0, 1))).ClearContents
            ElseIf Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j0, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i0, 1))) = "r" Then
                Cells(9 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j0, 1)), 5 + CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i0, 1))).ClearContents
            End If
        End If
        Range(Cells(600 + npr, 6), Cells(600 + npr, 13)).ClearContents
        npr = npr - 1
        Cells(603, 5) = npr
        ActiveWorkbook.Names.Add Name:="|fffd||fffd||fffd|R|fffd||a414|", RefersTo:=Range(Cells(601, 13), Cells(600 + npr, 13))
    End If
End Sub
Sub |fffd||fffd|@|fffd||fffd|I|fffd||fffd||14c|v|fffd|Z|fffd||fffd||fffd|s()
    If Cells(609, 5) = "ML" Then |fffd||156||796|@RUN
    If Cells(609, 5) = "GLS" Then |fffd||fffd||289||fffd||fffd||14f||fffd||fffd||fffd||fffd|@RUN
    If Cells(609, 5) = "ULS" Then |fffd|d|fffd||742||202||fffd||fffd||14f||fffd||fffd||fffd||fffd|@RUN
End Sub
Sub |fffd||1c9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d||10c|v|fffd|Z()
    |fffd||1c9||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    |fffd||fffd|@|fffd||fffd|I|fffd||fffd||14c|v|fffd|Z|fffd||fffd||fffd|s
End Sub



Attribute VB_Name = "Module2"
Sub |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|()
    NN = Cells(2, 2)
    k = 0                       '|fffd||702||fffd||fffd||342||fffd||fffd|||fffd||fffd|
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If .Connector Then
                    .Delete     '|fffd|R|fffd|l|fffd|N|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
                ElseIf Left(.Name, 2) = "|fffd||3d0||fffd|" Then
                    k = k + 1   '|fffd||3d0||fffd||fffd|{|fffd|b|fffd|N|fffd|X|fffd||10502||fffd||fffd||fffd|
                End If
            End With
        Next
    End With
    If k <> 0 And k <> NN Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||182||fffd||fffd||355||3d0||fffd||fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd|
        |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|
    ElseIf k = NN Then
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|              '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|l|fffd||34f||fffd||fffd||fffd|
        Exit Sub
    End If
    
    For i = 1 To NN
        If Cells(9 + i, 4) = 1 And Cells(9 + i, 3) = 1 Then '|fffd|O|fffd||fffd||fffd||fffd||fffd||755||3d0||fffd|
            ActiveSheet.Shapes.AddShape(msoShapeOval, 500, 500, 50, 25).Select
            Selection.Characters.Text = Cells(9 + i, 5)  '|fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i) '|fffd||3d0||fffd|No|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            With Selection
                .AutoSize = True
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Placement = xlFreeFloating
                If .Width < 30 Then .Width = 30
            End With
        ElseIf Cells(9 + i, 4) = 1 And Cells(9 + i, 3) <> 1 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||755||3d0||fffd|
            ActiveSheet.Shapes.AddShape(msoShapeOval, 500, 500, 50, 25).Select
            Selection.Characters.Text = Cells(9 + i, 5)  '|fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i) '|fffd||3d0||fffd|No|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            With Selection
                .AutoSize = True
                .Placement = xlFreeFloating
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                If .Width < 30 Then .Width = 30
            End With
            ActiveSheet.Shapes.AddShape(msoShapeOvalCallout, _
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left + 0.8 * ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width, _
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top - 15, 20, 20).Select
            Selection.Characters.Text = "e"
            With Selection
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Orientation = xlHorizontal
                .Placement = xlFreeFloating
            End With
            Selection.Name = "|fffd|c|fffd||fffd|" & CStr(i) '|fffd|u|fffd|c|fffd||fffd|i|fffd|v|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            ActiveSheet.Shapes.Range(Array("|fffd||3d0||fffd|" & CStr(i), "|fffd|c|fffd||fffd|" & CStr(i))).Select
            Selection.ShapeRange.Group.Select
            With Selection
                .Placement = xlFreeFloating
                .PrintObject = True
            End With
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i)  '|fffd||3d0||fffd|No|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|v|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
        ElseIf Cells(9 + i, 4) <> 1 And Cells(9 + i, 3) = 1 Then '|fffd|O|fffd||fffd||fffd||3d1||fffd||fffd||3d0||fffd|
            ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, 500, 500, 50, 15).Select
            Selection.Characters.Text = Cells(9 + i, 5)  '|fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i) '|fffd||3d0||fffd|No|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            With Selection
                .AutoSize = True
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Placement = xlFreeFloating
            End With
        ElseIf Cells(9 + i, 4) <> 1 And Cells(9 + i, 3) <> 1 Then '|fffd||fffd||fffd||fffd||fffd||3d1||fffd||fffd||3d0||fffd|
            ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, 500, 500, 50, 15).Select
            Selection.Characters.Text = Cells(9 + i, 5)  '|fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd|
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i) '|fffd||3d0||fffd|No|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            With Selection
                .AutoSize = True
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Placement = xlFreeFloating
            End With
            ActiveSheet.Shapes.AddShape(msoShapeOvalCallout, _
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left + ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width - 6, _
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top - 20, 20, 20).Select
            Selection.Characters.Text = "e"
            With Selection
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
                .Orientation = xlHorizontal
                .Placement = xlFreeFloating
            End With
            Selection.Name = "|fffd|c|fffd||fffd|" & CStr(i) '|fffd|u|fffd|c|fffd||fffd|i|fffd|v|fffd||fffd|}|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
            ActiveSheet.Shapes.Range(Array("|fffd||3d0||fffd|" & CStr(i), "|fffd|c|fffd||fffd|" & CStr(i))).Select
            Selection.ShapeRange.Group.Select
            With Selection
                .Placement = xlFreeFloating
                .PrintObject = True
            End With
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i)  '|fffd||3d0||fffd|No|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|v|fffd||316||fffd||fffd|O|fffd||242||fffd||fffd||fffd|
        End If
    Next i
    If Cells(10, 46) = "" Then
        |fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd|W NN
    Else
        |fffd||fffd||fffd|W|fffd||24d||fffd||fffd||d0b9||fffd||fffd| NN
    End If
End Sub
Sub |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|()
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If Left(.Name, 2) = "|fffd||3d0||fffd|" Or Left(.Name, 2) = "|fffd|c|fffd||fffd|" Or .Name = "|fffd|V|fffd|^|fffd|W|fffd|L" Then .Delete
            End With
        Next
    End With
    |fffd||fffd||fffd||30f||fffd||fffd||fffd|
End Sub
Sub |fffd||fffd||fffd||30f||fffd||fffd||fffd|()
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If .Connector Then .Delete
            End With
        Next
    End With
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If Left(.Name, 2) = "|fffd||fffd||fffd|l" Then .Delete
            End With
        Next
    End With
End Sub
Sub |fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd|W(NN)
    x = Columns(7 + NN).Left
    f = x
    For i = 1 To NN
        If Cells(9 + i, 4) = 1 Then     '|fffd||fffd||fffd||755||3d0||fffd||fffd||30f||a347|
            ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left = f
            Cells(9 + i, 47) = Rows(10).Top
            If Cells(9 + i, 3) = 1 Then         '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||30f||a347|
                f = f + ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width + 5
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Rows(10).Top
            Else                                '|fffd||fffd||fffd||fffd||fffd||3d0||fffd||fffd||30f||a347||fffd|A|fffd|c|fffd||fffd||fffd||fffd||fffd||82||fffd|
                f = f + ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width - 5
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Rows(10).Top - 15
            End If
        Else                            '|fffd||3d1||fffd||fffd||3d0||fffd||fffd||30f||a347|
            ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left = x
            Cells(9 + i, 47) = Rows(10).Top + 45
            If Cells(9 + i, 3) = 1 Then         '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||30f||a347|
                x = x + ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width + 15
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Rows(10).Top + 45
            Else                                '|fffd||fffd||fffd||fffd||fffd||3d0||fffd||fffd||30f||a347||fffd|A|fffd|c|fffd||fffd||fffd||fffd||fffd||82||fffd|
                x = x + ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Width - 5
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Rows(10).Top + 25
            End If
        End If
        Cells(9 + i, 46) = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left
    Next i
End Sub
Sub |fffd||fffd||fffd|W|fffd||6d1||fffd|()
    For i = 1 To Cells(2, 2)
        Cells(9 + i, 46) = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left
        If Cells(9 + i, 3) = 1 Then '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||fffd|y|fffd||fffd||fffd|W|fffd||342||fffd||fffd||302||702||fffd|
            Cells(9 + i, 47) = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top
        Else
            If Cells(9 + i, 4) = 1 Then
                Cells(9 + i, 47) = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top + 15
            Else
                Cells(9 + i, 47) = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top + 20
            End If
        End If
    Next
End Sub
Sub |fffd||fffd||fffd|W|fffd||24d||fffd||fffd||d0b9||fffd||fffd|(NN)
    For i = 1 To Cells(2, 2)
        ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Left = Cells(9 + i, 46)
        If Cells(9 + i, 3) = 1 Then '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||fffd|y|fffd||fffd||fffd|W|fffd||342||fffd||fffd||302||702||fffd|
            ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Cells(9 + i, 47)
        Else
            If Cells(9 + i, 4) = 1 Then
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Cells(9 + i, 47) - 15
            Else
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Top = Cells(9 + i, 47) - 20
            End If
        End If
    Next
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|

    For i = 1 To NN
        If Cells(9 + i, 3) <> 1 Then
            ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Ungroup.Select
        End If
    Next i

    For i = 1 To NN
        For j = 1 To NN
            If Cells(9 + i, 5 + j) Like "b*" Then
                ActiveSheet.Shapes.AddConnector(msoConnectorStraight, 1000, 10, 10, 10).Select  '|fffd|R|fffd|l|fffd|N|fffd|^|fffd||fffd|I|fffd||fffd|
                Selection.ShapeRange.Line.EndArrowheadStyle = msoArrowheadTriangle '|fffd||fffd||fffd||fffd||6c2||356||fffd||fffd|
                Selection.ShapeRange.ConnectorFormat.BeginConnect ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(j)), 3 '|fffd|n|fffd|_
                Selection.ShapeRange.ConnectorFormat.EndConnect ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)), 3 '|fffd|I|fffd|_(|fffd||209|~|fffd||34f||30a9||fffd||fffd|45|fffd|x|fffd||fffd||fffd||742||14d||fffd||fffd||fffd||fffd||254||50d||fffd||fffd|j
                Selection.Name = "|fffd||3d0||fffd|" & CStr(j) & "|fffd||fffd|" & CStr(i) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
                Selection.ShapeRange.RerouteConnections '|fffd||152|Z|fffd||30c||fffd||fffd||fffd||fffd|_|fffd||24e||fffd||fffd||fffd||fffd||3cd|X
                With Selection
                    .ShapeRange.Line.Weight = Cells(2, 32)
                    .Placement = xlFreeFloating
                End With
            ElseIf Cells(9 + i, 5 + j) Like "r*" Then
                ActiveSheet.Shapes.AddConnector(msoConnectorStraight, 1000, 10, 10, 10).Select  '|fffd|R|fffd|l|fffd|N|fffd|^|fffd||fffd|I|fffd||fffd|
                Selection.ShapeRange.Line.EndArrowheadStyle = msoArrowheadTriangle '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Selection.ShapeRange.Line.BeginArrowheadStyle = msoArrowheadTriangle
                If i > j Then
                    Selection.Name = "|fffd||3d0||fffd|" & CStr(j) & "|fffd||" & CStr(i)   '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
                ElseIf j > i Then
                    Selection.Name = "|fffd||3d0||fffd|" & CStr(i) & "|fffd||" & CStr(j)   '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
                End If
                If Cells(9 + i, 3) = 1 Then         'i|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd|
                    Selection.ShapeRange.ConnectorFormat.BeginConnect ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)), 3
                ElseIf Cells(9 + i, 3) <> 1 Then    'i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|
                    Selection.ShapeRange.ConnectorFormat.BeginConnect ActiveSheet.Shapes("|fffd|c|fffd||fffd|" & CStr(i)), 7
                End If
                If Cells(9 + j, 3) = 1 Then         'j|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd|
                    Selection.ShapeRange.ConnectorFormat.EndConnect ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(j)), 3
                ElseIf Cells(9 + j, 3) <> 1 Then    'j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|
                    Selection.ShapeRange.ConnectorFormat.EndConnect ActiveSheet.Shapes("|fffd|c|fffd||fffd|" & CStr(j)), 7
                End If
                Selection.ShapeRange.RerouteConnections '|fffd||152|Z|fffd||30c||fffd||fffd||fffd||fffd|_|fffd||24e||fffd||fffd||fffd||fffd||3cd|X
                With Selection
                    .ShapeRange.Line.Weight = Cells(2, 32)
                    .Placement = xlFreeFloating
                End With
            End If
            If Cells(9 + i, 5 + j) Like "*:*" Then '|fffd||fffd||fffd||42802||fffd||390||fffd|
                If i <> j Then                     '|fffd||642||202||fffd||3d0||fffd||fffd||502||303|R|fffd|l|fffd|N|fffd|^|fffd||342||fffd||fffd||142||251|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||342||fffd|
                    Selection.ShapeRange.Line.ForeColor.SchemeColor = 12
                ElseIf Cells(9 + i, 3) = 1 Then    '|fffd|O|fffd||fffd||fffd||3d0||fffd||fffd||315||fffd||fffd|U|fffd||310||fffd||fffd||fffd|
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).Select
                    Selection.ShapeRange.Line.ForeColor.SchemeColor = 12
                Else                               '|fffd||fffd||fffd||fffd||fffd||3d0||fffd||fffd||30e|c|fffd||fffd||fffd||fffd||fffd|U|fffd||310||fffd||fffd||fffd|i|fffd||fffd||fffd||282||342||fffd||fffd||202||fffd||fffd|j
                    ActiveSheet.Shapes("|fffd|c|fffd||fffd|" & CStr(i)).Select
                    Selection.ShapeRange.Line.ForeColor.SchemeColor = 12
                End If
            End If
        Next j
    Next i
    
    For i = 1 To NN
        If Cells(9 + i, 3) <> 1 Then
            ActiveSheet.Shapes.Range(Array("|fffd||3d0||fffd|" & CStr(i), "|fffd|c|fffd||fffd|" & CStr(i))).Select
            Selection.ShapeRange.Group.Select
            Selection.Name = "|fffd||3d0||fffd|" & CStr(i) '|fffd|O|fffd||fffd||fffd|[|fffd|v|fffd||316||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd|
            With Selection
                .Placement = xlFreeFloating
                .PrintObject = True
            End With
        End If
    Next i
    If Cells(6, 32) = "|fffd|W|fffd||fffd||fffd||fffd|" Then |fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||14f49|f
    If Cells(6, 32) = "|fffd||fffd|W|fffd||fffd||fffd||fffd|" Then |fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||14f49|f
    If Cells(6, 30) = "|fffd||3d0||fffd|>|fffd|O" Then |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|O|fffd||fffd|
    If Cells(6, 31) = "|fffd|W|fffd||fffd||fffd||fffd|" Then
        |fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
    ElseIf Cells(6, 31) = "|fffd||fffd|W|fffd||fffd||fffd||fffd|" Then
        |fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
    End If
    If Cells(6, 33) = "|fffd||fffd||fffd||7b7|" Then |fffd|V|fffd|^|fffd|W|fffd|L
End Sub
Sub |fffd|S|fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd|_|fffd||30d||153|K|fffd||fffd|()
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If .Connector Then .RerouteConnections
            End With
        Next
    End With
End Sub
Sub |fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd|`|fffd||30c||fffd||fffd||fffd||fffd|_|fffd||30d||153|K|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    Cells(8, 1) = Selection.ShapeRange.Name
    Cells(8, 2) = "=SUBSTITUTE(A8,""|fffd||3d0||fffd|"","""")"
    i = CInt(Cells(8, 2))
    For j = 1 To NN
            If Cells(9 + i, 5 + j) Like "b*" Then
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(j) & "|fffd||fffd|" & CStr(i)).RerouteConnections
            ElseIf Cells(9 + i, 5 + j) Like "r*" Then
                If i > j Then
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(j) & "|fffd||" & CStr(i)).RerouteConnections
                ElseIf j > i Then
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i) & "|fffd||" & CStr(j)).RerouteConnections
                End If
            End If
    Next j
    For j = 1 To NN
            If Cells(9 + j, 5 + i) Like "b*" Then
                ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i) & "|fffd||fffd|" & CStr(j)).RerouteConnections
            ElseIf Cells(9 + j, 5 + i) Like "r*" Then
                If j < i Then
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(j) & "|fffd||" & CStr(i)).RerouteConnections
                ElseIf j > i Then
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i) & "|fffd||" & CStr(j)).RerouteConnections
                End If
            End If
    Next j
    Range("A8:B8").ClearContents
End Sub
Sub |fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|()
    |fffd|p|fffd|X|fffd||191||fffd||fffd||58b|L|fffd||fffd|
    If Cells(6, 26) = "|fffd||fffd||fffd||fffd|W|fffd||fffd|" Then |fffd||fffd||fffd||fffd|W|fffd||fffd|
    If Cells(6, 26) = "|fffd|c|fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd|" Then |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||315|W|fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd|
End Sub
Sub |fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|()
    |fffd|p|fffd|X|fffd||18b||fffd||fffd||fffd||fffd|U|fffd|L|fffd||fffd|
    If Cells(6, 26) = "|fffd|c|fffd||fffd||fffd||fffd||fffd|U" Then |fffd|c|fffd||fffd||fffd||fffd||fffd|U
End Sub
Sub |fffd|p|fffd|X|fffd||191||fffd||fffd||58b|L|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 7 + NN  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd| NN, c
End Sub
Sub |fffd|p|fffd|X|fffd||18b||fffd||fffd||fffd||fffd|U|fffd|L|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 5  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd| NN, c
End Sub
Sub |fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 7 + NN  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd| NN, c
End Sub
Sub |fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd|()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 5  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd| NN, c
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd|(NN, c)
        For i = 1 To NN
            For j = 1 To NN
                If Cells(50 + i, c + j) <> 0 Then
                    x = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Left
                    y = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Top
                    w = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Width
                    h = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Height
                    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, x + 0.5 * w, y + 0.5 * h, 20, 10).Select
                    Selection.Formula = "R" & 50 + i & "C" & c + j
                    Selection.ShapeRange.Line.Visible = msoFalse
                    Selection.ShapeRange.Fill.Visible = msoFalse
                    With Selection.Font
                        .Size = 9
                    End With
                    With Selection
                        .AutoSize = True
                        .Placement = xlFreeFloating
                    End With
                    Selection.Name = "|fffd||fffd||fffd|l" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
               End If
            Next j
        Next i
        For i = 1 To NN
            For j = 1 To i - 1
                If Cells(100 + i, c + j) <> 0 Then
                    If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) < Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                        k = j
                        l = i
                    ElseIf Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) > Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                        k = i
                        l = j
                    End If
                    x = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Left
                    y = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Top
                    w = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Width
                    h = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Height
                    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, x + 0.5 * w, y + 0.5 * h, 20, 10).Select
                    Selection.Formula = "R" & 100 + i & "C" & c + j
                    Selection.ShapeRange.Line.Visible = msoFalse
                    Selection.ShapeRange.Fill.Visible = msoFalse
                    With Selection.Font
                        .Size = 9
                    End With
                    With Selection
                        .AutoSize = True
                        .Placement = xlFreeFloating
                    End With
                    Selection.Name = "|fffd||fffd||fffd|l" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1)) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
                End If
            Next j
        Next i
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|(NN, c)
        For i = 1 To NN
            For j = 1 To NN
                If Cells(50 + i, c + j) <> 0 Then
                    x = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Left
                    y = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Top
                    w = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Width
                    h = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Height
                    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, x + 0.5 * w, y + 0.5 * h, 20, 10).Select
                    Selection.Characters.Text = FormatNumber(Cells(50 + i, c + j), Cells(2, 25), 0) '|fffd||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd|
                    Selection.ShapeRange.Line.Visible = msoFalse
                    Selection.ShapeRange.Fill.Visible = msoFalse
                    With Selection.Font
                        .Size = 9
                        If Cells(50 + i, c + j) < 0 And Cells(3, 25) = "|fffd||fffd||fffd|E|fffd||fffd|" Then .ColorIndex = 3
                    End With
                    With Selection
                        .AutoSize = True
                        .Placement = xlFreeFloating
                    End With
                    Selection.Name = "|fffd||fffd||fffd|l" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
               End If
            Next j
        Next i
        For i = 1 To NN
            For j = 1 To i - 1
                If Cells(100 + i, c + j) <> 0 Then
                    If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) < Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                        k = j
                        l = i
                    ElseIf Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) > Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                        k = i
                        l = j
                    End If
                    x = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Left
                    y = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Top
                    w = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Width
                    h = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Height
                    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, x + 0.5 * w, y + 0.5 * h, 20, 10).Select
                    Selection.Characters.Text = FormatNumber(Cells(100 + i, c + j), Cells(2, 25), 0) '|fffd||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd|
                    Selection.ShapeRange.Line.Visible = msoFalse
                    Selection.ShapeRange.Fill.Visible = msoFalse
                    With Selection.Font
                        .Size = 9
                        If Cells(100 + i, c + j) < 0 Then
                            If Cells(4, 25) = "|fffd||fffd||fffd|E|fffd||fffd|" Then .ColorIndex = 3
                            If Cells(4, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Then
                                .ColorIndex = 45
                                .Bold = True
                            End If
                        Else
                            If Cells(4, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Or Cells(4, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                                .ColorIndex = 48
                                .Bold = True
                            End If
                        End If
                    End With
                    With Selection
                        .AutoSize = True
                        .Placement = xlFreeFloating
                    End With
                    Selection.Name = "|fffd||fffd||fffd|l" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1)) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
                End If
            Next j
        Next i
End Sub
Sub |fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||14f49|f()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 7 + NN  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||11f82||fffd||fffd||155|\|fffd||fffd| NN, c
End Sub
Sub |fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||14f49|f()
    NN = Cells(2, 2)    '|fffd|\|fffd||fffd||fffd||3d0||fffd||fffd||310||fffd||fffd||fffd|NN|fffd||182||fffd||fffd||fffd|
    c = 5  '|fffd|W|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd||310||64ea||fffd|Z|fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||11f82||fffd||fffd||155|\|fffd||fffd| NN, c
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||11f82||fffd||fffd||155|\|fffd||fffd|(NN, c)
    If Cells(2, 30) <> "|fffd||fffd||fffd|" Then b = 1
    If Cells(3, 30) <> "|fffd||fffd||fffd|" Then r = 1
    mbc = 64
    mrc = 64
    If Cells(4, 30) = "|fffd||fffd||fffd|E|fffd||fffd|" Then mbc = 10
    If Cells(5, 30) = "|fffd||fffd||fffd|E|fffd||fffd|" Then mrc = 10
    If Cells(5, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Then mrc = 47
    If Cells(5, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Or Cells(5, 30) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then rc = 22
        For i = 1 To NN
            For j = 1 To NN
                If Cells(50 + i, c + j) <> 0 Then
                    ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Line.Weight = b * Cells(5, 32) * Abs(Cells(50 + i, c + j)) + (1 - b) * Cells(2, 32)
                    If Cells(50 + i, c + j) < 0 Then
                       ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Line.ForeColor.SchemeColor = mbc
                    Else
                       ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1)) & "|fffd||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Line.ForeColor.SchemeColor = bc
                    End If
                End If
            Next j
        Next i
        For i = 1 To NN
            For j = 1 To i - 1
                If Cells(100 + i, c + j) <> 0 Then
                        If Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) < Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                            k = j
                            l = i
                        ElseIf Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + j, 1) > Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1) Then
                            k = i
                            l = j
                        End If
                        With ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + k, 1)) & "|fffd||" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + l, 1))).Line
                            .Weight = r * Cells(5, 32) * Abs(Cells(100 + i, c + j)) + (1 - r) * Cells(3, 32)
                            If Cells(100 + i, c + j) < 0 Then
                                .ForeColor.SchemeColor = mrc
                            Else
                                .ForeColor.SchemeColor = rc
                            End If
                        End With
               End If
            Next j
        Next i
End Sub
Sub |fffd|c|fffd||fffd||fffd||fffd||fffd|U()
    Dim e(40) As Single
    For i = 1 To Cells(2, 2)
        e(i - 1) = Cells(100 + i, 2)
    Next i
    |fffd|c|fffd||fffd||fffd||310||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd| e, "|fffd|c|fffd||fffd||fffd||fffd||fffd|U="
End Sub
Sub |fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||315|W|fffd||fffd||fffd|p|fffd|X|fffd|W|fffd||fffd|()
    Dim e(40) As Single
    For i = 1 To Cells(2, 2)
        e(i - 1) = Sqr(Cells(100 + i, 3))
    Next i
    |fffd|c|fffd||fffd||fffd||310||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd| e, "|fffd|c|fffd||fffd||fffd||7fd|="
End Sub
Sub |fffd||fffd||fffd||fffd|W|fffd||fffd|()
    Dim e(40) As Single
    For i = 1 To Cells(2, 2)
        e(i - 1) = 1 - Cells(100 + i, 3)
    Next i
    |fffd|c|fffd||fffd||fffd||310||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd| e, "R2="
End Sub
Sub |fffd|c|fffd||fffd||fffd||310||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd|(e, moji)
    For i = 1 To Cells(2, 2)
            If Cells(9 + Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1), 3) <> 1 Then '|fffd||fffd||fffd||fffd||fffd||3d0||fffd|
                x = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Left
                y = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Top
                w = ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1))).Width
                ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, 500, y + 9, 20, 10).Select
                If Cells(6, 25) = "|fffd||fffd||fffd|l|fffd||302||fffd|" Then
                    Selection.Characters.Text = FormatNumber(e(i - 1), Cells(2, 25), 0) '|fffd||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd|
                Else
                    Selection.Characters.Text = moji & CStr(FormatNumber(e(i - 1), Cells(2, 25), 0)) '|fffd||fffd||fffd|l|fffd||fffd||fffd|L|fffd||fffd|
                End If
                Selection.ShapeRange.Line.Visible = msoFalse
                If Cells(5, 26) = "|fffd||fffd||fffd|F" Then Selection.ShapeRange.Fill.Visible = msoFalse
                With Selection.Font
                    .Size = 9
                        If Abs(Cells(100 + Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1), 3) - 0.5) > 0.5 Then
                            If Cells(4, 25) = "|fffd||fffd||fffd|E|fffd||fffd|" Then .ColorIndex = 3
                            If Cells(4, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Then
                                .ColorIndex = 45
                                .Bold = True
                            End If
                        Else
                            If Cells(5, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|" Or Cells(4, 25) = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                                .ColorIndex = 48
                                .Bold = True
                            End If
                        End If
                End With
                With Selection
                    .AutoSize = True
                    .Placement = xlFreeFloating
                End With
                If Cells(9 + Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1), 4) = 1 And w > 100 Then   '|fffd||fffd||fffd|l|fffd||fffd|x|fffd||fffd||fffd|W|fffd||fffd||fffd||fffd|
                    Selection.ShapeRange.Left = x + 0.8 * w - Selection.ShapeRange.Width + 2  '|fffd||50ab||fffd||7c2||310||fffd||fffd||755||3d0||fffd||fffd|p
                Else
                    Selection.ShapeRange.Left = x + w - Selection.ShapeRange.Width - 18       '|fffd||28f||fffd||342||fffd||fffd||fffd||fffd||fffd|
                End If
                If Cells(9 + Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1), 4) = 1 Then _
                     Selection.ShapeRange.Top = y + 3                            '|fffd||fffd||fffd||755||3d0||fffd||fffd||30e|c|fffd||fffd||fffd||310||fffd||fffd|l|fffd||fffd|y|fffd||fffd||fffd|W|fffd||fffd||fffd||fffd|
                Selection.Name = "|fffd||fffd||fffd|l" & CStr(Sheets("|fffd|P|fffd||28d|s|fffd||fffd|").Cells(80 + i, 1)) '|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||fffd|
            End If
    Next i
End Sub
Sub |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|O|fffd||fffd|()
    For i = 1 To Cells(2, 2)
        ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).ZOrder msoBringToFront
    Next i
End Sub
Sub |fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd|()
    For i = 1 To Cells(2, 2)
        ActiveSheet.Shapes("|fffd||3d0||fffd|" & CStr(i)).ZOrder msoSendToBack
    Next i
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If .Name = "|fffd|V|fffd|^|fffd|W|fffd|L" Then .ZOrder msoSendToBack
            End With
        Next
    End With
End Sub
Sub |fffd||fffd||fffd|l|fffd||fffd|O|fffd||fffd|()
    With ActiveSheet.Shapes
        For i = .Count To 1 Step -1
            With .Item(i)
                If Left(.Name, 2) = "|fffd||fffd||fffd|l" Then .ZOrder msoBringToFront
            End With
        Next
    End With
End Sub
Sub |fffd|V|fffd|^|fffd|W|fffd|L()
    |fffd||fffd||fffd|W|fffd||6d1||fffd|
    ActiveSheet.Shapes.AddShape(msoShapeRectangle, _
        Cells(2, 3) - 10, Cells(4, 3) - 25, Cells(1, 3) - Cells(2, 3) + 70, Cells(3, 3) - Cells(4, 3) + 60).Select
    Selection.ShapeRange.ZOrder msoSendToBack
    Selection.Name = "|fffd|V|fffd|^|fffd|W|fffd|L"
    With Selection
        .Placement = xlFreeFloating             '|fffd||693||fffd||fffd||fffd|T|fffd|C|fffd|Y|fffd||3cd|X|fffd||fffd||fffd||202||fffd|
    End With
End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
