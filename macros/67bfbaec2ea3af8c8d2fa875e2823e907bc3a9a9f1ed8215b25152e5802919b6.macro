Attribute VB_Name = "Deckblatt"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Deckblatt10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Deckblatt5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Deckblatt9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_BeforeClose(Cancel As Boolean)
On Error GoTo ErrHandler
Excel.CommandBars("Messbericht").Delete

Exit Sub

ErrHandler:
    Exit Sub
End Sub
Attribute VB_Name = "Globals"
Option Explicit

Global Const OkRating = 6
Global Const NokRating = 5
Attribute VB_Name = "Hidden"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Messdatenblatt1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub




Attribute VB_Name = "Messdatenblatt10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Messdatenblatt9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const DesiredValue = 7
Const ToleranceLower = 8
Const ToleranceUpper = 9
Const ActualValue = 10
Const Rating = 13
Const Ratings = 3
Const ReportTopRow = 8

Private Sub Worksheet_Change(ByVal Target As Excel.Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean

Set ws = Target.Worksheet

If Target.Column = ActualValue And Target.Row >= ReportTopRow Then
    If IsEmpty(ws.Cells(Target.Row, ActualValue).Value) Then
        Target.Worksheet.Cells(Target.Row, Rating).ClearContents
    ElseIf Not IsEmpty(ws.Cells(Target.Row, ActualValue).Value) And IsNumeric(ws.Cells(Target.Row, DesiredValue).Value) Then
        bOK = (ws.Cells(Target.Row, ActualValue).Value >= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceLower).Value And _
            ws.Cells(Target.Row, ActualValue).Value <= ws.Cells(Target.Row, DesiredValue).Value + ws.Cells(Target.Row, ToleranceUpper).Value)
        
        Target.Worksheet.Cells(Target.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

Private Sub ValueRating()

Dim bOK As Boolean

If ActiveCell.Column = ActualValue And ActiveCell.Row >= ReportTopRow Then
    If IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) Then
        Cells(ActiveCell.Row, Rating).ClearContents
    ElseIf Not IsEmpty(Cells(ActiveCell.Row, ActualValue).Value) And IsNumeric(Cells(ActiveCell.Row, DesiredValue).Value) Then
        bOK = (Cells(ActiveCell.Row, ActualValue).Value >= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceLower).Value And _
            Cells(ActiveCell.Row, ActualValue).Value <= Cells(ActiveCell.Row, DesiredValue).Value + Cells(ActiveCell.Row, ToleranceUpper).Value)
    
        Cells(ActiveCell.Row, Rating).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

End Sub

Sub RunAutoRating()

On Error GoTo OnError

Sheets("Messdatenblatt").Select

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Cells(8, 1).Select

Do While Not ActiveCell.Value = ""
    Cells(ActiveCell.Row, 10).Select
    ValueRating
    Cells(ActiveCell.Row + 1, 1).Select
Loop

Cells(1, 1).Select

OnExit:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit

End Sub






Attribute VB_Name = "Modul"
Option Explicit

Public Function GetGUID() As String
    Dim x As Variant
    Set x = CreateObject("Scriptlet.TypeLib")
    GetGUID = Mid(Left(x.GUID, 38), 2, 36)
End Function

Sub AddToolCorrection()

 Dim i As Integer
 i = 0

 Dim currentRow As Integer
 currentRow = Excel.Selection.Row

 If (currentRow < 8 Or (Cells(currentRow, 29) = "" And Cells(currentRow, 30) = "")) Then
    Exit Sub
 End If
 
 Dim ActualValueRow As Integer
 
 For ActualValueRow = currentRow To 1 Step -1
 
    If (Cells(ActualValueRow, 29) <> "") Then
       Exit For
    End If
 Next
 
 If (Cells(ActualValueRow, 1).Interior.ColorIndex = 3) Then
    Exit Sub
 End If
 
Dim CorrectionCount As Integer
  
CorrectionCount = 1

Do While (Cells(ActualValueRow + CorrectionCount, 29) = "" And Cells(ActualValueRow + CorrectionCount, 30) <> "")
    CorrectionCount = CorrectionCount + 1
Loop
  
   
currentRow = ActualValueRow + CorrectionCount

Rows(currentRow).Select
Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove

Cells(currentRow, 1).Select

For i = 1 To 16
    Range(Cells(ActualValueRow, i), Cells(currentRow, i)).MergeCells = True
Next

Range(Cells(ActualValueRow, 29), Cells(currentRow, 29)).MergeCells = True
 
Range(Cells(currentRow, 17), Cells(currentRow, 30)).Interior.Color = RGB(255, 255, 255)
 
Cells(currentRow, 30) = GetGUID()
 
End Sub


Sub AddActualValue()

 Dim i As Integer
 i = 0

 Dim currentRow As Integer
 currentRow = Excel.Selection.Row

 If (currentRow < 8 Or (Cells(currentRow, 29) = "" And Cells(currentRow, 30) = "")) Then
    Exit Sub
 End If
 
 Dim ActualValueRow As Integer
 
 For ActualValueRow = currentRow To 1 Step -1
 
    If (Cells(ActualValueRow, 29) <> "") Then
       Exit For
    End If
 Next
 
 
Dim CorrectionCount As Integer
  CorrectionCount = 1
  
  If (Cells(ActualValueRow, 30) <> "") Then
    
    Do While (Cells(ActualValueRow + CorrectionCount, 29) = "" And Cells(ActualValueRow + CorrectionCount, 30) <> "")
        CorrectionCount = CorrectionCount + 1
    Loop
  
  End If
   
 
currentRow = ActualValueRow + CorrectionCount

Rows(currentRow).Select
Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove

Cells(currentRow, 1).Select

Cells(currentRow, 29) = Cells(ActualValueRow, 29)
Range(Cells(currentRow, 1), Cells(currentRow, 16)).Value = Range(Cells(ActualValueRow, 1), Cells(ActualValueRow, 16)).Value

Cells(currentRow, 31).Value = "A"
  
Range(Cells(currentRow, 1), Cells(currentRow, 30)).Interior.Color = RGB(255, 255, 255)
   
End Sub


Sub DeleteActualValue()


 Dim i As Integer
 i = 0

 Dim currentRow As Integer
 currentRow = Excel.Selection.Row

 If (currentRow < 8 Or (Cells(currentRow, 29) = "" And Cells(currentRow, 30) = "")) Then
    Exit Sub
 End If
 
 Dim ActualValueRow As Integer
 
 For ActualValueRow = currentRow To 1 Step -1
 
    If (Cells(ActualValueRow, 29) <> "") Then
       Exit For
    End If
 Next
 
 Dim CorrectionCount As Integer
  CorrectionCount = 1
  
  Do While (Cells(ActualValueRow + CorrectionCount, 29) = "" And Cells(ActualValueRow + CorrectionCount, 30) <> "")
      Range(Cells(ActualValueRow + CorrectionCount, 1), Cells(ActualValueRow + CorrectionCount, 28)).Interior.Color = RGB(255, 0, 0)
      CorrectionCount = CorrectionCount + 1
  Loop

Range(Cells(ActualValueRow, 1), Cells(ActualValueRow, 28)).Interior.Color = RGB(255, 0, 0)
  
Cells(ActualValueRow, 31).Font.Color = RGB(255, 255, 255)
Cells(ActualValueRow, 31).Value = "D"
    
 
End Sub

Sub DeleteToolCorrection()

 Dim i As Integer
 i = 0

 Dim currentRow As Integer
 currentRow = Excel.Selection.Row

 If (currentRow < 8 Or (Cells(currentRow, 29) = "" And Cells(currentRow, 30) = "")) Then
    Exit Sub
 End If
   
 Range(Cells(currentRow, 17), Cells(currentRow, 28)).Interior.Color = RGB(255, 0, 0)
 
 Cells(currentRow, 32).Font.Color = RGB(255, 255, 255)
Cells(currentRow, 32).Value = "D"

End Sub



Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const ReportTopRow = 8
Const ReportHeaders = 6
Const ActualValue = 10
Const DesiredValue = 9
Const ToleranceLower = 10
Const ToleranceUpper = 11
Const Ratings = 3

Private Sub Worksheet_Change(ByVal Target As Range)

On Error GoTo OnError

Dim ws As Worksheet
Dim bOK As Boolean
Dim colm As Integer
Dim ro As Integer
Dim zaehler As Integer

Dim rngZelle As Range
Set ws = Target.Worksheet

'jede Zelle innerhalb des Target-Bereiches durchlaufen
For Each rngZelle In Target

colm = rngZelle.Column
ro = rngZelle.Row
zaehler = Cells(ro, 1).Value

If Cells(ReportHeaders, colm).Value = "Istwert" And ro >= ReportTopRow Then
    Worksheets("Measurement").Cells(zaehler + 7, ActualValue).Value = rngZelle.Value
    If IsEmpty(ws.Cells(ro, colm).Value) Then
        ws.Cells(ro, colm + 3).ClearContents
    ElseIf Not IsEmpty(ws.Cells(ro, colm).Value) And IsNumeric(ws.Cells(ro, colm).Value) Then
        bOK = (ws.Cells(ro, colm).Value >= ws.Cells(ro, DesiredValue).Value + ws.Cells(ro, ToleranceLower).Value And _
            ws.Cells(ro, colm).Value <= ws.Cells(ro, DesiredValue).Value + ws.Cells(ro, ToleranceUpper).Value)
        ws.Cells(ro, colm + 3).Formula = Hidden.Cells(IIf(bOK, OkRating, NokRating), Ratings).Value
    End If
End If

If Cells(ReportHeaders, colm).Value = "Messmittel" And ro >= ReportTopRow Then
    Worksheets("Measurement").Cells(zaehler + 7, ActualValue + 1).Value = rngZelle.Value
ElseIf Cells(ReportHeaders, colm).Value = "Bemerkung" And ro >= ReportTopRow Then
    Worksheets("Measurement").Cells(zaehler + 7, ActualValue + 2).Value = rngZelle.Value
End If

Next rngZelle

OnExit:
    Exit Sub
OnError:
    MsgBox Err.Description
    Resume OnExit
End Sub

 


INQUEST-PP=macro
