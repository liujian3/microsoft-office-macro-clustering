Attribute VB_Name = "Collapse_Expand"
Sub Exp_Coll_Less_Separate_Source_Income()

' Expand_Collapse Macro

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
Range("Exp_Col_Source_Inc").Select
Selection.EntireRow.Hidden = IIf(Selection.EntireRow.Hidden, False, True)


Application.ScreenUpdating = True

Range("Comp_Income_First").Select

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Exp_Coll_Less_Non_Taxable_Income()

' Expand_Collapse Macro

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
Range("Exp_Col_NonTax_Inc").Select
Selection.EntireRow.Hidden = IIf(Selection.EntireRow.Hidden, False, True)


Application.ScreenUpdating = True

Range("NT_Rcpt_First").Select

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Exp_Coll_Less_Non_Tax_Deductible_Expenses()

' Expand_Collapse Macro

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
Range("Exp_Col_NonTax_DedExp").Select
Selection.EntireRow.Hidden = IIf(Selection.EntireRow.Hidden, False, True)


Application.ScreenUpdating = True

Range("Exp_Coll_Exp").Select

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Exp_Coll_Add_Separate_Source_Income()

' Expand_Collapse Macro

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
Range("Exp_Col_Add_Source_Inc").Select
Selection.EntireRow.Hidden = IIf(Selection.EntireRow.Hidden, False, True)


Application.ScreenUpdating = True

Range("Net_Rental_Inc").Select

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Exp_Coll_Donations()

' Expand_Collapse Macro

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
Range("Exp_Col_Donation").Select
Selection.EntireRow.Hidden = IIf(Selection.EntireRow.Hidden, False, True)


Application.ScreenUpdating = True

Range("TaxComp_Donation").Select

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Attribute VB_Name = "DeleteRow"
Sub DeleteRow_CA()
'
' Delete_Row Macro
' Delete Row for Capital Allowance (CA)
'
Application.ScreenUpdating = False
Worksheets("Capital Allowance (CA)").Activate
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
'
Range("P9").Select

For i = 1 To 20

    If ActiveCell.Offset(i, 0).Value = "x" Then
        ActiveCell.Offset(i, 0).Select
        Selection.EntireRow.Select
        Selection.Delete Shift:=xlUp
    End If
Next i

Range("B10").Select

Application.ScreenUpdating = True

Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"

End Sub

Sub DeleteRow_PIC()
'
' Delete_Row Macro
' Delete Row for Capital Allowance - PIC
'
Application.ScreenUpdating = False
Worksheets("Capital Allowance - PIC").Activate
Sheets("Capital Allowance - PIC").Unprotect Password:="BTCYA2010"
'
Range("U10").Select

For i = 1 To 100

    If ActiveCell.Offset(i, 0).Value = "x" Then
        ActiveCell.Offset(i, 0).Select
        Selection.EntireRow.Select
        Selection.Delete Shift:=xlUp
    End If
Next i

Range("B11").Select

Application.ScreenUpdating = True

Sheets("Capital Allowance - PIC").Protect Password:="BTCYA2010"

End Sub

Attribute VB_Name = "Insert"
Sub Insert_Medical()
Attribute Insert_Medical.VB_Description = "Insert Additional Row for Medical Expense Schedule"
Attribute Insert_Medical.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Insert_Medical Macro
' Insert Additional Row for Medical Expense Schedule
'
Application.ScreenUpdating = False
Worksheets("Medical Expense Schedule").Activate
Sheets("Medical Expense Schedule").Unprotect Password:="BTCYA2010"
'
    Rows("22:22").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("B21").Select
    
Application.ScreenUpdating = True

Sheets("Medical Expense Schedule").Protect Password:="BTCYA2010"
    
    
End Sub

Sub Insert_Rental()
'
' Insert_Rental Macro
' Insert Additional Row in Rental Income Schedule
'
Application.ScreenUpdating = False
Worksheets("Rental Income Schedule").Activate
Sheets("Rental Income Schedule").Unprotect Password:="BTCYA2010"
'


    Range("Rental").Select
    Selection.EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
  
    Range("C32:D32").Select
    Selection.Copy
    Range("C33:D34").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
      
    Range("C32").Select
   
Application.ScreenUpdating = True

Sheets("Rental Income Schedule").Protect Password:="BTCYA2010"
    
    
End Sub

Sub Insert_TaxComp_Inc()
Attribute Insert_TaxComp_Inc.VB_Description = "Insert Additional row for Tax Comp - Income"
Attribute Insert_TaxComp_Inc.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Insert_TaxComp_Inc Macro
' Insert Additional row for Tax Comp - Income
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_Inc").Select
    Selection.EntireRow.Insert
    Range("Inc").Select
    
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_TaxComp_NR()
'
' Insert_TaxComp_Inc Macro
' Insert Additional row for Tax Comp - Income
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_NR").Select
    Selection.EntireRow.Insert
    Range("NR").Select
    
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_TaxComp_PIC()
'
' Insert_TaxComp_PIC Macro
' Insert Additional row for Tax Comp - PIC
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_PIC").Select
    Selection.EntireRow.Insert
    Range("PIC").Select
  
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_TaxComp_Exp()
'
' Insert_TaxComp_Exp Macro
' Insert Additional Row for Tax Comp - Expenses
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_OtherExp").Select
    Selection.EntireRow.Insert
    Range("OtherExp").Select
        
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"

End Sub

Sub Insert_TaxComp_Enhance()
'
' Insert_TaxComp_Enhance Macro
' Insert Additional Row for Tax Comp - Enhanced
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_Enhance").Select
    Selection.EntireRow.Insert
    Range("Enhance").Select
        
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"

End Sub

Sub Insert_TaxComp_Oth()
Attribute Insert_TaxComp_Oth.VB_Description = "Insert Additional row for Tax Comp - Other Income"
Attribute Insert_TaxComp_Oth.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Insert_TaxComp_Oth Macro
' Insert Additional row for Tax Comp - Other Income
'
Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
'
    Range("TaxComp_Others").Select
    Selection.EntireRow.Insert
    Range("OtherInc").Select
    
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"

End Sub

Sub Insert_RRCost()
'
' Insert_RRCost Macro
' Insert Additonal Row in R&R Schedule
'
Application.ScreenUpdating = False
Worksheets("R&R Cost Schedule").Activate
Sheets("R&R Cost Schedule").Unprotect Password:="BTCYA2010"
'
    Rows("13:13").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    
    Range("C13:G13").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
       
    Range("B12").Select
    
Application.ScreenUpdating = True

Sheets("R&R Cost Schedule").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_Existing_NoHP()
'
' Insert_CA_Existing_NoHP Macro in Capital Allowance (CA)
' Insert Additonal Row in Capital Allowance Summary
'
Application.ScreenUpdating = False
Worksheets("Capital Allowance (CA)").Activate
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
'
    Range("CA_Existing_NoHP").Select
    Selection.EntireRow.Insert
    
    Range("CA_Ex_NoHP_Row").Select
    Selection.Copy
    Range("CA_Ex_NoHP_Group").Select
    ActiveSheet.Paste
    
    Range("CA_Ex_Asset").Select
    
Application.ScreenUpdating = True

Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_Existing_HP()
'
' Insert_CA_Existing_HP Macro in Capital Allowance (CA)
' Insert Additonal Row in Capital Allowance Summary
'
Application.ScreenUpdating = False
Worksheets("Capital Allowance (CA)").Activate
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
'
    Range("CA_Existing_HP").Select
    Selection.EntireRow.Insert
    
    Range("CA_Ex_HP_Row").Select
    Selection.Copy
    Range("CA_Ex_HP_Group").Select
    ActiveSheet.Paste
        
    Range("CA_Existing_Asset_Hp").Select
    
Application.ScreenUpdating = True

Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_Disposal()
'
' Insert_CA_Disposal Macro in Capital Allowance (CA)
' Insert Additonal Row in Capital Allowance Summary
'
Application.ScreenUpdating = False
Worksheets("Capital Allowance (CA)").Activate
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
'
    Range("CA_Disposal").Select
    Selection.EntireRow.Insert
    
    Range("CA_Disposal_Row").Select
    Selection.Copy
    Range("CA_Disposal_Group").Select
    ActiveSheet.Paste
        
    Range("CA_Disposal_Assets").Select
    
Application.ScreenUpdating = True

Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_PIC_Existing_NoHP()
'
' Insert_CA_Existing_PIC_NoHP Macro in CA (assets acquired under PIC)
' Insert Additonal Row in Capital Allowance PIC
'
Application.ScreenUpdating = False
Worksheets("CA (assets acquired under PIC)").Activate
Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"
'
    Range("CA_Existing_PIC_NoHP").Select
    Selection.EntireRow.Insert
    Range("CA_Ex_PIC_NoHP_Row").Select
    Selection.Copy
    Range("CA_Ex_PIC_NoHP_Group").Select
    ActiveSheet.Paste
    
    Range("CA_Ex_PIC_Asset").Select
    
Application.ScreenUpdating = True

Sheets("CA (assets acquired under PIC)").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_PIC_Existing_HP()
'
' Insert_CA_PIC_Existing_HP Macro in CA (assets acquired under PIC)
' Insert Additonal Row in Capital Allowance PIC
'
Application.ScreenUpdating = False
Worksheets("CA (assets acquired under PIC)").Activate
Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"
'
    Range("CA_Existing_PIC_HP").Select
    Selection.EntireRow.Insert
    Range("CA_Ex_PIC_HP_Row").Select
    Selection.Copy
    Range("CA_Ex_PIC_HP_Group").Select
    ActiveSheet.Paste
        
    Range("CA_Existing_PIC_Asset_HP").Select
    
Application.ScreenUpdating = True

Sheets("CA (assets acquired under PIC)").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_CA_PIC_Disposal()
'
' Insert_CA_PIC_Disposal Macro in CA (assets acquired under PIC)
' Insert Additonal Row in Capital Allowance PIC
'
Application.ScreenUpdating = False
Worksheets("CA (assets acquired under PIC)").Activate
Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"
'
    Range("CA_PIC_Disposal").Select
    Selection.EntireRow.Insert
    
    'Range("CA_Disposal_Row").Select
    'Selection.Copy
    'Range("CA_Disposal_Group").Select
    'ActiveSheet.Paste
        
    Range("CA_Disposal_PIC_Assets").Select
    
Application.ScreenUpdating = True

Sheets("CA (assets acquired under PIC)").Protect Password:="BTCYA2010"
    
End Sub


Attribute VB_Name = "Insert_CA_NewAssets"
Sub Insert_CA_New()
 'Find the last empty row in Capital Allowance Summary
 
 Application.ScreenUpdating = False
 
 Dim WS1 As Worksheet
 Dim WS2 As Worksheet
 
 Set WS1 = Worksheets("Capital Allowance - New")
 Set WS2 = Worksheets("Capital Allowance (CA)")

 WS2.Select
 ActiveSheet.Unprotect Password:="BTCYA2010"

 Dim j As Long
 j = 10
 Do While Cells(j, 1) <> ""
 j = j + 1
 Loop
 With Rows(j)
 .Copy
 .Insert Shift:=xlUp
 End With
 Application.CutCopyMode = False

 'Copy data
  
 WS2.Cells(j, 2).Value = WS1.Range("G30").Value 'Category of fixed asset
 WS2.Cells(j, 3).Value = WS1.Range("E12").Value 'YA
 WS2.Cells(j, 5).Value = WS1.Range("C38").Value 'Working Life
 WS2.Cells(j, 7).Value = WS1.Range("C42").Value 'cost
 
 ActiveSheet.Protect Password:="BTCYA2010"
 
 WS1.Select
 Range("C30").ClearContents
 Range("C34").ClearContents
 Range("C38").ClearContents
 Range("C42").ClearContents
 
 Range("C30").Select
 Application.ScreenUpdating = True
   
End Sub
  





Attribute VB_Name = "Insert_PIC"
Sub Insert_PIC_Equip()

' Insert_PIC_Equip Macro
' Insert Additional row for PIC - Training & Equip. Leasing (Equipment)
'
Application.ScreenUpdating = False
Worksheets("PIC - Training & Equip. Leasing").Activate
Sheets("PIC - Training & Equip. Leasing").Unprotect Password:="BTCYA2010"
'
    Range("PIC_Equip").Select
    Selection.EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
           
    Range("PIC_Equip_Copy").Select
    Selection.Copy
    Range("PIC_Equip_Paste").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
        
    Range("Equipment").Select
    
Application.ScreenUpdating = True

Sheets("PIC - Training & Equip. Leasing").Protect Password:="BTCYA2010"
    
End Sub

Sub Insert_PIC_Train()

' Insert_PIC_Train Macro
' Insert Additional row for PIC - Training & Equip. Leasing (Training)
'
Application.ScreenUpdating = False
Worksheets("PIC - Training & Equip. Leasing").Activate
Sheets("PIC - Training & Equip. Leasing").Unprotect Password:="BTCYA2010"
'
    Range("PIC_Train").Select
    Selection.EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    
    Range("PIC_Train_Copy").Select
    Selection.Copy
    Range("PIC_Train_Paste").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
 
    Range("Train").Select
    
Application.ScreenUpdating = True

Sheets("PIC - Training & Equip. Leasing").Protect Password:="BTCYA2010"
    
End Sub
Attribute VB_Name = "Named_Range"
Sub UnHideAllNames()

 Dim N As Name
    For Each N In Names
        If N.Visible = False Then N.Visible = True
    Next

End Sub

Sub HideAllNames()

 Dim N As Name
    For Each N In Names
       If N.Visible = True Then N.Visible = False 'Else N.Visible = True
    Next

End Sub



Attribute VB_Name = "Password_All"
Sub Unprotect_Password()

'Unprotect All
Sheets("Content").Unprotect Password:="BTCYA2010"
Sheets("Introduction").Unprotect Password:="BTCYA2010"
Sheets("Using the Basic Tax Calculator").Unprotect Password:="BTCYA2010"
Sheets("Company's Particulars").Unprotect Password:="BTCYA2010"
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"
Sheets("Rental Income Schedule").Unprotect Password:="BTCYA2010"
Sheets("Interest Adjustment Schedule").Unprotect Password:="BTCYA2010"
Sheets("Medical Expense Schedule").Unprotect Password:="BTCYA2010"
Sheets("R&R Cost Schedule").Unprotect Password:="BTCYA2010"
Sheets("Capital Allowance - New").Unprotect Password:="BTCYA2010"
Sheets("Capital Allowance (HP) - Main").Unprotect Password:="BTCYA2010"
Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
Sheets("Capital Allowance Summary").Unprotect Password:="BTCYA2010"
Sheets("Notes").Unprotect Password:="BTCYA2010"

End Sub

Sub Protect_Password()

'Protect All
Sheets("Content").Protect Password:="BTCYA2010"
Sheets("Introduction").Protect Password:="BTCYA2010"
Sheets("Using the Basic Tax Calculator").Protect Password:="BTCYA2010"
Sheets("Company's Particulars").Protect Password:="BTCYA2010"
Sheets("Tax Computation").Protect Password:="BTCYA2010"
Sheets("Rental Income Schedule").Protect Password:="BTCYA2010"
Sheets("Interest Adjustment Schedule").Protect Password:="BTCYA2010"
Sheets("Medical Expense Schedule").Protect Password:="BTCYA2010"
Sheets("R&R Cost Schedule").Protect Password:="BTCYA2010"
Sheets("Capital Allowance - New").Protect Password:="BTCYA2010"
Sheets("Capital Allowance (HP) - Main").Protect Password:="BTCYA2010"
Sheets("CA (assets acquired under PIC)").Protect Password:="BTCYA2010"
Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"
Sheets("Capital Allowance Summary").Protect Password:="BTCYA2010"
Sheets("Notes").Protect Password:="BTCYA2010"

End Sub

Sub Unprotect_Password_Sub()

'Unprotect Notes

Sheets("Notes").Unprotect Password:="BTCYA2010"

End Sub

Sub Unprotect_TaxComp()

'Unprotect Tax Computation

Sheets("Tax Computation").Unprotect Password:="BTCYA2010"

End Sub
Attribute VB_Name = "PrintSettings_Add_Sch"

Sub PrintSet_Add_Sch()

    Application.ScreenUpdating = False
    lngLastRow = Columns("B:B").Find(What:="(2) *", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$B$2:$H$" & lngLastRow 'Change This
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.5)
        .RightMargin = Application.InchesToPoints(0.1)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        '.PrintQuality = 300
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
    
End Sub

Attribute VB_Name = "PrintSettings_All"
Sub Printset_All()

Call CellsCheck_TaxComp
'Call PrintSet_CITRebate
Call PrintSet_Rental
Call CellsCheck_Interest
Call CellsCheck_MedicalExp
Call CellsCheck_RRCost
'Call PrintSet_PIC
Call PrintSet_CA_NewHP
Call CellsCheck_CA_PIC
Call CellsCheck_CA_NoPIC
Call PrintSet_CA_Summary

End Sub
Attribute VB_Name = "PrintSettings_CA_AssetsAcqPIC"
Sub CellsCheck_CA_PIC()

'CA (assets acquired under PIC)

Application.ScreenUpdating = False
Worksheets("CA (assets acquired under PIC)").Activate
Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"

Call PrintSet_CA_PIC_Summary

Rows("9:37").Select
Selection.EntireRow.Hidden = False

Range("B8").Select
Application.ScreenUpdating = True

Sheets("CA (assets acquired under PIC)").Protect Password:="BTCYA2010"

End Sub

Sub PrintSet_CA_PIC_Summary()
'
    Application.ScreenUpdating = False
    Worksheets("CA (assets acquired under PIC)").Activate
    Sheets("CA (assets acquired under PIC)").Unprotect Password:="BTCYA2010"
    
    lngLastRow = Columns("B:B").Find(What:="* The company", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$A$8:$S$" & lngLastRow 'Change This
        
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 59
        .PrintTitleRows = "$1:$7"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
End Sub

Attribute VB_Name = "PrintSettings_CA_HP_Main"
Sub PrintSet_CA_NewHP()
'
    Application.ScreenUpdating = False
    Worksheets("Capital Allowance (HP) - Main").Activate
    Sheets("Capital Allowance (HP) - Main").Unprotect Password:="BTCYA2010"
    
       Range("M5:M13").Select
           With Selection.Font
              .ColorIndex = xlAutomatic
              .TintAndShade = 0
            End With
    
        Range("M31").Select
            With Selection.Font
              .ColorIndex = xlAutomatic
              .TintAndShade = 0
            End With
            
    Sheets("Capital Allowance (HP) - Main").PageSetup.PrintArea = "$B$11:$V$41"
    
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$5:$16"
        .PrintTitleColumns = "$B$11:$B$41"
    End With
    
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
    
      Range("M5:M13").Select
           With Selection.Font
              .ThemeColor = xlThemeColorDark1
              .TintAndShade = 0
            End With
    
        Range("M31").Select
            With Selection.Font
              .ThemeColor = xlThemeColorDark1
              .TintAndShade = 0
            End With
        
    Sheets("Capital Allowance (HP) - Main").Protect Password:="BTCYA2010"
End Sub



Attribute VB_Name = "PrintSettings_CA_NoPIC"
Sub CellsCheck_CA_NoPIC()

'Capital Allowance (CA)

Application.ScreenUpdating = False
Worksheets("Capital Allowance (CA)").Activate
Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"

Call PrintSet_CA_NoPIC_Summary

Rows("8:52").Select
Selection.EntireRow.Hidden = False

Range("B8").Select
Application.ScreenUpdating = True

Sheets("Capital Allowance (CA)").Protect Password:="BTCYA2010"

End Sub

Sub PrintSet_CA_NoPIC_Summary()
'
    Application.ScreenUpdating = False
    Worksheets("Capital Allowance (CA)").Activate
    Sheets("Capital Allowance (CA)").Unprotect Password:="BTCYA2010"
    
    lngLastRow = Columns("B:B").Find(What:="Gain / (Loss)", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$A$1:$N$" & lngLastRow 'Change This
        
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
 
End Sub

Attribute VB_Name = "PrintSettings_CA_Summary"
Sub CellsCheck_CA_Summary()

'Capital Allowance Summary

Application.ScreenUpdating = False
Worksheets("Capital Allowance Summary").Activate
Sheets("Capital Allowance Summary").Unprotect Password:="BTCYA2010"

'Call CA_New_NoHP
'Call CA_Ex_NoHP
'Call CA_New_HP
'Call CA_Ex_HP
'Call CA_Disposal

Call PrintSet_CA_Summary

Rows("8:15").Select
Selection.EntireRow.Hidden = False

Range("B8").Select
Application.ScreenUpdating = True

Sheets("Capital Allowance Summary").Protect Password:="BTCYA2010"

End Sub

Sub CA_New_NoHP()

'Additions during the year (non-HP assets)

Dim New_NoHP_First As Long
Dim New_NoHP_Last As Long

New_NoHP_First = Sheets("Capital Allowance - No PIC").Range("Add_NoHP_Life_First").Row
New_NoHP_Last = Sheets("Capital Allowance - No PIC").Range("Add_NoHP_Life_Last").Row

For N = New_NoHP_First To New_NoHP_Last
    If Cells(N, 12).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub CA_Ex_NoHP()

'Existing Assets (non-HP)

Dim Existing_NoHP_First As Long
Dim Existing_NoHP_Last As Long

Existing_NoHP_First = Sheets("Capital Allowance - No PIC").Range("Ex_NoHP_Life_First").Row
Exisitng_NoHP_Last = Sheets("Capital Allowance - No PIC").Range("Ex_NoHP_Life_Last").Row

For N = Existing_NoHP_First To Exisitng_NoHP_Last
    If Cells(N, 12).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub
Sub CA_New_HP()

'Additions during the year (HP assets)

Dim New_HP_First As Long
Dim New_HP_Last As Long

New_HP_First = Sheets("Capital Allowance - No PIC").Range("Add_HP_Life_First").Row
New_HP_Last = Sheets("Capital Allowance - No PIC").Range("Add_HP_Life_Last").Row

For N = New_HP_First To New_HP_Last
    If Cells(N, 12).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub CA_Ex_HP()

'Existing Assets (HP)

Dim Existing_HP_First As Long
Dim Existing_HP_Last As Long

Existing_HP_First = Sheets("Capital Allowance - No PIC").Range("Ex_HP_Life_First").Row
Exisitng_HP_Last = Sheets("Capital Allowance - No PIC").Range("Ex_HP_Life_Last").Row

For N = Existing_HP_First To Exisitng_HP_Last
    If Cells(N, 12).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub CA_Disposal()

'Disposal during the year

Dim Disp_First As Long
Dim Disp_Last As Long

Disp_First = Sheets("Capital Allowance - No PIC").Range("CA_Disposal_Row").Row
Disp_Last = Sheets("Capital Allowance - No PIC").Range("CA_Disposal_Last").Row

For N = Disp_First To Disp_Last
    If Cells(N, 10).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub PrintSet_CA_Summary()
'
    Application.ScreenUpdating = False
    Worksheets("Capital Allowance Summary").Activate
    Sheets("Capital Allowance Summary").Unprotect Password:="BTCYA2010"
    
    lngLastRow = Columns("B:B").Find(What:="Total BC", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$A$1:$N$" & lngLastRow 'Change This
        
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.65)
        .RightMargin = Application.InchesToPoints(0.65)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 75
        .PrintTitleRows = "$1:$7"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
 
End Sub
Attribute VB_Name = "PrintSettings_CITRebate"
Sub PrintSet_CITRebate()
'
Application.ScreenUpdating = False
Worksheets("SME Cash Grant").Activate
Sheets("SME Cash Grant").Unprotect Password:="BTCYA2010"

    Range("A2:G41").Select
    Range("H20").Activate
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
       
Range("G10").Select

Sheets("SME Cash Grant").Protect Password:="BTCYA2010"
       
End Sub
Attribute VB_Name = "PrintSettings_Interest"
Sub CellsCheck_Interest()

Application.ScreenUpdating = False
Worksheets("Interest Adjustment Schedule").Activate
Sheets("Interest Adjustment Schedule").Unprotect Password:="BTCYA2010"


'Non-Income Producing Assets
For N = 9 To 16
    If Cells(N, 5).Value = "" Then
    Rows(N).Select
    Selection.EntireRow.Hidden = True
    End If
Next N

'Total Assets
For N = 20 To 27
    If Cells(N, 5).Value = "" Then
    Rows(N).Select
    Selection.EntireRow.Hidden = True
    End If
Next N

'Interest Expense
For N = 31 To 34
    If Cells(N, 5).Value = "" Then
    Rows(N).Select
    Selection.EntireRow.Hidden = True
    End If
Next N


Call PrintSet_Interest

Rows("8:36").Select
Selection.EntireRow.Hidden = False

Range("C8").Select
Application.ScreenUpdating = True

Sheets("Interest Adjustment Schedule").Protect Password:="BTCYA2010"

End Sub



Sub PrintSet_Interest()
'
    Application.ScreenUpdating = False
    ActiveSheet.PageSetup.PrintArea = "$B$1:$G$43" 'Change This
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.5)
        .RightMargin = Application.InchesToPoints(0.5)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 90
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview

End Sub
Attribute VB_Name = "PrintSettings_Medical"
Sub CellsCheck_MedicalExp()

Application.ScreenUpdating = False
Worksheets("Medical Expense Schedule").Activate
Sheets("Medical Expense Schedule").Unprotect Password:="BTCYA2010"


Dim Med_First As Long
Dim Med_Last As Long

Med_First = Sheets("Medical Expense Schedule").Range("Med_Amt").Row
Med_Last = Sheets("Medical Expense Schedule").Range("Med_Tot_Amt").Row

For N = Med_First To Med_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

Call PrintSet_MedicalExp


Rows("8:35").Select
Selection.EntireRow.Hidden = False


Range("J9").Select
Application.ScreenUpdating = True



Sheets("Medical Expense Schedule").Protect Password:="BTCYA2010"

End Sub

Sub PrintSet_MedicalExp()
'
    Application.ScreenUpdating = False
    lngLastRow = Columns("B:B").Find(What:="Amount disallowed", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$B$2:$K$" & lngLastRow
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.05)
        .RightMargin = Application.InchesToPoints(0.05)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 90
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview

End Sub




Attribute VB_Name = "PrintSettings_PIC"
Sub PrintSet_PIC()
'
Application.ScreenUpdating = False
Worksheets("PIC - Training & Equip. Leasing").Activate
Sheets("PIC - Training & Equip. Leasing").Unprotect Password:="BTCYA2010"
    
    ActiveSheet.PageSetup.PrintArea = "$A$1:$G$50"
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
       
Range("B11").Select

Sheets("PIC - Training & Equip. Leasing").Protect Password:="BTCYA2010"
       
End Sub

Attribute VB_Name = "PrintSettings_PIC_Tracker"
Sub PrintSet_PIC_Exp()
'
Application.ScreenUpdating = False
Worksheets("PIC Tracker (Optional)").Activate
Sheets("PIC Tracker (Optional)").Unprotect Password:="BTCYA2010"
    
    ActiveSheet.PageSetup.PrintArea = "$A$1:$J$16"
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = False
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
       
Range("E10").Select

Sheets("PIC Tracker (Optional)").Protect Password:="BTCYA2010"
       
End Sub


Attribute VB_Name = "PrintSettings_RRcost"
Sub CellsCheck_RRCost()

Application.ScreenUpdating = False
Worksheets("R&R Cost Schedule").Activate
Sheets("R&R Cost Schedule").Unprotect Password:="BTCYA2010"

Dim RR_First As Long
Dim RR_Last As Long

RR_First = Sheets("R&R Cost Schedule").Range("RR_Amt").Row
RR_Last = Sheets("R&R Cost Schedule").Range("RR_Tot_Amt").Row

For N = RR_First To RR_Last
    If Cells(N, 8).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N
      
Call PrintSet_RRCost

Rows("8:39").Select
Selection.EntireRow.Hidden = False


Range("B11").Select
Application.ScreenUpdating = True


Sheets("R&R Cost Schedule").Protect Password:="BTCYA2010"

End Sub

Sub PrintSet_RRCost()

    Application.ScreenUpdating = False
    Worksheets("R&R Cost Schedule").Activate
    Sheets("R&R Cost Schedule").Unprotect Password:="BTCYA2010"
    
    lngLastRow = Columns("B:B").Find(What:="End*", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$B$2:$H$" & lngLastRow 'Change This
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.5)
        .RightMargin = Application.InchesToPoints(0.1)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        '.PrintQuality = 300
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 100
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
    
End Sub
Attribute VB_Name = "PrintSettings_Rental"

Sub CellsCheck_Rental()

Application.ScreenUpdating = False
Worksheets("Rental Income Schedule").Activate
Sheets("Rental Income Schedule").Unprotect Password:="BTCYA2010"

If Cells(22, 5).Value = "" Then
    Rows(22).Select
    Selection.EntireRow.Hidden = True
End If


Dim Rent_First As Long
Dim Rent_Last As Long

Rent_First = Sheets("Rental Income Schedule").Range("Rent_Exp_Amt").Row
Rent_Last = Sheets("Rental Income Schedule").Range("Rent_Oth_Amt").Row

For N = Rent_First To Rent_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N



Call PrintSet_Rental

Rows("6:39").Select
Selection.EntireRow.Hidden = False

Range("D14").Select
Application.ScreenUpdating = True

Sheets("Rental Income Schedule").Protect Password:="BTCYA2010"

End Sub


Sub PrintSet_Rental()
Attribute PrintSet_Rental.VB_Description = "Macro recorded 06/12/2006 by Lim Ming Siang"
Attribute PrintSet_Rental.VB_ProcData.VB_Invoke_Func = " \n14"
'
    Application.ScreenUpdating = False
    Worksheets("Rental Income Schedule").Activate
    Sheets("Rental Income Schedule").Unprotect Password:="BTCYA2010"
    
    lngLastRow = Columns("C:C").Find(What:="Net rental income*", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$A$1:$G$" & lngLastRow  'Change This
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.27)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlPortrait
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 90
        .PrintTitleRows = "$1:$6" 'Print Title
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
    
End Sub


Attribute VB_Name = "PrintSettings_TaxComp"
Sub CellsCheck_TaxComp()

Application.ScreenUpdating = False
Worksheets("Tax Computation").Activate
Sheets("Tax Computation").Unprotect Password:="BTCYA2010"

Call Comp_Income
Call Comp_Receipts
Call Comp_Exp
'Call Comp_Enh
Call Comp_Oth_Inc

Call PrintSet_TaxComp

Rows("8:113").Select
Selection.EntireRow.Hidden = False

Range("F8").Select
Application.ScreenUpdating = True

Sheets("Tax Computation").Protect Password:="BTCYA2010"

End Sub

Sub Comp_Income()

'Less: Separate source Income / Non-taxable income

Dim Inc_First As Long
Dim Inc_Last As Long

Inc_First = Sheets("Tax Computation").Range("Comp_Income_First").Row
Inc_Last = Sheets("Tax Computation").Range("Comp_Income_Last").Row

For N = Inc_First To Inc_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub Comp_Receipts()

'Less: Non-Taxable Receipts / Non-taxable income

Dim Rcpt_First As Long
Dim Rcpt_Last As Long

Rcpt_First = Sheets("Tax Computation").Range("NT_Rcpt_First").Row
Rcpt_Last = Sheets("Tax Computation").Range("NT_Rcpt_Last").Row

For N = Rcpt_First To Rcpt_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub Comp_Exp()

'Add: Disallowable expenses

Dim Exp_First As Long
Dim Exp_Last As Long

Exp_First = Sheets("Tax Computation").Range("Comp_Exp_First").Row
Exp_Last = Sheets("Tax Computation").Range("Comp_Exp_Last").Row

For N = Exp_First To Exp_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub Comp_Enh()

'Add: Enhanced / further deduction

Dim Enh_First As Long
Dim Enh_Last As Long

Enh_First = Sheets("Tax Computation").Range("Comp_Enh_First").Row
Enh_Last = Sheets("Tax Computation").Range("Comp_Enh_Last").Row

For N = Enh_First To Enh_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub Comp_Oth_Inc()

'Add: Other income

Dim Oth_First As Long
Dim Oth_Last As Long

Oth_First = Sheets("Tax Computation").Range("Comp_Oth_Inc_First").Row
Oth_Last = Sheets("Tax Computation").Range("Comp_Oth_Inc_Last").Row

For N = Oth_First To Oth_Last
    If Cells(N, 5).Value = "" Then
      Rows(N).Select
      Selection.EntireRow.Hidden = True
    End If
Next N

End Sub

Sub PrintSet_TaxComp()
'
    Application.ScreenUpdating = False
    lngLastRow = Columns("D:D").Find(What:="Unutilised donations c/f", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row
    ActiveSheet.PageSetup.PrintArea = "$A$4:$I$" & lngLastRow
    With ActiveSheet.PageSetup
        .LeftHeader = ""
        .CenterHeader = ""
        .RightHeader = ""
        .LeftFooter = ""
        .CenterFooter = ""
        .RightFooter = ""
        .LeftMargin = Application.InchesToPoints(0.25)
        .RightMargin = Application.InchesToPoints(0.25)
        .TopMargin = Application.InchesToPoints(0.36)
        .BottomMargin = Application.InchesToPoints(0.7)
        .HeaderMargin = Application.InchesToPoints(0.2)
        .FooterMargin = Application.InchesToPoints(0.16)
        .PrintHeadings = False
        .PrintGridlines = False
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperA4
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = False
        .Zoom = 81
        .PrintTitleRows = "$1:$6"
        .PrintTitleColumns = ""
    End With
    
    ' 21 August 2008 - INFOD
    ' Change .ScreenUpdating setting before .PrintPreview
    Application.ScreenUpdating = True
    
    ActiveWindow.SelectedSheets.PrintPreview
    
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()

    ActiveWindow.DisplayZeros = False

End Sub

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
