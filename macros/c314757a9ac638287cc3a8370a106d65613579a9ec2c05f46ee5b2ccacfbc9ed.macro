Attribute VB_Name = "ModuleServ"
Public DoSelection As Boolean
Public SignType As Integer
Public Listname As String
Public EditRangeRow As Long
Public EditRangeCol As Long
Public EthernetIP As Long
Public EthernetSlot As Integer

Public Const snDI = 1
Public Const snDO = 2
Public Const snAI = 3
Public Const snAIm = 4
Public Const snAO = 5
Public Const snGrp = 6

Public Const ltMinAvar = 1
Public Const ltMin = 2
Public Const ltMax = 3
Public Const ltMaxAvar = 4
 
Sub Lists()
  Set myBar = CommandBars.ActionControl
  For i = 1 To myBar.Controls.Count
    myBar.Controls.Item(1).Delete
  Next
  For i = 1 To Sheets.Count
    Set myControl = myBar.Controls.Add(Type:=msoControlButton)
    With myControl
      .Caption = Sheets.Item(i).name
      .OnAction = "CBarButton_Click"
    End With
  Next
  myBar.Visible = True
End Sub

Sub CBarButton_Click()
    Set myControl = CommandBars.ActionControl
    Sheets(myControl.Caption).Select
End Sub


Sub RefreshAll()
  Worksheets("LIST1").RefreshCBtn8_Click
  Worksheets("LIST2").RefreshCBtn9_Click
  Worksheets("LIST3").RefreshCBtn10_Click
  Worksheets("LIST4").RefreshCBtn11_Click
  Worksheets("LIST5").RefreshCBtn12_Click
  Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn14_Click
  Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Worksheet_Activate
  Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn19_Click
  Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn20_Click
  Worksheets("|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Refresh|fffd|Btn23_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn24_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn29_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn31_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn32_Click
  Worksheets("DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn33_Click
  Worksheets("DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn37_Click
  Worksheets("DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn38_Click
  Worksheets("DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn39_Click
  Worksheets("DI |fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn40_Click
  Worksheets("DO |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn41_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn43_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").RefreshCBtn44_Click
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").RefreshCBtn45_Click
End Sub
Function ExtractProjName(FName As String) As String
  Dim PosSl As Integer
  Dim PosP As Integer
  Dim LenStr As Integer
  LenStr = Len(FName)
  For i = LenStr To 1 Step -1
    If Mid(FName, i - 1, 1) = "\" Then
      PosSl = i
      Exit For
    End If
    If Mid(FName, i - 1, 1) = "." Then
      PosP = i
    End If
  Next i
  ExtractProjName = Mid(FName, PosSl, LenStr - PosSl - (LenStr - PosP) - 1)
End Function

Function GetIPCode(IPStr As String) As Long
  Dim N4 As Integer
  Dim N3 As Integer
  Dim N2 As Integer
  Dim N1 As Integer
  Dim n As Integer
  Dim LenStr As Integer
  GetIPCode = 16843009
  LenStr = Len(IPStr)
  n = 0
  For i = LenStr To 1 Step -1
    If Mid(IPStr, i - 1, 1) = "." Or Mid(IPStr, i - 1, 1) = "," Then
      n = n + 1
      Select Case n
        Case 1
          GetIPCode = 65536 * CInt(Right(IPStr, Len(IPStr) - i + 1))
          IPStr = Left(IPStr, i - 2)
        Case 2
          GetIPCode = GetIPCode + 16777216 * CInt(Right(IPStr, Len(IPStr) - i + 1))
          IPStr = Left(IPStr, i - 2)
        Case 3
          GetIPCode = GetIPCode + CInt(Right(IPStr, Len(IPStr) - i + 1))
          IPStr = Left(IPStr, i - 2)
          GetIPCode = GetIPCode + 256 * CLng(IPStr)
          Exit For
      End Select
    End If
  Next i
End Function

Sub WriteModule(fNum As Long, ModuleName As String, i As Variant, j As Variant)
  If ModuleName = "140 CRA 932 00" Or ModuleName = "140 CRA 931 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 2"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 267"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CRA-93x-00"""
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 ACI 040 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 2"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 294"
    Print #fNum, String(5, Chr(9)); "inputBytes = 34"
    Print #fNum, String(5, Chr(9)); "inputIsRegister = 1"
    If Cells(6 + 6 * (i - 1), 5 + j - 1).Value < 400000 Then
      Print #fNum, String(5, Chr(9)); "inputReference = 3:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 300000)
    Else
      Print #fNum, String(5, Chr(9)); "inputReference = 4:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 400000)
    End If
    Print #fNum, String(5, Chr(9)); "outputIsSwapped = 1"
    Print #fNum, String(5, Chr(9)); "dataLength = 5"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-ACI-040-00"""
    Print #fNum, String(5, Chr(9)); "modData = 10: 33 33 33 33 33 33 33 33 33 33 "
    Print #fNum, String(4, Chr(9)); "END"
   
  ElseIf ModuleName = "140 ACO 020 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 2"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 259"
    Print #fNum, String(5, Chr(9)); "outputBytes = 8"
    Print #fNum, String(5, Chr(9)); "outputIsRegister = 1"
    Print #fNum, String(5, Chr(9)); "outputIsSwapped = 1"
    Print #fNum, String(5, Chr(9)); "outputReference = 4:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 400000)
    Print #fNum, String(5, Chr(9)); "dataLength = 2"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-ACO-020-00"""
    Print #fNum, String(5, Chr(9)); "modData = 4: 01 80 55 55 "
    Print #fNum, String(4, Chr(9)); "END"
   
  ElseIf ModuleName = "140 DDI 353 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 6"
    Print #fNum, String(5, Chr(9)); "inputBytes = 4"
    Print #fNum, String(5, Chr(9)); "inputIsRegister = 1"
    Print #fNum, String(5, Chr(9)); "inputIsSwapped = 1"
    If Cells(6 + 6 * (i - 1), 5 + j - 1).Value < 400000 Then
      Print #fNum, String(5, Chr(9)); "inputReference = 3:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 300000)
    Else
      Print #fNum, String(5, Chr(9)); "inputReference = 4:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 400000)
    End If
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-DDI-353-00"""
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 DDO 353 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 4"
    Print #fNum, String(5, Chr(9)); "outputBytes = 4"
    Print #fNum, String(5, Chr(9)); "outputIsRegister = 1"
    Print #fNum, String(5, Chr(9)); "outputIsSwapped = 1"
    If Cells(6 + 6 * (i - 1), 5 + j - 1).Value < 400000 Then
      Print #fNum, String(5, Chr(9)); "outputReference = 3:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 300000)
    Else
      Print #fNum, String(5, Chr(9)); "outputReference = 4:"; CStr(Cells(6 + 6 * (i - 1), 5 + j - 1).Value - 400000)
    End If
    Print #fNum, String(5, Chr(9)); "dataLength = 2"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-DDO-353-00"""
    Print #fNum, String(5, Chr(9)); "fHoldLast = 1"
    Print #fNum, String(5, Chr(9)); "modData = 4: 00 00 00 00 "
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 CPS 114 20" Or ModuleName = "140 CPS 114 10" Or ModuleName = "140 CPS 114 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 6"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 9"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CPS-114-x0"""
    Print #fNum, String(4, Chr(9)); "END"

  ElseIf ModuleName = "140 CPU 434 12" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 5"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 283"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CPU-434-12"""
    Print #fNum, String(4, Chr(9)); "END"

  ElseIf ModuleName = "140 CHS 210 00" Or ModuleName = "140 CHS 110 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 278"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CHS-110-00"""
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 NOM 2xx 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 4"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 268"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-NOM-2xx-00"""
    Print #fNum, String(4, Chr(9)); "END"
    HeadSlot = j
    
  ElseIf ModuleName = "140 CRP 932 00" Or ModuleName = "140 CRP 931 00" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 4"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 257"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CRP-93x-00"""
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 NOE 771 00" Then
    EthernetSlot = j
    EthernetIP = GetIPCode(Cells(6 + 6 * (i - 1), 5 + j - 1).Text)
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "moduleClass = 4"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 1037"
    Print #fNum, String(5, Chr(9)); "dataLength = 7"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-NOE-771-00"""
    Print #fNum, String(5, Chr(9)); "modData = 14: 00 00 00 00 00 00 00 FF FF FF 00 00 00 00 "
    Print #fNum, String(4, Chr(9)); "END"
  
  ElseIf ModuleName = "140 CRA 21x x0" Then
    Print #fNum, String(4, Chr(9)); "BEGIN IOModule"
    Print #fNum, String(5, Chr(9)); "rack = 1"
    Print #fNum, String(5, Chr(9)); "slot = "; CStr(j)
    Print #fNum, String(5, Chr(9)); "family = 2"
    Print #fNum, String(5, Chr(9)); "personality = 265"
    Print #fNum, String(5, Chr(9)); "moduleName = ""140-CRA-21x-x0"""
    Print #fNum, String(4, Chr(9)); "END"
    HeadSlot = j
  End If
End Sub

Sub DoCfgFile()
  Load PathForm
  PathForm.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Concept"
  PathForm.CmnDlg.Filter = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (*.ccf)|*.ccf"
  PathForm.Show vbModal
  If FileNameStr <> "" Then
    Dim IsEthernet As Boolean
    IsEthernet = False
    EthernetSlot = 0
    EthernetIP = 16843009
    Open FileNameStr For Output As #1    ' Open file for output.
    Print #1, "; |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| Excel: """; ThisWorkbook.name; """ "; CStr(FormatDateTime(Now, vbLongDate)); " "; FormatDateTime(Now, vbLongTime)
    Print #1, ";"
    Print #1, "BEGIN PlcCnfDb"
    Print #1, String(1, Chr(9)); "Version = 2.16"
    Print #1,
    Print #1, String(1, Chr(9)); "BEGIN PLCConfig"
    Print #1, String(2, Chr(9)); "plcName = """; UCase(ExtractProjName(FileNameStr)); """"
    Print #1, String(2, Chr(9)); "modelName = ""QUANTUM-434 12"""
    Print #1, String(2, Chr(9)); "configTable = 0883 0000 0000 0000 0000 0600 0000 0000 0000 0001 0200 0000 0000 0000 A488 0000 "
    Print #1, String(3, Chr(9)); "4E20 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 "
    Print #1, String(3, Chr(9)); "0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 "
    Print #1, String(3, Chr(9)); "0000 0000 0000 0010 0040 0000 0000 0000 0000 0000 0020 0000 0000 0000 0000 0000 "
    Print #1, String(3, Chr(9)); "0000 0000 0000 7FEE 0002 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 "
    Print #1, String(3, Chr(9)); "0100 0001 6FEE 0000 0001 0001 6FEE 0000 0001 0001 6FEE 0000 0001 0000 0000 0000 "
    Print #1, String(3, Chr(9)); "0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 001E 0000 0001 0000 0000 "
    Print #1, String(3, Chr(9)); "0000 0000 0000 0000 0000 0000 0000 00DF 0000 0000 0000 000A 206F 0000 0001 0000 "
    Print #1, String(3, Chr(9))
    Set NOE = Range("A1:T193").Find("140 NOE 771 00", LookIn:=xlValues)
    Set CHS = Range("A1:T193").Find("140 CHS 210 00", LookIn:=xlValues)
    Set NOM = Range("A1:T193").Find("140 NOM 2xx 00", LookIn:=xlValues)
    If Not NOE Is Nothing And Not CHS Is Nothing Then
      Print #1, String(2, Chr(9)); "extCount = 2"
      Print #1, String(2, Chr(9)); "extType = 00 00 01 01 00 00 00 00 00 01 00 00 00 00 00 00 "
    ElseIf NOE Is Nothing Then
      Print #1, String(2, Chr(9)); "extCount = 1"
      Print #1, String(2, Chr(9)); "extType = 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 "
    ElseIf CHS Is Nothing Then
      Print #1, String(2, Chr(9)); "extCount = 1"
      Print #1, String(2, Chr(9)); "extType = 00 00 00 01 00 00 00 00 00 01 00 00 00 00 00 00 "
    End If

    Print #1, String(2, Chr(9)); "ioMapExpandSize = 144"
    Print #1, String(2, Chr(9)); "pcExpandSize = 100"
    Print #1, String(2, Chr(9)); "pcHealthTimeout = 01F4 01F4 01F4"
    Print #1, String(2, Chr(9)); "pcHoldLastValue = 0001 0001 0000"
    Print #1, String(2, Chr(9)); "commandReg = 10"
    Print #1, String(2, Chr(9)); "initCmdRegValue = 6"
    Print #1, String(2, Chr(9)); "nonXferAreaStart = 19900"
    Print #1, String(2, Chr(9)); "nonXferAreaLen = 100"
    Print #1, String(2, Chr(9)); "stateRAMXferCtrl = 244"
    Print #1, String(2, Chr(9)); "iecHsbFrstReg = 961"
    Print #1, String(2, Chr(9)); "iecHsbNumReg = 41160"
    If Not CHS Is Nothing Then
      Print #1, String(2, Chr(9)); "hotStdBy = 2"
    End If
    Print #1, String(2, Chr(9)); "totalExeLoadSize = 916032"
    If Not CHS Is Nothing Then
      Print #1, String(2, Chr(9)); "pcLinkSlot1 = "; CStr(CHS.Column - 4)
    ElseIf Not NOE Is Nothing Then
      Print #1, String(2, Chr(9)); "pcLinkSlot1 = "; CStr(NOE.Column - 4)
    End If
    
    Dim HeadSlot As Integer
    HeadSlot = 0
    Print #1, String(2, Chr(9)); "BEGIN DropHead"
    Print #1, String(3, Chr(9)); "headIndex = 1"
    Print #1, String(3, Chr(9)); "headType = 1"
    Set f = Range("A1:T193").Find("140 CRP 932 00", LookIn:=xlValues)
    If Not f Is Nothing Then
      Print #1, String(3, Chr(9)); "headSlot = "; CStr(f.Column - 4)
    End If
    Dim DropCount As Long
    DropCount = 0
    For i = 1 To 32
      Set DIO = Range("A" + CStr(5 + 6 * (i - 1)) + ":T" + CStr(5 + 6 * (i - 1))).Find("140 CRA 21x x0", LookIn:=xlValues)
      If Cells(4 + 6 * (i - 1), 2).Font.ColorIndex <> 15 And DIO Is Nothing Then
        DropCount = DropCount + 1
        Print #1, String(3, Chr(9)); "BEGIN IODrop"
        Print #1, String(4, Chr(9)); "dropNumber = "; CStr(DropCount)
        Print #1, String(4, Chr(9)); "dropType = 1"
        Print #1, String(4, Chr(9)); "holdUp = 4"
       
        For j = 1 To 16
          Set WorkCellMod = Cells(5 + 6 * (i - 1), 5 + j - 1)
          If Cells(4 + 6 * (i - 1), 5 + j - 1).Interior.ColorIndex <> 1 Then
            WriteModule 1, WorkCellMod.Text, i, j
          End If
        Next j
        Print #1, String(3, Chr(9)); "END"
      End If
    Next i
    Print #1, String(2, Chr(9)); "END"
    Print #1, String(2, Chr(9)); "BEGIN DropHead"
    Print #1, String(3, Chr(9)); "headIndex = 2"
    Print #1, String(3, Chr(9)); "headType = 2"
    DropCount = 0
    For i = 1 To 32
      Set DIO = Range("A" + CStr(5 + 6 * (i - 1)) + ":T" + CStr(5 + 6 * (i - 1))).Find("140 CRA 21x x0", LookIn:=xlValues)
      If Cells(4 + 6 * (i - 1), 2).Font.ColorIndex <> 15 And Not DIO Is Nothing Then
        DropCount = DropCount + 1
        Print #1, String(3, Chr(9)); "BEGIN IODrop"
        Print #1, String(4, Chr(9)); "dropNumber = "; CStr(DropCount)
        Print #1, String(4, Chr(9)); "dropType = 3"
        Print #1, String(4, Chr(9)); "holdUp = 3"
        For j = 1 To 16
          Set WorkCellMod = Cells(5 + 6 * (i - 1), 5 + j - 1)
          If Cells(4 + 6 * (i - 1), 5 + j - 1).Interior.ColorIndex <> 1 Then
            WriteModule 1, WorkCellMod.Text, i, j
          End If
        Next j
        Print #1, String(3, Chr(9)); "END"
      End If
    Next i
    Print #1, String(2, Chr(9)); "END"
    Print #1, String(2, Chr(9)); "BEGIN DropHead"
    Print #1, String(3, Chr(9)); "headIndex = 3"
    Print #1, String(3, Chr(9)); "headType = 2"
    If Not NOM Is Nothing Then
      Print #1, String(3, Chr(9)); "headSlot = "; (NOM.Column - 4)
    End If
    Print #1, String(2, Chr(9)); "END"
    Print #1, String(2, Chr(9)); "BEGIN DropHead"
    Print #1, String(3, Chr(9)); "headIndex = 4"
    Print #1, String(3, Chr(9)); "headType = 2"
    Print #1, String(2, Chr(9)); "END"
    For k = 5 To 9
      Print #1, String(2, Chr(9)); "BEGIN DropHead"
      Print #1, String(3, Chr(9)); "headIndex = "; CStr(k)
      Print #1, String(3, Chr(9)); "headType = 3"
      Print #1, String(2, Chr(9)); "END"
    Next k
    For k = 1 To 32
      If Cells(4 + 6 * (k - 1), 2).Font.ColorIndex <> 15 Then
        Print #1, String(2, Chr(9)); "BEGIN SegmSched"
        Print #1, String(3, Chr(9)); "schedIndex = "; CStr(k)
        Print #1, String(3, Chr(9)); "programSegment = "; CStr(k)
        Print #1, String(3, Chr(9)); "dropInput = "; CStr(k)
        Print #1, String(3, Chr(9)); "dropOutput = "; CStr(k)
        Print #1, String(2, Chr(9)); "END"
      Else
        Print #1, String(2, Chr(9)); "BEGIN SegmSched"
        Print #1, String(3, Chr(9)); "schedIndex = "; CStr(k)
        Print #1, String(3, Chr(9)); "typeOfSolve = 3"
        Print #1, String(3, Chr(9)); "programSegment = "; CStr(k)
        Print #1, String(2, Chr(9)); "END"
      End If
    Next k

    Print #1, String(2, Chr(9)); "BEGIN LoadedInstr"
    Print #1, String(3, Chr(9)); "fileName = ""CHS_208.DAT"""
    Print #1, String(3, Chr(9)); "majorVersion = 208"
    Print #1, String(3, Chr(9)); "minorVersion = 21526"
    Print #1, String(3, Chr(9)); "instrFamily = 1"
    Print #1, String(3, Chr(9)); "instrName = ""CHS """
    Print #1, String(3, Chr(9)); "opcode = 255"
    Print #1, String(3, Chr(9)); "groupMembership = 30"
    Print #1, String(3, Chr(9)); "placementRules = 2"
    Print #1, String(3, Chr(9)); "nodesPerElement = 3"
    Print #1, String(3, Chr(9)); "nodeParam = 0008 C008 0010"
    Print #1, String(3, Chr(9)); "maxConstant = 1FFF 1FFF 1FFF"
    Print #1, String(3, Chr(9)); "geeID = 4602"
    Print #1, String(3, Chr(9)); "menuHelpID = 518"
    Print #1, String(3, Chr(9)); "heapSize = 832"
    Print #1, String(2, Chr(9)); "END"
    Print #1, String(2, Chr(9)); "BEGIN LoadedInstr"
    Print #1, String(3, Chr(9)); "fileName = ""IHSB196.exe"""
    Print #1, String(3, Chr(9)); "majorVersion = 196"
    Print #1, String(3, Chr(9)); "instrFamily = 3"
    Print #1, String(3, Chr(9)); "instrName = ""IHSB"""
    Print #1, String(3, Chr(9)); "opcode = 251"
    Print #1, String(3, Chr(9)); "groupMembership = 30"
    Print #1, String(3, Chr(9)); "placementRules = 2"
    Print #1, String(3, Chr(9)); "nodesPerElement = 3"
    Print #1, String(3, Chr(9)); "nodeParam = 0018 C008 0010 "
    Print #1, String(3, Chr(9)); "maxConstant = FFFF FFFF 270F "
    Print #1, String(3, Chr(9)); "geeID = 4602"
    Print #1, String(3, Chr(9)); "menuHelpID = 518"
    Print #1, String(3, Chr(9)); "heapSize = 57152"
    Print #1, String(2, Chr(9)); "END"
    If Not NOE Is Nothing Then
      Print #1, String(2, Chr(9)); "BEGIN EthernetCTE"
      Print #1, String(3, Chr(9)); "index = 1"
      Print #1, String(3, Chr(9)); "ipAddress = "; CStr(EthernetIP)
      Print #1, String(3, Chr(9)); "subntMsk = -256"
      Print #1, String(3, Chr(9)); "slot = "; CStr(EthernetSlot)
      Print #1, String(3, Chr(9)); "personality = 1037"
      Print #1, String(2, Chr(9)); "END"
      EthernetSlot = 0
    End If
    Print #1, String(1, Chr(9)); "END"
    Print #1, "END"

    Close #1
  End If
End Sub

Sub ColorsActive()
 Dim S As String
 Set WorkItem = ThisWorkbook.ActiveSheet
 S = WorkItem.name
 If Not (S = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "LIST2" Or _
    S = "LIST3" Or S = "LIST4" Or S = "LIST5" Or _
    S = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or _
    S = "DI |fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or _
    S = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DO |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or S = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then Exit Sub
  
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("E6:F5000").Interior.ColorIndex = 0
  Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("E6:F2000").Interior.ColorIndex = 0
  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("B6:C505").Interior.ColorIndex = 0
  If S = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
    For i = 1 To 128
      If Cells(6 + i - 1, 11).Value <> 0 Then
        Select Case Cells(6 + i - 1, 8).Value
          Case 0
              Set c = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("I6:I5000").Find((Cells(6 + i - 1, 11).Value + 1000), LookIn:=xlValues)
              If Not c Is Nothing Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 5).Interior.ColorIndex = 38
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 6).Interior.ColorIndex = 38
              End If
          Case 1
              Set c = Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("I6:I2000").Find((Cells(6 + i - 1, 11).Value + 3000), LookIn:=xlValues)
              If Not c Is Nothing Then
                Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 5).Interior.ColorIndex = 38
                Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 6).Interior.ColorIndex = 38
              End If
          Case 2, 3, 6, 7
              Set c = Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("A6:A600").Find((Cells(6 + i - 1, 11).Value), LookIn:=xlValues)
              If Not c Is Nothing Then
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 2).Interior.ColorIndex = 38
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(c.Row, 3).Interior.ColorIndex = 38
              End If
        End Select
      End If
    Next i
  End If
End Sub

Sub ColorsAll()
  MsgBox "dsf2"
End Sub

Attribute VB_Name = "NewMod"
Option Explicit

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| \ |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Public Function GetPath(pth As String) As String
  Dim t As String
  
  GetPath = Trim$(pth)
  If Right$(GetPath, 1) <> "\" Then
    GetPath = GetPath & "\"
  End If
End Function

Public Function Addr4x(adr As Long) As String
  Addr4x = Left$("400000", 6 - Len(CStr(adr))) & CStr(adr)
End Function

Public Function Addr3x(adr As Long) As String
  Addr3x = Left$("300000", 6 - Len(CStr(adr))) & CStr(adr)
End Function

Public Function SetEndDot(msg As String) As String
  SetEndDot = Trim$(msg)
  
  If Right$(SetEndDot, 1) <> "." Then
    SetEndDot = SetEndDot & "."
  End If
End Function

Public Function IsListExist(lst As String) As Boolean
  Dim i As Long
  
  For i = 1 To Sheets.Count
    If Sheets(i).name = lst Then
      IsListExist = True
      Exit Function
    End If
  Next i
End Function

Public Function Rus2Eng(rus As String, Optional IsMute As Boolean = False, Optional ReplaceSymbol) As String
  Dim RusA, EngA, i

  RusA = Array("|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|", "|fffd|")
  EngA = Array("Y", "K", "E", "H", "X", "B", "A", "P", "P", "O", "C", "M", "T", "D")
  
  Rus2Eng = rus
  
  For i = LBound(RusA) To UBound(RusA)
    Rus2Eng = Replace$(Rus2Eng, LCase$(RusA(i)), LCase$(EngA(i)), , , vbBinaryCompare)
    Rus2Eng = Replace$(Rus2Eng, RusA(i), EngA(i), , , vbBinaryCompare)
  Next
  
  For i = 1 To Len(Rus2Eng)
    If Asc(Mid$(Rus2Eng, i, 1)) > 127 Then
      If Not IsMute Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd| ''" & Mid$(Rus2Eng, i, 1) & "'' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
      End If
      
      If Not IsMissing(ReplaceSymbol) Then
        Rus2Eng = Left$(Rus2Eng, i - 1) & Left$(CStr(ReplaceSymbol), 1) & Mid$(Rus2Eng, i + 1)
      End If
    End If
  Next i
End Function

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function GetNextCSV(csv As String) As String
  Dim i As Long
  
  Do
    i = InStr(1, csv, ",")
    
    If i > 0 Then
      GetNextCSV = Trim(Left(csv, i - 1))
      csv = Mid(csv, i + 1)
    Else
      GetNextCSV = Trim(csv)
      csv = ""
    End If
  Loop While GetNextCSV = "" And csv <> ""
End Function


Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn10, 21, 0, MSForms, CommandButton"

Public Sub RefreshCBtn10_Click()
  For i = 1 To 16
    Cells(6 + 65 * (i - 1), 1).FormulaR1C1 = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Text
    If Cells(6 + 65 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 65 * (i - 1)) + ":AJ" + CStr(69 + 65 * (i - 1))).Font.ColorIndex = _
      Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
      Range("A" + CStr(70 + 65 * (i - 1)) + ":C" + CStr(70 + 65 * (i - 1))).Font.ColorIndex = 15
      Range("X" + CStr(70 + 65 * (i - 1)) + ":AJ" + CStr(70 + 65 * (i - 1))).Font.ColorIndex = 15
    End If
  Next i
  For i = 1 To 1040
    If Cells(6 + i - 1, 30).Value = 0 Then
      Cells(6 + i - 1, 2).FormulaR1C1 = ""
    End If
  Next i
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 38 And Target.Row > 5 And Target.Row < 1046 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn11, 25, 0, MSForms, CommandButton"

Public Sub RefreshCBtn11_Click()
  For i = 1 To 160
    If Cells(6 + i - 1, 30).Value = 0 Then
      Cells(6 + i - 1, 2).FormulaR1C1 = ""
    End If
  Next i
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 38 And Target.Row > 5 And Target.Row < 517 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn12, 17, 0, MSForms, CommandButton"

Public Sub RefreshCBtn12_Click()
  For i = 1 To 512
    If Cells(6 + i - 1, 14).Value = 0 Then
      Cells(6 + i - 1, 2).FormulaR1C1 = ""
    End If
  Next i
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 38 And Target.Row > 5 And Target.Row < 518 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn14, 10, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 16
    If Cells(6 + 5 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 5 * (i - 1)) + ":P" + CStr(10 + 5 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub
Public Sub RefreshCBtn14_Click()
  For i = 1 To 80
    If Cells(6 + i - 1, 9).Value = 0 Then
      Select Case ((6 + i - 1) Mod 5)
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "MBC"
        Case 2
          Cells(6 + i - 1, 3).FormulaR1C1 = "MBO"
        Case 3
          Cells(6 + i - 1, 3).FormulaR1C1 = "ECx02"
        Case 4
          Cells(6 + i - 1, 3).FormulaR1C1 = "ECx03"
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "|fffd||fffd||fffd||fffd||fffd|"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Public Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 9 And Target.Row > 5 And Target.Row < 86 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 3).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub Worksheet_Activate()
  For i = 1 To 16
    If Cells(6 + i - 1, 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + i - 1) + ":S" + CStr(6 + i - 1)).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 45, 0, MSForms, CommandButton"
Attribute VB_Control = "RefreshCBtn19, 30, 1, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 500
    If Cells(6 + 8 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 8 * (i - 1)) + ":S" + CStr(13 + 8 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub CommandButton1_Click()
  For i = 1 To 500
    Cells(6 + 8 * (i - 1), 1).Formula = "='|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'!$A$" & CInt(6 + i - 1)
  Next i
End Sub

Public Sub RefreshCBtn19_Click()
    
  'Load PForm
  'PForm.Show vbModeless
  'PForm.ProgressBar.Visible = True
  'PForm.ProgressBar.Min = 0
  'PForm.ProgressBar.Max = 1200
  'PForm.LblProc.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| DI_ZD."

  For i = 1 To 1200
    If Cells(6 + i - 1, 9).Value = 0 Then
      Select Case ((8 + i - 1) Mod 8)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "KBO"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "KBZ"
        Case 2
          Cells(6 + i - 1, 3).FormulaR1C1 = "MPO"
        Case 3
          Cells(6 + i - 1, 3).FormulaR1C1 = "MPZ"
        Case 4
          Cells(6 + i - 1, 3).FormulaR1C1 = "Dist"
        Case 5
          Cells(6 + i - 1, 3).FormulaR1C1 = "Volt"
        Case 6
          Cells(6 + i - 1, 3).FormulaR1C1 = "OMC"
        Case 7
          Cells(6 + i - 1, 3).FormulaR1C1 = "CMC"

      End Select
    End If
    'PForm.ProgressBar.Value = PForm.ProgressBar.Value + 1
  Next i
  CellsColoring
  
  'Unload PForm
  MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbInformation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 9 And Target.Row > 5 And Target.Row < 3997 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 3).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn20, 25, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 128
    If Cells(6 + 3 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 3 * (i - 1)) + ":P" + CStr(8 + 3 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Public Sub RefreshCBtn20_Click()
  For i = 1 To 384
    If Cells(6 + i - 1, 9).Value = 0 Then
      Select Case ((6 + i - 1) Mod 3)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "EC"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "MPC"
        Case 2
          Cells(6 + i - 1, 3).FormulaR1C1 = "PC"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 9 And Target.Row > 5 And Target.Row < 389 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Refresh|fffd|Btn23, 17, 1, MSForms, CommandButton"

Public Sub Refresh|fffd|Btn23_Click()
  For i = 1 To 128
    For j = 1 To 128
      If Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + j - 1, 11).Value = i Then
        Range("A" + CStr(i + 5) + ":S" + CStr(i + 5)).Font.ColorIndex = 0
        Exit For
      End If
    Next j
    If j = 129 Then
      Range("A" + CStr(i + 5) + ":S" + CStr(i + 5)).Font.ColorIndex = 15
    End If
  Next i
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn24, 17, 0, MSForms, CommandButton"
Public Sub RefreshCBtn24_Click()
  For i = 1 To 128
    If Cells(6 + i - 1, 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + i - 1) + ":T" + CStr(6 + i - 1)).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  RefreshCBtn24_Click
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
  If ModuleServ.DoSelection Then
    Dim V As Long
    If ModuleServ.SignType = snDI Then
      If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 1 And _
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value + 3000
      End If
      Set c = Range("I6:I5000").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
    End If
  End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If ModuleServ.DoSelection And Target.Column = 9 Then
    ModuleServ.DoSelection = False
    Dim val As Long
    If ModuleServ.SignType = snDI Then
      val = Target.Value - 3000
    End If
    Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).FormulaR1C1 = val
    If ModuleServ.Listname = "LIST2" Or ModuleServ.Listname = "LIST3" Or ModuleServ.Listname = "LIST4" Or ModuleServ.Listname = "LIST5" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 2).FormulaR1C1 = Cells(Target.Row, 5).Text
'----------------------------------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| 3 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 05.04.2011
'----------------------------------------------------------------------------------
      If ModuleServ.Listname = "LIST3" Then
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 6).Text
      End If
'----------------------------------------------------------------------------------
    
    Else
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 5).Text
    End If
    If ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 38
      Cells(Target.Row, 6).Interior.ColorIndex = 38
    ElseIf ModuleServ.Listname = "LIST2" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 40
      Cells(Target.Row, 6).Interior.ColorIndex = 40
    ElseIf ModuleServ.Listname = "LIST3" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 43
      Cells(Target.Row, 6).Interior.ColorIndex = 43
    ElseIf ModuleServ.Listname = "LIST4" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 35
      Cells(Target.Row, 6).Interior.ColorIndex = 35
    ElseIf ModuleServ.Listname = "LIST5" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 34
      Cells(Target.Row, 6).Interior.ColorIndex = 34
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 37
      Cells(Target.Row, 6).Interior.ColorIndex = 37
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 39
      Cells(Target.Row, 6).Interior.ColorIndex = 39
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 44
      Cells(Target.Row, 6).Interior.ColorIndex = 44
    ElseIf ModuleServ.Listname = "DI |fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 7
      Cells(Target.Row, 6).Interior.ColorIndex = 7
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 4
      Cells(Target.Row, 6).Interior.ColorIndex = 4
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 8
      Cells(Target.Row, 6).Interior.ColorIndex = 8
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 33
      Cells(Target.Row, 6).Interior.ColorIndex = 33
    ElseIf ModuleServ.Listname = "DO |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 54
      Cells(Target.Row, 6).Interior.ColorIndex = 54
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 36
      Cells(Target.Row, 6).Interior.ColorIndex = 36
    End If
    
    ModuleServ.SignType = 0
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
    Worksheets(ModuleServ.Listname).Activate
    Cancel = True
  End If
End Sub

Private Sub Worksheet_Deactivate()
  If ModuleServ.DoSelection Then
    ModuleServ.DoSelection = False
    ModuleServ.SignType = 0
    ModuleServ.Listname = ""
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
  If ModuleServ.DoSelection And ModuleServ.SignType = snAIm Then
    Dim V As Long
    If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 1).Value = 1 And _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
      V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value + 400000
    End If
    Set c = Range("G6:G2000").Find(V, LookIn:=xlValues)
    If Not c Is Nothing Then c.Select
  End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If ModuleServ.DoSelection And ModuleServ.SignType = snAIm And Target.Column = 7 Then
    ModuleServ.DoSelection = False
    Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).FormulaR1C1 = Target.Value
    If ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 2).FormulaR1C1 = Cells(Target.Row, 5).Text
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 6).Text

    End If
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
    Worksheets(ModuleServ.Listname).Activate
    Cancel = True
  End If
End Sub

Private Sub Worksheet_Deactivate()
  If ModuleServ.DoSelection Then
    ModuleServ.DoSelection = False
    ModuleServ.SignType = 0
    ModuleServ.Listname = ""
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn29, 9, 0, MSForms, CommandButton"
Public Sub RefreshCBtn29_Click()
  For i = 1 To 128
    If Cells(6 + i - 1, 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + i - 1) + ":T" + CStr(6 + i - 1)).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  RefreshCBtn29_Click
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn31, 1, 0, MSForms, CommandButton"
Public Sub RefreshCBtn31_Click()
  For i = 1 To 32
    Set WRange = Range("A" + CStr(6 + i - 1) + ":T" + CStr(6 + i - 1))
    If Cells(6 + i - 1, 11).Value < 1 Or Cells(6 + i - 1, 11).Text = "" Then
      WRange.Font.ColorIndex = 15
    Else
      WRange.Font.ColorIndex = 0
      Cells(6 + i - 1, 1).FormulaR1C1 = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + Cells(6 + i - 1, 11).Value - 1, 1).Text
    End If
  Next i
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn32, 12, 0, MSForms, CommandButton"
Public Sub RefreshCBtn32_Click()
  For i = 1 To 128
    If Cells(6 + i - 1, 11).Value = 0 Then
      Cells(6 + i - 1, 3).FormulaR1C1 = ""
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  If ModuleServ.DoSelection Then
    Dim V As Long
    If ModuleServ.SignType = snGrp Then
      If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 5 And _
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value
      End If
      Set c = Range("A6:A165").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
    End If
  End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If ModuleServ.DoSelection And Target.Column = 1 And ModuleServ.SignType = snGrp Then
    ModuleServ.DoSelection = False
    Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).FormulaR1C1 = Target.Value
    If ModuleServ.Listname = "LIST2" Or ModuleServ.Listname = "LIST3" Or ModuleServ.Listname = "LIST4" Or ModuleServ.Listname = "LIST5" Then
'      If Cells(Target.Row, 3).Text <> "" And Cells(Target.Row + 1, 3).Text <> "" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 2).FormulaR1C1 = Cells(Target.Row, 3).Text + ", " + Cells(Target.Row + 1, 3).Text + ", " + Cells(Target.Row + 2, 3).Text + ", " + Cells(Target.Row + 3, 3).Text
'      End If
    Else
'      If Cells(Target.Row, 3).Text <> "" And Cells(Target.Row + 1, 3).Text <> "" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 3).Text + ", " + Cells(Target.Row + 1, 3).Text + ", " + Cells(Target.Row + 2, 3).Text + ", " + Cells(Target.Row + 3, 3).Text
'      End If
    End If
    If ActiveSheet.name = ModuleServ.Listname Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Select
    End If
    ModuleServ.SignType = 0
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
    Worksheets(ModuleServ.Listname).Activate
    Cancel = True
  End If
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 11 And Target.Row > 5 And Target.Row < 134 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
    End Select
    Cancel = True
  End If
  If ModuleServ.DoSelection And ModuleServ.SignType = snGrp Then
    Dim V As Long
    If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 3).Value = 5 And _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
      V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value
    End If
    Set c = Range("A6:A500").Find(V, LookIn:=xlValues)
    If Not c Is Nothing Then c.Select
  End If
End Sub

Private Sub Worksheet_Deactivate()
  If ModuleServ.DoSelection And ModuleServ.SignType = snGrp Then
    ModuleServ.DoSelection = False
    ModuleServ.SignType = 0
    ModuleServ.Listname = ""
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn33, 6, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 16
    If Cells(6 + 2 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 2 * (i - 1)) + ":G" + CStr(7 + 2 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Public Sub RefreshCBtn33_Click()
  For i = 1 To 40
    If Cells(6 + i - 1, 6).Value = 0 Then
      Select Case ((6 + i - 1) Mod 2)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABB"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABO"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 6 And Target.Row > 5 And Target.Row < 46 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    ModuleServ.SignType = snDO
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 12, 0, MSForms, CommandButton"
Attribute VB_Control = "RefreshCBtn37, 11, 1, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 500
    If Cells(6 + 4 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 4 * (i - 1)) + ":G" + CStr(9 + 4 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub CommandButton1_Click()
  For i = 1 To 500
    Cells(6 + 4 * (i - 1), 1).Formula = "='|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'!$A$" & CInt(6 + i - 1)
  Next i
End Sub

Public Sub RefreshCBtn37_Click()
  For i = 1 To 856
    If Cells(6 + i - 1, 6).Value = 0 Then
      Select Case ((6 + i - 1) Mod 4)
        Case 2
          Cells(6 + i - 1, 3).FormulaR1C1 = "DOB"
        Case 3
          Cells(6 + i - 1, 3).FormulaR1C1 = "DKB"
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "DCBO"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "DCBZ"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 6 And Target.Row > 5 And Target.Row < 2001 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    ModuleServ.SignType = snDO
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn38, 10, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 128
    If Cells(6 + 2 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 2 * (i - 1)) + ":G" + CStr(7 + 2 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Public Sub RefreshCBtn38_Click()
  For i = 1 To 284
    If Cells(6 + i - 1, 6).Value = 0 Then
      Select Case ((6 + i - 1) Mod 2)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABB"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABO"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 6 And Target.Row > 5 And Target.Row < 290 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    ModuleServ.SignType = snDO
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn39, 10, 0, MSForms, CommandButton"

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 6 And Target.Row > 5 And Target.Row < 134 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    ModuleServ.SignType = snDO
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cancel = True
  End If
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn40, 21, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 64
    If Cells(6 + 2 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 2 * (i - 1)) + ":P" + CStr(7 + 2 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Public Sub RefreshCBtn40_Click()
  For i = 1 To 128
    If Cells(6 + i - 1, 9).Value = 0 Then
      Select Case ((6 + i - 1) Mod 2)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "MBC"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "MBO"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 9 And Target.Row > 5 And Target.Row < 134 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 3).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn41, 9, 0, MSForms, CommandButton"
Private Sub CellsColoring()
  For i = 1 To 64
    If Cells(6 + 2 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 2 * (i - 1)) + ":G" + CStr(7 + 2 * (i - 1))).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Public Sub RefreshCBtn41_Click()
  For i = 1 To 128
    If Cells(6 + i - 1, 6).Value = 0 Then
      Select Case ((6 + i - 1) Mod 2)
        Case 0
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABB"
        Case 1
          Cells(6 + i - 1, 3).FormulaR1C1 = "ABO"
      End Select
    End If
  Next i
  CellsColoring
End Sub

Private Sub Worksheet_Activate()
  CellsColoring
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 6 And Target.Row > 5 And Target.Row < 134 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    ModuleServ.SignType = snDO
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn43, 16, 1, MSForms, CommandButton"
Public Sub RefreshCBtn43_Click()
  For i = 1 To 200
    If Cells(6 + i - 1, 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + i - 1) + ":T" + CStr(6 + i - 1)).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  RefreshCBtn43_Click
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|44"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn44, 14, 1, MSForms, CommandButton"
Public Sub RefreshCBtn44_Click()
  For i = 1 To 16
    If Cells(6 + i - 1, 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + i - 1) + ":T" + CStr(6 + i - 1)).Font.ColorIndex = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  RefreshCBtn44_Click
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "VSMadeBut, 1, 0, MSForms, CommandButton"
Public CalcDone As Boolean

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub VSMadeBut_Click()
  Do While j < 128
    For k = 1 To 5
       If ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j + 6, 1).Font.ColorIndex = 15 Or ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j + 6, 17).Value = 0 Then
         Cells(7 + i, k).Font.ColorIndex = 15
         Cells(7 + i + 1, k).Font.ColorIndex = 15
       Else
         Cells(7 + i, k).Font.ColorIndex = 1
         Cells(7 + i + 1, k).Font.ColorIndex = 1
       End If
    Next k
     Cells(7 + i, 3).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j + 6, 1).Text & " |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
     Cells(8 + i, 3).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(j + 6, 1).Text & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
     i = i + 2
     j = j + 1
  Loop
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|47"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|48"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|49"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RackButton, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "RefreshCBtn45, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "CBox, 1, 2, MSForms, ComboBox"
Public CalcDone As Boolean
Private Sub CBox_Change()
  If CBox.Visible Then
    Selection.FormulaR1C1 = CBox.Text
    CBox.Visible = False
  End If
End Sub

Private Sub CBox_LostFocus()
  CBox.Visible = False
End Sub


' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
Private Sub RackButton_Click()
Dim NumRack As String
Dim IntRack As Integer
  For i = 1 To 32
    For j = 1 To 16
     NumRack = Cells(4 + (i - 1) * 6, 4)
     IntRack = val(Right(NumRack, 1))
     Cells(4 + (i - 1) * 6, 4 + j).Value = "A" & IntRack & "." & j
    Next j
  Next i
End Sub

Public Sub RefreshCBtn45_Click()
  Dim BegAICnt As Long
  Dim BegDICnt As Long
  Dim BegDOCnt As Long
  Dim BegAOCnt As Long
  CBox.Visible = False
  BegAICnt = 300000 + ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(2, 10).Value - 1
  BegDICnt = 300000 + ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(4, 10).Value - 1
  BegDOCnt = 400000 + ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(47, 7).Value - 1
  BegAOCnt = 400000 + ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(49, 7).Value - 1
  For i = 1 To 32
    If Cells(4 + 6 * (i - 1), 2).Font.ColorIndex <> 15 Then
      For j = 1 To 16
        If Cells(4 + 6 * (i - 1), 5 + j - 1).Font.ColorIndex <> 15 And _
          Cells(4 + 6 * (i - 1), 5 + j - 1).Font.ColorIndex <> 2 Then
          
          If Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACI 040 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 16
            BegAICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
          
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACI 030 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 8
            BegAICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1

          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 AII 330 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 9
            BegAICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
            
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ARI 030 10" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 8
            BegAICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
            
            
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 AVI 030 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 8
            BegAICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
            
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DDI 353 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegDICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 1
            BegDICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
          
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DII 330 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegDICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value
            BegDICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
          
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DAI 740 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegDICnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value
            BegDICnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1

          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DDO 353 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegDOCnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 1
            BegDOCnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
            
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACO 020 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = BegAOCnt + 1
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = Cells(6 + 6 * (i - 1), 5 + j - 1).Value + 3
            BegAOCnt = Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1
            
          ElseIf Cells(5 + 6 * (i - 1), 5 + j - 1).Text <> "140 NOE 771 00" Then
            Cells(6 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = ""
            Cells(7 + 6 * (i - 1), 5 + j - 1).FormulaR1C1 = ""
          End If
        End If
      Next j
    End If
    DoEvents
  Next i
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If Selection.Row < 195 And (Selection.Row Mod 6 = 5) And Selection.Column > 4 And Selection.Column < 21 Then
    If CBox.ListCount = 0 Then
      CBox.Clear
      CBox.AddItem "140 AII 330 00"
      CBox.AddItem "140 ACI 030 00"
      CBox.AddItem "140 ACI 040 00"
      CBox.AddItem "140 ARI 030 10"
      CBox.AddItem "140 AVI 030 00"
      CBox.AddItem "140 ACO 020 00"
      CBox.AddItem "140 DII 330 00"
      CBox.AddItem "140 DAI 740 00"
      CBox.AddItem "140 DDI 353 00"
      CBox.AddItem "140 DDO 353 00"
      CBox.AddItem "140 CPS 114 10"
      CBox.AddItem "140 CPS 124 10"
      CBox.AddItem "140 CPS 114 20"
      CBox.AddItem "140 CPU 113 02"
      CBox.AddItem "140 CPU 113 03"
      CBox.AddItem "140 CPU 311 10"
      CBox.AddItem "140 CPU 434 12"
      CBox.AddItem "140 CPU 534 14"
      CBox.AddItem "140 CPU 651 50"
      CBox.AddItem "140 CPU 651 60"
      CBox.AddItem "140 CPU 652 60"
      CBox.AddItem "140 CPU 671 60"
      CBox.AddItem "140 CHS 210 00"
      CBox.AddItem "140 NOM 2xx 00"
      CBox.AddItem "140 CRP 932 00"
      CBox.AddItem "140 CRA 932 00"
      CBox.AddItem "140 CRA 21x x0"
      CBox.AddItem "140 NOE 771 00"
      CBox.AddItem "140 XCP 510 00"
      
    End If
    CBox.Text = Selection.Text
    CBox.Left = Selection.Left
    CBox.Top = Selection.Top
    CBox.Visible = True
    Cancel = True
  End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  If CBox.Visible Then CBox.Visible = False
End Sub




Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|50"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 3, 0, MSForms, CommandButton"
Attribute VB_Control = "CmdBtnGenerate, 2, 1, MSForms, CommandButton"
Private Sub DrawBorders(WRange As Range, OneCol As Boolean, OneRow As Boolean)
  With WRange.Borders(xlEdgeLeft)
      .LineStyle = xlContinuous
      .Weight = xlMedium
      .ColorIndex = xlAutomatic
  End With
  With WRange.Borders(xlEdgeTop)
      .LineStyle = xlContinuous
      .Weight = xlMedium
      .ColorIndex = xlAutomatic
  End With
  With WRange.Borders(xlEdgeBottom)
      .LineStyle = xlContinuous
      .Weight = xlMedium
      .ColorIndex = xlAutomatic
  End With
  With WRange.Borders(xlEdgeRight)
      .LineStyle = xlContinuous
      .Weight = xlMedium
      .ColorIndex = xlAutomatic
  End With
  If Not OneCol Then
    With WRange.Borders(xlInsideVertical)
      .LineStyle = xlContinuous
      .Weight = xlThin
      .ColorIndex = xlAutomatic
    End With
  Else
    WRange.Borders(xlInsideVertical).LineStyle = xlNone
  End If
  If Not OneRow Then
    With WRange.Borders(xlInsideHorizontal)
      .LineStyle = xlContinuous
      .Weight = xlThin
      .ColorIndex = xlAutomatic
    End With
  Else
    WRange.Borders(xlInsideHorizontal).LineStyle = xlNone
  End If
End Sub
Private Sub DrawAIGrid(BegRow As Integer, SignCnt As Integer, USOColor As Integer, ModuleColor As Integer, _
                       USOText As String, USOModuleName As String, BegAddr As Long, BegSignNum As Long)
    Dim WRange As Range
    Set WRange = Range("A" + CStr(BegRow) + ":I" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    WRange.Borders(xlEdgeLeft).LineStyle = xlNone
    WRange.Borders(xlEdgeTop).LineStyle = xlNone
    WRange.Borders(xlEdgeBottom).LineStyle = xlNone
    WRange.Borders(xlEdgeRight).LineStyle = xlNone
    WRange.Borders(xlInsideVertical).LineStyle = xlNone
    WRange.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Set WRange = Range("A" + CStr(BegRow) + ":I" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, False, False
    
    Set WRange = Range("A" + CStr(BegRow) + ":A" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, True
    
    Set WRange = Range("A" + CStr(BegRow) + ":A" + CStr(BegRow + 3))
    With WRange
      .Merge
      .Font.Bold = True
      .Orientation = 90
    End With
    With WRange.Interior
        .ColorIndex = USOColor
        .Pattern = xlSolid
    End With
    WRange.FormulaR1C1 = USOText
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    
    Set WRange = Range("B" + CStr(BegRow) + ":B" + CStr(BegRow + SignCnt - 1))
    With WRange
      .Merge
      .FormulaR1C1 = "AI"
      .Font.Bold = True
      .Orientation = 90
    End With
    
    Set WRange = Range("C" + CStr(BegRow) + ":C" + CStr(BegRow + SignCnt - 1))
    With WRange
      .Merge
      .FormulaR1C1 = USOModuleName
      .Orientation = 90
    End With
    With ActiveCell.Characters(Start:=1, Length:=6).Font
      .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    With WRange.Interior
        .ColorIndex = ModuleColor
        .Pattern = xlSolid
    End With
    
    Set WRange = Range("D" + CStr(BegRow) + ":D" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    For i = 1 To SignCnt
      Cells(BegRow + i - 1, 4).FormulaR1C1 = i
      Cells(BegRow + i - 1, 7).FormulaR1C1 = BegAddr + i - 1
'      Cells(BegRow + i - 1, 8).FormulaR1C1 = i - 1
      Cells(BegRow + i - 1, 9).FormulaR1C1 = BegSignNum + i - 1
    Next i
End Sub

Private Sub DrawDIDOGrid(BegRow As Integer, SignCnt As Integer, USOColor As Integer, ModuleColor As Integer, DIDO As String, _
                       USOText As String, USOModuleName As String, BegAddr As Long, BegSignNum As Long)
    Dim WRange As Range
    Set WRange = Range("A" + CStr(BegRow) + ":I" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    WRange.Borders(xlEdgeLeft).LineStyle = xlNone
    WRange.Borders(xlEdgeTop).LineStyle = xlNone
    WRange.Borders(xlEdgeBottom).LineStyle = xlNone
    WRange.Borders(xlEdgeRight).LineStyle = xlNone
    WRange.Borders(xlInsideVertical).LineStyle = xlNone
    WRange.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    Set WRange = Range("A" + CStr(BegRow) + ":I" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, False, False
    If SignCnt = 32 Then
      Set WRange = Range("A" + CStr(BegRow) + ":I" + CStr(BegRow + (SignCnt / 2) - 1))
      WRange.Borders(xlDiagonalDown).LineStyle = xlNone
      WRange.Borders(xlDiagonalUp).LineStyle = xlNone
      DrawBorders WRange, False, False
    End If
    
    Set WRange = Range("A" + CStr(BegRow) + ":A" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, True
    
    Set WRange = Range("A" + CStr(BegRow) + ":A" + CStr(BegRow + 3))
    With WRange
      .Merge
      .Font.Bold = True
      .Orientation = 90
    End With
    With WRange.Interior
        .ColorIndex = USOColor
        .Pattern = xlSolid
    End With
    WRange.FormulaR1C1 = USOText
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    
    Set WRange = Range("B" + CStr(BegRow) + ":B" + CStr(BegRow + SignCnt - 1))
    With WRange
      .Merge
      .FormulaR1C1 = DIDO
      .Font.Bold = True
      .Orientation = 90
    End With
    
    Set WRange = Range("C" + CStr(BegRow) + ":C" + CStr(BegRow + SignCnt - 1))
    With WRange
      .Merge
      .FormulaR1C1 = USOModuleName
      .Orientation = 90
    End With
    With ActiveCell.Characters(Start:=1, Length:=6).Font
      .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    With WRange.Interior
        .ColorIndex = ModuleColor
        .Pattern = xlSolid
    End With
    
    Set WRange = Range("D" + CStr(BegRow) + ":D" + CStr(BegRow + SignCnt - 1))
    WRange.Borders(xlDiagonalDown).LineStyle = xlNone
    WRange.Borders(xlDiagonalUp).LineStyle = xlNone
    DrawBorders WRange, True, False
    
    If SignCnt = 32 Then
      Set WRange = Range("G" + CStr(BegRow) + ":G" + CStr(BegRow + (SignCnt / 2) - 1))
      WRange.Merge
      WRange.FormulaR1C1 = BegAddr
      Set WRange = Range("G" + CStr(BegRow + (SignCnt / 2)) + ":G" + CStr(BegRow + SignCnt - 1))
      WRange.Merge
      WRange.FormulaR1C1 = BegAddr + 1
    Else
      Set WRange = Range("G" + CStr(BegRow) + ":G" + CStr(BegRow + SignCnt - 1))
      WRange.Merge
      WRange.FormulaR1C1 = BegAddr
    End If
    For i = 1 To SignCnt
      Cells(BegRow + i - 1, 4).FormulaR1C1 = i
      Cells(BegRow + i - 1, 8).FormulaR1C1 = 16 - i + ((i - 1) \ 16) * 16
      Cells(BegRow + i - 1, 9).FormulaR1C1 = BegSignNum + i - 1
    Next i
End Sub

Private Sub CmdBtnGenerate_Click()
  Dim BegRowCnt As Integer
  Dim BegAICnt As Long
  Dim BegDICnt As Long
  Dim BegDOCnt As Long
  Dim BegAOCnt As Long
  Dim USOClr As Integer
  Dim PrevUSOName As String
  
  If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!!" + _
            Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNoCancel Or vbExclamation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbYes Then
    Set WRange = Rows("6:16400")
'    Range("D6").Activate
    WRange.Delete Shift:=xlUp
'    Range("A6").Select
    
    Set WorkItem = ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
    BegRowCnt = 6
    BegAICnt = 1
    BegDICnt = 1001
    BegDOCnt = 2001
    BegAOCnt = 3001
    USOClr = 36
    PrevUSOName = ""
    For i = 1 To 32
      If WorkItem.Cells(4 + 6 * (i - 1), 2).Font.ColorIndex <> 15 Then
        If WorkItem.Cells(4 + 6 * (i - 1), 2).Text <> PrevUSOName Then USOClr = USOClr + 1
        For j = 1 To 16
          If WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Font.ColorIndex <> 15 And _
             WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Font.ColorIndex <> 2 And _
             WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Interior.ColorIndex <> 1 Then
            If WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACI 040 00" Then
              DrawAIGrid BegRowCnt, 16, USOClr, 50, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 ACI 040 00)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAICnt
              BegRowCnt = BegRowCnt + 16
              BegAICnt = BegAICnt + 16
              
             ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACI 030 00" Then
              DrawAIGrid BegRowCnt, 8, USOClr, 50, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 ACI 030 00)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAICnt
              BegRowCnt = BegRowCnt + 8
              BegAICnt = BegAICnt + 8
              
             ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ARI 030 10" Then
              DrawAIGrid BegRowCnt, 8, USOClr, 50, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 ARI 030 10)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAICnt
              BegRowCnt = BegRowCnt + 8
              BegAICnt = BegAICnt + 8
              
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 AVI 030 00" Then
              DrawAIGrid BegRowCnt, 8, USOClr, 50, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 AVI 030 00)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAICnt
              BegRowCnt = BegRowCnt + 8
              BegAICnt = BegAICnt + 8
              
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 AII 330 00" Then
              DrawAIGrid BegRowCnt, 8, USOClr, 50, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 AII 330 00)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAICnt
              BegRowCnt = BegRowCnt + 8
              BegAICnt = BegAICnt + 8
              
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DDI 353 00" Then
              DrawDIDOGrid BegRowCnt, 32, USOClr, 47, _
                           "DI", _
                           WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                           WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 DDI 353 00)", _
                           WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                           BegDICnt
              BegRowCnt = BegRowCnt + 32
              BegDICnt = BegDICnt + 32
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DAI 740 00" Then
              DrawDIDOGrid BegRowCnt, 16, USOClr, 47, _
                           "DI", _
                           WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                           WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 DAI 740 00)", _
                           WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                           BegDICnt
              BegRowCnt = BegRowCnt + 16
              BegDICnt = BegDICnt + 16
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DII 330 00" Then
              DrawDIDOGrid BegRowCnt, 16, USOClr, 47, _
                           "DI", _
                           WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                           WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 DII 330 00)", _
                           WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                           BegDICnt
              BegRowCnt = BegRowCnt + 16
              BegDICnt = BegDICnt + 16
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 DDO 353 00" Then
              DrawDIDOGrid BegRowCnt, 32, USOClr, 37, _
                           "DO", _
                           WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                           WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 DDO 353 00)", _
                           WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                           BegDOCnt
              BegRowCnt = BegRowCnt + 32
              BegDOCnt = BegDOCnt + 32
            ElseIf WorkItem.Cells(5 + 6 * (i - 1), 5 + j - 1).Text = "140 ACO 020 00" Then
              DrawAIGrid BegRowCnt, 4, USOClr, 4, _
                         WorkItem.Cells(4 + 6 * (i - 1), 2).Text, _
                         WorkItem.Cells(4 + 6 * (i - 1), 5 + j - 1).Text + "  (140 ACI 040 00)", _
                         WorkItem.Cells(6 + 6 * (i - 1), 5 + j - 1).Value, _
                         BegAOCnt
              BegRowCnt = BegRowCnt + 4
              BegAOCnt = BegAOCnt + 4
            End If
          End If
        Next j
        PrevUSOName = WorkItem.Cells(4 + 6 * (i - 1), 2).Text
      End If
    Next i
  End If
End Sub

Private Sub CommandButton1_Click()
  Dim t As String, t1 As String, i As Long, j As Long
  Dim WorkItem As Object
  
  Set WorkItem = ThisWorkbook.Sheets.Item("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
  j = 0
  For i = 1 To 2000
    t = WorkItem.Cells(6 + i - 1, 5).Text
    t1 = Rus2Eng(t)
    If t <> t1 Then
      j = j + 1
      WorkItem.Cells(6 + i - 1, 5).FormulaR1C1 = t1
    End If
  Next i
  MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! " & IIf(j <> 0, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & CStr(j) & " |fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.")
End Sub


Private Sub Worksheet_Activate()
  If ModuleServ.DoSelection Then
    Dim V As Long
    If ModuleServ.SignType = snDI Then
      If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 3).Value = 0 And _
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value + 1000
      End If
      Set c = Range("I6:I5000").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
    ElseIf ModuleServ.SignType = snDO Then
      If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value + 5000
      End If
      Set c = Range("I6:I5000").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
    ElseIf ModuleServ.SignType = snAIm Then
      If Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 1).Value = 0 And _
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value + 300000
      End If
      Set c = Range("G6:G5000").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
'    ElseIf ModuleServ.SignType = snAO Then
    End If
  End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If ModuleServ.DoSelection And _
     ((ModuleServ.SignType = snAIm And Target.Column = 7) Or _
      (ModuleServ.SignType = snDI And Target.Column = 9) Or _
      (ModuleServ.SignType = snDO And Target.Column = 9)) Then
    Dim val As Long
    val = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value
    Dim StrMsg As String
    StrMsg = ""
    If ModuleServ.SignType = snDI And Target.Column = 9 Then
      If Target.Value > 1000 And Target.Value <= 5000 Then
        val = Target.Value - 1000
      ElseIf Target.Value <= 1000 Then
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (1001-2000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      ElseIf Target.Value > 5000 And Target.Value <= 7000 Then
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (1001-2000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      Else
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (1001-2000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      End If
    ElseIf ModuleServ.SignType = snDO And Target.Column = 9 Then
      If Target.Value > 1000 And Target.Value <= 5000 Then
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (2001-3000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      ElseIf Target.Value <= 1000 Then
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (2001-3000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      ElseIf Target.Value > 5000 And Target.Value <= 7000 Then
        val = Target.Value - 5000
      Else
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (2001-3000)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      End If
    
    ElseIf ModuleServ.SignType = snAIm And Target.Column = 7 Then
      If Cells(Target.Row, Target.Column).Value < 300500 Then
        val = Cells(Target.Row, Target.Column).Value - 300000
      Else
        StrMsg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|." + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (300001-300499)" _
         + Chr(13) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
      End If
'    ElseIf ModuleServ.SignType = snAO Then
    End If
    If StrMsg <> "" Then
      If MsgBox(StrMsg, vbYesNo Or vbExclamation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!") = vbYes Then
        Cancel = True
        Exit Sub
      End If
    End If
    ModuleServ.DoSelection = False
    Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).FormulaR1C1 = val
    If ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 1).FormulaR1C1 = Cells(Target.Row, 6).Text + CStr(AddInt)
    End If
    If ModuleServ.Listname = "LIST2" Or ModuleServ.Listname = "LIST3" Or ModuleServ.Listname = "LIST4" Or ModuleServ.Listname = "LIST5" Or ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 2).FormulaR1C1 = Cells(Target.Row, 5).Text + CStr(AddInt)
'----------------------------------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| 3 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 05.04.2011
'----------------------------------------------------------------------------------
      If ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 6).Text + CStr(AddInt)
      End If
'----------------------------------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 05.04.2011
'----------------------------------------------------------------------------------
      If ModuleServ.Listname = "LIST5" Then
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 6).Text + CStr(AddInt)
      End If
'----------------------------------------------------------------------------------
    
    
    Else
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 5).Text + CStr(AddInt)
    End If
    If ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 38
      Cells(Target.Row, 6).Interior.ColorIndex = 38
    ElseIf ModuleServ.Listname = "LIST2" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 40
      Cells(Target.Row, 6).Interior.ColorIndex = 40
    ElseIf ModuleServ.Listname = "LIST3" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 43
      Cells(Target.Row, 6).Interior.ColorIndex = 43
    ElseIf ModuleServ.Listname = "LIST4" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 35
      Cells(Target.Row, 6).Interior.ColorIndex = 35
    ElseIf ModuleServ.Listname = "LIST5" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 34
      Cells(Target.Row, 6).Interior.ColorIndex = 34
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 37
      Cells(Target.Row, 6).Interior.ColorIndex = 37
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 39
      Cells(Target.Row, 6).Interior.ColorIndex = 39
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 44
      Cells(Target.Row, 6).Interior.ColorIndex = 44
    ElseIf ModuleServ.Listname = "DI |fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 7
      Cells(Target.Row, 6).Interior.ColorIndex = 7
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 4
      Cells(Target.Row, 6).Interior.ColorIndex = 4
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 8
      Cells(Target.Row, 6).Interior.ColorIndex = 8
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 33
      Cells(Target.Row, 6).Interior.ColorIndex = 33
    ElseIf ModuleServ.Listname = "DO |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 54
      Cells(Target.Row, 6).Interior.ColorIndex = 54
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 36
      Cells(Target.Row, 6).Interior.ColorIndex = 36
    ElseIf ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 5).Interior.ColorIndex = 50
      Cells(Target.Row, 6).Interior.ColorIndex = 50
    End If
    
    ModuleServ.SignType = 0
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
    Worksheets(ModuleServ.Listname).Activate
    Cancel = True
  End If
End Sub

Private Sub Worksheet_Deactivate()
  If ModuleServ.DoSelection Then
    ModuleServ.DoSelection = False
    ModuleServ.SignType = 0
    ModuleServ.Listname = ""
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|52"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|53"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|54"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
  If ModuleServ.DoSelection Then
    Dim V As Long
    If ModuleServ.SignType = snAI Then
      If (Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 2 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 3 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 6 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 7 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 8 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 9 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 10 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 11 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 12 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 13 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 14 Or _
          Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 15) And _
         Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value <> 0 Then
        V = Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).Value
      End If
      Set c = Range("A6:A1005").Find(V, LookIn:=xlValues)
      If Not c Is Nothing Then c.Select
    End If
  End If
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  If ModuleServ.DoSelection And Target.Column = 1 Then
    ModuleServ.DoSelection = False
    Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol).FormulaR1C1 = Target.Value
    Dim AddInt As Integer
    If (Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 2 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 8) Then
      AddInt = 3
    End If
    If (Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 3 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 9 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 10 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 11) Then
      AddInt = 4
    End If
    If (Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 6 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 12) Then
      AddInt = 2
    End If
    If (Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 7 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 13 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 14 Or _
       Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, ModuleServ.EditRangeCol - 4).Value = 15) Then
      AddInt = 1
    End If
    If ModuleServ.Listname = "LIST2" Or ModuleServ.Listname = "LIST3" Or ModuleServ.Listname = "LIST4" Or ModuleServ.Listname = "LIST5" Then
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 2).FormulaR1C1 = Cells(Target.Row, 2).Text + CStr(AddInt)
    Else
      Worksheets(ModuleServ.Listname).Cells(ModuleServ.EditRangeRow, 3).FormulaR1C1 = Cells(Target.Row, 2).Text + CStr(AddInt)
    End If
    If ModuleServ.Listname = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 38
      Cells(Target.Row, 3).Interior.ColorIndex = 38
    ElseIf ModuleServ.Listname = "LIST2" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 40
      Cells(Target.Row, 3).Interior.ColorIndex = 40
    ElseIf ModuleServ.Listname = "LIST3" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 43
      Cells(Target.Row, 3).Interior.ColorIndex = 43
    ElseIf ModuleServ.Listname = "LIST4" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 35
      Cells(Target.Row, 3).Interior.ColorIndex = 35
    ElseIf ModuleServ.Listname = "LIST5" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 34
      Cells(Target.Row, 3).Interior.ColorIndex = 34
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 37
      Cells(Target.Row, 3).Interior.ColorIndex = 37
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 39
      Cells(Target.Row, 3).Interior.ColorIndex = 39
    ElseIf ModuleServ.Listname = "DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 44
      Cells(Target.Row, 3).Interior.ColorIndex = 44
    ElseIf ModuleServ.Listname = "DI |fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 7
      Cells(Target.Row, 3).Interior.ColorIndex = 7
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 4
      Cells(Target.Row, 3).Interior.ColorIndex = 4
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 8
      Cells(Target.Row, 3).Interior.ColorIndex = 8
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 33
      Cells(Target.Row, 3).Interior.ColorIndex = 33
    ElseIf ModuleServ.Listname = "DO |fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 54
      Cells(Target.Row, 3).Interior.ColorIndex = 54
    ElseIf ModuleServ.Listname = "DO |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
      Cells(Target.Row, 2).Interior.ColorIndex = 36
      Cells(Target.Row, 3).Interior.ColorIndex = 36
    End If

    ModuleServ.SignType = 0
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
    Worksheets(ModuleServ.Listname).Activate
    Cancel = True
  End If
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 7 And Target.Row > 5 And Target.Row < 2006 Then
    ModuleServ.DoSelection = True
    ModuleServ.SignType = snAIm
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    If Cells(Target.Row, Target.Column - 1).Value = 0 Then
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    Else
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End If
    Cancel = True
  End If
End Sub

Private Sub Worksheet_Deactivate()
  If ModuleServ.DoSelection And ModuleServ.SignType <> snAIm Then
    ModuleServ.DoSelection = False
    ModuleServ.SignType = 0
    ModuleServ.Listname = ""
    ModuleServ.EditRangeRow = 0
    ModuleServ.EditRangeCol = 0
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn8, 27, 0, MSForms, CommandButton"

Public Sub RefreshCBtn8_Click()
  For i = 1 To 16
    Cells(6 + 17 * (i - 1), 1).FormulaR1C1 = Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Text
    If Cells(6 + 17 * (i - 1), 1).Font.ColorIndex <> Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex Then
      Range("A" + CStr(6 + 17 * (i - 1)) + ":K" + CStr(22 + 17 * (i - 1))).Font.ColorIndex = _
      Worksheets("|fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|").Cells(6 + i - 1, 1).Font.ColorIndex
    End If
  Next i
End Sub

Private Sub Worksheet_Activate()
  RefreshCBtn8_Click
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RefreshCBtn9, 39, 0, MSForms, CommandButton"

Public Sub RefreshCBtn9_Click()
  For i = 1 To 64
    If Cells(6 + i - 1, 30).Value = 0 Then
      Cells(6 + i - 1, 2).FormulaR1C1 = ""
    End If
  Next i
End Sub

Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
  If Target.Column = 38 And Target.Row > 5 And Target.Row < 70 Then
    ModuleServ.DoSelection = True
    ModuleServ.Listname = ActiveSheet.name
    ModuleServ.EditRangeRow = Target.Row
    ModuleServ.EditRangeCol = Target.Column
    Select Case Cells(Target.Row, Target.Column - 4).Value
      Case 0
        ModuleServ.SignType = snDI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 1
        ModuleServ.SignType = snDI
        Worksheets("DI |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
        ModuleServ.SignType = snAI
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
      Case 5
        ModuleServ.SignType = snGrp
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Activate
    End Select
    Cancel = True
  End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
  Dim MsgStr As String
'  If ThisWorkbook.BuiltinDocumentProperties(2) <> "|fffd||fffd||fffd||fffd||fffd||fffd| 4.0 |fffd||fffd| 2011" Then
'    ThisWorkbook.BuiltinDocumentProperties(2) = "|fffd||fffd||fffd||fffd||fffd||fffd| 4.0 |fffd||fffd| 2011"
'  End If
  MsgStr = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" + Chr(13) + _
           "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + Chr(13) + _
           "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" + Chr(13) + _
           "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|:" + Chr(13) + _
           ThisWorkbook.BuiltinDocumentProperties(2) + " |fffd||fffd||fffd||fffd|"
  MsgBox MsgStr, vbOKOnly Or vbInformation, "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 
End Sub






INQUEST-PP=macro
