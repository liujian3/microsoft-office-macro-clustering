Attribute VB_Name = "Module1"
'Option Explicit
Public show_msg_mz   As Integer
Dim base_row As Integer
Public Const BFMmz_version = "Ver 1.00" '2017.2.27 copied 0.06c, Result table of fPlan sheet was put into Portguese, _
    2017.4.27, 2017.5.2 2017.5.16 2017.6.14 2017.6.21 2017.7.5 2017.7.10 _
    CR3:2017.9.5 9.6 9.7 CR4:2017.9.20 2017.9.27  CR4.1:2017.9.28 10.4  1.00:2018.1.17

Public Sub auto_open_bk()

    Dim add_mode    As Boolean
    Dim folder      As Object
    Dim bfm_prg
    Dim Df
    Dim ans%
        
   Df = ThisWorkbook.Path
   
   On Error GoTo no_ini_file
   
   Open Df & "\bfm_mz.ini" For Input As 1: Input #1, show_msg_mz: Close 1
   add_mode = False
   'check bfm is or not
   If bfm_menu = False Then
      On Error Resume Next
      Workbooks("BFMe.xla").Close
      On Error GoTo 0
      If Dir(Df & "\BFMe.xla") <> "" Then
         open_bfm
      Else
         ans% = MsgBox("Nao existe BFMe necessario para executar BFMmz." & Chr(13) & Chr(13) & _
         "Por favor,copie BFMe.xla para a mesma pasta." & Chr(13) & Chr(13), , "BFMmz")
         'BFMmz|fffd||30e||fffd||fffd|s|fffd||255|K|fffd|v|fffd||fffd|BFMe|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B
         'BFMe.xla |fffd||13bc2||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|[|fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
         ThisWorkbook.Close
          Exit Sub
      End If
   End If
   If show_msg_mz = 1 Then
      show_opening_form_mz '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||309||fffd||295|\|fffd||fffd|
   End If

    'XLP|fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd||314||fffd|\|fffd||fffd|
    If xlp_menu = True Then
        CommandBars.ActiveMenuBar.Controls("XLP(&X)").Visible = False
    End If
'    'BFM|fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd||314||fffd|\|fffd||fffd|
'    If bfm_menu = True Then
'        CommandBars.ActiveMenuBar.Controls("BFM(&B)").Visible = True
'    End If
    

   'remake [BFM]menu
   modify_menubar_menu
   modify_sidebar_menu
   modify_sidebar_menu_in_edit
   modify_shortcut_menu
   modify_shortcut_menu_in_edit
        
   Exit Sub

no_ini_file:
   show_msg_mz = 1
   Open Df & "\bfm_mz.ini" For Output As 2: Print #2, show_msg_mz: Close 2
   Resume Next
   
End Sub

Sub open_bfm()

   Dim aru     As Integer
   Dim tmp_show_msg    As Integer

   Dim Df
   Df = ThisWorkbook.Path

   If Dir(Df & "\bfm.ini") <> "" Then
      aru = 1
      Open Df & "\bfm.ini" For Input As 1: Input #1, tmp_show_msg: Close 1
   End If
   Open Df & "\bfm.ini" For Output As 2: Print #2, "0": Close 2
   Workbooks.Open Df & "\BFMe.xla"
   If aru = 1 Then
      Open Df & "\bfm.ini" For Output As 2: Print #2, tmp_show_msg: Close 2
   Else
      Kill Df & "\bfm.ini"
   End If
End Sub

'|fffd|N|fffd||fffd||fffd|[|fffd|Y|fffd||fffd||fffd||303||fffd||fffd|j|fffd||fffd||fffd|[|fffd||d3dc||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub auto_close()
   On Error Resume Next
   CommandBars("my_bar").Delete
   CommandBars.ActiveMenuBar.Controls("BFM(&B)").Delete
End Sub

'|fffd|N|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd||fffd||282||315|\|fffd||fffd|
Public Sub show_opening_form_mz()
   
   Dim uf As Object
   
   Set uf = UserForm1
   uf.Label14.Caption = BFMmz_version
   
   If show_msg_mz = 1 Then
      UserForm1.OptionButton1.Value = True
   Else
      UserForm1.OptionButton2.Value = True
   End If
   
   If Val(Application.Version) >= 9 Then
      uf.Show vbModeless
   Else
      uf.Show
   End If
End Sub

'|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1228f|o|fffd||fffd||fffd||fffd|i|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|r|fffd||fffd||fffd|j
Function extract_fname(fname As Variant)
    Dim i   As Integer
    Do
        i = InStr(fname, "\")
        If i > 0 Then fname = Mid(fname, i + 1)
    Loop While i > 0
    extract_fname = fname
End Function

'XLP|fffd||303||fffd||fffd|j|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|
Function xlp_menu()
    Dim ctrl    As Object
   xlp_menu = False
   For Each ctrl In CommandBars.ActiveMenuBar.Controls
      If ctrl.Caption = "XLP(&X)" Then xlp_menu = True: Exit For
   Next ctrl
End Function

'BFM|fffd||303||fffd||fffd|j|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd|d|fffd||fffd||fffd||fffd||fffd||fffd|
Function bfm_menu()
    Dim ctrl    As Object
   bfm_menu = False
   For Each ctrl In CommandBars.ActiveMenuBar.Controls
      If ctrl.Caption = "BFM(&B)" Then bfm_menu = True: Exit For
   Next ctrl
End Function

'|fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd||312||1c9||fffd|
Sub make_item(extMenu, name As String, cmd As String)
    Dim newItem As Object
    Set newItem = extMenu.Controls.Add(Type:=msoControlButton)
       newItem.Caption = name: newItem.OnAction = cmd
End Sub

'|fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd||312||1c9||fffd|
Sub make_submenu(extMenu, name As String, newMenu)
    Set newMenu = extMenu.Controls.Add(Type:=msoControlPopup)
       newMenu.Caption = name
End Sub


'codes run in the menus set by BFMmz
Sub modify_menubar_menu()
   'On Error Resume Next
   'delete_menubar_BFMmenu()
   CommandBars.ActiveMenuBar.Controls("BFM(&B)").Delete
   'set new menu
   Set newMenu = CommandBars.ActiveMenuBar.Controls.Add _
      (Type:=msoControlPopup, Temporary:=True, before:=1)
   newMenu.Caption = "BFM(&B)"
   make_submenu newMenu, "iData", newSubmenu
   make_item newSubmenu, "Novo livro", "mz_make_book_MI" 'New book
   make_item newSubmenu, "Nova folha", "mz_make_sheet_MI" 'New sheet
   make_item newSubmenu, "Novo registro", "mz_edit_item_newly" 'New registration
   make_item newSubmenu, "Abrir (Novo)", "mz_read_data_base" 'Open(New)
   make_item newSubmenu, "Abrir (Adicao)", "mz_read_and_add_data_base" 'Open(Add)
   make_item newSubmenu, "Editar", "mz_edit_all_item" 'Edit
   make_item newSubmenu, "Editar(somente as culturas selecionadas)", "mz_edit_ticked_item" 'Edit(only selected crops)
   make_item newSubmenu, "Guardar(Sobrescrever)", "mz_resave_data_base" 'Save(Overwrite)
   make_item newSubmenu, "Guardar Como", "mz_save_data_base" 'Save as
   
   make_submenu newMenu, "fCondition", newSubmenu
   make_item newSubmenu, "Novo", "mz_make_farmCondition_sheet" 'New
   make_item newSubmenu, "Abrir", "mz_read_farming_condition" 'Open
   make_item newSubmenu, "Guardar(Sobrescrever)", "mz_resave_farming_condition" 'Save(Overwrite)
   make_item newSubmenu, "Guardar Como", "mz_save_farming_condition" 'Save as
   make_item newSubmenu, "A condicao de contratar o mao-de-obra muda", "mz_change_meaning_of_hired_days"
   
   make_item newMenu, "Criar um plano agrario", "mz_budget_LPtd" 'Create a farming plan
   make_item newMenu, "Ajuda", "mz_show_usage" 'Help
   make_item newMenu, "Mostrar o menu iniciar", "show_opening_form_mz" 'Show start menu
'   make_shortcut_menu
'   make_shortcut_menu_in_edit
'   make_side_menu
    
   Exit Sub
'del_bar:
'   auto_close
'   Resume
End Sub

Sub modify_sidebar_menu() 'codes processed by the menus added by BFMmz
   With CommandBars("side_menu_i").Controls("iData")
    .Controls("New book").Caption = "Novo livro"
    .Controls("Novo livro").OnAction = "mz_make_book_MI"
    .Controls("New sheet").Caption = "Nova folha"
    .Controls("Nova folha").OnAction = "mz_make_sheet_MI"
    .Controls("New registration").Caption = "Novo registro"
    .Controls("Novo registro").OnAction = "mz_edit_item_newly"
    .Controls("Open (New)").Caption = "Abrir (Novo)"
    .Controls("Abrir (Novo)").OnAction = "mz_read_data_base"
    .Controls("Open (Add)").Caption = "Abrir (Adicao)"
    .Controls("Abrir (Adicao)").OnAction = "mz_read_and_add_data_base"
    .Controls("Edit").Caption = "Editar"
    .Controls("Editar").OnAction = "mz_edit_all_item"
    .Controls("Edit(only selected crops)").Caption = "Editar(Somente as culturas selecionadas)"
    .Controls("Editar(Somente as culturas selecionadas)").OnAction = "mz_edit_ticked_item"
    .Controls("Save(Overwrite)").Caption = "Guardar(Sobrescrever)"
    .Controls("Guardar(Sobrescrever)").OnAction = "mz_resave_data_base"
    .Controls("Save As").Caption = "Guardar Como"
    .Controls("Guardar Como").OnAction = "mz_save_data_base"
   End With
   
   With CommandBars("side_menu_i").Controls("fCondition")
    .Controls("New").Caption = "Novo"
    .Controls("Novo").OnAction = "mz_make_farmCondition_sheet"
    .Controls("Open").Caption = "Abrir"
    .Controls("Abrir").OnAction = "mz_read_farming_condition"
    .Controls("Save(Overwrite)").Caption = "Guardar(Sobrescrever)"
    .Controls("Guardar(Sobrescrever)").OnAction = "mz_resave_farming_condition"
    .Controls("Save As").Caption = "Guardar Como"
    .Controls("Guardar Como").OnAction = "mz_save_farming_condition"
    .Controls("Change the conditions of labor employment").Caption = "A condicao de contratar o mao-de-obra muda"
    .Controls("A condicao de contratar o mao-de-obra muda").OnAction = "mz_change_meaning_of_hired_days"
   End With
   
   With CommandBars("side_menu_i")
    .Controls("Create a farming plan").Caption = "  Criar um plano agrari"
    .Controls("  Criar um plano agrari").OnAction = "mz_budget_LPtd"
    .Controls("Help").Caption = "   Ajuda"
    .Controls("   Ajuda").OnAction = "mz_show_usage"
   End With

'   make_item Application.CommandBars("side_menu_i"), "Mostrar o menu iniciar", "show_opening_form_mz" 'Show start menu

   CommandBars("side_menu_c").Controls("Compute again").Caption = "calcular novamente"
   CommandBars("side_menu_c").Controls("calcular novamente").OnAction = "mz_compute_LPm_only"
    
   Exit Sub
'del_bar:
'   auto_close
'   Resume
End Sub

Sub modify_sidebar_menu_in_edit() 'modify the menus name in BFMmz
   With CommandBars("side_menu_e")
    .Controls("Add").Caption = "Adicionar"
    .Controls("Adicionar").OnAction = "edit2_add"
    .Controls("Previous").Caption = ", Indicador anterior"
    .Controls(", Indicador anterior").OnAction = "edit2_backward"
    .Controls("Next").Caption = ", Indicador seguinte"
    .Controls(", Indicador seguinte").OnAction = "edit2_forward"
    .Controls("Copy ").Caption = ", Copiar"
    .Controls(", Copiar").OnAction = "edit2_copy_and_paste"
    .Controls("Working time forward ").Caption = ", Avancar de trabalho periodo"
    .Controls(", Avancar de trabalho periodo").OnAction = "edit2_working_time_forward"
    .Controls("Working time backward ").Caption = ", Atrasar de trabalho periodo"
    .Controls(", Atrasar de trabalho periodo").OnAction = "edit2_working_time_backward"
    .Controls("Show/Hide land coefficients").Caption = ", Exibir/ocultar o coeficiente de terra"
    .Controls(", Exibir/ocultar o coeficiente de terra").OnAction = "show_landcoef_or_hide"
    .Controls(" |").Caption = " |"
    .Controls("Adicionar").OnAction = ""
    .Controls("Close").Caption = "Fechar"
    .Controls("Fechar").OnAction = "edit2_close"
    .Controls("| ").Caption = "| "
    .Controls("Adicionar").OnAction = ""
    .Controls("Confirm").Caption = "Confirmar"
    .Controls("Confirmar").OnAction = "edit2_determine"
    .Controls("Delete").Caption = ", Deletar"
    .Controls(", Deletar").OnAction = "edit2_delete"
    .Controls("Reduction").Caption = ", Reduzir"
    .Controls(", Reduzir").OnAction = "reduce_screen"
    .Controls("Expansion").Caption = ", Ampliar"
    .Controls(", Ampliar").OnAction = "magnify_screen"
    .Controls("Help").Caption = ", Ajuda"
    .Controls(", Ajuda").OnAction = "edit2_help"
    .Visible = False
   End With
End Sub

Sub modify_shortcut_menu()
   'On Error Resume Next
   'delete_menubar_BFMmenu()
   CommandBars("Cell").Controls("BFM(&B)").Delete
   Set newMenu = CommandBars("Cell").Controls.Add _
      (Type:=msoControlPopup, Temporary:=True, before:=1)
   newMenu.Caption = "BFM(&B)"
   make_submenu newMenu, "iData", newSubmenu
   make_item newSubmenu, "Novo livro", "mz_make_book_MI" 'New book
   make_item newSubmenu, "Nova folha", "mz_make_sheet_MI" 'New sheet
   make_item newSubmenu, "Novo registro", "mz_edit_item_newly" 'New registration
   make_item newSubmenu, "Abrir (Novo)", "mz_read_data_base" 'Open (New)
   make_item newSubmenu, "Abrir (Adicao)", "mz_read_and_add_data_base" 'Open (New)
   make_item newSubmenu, "Editar", "mz_edit_all_item" 'Edit
   make_item newSubmenu, "Editar(Somente as culturas selecionadas)", "mz_edit_ticked_item" 'Edit(only selected crops)
   make_item newSubmenu, "Guardar(Sobrescrever)", "mz_resave_data_base" 'Save(Overwrite)
   make_item newSubmenu, "Guardar Como", "mz_save_data_base" 'Save As
   
   make_submenu newMenu, "fCondition", newSubmenu
   make_item newSubmenu, "Novo", "mz_make_farmCondition_sheet" 'New
   make_item newSubmenu, "Abrir", "mz_read_farming_condition" 'Open
   make_item newSubmenu, "Guardar(Sobrescrever)", "mz_resave_farming_condition" 'Save(Overwrite)
   make_item newSubmenu, "Guardar Como", "mz_save_farming_condition" 'Save As
   make_item newSubmenu, "A condicao de contratar o mao-de-obra muda", "mz_change_meaning_of_hired_days" '|fffd|||fffd||c2a95|K|fffd|v
   
   make_item newMenu, "Criar um plano agrari", "mz_budget_LPtd" 'Create a farming plan
   make_item newMenu, "Ajuda", "mz_show_usage" 'Help
   make_item newMenu, "Mostrar menu iniciar", "show_opening_form_mz" 'Show start menu
   make_item newMenu, "calcular novamente", "mz_compute_LPm_only" 'Compute again
'   make_shortcut_menu
'   make_shortcut_menu_in_edit
'   make_side_menu

   CommandBars("Cell").Controls("BFM(&B)").Visible = True
    
   Exit Sub
'del_bar:
'   auto_close
'   Resume
End Sub

Sub modify_shortcut_menu_in_edit()

   CommandBars("Cell").Controls("eDB(&e)").Delete
   Dim sc_menu As CommandBarPopup
   On Error Resume Next
   Set sc_menu = Application.CommandBars("Cell").Controls.Add _
     (Type:=msoControlPopup, Temporary:=True, before:=1)
   sc_menu.BeginGroup = True
   sc_menu.Caption = "eDB(&e)"
   make_item sc_menu, "Adicionar(Novo)", "edit2_add" 'Add(new)
   make_item sc_menu, "Indicador anterior", "edit2_backward" 'Previous index
   make_item sc_menu, "Indicador seguinte", "edit2_forward" 'Next index
   make_item sc_menu, "Copiar", "edit2_copy_and_paste" 'Copy.
   make_item sc_menu, "Avancar de trabalho periodo", "edit2_working_time_forward" 'Cropping season forward
   make_item sc_menu, "Atrasar de trabalho periodo", "edit2_working_time_backward" 'Cropping season backward
   make_item sc_menu, "Exibir/ocultar o coeficiente de terra", "show_landcoef_or_hide" 'Display/Hide land coefficients
   make_item sc_menu, "--", ""
   make_item sc_menu, "Fechar", "edit2_close" 'Close.
   make_item sc_menu, "--", ""
   make_item sc_menu, "Confirmar", "edit2_determine" 'Confirm
   make_item sc_menu, "Deletar", "edit2_delete" 'Delete
   make_item sc_menu, "Reduzir", "reduce_screen" 'Reduction of screen
   make_item sc_menu, "Ampliar", "magnify_screen" 'Expansion of screen
   make_item sc_menu, "Ajuda", "edit2_help" 'Help
   CommandBars("Cell").Controls("eDB(&e)").Visible = False

End Sub

Sub mz_read_data_base()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Workbooks.Add
   Application.ScreenUpdating = True
   Application.ScreenUpdating = False
   Dim sh As String
   sh = "iData"
   If Not sheet_exist(sh) Then
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
'      Workbooks("BFMe.xla").Sheets(sh).Copy before:=ActiveSheet
'      mz_make_sheet_MI
   End If
   Sheets(sh).Visible = True
   Run "BFMe.xla!read_data_base"
End Sub

Sub mz_read_and_add_data_base()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Workbooks.Add
   Application.ScreenUpdating = True
   Application.ScreenUpdating = False
   Dim sh As String
   sh = "iData"
   If Not sheet_exist(sh) Then
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
'      Workbooks("BFMe.xla").Sheets(sh).Copy before:=ActiveSheet
'      mz_make_sheet_MI
   End If
   Sheets(sh).Visible = True
   Run "BFMe.xla!read_and_add_data_base"
End Sub

Sub mz_copy_MIsheet_to_ILsheet()
End Sub

Sub mz_make_book_MI()
   Workbooks.Add
   Application.DisplayAlerts = False 'On a computer screen user does not confirm the result processed by this program.
   While Worksheets.Count > 1: ActiveSheet.Delete: Wend
   mz_make_sheet_MI
End Sub

Sub mz_make_sheet_MI()
   If ActiveWindow Is Nothing Then
      Workbooks.Add
      Application.DisplayAlerts = False 'On a computer screen user does not confirm the result processed by this program.
      While Worksheets.Count > 1: ActiveSheet.Delete: Wend
   End If
   Dim sh As String
   sh = "iData"
   If Not sheet_exist(sh) Then
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
   End If
End Sub

Sub mz_save_data_base()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   
   If Not sheet_exist("iData") Then
      MsgBox "A pagina""iData""nao existe.", , "BFMmz"
'      MsgBox "A pagina""iData""nao existe. " & vbCr & vbCr & "Execucao e cancelada.", , "BFMmz"
      Exit Sub
   End If
   
   If [a1] <> "[MI]" Then
      Sheets("iData").Select
   End If
   
   LastRow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row 'Get  the line of lowermost data
'   If LastRow = Rows.Count Then LastRow = 2
   active_row = ActiveCell.Row
   active_col = ActiveCell.Column
   
   If LastRow = 2 Then
      MsgBox "Indice nao registado.", vbOKOnly + vbExclamation, "BFMmz"
      Cells(active_row, active_col).Select
'      [a1].Select
      Exit Sub
   Else
      Application.DisplayAlerts = False
      output_file = Application.GetSaveAsFilename _
      ("", filefilter:="bfm file (*.bfm), *.bfm,agr file (*.agr), *.agr")
      If output_file = False Then Exit Sub
      On Error GoTo FA
      fname = Trim(output_file)
      If Dir(fname) <> "" Then
         fname = fullpath2filename(fname)
         ans = MsgBox(fname & " ja existe." & vbCr & vbCr & "Deseja substitui-lo?", vbYesNo, "BFMmz")
         If ans = vbNo Then Exit Sub
      End If
   End If
         
   delete_item_made_byBFM
   
   Run "BFMe.xla!save_data_base", fname
   Exit Sub
   
FA:
   Close
   MsgBox "Not saved correctly", vbOKOnly + vbExclamation, "BFMmz"
err1:

End Sub

Sub mz_resave_data_base()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   Dim sh As String
   sh = "iData"
   If Not sheet_exist(sh) Then
      MsgBox "A pagina""iData""nao existe.", , "BFMmz"
      Exit Sub
'      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
'      ActiveSheet.name = sh
   End If
   Sheets("iData").Select
   delete_item_made_byBFM
   
   LastRow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row 'Get  the line of lowermost data
   If LastRow = 2 Then
      MsgBox "Indice nao registado", vbOKOnly + vbExclamation, "BFMmz"
      [a1].Select
      Exit Sub
   End If
   
   Run "BFMe.xla!resave_data_base"
End Sub

Sub mz_copy_ILsheet_to_MIsheet()
End Sub

Sub mz_read_farming_condition()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Workbooks.Add
   Application.ScreenUpdating = True
   Application.ScreenUpdating = False

   If sheet_exist("fCondition") Then
      Sheets("fCondition").Select
      Application.ScreenUpdating = True
      Application.ScreenUpdating = False 'Stop of the renewal of display
'      ans = MsgBox("(PT) The displayed data is overwritten with the data in selected file." _
'      & vbCr & vbCr & "Is it OK?", vbYesNo)
   Else
      mz_make_farmCondition_sheet
      Run "BFMe.xla!auto_zoom" '2013.2.19
   End If
   If ans = vbNo Then Exit Sub
   Dim data_check_done As Boolean
   data_check_done = True

   Run "BFMe.xla!read_farming_condition", data_check_done
   
   add_jikyu_konsaku_data_range
   change_item_name_fCondition
   change_fCondition_validation_rule_acordingToLocale
   change_units_fCondition
   add_item_fCondition
   
   Range("n27").HorizontalAlignment = xlLeft
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True

End Sub

Sub mz_copy_FCsheet_to_FCMZsheet()
End Sub

Sub mz_make_farmCondition_sheet()
   If ActiveWindow Is Nothing Then Workbooks.Add
   Run "BFMe.xla!make_farmCondition_sheet"
   
   add_jikyu_konsaku_data_range
   change_item_name_fCondition
   change_fCondition_validation_rule_acordingToLocale
   change_units_fCondition
   add_item_fCondition
   
   'adjustment of ColumnWidth
'   Range("e3").Columns.AutoFit
'   Range("j6").Columns.AutoFit
'   Range("n6").Columns.AutoFit
   Range("n27").HorizontalAlignment = xlLeft
   Range("b4:b28").Columns.AutoFit
   Columns("b").ColumnWidth = Round(Columns("b").ColumnWidth / 12 * 11) 'Too wide is setting by AutoFit
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True
   
End Sub

Sub change_fCondition_validation_rule_acordingToLocale()
   For Each cl In Union([d19], [d20], [d22])
      cl.Value = "Nao"
      With cl.Validation
        .Delete
        .Add Type:=xlValidateList, Formula1:="Sim,Nao"
      End With
   Next cl
End Sub

Sub mz_save_farming_condition()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   
   On Error GoTo err1
   If Not sheet_exist("fCondition") Then
      MsgBox "A pagina""fCondition""nao existe.", , "BFMmz"
'      MsgBox "A pagina""fCondition""nao existe." & vbCr & vbCr & "Execucao e cancelada.", , "BFMmz"
      Exit Sub
   End If
   
   If [a1] <> "[FC]" Then
      Sheets("fCondition").Select
   End If
   Application.ScreenUpdating = False
   Application.DisplayAlerts = False
   
   output_file = Application.GetSaveAsFilename _
   (filefilter:="bfc|327||fffd||fffd| (*.bfc), *.bfc") 'delete the appointment the file name desplayed as the designated value
   '([c1].Value, fileFilter:="bfc file (*.bfc), *.bfc")
   If output_file = False Then Exit Sub
   fname = Trim(output_file)
   '2013.2.19 start
   If Dir(fname) <> "" Then
         fname = fullpath2filename(fname)
         ans = MsgBox(fname & " ja existe." & vbCr & vbCr & "Deseja substitui-lo?", vbYesNo, "BFMmz")
   End If
   '-- end
      
   Run "BFMe.xla!save_farming_condition", fname
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True
   
   Exit Sub
   
err1:

End Sub

Sub mz_resave_farming_condition()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   Dim sh As String
   sh = "fCondition"
   If Not sheet_exist(sh) Then
      MsgBox "A pagina""fCondition""nao existe.", , "BFMmz"
      Exit Sub
   End If
   Sheets("fCondition").Select
   Run "BFMe.xla!resave_farming_condition"
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True
   
End Sub

Sub mz_copy_FCMZsheet_to_FCsheet()
End Sub

Sub mz_budget_LPtd()
   Application.ScreenUpdating = False
   If sheet_exist("iData") Then
      Sheets("iData").Select
   Else
      MsgBox "A pagina""iData""nao existe. ", , "BFMmz"
      Exit Sub
   End If
   Set mi_sh = ActiveSheet
   is_selected_item = False
   On Error Resume Next
   LastRow = ActiveSheet.Range("b2").End(xlDown).Row 'Get the row number of the last row of index data.
   For i = 3 To LastRow
      If Cells(i, 1) = True Then is_selected_item = True: Exit For
   Next i
   If Not is_selected_item Then 'Whether the management index has been chosen
      MsgBox "A cultura nao foi selecionada", , "BFMmz"
      Exit Sub
   End If
   
   delete_item_made_byBFM
   
   Sheets("fCondition").Unprotect
   
   change_landCategoryName_accordingTo_USLocale
   change_YesNoSpelling_accordingTo_USLocale
   change_First_Middle_LastSpelling_accordingTo_USLocale
   
   If Not sheet_exist("fCondition") Then 'Whether there is a farming condition sheet
      MsgBox "A pagina""fCondition""nao existe.", , "BFMmz"
      Exit Sub
   End If
      
   
   change_ItemName_accordingTo_USLocale
   
   Dim s_MI As Object, s_TBL As Object
   Set s_MI = ActiveSheet

'2013.2.25 start, 2017.6.7
   For i = 3 To LastRow
      If (Cells(i, 1) = True) And Val(Cells(i, "BV")) > 0 Then 'Do not check the crop whose land coefficient is 0.
         If Cells(i, 5) = "" Then icrop = "" Else icrop = "(" & Cells(i, 5) & ")"
         
'         'Next if-statement is only for Japanese edition. 2013.10.3 start --
'         If (Cells(i, 77) = "|fffd|c") And (Cells(i, 78) <> "|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|" And Cells(i, 78) <> "|fffd|Y|fffd||fffd||fffd||fffd||fffd||202||fffd|") Then
'            ans = MsgBox("|fffd||fffd||681|F" & Cells(i, 4) & icrop & " |fffd||fffd|" & vbCr & vbCr & _
'            "|fffd||fffd|H|fffd|p|fffd||102||24a|Y|fffd||fffd||fffd||fffd||fffd||90a9||fffd||6c2||fffd||fffd||303|f|fffd|[|fffd|^|fffd|i|fffd|w|fffd|W|fffd||48f|W|fffd|V|fffd|[|fffd|g|fffd||303|Z|fffd||fffd||fffd|mK12|fffd|n|fffd|j|fffd||fffd|" & vbCr & vbCr & _
'            "|fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||202||fffd||fffd||181|A|fffd|c|fffd|_|fffd||30d||153|K|fffd|v|fffd||fffd||102||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|" & vbCr & vbCr & _
'            "|fffd||6c2||241|A|fffd||102||310||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||24c|W|fffd||fffd||9427||fffd|x|fffd||fffd||fffd|_|fffd||18c|o|fffd|c|fffd||310||fffd||fffd|c|fffd||fffd||fffd|p|fffd||24b|y|fffd||682||fffd||fffd|e|fffd||fffd||fffd||fffd|" & vbCr & vbCr & _
'            "|fffd|l|fffd||fffd||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||44d||fffd||202||1c2||24a||582||fffd||fffd||113|K|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCr & vbCr & _
'            "|fffd||202||fffd||fffd||202||1c2||316||fffd||80aa||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCr & vbCr & _
'            "|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|[|fffd||fffd||fffd||102||fffd||fffd||fffd||113|x|fffd||fffd||fffd|s|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCr,, "BFMmz")
'            End
'         End If
'         '-- end
         
         If (Val(Cells(i, 79)) = 0 Or Val(Cells(i, 80)) = 0) Then
            ans = MsgBox("Lista de culturas|fffd|F" & Cells(i, 4) & icrop & vbCr & vbCr & _
            "Data of the beginning and the end of field use are not input." & vbCr & vbCr & _
            "Sem esses dados, um modelo ser? criado sob a condi??o de que o campo foi utilizado de Janeiro a Dezembro," & vbCr & vbCr & _
            "E erros de processamento em usos de terra como sistema de duas culturas" & vbCr & vbCr & _
            "Pode surgir." & vbCr & vbCr & _
            "Realmente deseja cancelar a opera??o e modificar os dados ?" & vbCr & vbCr & _
            "Prima [Sim] para cancearl, e [Nao] para continuar," & vbCr & vbCr & _
            "respectivamente.", vbYesNo, "BFMmz")
            If ans = vbYes Then
               End
            End If
         Else
            Set c2 = Sheets("fCondition").[d20] 'insert and comment out next 3 lines on 2017.4.20
'            With Sheets("fCondition").Range("b1:b28")
'               Set c2 = .Find("use of rented land") ', LookIn:=xlValues) |fffd||fffd| comment out LookIn 2013.5.7
'            End With
            land_type = Cells(i, "by")
            With Sheets("fCondition").Range("b1:b28")
               Set c = .Find(land_type) ', LookIn:=xlValues) |fffd||fffd| comment out LookIn 2013.5.7
               If Not c Is Nothing Then
                  If c.Offset(0, 2) = 0 And c.Offset(0, 3) = 0 Then
                     ans = MsgBox("Lista de culturas|fffd|F" & Cells(i, 4) & "(" & Cells(i, 5) & ") e suposto ser plantado em" & vbCr & vbCr & _
                     land_type & ", quando nao ha terras proprias ou alugadas" & land_type & "." & vbCr & vbCr & _
                     "Realmente deseja cancelar a operacao e modificar os dados?" & vbCr & vbCr & _
                     "Prima [Sim] para cancelar e [Nao] para continuar, respectivamente.", vbYesNo, "BFMmz")
                     If ans = vbYes Then
                        End
                     End If
                  End If
               End If
               If Not c2 Is Nothing Then
                  If c.Offset(0, 2) = 0 And c.Offset(0, 3) > 0 And c2.Value = "No" Then
                     ans = MsgBox("Lista de culturas|fffd|F" & Cells(i, 4) & "(" & Cells(i, 5) & ") e suposto ser plantado em" & vbCr & vbCr & _
                     land_type & ". No entanto n?o h? terras pr?prias e ? suposto n?o usar terras alugadas" & vbCr & vbCr & _
                     land_type & "." & vbCr & vbCr & _
                     "n?o h? terras pr?prias e ? suposto n?o usar terras alugadas?" & vbCr & vbCr & _
                     "Prima [Sim] para cancelar e [Nao] para continuar, respectivamente.", vbYesNo, "BFMmz")
                     If ans = vbYes Then
                        End
                     End If
                  End If
               End If
            End With
         End If
      End If
   Next i
   Dim data_check As Boolean: data_check = True
'-- end

   make_mixed_cropping_process

   Run "BFMe.xla!make_LPtd", data_check

   add_subsistence_crop_constraint

   Set s_TBL = ActiveSheet
   If xlp_menu = False Then Exit Sub
   
   Application.Run "lp_calc"
   
   Application.DisplayAlerts = False
   Application.DisplayAlerts = True

   If Sheets("Result").[a3] = "" Then 'If there is no solution or it is an infinite solution
      Sheets("fPlan").Unprotect
      Sheets("fPlan").Cells.ClearContents 'Clear the sheet of farming plan table,
      Sheets("fPlan").Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
      mi_sh.Select 'return to the management index sheet,
      
      MsgBox "Error", , "BFMmz"
      
      Exit Sub 'Interrupt the process
   End If
   
   Run ("BFMe.xla!make_budget_sheet") '36: num of land-constraints

   change_units_fPlan
   change_item_name_fPlan
   
   recover_original_landCategoryName
   recover_YesNoSpelling
   recover_First_Middle_LastSpelling
   recover_ItemName
   change_chart_title_fPlan
   change_memo_field_fPlan
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True
   
   'delete_MixedData_madeByBFMmz
   
End Sub

Sub change_memo_field_fPlan()

   msg_memo = "[Espaco de memo] (PT) This table is an optimal plan which is calculated using the data of sheet""fCondition""  and sheet""iData""."
   msg_memo = msg_memo & _
   " You can get the new plan by modifying the numerical values (crop acreage, income, cost etc.) in the cream-colored cells."
   [b1] = msg_memo
   
   Range("B1:G4").Font.Bold = False
   With Range("B1:G4").Characters(Start:=1, Length:=16).Font
      .name = "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N"
      .Bold = True
      .ColorIndex = 5 'blue
   End With

End Sub

Sub change_chart_title_fPlan()
   ActiveSheet.Unprotect
   For Each obj In ActiveSheet.ChartObjects
      If InStr(obj.Chart.ChartTitle.Text, "crop area and") > 0 Then
         obj.Chart.ChartTitle.Text = "Area cultivada e Lucro proporcional"
      ElseIf InStr(obj.Chart.ChartTitle.Text, "working hours per") > 0 Then
         obj.Chart.ChartTitle.Text = "Horas de trabalho por dez dias"
      End If
   Next obj
   
   Rows("107:300").EntireRow.Hidden = True
   [b6].Activate
   
   ActiveSheet.Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub

Sub change_landCategoryName_accordingTo_USLocale()
   With Sheets("fCondition")
      .[b12] = "1) Paddy": .[b13] = "2) Field": .[b17] = "6) Other"
   End With
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "by")
         If tmp = "Zona alta" Then
            tmp = "Paddy"
         ElseIf tmp = "Zona baixa" Then
            tmp = "Field"
         ElseIf tmp = "Outra" Then
            tmp = "Other"
         End If
         .Cells(i, "by") = tmp
      Next i
   End With
End Sub

Sub recover_original_landCategoryName()
   With Sheets("fCondition")
      .[b12] = "1) Zona alta": .[b13] = "2) Zona baixa": .[b17] = "6) Outra"
   End With
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "by")
         If tmp = "Paddy" Then
            tmp = "Zona alta"
         ElseIf tmp = "Field" Then
            tmp = "Zona baixa"
         ElseIf tmp = "Other" Then
            tmp = "Outra"
         End If
         .Cells(i, "by") = tmp
      Next i
   End With
End Sub

Sub change_YesNoSpelling_accordingTo_USLocale()
   With Sheets("fCondition")
      For i = 19 To 22
         tmp = .Cells(i, "d")
         If tmp = "Sim" Then
            tmp = "Yes"
         ElseIf tmp = "Nao" Then
            tmp = "No"
         End If
         .Cells(i, "d") = tmp
      Next i
   End With
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "bz")
         If tmp = "Sim" Then
            tmp = "Yes"
         ElseIf tmp = "Nao" Then
            tmp = "No"
         End If
         .Cells(i, "bz") = tmp
         tmp = .Cells(i, "bt")
         If tmp = "Inicio" Then
            tmp = "First"
         ElseIf tmp = "Medio" Then
            tmp = "Middle"
         ElseIf tmp = "Final" Then
            tmp = "Last"
         End If
         .Cells(i, "bt") = tmp
         tmp = .Cells(i, "bu")
         If tmp = "Inicio" Then
            tmp = "First"
         ElseIf tmp = "Medio" Then
            tmp = "Middle"
         ElseIf tmp = "Final" Then
            tmp = "Last"
         End If
         .Cells(i, "bu") = tmp
      Next i
   End With
End Sub

Sub recover_YesNoSpelling()
   With Sheets("fCondition")
      For i = 19 To 22
         tmp = .Cells(i, "d")
         If tmp = "Yes" Then
            tmp = "Sim"
         ElseIf tmp = "No" Then
            tmp = "Nao"
         End If
         .Cells(i, "d") = tmp
      Next i
   End With
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "bz")
         If tmp = "Yes" Then
            tmp = "Sim"
         ElseIf tmp = "No" Then
            tmp = "Nao"
         End If
         .Cells(i, "bz") = tmp
      Next i
   End With
End Sub

Sub change_First_Middle_LastSpelling_accordingTo_USLocale()
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "bt")
         If tmp = "Inicio" Then
            tmp = "First"
         ElseIf tmp = "Medio" Then
            tmp = "Middle"
         ElseIf tmp = "Final" Then
            tmp = "Last"
         End If
         .Cells(i, "bt") = tmp
         tmp = .Cells(i, "bu")
         If tmp = "Inicio" Then
            tmp = "First"
         ElseIf tmp = "Medio" Then
            tmp = "Middle"
         ElseIf tmp = "Final" Then
            tmp = "Last"
         End If
         .Cells(i, "bu") = tmp
      Next i
   End With
End Sub

Sub recover_First_Middle_LastSpelling()
   With Sheets("iData")
      LastRow = Sheets("iData").Range("b2").End(xlDown).Row
      For i = 3 To LastRow
         tmp = .Cells(i, "bt")
         If tmp = "First" Then
            tmp = "Inicio"
         ElseIf tmp = "Middle" Then
            tmp = "Medio"
         ElseIf tmp = "Last" Then
            tmp = "Final"
         End If
         .Cells(i, "bt") = tmp
         tmp = .Cells(i, "bu")
         If tmp = "First" Then
            tmp = "Inicio"
         ElseIf tmp = "Middle" Then
            tmp = "Medio"
         ElseIf tmp = "Last" Then
            tmp = "Final"
         End If
         .Cells(i, "bu") = tmp
      Next i
   End With
End Sub

Sub change_ItemName_accordingTo_USLocale()
   str_first = "|fffd|@|fffd|uPart-time|fffd|v:|fffd|@Hirable days of part-timer"
   str_second = "|fffd|@|fffd|uPart-time|fffd|v:|fffd|@Man-days of hired part-timer"
   With Sheets("fCondition")
      .[b5] = "1) Family labor"
      If InStr(.[i5], "maximo") > 0 Or InStr(.[i5], "Hirable") > 0 Then '2017.7.11 add the part of "Hirable"
         .[i5] = str_first
      Else
         .[i5] = str_second
      End If
   End With
End Sub

Sub recover_ItemName()
   str_first = "|fffd|@|fffd|uTempo parcial|fffd|v:|fffd|@Numero maximo de dias que voce pode empregar"
   str_second = "|fffd|@|fffd|uTempo parcial|fffd|v:|fffd|@Numero de dias de empregar sempre"
   With Sheets("fCondition")
      .[b5] = "1) Mao-de-obra familiar"
      If InStr(.[i5], "Hirable") > 0 Then
         .[i5] = str_first
      Else
         .[i5] = str_second
      End If
      .[i5].Characters(Start:=19).Font.ColorIndex = 3
   End With
End Sub

Sub delete_item_made_byBFM()
   Set tmp = ActiveSheet
   Sheets("iData").Select
   LastRow = ActiveSheet.Range("b2").End(xlDown).Row
   For i = LastRow To 3 Step -1
      If Cells(i, 3) = "BFM.$$$" Then Rows(i).Delete
   Next i
   tmp.Select
End Sub

Sub run_BFMe()
   Run "BFMe.xla!make_budget_sheet 36" '36: num of land-constraints
End Sub

Sub mz_budget_LPm()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then
      MsgBox "Nao existe uma planilha.", , "BFMmz"
      Exit Sub
   End If
   Run "BFMe.xla!budget_LPm"
   
   correct_horizontal_axis_label
   change_units_fPlan
   change_item_name_fPlan
   
End Sub

Sub mz_compute_LPm_only()
   
   Sheets("fCondition").Unprotect
   
   change_ItemName_accordingTo_USLocale
   change_landCategoryName_accordingTo_USLocale
   change_YesNoSpelling_accordingTo_USLocale
   change_First_Middle_LastSpelling_accordingTo_USLocale
   
   Run "BFMe.xla!compute_LPm_only"
   change_units_fPlan
   change_item_name_fPlan
   
   recover_original_landCategoryName
   recover_YesNoSpelling
   recover_First_Middle_LastSpelling
   recover_ItemName
   change_chart_title_fPlan
   
   Sheets("fCondition").Protect AllowFormattingCells:=True, _
   AllowFormattingColumns:=True, AllowFormattingRows:=True
   
End Sub

Sub correct_horizontal_axis_label()
   ActiveSheet.Unprotect
   For i = 1 To 12
      Cells(67 + i, 2) = i
   Next i
   ActiveSheet.Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub

Sub change_units_fPlan()
   ActiveSheet.Unprotect
   For Each cl In Range("C7:R35").Cells
      If cl.NumberFormatLocal = "#,##0 ""$""" Then
         cl.NumberFormatLocal = "#,##0 ""MT"""
      Else
         If cl.NumberFormatLocal = "#.##0 ""$""" Then
            cl.NumberFormatLocal = "#.##0 ""MT"""
         End If
      End If
   Next cl
   'numerical data
'   Range("C7:R35").Replace what:="#,##0  ""$""", replacement:="#,##0  ""MT"""
   'item name
   Range("B7:B35").Replace what:="$", replacement:="MT"
   For Each cl In Range("C7:R35").Cells
      If cl.NumberFormatLocal = "#,##0.0 ""day""" Then
         cl.NumberFormatLocal = "#,##0.0 ""dias"""
      Else
         'in case of (decimal point is ",")
      End If
   Next cl
      
   ActiveSheet.Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub

Sub change_units_fCondition()
   ActiveSheet.Unprotect
   For Each cl In Union(Range("d4:d6"), Range("e4:e9"), Range("d9:d28"), Range("F6:F17")).Cells
      If InStr(cl.NumberFormatLocal, "$") > 0 Then
         cl.NumberFormatLocal = "#,##0 ""MT"""
      Else
         If cl.NumberFormatLocal = "#.##0 ""$""" Then
            cl.NumberFormatLocal = "#.##0 ""MT"""
         End If
      End If
      If InStr(cl.NumberFormatLocal, "people") > 0 Then
         cl.NumberFormatLocal = "#,##0.0 ""pessoas"""
      End If
      If InStr(cl.NumberFormatLocal, "hour/day") > 0 Then
         cl.NumberFormatLocal = "#,##0.0 ""horas/dia"""
      Else
         'in case of (decimal point is ",")
      End If
   Next cl
'   Union(Range("d9:d28"), Range("F6:F17")).Cells.Replace what:="$", replacement:="MT"
'   Range("d9:d28").Replace what:="$", replacement:="MT"
   For Each cl In Range("j7:p24").Cells
      If InStr(cl.NumberFormatLocal, "day") > 0 Then
         cl.NumberFormatLocal = "#,##0.0 ""dias"""
      Else
         'in case of (decimal point is ",")
      End If
   Next cl
End Sub

Sub change_units_iEdit()
   ActiveSheet.Unprotect
   For Each cl In Range("C7:R35").Cells
      If cl.NumberFormatLocal = "#,##0 ""$""" Then
         cl.NumberFormatLocal = "#,##0 ""MT"""
      Else
         If cl.NumberFormatLocal = "#.##0 ""$""" Then
            cl.NumberFormatLocal = "#.##0 ""MT"""
         End If
      End If
   Next cl
   'numerical data
'   Range("C7:R35").Replace what:="#,##0  ""$""", replacement:="#,##0  ""MT"""
   'item name
   Range("B7:B35").Replace what:="$", replacement:="MT"
   For Each cl In Range("C7:R35").Cells
      If cl.NumberFormatLocal = "#,##0.0 ""day""" Then
         cl.NumberFormatLocal = "#,##0.0 ""dias"""
      Else
         'in case of (decimal point is ",")
      End If
   Next cl
End Sub

Sub mz_edit_item_newly()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then mz_make_book_MI
   
   Dim sh As String
   sh = "iData"
   If sheet_exist(sh) Then
      Sheets(sh).Select
   Else
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
   End If
   ActiveWindow.LargeScroll toleft:=10
   
   sh = "iEdit"
   If Not sheet_exist(sh) Then
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
      Run "BFMe.xla!auto_zoom"
   End If
   Run "BFMe.xla!edit_item_newly"
   
End Sub

Sub mz_edit_all_item()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   
   Dim sh As String
   sh = "iData"
   If sheet_exist(sh) Then
      Sheets(sh).Select
   Else
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
'      mz_make_sheet_MI
   End If
'   change_item_name_iData
   ActiveWindow.LargeScroll toleft:=10
   
   sh = "iEdit"
   If Not sheet_exist(sh) Then
      ThisWorkbook.Sheets(sh & "_mz").Copy before:=ActiveSheet
      ActiveSheet.name = sh
'      Workbooks("BFMe.xla").Sheets(sh).Copy before:=ActiveSheet
      Run "BFMe.xla!auto_zoom"
   End If
'   change_item_name_iEdit
   
   Run "BFMe.xla!edit_all_item"

End Sub

Sub mz_edit_ticked_item()
   Application.ScreenUpdating = False
   If ActiveWindow Is Nothing Then Exit Sub
   
   If sheet_exist("iData") Then
      Sheets("iData").Select
   Else
      mz_make_sheet_MI
   End If
'   change_item_name_iData
   ActiveWindow.LargeScroll toleft:=10
   
   If Not sheet_exist("iEdit") Then
      Workbooks("BFMe.xla").Sheets("iEdit").Copy before:=ActiveSheet
      Run "BFMe.xla!auto_zoom"
   End If
   change_item_name_iEdit
   
   Run "BFMe.xla!edit_ticked_item"

End Sub

Sub mz_change_meaning_of_hired_days()
   If ActiveSheet.name <> "fCondition" Then
      MsgBox "Por favor executar em ""fCondition""folha.", , "BFMmz" '"please run from the farming condition sheet."
      Exit Sub
   End If
   ActiveSheet.Unprotect
   str_first = "|fffd|@|fffd|uTempo parcial|fffd|v:|fffd|@Numero maximo de dias que voce pode empregar"
   str_second = "|fffd|@|fffd|uTempo parcial|fffd|v:|fffd|@Numero de dias de empregar sempre"
   If InStr([i5], "maximo") > 0 Then
      [i5] = str_second
   Else
      [i5] = str_first
   End If
   [i5].Characters(Start:=19).Font.ColorIndex = 3
   ActiveSheet.Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub

Sub change_item_name_iData()
   Set src = ThisWorkbook.Sheets("itemNameList")
   [b2] = src.[b3]
   [c2] = src.[b4]
   
   
End Sub

Sub change_item_name_iEdit()

End Sub

Sub change_item_name_fPlan()
   ActiveSheet.Unprotect
   
   Cells(6, Columns.Count).End(xlToLeft).End(xlToLeft).End(xlToLeft).Select
   last_crop_col = ActiveCell.Column
   Range(Cells(6, 3), Cells(6, last_crop_col)).Replace what:="Mixed", replacement:="Mistura"
   
   [a1] = "[Plano agrario]" '[Farming plan]
   'Put the item name (front side) into Portuguese
   [c6] = "Maneio geral"
   [b7] = "Area cultivada (unidade|fffd|Fha)"
   [b8] = " Zona alta ( |fffd|V )"
   [b9] = " Zona baixa ( |fffd|V )"
   [b10] = " Pastagem ( |fffd|V )"
   [b11] = " Pomar ( |fffd|V )"
   [b12] = " Estufa ( |fffd|V )"
   [b13] = "Outro ( |fffd|V )"
   [b14] = "Nao usa terra" 'The choises of the crop list which does not use land
   [b15] = "Rendimento (kg/ha)"
   [b16] = "Custo unitario (MT/kg)"
   [b17] = "Outros rendimentos (MT/ha)"
   [b18] = "Rendimento bruto total ( |fffd|V )"
   [b19] = "Custo de semente ( |fffd|V )"
   [b20] = "Custo de fertilizantes ( |fffd|V )"
   [b21] = "Agro-quimicos e sanitarios ( |fffd|V )"
   [b22] = "Custo de energia ( |fffd|V )"
   [b23] = "Custo de outros materiais ( |fffd|V )"
   [b24] = "Melhoramento da terra e uso de agua ( |fffd|V )"
   [b25] = "Custo de renda ( |fffd|V )"
   [b26] = "Custo de transporte ( |fffd|V )"
   [b27] = "Outros custos ( |fffd|V )"
   [b28] = "Custos totais variaveis ( |fffd|V )"
   [b29] = "Coeficiente do lucro ( |fffd|V )"
   [b30] = "Lucro proporcional (MT)"
   [b31] = "Custos fixos (depreciacao etc.) ( |fffd|V )"
   [b32] = "Renda de terra ( |fffd|V )"
   [b33] = "Custo de mao-de-obra a tempo inteiro ( |fffd|V )"
   [b34] = " Custo de mao-de-obra a tempo parcial ( |fffd|V )"
   [b35] = "Lucro agrario ( |fffd|V )"
   'Supplement the item name (beginning of the table)
   Cells(6, last_crop_col + 2) = "Area de terra alugada (ha)" & Chr(10) & "Trabalhador sazonal (dias)"
   Cells(6, last_crop_col + 3) = "Aluguer de terra" & Chr(10) & " Trabalhador sazonal" & Chr(10) & "Preco unitario"
  
   
   
   ActiveSheet.Protect AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
End Sub

Sub change_item_name_fCondition()
   tmpArray = Array()
   'Set tmp = Range("b4:b28")
   'B-column
   [b1] = "Condicoes de cultivo"
   [b4] = "Mao-de-obra a tempo inteiro"
   [b5] = "1) Mao-de-obra familiar"
   [b6] = "2) Mao-de-obra contratada"
   [b9] = "Mao-de-obra a tempo parcial"
   [b11] = "Categoria da terra"
   [b12] = "1) Zona alta"
   [b13] = "2) Zona baixa"
   [b14] = "-"
   [b15] = "-"
   [b16] = "-"
   [b17] = "6) Outra"
   [b19] = "Uso de mao-de-oba a tempo parcial"
   [b20] = "Uso de terra alugada"
   [b22] = "Ajuste de producao de arroz"
   [b23] = "Taxa da rotacao de culturas"
   [b25] = "Custos fixos"
   [b26] = "1) Maquinarias"
   [b27] = "2) Instalacao"
   [b28] = "3) Outros"
   
   'D,E,F-column
   [d3] = "Numero"
   [e3] = "Horas de trabalho"
   [f3] = "Salario anual"
   
   [d8] = "Jorna diaria"
   [e8] = "Horas de trabalho"
   
   [d11] = "Terra propria"
   [e11] = "Terra alugavel"
   [f11] = "Taxa de arrenda"
   
   'I-column
   [i3] = "Dias de trabalho e contratacao"
   [i4] = "|fffd|@|fffd|uTempo inteiro|fffd|v:|fffd|@Numero de dias que voce pode trabalhar"
   [i5] = "|fffd|@|fffd|uTempo parcial|fffd|v:|fffd|@Numero maximo de dias que voce pode empregar" 'togle string:"Numero de dias de empregar sempre"
   [i5].Characters(Start:=19).Font.ColorIndex = 3
   [i7] = "Jan.Ini"
   [i8] = "   .Med"
   [i9] = "   .Fin"
   [i10] = "Fev.Ini"
   [i11] = "   .Med"
   [i12] = "   .Fin"
   [i13] = "Mar.Ini"
   [i14] = "   .Med"
   [i15] = "   .Fin"
   [i16] = "Abr.Ini"
   [i17] = "   .Med"
   [i18] = "   .Fin"
   [i19] = "Mai.Ini"
   [i20] = "   .Med"
   [i21] = "   .Fin"
   [i22] = "Jun.Ini"
   [i23] = "   .Med"
   [i24] = "   .Fin"
   [i26] = "Culturas de subsistencia"
   [i27] = "Cultura"
   
   'J-column
   [j6] = "Inteiro"
   [j27] = "Qtd (kg)"
   
   'L-column
   [L6] = "Parcial"
   
   'M-column
   [m7] = "Jul.Ini"
   [m8] = "   .Med"
   [m9] = "   .Fin"
   [m10] = "Ago.Ini"
   [m11] = "   .Med"
   [m12] = "   .Fin"
   [m13] = "Set.Ini"
   [m14] = "   .Med"
   [m15] = "   .Fin"
   [m16] = "Out.Ini"
   [m17] = "   .Med"
   [m18] = "   .Fin"
   [m19] = "Nov.Ini"
   [m20] = "   .Med"
   [m21] = "   .Fin"
   [m22] = "Dez.Ini"
   [m23] = "   .Med"
   [m24] = "   .Fin"
   [m26] = "Mistura ou Consociacao"
   [m27] = "Nome"
   
   'N-column
   [n6] = "Inteiro"
   [n27] = "Numero de culturas"
   
   'P -Column
   [p6] = "Parcial"
   
End Sub

Sub setting_input_rule_iEdit() '|fffd||13a6|
   [L11].Validation.Add Type:=xlValidateList, _
      AlertStyle:=xlValidAlertStop, Operator:=xlBetween, _
      Formula1:=" ,1,2,3"
End Sub

Sub add_item_fCondition()

End Sub

Sub add_jikyu_konsaku_data_range()
   ActiveSheet.Unprotect
   ActiveWorkbook.Names.Add name:="FC_jikyu", RefersTo:="=$i$28:$j$32"
   ActiveWorkbook.Names.Add name:="FC_konsaku", RefersTo:="=$m$28:$n$32"
   [i26] = "Subsistence crop"
   [i27] = "Crop": [j27] = "qty(kg)"
   [m26] = "Mixed cropping"
   [m27] = "Name": [n27] = "num of crop"
   
   Range("D19").Copy
   [FC_jikyu].PasteSpecial Paste:=xlPasteFormats
   Range("D19").Copy
   [FC_konsaku].PasteSpecial Paste:=xlPasteFormats
   
   Range("j6").Copy
   Range("i27,j27,m27,n27").PasteSpecial Paste:=xlPasteFormats
   Application.CutCopyMode = False
'   Range("n27").ShrinkToFit = True
   Range("i26:p32").Font.ColorIndex = xlAutomatic
   [b1].Select
End Sub

Sub make_mixed_cropping_process()
   Application.ScreenUpdating = False
   base_row = Cells(Rows.Count, 2).End(xlUp).Row
   For k = 1 To 15
      If Left(Sheets("fCondition").[FC_konsaku].Cells(k, 1), 5) = "Mixed" Then
         last_row = Cells(Rows.Count, 2).End(xlUp).Row
         add_row = last_row + 1
         hosoku = "" 'remarks column"E"
         Cells(add_row, 1) = True
         Cells(add_row, 2) = Cells(last_row, 2) + 1
         Cells(add_row, 3) = "BFM.$$$"
         Cells(add_row, 4) = Sheets("fCondition").[FC_konsaku].Cells(k, 1)
         
         For i = 3 To base_row
            n = InStr(Cells(i, 4), "(")
            m = InStr(Cells(i, 4), ")")
            If n > 0 And m > 0 Then
               nCrop = Left(Cells(i, 4), n - 1) 'name of mixed cropping
               mCrop = Mid(Cells(i, 4), n + 1, m - n - 1) 'name of crop
            Else
               nCrop = ""
               mCrop = ""
            End If
            If nCrop = Sheets("fCondition").[FC_konsaku].Cells(k, 1) Then
               hosoku = hosoku & "_" & mCrop
               land_category = Cells(i, "BY") 'name of land_category
            End If
         Next i
         For j = 10 To 65
            For i = 3 To base_row
               n = InStr(Cells(i, 4), "(")
               If n > 0 Then
                  nCrop = Left(Cells(i, 4), n - 1)
               Else
                  nCrop = ""
               End If
               If nCrop = Sheets("fCondition").[FC_konsaku].Cells(k, 1) Then
                  Cells(add_row, j) = Cells(add_row, j) + Cells(i, j)
               End If
            Next i
         Next j
         Cells(add_row, "z") = Cells(add_row, "z") + Cells(add_row, "j")
         For j = 79 To 80
            For i = 3 To base_row
               n = InStr(Cells(i, 4), "(")
               If n > 0 Then
                  nCrop = Left(Cells(i, 4), n - 1)
               Else
                  nCrop = ""
               End If
               If nCrop = Sheets("fCondition").[FC_konsaku].Cells(k, 1) Then
                  Cells(add_row, j) = Cells(add_row, j) + Cells(i, j)
               End If
            Next i
         Next j
         Cells(add_row, 72) = "Beginning"
         Cells(add_row, 73) = "End"
         Cells(add_row, 74) = 1
         Cells(add_row, 77) = land_category '"Field"
         Cells(add_row, 79) = 1
         Cells(add_row, 80) = 12
      End If
         Cells(add_row, 5) = hosoku
   Next k
   
End Sub

Sub add_subsistence_crop_constraint()
   Application.ScreenUpdating = False
   Set acti_sheet = ActiveSheet
   iData_last_row = Sheets("iData").Cells(Rows.Count, 4).End(xlUp).Row
   For i = 1 To Sheets("fCondition").[FC_jikyu].Cells.Row
      siki = ""
      sCrop = Sheets("fCondition").[FC_jikyu].Cells(i, 1) 'name of subsistence crop
      If sCrop <> "" Then
         model_last_row = Sheets("(Model)").Cells(Rows.Count, 3).End(xlUp).Row
         Sheets("(Model)").Cells(model_last_row + 1, 3) = sCrop & "_Llimit"
         ix = 0
         For j = 3 To iData_last_row
            nCrop = Sheets("iData").Cells(j, 4) 'name of item(Crop)
            nArea = Sheets("iData").Cells(j, 3) 'name of Area
            If Sheets("iData").Cells(j, 1).Value And nArea <> "BFM.$$$" Then 'flag of in model or out of model
               ix = ix + 1
               If (sCrop = nCrop) Then  'single cropping
                  siki = siki & "+" & Sheets("iData").Cells(j, "H") & "x" & ix
               End If
            End If
         Next j
         For j = 3 To iData_last_row
            ik = 0
            nCrop = Sheets("iData").Cells(j, 4) 'name of item
            If (Not Sheets("iData").Cells(j, 1)) And (sCrop <> nCrop) And (InStr(nCrop, sCrop)) > 0 Then  'mixed cropping
               For k = 1 To Sheets("fCondition").[FC_konsaku].Cells.Row
                  clValue = Sheets("fCondition").[FC_konsaku].Cells(k, 1)
                  If clValue <> "" Then ik = ik + 1
                  If InStr(nCrop, clValue) > 0 And clValue <> "" Then
                     siki = siki & "+" & Sheets("iData").Cells(j, "H") & "x" & (ix + ik)
                     Exit For
                  End If
               Next k
            End If
         Next j
      End If
      If siki <> "" Then
         Sheets("(Model)").Cells(model_last_row + 1, 4) _
         = Sheets("fCondition").[FC_jikyu].Cells(i, 2) & "<=" & siki
      End If
   Next i
   Sheets("(Model)").Select
   Application.Run "formula2tableau_for_BFM"
   acti_sheet.Select
End Sub

Sub add_subsistence_crop_constraint_bk()
   Set acti_sheet = ActiveSheet
   For i = 1 To Sheets("fCondition").[FC_jikyu].Cells.Row
      siki = ""
      sCrop = Sheets("fCondition").[FC_jikyu].Cells(i, 1)
      If sCrop <> "" Then
         last_row = Sheets("(Model)").Cells(Rows.Count, 3).End(xlUp).Row
         Sheets("(Model)").Cells(last_row + 1, 3) = sCrop & "_Llimit"
'         siki = Sheets("fCondition").[FC_jikyu].Cells(i, 2) & "<="
         j = 3
         ix = 0
         Do While Sheets("iData").Cells(j, 4) <> ""
            nCrop = Sheets("iData").Cells(j, 4)
            If (sCrop = nCrop) And (Sheets("iData").Cells(j, 1)) Then 'single cropping
               ix = ix + 1
               siki = siki & "+" & Sheets("iData").Cells(j, "H") & "x" & ix
            ElseIf InStr(nCrop, sCrop) > 0 Then 'mixed cropping
               For k = 1 To Sheets("fCondition").[FC_konsaku].Cells.Row
                  clValue = Sheets("fCondition").[FC_konsaku].Cells(k, 1)
                  If InStr(nCrop, clValue) > 0 Then
                     siki = siki & "+" & Sheets("iData").Cells(j, "H") & "x" & (ix + k)
                     Exit For
                  End If
               Next k
            End If
            
            j = j + 1
         Loop
      End If
      If siki <> "" Then
         Sheets("(Model)").Cells(last_row + 1, 4) _
         = Sheets("fCondition").[FC_jikyu].Cells(i, 2) & "<=" & siki
      End If
   Next i
   
End Sub

Sub delete_MixedData_madeByBFMmz()
   tmp = ActiveSheet.name
   Sheets("iData").Select
   Rows((base_row + 1) & ":" & (base_row + 5)).Delete
   Sheets(tmp).Select
End Sub

Sub return_working_days_data_copied_in_FCsheet() 'return_to_FCMZsheet
End Sub

Function sheet_exist(sheet_name As String)
   sheet_exist = False
   If ActiveWindow Is Nothing Then Exit Function
   For Each mb In Sheets
      If mb.name = sheet_name Then sheet_exist = True: Exit Function
   Next mb
End Function

Sub mz_show_usage()
   MsgBox "Desculpa...sob construcao.", , "BFMmz"
End Sub

Sub close_self()
   ThisWorkbook.Close
End Sub

Function fullpath2filename(fname)
   For i = Len(fname) To 1 Step -1
      If Mid(fname, i, 1) = "\" Then ipos = i: Exit For
   Next i
   fullpath2filename = Mid(fname, ipos + 1)
End Function

Sub change_codes_which_menu_excutes() 'record_of_sample
'    '===============================================================================
'    'Change codes menu excute
'        'a = 0 'only while debugging
'        Set oTmp = CommandBars.ActiveMenuBar.Controls("BFM(&B)")
'        For Each mn In oTmp.Controls
'           If mn.Caption = "iData" Then
'              For Each mn2 In mn.Controls
'                 If mn2.Caption = "New book" Then
'                    mn2.OnAction = "BFMe.xla!read_data_base" 'Change codes menu excute
'                    mn2.Caption = "New book mz" 'Change menu name
'                    'a = 2 'only while debugging
'                 End If
'              Next mn2
'           End If
'        Next mn
'        'MsgBox a 'only while debugging
'    '===============================================================================
End Sub
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim save_flag As Byte
Dim active_sh As String

Private Sub Worksheet_Activate()
   On Error Resume Next
   CommandBars("Cell").Controls("BFM(&B)").Visible = False
   CommandBars("Cell").Controls("eDB(&e)").Visible = True
   CommandBars("side_menu_i").Visible = False
   CommandBars("side_menu_c").Visible = False
   CommandBars("side_menu_e").Visible = True
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
   save_flag = 5
   active_sh = ActiveSheet.name
End Sub

Private Sub Worksheet_Deactivate()
   On Error Resume Next
   CommandBars("Cell").Controls("BFM(&B)").Visible = True
   CommandBars("Cell").Controls("eDB(&e)").Visible = False
   CommandBars("side_menu_i").Visible = True
   CommandBars("side_menu_e").Visible = False
   If (save_flag = 5) And (active_sh = "iEdit") Then
      save_flag = 1
      Run "edit3_determine"
   End If
End Sub



Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
   On Error Resume Next
   CommandBars("Cell").Controls("BFM(&B)").Visible = True
   CommandBars("Cell").Controls("eDB(&e)").Visible = False
   CommandBars("side_menu_i").Visible = True
   CommandBars("side_menu_c").Visible = False
   CommandBars("side_menu_e").Visible = False
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
   [a1].Font.Bold = True
   [a1].Font.ColorIndex = 5 'blue
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
    auto_open_bk
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{AE1460F6-32D6-4D35-97D0-7EA235AF2396}{5261089A-0DB4-4711-B5A9-405CDA0B5A67}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton2_Click()
   d_cr = vbCr & vbCr
   If Val(Application.Version) < 12 Then ' Excel 2003 and earlier
      msg_content = _
      "Obrigado por usar BFM" & d_cr & _
      "BFM e um programa que o ajuda a criar um plano ideal de cultivo" & d_cr & _
      "Quando iniciar BFM, voce encontra o menu [BFM] na parte superior esquerda e direita da tela" & d_cr & _
      "Ao clicar no menu [iData|fffd|n-|fffd|mNovo livro|fffd|n, voce encontra a folha de ""iData""" & d_cr & _
      "Nesta folha, voce pode criar um banco de dados de indices agricolas e modifica-lo" & d_cr & _
      "Ao clicar no menu [fCondition|fffd|n-|fffd|mNovo|fffd|n, voce encontra a folha de ""fCondition""" & d_cr & _
      "Nesta folha, voce pode criar um banco de dados de condicoes agricolas e modifica-lo" & d_cr & _
      "Ao clicar no menu [Criar um plano agrario], voce pode calcular um plano ideal de cultivo" & d_cr & _
      "Se voce tiver problemas ou duvidas, entre em contacto com <koidejunji@affrc.go.jp>"
      MsgBox msg_content
   Else ' Excel 2007 and later
      msg_content = _
      "Obrigado por usar BFM" & d_cr & _
      "BFM e um programa que o ajuda a criar um plano ideal de cultivo" & d_cr & _
      "Quando iniciar BFM, voce pode encontrar o menu [BFM] e os submenus no guia[Addin] do [Ribbon]." & d_cr & _
      "Ao clicar no menu [iData|fffd|n-|fffd|mNovo livro|fffd|n, voce encontra a folha de ""iData""" & d_cr & _
      "Nesta folha, voce pode criar um banco de dados de indices agricolas e modifica-lo" & d_cr & _
      "Ao clicar no menu [fCondition|fffd|n-|fffd|mNovo|fffd|n, voce encontra a folha de ""fCondition""" & d_cr & _
      "Nesta folha, voce pode criar um banco de dados de condicoes agricolas e modifica-lo" & d_cr & _
      "Ao clicar no menu [Criar um plano agrario], voce pode calcular um plano ideal de cultivo" & d_cr & _
      "Se voce tiver problemas ou duvidas, entre em contacto com <koidejunji@affrc.go.jp>"
      MsgBox msg_content
   End If
End Sub

Private Sub CommandButton8_Click()
   make_user_form_not_show
   UserForm1.Hide
End Sub
Sub make_user_form_not_show()
   If UserForm1.OptionButton2.Value = True Then
      show_msg_mz = 0 'by ooisi
   Else
      show_msg_mz = 1 'by ooisi
   End If
   On Error Resume Next
   Df = ThisWorkbook.Path 'by ooisi
   Open Df & "\bfm_mz.ini" For Output As 2
   Print #2, show_msg_mz 'by ooisi
   Close 2
End Sub

Private Sub Label1_Click()

End Sub

Private Sub Label15_Click()

End Sub


INQUEST-PP=macro
