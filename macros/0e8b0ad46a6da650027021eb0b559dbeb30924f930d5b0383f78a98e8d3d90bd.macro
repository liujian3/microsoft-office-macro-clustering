Attribute VB_Name = "Common"

'*********************************************************************8
'***
'*    Common Module across ALL Workbooks except EntFuncs.Xls
'***
'*********************************************************************8

Option Explicit
Option Private Module

Global EntServer As Object
Global ServerSet As Boolean


' returns True if the passed Nominal Code is valid
Public Function ValidCompany(Company$) As Boolean
    Company$ = Trim(Company$)
    
    If (Len(Company) > 0) And (Len(Company) <= 6) Then
        ValidCompany = True
    Else
        Error 516
        ValidCompany = False
    End If
End Function
 

' returns True if the passed General Ledger Code is valid
Public Function ValidGLCode(GLCode As Long) As Boolean
    If (GLCode <= 0) Then
        If (GLCode < 0) Then
            Error 511
        End If
        
        ValidGLCode = False
    Else
        ValidGLCode = True
    End If
End Function


' returns True if the passed year is valid
Public Function ValidYear(TheYear%) As Boolean
    If ((TheYear > 1900) And (TheYear < 2100)) Or (TheYear = -99) Then
        ' Actual Year or F6 Year
        ValidYear = True
    Else
        Error 512
        ValidYear = False
    End If
End Function


' returns True if the passed period is valid
Public Function ValidPeriod(ThePeriod%) As Boolean
    If ((ThePeriod >= 0) And (ThePeriod <= 99)) Or (ThePeriod = -99) Or (ThePeriod = -98) Or ((ThePeriod >= 101) And (ThePeriod <= 199)) Then
        ' Actual Period or F6 Period or CTD or CTD Period Offset
        ValidPeriod = True
    Else
        Error 513
        ValidPeriod = False
    End If
End Function

Public Function ValidTransactionPeriod(ThePeriod%) As Boolean
    If (ThePeriod >= 1) And (ThePeriod <= 99) Then
        ' Actual Period or F6 Period or CTD or CTD Period Offset
        ValidTransactionPeriod = True
    Else
        Error 513
        ValidTransactionPeriod = False
    End If
End Function


' returns True if the passed currency is valid
Public Function ValidCcy(TheCcy%) As Boolean
    If (TheCcy < 0) Or (TheCcy > 90) Then
        Error 514
        ValidCcy = False
    Else
        ValidCcy = True
    End If
End Function


' returns true if the passed customer code is valid
Public Function ValidCustCode(CustCode$, CSType$) As Boolean
    CustCode$ = UCase(Trim(CustCode$))

    If (Len(CustCode) > 0) And (Len(CustCode) <= 6) Then
        ValidCustCode = True
    Else
        ValidCustCode = False
        If (CSType$ = "C") Then
            Error 515
        Else
            Error 526
        End If
    End If
End Function

' returns True if the passed Stock Code is valid
Public Function ValidStockCode(StockCode$) As Boolean
    StockCode$ = UCase(Trim(StockCode$))
    
    ValidStockCode = True
End Function

' returns True if the passed Stock Code is valid
Public Function ValidLocation(LocCode$) As Boolean
    LocCode$ = UCase(Trim(LocCode$))
    
    If (Len(LocCode$) > 0) And (Len(LocCode$) <= 3) Then
        ValidLocation = True
    Else
        ValidLocation = False
        Error 527
    End If
End Function

' returns True if the passed Nominal Code is valid
Public Function ValidCCDep(IsCC%, ByRef CCDep$) As Boolean
    CCDep$ = UCase(Trim(CCDep$))

    If (Len(CCDep$) >= 0) And (Len(CCDep$) <= 3) Then
        ValidCCDep = True
    Else
        If IsCC% = True Then
            Error 519
        Else
            Error 520
        End If
        ValidCCDep = False
    End If
End Function


' Returns True if the passed JC Total Type is valid
Public Function ValidTotType(TType%) As Boolean
    If (TType% = 10) Or (TType% = 20) Or (TType% = 30) Or (TType% = 40) Or (TType% = 50) Or (TType% = 60) Or (TType% = 99) Or (TType% = 160) Or (TType% = 170) Or (TType% = 180) Or (TType% = 190) Then
        ValidTotType = True
    Else
        Error 531
        ValidTotType = False
    End If
End Function


' returns True if the passed Stock Code is valid
Public Function ValidJobCode(JobCode$) As Boolean
    JobCode$ = UCase(Trim(JobCode$))
    
    If (Len(JobCode$) > 0) And (Len(JobCode$) <= 10) Then
        ValidJobCode = True
    Else
        ValidJobCode = False
        Error 521
    End If
End Function


' returns True if the passed date is valid
Public Function ValidDate(TheDate$, ActDate As Date, ErrNo%) As Boolean
On Error GoTo ValidDate_Error

    If IsDate(TheDate) Then
        ValidDate = True
        ActDate = CDate(TheDate$)
    Else
        ValidDate = False
        Error ErrNo%
    End If
    
    GoTo ValidDate_Exit
    
ValidDate_Error:
    Error ErrNo%
    ValidDate = False

ValidDate_Exit:
End Function


' Validates the Posted/Committed parameter used in some JC history functions
Public Function ValidPC(PCStr$) As Boolean
    PCStr$ = UCase(PCStr$)
    
    If (Len(PCStr$) = 1) And ((Left$(PCStr$, 1) = "P") Or (Left$(PCStr$, 1) = "C")) Then
        ' 1 Char long and "P" or "C"
        ValidPC = True
    Else
        Error 533       ' Invalid Posted/Commited Flag
        ValidPC = False
    End If
End Function


' returns a formatted error string
Public Function GetErrorStr() As String
    GetErrorStr = "Error (" + Trim(Str(Err)) + "): " + EntErrorStr(Err)
End Function


' returns a formatted error string for number fields
Public Function GetErrorNumStr() As String
    GetErrorNumStr = "#(" + Trim(Str(Err)) + "): " + EntErrorStr(Err)
End Function


' Checks for the local server, and gets the server from EntFuncs.XLA if necessary
Public Function LocalCheckServer() As Boolean
On Error GoTo LocalCheckServer_Error

    If Not ServerSet Then
        ' Server Not Running - Start server
        If ZSYS9194(719, EntServer) Then
            ServerSet = True
        Else
            ServerSet = False
        End If
    End If

    ' Finish procedure without causing an error
    LocalCheckServer = ServerSet
    GoTo LocalCheckServer_Exit
    
LocalCheckServer_Error:
    Error 500
    LocalCheckServer = False

LocalCheckServer_Exit:
End Function


Attribute VB_Name = "GLHist"
Option Explicit

' Gets a specified value for the passed general ledger code
Private Function GetGLValue3(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, _
                             CCDepType$, CostCentre$, Department$, _
                             Commited%) As Variant
On Error GoTo GetGLValue3_Error
    Dim CompStr$, Ty%, Tp%, TC%, GLC&, Mode As Integer
    Dim DblVal As Double, RetVal%
     
    DblVal# = 0#
    
    If ValidCompany(Company) And ValidYear(TheYear) And ValidPeriod(ThePeriod) And ValidCcy(TheCcy) And ValidGLCode(GLCode) Then
        If LocalCheckServer() Then
            CompStr$ = UCase(Company$)
            Ty% = TheYear%
            Tp% = ThePeriod%
            TC% = TheCcy%
            GLC& = GLCode&
            Mode = ValueReq%
                        
            RetVal% = EntServer.GetNominalValue(Mode%, CompStr$, Ty%, Tp%, TC%, GLC&, _
                                                CostCentre$, Department$, CCDepType$, _
                                                DblVal#, Commited%)
        
            If (RetVal% <> 0) Then
                Error RetVal%
            End If
        End If
    End If
      
    GetGLValue3 = DblVal
    
    GoTo GetGLValue3_Exit
        
GetGLValue3_Error:
    GetGLValue3 = GetErrorNumStr

GetGLValue3_Exit:
    
End Function ' GetGLValue3

'------------------------------------------------------------------------------

' wrapper function so I don't have to add the new separate Cost Centre/Department parameters into all the calls!
Private Function GetGLValue2(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CCDep$, CCDepType$, Commited%) As Variant
    Dim CC$, Dept$
        
    If (CCDepType$ = "C") Then
        ' Cost Centre
        CC$ = CCDep$
        Dept$ = ""
    Else
        ' Normal or Department
        CC$ = ""
        Dept$ = CCDep$
    End If
    
    GetGLValue2 = GetGLValue3(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, _
                              CCDepType$, CC$, Dept$, _
                              Commited%)
End Function ' GetGLValue2

' wrapper function so I don't have to add the Commited% parameter into all the calls!
Private Function GetGLValue(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CCDep$, CCDepType$) As Variant
    GetGLValue = GetGLValue2(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CCDep$, CCDepType$, 0)
End Function

'------------------------------------------------------------------------------

' Gets a Cost Centre/Department name for a specified code
Private Function GetCCDpName(Company$, CCDpType$, CCDpCode$) As String
On Error GoTo GetCCDpName_Error
    Dim CCDpName$, RetVal%
     
    RetVal% = 0
     
    If ValidCompany(Company) And ValidCCDep((CCDpType$ = "C"), CCDpCode$) Then
        If LocalCheckServer() Then
            Company$ = UCase(Company$)
            CCDpCode$ = UCase(CCDpCode$)
            
            RetVal% = EntServer.GetCCDepName(Company$, CCDpType$, CCDpCode$, CCDpName$)
            
            If (RetVal% <> 0) Then
                Error RetVal%
            End If
        End If
    End If
      
    GetCCDpName = CCDpName$
    
    GoTo GetCCDpName_Exit
    
GetCCDpName_Error:
    GetCCDpName = GetErrorStr$
    
GetCCDpName_Exit:

End Function

'*******************************************************************************
' Name:        EntGLName
' Description: Gets the description for the specified general ledger code
'*******************************************************************************
Public Function EntGLName(Company$, GLCode&) As String
Attribute EntGLName.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLName_Error
    Dim CompStr$, CompName$, GLC&, IntVal%
    
    CompName$ = ""
    
    If ValidCompany(Company) And ValidGLCode(GLCode) Then
        If LocalCheckServer() Then
            CompStr = UCase(Company$)
            GLC& = GLCode&
            IntVal% = EntServer.GetNominalName(CompStr, GLC&, CompName$)

            If (IntVal <> 0) Then
                Error IntVal
            End If
        End If
    End If
      
    GoTo EntGLName_Exit
    
EntGLName_Error:
    CompName$ = GetErrorStr$
    
EntGLName_Exit:
    EntGLName = CompName$
End Function
 
'*******************************************************************************
' Name:        EntGLBudget
' Description: Gets the Budget1 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLBudget(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
Attribute EntGLBudget.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLBudget = GetGLValue(1, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLBudget2
' Description: Gets the Budget2 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLBudget2(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
Attribute EntGLBudget2.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLBudget2 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLActual
' Description: Gets the Actual Value for the passed general ledger code
'*******************************************************************************
Public Function EntGLActual(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
Attribute EntGLActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLActual = GetGLValue(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLDebit
' Description: Gets the Debit Value for the passed general ledger code
'*******************************************************************************
Public Function EntGLDebit(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
Attribute EntGLDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDebit = GetGLValue(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLCredit
' Description: Gets the Credit Value for the passed general ledger code
'*******************************************************************************
Public Function EntGLCredit(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
Attribute EntGLCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCredit = GetGLValue(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLCCName
' Description: Gets a Cost Centre Name
'*******************************************************************************
Public Function EntGLCCName(Company$, CCCode$) As String
Attribute EntGLCCName.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCName = GetCCDpName(Company$, "C", CCCode$)
End Function

'*****************************************************************************************
' Name:        EntGLCCBudget
' Description: Gets the Budget1 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCBudget(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCBudget.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCBudget = GetGLValue(1, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCBudget2
' Description: Gets the Budget2 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCBudget2.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCBudget2 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCActual
' Description: Gets the Actual value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCActual = GetGLValue(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCDebit
' Description: Gets the Debit value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDebit = GetGLValue(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCCredit
' Description: Gets the Credit value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCCredit = GetGLValue(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*******************************************************************************
' Name:        EntGLDpName
' Description: Gets a Department Name
'*******************************************************************************
Public Function EntGLDpName(Company$, DpCode$) As String
Attribute EntGLDpName.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpName = GetCCDpName(Company$, "D", DpCode$)
End Function

'*****************************************************************************************
' Name:        EntGLDpBudget
' Description: Gets the Budget1 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpBudget(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDpBudget.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpBudget = GetGLValue(1, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
 
'*****************************************************************************************
' Name:        EntGLDpBudget2
' Description: Gets the Budget2 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDpBudget2.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpBudget2 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function

'*****************************************************************************************
' Name:        EntGLDpActual
' Description: Gets the Actual value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDpActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpActual = GetGLValue(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function

'*****************************************************************************************
' Name:        EntGLDpDebit
' Description: Gets the Debit value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDpDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpDebit = GetGLValue(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function

'*****************************************************************************************
' Name:        EntGLDpCredit
' Description: Gets the Credit value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDpCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDpCredit = GetGLValue(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
  
'*******************************************************************************
' Name:        EntGLGetTxMovement
' Description: Gets the movement for the specified GL Code during a specified
'              period with optional filtering on Cost Centre, Department,
'              Currency and Account Code.
'*******************************************************************************
Public Function EntGLGetTxMovement(Company$, GLCode&, StartDate$, EndDate$, TheCcy%, CostCentre$, Dept$, AccCode$) As Variant
Attribute EntGLGetTxMovement.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLGetTxMovement_Error
    Dim TxMove#, SDate As Date, EDate As Date, GLC&, TC%, TheCC$, TheDp$, TheAc$
    Dim VarSDate As Variant, VarEDate As Variant, RetVal%
     
    TxMove# = 0#
     
    If ValidCompany(Company) And ValidGLCode(GLCode) And ValidDate(StartDate, SDate, 534) And ValidDate(EndDate, EDate, 535) And ValidCcy(TheCcy%) Then
        ' Check dates are valid
        VarSDate = SDate
        VarEDate = EDate
        If (VarEDate >= VarSDate) Then
            TheCC$ = ""
            If (Trim(CostCentre$) <> "") Then
                ' Validate CostCentre$ parameter
                CostCentre$ = UCase(Trim(CostCentre$))
                If ValidCCDep(True, CostCentre$) Then
                    TheCC$ = CostCentre$
                End If
            End If
                
            TheDp$ = ""
            If (Trim(Dept$) <> "") Then
                ' Validate Dept$ parameter
                Dept$ = UCase(Trim(Dept$))
                If ValidCCDep(False, Dept$) Then
                    TheDp$ = Dept$
                End If
            End If
            
            TheAc$ = ""
            If (Trim(AccCode$) <> "") Then
                ' Validate AccCode$ parameter
                AccCode$ = UCase(Trim(AccCode$))
                If ValidCustCode(AccCode$, "C") Then
                    TheAc$ = AccCode$
                End If
            End If
            
            If LocalCheckServer() Then
                Company$ = UCase(Company$)
                GLC& = GLCode&
                TC% = TheCcy%
                
                RetVal% = EntServer.GetGLTxMove(Company$, GLC&, VarSDate, VarEDate, TC%, TheCC$, TheDp$, TheAc$, TxMove#)
            
                If (RetVal% <> 0) Then
                    Error RetVal%
                End If
            End If
        Else
            ' End Date must be on or after Start Date
            Error 535
        End If
    End If
      
    EntGLGetTxMovement = TxMove#
    
    GoTo EntGLGetTxMovement_Exit
    
EntGLGetTxMovement_Error:
    EntGLGetTxMovement = GetErrorStr$
    
EntGLGetTxMovement_Exit:

End Function

'*******************************************************************************
' Name:        EntGLAltCode
' Description: Gets the description for the specified general ledger code
'*******************************************************************************
Public Function EntGLAltCode(Company$, GLCode&) As String
Attribute EntGLAltCode.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLAltCode_Error
    Dim CompStr$, CompName$, GLC&, IntVal%
    
    CompName$ = ""
    
    If ValidCompany(Company) And ValidGLCode(GLCode) Then
        If LocalCheckServer() Then
            CompStr = UCase(Company$)
            GLC& = GLCode&
            IntVal% = EntServer.GetNomAltCode(CompStr, GLC&, CompName$)

            If (IntVal <> 0) Then
                Error IntVal
            End If
        End If
    End If
      
    GoTo EntGLAltCode_Exit
    
EntGLAltCode_Error:
    CompName$ = GetErrorStr$
    
EntGLAltCode_Exit:
    EntGLAltCode = CompName$
End Function

'*****************************************************************************************
' Name:        EntGLCOMCredit
' Description: Gets the Committed Credit value for the passed general ledger code
'*****************************************************************************************
Public Function EntGLCOMCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&) As Variant
Attribute EntGLCOMCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCOMCredit = GetGLValue2(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N", 1)
End Function

'*****************************************************************************************
' Name:        EntGLCCCOMCredit
' Description: Gets the Committed Credit value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCCOMCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCCOMCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCCOMCredit = GetGLValue2(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C", 1)
End Function

'*****************************************************************************************
' Name:        EntGLDPCOMCredit
' Description: Gets the Committed Credit value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDPCOMCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDPCOMCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDPCOMCredit = GetGLValue2(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D", 1)
End Function
 
'*****************************************************************************************
' Name:        EntGLCOMDebit
' Description: Gets the Committed Debit value for the passed general ledger code
'*****************************************************************************************
Public Function EntGLCOMDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&) As Variant
Attribute EntGLCOMDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCOMDebit = GetGLValue2(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N", 1)
End Function
  
'*****************************************************************************************
' Name:        EntGLCCCOMDebit
' Description: Gets the Committed Debit value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCCOMDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCCOMDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCCOMDebit = GetGLValue2(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C", 1)
End Function

'*****************************************************************************************
' Name:        EntGLDPCOMDebit
' Description: Gets the Committed Debit value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDPCOMDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDPCOMDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDPCOMDebit = GetGLValue2(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D", 1)
End Function

'*****************************************************************************************
' Name:        EntGLCOMActual
' Description: Gets the Committed Actual value for the passed general ledger code
'*****************************************************************************************
Public Function EntGLCOMActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&) As Variant
Attribute EntGLCOMActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCOMActual = GetGLValue2(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N", 1)
End Function

'*****************************************************************************************
' Name:        EntGLCCCOMActual
' Description: Gets the Committed Actual value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCCOMActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
Attribute EntGLCCCOMActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCCOMActual = GetGLValue2(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C", 1)
End Function

'*****************************************************************************************
' Name:        EntGLDPCOMActual
' Description: Gets the Committed Actual value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDPCOMActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
Attribute EntGLDPCOMActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLDPCOMActual = GetGLValue2(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D", 1)
End Function

'-------------------------------------------------------------------------------------------------------------

'*******************************************************************************
' Name:        EntGLCCDpActual
' Description: Gets the Actual Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpActual = GetGLValue3(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function ' EntGLCCDpActual
 
'*******************************************************************************
' Name:        EntGLCCDpBudget
' Description: Gets the Budget1 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpBudget(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpBudget.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpBudget = GetGLValue3(1, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function ' EntGLCCDpBudget
 
'*******************************************************************************
' Name:        EntGLCCDpBudget2
' Description: Gets the Budget2 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpBudget2.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpBudget2 = GetGLValue3(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function ' EntGLCCDpBudget2

'*******************************************************************************
' Name:        EntGLCCDpDebit
' Description: Gets the Debit Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpDebit = GetGLValue3(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function ' EntGLCCDpDebit

'*******************************************************************************
' Name:        EntGLCCDpCredit
' Description: Gets the Credit Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpCredit = GetGLValue3(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function ' EntGLCCDpCredit

'-------------------------------------------------------------------------------------------------------------

'*******************************************************************************
' Name:        EntGLCCDpComActual
' Description: Gets the Committed Actual Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpComActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpComActual.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpComActual = GetGLValue3(3, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 1)
End Function ' EntGLCCDpComActual

'*******************************************************************************
' Name:        EntGLCCDpComDebit
' Description: Gets the Committed Debit Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpComDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpComDebit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpComDebit = GetGLValue3(4, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 1)
End Function ' EntGLCCDpComDebit

'*******************************************************************************
' Name:        EntGLCCDpComCredit
' Description: Gets the Committed Credit Value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpComCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
Attribute EntGLCCDpComCredit.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLCCDpComCredit = GetGLValue3(5, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 1)
End Function ' EntGLCCDpComCredit



'*******************************************************************************
' Name:        EntGLRevisedBudget1
' Description: Gets the Revised Budget 1 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLRevisedBudget1(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
    EntGLRevisedBudget1 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLRevisedBudget2
' Description: Gets the Revised Budget 2 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLRevisedBudget2(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
    EntGLRevisedBudget2 = GetGLValue(7, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLRevisedBudget3
' Description: Gets the Revised Budget 3 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLRevisedBudget3(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
    EntGLRevisedBudget3 = GetGLValue(8, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLRevisedBudget4
' Description: Gets the Revised Budget 4 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLRevisedBudget4(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
    EntGLRevisedBudget4 = GetGLValue(9, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function

'*******************************************************************************
' Name:        EntGLRevisedBudget5
' Description: Gets the Revised Budget 5 value for the passed general ledger code
'*******************************************************************************
Public Function EntGLRevisedBudget5(Company As String, TheYear As Integer, ThePeriod As Integer, TheCcy As Integer, GLCode As Long) As Variant
    EntGLRevisedBudget5 = GetGLValue(10, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "", "N")
End Function


'*****************************************************************************************
' Name:        EntGLCCRevisedBudget1
' Description: Gets the Revised Budget 1 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCRevisedBudget1(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
    EntGLCCRevisedBudget1 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCRevisedBudget2
' Description: Gets the Revised Budget 2 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCRevisedBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
    EntGLCCRevisedBudget2 = GetGLValue(7, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCRevisedBudget3
' Description: Gets the Revised Budget 3 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCRevisedBudget3(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
    EntGLCCRevisedBudget3 = GetGLValue(8, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCRevisedBudget4
' Description: Gets the Revised Budget 4 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCRevisedBudget4(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
    EntGLCCRevisedBudget4 = GetGLValue(9, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

'*****************************************************************************************
' Name:        EntGLCCRevisedBudget5
' Description: Gets the Revised Budget 5 value for the passed general ledger/Cost Centre code
'*****************************************************************************************
Public Function EntGLCCRevisedBudget5(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$) As Variant
    EntGLCCRevisedBudget5 = GetGLValue(10, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, "C")
End Function

 
'*******************************************************************************
' Name:        EntGLCCDpRevisedBudget1
' Description: Gets the Revised Budget 1 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpRevisedBudget1(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
    EntGLCCDpRevisedBudget1 = GetGLValue3(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function
 
'*******************************************************************************
' Name:        EntGLCCDpRevisedBudget2
' Description: Gets the Revised Budget 2 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpRevisedBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
    EntGLCCDpRevisedBudget2 = GetGLValue3(7, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function
 
'*******************************************************************************
' Name:        EntGLCCDpRevisedBudget3
' Description: Gets the Revised Budget 3 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpRevisedBudget3(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
    EntGLCCDpRevisedBudget3 = GetGLValue3(8, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function
 
'*******************************************************************************
' Name:        EntGLCCDpRevisedBudget4
' Description: Gets the Revised Budget 4 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpRevisedBudget4(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
    EntGLCCDpRevisedBudget4 = GetGLValue3(9, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function
 
'*******************************************************************************
' Name:        EntGLCCDpRevisedBudget5
' Description: Gets the Revised Budget 5 value for the specified Cost Centre and Department
'*******************************************************************************
Public Function EntGLCCDpRevisedBudget5(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, CostCentre$, Dept$) As Variant
    EntGLCCDpRevisedBudget5 = GetGLValue3(10, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, "C", CostCentre$, Dept$, 0)
End Function

 
'*****************************************************************************************
' Name:        EntGLDpRevisedBudget1
' Description: Gets the Revised Budget 1 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpRevisedBudget1(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
    EntGLDpRevisedBudget1 = GetGLValue(2, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
 
'*****************************************************************************************
' Name:        EntGLDpRevisedBudget2
' Description: Gets the Revised Budget 2 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpRevisedBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
    EntGLDpRevisedBudget2 = GetGLValue(7, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
 
'*****************************************************************************************
' Name:        EntGLDpRevisedBudget3
' Description: Gets the Revised Budget 3 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpRevisedBudget3(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
    EntGLDpRevisedBudget3 = GetGLValue(8, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
 
'*****************************************************************************************
' Name:        EntGLDpRevisedBudget4
' Description: Gets the Revised Budget 4 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpRevisedBudget4(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
    EntGLDpRevisedBudget4 = GetGLValue(9, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function
 
'*****************************************************************************************
' Name:        EntGLDpRevisedBudget5
' Description: Gets the Revised Budget 5 value for the passed general ledger/Department code
'*****************************************************************************************
Public Function EntGLDpRevisedBudget5(Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$) As Variant
    EntGLDpRevisedBudget5 = GetGLValue(10, Company$, TheYear%, ThePeriod%, TheCcy%, GLCode&, Dept$, "D")
End Function

Attribute VB_Name = "GLView"
Option Explicit

'*******************************************************************************
' GetGLViewValue: Gets a specified value for the passed view number and code
'*******************************************************************************
Private Function GetGLViewValue(ValueReq%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, _
                                GLViewCode$) As Variant
On Error GoTo GetGLViewValue_Error
    Dim CompStr$, Ty%, Tp%, TC%, GLV&, GLC$, Mode As Integer
    Dim DblVal As Double
    Dim Result%
     
    DblVal# = 0#
    
    If ValidCompany(Company) And ValidYear(TheYear) And ValidPeriod(ThePeriod) And ValidCcy(TheCcy) Then
        If LocalCheckServer() Then
            CompStr$ = UCase(Company$)
            Ty% = TheYear%
            Tp% = ThePeriod%
            TC% = TheCcy%
            GLV& = GLView&
            GLC$ = GLViewCode$
            Mode = ValueReq%
                        
            Result% = EntServer.GetGLViewValue(Mode%, CompStr$, Ty%, Tp%, TC%, GLV&, _
                                               GLC$, DblVal#)
        
            If (Result% <> 0) Then
                Error Result%
            End If
        End If
    End If
      
    GetGLViewValue = DblVal
    
    GoTo GetGLViewValue_Exit
        
GetGLViewValue_Error:
    GetGLViewValue = GetErrorNumStr

GetGLViewValue_Exit:
    
End Function ' GetGLViewValue
'*******************************************************************************
' Name:        EntGLViewActual
' Description: Gets the Actual Value for the passed G/L View code and line
'*******************************************************************************
Public Function EntGLViewActual(Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$) As Variant
Attribute EntGLViewActual.VB_ProcData.VB_Invoke_Func = " \n14"
  Dim Mode%
  Mode% = 3
  EntGLViewActual = GetGLViewValue(Mode%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$)
End Function
'*******************************************************************************
' Name:        EntGLViewBudget
' Description: Gets the Budget Value for the passed G/L View code and line
'*******************************************************************************
Public Function EntGLViewBudget(Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$) As Variant
Attribute EntGLViewBudget.VB_ProcData.VB_Invoke_Func = " \n14"
  Dim Mode%
  Mode% = 1
  EntGLViewBudget = GetGLViewValue(Mode%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$)
End Function
'*******************************************************************************
' Name:        EntGLViewBudget2
' Description: Gets the Budget2 Value for the passed G/L View code and line
'*******************************************************************************
Public Function EntGLViewBudget2(Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$) As Variant
Attribute EntGLViewBudget2.VB_ProcData.VB_Invoke_Func = " \n14"
  Dim Mode%
  Mode% = 2
  EntGLViewBudget2 = GetGLViewValue(Mode%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$)
End Function
'*******************************************************************************
' Name:        EntGLViewCredit
' Description: Gets the Credit Value for the passed G/L View code and line
'*******************************************************************************
Public Function EntGLViewCredit(Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$) As Variant
Attribute EntGLViewCredit.VB_ProcData.VB_Invoke_Func = " \n14"
  Dim Mode%
  Mode% = 5
  EntGLViewCredit = GetGLViewValue(Mode%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$)
End Function
'*******************************************************************************
' Name:        EntGLViewDebit
' Description: Gets the Debit Value for the passed G/L View code and line
'*******************************************************************************
Public Function EntGLViewDebit(Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$) As Variant
Attribute EntGLViewDebit.VB_ProcData.VB_Invoke_Func = " \n14"
  Dim Mode%
  Mode% = 4
  EntGLViewDebit = GetGLViewValue(Mode%, Company$, TheYear%, ThePeriod%, TheCcy%, GLView&, ViewCode$)
End Function
'*******************************************************************************
' Name:        EntGLViewName
' Description: Gets the GL View Name
'*******************************************************************************
Public Function EntGLViewName(Company$, GLView&, ViewCode$) As String
Attribute EntGLViewName.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLViewName_Error

  Dim Result%
  Dim RetStr$
  Dim StrNo%

  StrNo% = 2
  If ValidCompany(Company) Then
    If LocalCheckServer() Then
      Result% = EntServer.GetGLViewMiscStr(Company$, GLView&, ViewCode$, StrNo%, RetStr$)
      If (Result% <> 0) Then
        Error Result%
      End If
    End If
  End If
    
  EntGLViewName = RetStr$
  
  GoTo EntGLViewName_Exit
  
EntGLViewName_Error:

  EntGLViewName = GetErrorNumStr

EntGLViewName_Exit:

End Function

'*******************************************************************************
' Name:        EntGLViewAltCode
' Description: Gets the GL View AltCode
'*******************************************************************************
Public Function EntGLViewAltCode(Company$, GLView&, ViewCode$) As String
Attribute EntGLViewAltCode.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLViewAltCode_Error

  Dim Result%
  Dim RetStr$
  Dim StrNo%

  StrNo% = 1
  If ValidCompany(Company) Then
    If LocalCheckServer() Then
      Result% = EntServer.GetGLViewMiscStr(Company$, GLView&, ViewCode$, StrNo%, RetStr$)
      If (Result% <> 0) Then
        Error Result%
      End If
    End If
  End If
  
  EntGLViewAltCode = RetStr$
  
  GoTo EntGLViewAltCode_Exit
  
EntGLViewAltCode_Error:

  EntGLViewAltCode = GetErrorNumStr

EntGLViewAltCode_Exit:

End Function
'*******************************************************************************
' Name:        EntGLViewLinkCode
' Description: Gets the actual G/L Code for the specified GL View
'*******************************************************************************
Public Function EntGLViewLinkCode(Company$, GLView&, ViewCode$) As Variant
Attribute EntGLViewLinkCode.VB_ProcData.VB_Invoke_Func = " \n14"
On Error GoTo EntGLViewLinkCode_Error

  Dim RetVal&
  Dim Result%

  If ValidCompany(Company) Then
    If LocalCheckServer() Then
      Result% = EntServer.GetGLViewLinkCode(Company$, GLView&, ViewCode$, RetVal&)
      If (Result% <> 0) Then
        Error Result%
      End If
    End If
  End If
  
  EntGLViewLinkCode = RetVal&
  
  GoTo EntGLViewLinkCode_Exit
  
EntGLViewLinkCode_Error:

  EntGLViewLinkCode = GetErrorNumStr

EntGLViewLinkCode_Exit:

End Function




Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Version"
Option Explicit

' Release Version Number
Const AddInVer = "Exchequer v12.0.0 Build 208"           ' should be incremented for each build


'*******************************************************************************
' Add-In History
'
' Exchequer v12.0.0 Build 208   Updated for v12.0.0 release for Antivirus Issue
' Exchequer v12.0.0 Build 207   Updated for v12.0.0 release
'
' Exchequer 2018 R1 Build 206   Updated for 2018-R1 release
'
' 2016 R2 Build 205   03/05/2016   ABSEXCH-17353: Added Revised Budget 1-5 functions
'
' v2016R1.204 PKR   26/01/2016  Released for v2016 R1
'
' v7.0.203    MH    10/09/12    Released for v7.0
'
' v6.00.202   MH    31/10/07    Rebuilt as appears to have lost link to EntFuncs
'
' v6.00.200   MH    16/07/07    Recreated from scratch under XL95 to try and fix help problems in XL2003
'
' v6.00.004   MH    20/06/07    Rebuilt after help stopped working due to an MS Office Update
'
' v6.00.003   MH    14/06/07    Modified to use HTML Help
'
' v5.71.002   MH    08/01/07    Changed parameter names on instructions of QA
'
' v5.71.001   MH    21/06/06    Converted to Excel 95 format
'
' v5.71.000   CS    09/06/06    Created

'*******************************************************************************
' Name:        EntGLAddInVer
' Description: Gets the version of this Add-In source code
'*******************************************************************************
Public Function EntGLAddInVer() As String
Attribute EntGLAddInVer.VB_Description = "Returns the version information for EntGL.Xla"
Attribute EntGLAddInVer.VB_HelpID = 20000
Attribute EntGLAddInVer.VB_ProcData.VB_Invoke_Func = " \n14"
    EntGLAddInVer = "Exchequer G/L Functions - " + AddInVer$
End Function

' InQuest injected base64 decoded content
' {F, 
' {F, 

INQUEST-PP=macro
