Attribute VB_Name = "Foglio1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Modulo1"
Sub pal()

Dim xX, xxX
xX = Application.InputBox("Vuoi cancellare i dati inseriti?, SI  o  NO")
   If xX = False Then
   Exit Sub
   End If
    If xX = "NO" Or xX = "no" Then
    GoTo linea2
    Else
    If xX = "SI" Or xX = "si" Then
    xxX = Application.InputBox("SEI PROPRIO SICURO?, SI  o  NO")
    If xxX = "SI" Or xxX = "si" Then

Sheets("base").Activate
Application.ScreenUpdating = True
Range("a7:ea2000").ClearContents

linea2:
Application.ScreenUpdating = False


Sheets("pal").Activate
Range("an:aw").ClearContents
    myurl = Range("bc7").Value
    Range("AN5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("an5"))
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
        Range("x4:am4").Select
    Selection.AutoFill Destination:=Range("x4:Am3033"), Type:=xlFillDefault
    Range("x4:Am3033").Select
    
    End If
     End If
      End If
    
End Sub

Sub palbbbbb()


Dim xX, xxX
xX = Application.InputBox("Vuoi cancellare i dati inseriti?, SI  o  NO")
   
    If xX = "NO" Or xX = "no" Then
    GoTo linea2
    Else
    If xX = "SI" Or xX = "si" Then
    xxX = Application.InputBox("SEI PROPRIO SICURO?, SI  o  NO")
    If xxX = "SI" Or xxX = "si" Then


Sheets("base").Activate
Application.ScreenUpdating = True
Range("a7:u2000").ClearContents

linea2:
Application.ScreenUpdating = False
Sheets("pal").Activate

Range("an:aw").ClearContents

    myurl = Range("bc7").Value
    Range("AN5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("an5"))
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
        Range("x4:am4").Select
    Selection.AutoFill Destination:=Range("x4:Am3033"), Type:=xlFillDefault
    Range("x4:Am3033").Select
    End If
     End If
      End If
End Sub

Attribute VB_Name = "Modulo10"
Sub DeleteAllPics()
Dim Pic As Object
For Each Pic In ActiveSheet.Pictures
Pic.Delete
Next Pic
End Sub
Attribute VB_Name = "Modulo11"
Sub Cancella_le_query_in_tutti_i_fogli()

If MsgBox("ATTENZIONE!!!:" & vbNewLine & _
                vbNewLine & _
                "VUOI CANCELLARE TUTTE LE QUERY ?     " & vbNewLine & _
                vbNewLine & _
                "SEI PROPRIO SICURO?", _
                vbCritical + vbYesNo + vbDefaultButton2, "Cancellazione CELLA") = vbNo Then
                Exit Sub
                End If
Application.ScreenUpdating = False
        Dim wk As Workbook
Dim n As Name

Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing


Dim xConnect As Object
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    Range("G12").Value = "Querry cancellate il" & "  " & Now
    MsgBox "   Completato"
    
End Sub

Attribute VB_Name = "Modulo12"
Attribute VB_Name = "Modulo13"
Sub archivia1()

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False
If Sheets("PRONO").Range("cc1").Value = 1 Then
MsgBox "   Hai gi|fffd| archiviato"
Exit Sub
End If

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("PRONO")
Set Ws2 = Sheets("ARCHIVIO")
UR1 = Ws1.Range("d" & Rows.Count).End(xlUp).Row
For RR1 = 7 To UR1
        If Ws1.Range("AG" & RR1).Value <> "-" And Ws1.Range("AG" & RR1).Value <> "" And Ws1.Range("X" & RR1).Value <> "postp" Then
        UR2 = Ws2.Range("a" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("a" & RR1 & ":BA" & RR1).Copy
        Ws2.Range("a" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlCalculationAutomatic

MsgBox "   Archiviato"
End Sub





Attribute VB_Name = "Modulo14"
Sub incolonnaris()

Sheets("pal").Activate
Application.Calculation = xlManual
Range("DA2:DA2000").ClearContents
Range("DF3:EU200000").ClearContents


Set wk = ActiveWorkbook
With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With
Set n = Nothing
Set wk = Nothing
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("pal")
Set Ws2 = Sheets("pal")
UR1 = Ws1.Range("x" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Ws1.Range("x" & RR1).Value = 1 Then
        UR2 = Ws2.Range("DA" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("AM" & RR1 & ":AM" & RR1).Copy
        Ws2.Range("DA" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate

If Range("DE1").Value < 200 Then

    Dim xlCal As XlCalculation
    Dim nextRow As Integer
    Dim lastRow As Long
    Dim URL As Range
    
Application.Calculation = xlManual
    a = 0
    
    lR = Sheets("pal").Cells(Rows.Count, "DA").End(xlUp).Row - 1
    For Each URL In Sheets("pal").Range("DA1:DA" & lR).Offset(1, 0).Rows
    Shell "RunDll32.exe Inetcpl.cpl, ClearMyTracksByProcess 8"
    nextRow = ActiveSheet.Cells(Rows.Count, "DF").End(xlUp).Row

        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("DF" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a
    Next
    Application.Calculation = xlAutomatic
Calculate

Else
Application.Calculation = xlManual
    a = 0
    
    'lR = Sheets("pal").Cells(Rows.Count, "DA").End(xlUp).Row - 1
    For Each URL In Sheets("pal").Range("DA1:DA190").Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "DF").End(xlUp).Row
    Shell "RunDll32.exe Inetcpl.cpl, ClearMyTracksByProcess 8"

        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("DF" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    a = a + 1
    Application.StatusBar = a
    Next
    Application.Calculation = xlAutomatic
Calculate

Application.Calculation = xlManual
    a = 0
    
    lR = Sheets("pal").Cells(Rows.Count, "DA").End(xlUp).Row - 1
    For Each URL In Sheets("pal").Range("DA190:DA" & lR).Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "DF").End(xlUp).Row
    Shell "RunDll32.exe Inetcpl.cpl, ClearMyTracksByProcess 8"

        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("DF" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a
    Next
    Application.Calculation = xlAutomatic
Calculate
End If


End Sub
Attribute VB_Name = "Modulo15"
Attribute VB_Name = "Modulo16"
Attribute VB_Name = "Modulo17"
Attribute VB_Name = "Modulo18"
Attribute VB_Name = "Modulo19"

Attribute VB_Name = "Modulo2"
Function HLink(rng As Range) As String
  If rng(1).Hyperlinks.Count Then
      HLink = rng.Hyperlinks(1).Address
  End If
End Function
Attribute VB_Name = "Modulo20"
Attribute VB_Name = "Modulo21"
Sub a()
Range("a:d").ClearContents
Application.Calculation = xlManual
UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 1 Then
        UR2 = Range("a" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("a" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 2 Then
        UR2 = Range("b" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("b" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 3 Then
        UR2 = Range("c" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("c" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 4 Then
        UR2 = Range("d" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("d" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate
End Sub
Attribute VB_Name = "Modulo22"
Sub pulisci()

Application.Calculation = xlManual
        Dim wk As Workbook
Dim n As Name

Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing


Dim xConnect As Object
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    



    Application.Calculation = xlAutomatic
Calculate
    MsgBox "   Completato "
End Sub

Attribute VB_Name = "Modulo23"

Attribute VB_Name = "Modulo24"
Sub opzris()



Dim answer As Integer
answer = MsgBox("ti servono anche i risultati del primo tempo?" & vbNewLine & "(questo allunga l'aggiornamento)", vbYesNo + vbQuestion, "OPZIONE")
If answer = vbYes Then
    Call rispt
Else
  Call ris
  
End If
Sheets("prono").Activate
MsgBox "   Completato"
End Sub
Attribute VB_Name = "Modulo25"
Sub rispt()
Application.ScreenUpdating = False
Application.Calculation = xlAutomatic
Application.Calculation = xlManual
Dim xX, xxX
xX = Application.InputBox("Vuoi cancellare i risultati inseriti?, SI  o  NO")
    If xX = False Then
    Exit Sub
    End If
    If xX = "NO" Or xX = "no" Then
    GoTo linea2
    Else
    If xX = "SI" Or xX = "si" Then
    xxX = Application.InputBox("SEI PROPRIO SICURO?, SI  o  NO")
    If xxX = "SI" Or xxX = "si" Then
Sheets("pal").Activate
Range("cd2:ch10000").ClearContents
linea2:




Sheets("pal").Activate
Range("bd4:bk5000").ClearContents
    myurl = Range("bc3").Value
    Range("bd5").Select
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;" & myurl _
        , Destination:=Range("bd5"))
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
        End If
        End If
        End If
Sheets("base").Activate
    UR111 = Sheets("base").Range("d" & Rows.Count).End(xlUp).Row
    
For rr2 = 7 To UR111
    
    Cells(rr2, 139).Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF(RC[-132]="""","""",VLOOKUP(RC[-134]&"" - ""&RC[-132],PAL!C[-53]:C[-54],2,FALSE)),""-"")"
    
    Next rr2


        Call lista_match_risultati
        
        
        
        Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate

Application.Calculation = xlManual
        Dim wk As Workbook
Dim n As Name

Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing


Dim xConnect As Object
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    



    Application.Calculation = xlAutomatic
Calculate
DoEvents
       Sheets("base").Activate
    
    Application.ScreenUpdating = False

Sheets("R1T").Activate
Range("k:k").ClearContents
Range("a:d").ClearContents
Application.Calculation = xlManual
Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("pal")
Set Ws2 = Sheets("R1T")
UR1 = Ws1.Range("x" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Ws1.Range("x" & RR1).Value = 1 Then
        UR2 = Ws2.Range("k" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("AM" & RR1 & ":AM" & RR1).Copy
        Ws2.Range("k" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate


Application.Calculation = xlManual

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 1 Then
        UR2 = Range("a" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("a" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 2 Then
        UR2 = Range("b" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("b" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 3 Then
        UR2 = Range("c" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("c" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

UR1 = Range("k" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Range("j" & RR1).Value = 4 Then
        UR2 = Range("d" & Rows.Count).End(xlUp).Row + 1
        Range("k" & RR1 & ":k" & RR1).Copy
        Range("d" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate

    DoEvents
    
    Dim xlCal As XlCalculation
    Dim nextRow As Integer
    Dim lastRow As Long
    Dim URL As Range
    Dim a As String
    
    Range("ba:ck").ClearContents
    Range("aw:az").ClearContents
Application.Calculation = xlManual
a = 0
If Range("e1") > 0 Then

    
    lR = Sheets("R1T").Cells(Rows.Count, "a").End(xlUp).Row - 1
    For Each URL In Sheets("R1T").Range("a1:a" & lR).Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "ba").End(xlUp).Row

     
     
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("ba" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a & " di " & Range("i1").Value

   
    Next
    End If
        Columns("BA:BA").Select
    Selection.Copy
    Columns("AW:AW").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Application.Calculation = xlAutomatic
Calculate


    Range("ba:ck").ClearContents
Application.Calculation = xlManual
a = Range("e1").Value
If Range("f1") > 0 Then

    
    lR = Sheets("R1T").Cells(Rows.Count, "b").End(xlUp).Row - 1
    For Each URL In Sheets("R1T").Range("b1:b" & lR).Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "ba").End(xlUp).Row

     
     
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("ba" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a & " di " & Range("i1").Value

   
    Next
    
    End If
    DoEvents
    
        Columns("BA:BA").Select
    Selection.Copy
    Columns("Ax:Ax").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Application.Calculation = xlAutomatic
Calculate


    Range("ba:ck").ClearContents
Application.Calculation = xlManual
a = Range("e1").Value + Range("f1").Value
If Range("g1") > 0 Then

    
    lR = Sheets("R1T").Cells(Rows.Count, "c").End(xlUp).Row - 1
    For Each URL In Sheets("R1T").Range("c1:c" & lR).Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "ba").End(xlUp).Row

     
     
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("ba" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a & " di " & Range("i1").Value

   
    Next
    End If
        Columns("BA:BA").Select
    Selection.Copy
    Columns("Ay:Ay").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Application.Calculation = xlAutomatic
Calculate

    Range("ba:ck").ClearContents
Application.Calculation = xlManual
a = Range("e1").Value + Range("f1").Value + Range("g1").Value
If Range("h1") > 0 Then

    
    lR = Sheets("R1T").Cells(Rows.Count, "d").End(xlUp).Row - 1
    For Each URL In Sheets("R1T").Range("d1:d" & lR).Offset(1, 0).Rows
    nextRow = ActiveSheet.Cells(Rows.Count, "ba").End(xlUp).Row

     
     
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & URL, _
            Destination:=Range("ba" & nextRow + 30))
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
   a = a + 1
   Application.StatusBar = a & " di " & Range("i1").Value

   
    Next
    End If
        Columns("BA:BA").Select
    Selection.Copy
    Columns("Az:Az").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Application.Calculation = xlAutomatic
Calculate
Range("ba:ck").ClearContents

Application.Calculation = xlManual



Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing



For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    



    Application.Calculation = xlAutomatic
Calculate
End Sub

Attribute VB_Name = "Modulo3"
Sub lista_match_pal()

Sheets("pal").Activate

Application.Calculation = xlManual
Range("f2:m1000").ClearContents
Range("o2:v1000").ClearContents
Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("pal")
Set Ws2 = Sheets("pal")
UR1 = Ws1.Range("x" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Ws1.Range("x" & RR1).Value = 1 Then
        UR2 = Ws2.Range("o" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("z" & RR1 & ":ag" & RR1).Copy
        Ws2.Range("o" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

Application.Calculation = xlAutomatic
Calculate

    
    lR = Cells(Rows.Count, "o").End(xlUp).Row
Set rng = Range("o2:v" & lR)
rng.Select
Selection.Copy
Cells(Cells(Rows.Count, "f").End(xlUp).Row + 1, "f").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
rng.Select
Selection.ClearContents
Application.CutCopyMode = False
If Range("x1") = 2 Then
Set Ws1 = Sheets("pal")
Set Ws2 = Sheets("pal")
UR1 = Ws1.Range("x" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Ws1.Range("x" & RR1).Value = 2 Then
        UR2 = Ws2.Range("o" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("z" & RR1 & ":ag" & RR1).Copy
        Ws2.Range("o" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
    'ActiveWorkbook.Worksheets("PAL").AutoFilter.Sort.SortFields.Clear
    'ActiveWorkbook.Worksheets("PAL").AutoFilter.Sort.SortFields.Add Key:=Range( _
        "P1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    'With ActiveWorkbook.Worksheets("PAL").AutoFilter.Sort
        '.Header = xlYes
        '.MatchCase = False
        '.Orientation = xlTopToBottom
        '.SortMethod = xlPinYin
        '.Apply
    'End With
    
    lR = Cells(Rows.Count, "o").End(xlUp).Row
Set rng = Range("o2:v" & lR)
rng.Select
Selection.Copy
Cells(Cells(Rows.Count, "f").End(xlUp).Row + 1, "f").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
rng.Select
Selection.ClearContents
Application.CutCopyMode = False
End If
Sheets("dati").Activate
Range("s2:ab2000").ClearContents
Sheets("pal").Activate
    lR = Sheets("pal").Cells(Rows.Count, "g").End(xlUp).Row
Set rng = Sheets("pal").Range("d2:m" & lR)
rng.Select
Selection.Copy
Sheets("dati").Activate
Cells(Cells(Rows.Count, "s").End(xlUp).Row + 1, "s").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

Sheets("dati").Select
    Range("AG1").Select
    Selection.Copy
    Range("AF1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

End Sub

Attribute VB_Name = "Modulo4"
Sub dati()
Attribute dati.VB_ProcData.VB_Invoke_Func = " \n14"

Inizio:

Sheets("dati").Select

If Range("ag1") < 1 Then GoTo linea25
'Exit Sub
'End If

Riga = Range("v" & Rows.Count).End(xlUp).Row
Range("r" & Riga & ":" & "ab" & Riga).Select
Selection.Copy
Range("aj1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    'riga = Range("s" & Rows.Count).End(xlUp).Row
'Range("s" & riga & ":" & "aa" & riga).Select
'Selection.ClearContents

' download dati squadra casa
On Error GoTo 10
myurl = Range("ak1").Value
Range("ay2:bh7000").ClearContents
Range("ay5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("ay5"))
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "2"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
       
    End With
    
    DoEvents
    
        Range("af6:aw6").Select
    Selection.AutoFill Destination:=Range("af6:aw100"), Type:=xlFillDefault
    Range("af6:aw100").Select
    

' download dati squadra fuori
    On Error GoTo 10
    myurl = Range("al1").Value
Range("cb:ck").ClearContents
Range("cb5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("cb5"))
        .WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        .WebTables = "2"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    
    DoEvents

            Range("bi6:bz6").Select
    Selection.AutoFill Destination:=Range("bi6:bz100"), Type:=xlFillDefault
    Range("bi6:bz100").Select
    
                Range("ed6:ee6").Select
    Selection.AutoFill Destination:=Range("ed6:ee100"), Type:=xlFillDefault
    Range("ed6:ee10").Select

Dim valore As Integer
valore = Abs(Sheets("over").Range("ej130"))  'scarto lose
'If valore = 1 Then
 '   GoTo Salta
'End If

'download h2h DOVREBBE SCARICARE I TESTA A TESTA
    On Error GoTo 10
    'Sheets("H2H").Activate
'myurl = Sheets("dati").Range("aj1").Value
'Range("k:aa").ClearContents
'Range("k5").Select
        'With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("k5"))
        '.WebSelectionType = xlSpecifiedTables
        '.WebFormatting = xlWebFormattingAll
        '.WebTables = "3"
        '.WebPreFormattedTextToColumns = True
        '.WebConsecutiveDelimitersAsOne = True
        '.WebSingleBlockTextImport = False
        '.WebDisableDateRecognition = True
        '.WebDisableRedirections = False
        '.Refresh BackgroundQuery:=False
    'End With
    
        'Range("A15").Select
    'ActiveCell.FormulaR1C1 = "=R10C11&"" - ""&R12C11"
    'Range("A15").Select
    'Selection.AutoFill Destination:=Range("A15:A54"), Type:=xlFillDefault
    'Range("A15:A54").Select
    'ActiveWindow.SmallScroll Down:=-57
    'Range("a15:A54").Select
    
    
    
    
        On Error GoTo 10
        Sheets("odds").Activate
myurl = Sheets("dati").Range("aj1").Value
Range("k:az").ClearContents
Range("k5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("k5"))
        '.WebSelectionType = xlSpecifiedTables
        .WebFormatting = xlWebFormattingNone
        '.WebTables = "16"
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    
        Range("I2").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(R2C10:RC[1],1)"
    Range("J2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]=""Bookmaker"",R[-1]C+1,R[-1]C)"
    Range("I2:J2").Select
    Selection.AutoFill Destination:=Range("I2:J669"), Type:=xlFillDefault
    Range("I2:J669").Select
    
    'Dim Riga As Integer
'Dim Colonna As Integer
Range("b:d").ClearContents
Range([h1]).Activate
Riga = ActiveCell.Row
Colonna = ActiveCell.Column
Range(Cells(Riga, Colonna).Address & ":" & Cells(Riga + 29, Colonna + 2).Address).Select
Selection.Copy
Range("b1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    

    
    
    
    
    
    
Salta:
10
    
    Sheets("dati").Select
Riga = Range("v" & Rows.Count).End(xlUp).Row
Range("s" & Riga & ":" & "ab" & Riga).Select
Selection.ClearContents
    
'Dim valore As Integer
valore = Abs(Sheets("over").Range("ei130"))  'eventuali errori
If valore >= 10 Then              ' tutto OK COPIA I VALORI NEL FOGLIO BASE
    Set Ws1 = Sheets("over")
    Set Ws2 = Sheets("base")
    UR2 = Ws2.Range("a" & Rows.Count).End(xlUp).Row + 1
    Ws1.Range("a130:eh130").Copy
    Ws2.Range("a" & UR2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
End If

'Dim Ws1 As Worksheet
'Dim Ws2 As Worksheet
'Set Ws1 = Sheets("over")
'Set Ws2 = Sheets("base")
'UR1 = Ws1.Range("z" & Rows.Count).End(xlUp).Row
'For RR1 = 120 To UR1
      '  If Ws1.Range("a126").Value <> "" Then
      '  UR2 = Ws2.Range("a" & Rows.Count).End(xlUp).Row + 1
      '  Ws1.Range("a" & RR1 & ":x" & RR1).Copy
     '   Ws2.Range("a" & UR2).PasteSpecial Paste:=xlPasteValues
      '  End If
'Next RR1
'Application.CutCopyMode = False




Sheets("dati").Select

Dim Inizio As Integer
Dim fine As Integer
fine = Sheets("dati").Range("af1").Value
Inizio = Sheets("dati").Range("ae1").Value
Application.StatusBar = "Completato " & Inizio & " di " & fine & " partite da elaborare"

'Call dati
GoTo Inizio

linea25:
    Application.StatusBar = ""




    
End Sub



Attribute VB_Name = "Modulo5"
Sub ris()
Application.ScreenUpdating = False
Application.Calculation = xlAutomatic
Application.Calculation = xlManual
Dim xX, xxX
xX = Application.InputBox("Vuoi cancellare i risultati inseriti?, SI  o  NO")
    If xX = False Then
    Exit Sub
    End If
       If xX = "NO" Or xX = "no" Then
    GoTo linea2
    Else
    If xX = "SI" Or xX = "si" Then
    xxX = Application.InputBox("SEI PROPRIO SICURO?, SI  o  NO")
    If xxX = "SI" Or xxX = "si" Then
Sheets("pal").Activate
Range("cd2:ch10000").ClearContents
linea2:




Sheets("pal").Activate
Range("bd4:bk5000").ClearContents
    myurl = Range("bc3").Value
    Range("bd5").Select
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;" & myurl _
        , Destination:=Range("bd5"))
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
        End If
        End If
        End If
Sheets("base").Activate
    UR111 = Sheets("base").Range("d" & Rows.Count).End(xlUp).Row
    
For rr2 = 7 To UR111
    
    Cells(rr2, 139).Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF(RC[-132]="""","""",VLOOKUP(RC[-134]&"" - ""&RC[-132],PAL!C[-53]:C[-54],2,FALSE)),""-"")"
    
    Next rr2


        Call lista_match_risultati
        
        
        
        Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate

Application.Calculation = xlManual
        Dim wk As Workbook
Dim n As Name

Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing


Dim xConnect As Object
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    



    Application.Calculation = xlAutomatic
Calculate
        
    Sheets("base").Activate
End Sub

Sub lista_match_risultati()

Sheets("pal").Activate
Application.Calculation = xlAutomatic
Application.Calculation = xlManual
'Range("cd2:ch1000").ClearContents
Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("pal")
Set Ws2 = Sheets("pal")
UR1 = Ws1.Range("bm" & Rows.Count).End(xlUp).Row
UR3 = Ws1.Range("cg" & Rows.Count).End(xlUp).Row + 1
For RR1 = 2 To UR1
        If Ws1.Range("bm" & RR1).Value = 1 Then
        UR2 = Ws2.Range("cd" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("bo" & RR1 & ":bs" & RR1).Copy
        Ws2.Range("cd" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1

Range("CD1").Select
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate

End Sub

Attribute VB_Name = "Modulo6"
Sub Archivia()

Application.ScreenUpdating = False
If Sheets("ARCH.BASE").Range("ba1").Value = 1 Then
MsgBox "   Hai gi|fffd| archiviato"
Exit Sub
End If

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("base")
Set Ws2 = Sheets("ARCH.BASE")
UR1 = Ws1.Range("m" & Rows.Count).End(xlUp).Row
For RR1 = 7 To UR1
        If Ws1.Range("ei" & RR1).Value <> "-" And Ws1.Range("ei" & RR1).Value <> "" And Ws1.Range("ei" & RR1).Value <> "postp" Then
        UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("A" & RR1 & ":er" & RR1).Copy
        Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False

MsgBox "   Archiviato"
End Sub

Attribute VB_Name = "Modulo7"
Sub gestione()
Application.ScreenUpdating = False
Sheets("PAL").Visible = True
Sheets("DATI").Visible = True
Sheets("OVER").Visible = True
Sheets("ODDS").Visible = True
Sheets("H2H").Visible = True

'Call pal

Dim xX, xxX
xX = Application.InputBox("Vuoi cancellare i dati inseriti?, SI  o  NO")
   If xX = False Then
   Exit Sub
   End If
    If xX = "NO" Or xX = "no" Then
    GoTo linea2
    Else
    If xX = "SI" Or xX = "si" Then
    xxX = Application.InputBox("SEI PROPRIO SICURO?, SI  o  NO")
    If xxX = "SI" Or xxX = "si" Then
Sheets("R1T").Activate
Range("aw:az").ClearContents
Sheets("base").Activate
Application.ScreenUpdating = True
Range("a7:eh2000").ClearContents

linea2:
Application.ScreenUpdating = False


Sheets("pal").Activate
Range("an:aw").ClearContents
    myurl = Range("bc7").Value
    Range("AN5").Select
        With ActiveSheet.QueryTables.Add(Connection:= _
            "URL;" & myurl, _
            Destination:=Range("an5"))
        .WebSelectionType = xlEntirePage
        .WebFormatting = xlWebFormattingAll
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = True
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
        Range("x4:am4").Select
    Selection.AutoFill Destination:=Range("x4:Am3033"), Type:=xlFillDefault
    Range("x4:Am3033").Select
    
    
    

Call lista_match_pal
Application.Wait (Now + TimeValue("00:00:03"))
Call dati
Dim wk As Workbook
Dim n As Name

Set wk = ActiveWorkbook

With wk
For Each n In .Names
If InStr(n.Name, _
"DatiEsterni") Then
.Names(n.Name).Delete
End If
Next
End With

Set n = Nothing
Set wk = Nothing


Dim xConnect As Object
For Each xConnect In ActiveWorkbook.Connections
If xConnect.Name <> "ThisWorkbookDataModel" Then xConnect.Delete
Next xConnect
    




    Sheets("BASE").Select
    ActiveWorkbook.Worksheets("BASE").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("BASE").AutoFilter.Sort.SortFields.Add Key:=Range( _
        "B5:B1080"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("BASE").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveWindow.SmallScroll Down:=-2000
    Range("AD1").Select
    ActiveWindow.ScrollColumn = 1
    
    Sheets("PAL").Visible = False
Sheets("DATI").Visible = False
Sheets("OVER").Visible = False
Sheets("ODDS").Visible = False
Sheets("H2H").Visible = False
End If
     End If
      End If
    

    GoTo 2
linea25:
     MsgBox "  NON CI SONO INCONTRI"
     
2:
    Application.StatusBar = ""
    
    
    MsgBox "   Completato"
    'Application.StatusBar = "Completato"

End Sub
Attribute VB_Name = "Modulo8"
Attribute VB_Name = "Modulo9"
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{561FA807-3C7B-4D79-BE7A-AD2DA266ECFC}{FBAB6439-D996-49B6-8360-1E383120FE44}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


INQUEST-PP=macro
