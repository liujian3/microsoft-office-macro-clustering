Attribute VB_Name = "ClearModule"
Sub Clear()
'
' Clear Macro
' Macro recorded 7/29/98 by Practitioners Publishing Company
'

'
    msg = "Are you sure you want to clear all of the " & vbCrLf
    msg = msg & "input items from the worksheets?"
    Beep
    ans = MsgBox(msg, vbYesNo + vbQuestion + vbDefaultButton2, "PPC's Workpapers")
    
    If ans = vbNo Then  ' User chose No.
        Exit Sub
    End If
     
    Application.ScreenUpdating = False
    Sheet3.Visible = xlSheetVisible
    Sheet3.Select
    Range("FinalAssess1").Value = "Please complete the other " & _
      "worksheet(s) to obtain the final assessment."
    Range("A1").Select
    Sheet2.Visible = xlSheetVisible
    Sheet2.Select
    Sheet2.QuanYes1.Value = False
    Sheet2.QuanNo1.Value = False
    Range("QuanResponse1").Value = ""
    Range("QuanAssessResult").Value = ""
    Range("A1").Select
    Sheet1.Select
    Range("ClearHeadings").ClearContents
    Sheet1.AssetTypeComboBox.Value = 4
    Sheet1.AssetTypeComboBox.Value = 0
    Range("YearEnd").Value = "=PPC_GetBalanceSheetDate()"
    Range("Client").Value = "=PPC_GetClientName()"
    Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Client_Name") = "[Client Name]"
    Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Engagement_Date") = ""
    Application.ActiveWorkbook.ActiveSheet.EnableCalculation = False
    Application.ActiveWorkbook.ActiveSheet.EnableCalculation = True

    Range("A1").Select
    Sheet2.Visible = xlSheetHidden
    Sheet3.Visible = xlSheetHidden
    Application.ScreenUpdating = True
    
End Sub

Attribute VB_Name = "EditorialMacros"
Option Explicit

Public Sub InitForEditorial()

  '
  ' Code for editorial special setups that need to be called
  '  after saving or on worksheet initialization.
  '
'**********************************************************************
'***WORKBOOK WILL NOT WORK IF THIS CODE IS DELETED*********************
'    Dim CurrentAssetType As String
    Dim CurrentMethodType As String
'    If Sheet1.Range("ComboEventValue").Value = 1 Then Sheet1.Range("ComboEventValue").Value = 0
    If Sheet1.AssetTypeComboBox.ListCount <> 5 Then
'        CurrentAssetType = Sheet1.AssetTypeComboBox.Text
        Sheet1.AssetTypeComboBox.Clear
        Sheet1.AssetTypeComboBox.AddItem "Select the Type of Asset"
        Sheet1.AssetTypeComboBox.AddItem "Goodwill"
        Sheet1.AssetTypeComboBox.AddItem "Intangible Asset (Amortized)"
        Sheet1.AssetTypeComboBox.AddItem "Intangible Asset (Non Amortized)"
        Sheet1.AssetTypeComboBox.AddItem "Property, Plant, and Equipment"
'        Sheet1.AssetTypeComboBox.Value = CurrentAssetType
        If Sheet1.AssetTypeComboBox.Text = "0" Then
            Sheet1.AssetTypeComboBox.Text = "Select the Type of Asset"
        ElseIf Sheet1.AssetTypeComboBox.Text = "1" Then
            Sheet1.AssetTypeComboBox.Text = "Goodwill"
        ElseIf Sheet1.AssetTypeComboBox.Text = "2" Then
            Sheet1.AssetTypeComboBox.Text = "Intangible Asset (Amortized)"
        ElseIf Sheet1.AssetTypeComboBox.Text = "3" Then
            Sheet1.AssetTypeComboBox.Text = "Intangible Asset (Non Amortized)"
        ElseIf Sheet1.AssetTypeComboBox.Text = "4" Then
            Sheet1.AssetTypeComboBox.Text = "Property, Plant, and Equipment"
        End If
'        Sheet1.Range("ComboEventValue").Value = 1
'    End If
        If Sheet2.MethodComboBox.ListCount <> 4 Then
            CurrentMethodType = Sheet2.MethodComboBox.Text
            Sheet2.MethodComboBox.Clear
            Sheet2.MethodComboBox.AddItem "Select a Method"
            Sheet2.MethodComboBox.AddItem "Quoted Market Prices"
            Sheet2.MethodComboBox.AddItem "Net Present Value of Future Cash Flows"
            Sheet2.MethodComboBox.AddItem "Other"
            Sheet2.MethodComboBox.Value = CurrentMethodType
            Sheet2.Range("MethodTypeResult").Value = CurrentMethodType
        End If
'***********************************************************************
    
'Because the existing security code unhides all worksheets upon saving, this
'code hides any worksheets that should be hidden.
    
        If Sheet1.Range("AssetTypeResult").Value = 0 Then
            Sheet2.Visible = xlSheetHidden
            Sheet3.Visible = xlSheetHidden
        ElseIf Sheet1.Range("AssetTypeResult").Value = 2 Or Sheet1.Range("AssetTypeResult").Value = 4 Then
            If Sheet2.QuanYes1.Value = False And Sheet2.QuanNo1.Value = False Then
                Sheet3.Visible = xlSheetHidden
            ElseIf Sheet2.QuanYes1.Value = True Then
                If Sheet2.Range("QuanAssessResult").Value = "" Then
                    Sheet3.Visible = xlSheetHidden
                End If
            ElseIf Sheet2.QuanNo1.Value = True Then
                Sheet3.Visible = xlSheetVisible
            End If
        ElseIf Sheet1.AssetTypeComboBox.Value = 1 Or Sheet1.AssetTypeComboBox.Value = 3 Then
            If Sheet1.QualYes1.Value = False And Sheet1.QualNo1.Value = False Then
                Sheet2.Visible = xlSheetHidden
                Sheet3.Visible = xlSheetHidden
            ElseIf Sheet1.QualYes1.Value = True And Sheet1.QualNo1.Value = False Then
                Sheet2.Visible = xlSheetVisible
                If Sheet2.Range("QuanAssessResult").Value = "" Or _
                 Sheet2.Range("QuanAssessResult").Value = "Input all three " & _
                 "reporting unit amounts to proceed." Then
                    Sheet3.Visible = xlSheetHidden
                Else
                    Sheet3.Visible = xlSheetVisible
                End If
            ElseIf Sheet1.QualYes1.Value = False And Sheet1.QualNo1.Value = True Then
                If Sheet1.QualYes2.Value = False And Sheet1.QualNo2.Value = False Then
                    Sheet2.Visible = xlSheetHidden
                    Sheet3.Visible = xlSheetHidden
                ElseIf Sheet1.QualYes2.Value = True And Sheet1.QualNo2.Value = False Then
                    Sheet2.Visible = xlSheetVisible
                    If Sheet2.Range("QuanAssessResult").Value = "" Then
                        Sheet3.Visible = xlSheetHidden
                    Else
                        Sheet3.Visible = xlSheetVisible
                    End If
                ElseIf Sheet1.QualYes2.Value = False And Sheet1.QualNo2.Value = True Then
                    Sheet2.Visible = xlSheetHidden
                    Sheet3.Visible = xlSheetVisible
                End If
            End If
        End If
        If Sheet3.Range("FinalAssess1").Value = "Please complete the other " & _
          "worksheet(s) to obtain the final assessment." Then
            Sheet3.Visible = xlSheetHidden
        End If
    End If

End Sub

Public Sub Workbook_BeforeClose_Editorial()
  '
  ' Code for editorial special setups that need to be called
  '  before close.
  '
    If ThisWorkbook.ActiveSheet.Name <> "Qualitative Assessment" Then
        Sheet1.Select
        Sheet1.Range("A1").Select
    End If
  
'  Sheet1.Range("ComboEventValue").Value = 0
  
End Sub

Attribute VB_Name = "EditorialMacros_Deactivate"
Option Explicit

Public Sub Workbook_Deactivate_Editorial()
  '
  ' Code for editorial special setups that need to be called
  '  when leaving the workbook without closing it. This, will
  '  also run when closing workbook.
  '
End Sub

Attribute VB_Name = "PPC_CodeModule"
Public Sub MacroCheck()
'Do nothing. This sub will be called from .NET code to check macro is enabled or not
End Sub


Public Function PPC_GetClientName()
  PPC_GetClientName = Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Client_Name")
End Function

Public Function PPC_GetBalanceSheetDate()
  PPC_GetBalanceSheetDate = Application.ActiveWorkbook.CustomDocumentProperties("PPC_Template_Engagement_Date")
End Function

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "GWNo1, 14, 1, MSForms, OptionButton"
Attribute VB_Control = "GWYes1, 13, 2, MSForms, OptionButton"
Attribute VB_Control = "AssetTypeComboBox, 2, 3, MSForms, ComboBox"
Attribute VB_Control = "QualYes1, 5, 4, MSForms, OptionButton"
Attribute VB_Control = "QualNo1, 6, 5, MSForms, OptionButton"
Attribute VB_Control = "QualYes2, 8, 6, MSForms, OptionButton"
Attribute VB_Control = "QualNo2, 9, 7, MSForms, OptionButton"

Private Sub GWNo1_Click()
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
'If Quantitative Assessment worksheet's "fair value of reporting unit"
' has been entered or calculated
    If Sheet2.Range("FairValue1").Value <> "" Or _
     Sheet2.Range("FairValue2").Value <> "" Then
''On the Quantitative Assessment worksheet, clear all implied fair value
'' inputs unhide the Quantitative Analysis result
        Sheet2.Range("GoodwillInputs").ClearContents
        Sheet2.Range("QuanAssessResult").Rows.Hidden = False
''If the Quantitative Assessment worksheet's "carrying amount of reporting unit,
'' including goodwill" is greater than than its fair value
        If Sheet2.Range("FairValue1").Value <> "" And _
         Sheet2.Range("CarryAmount").Value > Sheet2.Range("FairValue1").Value Or _
         Sheet2.Range("FairValue2").Value <> "" And _
         Sheet2.Range("CarryAmount").Value > Sheet2.Range("FairValue2").Value Then
'''On the Quantitative Assessment worksheet, unhide the implied fair value
''' section and instruct user to input theimplied fair value information.
''' Also, hide the Final Assessment worksheet.
            Sheet2.Range("GoodwillSection").Rows.Hidden = False
            Sheet2.Range("QuanAssessResult").Value = _
             "Input all three reporting unit amounts to proceed."
            Sheet3.Visible = xlSheetHidden
'''If NPV used to measure reporting unit
            If Sheet2.Range("MethodTypeResult").Value = 2 Then
''''On the Quantitative Assessment worksheet, unhide and populate the cash flow response
                Sheet2.Range("CashFlowResponse").Rows.Hidden = False
                Sheet2.Range("CashFlowResponse").Value = "Complete the following " & _
                 "reporting unit information."
'''If NPV not used to measure fair value of reporting unit
            Else
''''On the Quantitative Assessment worksheet, hide the cash flow response
                Sheet2.Range("CashFlowResponse").Rows.Hidden = True
            End If
'            Sheet2.Range("GoodwillInputs").Offset(-2, 0).Resize(5, 1).Rows.Hidden = False
'            Sheet2.Range("FairValue5").Rows.Hidden = False
''If the Quantitative Assessment worksheet's "carrying amount of reporting unit,
'' including goodwill" is less than or equal to its fair value
        ElseIf Sheet2.Range("FairValue1").Value <> "" And _
         Sheet2.Range("CarryAmount").Value <= Sheet2.Range("FairValue1").Value Or _
         Sheet2.Range("FairValue2").Value <> "" And _
         Sheet2.Range("CarryAmount").Value <= Sheet2.Range("FairValue2").Value Then
'''On the Quantitative Assessment worksheet, hide the cash flow response, hide the
''' implied goodwill section, and add instructions that no other quantitative
''' inputs are necessary. Also, unhide the Final Assessment worksheet.
            Sheet2.Range("CashFlowResponse").Rows.Hidden = True
            Sheet2.Range("GoodwillSection").Rows.Hidden = True
            Sheet2.Range("QuanAssessResult").Value = "No further inputs are " & _
            "necessary. Please proceed to the Final Assessment worksheet."
            Sheet3.Visible = xlSheetVisible
        End If
    End If
'Unhide goodwill question #2 (Bypass Question) and hide/unhide
'the qualitative assessment section.
    Range("GWQualQuest2").EntireRow.Hidden = False
    Range("QualBypassQuest").EntireRow.Hidden = False
    With QualYes1
        .Top = Range("QualBypassQuest").Top + 0.75
'        .Value = False
        .Visible = True
    End With
    With QualNo1
        .Top = Range("QualBypassQuest").Top + 0.75
'        .Value = False
        .Visible = True
    End With
    If QualYes1.Value = False And QualNo1.Value = False Then
        Range("QualAssessFactors").EntireRow.Hidden = True
        With QualYes2
            .Top = Range("QualAssessYes2").Top
            .Value = False
            .Visible = False
        End With
        With QualNo2
            .Top = Range("QualAssessNo2").Top
            .Value = False
            .Visible = False
        End With
    Range("GWQualQuest2").Resize(1, 1).Select
    ElseIf QualYes1.Value = True Then
        Range("QualBypassQuest").EntireRow.Hidden = False
        Range("QualAssessFactors").EntireRow.Hidden = True
        Range("QualBypassResult").Resize(1, 1).Select
    ElseIf QualNo1.Value = True Then
        Range("QualBypassQuest").EntireRow.Hidden = False
        Range("QualAssessFactors").EntireRow.Hidden = False
        Range("QualBypassResult").Resize(1, 1).Select
    End If

    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub GWYes1_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
'If Quantitative Assessment worksheet's "fair value of reporting unit"
' has been entered or calculated
    If Sheet2.Range("FairValue1").Value <> "" Or _
     Sheet2.Range("FairValue2").Value <> "" Then
''Remove all implied fair value inputs
        Sheet2.Range("GoodwillInputs").ClearContents
'''If carrying amount of the entity/reporting unit is greater than its fair value
        If Sheet2.Range("FairValue1").Value <> "" And _
         Sheet2.Range("CarryAmount").Value > Sheet2.Range("FairValue1").Value Or _
         Sheet2.Range("FairValue2").Value <> "" And _
         Sheet2.Range("CarryAmount").Value > Sheet2.Range("FairValue2").Value Then
''''On the Quantitative Assessment worksheet, unhide the "carrying amount of the
'''' entity's/reporting unit's goodwill input row, and add instructions for the
'''' user to make the final input. Also, hide the Final Assessment worksheet.
            Sheet2.Range("GoodwillInputs").Offset(-1, 0).Resize(4, 1).Rows.Hidden = True
            Sheet2.Range("FairValue5").Rows.Hidden = False
            Sheet2.Range("QuanAssessResult").Value = "Enter the final input to proceed."
            Sheet3.Visible = xlSheetHidden
'''If carrying amount of the entity/reporting unit is less than or equal to its fair value
        ElseIf Sheet2.Range("FairValue1").Value <> "" And _
         Sheet2.Range("CarryAmount").Value <= Sheet2.Range("FairValue1").Value Or _
         Sheet2.Range("FairValue2").Value <> "" And _
         Sheet2.Range("CarryAmount").Value <= Sheet2.Range("FairValue2").Value Then
''''On the Quantitative Assessment worksheet, hide the implied fair value section
'''' and add instructions for the user to proceed to the Final Assessment worksheet.
'''' Also, unhide the Final Assessment worksheet.
            Sheet2.Range("GoodwillSection").Rows.Hidden = True
            Sheet2.Range("QuanAssessResult").Value = "No further inputs are " & _
            "necessary. Please proceed to the Final Assessment worksheet."
            Sheet3.Visible = xlSheetVisible
        End If
    End If
'Unhide goodwill question #2 (Bypass Question) and hide/unhide
'the qualitative assessment section.
    Range("GWQualQuest2").EntireRow.Hidden = False
    Range("QualBypassQuest").EntireRow.Hidden = False
    With QualYes1
        .Top = Range("QualBypassQuest").Top + 0.75
'        .Value = False
        .Visible = True
    End With
    With QualNo1
        .Top = Range("QualBypassQuest").Top + 0.75
'        .Value = False
        .Visible = True
    End With
    If QualYes1.Value = False And QualNo1.Value = False Then
        Range("QualAssessFactors").EntireRow.Hidden = True
        With QualYes2
            .Top = Range("QualAssessYes2").Top
            .Value = False
            .Visible = False
        End With
        With QualNo2
            .Top = Range("QualAssessNo2").Top
            .Value = False
            .Visible = False
        End With
        Range("GWQualQuest2").Resize(1, 1).Select
    ElseIf QualYes1.Value = True Then
        Range("QualBypassQuest").EntireRow.Hidden = False
        Range("QualAssessFactors").EntireRow.Hidden = True
        Range("QualBypassResult").Resize(1, 1).Select
    ElseIf QualNo1.Value = True Then
        Range("QualBypassQuest").EntireRow.Hidden = False
        Range("QualAssessFactors").EntireRow.Hidden = False
        Range("QualBypassResult").Resize(1, 1).Select
    End If
'    Range("GWQualQuest5").Resize(1, 1).Select
'    If QualYes1.Value = False And QualNo1.Value = False Then
'        Range("GWQualQuest5").EntireRow.Hidden = False
'        Range("QualBypassQuest").EntireRow.Hidden = False
'        Range("QualAssessFactors").EntireRow.Hidden = True
'        With QualYes1
'            .Top = Range("QualAssessYes1").Top
'            .Value = False
'            .Visible = False
'        End With
'        With QualNo1
'            .Top = Range("QualAssessNo1").Top
'            .Value = False
'            .Visible = False
'        End With
'        With QualYes2
'            .Top = Range("QualAssessYes2").Top
'            .Value = False
'            .Visible = False
'        End With
'        With QualNo2
'            .Top = Range("QualAssessNo2").Top
'            .Value = False
'            .Visible = False
'        End With
'    Range("GWQualQuest5").Resize(1, 1).Select
'    ElseIf QualYes1.Value = True Then
'        Range("QualBypassQuest").EntireRow.Hidden = False
'        Range("QualAssessFactors").EntireRow.Hidden = True
'    Range("QualBypassResult").Resize(1, 1).Select
'    ElseIf QualNo1.Value = True Then
'        Range("QualBypassQuest").EntireRow.Hidden = False
'        Range("QualAssessFactors").EntireRow.Hidden = False
'    Range("QualBypassResult").Resize(1, 1).Select
'    End If
       
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_Activate()

    Range("A1").Select
    

End Sub

Private Sub AssetTypeComboBox_Change()

    Static bOnce As Boolean
    Dim cmt12 As Comment
    Dim cmt14 As Comment
    Dim TextWidth As Integer

'This line of code hopefully keeps "errors" occuring when the workbook is closed.
If ThisWorkbook.Worksheets("Qualitative Assessment") _
 .AssetTypeComboBox.ListCount <> CLng(5) Then GoTo Conclude
'    If Sheet1.Range("ComboEventValue").Value = 0 Then GoTo Conclude
    
If ActiveSheet.Name = "Qualitative Assessment" Then

    If bOnce <> True Then
        bOnce = True
        GoTo Conclude
    End If
'For all...remove merged cells and border formatting from the
'Asset Type (AT) Instructions row (12)
    Sheet1.Range("ComboEventValue").Value = 1
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Range("AssetDescript").Value = ""
    With Range("AssetTypeInstruct")
        .UnMerge
        .RowHeight = 25.5
    End With
    Range(Range("AssetTypeInstruct").Offset(0, 1), _
     Range("AssetTypeInstruct").Offset(0, 2)).Select
    Selection.Borders.LineStyle = xlNone
'''''    Selection.Offset(0, 1).Select
'''''    Selection.Borders.LineStyle = xlNone
'If Goodwill was selected...
    If AssetTypeComboBox.Value = 1 Then
''If there is not a comment in column A of the AT Instructions row (12)...
        If Range("AssetTypeInstruct").Offset(0, -1).Comment Is Nothing Then
'''do the cut and paste comment from row 14 to 12.
            Application.CutCopyMode = False
            Range("AssetTypeInstruct").Offset(2, -1).Cut _
             Range("AssetTypeInstruct").Offset(0, -1)
            Application.CutCopyMode = False
        End If
'If anything but Goodwill is selected...
    Else
''If there is not a comment in column A of the two rows below the AT Instructions row (14)
        If Range("AssetTypeInstruct").Offset(2, -1).Comment Is Nothing Then
'''do the cut and paste comment from 12 to 14.
            Application.CutCopyMode = False
            Range("AssetTypeInstruct").Offset(0, -1).Cut _
             Range("AssetTypeInstruct").Offset(2, -1)
            Application.CutCopyMode = False
        End If
    End If
'For all...reinstate merged cells to and hide all rows below the Asset Type (AT) Instructions row (12)
    Range(Range("AssetTypeInstruct"), Range("AssetTypeInstruct").Offset(0, 9)).Merge
    Range("AssetTypeInstruct").HorizontalAlignment = xlLeft
    GWYes1.Visible = False
    GWNo1.Visible = False
    Range("GWQualQuest2").EntireRow.Hidden = True
    Range("QualBypassQuest").EntireRow.Hidden = True
    Range("QualBypassResult").Value = ""
    Range("QualAssessAnswers").Value = ""
    Range("QualAssessResult").Value = ""
    Range("QualAssessFactors").EntireRow.Hidden = True
'For no selection, Unamortizable intangibles, and PPE only
    If AssetTypeComboBox.Value = 0 Or AssetTypeComboBox.Value = 2 Or AssetTypeComboBox.Value = 4 Then
'''''        Range("QualBypassResult").Value = ""
'''''        Range("QualAssessAnswers").Value = ""
'''''        Range("QualAssessResult").Value = ""
'''''        Range("QualAssessFactors").EntireRow.Hidden = True
'''''        Range("QualBypassQuest").EntireRow.Hidden = True
''Hide all goodwill and qualitative assessment questions, radio buttons, text boxes, and instructions.
''(This may not be necessary.)
        With GWYes1
            .Top = Range("AssetTypeInstruct").Top + 0.75
            .Value = False
'            .Visible = False
        End With
        With GWNo1
            .Top = Range("AssetTypeInstruct").Top + 0.75
            .Value = False
'            .Visible = False
        End With
        With QualYes1
            .Top = Range("QualBypassQuest").Top + 0.75
            .Value = False
            .Visible = False
        End With
        With QualNo1
            .Top = Range("QualBypassQuest").Top + 0.75
            .Value = False
            .Visible = False
        End With
        With QualYes2
            .Top = Range("QualAssessYes2").Top
            .Value = False
            .Visible = False
        End With
        With QualNo2
            .Top = Range("QualAssessNo2").Top
            .Value = False
            .Visible = False
        End With
        Sheet3.Visible = xlSheetHidden
    End If
'For all...answer QuanQuestion2 as "Yes" and hide QuanQuestion2 and radio buttions
    With ThisWorkbook.Worksheets("Quantitative Assessment").QuanYes2
        .Top = Sheet2.Range("QuanYN2").Top + 5.5
        .Value = True
        .Visible = False
    End With
    With ThisWorkbook.Worksheets("Quantitative Assessment").QuanNo2
        .Top = Sheet2.Range("QuanYN2").Top + 5.5
        .Value = False
        .Visible = False
    End With
    Sheet2.Range("QuanQuestion2").Rows.Hidden = True
'For PPE only...
    If AssetTypeComboBox.Value = 4 Then
''Clear QuanQuestion 2
        ThisWorkbook.Worksheets("Quantitative Assessment").QuanYes2.Value = False
    End If
'For all...Hide and clear QuanQuestion3 amount, show (sheet 1) AT Instructions, and
'make the Quantitative Assessment sheet (2) visible.
    Sheet2.Range("CarryAmount").ClearContents
    Sheet2.Range("QuanQuestion3").Rows.Hidden = True
'    Range("AssetTypeInstructs").EntireRow.Hidden = False
    Range("AssetTypeInstructs").EntireRow.Hidden = False
    Sheet2.Visible = xlSheetVisible
'For all...Hide and clear QuanQuestion4
    Sheet2.Range("QuanResponse4").Value = ""
    If Sheet2.Range("QuanQuestion4").Rows.Hidden = False Then
        Sheet2.Range("QuanQuestion4").Rows.Hidden = True
        With ThisWorkbook.Worksheets("Quantitative Assessment").QuanYes3
            .Top = Sheet2.Range("QuanYN3").Top + 5.5
            .Value = False
            .Visible = False
        End With
        With ThisWorkbook.Worksheets("Quantitative Assessment").QuanNo3
            .Top = Sheet2.Range("QuanYN3").Top + 5.5
            .Value = False
            .Visible = False
        End With
    End If
'For all...Hide and clear QuanQuestion5
    Sheet2.MethodComboBox.Visible = False
    If Sheet2.MethodComboBox.Value <> 0 Then
        Sheet2.MethodComboBox.Value = 0
    End If
    Sheet2.Range("QuanQuestion5").Rows.Hidden = True
'For all...Hide and clear cash flow and fair value sections
    Sheet2.Range("CashFlowInputs").ClearContents
    Sheet2.Range("CashFlowResponse").ClearContents
    Sheet2.Range("FairValueInputs").ClearContents
    Sheet2.Range("QuanAssessResult").Value = ""
    Sheet2.Range("CashFlowSection").Rows.Hidden = True
    Sheet2.Range("FairValueSection").Rows.Hidden = True
    Sheet2.Range("QuanAssessResult").Rows.Hidden = True
    With ThisWorkbook.Worksheets("Quantitative Assessment").chkCashFlow
        .Value = False
        .Visible = False
    End With
'For Select (the type of asset) only...
    If AssetTypeComboBox.Value = 0 Then
''Hide the AT Instructions row and the Quantitative Assessment sheet (2)
        Range("AssetTypeInstructs").EntireRow.Hidden = True
        Sheet2.Visible = xlSheetHidden
    End If
'For Unamortizable intangibles and PPE only
    If AssetTypeComboBox.Value = 2 Or AssetTypeComboBox.Value = 4 Then
''Unhide the AT Instructions row and the Quantitative Assessment sheet (2)
        Range("AssetTypeInstructs").EntireRow.Hidden = False
        Sheet2.Visible = xlSheetVisible
''Enable and clear QuanQuestion1
        Sheet2.Range("QuanQuestion1").Rows.Hidden = False
        With ThisWorkbook.Worksheets("Quantitative Assessment").QuanYes1
            .Enabled = True
            .Top = Sheet2.Range("QuanYN1").Top + 5.5
            .Value = False
            .Visible = True
        End With
        With ThisWorkbook.Worksheets("Quantitative Assessment").QuanNo1
            .Enabled = True
            .Top = Sheet2.Range("QuanYN1").Top + 5.5
            .Value = False
            .Visible = True
        End With
        Sheet2.Range("QuanResponse1").Value = ""
    End If
'For Goodwill and nonamortizable intangibles only...
    If AssetTypeComboBox.Value = 1 Or AssetTypeComboBox.Value = 3 Then
''Unhide and clear QuanQuestion3
        Sheet2.Range("CarryAmount").ClearContents
        Sheet2.Range("QuanQuestion3").Rows.Hidden = False
''For Goodwill only...
        If AssetTypeComboBox.Value = 1 Then
'''Unmerge the Sheet 1 AT Instructions
            Range("AssetTypeInstruct").UnMerge
'''Remerge AT Instructs (but only for 5 columns)
            Range(Range("AssetTypeInstruct"), Range("AssetTypeInstruct").Offset(0, 5)).Merge
            Range("AssetTypeInstruct").HorizontalAlignment = xlLeft
'*************************************************************************************
'''Assess the length of the value in AT Instructions and adjust row height accordingly
'''Unique to WPN...not necessary for WPC
            Range("AssetTypeInstruct").Select
            Selection.Copy
            Range("AA1").Select
            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
                :=False, Transpose:=False
            Range("AA1").Select
            Selection.Columns.AutoFit
            Application.CutCopyMode = False
            TextWidth = Selection.Width
            Selection.EntireColumn.Delete
            Range("AssetTypeInstruct").Select
            If Selection.Width > TextWidth Then
                Range("AssetTypeInstruct").RowHeight = 17
            Else
                 Range("AssetTypeInstruct").RowHeight = 25.5
            End If
'''Add GW Question Yes/No radios with borders
'''Differs between WPN and WPC...
            Range("AssetTypeInstruct").Offset(0, 1).Select
            With Selection.Borders
                .LineStyle = xlContinuous
                .ColorIndex = xlAutomatic
                .Weight = xlThin
            End With
            Selection.Borders(xlEdgeRight).LineStyle = xlNone
            Selection.Offset(0, 1).Select
            With Selection.Borders
                .LineStyle = xlContinuous
                .ColorIndex = xlAutomatic
                .Weight = xlThin
            End With
            Selection.Borders(xlEdgeLeft).LineStyle = xlNone
            With GWYes1
                If Range("AssetTypeInstruct").RowHeight = 17 Then
                    .Top = Range("AssetTypeInstruct").Top + 0.75
                Else
                    .Top = Range("AssetTypeInstruct").Top + 5.75
                End If
                .Visible = True
            End With
            With GWNo1
                If Range("AssetTypeInstruct").RowHeight = 17 Then
                    .Top = Range("AssetTypeInstruct").Top + 0.75
                Else
                    .Top = Range("AssetTypeInstruct").Top + 5.75
                End If
                .Visible = True
            End With
'*************************************************************************************
'''Hide all subsequent sheet 1 rows
            With QualYes1
                .Top = Range("QualBypassQuest").Top + 0.75
                .Value = False
                .Visible = False
            End With
            With QualNo1
                .Top = Range("QualBypassQuest").Top + 0.75
                .Value = False
                .Visible = False
            End With
            With QualYes2
                .Top = Range("QualAssessYes2").Top
                .Value = False
                .Visible = False
            End With
            With QualNo2
                .Top = Range("QualAssessNo2").Top
                .Value = False
                .Visible = False
            End With
            Range("QualBypassQuest").EntireRow.Hidden = True
        End If
''For Nonamortizable Intangibles only...
        If AssetTypeComboBox.Value = 3 Then
'''Hide and clear GW Question 1 row and all subsequent sheet 1 rows/radio buttons.
            Range("QualBypassQuest").EntireRow.Hidden = False
            With GWYes1
                .Top = Range("AssetTypeInstruct").Top + 0.75
                .Value = False
    '            .Visible = False
            End With
            With GWNo1
                .Top = Range("AssetTypeInstruct").Top + 0.75
                .Value = False
    '            .Visible = False
            End With
            With QualYes1
                .Top = Range("QualBypassQuest").Top + 0.75
                .Value = False
                .Visible = True
            End With
            With QualNo1
                .Top = Range("QualBypassQuest").Top + 0.75
                .Value = False
                .Visible = True
            End With
            With QualYes2
                .Top = Range("QualAssessYes2").Top
                .Value = False
                .Visible = False
            End With
            With QualNo2
                .Top = Range("QualAssessNo2").Top
                .Value = False
                .Visible = False
            End With
        End If
''For Goodwill and nonamortizable intangibles only
        Sheet2.Visible = xlSheetHidden
        Sheet3.Visible = xlSheetHidden
    End If
'For all--Place cursor
    Range("AssetDescript").Select
End If
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True


Conclude:

End Sub

Private Sub QualNo1_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("QualBypassResult").Value = "Please complete the following qualitative assessment."
    With Range("QualBypassResult")
        .EntireRow.Hidden = False
        .Value = "Please complete the following qualitative assessment."
    End With
    Range("QualAssessResult").Value = ""
    Range("QualAssessAnswers").Value = ""
    Range("QualAssessFactors").EntireRow.Hidden = False
    If AssetTypeComboBox.Value = 3 Then
        Range("QualAssessFactorsGW").EntireRow.Hidden = True
    End If
    With QualYes2
        .Top = Range("QualAssessYes2").Top
        .Value = False
        .Visible = True
    End With
    With QualNo2
        .Top = Range("QualAssessNo2").Top
        .Value = False
        .Visible = True
    End With
    Sheet2.QuanYes1.Value = False
    Sheet2.QuanNo1.Value = False
    Sheet2.Range("QuanResponse1").Value = ""

    Range("QualBypassResult").Select
    Sheet2.Visible = xlSheetHidden
    Sheet3.Visible = xlSheetHidden
    
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub QualNo2_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("QualAssessResult").Value = "No further inputs are necessary. Please proceed to the Final Assessment worksheet."
    Sheet2.Visible = xlSheetHidden
    Sheet3.Visible = xlSheetVisible
    Range("QualAssessResult").Select
       
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub QualYes1_Click()
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("QualAssessResult").Value = ""
    Sheet2.Range("QuanResponse1").Value = ""
    With Range("QualBypassResult")
        .EntireRow.Hidden = False
        .Value = "Please proceed to the Quantitative Assessment worksheet."
    End With
    Range("QualAssessAnswers").Value = ""
    Range("QualAssessFactors").EntireRow.Hidden = True
    With QualYes2
        .Value = False
        .Visible = False
    End With
    With QualNo2
        .Value = False
        .Visible = False
    End With
''Enable and clear QuanQuestion1
'    With Sheet2.QuanYes1
'        .Enabled = True
'        .Top = Sheet2.Range("QuanYN1").Top + 5.5
'        .Value = False
'    End With
'    With Sheet2.QuanNo1
'        .Enabled = True
'        .Top = Sheet2.Range("QuanYN1").Top + 5.5
'        .Value = False
'    End With
'Hide, disable, and answer QuanQuestion1
    Sheet2.Range(Sheet2.Range("QuanQuestion1"), _
     Sheet2.Range("QuanQuestion1").Offset(1, 0)).Rows.Hidden = True
    With Sheet2.QuanYes1
        .Enabled = False
        .Top = Sheet2.Range("QuanYN1").Top - 15.5
        .Value = True
        .Visible = False
    End With
    With Sheet2.QuanNo1
        .Enabled = False
        .Top = Sheet2.Range("QuanYN1").Top - 15.5
        .Value = False
        .Visible = False
    End With
'Hide and answer QuanQuestion2
    Sheet2.Range("QuanQuestion2").Rows.Hidden = True
    With Sheet2.QuanYes2
        .Top = Sheet2.Range("QuanYN2").Top - 5.5
        .Value = True
        .Visible = False
    End With
    With Sheet2.QuanNo2
        .Top = Sheet2.Range("QuanYN2").Top - 5.5
        .Value = False
        .Visible = False
    End With
''Hide and clear QuanQuestion3
'    Sheet2.Range("CarryAmount").ClearContents
'    Sheet2.Range("QuanQuestion3").Rows.Hidden = True
'Unhide and clear QuanQuestion3
    Sheet2.Range("CarryAmount").ClearContents
    Sheet2.Range("QuanQuestion3").Rows.Hidden = False

'Hide and clear QuanQuestion4
    Sheet2.Range("QuanResponse4").Value = ""
    Sheet2.Range("QuanQuestion4").Rows.Hidden = True
    With Sheet2.QuanYes3
        .Height = 15.75
        .Value = False
        .Visible = False
    End With
    With Sheet2.QuanNo3
        .Value = False
        .Visible = False
    End With
'Hide and clear QuanQuestion5
    Sheet2.Range("QuanQuestion5").Rows.Hidden = True
    Sheet2.MethodComboBox.Visible = False
'Hide and clear cash flow and fair value sections
    Sheet2.Range("CashFlowInputs").ClearContents
    Sheet2.Range("CashFlowResponse").ClearContents
    Sheet2.Range("FairValueInputs").ClearContents
    Sheet2.Range("QuanAssessResult").Value = ""
    Sheet2.Range("CashFlowSection").Rows.Hidden = True
    Sheet2.Range("FairValueSection").Rows.Hidden = True
    Sheet2.Range("QuanAssessResult").Rows.Hidden = True
    With Sheet2.chkCashFlow
        .Value = False
        .Visible = False
    End With
'Hide/Unhide worksheets and select next cell
    Range("QualBypassResult").Select
    Sheet2.Visible = xlSheetVisible
    Sheet3.Visible = xlSheetHidden
       
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Private Sub QualYes2_Click()

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    Range("QualAssessResult").Value = "Please proceed to the Quantitative Assessment worksheet."
'For both goodwill and other nonamortizable intangibles
'Hide, disable, and answer QuanQuestion1
    Sheet2.Range("QuanQuestion1").Rows.Hidden = True
    With Sheet2.QuanYes1
        .Enabled = False
        .Value = True
        .Visible = False
    End With
    With Sheet2.QuanNo1
        .Enabled = False
        .Value = False
        .Visible = False
    End With
'Hide and answer QuanQuestion2
    Sheet2.Range("QuanQuestion2").Rows.Hidden = True
    With Sheet2.QuanYes2
        .Top = Sheet2.Range("QuanYN2").Top + 5.5
        .Value = True
        .Visible = False
    End With
    With Sheet2.QuanNo2
        .Top = Sheet2.Range("QuanYN2").Top + 5.5
        .Value = False
        .Visible = False
    End With
'Unhide and clear QuanQuestion3
    Sheet2.Range("CarryAmount").ClearContents
    Sheet2.Range("QuanQuestion3").Rows.Hidden = False
'Hide and clear QuanQuestion4
    Sheet2.Range("QuanResponse4").Value = ""
    Sheet2.Range("QuanQuestion4").Rows.Hidden = True
    With Sheet2.QuanYes3
        .Height = 15.75
        .Value = False
        .Visible = False
    End With
    With Sheet2.QuanNo3
        .Value = False
        .Visible = False
    End With
'Hide and clear QuanQuestion5
    Sheet2.Range("QuanQuestion5").Rows.Hidden = True
    Sheet2.MethodComboBox.Visible = False
'Hide and clear cash flow and fair value sections
    Sheet2.Range("CashFlowInputs").ClearContents
    Sheet2.Range("CashFlowResponse").ClearContents
    Sheet2.Range("FairValueInputs").ClearContents
    Sheet2.Range("QuanAssessResult").Value = ""
    Sheet2.Range("CashFlowSection").Rows.Hidden = True
    Sheet2.Range("FairValueSection").Rows.Hidden = True
    Sheet2.Range("QuanAssessResult").Rows.Hidden = True
    With Sheet2.chkCashFlow
        .Value = False
        .Visible = False
    End With
'Hide/Unhide worksheets and select next cell
    Sheet2.Visible = xlSheetVisible
    Sheet3.Visible = xlSheetHidden
    Range("QualAssessResult").Select
       
    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub


Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "QuanYes1, 24, 0, MSForms, OptionButton"
Attribute VB_Control = "QuanNo1, 25, 1, MSForms, OptionButton"
Attribute VB_Control = "QuanYes2, 27, 2, MSForms, OptionButton"
Attribute VB_Control = "QuanNo2, 28, 3, MSForms, OptionButton"
Attribute VB_Control = "QuanYes3, 29, 4, MSForms, OptionButton"
Attribute VB_Control = "QuanNo3, 30, 5, MSForms, OptionButton"
Attribute VB_Control = "MethodComboBox, 33, 6, MSForms, ComboBox"
Attribute VB_Control = "chkCashFlow, 34, 7, MSForms, CheckBox"

Private Sub chkCashFlow_Click()

    If ThisWorkbook.ActiveSheet.Name = "Quantitative Assessment" Then

        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
'If unchecked
        If chkCashFlow.Value = False Then
            Range("QuanAssessResult").Value = ""
            Range("CashFlowResponse").ClearContents
            Range("FairValueInputs").ClearContents
            Range("FairValueSection").Rows.Hidden = True
            Range("QuanAssessResult").Rows.Hidden = True
            Range("CashFlowResponse").Rows.Hidden = True
            Range("CashFlowUndiscount").Resize(1, 1).Select
            Sheet3.Visible = xlSheetHidden
        End If
'If checked
        If chkCashFlow.Value = True Then
''For goodwill
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 1 Then
                Range("FairValue2").Rows.Hidden = False
'''If ASU 2017-04 adopted...
                If ThisWorkbook.Worksheets("Qualitative Assessment").GWYes1.Value = True Then
                    Range("CashFlowResponse").ClearContents
                    Range("CashFlowResponse").Rows.Hidden = True
''''If carrying amount the of entity/reporting unit is less than its fair value
                    If Range("CarryAmount").Value < Range("FairValue2").Value Then
'''''Clear the implied fair value inputs, hide the "carrying amount of the
''''' entity's/reporting unit's goodwill input row, unhide the Final Assessment
''''' worksheet, and instruct the user to go to the Final Assessment worksheet.
                        Range("GoodwillInputs").ClearContents
                        Range("GoodwillSection").Rows.Hidden = True
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
''''If carrying amount the of entity/reporting unit is >= its fair value
                    Else
'''''Clear the implied fair value inputs, unhide the "carrying amount of the
''''' reporting unit's goodwill input row, hide the Final Assessment
''''' worksheet, and instruct the user to go to make the final input.
                        Range("GoodwillSection").Rows.Hidden = True
                        Range("GoodwillSection").Resize(1, 1).Rows.Hidden = False
                        Range("FairValue5").Rows.Hidden = False
                        Range("FairValue6").Value = ""
                        Range("FairValue7").Value = ""
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "Enter the final input to proceed."
                        Sheet3.Visible = xlSheetHidden
'                       GoTo ConcludeChgFV1
                    End If
                Else
'''If ASU 2017-04 not adopted...
                    Range("GoodwillSection").Rows.Hidden = False
                    Range("CashFlowResponse").Rows.Hidden = False
                    Range("CashFlowResponse").Value = "Complete the following " & _
                    "reporting unit information."
'                    Range("QuanAssessResult").Rows.Hidden = False
'                    Range("QuanAssessResult").Value = "Input all three reporting " & _
'                    "unit amounts to proceed."
''''If carrying amount is equal to or less than zero
                    If QuanYes3.Value = True Then
'                        Range("CashFlowResponse").Value = "Complete the following " & _
'                        "reporting unit information."
'                        Range("GoodwillSection").Rows.Hidden = False
                        Range("QuanAssessResult").Value = ""
                        Range("QuanAssessResult").Rows.Hidden = True
                        Range("FairValue5").Select
                        GoTo ConcludeCheck
                    End If
''''If carrying amount is greater than zero and the fair value
                    If Range("FairValue2").Value < Range("CarryAmount").Value Then
'                        Range("CashFlowResponse").Rows.Hidden = False
'                        Range("CashFlowResponse").Value = "Complete the following " & _
'                        "reporting unit information."
'                        Range("GoodwillSection").Rows.Hidden = False
                        Range("QuanAssessResult").Value = ""
                        Range("QuanAssessResult").Rows.Hidden = True
                        Range("FairValue5").Select
''''If carrying amount is greater than zero but less than the fair value
                    Else
                        Range("CashFlowResponse").ClearContents
                        Range("CashFlowResponse").Rows.Hidden = True
                        Range("GoodwillSection").Rows.Hidden = True
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
                    End If
                End If
            End If
''For amortizable intangible assets
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 2 Then
'''If Market or Other valuation method
                If MethodComboBox.Value = 1 Or MethodComboBox.Value = 3 Then
''''If undiscounted cash flows are less than asset's carrying amount (failed Part 1 test)
                    If Range("CashFlowUndiscountTotal").Value < Range("CarryAmount").Value Then
                        Range("FairValue1").Rows.Hidden = False
                        Range("CashFlowResponse").Rows.Hidden = False
                        Range("CashFlowResponse").Value = "Input the fair value " & _
                        "of the asset."
                        Range("QuanAssessResult").Value = ""
                        Range("QuanAssessResult").Rows.Hidden = True
                        Range("FairValue1").Select
                        Sheet3.Visible = xlSheetHidden
''''If undiscounted cash flows are equal to or greater than than asset's carrying amount
                    Else
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
                    End If
                End If
'''If NPV of future cash flows valuation method
                If MethodComboBox.Value = 2 Then
                    Range("FairValue2").Rows.Hidden = False
                    Range("QuanAssessResult").Rows.Hidden = False
                    Range("CashFlowResponse").ClearContents
                    Range("CashFlowResponse").Rows.Hidden = True
                    Range("QuanAssessResult").Value = "No further inputs are " & _
                    "necessary. Please proceed to the Final Assessment worksheet."
                    Range("QuanAssessResult").Select
                    Sheet3.Visible = xlSheetVisible
                End If
            End If
''For intangible assets not subject to amortization
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 3 Then
'''For NPV cash flow method (market or other methods not applicable)
                Range("FairValue2").Rows.Hidden = False
                Range("CashFlowResponse").ClearContents
                Range("CashFlowResponse").Rows.Hidden = True
                Range("QuanAssessResult").Rows.Hidden = False
                Range("QuanAssessResult").Value = "No further inputs are " & _
                "necessary. Please proceed to the Final Assessment worksheet."
                Range("QuanAssessResult").Select
                Sheet3.Visible = xlSheetVisible
            End If
''For PPE
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 4 Then
'''If PPE is held for sale (only NPV of future cash flows valuation method is applicable)
                If QuanNo2.Value = True Then
                    Range("CashFlowResponse").Rows.Hidden = False
                    Range("CashFlowResponse").Value = "Input the costs " & _
                    "to sell the asset."
                    Range("FairValue2").Rows.Hidden = False
                    Range("FairValue3").Rows.Hidden = False
                    Range("FairValue4").Rows.Hidden = False
                    Range("FairValue3").Select
'''If PPE is held and used
                ElseIf QuanYes2.Value = True Then
''''If Market or Other valuation method
                    If MethodComboBox.Value = 1 Or MethodComboBox.Value = 3 Then
'''''If undiscounted cash flows are less than asset's carrying amount (failed Part 1 test)
                        If Range("CashFlowUndiscountTotal").Value < Range("CarryAmount").Value Then
                            Range("FairValue1").Rows.Hidden = False
                            Range("CashFlowResponse").Rows.Hidden = False
                            Range("CashFlowResponse").Value = "Input the fair value " & _
                            "of the asset."
                            Range("QuanAssessResult").Value = ""
                            Range("QuanAssessResult").Rows.Hidden = True
                            Range("FairValue1").Select
                            Sheet3.Visible = xlSheetHidden
'''''If undiscounted cash flows are equal to or greater than than asset's carrying amount
                        Else
                            Range("CashFlowResponse").ClearContents
                            Range("CashFlowResponse").Rows.Hidden = True
                            Range("QuanAssessResult").Rows.Hidden = False
                            Range("QuanAssessResult").Value = "No further inputs are " & _
                            "necessary. Please proceed to the Final Assessment worksheet."
                            Sheet3.Visible = xlSheetVisible
                        End If
                    End If
''''If NPV of future cash flows valuation method
                    If MethodComboBox.Value = 2 Then
                        Range("FairValue2").Rows.Hidden = False
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("CashFlowResponse").ClearContents
                        Range("CashFlowResponse").Rows.Hidden = True
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
                    End If
                End If
            End If
        End If
ConcludeCheck:
        Application.EnableEvents = True
        Application.ScreenUpdating = True
    End If

End Sub

Private Sub MethodComboBox_Change()

    If Sheet1.Range("ComboEventValue").Value = 0 Then GoTo Conclude2
    
    If ThisWorkbook.ActiveSheet.Name = "Quantitative Assessment" Then

        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        If IsNull(MethodComboBox.Value) Then
            Range("MethodTypeResult").Value = MethodComboBox.Text
        End If
        Range("CashFlowInstructs").Value = ""
        Range("CashFlowInstructs").RowHeight = 25.5
        Range("CashFlowInputs").ClearContents
        Range("FairValueInputs").ClearContents
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Value = ""
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
        If MethodComboBox.Value = 0 Then
            Range("QuanQuestion5").Resize(1, 6).Select
        End If
        If MethodComboBox.Value = 1 Or MethodComboBox.Value = 3 Then
            If Sheet1.Range("AssetTypeResult").Value = 1 Or Sheet1.Range("AssetTypeResult").Value = 3 Then
                Range("FairValue1").Rows.Hidden = False
                Range("FairValue1").Select
            End If
            If Sheet1.Range("AssetTypeResult").Value = 2 Then
                Range("CashFlowSection").Rows.Hidden = False
                With chkCashFlow
                    .Top = Range("CashFlowResponse").Top - 10
                    .Visible = True
                End With
                Range("CashFlowInstructs").Value = "Input the undiscounted expected " & _
                "cash inflows (outflows) in the table below."
                Range("CashFlowUndiscount").Resize(1, 1).Select
            End If
            If Sheet1.Range("AssetTypeResult").Value = 4 Then
                If QuanNo2.Value = True Then
                    Range("FairValue1").Rows.Hidden = False
                    Range("FairValue3").Rows.Hidden = False
                    Range("FairValue4").Rows.Hidden = False
                    Range("FairValue1").Select
                ElseIf QuanYes2.Value = True Then
                    Range("CashFlowSection").Rows.Hidden = False
                With chkCashFlow
                    .Top = Range("CashFlowResponse").Top - 10
                    .Visible = True
                End With
                Range("CashFlowInstructs").Value = "Input the undiscounted expected " & _
                "cash inflows (outflows) in the table below."
                    Range("CashFlowUndiscount").Resize(1, 1).Select
                End If
            End If
        End If
        If MethodComboBox.Value = 2 Then
            Range("CashFlowSection").Rows.Hidden = False
                With chkCashFlow
                    .Top = Range("CashFlowResponse").Top - 10
                    .Visible = True
                End With
            Range("CashFlowInstructs").Value = "Complete the cash flow table below."
            Range("CashFlowInputs").Item(1).Select
        End If
        Application.EnableEvents = True
        Application.ScreenUpdating = True
    End If

Conclude2:
End Sub

Private Sub QuanNo1_Click()

    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
'If type of asset on the Qualitative Assessment worksheet is not selected
'then provide instructions to go to the Qualitative worksheet...
        If Sheet1.AssetTypeComboBox.Value = 0 Then
            QuanNo1.Value = False
            Range("QuanResponse1").Value = "Please select the type of asset from " & _
             "the Qualitative Assessment worksheet."
            Range("QuanResponse1").Select
            GoTo ConcludeQuanNo1
        End If
'Hide and clear QuanQuestion2
        If Range("QuanQuestion2").Rows.Hidden = False Then
            Range("QuanQuestion2").Rows.Hidden = True
            With QuanYes2
                .Top = Range("QuanYN2").Top + 5.5
                .Value = False
                .Visible = False
            End With
            With QuanNo2
                .Top = Range("QuanYN2").Top + 5.5
                .Value = False
                .Visible = False
            End With
        End If
'Hide and clear QuanQuestion3
        Range("QuanQuestion3").Rows.Hidden = True
        Range("CarryAmount").ClearContents
'Hide and clear QuanQuestion4
        If Range("QuanQuestion4").Rows.Hidden = False Then
            Range("QuanQuestion4").Rows.Hidden = True
            With QuanYes3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
            With QuanNo3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
        End If
'Hide and clear QuanQuestion5
        MethodComboBox.Visible = False
        If MethodComboBox.Value <> 0 Then
            MethodComboBox.Value = 0
        End If
        Range("QuanQuestion5").Rows.Hidden = True
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
'Response to QuanQuestion1
        Range("QuanResponse1").RowHeight = 25.5
        Range("QuanResponse1").Value = "No further inputs are necessary. Please proceed to the Final Assessment worksheet."
        Range("QuanResponse1").Select

        Sheet3.Visible = xlSheetVisible

ConcludeQuanNo1:
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If
    
End Sub

Private Sub QuanNo2_Click()
    
    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        Sheet3.Visible = xlSheetHidden
'Unhide and clear QuanQuestion3
        Range("QuanQuestion3").Rows.Hidden = False
        Range("CarryAmount").ClearContents
'Hide and clear QuanQuestion4
        If Range("QuanQuestion4").Rows.Hidden = False Then
            Range("QuanQuestion4").Rows.Hidden = True
            With QuanYes3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
            With QuanNo3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
        End If
'Hide and clear QuanQuestion5
        MethodComboBox.Visible = False
        If MethodComboBox.Value <> 0 Then
            MethodComboBox.Value = 0
        End If
        Range("QuanQuestion5").Rows.Hidden = True
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
'Place cursor
        If ActiveSheet.Name = "Quantitative Assessment" Then
            Range("CarryAmount").Select
        End If

        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If

End Sub

Private Sub QuanNo3_Click()

    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        Sheet3.Visible = xlSheetVisible

'Hide and clear QuanQuestion5
        MethodComboBox.Visible = False
        If MethodComboBox.Value <> 0 Then
            MethodComboBox.Value = 0
        End If
        Range("QuanQuestion5").Rows.Hidden = True
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
'Response to QuanQuestion4
        Range("QuanResponse4").RowHeight = 25.5
        Range("QuanResponse4").Value = "No further inputs are necessary. Please proceed to the Final Assessment worksheet."
        Range("QuanResponse4").Select
        
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If
    
    End Sub

Private Sub QuanYes1_Click()

    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        Sheet3.Visible = xlSheetHidden
        Range("QuanResponse1").RowHeight = 12.75
        Range("QuanResponse1").Value = ""
'If type of asset on the Qualitative Assessment worksheet is not selected
'then provide instructions to go to the Qualitative worksheet and end Sub...
        If Sheet1.AssetTypeComboBox.Value = 0 Then
            QuanYes1.Value = False
            Range("QuanResponse1").Value = "Please select the type of asset from " & _
             "the Qualitative Assessment worksheet."
            GoTo ConcludeQuanYes1
        End If
'Unhide QuanQuestion2 for PPE
        If Sheet1.AssetTypeComboBox.Value = 4 Then
            Range("QuanQuestion2").Rows.Hidden = False
            With QuanYes2
                .Height = 15.75
                .Top = Range("QuanYN2").Top + 5.5
                .Value = False
                .Visible = True
            End With
            With QuanNo2
                .Top = Range("QuanYN2").Top + 5.5
                .Value = False
                .Visible = True
            End With
'Unhide QuanQuestion3 for all but PPE
        Else
            Range("QuanQuestion3").Rows.Hidden = False
        End If
'Hide and clear QuanQuestion4
        Range("QuanResponse4").Value = ""
        If Range("QuanQuestion4").Rows.Hidden = False Then
            Range("QuanQuestion4").Rows.Hidden = True
            With QuanYes3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
            With QuanNo3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
        End If
'Hide and clear QuanQuestion5
        MethodComboBox.Visible = False
        If MethodComboBox.Value <> 0 Then
            MethodComboBox.Value = 0
        End If
        Range("QuanQuestion5").Rows.Hidden = True
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With

ConcludeQuanYes1:
'Place cursor
        If Sheet1.AssetTypeComboBox.Value = 0 Then
            Range("QuanResponse1").Select
        ElseIf Sheet1.AssetTypeComboBox.Value = 4 Then
            Range("QuanYN2").Select
        Else
            Range("CarryAmount").Select
        End If
        
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If

End Sub

Private Sub QuanYes2_Click()
    
    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        Sheet3.Visible = xlSheetHidden
'Unhide and clear QuanQuestion3
        Range("QuanQuestion3").Rows.Hidden = False
        Range("CarryAmount").ClearContents
'Hide and clear QuanQuestion4
        If Range("QuanQuestion4").Rows.Hidden = False Then
            Range("QuanQuestion4").Rows.Hidden = True
            With QuanYes3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
            With QuanNo3
                .Top = Range("QuanYN3").Top + 5.5
                .Value = False
                .Visible = False
            End With
        End If
'Hide and clear QuanQuestion5
        MethodComboBox.Visible = False
        If MethodComboBox.Value <> 0 Then
            MethodComboBox.Value = 0
        End If
        Range("QuanQuestion5").Rows.Hidden = True
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
'Place cursor
        If ActiveSheet.Name = "Quantitative Assessment" Then
            Range("CarryAmount").Select
        End If
        
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If

End Sub

Private Sub QuanYes3_Click()

    If ActiveSheet.Name = "Quantitative Assessment" Then
        Application.ScreenUpdating = False
        Application.EnableEvents = False
        
        Sheet3.Visible = xlSheetHidden
        Range("QuanResponse4").RowHeight = 12.75
        Range("QuanResponse4").Value = ""
'Unhide and clear QuanQuestion5
        Range("QuanQuestion5").Rows.Hidden = False
        With MethodComboBox
            .Top = Range("QuanQuestion5").Top + 17.75
            .Visible = True
        End With
        Range("QuanQuestion5").Resize(1, 6).Select
'Hide and clear cash flow and fair value sections
        Range("CashFlowInputs").ClearContents
        Range("CashFlowResponse").ClearContents
        Range("FairValueInputs").ClearContents
        Range("QuanAssessResult").Value = ""
        Range("CashFlowSection").Rows.Hidden = True
        Range("FairValueSection").Rows.Hidden = True
        Range("QuanAssessResult").Rows.Hidden = True
        With chkCashFlow
            .Value = False
            .Visible = False
        End With
        
        Application.ScreenUpdating = True
        Application.EnableEvents = True
    End If

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

    If ActiveSheet.Name = "Quantitative Assessment" Then
'When changing carrying amount
        If Not Application.Intersect(Range("CarryAmount"), Range(Target.Address)) _
         Is Nothing Then
        
            Application.ScreenUpdating = False
            Application.EnableEvents = False
    
''For all
            Sheet3.Visible = xlSheetHidden
''Hide and clear QuanQuestion4
            Range("QuanResponse4").Value = ""
            Range("QuanQuestion4").Rows.Hidden = True
            With QuanYes3
                .Height = 15.75
                .Value = False
                .Visible = False
            End With
            With QuanNo3
                .Value = False
                .Visible = False
            End With
''Unhide QuanQuestion5
            Range("QuanQuestion5").Rows.Hidden = False
            If MethodComboBox.Value <> 0 Then
                MethodComboBox.Value = 0
            End If
            With MethodComboBox
                .Top = Range("QuanQuestion5").Top + 17.75
                .Visible = True
            End With
''Hide and clear cash flow and fair value sections
            Range("CashFlowInputs").ClearContents
            Range("CashFlowResponse").ClearContents
            Range("FairValueInputs").ClearContents
            Range("QuanAssessResult").Value = ""
            Range("CashFlowSection").Rows.Hidden = True
            Range("FairValueSection").Rows.Hidden = True
            Range("QuanAssessResult").Rows.Hidden = True
            With chkCashFlow
                .Value = False
                .Visible = False
            End With
''Cursor placement
            Range("QuanQuestion5").Resize(1, 6).Select

''For only Goodwill if ASU has 2017-04 has not been adopted (no ASU 2017-04)...
''if carrying amount is zero or less...
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 1 And ThisWorkbook.Worksheets("Qualitative Assessment").GWYes1.Value = False And _
             Range("CarryAmount").Value <= 0 Then
'''Unhide QuanQuestion4
                Range("QuanQuestion4").Rows.Hidden = False
                With QuanYes3
                    .Height = 15.75
                    .Top = Range("QuanYN3").Top + 5.5
                    .Visible = True
                End With
                With QuanNo3
                    .Top = Range("QuanYN3").Top + 5.5
                    .Visible = True
                End With
'''Hide and clear QuanQuestion5
                MethodComboBox.Visible = False
                If MethodComboBox.Value <> 0 Then
                    MethodComboBox.Value = 0
                End If
                Range("QuanQuestion5").Rows.Hidden = True
'''Cursor placement
                    Range("QuanYN3").Select
            End If
''For all...If carrying amount was only cleared
            If Range("CarryAmount").Value = "" Then
'''Hide and clear QuanQuestion4
                Range("QuanResponse4").Value = ""
                Range("QuanQuestion4").Rows.Hidden = True
                With QuanYes3
                    .Height = 15.75
                    .Value = False
                    .Visible = False
                End With
                With QuanNo3
                    .Value = False
                    .Visible = False
                End With
'''Hide and clear QuanQuestion5
                MethodComboBox.Visible = False
                If MethodComboBox.Value <> 0 Then
                    MethodComboBox.Value = 0
                End If
                Range("QuanQuestion5").Rows.Hidden = True
''Cursor placement
                Range("CarryAmount").Select
            End If

            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
'For all...when changing cash flow table inputs
        If Not Application.Intersect(Range("CashFlowInputs"), Range(Target.Address)) _
         Is Nothing Then
            If chkCashFlow.Value = False Then Exit Sub
            
            Application.ScreenUpdating = False
            Application.EnableEvents = False
''Hide and clear fair value section
            Range("FairValueInputs").ClearContents
            Range("QuanAssessResult").Value = ""
            Range("FairValueSection").Rows.Hidden = True
            Range("QuanAssessResult").Rows.Hidden = True
            chkCashFlow.Value = False
            
            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
'For all...when changing the FairValue1 input
        If Not Application.Intersect(Range("FairValue1"), Range(Target.Address)) _
         Is Nothing Then
            
            Application.ScreenUpdating = False
            Application.EnableEvents = False
''For goodwill
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 1 Then
                Range("FairValue5").Select
'''If ASU 2017-04
                If ThisWorkbook.Worksheets("Qualitative Assessment").GWYes1.Value = True Then
''''Clear all implied fair value inputs, hide the goodwill section, and
'''' unhide the quantitative assessment result
                    Range("GoodwillInputs").ClearContents
                    Range("GoodwillSection").Rows.Hidden = True
                    Range("QuanAssessResult").Rows.Hidden = False
''''If carrying amount, including goodwill, is greater than its fair value
                    If Range("CarryAmount").Value > Range("FairValue1").Value Then
'''''Unhide the row to input the carrying amount of the entity's/reporting unit's
''''' goodwill and instruct user to make final input
                        Range("GoodwillSection").Resize(1, 1).Rows.Hidden = False
                        Range("FairValue5").Rows.Hidden = False
                        Range("FairValue5").Select
                        Range("QuanAssessResult").Value = "Enter the final input to proceed."
                        Sheet3.Visible = xlSheetHidden
'                       Range("FairValue6").Value = ""
'                       Range("FairValue7").Value = ""
''''If carrying amount, including goodwill, is less than or equal to its fair value
                    Else
'''''Instruct user to proceed to the Final Assessment worksheet
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
                    End If
                    GoTo ConcludeChgFV1
                Else
'''If no ASU 2017-04
                    Range("GoodwillSection").Rows.Hidden = False
                    Range("QuanAssessResult").Rows.Hidden = False
                    Range("QuanAssessResult").Value = "Input all three reporting " & _
                    "unit amounts to proceed."
''''If carrying amount is equal to or less than zero
                    If QuanYes3.Value = True Then
                        GoTo ConcludeChgFV1
                    End If
''''If carrying amount is greater than zero and the fair value
                    If Range("FairValue1").Value < Range("CarryAmount").Value Then
                        Sheet3.Visible = xlSheetHidden
''''If carrying amount is greater than zero but less than the fair value
                    Else
                        Range("GoodwillSection").Rows.Hidden = True
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
                    End If
                End If
            End If
''For intangible assets (does not matter whether subject to amortization)
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 2 Or ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 3 Then
                Range("QuanAssessResult").Rows.Hidden = False
                Range("QuanAssessResult").Value = "No further inputs are " & _
                "necessary. Please proceed to the Final Assessment worksheet."
                Range("QuanAssessResult").Select
                Sheet3.Visible = xlSheetVisible
            End If
''For PPE
            If ThisWorkbook.Worksheets("Qualitative Assessment").AssetTypeComboBox.Value = 4 Then
'''If PPE is held for sale
                If QuanNo2.Value = True Then
''''If Market or Other valuation method
                    If MethodComboBox.Value = 1 Or MethodComboBox.Value = 3 Then
'''''If the cell for expected selling costs has been input
                        If Range("FairValue3").Value <> "" Then
                            Range("QuanAssessResult").Rows.Hidden = False
                            Range("QuanAssessResult").Value = "No further inputs are " & _
                            "necessary. Please proceed to the Final Assessment worksheet."
                            Range("QuanAssessResult").Select
                            Sheet3.Visible = xlSheetVisible
                        Else
                            Sheet3.Visible = xlSheetHidden
                        End If
                    End If
                End If
'''If PPE is held and used [only if undiscounted cash flows are less than asset's carrying
'''amount (failed Part 1 test)]
                If QuanYes2.Value = True Then
                    Range("QuanAssessResult").Rows.Hidden = False
                    Range("QuanAssessResult").Value = "No further inputs are " & _
                    "necessary. Please proceed to the Final Assessment worksheet."
                    Range("QuanAssessResult").Select
                    Sheet3.Visible = xlSheetVisible
                End If
            End If
ConcludeChgFV1:

''If FairValue1 was only cleared
            If Range("FairValue1").Value = "" Then
                Range("FairValueInputs").ClearContents
                Range("GoodwillSection").Rows.Hidden = True
                Range("QuanAssessResult").Value = ""
                Range("QuanAssessResult").Rows.Hidden = True
                Sheet3.Visible = xlSheetHidden
                Range("FairValue1").Select
            End If
            
            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
'For only PPE held for sale...when changing the FairValue3 input
        If Not Application.Intersect(Range("FairValue3"), Range(Target.Address)) _
         Is Nothing Then
            
            Application.ScreenUpdating = False
            Application.EnableEvents = False

''If Market or Other valuation method
            If MethodComboBox.Value = 1 Or MethodComboBox.Value = 3 Then
'''If the cell for the asset's fair value has been input
                If Range("FairValue1").Value <> "" Then
                    Range("QuanAssessResult").Rows.Hidden = False
                    Range("QuanAssessResult").Value = "No further inputs are " & _
                    "necessary. Please proceed to the Final Assessment worksheet."
                    Range("QuanAssessResult").Select
                    Sheet3.Visible = xlSheetVisible
                Else
                    Range("QuanAssessResult").Value = ""
                    Range("QuanAssessResult").Rows.Hidden = True
                    Range("FairValue1").Select
                    Sheet3.Visible = xlSheetHidden
                End If
''If NPV of future cash flows valuation method
            ElseIf MethodComboBox.Value = 2 Then
                Range("QuanAssessResult").Rows.Hidden = False
                Range("QuanAssessResult").Value = "No further inputs are " & _
                "necessary. Please proceed to the Final Assessment worksheet."
                Range("QuanAssessResult").Select
                Sheet3.Visible = xlSheetVisible
            End If
''If FairValue3 was only cleared
            If Range("FairValue3").Value = "" Then
                Range("QuanAssessResult").Value = ""
                Range("QuanAssessResult").Rows.Hidden = True
                Sheet3.Visible = xlSheetHidden
                Range("FairValue3").Select
            End If

            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
'For goodwill only...when changing a cell in the GoodwillInputs range
        If Not Application.Intersect(Range("GoodwillInputs"), Range(Target.Address)) _
         Is Nothing Then
''If the cell changed is "FairValue5"
            If Not Application.Intersect(Range("FairValue5"), Range(Target.Address)) _
            Is Nothing Then
            
                Application.ScreenUpdating = False
                Application.EnableEvents = False
'''If ASU 2017-04
                If ThisWorkbook.Worksheets("Qualitative Assessment").GWYes1.Value = True Then
''''Only "FairVlaue5" input is necessary
                    If Range("FairValue5").Value <> "" Then
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = "No further inputs are " & _
                        "necessary. Please proceed to the Final Assessment worksheet."
                        Range("QuanAssessResult").Select
                        Sheet3.Visible = xlSheetVisible
'''If no ASU 2017-04
                   Else
                        Range("QuanAssessResult").Rows.Hidden = False
                        Range("QuanAssessResult").Value = ""
                        Range("FairValue5").Select
                        Sheet3.Visible = xlSheetHidden
                    End If
                    GoTo ConcludeChgFV5
                End If
            End If
                Application.ScreenUpdating = False
                Application.EnableEvents = False

''If at least one of the goodwill inputs is blank
            If Range("FairValue5").Value = "" Or Range("FairValue6").Value = "" Or _
             Range("FairValue7").Value = "" Then
'''Place cursor in the first blank cell
                For Each Cell In Range("GoodwillInputs")
                    If Cell.Value = "" Then
                        Cell.Select
                        Exit For
                    End If
                Next Cell
                Range("QuanAssessResult").Rows.Hidden = False
                Range("QuanAssessResult").Value = "Input all three reporting " & _
                "unit amounts to proceed."
                Sheet3.Visible = xlSheetHidden
''If all of the goodwill inputs are entered
            Else
                Range("QuanAssessResult").Rows.Hidden = False
                Range("QuanAssessResult").Value = "No further inputs are " & _
                "necessary. Please proceed to the Final Assessment worksheet."
                Range("QuanAssessResult").Select
                Sheet3.Visible = xlSheetVisible
            End If
            
ConcludeChgFV5:

            Application.ScreenUpdating = True
            Application.EnableEvents = True
        End If
    
    
    End If

End Sub

Private Sub Worksheet_Activate()

    If Range("QuanResponse1").Value = "" Then
        Range("QuanResponse1").RowHeight = 12.75
    Else
        Range("QuanResponse1").RowHeight = 25.5
    End If
    If Range("QuanResponse4").Value = "" Then
        Range("QuanResponse4").RowHeight = 12.75
        If Range("QuanQuestion3").Rows.Hidden = True Then
            Range("QuanResponse4").Rows.Hidden = True
        End If
    Else
        Range("QuanResponse4").RowHeight = 25.5
    End If

    If Sheet1.GWYes1 = True And chkCashFlow.Value = True Then
'    If Sheet1.GWYes2 = True Or Sheet1.GWYes4 = True Then
'        If chkCashFlow.Value = True Then
        Range("CashFlowResponse").ClearContents
        Range("CashFlowResponse").Rows.Hidden = True
'        End If
    ElseIf Sheet1.GWNo1 = True And chkCashFlow.Value = True Then
'    ElseIf Sheet1.GWNo2 = True Or Sheet1.GWNo4 = True Then
'        If chkCashFlow.Value = True Then
        If QuanYes3.Value = False Then
            If Range("CarryAmount").Value <= Range("FairValue1").Value Or _
             Range("CarryAmount").Value <= Range("FairValue2").Value Then
                Range("CashFlowResponse").ClearContents
                Range("CashFlowResponse").Rows.Hidden = True
            ElseIf Range("CarryAmount").Value > Range("FairValue1").Value Or _
             Range("CarryAmount").Value > Range("FairValue2").Value Then
                Range("CashFlowResponse").Value = "Complete the following " & _
                "reporting unit information."
                Range("CashFlowResponse").Rows.Hidden = False
            End If
'            End If
        End If
    End If
    Range("Input").Select

End Sub



Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
    
Dim CurrentRowHeight As Variant
Dim ImpliedGoodwill As Variant
Dim AltImpairLoss As Variant

    ImpliedGoodwill = 0
    AltImpairLoss = 0

    Application.ScreenUpdating = False
    Application.EnableEvents = False

'Clear all final assessments and hide all but FinalAssess1
    Range("FinalAssess1").Value = ""
    Range("FinalAssess2").Value = ""
    Range("FinalAssess2").Rows.Hidden = True
    With Range("FinalAssessTable")
        .ClearContents
        .Rows.Hidden = True
    End With

'If Qualitative Assessment and/or Quantitative Assessment worksheet(s)
'are not completed then tell user to complete them.
    If Sheet1.QualNo2.Value <> True And Sheet2.QuanNo1 <> True And _
     Sheet2.QuanNo3 <> True And Sheet2.Range("QuanAssessResult").Value <> _
     "No further inputs are necessary. Please proceed to the Final " & _
     "Assessment worksheet." Then
            Range("FinalAssess1").Value = "Please complete the other " & _
             "worksheet(s) to obtain the final assessment."
'If there is no impairment inform the user
    ElseIf Sheet2.QuanNo1 = True Then
''For goodwill (ASU 2017-04 adoption is irrelevant)
        If Sheet1.AssetTypeComboBox.Value = 1 Then
            Range("FinalAssess1").Value = "Because it is more likely than " & _
             "not that the fair value of the reporting unit is less than " & _
             "its carrying amount, including goodwill, the goodwill is " & _
             "not considered impaired."
''For other types of assets
        ElseIf Sheet1.AssetTypeComboBox.Value = 2 Then
            Range("FinalAssess1").Value = "The amortizable intangible " & _
             "asset is not considered impaired."
        ElseIf Sheet1.AssetTypeComboBox.Value = 3 Then
            Range("FinalAssess1").Value = "The nonamortizable intangible " & _
             "asset is not considered impaired."
        ElseIf Sheet1.AssetTypeComboBox.Value = 4 Then
            Range("FinalAssess1").Value = "The asset is not considered impaired."
        End If
        GoTo Conclude
    End If
'If there is potential impairment
'For Goodwill
    If Sheet1.AssetTypeComboBox.Value = 1 Then
''If ASU 2017-04
        If Sheet1.GWYes1.Value = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "The entity has adopted the goodwill impairment accounting requirements " & _
             "of ASU 2017-04. Accordingly, goodwill impairment is assessed at the " & _
             "reporting unit level and an impairment loss is recognized for the amount " & _
             "that a reporting unit's carrying amount, including goodwill, exceeds its " & _
             "fair value. However, the impairment loss cannot exceed the total amount " & _
             "of goodwill allocated to the reporting unit. " & vbCrLf & vbCrLf & _
             "Before conducting a quantitative assessment of goodwill impairment, " & _
             "an optional qualitative assessment may be performed to determine whether " & _
             "it is more likely than not that the fair value of the reporting unit is " & _
             "less than its carrying amount, including goodwill. " & vbCrLf & vbCrLf

''If no ASU 2017-04
        Else
            Range("FinalAssess1").Value = "The entity has yet to adopt the goodwill " & _
             "impairment accounting requirements of ASU 2017-04. Accordingly, goodwill " & _
             "impairment is assessed at the reporting unit level and exists when the " & _
             "carrying amount of goodwill exceeds its implied fair value. Before " & _
             "conducting a quantitative assessment of goodwill impairment, an optional " & _
             "qualitative assessment may be performed to determine whether it is more " & _
             "likely than not that the fair value of the reporting unit is less than " & _
             "its carrying amount, including goodwill." & vbCrLf & vbCrLf
        End If

''For all goodwill...if qualitative assessment not performed
        If Sheet1.QualNo2 = False And Sheet1.QualYes2 = False Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "In this instance, the qualitative assessment was bypassed, so it " & _
             "was necessary to perform the quantitative goodwill impairment " & _
             "assessment. " '& vbCrLf & vbCrLf
''''If ASU 2017-04 is adopted
'            If Sheet1.GWYes1 = True And Sheet1.GWYes2 = True And Sheet1.GWYes3 = True Then
'                Range("FinalAssess1").Value = Range("FinalAssess1").Value & vbCrLf
'            End If
''For all goodwill...if qualitative assessment determines no impairment
        ElseIf Sheet1.QualNo2 = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "Based on this qualitative assessment, it was determined that it is " & _
             "more likely than not that the fair value of the reporting unit is " & _
             "greater than its carrying amount, including goodwill. Thus, " & _
             "further consideration of goodwill impairment is not necessary."
             GoTo Conclude
''For all goodwill...if qualitative assessment determines possible impairment
        ElseIf Sheet1.QualYes2 = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "Based on this qualitative assessment, it was determined that it is " & _
             "more likely than not that the fair value of the reporting unit is " & _
             "less than its carrying amount, including goodwill. Thus, " & _
             "it was necessary to perform the quantitative goodwill impairment " & _
             "assessment. " '& vbCrLf & vbCrLf
        End If
''If no ASU 2017-04, if the carrying amount is zero or less but not MLTN that goodwill
''is impaired
        If Sheet1.GWYes1.Value = False And Sheet2.Range("CarryAmount").Value <= 0 And _
         Sheet2.QuanNo3.Value = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "The first step of the quantitative goodwill impairment assessment " & _
             "is to determine the reporting unit's fair value and compare it " & _
             "to the reporting unit's carrying amount. However, if the reporting " & _
             "unit's carrying amount is equal to or less than zero, an assessment " & _
             "must be made to determine whether it is more likely than not that a " & _
             "goodwill impiarment exists. If it is more likely than not that " & _
             "goodwill does exist, it is necessary to perform the second step of " & _
             "the quantitative goodwill impairment assessment. Otherwise, " & _
             "recording goodwill impairment is not necessary." & vbCrLf
             Range("FinalAssess2").Value = "Because the reporting unit's carrying " & _
             "amount is zero or less, it was necessary to assess if it was more " & _
             "likely than not that goodwill was impaired. Based on that assessment, it is " & _
             "more likely than not that goodwill was not impaired, so goodwill " & _
             "impairment is not necessary."
            GoTo Conclude:
        End If
''If quantitative assessment
        If Sheet2.Range("FairValue1").Value <> "" Or _
         Sheet2.Range("FairValue2").Value <> "" Then
'''If ASU 2017-04
            If Sheet1.GWYes1.Value = True Then
                Range("FinalAssess2").Value = "Impairment of goodwill exists when " & _
                 "the carrying amount of a reporting unit that includes goodwill is " & _
                 "greater than the fair value of the reporting unit." & vbCrLf & vbCrLf
'''If no ASU 2017-04
            Else
                Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                 "The first step of the quantitative goodwill impairment assessment " & _
                 "is to determine the reporting unit's fair value and compare it " & _
                 "to the reporting unit's carrying amount. If the reporting unit's " & _
                 "carrying amount is greater than zero but less than its fair value, " & _
                 "then goodwill impairment does not exist. Otherwise, it is necessary " & _
                 "to perform the second step of the quantitative goodwill impairment " & _
                 "assessment." '& vbCrLf & vbCrLf
            End If
'''If valuation method is "Quoted Market Price" or "Other"
            If Sheet2.MethodComboBox.Value = 1 Or _
             Sheet2.MethodComboBox.Value = 3 Then
''''If ASU 2017-04
                If Sheet1.GWYes1.Value = True Then
                    AltImpairLoss = Sheet2.Range("CarryAmount").Value - _
                     Sheet2.Range("FairValue1").Value
'''''If reporting unit's carrying amount > fair value
                    If AltImpairLoss > 0 Then
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on this assessment, the reporting unit's " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill) exceeds its fair value of " & _
                         Format(Sheet2.Range("FairValue1").Value, "$#,##0") & ". Thus, " & _
                         "the goodwill is considered impaired"
                        Range("FinalAssessTable").Rows.Hidden = False
                        Range("FinalAssess3").Value = "Carrying amount of reporting unit"
                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                        Range("FinalAssess4").Value = "Less: fair value of reporting unit"
                        Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue1").Value
                        Range("FinalAssess5").Value = "Impairment loss"
''''''If reporting unit's impairment loss <= reporting unit's carrying amount of goodwill
                        If AltImpairLoss <= Sheet2.Range("FairValue5").Value Then
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ". The write-down needed is determined as follows: "
'                            Range("FinalAssess5").Offset(0, 1).Value = 0 - AltImpairLoss
                            Range("FinalAssess5").Offset(0, 1).Value = AltImpairLoss
''''''If reporting unit's impairment loss > reporting unit's carrying amount of goodwill
                        Else
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ", but the impairment loss cannot be greater than " & _
                             "the reporting unit's " & _
                             Format(Sheet2.Range("FairValue5").Value, "$#,##0") & _
                             " carrying amount of goodwill. The write-down needed " & _
                             "is determined as follows:" & vbCrLf
                            Range("FinalAssess5").Value = "Difference|fffd|-excess carrying amount"
                            Range("FinalAssess5").Offset(0, 1).Value = _
                             Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue1").Value
                            Range("FinalAssess5").Offset(3, 0).Value = "Impairment loss " & _
                             "is the lesser of|fffd|-"
                            Range("FinalAssess5").Offset(4, 0).Value = "Excess carrying amount"
                            Range("FinalAssess5").Offset(4, 2).Value = _
                             Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue1").Value
                            Range("FinalAssess5").Offset(5, 0).Value = "Reporting unit's " & _
                             "carrying amount of goodwill"
                            Range("FinalAssess5").Offset(5, 2).Value = _
                             Sheet2.Range("FairValue5").Value
                            Range("FinalAssess5").Offset(7, 0).Value = "Impairment loss"
                            Range("FinalAssess5").Offset(7, 2).Value = _
                             Sheet2.Range("FairValue5").Value
                        End If
                        GoTo Conclude:
'''''If reporting unit's carrying amount <= fair value
                    Else
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on this assessment, the reporting unit's " & _
                         Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                         " fair value exceeds its carrying amount (including goodwill) of " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & ". Thus, " & _
                         "the goodwill is not considered impaired." & vbCrLf
                        GoTo Conclude:
                    End If
                    GoTo Conclude:
                End If

''''If no ASU 2017-04
                If Sheet1.GWYes1.Value = False Then
'''''If the carrying amount is zero or less and MLTN that goodwill is impaired
                    If Sheet2.Range("CarryAmount").Value <= 0 And Sheet2.QuanYes3.Value = True Then
                        Range("FinalAssess2").Value = _
                         "Because the reporting unit's carrying amount is zero or " & _
                         "less and it is more likely than not that goodwill is impaired, " & _
                         "only the second step of the quantitative impairment assessment " & _
                         "is necessary. "
                         GoTo ContinueZero1
                    End If
'''''If carrying amount is greater than zero but less than or equal to the fair value
                    If Sheet2.Range("FairValue1").Value >= _
                     Sheet2.Range("CarryAmount").Value And _
                     Sheet2.Range("CarryAmount").Value > 0 Then
                        Range("FinalAssess2").Rows.Hidden = False
                        Range("FinalAssess2").Value = _
                         "Based on the first step of the quantitative impairment " & _
                         "assessment, the reporting unit's fair value of " & _
                         Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                         " equals or exceeds its " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill), thus the goodwill " & _
                         "is not considered impaired." & vbCrLf
'                         "is not considered impaired as indicated below." & vbCrLf
'                        Range("FinalAssessTable").Rows.Hidden = False
'                        Range("FinalAssess3").Value = "Carrying amount of the reporting unit"
'                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'                        Range("FinalAssess4").Value = "Fair value of the reporting unit"
'                        Range("FinalAssess4").Offset(0, 1).Value = _
'                         Sheet2.Range("FairValue1").Value
'                        Range("FinalAssess5").Value = "Impairment loss"
'                        Range("FinalAssess5").Offset(0, 1).Value = 0
'''''If carrying amount is greater than zero and the fair value
                    ElseIf Sheet2.Range("FairValue1").Value < _
                     Sheet2.Range("CarryAmount").Value And _
                     Sheet2.Range("CarryAmount").Value > 0 Then
                        Range("FinalAssess2").Rows.Hidden = False
                        Range("FinalAssess2").Value = _
                         "Based on the first step of the quantitative impairment " & _
                         "assessment, the reporting unit's " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill) exceeds its fair " & _
                         "value of " & Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                         ". Thus, it was necessary to complete part two of the quantitative " & _
                         "impairment assessment." & vbCrLf & vbCrLf
ContinueZero1:
                    ImpliedGoodwill = Sheet2.Range("FairValue1").Value - _
                     Sheet2.Range("FairValue5").Value + Sheet2.Range("FairValue6").Value
'                    Range("FinalAssess2").Rows.Hidden = False
                    Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                     "The second step of the " & _
                     "quantitative impairment assessment compares the implied fair " & _
                     "value of the reporting unit's goodwill to its carrying amount " & _
                     "of that goodwill. To determine the implied fair value of " & _
                     "goodwill, fair values must be assigned to all of the reporting " & _
                     "unit's assets and liabilities (including unrecognized " & _
                     "intangible assets). The excess of the reporting unit's fair value " & _
                     "over the amounts assigned to its assets less liabilities is the " & _
                     "implied fair value of goodwill." & vbCrLf & vbCrLf
'                    Range("FinalAssessTable").Rows.Hidden = False
'                    Range("FinalAssess3").Value = "Carrying amount of goodwill"
'                    Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("FairValue7").Value
'                    Range("FinalAssess4").Value = "Implied fair value of goodwill"
'                    Range("FinalAssess4").Offset(0, 1).Value = ImpliedGoodwill
'                    Range("FinalAssess5").Value = "Impairment loss"
''''''If the implied fair value of goodwill is greater than or equal to goodwill carrying amount
                    If ImpliedGoodwill >= _
                     Sheet2.Range("FairValue7").Value Then
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on the second step of the quantitative impairment " & _
                         "assessment, the reporting unit's " & _
                         Format(ImpliedGoodwill, "$#,##0") & " implied fair value " & _
                         "of goodwill equals or exceeds its " & _
                         Format(Sheet2.Range("FairValue7").Value, "$#,##0") & " " & _
                         "carrying amount of " & _
                         "goodwill. Thus, the asset is not considered impaired."
'                         "of goodwill equals or exceeds its carrying amount of " & _
'                         "goodwill. Thus, the asset is not considered impaired as " & _
'                         "indicated below." & vbCrLf
'                            Range("FinalAssess5").Offset(0, 1).Value = 0
''''''If the implied fair value of goodwill is less than the goodwill carrying amount
                    Else
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on the second step of the quantitative impairment " & _
                         "assessment, the reporting unit's " & _
                         Format(Sheet2.Range("FairValue7").Value, "$#,##0") & " carrying " & _
                         "amount of goodwill equals or exceeds its " & _
                         Format(ImpliedGoodwill, "$#,##0") & " implied fair " & _
                         "value of goodwill. Thus, the goodwill is considered impaired"
'                         "amount of goodwill equals or exceeds its implied fair " & _
'                         "value of goodwill. Thus, the goodwill is considered impaired"
                         Range("FinalAssessTable").Rows.Hidden = False
                         Range("FinalAssess3").Value = "Carrying amount of goodwill"
                         Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("FairValue7").Value
'''''''If the impairment loss is less equal to or less than the goodwill carrying amount
                        If ImpliedGoodwill >= 0 Then
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ". The writedown needed is determined as follows:" & vbCrLf
                             Range("FinalAssess4").Value = "Less: implied fair value of goodwill"
                             Range("FinalAssess4").Offset(0, 1).Value = -ImpliedGoodwill
                             Range("FinalAssess5").Value = "Impairment loss"
                             Range("FinalAssess5").Offset(0, 1).Value = _
                              Sheet2.Range("FairValue7").Value - ImpliedGoodwill
'                                 Range("FinalAssess5").Offset(0, 1).Value = _
'                                 ImpliedGoodwill - Sheet2.Range("FairValue7").Value
'''''''If the impairment loss is greater than the goodwill carrying amount
                        Else
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ", but the impairment loss cannot be greater than " & _
                             "the reporting unit's carrying amount of goodwill. " & _
                             "The writedown needed is determined as follows:" & vbCrLf
                            Range("FinalAssess4").Value = "Implied fair value of goodwill"
                            Range("FinalAssess4").Offset(0, 1).Value = ImpliedGoodwill
                            Range("FinalAssess5").Value = "Difference|fffd|-excess carrying amount"
                            Range("FinalAssess5").Offset(0, 1).Value = _
                             Sheet2.Range("FairValue7").Value - ImpliedGoodwill
                            Range("FinalAssess5").Offset(3, 0).Value = "Impairment loss " & _
                             "is the lesser of|fffd|-"
                            Range("FinalAssess5").Offset(4, 0).Value = "Excess carrying amount"
                            Range("FinalAssess5").Offset(4, 2).Value = _
                             Sheet2.Range("FairValue7").Value - ImpliedGoodwill
                            Range("FinalAssess5").Offset(5, 0).Value = "Reporting unit's " & _
                             "carrying amount of goodwill"
                            Range("FinalAssess5").Offset(5, 2).Value = _
                             Sheet2.Range("FairValue7").Value
                            Range("FinalAssess5").Offset(7, 0).Value = "Impairment loss"
                            Range("FinalAssess5").Offset(7, 2).Value = _
                             Sheet2.Range("FairValue7").Value
'                            Range("FinalAssess5").Offset(0, 1).Value = 0 - _
'                             Sheet2.Range("FairValue7").Value
                        End If
                    End If
                End If
            End If
'''If valuation method is "Net Present Value of Future Cash Flows"
            ElseIf Sheet2.MethodComboBox.Value = 2 Then
''''If ASU 2017-04
                If Sheet1.GWYes1.Value = True Then
                    AltImpairLoss = Sheet2.Range("CarryAmount").Value - _
                     Sheet2.Range("FairValue2").Value
'''''If reporting unit's carrying amount > fair value
                    If AltImpairLoss > 0 Then
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on this assessment, the reporting unit's " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill) exceeds its fair value of " & _
                         Format(Sheet2.Range("FairValue2").Value, "$#,##0") & ". Thus, " & _
                         "the goodwill is considered impaired"
                        Range("FinalAssessTable").Rows.Hidden = False
                        Range("FinalAssess3").Value = "Carrying amount of reporting unit"
                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                        Range("FinalAssess4").Value = "Less: Fair value of reporting unit"
                        Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue2").Value
                        Range("FinalAssess5").Value = "Impairment loss"
''''''If reporting unit's impairment loss <= reporting unit's carrying amount of goodwill
                        If AltImpairLoss <= Sheet2.Range("FairValue5").Value Then
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ". The write-down needed is determined as follows: " & vbCrLf
                            Range("FinalAssess5").Offset(0, 1).Value = AltImpairLoss
''''''If reporting unit's impairment loss > reporting unit's carrying amount of goodwill
                        Else
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             ", but the impairment loss cannot be greater than " & _
                             "the reporting unit's " & _
                             Format(Sheet2.Range("FairValue5").Value, "$#,##0") & _
                             " carrying amount of goodwill. The write-down needed " & _
                             "is determined as follows:" & vbCrLf
                            Range("FinalAssess5").Value = "Difference|fffd|-excess carrying amount"
                            Range("FinalAssess5").Offset(0, 1).Value = _
                             Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
                            Range("FinalAssess5").Offset(3, 0).Value = "Impairment loss " & _
                             "is the lesser of|fffd|-"
                            Range("FinalAssess5").Offset(4, 0).Value = "Excess carrying amount"
                            Range("FinalAssess5").Offset(4, 2).Value = _
                             Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
                            Range("FinalAssess5").Offset(5, 0).Value = "Reporting unit's " & _
                             "carrying amount of goodwill"
                            Range("FinalAssess5").Offset(5, 2).Value = _
                             Sheet2.Range("FairValue5").Value
                            Range("FinalAssess5").Offset(7, 0).Value = "Impairment loss"
                            Range("FinalAssess5").Offset(7, 2).Value = _
                             Sheet2.Range("FairValue5").Value
                        End If
                        GoTo Conclude:
'''''If reporting unit's carrying amount <= fair value
                    Else
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "Based on this assessment, the reporting unit's " & _
                         Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                         " fair value exceeds its carrying amount (including goodwill) of " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & ". Thus, " & _
                         "the goodwill is not considered impaired." & vbCrLf
'                         "the goodwill is not considered impaired as indicated below." & vbCrLf
'                        Range("FinalAssessTable").Rows.Hidden = False
'                        Range("FinalAssess3").Value = "Carrying amount of reporting unit"
'                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'                        Range("FinalAssess4").Value = "Fair value of reporting unit"
'                        Range("FinalAssess4").Offset(0, 1).Value = Sheet2.Range("FairValue2").Value
'                        Range("FinalAssess5").Value = "Impairment loss"
'                        Range("FinalAssess5").Offset(0, 1).Value = 0
                        GoTo Conclude:
                    End If
                    GoTo Conclude:
                End If
''''If no ASU 2017-04...
                If Sheet1.GWYes1.Value = False Then
'''''If the carrying amount is zero or less
                    If Sheet2.Range("CarryAmount").Value <= 0 And Sheet2.QuanYes3.Value = True Then
                        Range("FinalAssess2").Value = _
                         "Because the reporting unit's carrying amount is zero or " & _
                         "less and it is more likely than not that goodwill is impaired, " & _
                         "only the second step of the quantitative impairment assessment " & _
                         "is necessary. "
                         GoTo ContinueZero2
                    End If
'''''If carrying amount is greater than zero but less than or equal to the fair value
                    If Sheet2.Range("FairValue2").Value >= _
                     Sheet2.Range("CarryAmount").Value And _
                     Sheet2.Range("CarryAmount").Value > 0 Then
                        Range("FinalAssess2").Rows.Hidden = False
                        Range("FinalAssess2").Value = _
                         "Based on the first step of the quantitative impairment " & _
                         "assessment, the reporting unit's fair value of " & _
                         Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                         " equals or exceeds its " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill), thus the goodwill " & _
                         "is not considered impaired." & vbCrLf
'                         "is not considered impaired as indicated below." & vbCrLf
'                        Range("FinalAssessTable").Rows.Hidden = False
'                        Range("FinalAssess3").Value = "Carrying amount of the reporting unit"
'                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'                        Range("FinalAssess4").Value = "Fair value of the reporting unit"
'                        Range("FinalAssess4").Offset(0, 1).Value = _
'                         Sheet2.Range("FairValue2").Value
'                        Range("FinalAssess5").Value = "Impairment loss"
'                        Range("FinalAssess5").Offset(0, 1).Value = 0
'''''If carrying amount is greater than zero and the fair value
                    ElseIf Sheet2.Range("FairValue2").Value < _
                     Sheet2.Range("CarryAmount").Value And _
                     Sheet2.Range("CarryAmount").Value > 0 Then
                        Range("FinalAssess2").Rows.Hidden = False
                        Range("FinalAssess2").Value = _
                         "Based on the first step of the quantitative impairment " & _
                         "assessment, the reporting unit's " & _
                         Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                         " carrying amount (including goodwill) exceeds its fair " & _
                         "value of " & Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                         ". Thus, it was necessary to complete part two of the quantitative " & _
                         "impairment assessment." & vbCrLf & vbCrLf
ContinueZero2:
                        ImpliedGoodwill = Sheet2.Range("FairValue2").Value - _
                         Sheet2.Range("FairValue5").Value + Sheet2.Range("FairValue6").Value
                        Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                         "The second step of the " & _
                         "quantitative impairment assessment compares the implied fair " & _
                         "value of the reporting unit's goodwill to its carrying amount " & _
                         "of that goodwill. To determine the implied fair value of " & _
                         "goodwill, fair values must be assigned to all of the reporting " & _
                         "unit's assets and liabilities (including unrecognized " & _
                         "intangible assets). The excess of the reporting unit's fair value " & _
                         "over the amounts assigned to its assets less liabilities is the " & _
                         "implied fair value of goodwill." & vbCrLf & vbCrLf
'                        Range("FinalAssessTable").Rows.Hidden = False
'                        Range("FinalAssess3").Value = "Carrying amount of goodwill"
'                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("FairValue7").Value
'                        Range("FinalAssess4").Value = "Implied fair value of goodwill"
''                        Range("FinalAssess4").Offset(0, 1).Value = ImpliedGoodwill
'                        Range("FinalAssess4").Offset(0, 1).Value = -ImpliedGoodwill
'                        Range("FinalAssess5").Value = "Impairment loss"
''''''If the implied fair value of goodwill is greater than or equal to goodwill carrying amount
                        If ImpliedGoodwill >= _
                         Sheet2.Range("FairValue7").Value Then
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             "Based on the second step of the quantitative impairment " & _
                             "assessment, the reporting unit's " & _
                             Format(ImpliedGoodwill, "$#,##0") & " implied fair value " & _
                             "of goodwill equals or exceeds its " & _
                             Format(Sheet2.Range("FairValue7").Value, "$#,##0") & " " & _
                             "carrying amount of " & _
                             "goodwill. Thus, the asset is not considered impaired."
'                             "goodwill. Thus, the asset is not considered impaired as " & _
'                             "indicated below." & vbCrLf
'                            Range("FinalAssess5").Offset(0, 1).Value = 0
''''''If the implied fair value of goodwill is less than the goodwill carrying amount
                        Else
                            Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                             "Based on the second step of the quantitative impairment " & _
                             "assessment, the reporting unit's " & _
                             Format(Sheet2.Range("FairValue7").Value, "$#,##0") & " carrying " & _
                             "amount of goodwill equals or exceeds its " & _
                             Format(ImpliedGoodwill, "$#,##0") & " implied fair " & _
                             "value of goodwill. Thus, the goodwill is considered impaired"
                            Range("FinalAssessTable").Rows.Hidden = False
                            Range("FinalAssess3").Value = "Carrying amount of goodwill"
                            Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("FairValue7").Value
'                            Range("FinalAssess4").Value = "Less: implied fair value of goodwill"
'                            Range("FinalAssess4").Offset(0, 1).Value = ImpliedGoodwill
'                            Range("FinalAssess4").Offset(0, 1).Value = -ImpliedGoodwill
'''''''If the impairment loss is equal to or less than the goodwill carrying amount
                            If ImpliedGoodwill >= 0 Then
                                Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                                 ". The writedown needed is determined as follows:" & vbCrLf
                                Range("FinalAssess4").Value = "Less: implied fair value of goodwill"
                                Range("FinalAssess4").Offset(0, 1).Value = -ImpliedGoodwill
                                Range("FinalAssess5").Value = "Impairment loss"
                                Range("FinalAssess5").Offset(0, 1).Value = _
                                 Sheet2.Range("FairValue7").Value - ImpliedGoodwill
'''''''If the impairment loss is greater than the goodwill carrying amount
                            Else
                                Range("FinalAssess2").Value = Range("FinalAssess2").Value & _
                                 ", but the impairment loss cannot be greater than " & _
                                 "the reporting unit's carrying amount of goodwill. " & _
                                 "The writedown needed is determined as follows:" & vbCrLf
                                Range("FinalAssess4").Value = "Implied fair value of goodwill"
                                Range("FinalAssess4").Offset(0, 1).Value = ImpliedGoodwill
                                Range("FinalAssess5").Value = "Difference|fffd|-excess carrying amount"
'                                Range("FinalAssess5").Offset(0, 1).Value = _
'                                 Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
                                Range("FinalAssess5").Offset(0, 1).Value = _
                                 Sheet2.Range("FairValue7").Value - ImpliedGoodwill
                                Range("FinalAssess5").Offset(3, 0).Value = "Impairment loss " & _
                                 "is the lesser of|fffd|-"
                                Range("FinalAssess5").Offset(4, 0).Value = "Excess carrying amount"
                                Range("FinalAssess5").Offset(4, 2).Value = _
                                 Sheet2.Range("FairValue7").Value - ImpliedGoodwill
                                Range("FinalAssess5").Offset(5, 0).Value = "Reporting unit's " & _
                                 "carrying amount of goodwill"
                                Range("FinalAssess5").Offset(5, 2).Value = _
                                 Sheet2.Range("FairValue7").Value
                                Range("FinalAssess5").Offset(7, 0).Value = "Impairment loss"
                                Range("FinalAssess5").Offset(7, 2).Value = _
                                 Sheet2.Range("FairValue7").Value
'                                Range("FinalAssess5").Offset(0, 1).Value = 0 - _
'                                 Sheet2.Range("FairValue7").Value
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End If
    
'For Amortizable intangible Assets
    If Sheet1.AssetTypeComboBox.Value = 2 Then
        Range("FinalAssess1").Value = "An intangible asset subject to amortization " & _
         "is considered impaired if its carrying amount is not recoverable and " & _
         "its carrying amount exceeds its fair value. To evaluate an amortizable " & _
         "intangible asset for impairment, the undiscounted future " & _
         "cash flows from the intangible asset's continued use and eventual " & _
         "disposition are compared to its carrying amount. If the intangible " & _
         "asset's undiscounted future cash flows are less than its carrying value, " & _
         "the potential for impairment exists, so the intangible asset's fair " & _
         "value should be determined and compared to its carrying amount." & vbCrLf & _
         vbCrLf
''If undiscounted future cash flows are greater than or equal to the carrying amount
        If Sheet2.Range("CashFlowUndiscountTotal").Value >= _
         Sheet2.Range("CarryAmount").Value Then
             Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
              "Because future undiscounted cash flows from the amortizable " & _
              "intangible asset's continued use and eventual disposition of " & _
              Format(Sheet2.Range("CashFlowUndiscountTotal").Value, "$#,##0") & _
              " equal or exceed its " & _
              Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
              " carrying amount, an impairment loss is not necessary."
''If undiscounted future cash flows are less than the carrying amount
        Else
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "The amortizable intangible asset's carrying amount of " & _
             Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & " exceeds the " & _
             Format(Sheet2.Range("CashFlowUndiscountTotal").Value, "$#,##0") & _
             " of future undiscounted cash flows from its continued use and " & _
             "eventual disposition, indicating that an impairment loss may be " & _
             "necessary. "
'            Range("FinalAssessTable").Rows.Hidden = False
'            Range("FinalAssess3").Value = "Carrying amount of the intangible asset"
'            Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'            Range("FinalAssess4").Value = "Fair value of the intangible asset"
'            Range("FinalAssess5").Value = "Impairment loss"
'''If valuation method is "Quoted Market Price" or "Other"
            If Sheet2.MethodComboBox.Value = 1 Or _
             Sheet2.MethodComboBox.Value = 3 Then
''''If the fair value is greater than or equal to the carrying amount
                If Sheet2.Range("FairValue1").Value >= _
                 Sheet2.Range("CarryAmount").Value Then
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "However, the intangible asset's fair value of " & _
                     Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                     " equals or exceeds its carrying amount. Thus, the " & _
                     "intangible asset is not considered impaired."
'                     "intangible asset is not considered impaired as indicated below."
'                    Range("FinalAssess5").Offset(0, 1).Value = 0
''''If the fair value is less than the carrying amount
                Else
'                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
'                     "Because the intangible asset's carrying amount exceeds its " & _
'                     "fair value of " & '_
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "Because the intangible asset's carrying amount also exceeds its " & _
                     Format(Sheet2.Range("FairValue1").Value, "$#,##0") & " fair value, " & _
                     "the intangible asset is considered impaired. The writedown " & _
                     "needed is determined as follows:"
                    Range("FinalAssessTable").Rows.Hidden = False
                    Range("FinalAssess3").Value = "Carrying amount of the intangible asset"
                    Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                    Range("FinalAssess4").Value = "Less: fair value of the intangible asset"
                    Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue1").Value
'                    Range("FinalAssess4").Offset(0, 1).Value = _
                     Sheet2.Range("FairValue1").Value
                    Range("FinalAssess5").Value = "Impairment loss"
                    Range("FinalAssess5").Offset(0, 1).Value = _
                     Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue1").Value
'                     Sheet2.Range("FairValue1").Value -Sheet2.Range("CarryAmount").Value
                End If
'''If valuation method is "Net Present Value of Future Cash Flows"
            ElseIf Sheet2.MethodComboBox.Value = 2 Then
'                Range("FinalAssess4").Offset(0, 1).Value = _
'                 Sheet2.Range("FairValue2").Value
''''If the fair value is greater than or equal to the carrying amount
                If Sheet2.Range("FairValue2").Value >= _
                 Sheet2.Range("CarryAmount").Value Then
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "However, the intangible asset's fair value of " & _
                     Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                     " equals or exceeds its carrying amount. Thus the, " & _
                     "intangible asset is not considered impaired."
'                     "intangible asset is not considered impaired as indicated below."
'                    Range("FinalAssess5").Offset(0, 1).Value = 0
''''If the fair value is less than the carrying amount
                Else
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "Because the intangible asset's carrying amount also exceeds its " & _
                     Format(Sheet2.Range("FairValue2").Value, "$#,##0") & " fair value, " & _
                     "the intangible asset is considered impaired. The writedown " & _
                     "needed is determined as follows:"
                    Range("FinalAssessTable").Rows.Hidden = False
                    Range("FinalAssess3").Value = "Carrying amount of the intangible asset"
                    Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                    Range("FinalAssess4").Value = "Less: fair value of the intangible asset"
                    Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue2").Value
'                    Range("FinalAssess5").Offset(0, 1).Value = _
'                     Sheet2.Range("FairValue2").Value - Sheet2.Range("CarryAmount").Value
                    Range("FinalAssess5").Value = "Impairment loss"
                    Range("FinalAssess5").Offset(0, 1).Value = _
                     Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
                End If
            End If
        End If
    End If
'For Nonamortizable intangible Assets
    If Sheet1.AssetTypeComboBox.Value = 3 Then
        Range("FinalAssess1").Value = "A nonamortizable intangible asset is one " & _
         "that has an indefinite useful life. Impairment for a nonamortizable " & _
         "intangible asset exists when the carrying amount of the intangible " & _
         "asset exceeds its fair value. An impairment loss is recognized in an " & _
         "amount equal to that excess. Before conducting a quantitative assessment " & _
         "of impairment for a nonamortizable intangible asset, an optional " & _
         "qualitative assessment may be performed to determine whether it is " & _
         "more likely than not that the nonamortizable intangible asset is " & _
         "impaired." & vbCrLf & vbCrLf
''If qualitative assessment not performed
        If Sheet1.QualNo2 = False And Sheet1.QualYes2 = False Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "In this instance, the qualitative assessment was bypassed, so it " & _
             "was necessary to perform the quantitative impairment assessment." & _
             vbCrLf & vbCrLf
''If qualitative assessment determines no impairment
        ElseIf Sheet1.QualNo2 = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "Based on this qualitative assessment, it was determined that it is " & _
             "more likely than not that the fair value of the nonamortizable " & _
             "intangible asset is greater than its carrying amount. Thus, " & _
             "impairment is not necessary."
             GoTo Conclude
''If qualitative assessment determines possible impairment
        ElseIf Sheet1.QualYes2 = True Then
            Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
             "Based on this qualitative assessment, it was determined that it is " & _
             "more likely than not that the fair value of the nonamortizable " & _
             "intangible asset is less than its carrying amount. Thus, it was " & _
             "necessary to perform the quantitative goodwill impairment " & _
             "assessment." & vbCrLf & vbCrLf
        End If
''If quantitative assessment
        If Sheet2.Range("FairValue1").Value <> "" Or _
         Sheet2.Range("FairValue2").Value <> "" Then
'            Range("FinalAssessTable").Rows.Hidden = False
'            Range("FinalAssess3").Value = "Carrying amount of the intangible asset"
'            Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'            Range("FinalAssess4").Value = "Fair value of the intangible asset"
'            Range("FinalAssess5").Value = "Impairment loss"
'''If valuation method is "Quoted Market Price" or "Other"
            If Sheet2.MethodComboBox.Value = 1 Or _
             Sheet2.MethodComboBox.Value = 3 Then
                Range("FinalAssess4").Offset(0, 1).Value = _
                 Sheet2.Range("FairValue1").Value
''''If the fair value is greater than or equal to the carrying amount
                If Sheet2.Range("FairValue1").Value >= _
                 Sheet2.Range("CarryAmount").Value Then
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "The quantitative impairment assessment indicates that the " & _
                     "nonamortizable intangible asset's fair value of " & _
                     Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                     " equals or exceeds its " & _
                     Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                     " carrying amount. Thus, the intangible asset is not " & _
                     "considered impaired."
'                     "considered impaired as indicated below." & vbCrLf
'                    Range("FinalAssess5").Offset(0, 1).Value = 0
''''If fair value less is less than carrying amount
                Else
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "The quantitative impairment assessment indicates that the " & _
                     "nonamortizable intangible asset's carrying amount of " & _
                     Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                     " exceeds its " & _
                     Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                     " fair value. Thus, the intangible asset is considered " & _
                     "impaired. The writedown needed is determined as follows:" & vbCrLf
                    Range("FinalAssessTable").Rows.Hidden = False
                    Range("FinalAssess3").Value = "Carrying amount of intangible asset"
                    Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                    Range("FinalAssess4").Value = "Less: fair value of intangible asset"
                    Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue1").Value
                    Range("FinalAssess5").Value = "Impairment loss"
                    Range("FinalAssess5").Offset(0, 1).Value = _
                     Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue1").Value
'                     Sheet2.Range("FairValue1").Value -Sheet2.Range("CarryAmount").Value
                End If
'''If valuation method is "Net Present Value of Future Cash Flows"
            ElseIf Sheet2.MethodComboBox.Value = 2 Then
                Range("FinalAssess4").Offset(0, 1).Value = _
                 Sheet2.Range("FairValue2").Value
''''If the fair value is greater than or equal to the carrying amount
                If Sheet2.Range("FairValue2").Value >= _
                 Sheet2.Range("CarryAmount").Value Then
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "The quantitative impairment assessment indicates that the " & _
                     "nonamortizable intangible asset's fair value of " & _
                     Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                     " equals or exceeds its " & _
                     Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                     " carrying amount. Thus, the intangible asset is not " & _
                     "considered impaired."
'                     "considered impaired as indicated below." & vbCrLf
'                    Range("FinalAssess5").Offset(0, 1).Value = 0
''''If fair value less is less than carrying amount
                Else
                    Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                     "The quantitative impairment assessment indicates that the " & _
                     "nonamortizable intangible asset's carrying amount of " & _
                     Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                     " exceeds its " & _
                     Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                     " fair value. Thus, the intangible asset is considered " & _
                     "impaired. The writedown needed is determined as follows:" & vbCrLf
                    Range("FinalAssessTable").Rows.Hidden = False
                    Range("FinalAssess3").Value = "Carrying amount of intangible asset"
                    Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                    Range("FinalAssess4").Value = "Less: fair value of intangible asset"
                    Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue2").Value
                    Range("FinalAssess5").Value = "Impairment loss"
                    Range("FinalAssess5").Offset(0, 1).Value = _
                     Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
'                     Sheet2.Range("FairValue2").Value -Sheet2.Range("CarryAmount").Value
                End If
            End If
        End If
    End If
'For PPE
    If Sheet1.AssetTypeComboBox.Value = 4 Then
''If asset is held for sale
        If Sheet2.QuanNo2 = True Then
            Range("FinalAssess1").Value = "A long-lived asset held for sale " & _
             "should not be amortized or depreciated but should be measured " & _
             "at the lower of its fair value less costs to sell or its " & _
             "carrying amount. "
'            Range("FinalAssessTable").Rows.Hidden = False
'            Range("FinalAssess3").Value = "Carrying amount of the asset"
'            Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'            Range("FinalAssess4").Value = "Fair value of the asset less cost to sell"
'            Range("FinalAssess4").Offset(0, 1).Value = Sheet2.Range("FairValue4").Value
'            Range("FinalAssess5").Value = "Impairment loss"
'            If Sheet2.Range("FairValue4").Value < Sheet2.Range("CarryAmount").Value Then
'                Range("FinalAssess5").Offset(0, 1).Value = _
'                 Sheet2.Range("FairValue4").Value - Sheet2.Range("CarryAmount").Value
'            Else
'                Range("FinalAssess5").Offset(0, 1).Value = 0
'            End If
'''If fair value less costs to sell is greater than or equal to the carrying value
            If Sheet2.Range("FairValue4").Value >= Sheet2.Range("CarryAmount").Value Then
                Range("FinalAssess1").Value = Range("FinalAssess1").Value & "Because " & _
                 "the asset's fair value less cost to sell of " & _
                 Format(Sheet2.Range("FairValue4").Value, "$#,##0") & " is greater " & _
                 "than its " & Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                 " carrying amount, the asset is not considered."
'                 "the asset's fair value less cost to sell is greater than its " & _
'                 "carrying amount, the asset is not considered impaired as " & _
'                 "indicated below."
'''If fair value less costs to sell is less than the carrying value
            Else
                Range("FinalAssess1").Value = Range("FinalAssess1").Value & "Because " & _
                 "the asset's fair value less cost to sell of " & _
                 Format(Sheet2.Range("FairValue4").Value, "$#,##0") & " is less than " & _
                 "its " & Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                 " carrying amount, the asset is considered impaired. The writedown " & _
                 "needed is determined as follows:" & vbCrLf
'                 "the asset's fair value less cost to sell is less than its carrying " & _
'                 "amount, the asset is considered impaired. The writedown needed is " & _
'                 "determined as follows:" & vbCrLf
                Range("FinalAssessTable").Rows.Hidden = False
                Range("FinalAssess3").Value = "Carrying amount of the asset"
                Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                Range("FinalAssess4").Value = "Less: asset's fair value less cost to sell"
                Range("FinalAssess4").Offset(0, 1).Value = -Sheet2.Range("FairValue4").Value
                Range("FinalAssess5").Value = "Impairment loss"
                Range("FinalAssess5").Offset(0, 1).Value = _
                 Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue4").Value
            End If
''If asset is held and used
        ElseIf Sheet2.QuanYes2 = True Then
            Range("FinalAssess1").Value = "A long-lived asset held and used should " & _
             "be measured at the lower of its fair value or its carrying amount. " & _
             "To evaluate the asset for impairment, the undiscounted future " & _
             "cash flows from the asset's continued use and eventual disposition " & _
             "are compared to the asset's carrying amount. If the undiscounted " & _
             "future cash flows are less than the asset's carrying value, the " & _
             "potential for impairment exists, so the asset's fair value is " & _
             "determined and compared to the carrying amount." & vbCrLf & vbCrLf
'''If undiscounted future cash flows are greater than or equal to the carrying amount
            If Sheet2.Range("CashFlowUndiscountTotal").Value >= _
             Sheet2.Range("CarryAmount").Value Then
                 Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                  "Because future undiscounted cash flows from the asset's " & _
                  "continued use and eventual disposition of " & _
                  Format(Sheet2.Range("CashFlowUndiscountTotal").Value, "$#,##0") & _
                  " equal or exceed the asset's " & _
                  Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & _
                  " carrying amount, an impairment loss is not necessary."
'''If undiscounted future cash flows are less than the carrying amount
            Else
                Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                 "The asset's carrying amount of " & _
                 Format(Sheet2.Range("CarryAmount").Value, "$#,##0") & " exceeds " & _
                 "future undiscounted cash flows from the asset's continued use " & _
                 "and eventual disposition of " & _
                 Format(Sheet2.Range("CashFlowUndiscountTotal").Value, "$#,##0") & _
                 ", indicating that an impairment loss may be necessary. "
'                Range("FinalAssessTable").Rows.Hidden = False
'                Range("FinalAssess3").Value = "Carrying amount of the asset"
'                Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
'                Range("FinalAssess4").Value = "Fair value of the asset"
'                Range("FinalAssess5").Value = "Impairment loss"
''''If valuation method is "Quoted Market Price" or "Other"
                If Sheet2.MethodComboBox.Value = 1 Or _
                 Sheet2.MethodComboBox.Value = 3 Then
'                    Range("FinalAssess4").Offset(0, 1).Value = _
'                     Sheet2.Range("FairValue1").Value
'''''If the fair value is greater than or equal to the carrying amount
                    If Sheet2.Range("FairValue1").Value >= _
                     Sheet2.Range("CarryAmount").Value Then
                        Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                         "However, the asset's fair value of " & _
                         Format(Sheet2.Range("FairValue1").Value, "$#,##0") & _
                         " equals or exceeds it's carrying amount. Thus, " & _
                         "the asset is not considered impaired." & vbCrLf
'                         "the asset is not considered impaired as indicated below." & vbCrLf
'                        Range("FinalAssess5").Offset(0, 1).Value = 0
'''''If the fair value is less than the carrying amount
                    Else
                        Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                         "Because the asset's carrying amount also exceeds its " & _
                         Format(Sheet2.Range("FairValue1").Value, "$#,##0") & " fair value, " & _
                         "the asset is considered impaired. The writedown needed is " & _
                         "determined as follows:" & vbCrLf
                        Range("FinalAssessTable").Rows.Hidden = False
                        Range("FinalAssess3").Value = "Carrying amount of the asset"
                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                        Range("FinalAssess4").Value = "Less: fair value of the asset"
                        Range("FinalAssess4").Offset(0, 1).Value = _
                         -Sheet2.Range("FairValue1").Value
                        Range("FinalAssess5").Value = "Impairment loss"
                        Range("FinalAssess5").Offset(0, 1).Value = _
                         Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue1").Value
'                         Sheet2.Range("FairValue1").Value -Sheet2.Range("CarryAmount").Value
                    End If
''''If valuation method is "Net Present Value of Future Cash Flows"
                ElseIf Sheet2.MethodComboBox.Value = 2 Then
'                    Range("FinalAssess4").Offset(0, 1).Value = _
'                     Sheet2.Range("FairValue2").Value
'''''If the fair value is greater than or equal to the carrying amount
                    If Sheet2.Range("FairValue2").Value >= _
                     Sheet2.Range("CarryAmount").Value Then
                        Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                         "However, the asset's fair value of " & _
                         Format(Sheet2.Range("FairValue2").Value, "$#,##0") & _
                         " equals or exceeds it's carrying amount. Thus, " & _
                         "the asset is not considered impaired." & vbCrLf
'                         "the asset is not considered impaired as indicated below." & vbCrLf
'                        Range("FinalAssess5").Offset(0, 1).Value = 0
'''''If the fair value is less than the carrying amount
                    Else
                        Range("FinalAssess1").Value = Range("FinalAssess1").Value & _
                         "Because the asset's carrying amount also exceeds its " & _
                         Format(Sheet2.Range("FairValue2").Value, "$#,##0") & " fair value, " & _
                         "the asset is considered impaired. The writedown needed is " & _
                         "determined as follows:" & vbCrLf
                        Range("FinalAssessTable").Rows.Hidden = False
                        Range("FinalAssess3").Value = "Carrying amount of the asset"
                        Range("FinalAssess3").Offset(0, 1).Value = Sheet2.Range("CarryAmount").Value
                        Range("FinalAssess4").Value = "Less: fair value of the asset"
                        Range("FinalAssess4").Offset(0, 1).Value = _
                         -Sheet2.Range("FairValue2").Value
                        Range("FinalAssess5").Value = "Impairment loss"
                        Range("FinalAssess5").Offset(0, 1).Value = _
                         Sheet2.Range("CarryAmount").Value - Sheet2.Range("FairValue2").Value
'                         Sheet2.Range("FairValue2").Value -Sheet2.Range("CarryAmount").Value
                    End If
                End If
            End If
        End If
    End If

Conclude:

    Range("FinalAssess1").Select
    Call AutoFitMergedCellRowHeight
    If Range("FinalAssess2").Value <> "" Then
        Range("FinalAssess2").Select
        Call AutoFitMergedCellRowHeight
    End If
    Range("Assessment").Select

    Application.EnableEvents = True
    Application.ScreenUpdating = True

End Sub

Sub AutoFitMergedCellRowHeight()
    
    Dim CurrentRowHeight As Single, MergedCellRgWidth As Single
    Dim CurrCell As Range
    Dim ActiveCellWidth As Single, PossNewRowHeight As Single
    
    If ActiveCell.MergeCells Then
      With ActiveCell.MergeArea
            If .Rows.Count = 1 And .WrapText = True Then
'                Application.ScreenUpdating = False
                CurrentRowHeight = 12.75
                ActiveCellWidth = ActiveCell.ColumnWidth
                For Each CurrCell In Selection
                    MergedCellRgWidth = CurrCell.ColumnWidth + MergedCellRgWidth
                Next
                .MergeCells = False
                .Cells(1).ColumnWidth = MergedCellRgWidth
                .Cells(1).EntireRow.AutoFit
'                .EntireRow.AutoFit
                PossNewRowHeight = .RowHeight
                .Cells(1).ColumnWidth = ActiveCellWidth
                .MergeCells = True
                .RowHeight = IIf(CurrentRowHeight > PossNewRowHeight, _
                  CurrentRowHeight, PossNewRowHeight)
            End If
        End With
    End If
'    Application.ScreenUpdating = True

End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'
' This code is protected and passworded when complete.
'

Private Const XL4MACRO As String = "PPCSecurityMacro"
Private Const INFORMATION As String = "INFORMATION"

Private Const bIsIDxR As Boolean = False        ' Set True if Interactive Disclosure Library
#Const IDxR = 0                                 ' Set 1 if Interactive Disclosure Library

      ' Declare security class

Private Sub Workbook_Activate()

  
  InitForEditorial
  
  On Error GoTo 0
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
  Workbook_BeforeClose_Editorial
End Sub



Public Function bIsSaving() As Boolean
  bIsSaving = False
End Function


' InQuest injected base64 decoded content
' Z0Rwb

INQUEST-PP=macro
