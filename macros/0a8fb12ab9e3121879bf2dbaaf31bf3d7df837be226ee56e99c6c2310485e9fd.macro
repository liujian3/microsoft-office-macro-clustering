Attribute VB_Name = "ClsTds"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'"|4aa||fffd||63c||fffd||fffd||170||fffd|"|fffd||fffd||165|
Public WithEvents CmdFm As CommandBarButton         '|fffd||fffd||fffd||fffd|
Attribute CmdFm.VB_VarHelpID = -1
Public WithEvents CmdFmC As CommandBarButton
Attribute CmdFmC.VB_VarHelpID = -1
Public WithEvents CmdMc As CommandBarButton         '|13f||fffd||fffd|
Attribute CmdMc.VB_VarHelpID = -1
Public WithEvents CmdMcC As CommandBarButton
Attribute CmdMcC.VB_VarHelpID = -1
Public WithEvents CmdQy As CommandBarButton         '|1f0||fffd||fffd|
Attribute CmdQy.VB_VarHelpID = -1
Public WithEvents CmdQyC As CommandBarButton
Attribute CmdQyC.VB_VarHelpID = -1
Public WithEvents CmdYy As CommandBarButton         '|fffd||fffd||fffd||fffd|
Attribute CmdYy.VB_VarHelpID = -1
Public WithEvents CmdYyC As CommandBarButton
Attribute CmdYyC.VB_VarHelpID = -1
Public WithEvents CmdFl As CommandBarButton         '|fffd||fffd||bc|
Attribute CmdFl.VB_VarHelpID = -1
Public WithEvents CmdFlC As CommandBarButton
Attribute CmdFlC.VB_VarHelpID = -1
Public WithEvents CmdCk As CommandBarButton         '|fffd||3bf||fffd||fffd||fffd||fffd||fffd|
Attribute CmdCk.VB_VarHelpID = -1
Public WithEvents CmdCkC As CommandBarButton
Attribute CmdCkC.VB_VarHelpID = -1
Public WithEvents CmdSy As CommandBarButton         '|fffd||fffd||fffd||fffd|
Attribute CmdSy.VB_VarHelpID = -1
Public WithEvents CmdSyC As CommandBarButton
Attribute CmdSyC.VB_VarHelpID = -1
Public WithEvents CmdBJSYX As CommandBarButton      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdBJSYX.VB_VarHelpID = -1
Public WithEvents CmdBJSYXC As CommandBarButton
Attribute CmdBJSYXC.VB_VarHelpID = -1
Public WithEvents CmdSCSY As CommandBarButton       '|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdSCSY.VB_VarHelpID = -1
Public WithEvents CmdSCSYC As CommandBarButton
Attribute CmdSCSYC.VB_VarHelpID = -1
Public WithEvents CmdTwoPage As CommandBarButton    '|2eb||fffd||fffd||fffd||170||fffd|
Attribute CmdTwoPage.VB_VarHelpID = -1
Public WithEvents CmdTwoPageC As CommandBarButton
Attribute CmdTwoPageC.VB_VarHelpID = -1
Public WithEvents CmdPrtPreview As CommandBarButton '|fffd||fffd||4e1||524||fffd||fffd|
Attribute CmdPrtPreview.VB_VarHelpID = -1
Public WithEvents CmdPrtPreviewC As CommandBarButton
Attribute CmdPrtPreviewC.VB_VarHelpID = -1
Public WithEvents CmdGZ As CommandBarButton         '|fffd||fffd||434||fffd||fffd||fffd||fffd|
Attribute CmdGZ.VB_VarHelpID = -1
Public WithEvents CmdGZC As CommandBarButton
Attribute CmdGZC.VB_VarHelpID = -1
'zle,09-06-26,+|fffd||fffd||fffd||fffd|"|fffd||fffd||4e1|"|fffd||fffd||165|
Public WithEvents CmdPRINT As CommandBarButton         '|fffd||fffd||4e1|
Attribute CmdPRINT.VB_VarHelpID = -1
Public WithEvents CmdPRINTC As CommandBarButton
Attribute CmdPRINTC.VB_VarHelpID = -1
'zle,09-07-02,+|fffd||fffd||fffd||fffd|"|fffd||fffd||fffd||fffd|"|fffd||fffd||221||fffd||fffd||fffd||fffd||fffd||fffd||165|
Public WithEvents CmdPROTECT As CommandBarButton         '|fffd||fffd||fffd||fffd|
Attribute CmdPROTECT.VB_VarHelpID = -1
Public WithEvents CmdPROTECTC As CommandBarButton
Attribute CmdPROTECTC.VB_VarHelpID = -1
Public WithEvents CmdUNPROTECT As CommandBarButton
Attribute CmdUNPROTECT.VB_VarHelpID = -1


'"|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|"|fffd||fffd||165|
Public WithEvents CmdZtitle As CommandBarButton     '|fffd||b1||fffd||fffd||fffd|
Attribute CmdZtitle.VB_VarHelpID = -1
Public WithEvents CmdZtitleC As CommandBarButton
Attribute CmdZtitleC.VB_VarHelpID = -1

Public WithEvents CmdTTitle1 As CommandBarButton     '|fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdTTitle1.VB_VarHelpID = -1
Public WithEvents CmdTTitle2 As CommandBarButton
Attribute CmdTTitle2.VB_VarHelpID = -1
Public WithEvents CmdTTitle3 As CommandBarButton
Attribute CmdTTitle3.VB_VarHelpID = -1
Public WithEvents CmdTTitle4 As CommandBarButton
Attribute CmdTTitle4.VB_VarHelpID = -1
Public WithEvents CmdTTitle5 As CommandBarButton
Attribute CmdTTitle5.VB_VarHelpID = -1

Public WithEvents CmdTTitle1C As CommandBarButton    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Attribute CmdTTitle1C.VB_VarHelpID = -1
Public WithEvents CmdTTitle2C As CommandBarButton
Attribute CmdTTitle2C.VB_VarHelpID = -1
Public WithEvents CmdTTitle3C As CommandBarButton
Attribute CmdTTitle3C.VB_VarHelpID = -1
Public WithEvents CmdTTitle4C As CommandBarButton
Attribute CmdTTitle4C.VB_VarHelpID = -1
Public WithEvents CmdTTitle5C As CommandBarButton
Attribute CmdTTitle5C.VB_VarHelpID = -1

Public WithEvents CmdTTitle1F As CommandBarButton    '|fffd||1f1||fffd||fffd||fffd||fffd||fffd|
Attribute CmdTTitle1F.VB_VarHelpID = -1
Public WithEvents CmdTTitle2F As CommandBarButton
Attribute CmdTTitle2F.VB_VarHelpID = -1
Public WithEvents CmdTTitle3F As CommandBarButton
Attribute CmdTTitle3F.VB_VarHelpID = -1
Public WithEvents CmdTTitle4F As CommandBarButton
Attribute CmdTTitle4F.VB_VarHelpID = -1
Public WithEvents CmdTTitle5F As CommandBarButton
Attribute CmdTTitle5F.VB_VarHelpID = -1

Public WithEvents CmdTTitle1FC As CommandBarButton    '|fffd||1f1||fffd||fffd||fffd||fffd||fffd|
Attribute CmdTTitle1FC.VB_VarHelpID = -1
Public WithEvents CmdTTitle2FC As CommandBarButton
Attribute CmdTTitle2FC.VB_VarHelpID = -1
Public WithEvents CmdTTitle3FC As CommandBarButton
Attribute CmdTTitle3FC.VB_VarHelpID = -1
Public WithEvents CmdTTitle4FC As CommandBarButton
Attribute CmdTTitle4FC.VB_VarHelpID = -1
Public WithEvents CmdTTitle5FC As CommandBarButton
Attribute CmdTTitle5FC.VB_VarHelpID = -1

Public WithEvents CmdD As CommandBarButton             '|fffd||fffd|
Attribute CmdD.VB_VarHelpID = -1
Public WithEvents CmdDC As CommandBarButton
Attribute CmdDC.VB_VarHelpID = -1

Public WithEvents CmdLx1 As CommandBarButton           '|fffd||fffd||fffd||fffd|
Attribute CmdLx1.VB_VarHelpID = -1
Public WithEvents CmdLx2 As CommandBarButton
Attribute CmdLx2.VB_VarHelpID = -1
Public WithEvents CmdLx3 As CommandBarButton
Attribute CmdLx3.VB_VarHelpID = -1
Public WithEvents CmdLx4 As CommandBarButton
Attribute CmdLx4.VB_VarHelpID = -1
Public WithEvents CmdLx41 As CommandBarButton          '|fffd||fffd||fffd||fffd||138||fffd||fffd||fffd|
Attribute CmdLx41.VB_VarHelpID = -1
Public WithEvents CmdLx41C As CommandBarButton         '|fffd||fffd||fffd||fffd||138||fffd||fffd||17f||fffd||770||fffd||165|
Attribute CmdLx41C.VB_VarHelpID = -1
Public WithEvents CmdLx5 As CommandBarButton
Attribute CmdLx5.VB_VarHelpID = -1
Public WithEvents CmdLx51 As CommandBarButton          '|fffd||fffd||fffd||fffd||fffd||5b1||fffd||fffd|
Attribute CmdLx51.VB_VarHelpID = -1
Public WithEvents CmdLx51C As CommandBarButton         '|fffd||fffd||fffd||fffd||fffd||5b1||fffd||17f||fffd||770||fffd||165|
Attribute CmdLx51C.VB_VarHelpID = -1
Public WithEvents CmdLx6 As CommandBarButton
Attribute CmdLx6.VB_VarHelpID = -1

Public WithEvents CmdLx1C As CommandBarButton          '|fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Attribute CmdLx1C.VB_VarHelpID = -1
Public WithEvents CmdLx2C As CommandBarButton
Attribute CmdLx2C.VB_VarHelpID = -1
Public WithEvents CmdLx3C As CommandBarButton
Attribute CmdLx3C.VB_VarHelpID = -1
Public WithEvents CmdLx4C As CommandBarButton
Attribute CmdLx4C.VB_VarHelpID = -1
Public WithEvents CmdLx5C As CommandBarButton
Attribute CmdLx5C.VB_VarHelpID = -1
Public WithEvents CmdLx6C As CommandBarButton
Attribute CmdLx6C.VB_VarHelpID = -1

'"|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|"|fffd||fffd||165|
Public WithEvents CmdSl As CommandBarButton            '|2be||fffd||fffd|
Attribute CmdSl.VB_VarHelpID = -1
Public WithEvents CmdSlC As CommandBarButton
Attribute CmdSlC.VB_VarHelpID = -1

Public WithEvents CmdDSl As CommandBarButton           '|fffd||fffd||2be||fffd||fffd|
Attribute CmdDSl.VB_VarHelpID = -1
Public WithEvents CmdDSlC As CommandBarButton
Attribute CmdDSlC.VB_VarHelpID = -1

Public WithEvents CmdSSl As CommandBarButton           '|fffd||fffd||2be||fffd||fffd|
Attribute CmdSSl.VB_VarHelpID = -1
Public WithEvents CmdSSlC As CommandBarButton
Attribute CmdSSlC.VB_VarHelpID = -1
Public WithEvents CmdSLCONT As CommandBarButton        '|2be||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdSLCONT.VB_VarHelpID = -1

Public WithEvents CmdZWZ As CommandBarButton           '|fffd||fffd||fffd||fffd||5e2|
Attribute CmdZWZ.VB_VarHelpID = -1
Public WithEvents CmdZWZC As CommandBarButton
Attribute CmdZWZC.VB_VarHelpID = -1
Public WithEvents CmdZWZZ As CommandBarButton          '|fffd||fffd||fffd||fffd||5e2||fffd||fffd|
Attribute CmdZWZZ.VB_VarHelpID = -1
Public WithEvents CmdZWZZC As CommandBarButton
Attribute CmdZWZZC.VB_VarHelpID = -1
Public WithEvents CmdZWZZF As CommandBarButton         '|fffd||fffd||fffd||fffd||fffd||fffd||5e2|
Attribute CmdZWZZF.VB_VarHelpID = -1
Public WithEvents CmdZWZZFC As CommandBarButton
Attribute CmdZWZZFC.VB_VarHelpID = -1

Public WithEvents CmdZ As CommandBarButton             '|37c||fffd||fffd||5e2|
Attribute CmdZ.VB_VarHelpID = -1
Public WithEvents CmdZC As CommandBarButton
Attribute CmdZC.VB_VarHelpID = -1
Public WithEvents CmdZZ As CommandBarButton            '|37c||fffd||fffd||5e2||fffd||fffd|
Attribute CmdZZ.VB_VarHelpID = -1
Public WithEvents CmdZZC As CommandBarButton
Attribute CmdZZC.VB_VarHelpID = -1
Public WithEvents CmdZZF As CommandBarButton           '|37c||fffd||fffd||fffd||fffd||5e2|
Attribute CmdZZF.VB_VarHelpID = -1
Public WithEvents CmdZZFC As CommandBarButton
Attribute CmdZZFC.VB_VarHelpID = -1

Public WithEvents CmdJZ As CommandBarButton            '|fffd||fffd||fffd||13d||fffd||5e2|
Attribute CmdJZ.VB_VarHelpID = -1
Public WithEvents CmdJZC As CommandBarButton
Attribute CmdJZC.VB_VarHelpID = -1

Public WithEvents CmdGTitle As CommandBarButton        '|37c||fffd||fffd||fffd||fffd|
Attribute CmdGTitle.VB_VarHelpID = -1
Public WithEvents CmdGTitleC As CommandBarButton
Attribute CmdGTitleC.VB_VarHelpID = -1

Public WithEvents CmdTabTitle As CommandBarButton      '|fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdTabTitle.VB_VarHelpID = -1
Public WithEvents CmdTabTitleC As CommandBarButton
Attribute CmdTabTitleC.VB_VarHelpID = -1

Public WithEvents CmdSjTable As CommandBarButton       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Attribute CmdSjTable.VB_VarHelpID = -1
Public WithEvents CmdSjTableC As CommandBarButton
Attribute CmdSjTableC.VB_VarHelpID = -1

Public WithEvents CmdTBJZSM As CommandBarButton        '|37c||fffd||fffd||fffd||13d||fffd||5e2||2f5||fffd||fffd|
Attribute CmdTBJZSM.VB_VarHelpID = -1
Public WithEvents CmdTBJZSMC As CommandBarButton
Attribute CmdTBJZSMC.VB_VarHelpID = -1
Public WithEvents CmdSTBJZSM As CommandBarButton       '|37c||fffd||fffd||fffd||5fd||fffd||5e2||2f5||fffd||fffd|
Attribute CmdSTBJZSM.VB_VarHelpID = -1
Public WithEvents CmdSTBJZSMC As CommandBarButton
Attribute CmdSTBJZSMC.VB_VarHelpID = -1

Public WithEvents CmdGS As CommandBarButton            '|fffd||fffd||fffd||be6b||2bd|
Attribute CmdGS.VB_VarHelpID = -1
Public WithEvents CmdGSC As CommandBarButton
Attribute CmdGSC.VB_VarHelpID = -1
Public WithEvents CmdGsGs As CommandBarButton          '|fffd||fffd||2bd||fffd||fffd||fffd|
Attribute CmdGsGs.VB_VarHelpID = -1
Public WithEvents CmdGsGsC As CommandBarButton
Attribute CmdGsGsC.VB_VarHelpID = -1
Public WithEvents CmdGXGs As CommandBarButton          '|fffd||fffd||fffd||b9||fffd||2bd|
Attribute CmdGXGs.VB_VarHelpID = -1
Public WithEvents CmdGXGsC As CommandBarButton
Attribute CmdGXGsC.VB_VarHelpID = -1

'zle,09-06-17,*begin
'Public WithEvents CmdFlZTitle As CommandBarButton         '|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|
'
'Public WithEvents CmdFlPTitle As CommandBarButton         '|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlBTitle As CommandBarButton         '|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle1 As CommandBarButton        '|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle2 As CommandBarButton        '|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle3 As CommandBarButton        '|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle4 As CommandBarButton        '|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle5 As CommandBarButton        '|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd|
'
''|fffd||fffd||bc||fffd||1f1||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle1F As CommandBarButton        '|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle2F As CommandBarButton        '|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle3F As CommandBarButton        '|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle4F As CommandBarButton        '|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdFlTTitle5F As CommandBarButton        '|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd|
'
'
'Public WithEvents CmdFlBs As CommandBarButton             '|fffd||fffd||bc||fffd||fffd||2b6|
'Public WithEvents CmdShowHelp As Office.CommandBarButton '|fffd||fffd||2be||fffd||fffd||fffd||fffd|
'
''|fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||2bd||fffd||379||fffd||2bd||fffd||fffd||2bd||fffd||fffd||165|
'Public WithEvents CmdFlGS As CommandBarButton
'Public WithEvents CmdFlGsGs As CommandBarButton
'
'
''|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public WithEvents CmdCRSY As CommandBarButton
'Public WithEvents CmdCRSYC As CommandBarButton
'zle,09-06-17,*end
Public WithEvents TdsApp As Application
Attribute TdsApp.VB_VarHelpID = -1
'|fffd||3bf||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdCk_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdCkC_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdCkC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertReferences
End Sub
'|fffd||fffd|
Private Sub CmdD_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdDC_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdDC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertParagraph
End Sub

'zle,2008-7-18,|fffd||fffd||fffd||4f6||fffd||fffd||2be||fffd||fffd|
Private Sub CmdDSl_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertMulExample
End Sub
'|fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdDSlC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdDSl_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-10-4,+|fffd||fffd||fffd||4f1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdBJSYX_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdBJSYXC_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdBJSYXC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    ShowfrmMarkIndex
End Sub
'zle,09-06-07,*begin
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Private Sub CmdCRSY_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    Call CmdCRSYC_Click(Ctrl, CancelDefault)
'End Sub
'
'Private Sub CmdCRSYC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    If ActiveDocument.Bookmarks.Exists("BKSY") Then
'    Else
'        MsgBox "|fffd||fffd||fffd||232||fffd||fffd||b870||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||68e1|"
'        Exit Sub
'    End If
'    ProcessIndexFormat
'End Sub
'zle,09-06-17,*end

'zle,2008-11-2,|fffd||fffd||fffd||b9||fffd||2bd||fffd||fffd||165|
Private Sub CmdGXGs_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdGXGsC_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdGXGsC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    UpdateEquationNumTCS
End Sub
'zle,09-06-26,+|fffd||fffd||fffd||fffd|"|fffd||fffd||4e1|"|fffd||fffd||165|
Private Sub CmdPRINT_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdPRINTC_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdPRINTC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    On Error GoTo errorhandle
    
    'zle,090709,+begin |fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||531||fffd||635||fffd||52d||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="PRTBK"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,090709,+end
    
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    ProcessPrint       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||4e1||5f4||32c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||f2d|
    
    'zle,090709,+4,|fffd||635||fffd||52d||3bb|
    If ActiveDocument.Bookmarks.Exists("PRTBK") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="PRTBK"
        ActiveDocument.Bookmarks("PRTBK").Delete
    End If
    
    Application.Dialogs(wdDialogFilePrint).Show
    g_ZMFirst = 1
    
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||4e1||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||4e1||fffd||fffd|", , "TCS"
End Sub
'zle,|fffd||fffd||fffd||5c63||fffd||fffd|
Private Sub CmdPROTECT_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    PrctTCS
    If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
        ClsEvent.CmdPROTECTC.FaceId = 277
        ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
End Sub

Private Sub CmdPROTECTC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If

    If Ctrl.FaceId = 277 Then
        UnPrctTCS
'        Ctrl.State = msoButtonUp
        ClsEvent.CmdPROTECTC.Caption = "|fffd||fffd||fffd||fffd||fffd||135||fffd|"
        Ctrl.FaceId = 225
    Else
'        Ctrl.State = msoButtonDown
        PrctTCS
        ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        Ctrl.FaceId = 277
    End If
End Sub



'zle,|221||fffd||fffd||fffd||fffd||fffd||5c63||fffd||fffd|
Private Sub CmdUNPROTECT_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    UnPrctTCS
    If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
        ClsEvent.CmdPROTECTC.Caption = "|fffd||fffd||fffd||fffd||fffd||135||fffd|"
        Ctrl.FaceId = 225
    End If
End Sub

'zle,|fffd||fffd||4e1||524||fffd||fffd|
Private Sub CmdPrtPreview_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdPrtPreviewC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-10-4,+begin, |fffd||fffd||fffd||4f4||fffd||4e1||524||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdPrtPreviewC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    'zle,090709,+begin |fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||531||fffd||635||fffd||52d||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="PRTVIEWTCS"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,090709,+end
    
    ProcessPrint       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||4e1||5f4||32c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||f2d|
    PrintPreviewTCS
    
    If ActiveDocument.Bookmarks.Exists("PRTVIEWTCS") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="PRTVIEWTCS"
        ActiveDocument.Bookmarks("PRTVIEWTCS").Delete
    End If
    g_ZMFirst = 1
End Sub
'zle,2008-10-4,+end
'|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdSCSY_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSCSYC_Click(Ctrl, CancelDefault)
End Sub
'|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdSCSYC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    ShowfrmDelIndex
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd|
Private Sub CmdSSl_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFirExample
End Sub

Private Sub CmdSSlC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSSl_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdSLCONT_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    InsertExampleContent
End Sub

'zle,2008-8-17,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||139||fffd||2bd|
Private Sub CmdGS_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertEquation
End Sub
'zle,2008-8-17,+end

'zle,2008-12-2,+|fffd||fffd||fffd||4f9||fffd||2bd||fffd||fffd||770||fffd||165|
Private Sub CmdGSC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdGS_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-8-17,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||139||fffd||2bd||fffd||fffd||2bd|
Private Sub CmdGsGs_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertEquationNum
End Sub
'zle,2008-8-17,+end

'zle,2008-12-2,+|fffd||fffd||fffd||4f9||fffd||2bd||fffd||fffd||178||fffd||2bd||fffd||fffd||770||fffd||165|
Private Sub CmdGsGsC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdGsGs_Click(Ctrl, CancelDefault)
End Sub

'zle,09-06-17,*begin
'zle,2008-8-17,+begin,|fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||2bd|
'Private Sub CmdFlGS_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertEquation
'End Sub
''zle,2008-8-17,+end
'
''zle,2008-8-17,+begin,|fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||2bd||fffd||fffd||2bd|
'Private Sub CmdFlGsGs_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlGsGs
'End Sub
''zle,2008-8-17,+end
'zle,09-06-17,*end
'|fffd||fffd||fffd||be3d||bc|
Private Sub CmdFl_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
   Call CmdFlC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-26,+begin,|fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||770||fffd||165|
Private Sub CmdFlC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    FrmFL.Show 1
End Sub
'zle,2008-9-26,+end

'zle,09-06-17,|fffd||fffd||bc||fffd||fffd||2b6|,*begin
'Private Sub CmdFlBs_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlBs
'End Sub
'zle,09-06-17,*end

'zle,09-06-17,|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||28ec|*begin
'Private Sub CmdFlBTitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlBTitle
'End Sub
'zle,09-06-17,*end

'zle,09-06-17,|fffd||fffd||bc||37c||fffd||fffd||fffd||28ec|*begin
'Private Sub CmdFlPTitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlPTitle
'End Sub
'zle,09-06-17,*end

'zle,09-06-17,*begin
''|fffd||fffd||fffd||fffd||fffd||fffd|
'Private Sub CmdFlTTitle1_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlTTitle1
'End Sub
'
'Private Sub CmdFlTTitle2_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlTTitle2
'End Sub
'
'Private Sub CmdFlTTitle3_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlTTitle3
'End Sub
'
'Private Sub CmdFlTTitle4_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlTTitle4
'End Sub
'
'Private Sub CmdFlTTitle5_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlTTitle5
'End Sub
'
''|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Private Sub CmdFlTTitle1F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    InsertFlTTitle1
'    ChgToSong
'    'zle,2008-10-8,+1|fffd||fffd||fffd||7b8||fffd||3aa||fffd||7b1||fffd||fffd||fffd|
'    Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|"
'End Sub
'
'Private Sub CmdFlTTitle2F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    InsertFlTTitle2
'    ChgToSong
'    'zle,2008-10-8,+1|fffd||fffd||fffd||7b8||fffd||3aa||fffd||7b1||fffd||fffd||fffd|
'    Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|"
'End Sub
'
'Private Sub CmdFlTTitle3F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    InsertFlTTitle3
'    ChgToSong
'    'zle,2008-10-8,+1|fffd||fffd||fffd||7b8||fffd||3aa||fffd||7b1||fffd||fffd||fffd|
'    Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|"
'End Sub
'
'Private Sub CmdFlTTitle4F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    InsertFlTTitle4
'    ChgToSong
'    'zle,2008-10-8,+1|fffd||fffd||fffd||7b8||fffd||3aa||fffd||7b1||fffd||fffd||fffd|
'    Selection.Style = "|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd|"
'
'End Sub
'
'Private Sub CmdFlTTitle5F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    InsertFlTTitle5
'    ChgToSong
'    'zle,2008-10-8,+1|fffd||fffd||fffd||7b8||fffd||3aa||fffd||7b1||fffd||fffd||fffd|
'    Selection.Style = "|fffd||fffd||bc||fffd||5f36||fffd||fffd|"
'End Sub

'Private Sub CmdFlZTitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    InsertFlZTitle
'End Sub
'zle,09-06-17,*end

Private Sub CmdFm_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdFmC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-26,+begin,|fffd||fffd||fffd||4f7||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdFmC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    If ActiveDocument.FormFields.Count > 10 Then
        MsgBox "|fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||68ec||fffd||fffd||fffd||fffd||fffd||fffd||fffd||674||3b2||fffd||fffd||b8e1|"
    Else
        FrmChoice.Show
    End If
End Sub
'zle,2008-9-26,+end
'|37c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||121||fffd||fffd||fffd||bc|
Private Sub CmdGTitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdGTitleC_Click(Ctrl, CancelDefault)
End Sub
'|37c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||121||fffd||fffd||fffd||bc||fffd||fffd||770||fffd||165|
Private Sub CmdGTitleC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTitle
End Sub
'|fffd||fffd||fffd||fffd|
Private Sub CmdGZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdGZC_Click(Ctrl, CancelDefault)
End Sub
'zle,2008-9-26,+begin,|fffd||fffd||fffd||4f9||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdGZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    gpath = GetSetting("TCS", "Graphic", "Path", "")
    Shell gpath & "\IEXPLORE.EXE  " & gpath & "\TdsHelp.htm", vbMaximizedFocus
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13d||fffd||5e2|
Private Sub CmdJZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdJZC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-26,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||13d||fffd||5e2||fffd||fffd||770||fffd||165|
Private Sub CmdJZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    On Error GoTo errorhandle
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    'zle,2008-12-25,+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b7||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4fd||fffd||5e2|
    If ActiveDocument.FormFields.Count > 10 Then
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
            MsgBox "|fffd||bf6b||fffd||fffd||fffd||fffd||1b3||fffd||fffd||fffd||fffd||68ec||fffd||67d||fffd||fffd||43d||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd|"
            Exit Sub
        End If
    End If
    'zle,2008-12-25,
    
    Dim Protected As Boolean '|fffd||436||fffd||fffd||2b5||fffd||fffd||1f7||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim TxtFoot As String, TxtChg As String
    InProcess = True
     '|fffd||fffd||fffd||fffd||fffd||fffd||6c63||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
        Protected = True
    Else
        Protected = False
    End If
    'zle,2008-12-23,+begin,|fffd||fffd||fffd||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||4fd||fffd||5e2||fffd||fffd||fffd||763||fffd||fffd||fffd||fffd||fffd||fffd||7b8||13d||fffd||5e2||fffd||fffd||fffd||fffd|
    g_MarkOrAll = 0
    Dim iSide As Integer
    iSide = 0
    '1.|fffd||fffd||fffd||fffd||fffd||fffd||6bd||fffd||5e2||fffd||fffd||175||fffd||fffd||fffd||fffd|
    Selection.MoveRight wdCharacter, 1, wdExtend
    If Selection.Style = "|fffd||fffd||5e2||fffd||fffd||fffd||fffd|" Then
        If Selection.Range.Text <> ")" Then
            Selection.MoveLeft wdCharacter, 1
            If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
                ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
                wdPrintPreview Then
                ActiveWindow.View.SeekView = wdSeekFootnotes
            Else
                ActiveWindow.View.SplitSpecial = wdPaneFootnotes
            End If
            Selection.Paragraphs(1).Range.Select
            Selection.MoveEnd wdCharacter, -1
            g_MarkOrAll = 3
            frmJz.Show
            g_MarkOrAll = 0
            Selection.Range.Text = Trim(g_SYGS)
            If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
                ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
                wdPrintPreview Then
                ActiveWindow.View.SeekView = wdSeekMainDocument
            Else
                ActiveWindow.Panes(2).Close
            End If
            g_SYGS = ""
            iSide = 1
            GoTo Pt
        Else
            Selection.MoveLeft wdCharacter, 1
        End If
    Else
        Selection.MoveLeft wdCharacter, 1
    End If
    '2.|fffd||fffd||fffd||fffd||fffd||fffd||6bd||fffd||5e2||fffd||fffd||175||fffd||fffd||43c||fffd|
    Selection.MoveLeft wdCharacter, 1, wdExtend
    If Selection.Style = "|fffd||fffd||5e2||fffd||fffd||fffd||fffd|" Then
        If Selection.Range.Text <> ")" Then
            Selection.MoveLeft wdCharacter, 1
            If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
                ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
                wdPrintPreview Then
                ActiveWindow.View.SeekView = wdSeekFootnotes
            Else
                ActiveWindow.View.SplitSpecial = wdPaneFootnotes
            End If
            Selection.Paragraphs(1).Range.Select
            Selection.MoveEnd wdCharacter, -1
            g_MarkOrAll = 3
            frmJz.Show
            g_MarkOrAll = 0
            Selection.Range.Text = Trim(g_SYGS)
            If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
                ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
                wdPrintPreview Then
                ActiveWindow.View.SeekView = wdSeekMainDocument
            Else
                ActiveWindow.Panes(2).Close
            End If
            g_SYGS = ""
            iSide = 2
            GoTo Pt
        Else
            Selection.MoveRight wdCharacter, 1
        End If
    Else
        Selection.MoveRight wdCharacter, 1
    End If
    '3.|fffd||fffd||fffd||fffd||fffd||fffd||6bd||fffd||5e2||fffd||fffd||175||fffd||fffd||4b2||fffd|
    Selection.MoveLeft wdCharacter, 2, wdExtend
    If Selection.Style = "|fffd||fffd||5e2||fffd||fffd||fffd||fffd|" Then
        Selection.MoveLeft wdCharacter, 1
        If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
            ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
            wdPrintPreview Then
            ActiveWindow.View.SeekView = wdSeekFootnotes
        Else
            ActiveWindow.View.SplitSpecial = wdPaneFootnotes
        End If
        Selection.Paragraphs(1).Range.Select
        Selection.MoveEnd wdCharacter, -1
        g_MarkOrAll = 3
        frmJz.Show
        g_MarkOrAll = 0
        Selection.Range.Text = Trim(g_SYGS)
        If ActiveWindow.ActivePane.View.Type = wdPrintView Or ActiveWindow. _
            ActivePane.View.Type = wdWebView Or ActiveWindow.ActivePane.View.Type = _
            wdPrintPreview Then
            ActiveWindow.View.SeekView = wdSeekMainDocument
        Else
            ActiveWindow.Panes(2).Close
        End If
        g_SYGS = ""
        iSide = 3
        GoTo Pt
    Else
        Selection.MoveRight wdCharacter, 1
    End If
    
    '|2f5||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4fd||fffd||5e2|
    If iSide = 0 Then
'        Selection.MoveLeft , 1
'        Selection.MoveRight , 3, wdExtend
'        If Selection.Footnotes.Count > 0 Then
''            'zle,2008-12-9,|5e2||fffd||375||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''            TxtFoot = InputBox("|fffd||fffd||fffd||7b8||13a||fffd||fffd||5e2||fffd||fffd||fffd||fffd|", "|fffd||7b8||13d||fffd||5e2|", Selection.Footnotes(1).Range.Text)
'            frmJz.Show
'            If Trim(g_SYGS) <> "" And Trim(g_SYGS) <> Selection.Footnotes(1).Range.Text Then
'                Selection.Footnotes(1).Range.Text = Trim(g_SYGS)
'            End If
'            Selection.MoveLeft , 1
'            Selection.MoveRight , 1
'        Else
''            Selection.MoveLeft , 1
''            Selection.MoveRight , 1
'            TxtFoot = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||bd||fffd||5e2||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||4fd||fffd||5e2|", "")
            frmJz.Show
            If Trim(g_SYGS) <> "" Then
                If Selection.Range.Text <> "" Then
                    Selection.MoveLeft , 1
                End If
                Selection.TypeText Text:=")"
                Selection.MoveLeft , 1, wdExtend
                Selection.Style = wdStyleFootnoteReference
                Selection.MoveLeft , 1
                Set ft = ActiveDocument.Footnotes.Add(Selection.Range, "")
                Selection.MoveLeft , 2, wdExtend
                Selection.Delete
                Selection.TypeText Trim(g_SYGS)
                ActiveWindow.View.SeekView = wdSeekMainDocument
            End If
            g_SYGS = ""
'        End If
     End If

    'zle,2008-12-23,+end
    
        
Pt:    If Protected Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         ActiveDocument.Sections(1).ProtectedForForms = True
         For i = 2 To ActiveDocument.Sections.Count
             ActiveDocument.Sections(i).ProtectedForForms = False
         Next
         ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    End If
    InProcess = False
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||237||461||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
'zle,2008-9-26,+end

'|fffd||fffd||fffd||fffd|
Private Sub CmdLx1_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx1C_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdLx1C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx1
End Sub

Private Sub CmdLx2_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx2C_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdLx2C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx2
End Sub

Private Sub CmdLx3_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx3C_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdLx3C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx3
End Sub

Private Sub CmdLx4_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx4C_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdLx41_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx41
End Sub
'|fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdLx41C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx41_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdLx4C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx4
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdLx5_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx5C_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdLx51_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
'    InsertLx51
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdLx51C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx51_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdLx5C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx5
End Sub

Private Sub CmdLx6_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdLx6C_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdLx6C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertLx6
End Sub


'|13f||fffd||fffd|
Private Sub CmdMc_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdMcC_Click(Ctrl, CancelDefault)
End Sub
'zle,2008-9-26,+begin,|fffd||fffd||fffd||fffd||13f||fffd||3bf||fffd||770||fffd||165|
'|13f||fffd||fffd|
Private Sub CmdMcC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
   If ActiveDocument.Bookmarks.Exists("BKML") Then
        Dim Res As String
        Res = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||3a3||fffd||fffd||1f7||fffd||fffd||fffd||a3||fffd|", vbYesNo + vbQuestion)
        If Res = vbNo Then
            Exit Sub
        End If
        'zle,2008-10-10,+1,|13f||fffd||3b8||fffd||fffd||b5||134||fffd||fffd||fffd||fffd||fffd|1
        g_MC_Count = g_MC_Count + 1
    End If
    FrmContent.Show
End Sub
'zle,2008-9-26,+end

'|1f0||fffd||fffd|
Private Sub CmdQy_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdQyC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-26,+begin,|fffd||fffd||fffd||fffd||1f0||fffd||53f||fffd||770||fffd||165|
Private Sub CmdQyC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    Dim MoveBK As String
    InProcess = True
    If ActiveDocument.Bookmarks.Exists("BKQY") Then
        'zle,2009-1-9,+begin,|fffd||436||fffd||fffd||1f2||fffd||fffd||fffd||fffd||fffd||27e|
        Selection.GoTo what:=wdGoToBookmark, Name:="BKQY"
        '|2f5||fffd||fffd||237||2b5||fffd||fffd||fffd||fffd| |1f0||fffd||fffd|
        If Selection.Style = "|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|" Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||1f0||fffd||523||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd|"
            InProcess = False
            Exit Sub
        '|2f5||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||2e1||fffd||1f0||fffd||521||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |1f0||fffd||535||fffd| |fffd||fffd||2bd||fffd||fffd||2a7|
        Else
             '|fffd||436||3e1||fffd||fffd||fffd||fffd||521||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||1f0||fffd||535||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |3aa||5b9|
             If ActiveDocument.Bookmarks.Exists("BKYY") Then
                Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKQY").Start - 1, End:=ActiveDocument.Bookmarks("BKYY").Start - 2)
                tempRange.Select
                tempRange.Delete
                
             '|fffd||436||3e1||fffd||fffd||fffd||fffd||521||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||1f0||fffd||535||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |3aa||5b9|
             Else
                Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKQY").Start - 1, End:=ActiveDocument.Bookmarks("StandardName").Start - 2)
                tempRange.Select
                tempRange.Delete
             End If
        End If
        'zle,2009-1-9,+end
    End If
    
    MoveBK = "StandardName"
    If ActiveDocument.Bookmarks.Exists("BKYY") Then
        MoveBK = "BKYY"
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        Selection.HomeKey
        Selection.TypeParagraph
        Selection.MoveLeft , 1

    ElseIf ActiveDocument.Bookmarks.Exists("BKML") Then
        MoveBK = "StandardName"
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        Selection.HomeKey
        Selection.MoveLeft , 1
        Selection.TypeParagraph
    Else
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        ProcessFontPage
    End If
    Selection.Style = ActiveDocument.Styles("|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|")

    Selection.TypeText Text:="|1f0|"
    'zle,2008-10-10,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||13e||fffd||fffd||fffd|
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    
    Selection.HomeKey
    Selection.MoveRight , 1
    Selection.MoveRight wdSentence, 1, wdExtend
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BKQY"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.HomeKey
    Selection.EndKey
    If ActiveDocument.Bookmarks.Exists("BKYY") Then
        Selection.TypeParagraph
    Else
        Selection.TypeParagraph
        Selection.MoveLeft , 1
        Selection.TypeParagraph
    End If
    InProcess = False
End Sub
'zle,2008-9-26,+end

'zle,2008-7-23,+begin |fffd||fffd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd||134||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdSjTable_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSjTableC_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdSjTableC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertTable
End Sub
'zle,2008-7-23,+end

'zle,2008-9-22,+begin,|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|
Private Sub CmdTBJZSM_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTblFooter
End Sub

Private Sub CmdTBJZSMC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTBJZSM_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-22,+begin,|37c||fffd||fffd||fffd||5fd||fffd||5e2||2f5||fffd||fffd|
Private Sub CmdSTBJZSM_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTblFirFooter
End Sub
'zle,2008-9-22,+end

Private Sub CmdSTBJZSMC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSTBJZSM_Click(Ctrl, CancelDefault)
End Sub

'|fffd||fffd||fffd||fffd|
Private Sub CmdYy_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdYyC_Click(Ctrl, CancelDefault)
End Sub
'zle,2008-9-26,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||53f||fffd||770||fffd||165|
Private Sub CmdYyC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InProcess = True
    Dim MoveBK As String
    If ActiveDocument.Bookmarks.Exists("BKYY") Then
        'zle,2009-1-9,+begin,|fffd||436||fffd||fffd||1f2||fffd||fffd||fffd||fffd||fffd||27e|
        Selection.GoTo what:=wdGoToBookmark, Name:="BKYY"
        '|2f5||fffd||fffd||237||2b5||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        If Selection.Style = "|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|" Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||523||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd|"
            InProcess = False
            Exit Sub
        '|2f5||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||2e1||fffd||fffd||fffd||fffd||521||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||535||fffd| |fffd||fffd||2bd||fffd||fffd||2a7|
        Else
            Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKYY").Start - 1, End:=ActiveDocument.Bookmarks("StandardName").Start - 2)
            tempRange.Select
            tempRange.Delete
        End If
        'zle,2009-1-9,+end
    End If
    
    MoveBK = "StandardName"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    If ActiveDocument.Bookmarks.Exists("BKQY") Then
        Selection.EndKey
        Selection.MoveUp wdParagraph, 1
'        Selection.HomeKey
        Selection.MoveLeft , 2
        Selection.TypeParagraph
    ElseIf ActiveDocument.Bookmarks.Exists("BKML") Then
        MoveBK = "StandardName"
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        Selection.HomeKey
        Selection.MoveLeft , 1
        Selection.TypeParagraph
    Else
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        ProcessFontPage
    End If
    Selection.Style = ActiveDocument.Styles("|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|")

    Selection.TypeText Text:="|fffd||fffd|"
    'zle,2008-10-10,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||13e||fffd||fffd||fffd|
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    
    Selection.HomeKey
    Selection.MoveRight , 1
    Selection.MoveRight wdSentence, 1, wdExtend
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BKYY"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.HomeKey
    Selection.EndKey
    If ActiveDocument.Bookmarks.Exists("BKQY") Then
        Selection.MoveLeft , 1
    Else
        Selection.TypeParagraph
        Selection.MoveLeft , 1
    End If
     Selection.TypeParagraph
    InProcess = False
End Sub
'zle,2008-9-26,+end

'|2be||fffd||fffd|
Private Sub CmdSl_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSlC_Click(Ctrl, CancelDefault)
End Sub
'|2be||fffd||fffd|
Private Sub CmdSlC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertExample
End Sub
'|fffd||fffd||fffd||fffd|
Private Sub CmdSy_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdSyC_Click(Ctrl, CancelDefault)
End Sub

'zle,2008-9-26,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdSyC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    DesignIndexTCS
End Sub
'zle,2008-9-26,+end
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||121||fffd||fffd||fffd||bc|
Private Sub CmdTabTitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTabTitleC_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||138||fffd||bc||fffd||fffd||770||fffd||165|
Private Sub CmdTabTitleC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertTblTitle
End Sub

'|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle1_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle1C_Click(Ctrl, CancelDefault)
End Sub
'|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdTTitle1C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFirTitle
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle2_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle2C_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdTTitle2C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertSecTitle
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle3_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle3C_Click(Ctrl, CancelDefault)
End Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdTTitle3C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertThiTitle
End Sub
'|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle4_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle4C_Click(Ctrl, CancelDefault)
End Sub
'|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdTTitle4C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertForTitle
End Sub
'|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle5_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle5C_Click(Ctrl, CancelDefault)
End Sub
'|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdTTitle5C_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFifTitle
End Sub

'|fffd||1f1||fffd||fffd||fffd||fffd||fffd|
Private Sub CmdTTitle1F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If

    InsertFirTitle
    ChgToSong
    'zle,090702,+5
    If Selection.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Selection.Style = "|4bb||fffd||fffd||fffd||fffd|"
    Else
        Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|"
    End If
End Sub
Private Sub CmdTTitle1FC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle1F_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdTTitle2F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    InsertSecTitle
    ChgToSong
    'zle,090702,+5
    If Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
End Sub

Private Sub CmdTTitle2FC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle2F_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdTTitle3F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    InsertThiTitle
    ChgToSong
    'zle,090702,+5
    If Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
End Sub

Private Sub CmdTTitle3FC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle3F_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdTTitle4F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    InsertForTitle
    ChgToSong
    'zle,090702,+5
    If Selection.Style = "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Selection.Style = "|fffd||13c||fffd||fffd||fffd|"
    Else
        Selection.Style = "|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd|"
    End If
End Sub

Private Sub CmdTTitle4FC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle4F_Click(Ctrl, CancelDefault)
End Sub
Private Sub CmdTTitle5F_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    InsertFifTitle
    ChgToSong
    'zle,090702,+5
    If Selection.Style = "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        Selection.Style = "|fffd||5f36||fffd||fffd|"
    Else
        Selection.Style = "|fffd||fffd||bc||fffd||5f36||fffd||fffd|"
    End If
End Sub
Private Sub CmdTTitle5FC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdTTitle5F_Click(Ctrl, CancelDefault)
End Sub


'|fffd||fffd||fffd||1f1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd|
Private Sub ChgToSong()
    On Error GoTo errorhandle
    Selection.Paragraphs(1).Range.Font.Name = "|fffd||fffd||fffd||fffd|"
    'zle,2008-10-7,+|fffd||fffd||fffd||f6||fffd||fffd||fffd||1f0||fffd||fffd||fffd||fffd|
    With Selection.Paragraphs(1).Range.ParagraphFormat
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .LineSpacingRule = wdLineSpaceSingle
    End With
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|"
End Sub

'|5e2|
Private Sub CmdZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTblNote
End Sub
'|5e2| |fffd||13f||fffd||770||fffd||165|
Private Sub CmdZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZ_Click(Ctrl, CancelDefault)
End Sub

'|fffd||b1||fffd||fffd||fffd|
Private Sub CmdZtitle_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZtitleC_Click(Ctrl, CancelDefault)
End Sub
'|fffd||b1||fffd||fffd||fffd||fffd||770||fffd||165|
Private Sub CmdZtitleC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertCharacter
End Sub

'zle,09-06-13,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||5e2|
Private Sub CmdZWZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertTextNote
End Sub

Private Sub CmdZWZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZWZ_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdZWZZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertTextMulNote
End Sub

Private Sub CmdZWZZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZWZZ_Click(Ctrl, CancelDefault)
End Sub

Private Sub CmdZWZZF_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertTextFirNote
End Sub

Private Sub CmdZWZZFC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZWZZF_Click(Ctrl, CancelDefault)
End Sub
'zle,09-06-13,+end,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||5e2|


'|5e2||fffd||fffd|
Private Sub CmdZZ_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTblMulNote
End Sub
'|fffd||fffd||5e2||fffd||13f||fffd||770||fffd||165|
Private Sub CmdZZC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Call CmdZZ_Click(Ctrl, CancelDefault)
End Sub

'|fffd||1f7||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd|
Private Sub CmdShowHelp_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    Dim WIni As Boolean
    If Ctrl.State = msoButtonDown Then
        Ctrl.State = msoButtonUp
        ShowTip = False
    Else
        Ctrl.State = msoButtonDown
        ShowTip = True
    End If
    
End Sub

'|fffd||1f7||fffd||fffd||fffd||fffd||2eb||fffd||fffd||fffd||170||fffd|
Private Sub CmdTwopage_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    Dim WIni As Boolean
    If Ctrl.State = msoButtonDown Then
        ProcessOnePageHeader
        Ctrl.State = msoButtonUp
        ClsEvent.CmdTwoPageC.State = msoButtonUp
    Else
        Ctrl.State = msoButtonDown
        'zle,2008-11-24+1
        ClsEvent.CmdTwoPageC.State = msoButtonDown
        ProcessTwoPageHeader
    End If
End Sub
'zle,2008-10-4,+begin,|fffd||fffd||fffd||4e1||fffd||2eb||fffd||fffd||fffd||170||6871||fffd||fffd||770||fffd||165|
Private Sub CmdTwoPageC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    Dim WIni As Boolean
    If Ctrl.State = msoButtonDown Then
        ProcessOnePageHeader
        Ctrl.State = msoButtonUp
        ClsEvent.CmdTwoPage.State = msoButtonUp
    Else
        Ctrl.State = msoButtonDown
        'zle,2008-11-24+1
        ClsEvent.CmdTwoPage.State = msoButtonDown
        ProcessTwoPageHeader
    End If
End Sub
'zle,2008-10-4,+end

'zle,09-06-17,*begin
''|fffd||1f7||fffd||fffd||fffd||2be||fffd||fffd||4e1||5f4||32c|
'Private Sub CmdPrtStatus_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    Call CmdTwoPageC_Click(Ctrl, CancelDefault)
'End Sub
'
''zle,2008-10-4,+begin,|fffd||fffd||fffd||4f7||fffd||fffd||fffd||524||fffd||fffd||fffd||fffd||770||fffd||165|
'Private Sub CmdPrtStatusC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
'        g_ZMFirst = 0
'        ProcessEdit
'    End If
'    Dim WIni As Boolean
'    If Ctrl.State = msoButtonDown Then
'        Ctrl.State = msoButtonUp
'        ProcessEdit
'    Else
'        Ctrl.State = msoButtonDown
'        ProcessPrint
'    End If
'End Sub
'zle,2008-10-4,+end
'zle,09-06-17,*end

'|fffd||fffd||5e2|
Private Sub CmdZZF_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
        g_ZMFirst = 0
        ProcessEdit
    End If
    InsertFigTblFirNote
End Sub
'|fffd||fffd||5e2||fffd||13f||fffd||770||fffd||165|
Private Sub CmdZZFC_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
   Call CmdZZF_Click(Ctrl, CancelDefault)
End Sub

Private Sub TdsApp_DocumentBeforeClose(ByVal Doc As Document, Cancel As Boolean)
    '|fffd||fffd||fffd||fffd||fffd|word|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||43b||fffd||2b1||fffd||631||572||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If ActiveDocument.Path + "\" + ActiveDocument.Name <> ThisDocument.Path + "\" + ThisDocument.Name Then
        Exit Sub
    End If

End Sub

'Private Sub TdsApp_Quit()
'    Dim cmbNewMenu As CommandBar
'    Set cmbNewMenu = ActiveDocument.CommandBars("Menu Bar")
''|fffd||2f3||fffd||27e||fffd||fffd||fffd||2f5||fffd|
'    For Each ctlPopup In cmbNewMenu.Controls
'        If ctlPopup.Caption = "|fffd||fffd||fffd||4f1||fffd||5fc||4aa||fffd||fffd|" Or ctlPopup.Caption = "|fffd||fffd||5fc||fffd||131||fffd||fffd||fffd||2bd|" Or ctlPopup.Caption = "|fffd||fffd||bc||fffd||fffd||fffd||170||fffd|" Then
'            ctlPopup.Delete
'        End If
'    Next
'
'    For Each cmbNewBar In CommandBars
'        If cmbNewBar.Name = "|fffd||fffd||5fc||fffd||fffd||434||fffd||fffd||fffd||fffd|" Or cmbNewBar.Name = "|fffd||fffd||5fc||fffd||131||fffd||fffd||fffd||2bd|" Then
'            cmbNewBar.Delete
'        End If
'    Next
'End Sub

Private Sub TdsApp_WindowSelectionChange(ByVal Sel As Selection)
    On Error Resume Next
    'zle,2008-12-9,+3|fffd||53c||fffd||fffd||fffd||5bb||fffd||735||fffd||fffd||fffd||fffd||53c||fffd||fffd||fffd|
    If ActiveDocument.Path + "\" + ActiveDocument.Name <> ThisDocument.Path + "\" + ThisDocument.Name Then
        Exit Sub
    End If
    If Right(ActiveDocument.Name, 4) = ".tcs" Or Right(ActiveDocument.Name, 4) = ".TCS" Or ActiveDocument.Name = "TCS.SYS" Then

    Else
        Exit Sub
    End If
    If Not InProcess Then
        InProcess = True
        Dim i As Integer
        Dim LostFocus As Boolean, SetFldNull As Boolean
        Dim NewName As String
        SetFldNull = False
        'zle,2008-11-13,+2,
        Dim mystart As Range
        Dim iNum As Integer
        
        LostFocus = True

        If Sel.Sections(1).ProtectedForForms Then '|5bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

            Set mystart = ActiveDocument.Range(0, Selection.Range.End)
            iNum = mystart.FormFields.Count
            If iNum = 0 Then
                Exit Sub
            End If
            With mystart.FormFields(iNum)
                '|fffd||436||fffd||fffd||1f7||fffd||fffd||fffd||123||2bd||fffd||fffd||fffd||fffd||fffd|
'                If (g_rowNum = 1) Then
'                    g_rowNum = 0
'                    Unload UserForm1
'                End If
                '|fffd||3f4||fffd||fffd||fffd||2a7||225||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||3aa||231||2a1||5b5|
                If OriFldName <> .Name And Trim(OriFldName) <> "" Then
                    With ActiveDocument.FormFields(OriFldName)
                        If Trim(.Result) = "" Then
                            .Result = .TextInput.Default
                        End If
                        'zle,2008-11-24,+begin,|fffd||fffd||fffd||4f6||534||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6a1||fffd||fffd||fffd||fffd||fffd||fffd||175||fffd||fffd||fffd||fffd||2d26||fffd||fffd|
                        If .Name = "DT" Then
                            If Trim(.Result) = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "GB/T" Or Trim(.Result) = "|fffd||fffd||fffd||fffd|" Or Trim(.Result) = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "DB" Or Trim(.Result) = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "Q/" Then
                                .Result = ""
                            End If
                        End If
                        If .Name = "WCRQ" Then
                            If Trim(.Result) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd|" Then
                                .Result = ""
                            End If
                        End If
                        If .Name = "BAH" Then
                            If Trim(.Result) = "|fffd||fffd||fffd||fffd||fffd||163||fffd|" Then
                                .Result = ""
                            End If
                        End If
                        'zle,2008-11-24,+end
                    End With
                Else
                    LostFocus = False
                End If
                NewName = .Name
                '|fffd||fffd||1f0||fffd||fffd||f5||fffd||fffd||fffd||fffd||38ec||fffd||fffd||fffd||fffd||1f5||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd|
                If Left(.Result, 4) = "|fffd||fffd||fffd||fffd||2f4||fffd|" Then
                    .Result = ""
                End If
                '|fffd||fffd||5fc||fffd||fffd||163||fffd||225||fffd||fffd||fffd||fffd||fffd||435||fffd|XXXXX
                'zle,2008-11-24,+begin,|fffd||fffd||fffd||fffd||1f4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2d26||fffd||fffd|
                If .Name = "DT" And .Result = "" Then
                
                    'zle,2009-5-22,+1,|fffd||436||fffd||fffd||1f7||fffd||fffd||1f9||fffd||fffd||4b1||fffd||5fc|
                    If OnePage = False Then
                        GetFMType
                    End If
                    'zle|fffd||fffd|2009-1-8|fffd||fffd||fffd||fffd||fffd||436||fffd||4bb||fffd||fffd||fffd||1f7||fffd||fffd||1f9||fffd||fffd||4b1||fffd||5fc|
                    If StdType = 0 Then
                        .Result = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "GB/T "
                    ElseIf StdType = 1 Then
                        .Result = "|fffd||fffd||fffd||fffd| "
                    ElseIf StdType = 2 Then
                        .Result = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "DB "
                    ElseIf StdType = 3 Then
                        .Result = "|fffd||fffd||fffd||fffd|" & ChrW(8194) & "Q/ "
                    End If
                    If Left(OriFldName, 5) <> "StdNo" Then
                        Selection.EndKey
                    End If
                End If
                'zle,2008-11-24,+end
                
                'zle,2008-11-27,+begin,|fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b5||2a9||fffd||fffd||fffd||6a3||fffd||fffd||bdaf9||fffd||fffd||fffd||fffd||fffd||fffd||129||3b2|
                If ((.Name = "FY" And .Result = "XXXX") Or (.Name = "FM" And .Result = "XX") Or (.Name = "FD" And .Result = "XX") Or (.Name = "SY" And .Result = "XXXX") Or (.Name = "SM" And .Result = "XX") Or (.Name = "SD" And .Result = "XX")) Then
                    .Result = ""
                End If
                'zle,2008-11-27,+end
                If (.Name = "c1" And .Result = "") Or (.Name = "c2" And .Result = "") Or (.Name = "c3" And .Result = "") Or (.Name = "c4" And .Result = "") Or (.Name = "c5" And .Result = "") Or (.Name = "c6" And .Result = "") Or (.Name = "fm" And .Result = "") Then
                    Selection.EndKey
                End If


                'zle,2008-11-24,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2d26||fffd||fffd|
                If .Name = "WCRQ" And .Result = "" Then
                    .Result = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd|"
                    Selection.EndKey
                    Selection.MoveLeft , 1
                End If
                'zle,2008-11-24,+end
                
                If .Name = "BAH" And .Result = "" Then
                    .Result = "|fffd||fffd||fffd||fffd||fffd||163||fffd|"
                    Selection.EndKey
                End If
                'zle,2008-11-24,+end

                Dim iCount As Integer
                iCount = 0
                Dim iLen As Integer
                iLen = 0
                i = 1
                If Left(NewName, 6) = "StdNo0" Then
                    Dim StdStr As String
                    With ActiveDocument.FormFields("StdNo0")
                        StdStr = .Result
                        iLen = .TextInput.Width
                        For i = 1 To iLen
                            If (Mid(StdStr, i, 1) = "X" Or Mid(StdStr, i, 1) = "x") Then
                                iCount = iCount + 1
                            End If
                        Next i
                        If iCount = iLen Then
                            StdStr = Replace(StdStr, "X", "")
                            .Result = StdStr
                        End If
                    End With
                End If
                If Left(NewName, 6) = "StdNo1" Then
                    With ActiveDocument.FormFields("StdNo1")
                        StdStr = .Result
                        iLen = .TextInput.Width
                        For i = 1 To iLen
                            If (Mid(StdStr, i, 1) = "X" Or Mid(StdStr, i, 1) = "x") Then
                                iCount = iCount + 1
                            End If
                        Next i
                        If iCount = iLen Then
                            StdStr = Replace(StdStr, "X", "")
                            .Result = StdStr
                        End If
                    End With
                    If StdType <> 0 Then
                        If ActiveDocument.FormFields("StdNo1").Result = "" Then
                            LostFocus = False
                        End If
                    End If
                End If
                If Left(NewName, 6) = "StdNo2" Then
                    With ActiveDocument.FormFields("StdNo2")
                        StdStr = .Result
                        iLen = .TextInput.Width
                        For i = 1 To iLen
                            If (Mid(StdStr, i, 1) = "X" Or Mid(StdStr, i, 1) = "x") Then
                                iCount = iCount + 1
                            End If
                        Next i
                        If iCount = iLen Then
                            StdStr = Replace(StdStr, "X", "")
                            .Result = StdStr
                        End If
                    End With

                    If ActiveDocument.FormFields("StdNo2").Result = "" Then
                        LostFocus = False
                    End If

                    'zle,2008-10-14,*1,|fffd||f9||fffd||fffd||fffd||3bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||637||fffd|
'                    Selection.EndKey
                End If
            End With
        Else
            SetFldNull = True
        End If


        '|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1bc||fffd||4b3||fc|
        If LostFocus Then
            If Left(OriFldName, 5) = "StdNo" Then '|fffd||fffd||fffd||fffd||1f1||fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fc||fffd||fffd||4b3||fffd||fffd|

                If ((InStr(NewName, "StdNo") > 0 And InStr(OriFldName, "StdNo") = 0) Or (InStr(NewName, "StdNo") = 0 And InStr(OriFldName, "StdNo") > 0)) Then
                    InsertFooter
                    Selection.EndKey
                End If
                ActiveWindow.ScrollIntoView Selection.Range
            End If
            If OriFldName = "StdName" Then '|fffd||fffd||fffd||fffd||1f1||fffd||5fc||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||131||fffd||5fc||fffd||fffd||fffd||fffd|
                'zle,2008-11-26,+begin,|fffd||fffd||f5||fffd||1f0||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
                If NewName = "" Then
                    With ActiveDocument.Bookmarks
                        .Add Name:="BZ", Range:=Selection.Range
                        .ShowHidden = True
                        .DefaultSorting = wdSortByLocation
                    End With
                Else
                    g_SZFirst = NewName
                End If
                'zle,2008-11-26,+end
                ChgName
                ActiveWindow.ScrollIntoView Selection.Range
            End If
        End If
        '|fffd||fffd||5fc||fffd||fffd||fffd||1bc||fffd||4b3||fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If SetFldNull Then
            OriFldName = ""
        Else
            OriFldName = NewName
        End If
        InProcess = False
    End If
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) = "(|524||fffd||fffd|)" Then
        Exit Sub
    End If
    If g_ZMFirst = 1 And Right(ActiveDocument.ActiveWindow.Caption, 4) <> "(|524||fffd||fffd|)" Then
            g_ZMFirst = 0
            ProcessEdit
    End If
End Sub

Attribute VB_Name = "FrmAddFoot"
Attribute VB_Base = "0{00D3E462-356B-415B-9679-86C155FE8337}{24400486-15ED-4349-974D-18BC8848F7B6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim Protected As Boolean '|fffd||436||fffd||fffd||2b5||fffd||fffd||1f7||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
    InProcess = True
    If Trim(TxtJZ.Text = "") Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd|", vbOKOnly + vbInformation
        Exit Sub
    End If

    '|fffd||fffd||fffd||fffd||fffd||fffd||6c63||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
        Protected = True
    Else
        Protected = False
    End If
    
    If Selection.Range.Text <> "" Then
        Selection.MoveLeft , 1
    End If
    Selection.TypeText Text:=")"
    Selection.MoveLeft , 1, wdExtend
    Selection.Style = wdStyleFootnoteReference
    Selection.MoveLeft , 1
    Set ft = ActiveDocument.Footnotes.Add(Selection.Range, "")
    Selection.MoveLeft , 2, wdExtend
    Selection.Delete
    Selection.TypeText " " & TxtJZ.Text
    ActiveWindow.View.SeekView = wdSeekMainDocument
    If Protected Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         ActiveDocument.Sections(1).ProtectedForForms = True
         For i = 2 To ActiveDocument.Sections.Count
             ActiveDocument.Sections(i).ProtectedForForms = False
         Next
         ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    InProcess = False
    Unload Me
End Sub


Private Sub txtJz_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = 13 Then
        cmdOk_Click
    End If
End Sub

Attribute VB_Name = "FrmChoice"
Attribute VB_Base = "0{189439C0-E108-47E5-B21A-40FE17ADEC71}{48C77775-B24C-4086-A4B7-1DEE31383535}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Private Sub Cancel_Click()
    Unload Me
End Sub
Private Sub cmdOk_Click()
    If OptButton1.Value Then
        StdType = 0
    End If
    If OptButton2.Value Then
        StdType = 1
    End If
    If OptButton3.Value Then
        StdType = 2
    End If
    If OptButton4.Value Then
        StdType = 3
    End If
    Unload Me
    InsertFM
End Sub


Private Sub UserForm_Activate()
    OptButton1.Value = True
End Sub

Attribute VB_Name = "FrmContent"
Attribute VB_Base = "0{1DDD3CEA-C320-4ABD-9530-E5F7CAD8816F}{0FAD2219-ECB2-43BC-A3F2-8CCC4B8E2EB6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Dim a(100) As Integer
'Dim InProcess As Boolean

Sub ProcessParent(ByVal Indx As Integer)
    Dim i As Integer
    i = Indx
    If Not InProcess Then
        If (a(i) Mod 10) > 1 Then
            InProcess = True
            While (a(i) Mod 10) > 1
                LstContent.Selected(i) = True
                i = i - 1
            Wend
            LstContent.Selected(i) = True
        End If
    End If
    InProcess = False
End Sub
Private Sub cmdCancel_Click()
    Unload Me
End Sub



Private Sub cmdOk_Click()
   Dim i As Integer, ADstr As String, j As Integer, GStr As String
   Dim Tble As String           'zle,2008-10-8,+|4bb||fffd||fffd||fffd||fffd||fffd||fffd| Tble
   Dim upDateCount As Integer   'zle,2008-10-10+1
   Dim RegStr As String
   RegStr = ""
   GStr = ""
   Tble = ""                     'zle,2008-10-8,|fffd||fffd||2bc||fffd||fffd| Tble
   upDateCount = 7 + g_MC_Count
    'zle,2009,*1,|fffd||fffd||fffd||fffd||fffd||b1||fffd||fffd||2871||fffd||fffd||4bb||fffd||fffd| |fffd||fffd||fffd|  |fffd||fffd||fffd||fffd|
    ADstr = "|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|,1,|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,1,|fffd||b1||fffd||fffd||fffd|,1,|fffd||3bf||fffd||fffd||fffd||fffd||fffd|,1,|fffd||fffd||bc||fffd||fffd||2b6|,1,"
    'zle,2009,+11,|fffd||fffd||fffd||fffd||fffd||b1||fffd||fffd||2871||fffd||fffd||4bb||fffd||fffd| |fffd||fffd||fffd|  |fffd||fffd||fffd||fffd|
''    ADstr = "|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|,1,|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,1,|fffd||b1||fffd||fffd||fffd|,2,|fffd||3bf||fffd||fffd||fffd||fffd||fffd|,1,|fffd||fffd||bc||fffd||fffd||2b6|,1,"
    
    For i = 0 To LstContent.ListCount - 1
        If LstContent.Selected(i) Then
            RegStr = RegStr & str(i) & ","
            If (a(i) / 10) < 3 Then
                'zle,2008-9-28,+if|fffd||fffd||48ec||fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||13b||fffd||fffd||1f8||fffd||bc|
                If a(i) < 20 Then
                    j = a(i) Mod 10
                    'zle,2008-9-28,*1,|5e2||fffd||375||fffd||52d||fffd||fffd||fffd||fffd||13f||bc||fffd||fffd||fffd||5bc||fffd|
    '                ADstr = ADstr & LstContent.List(i) & ", 2  ,"  '" & Str(j + 1) & ","
    
'                    zle , 2008 - 9 - 28, 1, |2b9||13f||bc||fffd||739||fffd||fffd||5bc||fffd||fffd||fffd||fffd||fffd|
                    ADstr = ADstr & LstContent.List(i) & "," & str(j + 2) & ","
                Else
                    j = a(i) Mod 10
                    'zle,2008-9-28,+1,|2b9||13f||bc||fffd||739||fffd||fffd||5bc||fffd||fffd||fffd||fffd||fffd|
                    ADstr = ADstr & LstContent.List(i) & "," & str(j + 2) & ","

                End If
            Else
                If a(i) = 31 Then
                    GStr = GStr & "|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|,2,|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|,2"
                End If
                If a(i) = 41 Then
                   'zle,2008-10-8,*1|fffd||fffd||fffd||5bf||fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd||fffd||fffd|
'                    GStr = GStr & ",|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|,2,|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|,2"

                    'zle,2008-10-8,+1|fffd||fffd||fffd||5bf||fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd||fffd||fffd|
                    Tble = Tble & ",|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|,2,|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|,2"

                End If
            End If
        End If
    Next
    ADstr = Left(ADstr, Len(ADstr) - 1)
    If Trim(RegStr) <> "" Then
        RegStr = Left(RegStr, Len(RegStr) - 1)
    End If
    SaveSetting "TCS", ActiveDocument.Name, "MC", RegStr
    Dim MoveBK As String
    InProcess = True
    MoveBK = "StandardName"
    If ActiveDocument.Bookmarks.Exists("BKYY") Then
        MoveBK = "BKYY"
    End If
    Unload Me
    If ActiveDocument.Bookmarks.Exists("BKQY") Then
        MoveBK = "BKQY"
    End If
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
'    Selection.HomeKey
    Selection.MoveUp wdParagraph, 1
    Selection.TypeParagraph
    Selection.MoveLeft , 1
    'zle,2008-12-4,+1,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||2b1|range|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5ae||1f0||fffd||fffd||13f||fffd||3b5||fffd|neir
    Dim tempRange As Range
    If ActiveDocument.Bookmarks.Exists("BKML") Then
'        Selection.MoveUp wdParagraph, 7, wdExtend                     'zle,2008-9-22,|fffd||fffd|5 |fffd||133||fffd| 7
        'zle,2008-12-4,*2,|5e2||fffd||375||fffd||52d||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||2bd|
'        Selection.MoveUp wdParagraph, upDateCount, wdExtend
'        Selection.Delete

        Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKML").Start - 1, End:=Selection.Range.End)
        tempRange.Select
        tempRange.Delete
''        Selection.TypeBackspace
        If ActiveDocument.Bookmarks.Exists("BKQY") = False And ActiveDocument.Bookmarks.Exists("BKYY") = False Then
'            Selection.Delete
        End If
    End If
    
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd|
    Unload Me
'    total = 100000
    With frmUpDate
        .Show 0
    End With
    'zle,2008-10-16,+end

    'zle,2008-11-24,+begin,|fffd||fffd||fffd||fffd||4b3||fffd||fffd||fffd||2bd|
    If ActiveDocument.Bookmarks.Exists("BKQY") = False And ActiveDocument.Bookmarks.Exists("BKYY") = False Then
        Selection.Delete Unit:=wdCharacter, Count:=1
        ProcessFontPage
    End If
    'zle,2008-11-24,+end
    
    Selection.Style = ActiveDocument.Styles("|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|")
'    Selection.TypeText Text:="|13f|  |fffd||fffd|"
    Selection.TypeText Text:="|13f|"
    'zle,2008-10-10,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||13e||fffd||fffd||fffd|
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    
    Selection.HomeKey
    Selection.MoveRight , 1
    Selection.MoveRight wdSentence, 1, wdExtend

    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BKML"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.EndKey
    Selection.TypeParagraph
    ADstr = "TOC \h \z \t""" & ADstr & """"
    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:= _
        ADstr, PreserveFormatting:=True
    'zle,200-11-12,+4,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1bd||fffd||5b9||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveLeft wdCharacter, 1
    Selection.Fields.Locked = True
    Selection.EndKey
    'zle,09-06-08,+begin, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd|
'''    Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKML").Start + 4, End:=Selection.Range.End)
'''    tempRange.Select
''''    With tempRange.Font
''''        .NameFarEast = "|fffd||fffd||fffd||fffd|"
''''        .NameAscii = "Times New Roman"
''''        .NameOther = "Times New Roman"
''''        .Name = "Times New Roman"
''''    End With
''''zle,09-06-29,|fffd||fffd||fffd||fffd||fffd||5dbc||fffd||133||fffd||fffd||fffd||fffd||fffd|
'''    With tempRange.Font
'''        .NameFarEast = "|fffd||fffd||fffd||fffd|"
'''        .NameAscii = "|fffd||fffd||fffd||fffd|"
'''        .NameOther = "|fffd||fffd||fffd||fffd|"
'''        .Name = "|fffd||fffd||fffd||fffd|"
'''    End With
    'zle,09-06-08,+end
    
    Selection.MoveRight wdCharacter, 1

    Dim MCFld As Field
    If GStr <> "" Then
        GStr = "TOC \h \z \t""" & GStr & """"
        Selection.TypeParagraph
        Set MCFld = Selection.Fields.Add(Range:=Selection.Range, Type:=wdFieldEmpty, Text:= _
        GStr, PreserveFormatting:=True)
        'zle|fffd||fffd|2009-1-8|fffd||fffd|*4|5e2||fffd||375||fffd||fffd||fffd||fffd||fffd|
        If InStr(MCFld.Result, "|3b4||fffd||4b5||fffd||13f||bc||fffd||fffd|") <> 0 Then
            MCFld.Delete
            Selection.MoveLeft , 1
            Selection.Delete
        End If
    End If
    'zle,200-11-12,+1,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1bd||fffd||5b9||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveLeft , 1
    Selection.Fields.Locked = True
    Selection.MoveRight , 1
    'zle,2008-10-8,+begin,|fffd||fffd||fffd||4f1||fffd||fffd||fffd||13f||fffd||fffd|
    If Tble <> "" Then
        Tble = "TOC \h \z \t""" & Tble & """"
        Selection.TypeParagraph
        Set MCFld = Selection.Fields.Add(Range:=Selection.Range, Type:=wdFieldEmpty, Text:= _
        Tble, PreserveFormatting:=True)
        'zle|fffd||fffd|2009-1-8|fffd||fffd|*4|5e2||fffd||375||fffd||fffd||fffd||fffd||fffd|
        If InStr(MCFld.Result, "|3b4||fffd||4b5||fffd||13f||bc||fffd||fffd|") <> 0 Then
            MCFld.Delete
            Selection.MoveLeft , 1
            Selection.Delete
        End If
    End If
    'zle,2008-10-8,+end
    'zle,200-11-12,+1,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1bd||fffd||5b9||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.Fields.Locked = True
    
    
    'zle,2008-9-27,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  10-5
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With frmUpDate
        .Label3.Width = Int(86)
        .Label4.Caption = CStr(30) + "%"
        DoEvents
    End With
    'zle,2008-10-16,+end
    
    With ActiveDocument.Styles("|13f||bc| 1").ParagraphFormat
        .LineUnitBefore = 0.25
        .LineUnitAfter = 0.25
    End With
    
    With ActiveDocument.Styles("|13f||bc| 2").ParagraphFormat
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With
    
    With ActiveDocument.Styles("|13f||bc| 3").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0.18)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 1
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With
    
    ActiveDocument.Styles("|13f||bc| 3").NoSpaceBetweenParagraphsOfSameStyle = False
    
    With ActiveDocument.Styles("|13f||bc| 4").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0.35)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 2
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With

    With frmUpDate
        .Label3.Width = Int(115)
        .Label4.Caption = CStr(40) + "%"
        DoEvents
    End With
    
    With ActiveDocument.Styles("|13f||bc| 5").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0.53)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 3
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With

    
    With ActiveDocument.Styles("|13f||bc| 6").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0.71)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 4
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With

    With frmUpDate
        .Label3.Width = Int(144)
        .Label4.Caption = CStr(50) + "%"
        DoEvents
    End With
    
    With ActiveDocument.Styles("|13f||bc| 7").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0.89)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 5
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With

    With ActiveDocument.Styles("|13f||bc| 8").ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .Alignment = wdAlignParagraphLeft
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(1.07)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 6
        .LineUnitBefore = 0
        .LineUnitAfter = 0
    End With

    'zle,2008-9-27,+end
    
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With frmUpDate
        .Label3.Width = Int(172)
        .Label4.Caption = CStr(60) + "%"
        DoEvents
    End With
    'zle,2008-10-16,+end
    
''    'zle,2008-9-23,+begin,|2b9||4b3||fffd||fffd||fffd||4b6||fffd||fffd||fffd|


    With ActiveDocument
        ActiveDocument.Styles("|13f||bc| 1").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 1").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 2").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 2").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 3").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 3").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 4").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 4").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 5").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 5").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 6").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 6").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 7").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 7").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots
        ActiveDocument.Styles("|13f||bc| 8").ParagraphFormat.TabStops.ClearAll
        ActiveDocument.Styles("|13f||bc| 8").ParagraphFormat.TabStops.Add Position:=CentimetersToPoints(16.3), Alignment:=wdAlignTabRight, Leader:=wdTabLeaderDots

        If ActiveDocument.FormFields.Count > 10 Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
             ActiveDocument.Sections(1).ProtectedForForms = True
             For i = 2 To ActiveDocument.Sections.Count
                 ActiveDocument.Sections(i).ProtectedForForms = False
             Next
             ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
                 wdAllowOnlyFormFields
                 
            If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
                ClsEvent.CmdPROTECTC.FaceId = 277
                ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
            
        End If
    End With
''    'zle,2008-9-23,+end
    
    Selection.MoveLeft wdSentence, 4, wdExtend
    Selection.Font.Spacing = 0
    Selection.EndKey
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4ff||fffd||fffd||fffd||13f||fffd||3b8||fffd||2bd|
    
    '|fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd| |22b||fffd||1ff||578||fffd||fffd||fffd||fffd||fffd||435||13b||fffd||fffd||fffd||fffd||fffd||225||fffd||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd||fffd|"
        .Replacement.Text = ""
        .Forward = False
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    
    '|fffd||6efb||fffd||fffd||17a||fffd||fffd||fffd||130||fffd||1ff||578||fffd||3aa||22b||fffd||1ff||578||fffd|
    With ActiveDocument.Bookmarks
        .Add Name:="MCMW", Range:=Selection.Range
        .ShowHidden = True
        .DefaultSorting = wdSortByLocation
    End With
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With frmUpDate
        .Label3.Width = Int(200)
        .Label4.Caption = CStr(70) + "%"
        DoEvents
    End With
    'zle,2008-10-16,+end
    'zle,2008-11-12,+begin
    Dim strTemp As String
    strTemp = ""
    
    Do
       Selection.HomeKey
       Selection.MoveRight wdSentence, 1, wdExtend
       strTemp = Selection.Range.Text
       
       If InStr(strTemp, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||538||fffd||bc||fffd||fffd|") <> 0 Or InStr(strTemp, "|fffd||fffd||fffd||6df6||fffd||538||fffd||bc||fffd||fffd|") <> 0 Then
           Selection.HomeKey
           Selection.MoveRight wdCharacter, 4
           Selection.TypeBackspace
       End If
       
       Selection.MoveUp wdLine, 1
       
       If Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
            Exit Do
       End If
       
    Loop While Mid(strTemp, 1, 3) <> "|fffd||fffd||bc|A"
    
    Selection.GoTo what:=wdGoToBookmark, Name:="MCMW"
    With frmUpDate
        .Label3.Width = Int(258)
        .Label4.Caption = CStr(90) + "%"
        DoEvents
    End With
    'zle,2008-11-12,+end
    
    'zle,090807,+beign,|5bb||fffd||6efb||ff||fffd||435||fffd||4bb||fffd||fffd||fffd||fffd||1ff||578||fffd|
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting

    Do
        Selection.HomeKey
        Selection.MoveRight wdSentence, 1, wdExtend
        strTemp = Selection.Range.Text
        With Selection.Find
            .Text = " "                     '|fffd||fffd||1ff||578||fffd|
            .Replacement.Text = "|fffd||fffd|"        '|22b||fffd||1ff||578||fffd|
            .Forward = True
            .Wrap = wdFindStop
            .Format = False
            .MatchCase = False
            .MatchWholeWord = False
            .MatchByte = True
        End With
        Selection.Find.Execute Replace:=wdReplaceOne
        Selection.MoveUp wdLine, 1
        
    Loop While Selection.Style <> "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
    'zle,090807,+end

    If ActiveDocument.Bookmarks.Exists("MCMW") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="MCMW"
        ActiveDocument.Bookmarks("MCMW").Delete
    End If
    'zle,2008-10-16,+end
    
    InProcess = False
'    Unload Me
    'zle,2008-10-16,+begin,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With frmUpDate
        .Label3.Width = Int(285)
        .Label4.Caption = CStr(100) + "%"
        DoEvents
    End With
    Unload frmUpDate
    'zle,2008-10-16,+end
    'zle,2008-11-12,+1|fffd||fffd||fffd||fffd||fffd||4fd||fffd||5b9||fffd||fb||fffd||fffd||5b6||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd|
    Selection.Fields.Locked = True
End Sub

Private Sub LstContent_Change()
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4eef||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||4f5||fffd||461||fffd||fffd|
    '|fffd||fffd||fffd||fffd||fffd||fffd||6b4||fffd||fffd||fffd||fffd||3f1||fffd||fffd||4f5||fffd||fffd||fffd||fffd||fffd||423||fffd||fffd||fffd||4aa||fffd||6b4||fffd||fffd||fffd||fffd||3f1||fffd||fffd||4f5||38ec||fffd||fffd||fffd||fffd||fffd||fffd||46d||fffd||fffd|
    If Not InProcess Then
        Dim i As Integer
        For i = 0 To LstContent.ListCount - 1
            If LstContent.Selected(i) Then
                ProcessParent (i)
            End If
        Next
    End If
End Sub

Private Sub UserForm_Activate()

'|fffd||fffd||fffd||fffd||461||fffd||fffd|

    TxtSel.Text = "|1f0||fffd||521||fffd||fffd||fffd||fffd||521||fffd||fffd||b1||fffd||fffd||2862||fffd||fffd||bc||fffd||fffd|" & Chr(13) & "|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd|"
    InProcess = False
    '|368||fffd||fffd|a|fffd||fffd||5b5||fffd||fffd||237||fffd||fffd||fffd||fffd||fffd||4f9||fffd||3f5| ,|2ae||fffd||fffd||fffd||fffd||36c| |3aa||4bb||fffd||fffd||fffd||fffd||fffd||58ec||fffd||fffd||3bb||fffd||fffd||53d||fffd||f1cb7||fffd||53d||fffd||fffd|
    LstContent.AddItem "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(0) = 11
    LstContent.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(1) = 12
    LstContent.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(2) = 13
    LstContent.AddItem "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(3) = 14
    LstContent.AddItem "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(4) = 15
    LstContent.AddItem "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|"
    a(5) = 21
    LstContent.AddItem "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(6) = 22
    LstContent.AddItem "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(7) = 23
    LstContent.AddItem "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(8) = 24
    LstContent.AddItem "|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(9) = 25
    LstContent.AddItem "|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
    a(10) = 26
    LstContent.AddItem "|37c||fffd||fffd||fffd||fffd|"
    a(11) = 31
    LstContent.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
    a(12) = 41
    Dim RegStr As String
    RegStr = GetSetting("TCS", ActiveDocument.Name, "MC", "")
    If RegStr <> "" Then
        Dim i As Integer
        For i = 0 To LstContent.ListCount - 1
            If InStr(1, RegStr, Trim(str(i))) <> 0 Then
                LstContent.Selected(i) = True
            End If
        Next i
    End If
End Sub
Attribute VB_Name = "FrmEditFoot"
Attribute VB_Base = "0{160A3C05-7BD2-42CC-BB1F-C0A92F169297}{C9DE3BCF-587E-45C7-BC48-C11260EED7B7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim OriFoot As Integer
Dim IniLst As Boolean '|fffd||fffd||2bc||fffd||fffd||2b1||fffd||fffd||fffd||7b8||131||fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd|
Public AddFoot As Boolean
Dim Protected As Boolean
Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
    InProcess = True
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
        Protected = True
    Else
        Protected = False
    End If
    Dim i As Integer
    lstJZ.List(lstJZ.ListIndex) = TxtJZ.Text
    With ActiveDocument.Footnotes
        For i = 1 To .Count
            .Item(i).Range.Text = lstJZ.List(i - 1)
        Next i
    End With
    
    If Protected Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         ActiveDocument.Sections(1).ProtectedForForms = True
         For i = 2 To ActiveDocument.Sections.Count
             ActiveDocument.Sections(i).ProtectedForForms = False
         Next
         ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    InProcess = False
    Unload Me
End Sub

Private Sub lstJZ_Click()
    If IniLst Then
        Exit Sub
    End If
    If OriFoot <> -1 Then
        lstJZ.List(OriFoot) = TxtJZ.Text
    End If
    TxtJZ.Text = lstJZ.List(lstJZ.ListIndex)
    OriFoot = lstJZ.ListIndex
End Sub

Private Sub UserForm_Activate()
    Dim i As Integer
    IniLst = True
    OriFoot = -1
    With ActiveDocument.Footnotes
        For i = 1 To .Count
            lstJZ.AddItem .Item(i).Range.Text
        Next i
    End With
    IniLst = False
End Sub
Attribute VB_Name = "FrmFL"
Attribute VB_Base = "0{479C010D-B4D5-4AE6-A76A-E6EE5232A766}{98E42805-6765-4A7C-B1BA-5659BB32F28F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
    Dim MoveBK As String
    'zle,2008-8-27,*1,|5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fd|
    On Error GoTo errorhandle
    'zle,2008-8-27,+1|fffd||fffd||221||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|
'    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
'        ActiveDocument.Unprotect "zhangcheng"
'    End If
    
    InProcess = True
    'zle,2008-10-8,+begin,|fffd||b5||138||fffd||bc||fffd||fffd||fffd||fffd|
''        Selection.GoTo wdGoToLine, wdGoToLast
''        If ActiveDocument.Bookmarks.Exists("BKCKWX") Then
''            Selection.GoTo what:=wdGoToBookmark, Name:="BKCKWX"
''            Selection.HomeKey
''            Selection.MoveLeft , 1
''        Else
''            If ActiveDocument.Bookmarks.Exists("BKSY") Then
''                Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
''                Selection.HomeKey
''                Selection.MoveLeft , 1
''            Else
''                If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
''                    Selection.HomeKey
''                    Selection.MoveLeft , 1
''                    Selection.TypeParagraph
''                End If
''            End If
''        End If
''        Selection.EndKey
''        Selection.TypeParagraph
    'zle,2008-10-8,+end
    
    'zle,09-06-21,+begin
    If ActiveDocument.FormFields.Count > 10 Then
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.EndKey wdLine
        End If
    End If
    'zle,09-06-21,+end
    
    'zle,2008-10-8,*bgein,|5e2||fffd||375||fffd||52d||fffd||fffd||fffd||fffd||fffd||4f8||fffd||bc||fffd||137||fffd||2bd|
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = True
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    '|fffd||6b8||fffd||bc||fffd||43c||fffd||fffd||fffd||fffd|
        Selection.MoveLeft , 8
    Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Selection.GoTo wdGoToLine, wdGoToLast
        If ActiveDocument.Bookmarks.Exists("BKSY") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
            Selection.HomeKey
            Selection.MoveLeft , 1
        End If

        If ActiveDocument.Bookmarks.Exists("BKCKWX") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="BKCKWX"
            Selection.HomeKey
            Selection.MoveLeft , 1
        End If
    End If
    If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
        Selection.HomeKey
        Selection.TypeParagraph
        Selection.MoveLeft , 1
    Else
        Selection.EndKey
        Selection.TypeParagraph
    End If
    'zle,2008-10-8,*end
    

    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||37c||fffd||fffd||fffd|")
'    Selection.TypeText "|37c||fffd||fffd||fffd|"
    Selection.TypeParagraph
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd|")
'    Selection.TypeText "|fffd||fffd||fffd||fffd||fffd|"
    Selection.TypeParagraph
    
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
    
    
    Selection.TypeText Chr(11)
    If OptGF.Value Then
        Selection.TypeText "|fffd||fffd||fffd||6df6||fffd||538||fffd||bc||fffd||fffd|"
    Else
        Selection.TypeText "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||538||fffd||bc||fffd||fffd|"
    End If
    Selection.TypeText Chr(11)
    'zle,2008-10-8,*1,|5e2||fffd||375||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.TypeText txtTitle.Text
    
    'zle,2008-10-7,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd|
    Selection.TypeParagraph
'    Selection.MoveLeft wdCharacter, 1
'    'zle,2008-10-8,*1,|5e2||fffd||375||fffd||461||fffd||435||fffd||fffd||fffd||fffd||fffd|
'    Selection.HomeKey , Extend:=wdExtend
    
    Unload Me
    'zle,2008-9-24,+1,|fffd||fffd||fffd||436||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||739||fffd||fffd||fffd||2b1||fffd||f8||fffd||fffd||b8||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    UpdateFieldTCS
    Selection.GoTo what:=wdGoToBookmark, Name:="DW"
    ActiveDocument.Bookmarks("DW").Delete
    InProcess = False
    Exit Sub

errorhandle:
    InProcess = False
    Unload Me
    MsgBox "|fffd||fffd||fffd||fffd||fffd||6b1||f2d||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||fffd||bf6b||fffd||fffd||fffd||fffd||1b3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f8||fffd||bc|"
'
     
End Sub

Private Sub txtTitle_Change()
    If Trim(txtTitle.Text) <> "" Then
        CmdOK.Enabled = True
    Else
        CmdOK.Enabled = False
    End If
End Sub

Private Sub txtTitle_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = 13 Then
        cmdOk_Click
    End If
End Sub

Private Sub UserForm_Initialize()
    CmdOK.Enabled = False
    txtTitle.SetFocus
End Sub
Attribute VB_Name = "FrmFootType"
Attribute VB_Base = "0{7B8EB0C6-1364-4D1C-8B5F-9DB6CD61BB9D}{5349C165-3BE3-47CC-97BD-9680E935F428}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
    If OptAdd.Value Then
        FrmAddFoot.Show 1
    Else
        FrmEditFoot.Show 1
    End If
    Unload Me
End Sub
Attribute VB_Name = "FrmTable"
Attribute VB_Base = "0{B6631ACC-D7C7-431D-B3B5-2F25288A86FE}{64AB65F3-CB67-4D38-87F2-1B9480709EE0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
    If txtRow.Text = "" Or txtColumn.Text = "" Then
        MsgBox "|fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||b8e1|"
        Exit Sub
    End If
'    zle , 2008 - 8 - 6, +begin, |fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If IsNumeric(txtRow.Value) And IsNumeric(txtColumn.Value) Then
        g_rowNum = txtRow.Value
        g_columnNum = txtColumn.Value
        Unload Me
    Else
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        txtRow.Text = ""
        txtColumn.Text = ""
        Exit Sub
    End If
'    zle,2008-8-6,+end

End Sub

Private Sub txtColumn_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = 13 Then
        cmdOk_Click
    End If
End Sub

'zle,2008-9-21,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd|
Private Sub txtRow_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii <> 8 And KeyAscii <> 127 Then
        If KeyAscii < 48 Or KeyAscii > 57 Then
            KeyAscii = 0
        End If
    End If
End Sub
Private Sub txtColumn_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii <> 8 And KeyAscii <> 127 Then
        If KeyAscii < 48 Or KeyAscii > 57 Then
            KeyAscii = 0
        End If
    End If
End Sub

'zle,2008-9-21,+end

Private Sub UserForm_Activate()
    txtRow.Value = 6
    txtColumn.Value = 3
End Sub


Attribute VB_Name = "MdlTds"
Option Explicit
Global ShowTip As Boolean, OnePage As Boolean
Global ClsEvent As New ClsTds
Global ShpDT As Shape, ShpLB As Shape, ShpRQ As Shape
Global StdType As Integer '|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd|  0|fffd||fffd||fffd||fffd||fffd||2b1||fffd||5fc|  1|fffd||fffd||fffd||fffd||4b5||fffd||fffd||5fc| 2|fffd||fffd||fffd||637||fffd||fffd||fffd||5fc| 3|fffd||fffd||fffd||fffd||4b5||fffd||fffd||5fc|
Global InProcess As Boolean '|fffd||436||3f5||fffd||1f0||fffd||1f7||fffd||fffd||fffd||fffd||6bd||fffd||fffd||437||fffd||fffd||fffd||fffd||fffd||fffd||774||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||46d||fffd||fffd|
Global OriFldName As String '|52d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||fffd||133||fffd||fffd||fffd||fffd||2a7||225||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||e3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|OriFldName |fffd||fffd||5a4||fffd||fffd|OriFldName|2a7||225||fffd||fffd||fffd||fffd|    OriFld|2a7||225||fffd||fffd||fffd||fffd|
'zle,2008-7-23,+2|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Global g_rowNum As Integer
Global g_columnNum As Integer
'zle,2008-7-23,+begin|fffd||fffd||fffd||fffd||fffd||fffd||2e1||fffd||fffd||5e1||fffd||fffd||130||fffd||165|
Global g_SLFirst As Integer
Global g_ZhuFirst As Integer
Global g_ZMFirst As Integer
Global g_SZFirst As String
'zle,2008-10-4,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Global g_IndexText As String
Global g_MarkOrAll As Integer
Global g_strTitle As String
Global g_MC_Count As Integer         '|fffd||fffd||fffd||fffd||fffd||fffd||2b6||13f||fffd||3b8||fffd||fffd||b5||134||fffd||fffd||fffd|
Global g_SYGS As String
Global g_DelIndex As Integer
Global g_DelIndexText As String
Global g_FindCount As Integer

Option Base 1
'zle,09-6-16, +|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||1e79||fffd||fffd|
Private Type StrType
    strLetter As String
    strFirCharacter As String
End Type

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||2f5||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertMenu()

    Dim cmbNewMenu As CommandBar         '|fffd||536||fffd||fffd||fffd||2f5||fffd|
    Dim cmbNewBar_YS As CommandBar       '|fffd||fffd||4bb||fffd||437||fffd||fffd||fffd|"|fffd||fffd||5fc||4aa||fffd||fffd|"|fffd||fffd||772||2f5||fffd|
    Dim cmbNewBar_CB As CommandBar       '|fffd||6b6||fffd||fffd||437||fffd||fffd||fffd|"|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|"|fffd||fffd||772||2f5||fffd|
    Dim cmbNewBar_YY As CommandBar       '|fffd||fffd||fffd||fffd||fffd||437||fffd||fffd||fffd|"|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|"|fffd||fffd||772||2f5||fffd|
    
    Dim ctlPopup As CommandBarPopup
    Dim Cmd As CommandBarButton

    Dim StartStatus As String
    OriFldName = ""
    StartStatus = GetSetting("TCS", "StartControl", "Status", "End")
    StartStatus = "Start"
    If StartStatus = "End" Then
        MsgBox "|fffd||13c||fffd||fffd||fffd||fffd||735||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    End If
    'zle,2008-8-5,+1|fffd||fffd||fffd||336||fffd||fffd||2f5||fffd|
    'zle,090705,*1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||43b||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If Application.Version <> "12.0" Then
        CustomizationContext = ActiveDocument.AttachedTemplate
    End If
    
    Set cmbNewMenu = ActiveDocument.CommandBars("Menu Bar")
    'zle,2008-9-28,+3,|fffd||fffd||fffd||fffd||fffd||7b8||132||2f5||fffd|
    With cmbNewMenu
        .Protection = msoBarNoProtection
    End With
    
    '|fffd||fffd||fffd||fffd||1f0||fffd||fffd||27e||fffd||fffd||52d||fffd||fffd||fffd||132||2f5||fffd|
    For Each ctlPopup In cmbNewMenu.Controls
        If ctlPopup.Caption = "|4aa||fffd||63c||fffd||fffd||170||fffd|" Or ctlPopup.Caption = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|" Or ctlPopup.Caption = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|" Or ctlPopup.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            ctlPopup.Delete
        End If
    Next
    
    '|fffd||fffd||fffd||fffd||1f0||fffd||fffd||27e||fffd||fffd||52d||fffd||fffd||fffd||2f5||fffd||fffd||fffd||4e6||fffd||13f||fffd||770||fffd||165|
    For Each cmbNewBar_YY In CommandBars
        If cmbNewBar_YY.Name = "|4aa||fffd||63c||fffd||fffd||170||fffd|" Or cmbNewBar_YY.Name = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|" Or cmbNewBar_YY.Name = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|" Then
            cmbNewBar_YY.Delete
        End If
    Next
    
    '|fffd||fffd||fffd||4f2||2f5||fffd||fffd||fffd||4e6||fffd||13f||fffd||770||fffd||165|
    Set cmbNewBar_YS = ActiveDocument.CommandBars.Add(Name:="|4aa||fffd||63c||fffd||fffd||170||fffd|", temporary:=True)
    Set cmbNewBar_CB = ActiveDocument.CommandBars.Add(Name:="|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|", temporary:=True)
    Set cmbNewBar_YY = ActiveDocument.CommandBars.Add(Name:="|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|", temporary:=True)
    
'|fffd||fffd||4bb||fffd||fffd||fffd||2f5||fffd|

    With cmbNewMenu.Controls
        Set ctlPopup = .Add(Type:=msoControlPopup, Before:=1, temporary:=True)
        With ctlPopup
            .Caption = "|4aa||fffd||63c||fffd||fffd||170||fffd|"
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd|"
                .FaceId = 218
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdFm = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|13f||fffd||fffd|"
                .FaceId = 195
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdMc = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|1f0||fffd||fffd|"
                .FaceId = 302
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdQy = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd|"
                .FaceId = 2562
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdYy = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||bc|"
                .FaceId = 13
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdFl = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||3bf||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 250
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdCk = Cmd
                
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd|"
                .FaceId = 9190
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSy = Cmd    '|fffd||fffd||272||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||fffd||372||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||139||fffd||fffd||fffd|
            
            Set Cmd = .Controls.Add
            With Cmd
               .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
               .FaceId = 1087
               .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdBJSYX = Cmd

            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 1088
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSCSY = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = False
                .Caption = "|2eb||fffd||fffd||fffd||170||fffd|"
                .FaceId = 7698
                .Style = msoButtonIconAndCaption
                .BeginGroup = True
                .State = msoButtonUp
            End With
            Set ClsEvent.CmdTwoPage = Cmd
     
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = False
                .Caption = "|fffd||fffd||4e1||524||fffd||fffd|"
                .FaceId = 109
                .Style = msoButtonIconAndCaption
                .State = msoButtonUp
            End With
            Set ClsEvent.CmdPrtPreview = Cmd
            
            'zle,09-06-18,*|fffd||fffd||434||fffd||fffd||fffd||fffd||5e2||fffd||375||fffd|
'            Set Cmd = .Controls.Add
'            With Cmd
'                .Caption = "|fffd||fffd||434||fffd||fffd||fffd||fffd|"
'                .FaceId = 286
'                .Style = msoButtonIconAndCaption
'            End With
'            Set ClsEvent.CmdGZ = Cmd
            'zle,09-06-26,+,|fffd||fffd||fffd||fffd| "|fffd||fffd||4e1|" |fffd||fffd||165|
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = False
                .Caption = "|fffd||fffd||4e1|"
                .FaceId = 2521
                .Style = msoButtonIconAndCaption
'                .State = msoButtonUp
            End With
            Set ClsEvent.CmdPRINT = Cmd
            
            'zle,090702,+|fffd||fffd||fffd||4f1||fffd||fffd||fffd||fffd||37d||2c63||fffd||fffd|
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = True
                .Caption = "|fffd||fffd||fffd||fffd|TCS|fffd||13c||fffd|"
                .FaceId = 225
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdPROTECT = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = False
                .Caption = "|221||fffd||fffd|TCS|fffd||13c||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 277
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdUNPROTECT = Cmd
     
        End With
    End With
'|fffd||fffd||4bb||fffd||fffd||fffd||2f5||fffd||fffd||13f||fffd||770||fffd||165|
    With cmbNewBar_YS
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 218
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdFmC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|13f||fffd||fffd|"
            .FaceId = 195
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdMcC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|1f0||fffd||fffd|"
            .FaceId = 302
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdQyC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 2562
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdYyC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||bc|"
            .FaceId = 13
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdFlC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||3bf||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 250
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdCkC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 9190
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdSyC = Cmd   '|fffd||fffd||272||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||fffd||372||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||775||139||fffd||fffd||fffd|'''''''''''''''''''''''''
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 1087
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdBJSYXC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 1088
            .Style = msoButtonIconAndCaption
            .TooltipText = "|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdSCSYC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
             .Caption = "|2eb||fffd||fffd||fffd||170||fffd|"
             .FaceId = 7698
             .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdTwoPageC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||4e1||524||fffd||fffd|"
            .FaceId = 109
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdPrtPreviewC = Cmd
        'zle,09-06-18,*|fffd||fffd||434||fffd||fffd||fffd||fffd|
'        Set Cmd = .Controls.Add
'        With Cmd
'            .Caption = "|fffd||fffd||434||fffd||fffd||fffd||fffd|"
'            .FaceId = 286
'            .Style = msoButtonIconAndCaption
'        End With
'        Set ClsEvent.CmdGZC = Cmd

        'zle,09-06-26,+|fffd||fffd||fffd||fffd| "|fffd||fffd||4e1|"|fffd||fffd||770||fffd||165|
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||4e1|"
            .FaceId = 2521
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdPRINTC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||135||fffd|"
            .FaceId = 225
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdPROTECTC = Cmd
        
    End With

'|fffd||6b6||fffd||fffd||fffd||fffd||2f5||fffd|
    With cmbNewMenu.Controls
        Set ctlPopup = .Add(Type:=msoControlPopup, Before:=2, temporary:=True)
        With ctlPopup
            .Caption = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|"
            
            Set Cmd = .Controls.Add
            With Cmd
                .BeginGroup = False
                .Caption = "|fffd||b1||fffd||fffd||fffd|"
                .FaceId = 5795
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZtitle = Cmd
            
'            Set ctlPopup = .Controls.Add(Type:=msoControlPopup, temporary:=True)
'            With ctlPopup
'                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
                
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 71
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle1 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 72
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle2 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 73
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle3 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 74
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle4 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 75
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle5 = Cmd
'            End With
            
'            Set ctlPopup = .Controls.Add(Type:=msoControlPopup, temporary:=True)
'            With ctlPopup
'                .Caption = "|fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
                
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||7b1||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|"
                 .FaceId = 490
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle1F = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||7b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 491
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle2F = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||7b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 492
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle3F = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||7b1||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd|"
                .FaceId = 493
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle4F = Cmd
        
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||7b1||fffd||fffd||fffd||fffd||5f36||fffd||fffd|"
                .FaceId = 494
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTTitle5F = Cmd
'            End With
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd|"
                .FaceId = 779
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdD = Cmd
            
'            Set ctlPopup = .Controls.Add(Type:=msoControlPopup, temporary:=True)
'            With ctlPopup
'                .Caption = "|fffd||fffd||fffd||fffd|"
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||e86a||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|"
                .FaceId = 56
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx1 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 3793
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx2 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 439
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx3 = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
                .FaceId = 405
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx4 = Cmd

            Set Cmd = .Controls.Add
            With Cmd
               .Caption = "|fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
               .FaceId = 309
               .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx41 = Cmd

            
            Set Cmd = .Controls.Add
             With Cmd
                .Caption = "|fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 11
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx5 = Cmd
                      
            Set Cmd = .Controls.Add
             With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 503
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdLx6 = Cmd
'             End With
             
        End With
    End With
    
'|fffd||6b6||fffd||fffd||fffd||fffd||2f5||fffd||fffd||13f||fffd||770||fffd||165|
    With cmbNewBar_CB
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd|"
            .FaceId = 5795
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||b1||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdZtitleC = Cmd

        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||4bb|"
            .FaceId = 71
            .Style = msoButtonIconAndCaption
            .TooltipText = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle1C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 72
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle2C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 73
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle3C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 74
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle4C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 75
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle5C = Cmd
        
        If Application.Version = "11.0" Then
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||4bb|"
                .FaceId = 490
                .Style = msoButtonIconAndCaption
                .TooltipText = "|4bb||fffd||fffd||fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
            End With
            Set ClsEvent.CmdTTitle1FC = Cmd
        End If
        
        'zle,090705,+3|fffd||fffd||fffd||7b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 491
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle2FC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 492
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle3FC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 493
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||13c||fffd||fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle4FC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 494
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||5f36||fffd||7b1||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdTTitle5FC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd|"
            .FaceId = 779
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||136||fffd|"
        End With
        Set ClsEvent.CmdDC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||4bb|"
            .FaceId = 56
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||e86a||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdLx1C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd|"
            .FaceId = 3793
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdLx2C = Cmd
        
        If Application.Version = "11.0" Then
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd|"
                .FaceId = 439
                .Style = msoButtonIconAndCaption
                .TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            End With
            Set ClsEvent.CmdLx3C = Cmd
        End If
                
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||138||fffd||fffd|"
            .FaceId = 405
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdLx4C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||138||fffd||fffd|"
            .FaceId = 309
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdLx41C = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 11
            .Style = msoButtonIconAndCaption
            .TooltipText = "|fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
        End With
        Set ClsEvent.CmdLx5C = Cmd
        
'        Set Cmd = .Controls.Add
'        With Cmd
'            .Caption = "|fffd||fffd||fffd||fffd||fffd|"
'            .FaceId = 503
'            .Style = msoButtonIconAndCaption
'            .TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
'        End With
'        Set ClsEvent.CmdLx6C = Cmd
        
    End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f5||fffd|
    With cmbNewMenu.Controls
        Set ctlPopup = .Add(Type:=msoControlPopup, Before:=3, temporary:=True)
        With ctlPopup
            .Caption = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|"
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|2be||fffd||fffd|"
                .FaceId = 4881
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSl = Cmd
             
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|2be||fffd||fffd||fffd||fffd|"
                .FaceId = 3715
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdDSl = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||2be||fffd||fffd||fffd||fffd|"
                .FaceId = 4207
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSSl = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|2be||fffd||fffd||fffd||fffd||fffd||fffd|"
                If Application.Version = "11.0" Then
                    .FaceId = 44
                Else
                    .FaceId = 756
                End If
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSLCONT = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||5e2|"
                .FaceId = 245
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZWZ = Cmd
                        
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||5e2||fffd||fffd|"
                .FaceId = 9466
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZWZZ = Cmd
            
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd|"
                .FaceId = 1547
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZWZZF = Cmd
               
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|37c||fffd||fffd||5e2|"
                .FaceId = 2114
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZ = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|37c||fffd||fffd||5e2||fffd||fffd|"
                .FaceId = 586
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZZ = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||37c||fffd||fffd||5e2||fffd||fffd|"
                .FaceId = 1094
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdZZF = Cmd

            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||13d||fffd||5e2|"
                .FaceId = 260
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdJZ = Cmd
             
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|37c||fffd||fffd||fffd||fffd||5e2|"
                .FaceId = 9947
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTBJZSM = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||37c||fffd||fffd||5e2|"
                .FaceId = 4210
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSTBJZSM = Cmd
             
             
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|37c||fffd||fffd||fffd||fffd|"
                .FaceId = 1363
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGTitle = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 1751
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdTabTitle = Cmd

            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                .FaceId = 2059
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdSjTable = Cmd
             


            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||be6b||2bd|"
                .FaceId = 226
                .BeginGroup = True
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGS = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||2bd||fffd||fffd||fffd|"
                .FaceId = 4170
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGsGs = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||fffd||b9||fffd||2bd||fffd||fffd||fffd|"
                .FaceId = 1020
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGXGs = Cmd
            
        End With
    End With
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||13f||fffd||777||fffd||2bd|
    With cmbNewBar_YY
    
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd|"
            .FaceId = 4881
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdSlC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 3715
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdDSlC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            .FaceId = 4207
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdSSlC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|5e2|"
            .FaceId = 245
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZWZC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|5e2||fffd||fffd|"
            .FaceId = 9466
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZWZZC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||5e2||fffd||fffd|"
            .FaceId = 1547
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZWZZFC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|37c||fffd||fffd||5e2|"
            .FaceId = 2114
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|37c||fffd||fffd||5e2||fffd||fffd|"
            .FaceId = 586
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZZC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||37c||fffd||fffd||5e2||fffd||fffd|"
            .FaceId = 1094
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdZZFC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||5e2|"
            .FaceId = 260
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdJZC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|37c||fffd||fffd||fffd||fffd||5e2|"
            .FaceId = 9947
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdTBJZSMC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||37c||fffd||fffd||5e2|"
            .FaceId = 4210
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdSTBJZSMC = Cmd
        
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|37c||fffd||fffd|"
            .FaceId = 1363
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdGTitleC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 1751
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdTabTitleC = Cmd
        
        Set Cmd = .Controls.Add
        With Cmd
            .Caption = "|fffd||fffd||fffd||fffd|"
            .FaceId = 2059
            .Style = msoButtonIconAndCaption
        End With
        Set ClsEvent.CmdSjTableC = Cmd
        
        If Application.Version = "11.0" Then
             Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||2bd|"
                .FaceId = 226
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGSC = Cmd
            
            Set Cmd = .Controls.Add
            With Cmd
                .Caption = "|fffd||fffd||2bd||fffd||fffd||fffd|"
                .FaceId = 4170
                .Style = msoButtonIconAndCaption
            End With
            Set ClsEvent.CmdGsGsC = Cmd
        End If
        
    End With

     
     'zle,09-06-04,+begin,|fffd||436||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||2f6||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e3||fffd||fffd||fffd||27e||fffd||fffd||1f0||fffd||6f38||fffd||fffd||fffd||fffd||5bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||2f5||fffd|
     Dim iMenuCount As Integer
     Dim iNum As Integer
     iMenuCount = 0
     iNum = 0
     For Each ctlPopup In cmbNewMenu.Controls
        If ctlPopup.Caption = "|4aa||fffd||63c||fffd||fffd||170||fffd|" Then
            iMenuCount = iMenuCount + 1
        End If
    Next
    '|fffd||fffd||fffd|imenucount>1|2b1||fffd||fffd||2f5||fffd||fffd||fffd||436||fffd||fffd||fffd||638||fffd||fffd||132||2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd|
    If iMenuCount > 1 Then
    
        For Each ctlPopup In cmbNewMenu.Controls
            If ctlPopup.Caption = "|4aa||fffd||63c||fffd||fffd||170||fffd|" And iMenuCount > 1 Then
                ctlPopup.Delete
                iMenuCount = iMenuCount - 1
            End If
            If iNum <= 1 Then
                If iMenuCount >= 1 Then
                    If ctlPopup.Caption = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|" Or ctlPopup.Caption = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|" Then
                        ctlPopup.Delete
                    End If
                    If iMenuCount = 1 Then
                        iNum = iNum + 1
                    End If
                End If
            End If
        Next
        
    End If

    With cmbNewMenu
        .Protection = msoBarNoCustomize
    End With
    
     With cmbNewBar_YS
        .Protection = msoBarNoCustomize
        .Position = msoBarTop
        .Visible = True
    End With
    With cmbNewBar_CB
        .Protection = msoBarNoCustomize
        .Position = msoBarTop
        .Visible = True
    End With
    
    With cmbNewBar_YY
        .Protection = msoBarNoCustomize
        .Position = msoBarTop
        .Visible = True
    End With
    '|fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'zle,2008-11-7,|fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||631||fffd||1e1||fffd|
    If ActiveWindow.ActivePane.View.ShowAll = True Then
        ActiveWindow.ActivePane.View.ShowAll = False
    End If
    'zle,09-06-19,|fffd||436||3f0||6c7e||fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
    If Application.Version <> "12.0" Then
'        ActiveWindow.View.ShowParagraphs = False       '|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
'    Else
        ActiveWindow.View.ShowParagraphs = True
    End If
    
    'zle,090705,+|fffd||fffd||2b1||fffd||fffd||fffd||437||fffd||fffd||68ec||fffd||fffd||2be||fffd||fffd||fffd||fffd|
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    End If
'    zle,09-06-20,+1,|fffd||fffd||fffd||4f2||2f5||fffd||fffd||f18f4||fffd||fffd||135||fffd|
    ActiveDocument.Saved = True
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||2be|
Sub ProgEntry(ShowStr As String)
    On Error Resume Next
    Dim bln As Balloon
    Dim fld As Range
    Dim lf As Long, lr As Long, lw As Long, lh As Long
    If ShowTip Then
        Set fld = Selection.Range
        Call ActiveWindow.GetPoint(lf, lr, lw, lh, fld)
        Assistant.Left = lf
        Assistant.Top = lr - 150
        Set bln = Assistant.NewBalloon
        bln.Heading = "|fffd||fffd||5fc||fffd||fffd||434||fffd||fffd||2be|"
        bln.Text = ShowStr
        bln.Mode = msoModeAutoDown
        bln.Show
    End If
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be|
'==Para:
'==Return:
'==Designer:
'==Created:
'==Updated:
'== Update 1:
'=============================================================================

Sub ShowHelp1()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd|ICS|fffd||163||fffd|"
End Sub
Sub ShowHelp2()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||5f7||fffd||fffd||fffd||163||fffd|"
End Sub
Sub ShowHelp3()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||163||fffd| "
End Sub
Sub ShowHelp4()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||163||fffd| "
End Sub
Sub ShowHelp5()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1a3||fffd| "
End Sub
Sub ShowHelp6()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||4e2||fffd||fffd||fffd||fffd||fffd||1a3||fffd| "
End Sub
Sub ShowHelp7()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||5fc||4bb||fffd||fffd||fffd||533||336||235||631||fffd||2b6||fffd||fffd| "
End Sub
Sub ShowHelp8()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||bde2||fffd||fffd||fffd||fffd||fffd||6a3||fffd| "
End Sub
Sub ShowHelp9()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||2b5||2a9||fffd||fffd||fffd||6a3||fffd| "
End Sub
Sub ShowHelp10()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd||fffd||163||fffd| "
End Sub
Sub ShowHelp11()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||1a3||fffd| "
End Sub
Sub ShowHelp12()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||637||fffd||fffd||fffd||fffd||1a3||fffd| "
End Sub
Sub ShowHelp13()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||1a3||fffd| "
End Sub
Sub ShowHelp14()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||5fc||fffd||fffd||163||fffd| "
End Sub
Sub ShowHelp15()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||5fc||fffd||fffd||2b6|"
End Sub
Sub ShowHelp16()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||637||fffd||fffd||fffd||5fc||fffd||fffd||2b6|"
End Sub
Sub ShowHelp17()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||fffd||5fc||fffd||fffd||2b6|"
End Sub
Sub ShowHelp18()
    ProgEntry "|fffd||fffd||fffd||fffd||fffd||fffd||637||fffd||fffd||fffd||5fc||fffd||fffd||2b6|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFM()
    Dim shp As Shape
    Dim fld As FormField
    Dim StartStatus As String
    'zle,2008-11-7,|fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||631||fffd||1e1||fffd|
    If ActiveWindow.ActivePane.View.ShowAll = True Then
        ActiveWindow.ActivePane.View.ShowAll = False
    End If
    'zle,2008-12-22,|fffd||f9||fffd||fffd||fffd||3bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd|
    ActiveWindow.View.SeekView = wdSeekMainDocument
    InProcess = True
    StartStatus = GetSetting("TCS", "StartControl", "Status", "End")

    StartStatus = "Start"
    If StartStatus = "End" And ActiveDocument.Name <> "TCS.SYS" Then
        MsgBox "|fffd||13c||fffd||fffd||fffd||fffd||735||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical
        Exit Sub
    End If
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
    End If
    Selection.GoTo wdGoToPage, wdGoToFirst
    Selection.InsertBreak Type:=wdSectionBreakNextPage
    Selection.GoTo wdGoToPage, wdGoToFirst
    ActiveDocument.Sections(2).Headers(wdHeaderFooterPrimary).LinkToPrevious = False
    'zle,2009-5-17,+1,|fffd||fffd||fffd||fffd||fffd||6b6||3ff||fffd||fffd||377||fffd||fffd||fffd||fffd||4b3||fffd||fffd||fffd||fffd||fffd||fffd|
    'zle,090714,*1
'    ActiveDocument.Sections(2).Footers(wdHeaderFooterPrimary).LinkToPrevious = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||77e||da5||fffd||fffd||fffd||fffd||3aa|10mm
    With Selection.PageSetup
        .TopMargin = MillimetersToPoints(10)
        .RightMargin = MillimetersToPoints(15)
        .FooterDistance = 0
        .HeaderDistance = 0
    End With
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fc||4b3||fffd||fffd|
    With ActiveDocument.Sections(1)
        .Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fc||4bb|")
        .Headers(wdHeaderFooterPrimary).Range.Text = ""
        'zle,2009-5-17,+1,|fffd||fffd||fffd||fffd||4bb||fffd||6b5||fffd||4b3||fffd||fffd||fffd||fffd||fffd||f3||27f||fffd|
        .Footers(wdHeaderFooterPrimary).Range.Text = ""
    End With
    Selection.TypeText Text:="ICS"
    Selection.ParagraphFormat.Alignment = wdAlignParagraphLeft
    'zle,2008-10-10,+1,|fffd||fffd||fffd||4f0||fffd||fffd||fffd||fffd||fffd||5b5||13e||fffd||fffd||fffd|
    Selection.InsertSymbol CharacterNumber:=8194, Unicode:=True, Bias:=0
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "ICS"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd|ICS|fffd||163||fffd|"
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||fffd|ICS|fffd||fffd|", Format:=""
            .Width = 0
        End With
    End With
    Selection.EndKey
    Selection.TypeParagraph
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "WXFLH"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||5fc||fffd||fffd||fffd||5f7||fffd||fffd||fffd||163||fffd|"
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||fffd||fffd||439||fffd||fffd||fffd||5fc||fffd||fffd||fffd||5f7||fffd||fffd||fffd||fffd|", Format:=""
            .Width = 0
        End With
    End With
    Selection.EndKey
    If StdType > 0 Then
        Selection.TypeParagraph
        'zle,2008-9-2,+begin,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||171||fffd||fffd||fffd||fffd||fffd|
        ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
        1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
        wdAutoFitFixed
        With Selection.Tables(1)
            If .Style <> "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
                .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
            .ApplyStyleHeadingRows = True
            .ApplyStyleLastRow = False
            .ApplyStyleFirstColumn = True
            .ApplyStyleLastColumn = False
        End With
        Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
        'zle,2008-9-2,+end
        'zle,2008-11-24,*1
'        Selection.TypeText Text:="|fffd||fffd||fffd||fffd||fffd||fffd|"
        Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
            wdFieldFormTextInput)
            With fld
            .Name = "BAH"
            .Enabled = True
            .OwnHelp = False
            .HelpText = ""
            .OwnStatus = True
           End With
           
        'zle,2008-9-2,|5e2||fffd||375||fffd||4bb||fffd||fffd||fffd||633||fffd|
''        Selection.TypeParagraph
        
        Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
        Selection.MoveUp Unit:=wdLine, Count:=2, Extend:=wdExtend
    Else
        Selection.TypeParagraph
        Selection.HomeKey Unit:=wdLine, Extend:=wdExtend
        Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
    End If
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||5f7||fffd||fffd||fffd||fffd|")
    Selection.MoveDown Unit:=wdLine, Count:=1
    
    'zle,090708,+begin,|fffd||7b8||fffd||fffd||fffd||fffd||fffd|
    If StdType = 0 Then
        Selection.MoveLeft , 1
        Selection.HomeKey
        Selection.MoveUp wdLine, 1
    Else
        Selection.MoveLeft , 2
        Selection.MoveUp wdLine, 2
        Selection.HomeKey
    End If
    Selection.MoveRight wdCharacter, 3, wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "Times New Roman"
        .NameOther = "Times New Roman"
        .Name = "Times New Roman"
    End With
   
    Selection.EndKey
    If StdType = 0 Then
        Selection.MoveDown wdLine, 1
        Selection.EndKey
        Selection.MoveRight , 1
    Else
        Selection.MoveDown wdLine, 3
    End If
    'zle,090708,+end,
    
    Selection.TypeParagraph
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
'|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||2b6|
    Select Case StdType
        Case 0
         '|fffd||fffd||fffd||4b1||fffd||5fc|
            GBTag
        Case 1
        '|fffd||fffd||4b5||fffd||fffd||5fc|
            HBTag
        Case 2
        '|fffd||637||fffd||fffd||fffd||5fc|
            DBTag
        Case 3
        '|fffd||637||fffd||fffd||fffd||5fc|
            QBTag
    End Select
   
    '|fffd||fffd||5fc||fffd||fffd||fffd|
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd|2")
    If StdType = 0 Then
        Selection.TypeText Text:="GB/T"
        
        'zle,090708,+8,|fffd||7b8||fffd||fffd||fffd||fffd||fffd|
        Selection.MoveLeft , 4, wdExtend
        With Selection.Font
            .NameFarEast = "|fffd||fffd||fffd||fffd|"
            .NameAscii = "Times New Roman"
            .NameOther = "Times New Roman"
            .Name = "Times New Roman"
        End With
        Selection.MoveRight , 1
        
    ElseIf StdType = 2 Then
        Selection.TypeText Text:="DB "
        'zle,090804,+8,|fffd||7b8||fffd||fffd||fffd||fffd||fffd|
        Selection.MoveLeft , 3, wdExtend
        With Selection.Font
            .NameFarEast = "|fffd||fffd||fffd||fffd|"
            .NameAscii = "Times New Roman"
            .NameOther = "Times New Roman"
            .Name = "Times New Roman"
        End With
        Selection.MoveRight , 1
        Selection.Font.Name = "|fffd||fffd||fffd||fffd|"
    ElseIf StdType = 3 Then
        Selection.TypeText Text:="Q/"
    End If
    
    If StdType <> 0 Then
        Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
            wdFieldFormTextInput)
        With fld
            .Name = "StdNo0"
            .ExitMacro = ""
            .Enabled = True
            .OwnHelp = False
            .HelpText = ""
            .OwnStatus = True
            With .TextInput
                If StdType = 1 Then
                    .EditType Type:=wdRegularText, Default:="XX", Format:=""
                    .Width = 2
                     Selection.EndKey
                ElseIf StdType = 2 Then
                    .EditType Type:=wdRegularText, Default:="XX", Format:=""
                    .Width = 2
                     Selection.EndKey
                ElseIf StdType = 3 Then
                    .EditType Type:=wdRegularText, Default:="XXX", Format:=""
                    .Width = 0
                     Selection.EndKey
                End If
            End With
        End With
    End If
    
    If StdType = 0 Then
        Selection.TypeText Text:=" "
        'zle,090708,+4|fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd|
        With Selection.Font
            .NameFarEast = "|fffd||fffd||fffd||fffd|"
            .NameAscii = "|fffd||fffd||fffd||fffd|"
        End With
    ElseIf StdType = 1 Then
        Selection.TypeText Text:="/T "
        'zle,090804,+8,|fffd||7b8||fffd||fffd||fffd||fffd||fffd|
        Selection.MoveLeft , 4, wdExtend
        With Selection.Font
            .NameFarEast = "|fffd||fffd||fffd||fffd|"
            .NameAscii = "Times New Roman"
            .NameOther = "Times New Roman"
            .Name = "Times New Roman"
        End With
        Selection.MoveRight , 1
        Selection.Font.Name = "|fffd||fffd||fffd||fffd|"
    ElseIf StdType = 2 Then
        Selection.TypeText Text:="/ "
    ElseIf StdType = 3 Then
        'zle,090804,+8,|fffd||7b8||fffd||fffd||fffd||fffd||fffd|
        Selection.MoveLeft , 5, wdExtend
        With Selection.Font
            .NameFarEast = "|fffd||fffd||fffd||fffd|"
            .NameAscii = "Times New Roman"
            .NameOther = "Times New Roman"
            .Name = "Times New Roman"
        End With
        Selection.MoveRight , 1
        Selection.Font.Name = "|fffd||fffd||fffd||fffd|"
        Selection.TypeText Text:=" "
    End If
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "StdNo1"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
'            If StdType = 0 Then
                .EditType Type:=wdRegularText, Default:="XXXXX", Format:=""
                .Width = 0 '5
                Selection.EndKey
'            ElseIf StdType = 1 Then
'                .EditType Type:=wdRegularText, Default:="XXXX", Format:=""
'                .Width = 4
'                 Selection.EndKey
'            ElseIf StdType = 2 Then
'                .EditType Type:=wdRegularText, Default:="XXX", Format:=""
'                .Width = 3
'                 Selection.EndKey
'            ElseIf StdType = 3 Then
'                .EditType Type:=wdRegularText, Default:="XXXX", Format:=""
'                .Width = 4
'                 Selection.EndKey
'            End If
        End With
    End With
    'zle,090802,*|fffd||fffd||5e2||fffd||375||fffd||52d||fffd||fffd||fffd||13a||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Selection.InsertSymbol CharacterNumber:=9472, Unicode:=True
'    'zle,09-06-21,+5,|fffd||7b8||13a||fffd||fffd||fffd||32b||fffd||fffd||fffd||fffd||fffd||fffd|
'    Selection.MoveLeft , 1, wdExtend
'    Selection.Font.Name = "|fffd||fffd||fffd||fffd|"
'    Selection.Font.NameFarEast = "|fffd||fffd||fffd||fffd|"
'    Selection.Font.NameAscii = "Times New Roman"
'    Selection.MoveRight , 1
'
'    'zle,09-06-26,+3,|fffd||fffd||fffd||fffd||fffd||fffd||133||27a||fffd||fffd||fffd|
'    Selection.Font.Name = "|fffd||fffd||fffd||fffd|"
'    Selection.Font.NameFarEast = "|fffd||fffd||fffd||fffd|"
'    Selection.Font.NameAscii = "|fffd||fffd||fffd||fffd|"
    
    'zle,090802|fffd||fffd|+1
    Selection.TypeText Text:="|fffd||fffd|"
    
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "StdNo2"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XXXX", Format:=""
            .Width = 4
        End With
    End With
    Selection.EndKey
    Selection.TypeParagraph
    
    'zle,2008-9-2,+begin,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||174||fffd||fffd||fffd|
    ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
    1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
    wdAutoFitFixed
    With Selection.Tables(1)
        If .Style <> "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = False
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = False
    End With
    
        Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    'zle,2008-9-2,+end
    'zle,2008-11-24,*1
'    Selection.TypeText Text:="|fffd||fffd||fffd||fffd|"
    Selection.EndKey
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "DT"
        .EntryMacro = "ShowHelp4"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="", Format:=""
            .Width = 0
        End With
    End With
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||3e2|")
    Selection.EndKey
    
    'zle,2008-9-2,+2,|fffd||1b3||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveRight , 2


    Selection.TypeParagraph
    Selection.TypeParagraph
    
     'zle,090710,+1
'    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd|2")
    
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "StdName"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||4f1||fffd||5fc||fffd||fffd||fffd||fffd|", Format:=""
            .Width = 0
        End With
    End With
    'zle,090710,*1
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd|")
    Selection.EndKey
    Selection.TypeParagraph

        
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "StdEnglishName"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||4f1||fffd||5fc||4e2||fffd||fffd||fffd||fffd||fffd||fffd|", Format:=""
            .Width = 0
        End With
    End With
'    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||4e2||fffd||fffd||fffd||fffd||fffd||fffd|2")
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||4e2||fffd||fffd||fffd||fffd||fffd||fffd|")
    Selection.EndKey
    Selection.TypeParagraph
'    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||533||336||231||fffd||2b6|2")
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||533||336||231||fffd||2b6|")
    'zle,090702,*1
'    Selection.TypeText "("
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "YZBS"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||5fc||4bb||fffd||fffd||fffd||533||336||235||131||fffd||2b6|", Format:=""
            .Width = 0
        End With
    End With
    Selection.EndKey
    'zle,090702,*1
'    Selection.TypeText ")"

    
    'zle,2008-9-2,+begin,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
    1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
    wdAutoFitFixed
    With Selection.Tables(1)
        If .Style <> "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = False
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = False
    End With
    
        Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    'zle,2008-9-2,+end
    
'    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||138||fffd||fffd||fffd||fffd|2")
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||138||fffd||fffd||fffd||fffd|")
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormDropDown)
    With fld
        .Name = "LB"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = False
        .DropDown.ListEntries.Clear
        .DropDown.ListEntries.Add Name:="|fffd||138||fffd||fffd||fffd||461||fffd||fffd|"
        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6f8||58e9|"
        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||58e9|"
        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6f8||58e9|"
        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||58e9|"
        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||58e9|"
'        .DropDown.ListEntries.Add Name:="|fffd||fffd||fffd||fffd||fffd|"
    End With
    
    'zle,2008-9-2,+1,|fffd||fffd||fffd||fffd||fffd||fffd||1b3||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveRight , 2
    
'    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||138||fffd||f2d||fffd||fffd||3e2|2")
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||5fc||fffd||138||fffd||f2d||fffd||fffd||3e2|")
    
     'zle,2008-9-2,+begin,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _
    1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _
    wdAutoFitFixed
    With Selection.Tables(1)
        If .Style <> "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = False
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = False
    End With
    
        Selection.Borders(wdBorderTop).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderBottom).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderRight).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        Selection.Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
    'zle,2008-9-2,+end

    'zle,2008-8-5,+begin,|fffd||fffd||fffd||4fa||377||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b8||fffd||2bd||fffd||fffd||fffd||fffd||fffd||6bf||fffd||fffd||fffd|
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "WCRQ"
        .EntryMacro = ""
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="", Format:="" '.EditType Type:=wdDateText, Default:=Date, Format:="yyyy|fffd||fffd|M|fffd||fffd|d|fffd||fffd|"
        End With
    End With
    Selection.EndKey
    'zle,2008-8-5,+end
    
    'zle,2008-9-2,+1,|fffd||fffd||fffd||fffd||fffd||fffd||1b3||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveRight , 2
    Selection.Delete
    Selection.TypeParagraph
    Selection.MoveLeft wdCharacter, 1
    
    'zle,09-06-26,+5|fffd||fffd||fffd||fffd||fffd||4f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|

    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(257), MillimetersToPoints(25 + 170), MillimetersToPoints(257))
    shp.LockAnchor = True
    shp.RelativeVerticalPosition = wdRelativeVerticalPositionPage
'    shp.RelativeVerticalSize = wdRelativeVerticalSizePage
    shp.ZOrder msoBringToFront

    
'zle,2008-10-7,+|fffd||5b8||fffd||52d||fffd||fffd||fffd||137||fffd||fffd||fffd||fffd||fffd||fffd||6b8||fffd||2bd|
'    If StdType = 0 Then
'        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
'    Else
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
'    End If
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "FY"
        .EntryMacro = "ShowHelp8"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XXXX", Format:=""
            .Width = 4
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=4
    
    Selection.TypeText Text:=" - "
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "FM"
        .EntryMacro = "ShowHelp8"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XX", Format:=""
            .Width = 2
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=2
    Selection.TypeText Text:=" - "
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "FD"
        .EntryMacro = "ShowHelp8"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XX", Format:=""
            .Width = 2
    End With
        End With

    Selection.MoveRight Unit:=wdCharacter, Count:=2

    
    Selection.TypeText Text:="|fffd||fffd||fffd||fffd|"
    'zle,09-06-06,+begin|fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd|
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With

    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
'        .Position = 1
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
'    Selection.MoveRight Unit:=wdCharacter, Count:=3
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
'        .Position = 1
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.EndKey
    'zle,09-06-06,+end

    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.TypeParagraph
    Selection.MoveLeft wdCharacter, 1
    
    'zle,09-06-26,+3,
    shp.RelativeVerticalPosition = wdRelativeVerticalPositionPage
'    shp.RelativeVerticalSize = wdRelativeVerticalSizePage

    shp.Top = CentimetersToPoints(25.7)

    
'    If StdType = 0 Then
'        Selection.Style = ActiveDocument.Styles("|2b5||2a9||fffd||fffd||fffd||fffd|")
'    Else
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||2b5||2a9||fffd||fffd||fffd||fffd|")
'    End If
    

'    zle,2008-10-7,+|fffd||5b8||fffd||52d||fffd||fffd||2b5||2a9||fffd||fffd||fffd||6b8||fffd||2bd|
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "SY"
        .EntryMacro = "ShowHelp9"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XXXX", Format:=""
            .Width = 4
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=4

    Selection.TypeText Text:=" - "
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "SM"
        .EntryMacro = "ShowHelp9"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XX", Format:=""
            .Width = 2
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=2
    Selection.TypeText Text:=" - "
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
    With fld
        .Name = "SD"
        .EntryMacro = "ShowHelp9"
        .ExitMacro = ""
        .Enabled = True
        .OwnHelp = False
        .HelpText = ""
        .OwnStatus = True
        With .TextInput
            .EditType Type:=wdRegularText, Default:="XX", Format:=""
            .Width = 2
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=2

    
    Selection.TypeText Text:="|2b5||2a9|"
    
    'zle,09-06-06,+begin
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With

    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
'        .Position = 1
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
'    Selection.MoveRight Unit:=wdCharacter, Count:=3
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
'        .Position = 1
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.MoveLeft , 2
    Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    With Selection.Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.EndKey
    'zle,09-06-06,+end

   Selection.MoveRight , 1
   Selection.TypeParagraph
   Selection.MoveLeft , 1
   
   'zle,09-06-26,+3,
    shp.RelativeVerticalPosition = wdRelativeVerticalPositionPage
'    shp.RelativeVerticalSize = wdRelativeVerticalSizePage

    shp.Top = CentimetersToPoints(25.7)


    If StdType = 0 Then
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

        Dim gpath As String
        gpath = ""
        gpath = GetSetting("TCS", "Graphic", "Path", "")
        'zle,09-06-23*1,|fffd||fffd||37c||1ac||fffd||133||fffd|bmp|fffd||fffd||2bd|
'        gpath = gpath & "\GBSend.jpg"
        gpath = gpath & "\GBSendClear.bmp"
        Selection.InlineShapes.AddPicture FileName:=gpath, LinkToFile:=False, SaveWithDocument:=True
    Else
         Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
         Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)
         With fld
            .Name = "fm"
            .EntryMacro = ""
            .ExitMacro = ""
            .Enabled = True
            .OwnHelp = False
            .HelpText = ""
            .OwnStatus = False
            With .TextInput
                If StdType = 0 Then
                    .EditType Type:=wdRegularText, Default:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||dbd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||73e||fffd|", Format:=""
                     Selection.MoveRight , 12
                Else
                    .EditType Type:=wdRegularText, Default:="", Format:=""
                    Selection.MoveRight , 5
                End If
                .Width = 0
            End With
        End With
        'zle,090731,|fffd||7b8||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b871|
        Selection.InsertSymbol CharacterNumber:=8194, Unicode:=True, Bias:=0
        Selection.InsertSymbol CharacterNumber:=8194, Unicode:=True, Bias:=0
        Selection.InsertSymbol CharacterNumber:=8194, Unicode:=True, Bias:=0
        Selection.TypeText Text:="|fffd||fffd|"
'        Selection.InsertSymbol CharacterNumber:=8194, Unicode:=True, Bias:=0
        Selection.TypeText Text:="|fffd||fffd|"
        Selection.MoveLeft Unit:=wdCharacter, Count:=2, Extend:=wdExtend
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd|")
    End If
    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(75), MillimetersToPoints(25 + 170), MillimetersToPoints(75))

    'zle,2008-9-26,*4
''    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(252), MillimetersToPoints(25 + 170), MillimetersToPoints(252))
''    shp.LockAnchor = True
''    shp.RelativeVerticalPosition = wdRelativeVerticalPositionPage
''    shp.RelativeVerticalSize = wdRelativeVerticalSizePage
    
'|fffd||fffd||fffd||fffd||fffd||1f6||fffd||3bb||fffd||7e3||fffd||fffd||53e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||278||fffd||fffd||fffd||3bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||52a||fffd||635||fffd||fffd||3f8||fffd||3bb|
'    zle , 2
''    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(42), MillimetersToPoints(25 + 170), MillimetersToPoints(42))
''    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
''    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(50), MillimetersToPoints(25 + 170), MillimetersToPoints(50))
''    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
'    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(67), MillimetersToPoints(25 + 170), MillimetersToPoints(67))
'    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
''    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(115), MillimetersToPoints(25 + 170), MillimetersToPoints(115))
''    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
''    Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(297 - 24), MillimetersToPoints(25 + 170), MillimetersToPoints(297 - 24))
''    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
'     Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(124), MillimetersToPoints(25 + 170), MillimetersToPoints(124))

'    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
'      Set shp = ActiveDocument.Shapes.AddLine(MillimetersToPoints(25), MillimetersToPoints(134), MillimetersToPoints(25 + 170), MillimetersToPoints(134))
'    shp.Line.ForeColor.RGB = RGB(255, 0, 0)
 '|fffd||fffd||3bb||fffd||7fd||fffd||fffd||fffd|
    
    
  '  |fffd||fffd||fffd||fffd||fffd||1f2||fffd||fffd||fffd||fffd||6b1||3be||fffd||fffd||3bf||a3b35||fffd||133||4bb||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6a3||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set ShpDT = ActiveDocument.Shapes.AddShape(msoShapeRectangle, 455, 180, 90, 18)
    ShpDT.Line.Visible = msoFalse
    ShpDT.Name = "DT"
    ShpDT.ZOrder msoSendBehindText
    Set ShpLB = ActiveDocument.Shapes.AddShape(msoShapeRectangle, 250, 455, 100, 24)
    ShpLB.Line.Visible = msoFalse
    ShpLB.Name = "LB"
    ShpLB.ZOrder msoSendBehindText
    ShpLB.LockAnchor = False
'    MsgBox ShpLB.LockAnchor
    Set ShpRQ = ActiveDocument.Shapes.AddShape(msoShapeRectangle, 230, 480, 150, 20)
    ShpRQ.Line.Visible = msoFalse
    ShpRQ.Name = "RQ"
    ShpRQ.ZOrder msoSendBehindText
    ShpRQ.LockAnchor = True
'    MsgBox ShpRQ.LockAnchor
    If StdType > 0 Then
        Set ShpRQ = ActiveDocument.Shapes.AddShape(msoShapeRectangle, 65.65, 59.55, 68.25, 15.6)
        ShpRQ.Line.Visible = msoFalse
        ShpRQ.Name = "BAH"
        ShpRQ.ZOrder msoSendBehindText
    End If

'zle,2009-1-14,*3,|5e2||fffd||375||fffd||fffd||fffd||fffd||4f5||13e||fffd||fffd||3bf||fffd|
'    Set shp = ActiveDocument.Shapes.AddShape(msoShapeRectangle, 532.9, 831.75, 36.75, 15.6)
'    shp.Line.Visible = msoFalse
'    shp.ZOrder msoBringInFrontOfText

    
    'zle,090714+begin
    Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
    
    ActiveDocument.Sections(2).Footers(wdHeaderFooterPrimary).LinkToPrevious = False
    ActiveDocument.Sections(2).Footers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||4b3|")
    
    If ActiveWindow.View.SplitSpecial <> wdPaneNone Then
        ActiveWindow.Panes(2).Close
    End If
    If ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _
        ActivePane.View.Type = wdOutlineView Then
        ActiveWindow.ActivePane.View.Type = wdPrintView
    End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
    If Selection.HeaderFooter.IsHeader = True Then
        ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
    Else
        ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
    End If
    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldPage
    With Selection.HeaderFooter.PageNumbers
        .NumberStyle = wdPageNumberStyleArabic
        .HeadingLevelForChapter = 0
        .IncludeChapterNumber = False
        .ChapterPageSeparator = wdSeparatorHyphen
        .RestartNumberingAtSection = True
        .StartingNumber = 1
    End With
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    'zle,090714+end
    
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||134||fffd||fffd||5c63||fffd||fffd|
    Dim i As Integer
    ActiveDocument.Sections(1).ProtectedForForms = True
    For i = 2 To ActiveDocument.Sections.Count
        ActiveDocument.Sections(i).ProtectedForForms = False
    Next
    ActiveDocument.Protect Password:="zhangcheng", NoReset:=False, Type:= _
        wdAllowOnlyFormFields

    '|fffd||fffd||fffd||fffd||fffd||57d||fffd||fffd||fffd|
    Selection.GoTo wdGoToLine, wdGoToLast
    Selection.EndKey
    Selection.TypeParagraph
    Selection.TypeText "_________________________________"
    Selection.Style = ActiveDocument.Styles("|fffd||57d||fffd||fffd||fffd|")
    'zle,090713,+2,|fffd||fffd||fffd||fffd||4b3||fc||fffd||fffd||4f3||fffd||fffd|
    InsertFooter
    InProcess = True
    
    Selection.GoTo wdGoToLine, wdGoToFirst
    ActiveDocument.FormFields("StdName").Select
    InProcess = False

End Sub

'=============================================================================
'==Function:|fffd||fffd||2bc||fffd||fffd||fffd||13c||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================


Sub IniDocument()
    Selection.GoTo wdGoToPage, wdGoToFirst
    Selection.Style = ActiveDocument.Styles("|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|")

    Selection.TypeText Text:="|fffd||fffd||5fc||fffd||fffd||fffd||fffd|"
    Selection.HomeKey
   
    Selection.MoveRight , 1
    Selection.MoveRight wdSentence, 1, wdExtend

    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="StandardName"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.EndKey
    Selection.TypeParagraph
    Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.Style = ActiveDocument.Styles("|fffd||b1||fffd||fffd||fffd|")
    Selection.TypeText Text:="|fffd||fffd||3a7|"
    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.Style = ActiveDocument.Styles("|fffd||b1||fffd||fffd||fffd|")
    Selection.TypeText Text:="|fffd||6df6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd|"
    Selection.TypeParagraph
    Selection.Style = ActiveDocument.Styles("|fffd||fffd|")


    Selection.TypeText Text:="|fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||6b1||fffd||fffd||13c||fffd||fffd||fffd||4e6||fffd||fffd||fffd||1f1||632||fffd||fffd||fffd||fffd||675||121||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||6b5||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||6b5||130||6c7e||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||1f2||fffd||5e2||fffd||fffd||fffd||6b5||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b0||6c7e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||435||fffd||fffd||7b8||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||13c||fffd||fffd||fffd|"
    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.Style = ActiveDocument.Styles("|fffd||b1||fffd||fffd||fffd|")
        
    '|fffd||fffd||2bc||fffd||fffd||4b3||fc||4b3||fffd||fffd|
    ActiveDocument.PageSetup.DifferentFirstPageHeaderFooter = False
    ActiveDocument.PageSetup.OddAndEvenPagesHeaderFooter = False
'    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
'    Selection.MoveRight , 1
'    Selection.Delete Unit:=wdCharacter, Count:=1
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    With ActiveDocument.Sections(1)
           .Headers(wdHeaderFooterPrimary).Range.Text = " "
           .Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fc|_|fffd||fffd||fffd||fffd||4b3|")
           ActiveDocument.Fields.Add Range:=.Footers(wdHeaderFooterPrimary).Range, Type:=wdFieldPage
           .Footers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||4b3|")
    End With
    
        
    '|fffd||fffd||fffd||fd||fffd||5e2||fffd||fffd||2bd||fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    With ActiveDocument.Footnotes
        .Location = wdBottomOfPage
        .NumberingRule = wdRestartContinuous
        .StartingNumber = 1
        .NumberStyle = wdNoteNumberStyleArabic
    End With
    Set ClsEvent.TdsApp = Application
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||7b8||131||fffd||5fc||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ChgName()
    Dim rng As Range
    InProcess = True
    Set rng = ActiveDocument.Bookmarks("StandardName").Range
    If ActiveDocument.FormFields("StdName").Result <> "" Then
        If Left(ActiveDocument.FormFields("StdName").Result, 4) <> "|fffd||fffd||fffd||fffd||2f4||fffd|" Then

            rng.Text = ActiveDocument.FormFields("StdName").Result
            rng.Select
            Selection.HomeKey
            Selection.MoveRight , 2
            Selection.MoveRight wdSentence, 1, wdExtend
            With ActiveDocument.Bookmarks
                 .Add Range:=Selection.Range, Name:="StandardName"
                 .DefaultSorting = wdSortByLocation
                 .ShowHidden = True
            End With
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.MoveLeft wdCharacter, 2
            Selection.TypeBackspace
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.EndKey
            Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
            If ActiveDocument.Bookmarks.Exists("BZ") Then
                Selection.GoTo what:=wdGoToBookmark, Name:="BZ"
                ActiveDocument.Bookmarks("BZ").Delete
            Else
                If g_SZFirst <> "" Then
                    ActiveDocument.FormFields(g_SZFirst).Select
                End If
                Selection.EndKey
                g_SZFirst = ""
            End If
        Else
            rng.Text = "|fffd||fffd||5fc||fffd||fffd||fffd||fffd|"
            rng.Select
            Selection.HomeKey
            Selection.MoveRight , 2
            Selection.MoveRight wdSentence, 1, wdExtend
            With ActiveDocument.Bookmarks
                 .Add Range:=Selection.Range, Name:="StandardName"
                 .DefaultSorting = wdSortByLocation
                 .ShowHidden = True
            End With
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.HomeKey
            Selection.MoveRight , 1
            Selection.TypeBackspace

        Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
        If ActiveDocument.Bookmarks.Exists("BZ") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="BZ"
            ActiveDocument.Bookmarks("BZ").Delete
        Else
            If g_SZFirst <> "" Then
                ActiveDocument.FormFields(g_SZFirst).Select
            End If
            Selection.EndKey
            g_SZFirst = ""
        End If
        End If
    End If
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||17a||fffd||4f3||fffd||fffd||4b3||fc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFooter()
    InProcess = True
    Dim i As Integer
    'zle,090708+1,|fffd||fffd||fffd||fffd||fffd||fffd||5be|
    Dim flagePrt As Boolean
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
        flagePrt = True
    End If
    'zle,090522,+being,|fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||5b1||fffd||5fc|
    If OnePage = False Then
        Dim findPar As Paragraph
        Dim findRan As Range
        Dim iParaCount As Integer
        
        For Each findPar In ActiveDocument.Paragraphs
            iParaCount = iParaCount + 1
            If findPar.Style = "|fffd||fffd||5fc||fffd||fffd||3bd|" Or findPar.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||3bd|" Then
                Exit For
            End If
        Next
        Dim strContent As String
        strContent = findPar.Range.Text
        If (InStr(strContent, "|fffd||fffd||fffd||4b1||fffd||5fc|") <> 0) Then
            StdType = 0
        ElseIf (InStr(strContent, "|fffd||fffd||4b5||fffd||fffd||5fc|") <> 0) Then
            StdType = 1
        ElseIf (InStr(strContent, "|fffd||637||fffd||fffd||fffd||5fc|") <> 0) Then
            StdType = 2
        ElseIf (InStr(strContent, "|fffd||fffd||4b5||fffd||fffd||5fc|") <> 0) Then
            StdType = 3
        End If
        OnePage = True
    End If
    'zle,090522,+end,
    For i = 2 To ActiveDocument.Sections.Count
        With ActiveDocument.Sections(i)
            Dim HStr As String
            HStr = ""
            If StdType = 0 Then
                HStr = "GB/T "
                HStr = HStr & Trim(ActiveDocument.FormFields("StdNo1").Result) & "|fffd||fffd|" & ActiveDocument.FormFields("StdNo2").Result
            ElseIf StdType = 1 Then
                HStr = Trim(ActiveDocument.FormFields("StdNo0").Result) & "/T " & Trim(ActiveDocument.FormFields("StdNo1").Result) & "|fffd||fffd|" & ActiveDocument.FormFields("StdNo2").Result
            ElseIf StdType = 2 Then
                HStr = "DB"
                HStr = HStr & Trim(ActiveDocument.FormFields("StdNo0").Result) & "/ " & Trim(ActiveDocument.FormFields("StdNo1").Result) & "|fffd||fffd|" & ActiveDocument.FormFields("StdNo2").Result
            ElseIf StdType = 3 Then
                HStr = "Q/"
                HStr = HStr & Trim(ActiveDocument.FormFields("StdNo0").Result) & " " & Trim(ActiveDocument.FormFields("StdNo1").Result) & "|fffd||fffd|" & ActiveDocument.FormFields("StdNo2").Result
            End If
'            HStr = HStr & Trim(ActiveDocument.FormFields("StdNo1").Result) & "-" &
'            ActiveDocument.FormFields("StdNo2").Result
            .Headers(wdHeaderFooterPrimary).Range.Text = HStr
 '          .Headers(wdHeaderFooterEvenPages).Range.Text = HStr
        End With
    Next
    
    'zle,090805,+begin,|225||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fc| *
'    ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range.Select
'    Selection.ClearFormatting
'
'    ActiveWindow.View.Type = wdPrintView
'
'    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
'    ActiveWindow.View.Type = wdPrintView

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If flagePrt = True Then
         ActiveDocument.Sections(1).ProtectedForForms = True
         For i = 2 To ActiveDocument.Sections.Count
             ActiveDocument.Sections(i).ProtectedForForms = False
         Next
         ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields

        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    End If
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||436||3f1||fffd||5fc||fffd||137||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub GetFMType()
    If OnePage = False Then
        InProcess = True
        Dim i As Integer
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If

        Dim findPar As Paragraph
        Dim findRan As Range
        Dim iParaCount As Integer
        
        For Each findPar In ActiveDocument.Paragraphs
            iParaCount = iParaCount + 1
            If findPar.Style = "|fffd||fffd||5fc||fffd||fffd||3bd|" Or findPar.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||3bd|" Then
                Exit For
            End If
        Next
        Dim strContent As String
        strContent = findPar.Range.Text
        If (InStr(strContent, "|fffd||fffd||fffd||4b1||fffd||5fc|") <> 0) Then
            StdType = 0
        ElseIf (InStr(strContent, "|fffd||fffd||4b5||fffd||fffd||5fc|") <> 0) Then
            StdType = 1
        ElseIf (InStr(strContent, "|fffd||637||fffd||fffd||fffd||5fc|") <> 0) Then
            StdType = 2
        ElseIf (InStr(strContent, "|fffd||fffd||4b5||fffd||fffd||5fc|") <> 0) Then
            StdType = 3
        End If
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
         ActiveDocument.Sections(1).ProtectedForForms = True
         For i = 2 To ActiveDocument.Sections.Count
             ActiveDocument.Sections(i).ProtectedForForms = False
         Next
         ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
        OnePage = True
    End If
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||2eb||fffd||fffd||fffd||170||fffd||4b3||fc||4b3||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub ProcessTwoPageHeader()
    Dim i As Integer, j As Integer
    'zle,2008-11-23,*1,|5e2||fffd||4f5||fffd||fffd||fffd||fffd||fffd||5fd|
'    On Error GoTo errorhandle
    'zle090706,+1,|fffd||fffd||5b9||fffd||fffd||fffd||6d26||fffd||fffd|
    InProcess = True
    
    If ActiveDocument.FormFields.Count > 10 Then
    '|fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
'            ClsEvent.CmdTwoPageC.State = msoButtonUp
'            ClsEvent.CmdTwoPage.State = msoButtonUp
'            MsgBox "|fffd||fffd||fffd||fffd||fffd||6b7||fffd||fffd||6d26||fffd||fffd||2eb||fffd||fffd||fffd||170||68ec||fffd||bf6b||fffd||fffd||fffd||fffd||1b6||fffd||fffd||fffd||fffd||fffd||5b4||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd|"
'            Exit Sub
'        Else
            Selection.GoTo wdGoToSection, wdGoToAbsolute, 2
        End If
            If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
                ActiveDocument.Unprotect "zhangcheng"
            End If
'        End If
    End If
    
    ActiveDocument.PageSetup.DifferentFirstPageHeaderFooter = False
    ActiveDocument.PageSetup.OddAndEvenPagesHeaderFooter = True
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    'zle,090804,|fffd||fffd||fffd||6b6||fffd||fffd||6bf||fffd||2bc||fffd||133||275||fffd||4bb||fffd||6bf||fffd||2bc|
    For i = 1 To ActiveDocument.Sections.Count
        With ActiveDocument.Sections(i)
           
            .Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fc|_|fffd||fffd||fffd||fffd||4b3|")
            .Headers(wdHeaderFooterEvenPages).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fc|_|17c||fffd||fffd||4b3|")
            .Headers(wdHeaderFooterEvenPages).Range.Text = Left(.Headers(wdHeaderFooterPrimary).Range.Text, Len(.Headers(wdHeaderFooterPrimary).Range.Text) - 1)
            .Footers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||4b3|")
             ActiveDocument.Fields.Add Range:=.Footers(wdHeaderFooterEvenPages).Range, Type:=wdFieldPage
            .Footers(wdHeaderFooterEvenPages).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fffd|_|17c||fffd||fffd||4b3|")
            If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
                ActiveDocument.Unprotect "zhangcheng"
            End If
            .PageSetup.LeftMargin = CentimetersToPoints(2.5)
            .PageSetup.RightMargin = CentimetersToPoints(2)
            .PageSetup.MirrorMargins = True
         End With
     Next i
     ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd|")
     If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
        For i = 2 To ActiveDocument.Sections.Count
            ActiveDocument.Sections(i).ProtectedForForms = False
        Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
            wdAllowOnlyFormFields
            
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    InProcess = False
    Exit Sub
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||170||fffd||4b3||fc||4b3||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ProcessOnePageHeader()
    Dim i As Integer, j As Integer
    'zle,2008-11-23,*1,|5e2||fffd||4f5||fffd||fffd||fffd||fffd||fffd||5fd|
'    On Error GoTo errorhandle
    If ActiveDocument.FormFields.Count > 10 Then
    '|fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
'            MsgBox "|fffd||fffd||fffd||fffd||fffd||6b7||fffd||fffd||6d26||fffd||fffd||2eb||fffd||fffd||fffd||170||68ec||fffd||bf6b||fffd||fffd||fffd||fffd||1b6||fffd||fffd||fffd||fffd||fffd||5b4||fffd||434||fffd||fffd||fffd||fffd||fffd||fffd|"
'            Exit Sub
'        Else
            Selection.GoTo wdGoToSection, wdGoToAbsolute, 2
        End If
            If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
                ActiveDocument.Unprotect "zhangcheng"
            End If
'        End If
    End If
    ActiveDocument.PageSetup.DifferentFirstPageHeaderFooter = False
    ActiveDocument.PageSetup.OddAndEvenPagesHeaderFooter = False
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'zle,090804,|fffd||fffd||fffd||6b6||fffd||fffd||6bf||fffd||2bc||fffd||133||275||fffd||4bb||fffd||6bf||fffd||2bc|
    For i = 1 To ActiveDocument.Sections.Count
        With ActiveDocument.Sections(i)

           .Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fc|_|fffd||fffd||fffd||fffd||4b3|")
           .Footers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||4b3|")
            If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
                ActiveDocument.Unprotect "zhangcheng"
            End If
            'zle,090706+2,|4b3||fffd||7fe||fffd||fffd||fffd||fffd|
            .PageSetup.LeftMargin = CentimetersToPoints(2.5)
            .PageSetup.RightMargin = CentimetersToPoints(2)
            .PageSetup.MirrorMargins = False
            
         End With
     Next i
     ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Range.Style = ActiveDocument.Styles("|fffd||fffd|")
     If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
        For i = 2 To ActiveDocument.Sections.Count
            ActiveDocument.Sections(i).ProtectedForForms = False
        Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
            wdAllowOnlyFormFields
            
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If

    Exit Sub

End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTblNote()
    On Error GoTo errorhandle
        Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd|")
        Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||37c||fffd||fffd| |fffd||fffd||5e2||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTblMulNote()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||37c||fffd||fffd| |fffd||fffd||fffd||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTblFirNote()
    On Error GoTo errorhandle

    Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd||fffd||fffd|")
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(1)
        .NumberFormat = "|5e2|%1|fffd||fffd|"
        .TrailingCharacter = wdTrailingNone
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.43)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 9
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|5e2||fffd||fffd||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(2)
        .NumberFormat = "%2)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 1
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(3)
        .NumberFormat = "%3."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 2
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(4)
        .NumberFormat = "%4."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 3
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(5)
        .NumberFormat = "%5)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 4
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(6)
        .NumberFormat = "%6."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 5
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(7)
        .NumberFormat = "%7."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 6
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(8)
        .NumberFormat = "%8)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 7
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(9)
        .NumberFormat = "%9."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.75)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 8
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    ListGalleries(wdOutlineNumberGallery).ListTemplates(1).Name = ""
    Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries( _
        wdOutlineNumberGallery).ListTemplates(1), ContinuePreviousList:=False, _
        ApplyTo:=wdListApplyToWholeList, DefaultListBehavior:= _
        wdWord10ListBehavior

    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||121||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTextNote()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||123||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||121||fffd||5e2||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTextMulNote()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||123||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||121||fffd||fffd||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTextFirNote()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||123||fffd|")
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(1)
        .NumberFormat = "|5e2|%1|fffd||fffd|"
        .TrailingCharacter = wdTrailingNone
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.43)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 9
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||123||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(2)
        .NumberFormat = "%2)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 1
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(3)
        .NumberFormat = "%3."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 2
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(4)
        .NumberFormat = "%4."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 3
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(5)
        .NumberFormat = "%5)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 4
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(6)
        .NumberFormat = "%6."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 5
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(7)
        .NumberFormat = "%7."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 6
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(8)
        .NumberFormat = "%8)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 7
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(2).ListLevels(9)
        .NumberFormat = "%9."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.96)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(2.07)
        .TabPosition = CentimetersToPoints(0.32)
        .ResetOnHigher = 8
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    ListGalleries(wdOutlineNumberGallery).ListTemplates(2).Name = ""
    Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries( _
        wdOutlineNumberGallery).ListTemplates(2), ContinuePreviousList:=False, _
        ApplyTo:=wdListApplyToWholeList, DefaultListBehavior:= _
        wdWord10ListBehavior

        Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


Sub InsertTJ()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||13d||fffd||5e2|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

Sub InsertPJ()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFirstTTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertSecondTTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertThirdTTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertForthTTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||5f36||fffd||fffd||fffd||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFifthTTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||b1||fffd||fffd||2871|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertZTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||b1||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||2be||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertExample()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|2be||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertMulExample()
    On Error GoTo errorhandle
    Selection.Style = "|2be||fffd||fffd||fffd||fffd||fffd||fffd|"
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFirExample()
    On Error GoTo errorhandle
    
    Selection.Style = ActiveDocument.Styles("|2be||fffd||fffd||fffd||fffd||fffd||fffd|")
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(1)
        .NumberFormat = "|2be||fffd||fffd|%1|fffd||fffd|"
        .TrailingCharacter = wdTrailingNone
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 9
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|2be||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(2)
        .NumberFormat = "%2)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0)
        .TabPosition = wdUndefined
        .ResetOnHigher = 1
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(3)
        .NumberFormat = "%3."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 2
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(4)
        .NumberFormat = "%4."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 3
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(5)
        .NumberFormat = "%5)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 4
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(6)
        .NumberFormat = "%6."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 5
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(7)
        .NumberFormat = "%7."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 6
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(8)
        .NumberFormat = "%8)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 7
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(1).ListLevels(9)
        .NumberFormat = "%9."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0.7)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = wdUndefined
        .ResetOnHigher = 8
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = False
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    ListGalleries(wdOutlineNumberGallery).ListTemplates(1).Name = ""
    Selection.Range.ListFormat.ApplyListTemplate ListTemplate:= _
        ListGalleries(wdOutlineNumberGallery).ListTemplates(1), _
        ContinuePreviousList:=False, ApplyTo:=wdListApplyToWholeList, _
        DefaultListBehavior:=wdWord10ListBehavior
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||761||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090731
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertExampleContent()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|2be||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||3a1||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertParagraph()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

Sub InsertTWJz()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||13d||fffd||5e2|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

Sub InsertTBJz()        '|37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd|
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTblFooter()
    On Error GoTo errorhandle
    Dim iCount As Integer
    iCount = 0
    If Selection.Information(wdWithInTable) Then
        With ActiveDocument.Bookmarks
            .Add Range:=Selection.Range, Name:="BG"
            .DefaultSorting = wdSortByLocation
            .ShowHidden = True
        End With
        Do
            Selection.HomeKey
            Selection.MoveUp wdParagraph, 1
            iCount = iCount + 1
        Loop While Selection.Style <> "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" And iCount <> 3
        
        If Selection.Style = "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" Then
                Selection.GoTo what:=wdGoToBookmark, Name:="BG"
                ActiveDocument.Bookmarks("BG").Delete
                Selection.Style = ActiveDocument.Styles("|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|")
        Else
            Selection.GoTo what:=wdGoToBookmark, Name:="BG"
            ActiveDocument.Bookmarks("BG").Delete
            InsertFigTblFirFooter
        End If
           
    Else
        Selection.Style = ActiveDocument.Styles("|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|")
    End If
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||37c||fffd||fffd||fffd||5fd||fffd||5e2||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTblFirFooter()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|")
        With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(1)
        .NumberFormat = "%1   "
        .TrailingCharacter = wdTrailingNone
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.64)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.96)
        .TabPosition = wdUndefined
        .ResetOnHigher = 0
        .StartAt = 1
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = False
            .Superscript = True
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 9
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(2)
        .NumberFormat = "%2"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 1
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(3)
        .NumberFormat = "%3."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 2
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(4)
        .NumberFormat = "%4."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 3
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(5)
        .NumberFormat = "%5)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 4
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(6)
        .NumberFormat = "%6."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 5
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(7)
        .NumberFormat = "%7."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 6
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(8)
        .NumberFormat = "%8)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 7
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(4).ListLevels(9)
        .NumberFormat = "%9."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(0)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(0.64)
        .TabPosition = CentimetersToPoints(0.1)
        .ResetOnHigher = 8
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    ListGalleries(wdOutlineNumberGallery).ListTemplates(4).Name = ""
    Selection.Range.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries( _
        wdOutlineNumberGallery).ListTemplates(4), ContinuePreviousList:=False, _
        ApplyTo:=wdListApplyToWholeList, DefaultListBehavior:= _
        wdWord10ListBehavior
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub



Sub InsertFlZTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlPTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlBTitle()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlTTitle1()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlTTitle2()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlTTitle3()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlTTitle4()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlTTitle5()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertFlBs()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||3bf||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertReferences()
    Dim MoveBK As String
    If ActiveDocument.Bookmarks.Exists("BKCKWX") Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||3bf||fffd||fffd||fffd||fffd||5e3||fffd||fffd||fffd||fffd||fffd||fffd||638||fffd||fffd||fffd||fffd||fffd|"
        Exit Sub
    End If
    InProcess = True
    Selection.GoTo wdGoToLine, wdGoToLast
    If ActiveDocument.Bookmarks.Exists("BKSY") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
        Selection.HomeKey
        Selection.MoveLeft , 1
    End If
    If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
        Selection.HomeKey
        Selection.TypeParagraph
        Selection.MoveLeft , 1
    Else
        Selection.EndKey
        Selection.TypeParagraph
    End If
    Selection.Style = ActiveDocument.Styles("|fffd||3bf||fffd||fffd||fffd||fffd||fffd|")
    Selection.TypeText Text:="|fffd||fffd|"
    'zle,2008-10-10,+,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b5||13e||fffd||fffd||fffd|
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    
    Selection.HomeKey

    Selection.MoveRight wdSentence, 1, wdExtend
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BKCKWX"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.EndKey
    Selection.TypeParagraph
    InProcess = False
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||4e1||fffd||fffd||fffd||fffd||fffd||4b3||fffd||6871||fffd||361||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||761||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub DesignIndexTCS()
    
    '|fffd||232||fffd||fffd||4a3||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||6b5||121||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||e871|
    Dim MoveBK As String
    Dim Res As String
    MoveBK = "StandardName"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
    ActiveWindow.View.ShowHiddenText = True
    
    Selection.Find.ClearFormatting
    With Selection.Find
        .Text = "^d xe "
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    '|fffd||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If Selection.Find.Execute = True Then
        '|fffd||fffd||fffd||fffd||4b3||fffd||fffd||fffd||fffd||fffd|
        If ActiveDocument.Bookmarks.Exists("BKSY") Then
            'zle,090731,|fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||263||fffd|
            Res = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||a3||fffd|", vbYesNo + vbQuestion)
            If Res = vbNo Then
                ActiveWindow.View.ShowHiddenText = False
                Exit Sub
            End If
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ProcessIndexFormat
        '|fffd||fffd||fffd||fffd||4b3||fffd||6cbb||fffd||fffd||fffd||fffd|
        Else
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||fffd|
            InsertIndexPage
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ProcessIndexFormat
        End If

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else
        '|fffd||fffd||fffd||fffd||4b3||fffd||fffd||fffd||fffd||fffd|
        If ActiveDocument.Bookmarks.Exists("BKSY") Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            'zle,090731,|fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||263||fffd|
            Res = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||a3||fffd|", vbYesNo + vbQuestion)
            If Res = vbNo Then
                ActiveWindow.View.ShowHiddenText = False
                Exit Sub
            End If
            
            'zle,090806,|fffd||fffd||fffd||fffd||27e||fffd||fffd||52d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If ActiveDocument.FormFields.Count > 10 Then
            
                Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
                Selection.MoveRight , 2
                
                Selection.EndKey wdStory, wdExtend
                Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
                Selection.EndKey Unit:=wdLine, Extend:=wdExtend
                
                Selection.Range.Delete
                Selection.MoveLeft , 1
                Selection.TypeParagraph

            Else
                Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
                Selection.MoveRight , 2
                Selection.EndKey wdStory, wdExtend
                Selection.Range.Delete
                Selection.TypeParagraph
                
            End If
            
            Exit Sub
        '|fffd||fffd||fffd||fffd||4b3||fffd||6cbb||fffd||fffd||fffd||fffd|
        Else
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||fffd|
            InsertIndexPage
'            MsgBox "|fffd||fffd||fffd||231||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , "TCS"
            Exit Sub
        End If
    End If
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b3||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertIndexPage()
    InProcess = True
    Selection.GoTo wdGoToLine, wdGoToLast
    If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
        Selection.HomeKey
        Selection.TypeParagraph
        Selection.MoveLeft , 1
    Else
        Selection.EndKey
        Selection.TypeParagraph
    End If
    Selection.Style = ActiveDocument.Styles("|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Selection.TypeText Text:="|fffd||fffd|"
    'zle,2008-10-10,+2,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5bf||578||fffd|
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.InsertSymbol CharacterNumber:=8195, Unicode:=True, Bias:=0
    Selection.TypeText Text:="|fffd||fffd|"
    
    Selection.HomeKey

    Selection.MoveRight wdSentence, 1, wdExtend
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BKSY"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Selection.EndKey
    'zle,2008-10-27,+5,|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1e9|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="SYGSSQ"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    
    Selection.TypeParagraph
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||e86a||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx1()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||e86a||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd|")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx2()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx3()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx4()
    On Error GoTo errorhandle

    InProcess = True
    
    Dim int_Title As Integer
    Dim int_ZmBh As Integer
    int_Title = 0
    int_ZmBh = 0
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    
    Do
        Selection.HomeKey
        Selection.MoveUp wdParagraph, 1
        'zle,090806,|fffd||436||3f5||fffd||3aa|"|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"|2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b5||fffd||fffd||13f||fffd||fffd||fffd|
        If Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
            Selection.Style = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
            Exit Sub
        ElseIf Selection.Style = "|fffd||b1||fffd||fffd||fffd|" Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            int_Title = int_Title + 1
        ElseIf Selection.Style = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|" Then
            int_ZmBh = int_ZmBh + 1
        ElseIf Selection.Style = "|1f0||fffd||521||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd|" Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
            Selection.Style = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
            InProcess = False
            Exit Sub
        ElseIf Selection.Style = "|fffd||3bf||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
            InProcess = False
            Exit Sub
        ElseIf Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
            InsertLx41
            InProcess = False

            Exit Sub
            Exit Do
        End If
    Loop While int_Title = int_ZmBh
    If int_Title > int_ZmBh Then
        Selection.GoTo what:=wdGoToBookmark, Name:="DW"
        ActiveDocument.Bookmarks("DW").Delete
        InsertLx41
    Else

        Selection.GoTo what:=wdGoToBookmark, Name:="DW"
        ActiveDocument.Bookmarks("DW").Delete
        Selection.Style = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"

    End If

    InProcess = False
    Exit Sub
errorhandle:

    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx41()
    
    On Error GoTo errorhandle
    InProcess = True
    
    Selection.ClearFormatting

    Selection.Style = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
    
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(1)
        .NumberFormat = "%1)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(0.74)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(1.48)
        .TabPosition = CentimetersToPoints(1.48)
        .ResetOnHigher = 0
        .StartAt = 1

        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 10
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||e8e8||4bb||fffd||fffd||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(2)
        .NumberFormat = "%2)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(1.48)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.22)
        .TabPosition = CentimetersToPoints(2.22)
        .ResetOnHigher = 1
        .StartAt = 1
      
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 10
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(3)

        .NumberFormat = "(%3)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(2.22)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(2.96)
        .TabPosition = CentimetersToPoints(0)
        .ResetOnHigher = 2
        .StartAt = 1
        
        With .Font
            .Bold = False
            .Italic = False
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = 10
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = "|fffd||fffd||fffd||fffd|"
        End With
        .LinkedStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(4)
        .NumberFormat = "%4."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(2.96)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(3.7)
        .TabPosition = CentimetersToPoints(3.7)
        .ResetOnHigher = 3
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(5)
        .NumberFormat = "%5)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(3.7)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(4.44)
        .TabPosition = CentimetersToPoints(4.44)
        .ResetOnHigher = 4
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(6)
        .NumberFormat = "%6."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(4.44)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(5.18)
        .TabPosition = CentimetersToPoints(5.19)
        .ResetOnHigher = 5
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(7)
        .NumberFormat = "%7."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleArabic
        .NumberPosition = CentimetersToPoints(5.19)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(5.92)
        .TabPosition = CentimetersToPoints(5.93)
        .ResetOnHigher = 6
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(8)
        .NumberFormat = "%8)"
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseLetter
        .NumberPosition = CentimetersToPoints(5.93)
        .Alignment = wdListLevelAlignLeft
        .TextPosition = CentimetersToPoints(6.66)
        .TabPosition = CentimetersToPoints(6.67)
        .ResetOnHigher = 7
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    With ListGalleries(wdOutlineNumberGallery).ListTemplates(7).ListLevels(9)
        .NumberFormat = "%9."
        .TrailingCharacter = wdTrailingTab
        .NumberStyle = wdListNumberStyleLowercaseRoman
        .NumberPosition = CentimetersToPoints(6.67)
        .Alignment = wdListLevelAlignRight
        .TextPosition = CentimetersToPoints(7.41)
        .TabPosition = CentimetersToPoints(7.41)
        .ResetOnHigher = 8
        .StartAt = 1
        With .Font
            .Bold = wdUndefined
            .Italic = wdUndefined
            .StrikeThrough = wdUndefined
            .Subscript = wdUndefined
            .Superscript = wdUndefined
            .Shadow = wdUndefined
            .Outline = wdUndefined
            .Emboss = wdUndefined
            .Engrave = wdUndefined
            .AllCaps = wdUndefined
            .Hidden = wdUndefined
            .Underline = wdUndefined
            .Color = wdUndefined
            .Size = wdUndefined
            .Animation = wdUndefined
            .DoubleStrikeThrough = wdUndefined
            .Name = ""
        End With
        .LinkedStyle = ""
    End With
    ListGalleries(wdOutlineNumberGallery).ListTemplates(7).Name = ""
    Selection.Range.ListFormat.ApplyListTemplate ListTemplate:= _
        ListGalleries(wdOutlineNumberGallery).ListTemplates(7), _
        ContinuePreviousList:=False, ApplyTo:=wdListApplyToWholeList, _
        DefaultListBehavior:=wdWord10ListBehavior
        

    InProcess = False
    Exit Sub
    
errorhandle:

    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx5()
    On Error GoTo errorhandle

    InProcess = True
    Selection.ClearFormatting
  
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|")

    InProcess = False
    Exit Sub

errorhandle:
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| "|fffd||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|"
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertLx6()
    On Error GoTo errorhandle
    InProcess = True
    
    Selection.ClearFormatting
    
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||e8e8||fffd||fffd||fffd||fffd||fffd||fffd|")
    InProcess = False
     Exit Sub
     
errorhandle:
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

Sub InsertSy1()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 1")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy2()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 2")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy3()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 3")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy4()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 4")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy5()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 5")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy6()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 6")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy7()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 7")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy8()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 8")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertSy9()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 9")
     Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
Sub InsertGT()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"

End Sub

Sub InsertTab()
    On Error GoTo errorhandle
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|")
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||4e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f0||225||fffd||fffd||fffd||fffd||fffd||fffd||133||429||3b4||fffd||fffd||132||fffd||fffd||5b2||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||223||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ProcessPrint()
    '|fffd||fffd||fffd||fb||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f4||fffd||fffd||fffd|
    InProcess = True
    If ActiveDocument.FormFields.Count < 10 Then
        Exit Sub
    End If
    Dim i As Integer
    '|fffd||fffd||fffd||fffd||fffd||fffd||2f4||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||3aa||fffd||fffd|
    With ActiveDocument.FormFields
        For i = 1 To .Count
            If Left(.Item(i).Result, 4) = "|fffd||fffd||fffd||fffd||2f4||fffd|" Then
                .Item(i).Result = ""
            End If
        Next i
    End With

    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
    End If
    ActiveDocument.FormFields.Shaded = False
    '|fffd||fe||fffd||fffd||3bf||fffd||fffd||6b1||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||132||fffd||fffd||fffd|

    If OnePage = False Then
        GetFMType
    End If
    If StdType = 0 And Len(Trim(ActiveDocument.FormFields("DT").Result)) = 7 Then
        ActiveDocument.Shapes("DT").ZOrder msoBringInFrontOfText
    ElseIf StdType = 1 And Len(Trim(ActiveDocument.FormFields("DT").Result)) = 3 Then
            ActiveDocument.Shapes("DT").ZOrder msoBringInFrontOfText
    ElseIf StdType = 2 And Len(Trim(ActiveDocument.FormFields("DT").Result)) = 5 Then
            ActiveDocument.Shapes("DT").ZOrder msoBringInFrontOfText
    ElseIf StdType = 3 And Len(Trim(ActiveDocument.FormFields("DT").Result)) = 5 Then
        ActiveDocument.Shapes("DT").ZOrder msoBringInFrontOfText
    End If

    
    If Trim(ActiveDocument.FormFields("LB").Result) = "|fffd||138||fffd||fffd||fffd||461||fffd||fffd|" Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
        ActiveDocument.Shapes("LB").ZOrder msoBringInFrontOfText
    End If
    

    If Trim(ActiveDocument.FormFields("WCRQ").Result) = "" Or Trim(ActiveDocument.FormFields("WCRQ").Result) = "(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6a3||fffd|)" Or Trim(ActiveDocument.FormFields("WCRQ").Result) = "()" Or Trim(ActiveDocument.FormFields("WCRQ").Result) = ")" Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
        ActiveDocument.Shapes("RQ").ZOrder msoBringInFrontOfText
    End If
    
    '|fffd||531||fffd||fffd||fffd||fffd||17d||fffd||fffd||434||fffd||fffd||fffd|
    Dim HaveBAH As Boolean
    HaveBAH = False
    For i = 1 To ActiveDocument.FormFields.Count
        If ActiveDocument.FormFields(i).Name = "BAH" Then
            HaveBAH = True
            Exit For
        End If
    Next i
    If HaveBAH Then
        If Trim(ActiveDocument.FormFields("BAH").Result) = "" Then
            ActiveDocument.Shapes("BAH").ZOrder msoBringInFrontOfText
        End If
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5ae||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd|
    If (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Sections(1).ProtectedForForms = True
        For i = 2 To ActiveDocument.Sections.Count
            ActiveDocument.Sections(i).ProtectedForForms = False
        Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
            wdAllowOnlyFormFields
    End If
    
    If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
        ClsEvent.CmdPROTECTC.FaceId = 277
        ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
    
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||f2d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f0||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||431||f2d||fffd||fffd||fffd||5a3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b5||223||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ProcessEdit()
    '|fffd||fffd||fffd||fb||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f4||fffd||fffd||fffd|
    On Error Resume Next
    InProcess = True
    If ActiveDocument.FormFields.Count < 10 Then
        Exit Sub
    End If
    Dim i As Integer
    i = 1
    '|fffd||fffd||fffd||571||fffd||3aa||fffd||fffd||fffd||fffd||fffd||2be|
    With ActiveDocument.FormFields
        For i = 1 To .Count
            If Trim(.Item(i).Result) = "" Then
                .Item(i).Result = .Item(i).TextInput.Default
            End If
        Next i
    End With

    
    
    If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
        ActiveDocument.Unprotect "zhangcheng"
    End If
    ActiveDocument.FormFields.Shaded = True
    '|221||fffd||fffd||fffd||fffd||fffd||3bf||fffd||fffd||fffd||6b1||fffd|
    ActiveDocument.Shapes("DT").ZOrder msoSendBehindText
    ActiveDocument.Shapes("RQ").ZOrder msoSendBehindText
    ActiveDocument.Shapes("LB").ZOrder msoSendBehindText
    
        '|fffd||531||fffd||fffd||fffd||fffd||17d||fffd||fffd||434||fffd||fffd||fffd|
    Dim HaveBAH As Boolean
    HaveBAH = False
    For i = 1 To ActiveDocument.FormFields.Count
        If ActiveDocument.FormFields(i).Name = "BAH" Then
            HaveBAH = True
            Exit For
        End If
    Next i
    If HaveBAH Then
        If Trim(ActiveDocument.FormFields("BAH").Result) = "" Then
            ActiveDocument.Shapes("BAH").ZOrder msoSendBehindText
        End If
    End If

    
    
   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5ae||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd|
    ActiveDocument.Sections(1).ProtectedForForms = True
    For i = 2 To ActiveDocument.Sections.Count
        ActiveDocument.Sections(i).ProtectedForForms = False
    Next
    ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
        wdAllowOnlyFormFields
        
    If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
        ClsEvent.CmdPROTECTC.FaceId = 277
        ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
    
    InProcess = False
End Sub

Function FieldNull(SourceStr As String)
    Dim i As Integer, Result As Boolean
    Result = True
    For i = 1 To Len(SourceStr)
        If Asc(Mid(SourceStr, 1, 1)) <> 63 Then
            Result = False
            Exit For
        End If
    Next
    FieldNull = Result
End Function

'=============================================================================
'==Function:|fffd||fffd||fffd||b870||fffd||fffd||fffd||a871||37c||1ac|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub GBTag()
    
    Dim gpath As String
    gpath = GetSetting("TCS", "Graphic", "Path", "")
    gpath = gpath & "\GB.bmp"

    Dim pic As InlineShape
    Set pic = Selection.InlineShapes.AddPicture(FileName:=gpath, LinkToFile:=False, SaveWithDocument:=True)
    pic.Width = MillimetersToPoints(40)
    pic.Height = MillimetersToPoints(20)

    Selection.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||5be|")
    Selection.MoveRight Unit:=wdCharacter, Count:=1

    Selection.TypeParagraph
    Selection.TypeParagraph
    Selection.MoveLeft Unit:=wdCharacter, Count:=2
    Selection.TypeText Text:="|fffd||43b||fffd||fffd||fffd||fffd||79cba||379||fffd||fffd||fffd||fffd||4b1||fffd||5fc|"
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||3bd|")
    Selection.MoveRight Unit:=wdCharacter, Count:=1

End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||b870||fffd||431||a871||fffd||fffd||5fc||fffd||fffd||5be||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub HBTag()

    Dim fld As FormField
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)
    With fld
        .EntryMacro = "ShowHelp15"
        .OwnStatus = True
        .Name = "c1"
        .OwnHelp = False
        With .TextInput
            .EditType wdRegularText '
            .Width = 2
        End With
    End With
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||5fc||fffd||fffd||5be|")
    Selection.MoveRight Unit:=wdCharacter, Count:=5
    Selection.TypeParagraph
    Selection.TypeParagraph

    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.TypeText Text:="|fffd||43b||fffd||fffd||fffd||fffd||79cba||379||fffd|"
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
    wdFieldFormTextInput)
    With fld
         .Name = "c2"
         .EntryMacro = "showhelp11"
         .ExitMacro = ""
         .HelpText = ""
         .OwnHelp = False
         .OwnStatus = True
         With .TextInput
            .Width = 0
            .EditType wdRegularText
        End With
    End With
    Selection.MoveRight , 5
    Selection.TypeText Text:="|fffd||fffd||4b5||fffd||fffd||5fc|"
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||3bd|")
    Selection.MoveRight Unit:=wdCharacter, Count:=1
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||b870||fffd||631||a871||fffd||fffd||5fc||fffd||fffd||5be||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub DBTag()
Dim fld As FormField
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||5be|")
    Selection.TypeText "DB"
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)
    With fld
        .EntryMacro = "ShowHelp16"
        .OwnStatus = True
        .Name = "c3"
        .OwnHelp = False
        With .TextInput
            .EditType wdRegularText
            .Width = 2
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=6
    Selection.TypeParagraph

    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
        With fld
             .Name = "c4"
             .EntryMacro = "showhelp12"
             .ExitMacro = ""
             .HelpText = ""
             .OwnHelp = False
             .OwnStatus = True
             With .TextInput
                .Width = 0
                .EditType wdRegularText
            End With
        End With
        Selection.MoveRight , 5
        Selection.TypeText Text:="|fffd||637||fffd||fffd||fffd||5fc|"
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||3bd|")
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.TypeParagraph
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||b870||fffd||fffd||a871||fffd||fffd||5fc||fffd||fffd||5be||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub QBTag()
 Dim fld As FormField
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||5be|")
    Selection.TypeText "Q/"
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormTextInput)
    With fld
        .EntryMacro = "ShowHelp17"
        .OwnStatus = True
        .Name = "c5"
        .OwnHelp = False
        With .TextInput
            .EditType wdRegularText
            .Width = 0
        End With
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=6

    Selection.TypeParagraph
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Set fld = ActiveDocument.FormFields.Add(Range:=Selection.Range, Type:= _
        wdFieldFormTextInput)
        With fld
             .Name = "c6"
             .EntryMacro = "showhelp13"
             .ExitMacro = ""
             .HelpText = ""
             .OwnHelp = False
             .OwnStatus = True
             With .TextInput
                .Width = 0
                .EditType wdRegularText
            End With
        End With
        Selection.MoveRight , 5
        Selection.TypeText Text:="|fffd||fffd||4b5||fffd||fffd||5fc|"
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||3bd|")
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.TypeParagraph
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||fffd||4b3||fffd||fffd| |fffd||fffd||fffd||fffd||4b3||fffd||fffd||fffd||2bd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ProcessFontPage()
    Dim i As Integer
    i = 1
    If ActiveDocument.FormFields.Count > 10 Then
    '|fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    Selection.EndKey
    'zle,090704,+1
    Selection.MoveUp wdParagraph, 1
    'zle,090704,*1
'    Selection.HomeKey
    Selection.InsertBreak Type:=wdSectionBreakNextPage
    Selection.MoveLeft , 1
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
    Selection.HeaderFooter.PageNumbers.NumberStyle = wdPageNumberStyleUppercaseRoman
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
 
    If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
        For i = 2 To ActiveDocument.Sections.Count
            ActiveDocument.Sections(i).ProtectedForForms = False
        Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
            wdAllowOnlyFormFields
            
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    End If
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTable()
    On Error GoTo errorhandle
    FrmTable.Show
    Dim Tble As Table
'   zle,2008-7-29,+begin,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2f2||fffd||fffd||fffd||fffd||fffd||fffd||134||fffd||fffd||fffd||fffd||fffd||fffd||221||fffd||fffd||fffd||fffd||fffd||b2efd||fffd||fffd||432||fffd||fffd||fffd||fffd||fffd||fffd||4e6||fffd||2f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If g_rowNum = 0 Or g_columnNum = 0 Then
        Exit Sub
    End If
'   zle,2008-7-29,+end

    Selection.HomeKey Unit:=wdLine
    Selection.EndKey Unit:=wdLine
    If Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|") Then
        Selection.EndKey
        Selection.TypeParagraph
    ElseIf Selection.Characters.Count <> 0 Then           '|fffd||436||fffd||fffd||fffd||4bb||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Selection.EndKey
        Selection.TypeParagraph
        Selection.ClearFormatting
    End If
    Selection.EndKey
    Set Tble = ActiveDocument.Tables.Add(Range:=Selection.Range, NumRows:=g_rowNum, NumColumns:=g_columnNum)
    With Tble
        If .Style <> "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
            .Style = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = True
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = True
        
        With .Borders(wdBorderLeft)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth100pt
            .Color = wdColorAutomatic
        End With
        With .Borders(wdBorderRight)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth100pt
            .Color = wdColorAutomatic
        End With
        With .Borders(wdBorderTop)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth100pt
            .Color = wdColorAutomatic
        End With
        With .Borders(wdBorderBottom)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth100pt
            .Color = wdColorAutomatic
        End With
        With .Borders(wdBorderHorizontal)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth050pt
            .Color = wdColorAutomatic
        End With
        With .Borders(wdBorderVertical)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth050pt
            .Color = wdColorAutomatic
        End With
        .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
        .Borders.Shadow = False
        .Rows(1).Borders(wdBorderBottom).LineWidth = wdLineWidth100pt
        .Rows(g_rowNum - 2).Borders(wdBorderBottom).LineWidth = wdLineWidth100pt
        
'        zle |2b9||fffd||f1||fffd||fffd||fffd||fffd||4bb||fffd||43a||fffd||fffd||fffd||fffd||4bb||fffd||431||7ff||b6f3c||4f4||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||3f2||fffd|
        .Rows(g_rowNum - 1).Cells.Merge
        .Rows(g_rowNum).Cells.Merge
    End With
    
    Selection.EndOf wdTable
    Selection.MoveRight wdCharacter, 1
    Selection.MoveDown wdLine, 1
    Selection.TypeParagraph
    Selection.Style = "|fffd||fffd|"
    
    'zle,2008-8-11,+2,|fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa|0
    g_rowNum = 0
    g_columnNum = 0
    Exit Sub
errorhandle:
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||be6b||2bd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertEquation()
    If ActiveDocument.FormFields.Count > 10 Then
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
            MsgBox "|fffd||fffd||fffd||6cbb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f9||fffd||2bd||fffd||fffd|"
            Exit Sub
        End If
    End If
    
    Selection.ParagraphFormat.LeftIndent = CentimetersToPoints(0)
    Selection.ParagraphFormat.CharacterUnitFirstLineIndent = 0
    Selection.ParagraphFormat.FirstLineIndent = CentimetersToPoints(0)
    
    Selection.InlineShapes.AddOLEObject ClassType:="Equation.3", FileName:="", _
     LinkToFile:=False, DisplayAsIcon:=False
    'zle,09-06-29,+1
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
End Sub



'=============================================================================
'==Function:|fffd||fffd||fffd||be6b||2bd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertEquationNum()
    On Error GoTo errorhandle
    'zle,2008-11-6,+begin,|fffd||436||3f5||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="FLBH"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With

    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("FLBH") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="FLBH"
            ActiveDocument.Bookmarks("FLBH").Delete
        End If
        InsertFLEquationNum
        Exit Sub
    Else
         'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("FLBH") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="FLBH"
            ActiveDocument.Bookmarks("FLBH").Delete
        End If
    End If
    'zle,2008-11-6,+end
    If ActiveDocument.FormFields.Count > 10 Then
    'zle,2008-8-17,+3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c63||fffd||fffd|
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    Selection.HomeKey Unit:=wdLine
    Selection.HomeKey Unit:=wdLine
    Selection.TypeText Text:=vbTab
    Selection.EndKey Unit:=wdLine
    Selection.EndKey Unit:=wdLine
    Selection.TypeText Text:=vbTab
    Selection.TypeText Text:="()"

    'zle,2008-9-30,+begin,|fffd||fffd||fffd||4f9||fffd||2bd||fffd||fffd||fffd|
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    CaptionLabels.Add Name:="|fffd||fffd||5fc||fffd||536||fffd||fffd||fffd||2bd|"
    Selection.InsertCaption Label:="|fffd||fffd||5fc||fffd||536||fffd||fffd||fffd||2bd|", TitleAutoText:="", Title:="", _
        Position:=wdCaptionPositionBelow, ExcludeLabel:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    'zle,2008-9-30,+end
    
'    zle,2008-10-3,+3,|fffd||fffd||fffd||fffd||461||4e6||fffd||fffd||fffd||6a1||fffd||fffd||fffd||fffd||139||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|
    Selection.HomeKey Unit:=wdLine
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||139||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|")
    
    Selection.EndKey
    Selection.TypeParagraph
    Selection.TypeText "|2bd||fffd||423||fffd|"
    Selection.TypeParagraph
    
    Dim i As Integer
    i = 1
    If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
                For i = 2 To ActiveDocument.Sections.Count
                    ActiveDocument.Sections(i).ProtectedForForms = False
                Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    Exit Sub
errorhandle:
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||be3d||bc||fffd||fffd||2bd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub InsertFLEquationNum()
    On Error GoTo errorhandle
    'zle,2008-12-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||132||fffd||fffd||fffd|
    InProcess = True
    
    Dim i_First As Integer
    Dim i_Second As Integer
    
    If ActiveDocument.FormFields.Count > 10 Then
        'zle,2008-8-17,+3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c63||fffd||fffd|
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If

    Selection.HomeKey Unit:=wdLine
    Selection.HomeKey Unit:=wdLine
    Selection.TypeText Text:=vbTab
    Selection.EndKey Unit:=wdLine
    Selection.EndKey Unit:=wdLine
    'zle,2008-10-9,+1|fffd||fffd||fffd||fffd||3aa||fffd||437||5bd||6b7||fffd||fffd||fffd||fffd||fffd||fffd||539||fffd||fffd||fffd||fffd||4aa||fffd||fffd||1f0||fffd||1b6||fffd||4bb||fffd||fffd|
''    Selection.MoveLeft wdCharacter, 1
    Selection.TypeText Text:=vbTab
    Selection.TypeText Text:="()"
    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _
        PreserveFormatting:=False
    'zle,2008-8-28,+1,|fffd||fffd||fffd||fffd||fffd||fffd||138|
    Selection.TypeText Text:="STYLEREF  |fffd||fffd||bc||fffd||fffd||2b6| \l \n \t \* MERGEFORMAT"
    Selection.Fields.Update
 
    Selection.MoveRight wdCharacter, 1
    Selection.TypeText "."
    'zle,2008-10-3,+begin,|fffd||436||fffd||fffd||1f7||fffd||fffd||47e||fffd||fffd||439||fffd||2bd|
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    Dim iNumF As Integer
    Dim iNumS As Integer
    
    'zle,2008-10-7,+end
    Selection.MoveUp wdLine, 1
    Do While Selection.Style <> "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
        
        Selection.MoveUp wdLine, 1
        If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Then
            'zle,2008-10-7,+4,|fffd||635||fffd||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
            If ActiveDocument.Bookmarks.Exists("DW") Then
                Selection.GoTo what:=wdGoToBookmark, Name:="DW"
                ActiveDocument.Bookmarks("DW").Delete
            End If
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _
            PreserveFormatting:=False
            Selection.TypeText Text:="seq |fffd||fffd||bc||fffd||fffd||2bd| \r 1"
            Selection.Fields.Update
            
            Selection.HomeKey Unit:=wdLine
            Selection.MoveRight wdSentence, 1, wdExtend
            Selection.Style = "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
            Selection.EndKey
            Selection.TypeParagraph
            Selection.TypeText "|2bd||fffd||423||fffd|"
            Selection.TypeParagraph
            
            With ActiveDocument.Bookmarks
                .Add Name:="First", Range:=Selection.Range
                .DefaultSorting = wdSortByLocation
                .ShowHidden = True
            End With
            'zle,2008-10-9,+begin,|fffd||436||fffd||fffd||1f7||fffd||fffd||6b1||fffd||fffd|1|fffd||fffd||fffd||6ef9||fffd||431||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43c||fffd||fffd||fffd||fffd||fffd||fffd|
            Selection.MoveDown wdLine, 1
            Do While Selection.Style <> "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
xh:             Selection.HomeKey wdLine
                Selection.EndKey wdStory, wdExtend
                i_First = Selection.Range.Characters.Count
                Selection.MoveLeft , 1
                
                Selection.MoveDown wdLine, 1
                Selection.HomeKey wdLine
                Selection.EndKey wdStory, wdExtend
                i_Second = Selection.Range.Characters.Count
                Selection.MoveLeft , 1
                
                If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
                Else
                    Selection.MoveUp , 1
                End If
                If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Then
                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
                ElseIf Selection.Style = "|fffd||3bf||fffd||fffd||fffd||fffd||fffd|" Then
                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
                ElseIf Selection.Style = "|fffd||3bf||fffd||fffd||fffd||fffd||5e1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
                ElseIf Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
                '|fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||13d||fffd||3b2|
                
                ElseIf ((i_First = i_Second + 1) And i_First <= 5) Or (i_First = i_Second) Then          '|2f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||129||3b2|

                    If ActiveDocument.Bookmarks.Exists("First") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="First"
                        ActiveDocument.Bookmarks("First").Delete
                    End If
                    GoTo gx
'
                End If
                Selection.MoveDown wdLine, 1
            Loop
            'zle,09-24,+begin,
            With ActiveDocument.Bookmarks
                .Add Range:=Selection.Range, Name:="NUM1"
                .DefaultSorting = wdSortByLocation
                .ShowHidden = True
            End With
            
            iNumF = Selection.Range.Information(wdFirstCharacterLineNumber)
            Selection.GoTo what:=wdGoToEquation, Which:=wdGoToNext, Count:=1, Name:=""
            iNumS = Selection.Range.Information(wdFirstCharacterLineNumber)
            If iNumF <> iNumS Then
                    If ActiveDocument.Bookmarks.Exists("NUM1") Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="NUM1"
                        ActiveDocument.Bookmarks("NUM1").Delete
                    End If
                GoTo xh
            End If
            'zle,09-24,+end
            '|fffd||fffd||fffd||b2||fffd||fffd||fffd||fffd||4b5||fffd||fffd||fffd||fffd||438||fffd||bc||fffd||fffd||2bd|
            Selection.EndKey wdLine
            Selection.MoveLeft , 1
            Selection.TypeBackspace
            Selection.TypeBackspace
            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _
                PreserveFormatting:=False
            Selection.TypeText Text:="seq |fffd||fffd||bc||fffd||fffd||2bd| "
            Selection.Fields.Update
            If ActiveDocument.Bookmarks.Exists("First") Then
                Selection.GoTo what:=wdGoToBookmark, Name:="First"
                ActiveDocument.Bookmarks("First").Delete
            End If
            
            'zle,2008-10-9,+end
            GoTo gx
        End If
    Loop

    If ActiveDocument.Bookmarks.Exists("DW") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="DW"
        ActiveDocument.Bookmarks("DW").Delete
    End If
        
    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _
    PreserveFormatting:=False
    Selection.TypeText Text:="seq |fffd||fffd||bc||fffd||fffd||2bd| "
    Selection.Fields.Update
    Selection.MoveRight wdCharacter, 1
    'zle,2008-10-3,+end
    Selection.HomeKey Unit:=wdLine
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    Selection.Style = "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|"
    
    Selection.EndKey
    Selection.TypeParagraph
    Selection.TypeText "|2bd||fffd||423||fffd|"
    Selection.TypeParagraph
    'zle,2008-9-24,+1,|fffd||fffd||fffd||436||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd|
gx:
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BK"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    UpdateFieldTCS
    Selection.GoTo what:=wdGoToBookmark, Name:="BK"
    ActiveDocument.Bookmarks("BK").Delete
    Dim i As Integer
    i = 1
    If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
                For i = 2 To ActiveDocument.Sections.Count
                    ActiveDocument.Sections(i).ProtectedForForms = False
                Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    'zle,2008-12-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||132||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,2008-12-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||132||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
'zle,2008-8-17,+end

'=============================================================================
'==Function:|fffd||fffd||fffd||b9||fffd||2bd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub UpdateEquationNumTCS()

    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    
    Dim tempRange As Range
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    With frmUpDate
        .Show 0
        .Label3.Width = Int(28)
        .Label4.Caption = CStr(10) + "%"
        DoEvents
    End With
    Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
    Selection.EndKey
    Selection.EndKey wdStory, wdExtend
    Set tempRange = Selection.Range
    
    With frmUpDate
        .Label3.Width = Int(57)
        .Label4.Caption = CStr(20) + "%"
        DoEvents
    End With
    Dim i As Integer
    Dim fieldsCount As Integer
    fieldsCount = tempRange.Fields.Count
    For i = 1 To tempRange.Fields.Count
        If tempRange.Fields(i).Type = 12 Then
            tempRange.Fields(i).Select
            Selection.MoveRight , 1
            With ActiveDocument.Bookmarks
                .Add Range:=Selection.Range, Name:="DW"
                .DefaultSorting = wdSortByLocation
                .ShowHidden = True
            End With
            Selection.Find.ClearFormatting
            With Selection.Find
                .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
                .Forward = False
                .Wrap = wdFindStop
                .Format = True
                .MatchCase = False
                .MatchWholeWord = False
                .MatchByte = True
                .MatchWildcards = False
                .MatchSoundsLike = False
                .MatchAllWordForms = False
                .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
            End With
            Selection.Find.Execute
            If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
                If tempRange.Fields(i).Result = "1" Then
                    Selection.GoTo what:=wdGoToBookmark, Name:="DW"
                Else
                    If Val(tempRange.Fields(i).Result) <> 0 Then
                        Selection.GoTo what:=wdGoToBookmark, Name:="DW"
                        Do
                            Selection.MoveUp wdLine, 1
                            If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
                                Exit Do
                            End If
                        Loop While Selection.Style <> "|fffd||fffd||bc||fffd||fffd||2b6|"
                        If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2bd||fffd||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
                            ActiveDocument.Bookmarks("DW").Delete
                            tempRange.Fields(i).Update
                        Else
                            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
                            ActiveDocument.Bookmarks("DW").Delete
                            tempRange.Fields(i).Delete
                            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, PreserveFormatting:=False
                            Selection.TypeText Text:="seq |fffd||fffd||bc||fffd||fffd||2bd| \r 1"
                            Selection.Fields.Update
                        End If
                    End If
                End If
                    
                frmUpDate.Label3.Width = Int(i / fieldsCount * 200) + 57
                frmUpDate.Label4.Caption = CStr(Int(i / fieldsCount * 70) + 20) + "%"
                DoEvents
             
            Else
                ActiveDocument.Bookmarks("DW").Delete
                tempRange.Fields(i).Update
                frmUpDate.Label3.Width = Int(i / fieldsCount * 200) + 57
                frmUpDate.Label4.Caption = CStr(Int(i / fieldsCount * 70) + 20) + "%"
                DoEvents
            End If
         End If
    Next
    With frmUpDate
        .Label3.Width = Int(257)
        .Label4.Caption = CStr(90) + "%"
        DoEvents
    End With
    If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
                For i = 2 To ActiveDocument.Sections.Count
                    ActiveDocument.Sections(i).ProtectedForForms = False
                Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    With frmUpDate
        .Label3.Width = Int(285)
        .Label4.Caption = CStr(100) + "%"
        DoEvents
    End With
    Unload frmUpDate
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||435||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub UpdateFieldTCS()

    With frmUpDate
        .Show 0
        .Label3.Width = Int(84)
        .Label4.Caption = CStr(30) + "%"
        DoEvents
    End With
    
    Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
    Selection.EndKey
    Selection.EndKey wdStory, wdExtend

    
    With frmUpDate
        .Label3.Width = Int(168)
        .Label4.Caption = CStr(60) + "%"
        DoEvents
    End With
    
    Selection.Fields.Update

    With frmUpDate
        .Label3.Width = Int(285)
        .Label4.Caption = CStr(100) + "%"
        DoEvents
    End With
    Unload frmUpDate
    
End Sub


'=============================================================================
'==Function:|fffd||fffd||4e1||524||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub PrintPreviewTCS()
    ActiveDocument.PrintPreview
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||b1||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertCharacter()
    On Error GoTo errorhandle
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1
    
    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With

    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then

        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||b1||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||b1||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
    End If
    
    InProcess = False
    Exit Sub
errorhandle:
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub InsertFirTitle()
    On Error GoTo errorhandle
    
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1
    
    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If

        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub InsertSecTitle()
    On Error GoTo errorhandle
    
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1
    
    InProcess = True
    
    Selection.HomeKey
'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertThiTitle()
    On Error GoTo errorhandle
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1
    
    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub
'zle,2008-9-27,+end

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertForTitle()
    On Error GoTo errorhandle
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1
    
    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||5f36||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFifTitle()
    On Error GoTo errorhandle
    
    'zle,090812,+3
    If GetSecNum = 0 Then
        Exit Sub
    End If
    
    Selection.ClearFormatting
    
    'zle,090807,+10,|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8cf8||fffd||fffd||fffd||2b1|tempSelRan
    Dim str As String
    Dim tempSelRan As Range
    Dim iCountPara As Integer
    Dim i As Integer
    Dim strLength As Integer
    Dim strIndex As Integer
    
    Set tempSelRan = Selection.Range
    str = Selection.Range
    strLength = Len(str)
    i = 1

    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||fffd||bc||fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end
        
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If

        'zle,090807,+begin,|fffd||436||3f5||fffd||fffd||43b||fffd||fffd||1f6||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||2bd|
        Do While i <> 0
            i = InStr(i + 1, str, Chr$(13), vbTextCompare)
            If i <> 0 Then
                iCountPara = iCountPara + 1
                strIndex = i
            End If
        Loop
        
        If strIndex < strLength Then
            iCountPara = iCountPara + 1
        End If
        
        If iCountPara <= 1 Then
            Selection.Style = ActiveDocument.Styles("|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|")
        Else
            tempSelRan.Select
            Selection.MoveLeft , 1
            
            For i = 1 To iCountPara
                Selection.Style = "|fffd||5f36||fffd||fffd||fffd||fffd||fffd||fffd|"
                Selection.MoveDown wdParagraph, 1
            Next
        End If
        tempSelRan.Select
        'zle,090807,+end

    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||37c||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertFigTitle()
    On Error GoTo errorhandle
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|")
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|")
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||f8||fffd||2bd||3aa| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||277||5b1||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||bc|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTblTitle()
    On Error GoTo errorhandle
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    
    Selection.HomeKey
    'zle,2008-10-7,+begin,|368||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||f5||fffd||1f0||fffd||fffd||3bb||fffd||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    'zle,2008-10-7,+end
    Selection.Find.ClearFormatting
    With Selection.Find
        .Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||2b6|")
        .Forward = False
        .Wrap = wdFindStop
        .Format = True
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        .Execute FindText:="|fffd||538||fffd||bc||fffd||fffd|"
    End With
    Selection.Find.Execute
    If Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" And Selection.Text = "|fffd||538||fffd||bc||fffd||fffd|" Then
    'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|")
        Exit Sub
    Else
        'zle,2008-10-7,+4,|fffd||634||fffd||572||fffd||fffd||fffd||fffd||fffd||1e9||fffd||135||637||fffd|,|fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||1e9|
        If ActiveDocument.Bookmarks.Exists("DW") Then
            Selection.GoTo what:=wdGoToBookmark, Name:="DW"
            ActiveDocument.Bookmarks("DW").Delete
        End If
        Selection.Style = ActiveDocument.Styles("|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|")
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    Exit Sub
errorhandle:
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
    
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||fffd|"
End Sub

'=============================================================================
'==Function:|fffd||fffd||2be| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e871||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub ShowfrmMarkIndex()
    frmMarkIndex.Show 0
End Sub

'=============================================================================
'==Function:|fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||5ae||1f0||fffd||fffd||22b||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||1f5||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub DelBeoforeMarkAll()

    Dim MoveBK As String
    Dim findFlag As Boolean
    MoveBK = "StandardName"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
    ActiveWindow.View.ShowHiddenText = True
    g_FindCount = 0
    Do
        If findFlag = False Then
            With Selection.Find
                .ClearFormatting
                .Text = "^d xe " + Chr(34) + g_IndexText + Chr(34)
                .Wrap = wdFindStop
                .Forward = True
                .Format = False
            End With
            findFlag = True
            Selection.Find.Execute
        End If
        Selection.Range.Select
        If Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
            Exit Do
        End If
        Selection.Delete
        g_FindCount = g_FindCount + 1
    Loop While Selection.Find.Execute(FindText:="^d xe " + Chr(34) + g_IndexText + Chr(34), Forward:=True, Wrap:=wdFindStop)
    ActiveWindow.View.ShowHiddenText = False

    
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub MarkIndexItems()

    Dim strTitle1 As String
    Dim strTitle2 As String
    

    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    g_SYGS = ""
    g_strTitle = ""
    '|5bb||fffd||fffd||fffd||4bb||fffd||fffd|
    If g_MarkOrAll = 1 Then

        Selection.Range.Select
        Selection.MoveRight , 1
        
        'GetIndexTitleAll
        '09-06-14|fffd||132||fffd||fffd||4ba||fffd||fffd||fffd|
        GetIndexTitleSignle
        
        'zle,2008-11-2,+begin,|fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||1f0||fffd||521||fffd||fffd||fffd||fffd||521||fffd||13f||fffd||3b2||fffd||fffd||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If g_strTitle = "" Then
            Exit Sub
        End If
        'zle,2008-11-2,+end
        ActiveWindow.ActivePane.View.ShowAll = True
        
        'zle,09-06-14,|fffd||436||fffd||fffd||1f7||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||2e3||fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||2e3||fffd||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b1||fffd||fffd|
        Selection.MoveRight , 1, wdExtend
        If InStr(Selection.Range.Text, "XE") <> 0 Then
            Selection.Delete
        Else
            Selection.MoveLeft , 1
        End If
        
        ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
        EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
        "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
        
            ActiveWindow.ActivePane.View.ShowAll = Not ActiveWindow.ActivePane.View. _
        ShowAll
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else
        'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
        InProcess = True
        'zle,09-06-12,|fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||5ae||1f0||fffd||fffd||fffd||fffd||22b||fffd||fffd||27e||fffd||fffd|
        DelBeoforeMarkAll
        
        Dim findPar As Paragraph
        Dim findRan As Range
        Dim iParaCount As Integer
        Dim i As Integer

        g_ZhuFirst = 0
        For Each findPar In ActiveDocument.Paragraphs
            iParaCount = iParaCount + 1
            If findPar.Style = "|fffd||b1||fffd||fffd||fffd|" Then
                Exit For
            End If
        Next
        With frmMarkIndex
            .lblWid.Width = Int(27)
            .lblJD.Caption = CStr(15) + "%"
            DoEvents
        End With
        Dim strZW As String
        Dim strFL As String
        Dim strTempDu As String
        Dim inCrementWid As Integer
        Dim inCrementCap As Integer
        Dim strTitleArry As String
        inCrementWid = 27
        inCrementCap = 15
        strTempDu = ""
        strTitleArry = ""
        For i = iParaCount To ActiveDocument.Paragraphs.Count
            Set findRan = ActiveDocument.Paragraphs(i).Range
            With findRan.Find
                .ClearFormatting
                .Text = g_IndexText
                .Wrap = wdFindStop
                .Forward = True
            End With
            If findRan.Find.Execute = True Then
                findRan.Select
                
                If Selection.Style = "|fffd||b1||fffd||fffd||fffd|" Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Or Selection.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|" Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                    
                    GetIndexTitleAll
                    
                    strTitle1 = g_strTitle
                    strTitleArry = "," + strTitle1 + "," + strTitleArry
                    
                    ActiveWindow.ActivePane.View.ShowAll = True

                    ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                            EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
                            "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                    g_ZhuFirst = g_ZhuFirst + 1
                    If g_ZhuFirst Mod 2 = 0 Then
                        inCrementWid = inCrementWid + 2
                        inCrementCap = inCrementCap + 1
                        With frmMarkIndex
                            .lblWid.Width = Int(inCrementWid)
                            .lblJD.Caption = CStr(inCrementCap) + "%"
                            DoEvents
                        End With
                    End If
                ElseIf Selection.Style = "|fffd||fffd||fffd||fffd| 1" Then
                    Exit For
                Else
                    If Selection.Information(wdWithInTable) Then
                    Else
                    
                        GetIndexTitleBasedonUnTitle
                        
                        strTitle2 = g_SYGS
                        If strTitle1 = "" And strTitle2 = "" Then
                        Else
                            If InStr(strTitleArry, "," + strTitle2 + ",") = 0 Then
                                If strTitle2 <> strTempDu Then
                                    
                                    ActiveWindow.ActivePane.View.ShowAll = True
                                    ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                                    EntryAutoText:=g_IndexText, CrossReference:=g_SYGS, CrossReferenceAutoText:= _
                                    "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                                    g_ZhuFirst = g_ZhuFirst + 1
                                    strTempDu = strTitle2
                                    If g_ZhuFirst Mod 2 = 0 Then
                                        inCrementWid = inCrementWid + 2
                                        inCrementCap = inCrementCap + 1
                                        With frmMarkIndex
                                            .lblWid.Width = Int(inCrementWid)
                                            .lblJD.Caption = CStr(inCrementCap) + "%"
                                            DoEvents
                                        End With
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        Next
        With frmMarkIndex
            .lblWid.Width = Int(72)
            .lblJD.Caption = CStr(40) + "%"
            DoEvents
        End With

        Dim inWid As Integer
        Dim inCap As Integer
        Dim tempWid As Integer
        Dim tempCap As Integer
        tempWid = 72
        tempCap = 40

        Dim tbSum As Integer
        Dim flTbSum As Integer
        Dim iTableCount As Integer
        tbSum = 0
        flTbSum = 0
        iTableCount = 0
        Dim k As Integer
        Dim celTable As Cell
        Dim celRange As Range
        '|fffd||436||fffd||fffd||135||fffd||fffd||435||131||fffd||fffd||fffd|
        '1.|fffd||fffd||fffd||2f7||fffd||fffd||fffd|
        If ActiveDocument.FormFields.Count > 10 Then
            '(1) |fffd||436||fffd||fffd||1f9||fffd||fffd||4b1||fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||63a79||fffd||fffd||fffd||fffd||435||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|12|fffd||fffd||fffd||fffd||fffd||fffd||4b5||fffd||136||fffd||fffd||fffd|17|fffd||fffd|
            If ActiveDocument.FormFields.Count < 15 Then
                '1..|fffd||135||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|
                If ActiveDocument.Tables.Count - 2 > 0 Then
                    iTableCount = ActiveDocument.Tables.Count - 2
                    For k = 3 To ActiveDocument.Tables.Count
                        ActiveDocument.Tables(k).Cell(1, 1).Select
                        'zle,2008-11-29,+begin,|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        tempWid = tempWid + 2
                        tempCap = tempCap + 1
                        With frmMarkIndex
                            .lblWid.Width = Int(tempWid)
                            .lblJD.Caption = CStr(tempCap) + "%"
                            DoEvents
                        End With
                         'zle,2008-11-29,+end
                        '|fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd|
                        GetIndexTitleAll
                        If InStr(g_strTitle, "|fffd||fffd|") = 0 Then
                            MsgBox "|fb||fffd||438||fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                            Exit Sub
                        End If
                        '|2f5||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||433||fffd||fffd||5b8||f4||2a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||4b5||fffd||52a||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||438||f4||fffd|
                        If InStr(strTitleArry, "," + g_strTitle + ",") = 0 Then
                            For Each celTable In ActiveDocument.Tables(k).Range.Cells
                                Set celRange = ActiveDocument.Range(Start:=celTable.Range.Start, End:=celTable.Range.End - 1)
                                If InStr(celRange.Text, g_IndexText) <> 0 Then
                                    celRange.Select
                                    'zle,2008-12-4,+7|fffd||6b5||fffd||52a||fffd||fffd||fffd||436||fffd||3bb||fffd||fffd||fffd||5b5||133||fffd||fffd||fffd||3bb||fffd||fffd|
                                    Selection.Find.ClearFormatting
                                    With Selection.Find
                                        .Text = g_IndexText
                                        .Forward = True
                                        .Wrap = wdFindStop
                                    End With
                                    Selection.Find.Execute
                                    ActiveWindow.ActivePane.View.ShowAll = True
                                    ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                                    EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
                                    "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                                    g_ZhuFirst = g_ZhuFirst + 1
                                    Exit For
                                   
                                End If
                            Next
                        End If
                    Next
                End If
            '(2) |fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Else
                '1..|fffd||135||fffd||fffd||fffd||fffd||431||fffd||fffd||fffd|
                If ActiveDocument.Tables.Count - 3 > 0 Then
                    iTableCount = ActiveDocument.Tables.Count - 3
                    For k = 4 To ActiveDocument.Tables.Count
                        ActiveDocument.Tables(k).Cell(1, 1).Select
                        'zle,2008-11-29,+begin,|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        tempWid = tempWid + 2
                        tempCap = tempCap + 1
                        With frmMarkIndex
                            .lblWid.Width = Int(tempWid)
                            .lblJD.Caption = CStr(tempCap) + "%"
                            DoEvents
                        End With
                         'zle,2008-11-29,+end
                        '|fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd|
                        GetIndexTitleAll
                        If InStr(g_strTitle, "|fffd||fffd|") = 0 Then
                            MsgBox "|fb||fffd||438||fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                            Exit Sub
                        End If
                        '|2f5||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||433||fffd||fffd||5b8||f4||2a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||4b5||fffd||52a||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||438||f4||fffd|
                        If InStr(strTitleArry, "," + g_strTitle + ",") = 0 Then
                            For Each celTable In ActiveDocument.Tables(k).Range.Cells
                                Set celRange = ActiveDocument.Range(Start:=celTable.Range.Start, End:=celTable.Range.End - 1)
                                If InStr(celRange.Text, g_IndexText) <> 0 Then
                                    celRange.Select
                                    'zle,2008-12-4,+7|fffd||6b5||fffd||52a||fffd||fffd||fffd||436||fffd||3bb||fffd||fffd||fffd||5b5||133||fffd||fffd||fffd||3bb||fffd||fffd|
                                    Selection.Find.ClearFormatting
                                    With Selection.Find
                                        .Text = g_IndexText
                                        .Forward = True
                                        .Wrap = wdFindStop
                                    End With
                                    Selection.Find.Execute
                                    ActiveWindow.ActivePane.View.ShowAll = True
                                            ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                                            EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
                                            "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                                            g_ZhuFirst = g_ZhuFirst + 1

                                    Exit For
                                End If
                            Next
                        End If
                    Next
                End If
            End If
        '2.|fb||fffd||43c||4f7||fffd||fffd||fffd|
        Else
            If ActiveDocument.Tables.Count > 0 Then
                iTableCount = ActiveDocument.Tables.Count
                    For k = 1 To iTableCount
                        '|fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd|
                        ActiveDocument.Tables(k).Cell(1, 1).Select
                        'zle,2008-11-29,+begin,|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        tempWid = tempWid + 2
                        tempCap = tempCap + 1
                        With frmMarkIndex
                            .lblWid.Width = Int(tempWid)
                            .lblJD.Caption = CStr(tempCap) + "%"
                            DoEvents
                        End With
                        'zle,2008-11-29,+end
                        GetIndexTitleAll
                        If InStr(g_strTitle, "|fffd||fffd|") = 0 Then
                            MsgBox "|fb||fffd||438||fffd||fffd||f1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
                            Exit Sub
                        End If
                        '|2f5||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||433||fffd||fffd||5b8||f4||2a3||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||4b5||fffd||52a||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||438||f4||fffd|
                        If InStr(strTitleArry, "," + g_strTitle + ",") = 0 Then
                            For Each celTable In ActiveDocument.Tables(k).Range.Cells
                                Set celRange = ActiveDocument.Range(Start:=celTable.Range.Start, End:=celTable.Range.End - 1)
                                If InStr(celRange.Text, g_IndexText) <> 0 Then
                                    celRange.Select
                                    'zle,2008-12-4,+7|fffd||6b5||fffd||52a||fffd||fffd||fffd||436||fffd||3bb||fffd||fffd||fffd||5b5||133||fffd||fffd||fffd||3bb||fffd||fffd|
                                    Selection.Find.ClearFormatting
                                    With Selection.Find
                                        .Text = g_IndexText
                                        .Forward = True
                                        .Wrap = wdFindStop
                                    End With
                                    Selection.Find.Execute
                                    ActiveWindow.ActivePane.View.ShowAll = True
                                    ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                                    EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
                                    "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                                    g_ZhuFirst = g_ZhuFirst + 1

                                    Exit For
                                End If
                            Next
                        End If
                    Next
            End If
        End If
        With frmMarkIndex
            .lblWid.Width = Int(126)
            .lblJD.Caption = CStr(70) + "%"
            DoEvents
        End With
        tempWid = 126
        tempCap = 70
        '|fffd||436||fffd||fffd||135||fffd||fffd||435||fffd||37c||fffd||fffd||37c||5e2| |fffd||fffd| |37c||fffd||13d||fffd||5e2| |fffd||1f7||fffd||fffd||fffd|
        '***********************************
        Dim tempRange As Range
        Dim iNum As Integer

        For Each findPar In ActiveDocument.Paragraphs
            If findPar.Style = "|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|" Or findPar.Style = "|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|" Then
                findPar.Range.Select
                GetIndexTitleAll
                '|fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||433||fffd||fffd||5b9||fffd||fffd||fffd||fffd||fffd||1f5||fffd||fffd||e8ec||fffd||fffd||4aa||fffd||fffd||fffd||fffd| |37c||5e2| |fffd||fffd| |37c||fffd||13d||fffd||5e2| |fffd||1f7||fffd||fffd||423||fffd|
                If InStr(strTitleArry, "," + g_strTitle + ",") = 0 Then
                    Do
                        Selection.MoveUp wdLine, 1
                        Selection.EndKey
                        If ActiveDocument.Bookmarks.Exists("BKEnd") = False Then
                            With ActiveDocument.Bookmarks
                                .Add Range:=Selection.Range, Name:="BKEnd"
                                .DefaultSorting = wdSortByLocation
                                .ShowHidden = True
                            End With
                        End If
                        iNum = iNum + 1
                        If Selection.Style <> "|5e2||fffd||fffd|" And Selection.Style <> "|5e2||fffd||fffd||fffd||fffd|" And Selection.Style <> "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" Then
                            Exit Do
                        End If
                    Loop
                    If iNum = 1 Then
                        Selection.MoveDown wdLine, 1
                        Selection.EndKey
                        ActiveDocument.Bookmarks("BKEnd").Delete
                        iNum = 0
                    Else
                        Selection.MoveDown wdLine, 1
                        Selection.HomeKey
                        With ActiveDocument.Bookmarks
                            .Add Range:=Selection.Range, Name:="BKStart"
                            .DefaultSorting = wdSortByLocation
                            .ShowHidden = True
                        End With
                        iNum = 0

                        Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("BKStart").Start, End:=ActiveDocument.Bookmarks("BKEnd").End)
                        tempRange.Select
                        ActiveDocument.Bookmarks("BKStart").Delete
                        ActiveDocument.Bookmarks("BKEnd").Delete
                        Selection.Find.ClearFormatting
                        With Selection.Find
                            .Text = g_IndexText
                            .Replacement.Text = ""
                            .Forward = True
                            .Wrap = wdFindStop
                            .Format = False
                            .MatchCase = False
                            .MatchWholeWord = False
                            .MatchByte = True
                            .MatchWildcards = False
                            .MatchSoundsLike = False
                            .MatchAllWordForms = False
                        End With
                        If Selection.Find.Execute = True Then
                            Selection.MoveRight , 1
                            ActiveWindow.ActivePane.View.ShowAll = True
                            ActiveDocument.Indexes.MarkEntry Range:=Selection.Range, Entry:=g_IndexText, _
                            EntryAutoText:=g_IndexText, CrossReference:=g_strTitle, CrossReferenceAutoText:= _
                            "", BookmarkName:="", Bold:=False, Italic:=False, Reading:=""
                            g_ZhuFirst = g_ZhuFirst + 1
                            'zle,2008-11-29,+begin,|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            tempWid = tempWid + 2
                            tempCap = tempCap + 1
                            With frmMarkIndex
                                .lblWid.Width = Int(tempWid)
                                .lblJD.Caption = CStr(tempCap) + "%"
                                DoEvents
                            End With
                             'zle,2008-11-29,+end
                        Else
                            Selection.MoveRight , 1
                        End If
                    End If
                End If
            End If
        Next
        
        'zle,2008-11-10,+end
    End If
    With frmMarkIndex
        .lblWid.Width = Int(162)
        .lblJD.Caption = CStr(90) + "%"
        DoEvents
    End With
    If ActiveDocument.FormFields.Count > 10 Then
        ActiveDocument.Sections(1).ProtectedForForms = True
        For i = 2 To ActiveDocument.Sections.Count
            ActiveDocument.Sections(i).ProtectedForForms = False
        Next
        ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
             wdAllowOnlyFormFields
             
        If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
            ClsEvent.CmdPROTECTC.FaceId = 277
            ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    End If
    ActiveWindow.View.ShowHiddenText = False           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b2||fffd||fffd||fffd||2be|
    ActiveWindow.ActivePane.View.ShowAll = False '|fffd||fffd||2be|/|fffd||fffd||fffd||631||fffd||1f2||fffd||fffd||fffd||2be|
    'zle,09-06-19,|fffd||436||3f0||6c7e||fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
    If Application.Version <> "12.0" Then
'        ActiveWindow.View.ShowParagraphs = False       '|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
'    Else
        ActiveWindow.View.ShowParagraphs = True
    End If
    
'    'zle,09-07-09,+1,|fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd|
    Selection.MoveRight , 1
    Selection.MoveLeft , 1
    
    With frmMarkIndex
        .lblWid.Width = Int(180)
        .lblJD.Caption = CStr(100) + "%"
        DoEvents
    End With
    InProcess = False
'    'zle,2008-12-2,+1,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    frmMarkIndex.Enabled = True

End Sub

'=============================================================================
'==Function:|22b||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||2bd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub GetIndexTitleAll()
    Dim myRange As Range
    Dim ListParas As ListParagraphs
    Dim myString As String
    Set myRange = Selection.Paragraphs(1).Range
    myRange.SetRange 0, myRange.End
    Set ListParas = myRange.ListParagraphs
    Set myRange = ListParas(ListParas.Count).Range
    myString = myRange.ListFormat.ListString

    myString = Trim(myString)
    Dim str_Find As String
    Dim str_FindIn As String
    Dim str_FindText As String
    Dim int_Count As Integer
    Dim str_FindDot As String
    
    str_FindDot = "."
    str_FindText = "|fffd||fffd|"
    str_Find = myString
    
    'zle,09-06-13,+5
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="BJSY"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    
    If InStr(str_Find, str_FindDot) <> 0 Then
        g_strTitle = Trim(myString)
        Exit Sub
    ElseIf InStr(str_Find, str_FindText) <> 0 Then
        g_strTitle = Trim(myString)
        Exit Sub
    Else
        While InStr(str_Find, ")") <> 0 Or InStr(str_Find, "|fffd||fffd||fffd||fffd|") <> 0 Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|" Or InStr(str_Find, "|5e2|") <> 0 Or myRange.Style = "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|"
            Selection.MoveUp wdLine, 1
'            int_Count = int_Count + 1
            Set myRange = Selection.Paragraphs(1).Range
            myRange.SetRange 0, myRange.End
            Set ListParas = myRange.ListParagraphs
            Set myRange = ListParas(ListParas.Count).Range
            myString = myRange.ListFormat.ListString
            myString = Trim(myString)
            str_Find = myString
        Wend
        g_strTitle = Trim(myString)
'        Selection.MoveDown wdLine, int_Count
        'zle,09-06-13,+2
        Selection.GoTo what:=wdGoToBookmark, Name:="BJSY"
        ActiveDocument.Bookmarks("BJSY").Delete
        Exit Sub
    End If
    g_strTitle = Trim(myString)
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub GetIndexTitleSignle()
    Dim myRange As Range
    Dim ListParas As ListParagraphs
    Dim myString As String
    Dim str_Find As String
    Set myRange = Selection.Paragraphs(1).Range
    myRange.SetRange 0, myRange.End
    Set ListParas = myRange.ListParagraphs
    Set myRange = ListParas(ListParas.Count).Range
    myString = myRange.ListFormat.ListString

    myString = Trim(myString)
    str_Find = myString
    
    If Selection.Style = "|fffd||b1||fffd||fffd||fffd|" Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
        Or Selection.Style = "|fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Or Selection.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|" _
        Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
        Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||37c||fffd||fffd||fffd||fffd|" _
        Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" _
        Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Then
        
        g_strTitle = Trim(myString)
        Exit Sub
    End If
    
    '|2f5||fffd||fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||5e2|
    If Selection.Style <> "|5e2||fffd||fffd||fffd||fffd|" And Selection.Style <> "|5e2||fffd||fffd|" And Selection.Style <> "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" Then
        Dim str_FindIn As String
        Dim str_FindText As String
    
        str_Find = myString

        With ActiveDocument.Bookmarks
            .Add Range:=Selection.Range, Name:="BJSY"
            .DefaultSorting = wdSortByLocation
            .ShowHidden = True
        End With
     While InStr(str_Find, ")") <> 0 Or InStr(str_Find, "|fffd||fffd||fffd||fffd|") <> 0 Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|" _
            Or InStr(str_Find, "|fffd||fffd|") <> 0 Or InStr(str_Find, "|37c|") <> 0 Or InStr(str_Find, "|5e2|") <> 0 Or Selection.Style = "|fffd||fffd|" Or InStr(str_Find, "|2be||fffd||fffd|") <> 0
tt:        If InStr(str_Find, "|5e2|") <> 0 Then
                While InStr(str_Find, "|5e2|") <> 0
                    Selection.MoveUp wdLine, 1
                    Set myRange = Selection.Paragraphs(1).Range
                    myRange.SetRange 0, myRange.End
                    Set ListParas = myRange.ListParagraphs
                    Set myRange = ListParas(ListParas.Count).Range
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
                Wend
            Else
                Selection.MoveUp wdLine, 1
            End If
            Set myRange = Selection.Paragraphs(1).Range
            myRange.SetRange 0, myRange.End
            Set ListParas = myRange.ListParagraphs
            Set myRange = ListParas(ListParas.Count).Range
            myString = myRange.ListFormat.ListString
            myString = Trim(myString)
            str_Find = myString
            If InStr(str_Find, "|5e2|") = 0 Then
                If myRange.Style = "|fffd||b1||fffd||fffd||fffd|" Or myRange.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Or myRange.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or Selection.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
                    g_strTitle = Trim(myString)
                    
                    Selection.GoTo what:=wdGoToBookmark, Name:="BJSY"
                    ActiveDocument.Bookmarks("BJSY").Delete
                    Exit Sub
                End If
                If myRange.Style = "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" Then
                    GoTo tt
                End If
            End If

        Wend
    '|fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||5e2|
    Else
        With ActiveDocument.Bookmarks
            .Add Range:=Selection.Range, Name:="BJSY"
            .DefaultSorting = wdSortByLocation
            .ShowHidden = True
        End With
        '|fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||5e2|X|fffd||fffd||fffd||fffd||fffd||6b1||fffd||fffd||fffd||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1b6||fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||3aa||5b9|
        If Selection.Information(wdWithInTable) Then
            While InStr(str_Find, "|fffd||fffd|") = 0
                    Selection.MoveUp wdLine, 1
                    Set myRange = Selection.Paragraphs(1).Range
                    myRange.SetRange 0, myRange.End
                    Set ListParas = myRange.ListParagraphs
                    Set myRange = ListParas(ListParas.Count).Range
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
            Wend
            g_strTitle = Trim(str_Find)
            Selection.GoTo what:=wdGoToBookmark, Name:="BJSY"
            ActiveDocument.Bookmarks("BJSY").Delete
            Exit Sub
        '|fffd||fffd||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||5e2|X|fffd||fffd||fffd||fffd||fffd||fffd||37c||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1b6||fffd||fffd||fffd||5b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||2871||3aa||5b9|
        Else
            While InStr(str_Find, "|37c|") = 0
                    Selection.MoveDown wdLine, 1
                    Set myRange = Selection.Paragraphs(1).Range
                    myRange.SetRange 0, myRange.End
                    Set ListParas = myRange.ListParagraphs
                    Set myRange = ListParas(ListParas.Count).Range
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
            Wend
            g_strTitle = Trim(str_Find)
            Selection.GoTo what:=wdGoToBookmark, Name:="BJSY"
            ActiveDocument.Bookmarks("BJSY").Delete
            Exit Sub
        End If
    End If

End Sub

'=============================================================================
'==Function:|22b||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd| |fffd||1f1||fffd||fffd||fffd||2bd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub GetIndexTitleBasedonUnTitle()
    Dim myRange As Range
    Dim ListParas As ListParagraphs
    Dim myString As String
    Dim str_Find As String
    Set myRange = Selection.Paragraphs(1).Range
    myRange.SetRange 0, myRange.End
    Set ListParas = myRange.ListParagraphs
    Set myRange = ListParas(ListParas.Count).Range
    myString = myRange.ListFormat.ListString

    myString = Trim(myString)
    str_Find = myString

    '|2f5||fffd||fffd||fffd||fffd||fffd||fffd||37c||fffd||fffd||fffd||5e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd||5e2|
    If Selection.Style <> "|5e2||fffd||fffd||fffd||fffd|" And Selection.Style <> "|5e2||fffd||fffd|" Then
        Dim str_FindIn As String
        Dim str_FindText As String
    
        str_Find = myString
        Selection.MoveRight , 1
        With ActiveDocument.Bookmarks
            .Add Range:=Selection.Range, Name:="BJSY"
            .DefaultSorting = wdSortByLocation
            .ShowHidden = True
        End With
     While InStr(str_Find, ")") <> 0 Or InStr(str_Find, "|fffd||fffd||fffd||fffd|") <> 0 Or Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or Selection.Style = "|fffd||fffd||fffd||fffd||63a36||fffd||fffd||fffd||fffd||fffd|" _
            Or InStr(str_Find, "|fffd||fffd|") <> 0 Or InStr(str_Find, "|37c|") <> 0 Or InStr(str_Find, "|5e2|") <> 0 Or Selection.Style = "|fffd||fffd|" Or InStr(str_Find, "|2be||fffd||fffd|") <> 0
tt:        If InStr(str_Find, "|5e2|") <> 0 Then
                While InStr(str_Find, "|5e2|") <> 0
                    Selection.MoveUp wdLine, 1
                    Set myRange = Selection.Paragraphs(1).Range
                    myRange.SetRange 0, myRange.End
                    Set ListParas = myRange.ListParagraphs
                    Set myRange = ListParas(ListParas.Count).Range
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
                Wend
            Else
                Selection.MoveUp wdLine, 1
            End If
            Set myRange = Selection.Paragraphs(1).Range
            myRange.SetRange 0, myRange.End
            Set ListParas = myRange.ListParagraphs
            Set myRange = ListParas(ListParas.Count).Range
            myString = myRange.ListFormat.ListString
            myString = Trim(myString)
            str_Find = myString
            If InStr(str_Find, "|5e2|") = 0 Then
            
                If myRange.Style = "|fffd||b1||fffd||fffd||fffd|" Or myRange.Style = "|4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||2b6|" Or myRange.Style = "|fffd||fffd||bc||fffd||b1||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|4bb||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||4bb||fffd||fffd||fffd||fffd|" Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" _
                    Or myRange.Style = "|fffd||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|" Then
                    
                    myString = myRange.ListFormat.ListString
                    myString = Trim(myString)
                    str_Find = myString
                    g_SYGS = Trim(myString)
                    
                    Selection.GoTo what:=wdGoToBookmark, Name:="BJSY"
                    ActiveDocument.Bookmarks("BJSY").Delete
                    Exit Sub
                End If
                If myRange.Style = "|37c||fffd||fffd||fffd||fffd||5e2||2f5||fffd||fffd|" Then
                    GoTo tt
                End If
            End If

        Wend
    End If
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub InsertTCSIndex()
    WordBasic.FormatField Field:="INDEX \e """ & vbTab & """ \c ""1"" \h ""A"" \o ""P"" \y \z ""2052""  "

'    With ActiveDocument
'        .Indexes.Add Range:=Selection.Range, HeadingSeparator:= _
'            wdHeadingSeparatorLetter, Type:=wdIndexIndent, RightAlignPageNumbers _
'            :=True, NumberOfColumns:=1, SortBy:=wdIndexSortBySyllable, _
'            IndexLanguage:=wdSimplifiedChinese
'        .Indexes(1).TabLeader = wdTabLeaderDots
'    End With
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub ProcessIndexFormat()
    
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    Dim MoveBK As String

    MoveBK = "BKSY"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
    Selection.MoveRight wdCharacter, 1
    
    'zle,09-06-18,+|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd|
    With frmUpDate
        .Show 0
    End With
    
    'zle,090609,+|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    InsertTCSIndex
    
    'zle,090609,|fffd||fffd||fffd||4fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3bb||fffd||fffd|
    With frmUpDate
        .Label3.Width = Int(86)
        .Label4.Caption = CStr(30) + "%"
        DoEvents
    End With
    
    'zle,2008-11-19,+4,|fffd||fffd||fffd||fffd||27e||fffd||fffd||52d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If ActiveDocument.FormFields.Count > 10 Then
        Selection.EndKey wdStory, wdExtend
        Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
        Selection.EndKey Unit:=wdLine, Extend:=wdExtend
        If Selection.Range.Characters.Count >= 4 Then
            Selection.Range.Delete
        Else
            Selection.MoveRight , 1
            If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
                Selection.MoveLeft , 1
            End If
        End If
    Else
        Selection.EndKey wdStory, wdExtend
        If Selection.Range.Characters.Count >= 4 Then
'            Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend
'            Selection.EndKey Unit:=wdLine, Extend:=wdExtend
            Selection.Range.Delete
        Else
            Selection.MoveRight , 1
        End If
    End If
    
    With frmUpDate
        .Label3.Width = Int(115)
        .Label4.Caption = CStr(40) + "%"
        DoEvents
    End With
    
    
    'zle,090709,+5
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
    
    With ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 1").ParagraphFormat
        .Alignment = wdAlignParagraphLeft
    End With
    
    'zle,090706+,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd|
    With ActiveDocument.Styles("|fffd||fffd||fffd||fffd| 1").Font
        .NameFarEast = "|fffd||fffd||fffd||fffd|"
        .NameAscii = "|fffd||fffd||fffd||fffd|"
        .NameOther = "|fffd||fffd||fffd||fffd|"
        .Name = "|fffd||fffd||fffd||fffd|"
    End With
    
    Selection.MoveLeft , 1
    Selection.Fields.Update
    Selection.Fields.Locked = True

    MoveBK = "BKSY"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
    Selection.MoveDown wdLine, 1
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "|fffd||fffd|"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    'zle,2008-10-16,+end
    Selection.MoveRight , 1
    'zle,2008-10-24,+begin,|fffd||fffd||fffd||1b1||fffd||175||fffd||2f3||fffd||fffd||2b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim strNum() As String
    Dim length As Integer
    Dim strTemp As String
    Dim strZWZTitle As String
    Dim strFLZTitle As String
    Dim strTable As String
    Dim strGraph As String
    Dim strFL As String
    Dim strNew As String
    Dim strNewLength As Integer
    Dim i As Integer
    Dim j As Integer
    Dim flag As Boolean
    length = 0
    strTemp = ""
    strZWZTitle = ""
    strFLZTitle = ""
    strTable = ""
    strGraph = ""
    strFL = ""
    strNew = ""
    
    Selection.Find.ClearFormatting
    Do
        If flag = False Then
            With Selection.Find
                .Text = "^t"
                .Wrap = wdFindStop
                .Forward = True
            End With
            Selection.Find.Execute
        End If
        Selection.Range.Select
        Selection.MoveRight wdCharacter, 1
        Selection.MoveRight wdSentence, 1, wdExtend
        length = Len(Trim(Selection.Range.Text))
        'zle,09-06-14,+4|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||436||fffd||fffd||fffd||fb||fffd||fffd||fffd||638||fffd||fffd||131||fffd||fffd||fffd|
        Dim strF As String
        Dim strS As String
        strF = ""
        strS = ""
        '1.|2f5||fffd||fffd||5bb||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e8ec||fffd||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd|
        If InStr(Selection.Range.Text, ",") = 0 Then
            Selection.MoveRight , 1
        '2.|2f5||fffd||fffd||fffd||436||fffd||fffd||fffd||fffd||fffd||fffd||fffd||e8ec||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Else
            For i = 1 To length
                Do While Mid(Trim(Selection.Range.Text), i, 1) <> ","
                    If Mid(Trim(Selection.Range.Text), i, 1) = "" Then
                        Exit Do
                    End If
                    strTemp = strTemp + Mid(Selection.Range.Text, i, 1)
                    i = i + 1
                Loop
                
                'zle,09-06-14,+begin
                If strF = "" Then
                    strF = strTemp
                Else
                    strS = strTemp
                End If
                If strF <> strS Then
                
                    '1.|fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|
                    If IsNumeric(Left(strTemp, 1)) Then
                        strZWZTitle = strTemp + ", " + strZWZTitle
                        strTemp = ""
                    '2.|fffd||1f8||fffd||bc||fffd||fffd||2b6|
                    ElseIf Left(strTemp, 1) = "|fffd||fffd|" Then
                        strFL = strTemp + ", " + strFL
                        strTemp = ""
                    '3.|fffd||1f1||fffd|
                    ElseIf Left(strTemp, 1) = "|fffd||fffd|" Then
                        strTable = strTemp + ", " + strTable
                        strTemp = ""
                    '4.|fffd||fffd||37c|
                    ElseIf Left(strTemp, 1) = "|37c|" Then
                        strGraph = strTemp + ", " + strGraph
                        strTemp = ""
                    '5.|fffd||1f8||fffd||bc||fffd||fffd||fffd||fffd||fffd||fffd|
                    ElseIf 65 <= Asc(strTemp) <= 90 Then
                        strFLZTitle = strTemp + ", " + strFLZTitle
                        strTemp = ""
                    End If
                    
                    If strS <> "" Then
                        strF = strS
                    End If
                End If
                strTemp = ""
                
                i = i + 1
            Next
            
            strNew = strZWZTitle + strFL + strFLZTitle + strGraph + strTable
            strNewLength = Len(strNew)
            strNew = Left(strNew, strNewLength - 2)
            Selection.Range.Text = strNew
            strZWZTitle = ""
            strFL = ""
            strTable = ""
            strGraph = ""
            strFLZTitle = ""
            strNew = ""
        End If
        flag = True
    Loop While Selection.Find.Execute(FindText:="^t", Forward:=True, Wrap:=wdFindStop)
    
    With frmUpDate
        .Label3.Width = Int(144)
        .Label4.Caption = CStr(50) + "%"
        DoEvents
    End With
    
'    |fffd||fffd||fffd||fffd||fffd||fffd|
'    ActiveWindow.View.ShowParagraphs = True
    
    '    zle|fffd||fffd|2009-1-9|fffd||fffd|+5|fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||1e9||fffd||fffd||fffd||531||fffd||fffd||7b8||fffd||fffd||fffd||4b3||fffd||fffd||5ae||fffd||f7d7b||fffd||52d||fffd||fffd||fffd||135||637||fffd|
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="DW"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With
    
    'zle,2009-1-8,+begin,|3aa||fffd||2f7||fffd||5b9|03|fffd||fffd||fffd||7b8||fffd||4b3||fffd||fffd|
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If

    'zle,09-06-15,+begin,|fffd||fffd||fffd||4f0||fffd||fffd||fffd||1b4||fffd||fffd||2f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ReSortIndexByAscend
    'zle,09-06-15,+end
    
    With frmUpDate
        .Label3.Width = Int(258)
        .Label4.Caption = CStr(90) + "%"
        DoEvents
    End With
    
    '|fffd||7b8||fffd||4b3||fffd||fffd|
    MoveBK = "StandardName"
    Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
    Selection.EndKey
    
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
    Selection.MoveRight , 1, wdExtend
    If Selection.HeaderFooter.LinkToPrevious = True Then
        Selection.HeaderFooter.LinkToPrevious = False
    End If
    With Selection.HeaderFooter.PageNumbers
        .NumberStyle = wdPageNumberStyleArabic
        .HeadingLevelForChapter = 0
        .IncludeChapterNumber = False
        .ChapterPageSeparator = wdSeparatorHyphen
        .RestartNumberingAtSection = True
        .StartingNumber = 1
    End With
    
    ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
    
    If ActiveDocument.FormFields.Count > 10 Then
        If (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Sections(1).ProtectedForForms = True
            For i = 2 To ActiveDocument.Sections.Count
                ActiveDocument.Sections(i).ProtectedForForms = False
            Next
            ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
                 wdAllowOnlyFormFields
                 
            If CommandBars("|4aa||fffd||63c||fffd||fffd||170||fffd|").Visible Then
                ClsEvent.CmdPROTECTC.FaceId = 277
                ClsEvent.CmdPROTECTC.Caption = "|221||fffd||fffd||fffd||fffd||fffd||fffd|"
            End If
            
        End If
    End If
    'zle,2009-1-8,+end
    
'    zle|fffd||fffd|2009-1-9|fffd||fffd|+4|fffd||fffd||27e||fffd||fffd||fffd||1f8||fffd||fffd||fffd||1e9||fffd||fffd||fffd||fffd||fffd||fffd||52d||fffd||fffd||fffd||135||637||fffd|
    If ActiveDocument.Bookmarks.Exists("DW") Then
        Selection.GoTo what:=wdGoToBookmark, Name:="DW"
        ActiveDocument.Bookmarks("DW").Delete
    End If
    
    With frmUpDate
        .Label3.Width = Int(285)
        .Label4.Caption = CStr(100) + "%"
        DoEvents
    End With
    Unload frmUpDate
    
    ActiveWindow.View.ShowHiddenText = False           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5b2||fffd||fffd||fffd||2be|
    ActiveWindow.ActivePane.View.ShowAll = False '|fffd||fffd||2be|/|fffd||fffd||fffd||631||fffd||1f2||fffd||fffd||fffd||2be|
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
End Sub

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1b4||fffd||fffd||2f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub ReSortIndexByAscend()

   Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
    
    Selection.MoveRight Unit:=wdCharacter, Count:=2
    Selection.EndKey Unit:=wdLine, Extend:=wdExtend
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd|
    Selection.Fields.Unlink
    

    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.MoveLeft Unit:=wdCharacter, Count:=2
    
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="SYE"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With

    Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
    Selection.MoveRight Unit:=wdCharacter, Count:=1
    '|27e||fffd||fffd||fffd||5bd||6b7||fffd|

    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "^b"
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    
    With frmUpDate
        .Label3.Width = Int(172)
        .Label4.Caption = CStr(60) + "%"
        DoEvents
    End With
    
    'zle,09-06-23,+1|fffd||fffd||fffd||fffd||fffd||33a||37c||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||4e6|
    Documents(ThisDocument.Name).Activate
    
    'zle,09-06-21,+3,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13b||633||fffd|
    Selection.EndKey wdStory
    If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
        Selection.MoveUp , 1
    End If
    Selection.MoveLeft , 1
    Selection.Delete
    
    Selection.GoTo what:=wdGoToBookmark, Name:="BKSY"
    Selection.MoveRight Unit:=wdCharacter, Count:=2
    
    With ActiveDocument.Bookmarks
        .Add Range:=Selection.Range, Name:="SYF"
        .DefaultSorting = wdSortByLocation
        .ShowHidden = True
    End With

    Dim tempRange As Range
    Set tempRange = ActiveDocument.Range(Start:=ActiveDocument.Bookmarks("SYF").Start, End:=ActiveDocument.Bookmarks("SYE").Start)
    tempRange.Select
    
    '|fffd||131||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    WordBasic.TextToTable ConvertFrom:=0, NumColumns:=1, NumRows:=38, _
        InitialColWidth:=wdAutoPosition, Format:=0, Apply:=1184, AutoFit:=0, _
        SetDefault:=0, Word8:=0, Style:="|fffd||fffd||fffd||fffd||fffd||fffd|"
    
    '|fffd||fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||435||fffd||ff||4bb||fffd||423||fffd||fffd||f5||fffd||ff||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e6||fffd||131||fffd||fffd||fffd|
    Dim i As Integer
    Dim j As Integer
    Dim iTbleIndex As Integer
    Dim iRowCount As Integer
    
    
    With frmUpDate
        .Label3.Width = Int(186)
        .Label4.Caption = CStr(65) + "%"
        DoEvents
    End With
    
    '|fffd||fffd||fffd||4b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e6||fffd||121||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||17d||fffd||fffd||fffd||4e6||fffd||13d||1e79||fffd||fffd|
    Dim syType() As StrType          '|fffd||fffd||32c||fffd||fffd||fffd||fffd|
    
    iTbleIndex = ActiveDocument.Tables.Count
    iRowCount = ActiveDocument.Tables(iTbleIndex).Rows.Count
    
    ReDim syType(iRowCount)
    
    Dim length As Integer
    Dim strTemp As String
    Dim strItems As Integer
    j = 1
    For i = 1 To iRowCount
        length = 0

        ActiveDocument.Tables(iTbleIndex).Cell(i, 1).Select

        length = Len(Selection.Range.Text)
        
        If Selection.Range.Characters.Count < 4 Then
            If InStr(Selection.Range.Text, "|fffd||fffd||fffd||fffd|") <> 0 Then
                strTemp = Mid(Selection.Range.Text, 1, 2)
            Else
                strTemp = Mid(Selection.Range.Text, 1, 1)
            End If
        Else
            Selection.MoveLeft , 1
            Selection.MoveRight , 1, wdExtend
            
            syType(j).strLetter = strTemp
            syType(j).strFirCharacter = Selection.Range.Text
            j = j + 1
        End If
    Next
    strItems = j - 1
    
    '|27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd|
    Dim orow As Row
    For Each orow In ActiveDocument.Tables(iTbleIndex).Rows
        orow.Select
        If Selection.Range.Characters.Count <= 4 Then
            orow.Delete
        End If
    Next
    
    With frmUpDate
        .Label3.Width = Int(200)
        .Label4.Caption = CStr(70) + "%"
        DoEvents
    End With
    
    '|fffd||fffd||fffd||fffd||fffd|1|fffd||43e||372||fffd||fffd||fffd||4aa||fffd||fffd||fffd||fffd|
    If ActiveDocument.Tables(iTbleIndex).Rows.Count > 1 Then
        ActiveDocument.Tables(iTbleIndex).Select
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1b4||fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd|
        Selection.Sort ExcludeHeader:=False, FieldNumber:="|fffd||fffd| 1", SortFieldType:= _
        wdSortFieldSyllable, SortOrder:=wdSortOrderAscending, FieldNumber2:="", _
        SortFieldType2:=wdSortFieldSyllable, SortOrder2:=wdSortOrderAscending, _
        FieldNumber3:="", SortFieldType3:=wdSortFieldSyllable, SortOrder3:= _
        wdSortOrderAscending, Separator:=wdSortSeparateByCommas, SortColumn:= _
        False, CaseSensitive:=False, LanguageID:=wdSimplifiedChinese, _
        SubFieldNumber:="|fffd||fffd||fffd||fffd||fffd||fffd|", SubFieldNumber2:="|fffd||fffd||fffd||fffd||fffd||fffd|", SubFieldNumber3:="|fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
    
    With frmUpDate
        .Label3.Width = Int(215)
        .Label4.Caption = CStr(75) + "%"
        DoEvents
    End With
    '|fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||138||fffd||fffd||fffd||fffd||fffd||fffd||fffd||121||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2871||fffd||4f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e6||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim strRange1 As String
    Dim strRange2 As String
    Dim strRange3 As String
    For Each orow In ActiveDocument.Tables(iTbleIndex).Rows

        orow.Select
        Selection.MoveLeft , 1
        Selection.MoveRight , 1, wdExtend
        strRange2 = Selection.Range.Text
        
        For j = 1 To strItems
            If strRange2 = syType(j).strFirCharacter Then
                strRange1 = syType(j).strLetter
                Exit For
            End If
        Next
        If strRange3 <> strRange1 Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd|
            Selection.InsertRowsAbove 1
            Selection.TypeText strRange1
'            Selection.TypeBackspace
            Selection.Style = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            strRange3 = strRange1
        End If
    Next
    
    With frmUpDate
        .Label3.Width = Int(229)
        .Label4.Caption = CStr(80) + "%"
        DoEvents
    End With
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||5ea||fffd||fffd||fffd||fffd||fffd||131||fffd|
    Selection.Rows.ConvertToText Separator:=wdSeparateByParagraphs, _
        NestedTables:=True
    '|fffd||1b3||fffd||fffd||fffd||fffd||731||fffd||fffd|
    ActiveDocument.RemoveSmartTags
    
    'zle,09-06-23,+1|fffd||fffd||fffd||fffd||fffd||33a||37c||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||4e6|
    Documents(ThisDocument.Name).Activate
    
    'zle,09-06-21,+3,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13b||633||fffd|
    Selection.EndKey wdStory
    If Selection.Style = "|fffd||57d||fffd||fffd||fffd|" Then
        Selection.MoveUp , 1
    End If
    Selection.MoveLeft , 1
    Selection.Delete
    
End Sub

'=============================================================================
'==Function:|fffd||fffd||2be| |27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================

Sub ShowfrmDelIndex()
    frmDeleteIndex.Show 0
End Sub

'=============================================================================
'==Function: |27e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub DelIndexItems()
    Dim findPar As Paragraph
    Dim findRan As Range
    Dim findFlag As Boolean
    '1.|fffd||fffd||fffd||27e||fffd||fffd|
    If g_DelIndex = 1 Then
        Selection.TypeBackspace
        ActiveWindow.View.ShowHiddenText = False
    '2.|22b||fffd||fffd||27e||fffd||fffd|
    ElseIf g_DelIndex = 2 Then
        'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
        InProcess = True
        Dim MoveBK As String
'        Selection.HomeKey wdStory, wdMove
        MoveBK = "StandardName"
        Selection.GoTo what:=wdGoToBookmark, Name:=MoveBK
        Selection.EndKey
        ActiveWindow.View.ShowHiddenText = True
        g_FindCount = 0
        Do
            If findFlag = False Then
                With Selection.Find
                    .ClearFormatting
                    .Text = "^d xe " + Chr(34) + g_DelIndexText + Chr(34)
                    .Wrap = wdFindStop
                    .Forward = True
                    .Format = False
                End With
                findFlag = True
                Selection.Find.Execute
            End If
            Selection.Range.Select
            If Selection.Style = "|13f||fffd||3a1||fffd||fffd||fffd||5fc||fffd||fffd||fffd||1b1||fffd||fffd||fffd|" Then
                Exit Do
            End If
            Selection.Delete
            g_FindCount = g_FindCount + 1
        Loop While Selection.Find.Execute(FindText:="^d xe " + Chr(34) + g_DelIndexText + Chr(34), Forward:=True, Wrap:=wdFindStop)
        ActiveWindow.View.ShowHiddenText = False
        'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
        InProcess = False
    End If
End Sub
'zle,2008-11-2,+end|fffd||fffd||27e||fffd||fffd||fffd||fffd||1f5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||fffd||135||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub PrctTCS()
    Dim i As Integer
    If ActiveDocument.FormFields.Count > 10 Then
        If (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Sections(1).ProtectedForForms = True
            For i = 2 To ActiveDocument.Sections.Count
                ActiveDocument.Sections(i).ProtectedForForms = False
            Next
            ActiveDocument.Protect Password:="zhangcheng", NoReset:=True, Type:= _
                 wdAllowOnlyFormFields
        End If
    End If
End Sub


'=============================================================================
'==Function:|fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub UnPrctTCS()
    If ActiveDocument.FormFields.Count > 10 Then
        If Not (ActiveDocument.ProtectionType = wdNoProtection) Then
            ActiveDocument.Unprotect "zhangcheng"
        End If
    End If
End Sub

'=============================================================================
'==Function:|27e||fffd||fffd||fffd||638||fffd||fffd||2f5||fffd||fffd||fffd||5b4||fffd||434||2f3||fffd||fffd||fffd||f18f4||fffd||123||fffd||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090706
'==Updated:
'== Update 1:
'=============================================================================
Sub DeleteDuplicateMenu()
    Dim cbIndex  As Integer
    Dim cbString As String
    Dim ctlPopup As CommandBarPopup

    For cbIndex = 1 To ActiveDocument.CommandBars.Count
        cbString = cbString + "Name :" + ActiveDocument.CommandBars(cbIndex).Name + ";" + Chr(13)
    Next cbIndex
'    MsgBox cbString


    cbString = "Menu Bar Caption List" + Chr(13)
    For cbIndex = 1 To ActiveDocument.CommandBars("Menu Bar").Controls.Count
        cbString = cbString + "Caption :" + ActiveDocument.CommandBars("Menu Bar").Controls(cbIndex).Caption + ";" + Chr(13)
    Next cbIndex
'    MsgBox cbString
    
    ActiveDocument.CommandBars("Menu Bar").Protection = msoBarNoProtection

    cbString = "Menu Bar Deleted List" + Chr(13)

    For Each ctlPopup In ActiveDocument.CommandBars("Menu Bar").Controls
        If (ctlPopup.Caption = "|4aa||fffd||63c||fffd||fffd||170||fffd|") Or (ctlPopup.Caption = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|") Or (ctlPopup.Caption = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|") Then
            cbString = cbString + "Caption :" + ctlPopup.Caption + ";" + Chr(13)
            ctlPopup.Delete
        Else
            cbString = cbString + "Caption :" + ctlPopup.Caption + "(Remain);" + Chr(13)
        End If
    Next
'    MsgBox cbString
    
    'zle,09-06-04,|27e||fffd||fffd||fffd||fffd||770||fffd||165|
    
    Dim cmbNewBar_YY As CommandBar       '|fffd||fffd||772||2f5||fffd|
    For Each cmbNewBar_YY In CommandBars
        If cmbNewBar_YY.Name = "|4aa||fffd||63c||fffd||fffd||170||fffd|" Or cmbNewBar_YY.Name = "|fffd||fffd||3b1||fffd||fffd||fffd||fffd||fffd||2bd|" Or cmbNewBar_YY.Name = "|4aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd|" Then
            cmbNewBar_YY.Delete
        End If
    Next
End Sub

'=============================================================================
'==Function:|fffd||fffd||221||fffd||fffd||461||fffd||fffd||fffd||fffd||3bb||fffd||6b5||13d||6ba||163||fffd||fffd||436||fffd||fffd||1f7||fffd||fffd||fffd||fffd||13f||fffd||3a3||fffd||1f0||fffd||523||fffd||fffd||fffd||fffd||535||13d||6ba||fffd|
'==Para:
'==Return:
'==Designer:
'==Created: by zle,090812
'==Updated:
'== Update 1:
'=============================================================================

Function GetSecNum() As Integer

    If ActiveDocument.FormFields.Count > 10 Then
        If ActiveDocument.Bookmarks.Exists("BKML") Or ActiveDocument.Bookmarks.Exists("BKQY") Or ActiveDocument.Bookmarks.Exists("BKYY") Then
            If Selection.Information(wdActiveEndSectionNumber) = 2 Then
                GetSecNum = 0
            Else
                GetSecNum = 1
            End If
            Exit Function
        Else
            GetSecNum = 1
            Exit Function
        End If
    Else
        If ActiveDocument.Bookmarks.Exists("BKML") Or ActiveDocument.Bookmarks.Exists("BKQY") Or ActiveDocument.Bookmarks.Exists("BKYY") Then
            If Selection.Information(wdActiveEndSectionNumber) = 1 Then
                GetSecNum = 0
            Else
                GetSecNum = 1
            End If
            Exit Function
        Else
            GetSecNum = 1
            Exit Function
        End If
    End If
    
End Function
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Option Explicit
Dim ctlPopup As CommandBarPopup
Dim cmbNewBar As CommandBar
'Private Sub Document_Close()
'    Dim cmbNewMenu As CommandBar
'    Set cmbNewMenu = ActiveDocument.CommandBars("Menu Bar")
'        'zle,2008-9-28,+3,|fffd||fffd||fffd||fffd||fffd||7b8||132||2f5||fffd|
'    With cmbNewMenu
'        .Protection = msoBarNoProtection
'    End With
''|fffd||2f3||fffd||27e||fffd||fffd||fffd||2f5||fffd|
'    For Each ctlPopup In cmbNewMenu.Controls
'        If ctlPopup.Caption = "|fffd||fffd||fffd||4f1||fffd||5fc||4aa||fffd||fffd|" Or ctlPopup.Caption = "|fffd||fffd||5fc||fffd||131||fffd||fffd||fffd||2bd|" Or ctlPopup.Caption = "|fffd||fffd||bc||fffd||fffd||fffd||170||fffd|" Then
'            ctlPopup.Delete
'        End If
'    Next
'
'    For Each cmbNewBar In CommandBars
'        If cmbNewBar.Name = "|fffd||fffd||5fc||fffd||fffd||434||fffd||fffd||fffd||fffd|" Or cmbNewBar.Name = "|fffd||fffd||5fc||fffd||131||fffd||fffd||fffd||2bd|" Then
'            cmbNewBar.Delete
'        End If
'    Next
'    Dim i As Integer
'    i = 1
'    Do While ActiveDocument.CommandBars("Menu Bar").Controls(i).Caption <> "|fffd||13c||fffd|(&F)"
'        ActiveDocument.CommandBars("Menu Bar").Controls(i).Delete
'    Loop
'    'zle,2008-9-28,+3,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||132||2f5||fffd|
'    With cmbNewMenu
'        .Protection = msoBarNoCustomize
'    End With
'End Sub

Private Sub Document_Open()
    Set ClsEvent.TdsApp = ActiveDocument.Application
End Sub

Attribute VB_Name = "frmDate"
Attribute VB_Base = "0{51F9AF55-F4DA-4318-ADAB-ABF4E904D967}{5A98000E-4232-4225-912C-B04A892CBC75}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
Private Declare Function ReleaseDC Lib "user32" (ByVal hwnd As Long, ByVal hdc As Long) As Long
Private Declare Function GetDeviceCaps Lib "gdi32" (ByVal hdc As Long, ByVal nIndex As Long) As Long
Private Const LOGPIXELSX = 88        '  Logical pixels/inch in X

Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Const GWL_STYLE = (-16)
Private Const WS_BORDER = &H800000
Private Const WS_CAPTION = &HC00000                  '  WS_BORDER Or WS_DLGFRAME


Private Declare Function CreateRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal Y1 As Long, ByVal X2 As Long, ByVal Y2 As Long) As Long
Private Declare Function CombineRgn Lib "gdi32" (ByVal hDestRgn As Long, ByVal hSrcRgn1 As Long, ByVal hSrcRgn2 As Long, ByVal nCombineMode As Long) As Long
Private Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As Long
Private Declare Function SetWindowRgn Lib "user32" (ByVal hwnd As Long, ByVal hRgn As Long, ByVal bRedraw As Boolean) As Long
Private Const RGN_OR = 2

Dim PointToPixel As Single

'|3aa||fffd||fffd||5ea||fffd||fffd||fffd||fffd||3bb|

'Private Declare Function GetDeviceCaps Lib "gdi32" (ByVal hdc As Long, ByVal nIndex As Long) As Long
Private Declare Function GetSystemMetrics Lib "user32" (ByVal nIndex As Long) As Long
'Private Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
'Private Const LOGPIXELSX = 88
Private Const SM_CXSCREEN = 0


Private Sub DTPicker1_CloseUp()
    g_rowNum = 0
    g_DelIndexText = ""
    g_DelIndexText = DTPicker1.Value
    Unload Me
End Sub

Private Sub UserForm_Initialize()

    g_rowNum = 1
    '|fffd||fffd||221||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13b||fffd||435||fffd||3bb||fffd||fffd|
    Dim l  As Long, t  As Long, w  As Long, h As Long
    Dim lPIXELSX As Long
    Dim x As Long
    '|221||fffd||fffd||fffd||fffd||13b||fffd||13f||fffd||fffd||223||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||3bb|
    x = GetSystemMetrics(SM_CXSCREEN)
    
    '    |fffd||fffd||3aa||fffd||fffd||13b||fffd||fffd||fffd||a8ec||fffd||fffd||3bb|pixel
    ActiveWindow.GetPoint l, t, w, h, Selection.Range

    '|221||fffd||fffd||fffd||fffd||13b||fffd||fffd||ff||4e2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    lPIXELSX = GetDeviceCaps(GetDC(0), LOGPIXELSX)
    
    Me.StartUpPosition = 3
    Me.Left = l * 72 / lPIXELSX
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||38ec||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be||3bb||fffd||f5||fffd|LEFT|fffd||fffd||fffd||f5||fffd||fffd||fffd|point|fffd||fffd||ff||4e2||fffd||fffd|72point)|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||3bb|
    If Me.Left < 300 Then '|fffd||1f7||fffd||fffd||fffd||2b1||fffd||fffd|
        If x = 1024 Then
            Me.Left = 151.5
        Else
            Me.Left = 249
        End If
    Else '|fffd||fffd||2b5||2a9||2b1||fffd||fffd|
        If x = 1024 Then
            Me.Left = 540.5
        Else
            Me.Left = 632
        End If
    End If
    
'    Me.Left = l * 72 / lPIXELSX
    Me.Top = t * 72 / lPIXELSX

'
    '|fffd||fffd||f5||fffd||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13b||fffd||fffd||fffd||fffd||3f5|
    Dim hdc As Long
    hdc = GetDC(0)
    PointToPixel = GetDeviceCaps(hdc, LOGPIXELSX) / 72
    ReleaseDC 0, hdc
    
    '|225||fffd||fffd||fffd||fffd||fffd||6b5||131||7ff||fffd||131||fffd||fffd||fffd||fffd||fffd|
    Dim hwnd As Long
    Dim lStyle As Long
    hwnd = FindWindow(vbNullString, Me.Caption)
    lStyle = GetWindowLong(hwnd, GWL_STYLE)
    lStyle = lStyle And Not WS_BORDER And Not WS_CAPTION
    SetWindowLong hwnd, GWL_STYLE, lStyle
    
    '|fffd||fffd||221||ff||fffd||fffd||fffd||63c||fffd||fffd||fffd||fffd||6b5||13e||fffd||fffd||fffd||fffd||fffd||fffd||b28bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim ctl
    Dim i As Integer
    Dim hRgnAll As Long
    Dim hRgnCtl As Long
    i = 1
    hRgnAll = CreateRectRgn(0, 0, 0, 0)
    For Each ctl In Me.Controls
        With ctl
            '|fffd||fffd||fffd||fffd||fffd|+3|fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6ef9||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||3aa|F3 Server 60000000|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bd30||fffd||6b1||7ff||fffd||13e||fffd||fffd||fffd||3aa|3|fffd||fffd||fffd||fffd|
            hRgnCtl = CreateRectRgn(.Left * PointToPixel + 3, .Top * PointToPixel + 3, (.Left + .Width) * PointToPixel + 3, (.Top + .Height) * PointToPixel + 3)
            CombineRgn hRgnAll, hRgnAll, hRgnCtl, RGN_OR
            DeleteObject hRgnCtl
       End With
    Next
    '|fffd||fffd||fffd||63c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2be||fffd||fffd||fffd||fffd|
    SetWindowRgn hwnd, hRgnAll, True
    DeleteObject hrngall
    
    'zle,2009-5-19,+|fffd||fffd||2bc||fffd||fffd||2b1||fffd||fffd|
 
'    +|fffd||fffd||2bc||fffd||fffd||2b1||fffd||fffd|
    If g_DelIndexText = "" Then
        DTPicker1.Value = Date
    Else
        DTPicker1.Value = g_DelIndexText
    End If

End Sub


Attribute VB_Name = "frmDeleteIndex"
Attribute VB_Base = "0{739CFE6E-493B-4F54-938F-7016F377021E}{CF4736C8-D5DA-4F3D-9EA7-45AD819AFD55}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cmdCancel_Click()
    ActiveWindow.View.ShowHiddenText = False
    g_SLFirst = 0
    Unload Me
End Sub
Private Sub cmdFindNext_Click()
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    'zle,09-06-20,+begin,|fffd||4ff||fffd||2bc||fffd||fffd||fffd||fffd|
    If ActiveDocument.FormFields.Count > 10 Then
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.EndKey wdLine
        End If
    End If
    If g_SLFirst = 0 Then
        Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
        Selection.EndKey wdLine
        g_SLFirst = 1
    Else
        g_SLFirst = g_SLFirst + 1
    End If
    'zle,09-06-20,+end
    
    ActiveWindow.View.ShowHiddenText = True
    Selection.Find.ClearFormatting
    With Selection.Find
        .Text = "^d xe " + Chr(34) + txtIndex.Text + Chr(34)
        .Forward = True
        .Wrap = wdFindStop
    End With
    Dim Response
    If Selection.Find.Execute = False Then
         
        ActiveWindow.View.ShowHiddenText = False
        If g_SLFirst = 1 Then
            g_SLFirst = 0
            Response = MsgBox("|fffd||f4||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||431||fffd||1e3||fffd||fffd||1f7||fffd||27e||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo, "TCS")
            If Response = vbYes Then
               txtIndex.Text = ""
            Else
                Unload Me
            End If
        Else
            g_SLFirst = 0
            Response = MsgBox("|fffd||47e||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||1f7||fffd||27e||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo, "TCS")
            If Response = vbYes Then
               txtIndex.Text = ""
            Else
                Unload Me
            End If
        End If
    Else
        cmdDelete.Enabled = True
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
End Sub

Private Sub cmdDelete_Click()
    g_DelIndexText = txtIndex.Text
    g_DelIndex = 1
    DelIndexItems
'    cmdDelete.Enabled = False
    InProcess = True
    ActiveWindow.View.ShowHiddenText = True
    Selection.Find.ClearFormatting
    With Selection.Find
        .Text = "^d xe " + Chr(34) + txtIndex.Text + Chr(34)
        .Forward = True
        .Wrap = wdFindStop
    End With

    If Selection.Find.Execute = False Then
        cmdDelete.Enabled = False
        g_SLFirst = 0
        ActiveWindow.View.ShowHiddenText = False
        Dim Response
        Response = MsgBox("|fffd||47e||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||1f7||fffd||27e||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo)
        If Response = vbYes Then
            txtIndex.Text = ""
        Else
            Unload Me
        End If
    Else
'        ActiveWindow.View.ShowHiddenText = False
        cmdDelete.Enabled = True
    End If
    InProcess = False
End Sub

Private Sub cmdDeleteAll_Click()
    g_DelIndexText = txtIndex.Text
    g_DelIndex = 2
    DelIndexItems
'    ActiveWindow.View.ShowHiddenText = False
    If g_FindCount = 0 Then
        MsgBox "|fffd||f4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fb||fffd||431||fffd||fffd||fffd||fffd||3aa||fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
       
        g_SLFirst = 0
        Dim Response
        Response = MsgBox("|fffd||47e||fffd||fffd||fffd||fffd||27e||fffd||fffd||fffd||fffd||fffd||1f7||fffd||27e||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo, "TCS")
        If Response = vbYes Then
           txtIndex.Text = ""
        Else
            Unload Me
        End If
    End If
End Sub

Private Sub txtIndex_Change()
    If Trim(txtIndex.Text) <> "" Then
        cmdFindNext.Enabled = True
        cmdDeleteAll.Enabled = True
    Else
        cmdFindNext.Enabled = False
        cmdDelete.Enabled = False
        cmdDeleteAll.Enabled = False
    End If
End Sub

Private Sub UserForm_Activate()
    cmdFindNext.Enabled = False
    cmdDelete.Enabled = False
    cmdDeleteAll.Enabled = False
End Sub



Attribute VB_Name = "frmFLBS"
Attribute VB_Base = "0{F182FE76-6015-4431-93DD-D806D4256756}{0732603A-6CAE-4790-9669-21E43D230C31}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cmdCancel_Click()
    Unload Me
End Sub

Private Sub cmdOk_Click()
On Error GoTo errorhandle
    InProcess = True
    Selection.TypeText Chr(11)
    If OptGF.Value Then
        Selection.TypeText "|fffd||fffd||fffd||6df6||fffd||538||fffd||bc||fffd||fffd|"
    Else
        Selection.TypeText "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||538||fffd||bc||fffd||fffd|"
    End If
    Selection.TypeText Chr(11)
    Selection.TypeText "|fffd||6b4||2f4||fffd||fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||fffd||fffd|"
    Selection.EndKey
    Selection.TypeParagraph
    Selection.MoveLeft wdCharacter, 1
    Selection.HomeKey , Extend:=wdExtend
    InProcess = False
    Unload Me
    'zle,2008-9-24,+1,|fffd||fffd||fffd||436||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531||fffd||fffd||739||fffd||fffd||fffd||2b1||fffd||f8||fffd||fffd||b8||fffd||bc||fffd||fffd||2be||fffd||fffd||fffd|
    UpdateFieldTCS
    Exit Sub

errorhandle:
    InProcess = False
    Unload Me
    MsgBox "|fffd||fffd||fffd||fffd||fffd||6b1||f2d||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||4f8||fffd||bc||fffd||fffd||fffd||bf6b||fffd||fffd||fffd||fffd||1b3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4f8||fffd||bc|"
End Sub

Attribute VB_Name = "frmJz"
Attribute VB_Base = "0{20AFCED3-F061-4C2A-BA67-74EE61D3F533}{BFC1F666-314D-4002-AB3B-58901DA26D99}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cmdCancel_Click()
    g_SYGS = ""
    g_SYGS = TxtJZ.Text
    Unload Me
End Sub

Private Sub cmdOk_Click()
    g_SYGS = ""
    g_SYGS = TxtJZ.Text
    Unload Me
End Sub

Private Sub txtJz_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
        If KeyCode = 13 Then
        cmdOk_Click
    End If
End Sub

Private Sub UserForm_Activate()
    If g_MarkOrAll = 3 Then
        frmJz.TxtJZ.Text = Selection.Range.Text
    Else
        frmJz.TxtJZ.Text = ""
    End If
End Sub

Attribute VB_Name = "frmMarkIndex"
Attribute VB_Base = "0{2B082BE9-7F19-4D1E-92FB-4680BD916C1F}{9706E5B2-A69F-4CCB-BF76-610AB827323B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub cmdCancel_Click()
    Unload Me
    g_SLFirst = 0
End Sub

Private Sub cmdFindNext_Click()
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = True
    If ActiveDocument.FormFields.Count > 10 Then
        If Selection.Information(wdActiveEndPageNumber) = 1 Then
            Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
            Selection.EndKey wdLine
        End If
    End If
    If g_SLFirst = 0 Then
        Selection.GoTo what:=wdGoToBookmark, Name:="StandardName"
        Selection.EndKey wdLine
        g_SLFirst = 1
    Else
        g_SLFirst = g_SLFirst + 1
    End If
    Selection.Find.ClearFormatting
    With Selection.Find
        .Text = Trim(txtIndex)
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    If Selection.Find.Execute = False Then
        Dim Response
        If g_SLFirst = 1 Then
            g_SLFirst = 0
            Response = MsgBox("|fffd||f4||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||433||fffd||fffd||5a3||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||b5||134||fffd||fffd||f8ff|", vbYesNo, "TCS")
            If Response = vbYes Then
                txtIndex.Text = ""
            Else
                Unload Me
            End If
        Else
            g_SLFirst = 0
            Response = MsgBox("|fffd||47e||fffd||fffd||fffd||272||fffd||fffd||4a3||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||b5||134||fffd||fffd||f8ff|", vbYesNo, "TCS")
            If Response = vbYes Then
                txtIndex.Text = ""
            Else
                Unload Me
            End If
        End If
    Else
        cmdMark.Enabled = True
    End If
    'zle,200812-1,+1,|fffd||fffd||5b9||fffd||537||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd|
    InProcess = False
End Sub

Private Sub cmdMark_Click()
    g_IndexText = txtIndex.Text
    g_MarkOrAll = 1
    MarkIndexItems
    'zle,09-06-18,*1
'    cmdMark.Enabled = False
    Selection.Find.ClearFormatting
    InProcess = True
    With Selection.Find
        .Text = Trim(txtIndex)
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchByte = True
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    If Selection.Find.Execute = False Then
    
        cmdMark.Enabled = False
        g_SLFirst = 0
        
        Dim Response
        Response = MsgBox("|fffd||47e||fffd||fffd||fffd||271||fffd||1e3||fffd||fffd||1f7||fffd||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo, "TCS")
        If Response = vbYes Then
            txtIndex.Text = ""
        Else
            Unload Me
        End If
  
    Else
        cmdMark.Enabled = True
    End If
    InProcess = True
End Sub

Private Sub cmdMarkAll_Click()
    g_IndexText = txtIndex.Text
    g_MarkOrAll = 2
    'zle,2008-11-17,+4,|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd|
    With frmMarkIndex
        .Width = 245
        .Height = 138
    End With
    lblWid.BackColor = &HFF0000
    lblWid.Width = Int(18)
    lblJD.Caption = CStr(10) + "%"
    DoEvents
'    'zle,2008-12-2,+1,|fffd||fffd||5b9||fffd||6b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    frmMarkIndex.Enabled = False
    MarkIndexItems
    With frmMarkIndex
        .Width = 237
        .Height = 99
    End With
    If g_ZhuFirst = 0 Then
        MsgBox "|fffd||f4||fffd||fb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||433||fffd||fffd||fffd|"
    Else
        Dim Response
        Response = MsgBox("|fffd||47e||fffd||fffd||fffd||271||fffd||1e3||fffd||fffd||1f7||fffd||fffd||fffd||fffd||b5||fffd||fffd||fffd||fffd||fffd||fffd||e8ff|", vbYesNo, "TCS")
        If Response = vbYes Then
            txtIndex.Text = ""
        Else
            Unload Me
        End If
    End If

End Sub

Private Sub Label6_Click()

End Sub

Private Sub txtIndex_Change()
    g_SLFirst = 0
    If Trim(txtIndex.Text) <> "" Then
        cmdFindNext.Enabled = True
        cmdMarkAll.Enabled = True
    Else
        cmdFindNext.Enabled = False
        cmdMark.Enabled = False
        cmdMarkAll.Enabled = False
    End If
End Sub

Private Sub UserForm_Activate()
    cmdFindNext.Enabled = False
    cmdMark.Enabled = False
    cmdMarkAll.Enabled = False
    '|fffd||575||fffd||fffd||fffd||fffd||fffd||2b1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    With frmMarkIndex
'        .Width = 237
'        .Height = 108
'    End With
    lblWid.BackColor = &HFFFFFF
    lblJD.Caption = "0%"
End Sub


Attribute VB_Name = "frmUpDate"
Attribute VB_Base = "0{0AAF2BB4-F8BA-404E-98F3-BE221C75B9DC}{090C293E-1324-469C-858C-DA55EF4F9E8C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit



Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = 0 Then
        Cancel = 1
        MsgBox "|fffd||fffd||fffd||6bd||fffd||fffd||438||fffd||fffd||a3||fffd||fffd||fffd||fffd||ba||fffd||fffd||536||fffd||fffd||631||563||fffd|"
    End If
End Sub

' InQuest injected base64 decoded content
' zPhw$
' yJiz
' N+ex

INQUEST-PP=macro
