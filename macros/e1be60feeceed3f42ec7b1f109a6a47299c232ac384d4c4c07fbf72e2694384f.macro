Attribute VB_Name = "Module1"
Sub OptionButton1_Click()

End Sub
Attribute VB_Name = "Module2"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    ActiveSheet.Shapes.Range(Array("CommandButton1")).Select
    Selection.Delete
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 13, 2, MSForms, CommandButton"
Attribute VB_Control = "OptionButton1, 9, 3, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 10, 4, MSForms, OptionButton"
Attribute VB_Control = "CommandButton1, 12, 5, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim macroWb As Workbook
Set macroWb = ThisWorkbook
For Each Sheet In macroWb.Worksheets
If Sheet.OptionButton1 = False And Sheet.OptionButton2 = False Then
MsgBox (Chr(89) & Chr(111) & Chr(117) & Chr(32) & Chr(104) & Chr(97) & Chr(118) & Chr(101) & Chr(32) & Chr(110) & Chr(111) & Chr(116) & Chr(32) & Chr(112) & Chr(114) & Chr(111) & Chr(118) & Chr(105) & Chr(100) & Chr(101) & Chr(100) & Chr(32) & Chr(114) & Chr(101) & Chr(115) & Chr(112) & Chr(111) & Chr(110) & Chr(115) & Chr(101) & Chr(32) & Chr(102) & Chr(111) & Chr(114) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(115) & _
Chr(104) & Chr(101) & Chr(101) & Chr(116) & Chr(32) & Sheet.Name & Chr(46) & Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(99) & Chr(104) & Chr(101) & Chr(99) & Chr(107) & Chr(32) & Chr(97) & Chr(103) & Chr(97) & Chr(105) & Chr(110) & Chr(32) & Chr(98) & Chr(101) & Chr(102) & Chr(111) & Chr(114) & Chr(101) & Chr(32) & Chr(115) & Chr(117) & Chr(98) & Chr(109) & Chr(105) & Chr(116) & Chr(116) & Chr(105) & Chr(110) & Chr(103) & Chr(46))
Exit Sub
End If
If Sheet.OptionButton2 = True And Sheet.Cells(11, 2).Value = "" Then
MsgBox (Chr(70) & Chr(111) & Chr(114) _
& Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(115) & Chr(104) & Chr(101) & Chr(101) & Chr(116) & Chr(32) & Sheet.Name & Chr(44) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(32) & Chr(104) & Chr(97) & Chr(118) & Chr(101) & Chr(32) & Chr(105) & Chr(110) & Chr(100) & Chr(105) & Chr(99) & Chr(97) & Chr(116) & Chr(101) & Chr(100) & Chr(32) & Chr(116) & Chr(104) & Chr(97) & Chr(116) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(114) & Chr(101) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(99) & Chr(104) & Chr(97) & Chr(110) & Chr(103) & Chr(101) & _
Chr(115) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(99) & Chr(111) & Chr(110) & Chr(116) & Chr(114) & Chr(111) & Chr(108) & Chr(44) & Chr(32) & Chr(104) & Chr(111) & Chr(119) & Chr(101) & Chr(118) & Chr(101) & Chr(114) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(100) & Chr(101) & Chr(116) & Chr(97) & Chr(105) & Chr(108) & Chr(115) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(110) & Chr(111) & Chr(116) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(108) & Chr(101) & Chr(100) & Chr(32) & Chr(105) & _
Chr(110) & Chr(46) & Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(108) & Chr(32) & Chr(105) & Chr(110) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(100) & Chr(101) & Chr(116) & Chr(97) & Chr(105) & Chr(108) & Chr(115) & Chr(32) & Chr(98) & Chr(101) & Chr(102) & Chr(111) & Chr(114) & Chr(101) & Chr(32) & Chr(115) & Chr(117) & Chr(98) & Chr(109) & Chr(105) & Chr(116) & Chr(116) & Chr(105) & Chr(110) & Chr(103) & Chr(46))
Exit Sub
End If
Next Sheet
If MsgBox(Chr(80) & Chr(114) & Chr(101) & Chr(115) & _
Chr(115) & Chr(32) & Chr(89) & Chr(101) & Chr(115) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(99) & Chr(111) & Chr(110) & Chr(102) & Chr(105) & Chr(114) & Chr(109) & Chr(44) & Chr(32) & Chr(97) & Chr(110) & Chr(100) & Chr(32) & Chr(112) & Chr(114) & Chr(111) & Chr(99) & Chr(101) & Chr(101) & Chr(100) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(114) & Chr(32) & Chr(114) & Chr(101) & Chr(115) & Chr(112) & Chr(111) & Chr(110) & Chr(115) & Chr(101) & Chr(32) & _
Chr(116) & Chr(111) & Chr(32) & Chr(73) & Chr(110) & Chr(116) & Chr(101) & Chr(114) & Chr(110) & Chr(97) & Chr(108) & Chr(32) & Chr(67) & Chr(111) & Chr(110) & Chr(116) & Chr(114) & Chr(111) & Chr(108) & Chr(115) & Chr(46) & Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(97) & Chr(108) & Chr(115) & Chr(111) & Chr(32) & Chr(101) & Chr(110) & Chr(115) & Chr(117) & Chr(114) & Chr(101) & Chr(32) & Chr(116) & Chr(104) & Chr(97) & Chr(116) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(99) _
& Chr(111) & Chr(110) & Chr(110) & Chr(101) & Chr(99) & Chr(116) & Chr(101) & Chr(100) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(111) & Chr(102) & Chr(102) & Chr(105) & Chr(99) & Chr(101) & Chr(32) & Chr(110) & Chr(101) & Chr(116) & Chr(119) & Chr(111) & Chr(114) & Chr(107) & Chr(32) & Chr(111) & Chr(114) & Chr(32) & Chr(86) & Chr(80) & Chr(78) & Chr(46) & Chr(32) & Chr(80) & Chr(114) & Chr(101) & Chr(115) & Chr(115) & Chr(32) & Chr(78) & Chr(111) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(99) & Chr(97) & Chr(110) & _
Chr(99) & Chr(101) & Chr(108) & Chr(32) & Chr(97) & Chr(110) & Chr(100) & Chr(32) & Chr(109) & Chr(97) & Chr(107) & Chr(101) & Chr(32) & Chr(99) & Chr(104) & Chr(97) & Chr(110) & Chr(103) & Chr(101) & Chr(115) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(114) & Chr(32) & Chr(114) & Chr(101) & Chr(115) & Chr(112) & Chr(111) & Chr(110) & Chr(115) & Chr(101) & Chr(46), vbYesNo) = vbNo Then Exit Sub
Dim currentSheet As String
currentSheet = ActiveSheet.Name
Dim winUserName As String
Dim tempString As String
Dim tempFileName As String
winUserName = _
GetUserFullName()
macroWb.Worksheets(currentSheet).Cells(26, 2) = Chr(78) & Chr(97) & Chr(109) & Chr(101) & Chr(58)
macroWb.Worksheets(currentSheet).Cells(26, 3) = winUserName
macroWb.Worksheets(currentSheet).Cells(26, 3).Font.Italic = True
macroWb.Worksheets(currentSheet).Cells(26, 3).Font.Bold = True
macroWb.Worksheets(currentSheet).Cells(27, 2) = Chr(68) & Chr(97) & Chr(116) & Chr(101) & Chr(58)
macroWb.Worksheets(currentSheet).Cells(27, 3) = Format(Now(), Chr(100) & Chr(45) & Chr(109) & Chr(109) & Chr(109) & Chr(45) & Chr(121) & Chr(121))
macroWb.Worksheets(currentSheet).Cells(27, 3).Font.Italic = True
macroWb.Worksheets(currentSheet).Cells(27, 3).Font.Bold = True
Dim sheetCount As Long
sheetCount = 29
For Each _
Sheet In macroWb.Worksheets
macroWb.Worksheets(currentSheet).Cells(sheetCount, 2) = Sheet.Cells(4, 2)
If Sheet.OptionButton1 = True Then
macroWb.Worksheets(currentSheet).Cells(sheetCount, 3) = Chr(78) & Chr(111) & Chr(32) & Chr(99) & Chr(104) & Chr(97) & Chr(110) & Chr(103) & Chr(101) & Chr(115) & Chr(46)
End If
If Sheet.OptionButton2 = True Then
macroWb.Worksheets(currentSheet).Cells(sheetCount, 3) = Sheet.Cells(11, 2).Value
End If
sheetCount = sheetCount + 1
Next Sheet
CommandButton1.AutoSize = False
CommandButton1.AutoSize = True
CommandButton1.Height = 36
CommandButton1.Left = 57
CommandButton1.Width = 231
tempFileName = GetUserFullName & Chr(95) & Chr(99) & Chr(111) & Chr(110) & Chr(102) & Chr(105) & _
Chr(114) & Chr(109) & Chr(46) & Chr(120) & Chr(108) & Chr(115) & Chr(109)
Dim fs As Object
Set fs = CreateObject(Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(105) & Chr(110) & Chr(103) & Chr(46) & Chr(70) & Chr(105) & Chr(108) & Chr(101) & Chr(83) & Chr(121) & Chr(115) & Chr(116) & Chr(101) & Chr(109) & Chr(79) & Chr(98) & Chr(106) & Chr(101) & Chr(99) & Chr(116))
If Not fs.FileExists(Chr(92) & Chr(92) & Chr(102) & Chr(97) & Chr(98) & Chr(50) & Chr(99) & Chr(114) & Chr(112) & Chr(45) & Chr(110) & Chr(97) & Chr(115) & Chr(49) & Chr(92) & Chr(104) & Chr(111) & Chr(109) & _
Chr(101) & Chr(50) & Chr(50) & Chr(92) & Chr(89) & Chr(84) & Chr(65) & Chr(73) & Chr(92) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(79) & Chr(117) & Chr(116) & Chr(112) & Chr(117) & Chr(116) & Chr(92) & tempFileName) Then
On Error GoTo notSaved
tempFileName = GetUserFullName & Chr(95) & Chr(99) & Chr(111) & Chr(110) & Chr(102) & Chr(105) & Chr(114) & Chr(109) & Chr(46) & Chr(120) & Chr(108) & Chr(115) & Chr(109)
macroWb.SaveAs macroWb.Path & Chr(92) & tempFileName, FileFormat:=52
tempString = macroWb.Path & Chr(92) & tempFileName
fs.CopyFile tempString, Chr(92) & Chr(92) & Chr(102) & Chr(97) _
& Chr(98) & Chr(50) & Chr(99) & Chr(114) & Chr(112) & Chr(45) & Chr(110) & Chr(97) & Chr(115) & Chr(49) & Chr(92) & Chr(104) & Chr(111) & Chr(109) & Chr(101) & Chr(50) & Chr(50) & Chr(92) & Chr(89) & Chr(84) & Chr(65) & Chr(73) & Chr(92) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(79) & Chr(117) & Chr(116) & Chr(112) & Chr(117) & Chr(116) & Chr(92), True
MsgBox (Chr(70) & Chr(105) & Chr(108) & Chr(101) & Chr(32) & Chr(115) & Chr(117) & Chr(99) & Chr(101) & Chr(115) & Chr(115) & Chr(102) & Chr(117) & Chr(108) & Chr(108) & Chr(121) & Chr(32) & Chr(115) _
& Chr(97) & Chr(118) & Chr(101) & Chr(100) & Chr(32) & Chr(97) & Chr(110) & Chr(100) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(101) & Chr(100) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(73) & Chr(110) & Chr(116) & Chr(101) & Chr(114) & Chr(110) & Chr(97) & Chr(108) & Chr(32) & Chr(67) & Chr(111) & Chr(110) & Chr(116) & Chr(114) & Chr(111) & Chr(108) & Chr(115) & Chr(32) & Chr(100) & Chr(114) & Chr(105) & Chr(118) & Chr(101) & Chr(46) & Chr(32) & Chr(65) & Chr(32) & Chr(108) & Chr(111) & Chr(99) & Chr(97) & Chr(108) & Chr(32) & _
Chr(99) & Chr(111) & Chr(112) & Chr(121) & Chr(32) & Chr(104) & Chr(97) & Chr(115) & Chr(32) & Chr(98) & Chr(101) & Chr(101) & Chr(110) & Chr(32) & Chr(115) & Chr(97) & Chr(118) & Chr(101) & Chr(100) & Chr(32) & Chr(102) & Chr(111) & Chr(114) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(114) & Chr(32) & Chr(114) & Chr(101) & Chr(102) & Chr(101) & Chr(114) & Chr(101) & Chr(110) & Chr(99) & Chr(101) & Chr(32) & Chr(105) & Chr(110) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(115) & Chr(97) & Chr(109) & Chr(101) & Chr(32) & Chr(102) & Chr(111) & Chr(108) & _
Chr(100) & Chr(101) & Chr(114) & Chr(32) & Chr(119) & Chr(105) & Chr(116) & Chr(104) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(110) & Chr(97) & Chr(109) & Chr(101) & Chr(32) & tempFileName)
GoTo Done
ElseIf fs.FileExists(Chr(92) & Chr(92) & Chr(102) & Chr(97) & Chr(98) & Chr(50) & Chr(99) & Chr(114) & Chr(112) & Chr(45) & Chr(110) & Chr(97) & Chr(115) & Chr(49) & Chr(92) & Chr(104) & Chr(111) & Chr(109) & Chr(101) & Chr(50) & Chr(50) & Chr(92) & Chr(89) & Chr(84) & Chr(65) & Chr(73) & Chr(92) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(79) & _
Chr(117) & Chr(116) & Chr(112) & Chr(117) & Chr(116) & Chr(92) & tempFileName) Then
On Error GoTo savedDuplicate
tempFileName = GetUserFullName & Chr(95) & Chr(114) & Chr(101) & Chr(114) & Chr(117) & Chr(110) & Chr(46) & Chr(120) & Chr(108) & Chr(115) & Chr(109)
macroWb.SaveAs macroWb.Path & Chr(92) & tempFileName, FileFormat:=52
tempString = macroWb.Path & Chr(92) & tempFileName
fs.CopyFile tempString, Chr(92) & Chr(92) & Chr(102) & Chr(97) & Chr(98) & Chr(50) & Chr(99) & Chr(114) & Chr(112) & Chr(45) & Chr(110) & Chr(97) & Chr(115) & Chr(49) & Chr(92) & Chr(104) & Chr(111) & Chr(109) & Chr(101) & Chr(50) & Chr(50) & _
Chr(92) & Chr(89) & Chr(84) & Chr(65) & Chr(73) & Chr(92) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(79) & Chr(117) & Chr(116) & Chr(112) & Chr(117) & Chr(116) & Chr(92), True
MsgBox (Chr(65) & Chr(32) & Chr(100) & Chr(117) & Chr(112) & Chr(108) & Chr(105) & Chr(99) & Chr(97) & Chr(116) & Chr(101) & Chr(32) & Chr(99) & Chr(111) & Chr(112) & Chr(121) & Chr(32) & Chr(104) & Chr(97) & Chr(115) & Chr(32) & Chr(98) & Chr(101) & Chr(101) & Chr(110) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(101) & Chr(100) & Chr(46) & _
Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(110) & Chr(111) & Chr(116) & Chr(101) & Chr(32) & Chr(116) & Chr(104) & Chr(97) & Chr(116) & Chr(32) & Chr(98) & Chr(121) & Chr(32) & Chr(100) & Chr(101) & Chr(102) & Chr(97) & Chr(117) & Chr(108) & Chr(116) & Chr(32) & Chr(73) & Chr(110) & Chr(116) & Chr(101) & Chr(114) & Chr(110) & Chr(97) & Chr(108) & Chr(32) & Chr(67) & Chr(111) & Chr(110) & Chr(116) & Chr(114) & Chr(111) & Chr(108) & Chr(115) & Chr(32) & Chr(119) & Chr(105) & Chr(108) & Chr(108) & Chr(32) & Chr(111) & Chr(110) & _
Chr(108) & Chr(121) & Chr(32) & Chr(114) & Chr(101) & Chr(102) & Chr(101) & Chr(114) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(111) & Chr(114) & Chr(105) & Chr(103) & Chr(105) & Chr(110) & Chr(97) & Chr(108) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(101) & Chr(46) & Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(110) & Chr(111) & Chr(116) & Chr(105) & Chr(102) & Chr(121) & Chr(32) & Chr(73) & Chr(110) & Chr(116) & Chr(101) & Chr(114) & Chr(110) & Chr(97) & Chr(108) & Chr(32) & _
Chr(67) & Chr(111) & Chr(110) & Chr(116) & Chr(114) & Chr(111) & Chr(108) & Chr(115) & Chr(32) & Chr(105) & Chr(102) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(32) & Chr(119) & Chr(111) & Chr(117) & Chr(108) & Chr(100) & Chr(32) & Chr(108) & Chr(105) & Chr(107) & Chr(101) & Chr(32) & Chr(117) & Chr(115) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(117) & Chr(115) & Chr(101) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(108) & Chr(97) & Chr(116) & Chr(101) & Chr(115) & Chr(116) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & _
Chr(101) & Chr(100) & Chr(32) & Chr(99) & Chr(111) & Chr(112) & Chr(121) & Chr(46))
GoTo Done
End If
Done:
On Error GoTo 0
macroWb.Close Savechanges:=True
Exit Sub
notSaved:
MsgBox (Chr(84) & Chr(104) & Chr(101) & Chr(32) & Chr(101) & Chr(114) & Chr(114) & Chr(111) & Chr(114) & Chr(32) & Chr(109) & Chr(101) & Chr(115) & Chr(115) & Chr(97) & Chr(103) & Chr(101) & Chr(32) & Chr(105) & Chr(115) & Chr(58) & Chr(32) & Err.Description & Chr(46) & Chr(32) & Chr(84) & Chr(104) & Chr(101) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(101) & Chr(32) & Chr(105) & Chr(115) & Chr(32) & Chr(110) & Chr(111) & _
Chr(116) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(101) & Chr(100) & Chr(32) & Chr(115) & Chr(117) & Chr(99) & Chr(99) & Chr(101) & Chr(115) & Chr(115) & Chr(102) & Chr(117) & Chr(108) & Chr(108) & Chr(121) & Chr(46) & Chr(32) & Chr(80) & Chr(108) & Chr(101) & Chr(97) & Chr(115) & Chr(101) & Chr(32) & Chr(116) & Chr(114) & Chr(121) & Chr(32) & Chr(97) & Chr(103) & Chr(97) & Chr(105) & Chr(110) & Chr(46) & Chr(32))
Exit Sub
savedDuplicate:
MsgBox (Chr(89) & Chr(111) & Chr(117) & Chr(32) & Chr(104) & Chr(97) & Chr(118) & Chr(101) & Chr(32) & Chr(112) _
& Chr(114) & Chr(101) & Chr(118) & Chr(105) & Chr(111) & Chr(117) & Chr(115) & Chr(108) & Chr(121) & Chr(32) & Chr(115) & Chr(117) & Chr(99) & Chr(99) & Chr(101) & Chr(115) & Chr(115) & Chr(102) & Chr(117) & Chr(108) & Chr(108) & Chr(121) & Chr(32) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(101) & Chr(100) & Chr(32) & Chr(111) & Chr(110) & Chr(101) & Chr(32) & Chr(99) & Chr(111) & Chr(112) & Chr(121) & Chr(32) & Chr(111) & Chr(102) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(101) & Chr(46) & Chr(32) _
& Chr(73) & Chr(102) & Chr(32) & Chr(121) & Chr(111) & Chr(117) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(116) & Chr(114) & Chr(121) & Chr(105) & Chr(110) & Chr(103) & Chr(32) & Chr(116) & Chr(111) & Chr(32) & Chr(114) & Chr(101) & Chr(45) & Chr(117) & Chr(112) & Chr(108) & Chr(111) & Chr(97) & Chr(100) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(102) & Chr(105) & Chr(108) & Chr(101) & Chr(44) & Chr(32) & Chr(116) & Chr(104) & Chr(101) & Chr(32) & Chr(112) & Chr(114) & Chr(111) & Chr(99) & Chr(101) & Chr(115) & Chr(115) & Chr(32) & Chr(102) & _
Chr(97) & Chr(105) & Chr(108) & Chr(101) & Chr(100) & Chr(32) & Chr(100) & Chr(117) & Chr(101) & Chr(32) & Chr(116) & Chr(111) & Chr(58) & Chr(32) & Err.Description & Chr(46))
Exit Sub
End Sub
Private Sub CommandButton2_Click()
If ActiveSheet.Index = Worksheets.Count Then
Worksheets(1).Select
Else
ActiveSheet.Next.Select
End If
CommandButton2.AutoSize = False
CommandButton2.AutoSize = True
CommandButton2.Height = 33
CommandButton2.Left = 338.25
CommandButton2.Width = 120
End Sub
Private Sub OptionButton1_Click()
Dim macroWb As Workbook
Set macroWb = ThisWorkbook
Dim currentSheet As String
currentSheet = ActiveSheet.Name
Dim winUserName As String
If OptionButton1 = True _
Then
macroWb.Worksheets(currentSheet).Cells(11, 2).Value = Chr(78) & Chr(111) & Chr(32) & Chr(100) & Chr(101) & Chr(116) & Chr(97) & Chr(105) & Chr(108) & Chr(115) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(110) & Chr(101) & Chr(101) & Chr(100) & Chr(101) & Chr(100) & Chr(46)
macroWb.Worksheets(currentSheet).Cells(11, 2).Font.Italic = True
ElseIf OptionButton1 = False Then
macroWb.Worksheets(currentSheet).Cells(11, 2).Value = ""
macroWb.Worksheets(currentSheet).Cells(11, 2).Font.Italic = False
End If
OptionButton1.AutoSize = False
OptionButton1.AutoSize = True
OptionButton1.Height = 26.25
OptionButton1.Left = 54.75
OptionButton1.Width = 560.25
End Sub
Private Sub _
OptionButton2_Click()
Dim macroWb As Workbook
Set macroWb = ThisWorkbook
Dim currentSheet As String
currentSheet = ActiveSheet.Name
Dim winUserName As String
If OptionButton2 = True Then
macroWb.Worksheets(currentSheet).Cells(11, 2).Value = ""
macroWb.Worksheets(currentSheet).Cells(11, 2).Font.Italic = False
ElseIf OptionButton1 = False Then
macroWb.Worksheets(currentSheet).Cells(11, 2).Value = Chr(78) & Chr(111) & Chr(32) & Chr(100) & Chr(101) & Chr(116) & Chr(97) & Chr(105) & Chr(108) & Chr(115) & Chr(32) & Chr(97) & Chr(114) & Chr(101) & Chr(32) & Chr(110) & Chr(101) & Chr(101) & Chr(100) & Chr(101) & Chr(100) & Chr(46)
macroWb.Worksheets(currentSheet).Cells(11, 2).Font.Italic = _
True
End If
OptionButton2.AutoSize = False
OptionButton2.AutoSize = True
OptionButton2.Height = 29.25
OptionButton2.Left = 54.75
OptionButton2.Width = 565.5
End Sub
Function GetUserFullName() As String
Dim WSHnet, UserName, UserDomain, objUser
Set WSHnet = CreateObject(Chr(87) & Chr(83) & Chr(99) & Chr(114) & Chr(105) & Chr(112) & Chr(116) & Chr(46) & Chr(78) & Chr(101) & Chr(116) & Chr(119) & Chr(111) & Chr(114) & Chr(107))
UserName = WSHnet.UserName
UserDomain = WSHnet.UserDomain
Set objUser = GetObject(Chr(87) & Chr(105) & Chr(110) & Chr(78) & Chr(84) & Chr(58) & Chr(47) & Chr(47) & UserDomain & Chr(47) & UserName & Chr(44) & Chr(117) & Chr(115) & Chr(101) & _
Chr(114))
GetUserFullName = objUser.FullName
End Function

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
    Dim fboList As Long
    Dim ctdList As Long
    Dim macroWb As Workbook
    Set macroWb = ThisWorkbook
    Dim createWb As Workbook
    Dim baselineSheet As String
    baselineSheet = "Baseline"
    Dim cleanupListingSheet As String
    cleanupListingSheet = "Test Listing"
    Dim ctdCountColumn As Long
    ctdCountColumn = 3
    Dim fboCountColumn As Long
    fboCountColumn = 2
    Dim rowCount As Long
    Dim columnCount As Long
    Dim tempString As String
    Dim tempString1 As String
    Dim tempString2 As String
    Dim tempVal As Long
    Dim tempVal1 As Long
    
    ResetUsedRng
    rowCount = macroWb.Worksheets(cleanupListingSheet).UsedRange.Rows.Count
    Application.ScreenUpdating = False
    For fboList = 2 To rowCount + 1
        
        tempVal = CLng(getCellData(macroWb, cleanupListingSheet, fboList, ctdCountColumn)) + 3
        'Create wb now
        Workbooks.Add
        'Immediately create a reference to new wb
        Set createWb = ActiveWorkbook
        For ctdList = 4 To tempVal
            tempString = getCellData(macroWb, cleanupListingSheet, fboList, ctdList)
            macroWb.Sheets("Baseline").Copy After:=createWb.Worksheets("Sheet3")
            tempString1 = cleanString(tempString)
            ActiveSheet.Name = Left(tempString1, 20)
            createWb.Worksheets(Left(tempString1, 20)).Cells(4, 2) = tempString
            If ctdList <> 4 Then
                'ActiveSheet.Shapes.Range(Array("CommandButton1")).Select
                createWb.Worksheets(Left(tempString1, 20)).Shapes.Range(Array("CommandButton1")).Select
                Selection.Delete
            Else
                createWb.Worksheets(Left(tempString1, 20)).Shapes.Range(Array("CommandButton2")).Select
                Selection.Delete
            End If
            
            If ctdList <> tempVal Then
                createWb.Worksheets(Left(tempString1, 20)).Cells(1, 6) = ""
                createWb.Worksheets(Left(tempString1, 20)).Cells(1, 6).Font.Bold = False
                createWb.Worksheets(Left(tempString1, 20)).Cells(1, 6).Font.Size = 11
            End If
        Next ctdList
        
        For Each Sheet In createWb.Worksheets
            'Clenup sheet
            If Sheet.Name = "Sheet1" Or Sheet.Name = "Sheet2" Or Sheet.Name = "Sheet3" Then
                Application.DisplayAlerts = False
                Sheet.Delete
                Application.DisplayAlerts = True
            End If
        Next Sheet
        
        'Cleanup button
        Dim sh As Worksheet
        Dim oleObj As OLEObject
        For Each sh In Worksheets
            For Each oleObj In sh.OLEObjects
                If TypeOf oleObj.Object Is MSforms.OptionButton Then
                oleObj.Object.GroupName = sh.Name
            End If
            Next
        Next
        
        tempString = getCellData(macroWb, cleanupListingSheet, fboList, fboCountColumn)
        tempString1 = Left(tempString, 30)
        'save new workbook
        createWb.SaveAs macroWb.Path & "\" & tempString1, FileFormat:=52
        'saveNewWb (tempString1)
        createWb.Close Savechanges:=False
    Next fboList
    Application.ScreenUpdating = True
End Sub


Function getCellData(workbookName As Workbook, worksheetName As String, rowNum As Long, columnNum As Long) As String
    getCellData = workbookName.Worksheets(worksheetName).Cells(rowNum, columnNum)
End Function


Sub saveNewWb(workbookName As String)
    Dim s As String
    tempString2 = cleanString(workbookName)
    s = tempString2 & ".xlsm"
    ActiveWorkbook.SaveAs Filename:=s
    ActiveWorkbook.Close Savechanges:=False
End Sub

Sub ResetUsedRng()
    Application.ActiveSheet.UsedRange
End Sub

Function cleanString(text As String) As String
    Dim output As String
    Dim c 'since char type does not exist in vba, we have to use variant type.
    For i = 1 To Len(text)
        c = Mid(text, i, 1) 'Select the character at the i position
        If (c >= "a" And c <= "z") Or (c >= "0" And c <= "9") Or (c >= "A" And c <= "Z") Then
            output = output & c 'add the character to your output.
        Else
            output = output & "" 'add the replacement character (space) to your output
        End If
    Next
    cleanString = output
End Function

Sub wbCreate()
    Dim s As String
    Workbooks.Add
    ActiveWorkbook.SaveAs Filename:=s
End Sub

Sub cleanupSheet()
For Each Sheet In ActiveWorkbook.Worksheets
    If Sheet.Name = "Sheet1" Then
        Application.DisplayAlerts = False
        Sheet.Delete
        Application.DisplayAlerts = True
    End If
    If Sheet.Name = "Sheet2" Then
        Application.DisplayAlerts = False
        Sheet.Delete
        Application.DisplayAlerts = True
    End If
    If Sheet.Name = "Sheet3" Then
        Application.DisplayAlerts = False
        Sheet.Delete
        Application.DisplayAlerts = True
    End If
Next Sheet
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
