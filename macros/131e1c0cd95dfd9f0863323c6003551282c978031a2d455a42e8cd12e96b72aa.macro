Attribute VB_Name = "Dateneingabe"
Attribute VB_Base = "0{67360A05-AFC5-4F10-91C3-933053AF1D90}{71B85179-04C5-485F-859D-C2F5AD539CDA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
   
    Dim Jahr As Integer, JF As String, Eingestellt As String

Private Sub Abbrechen_Click()
    End
End Sub

Private Sub Abbrechen1_Click()
    
    If CInt(Me.TextBox103) <> 0 Then
        Me.TextBox101.Enabled = False
        Me.TextBox102.Enabled = False
        Me.CheckBox1.Enabled = False
    Else
        Me.TextBox101.Enabled = True
        Me.TextBox102.Enabled = True
        Me.CheckBox1.Enabled = True
    End If

    Me.Label.Visible = False
    Me.|fffd|bergabe.Visible = False
    Me.Abbrechen1.Visible = False
    Me.MultiPage.Visible = True
End Sub

Private Sub |fffd|bergabe_Click()

    'Seite 1 Anzahl Mitglieder
    Me.TextBox101 = Me.TextBox122
    Me.TextBox102 = Me.TextBox123
    If CInt(Me.TextBox125) = 0 Then Me.CheckBox1 = False Else Me.CheckBox1 = True
    Me.TextBox104 = 0
    Me.TextBox105 = 0
    Me.TextBox107 = 0
    Me.TextBox108 = 0
    Me.TextBox113 = 0
    Me.TextBox114 = 0
    Me.TextBox116 = 0
    Me.TextBox117 = 0
    Me.TextBox119 = 0
    Me.TextBox120 = 0
    Me.TextBox125 = 0
    'Seite 1 Anzahl Alter
    Me.TextBox126 = 0
    Me.TextBox127 = 0
    Me.TextBox129 = 0
    Me.TextBox130 = 0
    Me.TextBox132 = 0
    Me.TextBox133 = 0
    Me.TextBox135 = 0
    Me.TextBox136 = 0
    Me.TextBox138 = 0
    Me.TextBox139 = 0
    Me.TextBox141 = 0
    Me.TextBox142 = 0
    Me.TextBox144 = 0
    Me.TextBox145 = 0
    Me.TextBox147 = 0
    Me.TextBox148 = 0
    Me.TextBox150 = 0
    Me.TextBox151 = 0
    Me.TextBox153 = 0
    Me.TextBox154 = 0
    Me.TextBox156 = 0
    Me.TextBox157 = 0
    Me.TextBox159 = 0
    Me.TextBox160 = 0
    Me.TextBox162 = 0
    Me.TextBox163 = 0
    Me.TextBox165 = 0
    Me.TextBox166 = 0
    Me.TextBox168 = 0
    Me.TextBox169 = 0
    Me.TextBox171 = 0
    Me.TextBox172 = 0
    'Seite 2 Austrittsgr|fffd|nde
    Me.TextBox201 = 0
    Me.TextBox202 = 0
    Me.TextBox203 = 0
    Me.TextBox204 = 0
    Me.TextBox205 = 0
    Me.TextBox206 = 0
    Me.TextBox207 = 0
    Me.TextBox208 = 0
    'Seite 2 verliehen Jugendflamme
    Me.TextBox210 = 0
    Me.TextBox211 = 0
    Me.TextBox212 = 0
    'Seite 2 Fortbildungen
    Me.TextBox213 = 0
    Me.TextBox214 = 0
    Me.TextBox215 = 0
    Me.TextBox216 = 0
    'Seite 2 JF hat sich beteiligt an
    Me.CheckBox2 = False
    Me.CheckBox3 = False
    Me.CheckBox4 = False
    Me.CheckBox5 = False
    Me.CheckBox6 = False
    Me.CheckBox7 = False
    Me.CheckBox8 = False
    Me.CheckBox9 = False
    Me.CheckBox10 = False
    Me.CheckBox11 = False
    Me.CheckBox12 = False
    'Seite 3 Gruppenabende und Stunden
    Me.CheckBox13 = False
    Me.CheckBox14 = False
    Me.CheckBox15 = False
    Me.CheckBox16 = False
    Me.TextBox301 = 0
    Me.TextBox302 = 0
    Me.TextBox303 = 0
    'Seite 4
    Me.TextBox401 = 0
    Me.TextBox402 = 0
    Me.TextBox403 = 0
    'Stunden
    Me.TextBox404 = 0
    Me.TextBox405 = 0
    Me.TextBox406 = 0
    Me.TextBox408 = 0
    Me.TextBox409 = 0
    Me.TextBox410 = 0
    Me.TextBox412 = 0
    Me.TextBox413 = 0
    Me.TextBox414 = 0
    Me.TextBox416 = 0
    Me.TextBox417 = 0
    Me.TextBox418 = 0
    Me.TextBox420 = 0
    Me.TextBox421 = 0
    Me.TextBox422 = 0
    
    Call Berechnung
    Call Stundenberechnung
    
    If CInt(Me.TextBox103) <> 0 Then
        Me.TextBox101.Enabled = False
        Me.TextBox102.Enabled = False
        Me.CheckBox1.Enabled = False
    Else
        Me.TextBox101.Enabled = True
        Me.TextBox102.Enabled = True
        Me.CheckBox1.Enabled = True
    End If
    
    Me.Label.Visible = False
    Me.|fffd|bergabe.Visible = False
    Me.Abbrechen1.Visible = False
    Me.MultiPage.Visible = True
End Sub

Private Sub UserForm_Activate()
On Error GoTo subErr

    Worksheets("liesmich").Select
    Worksheets("liesmich").Unprotect Password:="tedher112"
    Jahr = Range("I5").Value
    Eingestellt = Range("C20").Value
    JF = Mid(Range("C9").Value, 1, 31)
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    Me.Label2.Caption = "am 31.12." & Jahr - 1
    Me.Label12.Caption = "Gesamtzahl am 31.12." & Jahr
    Me.Label13.Caption = "davon Mitglieder mit Migrationshintergrund am 31.12." & Jahr
    
    Worksheets(JF).Select: Worksheets(JF).Unprotect Password:="tedher112"
    
    Select Case Range("K6").Value
    
        Case Is = "Niedersachsen"
        
        
        Case Else
        
                        
    End Select
    
    'Mitgielderzahlen
    Me.TextBox101 = Range("B15").Value
    Me.TextBox102 = Range("C15").Value
    Me.TextBox104 = Range("B17").Value
    Me.TextBox105 = Range("C17").Value
    Me.TextBox107 = Range("B18").Value
    Me.TextBox108 = Range("C18").Value
    Me.TextBox113 = Range("B22").Value
    Me.TextBox114 = Range("C22").Value
    Me.TextBox116 = Range("B23").Value
    Me.TextBox117 = Range("C23").Value
    Me.TextBox119 = Range("B24").Value
    Me.TextBox120 = Range("C24").Value
    Me.TextBox125 = Range("B28").Value
    'Alter
    Me.TextBox126 = Range("G15").Value
    Me.TextBox127 = Range("H15").Value
    Me.TextBox129 = Range("G16").Value
    Me.TextBox130 = Range("H16").Value
    Me.TextBox132 = Range("G17").Value
    Me.TextBox133 = Range("H17").Value
    Me.TextBox135 = Range("G18").Value
    Me.TextBox136 = Range("H18").Value
    Me.TextBox138 = Range("G19").Value
    Me.TextBox139 = Range("H19").Value
    Me.TextBox141 = Range("G20").Value
    Me.TextBox142 = Range("H20").Value
    Me.TextBox144 = Range("G21").Value
    Me.TextBox145 = Range("H21").Value
    Me.TextBox147 = Range("G22").Value
    Me.TextBox148 = Range("H22").Value
    Me.TextBox150 = Range("G23").Value
    Me.TextBox151 = Range("H23").Value
    Me.TextBox153 = Range("G24").Value
    Me.TextBox154 = Range("H24").Value
    Me.TextBox156 = Range("G25").Value
    Me.TextBox157 = Range("H25").Value
    Me.TextBox159 = Range("G26").Value
    Me.TextBox160 = Range("H26").Value
    Me.TextBox162 = Range("G27").Value
    Me.TextBox163 = Range("H27").Value
    Me.TextBox165 = Range("G28").Value
    Me.TextBox166 = Range("H28").Value
    Me.TextBox168 = Range("G29").Value
    Me.TextBox169 = Range("H29").Value
    'Austrittsgr|fffd|nde
    Me.TextBox201 = Range("M15").Value
    Me.TextBox202 = Range("M16").Value
    Me.TextBox203 = Range("M17").Value
    Me.TextBox204 = Range("M18").Value
    Me.TextBox205 = Range("M19").Value
    Me.TextBox206 = Range("M20").Value
    Me.TextBox207 = Range("M21").Value
    Me.TextBox208 = Range("M22").Value
    'Jugendflamme
    Me.TextBox210 = Range("C40").Value
    Me.TextBox211 = Range("C41").Value
    Me.TextBox212 = Range("C42").Value
    'Fortbildungen
    Me.TextBox213 = Range("C46").Value
    Me.TextBox214 = Range("C47").Value
    Me.TextBox215 = Range("C48").Value
    Me.TextBox216 = Range("C49").Value
    'Gesamttage
    Me.TextBox303 = Range("B53").Value
    'Gesamtstunden
    Me.TextBox301 = Std(Range("H52").Value)
    Me.TextBox302 = Std(Range("H53").Value)
    'Feuerwehrzahlen
    Me.TextBox401 = Range("B71").Value
    Me.TextBox402 = Range("B73").Value
    Me.TextBox403 = Range("B74").Value
    'Zeitaufwand
    Me.TextBox404 = Std(Range("B61").Value)
    Me.TextBox405 = Std(Range("B62").Value)
    Me.TextBox406 = Std(Range("B63").Value)
    Me.TextBox408 = Std(Range("D61").Value)
    Me.TextBox409 = Std(Range("D62").Value)
    Me.TextBox410 = Std(Range("D63").Value)
    Me.TextBox412 = Std(Range("G61").Value)
    Me.TextBox413 = Std(Range("G62").Value)
    Me.TextBox414 = Std(Range("G63").Value)
    Me.TextBox416 = Std(Range("H61").Value)
    Me.TextBox417 = Std(Range("H62").Value)
    Me.TextBox418 = Std(Range("H63").Value)
    Me.TextBox420 = Std(Range("I61").Value)
    Me.TextBox421 = Std(Range("I62").Value)
    Me.TextBox422 = Std(Range("I63").Value)
    
    If Eingestellt <> "" Then basCheckBoxAusblenden
    If CByte(Range("L11").Value) = 1 Then Me.CheckBox1 = True Else Me.CheckBox1 = False
    If CByte(Range("C34").Value) = 1 Then Me.CheckBox2 = True Else Me.CheckBox2 = False
    If CByte(Range("C35").Value) = 1 Then Me.CheckBox3 = True Else Me.CheckBox3 = False
    If CByte(Range("C36").Value) = 1 Then Me.CheckBox4 = True Else Me.CheckBox4 = False
    If CByte(Range("C37").Value) = 1 Then Me.CheckBox5 = True Else Me.CheckBox5 = False
    If CByte(Range("L34").Value) = 1 Then Me.CheckBox6 = True Else Me.CheckBox6 = False
    If CByte(Range("L35").Value) = 1 Then Me.CheckBox7 = True Else Me.CheckBox7 = False
    If CByte(Range("L36").Value) = 1 Then Me.CheckBox8 = True Else Me.CheckBox8 = False
    If CByte(Range("L38").Value) = 1 Then Me.CheckBox9 = True Else Me.CheckBox9 = False
    If CByte(Range("L40").Value) = 1 Then Me.CheckBox10 = True Else Me.CheckBox10 = False
    If CByte(Range("L41").Value) = 1 Then Me.CheckBox11 = True Else Me.CheckBox11 = False
    If CByte(Range("L43").Value) = 1 Then Me.CheckBox12 = True Else Me.CheckBox12 = False
    If CByte(Range("L46").Value) = 1 Then Me.CheckBox13 = True Else Me.CheckBox13 = False
    If CByte(Range("L47").Value) = 1 Then Me.CheckBox14 = True Else Me.CheckBox14 = False
    If CByte(Range("L48").Value) = 1 Then Me.CheckBox15 = True Else Me.CheckBox15 = False
    If CByte(Range("L49").Value) = 1 Then Me.CheckBox16 = True Else Me.CheckBox16 = False
    Worksheets(JF).Protect Password:="tedher112"
    
    If (CDbl(Me.TextBox301) + CDbl(Me.TextBox302)) = 0 Then Me.|fffd|bergabe.Visible = False Else Me.|fffd|bergabe.Visible = True
    Call Berechnung
    Call Stundenberechnung

Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Die Daten auf der Seite" & vbCrLf & vbCrLf & "liesmich" & vbCrLf & vbCrLf & _
            "m|fffd|ssen erst eingeben werden!", vbExclamation, "Pr|fffd|fen"
    Worksheets("liesmich").Select
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    Range("C5").Select: End
    Resume Exit_subErr
End Sub

Private Sub |fffd|bernehmen_Click()

    Worksheets("liesmich").Select: Worksheets("liesmich").Unprotect Password:="tedher112"
    JF = Mid(Range("C9").Value, 1, 31)
    Eingestellt = Range("C20").Value
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    
    Worksheets(JF).Select: Worksheets(JF).Unprotect Password:="tedher112"
    'Mitgliederzahlen
    Range("B15").Value = CInt(Me.TextBox101)
    Range("C15").Value = CInt(Me.TextBox102)
    Range("B17").Value = CInt(Me.TextBox104)
    Range("C17").Value = CInt(Me.TextBox105)
    Range("B18").Value = CInt(Me.TextBox107)
    Range("C18").Value = CInt(Me.TextBox108)
    Range("B22").Value = CInt(Me.TextBox113)
    Range("C22").Value = CInt(Me.TextBox114)
    Range("B23").Value = CInt(Me.TextBox116)
    Range("C23").Value = CInt(Me.TextBox117)
    Range("B24").Value = CInt(Me.TextBox119)
    Range("C24").Value = CInt(Me.TextBox120)
    Range("B28").Value = CInt(Me.TextBox125)
    'Alterszahlen
    Range("G15").Value = CInt(Me.TextBox126)
    Range("H15").Value = CInt(Me.TextBox127)
    Range("G16").Value = CInt(Me.TextBox129)
    Range("H16").Value = CInt(Me.TextBox130)
    Range("G17").Value = CInt(Me.TextBox132)
    Range("H17").Value = CInt(Me.TextBox133)
    Range("G18").Value = CInt(Me.TextBox135)
    Range("H18").Value = CInt(Me.TextBox136)
    Range("G19").Value = CInt(Me.TextBox138)
    Range("H19").Value = CInt(Me.TextBox139)
    Range("G20").Value = CInt(Me.TextBox141)
    Range("H20").Value = CInt(Me.TextBox142)
    Range("G21").Value = CInt(Me.TextBox144)
    Range("H21").Value = CInt(Me.TextBox145)
    Range("G22").Value = CInt(Me.TextBox147)
    Range("H22").Value = CInt(Me.TextBox148)
    Range("G23").Value = CInt(Me.TextBox150)
    Range("H23").Value = CInt(Me.TextBox151)
    Range("G24").Value = CInt(Me.TextBox153)
    Range("H24").Value = CInt(Me.TextBox154)
    Range("G25").Value = CInt(Me.TextBox156)
    Range("H25").Value = CInt(Me.TextBox157)
    Range("G26").Value = CInt(Me.TextBox159)
    Range("H26").Value = CInt(Me.TextBox160)
    Range("G27").Value = CInt(Me.TextBox162)
    Range("H27").Value = CInt(Me.TextBox163)
    Range("G28").Value = CInt(Me.TextBox165)
    Range("H28").Value = CInt(Me.TextBox166)
    Range("G29").Value = CInt(Me.TextBox168)
    Range("H29").Value = CInt(Me.TextBox169)
    'Austrittsgr|fffd|nde
    Range("M15").Value = CInt(Me.TextBox201)
    Range("M16").Value = CInt(Me.TextBox202)
    Range("M17").Value = CInt(Me.TextBox203)
    Range("M18").Value = CInt(Me.TextBox204)
    Range("M19").Value = CInt(Me.TextBox205)
    Range("M20").Value = CInt(Me.TextBox206)
    Range("M21").Value = CInt(Me.TextBox207)
    Range("M22").Value = CInt(Me.TextBox208)
    'Jugendflamme
    Range("C40").Value = CInt(Me.TextBox210)
    Range("C41").Value = CInt(Me.TextBox211)
    Range("C42").Value = CInt(Me.TextBox212)
    'Fortbildungen
    Range("C46").Value = CInt(Me.TextBox213)
    Range("C47").Value = CInt(Me.TextBox214)
    Range("C48").Value = CInt(Me.TextBox215)
    Range("C49").Value = CInt(Me.TextBox216)
    'Gesamttage
    Range("B53").Value = CInt(Me.TextBox303)
    'Gesamtstunden
    Range("H52").Value = CDbl(Me.TextBox301)
    Range("H53").Value = CDbl(Me.TextBox302)
    'Feuerwehrzahlen
    Range("B71").Value = CLng(Me.TextBox401)
    Range("B73").Value = CLng(Me.TextBox402)
    Range("B74").Value = CLng(Me.TextBox403)
    'Zeitaufwand
    Range("B61").Value = CDbl(Me.TextBox404)
    Range("B62").Value = CDbl(Me.TextBox405)
    Range("B63").Value = CDbl(Me.TextBox406)
    Range("D61").Value = CDbl(Me.TextBox408)
    Range("D62").Value = CDbl(Me.TextBox409)
    Range("D63").Value = CDbl(Me.TextBox410)
    Range("G61").Value = CDbl(Me.TextBox412)
    Range("G62").Value = CDbl(Me.TextBox413)
    Range("G63").Value = CDbl(Me.TextBox414)
    Range("H61").Value = CDbl(Me.TextBox416)
    Range("H62").Value = CDbl(Me.TextBox417)
    Range("H63").Value = CDbl(Me.TextBox418)
    Range("I61").Value = CDbl(Me.TextBox420)
    Range("I62").Value = CDbl(Me.TextBox421)
    Range("I63").Value = CDbl(Me.TextBox422)
    
    If Eingestellt <> "" Then
        Me.CheckBox2 = False
        Me.CheckBox3 = False
        Me.CheckBox4 = False
        Me.CheckBox5 = False
        Me.CheckBox6 = False
        Me.CheckBox7 = False
        Me.CheckBox8 = False
        Me.CheckBox9 = False
        Me.CheckBox10 = False
        Me.CheckBox11 = False
        Me.CheckBox12 = False
        Me.CheckBox13 = False
        Me.CheckBox14 = False
        Me.CheckBox15 = False
        Me.CheckBox16 = False
    End If
    
    If Me.CheckBox1 = True Then Range("L11").Value = 1 Else Range("L11").Value = 0
    If Me.CheckBox2 = True Then Range("C34").Value = 1 Else Range("C34").Value = 0
    If Me.CheckBox3 = True Then Range("C35").Value = 1 Else Range("C35").Value = 0
    If Me.CheckBox4 = True Then Range("C36").Value = 1 Else Range("C36").Value = 0
    If Me.CheckBox5 = True Then Range("C37").Value = 1 Else Range("C37").Value = 0
    If Me.CheckBox6 = True Then Range("L34").Value = 1 Else Range("L34").Value = 0
    If Me.CheckBox7 = True Then Range("L35").Value = 1 Else Range("L35").Value = 0
    If Me.CheckBox8 = True Then Range("L36").Value = 1 Else Range("L36").Value = 0
    If Me.CheckBox9 = True Then Range("L38").Value = 1 Else Range("L38").Value = 0
    If Me.CheckBox10 = True Then Range("L40").Value = 1 Else Range("L40").Value = 0
    If Me.CheckBox11 = True Then Range("L41").Value = 1 Else Range("L41").Value = 0
    If Me.CheckBox12 = True Then Range("L43").Value = 1 Else Range("L43").Value = 0
    If Me.CheckBox13 = True Then Range("L46").Value = 1 Else Range("L46").Value = 0
    If Me.CheckBox14 = True Then Range("L47").Value = 1 Else Range("L47").Value = 0
    If Me.CheckBox15 = True Then Range("L48").Value = 1 Else Range("L48").Value = 0
    If Me.CheckBox16 = True Then Range("L49").Value = 1 Else Range("L49").Value = 0
    Cells.Select: Selection.Locked = True: Selection.FormulaHidden = False
    Range("G1").Select
    Worksheets(JF).Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection: End
End Sub

Function basCheckBoxAusblenden()

    Me.Label44.Visible = False
    Me.Label50.Visible = False
    Me.CheckBox2.Visible = False
    Me.CheckBox3.Visible = False
    Me.CheckBox4.Visible = False
    Me.CheckBox5.Visible = False
    Me.CheckBox6.Visible = False
    Me.CheckBox7.Visible = False
    Me.CheckBox8.Visible = False
    Me.CheckBox9.Visible = False
    Me.CheckBox10.Visible = False
    Me.CheckBox11.Visible = False
    Me.CheckBox12.Visible = False
    Me.CheckBox13.Visible = False
    Me.CheckBox14.Visible = False
    Me.CheckBox15.Visible = False
    Me.CheckBox16.Visible = False
End Function

Function Bewertung(x As String)

    If Me("TextBox" & x) = Empty Then Me("TextBox" & x) = 0
    Call Berechnung
End Function

Function Berechnung()

    'Mitgliederberechnung
    Me.TextBox110 = CInt(Me.TextBox101) + CInt(Me.TextBox104) + CInt(Me.TextBox107)
    Me.TextBox111 = CInt(Me.TextBox102) + CInt(Me.TextBox105) + CInt(Me.TextBox108)
    Me.TextBox103 = CInt(Me.TextBox101) + CInt(Me.TextBox102)
    Me.TextBox106 = CInt(Me.TextBox104) + CInt(Me.TextBox105)
    Me.TextBox109 = CInt(Me.TextBox107) + CInt(Me.TextBox108)
    Me.TextBox112 = CInt(Me.TextBox110) + CInt(Me.TextBox111)
    Me.TextBox115 = CInt(Me.TextBox113) + CInt(Me.TextBox114)
    Me.TextBox118 = CInt(Me.TextBox116) + CInt(Me.TextBox117)
    Me.TextBox121 = CInt(Me.TextBox119) + CInt(Me.TextBox120)
    Me.TextBox122 = CInt(Me.TextBox110) - CInt(Me.TextBox113) - CInt(Me.TextBox119)
    Me.TextBox123 = CInt(Me.TextBox111) - CInt(Me.TextBox114) - CInt(Me.TextBox120)
    Me.TextBox124 = CInt(Me.TextBox122) + CInt(Me.TextBox123)
    
    'Altersberechnung
    Me.TextBox128 = CInt(Me.TextBox126) + CInt(Me.TextBox127)   'unter 6
    Me.TextBox131 = CInt(Me.TextBox129) + CInt(Me.TextBox130)   '6
    Me.TextBox134 = CInt(Me.TextBox132) + CInt(Me.TextBox133)   '7
    Me.TextBox137 = CInt(Me.TextBox135) + CInt(Me.TextBox136)   '8
    Me.TextBox140 = CInt(Me.TextBox138) + CInt(Me.TextBox139)   '9
    Me.TextBox143 = CInt(Me.TextBox141) + CInt(Me.TextBox142)   '10
    Me.TextBox146 = CInt(Me.TextBox144) + CInt(Me.TextBox145)   '11
    Me.TextBox149 = CInt(Me.TextBox147) + CInt(Me.TextBox148)   '12
    Me.TextBox152 = CInt(Me.TextBox150) + CInt(Me.TextBox151)   '13
    Me.TextBox155 = CInt(Me.TextBox153) + CInt(Me.TextBox154)   '14
    Me.TextBox158 = CInt(Me.TextBox156) + CInt(Me.TextBox157)   '15
    Me.TextBox161 = CInt(Me.TextBox159) + CInt(Me.TextBox160)   '16
    Me.TextBox164 = CInt(Me.TextBox162) + CInt(Me.TextBox163)   '17
    Me.TextBox167 = CInt(Me.TextBox165) + CInt(Me.TextBox166)   '18
    Me.TextBox170 = CInt(Me.TextBox168) + CInt(Me.TextBox169)   '|fffd|ber 18
    
    'Anzahl Jungen
    Me.TextBox171 = CInt(Me.TextBox126) + CInt(Me.TextBox129) + CInt(Me.TextBox132) + CInt(Me.TextBox135) + _
                    CInt(Me.TextBox138) + CInt(Me.TextBox141) + CInt(Me.TextBox144) + CInt(Me.TextBox147) + _
                    CInt(Me.TextBox150) + CInt(Me.TextBox153) + CInt(Me.TextBox156) + CInt(Me.TextBox159) + _
                    CInt(Me.TextBox162) + CInt(Me.TextBox165) + CInt(Me.TextBox168)
    'Anzahl M|fffd|dchen
    Me.TextBox172 = CInt(Me.TextBox127) + CInt(Me.TextBox130) + CInt(Me.TextBox133) + CInt(Me.TextBox136) + _
                    CInt(Me.TextBox139) + CInt(Me.TextBox142) + CInt(Me.TextBox145) + CInt(Me.TextBox148) + _
                    CInt(Me.TextBox151) + CInt(Me.TextBox154) + CInt(Me.TextBox157) + CInt(Me.TextBox160) + _
                    CInt(Me.TextBox163) + CInt(Me.TextBox166) + CInt(Me.TextBox169)
    'Anzahl gesamt
    Me.TextBox173 = CInt(Me.TextBox171) + CInt(Me.TextBox172)
    
    'Anzahl Austrittsgr|fffd|nde
    Me.TextBox209 = CInt(Me.TextBox201) + CInt(Me.TextBox202) + CInt(Me.TextBox203) + CInt(Me.TextBox204) + _
                    CInt(Me.TextBox205) + CInt(Me.TextBox206) + CInt(Me.TextBox207) + CInt(Me.TextBox208)
  
    If CInt(Me.TextBox122) < 0 Or CInt(Me.TextBox123) < 0 Then Me.Label88.Visible = True Else Me.Label88.Visible = False
    'Pr|fffd|fung Anzahl Jungen
    If CInt(Me.TextBox122) = CInt(Me.TextBox171) Then Me.Label38.Visible = False Else Me.Label38.Visible = True
    'Pr|fffd|fung Anzahl M|fffd|dchen
    If CInt(Me.TextBox123) = CInt(Me.TextBox172) Then Me.Label96.Visible = False Else Me.Label96.Visible = True
    'Pr|fffd|fung Anzahl Gesamt
    If CInt(Me.TextBox124) = CInt(Me.TextBox173) Then Me.Label98.Visible = False Else Me.Label98.Visible = True
    
    'Pr|fffd|fung Austrittsgr|fffd|nde
    If CInt(Me.TextBox121) = CInt(Me.TextBox209) Then Me.Label39.Visible = False Else Me.Label39.Visible = True
End Function

Function Stundenbewertung(x As String)

    If Me("TextBox" & x) = Empty Then Me("TextBox" & x) = 0 Else Me("TextBox" & x) = Std(Me("TextBox" & x))
    Call Stundenberechnung
End Function

Function Std(strStunden As String) As String

    Dim x As Integer
    Dim intL|fffd|nge As Integer, Std_1
    
    intL|fffd|nge = Len(strStunden)
    For x = intL|fffd|nge To 1 Step -1
        If Mid(strStunden, x, 1) = "." Or x = 1 Then
            If x = 1 Then Std = Right(strStunden, intL|fffd|nge) Else Std_1 = Right(strStunden, intL|fffd|nge - x)
            If Val(Std_1) <> 0 Then
                Std = Left(strStunden, x - 1)
                Std = Std & "," & Std_1
                Exit For
            End If
        End If
    Next x
End Function

Function Stundenberechnung()
    
    Me.TextBox407 = CDbl(Me.TextBox404) + CDbl(Me.TextBox405) + CDbl(Me.TextBox406)
    Me.TextBox411 = CDbl(Me.TextBox408) + CDbl(Me.TextBox409) + CDbl(Me.TextBox410)
    Me.TextBox415 = CDbl(Me.TextBox412) + CDbl(Me.TextBox413) + CDbl(Me.TextBox414)
    Me.TextBox419 = CDbl(Me.TextBox416) + CDbl(Me.TextBox417) + CDbl(Me.TextBox418)
    Me.TextBox423 = CDbl(Me.TextBox420) + CDbl(Me.TextBox421) + CDbl(Me.TextBox422)
    Me.TextBox424 = CDbl(Me.TextBox407) + CDbl(Me.TextBox411) + CDbl(Me.TextBox415) + CDbl(Me.TextBox419) + CDbl(Me.TextBox423)
End Function

Function Flamme(x As String)
    
    If Me("TextBox" & x) = Empty Then Me("TextBox" & x) = 0
    If CInt(Me.TextBox210) > CInt(Me.TextBox112) Or _
            CInt(Me.TextBox211) > CInt(Me.TextBox112) Or _
            CInt(Me.TextBox212) > CInt(Me.TextBox112) Then
        Me.Label43.Visible = True
    Else
        Me.Label43.Visible = False
    End If
End Function

Function Pr|fffd|fung(x As String)

    If Me("TextBox" & x) = Empty Then Me("TextBox" & x) = 0 Else Me("TextBox" & x) = Std(Me("TextBox" & x))
End Function

Function Dienstabend(A As String, B As String, C As String, D As String)

    If Me("CheckBox" & A) = True Then
        Me("CheckBox" & B) = False
        Me("CheckBox" & C) = False
        Me("CheckBox" & D) = False
    End If
End Function

Private Sub CheckBox13_Click()
    Call Dienstabend(13, 14, 15, 16)
End Sub

Private Sub CheckBox14_Click()
    Call Dienstabend(14, 13, 15, 16)
End Sub

Private Sub CheckBox15_Click()
    Call Dienstabend(15, 13, 14, 16)
End Sub

Private Sub CheckBox16_Click()
    Call Dienstabend(16, 13, 14, 15)
End Sub

Private Sub TextBox101_AfterUpdate()
    Call Bewertung(101)
End Sub

Private Sub TextBox102_AfterUpdate()
    Call Bewertung(102)
End Sub

Private Sub TextBox104_AfterUpdate()
    Call Bewertung(104)
End Sub

Private Sub TextBox105_AfterUpdate()
    Call Bewertung(105)
End Sub

Private Sub TextBox107_AfterUpdate()
    Call Bewertung(107)
End Sub

Private Sub TextBox108_AfterUpdate()
    Call Bewertung(108)
End Sub

Private Sub TextBox113_AfterUpdate()
    Call Bewertung(113)
End Sub

Private Sub TextBox114_AfterUpdate()
    Call Bewertung(114)
End Sub

Private Sub TextBox116_AfterUpdate()
    Call Bewertung(116)
End Sub

Private Sub TextBox117_AfterUpdate()
    Call Bewertung(117)
End Sub

Private Sub TextBox118_AfterUpdate()
    Call Bewertung(118)
End Sub

Private Sub TextBox119_AfterUpdate()
    Call Bewertung(119)
End Sub

Private Sub TextBox120_AfterUpdate()
    Call Bewertung(120)
End Sub

Private Sub TextBox126_AfterUpdate()
    Call Bewertung(126)
End Sub

Private Sub TextBox127_AfterUpdate()
    Call Bewertung(127)
End Sub

Private Sub TextBox129_AfterUpdate()
    Call Bewertung(129)
End Sub

Private Sub TextBox130_AfterUpdate()
    Call Bewertung(130)
End Sub

Private Sub TextBox132_AfterUpdate()
    Call Bewertung(132)
End Sub

Private Sub TextBox133_AfterUpdate()
    Call Bewertung(133)
End Sub

Private Sub TextBox135_AfterUpdate()
    Call Bewertung(135)
End Sub

Private Sub TextBox136_AfterUpdate()
    Call Bewertung(136)
End Sub

Private Sub TextBox138_AfterUpdate()
    Call Bewertung(138)
End Sub

Private Sub TextBox139_AfterUpdate()
    Call Bewertung(139)
End Sub

Private Sub TextBox141_AfterUpdate()
    Call Bewertung(141)
End Sub

Private Sub TextBox142_AfterUpdate()
    Call Bewertung(142)
End Sub

Private Sub TextBox144_AfterUpdate()
    Call Bewertung(144)
End Sub

Private Sub TextBox145_AfterUpdate()
    Call Bewertung(145)
End Sub

Private Sub TextBox147_AfterUpdate()
    Call Bewertung(147)
End Sub

Private Sub TextBox148_AfterUpdate()
    Call Bewertung(148)
End Sub

Private Sub TextBox150_AfterUpdate()
    Call Bewertung(150)
End Sub

Private Sub TextBox151_AfterUpdate()
    Call Bewertung(151)
End Sub

Private Sub TextBox153_AfterUpdate()
    Call Bewertung(153)
End Sub

Private Sub TextBox154_AfterUpdate()
    Call Bewertung(154)
End Sub

Private Sub TextBox156_AfterUpdate()
    Call Bewertung(156)
End Sub

Private Sub TextBox157_AfterUpdate()
    Call Bewertung(157)
End Sub

Private Sub TextBox159_AfterUpdate()
    Call Bewertung(159)
End Sub

Private Sub TextBox160_AfterUpdate()
    Call Bewertung(160)
End Sub

Private Sub TextBox162_AfterUpdate()
    Call Bewertung(162)
End Sub

Private Sub TextBox163_AfterUpdate()
    Call Bewertung(163)
End Sub

Private Sub TextBox165_AfterUpdate()
    Call Bewertung(165)
End Sub

Private Sub TextBox166_AfterUpdate()
    Call Bewertung(166)
End Sub

Private Sub TextBox168_AfterUpdate()
    Call Bewertung(168)
End Sub

Private Sub TextBox169_AfterUpdate()
    Call Bewertung(169)
End Sub

Private Sub TextBox171_AfterUpdate()
    Call Bewertung(171)
End Sub

Private Sub TextBox172_AfterUpdate()
    Call Bewertung(172)
End Sub

Private Sub TextBox201_AfterUpdate()
    Call Bewertung(201)
End Sub

Private Sub TextBox202_AfterUpdate()
    Call Bewertung(202)
End Sub

Private Sub TextBox203_AfterUpdate()
    Call Bewertung(203)
End Sub

Private Sub TextBox204_AfterUpdate()
    Call Bewertung(204)
End Sub

Private Sub TextBox205_AfterUpdate()
    Call Bewertung(205)
End Sub

Private Sub TextBox206_AfterUpdate()
    Call Bewertung(206)
End Sub

Private Sub TextBox207_AfterUpdate()
    Call Bewertung(207)
End Sub

Private Sub TextBox208_AfterUpdate()
    Call Bewertung(208)
End Sub

Private Sub TextBox210_AfterUpdate()
    Call Flamme(210)
End Sub

Private Sub TextBox211_AfterUpdate()
    Call Flamme(211)
End Sub

Private Sub TextBox212_AfterUpdate()
    Call Flamme(212)
End Sub

Private Sub TextBox301_AfterUpdate()
    Call Pr|fffd|fung(301)
End Sub

Private Sub TextBox302_AfterUpdate()
    Call Pr|fffd|fung(302)
End Sub

Private Sub TextBox303_AfterUpdate()
    Call Pr|fffd|fung(303)
End Sub

Private Sub TextBox401_AfterUpdate()
    Call Pr|fffd|fung(401)
End Sub

Private Sub TextBox402_AfterUpdate()
    Call Pr|fffd|fung(402)
End Sub

Private Sub TextBox403_AfterUpdate()
    Call Pr|fffd|fung(403)
End Sub

Private Sub TextBox404_AfterUpdate()
    Call Stundenbewertung(404)
End Sub

Private Sub TextBox405_AfterUpdate()
    Call Stundenbewertung(405)
End Sub

Private Sub TextBox406_AfterUpdate()
    Call Stundenbewertung(406)
End Sub

Private Sub TextBox408_AfterUpdate()
    Call Stundenbewertung(408)
End Sub

Private Sub TextBox409_AfterUpdate()
    Call Stundenbewertung(409)
End Sub

Private Sub TextBox410_AfterUpdate()
    Call Stundenbewertung(410)
End Sub

Private Sub TextBox412_AfterUpdate()
    Call Stundenbewertung(412)
End Sub

Private Sub TextBox413_AfterUpdate()
    Call Stundenbewertung(413)
End Sub

Private Sub TextBox414_AfterUpdate()
    Call Stundenbewertung(414)
End Sub

Private Sub TextBox416_AfterUpdate()
    Call Stundenbewertung(416)
End Sub

Private Sub TextBox417_AfterUpdate()
    Call Stundenbewertung(417)
End Sub

Private Sub TextBox418_AfterUpdate()
    Call Stundenbewertung(418)
End Sub

Private Sub TextBox420_AfterUpdate()
    Call Stundenbewertung(420)
End Sub

Private Sub TextBox421_AfterUpdate()
    Call Stundenbewertung(421)
End Sub

Private Sub TextBox422_AfterUpdate()
    Call Stundenbewertung(422)
End Sub
Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Attribute VB_Name = "Eingabeformular"
Attribute VB_Base = "0{785A173E-E637-45ED-8636-1AD5CE6607C1}{6868B5FE-74F4-416A-8D80-DD22CA4ABCFD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

    Dim Laenge As Integer, intL|fffd|nge As Integer
    Dim OrdNr As String, tmpHausnummer As String
    Dim JF As String

Private Sub Abbrechen_Click()
    End
End Sub

Private Sub Beenden_Click()
    Application.Quit
End Sub

Private Sub Berichtsjahr_Click()    'Jahr festlegen

    If Me.TextBox6 = Empty Then
        If Me.Berichtsjahr = True Then
            Me.Vorjahr = False
            Me.Eingabe.Visible = True
        ElseIf Me.Berichtsjahr = False Then
            Call basGrunddatenSichtbar(False)
            Me.Eingabe.Visible = False
        End If
    Else
        If Me.Berichtsjahr = True Then
            Me.Vorjahr = False
            Me.Eingabe_Neu.Visible = True
        ElseIf Me.Berichtsjahr = False Then
            Call basGrunddatenSichtbar(False)
            Me.Eingabe_Neu.Visible = False
        End If
    End If
End Sub

Private Sub TextBox1_Change()

    If Me.TextBox1 = "Hannover" Then Me.Label1 = "Region"
End Sub

Private Sub TextBox4_Change()
On Error Resume Next

    If Me.TextBox10 = "nicht bekannt" Then Me.TextBox10 = Me.TextBox4.Column(1)
    If Len(Me.TextBox10) = 14 And (CDbl((Mid(Me.TextBox10, 4, 3))) + CDbl((Mid(Me.TextBox10, 8, 3))) + CDbl((Mid(Me.TextBox10, 12, 3)))) = 0 Then Me.TextBox10 = Me.TextBox4.Column(1)
End Sub

Private Sub Vorjahr_Click() 'Jahr festlegen

    If Me.TextBox6 = Empty Then
        If Me.Vorjahr = True Then
            Me.Berichtsjahr = False
            Me.Eingabe.Visible = True
        ElseIf Me.Vorjahr = False Then
            Me.Eingabe.Visible = False
            Call basGrunddatenSichtbar(False)
        End If
    Else
        If Me.Vorjahr = True Then
            Me.Berichtsjahr = False
            Me.Eingabe_Neu.Visible = True
        ElseIf Me.Vorjahr = False Then
            Me.Eingabe_Neu.Visible = False
            Call basGrunddatenSichtbar(False)
        End If
    End If
End Sub

Private Sub Neu_Click()    'Jahresbericht erstellen beginnen   i. O.

    If Me.Neu = True Then
        Me.Neu.Visible = False
        Me.Vorjahr.Visible = True
        Me.Berichtsjahr.Visible = True
    End If
End Sub

Private Sub Alt_Click()    'Jahr des Jahresberichts |fffd|ndern

    If Me.Alt = True Then
        Me.Alt.Visible = False
        Me.Vorjahr.Visible = True
        Me.Berichtsjahr.Visible = True
        Me.|fffd|bernehmen.Visible = False
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
        Call basGrunddatenSichtbar(False)
        Call basJugendwartSichtbar(False)
        Me.Abdeckung.Visible = True
    End If
End Sub

Private Sub TextBox6_AfterUpdate()  ' JF gegr|fffd|ndet
On Error GoTo subErr

    If IsDate(Me.TextBox6) Then
        Me.TextBox6 = Format(DateValue(Me.TextBox6))
        Me.|fffd|bernehmen.Visible = True
    Else
        MsgBox "Der von Ihnen eingegebene Wert ist kein Datum.", vbExclamation, "Fehlermeldung"
        Me.TextBox6 = Empty
        Me.|fffd|bernehmen.Visible = False
        Call basJugendwartSichtbar(False)
        Me.Daten_eingeben.Visible = False
    End If

Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Das Datum ist nicht" & vbCrLf & "richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
    Me.TextBox6 = Empty
    Me.|fffd|bernehmen.Visible = False
    Call basJugendwartSichtbar(False)
    Resume Exit_subErr
End Sub

Private Sub TextBox7_AfterUpdate()  'Dienstbetrieb eingestellt
On Error GoTo subErr

    If IsDate(Me.TextBox7) Then
        If MsgBox("Wurde der Dienstbetrieb eingestellt?", vbQuestion + vbYesNo, "Pr|fffd|fen") = vbNo Then Me.TextBox7 = Empty
        Me.TextBox7 = Format(DateValue(Me.TextBox7))
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
        Me.|fffd|bernehmen.Visible = True
        Me.Label11.Visible = False
        Me.TextBox11.Visible = False
    Else
        If Me.TextBox7 <> "" Then MsgBox "Der von Ihnen eingegebene Wert ist kein Datum.", vbExclamation, "Fehlermeldung"
        Me.TextBox7 = Empty
        Me.Label11.Visible = True
        Me.TextBox11.Visible = True
        If Me.TextBox7 = Empty Then Me.TextBox11 = DateDiff("yyyy", Me.TextBox23, Me.TextBox9) Else Me.TextBox11 = Empty
        Me.|fffd|bernehmen.Visible = True
        Me.Daten_eingeben.Visible = False
    End If

Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Das Datum ist nicht" & vbCrLf & "richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
    Me.TextBox7 = Empty
    Me.|fffd|bernehmen.Visible = False
    Me.Daten_eingeben.Visible = False
    Resume Exit_subErr
End Sub

Private Sub TextBox23_AfterUpdate() 'geb. am:
On Error GoTo subErr

    If IsDate(Me.TextBox23) Then
        Me.TextBox23 = Format(DateValue(Me.TextBox23))
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
        If Me.TextBox7 = Empty Then Me.TextBox11 = DateDiff("yyyy", Me.TextBox23, Me.TextBox9) Else Me.TextBox11 = Empty
        Me.|fffd|bernehmen1.Visible = True
    Else
        MsgBox "Der von Ihnen eingegebene Wert ist kein Datum.", vbExclamation, "Fehlermeldung"
        Me.TextBox23 = Empty
        Me.TextBox11 = Empty
        Me.TextBox12 = Empty
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
    End If
   
    If Me.TextBox23 = Empty Or Me.TextBox24 = Empty Then
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
    Else
        Me.|fffd|bernehmen1.Visible = True
        Me.Daten_eingeben.Visible = True
    End If

Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Das Datum ist nicht" & vbCrLf & "richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
    Me.TextBox23 = Empty
    Me.|fffd|bernehmen1.Visible = False
    Me.Daten_eingeben.Visible = False
    Resume Exit_subErr
End Sub

Private Sub TextBox24_AfterUpdate() 'JFW seit:
On Error GoTo subErr

    If IsDate(Me.TextBox24) Then
        Me.TextBox24 = Format(DateValue(Me.TextBox24))
    Else
        MsgBox "Der von Ihnen eingegebene Wert ist kein Datum.", vbExclamation, "Fehlermeldung"
        Me.TextBox24 = Empty
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
        Exit Sub
    End If
   
    If Me.TextBox23 = Empty Or Me.TextBox24 = Empty Then
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
    Else
        Me.|fffd|bernehmen1.Visible = True
        Me.Daten_eingeben.Visible = True
    End If

Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Das Datum ist nicht" & vbCrLf & "richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
    Me.TextBox24 = Empty
    Me.|fffd|bernehmen1.Visible = False
    Me.Daten_eingeben.Visible = False
    Resume Exit_subErr
End Sub

Private Sub Eingabe_Click() 'Beginn der Eingabe f|fffd|r den Jahresbericht
On Error GoTo subErr

    If Me.Berichtsjahr = True Then
        Me.TextBox8 = Format(Date, "yyyy")
        Me.TextBox9 = "31.12." & Format(Date, "yyyy")
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
    ElseIf Me.Vorjahr = True Then
        Me.Berichtsjahr = False
        Me.TextBox8 = Format(Date, "yyyy") - 1
        Me.TextBox9 = "31.12." & Format(Date, "yyyy") - 1
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
    ElseIf Me.Vorjahr = False Then Me.Abdeckung.Visible = True: Call basGrunddatenSichtbar(False) 'Call basGrunddatenAusblenden
    ElseIf Me.Berichtsjahr = False Then Me.Abdeckung.Visible = True: Call basGrunddatenSichtbar(False) 'Call basGrunddatenAusblenden
    End If
    
    If Me.TextBox10 = Empty Then
        If MsgBox("Ist die Ordnungsnummer bekannt ?", vbYesNo + vbQuestion + vbDefaultButton2, "Frage") = vbYes Then
            Call Ordnungsnummer
        Else
            Me.TextBox10 = "nicht bekannt"
        End If
    Else
        If MsgBox("Ordnungsnummer :  " & Me.TextBox10, vbYesNo + vbQuestion + vbDefaultButton2, "Pr|fffd|fen") = vbNo Then
            Me.TextBox10 = Empty
            Call Ordnungsnummer
        End If
    End If
    
    If Me.TextBox6 = Empty Then
        Call basGrunddatenSichtbar(True)
        Me.Abdeckung.Visible = False
        Me.Eingabe.Visible = False
        Me.TextBox4.SetFocus
    Else
        Call basGrunddatenSichtbar(True)
        Me.Abdeckung.Visible = False
        Me.Eingabe.Visible = False
        Me.|fffd|bernehmen.Visible = True
        Me.TextBox4.SetFocus
    End If
    
Exit_subErr:
    Exit Sub
subErr:
    MsgBox "Die Ordnungsnummer ist nicht" & vbCrLf & "richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
    Me.Vorjahr = False
    Me.Berichtsjahr = False
    Resume Exit_subErr
End Sub

Private Sub Eingabe_Neu_Click() 'Jahr f|fffd|r den Jahresbericht |fffd|ndern
On Error GoTo subErr
    
    If Me.Berichtsjahr = True Then
        Me.TextBox8 = Format(Date, "yyyy")
        Me.TextBox9 = "31.12." & Format(Date, "yyyy")
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
        Me.Berichtsjahr = False
        Me.Berichtsjahr.Visible = False
        Me.Vorjahr.Visible = False
        Me.Alt.Visible = True
        Me.Alt = False
        Me.Abdeckung.Visible = False
    ElseIf Me.Vorjahr = True Then
        Me.TextBox8 = Format(Date, "yyyy") - 1
        Me.TextBox9 = "31.12." & Format(Date, "yyyy") - 1
        Me.TextBox12 = Format(Date, "dd" & "." & "mm" & "." & "yyyy")
        Me.Vorjahr = False
        Me.Vorjahr.Visible = False
        Me.Berichtsjahr.Visible = False
        Me.Alt.Visible = True
        Me.Alt = False
        Me.Abdeckung.Visible = False
    End If
    
    Call basGrunddatenSichtbar(True)
    Call basJugendwartSichtbar(True)
    
    If Me.TextBox23 = Empty Or Me.TextBox24 = Empty Then
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
    Else
        Me.|fffd|bernehmen1.Visible = True
        Me.Daten_eingeben.Visible = True
    End If
    
    Me.TextBox11 = DateDiff("yyyy", Me.TextBox23, Me.TextBox9)

Exit_subErr:
    Exit Sub
subErr:
    Me.|fffd|bernehmen.Visible = True
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    ActiveWorkbook.Protect Password:="tedher112"
    Resume Exit_subErr
End Sub

Private Sub Daten_eingeben_Click()  'Daten des Jahresberichts eingeben, Formular Dateneingabe aufrufen

    Worksheets("liesmich").Unprotect Password:="tedher112"
    JF = Range("B2").Value
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    Sheets(JF).Select: Dateneingabe.Show: End
End Sub

Private Sub |fffd|bernehmen_Click()  'Grunddaten der Jugendfeuerwehr |fffd|bernehmen
On Error GoTo subErr

    Worksheets("liesmich").Unprotect Password:="tedher112"
    
    If Me.Vorjahr = True Then
        Range("A2").Value = "Vorjahr"
    ElseIf Me.Berichtsjahr = True Then
        Range("A2").Value = "Berichtsjahr"
    End If
    
    Range("C5").Value = Me.TextBox1                                 'Kreis
    If Me.TextBox1 = "Hannover" Then Range("A5").Value = "Region"
    Range("C7").Value = Me.TextBox2                                 'Gemeinde
    Range("C9").Value = Me.TextBox3                                 'Jugendfeuerwehr
    Range("C11").Value = Me.TextBox4                                'Bundesland
    Range("C13").Value = Me.TextBox5                                'Bezirk
    Range("C18").Value = Me.TextBox6                                'JF gegr|fffd|ndet
    Range("C20").Value = Empty
    If IsDate(Me.TextBox7) Then Range("C20").Value = Me.TextBox7    'Dienstbetrieb eingestellt
    If IsDate(Me.TextBox7) Then Range("I11").Value = "" Else Range("I11").Value = Me.TextBox11
    Range("I5").Value = Me.TextBox8                                 'Jahr
    Range("I7").Value = Me.TextBox9                                 'Stand
    Range("I9").Value = Me.TextBox10                                'Ordnungsnummer
    Range("I13").Value = Me.TextBox12                               'Erstellt am
    
    ActiveWorkbook.Unprotect Password:="tedher112"
    JF = Range("B2").Value
    Range("B2").Value = Mid(Me.TextBox3, 1, 31)
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    Sheets(JF).Name = Mid(Me.TextBox3, 1, 31)
    ActiveWorkbook.Protect Password:="tedher112"
        
    Call basJugendwartSichtbar(True)
    
    If IsDate(Me.TextBox7) Then
        Me.|fffd|bernehmen.Visible = False
        Me.|fffd|bernehmen1.Visible = True
        Me.Daten_eingeben.Visible = True
        Me.TextBox11 = Empty
        Me.Label11.Visible = False
        Me.TextBox11.Visible = False
    Else
        Me.|fffd|bernehmen.Visible = False
        Me.Label11.Visible = True
        Me.TextBox11.Visible = True
        Me.|fffd|bernehmen1.Visible = True
    End If
    
Exit_subErr:
    Exit Sub
subErr:
    Range("B2").Value = "x1": Sheets(JF).Name = "x1"
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    ActiveWorkbook.Protect Password:="tedher112": End
    Resume Exit_subErr
End Sub

Private Sub |fffd|bernehmen1_Click() 'Daten des/der Jugendwartes/in |fffd|bernehmen
On Error GoTo subErr

    Worksheets("liesmich").Unprotect Password:="tedher112"
    Range("I5").Value = Me.TextBox8                                     'Jahr
    Range("I7").Value = Me.TextBox9                                     'Stand
    Range("I13").Value = Me.TextBox12                                   'Erstellt am
    
    If Me.TextBox7 = Empty Then
        Range("I11").Value = CInt(Me.TextBox11)                         'Alter der JFW
        Range("G19").Value = Me.TextBox13                               'Internetseite
        Range("G21").Value = Me.TextBox14                               'eMail
        Range("B23").Value = Me.TextBox15                               'Zuname
        Range("E23").Value = Me.TextBox16                               'Vorname
        Range("B24").Value = Me.TextBox17                               'Beruf
        Range("E24").Value = Me.TextBox18                               'Dienstgrad
        Range("B25").Value = Me.TextBox19                               'PLZ
        Range("C25").Value = Me.TextBox20                               'Wohnort
        Range("E25").Value = Me.TextBox21 & " " & Me.TextBox22          'Stra|fffd|e und Hausnummer
        Range("I23").Value = Me.TextBox23                               'Geburtsdatum
        Range("I24").Value = Me.TextBox24                               'JFW seit
        Range("I25").Value = Me.TextBox25                               'Telefon
        Range("I26").Value = Me.TextBox26                               'Fax
    Else
        Range("C20").Value = Empty
        If IsDate(Me.TextBox7) Then Range("C20").Value = Me.TextBox7    'Dienstbetrieb eingestellt
        Me.TextBox11 = Empty                                            'Alter der JFW
        If Me.TextBox11 = Empty Then
            Range("I11").Value = ""
        Else
            Range("I11").Value = CInt(Me.TextBox11)                     'Alter der JFW
        End If
        Range("G19").Value = Me.TextBox13                               'Internetseite
        Range("G21").Value = Me.TextBox14                               'eMail
        Range("B23").Value = Me.TextBox15                               'Zuname
        Range("E23").Value = Me.TextBox16                               'Vorname
        Range("B24").Value = Me.TextBox17                               'Beruf
        Range("E24").Value = Me.TextBox18                               'Dienstgrad
        Range("B25").Value = Me.TextBox19                               'PLZ
        Range("C25").Value = Me.TextBox20                               'Wohnort
        Range("E25").Value = Me.TextBox21 & " " & Me.TextBox22          'Stra|fffd|e und Hausnummer
        Range("I23").Value = Me.TextBox23                               'Geburtsdatum
        Range("I24").Value = Me.TextBox24                               'JFW seit
        Range("I25").Value = Me.TextBox25                               'Telefon
        Range("I26").Value = Me.TextBox26                               'Fax
        Me.Label11.Visible = False
        Me.TextBox11.Visible = False
        Me.|fffd|bernehmen1.Visible = False
    End If
    
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    Me.Daten_eingeben.Visible = True
    
Exit_subErr:
    Exit Sub
subErr:
    If Err.Number = 13 Then
        Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
        ActiveSheet.EnableSelection = xlNoSelection: End
    Else
        ActiveWorkbook.Unprotect Password:="tedher112"
        Range("B2").Value = "x1": Sheets(JF).Name = "x1"
        Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
        ActiveSheet.EnableSelection = xlNoSelection
        ActiveWorkbook.Protect Password:="tedher112": End
    End If
    Resume Exit_subErr
End Sub

Private Sub UserForm_Activate() 'Daten aus der Tabelle "liesmich" holen

    Worksheets("liesmich").Unprotect Password:="tedher112"
    Laenge = Len(Range("C18").Value)
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
    
    If IsEmpty(Range("A2").Value) And Laenge = 0 Then
        Me.Neu.Visible = True
    ElseIf (Range("A2").Value = "Vorjahr" Or Range("A2").Value = "Berichtsjahr") And Laenge <> 0 Then
        Me.Alt.Visible = True
        Call basGrunddatenSichtbar(True)
        Call basJugendwartSichtbar(True)
        Me.Abdeckung.Visible = False
        Me.Eingabe.Visible = False
        Me.TextBox1.Enabled = False
        Me.TextBox2.Enabled = False
        Me.TextBox3.Enabled = False
        Me.TextBox4.Enabled = False
        Me.TextBox5.Enabled = False
        Me.TextBox6.Enabled = False
    End If
    
    Call Daten_holen
    
    If IsDate(Me.TextBox7) Then Me.Label11.Visible = False: Me.TextBox11.Visible = False
    
    If Me.TextBox24 = Empty Then
        Me.|fffd|bernehmen1.Visible = False
        Me.Daten_eingeben.Visible = False
    Else
        Me.|fffd|bernehmen1.Visible = True
        Me.Daten_eingeben.Visible = True
    End If
End Sub

Function Daten_holen()

    Worksheets("liesmich").Unprotect Password:="tedher112"
    Me.TextBox1 = Range("C5").Value                         'Kreis
    If Range("C5").Value = "Hannover" Then Me.Label1 = Range("A5").Value
    Me.TextBox2 = Range("C7").Value                         'Gemeinde
    Me.TextBox3 = Range("C9").Value                         'Jugendfeuerwehr
    Me.TextBox4 = Range("C11").Value                        'Bundesland
    Me.TextBox5 = Range("C13").Value                        'Bezirk
    Me.TextBox6 = Range("C18").Value                        'JF gegr|fffd|ndet
    Me.TextBox7 = Range("C20").Value                        'Dienstbetrieb eingestellt
    Me.TextBox8 = Range("I5").Value                         'Jahr
    Me.TextBox9 = Range("I7").Value                         'Stand
    Me.TextBox10 = Range("I9").Value                        'Ordnungsnummer
    Me.TextBox11 = Range("I11").Value                       'Alter der JFW
    Me.TextBox12 = Range("I13").Value                       'Erstellt am
    Me.TextBox13 = Range("G19").Value                       'Internetseite
    Me.TextBox14 = Range("G21").Value                       'eMail
    Me.TextBox15 = Range("B23").Value                       'Zuname
    Me.TextBox16 = Range("E23").Value                       'Vorname
    Me.TextBox17 = Range("B24").Value                       'Beruf
    Me.TextBox18 = Range("E24").Value                       'Dienstgrad
    Me.TextBox19 = Range("B25").Value                       'PLZ
    Me.TextBox20 = Range("C25").Value                       'Wohnort
    Me.TextBox21 = Strasse(Range("E25").Value)              'Stra|fffd|e
    Me.TextBox22 = Hausnummer(Range("E25").Value)           'Hausnummer
    Me.TextBox23 = Range("I23").Value                       'Geburtsdatum
    Me.TextBox24 = Range("I24").Value                       'JFW seit
    Me.TextBox25 = Range("I25").Value                       'Telefon
    Me.TextBox26 = Range("I26").Value                       'Fax
    Worksheets("liesmich").Protect Password:="tedher112", DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlNoSelection
End Function

Function Ordnungsnummer()
FehlerOrdNr:

    OrdNr = InputBox("Ordnungsnummer eingeben !" & vbCrLf & "Format der Ordnungsnummer einhalten !" & vbCrLf & vbCrLf & "Beispiel: 00.000.000.000", "Ordnungsnummer erfassen")

    If OrdNr <> "" Then
        If ((Mid(OrdNr, 3, 1)) & (Mid(OrdNr, 7, 1)) & (Mid(OrdNr, 11, 1))) <> "..." Then
            MsgBox "Es wurde keine Ordnungsnummer eingegeben !", vbExclamation, "Pr|fffd|fen"
            GoTo FehlerOrdNr
        ElseIf Len(OrdNr) <> 14 Then
            MsgBox "Die Ordnungsnummer ist nicht richtig eingegeben worden !", vbExclamation, "Pr|fffd|fen"
            GoTo FehlerOrdNr
        ElseIf Len(OrdNr) = 14 And (CDbl((Mid(OrdNr, 1, 2))) + CDbl((Mid(OrdNr, 4, 3))) + CDbl((Mid(OrdNr, 8, 3))) + CDbl((Mid(OrdNr, 12, 3)))) > 0 Then
            Call basGrunddatenSichtbar(True)
            Me.TextBox10 = OrdNr
        End If
    Else
        MsgBox "Wenn keine Ordnungsnummer eingegeben wurde," & String(1, vbCr) & _
                "kann diese Datei nicht verwendet werden", vbExclamation, "Fehlermeldung": End
    End If
End Function

Function Strasse(strAdresse As String) As String
    
    intL|fffd|nge = Len(strAdresse)
    For Laenge = intL|fffd|nge To 1 Step -1
        If Mid(strAdresse, Laenge, 1) = " " Or Laenge = 1 Then
            If Laenge = 1 Then Strasse = Right(strAdresse, intL|fffd|nge) Else Strasse = Right(strAdresse, intL|fffd|nge - Laenge)
            If Val(Strasse) <> 0 Then
                Strasse = Left(strAdresse, Laenge - 1)
                Exit For
            End If
        End If
    Next Laenge
End Function

Function Hausnummer(strAdresse As String) As String

    intL|fffd|nge = Len(strAdresse)
    For Laenge = intL|fffd|nge To 1 Step -1
        If Mid(strAdresse, Laenge, 1) = " " Then
            tmpHausnummer = Right(strAdresse, intL|fffd|nge - Laenge)
            If Val(tmpHausnummer) <> 0 Then Exit For
        End If
    Next Laenge
    
    If Val(tmpHausnummer) <> 0 Then Hausnummer = tmpHausnummer Else Hausnummer = " "
End Function

Function basGrunddatenSichtbar(bolGrunddatensicht As Boolean)

    If bolGrunddatensicht = True Then
    
        Me.Label1.Visible = True: Me.Label2.Visible = True: Me.Label3.Visible = True
        Me.Label4.Visible = True: Me.Label5.Visible = True: Me.Label6.Visible = True
        Me.Label7.Visible = True: Me.Label8.Visible = True: Me.Label9.Visible = True
        Me.Label10.Visible = True: Me.Label12.Visible = True
        Me.TextBox1.Visible = True: Me.TextBox2.Visible = True: Me.TextBox3.Visible = True
        Me.TextBox4.Visible = True: Me.TextBox5.Visible = True: Me.TextBox6.Visible = True
        Me.TextBox7.Visible = True: Me.TextBox8.Visible = True: Me.TextBox9.Visible = True
        Me.TextBox10.Visible = True: Me.TextBox12.Visible = True
    
    Else
    
        Me.Label1.Visible = False: Me.Label2.Visible = False: Me.Label3.Visible = False
        Me.Label4.Visible = False: Me.Label5.Visible = False: Me.Label6.Visible = False
        Me.Label7.Visible = False: Me.Label8.Visible = False: Me.Label9.Visible = False
        Me.Label10.Visible = False: Me.Label12.Visible = False
        Me.TextBox1.Visible = False: Me.TextBox2.Visible = False: Me.TextBox3.Visible = False
        Me.TextBox4.Visible = False: Me.TextBox5.Visible = False: Me.TextBox6.Visible = False
        Me.TextBox7.Visible = False: Me.TextBox8.Visible = False: Me.TextBox9.Visible = False
        Me.TextBox10.Visible = False: Me.TextBox12.Visible = False
        
    End If
    
End Function

Function basJugendwartSichtbar(bolJugendwartSicht As Boolean)

    If bolJugendwartSicht = True Then
    
        Me.Label11.Visible = True: Me.Label13.Visible = True: Me.Label14.Visible = True
        Me.Label15.Visible = True: Me.Label16.Visible = True: Me.Label17.Visible = True
        Me.Label18.Visible = True: Me.Label19.Visible = True: Me.Label20.Visible = True
        Me.Label21.Visible = True: Me.Label22.Visible = True: Me.Label23.Visible = True
        Me.Label24.Visible = True: Me.Label25.Visible = True: Me.Label26.Visible = True
        Me.Label27.Visible = True
        Me.TextBox11.Visible = True: Me.TextBox13.Visible = True: Me.TextBox14.Visible = True
        Me.TextBox15.Visible = True: Me.TextBox16.Visible = True: Me.TextBox17.Visible = True
        Me.TextBox18.Visible = True: Me.TextBox19.Visible = True: Me.TextBox20.Visible = True
        Me.TextBox21.Visible = True: Me.TextBox22.Visible = True: Me.TextBox23.Visible = True
        Me.TextBox24.Visible = True: Me.TextBox25.Visible = True: Me.TextBox26.Visible = True
        
    Else
    
        Me.Label11.Visible = False: Me.Label13.Visible = False: Me.Label14.Visible = False
        Me.Label15.Visible = False: Me.Label16.Visible = False: Me.Label17.Visible = False
        Me.Label18.Visible = False: Me.Label19.Visible = False: Me.Label20.Visible = False
        Me.Label21.Visible = False: Me.Label22.Visible = False: Me.Label23.Visible = False
        Me.Label24.Visible = False: Me.Label25.Visible = False: Me.Label26.Visible = False
        Me.Label27.Visible = False
        Me.TextBox11.Visible = False: Me.TextBox13.Visible = False: Me.TextBox14.Visible = False
        Me.TextBox15.Visible = False: Me.TextBox16.Visible = False: Me.TextBox17.Visible = False
        Me.TextBox18.Visible = False: Me.TextBox19.Visible = False: Me.TextBox20.Visible = False
        Me.TextBox21.Visible = False: Me.TextBox22.Visible = False: Me.TextBox23.Visible = False
        Me.TextBox24.Visible = False: Me.TextBox25.Visible = False: Me.TextBox26.Visible = False
        
    End If
    
End Function

Attribute VB_Name = "F|fffd|llen"

Sub Eingabe()

    Eingabeformular.Show
End Sub

Sub Daten()

    Dateneingabe.Show
End Sub
Attribute VB_Name = "Tabelle01"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "liesmich"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





INQUEST-PP=macro
