Attribute VB_Name = "Class1"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Attribute VB_Name = "DateClass"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Public Sub Initial()
    Call DateModuleSetup
End Sub

Function JToday(Optional mode As String) As String
Dim GToday As String
GToday = Right(Date$, 4) + Left(Date$, 2) + Mid$(Date$, 4, 2)
JToday = JalaliDate(GToday, mode)
End Function

Function JDiff(Jdate1 As String, JDate2 As String) As Long
Dim JYear1 As Long, JMonth1 As Long, jday1 As Long
Dim JYear2 As Long, JMonth2 As Long, JDay2 As Long
Dim TotalDays1 As Long
Dim TotalDays2 As Long
JYear1 = Year_(Jdate1)
If Len(Jdate1) = 6 Then JYear1 = JYear1 + 1300
JMonth1 = Month_(Jdate1)
jday1 = Day_(Jdate1)
JYear2 = Year_(JDate2)
If Len(JDate2) = 6 Then JYear2 = JYear2 + 1300
JMonth2 = Month_(JDate2)
JDay2 = Day_(JDate2)
TotalDays1 = JalaliDays(JYear1, JMonth1, jday1)
TotalDays2 = JalaliDays(JYear2, JMonth2, JDay2)
JDiff = TotalDays2 - TotalDays1
End Function


Function JSubDay(Jdate As String, JDayOff As Integer, Optional mode As String) As String
Dim jyear As Long, jmonth As Long, jday As Long
Dim TotalDays As Long
jyear = Year_(Jdate)
If Len(Jdate) = 6 Then jyear = jyear + 1300
jmonth = Month_(Jdate)
jday = Day_(Jdate)
TotalDays = JalaliDays(jyear, jmonth, jday) - JDayOff + GYearOff
JalaliYMD TotalDays, jyear, jmonth, jday
JSubDay = YMD2Str(jyear, jmonth, jday, mode)
End Function


Function JWeekDay(Jdate As String, Optional mode As String) As Variant
Dim JWeekDays As Variant
Dim jyear As Long, jmonth As Long, jday As Long
Dim tmp As Long
If mode = "" Then
    mode = "SHORT"
Else
    mode = UCase(mode)
End If
JWeekDays = Array("|fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|")
jyear = Year_(Jdate)
If Len(Jdate) = 6 Then jyear = jyear + 1300
jmonth = Month_(Jdate)
jday = Day_(Jdate)
tmp = (JalaliDays(jyear, jmonth, jday) - JWkDayOff) Mod 7
Select Case mode
Case "LONG"
    JWeekDay = JWeekDays(tmp)
Case Else
    JWeekDay = tmp
End Select
End Function

Function NormDate(Date_ As String) As String
Dim Y As String, M As String, d As String
Dim Slash1Pos As Integer
Dim Slash2Pos As Integer
Date_ = LTrim(RTrim(Date_))
Slash1Pos = InStr(Date_, "/")
Slash2Pos = InStr(Slash1Pos + 1, Date_, "/")
If Slash1Pos = 0 Or Slash2Pos = 0 Then
    NormDate = "#Error"
    Exit Function
End If
Y = Left(Date_, Slash1Pos - 1)
M = Mid(Date_, Slash1Pos + 1, Slash2Pos - Slash1Pos - 1)
d = Mid(Date_, Slash2Pos + 1)
Y = LTrim(RTrim(Y))
M = LTrim(RTrim(M))
d = LTrim(RTrim(d))
M = IIf(Len(M) < 2, "0" + M, M)
d = IIf(Len(d) < 2, "0" + d, d)
NormDate = Y + M + d
End Function

Function JAddDay(Jdate As String, JDayOff As Integer, Optional mode As String) As String
Dim jyear As Long, jmonth As Long, jday As Long
Dim TotalDays As Long
jyear = Year_(Jdate)
If Len(Jdate) = 6 Then jyear = jyear + 1300
jmonth = Month_(Jdate)
jday = Day_(Jdate)
TotalDays = JalaliDays(jyear, jmonth, jday) + JDayOff + GYearOff
JalaliYMD TotalDays, jyear, jmonth, jday
JAddDay = YMD2Str(jyear, jmonth, jday, mode)
End Function

Function JalalDate(GDate As String, Optional mode As String) As String
JalalDate = JalaliDate(GDate, mode)
End Function


Attribute VB_Name = "Date_Module"
Option Explicit
Option Base 0
Public GDayTab(2, 13) As Long
Public JDayTab(2, 13) As Long
Public Const GYearOff = 226894
Public Const Solar = 365.25
Public Const JWkDayOff = 3
Public Const GWkDayOff = 0

Function Jleap(year As Long) As Long

    Dim tmp As Long
    tmp = year Mod 33
    If (tmp = 1 Or tmp = 5 Or tmp = 9 Or tmp = 13 Or tmp = 17 Or tmp = 22 Or tmp = 26 Or tmp = 30) Then
        Jleap = 1
    Else
        Jleap = 0
    End If

End Function

Function JDayOfYear(year As Long, Month As Long, day As Long) As Long
    Dim i As Long, leap As Long
    leap = Jleap(year)
    For i = 1 To Month - 1
        day = day + JDayTab(leap, i)
    Next i
    JDayOfYear = day
End Function



Function JLeapYears(jyear As Long) As Long

Dim leap As Long, CurrentCycle As Long, Div33 As Long, i As Long
Div33 = Int(jyear / 33)
CurrentCycle = jyear - (Div33 * 33)
leap = Div33 * 8
If CurrentCycle > 0 Then
    i = 1
    Do While i <= CurrentCycle And i <= 18
        leap = leap + 1
        i = i + 4
    Loop
End If
If CurrentCycle > 21 Then
    i = 22
    Do While i <= CurrentCycle And i <= 30
        leap = leap + 1
        i = i + 4
    Loop
End If
JLeapYears = leap

End Function


Function JalaliDays(jyear As Long, jmonth As Long, jday As Long) As Long

Dim TotalDays As Long
Dim leap, tmp As Long
leap = JLeapYears(jyear - 1)
tmp = JDayOfYear(jyear, jmonth, jday)
TotalDays = (jyear - 1) * 365 + leap + tmp
JalaliDays = TotalDays
End Function


Public Function GDayOfYear(year As Long, Month As Long, day As Long) As Long

Dim i As Long, leap As Long
leap = Gleap(year)
For i = 1 To Month - 1
    day = day + GDayTab(leap, i)
Next i
GDayOfYear = day

End Function

Public Function FDate(Jdate As String) As String

Dim year As String, Month As String, day As String
If Len(Jdate) < 8 Then
    day = Right(Jdate, 2)
    Month = Mid(Jdate, 3, 2)
    year = Left(Jdate, 2)
Else
    day = Right(Jdate, 2)
    Month = Mid(Jdate, 5, 2)
    year = Left(Jdate, 4)
End If
FDate = year + "/" + Month + "/" + day

End Function


Public Function Gleap(year As Long) As Long
If ((year Mod 4 = 0 And year Mod 100 <> 0) Or year Mod 400 = 0) Then
    Gleap = 1
Else
    Gleap = 0
End If
End Function

Public Sub GMonthDay(GYear As Long, GDayOfYear, Month, day)
Dim i As Long, leap As Long
leap = Gleap(GYear)
i = 1
Do While GDayOfYear > GDayTab(leap, i)
    GDayOfYear = GDayOfYear - GDayTab(leap, i)
    i = i + 1
Loop
Month = i
day = GDayOfYear
End Sub

Public Function GregDays(GYear As Long, GMonth As Long, GDay As Long) As Long
Dim Div4 As Long, Div100 As Long, Div400 As Long
Dim TotalDays  As Long, tmp As Long
Div4 = Int((GYear - 1) / 4)
Div100 = Int((GYear - 1) / 100)
Div400 = Int((GYear - 1) / 400)
tmp = GDayOfYear(GYear, GMonth, GDay)
TotalDays = (GYear - 1) * 365 + tmp + Div4 - Div100 + Div400
GregDays = TotalDays
End Function

Public Function GregorianDate(Jdate As String, Optional mode As String) As String
Dim jyear As Long, jmonth As Long, jday As Long
Dim GYear As Long, GMonth As Long, GDay As Long
Dim TotalDays As Long
jyear = Year_(Jdate)
If Len(Jdate) = 6 Then jyear = jyear + 1300
jmonth = Month_(Jdate)
jday = Day_(Jdate)
TotalDays = JalaliDays(jyear, jmonth, jday)
GregorianYMD TotalDays, GYear, GMonth, GDay
GregorianDate = YMD2Str(GYear, GMonth, GDay, mode)
End Function

Public Sub GregorianYMD(TotalDays As Long, GYear As Long, GMonth As Long, GDay As Long)
Dim Div4 As Long, Div100 As Long, Div400 As Long
Dim GDays As Long
TotalDays = TotalDays + GYearOff
GYear = Int(TotalDays / (Solar - 0.25 / 33))
Div4 = Int(GYear / 4)
Div100 = Int(GYear / 100)
Div400 = Int(GYear / 400)
GDays = TotalDays - (365 * GYear) - (Div4 - Div100 + Div400)
GYear = GYear + 1
If GDays = 0 Then
    GYear = GYear - 1
    If Gleap(GYear) Then
        GDays = 366
    Else
        GDays = 365
    End If
ElseIf (GDays = 366 And Gleap(GYear) = 0) Then
    GDays = 1
    GYear = GYear + 1
End If
GMonthDay GYear, GDays, GMonth, GDay
End Sub


Public Function YMD2Str(year As Long, Month As Long, day As Long, Optional mode As String) As String
Dim Y As String, M As String, d As String
Y = LTrim(Str(year))
M = LTrim(Str(Month))
If Len(M) <> 2 Then
    M = "0" + M
End If
d = LTrim(Str(day))
If Len(d) <> 2 Then
    d = "0" + d
End If
If mode = "" Then
    mode = "SHORT"
Else
    mode = UCase(mode)
End If
Select Case mode
Case "LONG"
    YMD2Str = Y + M + d
Case Else
    YMD2Str = Right(Y, 2) + M + d
End Select
End Function

Public Sub JalaliYMD(TotalDays As Long, jyear As Long, jmonth As Long, jday As Long)
Dim JDays As Long
Dim leap As Long
TotalDays = TotalDays - GYearOff
jyear = Int(TotalDays / (Solar - 0.25 / 33))
leap = JLeapYears(jyear)
JDays = TotalDays - (365 * jyear + leap)
jyear = jyear + 1
If JDays = 0 Then
    jyear = jyear - 1
    If Jleap(jyear) Then
        JDays = 366
    Else
        JDays = 365
    End If
ElseIf (JDays = 366 And Jleap(jyear) = 0) Then
    JDays = 1
    jyear = jyear + 1
End If
JMonthDay jyear, JDays, jmonth, jday
End Sub

Public Function Day_(Date_ As String) As Long
Day_ = CLng(Right(Date_, 2))
End Function


Public Function Month_(Date_ As String) As Long
Select Case Len(Date_)
Case 8
    Month_ = CLng(Mid(Date_, 5, 2))
Case Else
    Month_ = CLng(Mid(Date_, 3, 2))
End Select
End Function

Public Sub JMonthDay(jyear As Long, JDayOfYear As Long, Month As Long, day As Long)
Dim i As Long, leap As Long
leap = Jleap(jyear)
i = 1
Do While JDayOfYear > JDayTab(leap, i)
    JDayOfYear = JDayOfYear - JDayTab(leap, i)
    i = i + 1
Loop
Month = i
day = JDayOfYear
End Sub

Public Sub DateModuleSetup()
Dim i As Long

JDayTab(0, 0) = 0: JDayTab(1, 0) = 0
For i = 1 To 6
    JDayTab(0, i) = 31
    JDayTab(1, i) = 31
Next i
For i = 7 To 11
    JDayTab(0, i) = 30
    JDayTab(1, i) = 30
Next i
JDayTab(0, 12) = 29: JDayTab(1, 12) = 30

GDayTab(0, 0) = 0: GDayTab(1, 0) = 0
GDayTab(0, 1) = 31: GDayTab(1, 1) = 31
GDayTab(0, 2) = 28: GDayTab(1, 2) = 29
GDayTab(0, 3) = 31: GDayTab(1, 3) = 31
GDayTab(0, 4) = 30: GDayTab(1, 4) = 30
GDayTab(0, 5) = 31: GDayTab(1, 5) = 31
GDayTab(0, 6) = 30: GDayTab(1, 6) = 30
GDayTab(0, 7) = 31: GDayTab(1, 7) = 31
GDayTab(0, 8) = 31: GDayTab(1, 8) = 31
GDayTab(0, 9) = 30: GDayTab(1, 9) = 30
GDayTab(0, 10) = 31: GDayTab(1, 10) = 31
GDayTab(0, 11) = 30: GDayTab(1, 11) = 30
GDayTab(0, 12) = 31: GDayTab(1, 12) = 31
End Sub

Public Function Year_(Date_ As String) As Long
Select Case Len(Date_)
Case 8
    Year_ = CLng(Left(Date_, 4))
Case Else
    Year_ = CLng(Left(Date_, 2))
End Select
End Function

Public Function JalaliDate(GDate As String, Optional mode As String) As String

Dim GYear As Long, GMonth As Long, GDay As Long
Dim jyear As Long, jmonth As Long, jday As Long
Dim TotalDays As Long
GYear = Year_(GDate)
If Len(GDate) = 6 Then GYear = GYear + 1900
GMonth = Month_(GDate)
GDay = Day_(GDate)
TotalDays = GregDays(GYear, GMonth, GDay)
JalaliYMD TotalDays, jyear, jmonth, jday
JalaliDate = YMD2Str(jyear, jmonth, jday, mode)

End Function




Attribute VB_Name = "Module1"
Option Explicit
Attribute VB_Name = "Module10"
Option Explicit

Private Declare Function GetSystemMenu Lib "User32" _
(ByVal hwnd As Long, _
ByVal bRevert As Long) As Long

Private Declare Function RemoveMenu Lib "User32" _
(ByVal hme2nu As Long, _
ByVal nPosition As Long, _
ByVal wFlags As Long) As Long

Private Declare Function FindWindowA Lib "User32" _
(ByVal lpClassName2 As String, _
ByVal lpWindowName2 As String) As Long

Private Const MF_BYPOSITION As Long = &H400

Public Sub FormatUserForm(UserFormCaption As String)

Dim lFrmHdl         As Long
Dim iCount          As Integer
    
    lFrmHdl = FindWindowA(vbNullString, UserFormCaption)
    If lFrmHdl <> 0 Then
        For iCount = 0 To 1
            RemoveMenu GetSystemMenu(lFrmHdl, False), 0, MF_BYPOSITION
        Next iCount
    End If

End Sub


Attribute VB_Name = "Module11"
Option Explicit




Private Declare Function FindWindow Lib "User32" _
Alias "FindWindowA" ( _
ByVal lpClassName As String, _
ByVal lpWindowName As String) As Long

Private Declare Function GetWindowLong Lib "User32" _
Alias "GetWindowLongA" ( _
ByVal hwnd As Long, _
ByVal nIndex As Long) As Long

Private Declare Function SetWindowLong Lib "User32" _
Alias "SetWindowLongA" (ByVal hwnd As Long, _
ByVal nIndex As Long, _
ByVal dwNewLong As Long) As Long

Private Declare Function DrawMenuBar Lib "User32" ( _
ByVal hwnd As Long) As Long

Sub RemoveCaption(objForm As Object)
'|fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

Dim lStyle          As Long
Dim hMenu           As Long
Dim mhWndForm       As Long

    If Val(Application.Version) < 9 Then
        mhWndForm = FindWindow("ThunderXFrame", objForm.Caption)    'XL97
    Else
        mhWndForm = FindWindow("ThunderDFrame", objForm.Caption)    'XL2000+
    End If
    lStyle = GetWindowLong(mhWndForm, -16)
    lStyle = lStyle And Not &HC00000
    SetWindowLong mhWndForm, -16, lStyle
    DrawMenuBar mhWndForm

End Sub






Attribute VB_Name = "Module12"
Option Explicit

Sub killform()
Unload UserForm2
End Sub


Attribute VB_Name = "Module2"
Attribute VB_Name = "Module3"
Option Explicit
Attribute VB_Name = "Module4"
Attribute VB_Name = "Module5"
Attribute VB_Name = "Persian_Tools"
Sub InsertJalaliDate()

Dim Obj1 As New DateClass
Obj1.Initial
ActiveCell.Value = FDate(Obj1.JToday("long"))

End Sub

Function J_TODAY(Optional mode As Integer)

    Application.Volatile True
    Dim x1 As New DateClass
    x1.Initial
    
    If mode = 1 Then
        
        J_TODAY = FDate(x1.JToday("long"))
    Else
        J_TODAY = FDate(x1.JToday("Short"))
    End If

End Function


Function J_WEEKDAY(Jdate As String, Optional mode As Integer)

    Dim x2 As New DateClass
    x2.Initial
    Dim Temp$
    
    If mode = 1 Then Temp$ = "long" Else Temp$ = "short"
        J_WEEKDAY = x2.JWeekDay(x2.NormDate(Jdate), Temp$)
        
    End Function

Function J_normdate(Jdate As String)

    Dim x3 As New DateClass
    x3.Initial
    J_normdate = x3.NormDate(Jdate)
    
End Function


Function J_ADDDAY(Jdate As String, Number As Integer, Optional mode As Integer)

    Dim x4 As New DateClass
    x4.Initial
    
    If mode = 1 Then
        J_ADDDAY = FDate(x4.JAddDay(x4.NormDate(Jdate), Number, "long"))
    Else
        J_ADDDAY = FDate(x4.JAddDay(x4.NormDate(Jdate), Number, "short"))
    End If
    
End Function

Function J_DIFF(Jdate1 As String, JDate2 As String)

    Dim x5 As New DateClass
    x5.Initial
    J_DIFF = x5.JDiff(x5.NormDate(Jdate1), x5.NormDate(JDate2))
    
End Function


Function J_JALALDATE(MDate As String, Optional mode As Integer)

    Dim x6 As New DateClass
    x6.Initial
    If mode = 1 Then
        
        J_JALALDATE = FDate(x6.JalalDate(x6.NormDate(MDate), "long"))
    Else
        J_JALALDATE = FDate(x6.JalalDate(x6.NormDate(MDate), "Short"))
        
    End If
    
End Function

Function J_SUBDAY(Jdate As String, Number As Integer, Optional mode As Integer)

    Dim x7 As New DateClass
    x7.Initial
    
    If mode = 1 Then
      
        J_SUBDAY = FDate(x7.JSubDay(x7.NormDate(Jdate), Number, "long"))
    Else
        J_SUBDAY = FDate(x7.JSubDay(x7.NormDate(Jdate), Number, "Short"))
    End If
    
End Function


Function J_GregorianDate(MDate As String, Optional mode As Integer)

    Dim x6 As New DateClass
    x6.Initial
    If mode = 1 Then
        
        J_GregorianDate = FDate(GregorianDate(x6.NormDate(MDate), "long"))
    Else
        J_GregorianDate = FDate(GregorianDate(x6.NormDate(MDate), "short"))
    End If
    
End Function





Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Application.ScreenUpdating = False
Range("G5:K22").Font.ColorIndex = 2
 Range("e1:h4").Font.ColorIndex = 2
End Sub

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Tarix_b_Horof"
Option Explicit


Function TbH(Jdate As String, Optional mode As Integer)

On Error GoTo ErrorHandler
    
Dim txtYear, txtMonth, txtDay, s As String
Dim StandardDate, StandardYear, StandardMonth, StandardDay As String
Dim DayofWeek As String
Dim x20 As New DateClass

    x20.Initial
 
 If Left(Jdate, 2) = "13" Then StandardDate = x20.NormDate(Jdate) Else StandardDate = x20.NormDate(13 & Jdate)
 
StandardYear = Left(StandardDate, 4)
StandardMonth = Mid(StandardDate, 5, 2)
StandardDay = Right(StandardDate, 2)

Select Case Val(StandardMonth)
    Case 1
       s = " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
    Case 2
       s = " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
    Case 3
       s = " |fffd||fffd||fffd||fffd||fffd| "
    Case 4
       s = " |fffd||fffd||fffd| "
    Case 5
       s = " |fffd||fffd||fffd||fffd||fffd| "
    Case 6
       s = " |fffd||fffd||fffd||fffd||fffd||fffd| "
    Case 7
       s = " |fffd||fffd||fffd| "
    Case 8
       s = " |fffd||fffd||fffd||fffd| "
    Case 9
       s = " |fffd||fffd||fffd| "
    Case 10
       s = " |fffd||fffd| "
    Case 11
       s = " |fffd||fffd||fffd||fffd| "
    Case 12
       s = " |fffd||fffd||fffd||fffd||fffd| "
End Select





txtYear = Horof(Val(StandardYear))
txtMonth = s
txtDay = Horof(Val(StandardDay))
DayofWeek = J_WEEKDAY(Jdate, 1)

 Select Case mode
    Case 0
            TbH = Val(StandardDay) & txtMonth & StandardYear
    Case 1
            TbH = txtDay & txtMonth & txtYear
    Case 2
            TbH = DayofWeek & "|fffd| " & txtDay & txtMonth & txtYear
End Select
Exit Function

ErrorHandler:
TbH = "#Error"
End Function

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

UserForm2.Show


End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{49B74D4F-C5F8-4D95-8170-8681DB715B87}{F97859CD-6ECA-4199-B64D-26EA99CD8F3E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit


Private Sub cmdCancel_Click()
 Unload UserForm1

End Sub

Private Sub cmdok_Click()
If Combomonth.Value = "" Or Comboday.Value = "" Or Texsharhkar.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
Exit Sub
'//If Combomonth.Value > 12 Or Combomonth.Value < 0 Or Comboday.Value > 31 Or Comboday.Value < 0 Or Comboday.Value > 1389 Then
'//MsgBox "|fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
   ' //End If

    Else
    If Combomonth.ListIndex = 0 Then
Sheet1.Select
ElseIf Combomonth.ListIndex = 1 Then
Sheet2.Select
ElseIf Combomonth.ListIndex = 2 Then
Sheet3.Select
ElseIf Combomonth.ListIndex = 3 Then
Sheet4.Select
ElseIf Combomonth.ListIndex = 4 Then
Sheet5.Select
ElseIf Combomonth.ListIndex = 5 Then
Sheet6.Select
ElseIf Combomonth.ListIndex = 6 Then
Sheet7.Select
ElseIf Combomonth.ListIndex = 7 Then
Sheet8.Select
ElseIf Combomonth.ListIndex = 8 Then
Sheet9.Select
ElseIf Combomonth.ListIndex = 9 Then
Sheet10.Select
ElseIf Combomonth.ListIndex = 10 Then
Sheet11.Select
ElseIf Combomonth.ListIndex = 11 Then
Sheet12.Select

End If
With Selection
Range("A2").Select
Sheet1.Range("G17").FormulaR1C1 = "=J_TODAY(1)"
    Do
 Sheet1.Range("G18").Value = Comboyear.Value & "/" & Combomonth.Value & "/" & Comboday.Value
If Sheet1.Range("G18") < Sheet1.Range("G17") Then
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
Exit Sub
End If
Sheet1.Cells(1, 5).Value = UserForm1.Comboyear.Value
Sheet1.Range("E2").FormulaR1C1 = "=Gleap(R[-1]C)"
If Sheet1.Range("E2").Value = 0 And Combomonth.Value = 12 And Comboday.Value = 30 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| 30 |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
End If
If Combomonth.Value > 6 And Comboday.Value = 31 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| 31 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If
    If IsEmpty(ActiveCell) = False Then
        ActiveCell.Offset(1, 0).Select
    End If
Loop Until IsEmpty(ActiveCell) = True
 ActiveCell.Value = Comboyear.Value & "/" & Combomonth.Value & "/" & Comboday.Value
 
  ActiveCell.Offset(0, 2) = Texsharhkar.Value
End With
End If


Texsharhkar.Value = ""

 
End Sub



Private Sub cmdCancel_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Application.ScreenUpdating = False
cmdCancel.BackColor = &HFFC0C0
cmdCancel.BackColor = &HFFC0C0
End Sub

Private Sub cmdok_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Application.ScreenUpdating = False
cmdok.BackColor = &HFFC0C0
cmdok.BackColor = &HFFC0C0
End Sub

Private Sub CommandButton3_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Comboday.ListIndex >= 0 And Comboday.ListIndex < Comboday.ListCount - 1 Then
For i = 1 To Comboday.ListCount - 1
Comboday.ListIndex = Comboday.ListIndex + 1
Exit For
Next
ElseIf Comboday.ListIndex = Comboday.ListCount - 1 Then
Comboday.ListIndex = 0
End If
End Sub

Private Sub CommandButton4_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Combomonth.ListIndex >= 0 And Combomonth.ListIndex < Combomonth.ListCount - 1 Then
For i = 1 To Combomonth.ListCount - 1
Combomonth.ListIndex = Combomonth.ListIndex + 1
Exit For
Next
ElseIf Combomonth.ListIndex = Combomonth.ListCount - 1 Then
Combomonth.ListIndex = 0
End If
End Sub

Private Sub CommandButton5_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Comboyear.ListIndex >= 0 And Comboyear.ListIndex < Comboyear.ListCount - 1 Then
For i = 1 To Comboyear.ListCount - 1
Comboyear.ListIndex = Comboyear.ListIndex + 1
Exit For
Next
ElseIf Comboyear.ListIndex = Comboyear.ListCount - 1 Then
Comboyear.ListIndex = 0
End If
End Sub

Private Sub UserForm_Initialize()
With Comboyear
        .AddItem "1389"
        .AddItem "1390"
        .AddItem "1391"
        .AddItem "1392"
        .AddItem "1393"
        .AddItem "1394"
        .AddItem "1395"
        .AddItem "1396"
        .AddItem "1397"
End With
With Combomonth
        .AddItem "01"
        .AddItem "02"
        .AddItem "03"
        .AddItem "04"
        .AddItem "05"
        .AddItem "06"
        .AddItem "07"
        .AddItem "08"
        .AddItem "09"
        .AddItem "10"
        .AddItem "11"
        .AddItem "12"
    End With
    With Comboday
        .AddItem "01"
        .AddItem "02"
        .AddItem "03"
        .AddItem "04"
        .AddItem "05"
        .AddItem "06"
        .AddItem "07"
        .AddItem "08"
        .AddItem "09"
        .AddItem "10"
        .AddItem "11"
        .AddItem "12"
        .AddItem "13"
        .AddItem "14"
        .AddItem "15"
        .AddItem "16"
        .AddItem "17"
        .AddItem "18"
        .AddItem "19"
        .AddItem "20"
        .AddItem "21"
        .AddItem "22"
        .AddItem "23"
        .AddItem "24"
        .AddItem "25"
        .AddItem "26"
        .AddItem "27"
        .AddItem "28"
        .AddItem "29"
        .AddItem "30"
        .AddItem "31"
    End With
    Comboyear.ListIndex = 0
    Combomonth.ListIndex = 0
    Comboday.ListIndex = 0
End Sub

Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
cmdCancel.BackColor = -2147483633
cmdok.BackColor = -2147483633
End Sub

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{BBB59061-6969-4DC2-9359-B65420BCF994}{C3F2F3BB-6C7E-45E7-9B2A-23192BF23083}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Dim CM As Boolean

Private Sub CommandButton10_Click()
Application.ScreenUpdating = False
ThisWorkbook.Close SaveChanges:=True
End Sub

Private Sub CommandButton11_Click()
UserForm5.Show
End Sub

Private Sub CommandButton2_Click()
Unload Me
UserForm2.Show
End Sub

Private Sub CommandButton3_Click()
UserForm1.Show
End Sub










Private Sub CommandButton6_Click()
UserForm4.Show
End Sub

Private Sub CommandButton7_Click()
Dim strkartarihk As String, tarikh As String, kar As String, r As Integer
Dim a As Integer, j As Integer, i As Integer
ListBox1.Locked = False
If ListBox1.ListCount = 0 Then
MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", vbExclamation
 Exit Sub
 End If
  If ListBox1.ListIndex = -1 Then
            ListBox1.ListIndex = ListBox1.ListCount - 1
 Exit Sub
 End If
 strkartarihk = UserForm2.ListBox1.Text
tarikh = Trim(Left(strkartarihk, 10))
kar = Trim(Right(strkartarihk, Len(strkartarihk) - Len(tarikh) - Len("    ")))
j = Left(Right(tarikh, 5), 2)
i = Val(j)
Sheets(i).Select
 
             'mz
     If ListBox1.ListCount >= 1 Then
        'If no selection, choose last list item.
        If ListBox1.ListIndex = -1 Then
            ListBox1.ListIndex = ListBox1.ListCount - 1
                    
        End If
        'mz
            For r = 1 To 300
              If kar = Cells(r, 3).Value And tarikh = Cells(r, 1).Value Then
               Range(Cells(r, 1), Cells(r, 3)).Select
               Selection.ClearContents
               Cells(1, 1).Select
               ListBox1.RemoveItem (ListBox1.ListIndex)
        Exit For
        End If
         Next r
        'mz
    End If
'a = Len(kar)
'Label2.Caption = Trim(kar)
'If tarikh = Sheet8.Range("a8").Value Then
'MsgBox "yes"
'Else
'MsgBox "no"
'End If
End Sub

Private Sub CommandButton8_Click()
Dim i As Integer, Message As String
i = ListBox1.ListCount
If i = 0 Then
Message = MsgBox("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||1c1| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", vbExclamation, "|fffd||fffd||fffd|")
ElseIf i > 0 And i < 5 Then
Message = MsgBox("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||1c1| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd||fffd|")
ElseIf i > 5 Then
Sheet13.Select
Range("a1:a100").ClearContents
Cells(1, 1).Select
i = ListBox1.ListCount
Range("b1") = i
Range("a1" & ":" & "a" & i).Value = ListBox1.List
'*************
Range("a1" & ":" & "a" & i).Select
   
    ActiveSheet.PageSetup.PrintArea = "a1" & ":" & "a" & i
    
    With Sheet13.PageSetup
        
        .LeftMargin = Application.InchesToPoints(0.75)
        .RightMargin = Application.InchesToPoints(0.75)
        .TopMargin = Application.InchesToPoints(1)
        .BottomMargin = Application.InchesToPoints(1)
        .HeaderMargin = Application.InchesToPoints(0.5)
        .FooterMargin = Application.InchesToPoints(0.5)
        .CenterHorizontally = True
         .PrintErrors = xlPrintErrorsDisplayed
     End With
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
    Range("a1" & ":" & "a" & i).ClearContents
End If
End Sub

Private Sub UserForm_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
UserForm3.Show
End Sub

Private Sub UserForm_Initialize()
Dim j As Integer, i As Integer, r As Integer, s As Integer, day As Integer, year As Integer, randnum1 As Integer, randnum2 As Integer
Dim mah As String, rooz As String, roozehafte As String, roozsal As Integer, withoflabel As Integer
Call FormatUserForm(Me.Caption)
 Call RemoveCaption(Me)
UserForm2.righttoleft = True
CommandButton3.SetFocus
Sheet1.Activate
Cells(17, "g").FormulaR1C1 = "=J_TODAY(1)"
j = Left(Right(Cells(17, "g").Value, 5), 2)
i = Val(j)
day = Right(Cells(17, "g").Value, 2)
year = Left(Cells(17, "g").Value, 4)
    If i = 1 Then
    Sheet1.Select
    mah = " |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf i = 2 Then
Sheet2.Select
mah = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf i = 3 Then
Sheet3.Select
mah = "|fffd||fffd||fffd||fffd||fffd|"
ElseIf i = 4 Then
Sheet4.Select
mah = "|fffd||fffd||fffd|"
ElseIf i = 5 Then
Sheet5.Select
mah = "|fffd||fffd||fffd||fffd||fffd|"
ElseIf i = 6 Then
Sheet6.Select
mah = "|fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf i = 7 Then
Sheet7.Select
mah = "|fffd||fffd||fffd|"
ElseIf i = 8 Then
Sheet8.Select
mah = "|fffd||fffd||fffd||fffd|"
ElseIf i = 9 Then
Sheet9.Select
mah = "|fffd||fffd||fffd|"
ElseIf i = 10 Then
Sheet10.Select
mah = "|fffd||fffd|"
ElseIf i = 11 Then
Sheet11.Select
mah = "|fffd||fffd||fffd||fffd|"
Else
Sheet12.Select
mah = "|fffd||fffd||fffd||fffd||fffd|"
End If
Select Case day
        Case 1
            rooz = "|fffd||fffd||fffd|"
        Case 2
            rooz = "|fffd||fffd||fffd|"
        Case 3
            rooz = "|fffd||fffd||fffd|"
        Case 4
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 5
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 6
            rooz = "|fffd||fffd||fffd|"
        Case 7
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 8
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 9
            rooz = "|fffd||fffd||fffd|"
        Case 10
            rooz = "|fffd||fffd||fffd|"
        Case 11
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 12
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 13
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 14
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 15
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 16
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 17
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 18
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 19
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 20
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 21
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 22
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 23
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 24
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 25
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 26
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 27
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 28
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 29
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        Case 30
            rooz = "|fffd||fffd| |fffd||fffd|"
        Case 31
            rooz = "|fffd||fffd| |fffd| |fffd||fffd||fffd|"
        End Select
 Sheet1.Cells(21, "g").FormulaR1C1 = "=J_WEEKDAY(R[-4]C,1)"
 roozehafte = Sheet1.Cells(21, "g").Value
 Sheet1.Cells(2, "g").Value = "|fffd||fffd||fffd||fffd||fffd|:" & " " & roozehafte & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|:" & " " & roozehafte & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
With Selection
For r = 1 To 300
If Cells(r, 1).Value = Sheet1.Cells(17, "g").Value Then
UserForm2.ListBox1.AddItem (Cells(r, 1).Value & "    " & Cells(r, 3).Value)
End If
Next
End With
Application.ScreenUpdating = False
Application.WindowState = xlMaximized
Me.Width = Application.Width
Me.Height = Application.Height
'*********************
Sheet14.Range("f2").Value = year
Sheet14.Range("g2").Value = j
Sheet14.Range("h2").Value = day
Sheet14.Range("d2").FormulaR1C1 = "=JDayOfYear(RC[2],RC[3],RC[4])"
If Sheet14.Range("d2").Value < 13 Then
s = Sheet14.Cells(Rows.Count, "p").End(xlUp).Row
Randomize
randnum1 = Int((s) * Rnd() + 1)
Label2.Caption = Sheet14.Cells(randnum1, "p").Value
Else
r = Sheet14.Cells(Rows.Count, "b").End(xlUp).Row
Randomize
randnum2 = Int((r) * Rnd() + 1)
Label2.Caption = Sheet14.Cells(randnum2, 2).Value
End If
'*******************************
Label2.Top = Me.Height - 0.08 * Me.Height
Label2.Width = Me.Width
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = 0 Then Cancel = True
CM = True
End Sub

'
Private Sub UserForm_Activate()
Do
If CM = True Then Exit Sub
Label3 = Format(Now, "h:mm:ss AM/PM")

DoEvents
Loop
End Sub
'
 

Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{86A91E53-3395-4401-A5C2-0B1807503823}{30A10246-BD15-416F-888A-CA999B81BC89}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton1_Click()
If Trim(TextBox2.Text) = "" Or Trim(TextBox1.Text) = "" Then
'MsgBox "Enter UserName Or Password"
TextBox1.SetFocus
Exit Sub
End If
If Trim(TextBox2.Text) = "159753" And Trim(TextBox1.Text) = "zabihi" Then
Unload Me
Unload UserForm2
Else
MsgBox "Invalid UserName Or Password"
Unload Me
End If
End Sub



Private Sub UserForm_Initialize()
TextBox1.SetFocus
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{A71B5C19-CEE1-4654-A4E5-98B28B49D0F2}{C148E69F-7BA9-4869-A726-237C33A9A104}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Dim i As Integer, day As Integer, year As Integer, r As Integer, tafavottarikh As Integer, k As Integer
Dim mah As String, rooz As String, nextorghabl As String, mah1 As String, year2, messagetarikh As String
Sheet1.Range("g8:i9") = ""
UserForm2.ListBox1.Clear
If Combomonth3.Value = "" Or Comboday3.Value = "" Then
MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
Exit Sub
End If

If ComboBox1.Text = "" And ComboBox2.Text = "" And ComboBox3.Text = "" Then
ComboBox1.Text = Comboyear3.Text
ComboBox2.Text = Combomonth3.Text
ComboBox3.Text = Comboday3.Text
End If
i = Combomonth3.ListIndex + 1
j = ComboBox2.ListIndex + 1

If (i < 10 And j < 10) Then
date1 = Comboyear3.Value & "/" & "0" & Combomonth3.ListIndex + 1 & "/" & Comboday3.Value
date2 = ComboBox1.Value & "/" & "0" & ComboBox2.ListIndex + 1 & "/" & ComboBox3.Value
Else
date1 = Comboyear3.Value & "/" & Combomonth3.ListIndex + 1 & "/" & Comboday3.Value
date2 = ComboBox1.Value & "/" & ComboBox2.ListIndex + 1 & "/" & ComboBox3.Value
End If
Sheet1.Range("H8").Value = date1
Sheet1.Range("H9").Value = date2
Sheet1.Range("G8").FormulaR1C1 = "=J_DIFF(RC[1],R[1]C[1])"
tafavottarikh = Sheet1.Range("G8").Value
If tafavottarikh < 0 Then
messagetarikh = MsgBox("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||450||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|", vbExclamation, "|fffd||fffd||fffd||fffd||fffd|")
Exit Sub
End If
'************************************************
Sheet1.Range("E1").Value = Comboyear3.Value
Sheet1.Range("E3").Value = ComboBox1.Value
Sheet1.Range("E2").FormulaR1C1 = "=Gleap(R[-1]C)"
Sheet1.Range("E4").FormulaR1C1 = "=Gleap(R[-1]C)"
If Sheet1.Range("E2").Value = 0 And i = 12 And Comboday3.Value = 30 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| 30 |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
Exit Sub
End If
If Combomonth3.Value > 6 And Comboday3.Value = 31 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| 31 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
Exit Sub
End If
If Sheet1.Range("E2").Value = 0 And j = 12 And ComboBox3.Value = 30 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| 30 |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
Exit Sub
End If
If ComboBox2.Value > 6 And ComboBox3.Value = 31 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| 31 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
Exit Sub
End If
'**********************************
If tafavottarikh > 0 Then
For k = 1 To tafavottarikh
Sheet1.Range("g9").Value = k

Sheet1.Range("i8").FormulaR1C1 = "=J_ADDDAY(RC[-1],R[1]C[-2],1)"
M = Left(Right(Sheet1.Cells(8, "i").Value, 5), 2)
l = Val(M)
Sheets(l).Select
UserForm2.Label1.Font.Size = 16
UserForm2.Label1.Caption = " |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & " " & date1 & " " & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|  " & " " & date2
With Selection
For r = 1 To 300
If Cells(r, 1).Value = Sheet1.Cells(8, "i").Value Then
UserForm2.ListBox1.AddItem (Cells(r, 1).Value & "    " & Cells(r, 3).Value)
End If
Next
End With
Next
ElseIf tafavottarikh = 0 Then
Sheet1.Range("i8").Value = Sheet1.Range("H8").Value
M = Left(Right(Sheet1.Cells(8, "i").Value, 5), 2)
l = Val(M)
Sheets(l).Select
Sheet1.Range("j8").FormulaR1C1 = "=J_TODAY(1)"
Sheet1.Range("k8").FormulaR1C1 = "=J_DIFF(RC[-1],RC[-2])"
tafavot = Sheet1.Range("k8").Value
Sheet1.Range("I9").FormulaR1C1 = "=J_WEEKDAY(R[-1]C,1)"
roozehafte3 = Sheet1.Cells(9, "i").Value
mah = Combomonth3.Value
year = Comboyear3.Value
day = Comboday3.Value
Select Case day
        Case 1
            rooz = "|fffd||fffd||fffd|"
        Case 2
            rooz = "|fffd||fffd||fffd|"
        Case 3
            rooz = "|fffd||fffd||fffd|"
        Case 4
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 5
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 6
            rooz = "|fffd||fffd||fffd|"
        Case 7
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 8
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 9
            rooz = "|fffd||fffd||fffd|"
        Case 10
            rooz = "|fffd||fffd||fffd|"
        Case 11
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 12
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 13
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 14
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 15
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 16
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 17
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 18
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 19
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 20
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 21
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 22
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 23
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 24
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 25
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 26
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 27
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 28
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 29
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        Case 30
            rooz = "|fffd||fffd| |fffd||fffd|"
        Case 31
            rooz = "|fffd||fffd| |fffd| |fffd||fffd||fffd|"
        End Select
If tafavot < 0 Then
nextorghabl = " |fffd||fffd||fffd|: "
Else
nextorghabl = " |fffd||fffd||fffd||fffd||fffd|: "
End If
UserForm2.Label1.Caption = Abs(tafavot) & " |fffd||fffd||fffd| " & nextorghabl & roozehafte3 & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
With Selection
For r = 1 To 2000
If Cells(r, 1).Value = Sheet1.Cells(8, "i").Value Then
UserForm2.ListBox1.AddItem (Cells(r, 1).Value & "    " & Cells(r, 3).Value)
End If
Next
End With
End If
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
End Sub

Private Sub CommandButton10_Click()
Comboyear3.Visible = True
Combomonth3.Visible = True
Comboday3.Visible = True
ComboBox1.Visible = True
ComboBox2.Visible = True
ComboBox3.Visible = True
Label4.Visible = True
Label5.Visible = True
Label6.Visible = True
CommandButton6.Visible = True
CommandButton7.Visible = True
CommandButton8.Visible = True
CommandButton1.Top = 126
CommandButton2.Top = 126
UserForm4.Height = 196.5
CommandButton1.Top = 60
CommandButton2.Top = 60
Label1.Visible = True
Label2.Visible = True
Label3.Visible = True
CommandButton9.Top = 12
CommandButton9.Left = 246
CommandButton10.Left = 246
CommandButton10.Top = 60
UserForm4.Width = 316.5
CommandButton2.Left = 6
CommandButton2.Top = 126
CommandButton1.Left = 132
CommandButton1.Top = 126
CommandButton1.Visible = True
CommandButton2.Visible = True
CommandButton3.Visible = True
CommandButton4.Visible = True
CommandButton5.Visible = True
End Sub

Private Sub CommandButton2_Click()
Unload Me

End Sub

Private Sub CommandButton3_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Comboday3.ListIndex >= 0 And Comboday3.ListIndex < Comboday3.ListCount - 1 Then
For i = 1 To Comboday3.ListCount - 1
Comboday3.ListIndex = Comboday3.ListIndex + 1
Exit For
Next
ElseIf Comboday3.ListIndex = Comboday3.ListCount - 1 Then
Comboday3.ListIndex = 0
End If
End Sub

Private Sub CommandButton4_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Combomonth3.ListIndex >= 0 And Combomonth3.ListIndex < Combomonth3.ListCount - 1 Then
For i = 1 To Combomonth3.ListCount - 1
Combomonth3.ListIndex = Combomonth3.ListIndex + 1
Exit For
Next
ElseIf Combomonth3.ListIndex = Combomonth3.ListCount - 1 Then
Combomonth3.ListIndex = 0
End If
End Sub

Private Sub CommandButton5_Click()
Application.ScreenUpdating = False
Dim i As Integer
If Comboyear3.ListIndex >= 0 And Comboyear3.ListIndex < Comboyear3.ListCount - 1 Then
For i = 1 To Comboyear3.ListCount - 1
Comboyear3.ListIndex = Comboyear3.ListIndex + 1
Exit For
Next
ElseIf Comboyear3.ListIndex = Comboyear3.ListCount - 1 Then
Comboyear3.ListIndex = 0
End If
End Sub

Private Sub CommandButton6_Click()
Application.ScreenUpdating = False
Dim i As Integer
 
If ComboBox1.ListIndex >= 0 And ComboBox1.ListIndex < ComboBox1.ListCount - 1 Then
For i = 1 To ComboBox1.ListCount - 1
 ComboBox1.ListIndex = ComboBox1.ListIndex + 1
Exit For
Next
ElseIf ComboBox1.ListIndex = ComboBox1.ListCount - 1 Then
 ComboBox1.ListIndex = 0
End If
End Sub

Private Sub CommandButton7_Click()
Application.ScreenUpdating = False
Dim i As Integer

If ComboBox2.ListIndex >= 0 And ComboBox2.ListIndex < ComboBox2.ListCount - 1 Then
For i = 1 To ComboBox2.ListCount - 1
 ComboBox2.ListIndex = ComboBox2.ListIndex + 1
Exit For
Next
ElseIf ComboBox2.ListIndex = ComboBox2.ListCount - 1 Then
 ComboBox2.ListIndex = 0
End If
End Sub

Private Sub CommandButton8_Click()
Application.ScreenUpdating = False
Dim i As Integer

If ComboBox3.ListIndex >= 0 And ComboBox3.ListIndex < ComboBox3.ListCount - 1 Then
For i = 1 To ComboBox1.ListCount - 1
 ComboBox3.ListIndex = ComboBox3.ListIndex + 1
Exit For
Next
ElseIf ComboBox3.ListIndex = ComboBox3.ListCount - 1 Then
 ComboBox3.ListIndex = 0
End If
End Sub

Private Sub CommandButton9_Click()
ComboBox1.Text = ""
ComboBox2.Text = ""
ComboBox3.Text = ""
Comboyear3.Visible = True
Combomonth3.Visible = True
Comboday3.Visible = True
ComboBox1.Visible = False
ComboBox2.Visible = False
ComboBox3.Visible = False
Label1.Visible = True
Label2.Visible = True
Label3.Visible = True
Label4.Visible = False
Label5.Visible = False
Label6.Visible = False
CommandButton3.Visible = True
CommandButton4.Visible = True
CommandButton5.Visible = True
CommandButton1.Visible = True
CommandButton2.Visible = True
CommandButton6.Visible = False
CommandButton7.Visible = False
CommandButton8.Visible = False
CommandButton1.Top = 60
CommandButton2.Top = 60
UserForm4.Height = 120
CommandButton9.Top = 12
CommandButton9.Left = 246
CommandButton10.Left = 246
CommandButton10.Top = 60
UserForm4.Width = 316.5

End Sub

Private Sub UserForm_Initialize()
With Comboyear3
        .AddItem "1389"
        .AddItem "1390"
        .AddItem "1391"
        .AddItem "1392"
        .AddItem "1393"
        .AddItem "1394"
        .AddItem "1395"
        .AddItem "1396"
        .AddItem "1397"
End With
With Combomonth3
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
    End With
    With Comboday3
        .AddItem "01"
        .AddItem "02"
        .AddItem "03"
        .AddItem "04"
        .AddItem "05"
        .AddItem "06"
        .AddItem "07"
        .AddItem "08"
        .AddItem "09"
        .AddItem "10"
        .AddItem "11"
        .AddItem "12"
        .AddItem "13"
        .AddItem "14"
        .AddItem "15"
        .AddItem "16"
        .AddItem "17"
        .AddItem "18"
        .AddItem "19"
        .AddItem "20"
        .AddItem "21"
        .AddItem "22"
        .AddItem "23"
        .AddItem "24"
        .AddItem "25"
        .AddItem "26"
        .AddItem "27"
        .AddItem "28"
        .AddItem "29"
        .AddItem "30"
        .AddItem "31"
    End With
 Comboyear3.ListIndex = 0
   Combomonth3.ListIndex = 0
   Comboday3.ListIndex = 0
With ComboBox1
        .AddItem "1389"
        .AddItem "1390"
        .AddItem "1391"
        .AddItem "1392"
        .AddItem "1393"
        .AddItem "1394"
        .AddItem "1395"
        .AddItem "1396"
        .AddItem "1397"
End With
With ComboBox2
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
    End With
    With ComboBox3
        .AddItem "01"
        .AddItem "02"
        .AddItem "03"
        .AddItem "04"
        .AddItem "05"
        .AddItem "06"
        .AddItem "07"
        .AddItem "08"
        .AddItem "09"
        .AddItem "10"
        .AddItem "11"
        .AddItem "12"
        .AddItem "13"
        .AddItem "14"
        .AddItem "15"
        .AddItem "16"
        .AddItem "17"
        .AddItem "18"
        .AddItem "19"
        .AddItem "20"
        .AddItem "21"
        .AddItem "22"
        .AddItem "23"
        .AddItem "24"
        .AddItem "25"
        .AddItem "26"
        .AddItem "27"
        .AddItem "28"
        .AddItem "29"
        .AddItem "30"
        .AddItem "31"
    End With
   Comboyear3.Visible = False
Combomonth3.Visible = False
Comboday3.Visible = False
ComboBox1.Visible = False
ComboBox2.Visible = False
ComboBox3.Visible = False
Label1.Visible = False
Label2.Visible = False
Label3.Visible = False
Label4.Visible = False
Label5.Visible = False
Label6.Visible = False
CommandButton1.Visible = False
CommandButton2.Visible = False
CommandButton3.Visible = False
CommandButton4.Visible = False
CommandButton5.Visible = False
CommandButton6.Visible = False
CommandButton7.Visible = False
CommandButton8.Visible = False
UserForm4.Width = 120
UserForm4.Height = 112
CommandButton9.Top = 12
CommandButton9.Left = 32
CommandButton10.Left = 32
CommandButton10.Top = 60
   
End Sub
Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{68CD1069-AC02-4B20-B827-2FC464DD91EB}{F6B0A563-2340-4C3D-B0CB-936E9B02FBE3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()

Dim i As Integer, day As Integer, year As Integer, r As Integer, tafavottarikh As Integer, k As Integer
Dim mah As String, rooz As String, nextorghabl As String, mah1 As String, year2, messagetarikh As String
 Sheet1.Range("h1").Value = "1389/01/01"
i = Combomonth.ListIndex + 1

'*******************************
Sheet1.Range("E1").Value = Comboyear.Value
Sheet1.Range("E2").FormulaR1C1 = "=Gleap(R[-1]C)"
If Sheet1.Range("E2").Value = 0 And (Combomonth.ListIndex + 1) = 12 And Comboday.Value = 30 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| 30 |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
If Combomonth.Value > 6 And Comboday.Value = 31 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| 31 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If

'*******************************************************

If (i < 10) Then
date1 = Comboyear.Value & "/" & "0" & Combomonth.ListIndex + 1 & "/" & Comboday.Value

Else
date1 = Comboyear.Value & "/" & Combomonth.ListIndex + 1 & "/" & Comboday.Value

End If

Sheet1.Range("h2").Value = date1
Sheet1.Range("H3").FormulaR1C1 = "=J_DIFF(R[-2]C,R[-1]C)"
'****************************
Sheet1.Range("H4").FormulaR1C1 = "=J_DIFF(R[-2]C[-2],R[-2]C)"
tafavot = Sheet1.Range("h4").Value
mah = Combomonth.Value
year = Comboyear.Value
day = Comboday.Value

Select Case day
        Case 1
            rooz = "|fffd||fffd||fffd|"
        Case 2
            rooz = "|fffd||fffd||fffd|"
        Case 3
            rooz = "|fffd||fffd||fffd|"
        Case 4
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 5
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 6
            rooz = "|fffd||fffd||fffd|"
        Case 7
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 8
            rooz = "|fffd||fffd||fffd||fffd|"
        Case 9
            rooz = "|fffd||fffd||fffd|"
        Case 10
            rooz = "|fffd||fffd||fffd|"
        Case 11
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 12
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 13
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 14
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 15
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 16
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 17
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 18
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 19
            rooz = "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Case 20
            rooz = "|fffd||fffd||fffd||fffd||fffd|"
        Case 21
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 22
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 23
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 24
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 25
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 26
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
        Case 27
            rooz = "|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
        Case 28
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        Case 29
            rooz = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
        Case 30
            rooz = "|fffd||fffd| |fffd||fffd|"
        Case 31
            rooz = "|fffd||fffd| |fffd| |fffd||fffd||fffd|"
        End Select
Sheet1.Range("H5").FormulaR1C1 = "=J_WEEKDAY(R[-3]C,1)"
roozehafte3 = Sheet1.Range("H5").Value
If tafavot < 0 Then
UserForm5.Label9.Caption = Abs(tafavot) & " |fffd||fffd||fffd| " & "|fffd||fffd||fffd| " & roozehafte3 & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
ElseIf tafavot > 0 Then
UserForm5.Label9.Caption = Abs(tafavot) & " |fffd||fffd||fffd| " & "|fffd||fffd||fffd||fffd||fffd| " & roozehafte3 & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
Else
UserForm5.Label9.Caption = " |fffd||fffd||fffd||fffd||fffd| " & roozehafte3 & " - " & rooz & " " & mah & " |fffd||fffd||fffd|" & " " & year
End If

reminder = Abs(Sheet1.Range("h3").Value + 1) Mod 8
     Select Case reminder
      Case 0
      Label5.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label8.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 1
      Label5.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label7.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 2
      Label5.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Case 3
      Label5.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label8.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 4
      Label5.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label6.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 5
      Label5.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Case 6
      Label5.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label7.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 7
      Label5.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label6.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      End Select
End Sub

Private Sub CommandButton2_Click()
Unload Me
End Sub

Private Sub UserForm_Initialize()
With Comboyear
        .AddItem "1389"
        .AddItem "1390"
        .AddItem "1391"
        .AddItem "1392"
        .AddItem "1393"
        .AddItem "1394"
        .AddItem "1395"
        .AddItem "1396"
        .AddItem "1397"
End With
With Combomonth
         .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd|"
        .AddItem "|fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd|"
        .AddItem "|fffd||fffd||fffd||fffd||fffd|"
    End With
    With Comboday
        .AddItem "01"
        .AddItem "02"
        .AddItem "03"
        .AddItem "04"
        .AddItem "05"
        .AddItem "06"
        .AddItem "07"
        .AddItem "08"
        .AddItem "09"
        .AddItem "10"
        .AddItem "11"
        .AddItem "12"
        .AddItem "13"
        .AddItem "14"
        .AddItem "15"
        .AddItem "16"
        .AddItem "17"
        .AddItem "18"
        .AddItem "19"
        .AddItem "20"
        .AddItem "21"
        .AddItem "22"
        .AddItem "23"
        .AddItem "24"
        .AddItem "25"
        .AddItem "26"
        .AddItem "27"
        .AddItem "28"
        .AddItem "29"
        .AddItem "30"
        .AddItem "31"
    End With
    Comboyear.ListIndex = 0
    Combomonth.ListIndex = 0
    Comboday.ListIndex = 0
    '********************************
    Sheet1.Range("F1").Value = "1389/01/01"
    Sheet1.Range("F2").FormulaR1C1 = "=J_TODAY(1)"
    Sheet1.Range("F3").FormulaR1C1 = "=J_DIFF(R[-2]C,R[-1]C)"
    Label9.Caption = Sheet1.Cells(2, "g").Value
    reminder = (Sheet1.Range("F3").Value + 1) Mod 8
     Select Case reminder
       Case 0
      Label5.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label8.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 1
      Label5.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label7.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 2
      Label5.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Case 3
      Label5.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label8.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 4
      Label5.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label6.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 5
      Label5.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Case 6
      Label5.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label6.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|. |fffd|"
      Label7.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Case 7
      Label5.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|"
      Label6.Caption = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label7.Caption = "|fffd||fffd||458||fffd||fffd||fffd| |fffd||fffd||fffd|"
      Label8.Caption = "|fffd||fffd||498||fffd||fffd||fffd| |fffd||fffd||fffd|"
      End Select
      
End Sub


INQUEST-PP=macro
